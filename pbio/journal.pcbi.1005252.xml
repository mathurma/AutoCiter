<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01127</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005252</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolites</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecosystems</subject><subj-group><subject>Microbial ecosystems</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecosystems</subject><subj-group><subject>Microbial ecosystems</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolic processes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecosystems</subject><subj-group><subject>Ecosystem functioning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecosystems</subject><subj-group><subject>Ecosystem functioning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecosystems</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecosystems</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolic processes</subject><subj-group><subject>Fermentation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Metagenomics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Functional genomics</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Inferring Aggregated Functional Traits from Metagenomic Data Using Constrained Non-negative Matrix Factorization: Application to Fiber Degradation in the Human Gut Microbiota</article-title>
<alt-title alt-title-type="running-head">Constrained NMF for Trait Inference from Metagenomic Data</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Raguideau</surname> <given-names>Sébastien</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Plancade</surname> <given-names>Sandra</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Pons</surname> <given-names>Nicolas</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Leclerc</surname> <given-names>Marion</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7821-332X</contrib-id>
<name name-style="western">
<surname>Laroche</surname> <given-names>Béatrice</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Institut Micalis, INRA, AgroParisTech, Université Paris-Saclay, Jouy-en-Josas, France</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>MaIAGE, INRA, Université Paris-Saclay, Jouy-en-Josas, France</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>MGP, INRA, Université Paris-Saclay, Jouy-en-Josas, France</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Maranas</surname> <given-names>Costas D.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>The Pennsylvania State University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> SR SP ML BL.</p>
</list-item>
<list-item>
<p><bold>Data curation:</bold> NP SR.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> SR SP BL.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> SR.</p>
</list-item>
<list-item>
<p><bold>Validation:</bold> SR ML.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> SR SP ML BL.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">Beatrice.Laroche@inra.fr</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>12</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>16</day>
<month>12</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>12</issue>
<elocation-id>e1005252</elocation-id>
<history>
<date date-type="received">
<day>13</day>
<month>7</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>17</day>
<month>11</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Raguideau et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005252"/>
<abstract>
<p>Whole Genome Shotgun (WGS) metagenomics is increasingly used to study the structure and functions of complex microbial ecosystems, both from the taxonomic and functional point of view. Gene inventories of otherwise uncultured microbial communities make the direct functional profiling of microbial communities possible. The concept of community aggregated trait has been adapted from environmental and plant functional ecology to the framework of microbial ecology. Community aggregated traits are quantified from WGS data by computing the abundance of relevant marker genes. They can be used to study key processes at the ecosystem level and correlate environmental factors and ecosystem functions. In this paper we propose a novel model based approach to infer combinations of aggregated traits characterizing specific ecosystemic metabolic processes. We formulate a model of these Combined Aggregated Functional Traits (CAFTs) accounting for a hierarchical structure of genes, which are associated on microbial genomes, further linked at the ecosystem level by complex co-occurrences or interactions. The model is completed with constraints specifically designed to exploit available genomic information, in order to favor biologically relevant CAFTs. The CAFTs structure, as well as their intensity in the ecosystem, is obtained by solving a constrained Non-negative Matrix Factorization (NMF) problem. We developed a multicriteria selection procedure for the number of CAFTs. We illustrated our method on the modelling of ecosystemic functional traits of fiber degradation by the human gut microbiota. We used 1408 samples of gene abundances from several high-throughput sequencing projects and found that four CAFTs only were needed to represent the fiber degradation potential. This data reduction highlighted biologically consistent functional patterns while providing a high quality preservation of the original data. Our method is generic and can be applied to other metabolic processes in the gut or in other ecosystems.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Microbial communities are highly complex ecosystems, harboring a high taxonomic diversity, rapidly varying in time. Focusing on the functional traits of microorganisms instead of species offers an interesting and complementary insight since quite often, owing to environmental selection pressure, traits are less variable in time and shared by many species. By providing gene inventories of otherwise uncultured microbial communities, Whole Genome Shotgun (WGS) metagenomics made the functional profiling of microbial communities possible, since community aggregated traits can be quantified by the abundance of relevant marker genes. Considering a global metabolic process in an ecosystem, we propose a method that exploits gene abundance data to determine combinations of functional traits characterizing this process. When applied to fiber degradation in the human gut microbiota, the method shows that only four complex functional traits are needed to characterize this process. The approach is generic and could be applied to other processes or ecosystems. It allows summarizing complex datasets by a limited number of biologically interpretable functional patterns.</p>
</abstract>
<funding-group>
<funding-statement>The authors received no specific funding for this work.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="5"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Whole Genome Shotgun (WGS) metagenomics is increasingly used to study the structure and functions of complex microbial ecosystems. Thanks to a huge research effort, these high-throughput approaches are constantly improving and have already provided valuable information.</p>
<p>Recent achievements [<xref ref-type="bibr" rid="pcbi.1005252.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005252.ref003">3</xref>] for analyzing metagenomic reads have focused on genome or species reconstruction. They constitute an alternative to amplicon sequencing approaches such as 16S rDNA and provide potentially more robust tools for community structure assessment.</p>
<p>As a complement to these taxonomy oriented approaches, WGS metagenomics allows the direct functional profiling of microbial communities through gene inventories of otherwise uncultured microbial communities. The functional annotation of these genes, as well as the evaluation of their abundances requires the mapping of metagenomic reads on one or several functional databases which may include annotated, de novo assembled gene catalogs. It is a challenging task for which bioinformatic tools are still being developed (see [<xref ref-type="bibr" rid="pcbi.1005252.ref004">4</xref>] for a very recent review).</p>
<p>As early as 2005, Tringe et al. [<xref ref-type="bibr" rid="pcbi.1005252.ref005">5</xref>] demonstrated that functional binning could discriminate environments and determine the functional potential of microbial communities. Since then, several other groups used functional data to shed light on the processes taking place in the ecosystem, even in the absence of additional expression data (see e.g. [<xref ref-type="bibr" rid="pcbi.1005252.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005252.ref007">7</xref>]), and developed frameworks to functionally characterize and compare ecosystems [<xref ref-type="bibr" rid="pcbi.1005252.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005252.ref008">8</xref>]. Investigating complex microbial communities from a purely functional point of view provides an interesting insight because their taxonomic diversity may be very high and varying in time while, owing to environmental selection pressure, their ecosystemic functions are often ubiquitous and much more stable in time. The functional profiling of microbial communities has motivated the adaptation of concepts borrowed from environmental and plant functional ecology to the framework of microbial ecology, such as community aggregated traits [<xref ref-type="bibr" rid="pcbi.1005252.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005252.ref010">10</xref>], which can be quantified through abundance computation of specific genes or predefined pathways from WGS data. These taxon-free approaches allow the study of key processes at the ecosystem level and correlate environmental factors and ecosystem functions [<xref ref-type="bibr" rid="pcbi.1005252.ref011">11</xref>].</p>
<p>Choosing relevant descriptors for ecosystem functions raises several issues. Using arbitrarily predefined pathways helps simplifying the systems description by creating combined descriptors, however it may not reflect all the information in the data. On the other hand, unsupervised statistical analyses such as e.g. principal component analysis (PCA) are quite often used to extract low-dimensional description of these high-dimensional datasets. However, they do not exploit all the richness of available information about biological processes at the individual or collective level, and may lead to irrelevant or hardly interpretable results. To overcome these issues, we propose a novel model based approach, mixing satistical data analysis and system biology. We focus on specific ecosystemic metabolic processes, described by a possibly high number of genes or functional markers abundances. Our aim is to infer a limited number of combined functional traits characterizing these processes, as well as their intensity in the ecosystem.</p>
<p>Our approach relies on Non-negative Matrix Factorization (NMF), a popular machine learning technique in data and image analysis. NMF, together with PCA belongs to a wide family of data analysis methods designed to solve blind source separation problems. These questions are widely encountered and cover all situations where a mixture of several signals originating from different unknown sources is observed (here gene abundances in samples) and one wishes to separate them and identify the sources (the combined functional traits) and the mixture coefficients.</p>
<p>NMF was previously used for genomic data mining in the context of microarray data analysis [<xref ref-type="bibr" rid="pcbi.1005252.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005252.ref013">13</xref>]. More recently, it was introduced in the context of metagenomics for reads binning [<xref ref-type="bibr" rid="pcbi.1005252.ref014">14</xref>], or analyzing datasets from various ecosystems. In particular Jiang and co-authors used this approach as a “soft” clustering tool in different ecosystems. They studied pathway abundances in diverse environmental ecosystems [<xref ref-type="bibr" rid="pcbi.1005252.ref015">15</xref>], compared habitats in marine ecosystems using protein families profiles [<xref ref-type="bibr" rid="pcbi.1005252.ref016">16</xref>] and human body sites using phylogenetic and functional data [<xref ref-type="bibr" rid="pcbi.1005252.ref017">17</xref>].</p>
<p>In [<xref ref-type="bibr" rid="pcbi.1005252.ref018">18</xref>] the idea of coupling source separation analyses with prior knowledge was developed in the context of bipartite network reconstruction, using prior knowledge on the network structure, and applied to the reconstruction of regulatory signals from microarray data.</p>
<p>The originality of our work lies in the design of a constrained NMF approach where the constraints aim at selecting biologically relevant combined functional traits (the sources) to describe processes at the ecosystem level. The constraints are derived from available prior knowledge in a Bayesian perspective. Moreover, we propose a careful multicriteria selection procedure to select the relevant number of combined functional traits.</p>
<p>As a proof of concept, we applied our approach to the modelling of ecosystemic functional traits of fiber degradation by the human gut microbiota based on 1408 samples of gene abundances.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>A model of combined aggregated functional traits</title>
<p>Quantitative metagenomics allows the study of metabolic processes at the ecosystem level, by producing metagenes abundances with functional annotation. Taking advantage of this information, we consider a metabolic process occurring in an ecosystem. We assume that this process is described by a list of biochemical reactions, each associated to what we call a <italic>functional marker</italic>. A functional marker is a group of genes, or modular elements in genes, able to control the production of enzymes involved in a reaction. Typical functional markers are Kegg Orthologies (KO). The abundance of a functional marker is defined as the sum of the abundances of all the metagenes identified as belonging to the group.</p>
<p>Our first modelling hypothesis is the existence of patterns underlying functional markers abundances in the ecosystem. Indeed, within a microbial ecosystem, genes can be looked at in a hierarchical fashion. They are first associated on microbial genomes, which are further grouped at the ecosystem level into subcommunities of microorganisms. These subcommunities involve hundreds of different bacterial species linked by complex co-occurrences or interactions. Moreover they are influenced by environmental factors (e.g. nutrients or temperature). The set of functional marker abundances within each of these subcommunities form a characteristic pattern in the ecosystem.</p>
<p>This hypothesis is illustrated in the simplistic example of metabolic process in <xref ref-type="fig" rid="pcbi.1005252.g001">Fig 1</xref>. Here, the observed functional marker abundances originate from three subcommunities, resulting in three patterns. The ecological interpretation of the first pattern (green box) could be a trophic chain in which metabolite <italic>X</italic> is produced by bacterial species of type 1 and used by bacterial species of type 3 as well as an association between bacterial species of type 1 and 2 for other ecological reasons which cannot be elucidated with the observation of this particular metabolic process only. Therefore functional marker abundances in samples should reflect this structure.</p>
<fig id="pcbi.1005252.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Hierarchical structure underlying metagenomic data.</title>
<p>We consider a metabolic process in a microbial ecosystem involving a substrate U, metabolites V, X, Y, Z, T and the set of reactions U → V, V → X, X → Y, V → Z and U → T + X, respectively catalyzed by proteins synthesized by genes in KEGG Orthology (KO) groups <bold>a</bold>, <bold>b</bold>, <bold>c</bold>, <bold>d</bold> and <bold>e</bold>. Gene counts stem from an underlying hierarchical organization. Genes are associated within bacterial genomes (solid black lines) and through ecosystem level association patterns (green, red and blue ticked lines). In this example, the green and blue boxes can be interpreted as trophic chains corresponding to two distinct pathways for substrate degradation. The red box can be interpreted as an alternative to the green one, involving different bacterial groups, depending on the host diet or life history. Note that the red box involves (possibly several) species harbouring two copies of gene <bold>a</bold> in their genomes.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.g001" xlink:type="simple"/>
</fig>
<p>Our second modelling hypothesis is motivated by the fact that even if in many microbial communities microbial species composition varies over time and samples, metabolic processes at the community level are ubiquitous and much more stable in time. Consequently, we assume that the patterns mentioned above are shared by all samples of the ecosystem, in variable proportions because they were selected by specific environmental constraints. For instance, for the gut ecosystem these include anaerobic conditions, temperature or digestion residue composition coming from the host diet. As illustrated on <xref ref-type="fig" rid="pcbi.1005252.g002">Fig 2</xref>, when considering the abundances of functional markers in several samples, each of these patterns can be characterized by a line vector of functional marker frequencies, which we define to be a Combined Aggregated Functional Trait (CAFT), in the meaning that it represents a combination of quantifiable characteristics (functional markers) of aggregated microbial communities.</p>
<fig id="pcbi.1005252.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Combined Aggregated Functional Traits.</title>
<p>The gene association patterns in <xref ref-type="fig" rid="pcbi.1005252.g001">Fig 1</xref> correspond to stable structures, representing different ways to fulfill the metabolic function of interest at the ecosystem level. At the bottom of each box, vectors <italic>h</italic><sub>1</sub>, <italic>h</italic><sub>2</sub> and <italic>h</italic><sub>3</sub> represent functional markers abundances. We call these vectors Combined Aggregated Functional Traits (CAFTs). They should be found in all samples, possibly in varying proportions. Sample 1 is decomposed as <italic>A</italic><sub>1</sub> = 3<italic>h</italic><sub>1</sub> + 2<italic>h</italic><sub>2</sub> + <italic>h</italic><sub>3</sub> and sample <italic>n</italic> as <italic>A</italic><sub><italic>n</italic></sub> = <italic>h</italic><sub>1</sub> + 2<italic>h</italic><sub>2</sub> + 3<italic>h</italic><sub>3</sub>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.g002" xlink:type="simple"/>
</fig>
<p>Following our hypotheses, functional marker abundances in each sample are modelled as mixtures of underlying CAFTs. For each sample <italic>i</italic> = 1, …, <italic>n</italic> and marker <italic>j</italic> = 1, …, <italic>r</italic>, the observed frequency <italic>a</italic><sub><italic>ij</italic></sub> of marker <italic>j</italic> in sample <italic>i</italic> is the sum of the contributions of all CAFTs. This leads to
<disp-formula id="pcbi.1005252.e001"><alternatives><graphic id="pcbi.1005252.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≃</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:munderover> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>h</italic><sub><italic>l</italic></sub> = (<italic>h</italic><sub><italic>l</italic>1</sub>, …, <italic>h</italic><sub><italic>lr</italic></sub>) is the characterization in terms of <italic>r</italic> markers frequencies of the <italic>l</italic><sup><italic>th</italic></sup> CAFT and <italic>w</italic><sub><italic>i</italic></sub> = (<italic>w</italic><sub><italic>i</italic>1</sub>, …, <italic>w</italic><sub><italic>ik</italic></sub>) is the vector of the intensities or weights of the <italic>k</italic> CAFTs in sample <italic>i</italic>.</p>
<p>Note that each <italic>h</italic><sub><italic>l</italic></sub> is defined up to a multiplication by a positive constant, provided that its weights in the samples are scaled accordingly. The <italic>ℓ</italic><sup>1</sup>-scaled version <italic>h</italic><sub><italic>l</italic></sub>/(∑<sub><italic>j</italic></sub> <italic>h</italic><sub><italic>lj</italic></sub>) can be interpreted as the vector of relative frequencies of functional markers within the subcommunity characterized by trait <italic>l</italic>.</p>
<p>In the rest of the paper, we denote the (<italic>n</italic> × <italic>r</italic>) data matrix by <italic>A</italic>, the (<italic>k</italic> × <italic>r</italic>) matrix whose lines are the <italic>h</italic><sub><italic>l</italic></sub> by <italic>H</italic> and the (<italic>n</italic> × <italic>k</italic>) matrix whose lines are the <italic>w</italic><sub><italic>i</italic></sub> by <italic>W</italic>. <italic>H</italic> will be called the trait matrix and <italic>W</italic> the weight matrix.</p>
</sec>
<sec id="sec004">
<title>Constraints</title>
<p>By definition the entries of the weight and trait matrices <italic>W</italic> and <italic>H</italic> are assumed to be non-negative, we denote this condition by
<disp-formula id="pcbi.1005252.e002"><alternatives><graphic id="pcbi.1005252.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mrow><mml:mi>W</mml:mi> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>H</mml:mi> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
We now show how prior knowledge on microbial genomics and metabolism can be exploited in order to select biologically relevant CAFTs.</p>
<p>A first important consequence of our modeling framework is that genomic information can be translated into constraints on CAFTs structure. Indeed, by construction, the CAFT <italic>h</italic><sub><italic>l</italic></sub> characterizes a gene pattern associated in each sample <italic>i</italic> to a subcommunity <italic>C</italic><sub><italic>il</italic></sub>. Therefore, in each of these subcommunities, the total abundance of any functional marker <italic>j</italic> is proportional to <italic>h</italic><sub><italic>lj</italic></sub>. Thus, denoting <italic>n</italic><sub><italic>xj</italic></sub> the number of functional markers <italic>j</italic> in the genome of a microorganism <italic>x</italic> in the ecosystem, it follows that
<disp-formula id="pcbi.1005252.e003"><alternatives><graphic id="pcbi.1005252.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
From <xref ref-type="disp-formula" rid="pcbi.1005252.e003">Eq (3)</xref> we observe that any constraint on the structure of the genomes (the <italic>n</italic><sub><italic>xj</italic></sub>) satisfied by all <italic>x</italic> in the ecosystem induces a constraint on the CAFTs (the <italic>h</italic><sub><italic>lj</italic></sub>).</p>
<p>As an example, let us assume that two markers <italic>j</italic> and <italic>j</italic>′ are such that for each microorganism in the ecosystem, if <italic>j</italic>′ is not present in its genome, then neither is <italic>j</italic>. This implies that for each microorganism <italic>x</italic>, there is a non-negative constant <italic>R</italic><sub><italic>x</italic>, <italic>j</italic>, <italic>j</italic>′</sub> satisfying
<disp-formula id="pcbi.1005252.e004"><alternatives><graphic id="pcbi.1005252.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where we arbitrarily set <italic>R</italic><sub><italic>x</italic>, <italic>j</italic>, <italic>j</italic>′</sub> = 0 when <italic>n</italic><sub><italic>xj</italic></sub> = <italic>n</italic><sub><italic>xj</italic>′</sub> = 0. Then as a consequence of <xref ref-type="disp-formula" rid="pcbi.1005252.e003">Eq (3)</xref> we have for each CAFT <italic>l</italic> <disp-formula id="pcbi.1005252.e005"><alternatives><graphic id="pcbi.1005252.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mrow><mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>δ</italic> = sup<sub><italic>x</italic> ∈ Ecosystem</sub> <italic>R</italic><sub><italic>x</italic>, <italic>j</italic>, <italic>j</italic>′</sub>.</p>
<p>In the absence of any other information, exploiting genomic information only could lead to a large number of constraints. For instance, constraining the ratio of abundances in pairs of markers as above requires assessing the existence of constants such that <xref ref-type="disp-formula" rid="pcbi.1005252.e004">Eq (4)</xref> holds for <italic>r</italic>(<italic>r</italic> − 1) ordered pairs, for each genome <italic>x</italic>. This is why we propose to combine genomic information with metabolic information, when possible, in order to select a limited but relevant set of constraints on the CAFTs.</p>
<p>In order to do this, we formulate two additional assumptions. First, we assume that a subset of reactions in the metabolic process under consideration are well known, so that a list of metabolites that are consumed or produced by each reaction can be extracted.</p>
<p>Second, we assume that metabolites are partitioned in two classes. The first one corresponds to metabolites that are known to be exported out of the cell, from experimental evidence or published data. The second one gathers metabolites that are actually known to stay within microbial cells, as well as metabolites for which this is strongly suspected. For convenience, these two classes will be called the extracellular and intracellular metabolites, although this may be misleading in some cases.</p>
<p>Following similar steps as in eqs (<xref ref-type="disp-formula" rid="pcbi.1005252.e003">3</xref>–<xref ref-type="disp-formula" rid="pcbi.1005252.e005">5</xref>), a subset <italic>M</italic><sub>1</sub> of the class of intracellular metabolites can be derived from genomic information on the microorganisms present in the ecosystem, as well as a positive constant <italic>δ</italic><sub>1,<italic>m</italic></sub> for each <italic>m</italic> in <italic>M</italic><sub>1</sub>, such that in each CAFT <italic>h</italic><sub><italic>l</italic></sub> the marker frequencies associated to the production or consumption of <italic>m</italic> should satisfy
<disp-formula id="pcbi.1005252.e006"><alternatives><graphic id="pcbi.1005252.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mtext>j</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>producing</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>m</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mtext>j'</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>consuming</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>m</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
In the same way, there is a subset <italic>M</italic><sub>2</sub> of intracellular metabolites such that for each <italic>m</italic> in <italic>M</italic><sub>2</sub>, each CAFT <italic>h</italic><sub><italic>l</italic></sub> should satisfy
<disp-formula id="pcbi.1005252.e007"><alternatives><graphic id="pcbi.1005252.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mtext>j'</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>consuming</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>m</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mtext>j</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>producing</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>m</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
The intuitive idea behind such constraints is the following. Assuming that functional markers are relevant proxies of metabolic functions, it could be expected that if a genuinely intracellular metabolite is produced in the subcommunity characterized by a given CAFT it has to be used. This inspires <xref ref-type="disp-formula" rid="pcbi.1005252.e006">constraint (6)</xref>, since it imposes that the number of markers associated to reactions that produce a given intracellular metabolite is zero if the number of markers associated to reactions that consume the same intracellular metabolite is zero. Conversely, it could be expected that a metabolite cannot be used if it is not produced, which is enforced by <xref ref-type="disp-formula" rid="pcbi.1005252.e007">constraint (7)</xref>. This justifies the absence of constraints imposed on functional markers associated to reactions consuming or producing for the class of extracellular metabolites as the latter can actually be imported or exported outside bacterial cells in the ecosystem.</p>
<p>However, the set of metabolites and reactions under consideration is defined in the context of a specific metabolic process, given the available knowledge. Thus it may be that in this process, some intracellular metabolites accumulate in the cells. It may also be that the selected reactions ignore metabolic routes, because they are unknown or correspond to other metabolic processes, that could produce or use the metabolites, and finally it may also happen that we were wrong in assuming that some poorly studied metabolites are intracellular. Consequently, depending on metabolites, either none, one or both constraints <xref ref-type="disp-formula" rid="pcbi.1005252.e006">(6)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005252.e007">(7)</xref> may be satisfied. In the case where both constraints apply, the frequencies of markers associated to production and consumption are both either zero or positive with consumption over production marker frequency ratio lying in [1/<italic>δ</italic><sub>1,<italic>m</italic></sub>, <italic>δ</italic><sub>2,<italic>m</italic></sub>].</p>
<p>The theoretical construction of the two sets <italic>M</italic><sub>1</sub>, <italic>M</italic><sub>2</sub> and the positive constants <italic>δ</italic><sub>1,<italic>m</italic></sub> and <italic>δ</italic><sub>2,<italic>m</italic></sub> is detailed in the Materials and Methods section, as well as their practical approximation from known bacterial genomes.</p>
<p>The set of constraints <xref ref-type="disp-formula" rid="pcbi.1005252.e006">(6)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005252.e007">(7)</xref> can be expressed in matrix notation as
<disp-formula id="pcbi.1005252.e008"><alternatives><graphic id="pcbi.1005252.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mo>Δ</mml:mo></mml:msub> <mml:msup><mml:mi>H</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>≤</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
where Δ is the set of parameters Δ = {<italic>δ</italic><sub>1,<italic>m</italic></sub>, <italic>m</italic> ∈ <italic>M</italic><sub>1</sub>} ∪ {<italic>δ</italic><sub>2,<italic>m</italic></sub>, <italic>m</italic> ∈ <italic>M</italic><sub>2</sub>} and <italic>F</italic><sub>Δ</sub> is a coefficient matrix depending on Δ.</p>
<p>Note that, although they include metabolic information and take the familiar form of linear inequality constraints <xref ref-type="disp-formula" rid="pcbi.1005252.e006">(6)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005252.e007">(7)</xref> are constraints on gene frequencies in subcommunities, they are not constraints on metabolic fluxes.</p>
</sec>
<sec id="sec005">
<title>Inference of CAFT and weights</title>
<sec id="sec006">
<title>Nonnegative Matrix Factorization formulation</title>
<p>The determination of matrices <italic>W</italic> and <italic>H</italic> which satisfy Eqs <xref ref-type="disp-formula" rid="pcbi.1005252.e001">(1)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005252.e002">(2)</xref> can be formulated as an approximate Nonnegative Matrix Factorization (NMF) problem (see e.g. [<xref ref-type="bibr" rid="pcbi.1005252.ref019">19</xref>]). The mathematical formulation of the problem requires first to choose a dissimilarity measure for the approximate factorization <xref ref-type="disp-formula" rid="pcbi.1005252.e001">Eq (1)</xref>. In our algorithm, we considered the Frobenius norm. Moreover, as functional markers may display different order of magnitude, a scaling per functional marker is operated by considering the <italic>ℓ</italic><sup>2</sup>-columnwise normalization of <italic>A</italic>, denoted <inline-formula id="pcbi.1005252.e009"><alternatives><graphic id="pcbi.1005252.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mover><mml:mi>A</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Therefore, the dissimilarity considered is
<disp-formula id="pcbi.1005252.e010"><alternatives><graphic id="pcbi.1005252.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mi>W</mml:mi> <mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msubsup><mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:munderover> <mml:msup><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:munderover> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
where <inline-formula id="pcbi.1005252.e011"><alternatives><graphic id="pcbi.1005252.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the scaled trait matrix. Matrix <italic>H</italic> is then recovered by multiplying each column of <inline-formula id="pcbi.1005252.e012"><alternatives><graphic id="pcbi.1005252.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by the <italic>ℓ</italic><sup>2</sup>-norm of the corresponding column in <italic>A</italic>.</p>
<p>The NMF algorithms which aim at minimizing this distance require the use of regularizing terms in order to lift identifiability problems and filter noisy data during the minimization process. We consider a regularizing term that promotes sparsity over the columns of <inline-formula id="pcbi.1005252.e013"><alternatives><graphic id="pcbi.1005252.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, which encourages markers to be present in a limited number of CAFTs (see <xref ref-type="sec" rid="sec015">Materials and Methods</xref>).</p>
<p>Finally, we impose the additional <xref ref-type="disp-formula" rid="pcbi.1005252.e008">constraint (8)</xref>. Let <inline-formula id="pcbi.1005252.e014"><alternatives><graphic id="pcbi.1005252.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msub><mml:mover><mml:mi>F</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo>Δ</mml:mo></mml:msub></mml:math></alternatives></inline-formula> be the scaled matrix <italic>F</italic><sub>Δ</sub> such that the <xref ref-type="disp-formula" rid="pcbi.1005252.e008">constraint (8)</xref> is equivalent to <inline-formula id="pcbi.1005252.e015"><alternatives><graphic id="pcbi.1005252.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msub><mml:mover><mml:mi>F</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo>Δ</mml:mo></mml:msub> <mml:msup><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>T</mml:mi></mml:msup> <mml:mo>≤</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Therefore, the inference of the CAFTs and weights is obtained by solving the following minimization problem
<disp-formula id="pcbi.1005252.e016"><alternatives><graphic id="pcbi.1005252.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mi>W</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:munder> <mml:mrow><mml:mspace width="0.277778em"/><mml:mo>‖</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mi>W</mml:mi> <mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msubsup><mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mrow><mml:mi>α</mml:mi> <mml:mo>(</mml:mo> <mml:mo>‖</mml:mo> <mml:mi>W</mml:mi> <mml:mo>‖</mml:mo></mml:mrow> <mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>+</mml:mo> <mml:mo>‖</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:msubsup><mml:mo>‖</mml:mo> <mml:mrow><mml:mn>2</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mi>W</mml:mi> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>H</mml:mi> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>Δ</mml:mo></mml:msub> <mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>T</mml:mi></mml:msup> <mml:mo>≤</mml:mo> <mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
where <inline-formula id="pcbi.1005252.e017"><alternatives><graphic id="pcbi.1005252.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> denotes the vector of length <italic>k</italic> whose entries are equal to 1.</p>
<p>It is well known that problems like <xref ref-type="disp-formula" rid="pcbi.1005252.e016">Eq (10)</xref> may have multiple solutions or local minima. To circumvent this issue, similarly to most approaches presented in the literature, our algorithm is repeatedly implemented with random initializations, and the one providing the best reconstruction of the data is chosen. More details are given in the Inference section in Materials and Methods.</p>
</sec>
<sec id="sec007">
<title>Selection of parameters</title>
<p>The minimization problem <xref ref-type="disp-formula" rid="pcbi.1005252.e016">Eq (10)</xref> requires to choose a value for the number of CAFTs <italic>k</italic> and the tuning parameter <italic>α</italic>. Parameter selection procedures proposed in most applications of NMF to biological data are based upon stability of the weight matrix <italic>W</italic> over several initializations of the iterative algorithm used to solve the problem [<xref ref-type="bibr" rid="pcbi.1005252.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005252.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005252.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005252.ref016">16</xref>], in particular regarding the clustering of samples. Since our use of NMF focuses on extracting reproducible biological mechanisms characterized by the trait matrix <italic>H</italic>, we are more interested in biological stability than numerical one. Therefore, we propose an adaptation of the concordance index developed by [<xref ref-type="bibr" rid="pcbi.1005252.ref016">16</xref>], which measures the concordance between two matrices of profiles, to evaluate the concordance of the CAFTs computed on independent data sets. In our approach, the reproducibility of <italic>H</italic> on a new data set is mimicked by repeatedly splitting the set of biological samples, performing the NMF decomposition on each subset and evaluating the similarity between the two trait matrices via the concordance index. Even if the index formula is identical to the one proposed by [<xref ref-type="bibr" rid="pcbi.1005252.ref016">16</xref>], the interpretation differs since the authors assessed the reproducibility between various initializations of the NMF algorithm implemented on the whole data set. Note that, as mentioned in the previous section, our algorithm includes repeated random initializations as well, and each NMF decomposition computed on a subset of the data is obtained by chosing the initialization which offers the best reconstruction. To enhance interpretation, this criterion is associated with two more classical ones: change of slope of the reconstruction error and bi-cross-validation error [<xref ref-type="bibr" rid="pcbi.1005252.ref020">20</xref>]. The selected value is the one which optimizes the concordance of <italic>H</italic> while ensuring that the other criteria are acceptable. More details are given in Materials and Methods.</p>
</sec>
</sec>
<sec id="sec008">
<title>Impact of the constraint: Toy model</title>
<p>The constrained NMF algorithm as well as an unconstrained version were implemented on a toy model in order to illustrate the improvement in terms of CAFT analysis brought by the constraints. We considered a microbial ecosystem in which a metabolic process characterized by a simple 5 reactions graph takes place, each reaction being associated to a functional marker. The metabolic process was assumed to be structured in two CAFTs. The first CAFT characterizes a subcommunity in the ecosystem in which all the functional markers are present in equal proportion, while the second CAFT characterizes a subcommunity in which only three functional markers are present, in equal proportion. The metabolic graph and the true CAFTs are displayed in <xref ref-type="fig" rid="pcbi.1005252.g003">Fig 3A</xref>. Thus, the true CAFT composition matrix was taken equal to
<disp-formula id="pcbi.1005252.e018"><alternatives><graphic id="pcbi.1005252.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mrow><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfenced close=")" open="("><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mspace width="0.277778em"/><mml:mn>1</mml:mn> <mml:mspace width="0.277778em"/><mml:mn>1</mml:mn> <mml:mspace width="0.277778em"/><mml:mn>1</mml:mn> <mml:mspace width="0.277778em"/><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mspace width="0.277778em"/><mml:mn>0</mml:mn> <mml:mspace width="0.277778em"/><mml:mn>0</mml:mn> <mml:mspace width="0.277778em"/><mml:mn>1</mml:mn> <mml:mspace width="0.277778em"/><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula>
We built a matrix <italic>A</italic> for 80 samples assumed to be mixtures of CAFT 1 and CAFT 2. We first generated a matrix <inline-formula id="pcbi.1005252.e019"><alternatives><graphic id="pcbi.1005252.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mover><mml:mi>W</mml:mi> <mml:mo accent="true">‾</mml:mo></mml:mover></mml:math></alternatives></inline-formula> of abundances of CAFT 1 and CAFT 2 for the 80 samples, with entries randomly drawn from a uniform distribution, and computed the corresponding marker count matrix <inline-formula id="pcbi.1005252.e020"><alternatives><graphic id="pcbi.1005252.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:mi>B</mml:mi> <mml:mo>=</mml:mo> <mml:mover><mml:mi>W</mml:mi> <mml:mo accent="true">‾</mml:mo></mml:mover> <mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">‾</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. Noisy counts were generated from <italic>B</italic> according to the formula
<disp-formula id="pcbi.1005252.e021"><alternatives><graphic id="pcbi.1005252.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
where the <italic>ϵ</italic><sub><italic>ij</italic></sub> are independent, centered Gaussian variables with unit variance.</p>
<fig id="pcbi.1005252.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.g003</object-id>
<label>Fig 3</label>
<caption>
<title>A toy example to illustrate the impact of the constraints.</title>
<p>We consider a metabolic process in a microbial ecosystem, which involves five reactions (arrows) associated to functional markers <bold>a</bold>, <bold>b</bold>, <bold>c</bold>, <bold>d</bold> and <bold>e</bold>, three extracellular metabolites <italic>U</italic>, <italic>Z</italic> and <italic>T</italic> (blue circles) and three intracellular metabolites <italic>V</italic>, <italic>X</italic> and <italic>Y</italic> (yellow circles). The metabolic process is organized according two CAFTs, displayed in box A. The CAFTs were inferred from 80 samples of functional markers counts, generated from random mixtures of the two CAFTs. The estimated CAFTs are shown, both for the constrained (box B) and unconstrained NMF (box C). Box D shows the reconstructed counts in each sample (<italic>WH</italic>)<sub><italic>ij</italic></sub> with constrained (x-axis) and non-constrained (y-axis) NMF.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.g003" xlink:type="simple"/>
</fig>
<p>In order to exemplify the construction of the constraints, we assumed that a set of three highly prevalent bacteria in this ecosystem was known. Bacteria are represented by the vectors <italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub> and <italic>x</italic><sub>3</sub> of functional markers counts in their genomes
<disp-formula id="pcbi.1005252.e022"><alternatives><graphic id="pcbi.1005252.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>x</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
We assumed that based on published data on the physiology of these bacteria and possibly other bacteria in the ecosystem that are less prevalent, we knew that metabolites <italic>U</italic>, <italic>Z</italic> and <italic>T</italic> were extracellular. For instance, these data may come from <italic>in vitro</italic> culture experiments. We also assumed that the metabolites <italic>V</italic>, <italic>X</italic> and <italic>Y</italic> were not detected in the extracellular medium in these type of experiments, and considered them as intracellular by default.</p>
<p>We used these representative genomes, together with the metabolic graph of <xref ref-type="fig" rid="pcbi.1005252.g003">Fig 3A</xref> and applied the rules described in the Materials and Methods section to build a set of constraints on the CAFTs. Considering metabolite <italic>V</italic>, it is known to be produced by the reaction associated to marker <italic>a</italic> and consumed by the reactions associated to <italic>b</italic> and <italic>d</italic>. The inspection of the three genomes led to
<disp-formula id="pcbi.1005252.e023"><alternatives><graphic id="pcbi.1005252.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>×</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4.pt"/><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mtext>,</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>since</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>×</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4.pt"/><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mtext>,</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>since</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>3</mml:mn> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>×</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>3</mml:mn> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>3</mml:mn> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4.pt"/><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>x</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mtext>,</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>since</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>3</mml:mn> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mn>3</mml:mn> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
Therefore <xref ref-type="disp-formula" rid="pcbi.1005252.e031">Eq (11)</xref> is satisfied on the three reference genomes. Thus, <italic>V</italic> belongs to <inline-formula id="pcbi.1005252.e024"><alternatives><graphic id="pcbi.1005252.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> with <italic>δ</italic><sub>1<italic>V</italic></sub> = max(1, 1, 0) = 1. As described in the Materials and Methods section, we compensated for calibrating <italic>δ</italic><sub>1<italic>V</italic></sub> on a limited number of genomes instead of all the genomes in the ecosystem by applying a multiplicative factor of 2, which seems sensible here since the highly prevalent genome have at most one copy of each functional marker in their genome. We obtained the following constraints
<disp-formula id="pcbi.1005252.e025"><alternatives><graphic id="pcbi.1005252.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mrow><mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mn>4</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
Similarly, <italic>X</italic> belongs to <inline-formula id="pcbi.1005252.e026"><alternatives><graphic id="pcbi.1005252.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> with <italic>h</italic><sub><italic>l</italic>2</sub> ≤ 2<italic>h</italic><sub><italic>l</italic>3</sub>. However, <italic>Y</italic> is not in <inline-formula id="pcbi.1005252.e027"><alternatives><graphic id="pcbi.1005252.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> as <xref ref-type="disp-formula" rid="pcbi.1005252.e031">Eq (11)</xref> is not satisfied for genome <italic>x</italic><sub>2</sub>, here 33% of the reference genomes. In the same way, <italic>V</italic> and <italic>X</italic> belong to <inline-formula id="pcbi.1005252.e028"><alternatives><graphic id="pcbi.1005252.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula> with <italic>h</italic><sub><italic>l</italic>2</sub>+<italic>h</italic><sub><italic>l</italic>4</sub> ≤ 2<italic>h</italic><sub><italic>l</italic>1</sub> and <italic>h</italic><sub><italic>l</italic>3</sub> ≤ 2<italic>h</italic><sub><italic>l</italic>2</sub>, and <italic>Y</italic> is discarded.</p>
<p>We compared the CAFTs reconstructed using the constrained (<xref ref-type="fig" rid="pcbi.1005252.g003">Fig 3B</xref>) and unconstrained (<xref ref-type="fig" rid="pcbi.1005252.g003">Fig 3C</xref>) NMF inference. The NMF inference with constraints recovers the true CAFTs, while the unconstrained inference fails to provide relevant biological results. Besides, both constrained and unconstrained NMF provide a similar reconstruction of the data, as shown in <xref ref-type="fig" rid="pcbi.1005252.g003">Fig 3D</xref>. Indeed, from a mathematical point of view, the reconstructed CAFTs with and without constraints span the same linear space.</p>
<p>Therefore, while both constrained and unconstrained NMF provide usable results for biological sample analysis, only the constrained version is relevant for CAFT inference.</p>
</sec>
<sec id="sec009">
<title>Application: Fiber catabolism CAFT in the human gut microbiota</title>
<sec id="sec010">
<title>Data and metabolic process description</title>
<p>We exploited gene frequencies in 1408 Whole Genome Shotgun metagenomic samples from 8 distinct studies [<xref ref-type="bibr" rid="pcbi.1005252.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005252.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1005252.ref027">27</xref>] focused on different health status and human populations (Europe, China, USA). For each sample, gene frequencies were obtained by counting sample reads over the Integrated Genome Catalog (IGC) [<xref ref-type="bibr" rid="pcbi.1005252.ref021">21</xref>] composed of 9.9 million non redundant genes. Functional markers of fiber catabolism were defined from Kegg Orthologies (KO) [<xref ref-type="bibr" rid="pcbi.1005252.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005252.ref029">29</xref>] as well as Glycosides Hydrolases (GH) and Pectin Lyases (PL) families [<xref ref-type="bibr" rid="pcbi.1005252.ref030">30</xref>]. A total of 86 relevant markers (25 GH-PL and 61 KO, listed in Tables <xref ref-type="table" rid="pcbi.1005252.t001">1</xref> and <xref ref-type="table" rid="pcbi.1005252.t002">2</xref>) were carefully manually selected as being specifically associated to fiber catabolism in the human gut microbiota. Finally, a 1408 × 86 matrix of marker frequencies <italic>A</italic> was derived by summing the corresponding gene frequencies. The graph representing sugar fermentation is displayed on <xref ref-type="fig" rid="pcbi.1005252.g004">Fig 4</xref>. It comprises 43 major metabolites, among which 25 are known or assumed to be intracellular and 18 are known to be extracellular. It is oriented according to the biological catabolic pathway from the hydrolysis of fiber leading to simple sugars subsequently fermented to Short Chain Fatty Acid (SCFA) and methane.</p>
<fig id="pcbi.1005252.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Reaction graph of the biological catabolic pathway from simple sugars to SCFA and methane.</title>
<p>The nodes of the graph are the 43 selected metabolites, red nodes correspond to the 18 extracellular metabolites and blue nodes are the 25 extracellular, their full names and status are given in <xref ref-type="table" rid="pcbi.1005252.t003">Table 3</xref>. The 61 edges of the graph correspond to the 61 selected functional markers listed in <xref ref-type="table" rid="pcbi.1005252.t002">Table 2</xref> with their associated reaction. More details can be found in <xref ref-type="supplementary-material" rid="pcbi.1005252.s007">S1 Table</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.g004" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1005252.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.t001</object-id>
<label>Table 1</label>
<caption>
<title>List of the 25 selected GH/PL.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005252.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<tbody>
<tr>
<td align="center">GH3</td>
<td align="center">GH13</td>
<td align="center">GH32</td>
<td align="center">GH51</td>
<td align="center">GH120</td>
</tr>
<tr>
<td align="center">GH5</td>
<td align="center">GH16</td>
<td align="center">GH39</td>
<td align="center">GH74</td>
<td align="center">GH127</td>
</tr>
<tr>
<td align="center">GH8</td>
<td align="center">GH26</td>
<td align="center">GH43</td>
<td align="center">GH91</td>
<td align="center">PL1</td>
</tr>
<tr>
<td align="center">GH9</td>
<td align="center">GH28</td>
<td align="center">GH44</td>
<td align="center">GH94</td>
<td align="center">PL9</td>
</tr>
<tr>
<td align="center">GH10</td>
<td align="center">GH30</td>
<td align="center">GH48</td>
<td align="center">GH115</td>
<td align="center">PL11</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pcbi.1005252.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.t002</object-id>
<label>Table 2</label>
<caption>
<title>List of the 61 functional markers of sugar catabolism.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005252.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Reaction</th>
<th align="center">KO(s)</th>
<th align="center">Reaction</th>
<th align="center">KO(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td align="center">K01809</td>
<td align="center">32</td>
<td align="center">K00169/170/171/172</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">K00882</td>
<td align="center">33</td>
<td align="center">K00627</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">K06859</td>
<td align="center">34</td>
<td align="center">K03737</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">K01810</td>
<td align="center">35</td>
<td align="center">K00656</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">K01803</td>
<td align="center">36</td>
<td align="center">K04020</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">K00150</td>
<td align="center">37</td>
<td align="center">K00625</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">K00134</td>
<td align="center">38</td>
<td align="center">K00925</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">K00927</td>
<td align="center">39</td>
<td align="center">K00626</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">K00131</td>
<td align="center">40</td>
<td align="center">K01034/K01035</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">K01834</td>
<td align="center">41</td>
<td align="center">K00634</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">K01689</td>
<td align="center">42</td>
<td align="center">K00929</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">K00036</td>
<td align="center">43</td>
<td align="center">K01574</td>
</tr>
<tr>
<td align="center">13</td>
<td align="center">K01057</td>
<td align="center">44</td>
<td align="center">K01938/K00288/K01491</td>
</tr>
<tr>
<td align="center">14</td>
<td align="center">K07404</td>
<td align="center">45</td>
<td align="center">K00297</td>
</tr>
<tr>
<td align="center">15</td>
<td align="center">K01690</td>
<td align="center">46</td>
<td align="center">K00004/K03366</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">K00874</td>
<td align="center">47</td>
<td align="center">K00016</td>
</tr>
<tr>
<td align="center">17</td>
<td align="center">K00041</td>
<td align="center">48</td>
<td align="center">K01847</td>
</tr>
<tr>
<td align="center">18</td>
<td align="center">K01685</td>
<td align="center">49</td>
<td align="center">K01848/K01849</td>
</tr>
<tr>
<td align="center">19</td>
<td align="center">K00883</td>
<td align="center">50</td>
<td align="center">K01026</td>
</tr>
<tr>
<td align="center">20</td>
<td align="center">K00849</td>
<td align="center">51</td>
<td align="center">K00672</td>
</tr>
<tr>
<td align="center">21</td>
<td align="center">K00965</td>
<td align="center">52</td>
<td align="center">K01499</td>
</tr>
<tr>
<td align="center">22</td>
<td align="center">K01818</td>
<td align="center">53</td>
<td align="center">K00319</td>
</tr>
<tr>
<td align="center">23</td>
<td align="center">K00879</td>
<td align="center">54</td>
<td align="center">K13942</td>
</tr>
<tr>
<td align="center">24</td>
<td align="center">K01628</td>
<td align="center">55</td>
<td align="center">K00320</td>
</tr>
<tr>
<td align="center">25</td>
<td align="center">K01813</td>
<td align="center">56</td>
<td align="center">K00577/578/…/584</td>
</tr>
<tr>
<td align="center">26</td>
<td align="center">K01804</td>
<td align="center">57</td>
<td align="center">K00399/K00401/K00402</td>
</tr>
<tr>
<td align="center">27</td>
<td align="center">K01786</td>
<td align="center">58</td>
<td align="center">K01699/K13919/K13920</td>
</tr>
<tr>
<td align="center">28</td>
<td align="center">K03077</td>
<td align="center">59</td>
<td align="center">K13922</td>
</tr>
<tr>
<td align="center">29</td>
<td align="center">K03080</td>
<td align="center">60</td>
<td align="center">K13788</td>
</tr>
<tr>
<td align="center">30</td>
<td align="center">K00854</td>
<td align="center">61</td>
<td align="center">K15024</td>
</tr>
<tr>
<td align="center">31</td>
<td align="center">K01621</td>
<td align="center"/>
<td align="center"/>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pcbi.1005252.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.t003</object-id>
<label>Table 3</label>
<caption>
<title>List of the 43 selected metabolites.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005252.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Metabolite</th>
<th align="center">Abbreviation</th>
<th align="center">Status</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Acetate</td>
<td align="center">Ace</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">Acetone</td>
<td align="center">Acn</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">Butanediol</td>
<td align="center">Bud</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">Butanoate</td>
<td align="center">But</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">D-galacturonate</td>
<td align="center">D-Ga</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">D-Xylose</td>
<td align="center">D-Xy</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">Formate</td>
<td align="center">For</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">Fructose</td>
<td align="center">Fru</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">Galactose</td>
<td align="center">Gal</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">Glucose</td>
<td align="center">Glu</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">Lactate</td>
<td align="center">Lac</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">L-Arabinose</td>
<td align="center">L-Ar</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">L-Fucose</td>
<td align="center">L-Fu</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">L-Lactaldehyde</td>
<td align="center">L-la</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">L-Rhamnose</td>
<td align="center">L-Rh</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">Mannose</td>
<td align="center">Man</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">Methane</td>
<td align="center">Met</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">Propanoate</td>
<td align="center">Pro</td>
<td align="center">Extracellular</td>
</tr>
<tr>
<td align="center">10-Formyltetrahydrofolate</td>
<td align="center">10-FTHF</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">2-Dehydro-3-deoxy-D-gluconate</td>
<td align="center">2-D3DDG</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">5,10-Methenyltetrahydromethanopterin</td>
<td align="center">5,10Ml</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">5,10-Methylenetetrahydromethanopterin</td>
<td align="center">5,10M</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">5-Formyl-5,6,7,8-tetrahydromethanopterin</td>
<td align="center">5-FTHM</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">5-Methyl-5,6,7,8-tetrahydromethanopterin</td>
<td align="center">5M</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Acetoacetyl-CoA</td>
<td align="center">ActCoA</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Acetyl phosphate</td>
<td align="center">AcP</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Acetyl-CoA</td>
<td align="center">ACoA</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Butanoyl phosphate</td>
<td align="center">BuP</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">D-Altronate</td>
<td align="center">D-Al</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">D-Gluconate 6-phosphate</td>
<td align="center">D-Gl6P</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">D-Glucono-1,5-lactone 6-phosphate</td>
<td align="center">D-Glu</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Dihydroxyacetone phosphate</td>
<td align="center">GlP</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Galactose 1-phosphate</td>
<td align="center">Ga1P</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Glyceraldehyde 3-phosphate</td>
<td align="center">D-G3P</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Glycerate 2-phosphate</td>
<td align="center">Gc2P</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Glycerate 3-phosphate</td>
<td align="center">Gc3P</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Glycerate1,3 di-phosphate</td>
<td align="center">D-G3P2</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">L-Fuculose</td>
<td align="center">L-Fcl</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">L-Fuculose 1-phosphate</td>
<td align="center">L-F1P</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">L-Ribulose</td>
<td align="center">L-Ri</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Methyl-CoM</td>
<td align="center">MCoM</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Propane 1,2-diol</td>
<td align="center">Pro-2d</td>
<td align="center">Intracellular</td>
</tr>
<tr>
<td align="center">Pyruvate</td>
<td align="center">Pyr</td>
<td align="center">Intracellular</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>For each of the 25 intracellular metabolites, the constraints were calibrated using 190 core gut microbial genomes (see <xref ref-type="sec" rid="sec015">Materials and Methods</xref>). Both constraints <xref ref-type="disp-formula" rid="pcbi.1005252.e006">(6)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005252.e007">(7)</xref> were implemented together on the functional markers associated to the production and consumption of 17 intracellular metabolites, only one of them on 4 intracellular metabolites, resulting in 38 constraints. The functional markers associated to the production and consumption of the remainig 4 metabolites, namely D-Gluconate 6-phosphate, D-Glucono-1,5-lactone 6-phosphate, L-Fuculose 1-phosphate and Propane 1,2-diol were left unconstrained. The details of the constraints are given in <xref ref-type="table" rid="pcbi.1005252.t004">Table 4</xref>. We assessed the sensitivity of the inference procedure to the thresholds used to define the constraints and observed a moderate sensitivity (see <xref ref-type="sec" rid="sec015">Materials and Methods</xref> for more details). The overall data generation process and the graph building procedure are detailed in section Materials and Methods.</p>
<table-wrap id="pcbi.1005252.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.t004</object-id>
<label>Table 4</label>
<caption>
<title>Constraints on the functional markers associated to the production and consumption of intracellular metabolites in the catabolic pathway from simple sugars to SCFA and methane.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005252.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Metabolite</th>
<th align="center"><italic>δ</italic><sub>1,<italic>m</italic></sub> in <xref ref-type="disp-formula" rid="pcbi.1005252.e006">Eq (6)</xref></th>
<th align="center"><italic>δ</italic><sub>2,<italic>m</italic></sub> in <xref ref-type="disp-formula" rid="pcbi.1005252.e007">Eq (7)</xref></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">10-Formyltetrahydrofolate</td>
<td align="center">5</td>
<td align="center">20</td>
</tr>
<tr>
<td align="center">2-Dehydro-3-deoxy-D-gluconate</td>
<td align="center">5</td>
<td align="center">–</td>
</tr>
<tr>
<td align="center">5,10-Methenyltetrahydromethanopterin</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">5,10-Methylenetetrahydromethanopterin</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">5-Formyl-5,6,7,8-tetrahydromethanopterin</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">Methyl-CoM</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">5-Methyl-5,6,7,8-tetrahydromethanopterin</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">Acetoacetyl-CoA</td>
<td align="center">–</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">Acetyl-CoA</td>
<td align="center">20</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">Acetyl phosphate</td>
<td align="center">10</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">Butanoyl phosphate</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">D-Altronate</td>
<td align="center">10</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">D-Gluconate 6-phosphate</td>
<td align="center">–</td>
<td align="center">–</td>
</tr>
<tr>
<td align="center">Glycerate1,3 di-phosphate</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">Glyceraldehyde 3-phosphate</td>
<td align="center">30</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">D-Glucono-1,5-lactone 6-phosphate</td>
<td align="center">–</td>
<td align="center">–</td>
</tr>
<tr>
<td align="center">Galactose 1-phosphate</td>
<td align="center">–</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">Glycerate 2-phosphate</td>
<td align="center">15</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">Dihydroxyacetone phosphate</td>
<td align="center">10</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">Glycerate 3-phosphate</td>
<td align="center">10</td>
<td align="center">15</td>
</tr>
<tr>
<td align="center">L-Fuculose</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">L-Fuculose 1-phosphate</td>
<td align="center">–</td>
<td align="center">–</td>
</tr>
<tr>
<td align="center">L-Ribulose</td>
<td align="center">5</td>
<td align="center">–</td>
</tr>
<tr>
<td align="center">Propane 1,2-diol</td>
<td align="center">–</td>
<td align="center">–</td>
</tr>
<tr>
<td align="center">Pyruvate</td>
<td align="center">5</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec011">
<title>Parameter selection</title>
<p>In order to select the optimal values of the parameters <italic>α</italic> and <italic>k</italic>, the concordance index between matrices <italic>H</italic> computed on 40 random splits of the data, the reconstruction error and the 10-fold bi-cross-validation error were computed on a grid of parameters, following the procedure presented in Material and Methods. We present here the selection of the number <italic>k</italic> of CAFTs, and the details for <italic>α</italic> are given in Supplementary. The profiles of the three criteria as a function of the regularization parameter <italic>α</italic> are displayed in <xref ref-type="supplementary-material" rid="pcbi.1005252.s003">S3 Text</xref>, for various numbers of CAFTs <italic>k</italic>; the value <italic>α</italic> = 0.031 was selected. <xref ref-type="fig" rid="pcbi.1005252.g005">Fig 5</xref> displays the three criteria as a function of <italic>k</italic> for the selected value of <italic>α</italic>. The reconstruction error curve undergoes two changes of slope for <italic>k</italic> = 4 and 6. The profile of the concordance of <italic>H</italic> ensures a good reproducibility of the trait matrix <italic>H</italic> when less than 4 CAFTs are considered. Moreover, the bi-cross-validation error displays a significant decrease until 4 CAFTs, and a more moderate one for larger values of <italic>k</italic>; besides, the variations as <italic>k</italic> increases are globally weak with respect to the range of values over the splits. In the context of our analysis, in which the main focus is the inference of metabolic traits shared by all samples, the value <italic>k</italic> = 4 was chosen.</p>
<fig id="pcbi.1005252.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Fiber digestion in the human gut: selection of the number of CAFTs <italic>k</italic>.</title>
<p>The profiles of the three criteria as a function of <italic>k</italic> for the selected value of <italic>α</italic> = 0.031 are displayed. <bold>(A)</bold> Reconstruction error; <bold>(B)</bold> 10-fold bi-cross validation error; <bold>(C)</bold> Concordance of <italic>H</italic> over repeated splits of the sets of samples. In <bold>(B)</bold> and <bold>(C)</bold> the value of the criterion for each split as well as the median are shown.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Analysis of the weight matrix <italic>W</italic>*</title>
<p>The constrained NMF decomposition may be looked at as a dimension reduction analysis, where biological samples originally characterized by their abundances in 86 functional markers are described by their abundances in the 4 CAFTs displayed in the matrix <italic>W</italic>*. We checked that the information on biological samples carried out by <italic>A</italic> was well preserved in <italic>W</italic>*. First of all, the row sums of <italic>A</italic> quantify the proportion of genes devoted to the 86 fiber digestion reactions in each biological sample; they vary between 0.8% and 1.9% across the 1408 samples. <xref ref-type="fig" rid="pcbi.1005252.g006">Fig 6(A)</xref> shows that this proportion is highly correlated to the the total abundance in the 4 CAFTs characterized as the row sums of <italic>W</italic>* <italic>H</italic>* (Pearson correlation 0.91). Thus, the individual variability of the proportion of fiber digestion related genes is properly recovered by the NMF decomposition.</p>
<fig id="pcbi.1005252.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Fiber digestion in the human gut: analysis of <italic>W</italic>*.</title>
<p><bold>(A)</bold> For each biological sample, the total abundances in the 4 CAFTs (row sums of <italic>W</italic>* <italic>H</italic>*) is displayed as a function of the proportion of the 86 fiber digestion reactions in the metagenome (row sums of <italic>A</italic>). <bold>(B)</bold> For each sample, the vector of distances to the other samples is computed from the rows of <italic>A</italic> and of <italic>W</italic>* respectively; the histogram of Pearson correlations between theses two distance vectors for the 1408 biological samples is displayed.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.g006" xlink:type="simple"/>
</fig>
<p>Moreover, the two-by-two distances between the rows of <italic>A</italic> characterize the geometric structure of the biological sample population with respect to fiber digestion mechanisms. A similar geometric structure is defined by the rows of <italic>W</italic>*. We compared the distances of each sample to the others, respectively in <italic>A</italic> and in <italic>W</italic>* with Pearson correlation. The histogram of these correlations for the 1408 samples points out that all correlations are larger than 0.7, and that 99% are larger than 0.85, which indicates that the similarities between biological samples is well preserved in the reduced spaced induced by the NMF decomposition (<xref ref-type="fig" rid="pcbi.1005252.g006">Fig 6(B)</xref>).</p>
</sec>
<sec id="sec013">
<title>The CAFTs form coherent pathways</title>
<p>The columns of <italic>H</italic>* provide the composition of CAFTs. As an example, we detail here one of the CAFT presented in <xref ref-type="fig" rid="pcbi.1005252.g007">Fig 7</xref>. The 3 main genes encoding for enzyme involved in fibers hydrolysis are Glycosyl hydrolases GH13, GH16 and GH127 (<xref ref-type="fig" rid="pcbi.1005252.g007">Fig 7</xref>, GH table). The GH13 family is an alpha-amylase, widely represented in human intestinal microorganisms, processing resistant starch and glucose-based polysaccharides. GH16 family members are involved in the breakdown of galactose and glucose based polymers. GH127 (EC 3.2.1.185) family are arabinofuranosidases. A less abundant gene encodes for GH3 enzyme family, broadly present in micro-organisms and performing diversity of functions such as xylanase, glucosidase and arabinofuranosidase. Consistently with the above sugars released from the fiber breakdown (glucose, xylose, galactose, arabinose), the main fermentation substrates are glucose (reactions 4, 3, 31), fucose (22), D-xylose (30) and to a less extent, galactose (19). Fermentation further proceeds through the Emben-Meyerhoff-Parnas pathway to pyruvate, yielding the end products short chain fatty acids, mostly acetate, butyrate (which are the main SCFA measured in healthy human fecal samples [<xref ref-type="bibr" rid="pcbi.1005252.ref031">31</xref>]). Another major end product is lactaldehyde, resulting from the fermentation of fucose.</p>
<fig id="pcbi.1005252.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.g007</object-id>
<label>Fig 7</label>
<caption>
<title>An example of CAFT.</title>
<p>The first 61 coordinates of the functional marker frequency vector given by the first line of <italic>H</italic>*, associated to simple sugar fermentation, is represented on the reaction graph. The color scale represents percentages of the maximum coordinate among the 61 (reaction 7). The reactions form coherent pathways. The 25 coordinates associated with hydrolysis are presented in the table on the right. The numbers indicate GH families the color are scaled as percentages of the maximum coordinate among the 25 (<italic>GH</italic>13).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.g007" xlink:type="simple"/>
</fig>
<p>The hydrogenotrophic production of methane from H<sub>2</sub> and CO<sub>2</sub> is obtained (reactions 52 to 57). This production of methane from CO<sub>2</sub> (KEGG pathway module M00567) is only restricted to hydrogenotrophic methanogens, known to be present in more than 50% of human adult population [<xref ref-type="bibr" rid="pcbi.1005252.ref032">32</xref>].</p>
</sec>
</sec>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>We presented a new NMF based approach to investigate metabolic processes in microbial ecosystems using quantitative metagenomic data. As mentioned in the introduction, NMF techniques were previously used as a “soft” clustering tool to compare samples from various ecosystems, ranging from marine environment to human body ([<xref ref-type="bibr" rid="pcbi.1005252.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005252.ref016">16</xref>], [<xref ref-type="bibr" rid="pcbi.1005252.ref017">17</xref>]). However, our work focused on different aspects of NMF. Rather than clustering biological samples, we aimed at extracting biologically relevant features associated to a metabolic process, based on ecological modelling. Therefore our main interest, from the mathematical point of view, was the inference of a biologically interpretable trait matrix <italic>H</italic> rather than sample analysis through the weight matrix <italic>W</italic>.</p>
<p>We proposed to model the functional diversity of an habitat-specific microbial ecosystem as a mixture of contributions from subcommunities, each characterized by a profile of functional marker frequencies. These profiles were named Combined Aggregated Functional Traits in reference to [<xref ref-type="bibr" rid="pcbi.1005252.ref010">10</xref>], since they are measured at the community level from a random sample of microorganisms, regardless of their taxonomic identities. More precisely they result from both a combination of functional markers to form coherent and operative metabolic pathways, and an aggregation of individuals to form a subcommunity characterized by this trait.</p>
<p>Our main contribution was the design of a novel constrained NMF model for CAFT inference. Standard NMF approaches were popularised for biological data analysis mainly because usual dimension reduction techniques such as truncated Singular Value Decomposition (SVD), or the closely related Principal Componant Analysis (PCA) often lead to negative coefficients, which do not offer straightforward interpretations. However, while SVD or PCA provide a unique and well defined reduced dataset, optimal in the <italic>ℓ</italic><sup>2</sup>-error sense, NMF is an intrinsically ill-posed problem with multiple solutions. Imposing constraints reflecting biological knowledge greatly helps to select a relevant solution. This was illustrated through the toy example in <xref ref-type="fig" rid="pcbi.1005252.g003">Fig 3</xref>, where both constrained and unconstrained NMF provided solutions leading to the same reconstructed data. However, only the constraints allow the solution that makes biological sense to be picked.</p>
<p>Our approach is in essence Bayesian, and aims at taking advantage of prior information, when available, to explore the data. We proposed a method that exploits knowledge about the genomic structure and metabolism to build relevant constraints. Genes frequencies are not randomly distributed in the metagenome and result from metabolic association encoded in microbial genomes. Thus, constraints resulting from this metabolic structuration scale up at the community level and should be accounted for in the determination of CAFT. We designed local constraints, only involving adjacent functional markers in the graph representation of the metabolic process. Hence the constraints are not strongly restrictive and still leave a considerable freedom in assembling reactions to build the CAFT matrix, without ever forcing hard reconstruction of pathways.</p>
<p>Our method is flexible since it allows imposing constraints only on parts of the metabolic process where biological knowledge is available and considered reliable. Moreover, it could be easily adapted to include other types of prior informations than the one we considered. For instance it should be possible, in contexts where more prior information is available, to design constraints on the weight matrix <italic>W</italic>, as proposed in [<xref ref-type="bibr" rid="pcbi.1005252.ref018">18</xref>] for microarray data analysis.</p>
<p>We considered a new approach for selecting the number of CAFTs, based on biological reproducibility instead of the numerical stability usually considered in literature. We proposed a criterion which evaluates the concordance between CAFTs computed on independent data sets, and combined it with classical procedures.</p>
<p>We implemented our approach on metagenes abundances from 1408 samples of the human gut microbiota, in order to determine CAFTs associated to fiber degradation in the distal gut. Fiber degradation was chosen because it is a major function of the gut microbial ecosystem. It involves the anaerobic fermentation of simple sugar which has been largely documented in the literature, allowing the design of constraints related to this step. The constraints were built by selecting 190 reference microbial genomes from prevalent species of the human gut microbiome, for which marker genes of anaerobic fermentation were annotated. This involved manual curation and relied on both state of the art knowledge of metabolism and accuracy of available annotations. We proposed an approach to account for missing information. In particular, genes were missing in pathways where they were expected to be present, which could be explained by annotation errors, or by the presence of alternative pathways undocumented in the literature. It could also come from unmodelled pathways, not related to fermentation, but sharing some common steps. Then, constraining missing genes markers would be an error. Our approach carefully took into account annotation, modelling and knowledge based errors by adjusting the constraints.</p>
<p>We found that our ecological model of CAFTs was consistent with the data, and that the metagenomic potential for fiber degradation by the human gut microbiota could be interpreted as a mixture of 4 CAFTs, shared by all samples in variable proportions. The CAFT detailed in the Results section is the one including the genes involved in methane production, which can be detected in 50% of a healthy population through a breath test. As a matter of fact, none of the three other CAFTs showed a high frequency of this set of genes responsible for the conversion of H<sub>2</sub> and CO<sub>2</sub> to methane. Two of them are prevalent among individuals, characterized by their richness in terms of GH and fermentation pathways. They differ slightly in GH repertoire and downstream fermentation genes, which may be linked to dietary habits. Finally a fourth profile, less prevalent among samples, might be more represented in diseased individuals. This data reduction highlighted biologically consistent functional patterns while providing a high quality preservation of the original data.</p>
<p>Provided that prior knowledge is available, the generic framework we designed can be applied to other metabolic processes in the gut or in other ecosystems. By acknowledging fundamental data structuration our approach enables the inference of meaningful functional traits.</p>
</sec>
<sec id="sec015" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec016">
<title>Metagenomic data processing</title>
<sec id="sec017">
<title>Data and gene frequencies</title>
<p>1408 human faeces samples originating from 8 studies [<xref ref-type="bibr" rid="pcbi.1005252.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005252.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1005252.ref027">27</xref>] were exploited, covering several health status (Healthy, Crohn Disease, Ulcerative Colitis, Diabetes, Obesity) in donor groups from USA, Denmark, Spain, China and France.</p>
<p>The publicly released Integrated Gene Catalog (IGC) of 9.9 million genes from [<xref ref-type="bibr" rid="pcbi.1005252.ref021">21</xref>] was used to obtain counts, abundances and frequencies following the procedure described in [<xref ref-type="bibr" rid="pcbi.1005252.ref021">21</xref>] and [<xref ref-type="bibr" rid="pcbi.1005252.ref024">24</xref>].</p>
</sec>
<sec id="sec018">
<title>Annotation</title>
<p>In order to obtain Glycosides Hydrolases (GH) and Pectines Lyases (PL) frequencies, we used Hmmer tool (<ext-link ext-link-type="uri" xlink:href="http://hmmer.org/" xlink:type="simple">http://hmmer.org/</ext-link>) and dbCan version3 [<xref ref-type="bibr" rid="pcbi.1005252.ref033">33</xref>] with default parameters. We first assessed dbCan annotation quality on 145 protein sequences for which a cazy annotation was available (<ext-link ext-link-type="uri" xlink:href="http://www.cazy.org/" xlink:type="simple">http://www.cazy.org/</ext-link>) [<xref ref-type="bibr" rid="pcbi.1005252.ref034">34</xref>]. Similarity between annotation was evaluated by considering annotation from [<xref ref-type="bibr" rid="pcbi.1005252.ref034">34</xref>] as true and calculating accuracy. False positives mainly corresponded to Carbohydrate-binding modules, which we did not consider in this study. By ignoring them, we found an accuracy greater than 98%. As the results were good, the whole IGC was annotated, using the following rules in case of overlapping annotations, that is regions in an IGC gene sequence matching several GH or PL families: (1) if the size of the overlapping region did not exceed 10% of the smallest matched module size the overlap was ignored (2) otherwise, if the worst e-value between two overlapping annotations was 100 times smaller than the other, the corresponding annotation was rejected (3) in any other overlap situation both annotations were considered as erroneous and discarded. Regarding KO, we used the pre-existing KO annotation of the IGC, so that in the absence of any information on overlaps, the frequencies of genes with multiple KO annotations were dispatched in equal parts on each KO.</p>
<p>For each GH, PL and KO, the frequencies of all genes with the corresponding annotation were summed to obtain a global frequency.</p>
</sec>
<sec id="sec019">
<title>Markers of fiber degradation in the human gut microbiota</title>
<p>We selected 25 GH and PL relevant to the human gut microbiota, involved in the degradation of dietary fiber such as cellulose, hemicellulose, starch and pectin [<xref ref-type="bibr" rid="pcbi.1005252.ref035">35</xref>]. The pathways involved in the anaerobic degradation and fermentation of sugars resulting from the hydrolysis of fiber are well characterized. They were identified using bibliographic resources [<xref ref-type="bibr" rid="pcbi.1005252.ref036">36</xref>] and Metacyc database [<xref ref-type="bibr" rid="pcbi.1005252.ref037">37</xref>] guided by expertise. Pathways exclusively associated to microorganisms unlikely present in the gut (e.g. soil microorganisms or extremophils) were excluded. A list of putative reactions and associated KO was compiled from the selected pathways using KEGG database, filtered according the following rules: (1) when a KO was not found in the IGC annotation it was ignored, (2) when a reaction could not be linked to a KO, it was ignored, (3) when the enzyme from a KO could catalyze more than one reaction, preventing from accurately linking the KO frequency to a unique target reaction, this KO was discarded as well as any other KO that could catalyze this reaction. Since rule (3) is stringent, a few KO able to catalyze several reactions were not discarded, but only when these additional reactions (and the associated pathway) were highly unlikely present in the gut microbiota (see <xref ref-type="supplementary-material" rid="pcbi.1005252.s007">S1 Table</xref>).</p>
<p>Some reactions were associated with multiple KO corresponding to either different enzymes catalyzing the same chemical reaction or parts of the same enzyme. In the first situation, each KO was considered as a functional marker, in the second situation the corresponding KO were merged into a unique marker whose frequency was set to the mean of the KO frequencies.</p>
<p>A final list of 86 functional markers characterizing the fiber degradation process in the human gut microbiome was obtained, comprising 25 GH and PL and 61 KO or KO aggregations (see <xref ref-type="supplementary-material" rid="pcbi.1005252.s007">S1 Table</xref>). The data matrix <italic>A</italic> was built from those 86 markers frequencies for the 1408 samples (see <xref ref-type="supplementary-material" rid="pcbi.1005252.s004">S1 tsv File</xref>).</p>
</sec>
</sec>
<sec id="sec020">
<title>Building the linear constraint from pathway prior knowledge</title>
<sec id="sec021">
<title>General principles for constraint building</title>
<p>Considering a microorganism <italic>x</italic> in the ecosystem, we denote <italic>n</italic><sub><italic>xj</italic></sub> the number of functional markers <italic>j</italic> in its genome. Moreover, for each intracellular metabolite <italic>m</italic>, we denote by <italic>P</italic><sub><italic>m</italic></sub> the set of indexes of functional makers involved in reactions producing <italic>m</italic>, and <italic>C</italic><sub><italic>m</italic></sub> the set of indexes of functional makers involved in reactions consuming <italic>m</italic>. Then <inline-formula id="pcbi.1005252.e029"><alternatives><graphic id="pcbi.1005252.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:mo>=</mml:mo> <mml:mtext> </mml:mtext> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> <italic>n</italic><sub><italic>xj</italic></sub> is the number of markers associated to the production of metabolite <italic>m</italic> in the genome of <italic>x</italic>, and <inline-formula id="pcbi.1005252.e030"><alternatives><graphic id="pcbi.1005252.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:mo>=</mml:mo> <mml:mtext> </mml:mtext> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>′</mml:mo> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> <italic>n</italic><sub><italic>xj</italic>′</sub> denotes the number of markers associated to the consumption of <italic>m</italic>.</p>
<p>If <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> is positive, we can define the ratio <italic>δ</italic><sub>1,<italic>x</italic>,<italic>m</italic></sub> = <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub>/<italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub>, so that the following equality holds
<disp-formula id="pcbi.1005252.e031"><alternatives><graphic id="pcbi.1005252.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
and in the same way, if <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> is positive, we can define <italic>δ</italic><sub>2,<italic>x</italic>,<italic>m</italic></sub> = <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub>/<italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub>, and write
<disp-formula id="pcbi.1005252.e032"><alternatives><graphic id="pcbi.1005252.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
If <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> and <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> are both zero, we arbitrarily set <italic>δ</italic><sub>1,<italic>x</italic>,<italic>m</italic></sub> = <italic>δ</italic><sub>2,<italic>x</italic>,<italic>m</italic></sub> = 0 and both Eqs <xref ref-type="disp-formula" rid="pcbi.1005252.e031">(11)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005252.e032">(12)</xref> hold.</p>
<p>By definition, a CAFT <italic>l</italic> characterizes a gene pattern associated in each sample <italic>i</italic> to a subcommunity <italic>C</italic><sub><italic>il</italic></sub> in which the total abundance of any functional marker <italic>j</italic> is proportional to <italic>h</italic><sub><italic>lj</italic></sub>, namely
<disp-formula id="pcbi.1005252.e033"><alternatives><graphic id="pcbi.1005252.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
Therefore, for all <italic>m</italic>, <inline-formula id="pcbi.1005252.e034"><alternatives><graphic id="pcbi.1005252.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:mo>=</mml:mo> <mml:mtext> </mml:mtext> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e035"><alternatives><graphic id="pcbi.1005252.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:mo>=</mml:mo> <mml:mtext> </mml:mtext> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Consider now a metabolite <italic>m</italic> for which <xref ref-type="disp-formula" rid="pcbi.1005252.e031">Eq (11)</xref> holds for all microorganisms <italic>x</italic> in the ecosystem, and define <italic>δ</italic><sub>1,<italic>m</italic></sub> = max<sub><italic>x</italic></sub> <italic>δ</italic><sub>1,<italic>x</italic>,<italic>m</italic></sub>. Therefore <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> ≤ <italic>δ</italic><sub>1,<italic>m</italic></sub> <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> and for each CAFT <italic>l</italic>, <italic>h</italic><sub><italic>l</italic></sub> satisfies
<disp-formula id="pcbi.1005252.e036"><alternatives><graphic id="pcbi.1005252.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
In the same way, if we consider a metabolite <italic>m</italic> for which <xref ref-type="disp-formula" rid="pcbi.1005252.e032">Eq (12)</xref> holds for all microorganisms <italic>x</italic> in the ecosystem, each CAFT <italic>l</italic> satisfies
<disp-formula id="pcbi.1005252.e037"><alternatives><graphic id="pcbi.1005252.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula>
where <italic>δ</italic><sub>2,<italic>m</italic></sub> = max<sub><italic>x</italic></sub> <italic>δ</italic><sub>2,<italic>x</italic>,<italic>m</italic></sub>.</p>
<p>In practice, for complex microbial ecosystems, it is not possible to compute the values of <italic>δ</italic><sub>1,<italic>m</italic></sub> and <italic>δ</italic><sub>2,<italic>m</italic></sub>, since no exhaustive knowledge about the microorganisms that are present and their genomes is available. However it is possible to propose sensible values that can be used in Eqs <xref ref-type="disp-formula" rid="pcbi.1005252.e036">(14)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005252.e037">(15)</xref>, as shown below in the case of fiber degradation by the gut ecosystem.</p>
<p>For a convenient implementation of the constraints, we built a graph representing the structure of the reactions under consideration, in which each vertex is a metabolite and each edge is directed and corresponds to a functional marker associated to a reaction. We built a <italic>m</italic><sub><italic>int</italic></sub> × <italic>r</italic> matrix <italic>Q</italic> derived from the incidence matrix of the graph. For each intracellular metabolite <italic>m</italic> and each functional marker <italic>j</italic>, <italic>q</italic><sub><italic>mj</italic></sub> = 1 (resp. <italic>q</italic><sub><italic>mj</italic></sub> = −1) if the reaction associated with functional marker <italic>j</italic> produces (resp. consumes) metabolite <italic>m</italic>, and <italic>q</italic><sub><italic>mj</italic></sub> = 0 otherwise. Thus, columns corresponding to functional markers not included in the graph are equal to zero. The matrix <italic>Q</italic> was split as <italic>Q</italic> = <italic>Q</italic><sup>+</sup> − <italic>Q</italic><sup>−</sup>, where <italic>Q</italic><sup>+</sup> contains the positive terms in <italic>Q</italic> and <italic>Q</italic><sup>−</sup> the absolute value of the negative ones. Note that
<disp-formula id="pcbi.1005252.e038"><alternatives><graphic id="pcbi.1005252.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>q</mml:mi> <mml:mi>m</mml:mi> <mml:mo>+</mml:mo></mml:msubsup> <mml:msub><mml:mi>h</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mspace width="1.em"/><mml:mtext>and</mml:mtext> <mml:mspace width="1.em"/><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>q</mml:mi> <mml:mi>m</mml:mi> <mml:mo>-</mml:mo></mml:msubsup> <mml:msub><mml:mi>h</mml:mi> <mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1005252.e039"><alternatives><graphic id="pcbi.1005252.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mi>q</mml:mi> <mml:mi>m</mml:mi> <mml:mo>+</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e040"><alternatives><graphic id="pcbi.1005252.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msubsup><mml:mi>q</mml:mi> <mml:mi>m</mml:mi> <mml:mo>−</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> respectively denote the <italic>m</italic><sup><italic>th</italic></sup> line of <italic>Q</italic><sup>+</sup> and <italic>Q</italic><sup>−</sup>.</p>
<p>We define <italic>M</italic><sub>1</sub> and <italic>M</italic><sub>2</sub> as the two sets of intracellular metabolites for which constraints <xref ref-type="disp-formula" rid="pcbi.1005252.e036">(14)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005252.e037">(15)</xref> respectively apply. The rows corresponding to sets <italic>M</italic><sub>1</sub> and <italic>M</italic><sub>2</sub> were extracted from <italic>Q</italic><sup>+</sup> and <italic>Q</italic><sup>−</sup> and four sub-matrices <inline-formula id="pcbi.1005252.e041"><alternatives><graphic id="pcbi.1005252.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mi>i</mml:mi> <mml:mo>+</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e042"><alternatives><graphic id="pcbi.1005252.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mi>i</mml:mi> <mml:mo>−</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> for <italic>i</italic> = 1, 2 were built. Then constraints <xref ref-type="disp-formula" rid="pcbi.1005252.e036">(14)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005252.e037">(15)</xref> were formulated as
<disp-formula id="pcbi.1005252.e043"><alternatives><graphic id="pcbi.1005252.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mo>Δ</mml:mo></mml:msub> <mml:msup><mml:mi>H</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:mfenced close=")" open="("><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi> <mml:mn>2</mml:mn> <mml:mo>-</mml:mo></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mn>2</mml:mn> <mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msup><mml:mi>H</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>≤</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula>
where Δ<sub>1</sub> and Δ<sub>2</sub> were diagonal matrices with diagonal entries <italic>δ</italic><sub>1,<italic>m</italic></sub> and <italic>δ</italic><sub>2,<italic>m</italic></sub> for <italic>m</italic> in <italic>M</italic><sub>1</sub> and <italic>M</italic><sub>2</sub> respectively.</p>
</sec>
<sec id="sec022">
<title>Constraint building for fiber degradation by the gut microbiota</title>
<p>We considered two types of functional markers, GH/PL for fiber degradation into simple sugars and KO for anaerobic fermentation of simple sugars. While precise information is available for anaerobic fermentation, the GH/PL families are not substrate specific, thus although they are essential in the fiber degradation process, they could not be included in a reaction graph. Based on the KO only, we built an oriented graph from simple sugars to SCFA. Edge orientation represents the biological catabolic pathway from simple sugars to SCFA and methane. During the KO selection process, several KO did not pass the specificity criterion and were discarded, preventing fully continuous pathways from sugars to short chained fatty acids and simplifications were introduced in order to build a connected graph. We finally obtained a graph with 43 nodes corresponding to metabolites (see <xref ref-type="table" rid="pcbi.1005252.t001">Table 1</xref> for their complete and abbreviated names) and <italic>r</italic><sub>1</sub> = 61 edges corresponding to the selected KO (see <xref ref-type="table" rid="pcbi.1005252.t002">Table 2</xref>). The metabolites were divided into <italic>m</italic><sub><italic>int</italic></sub> = 25 intracellular and <italic>m</italic><sub><italic>ext</italic></sub> = 18 extracellular ones. A summary of simplification, selected metabolites and KO is available in <xref ref-type="supplementary-material" rid="pcbi.1005252.s007">S1 Table</xref>. The list of selected GH/PL is provided in <xref ref-type="table" rid="pcbi.1005252.t003">Table 3</xref>.</p>
<p>Approximate values for the entries of Δ<sub>1</sub> and Δ<sub>2</sub> were computed by screening 190 core genomes (see <xref ref-type="supplementary-material" rid="pcbi.1005252.s005">S2 tsv File</xref>) chosen from [<xref ref-type="bibr" rid="pcbi.1005252.ref022">22</xref>] and [<xref ref-type="bibr" rid="pcbi.1005252.ref038">38</xref>], which were annotated using blast on Kegg Orthologies with a bitscore threshold of 60. The number of copies of the <italic>r</italic> selected markers for each genome were gathered in a 190 × <italic>r</italic> matrix denoted <italic>G</italic>. We denote <italic>n</italic><sub><italic>x</italic></sub> the <italic>x</italic><sup><italic>th</italic></sup> row of <italic>G</italic> containing the number of copies of the functional markers in genome <italic>x</italic>, so that according to the notations defined above, <inline-formula id="pcbi.1005252.e044"><alternatives><graphic id="pcbi.1005252.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>q</mml:mi> <mml:mi>m</mml:mi> <mml:mo>−</mml:mo></mml:msubsup> <mml:msub><mml:mi>n</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e045"><alternatives><graphic id="pcbi.1005252.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>q</mml:mi> <mml:mi>m</mml:mi> <mml:mo>+</mml:mo></mml:msubsup> <mml:msub><mml:mi>n</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>In order to build an approximated set <inline-formula id="pcbi.1005252.e046"><alternatives><graphic id="pcbi.1005252.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>, we first relaxed the theoretical definition of <italic>M</italic><sub>1</sub> given in the Results section to make it more realistic. Indeed, for a given intracellular metabolite <italic>m</italic>, if there was only a small fraction of genomes <italic>x</italic> such that <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> = 0, we assumed that they could be neglected since we are looking for bounds on markers in aggregated populations.</p>
<p>Then we adopted the following empirical rules:</p>
<list id="list1" list-type="simple">
<list-item>
<label><italic>Rule 1</italic>:</label> <p>If <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0 for more than 95% of the 190 core genomes, meaning that <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> = 0 for 9 genomes or less, then <italic>m</italic> is included in <inline-formula id="pcbi.1005252.e047"><alternatives><graphic id="pcbi.1005252.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<label><italic>Rule 2</italic>:</label> <p>If <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0 for less than 85% of the 190 core genomes, meaning that <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> = 0 for 28 genomes or more, then <italic>m</italic> is not included in <inline-formula id="pcbi.1005252.e048"><alternatives><graphic id="pcbi.1005252.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<label><italic>Rule 3</italic>:</label> <p>If the proportion of genomes for which <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0 is between 85% and 90%, then we check if <italic>m</italic> is specifically involved in anaerobic sugar fermentation, or if it could be involved in other metabolic processes. If no specificity is found, then <italic>m</italic> is not included in <inline-formula id="pcbi.1005252.e049"><alternatives><graphic id="pcbi.1005252.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>, otherwise it is stored in a set <italic>S</italic><sub>1</sub>.</p>
<p>The same rules were applied to build <inline-formula id="pcbi.1005252.e050"><alternatives><graphic id="pcbi.1005252.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and <italic>S</italic><sub>2</sub>, upon replacement of <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> by <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub>.</p>
</list-item>
</list>
<p>An additional selection step was performed according to:</p>
<list continued-from="list1" list-type="simple">
<list-item>
<label><italic>Rule 4</italic>:</label> <p>If <italic>m</italic> ∈ <italic>S</italic><sub>1</sub>∪<italic>S</italic><sub>2</sub>, meaning that either the proportion of genomes for which <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0 or the proportion of genomes for which <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> &gt; 0 is between 85% and 90%, then if <italic>m</italic> ∈ <italic>S</italic><sub>1</sub> and <italic>m</italic> ∉ <italic>S</italic><sub>2</sub> it is included in <inline-formula id="pcbi.1005252.e051"><alternatives><graphic id="pcbi.1005252.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>, if <italic>m</italic> ∈ <italic>S</italic><sub>2</sub> and <italic>m</italic> ∉ <italic>S</italic><sub>1</sub> it is included in <inline-formula id="pcbi.1005252.e052"><alternatives><graphic id="pcbi.1005252.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and if <italic>m</italic> ∈ <italic>S</italic><sub>1</sub> ∩ <italic>S</italic><sub>2</sub> it is neither included in <inline-formula id="pcbi.1005252.e053"><alternatives><graphic id="pcbi.1005252.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> nor in <inline-formula id="pcbi.1005252.e054"><alternatives><graphic id="pcbi.1005252.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>.</p>
</list-item>
</list>
<p>After applying these rules, based on biological expertise, it was additionally considered that the metabolism of the Propane 1,2-diol was not well known and it was neither included in <inline-formula id="pcbi.1005252.e055"><alternatives><graphic id="pcbi.1005252.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> nor in <inline-formula id="pcbi.1005252.e056"><alternatives><graphic id="pcbi.1005252.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula></p>
<p>
<xref ref-type="table" rid="pcbi.1005252.t005">Table 5</xref> summarizes the affectation process of all the intracellular metabolites for which either <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> = 0 or <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> = 0 for 10 genomes or more. All the other metabolites were included both in <inline-formula id="pcbi.1005252.e057"><alternatives><graphic id="pcbi.1005252.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e058"><alternatives><graphic id="pcbi.1005252.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>.</p>
<table-wrap id="pcbi.1005252.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005252.t005</object-id>
<label>Table 5</label>
<caption>
<title>Affectation in <inline-formula id="pcbi.1005252.e059"><alternatives><graphic id="pcbi.1005252.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e060"><alternatives><graphic id="pcbi.1005252.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula> of metabolites for which Rule 1 is false.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005252.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.t005" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Metabolite</th>
<th align="center">Nb genomes s.t.<break/>hypothesis is false</th>
<th align="center">Hypothesis</th>
<th align="center">Membership</th>
<th align="center">Rule</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Acetoacetyl-CoA</td>
<td align="center">34</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e061">
<alternatives>
<graphic id="pcbi.1005252.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e061" xlink:type="simple"/>
<mml:math display="inline" id="M61">
<mml:mrow>
<mml:mo>∉</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>1</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 2</td>
</tr>
<tr>
<td align="center">ButanoylP</td>
<td align="center">28</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e062">
<alternatives>
<graphic id="pcbi.1005252.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e062" xlink:type="simple"/>
<mml:math display="inline" id="M62">
<mml:mrow>
<mml:mo>∈</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>1</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 2</td>
</tr>
<tr>
<td align="center">D-Altronate</td>
<td align="center">10</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e063">
<alternatives>
<graphic id="pcbi.1005252.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e063" xlink:type="simple"/>
<mml:math display="inline" id="M63">
<mml:mrow>
<mml:mo>∈</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>1</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 4</td>
</tr>
<tr>
<td align="center">D-Gluconate6P</td>
<td align="center">12</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e064">
<alternatives>
<graphic id="pcbi.1005252.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e064" xlink:type="simple"/>
<mml:math display="inline" id="M64">
<mml:mrow>
<mml:mo>∉</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>1</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 4</td>
</tr>
<tr>
<td align="center">D-gluconolactone</td>
<td align="center">12</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e065">
<alternatives>
<graphic id="pcbi.1005252.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e065" xlink:type="simple"/>
<mml:math display="inline" id="M65">
<mml:mrow>
<mml:mo>∉</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>1</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 4</td>
</tr>
<tr>
<td align="center">Galactose1P</td>
<td align="center">68</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e066">
<alternatives>
<graphic id="pcbi.1005252.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e066" xlink:type="simple"/>
<mml:math display="inline" id="M66">
<mml:mrow>
<mml:mo>∉</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>1</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 2</td>
</tr>
<tr>
<td align="center">L-Fuculose1P</td>
<td align="center">14</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e067">
<alternatives>
<graphic id="pcbi.1005252.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e067" xlink:type="simple"/>
<mml:math display="inline" id="M67">
<mml:mrow>
<mml:mo>∉</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>1</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 4</td>
</tr>
<tr>
<td align="center">2-D3DDG</td>
<td align="center">89</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e068">
<alternatives>
<graphic id="pcbi.1005252.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e068" xlink:type="simple"/>
<mml:math display="inline" id="M68">
<mml:mrow>
<mml:mo>∉</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 2</td>
</tr>
<tr>
<td align="center">D-Gluconate6P</td>
<td align="center">38</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e069">
<alternatives>
<graphic id="pcbi.1005252.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e069" xlink:type="simple"/>
<mml:math display="inline" id="M69">
<mml:mrow>
<mml:mo>∉</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 4</td>
</tr>
<tr>
<td align="center">D-gluconolactone</td>
<td align="center">24</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e070">
<alternatives>
<graphic id="pcbi.1005252.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e070" xlink:type="simple"/>
<mml:math display="inline" id="M70">
<mml:mrow>
<mml:mo>∉</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 4</td>
</tr>
<tr>
<td align="center">L-Fuculose</td>
<td align="center">17</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e071">
<alternatives>
<graphic id="pcbi.1005252.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e071" xlink:type="simple"/>
<mml:math display="inline" id="M71">
<mml:mrow>
<mml:mo>∈</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 4</td>
</tr>
<tr>
<td align="center">L-Fuculose1P</td>
<td align="center">26</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e072">
<alternatives>
<graphic id="pcbi.1005252.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e072" xlink:type="simple"/>
<mml:math display="inline" id="M72">
<mml:mrow>
<mml:mo>∉</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 4</td>
</tr>
<tr>
<td align="center">L-Ribulose</td>
<td align="center">27</td>
<td align="center"><italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> &gt; 0</td>
<td align="center">
<inline-formula id="pcbi.1005252.e073">
<alternatives>
<graphic id="pcbi.1005252.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e073" xlink:type="simple"/>
<mml:math display="inline" id="M73">
<mml:mrow>
<mml:mo>∉</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Rule 3</td>
</tr>
<tr>
<td align="center">Propanal</td>
<td align="center"/>
<td align="center"/>
<td align="center">
<inline-formula id="pcbi.1005252.e074">
<alternatives>
<graphic id="pcbi.1005252.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e074" xlink:type="simple"/>
<mml:math display="inline" id="M74">
<mml:mrow>
<mml:mo>∉</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>∪</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>M</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">expertise</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Finally, from the initial 25 intracellular metabolites, only 21 were used to generate contraints on the CAFTs. 17 metabolites were included both in <inline-formula id="pcbi.1005252.e075"><alternatives><graphic id="pcbi.1005252.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e076"><alternatives><graphic id="pcbi.1005252.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>, 2 in <inline-formula id="pcbi.1005252.e077"><alternatives><graphic id="pcbi.1005252.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and not in <inline-formula id="pcbi.1005252.e078"><alternatives><graphic id="pcbi.1005252.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and 2 in <inline-formula id="pcbi.1005252.e079"><alternatives><graphic id="pcbi.1005252.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and not in <inline-formula id="pcbi.1005252.e080"><alternatives><graphic id="pcbi.1005252.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>, resulting in a total of 38 constraints.</p>
<p>For each <italic>m</italic> in <inline-formula id="pcbi.1005252.e081"><alternatives><graphic id="pcbi.1005252.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> (resp <inline-formula id="pcbi.1005252.e082"><alternatives><graphic id="pcbi.1005252.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>), we denoted <italic>E</italic><sub><italic>m</italic></sub> (resp <italic>F</italic><sub><italic>m</italic></sub>) the set of genomes <italic>x</italic> such that <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>C</italic></sub> &gt; 0 (resp <italic>N</italic><sub><italic>x</italic>,<italic>m</italic>,<italic>P</italic></sub> &gt; 0). Then we defined
<disp-formula id="pcbi.1005252.e083"><alternatives><graphic id="pcbi.1005252.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e083" xlink:type="simple"/><mml:math display="block" id="M83"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula>
and for each m in <italic>M</italic><sub>2</sub>:
<disp-formula id="pcbi.1005252.e084"><alternatives><graphic id="pcbi.1005252.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e084" xlink:type="simple"/><mml:math display="block" id="M84"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula>
We further chose to define 5 by 5 integer thresholds
<disp-formula id="pcbi.1005252.e085"><alternatives><graphic id="pcbi.1005252.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e085" xlink:type="simple"/><mml:math display="block" id="M85"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>5</mml:mn> <mml:mrow><mml:mo>⌈</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mn>5</mml:mn></mml:mfrac> <mml:mo>⌉</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>5</mml:mn> <mml:mrow><mml:mo>⌈</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>δ</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mn>5</mml:mn></mml:mfrac> <mml:mo>⌉</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
This rounding step is somewhat redundant with the multiplicative factor, in complex situations with many functional markers as here we propose to use it to cluster the constraints by similar order of magnitude, but it may be omitted. <xref ref-type="table" rid="pcbi.1005252.t004">Table 4</xref> displays the values found for each <italic>m</italic>, when relevant.</p>
<p>Finally, <xref ref-type="disp-formula" rid="pcbi.1005252.e043">Eq (16)</xref> represents a set of 38 constraints with entries of Δ<sub>1</sub> and Δ<sub>2</sub> ranging from 5 to 30. The resulting matrix <italic>F</italic><sub>Δ</sub> is given in <xref ref-type="supplementary-material" rid="pcbi.1005252.s006">S3 tsv File</xref>.</p>
</sec>
</sec>
<sec id="sec023">
<title>Inference</title>
<sec id="sec024">
<title>Constrained NMF problem formulation and inference procedure</title>
<p>To take into account discrepancies among reactions, the (<italic>n</italic> × <italic>r</italic>) matrix <italic>A</italic> is scaled per reaction according to the formula
<disp-formula id="pcbi.1005252.e086"><alternatives><graphic id="pcbi.1005252.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e086" xlink:type="simple"/><mml:math display="block" id="M86"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msqrt><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mi>a</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(17)</label></disp-formula>
were the scaled abundance matrix is denoted <inline-formula id="pcbi.1005252.e087"><alternatives><graphic id="pcbi.1005252.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:mover><mml:mi>A</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Defining the scaling matrix <italic>D</italic> as the diagonal matrix whose <italic>j</italic><sup><italic>th</italic></sup> diagonal entry is <inline-formula id="pcbi.1005252.e088"><alternatives><graphic id="pcbi.1005252.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo form="prefix" stretchy="true">(</mml:mo> <mml:msubsup><mml:mi>a</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:math></alternatives></inline-formula>, it follows that <inline-formula id="pcbi.1005252.e089"><alternatives><graphic id="pcbi.1005252.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:mover><mml:mi>A</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi>A</mml:mi> <mml:msup><mml:mi>D</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, and the trait matrix has to be scaled accordingly as <inline-formula id="pcbi.1005252.e090"><alternatives><graphic id="pcbi.1005252.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mrow><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi>H</mml:mi> <mml:msup><mml:mi>D</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The approximation problem is therefore formulated and solved in terms of matrix <italic>W</italic> and <inline-formula id="pcbi.1005252.e091"><alternatives><graphic id="pcbi.1005252.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, after which <italic>H</italic> is recovered as <inline-formula id="pcbi.1005252.e092"><alternatives><graphic id="pcbi.1005252.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mrow><mml:mi>H</mml:mi> <mml:mo>=</mml:mo> <mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>D</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>The approximation error is defined using the Frobenius norm as given in <xref ref-type="disp-formula" rid="pcbi.1005252.e010">Eq (9)</xref>. Following [<xref ref-type="bibr" rid="pcbi.1005252.ref012">12</xref>] we use a regularizing term aimed at encouraging sparsity over the columns of <inline-formula id="pcbi.1005252.e093"><alternatives><graphic id="pcbi.1005252.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, formulated as <inline-formula id="pcbi.1005252.e094"><alternatives><graphic id="pcbi.1005252.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:mrow><mml:mi>α</mml:mi> <mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mo form="postfix" stretchy="false">‖</mml:mo> <mml:mi>W</mml:mi> <mml:msubsup><mml:mo form="postfix" stretchy="false">‖</mml:mo> <mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo form="postfix" stretchy="false">‖</mml:mo> <mml:msup><mml:mn mathvariant="double-struck">1</mml:mn> <mml:mi>T</mml:mi></mml:msup> <mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:msubsup><mml:mo form="postfix" stretchy="false">‖</mml:mo> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1005252.e095"><alternatives><graphic id="pcbi.1005252.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> is defined as
<disp-formula id="pcbi.1005252.e096"><alternatives><graphic id="pcbi.1005252.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e096" xlink:type="simple"/><mml:math display="block" id="M96"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:munder><mml:munder accentunder="true"><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mtext>size</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>k</mml:mtext></mml:mrow></mml:munder></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
More details about this regularization term is given in <xref ref-type="supplementary-material" rid="pcbi.1005252.s001">S1 Text</xref>.</p>
<p>The matrix <inline-formula id="pcbi.1005252.e097"><alternatives><graphic id="pcbi.1005252.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:mrow><mml:msub><mml:mover><mml:mi>F</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo>Δ</mml:mo></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mo>Δ</mml:mo></mml:msub> <mml:msup><mml:mi>D</mml:mi> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> such that <inline-formula id="pcbi.1005252.e098"><alternatives><graphic id="pcbi.1005252.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mo>Δ</mml:mo></mml:msub> <mml:msup><mml:mi>H</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mover><mml:mi>F</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo>Δ</mml:mo></mml:msub> <mml:msup><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is defined, in order to translate the constraints in terms of <inline-formula id="pcbi.1005252.e099"><alternatives><graphic id="pcbi.1005252.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Finally, for a given value of (<italic>k</italic>, <italic>α</italic>) the NMF problem to be solved is formulated as:
<disp-formula id="pcbi.1005252.e100"><alternatives><graphic id="pcbi.1005252.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e100" xlink:type="simple"/><mml:math display="block" id="M100"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mo>⋆</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>⋆</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mrow><mml:mspace width="4pt"/><mml:mtext>argmin</mml:mtext></mml:mrow> <mml:mrow><mml:mi>W</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:munder> <mml:mrow><mml:mspace width="0.277778em"/><mml:mo>‖</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mi>W</mml:mi> <mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msubsup><mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mrow><mml:mi>α</mml:mi> <mml:mo>(</mml:mo> <mml:mo>‖</mml:mo> <mml:mi>W</mml:mi> <mml:mo>‖</mml:mo></mml:mrow> <mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>+</mml:mo> <mml:mo>‖</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:msubsup><mml:mo>‖</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>s</mml:mi> <mml:mo>.</mml:mo> <mml:mi>t</mml:mi> <mml:mo>.</mml:mo> <mml:mspace width="4pt"/><mml:mi>W</mml:mi> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>Δ</mml:mo></mml:msub> <mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>T</mml:mi></mml:msup> <mml:mo>≤</mml:mo> <mml:mrow/><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(19)</label></disp-formula>
where <inline-formula id="pcbi.1005252.e101"><alternatives><graphic id="pcbi.1005252.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a (<italic>k</italic> × <italic>r</italic>) matrix and <italic>W</italic> is a (<italic>n</italic> × <italic>r</italic>) matrix. The NMF decomposition of <italic>A</italic> is (<italic>W</italic>*, <italic>H</italic>*) with <inline-formula id="pcbi.1005252.e102"><alternatives><graphic id="pcbi.1005252.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:mrow><mml:msup><mml:mi>H</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup> <mml:mi>D</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec025">
<title>Numerical implementation</title>
<p>Algorithm 1 details the inference process for the determination of <italic>W</italic><sup>⋆</sup> and <inline-formula id="pcbi.1005252.e103"><alternatives><graphic id="pcbi.1005252.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:msup><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo>⋆</mml:mo></mml:msup></mml:math></alternatives></inline-formula>. The minimization <xref ref-type="disp-formula" rid="pcbi.1005252.e110">step (20)</xref> is carried out using a block-coordinate descent algorithm detailed in Algorithm 2, in which <italic>W</italic> and <inline-formula id="pcbi.1005252.e104"><alternatives><graphic id="pcbi.1005252.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are alternatively updated.</p>
<p><bold>Algorithm 1</bold> NMF resolution</p>
<p specific-use="line">
<inline-formula id="pcbi.1005252.e105">
<alternatives>
<graphic id="pcbi.1005252.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e105" xlink:type="simple"/>
<mml:math display="inline" id="M105">
<mml:mrow>
<mml:mover>
<mml:mi>A</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mo accent="false">←</mml:mo>
<mml:mi>A</mml:mi>
<mml:msup>
<mml:mi>D</mml:mi>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</p>
<p specific-use="line">
<inline-formula id="pcbi.1005252.e106">
<alternatives>
<graphic id="pcbi.1005252.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e106" xlink:type="simple"/>
<mml:math display="inline" id="M106">
<mml:mrow>
<mml:msub>
<mml:mover>
<mml:mi>F</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mo>Δ</mml:mo>
</mml:msub>
<mml:mo accent="false">←</mml:mo>
<mml:msub>
<mml:mi>F</mml:mi>
<mml:mo>Δ</mml:mo>
</mml:msub>
<mml:msup>
<mml:mi>D</mml:mi>
<mml:mi>T</mml:mi>
</mml:msup>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</p>
<p specific-use="line"><bold>for</bold> Iter = 1 to 5 <bold>do</bold></p>
<p specific-use="line"> 
<inline-formula id="pcbi.1005252.e107">
<alternatives>
<graphic id="pcbi.1005252.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e107" xlink:type="simple"/>
<mml:math display="inline" id="M107">
<mml:mrow>
<mml:mo form="prefix" stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>W</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>H</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo form="postfix" stretchy="false">)</mml:mo>
<mml:mo>∼</mml:mo>
<mml:mstyle mathvariant="script">
<mml:mi>u</mml:mi>
</mml:mstyle>
<mml:mo form="prefix" stretchy="false">(</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo form="postfix" stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</p>
<p specific-use="line"> 
<inline-formula id="pcbi.1005252.e108">
<alternatives>
<graphic id="pcbi.1005252.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e108" xlink:type="simple"/>
<mml:math display="inline" id="M108">
<mml:mrow>
<mml:msub>
<mml:mi>W</mml:mi>
<mml:mrow>
<mml:mtext mathvariant="bold">ini</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo accent="false">←</mml:mo>
<mml:msub>
<mml:mi>W</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msqrt>
<mml:mfrac>
<mml:mrow>
<mml:mo form="postfix" stretchy="false">‖</mml:mo>
<mml:mover>
<mml:mi>A</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:msub>
<mml:mo form="postfix" stretchy="false">‖</mml:mo>
<mml:mi>F</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mo form="postfix" stretchy="false">‖</mml:mo>
<mml:msub>
<mml:mi>W</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mover>
<mml:mi>H</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mo form="postfix" stretchy="false">‖</mml:mo>
<mml:mi>F</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:msqrt>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</p>
<p specific-use="line"> 
<inline-formula id="pcbi.1005252.e109">
<alternatives>
<graphic id="pcbi.1005252.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e109" xlink:type="simple"/>
<mml:math display="inline" id="M109">
<mml:mrow>
<mml:msub>
<mml:mover>
<mml:mi>H</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mtext mathvariant="bold">ini</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo accent="false">←</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>H</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msqrt>
<mml:mfrac>
<mml:mrow>
<mml:mo form="postfix" stretchy="false">‖</mml:mo>
<mml:mover>
<mml:mi>A</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:msub>
<mml:mo form="postfix" stretchy="false">‖</mml:mo>
<mml:mi>F</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mo form="postfix" stretchy="false">‖</mml:mo>
<mml:msub>
<mml:mi>W</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mover>
<mml:mi>H</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mo form="postfix" stretchy="false">‖</mml:mo>
<mml:mi>F</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:msqrt>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
<disp-formula id="pcbi.1005252.e110">
<alternatives>
<graphic id="pcbi.1005252.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e110" xlink:type="simple"/>
<mml:math display="block" id="M110">
<mml:mrow><mml:mtable><mml:mtr><mml:mtd>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msubsup>
<mml:mi>W</mml:mi>
<mml:mtext>Iter</mml:mtext>
<mml:mo>⋆</mml:mo>
</mml:msubsup>
<mml:mo>,</mml:mo>
<mml:msubsup>
<mml:mover accent="true">
<mml:mi>H</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mtext>Iter</mml:mtext>
<mml:mo>⋆</mml:mo>
</mml:msubsup>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:munder>
<mml:mtext>argmin</mml:mtext>
<mml:mrow>
<mml:mi mathvariant="bold-italic">W</mml:mi>
<mml:mo>,</mml:mo>
<mml:mover accent="true">
<mml:mi mathvariant="bold-italic">H</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
</mml:mrow>
</mml:munder>
<mml:mrow>
<mml:mspace width="0.277778em"/>
<mml:mo>‖</mml:mo>
</mml:mrow>
<mml:mover accent="true">
<mml:mi>A</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mo>-</mml:mo>
<mml:mrow>
<mml:mi mathvariant="bold-italic">W</mml:mi>
<mml:mover accent="true">
<mml:mi mathvariant="bold-italic">H</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mo>‖</mml:mo>
</mml:mrow>
<mml:mi>F</mml:mi>
<mml:mn>2</mml:mn>
</mml:msubsup>
<mml:mo>+</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>α</mml:mi>
<mml:mo>(</mml:mo>
<mml:mo>‖</mml:mo>
<mml:mi mathvariant="bold-italic">W</mml:mi>
<mml:mo>‖</mml:mo>
</mml:mrow>
<mml:mi>F</mml:mi>
<mml:mn>2</mml:mn>
</mml:msubsup>
<mml:mrow>
<mml:mo>+</mml:mo>
<mml:mo>‖</mml:mo>
</mml:mrow>
<mml:mover accent="true">
<mml:mi mathvariant="bold-italic">H</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:msubsup>
<mml:mo>‖</mml:mo>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msubsup>
<mml:mo>)</mml:mo>
</mml:mrow></mml:mtd></mml:mtr>
<mml:mtr><mml:mtd><mml:mi>s</mml:mi>
<mml:mo>.</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>.</mml:mo>
<mml:mspace width="4pt"/>
<mml:mi mathvariant="bold-italic">W</mml:mi>
<mml:mo>≥</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mspace width="0.277778em"/>
<mml:mover accent="true">
<mml:mi mathvariant="bold-italic">H</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mo>≥</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mspace width="0.277778em"/>
<mml:msub>
<mml:mover accent="true">
<mml:mi>F</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mo>Δ</mml:mo>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mover accent="true">
<mml:mi mathvariant="bold-italic">H</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mi>T</mml:mi>
</mml:msup>
<mml:mo>≤</mml:mo>
<mml:mrow/>
<mml:mn>0</mml:mn>
</mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(20)</label>
</disp-formula>
</p>
<p specific-use="line"><bold>end for</bold></p>
<p specific-use="line">
<inline-formula id="pcbi.1005252.e111">
<alternatives>
<graphic id="pcbi.1005252.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e111" xlink:type="simple"/>
<mml:math display="inline" id="M111">
<mml:mrow>
<mml:mo form="prefix" stretchy="false">(</mml:mo>
<mml:msup>
<mml:mi>W</mml:mi>
<mml:mo>⋆</mml:mo>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:msup>
<mml:mover>
<mml:mi>H</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mo>⋆</mml:mo>
</mml:msup>
<mml:mo form="postfix" stretchy="false">)</mml:mo>
<mml:mo accent="false">←</mml:mo>
<mml:munder>
<mml:mtext mathvariant="normal">argmin</mml:mtext>
<mml:mrow>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
<mml:mo>∈</mml:mo>
<mml:mo form="prefix" stretchy="false">[</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>5</mml:mn>
<mml:mo form="postfix" stretchy="false">]</mml:mo>
</mml:mrow>
</mml:munder>
<mml:mo form="postfix" stretchy="false">‖</mml:mo>
<mml:mover>
<mml:mi>A</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mo>−</mml:mo>
<mml:msubsup>
<mml:mi>W</mml:mi>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
<mml:mo>⋆</mml:mo>
</mml:msubsup>
<mml:msubsup>
<mml:mover>
<mml:mi>H</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mtext mathvariant="normal">Iter</mml:mtext>
<mml:mo>⋆</mml:mo>
</mml:msubsup>
<mml:msubsup>
<mml:mo form="postfix" stretchy="false">‖</mml:mo>
<mml:mi>F</mml:mi>
<mml:mn>2</mml:mn>
</mml:msubsup>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</p>
<p specific-use="line">
<inline-formula id="pcbi.1005252.e112">
<alternatives>
<graphic id="pcbi.1005252.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e112" xlink:type="simple"/>
<mml:math display="inline" id="M112">
<mml:mrow>
<mml:msup>
<mml:mi>H</mml:mi>
<mml:mo>⋆</mml:mo>
</mml:msup>
<mml:mo accent="false">←</mml:mo>
<mml:msup>
<mml:mover>
<mml:mi>H</mml:mi>
<mml:mo accent="true">˜</mml:mo>
</mml:mover>
<mml:mo>⋆</mml:mo>
</mml:msup>
<mml:mi>D</mml:mi>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</p>
<p><bold>Algorithm 2</bold> Block-Coordinate-Descent for NMF</p>
<p specific-use="line"><bold>while</bold> Convergence ≠ True <bold>do</bold>
<disp-formula id="pcbi.1005252.e113">
<alternatives>
<graphic id="pcbi.1005252.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e113" xlink:type="simple"/>
<mml:math display="block" id="M113">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mover>
<mml:mi>H</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:msup>
<mml:mo>←</mml:mo>
<mml:munder>
<mml:mrow>
<mml:mtext>argmin</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mi mathvariant="bold-italic">H</mml:mi>
<mml:mo>≥</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>F</mml:mi>
<mml:mo>Δ</mml:mo>
</mml:msub>
<mml:msup>
<mml:mi mathvariant="bold-italic">H</mml:mi>
<mml:mi>T</mml:mi>
</mml:msup>
<mml:mo>≤</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:munder>
<mml:mtext> </mml:mtext>
<mml:mo>‖</mml:mo>
<mml:mover>
<mml:mi>A</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mi>W</mml:mi>
<mml:mi>t</mml:mi>
</mml:msup>
<mml:mi mathvariant="bold-italic">H</mml:mi>
<mml:msubsup>
<mml:mo>‖</mml:mo>
<mml:mi>F</mml:mi>
<mml:mn>2</mml:mn>
</mml:msubsup>
<mml:mo>+</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>‖</mml:mo>
<mml:mi mathvariant="bold-italic">H</mml:mi>
<mml:msubsup>
<mml:mo>‖</mml:mo>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msubsup>
</mml:mrow>
</mml:math>
</alternatives>
<label>(21)</label>
</disp-formula>
<disp-formula id="pcbi.1005252.e114">
<alternatives>
<graphic id="pcbi.1005252.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e114" xlink:type="simple"/>
<mml:math display="block" id="M114">
<mml:mrow>
<mml:msup>
<mml:mi>W</mml:mi>
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:msup>
<mml:mo>←</mml:mo>
<mml:munder>
<mml:mrow>
<mml:mtext>argmin</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mi mathvariant="bold-italic">W</mml:mi>
<mml:mo>≥</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:munder>
<mml:mtext> </mml:mtext>
<mml:mo>‖</mml:mo>
<mml:mover>
<mml:mi>A</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mo>−</mml:mo>
<mml:mi mathvariant="bold-italic">W</mml:mi>
<mml:msup>
<mml:mrow>
<mml:mover>
<mml:mi>H</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msubsup>
<mml:mo>‖</mml:mo>
<mml:mi>F</mml:mi>
<mml:mn>2</mml:mn>
</mml:msubsup>
<mml:mo>+</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>‖</mml:mo>
<mml:mi mathvariant="bold-italic">W</mml:mi>
<mml:msubsup>
<mml:mo>‖</mml:mo>
<mml:mi>F</mml:mi>
<mml:mn>2</mml:mn>
</mml:msubsup>
</mml:mrow>
</mml:math>
</alternatives>
<label>(22)</label>
</disp-formula>
</p>
<p specific-use="line"><bold>end while</bold></p>
<p>Algorithm 2 was implemented in C language. The minimization <xref ref-type="disp-formula" rid="pcbi.1005252.e114">step (22)</xref> is performed using Nesterov’s first order method (see [<xref ref-type="bibr" rid="pcbi.1005252.ref039">39</xref>]). <xref ref-type="disp-formula" rid="pcbi.1005252.e113">Step (21)</xref> is solved using a standard Augmented Lagrangian Method [<xref ref-type="bibr" rid="pcbi.1005252.ref040">40</xref>], in which Uzawa iterations are combined with Nesterov’s first order method (see <xref ref-type="supplementary-material" rid="pcbi.1005252.s002">S2 Text</xref> for pseudo-code). Finally, upon convergence, the NMF approximation of <inline-formula id="pcbi.1005252.e115"><alternatives><graphic id="pcbi.1005252.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:mover><mml:mi>A</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is (<italic>W</italic><sup>⋆</sup>, <italic>H</italic><sup>⋆</sup>) defined in Algorithm 1.</p>
</sec>
<sec id="sec026">
<title>Criteria for parameter selection</title>
<p>According to the algorithm presented in Numerical Implementation section, each NMF decomposition (on all or part of the data set) involved in the following criteria was computed using 5 random initializations and selecting the decomposition which leads to the smallest reconstruction error. The range of values of <italic>k</italic> on which the criteria are computed is determined by inspecting the SVD decomposition of <inline-formula id="pcbi.1005252.e116"><alternatives><graphic id="pcbi.1005252.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:mover><mml:mi>A</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, as well as the size of the data over parameter ratio <italic>nr</italic>/(<italic>k</italic>*(<italic>n</italic>+<italic>r</italic>)).</p>
<p><italic>Bi-cross-validation.</italic> The bi-cross-validation procedure developed in [<xref ref-type="bibr" rid="pcbi.1005252.ref020">20</xref>] is an adaptation of the classic cross-validation procedure to the NMF framework, in which both samples (rows of <italic>A</italic>) and functional markers (columns of <italic>A</italic>) are split into training and validation sets. Bi-cross-validation error evaluates the prediction ability of the NMF decomposition. Nevertheless, it can not be computed for constrained NMF inference since the column split breaks up the structure of the metabolic relationships on which the constraints are based. Therefore, we consider this criterion as an indication of the performances of the NMF decomposition computed without constraints.</p>
<p><italic>Reconstruction error.</italic> The reconstruction error ‖<italic>A</italic> − <italic>W</italic>* <italic>H</italic>*‖<sub><italic>F</italic></sub>/‖<italic>A</italic>‖<sub><italic>F</italic></sub> indicates the proportion of information in <italic>A</italic> recovered in the NMF approximation <italic>W</italic>* <italic>H</italic>*. For a fixed <italic>α</italic>, this quantity automatically decreases as the number of profiles <italic>k</italic> increases, and the decreasing rate when a profile is added indicates the significance of this profile. Thus, a slope discontinuity on the graph of the reconstruction error as a function of <italic>k</italic> indicates that additional profiles are less significant. Similarly, for a given <italic>k</italic> the reconstruction error increases as <italic>α</italic> increases; we considered the optimal value to be the largest <italic>α</italic> before the reconstruction error significantly increases.</p>
<p><italic>Concordance of CAFTs from independent data sets.</italic> Let <italic>M</italic> be a matrix of dimension (<italic>n</italic><sub>1</sub>, <italic>r</italic><sub>1</sub>), the similarity matrix <italic>S</italic><sup><italic>M</italic></sup> of <italic>M</italic> is the squared matrix with <italic>r</italic><sub>1</sub> columns whose (<italic>j</italic>, <italic>j</italic>′) entry is the cosine of the angle between the column vectors <italic>j</italic> and <italic>j</italic>′ of <italic>M</italic>:
<disp-formula id="pcbi.1005252.e117"><alternatives><graphic id="pcbi.1005252.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e117" xlink:type="simple"/><mml:math display="block" id="M117"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msubsup> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msubsup> <mml:msubsup><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfenced> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msubsup> <mml:msubsup><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfenced> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
For repetitions <italic>a</italic> = 1, …, 40, the set of rows of <inline-formula id="pcbi.1005252.e118"><alternatives><graphic id="pcbi.1005252.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e118" xlink:type="simple"/><mml:math display="inline" id="M118"><mml:mover><mml:mi>A</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is randomly split in two independent sets of equal length, the corresponding submatrices <inline-formula id="pcbi.1005252.e119"><alternatives><graphic id="pcbi.1005252.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:msubsup><mml:mover><mml:mi>A</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e120"><alternatives><graphic id="pcbi.1005252.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:msubsup><mml:mover><mml:mi>A</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are extracted and their NMF decompositions <inline-formula id="pcbi.1005252.e121"><alternatives><graphic id="pcbi.1005252.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>W</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e122"><alternatives><graphic id="pcbi.1005252.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>W</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are inferred using the constrained NMF algorithm. Then, the concordance index is defined as
<disp-formula id="pcbi.1005252.e123"><alternatives><graphic id="pcbi.1005252.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e123" xlink:type="simple"/><mml:math display="block" id="M123"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>40</mml:mn> <mml:mo>×</mml:mo> <mml:msqrt><mml:mrow><mml:mi>r</mml:mi> <mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>40</mml:mn></mml:munderover> <mml:msub><mml:mrow><mml:mo>‖</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>‖</mml:mo></mml:mrow> <mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></disp-formula>
with <inline-formula id="pcbi.1005252.e124"><alternatives><graphic id="pcbi.1005252.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:msubsup><mml:mi>S</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e125"><alternatives><graphic id="pcbi.1005252.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e125" xlink:type="simple"/><mml:math display="inline" id="M125"><mml:msubsup><mml:mi>S</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> the similarity matrices of <inline-formula id="pcbi.1005252.e126"><alternatives><graphic id="pcbi.1005252.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:msubsup><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e127"><alternatives><graphic id="pcbi.1005252.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e127" xlink:type="simple"/><mml:math display="inline" id="M127"><mml:msubsup><mml:mover><mml:mi>H</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
<p><italic>Selection of optimal parameters for fiber digestion analysis.</italic> The optimal value of <italic>α</italic> was selected by computing the three criteria for (<italic>α</italic>, <italic>k</italic>) in (10<sup>−3</sup>, 10<sup>−2</sup>, 10<sup>−1.5</sup>, 10<sup>−1</sup>) × (2, 4, 6, 8, 11, 13). Then, the optimal number of CAFTs <italic>k</italic> was selected by computing the three criteria for the optimal value of <italic>α</italic> and for <italic>k</italic> in the set of integers from 2 to 15. The same 10-fold split of rows and columns in the bi-cross-validation procedure, and the same row splits for concordance of <italic>H</italic>, were used for all values of <italic>k</italic> and <italic>α</italic>.</p>
</sec>
<sec id="sec027">
<title>Sensitivity to the constraints</title>
<p>We performed additional inferences with <italic>k</italic> = 4 in order to assess the sensitivity of the resulting matrices to the thresholds used to define the constraints. We tested three pairs of thresholds in Rules 1, 2 and 3 used to build the constraints, namely [0%, 10%], [5%, 15%] and [10%, 30%]. These parameters influence the number or nodes (metabolites) included in the sets <inline-formula id="pcbi.1005252.e128"><alternatives><graphic id="pcbi.1005252.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e128" xlink:type="simple"/><mml:math display="inline" id="M128"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005252.e129"><alternatives><graphic id="pcbi.1005252.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e129" xlink:type="simple"/><mml:math display="inline" id="M129"><mml:msub><mml:mover><mml:mi>M</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>: the larger the threshold values, the more metabolites are included in these sets, and therefore the more constraints are imposed to the functional markers frequencies. For each of these pairs, we tested three options for the computation of the parameters <italic>δ</italic><sub>1,<italic>m</italic></sub> and <italic>δ</italic><sub>2,<italic>m</italic></sub> associated to each constraint. The first option was to compute them as the value obtained on the set of 190 genomes, with a multiplicative factor of 1 and no rounding. The second option was the one presented in the paper: the values obtained from the genomes are multiplied by 1.5 and rounded to the nearest upper multiple of 5. The third rule was the same as the second one with a multiplicative factor of 2. So the resulting constraints rank from the more stringent to the less stringent. The sensitivity was assessed by measuring the concordance index between the inferred CAFT matrices and the CAFT matrix obtained with an unconstrained NMF. We observed that the results were mainly influenced by the thresholds, and that the sensitivity to the computation rule tended to be weaker. For the pair [0%, 10%] the deviation from the unconstrained case was very weak (less than 1% on average), for the pair [5%, 15%] the deviation was small (less than 5% on average) and it was higher for the pair [10%, 30%] (12% on average). Therefore the choice [5%, 15%] seems to be sensible on this example.</p>
</sec>
</sec>
<sec id="sec028">
<title>Preservation of the geometric struture</title>
<p>The columns of matrices <italic>A</italic> and <italic>W</italic> were <italic>ℓ</italic><sup>1</sup>-normalized; the normalized matrices correspond to the repartition of the functional markers (resp. the CAFTs) abundancies among the samples. The distance matrix <italic>d</italic><sup><italic>A</italic></sup> (resp. <italic>d</italic><sup><italic>W</italic></sup>) of <italic>A</italic> (resp. <italic>W</italic>) defined as the 1408 × 1408 matrix whose element (<italic>i</italic>, <italic>j</italic>) is the euclidean distance between rows <italic>i</italic> and <italic>j</italic> of <italic>A</italic> (resp. <italic>W</italic>) was computed. For each biological sample <italic>i</italic>, the Pearson correlation between the distance of <italic>i</italic> to the other samples in <italic>A</italic> and in <italic>W</italic> was evaluated:
<disp-formula id="pcbi.1005252.e130"><alternatives><graphic id="pcbi.1005252.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005252.e130" xlink:type="simple"/><mml:math display="block" id="M130"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mtext>cor</mml:mtext> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>A</mml:mi></mml:msubsup></mml:mfenced> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>W</mml:mi></mml:msubsup></mml:mfenced> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula>
and the histogram of (<italic>C</italic><sub><italic>i</italic></sub>)<sub><italic>i</italic> = 1, …, 1408</sub> was displayed.</p>
</sec>
</sec>
<sec id="sec029">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005252.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Regularization term.</title>
<p>This file details the mathematical motivation for using a unique regularization parameter.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005252.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Pseudo-code of the minimization algorithm.</title>
<p>This file provides details about optimization steps <xref ref-type="disp-formula" rid="pcbi.1005252.e113">(21)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005252.e114">(22)</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005252.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.s003" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Tuning of the regularization parameter <italic>α</italic>.</title>
<p>This file details the selection of the regularization parameter <italic>α</italic> based on the three criteria.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005252.s004" mimetype="text/tab-separated-values" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.s004" xlink:type="simple">
<label>S1 tsv File</label>
<caption>
<title>Functional markers abundances.</title>
<p>This file contains the abundance matrix of the 86 functional markers of fiber degradation in 1408 samples.</p>
<p>(TSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005252.s005" mimetype="text/tab-separated-values" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.s005" xlink:type="simple">
<label>S2 tsv File</label>
<caption>
<title>List of 190 core genomes used for constraint building.</title>
<p>(TSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005252.s006" mimetype="text/tab-separated-values" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.s006" xlink:type="simple">
<label>S3 tsv File</label>
<caption>
<title>Constraint matrix.</title>
<p>This file contains the constraint matrix <italic>F</italic><sub>Δ</sub>, storing the coefficients of the 38 constraints on the 86 entries of the CAFTs.</p>
<p>(TSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005252.s007" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005252.s007" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Description of fiber hydrolysis.</title>
<p>This file details the hypotheses underlying the selection of functional markers and metabolites representing simple sugar anaerobic fermentation in the human gut (sheet Reactions and KOs) and provides the list of the GH and PL selected in the model (sheet GH and PL).</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005252.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sunagawa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mende</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Zeller</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Izquierdo-Carrasco</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Kultima</surname> <given-names>JR</given-names></name>, <etal>et al</etal>. <article-title>Metagenomic species profiling using universal phylogenetic marker genes</article-title>. <source>Nature methods</source>. <year>2013</year>;<volume>10</volume>(<issue>12</issue>):<fpage>1196</fpage>–<lpage>1199</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2693" xlink:type="simple">10.1038/nmeth.2693</ext-link></comment> <object-id pub-id-type="pmid">24141494</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alneberg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bjarnason</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>de Bruijn</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Schirmer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Quick</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ijaz</surname> <given-names>UZ</given-names></name>, <etal>et al</etal>. <article-title>Binning metagenomic contigs by coverage and composition</article-title>. <source>Nature methods</source>. <year>2014</year>;<volume>11</volume>(<issue>11</issue>):<fpage>1144</fpage>–<lpage>1146</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3103" xlink:type="simple">10.1038/nmeth.3103</ext-link></comment> <object-id pub-id-type="pmid">25218180</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nielsen</surname> <given-names>HB</given-names></name>, <name name-style="western"><surname>Almeida</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Juncker</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Rasmussen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sunagawa</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Identification and assembly of genomes and genetic elements in complex metagenomic samples without using reference genomes</article-title>. <source>Nature biotechnology</source>. <year>2014</year>;<volume>32</volume>(<issue>8</issue>):<fpage>822</fpage>–<lpage>828</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2939" xlink:type="simple">10.1038/nbt.2939</ext-link></comment> <object-id pub-id-type="pmid">24997787</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kultima</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Coelho</surname> <given-names>LP</given-names></name>, <name name-style="western"><surname>Forslund</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Huerta-Cepas</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Driessen</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>MOCAT2: a metagenomic assembly, annotation and profiling framework</article-title>. <source>Bioinformatics</source>. <year>2016</year>;Available from: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/early/2016/04/08/bioinformatics.btw183.abstract" xlink:type="simple">http://bioinformatics.oxfordjournals.org/content/early/2016/04/08/bioinformatics.btw183.abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btw183" xlink:type="simple">10.1093/bioinformatics/btw183</ext-link></comment> <object-id pub-id-type="pmid">27153620</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tringe</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Von Mering</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kobayashi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Salamov</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>HW</given-names></name>, <etal>et al</etal>. <article-title>Comparative metagenomics of microbial communities</article-title>. <source>Science</source>. <year>2005</year>;<volume>308</volume>(<issue>5721</issue>):<fpage>554</fpage>–<lpage>557</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1107851" xlink:type="simple">10.1126/science.1107851</ext-link></comment> <object-id pub-id-type="pmid">15845853</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Segata</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Boernigen</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tickle</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Morgan</surname> <given-names>XC</given-names></name>, <name name-style="western"><surname>Garrett</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Huttenhower</surname> <given-names>C</given-names></name>. <article-title>Computational meta’omics for microbial community studies</article-title>. <source>Molecular Systems Biology</source>. <year>2013</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005252.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sharpton</surname> <given-names>TJ</given-names></name>. <article-title>An Introduction to the Analysis of Shotgun Metagenomic Data</article-title>. <source>Frontiers in Plant Science</source>. <year>2014</year>;<volume>5</volume>(<issue>209</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fpls.2014.00209" xlink:type="simple">10.3389/fpls.2014.00209</ext-link></comment> <object-id pub-id-type="pmid">24982662</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abubucker</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Segata</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Goll</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schubert</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Izard</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cantarel</surname> <given-names>BL</given-names></name>, <etal>et al</etal>. <article-title>Metabolic reconstruction for metagenomic data and its application to the human microbiome</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>6</issue>):<fpage>e1002358</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002358" xlink:type="simple">10.1371/journal.pcbi.1002358</ext-link></comment> <object-id pub-id-type="pmid">22719234</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moreno García</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Schellberg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ewert</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Brüser</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Canales-Prati</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Linstädter</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Response of community-aggregated plant functional traits along grazing gradients: insights from African semi-arid grasslands</article-title>. <source>Applied vegetation science</source>. <year>2014</year>;<volume>17</volume>(<issue>3</issue>):<fpage>470</fpage>–<lpage>481</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/avsc.12092" xlink:type="simple">10.1111/avsc.12092</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fierer</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Barberan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Laughlin</surname> <given-names>DC</given-names></name>. <article-title>Seeing the forest for the genes: using metagenomics to infer the aggregated traits of microbial communities</article-title>. <source>Frontiers in Microbiology</source>. <year>2014</year>;<volume>5</volume>(<issue>November</issue>):<fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005252.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Letunic</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Yamada</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Bork</surname> <given-names>P</given-names></name>. <article-title>Toward molecular trait-based ecology through integration of biogeochemical, geographical and metagenomic data</article-title>. <source>Molecular Systems Biology</source>. <year>2011</year>;<volume>7</volume>(<issue>1</issue>):<fpage>473</fpage>–<lpage>473</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2011.6" xlink:type="simple">10.1038/msb.2011.6</ext-link></comment> <object-id pub-id-type="pmid">21407210</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kim</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>H</given-names></name>. <article-title>Sparse non-negative matrix factorizations via alternating non-negativity-constrained least squares for microarray data analysis</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>(<issue>12</issue>):<fpage>1495</fpage>–<lpage>1502</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm134" xlink:type="simple">10.1093/bioinformatics/btm134</ext-link></comment> <object-id pub-id-type="pmid">17483501</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brunet</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Tamayo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Golub</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Mesirov</surname> <given-names>JP</given-names></name>. <article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2004</year>;<volume>101</volume>(<issue>12</issue>):<fpage>4164</fpage>–<lpage>4169</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0308531101" xlink:type="simple">10.1073/pnas.0308531101</ext-link></comment> <object-id pub-id-type="pmid">15016911</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baran</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Halperin</surname> <given-names>E</given-names></name>. <article-title>Joint analysis of multiple metagenomic samples</article-title>. <source>PLoS computational biology</source>. <year>2012</year>;<volume>8</volume>(<issue>2</issue>):<fpage>e1002373</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002373" xlink:type="simple">10.1371/journal.pcbi.1002373</ext-link></comment> <object-id pub-id-type="pmid">22359490</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jiang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Weitz</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Dushoff</surname> <given-names>J</given-names></name>. <article-title>A non-negative matrix factorization framework for identifying modular patterns in metagenomic profile data</article-title>. <source>Journal of Mathematical Biology</source>. <year>2012</year>;<volume>64</volume>(<issue>4</issue>):<fpage>697</fpage>–<lpage>711</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00285-011-0428-2" xlink:type="simple">10.1007/s00285-011-0428-2</ext-link></comment> <object-id pub-id-type="pmid">21630089</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jiang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Langille</surname> <given-names>MGI</given-names></name>, <name name-style="western"><surname>Neches</surname> <given-names>RY</given-names></name>, <name name-style="western"><surname>Elliot</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Levin</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Eisen</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Functional Biogeography of Ocean Microbes Revealed through Non-Negative Matrix Factorization</article-title>. <source>PLoS ONE</source>. <year>2012</year>;<volume>7</volume>(<issue>9</issue>):<fpage>e43866</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0043866" xlink:type="simple">10.1371/journal.pone.0043866</ext-link></comment> <object-id pub-id-type="pmid">23049741</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref017">
<label>17</label>
<mixed-citation publication-type="other" xlink:type="simple">Jiang X, Hu X, Xu W. Joint Analysis of Functional and Phylogenetic Composition for Human Microbiome Data. In: Basu M, Pan Y, Wang J, editors. Bioinformatics Research and Applications: 10th International Symposium, ISBRA 2014, Zhangjiajie, China, June 28–30, 2014. Proceedings. Springer International Publishing; 2014. p. 346–356.</mixed-citation>
</ref>
<ref id="pcbi.1005252.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liao</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Boscolo</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>YL</given-names></name>, <name name-style="western"><surname>Tran</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Sabatti</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Roychowdhury</surname> <given-names>VP</given-names></name>. <article-title>Network component analysis: reconstruction of regulatory signals in biological systems</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2003</year>;<volume>100</volume>(<issue>26</issue>):<fpage>15522</fpage>–<lpage>15527</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.2136632100" xlink:type="simple">10.1073/pnas.2136632100</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kim</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>H</given-names></name>. <article-title>Nonnegative Matrix Factorization Based on Alternating Nonnegativity Constrained Least Squares and Active Set Method</article-title>. <source>SIAM Journal on Matrix Analysis and Applications</source>. <year>2008</year>;<volume>30</volume>(<issue>2</issue>):<fpage>713</fpage>–<lpage>730</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/07069239X" xlink:type="simple">10.1137/07069239X</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Owen</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Perry</surname> <given-names>PO</given-names></name>. <article-title>Bi-cross-validation of the SVD and the nonnegative matrix factorization</article-title>. <source>The Annals of Applied Statistics</source>. <year>2009</year>;<volume>3</volume>(<issue>2</issue>):<fpage>564</fpage>–<lpage>594</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/08-AOAS227" xlink:type="simple">10.1214/08-AOAS227</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jia</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Cai</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zhong</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Sunagawa</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>An integrated catalog of reference genes in the human gut microbiome</article-title>. <source>Nature biotechnology</source>. <year>2014</year>;<volume>32</volume>(<issue>8</issue>):<fpage>834</fpage>–<lpage>841</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2942" xlink:type="simple">10.1038/nbt.2942</ext-link></comment> <object-id pub-id-type="pmid">24997786</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Raes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Arumugam</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Burgdorf</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Manichanh</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A human gut microbial gene catalogue established by metagenomic sequencing: Article: Nature</article-title>. <source>Nature</source>. <year>2010</year>;<volume>464</volume>(<issue>7285</issue>):<fpage>59</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08821" xlink:type="simple">10.1038/nature08821</ext-link></comment> <object-id pub-id-type="pmid">20203603</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Methé</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Pop</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Creasy</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Giglio</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Huttenhower</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A framework for human microbiome research</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>215</fpage>–<lpage>221</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11209" xlink:type="simple">10.1038/nature11209</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Cai</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>F</given-names></name>, <etal>et al</etal>. <article-title>A metagenome-wide association study of gut microbiota in type 2 diabetes</article-title>. <source>Nature</source>. <year>2012</year>;<volume>490</volume>(<issue>7418</issue>):<fpage>55</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11450" xlink:type="simple">10.1038/nature11450</ext-link></comment> <object-id pub-id-type="pmid">23023125</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Le Chatelier</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Qin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Prifti</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hildebrand</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Falony</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Richness of human gut microbiome correlates with metabolic markers</article-title>. <source>Nature</source>. <year>2013</year>;<volume>500</volume>(<issue>7464</issue>):<fpage>541</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12506" xlink:type="simple">10.1038/nature12506</ext-link></comment> <object-id pub-id-type="pmid">23985870</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Erickson</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Cantarel</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Lamendella</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Darzi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Mongodin</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Pan</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Integrated Metagenomics/Metaproteomics Reveals Human Host-Microbiota Signatures of Crohn’s Disease</article-title>. <source>PLoS ONE</source>. <year>2012</year>;<volume>7</volume>(<issue>11</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0049138" xlink:type="simple">10.1371/journal.pone.0049138</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cotillard</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kennedy</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Kong</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Prifti</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Pons</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Le Chatelier</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Dietary intervention impact on gut microbial gene richness</article-title>. <source>Nature</source>. <year>2013</year>;<volume>500</volume>(<issue>7464</issue>):<fpage>585</fpage>–<lpage>588</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12480" xlink:type="simple">10.1038/nature12480</ext-link></comment> <object-id pub-id-type="pmid">23985875</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>. <article-title>KEGG: Kyoto Encyclopaedia of Genes and Genomes</article-title>. <source>Nucl Acids Res</source>. <year>2000</year>;<volume>28</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/28.1.27" xlink:type="simple">10.1093/nar/28.1.27</ext-link></comment> <object-id pub-id-type="pmid">10592173</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sato</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kawashima</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Furumichi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tanabe</surname> <given-names>M</given-names></name>. <article-title>Data, information, knowledge and principle: back to metabolism in KEGG</article-title>. <source>Nucleic acids research</source>. <year>2014</year>;<volume>42</volume>(<issue>Database issue</issue>):<fpage>D199</fpage>–<lpage>205</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt1076" xlink:type="simple">10.1093/nar/gkt1076</ext-link></comment> <object-id pub-id-type="pmid">24214961</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cantarel</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Coutinho</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Rancurel</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bernard</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lombard</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Henrissat</surname> <given-names>B</given-names></name>. <article-title>The Carbohydrate-Active EnZymes database (CAZy): an expert resource for Glycogenomics</article-title>. <source>Nucleic Acids Research</source>. <year>2009</year>;<volume>37</volume>(<issue>Database</issue>):<fpage>D233</fpage>–<lpage>D238</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkn663" xlink:type="simple">10.1093/nar/gkn663</ext-link></comment> <object-id pub-id-type="pmid">18838391</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cummings</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Macfarlane</surname> <given-names>GT</given-names></name>. <article-title>The control and consequences of bacterial fermentation in the human colon</article-title>. <source>Journal of Applied Bacteriology</source>. <year>1991</year>;<volume>70</volume>(<issue>6</issue>):<fpage>443</fpage>–<lpage>459</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1365-2672.1991.tb02739.x" xlink:type="simple">10.1111/j.1365-2672.1991.tb02739.x</ext-link></comment> <object-id pub-id-type="pmid">1938669</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gaci</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Borrel</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Tottey</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>O’Toole</surname> <given-names>PW</given-names></name>, <name name-style="western"><surname>Brugère</surname> <given-names>JF</given-names></name>. <article-title>Archaea and the human gut: new beginning of an old story</article-title>. <source>World J Gastroenterol</source>. <year>2014</year>;<volume>20</volume>(<issue>43</issue>):<fpage>16062</fpage>–<lpage>16078</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3748/wjg.v20.i43.16062" xlink:type="simple">10.3748/wjg.v20.i43.16062</ext-link></comment> <object-id pub-id-type="pmid">25473158</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yin</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Mao</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Mao</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>Y</given-names></name>. <article-title>dbCAN: a web resource for automated carbohydrate-active enzyme annotation</article-title>. <source>Nucleic acids research</source>. <year>2012</year>;<volume>40</volume>(<issue>Web Server issue</issue>):<fpage>W445</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks479" xlink:type="simple">10.1093/nar/gks479</ext-link></comment> <object-id pub-id-type="pmid">22645317</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tasse</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Bercovici</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pizzut-Serin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Robe</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Tap</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Klopp</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Functional metagenomics to mine the human gut microbiome for dietary fiber catabolic enzymes</article-title>. <source>Genome Research</source>. <year>2010</year>;<volume>20</volume>(<issue>11</issue>):<fpage>1605</fpage>–<lpage>1612</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.108332.110" xlink:type="simple">10.1101/gr.108332.110</ext-link></comment> <object-id pub-id-type="pmid">20841432</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>El Kaoutari</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Armougom</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gordon</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Raoult</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Henrissat</surname> <given-names>B</given-names></name>. <article-title>The abundance and variety of carbohydrate-active enzymes in the human gut microbiota</article-title>. <source>Nature reviews Microbiology</source>. <year>2013</year> <month>jul</month>;<volume>11</volume>(<issue>7</issue>):<fpage>497</fpage>–<lpage>504</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrmicro3050" xlink:type="simple">10.1038/nrmicro3050</ext-link></comment> <object-id pub-id-type="pmid">23748339</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref036">
<label>36</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gottschalk</surname> <given-names>G</given-names></name>. <source>Bacterial Metabolism. Springer Series in Microbiology</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer New York</publisher-name>; <year>1986</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005252.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Caspi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Altman</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Billington</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Dreher</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Foerster</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Fulcher</surname> <given-names>CA</given-names></name>, <etal>et al</etal>. <article-title>The MetaCyc database of metabolic pathways and enzymes and the BioCyc collection of Pathway/Genome Databases</article-title>. <source>Nucleic acids research</source>. <year>2014</year>;<volume>42</volume>(<issue>Database issue</issue>):<fpage>D459</fpage>–<lpage>71</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt1103" xlink:type="simple">10.1093/nar/gkt1103</ext-link></comment> <object-id pub-id-type="pmid">24225315</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tap</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mondot</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Levenez</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pelletier</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Caron</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Furet</surname> <given-names>JP</given-names></name>, <etal>et al</etal>. <article-title>Towards the human intestinal microbiota phylogenetic core</article-title>. <source>Environmental Microbiology</source>. <year>2009</year>;<volume>11</volume>(<issue>10</issue>):<fpage>2574</fpage>–<lpage>2584</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1462-2920.2009.01982.x" xlink:type="simple">10.1111/j.1462-2920.2009.01982.x</ext-link></comment> <object-id pub-id-type="pmid">19601958</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005252.ref039">
<label>39</label>
<mixed-citation publication-type="other" xlink:type="simple">Nesterov Y. Introductory Lectures on Convex Programming Volume I: Basic course. vol. I; 1996.</mixed-citation>
</ref>
<ref id="pcbi.1005252.ref040">
<label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Arrow</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Hurwicz</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Uzawa</surname> <given-names>H</given-names></name>. <chapter-title>Studies in linear and non-linear programming</chapter-title>. <source>Stanford mathematical studies in the social sciences</source>. <publisher-name>Stanford University Press</publisher-name>; <year>1958</year>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>