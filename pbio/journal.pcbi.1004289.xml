<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01381</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004289</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>PF<sup>2</sup> <italic>fit</italic>: Polar Fast Fourier Matched Alignment of Atomistic Structures with 3D Electron Microscopy Maps</article-title>
<alt-title alt-title-type="running-head">Polar Fast Fourier Alignment of Structures with 3D Electron Microscopy</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Bettadapura</surname> <given-names>Radhakrishna</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Rasheed</surname> <given-names>Muhibur</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Vollrath</surname> <given-names>Antje</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Bajaj</surname> <given-names>Chandrajit</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Radhakrishna Bettadapura Computational Visualization Center/Department of Mechanical Engineering, University of Texas at Austin, Austin, Texas, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Muhibur Rasheed Computational Visualization Center/Department of Mechanical Engineering, University of Texas at Austin, Austin, Texas, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Antje Vollrath Institut Computational Mathematics, Technische Universität Braunschweig, Braunschweig, Germany</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Chandrajit Bajaj Computational Visualization Center/Institute of Computational Engineering &amp; Sciences/Department of Computer Science, University of Texas at Austin, Austin, Texas, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Russell</surname> <given-names>Robert B.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Heidelberg, GERMANY</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: CB RB MR AV. Performed the experiments: RB MR. Analyzed the data: CB RB MR AV. Contributed reagents/materials/analysis tools: CB RB MR AV. Wrote the paper: CB RB MR AV.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">bajaj@cs.utexas.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>10</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>15</day>
<month>10</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>10</issue>
<elocation-id>e1004289</elocation-id>
<history>
<date date-type="received">
<day>30</day>
<month>7</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>14</day>
<month>4</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Bettadapura et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004289" xlink:type="simple"/>
<abstract>
<p>There continue to be increasing occurrences of both atomistic structure models in the PDB (possibly reconstructed from X-ray diffraction or NMR data), and 3D reconstructed cryo-electron microscopy (3D EM) maps (albeit at coarser resolution) of the same or homologous molecule or molecular assembly, deposited in the EMDB. To obtain the best possible structural model of the molecule at the best achievable resolution, and without any missing gaps, one typically aligns (match and fits) the atomistic structure model with the 3D EM map. We discuss a new algorithm and generalized framework, named PF<sup>2</sup> <italic>fit</italic> (Polar Fast Fourier Fitting) for the best possible structural alignment of atomistic structures with 3D EM. While PF<sup>2</sup> <italic>fit</italic> enables only a rigid, six dimensional (6D) alignment method, it augments prior work on 6D X-ray structure and 3D EM alignment in multiple ways:</p>
<p><italic>Scoring</italic>. PF<sup>2</sup> <italic>fit</italic> includes a new scoring scheme that, in addition to rewarding overlaps between the volumes occupied by the atomistic structure and 3D EM map, rewards overlaps between the volumes complementary to them. We quantitatively demonstrate how this new complementary scoring scheme improves upon existing approaches. PF<sup>2</sup> <italic>fit</italic> also includes two scoring functions, the non-uniform exterior penalty and the skeleton-secondary structure score, and implements the scattering potential score as an alternative to traditional Gaussian blurring.</p>
<p><italic>Search</italic>. PF<sup>2</sup> <italic>fit</italic> utilizes a fast polar Fourier search scheme, whose main advantage is the ability to search over <italic>uniformly</italic> and <italic>adaptively</italic> sampled subsets of the space of rigid-body motions. PF<sup>2</sup> <italic>fit</italic> also implements a new reranking search and scoring methodology that considerably improves alignment metrics in results obtained from the initial search.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>In recent years, advances in cryo-electron microscopy (cryoEM) and three-dimensional (3D) image reconstruction have made it possible to determine the structures of molecular complexes, to sub-nanometer resolutions. These reconstructed 3D cryoEM maps provide a unique challenge, since the resolutions are often sufficient to resolve a subset of the secondary structural features (e.g., long <italic>α</italic>-helices), but not high enough to unambiguously identify others (e.g., short <italic>α</italic>-helices, <italic>β</italic>-sheets, <italic>α</italic>-helix pitch, or overall connectivity of proteins). Various types of hierarchical structure refinement models of the data, including the atomistic model match and fitting, which is the subject of this paper are crucial in helping derive a more complete understanding of the structure and function relationships of biological complexes. Our protocol offers several advantages over existing fitting techniques. We introduce three new scoring terms to evaluate the quality of fitting, and the optimization of these functions lead to better predictions than existing tools like ADP-EM and Colores. Furthermore, we have adopted a non-uniform FFT-based search which is not only faster than regular FFT, but it also enables one to selectively perform more refined searches in localized regions, which is specially useful when fitting a small molecular component into a larger symmetric or asymmetric macromolecular structure.</p>
</abstract>
<funding-group>
<funding-statement>This research in part was funded by grants NIH-R01-EB004873, NIH-R01GM117594 and NSF-OCI-1216701, the center for computational visualization <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://cvcweb.ices.utexas.edu/">http://cvcweb.ices.utexas.edu/</ext-link> and the Texas Advanced Computing Center TACC <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="https://www.tacc.utexas.edu/">https://www.tacc.utexas.edu/</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="3"/>
<page-count count="27"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files. The PDB data is publicly available from the PDB as is the EM data from the EMDB. All PDB, EM data links are provided in the manuscript.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> Methods paper</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Protein structural data is available in primarily two forms. Atomistic scale structures (or atomic structures for short), acquired through X-ray or nuclear magnetic resonance (NMR) imaging, contain information fine enough to localize the position of most, if not all, the atoms of the protein. However these imaging modalities do not allow a complete picture of the protein’s solvent-induced state. Three dimensional (3D) electron microscopy (EM) maps, reconstructed by single particle (SP) or electron tomography (ET), are at a lower resolution but are easier to obtain and probably closer to the functional native state. A relevant problem of computational structural biology is to reconcile these forms of protein structure data, producing a refined protein model that combines the finer resolution information in the former with the native-state information at lower resolution in the latter. Different frameworks or computational pipelines like comparative modeling, e.g. [<xref ref-type="bibr" rid="pcbi.1004289.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004289.ref005">5</xref>] and ab initio modeling, e.g. [<xref ref-type="bibr" rid="pcbi.1004289.ref006">6</xref>], have played an increasingly important role in this kind of structure determination referred to as the fitting problem. The fitting problem can be solved for either rigid-body (6D) or flexible motions (6D rigid body motion + flexible dimensions) of the atomic structure. In this work, we address aspects common to both problems, and demonstrate results here only on rigid-body fitting.</p>
<p>Approaches to the fitting problem begin by defining a score between an orientation of the atomic structure 𝓟 and the 3D EM map 𝓜. A majority of past work uses the cross-correlation score (CCS) between 𝓜 and a synthesized 3D EM map 𝓜<sub>𝓟</sub> generated from 𝓟. The CCS is widely used because it is intuitive, easy to implement, and amenable to Fast Fourier transform-based correlations, discussed below. Variants of the CCS include the core-weighted or the Laplacian-filtered CCS [<xref ref-type="bibr" rid="pcbi.1004289.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004289.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref007">7</xref>] or normalized cross-correlation (NCC) [<xref ref-type="bibr" rid="pcbi.1004289.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref009">9</xref>]. There have also been a number of other scoring functions. For instance, the external-total ratio (ETR) measures the total number of atoms of 𝓟 outside a given iso-contour of 𝓜 [<xref ref-type="bibr" rid="pcbi.1004289.ref010">10</xref>], the vector matching score measures the inner product between a set of vectors representing 𝓟 and 𝓜 [<xref ref-type="bibr" rid="pcbi.1004289.ref011">11</xref>], while in [<xref ref-type="bibr" rid="pcbi.1004289.ref012">12</xref>] isosurfaces are matched by comparing surface normals.</p>
<p>A recent review of scoring functions for cryo-EM fitting can be found in [<xref ref-type="bibr" rid="pcbi.1004289.ref013">13</xref>]. All scoring functions depend on representing 𝓟 (respectively 𝓜), in terms that render it mutually intelligible to 𝓜 (respectively 𝓟). The usual choice, and not necessarily the best choice, for the representation involves blurring 𝓟 by placing a Gaussian at each of its atomic centers. We introduce two representations, termed non-uniform inclusion potential and scattering potential, and show that the scattering potential results in better prediction accuracy. We discuss the details of the terms in the next section and perform a comparative analysis in the Results section.</p>
<p>Once a scoring function is chosen, an algorithm searches for its optima over the space of rigid-body transformations of the protein. Hereafter, we refer to this space as the motion group SE(3). Search algorithms can be usefully distinguished by whether they find local or global extrema of the scoring function. Local optimization is typically synonymous with a variant of steepest ascent [<xref ref-type="bibr" rid="pcbi.1004289.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref014">14</xref>], although more powerful techniques such as Powell optimization [<xref ref-type="bibr" rid="pcbi.1004289.ref015">15</xref>] and quadratic programming [<xref ref-type="bibr" rid="pcbi.1004289.ref005">5</xref>] have also been used. In global optimization, the contest is between Monte Carlo- and Fast Fourier Transform (FFT)-based algorithms. Monte Carlo-based fitting algorithms [<xref ref-type="bibr" rid="pcbi.1004289.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref017">17</xref>] are able to step past local optima on their way to a close-to-optimal solution; they are easy to implement and widely documented in the literature. Exhaustive or Fourier-based approaches exploit the fact that it is beneficial if the computation of the objective function can be done relatively fast. Fourier-based, deterministic approaches [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004289.ref020">20</xref>] guarantee that the found solution is within a user defined error margin of the optimum. Thus they offer a compelling trade-off between accuracy and computation time especially when combined with parallelization techniques or other hardware specific speed-ups, e.g. [<xref ref-type="bibr" rid="pcbi.1004289.ref009">9</xref>].</p>
<p>We adopt a variant of FFT, the non-uniform SO(3) Fourier transform (NFSOFT) [<xref ref-type="bibr" rid="pcbi.1004289.ref021">21</xref>] which not only provides better asymptotic computational complexity, but also is specially suited for better sampling of SE(3) and adaptive local searches.</p>
<p>An important aspect of the search procedure is a suitable sampling of the motion group SE(3). Usually the product property SE(3) = ℝ<sup>3</sup> × SO(3) is exploited for these samplings, where SO(3) denotes the group of three-dimensional rotations, (cf. [<xref ref-type="bibr" rid="pcbi.1004289.ref022">22</xref>]). Crucial to sampling on SE(3) is sampling of the rotational subgroup SO(3). There are several existing techniques that, given an angular sampling criterion, provide a set of samples that are uniform with respect to accepted metrics of uniformity [<xref ref-type="bibr" rid="pcbi.1004289.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1004289.ref025">25</xref>].</p>
<p>The paper [<xref ref-type="bibr" rid="pcbi.1004289.ref007">7</xref>] discusses fast rotational matching, i.e., it omits the translational part of the matching procedure which we incorporate. Hence, the series expansion of the scoring functions used in their work is different, as it uses spherical harmonics but not Laguerre polynomials for the radial part of the function. In contrast to that [<xref ref-type="bibr" rid="pcbi.1004289.ref019">19</xref>] considers rigid-body motion with rotation and translation. They use a ℝ<sup>1</sup> × 𝕊<sup>2</sup> × SO(3) parameterization of the motion group that is different from ours. Their affinity functions are expanded on terms of spherical shells of different radii while we use a decomposition directly on ℝ<sup>3</sup> using radial wavefunctions in addition to spherical harmonics only. In addition to that our fitting algorithm uses adaptive low-discrepancy samplings, cf. [<xref ref-type="bibr" rid="pcbi.1004289.ref024">24</xref>] that better reflect the underlying geometries of sphere and rotation group.</p>
<p>After a suitable sampling is obtained the essential mathematical tool needed is the fast calculation of the discrete Fourier transform on the rotation group SO(3) to evaluate the correlation integral that is the objective function. There are several methods to efficiently evaluate Fourier transforms specifically on SO(3) [<xref ref-type="bibr" rid="pcbi.1004289.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref027">27</xref>]. There are also works that tackle Fourier transforms on the entire motion group SE(3), [<xref ref-type="bibr" rid="pcbi.1004289.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref029">29</xref>]. The use of fast and efficient algorithms to evaluate the Fourier transform on non-uniformly distributed points, cf. NFSOFT [<xref ref-type="bibr" rid="pcbi.1004289.ref021">21</xref>] is another improvement of our algorithm. See also Section “Rotational and Rigid-body Correlations; Non-Uniform SO(3) Fourier Transforms”.</p>
<p>A schematic overview our algorithm package PF<sup>2</sup> <italic>fit</italic> which solves the 3D EM map rigid fitting problem, is shown in <xref ref-type="fig" rid="pcbi.1004289.g001">Fig 1</xref>. It introduces the following innovations, each of which lead to improvements over the current state of the art in terms of accuracy and speed.
<list list-type="order"><list-item><p><italic>New FFT-amenable complementary scoring scheme</italic>. The complementary scoring scheme rewards overlaps between the volumes occupied by 𝓟 and 𝓜 as well as overlaps between the volumes <italic>complementary</italic> to 𝓟 and 𝓜. In this context, we introduce two scoring functions: the non-uniform inclusion potential and the complementary space score, both of which are computed on non-uniform grids. We also implement the scattering potential as an alternative to classical Gaussian blurring. The new scoring functions compare favorably to Gaussian-blur-based scoring across a variety of resolutions, in the presence and absence of noise. In particular, our FFT-amenable scoring functions result in lower RMSD than existing ones across a range of resolutions for synthesized density map fitting, and result in lower ETRs for microscope acquired density map fitting, also across a range of resolutions.</p></list-item> <list-item><p><italic>Uniform and focused sampling and search with non-uniform FFT</italic>. All prior techniques <italic>require</italic> an equispaced/uniform angular grid for rotational search, a property that results in a highly non-uniform search of the space of rotations SO(3) which is likely to miss important regions of motions while oversampling others. By contrast, <italic>uniform</italic> sampling the space of rotations SO(3), requires non-uniform angular grids (cf. [<xref ref-type="bibr" rid="pcbi.1004289.ref024">24</xref>]) which is only amenable to a non-uniform, SO(3)-FFT-based search algorithm.</p>
<p>Furthermore, since our non-uniform FFT framework does not require uniformity of the translational and rotational grids, it enables <italic>focused</italic> searches in both translational and rotational space, thus combining the advantages of local and global fitting schemes.</p></list-item> <list-item><p><italic>Information driven rerank scheme</italic>. Finally, to improve the accuracy of our fitting predictions, we rerank results from the search stage with respect to a scoring function based on matching the skeleton of 𝓜 with the secondary structural elements of 𝓟. In the reranking stage, we also include the well-known mutual information score [<xref ref-type="bibr" rid="pcbi.1004289.ref030">30</xref>].</p>
<p>Our reranking stage improves the rank of fitting poses obtained in the initial search stage at resolutions &lt; 10Å. We expect the reranking stage to become more effective as more EM maps between 3 and 8Å are isolated.</p></list-item></list></p>
<fig id="pcbi.1004289.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Control flow.</title>
<p>A typical control flow of the 3D EM map fitting algorithm developed in this work. The first step of a fitting procedure is the inital exhaustive search. Here one needs to define suitable scoring functions that are amenable for fast correlation computation via the chosen search scheme. Here, we are using FFT-based algorithms for the fast computation of non-uniform rigid-body correlations. The scoring functions may account for various structural aspects such as scattering potential or pockets in the molecular surface. The exhaustive search is followed by an information driven reranking scheme which among others might include the mutual information score or skeleton-secondary structure score. The final output of the procedure will be the best fit between the atomic structure and the 3D EM map.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.g001"/>
</fig>
<p>We should also mention that, due to the improved sampling of SO(3), the time taken by PF<sup>2</sup> <italic>fit</italic> for an average fitting exercise is comparable to most rival fitting schemes, taking 2–3 mins on an quad-core computer per fitting procedure. In particular, non-uniform inclusion potential takes advantage of the non-uniform search scheme to provide even faster (1.3 mins) runtimes with reasonably accurate estimates of the fitting pose while guaranteeing an exhaustive sampling of the space of available motions. Also, leveraging the focused search capability, PF<sup>2</sup> <italic>fit</italic> can be applied to a vast range of problem types, from subunit-subunit, to subunit-assembly, to multiple subunit fitting. We have extensively compared PF<sup>2</sup>Fit to ADP-EM (Ref. [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>]) in the experiments.</p>
<p>Executable programs as well as the source code for the entire software package PF<sup>2</sup> <italic>fit</italic> and each of its components libraries are available to all academic users for free through our website. We made the sampling of SO(3) and SE(3), and the non-uniform FFT search libraries separately available so that users can adapt and modify all or some of them independently.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and Methods</title>
<p>A typical fitting procedure starts with two inputs: an atomic structure 𝓟 and a 3D EM map 𝓜, normally at different resolutions. Let <italic>A</italic> : ℝ<sup>3</sup> ↦ ℂ and <italic>B</italic> : ℝ<sup>3</sup> ↦ ℂ be such scalar-valued functions derived from 𝓟 and 𝓜 respectively. Once <italic>A</italic>(<bold>x</bold>) and <italic>B</italic>(<bold>x</bold>): are defined, the best fit of the two molecules is obtained by maximizing the unnormalized cross-correlation score
<disp-formula id="pcbi.1004289.e001"><alternatives><graphic id="pcbi.1004289.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi> <mml:mi>C</mml:mi> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∫</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:mn>3</mml:mn></mml:msup></mml:msub> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">R</mml:mi> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where (<bold>R</bold>, <bold>t</bold>) is a rigid-body motion, i.e., a three-dimensional rotation <bold><italic>R</italic></bold> followed by a three-dimensional translation <bold>t</bold>. Applying the rigid-body motion which produces the maximum score will lead to the best fit.</p>
<p>In this paper, we shall refer to <italic>A</italic>(<bold><italic>x</italic></bold>) and <italic>B</italic>(<bold><italic>x</italic></bold>): as affinity functions. Our fitting procedure is divided into two main stages (cf. <xref ref-type="fig" rid="pcbi.1004289.g001">Fig 1</xref>): the exhaustive FFT-based search, and the reranking. We discuss each of these stages, their affinity functions and their advantages below. Detailed comparison and empirical results are presented in the Results section.</p>
<sec id="sec003">
<title>Non-uniform FFT-amenable affinity functions</title>
<p>PF<sup>2</sup> <italic>fit</italic> provides four choices for defining the affinity functions of <italic>A</italic>(<bold><italic>x</italic></bold>) and <italic>B</italic>(<bold><italic>x</italic></bold>): the Gaussian <italic>A</italic><sub>gc</sub> (respectively <italic>B</italic><sub>gc</sub>); the scattering potential <italic>A</italic><sub>sc</sub> (respectively <italic>B</italic><sub>sc</sub>); the non-uniform inclusion potential <italic>A</italic><sub>nu</sub>(respectively <italic>B</italic><sub>nu</sub>); and the complementary (pocket) space potential <italic>A</italic><sub>cs</sub>(respectively <italic>B</italic><sub>cs</sub>). The first three are based on the space occupancy of 𝓟 and 𝓜, and fourth is based on the complementary space of 𝓟 and 𝓜, denoted <italic>A</italic><sub>nu</sub> and <italic>B</italic><sub>nu</sub> respectively. A typical depiction of the space and complementary space can be found in <xref ref-type="fig" rid="pcbi.1004289.g002">Fig 2</xref>. For a description of how a complementary volume is computed, we refer to [<xref ref-type="bibr" rid="pcbi.1004289.ref031">31</xref>]. We now discuss each of the affinity functions in detail.</p>
<fig id="pcbi.1004289.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Schematic of representations used in our algorithms.</title>
<p>(A) PDB schematic, showing the target volume <italic>V</italic><sub>𝓟</sub> and the complementary volume <inline-formula id="pcbi.1004289.e002"><alternatives><graphic id="pcbi.1004289.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e002"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>V</mml:mi> <mml:mo>𝓟</mml:mo></mml:msub> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. (B) 3D EM map schematic, showing the target volume <italic>V</italic><sub>𝓜</sub> and the complementary volume <inline-formula id="pcbi.1004289.e003"><alternatives><graphic id="pcbi.1004289.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e003"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>𝓜</mml:mo></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Detailed definitions can be found in the Materials and Methods section.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.g002"/>
</fig>
<sec id="sec004">
<title>Non-uniform inclusion potential cross-correlation score (NCCS)</title>
<p>Let 𝓟<sub><italic>s</italic></sub> be a chosen subset of atoms of 𝓟, and let <italic>X</italic><sub><italic>s</italic></sub> be the union of spheres of the atoms of 𝓟<sub><italic>s</italic></sub>. Then
<disp-formula id="pcbi.1004289.e004"><alternatives><graphic id="pcbi.1004289.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e004"/><mml:math id="M4" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mtext>nu</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>Similarly, let <italic>m</italic> ∈ ℝ be a chosen scalar intensity value. Then
<disp-formula id="pcbi.1004289.e005"><alternatives><graphic id="pcbi.1004289.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e005"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>B</mml:mi> <mml:mtext>nu</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>𝓜</mml:mo> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo> <mml:mo>≥</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>For these definitions of <italic>A</italic><sub>nu</sub> and <italic>B</italic><sub>nu</sub>, a reasonable definition for 𝓟<sub><italic>s</italic></sub> is the set of backbone atoms of the 3D EM map, while <italic>m</italic> can be defined, following [<xref ref-type="bibr" rid="pcbi.1004289.ref013">13</xref>], as that intensity that results in an isocontour enclosing a volume equal to the volume enclosed by the molecular surface of 𝓟. Note that the envelope score in [<xref ref-type="bibr" rid="pcbi.1004289.ref013">13</xref>] is a uniform-grid-based version of the non-uniform inclusion potential CCS (hereafter the NCCS).</p>
</sec>
<sec id="sec005">
<title>Gaussian cross-correlation score (GCCS)</title>
<p>A classical and widely-used way to represent the protein 𝓟 is by Gaussian blurring, in which Gaussians
<disp-formula id="pcbi.1004289.e006"><alternatives><graphic id="pcbi.1004289.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e006"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>G</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mi>β</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>∥</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>π</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo form="prefix">ln</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:msup><mml:mi>R</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>∥</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>corresponding to atom centers <bold>x</bold><sub><italic>i</italic></sub> and radii <italic>r</italic><sub><italic>i</italic></sub>, are summed at each grid point <bold>x</bold>; the parameter <italic>β</italic> &gt; 0 describes the width of the Gaussian at medium height, <italic>R</italic> is the resolution of the target 3D EM map [<xref ref-type="bibr" rid="pcbi.1004289.ref032">32</xref>], and
<disp-formula id="pcbi.1004289.e007"><alternatives><graphic id="pcbi.1004289.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e007"/><mml:math id="M7" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>atoms</mml:mtext> <mml:mspace width="1pt"/><mml:mtext>of</mml:mtext> <mml:mspace width="1pt"/><mml:mo>𝓟</mml:mo></mml:mrow></mml:munder> <mml:msup><mml:mi>G</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<p>A Gaussian blur is thus a representation that reproduces the electrostatic potential of an atom at points very close to it. This formulation indirectly includes atomic masses by modulating the decay of the Gaussian kernel based on the radii of the atoms.</p>
</sec>
<sec id="sec006">
<title>Scattering potential cross-correlation score (SCCS)</title>
<p>An elastic scattering model of the electrostatic potential uses five parameters for each atom, thus yielding a more realistic reconstruction of the electrostatic potential. According to the elastic scattering model [<xref ref-type="bibr" rid="pcbi.1004289.ref033">33</xref>], the potential at each grid point <bold>x</bold> due to an atom at <bold>x</bold><sub><italic>i</italic></sub> is given by a sum of five Gaussians
<disp-formula id="pcbi.1004289.e008"><alternatives><graphic id="pcbi.1004289.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e008"/><mml:math id="M8" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>c</mml:mi></mml:mrow> <mml:mi>i</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>16</mml:mn> <mml:msup><mml:mi>π</mml:mi> <mml:mfrac><mml:mn>5</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msup> <mml:msup><mml:mi>ℏ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mi>e</mml:mi></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>5</mml:mn></mml:munderover> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>3</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mn>4</mml:mn> <mml:msup><mml:mi>π</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>∥</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
and
<disp-formula id="pcbi.1004289.e009"><alternatives><graphic id="pcbi.1004289.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>atoms</mml:mtext> <mml:mspace width="1pt"/><mml:mtext>of</mml:mtext> <mml:mspace width="1pt"/><mml:mi>P</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>c</mml:mi></mml:mrow> <mml:mi>i</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p>where 2<italic>π</italic>ℏ = <italic>h</italic> is the Planck constant, <italic>m</italic><sub>0</sub> and <italic>e</italic> are respectively the mass of and charge on the electron, <italic>a</italic><sub><italic>j</italic></sub> and <italic>b</italic><sub><italic>j</italic></sub> are empirical parameters [<xref ref-type="bibr" rid="pcbi.1004289.ref034">34</xref>] that depend on the element type of atom <italic>i</italic>, and <italic>R</italic> is the desired resolution of the representation <italic>A</italic> of the atomic structure 𝓟. Note the functions <italic>B</italic><sub><italic>gc</italic></sub> and <italic>B</italic><sub><italic>sc</italic></sub> are identical to the input cryo-EM density map 𝓜 or a suitably filtered version of 𝓜.</p>
<p>The scattering potential is well-known [<xref ref-type="bibr" rid="pcbi.1004289.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref036">36</xref>]; and has been used for fitting of high- resolution structures to cryo-EM maps in conjunction with constrained geometric simulations [<xref ref-type="bibr" rid="pcbi.1004289.ref037">37</xref>] or molecular dynamics simulations [<xref ref-type="bibr" rid="pcbi.1004289.ref038">38</xref>]. The primary motivation behind implementing the scattering potential in PF<sup>2</sup> <italic>fit</italic> is to explore its value as an alternative to Gaussian blurring since EM reconstruction is based on phase shifts and phase contrast caused by the electrostatic potential. As we show in the Results section), there occur cases, in both acquired and synthesized density map fitting, in which the scattering CCS (hereafter the SCCS) performs better than Gaussian CCS (hereafter the GCCS).</p>
</sec>
<sec id="sec007">
<title>Complementary space cross-correlation score (CCCS)</title>
<p>Existing work on rigid-body fitting focuses on representing and correlating the volumes <italic>V</italic><sub>𝓟</sub> and <italic>V</italic><sub>𝓜</sub> occupied by 𝓟 and 𝓜 respectively. We introduce an addition to the fitting score, the complementary space cross-correlation score (CCCS), that uses the volumes complementary to <italic>V</italic><sub>𝓟</sub> and <italic>V</italic><sub>𝓜</sub> respectively. We define the complementary volumes as follows.</p>
<p>Let <italic>V</italic><sub>𝓟</sub> be the primal volume occupied by the Gaussian molecular surface of 𝓟, and <italic>V</italic><sub>𝓜</sub> ⊂ <italic>R</italic><sup>3</sup> is the volume occupied by a suitably chosen molecular surface of 𝓜. Then the complementary volumes <inline-formula id="pcbi.1004289.e010"><alternatives><graphic id="pcbi.1004289.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e010"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>𝓟</mml:mo></mml:msub> <mml:mo>⊂</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004289.e011"><alternatives><graphic id="pcbi.1004289.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e011"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>𝓜</mml:mo></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, are extracted from respective pocket functions [<xref ref-type="bibr" rid="pcbi.1004289.ref039">39</xref>] that use outward and backward propagation from the primal volumes. Note that, we also use pocket and complementary space interchangeably in the rest of the article.</p>
<p>Given these representations, we can assign <italic>A</italic><sub>pp</sub> and <italic>B</italic><sub>pp</sub> in <xref ref-type="disp-formula" rid="pcbi.1004289.e001">Eq (1)</xref> as follows:
<disp-formula id="pcbi.1004289.e012"><alternatives><graphic id="pcbi.1004289.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e012"/><mml:math id="M12" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mtext>cs</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msqrt><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msqrt> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mover><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>𝓟</mml:mo></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula> <disp-formula id="pcbi.1004289.e013"><alternatives><graphic id="pcbi.1004289.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e013"/><mml:math id="M13" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>B</mml:mi> <mml:mtext>cs</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:msqrt><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msqrt> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mover><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>𝓜</mml:mo></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula></p>
</sec>
<sec id="sec008">
<title>Combining the affinity functions</title>
<p>All the affinity functions we introduced will result in a high positive real <italic>CCS</italic> for large overlaps between target-target or complementary-complementary volumes. One can, in principle, combine all the scoring terms by taking a weighted linear combination where the weights can be either user-specified or optimized by well-known machine learning techniques [<xref ref-type="bibr" rid="pcbi.1004289.ref040">40</xref>–<xref ref-type="bibr" rid="pcbi.1004289.ref044">44</xref>]. However, we note that the first three affinity functions represent and the same quantity of interest in slightly different ways and a combination of the three may be redundant. The complementary space score, however, captures a different aspect and should be used in conjunction with any of the first three. Hence, in this work, we compare the predictive performace and speed for each of target-target scores independently and in conjunction with the complementary space score.</p>
</sec>
<sec id="sec009">
<title>Expected advantages of the non-uniform FFT-amenable affinity functions</title>
<p>Classical, uniform FFT-based approaches require that affinity functions describing atomic structures or features are mapped onto a uniform grid. This mapping results in either (A) a grid-size much smaller than the average distance between atomic centers, and a resulting increase in time spent on redundant or uninteresting points far from the actual centre of the protein, or, (B) a grid-size much larger than the average distance between atomic centers, resulting in the opposite effect.</p>
<p>By contrast, a feature common to all the affinity functions in PF<sup>2</sup> <italic>fit</italic> is that they are grid-free, i.e., they do not necessarily require affinity functions to be computed on a uniform grid. This not only mitigates the disadvantage above but leads to ability to perform searches focused to a particular region. The Results section details this advantage of PF<sup>2</sup> <italic>fit</italic>.</p>
</sec>
</sec>
<sec id="sec010">
<title>Non-uniform SO(3) FFT-based Search</title>
<p>The second important ingredient of the inital search stage of rigid-body fitting, is the search algorithm PF<italic>corr</italic> (Polar Fast Fourier Correlation), first introduced in [<xref ref-type="bibr" rid="pcbi.1004289.ref029">29</xref>], to search over the space of rigid-body motions SE(3) of 𝓟. PF<italic>corr</italic> is a family of rigid-body correlation algorithms based on non-uniform SO(3) Fourier Transforms, and it has many favorable attributes relative to classical FFT-based search algorithms, the most salient of which we discuss here.</p>
<sec id="sec011">
<title>Multi-basis framework</title>
<p>PF<italic>corr</italic> uses a framework in which scalar-valued functions <italic>A</italic> : ℝ<sup>3</sup> ↦ ℂ are expressed in terms of basis-expansion coefficients <inline-formula id="pcbi.1004289.e014"><alternatives><graphic id="pcbi.1004289.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e014"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>∈</mml:mo> <mml:mo>ℂ</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Let <bold>u</bold> = (<italic>θ</italic>, <italic>ϕ</italic>), <italic>θ</italic> ∈ [0, <italic>π</italic>], <italic>ϕ</italic> ∈ [0, 2<italic>π</italic>], and <italic>r</italic> ∈ ℝ<sup>+</sup>. A scalar valued function <italic>A</italic>(<italic>r</italic>, <bold>u</bold>):ℝ<sup>+</sup> × 𝕊<sup>2</sup> → ℂ can be expanded as
<disp-formula id="pcbi.1004289.e015"><alternatives><graphic id="pcbi.1004289.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e015"/><mml:math id="M15" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mi>l</mml:mi></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>l</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>R</mml:mi> <mml:mi>k</mml:mi> <mml:mi>ℓ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>ℓ</mml:mi> <mml:mi>m</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <inline-formula id="pcbi.1004289.e016"><alternatives><graphic id="pcbi.1004289.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e016"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mi>k</mml:mi> <mml:mo>ℓ</mml:mo></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>r</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004289.e017"><alternatives><graphic id="pcbi.1004289.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e017"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mo>ℓ</mml:mo> <mml:mi>m</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are the radial and spherical basis functions respectively, and <italic>L</italic> is a finite expansion degree. We choose weighted Laguerre radial-basis functions for <inline-formula id="pcbi.1004289.e018"><alternatives><graphic id="pcbi.1004289.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e018"/><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mi>k</mml:mi> <mml:mo>ℓ</mml:mo></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>r</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (see [<xref ref-type="bibr" rid="pcbi.1004289.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref045">45</xref>] for the exact form of these functions), whereas <inline-formula id="pcbi.1004289.e019"><alternatives><graphic id="pcbi.1004289.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e019"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mo>ℓ</mml:mo> <mml:mi>m</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are the well-known spherical harmonic functions.</p>
<p>PF<italic>corr</italic> can also discard the radial-basis functions, following [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>], and express each spherical slice <italic>A</italic><sub><italic>r</italic></sub>(<bold>u</bold>) in terms of the spherical harmonic basis coefficients <inline-formula id="pcbi.1004289.e020"><alternatives><graphic id="pcbi.1004289.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e020"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mo>ℓ</mml:mo> <mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1004289.e021"><alternatives><graphic id="pcbi.1004289.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e021"/><mml:math id="M21" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mi>l</mml:mi></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>ℓ</mml:mi> <mml:mi>m</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula></p>
<p>PF<italic>corr</italic>, and hence the algorithm package PF<sup>2</sup> <italic>fit</italic>, thus support a multi-basis framework, in which a user can choose between either of the two most commonly used bases for rotational speedups. While convenient, the multi-basis framework is not central to our search scheme, and in the interests of brevity, we restrict our discussions below to situations in which the more general mixed bases <inline-formula id="pcbi.1004289.e022"><alternatives><graphic id="pcbi.1004289.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e022"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mi>k</mml:mi> <mml:mo>ℓ</mml:mo></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>r</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mo>ℓ</mml:mo> <mml:mi>m</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are used.</p>
<p>All of our algorithms extend in a straightforward, if non-trivial way, to cases where the radial basis function is absent and <xref ref-type="disp-formula" rid="pcbi.1004289.e021">Eq (11)</xref> instead of <xref ref-type="disp-formula" rid="pcbi.1004289.e015">Eq (10)</xref> is evaluated at a chosen set of fixed radii <italic>r</italic>, as it is the case in [<xref ref-type="bibr" rid="pcbi.1004289.ref019">19</xref>] and even [<xref ref-type="bibr" rid="pcbi.1004289.ref007">7</xref>] where <xref ref-type="disp-formula" rid="pcbi.1004289.e021">Eq (11)</xref> is evaluated for only one fixed <italic>r</italic>.</p>
</sec>
<sec id="sec012">
<title>Rotational and Rigid-body Correlations; Non-Uniform SO(3) Fourier Transforms</title>
<p>Let <italic>A</italic>(<bold>x</bold>) and <italic>B</italic>(<bold>x</bold>) be two scalar valued functions with basis coefficients <inline-formula id="pcbi.1004289.e023"><alternatives><graphic id="pcbi.1004289.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e023"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>l</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004289.e024"><alternatives><graphic id="pcbi.1004289.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e024"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>l</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> respectively. We are interested in the pure rotational correlation
<disp-formula id="pcbi.1004289.e025"><alternatives><graphic id="pcbi.1004289.e025g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e025"/><mml:math id="M25" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">R</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:mn>3</mml:mn></mml:msup></mml:msub> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">R</mml:mi> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mstyle></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>ℓ</mml:mi> <mml:mi>m</mml:mi> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>m</mml:mi></mml:msup> <mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>ℓ</mml:mi> <mml:mo>-</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mover><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>ℓ</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>¯</mml:mo></mml:mover> <mml:msubsup><mml:mi>D</mml:mi> <mml:mi>ℓ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">R</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
and the rigid-body correlation
<disp-formula id="pcbi.1004289.e026"><alternatives><graphic id="pcbi.1004289.e026g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e026"/><mml:math id="M26" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">R</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:mn>3</mml:mn></mml:msup></mml:msub> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">R</mml:mi> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mstyle></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>l</mml:mi> <mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>ℓ</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>D</mml:mi> <mml:mi>ℓ</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>B</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>n</mml:mi></mml:msup> <mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:msubsup><mml:mi>D</mml:mi> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>A</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>T</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>ℓ</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula></p>
<p>where (<bold>R</bold><sup><italic>A</italic></sup>,<bold>R</bold><sup><italic>B</italic></sup>, <italic>z</italic>) is the factorization of the rigid-body transformation (<bold>R</bold>, <bold>t</bold>) into rotations of <italic>A</italic> and <italic>B</italic> and a single translation of <italic>A</italic> along the z-axis [<xref ref-type="bibr" rid="pcbi.1004289.ref029">29</xref>]. The effect of rotation is described by the Wigner-D functions <inline-formula id="pcbi.1004289.e027"><alternatives><graphic id="pcbi.1004289.e027g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e027"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi> <mml:mo>ℓ</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> that are a set of basis functions for <italic>L</italic><sup>2</sup>(SO(3)). The effect of this translation is described by a translation tensor <italic>T</italic>(<italic>z</italic>) with elements <inline-formula id="pcbi.1004289.e028"><alternatives><graphic id="pcbi.1004289.e028g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e028"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>ℓ</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mo>ℓ</mml:mo> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mrow><mml:mo stretchy="false">∣</mml:mo> <mml:mi>n</mml:mi> <mml:mo stretchy="false">∣</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>z</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, cf. [<xref ref-type="bibr" rid="pcbi.1004289.ref046">46</xref>].</p>
<p>This factorization of a motion into five rotational degrees of freedon and one remaining translational degree has been used in the field of protein matching by [<xref ref-type="bibr" rid="pcbi.1004289.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref047">47</xref>] before. However, here it will be applied in a uniform setting and a fast evaluation algorithm for the first time.</p>
<p>PF<italic>corr</italic> [<xref ref-type="bibr" rid="pcbi.1004289.ref029">29</xref>] provides a pair of recipes to compute each of the above sums. The technical content of these recipes can be found in our work on non-uniform multi-dimensional correlations [<xref ref-type="bibr" rid="pcbi.1004289.ref029">29</xref>]. For the purposes of this work, the most relevant fact is its use of the non-uniform fast SO(3) Fourier transform (NFSOFT) [<xref ref-type="bibr" rid="pcbi.1004289.ref021">21</xref>]:
<disp-formula id="pcbi.1004289.e029"><alternatives><graphic id="pcbi.1004289.e029g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e029"/><mml:math id="M29" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mi>l</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mi>l</mml:mi></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>D</mml:mi> <mml:mi>l</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>…</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi mathvariant="bold">R</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula></p>
<p>where <inline-formula id="pcbi.1004289.e030"><alternatives><graphic id="pcbi.1004289.e030g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e030"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:mo>ℂ</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are the input SO(3) Fourier coefficients of <italic>f</italic> ∈ <italic>L</italic><sup>2</sup>(SO(3)). The Wigner-D functions <inline-formula id="pcbi.1004289.e031"><alternatives><graphic id="pcbi.1004289.e031g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e031"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi> <mml:mi>l</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> form a orthogonal basis of <italic>L</italic><sup>2</sup>(SO(3)), and <italic>i</italic> indexes <italic>N</italic><sub><bold>R</bold></sub> non-uniformly spaced z-y-z Euler Angles in SO(3).</p>
<p>This is a significant improvement over existing fitting tools. Due to the limitations of the uniform-FFT techniques that underly them, all current rotationally efficient methods [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref047">47</xref>] depend on a uniform discretization of Euler angular space. Unfortunately, because the space of Euler angles is a non-linear parametrization of the target space of rotations SO(3), this leads to a highly <italic>non-uniform</italic> set of samples in SO(3).</p>
<p>The expansion degree <italic>L</italic> embodies an aspect of the speed-accuracy tradeoff: higher degrees result in a greater ability to capture shape information in the 3D EM map, while causing an obvious degradation in performance. We find that setting <italic>L</italic> anywhere between 20 and 30 suffices for 3D EM map fitting exercises. The NFSOFT can be used to compute the above sum in 𝓞(<italic>L</italic><sup>3</sup>log<italic>L</italic> + <italic>N</italic><sub><bold>R</bold></sub>) steps, in contrast to the generally far slower naive 𝓞(<italic>L</italic><sup>3</sup> <italic>N</italic><sub><bold>R</bold></sub>) approach.</p>
</sec>
<sec id="sec013">
<title>Adapting PF<italic>corr</italic> for Fitting</title>
<p>We can see that the above recipes can be conveniently incorporated into a fitting search algorithm. As a preprocessing step, we compute the basis-expansion coefficients <inline-formula id="pcbi.1004289.e032"><alternatives><graphic id="pcbi.1004289.e032g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e032"/><mml:math id="M32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>l</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004289.e033"><alternatives><graphic id="pcbi.1004289.e033g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e033"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>l</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> of <italic>A</italic>(<bold>x</bold>) and <italic>B</italic>(<bold>x</bold>) respectively. Then based on the two recipes, one can choose either of the following search schemes.
<list list-type="order"><list-item><p><italic>Search choice 1: PF<sup>2</sup> <italic>fit</italic>—SE(3)</italic>: Compute <xref ref-type="disp-formula" rid="pcbi.1004289.e026">Eq (13)</xref> in 𝓞((<italic>L</italic><sup>6</sup> + <italic>L</italic><sup>4</sup> <italic>N</italic><sub><bold>R</bold><sup><italic>B</italic></sup></sub> + <italic>N</italic><sub><bold>R</bold><sup><italic>B</italic></sup></sub> <italic>N</italic><sub><bold>R</bold><sup><italic>A</italic></sup></sub>)<italic>T</italic>) steps over appropriate sample sets {<bold>R</bold><sup><bold>A</bold></sup>}, {<bold>R</bold><sup><bold>B</bold></sup>}, and {<italic>dz</italic>} where <italic>N</italic><sub><bold>R</bold><sup><italic>B</italic></sup></sub> and <italic>N</italic><sub><bold>R</bold><sup><italic>A</italic></sup></sub> are respectively the sizes of the sample sets {<bold>R</bold><sup><italic>A</italic></sup>} and {<bold>R</bold><sup><italic>B</italic></sup>}.</p></list-item> <list-item><p><italic>Search choice 2: PF<sup>2</sup> <italic>fit</italic> —SO(3)</italic>. For each <bold>t</bold> over a set of samples in ℝ<sup>3</sup>, translate <italic>A</italic> by <bold>t</bold> and recompute <inline-formula id="pcbi.1004289.e034"><alternatives><graphic id="pcbi.1004289.e034g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e034"/><mml:math id="M34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>l</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>; then compute <xref ref-type="disp-formula" rid="pcbi.1004289.e025">Eq (12)</xref> in 𝓞(<italic>L</italic><sup>4</sup>) steps over a set of samples in SO(3).</p></list-item></list></p>
<p>While PF<sup>2</sup> <italic>fit</italic> —SE(3) can be used along with any sampling technique, we use the sets {<bold>R</bold><sup><bold>A</bold></sup>}, {<bold>R</bold><sup><bold>B</bold></sup>}, along with equispaced grid values for {<italic>dz</italic>} for the first fitting stage in order to avoid overseeing important regions of motions while oversampling others. This low dispersion and low discrepancy sampling of SO(3) [<xref ref-type="bibr" rid="pcbi.1004289.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref029">29</xref>] is highly advantageous in the first stage of fitting as explained in the next paragraph.</p>
<p>PF<sup>2</sup> <italic>fit</italic> —SO(3) maximizes rotational scanning at the expense of translational scanning, an approach also adopted in [<xref ref-type="bibr" rid="pcbi.1004289.ref019">19</xref>] and [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>]. Note that both these methods use a framework that excludes the radial basis function <inline-formula id="pcbi.1004289.e035"><alternatives><graphic id="pcbi.1004289.e035g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e035"/><mml:math id="M35" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mi>k</mml:mi> <mml:mo>ℓ</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, e.g. due to the consideration of star-shaped molecules and discretizations of the radial parts respectively.</p>
</sec>
<sec id="sec014">
<title>Expected advantages of the non-uniform SO(3) FFT-based search</title>
<p>Like the NFSOFT, PF<sup>2</sup> <italic>fit</italic> scales gracefully under non-uniform discretizations of the space of z-y-z Euler Angles. This is a significant improvement over existing fitting tools [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref047">47</xref>] that depend on a uniform discretization of Euler angular space. Hence, for a given angular step size, these methods will always generate sample sets in SO(3) that examine parts of that space very finely while leaving others undiscovered. By contrast, an advantage of PF<sup>2</sup> <italic>fit</italic> is its ability to work efficiently with an arbitrary set of samples in Euler angular space, using a sampling technique such as in [<xref ref-type="bibr" rid="pcbi.1004289.ref024">24</xref>]. This is the primary advantage of PF<sup>2</sup> <italic>fit</italic> as a search algorithm. The consequences of this advantage extend naturally to all results obtained by PF<sup>2</sup> <italic>fit</italic>.</p>
</sec>
</sec>
<sec id="sec015">
<title>The Reranking Scheme</title>
<p>In the second stage, results obtained in the correlation-amenable search stage are reranked with respect to scores that exhibit the following features: (A) They cannot be expressed in the general form of <xref ref-type="disp-formula" rid="pcbi.1004289.e001">Eq (1)</xref>. (B) The information they capture about a particular fitting orientation is additional to, or, ideally, independent of, each of the affinity functions maximized in the search stage.</p>
<sec id="sec016">
<title>Skeleton-secondary structure score</title>
<p>We introduce a reranking score that depends on the detection of secondary structural features from 𝓜. This has been a vigorous area of research in the past decade; for a recent review, see, for instance [<xref ref-type="bibr" rid="pcbi.1004289.ref048">48</xref>]. We use the skeletonization technique in [<xref ref-type="bibr" rid="pcbi.1004289.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref048">48</xref>] to detect secondary structures from 𝓜, and the publicly available Stride [<xref ref-type="bibr" rid="pcbi.1004289.ref049">49</xref>] to detect the secondary structures of 𝓟. Let 𝓗<sub>𝓜</sub> and 𝓗<sub>𝓟</sub> respectively be the set of helices detected from 𝓜 and 𝓟. Each helix consists of an axis <bold>r</bold>, with ‖<bold>r</bold>‖<sub>ℓ<sub>2</sub></sub> = 1, and a midpoint <bold>p</bold>. Let <inline-formula id="pcbi.1004289.e036"><alternatives><graphic id="pcbi.1004289.e036g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e036"/><mml:math id="M36" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mtext mathvariant="bold">h</mml:mtext> <mml:mi>i</mml:mi> <mml:mo>𝓜</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> be a helix in 𝓗<sub>𝓜</sub>, and let <inline-formula id="pcbi.1004289.e037"><alternatives><graphic id="pcbi.1004289.e037g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e037"/><mml:math id="M37" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mtext mathvariant="bold">h</mml:mtext> <mml:mi>j</mml:mi> <mml:mo>𝓟</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> be a helix in 𝓗<sub>𝓟</sub>. Let <italic>d</italic>(.,.) be the Euclidean distance function, ⟨.,.⟩ be the dot product, and <italic>w</italic><sub>1</sub> ∈ ℝ<sup>−</sup>, <italic>w</italic><sub>2</sub> ∈ ℝ<sup>+</sup> be respectively negative and positive weights. Then the per-helix score and the secondary structural score are respectively given by
<disp-formula id="pcbi.1004289.e038"><alternatives><graphic id="pcbi.1004289.e038g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e038"/><mml:math id="M38" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true"><mml:mrow><mml:mi>S</mml:mi> <mml:mi>S</mml:mi> <mml:msub><mml:mi>S</mml:mi> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>j</mml:mi> <mml:mo>𝓟</mml:mo></mml:msubsup></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo movablelimits="true" form="prefix">max</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>w</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mi>d</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">p</mml:mi> <mml:mi>i</mml:mi> <mml:mo>𝓜</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">p</mml:mi> <mml:mi>j</mml:mi> <mml:mo>𝓟</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">r</mml:mi> <mml:mi>i</mml:mi> <mml:mo>𝓜</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">r</mml:mi> <mml:mi>j</mml:mi> <mml:mo>𝓟</mml:mo></mml:msubsup> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula> <disp-formula id="pcbi.1004289.e039"><alternatives><graphic id="pcbi.1004289.e039g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e039"/><mml:math id="M39" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi> <mml:mi>S</mml:mi> <mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mi>S</mml:mi> <mml:mi>S</mml:mi> <mml:msub><mml:mi>S</mml:mi> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>j</mml:mi> <mml:mi>P</mml:mi></mml:msubsup></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula></p>
<p>In this work, we set <italic>w</italic><sub>1</sub> = −1, <italic>w</italic><sub>2</sub> = 1, in which case the theoretical range of the per-helix score <inline-formula id="pcbi.1004289.e040"><alternatives><graphic id="pcbi.1004289.e040g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e040"/><mml:math id="M40" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi> <mml:mi>S</mml:mi> <mml:msub><mml:mi>S</mml:mi> <mml:msubsup><mml:mtext mathvariant="bold">h</mml:mtext> <mml:mi>j</mml:mi> <mml:mo>𝓟</mml:mo></mml:msubsup></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is (−∞,1]. The best possible per-helix score corresponds to the situation where the helices are perfectly aligned and have the same mid point, and <inline-formula id="pcbi.1004289.e041"><alternatives><graphic id="pcbi.1004289.e041g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e041"/><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi> <mml:mi>S</mml:mi> <mml:msub><mml:mi>S</mml:mi> <mml:msubsup><mml:mtext mathvariant="bold">h</mml:mtext> <mml:mi>j</mml:mi> <mml:mo>𝓟</mml:mo></mml:msubsup></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. In most practical scenarios, <inline-formula id="pcbi.1004289.e042"><alternatives><graphic id="pcbi.1004289.e042g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e042"/><mml:math id="M42" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi> <mml:mi>S</mml:mi> <mml:msub><mml:mi>S</mml:mi> <mml:msubsup><mml:mtext mathvariant="bold">h</mml:mtext> <mml:mi>j</mml:mi> <mml:mo>𝓟</mml:mo></mml:msubsup></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is typically between 0.25 and 0.7.</p>
</sec>
<sec id="sec017">
<title>Mutual information score</title>
<p>The second reranking function we use is the mutual information score (see, for instance, [<xref ref-type="bibr" rid="pcbi.1004289.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref030">30</xref>]), given by
<disp-formula id="pcbi.1004289.e043"><alternatives><graphic id="pcbi.1004289.e043g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e043"/><mml:math id="M43" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi> <mml:mi>I</mml:mi> <mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>y</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>A</mml:mi></mml:mrow></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">log</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula></p>
<p>where <italic>p</italic>(<italic>x</italic>) and <italic>p</italic>(<italic>y</italic>) are the percentage of voxels in <italic>B</italic> and <italic>A</italic> that take on intensities equal to <italic>x</italic> and <italic>y</italic> respectively and <italic>p</italic>(<italic>x</italic>, <italic>y</italic>) is the percentage of voxels in <italic>B</italic> with intensity <italic>x</italic> that are aligned with voxels in <italic>A</italic> with intensity <italic>y</italic>. In PF<sup>2</sup> <italic>fit</italic>, <italic>A</italic> and <italic>B</italic> correspond respectively to the target volumes <italic>V</italic><sub>𝓟</sub> and <italic>V</italic><sub>𝓜</sub> respectively, with the former computed by the Gaussian blurring scheme.</p>
</sec>
<sec id="sec018">
<title>Expected advantages of the reranking scheme</title>
<p>The reranking stage serves two purposes. The first is to identify spurious results. Any fitting method that depends purely on a set of correlation-amenable affinity functions has the potential to yield high-scoring results that are nevertheless obviously incorrect. The second, related, goal of the reranking stage is to bring the process of rigid-body fitting closer to automation. We see fitting as a single stage in the elucidation of structure from biological data. The elucidation process comprises several data processing stages, and it is critical that the output of each stage is as accurate as it can be. One very popular way to measure the accuracy of a fitting algorithm is to perform a simple visual check; however, it may be time-consuming or otherwise impractical to visually check every single fitting pose generated by an automated fitting algorithm such as the one presented here. In these situations, the reranking procedure will either provide additional guarantees that the top result is in fact the one that fits the best, or will flag results whose scores do not agree about the quality of the fit.</p>
</sec>
</sec>
<sec id="sec019">
<title>Experimental Setup</title>
<p>We carried out experiments to compare different scoring and reranking functions implemented in PF<sup>2</sup> <italic>fit</italic> as well as to compare PF<sup>2</sup> <italic>fit</italic> with other publicly available fitting software, namely the Colores tool in Situs [<xref ref-type="bibr" rid="pcbi.1004289.ref018">18</xref>] and ADP_EM [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>]. In this section, we describe the benchmark dataset, the experiment protocol and the metric used in measuring and comparing accuracy of fitting. The results and their implications are presented in the next section (Results and Discussion).</p>
<sec id="sec020">
<title>Dataset</title>
<p>For experiments involving synthesized 3D EM maps, we used a variety of atomic structures from the PDB. Many of these atomic structures overlap with those in the docking benchmark [<xref ref-type="bibr" rid="pcbi.1004289.ref050">50</xref>]; they were chosen mainly for their diversity in size and shape (average TM-score [<xref ref-type="bibr" rid="pcbi.1004289.ref051">51</xref>] between the structures is 0.27165, which indicates very low structural similarity). The PDB IDs of the 53 atomic structures we used are: 1QG4a, 1OUNab, 1D6Oa, 1IASa, 2TGT, 1K9Ba, 1MH1, 1HH8a, 1FPZf, 1B39a, 2CGAb, 1EGL, 1AY1hl, 1CMWa, 1BJ1hl, 2VPFgh, 1A6Zab, 1C68ab, 1GJRa, 1CZPa, 1TNDc, 1FQIa, 1FGNlh, 1TFHa, 1HCL, 1DKSa, 1GJRa, 1CZPa, 2CLRde, 1CD8ab, 1FSKbc, 1BV1, 1IJJb, 3DNI, 1BVLba, 3LZT, 9RSAb, 2BNH, 1TRMa, 1ECZab, 1FSKbc, 1BV1, 1E1Na, 1CJEd, 4PEP, 1F32a, 1BDD, 1FC1ab, 1QHDa, 1OELg, 1AONa, 1CTS, 2CTS and 1Q3Qa. We generated synthesized 3D EM maps for each model 𝓟 of this benchmark, by first blurring it at a fixed resolution <italic>R</italic> to produce a synthesized map <italic>B</italic> which mimics an EM; and then a random transformation is applied to the original model 𝓟 to generate 𝓟′. Now, the task is to find the best fit between 𝓟′ and the map <italic>B</italic>.</p>
<p>For acquired 3D EM map experiments, we used a selection of datasets from the CryoEM Challenge [<xref ref-type="bibr" rid="pcbi.1004289.ref020">20</xref>]. The resolutions for these cryoEM 3D EM maps range between 3.8Å to 20Å and is hence lower than for the synthesized data.</p>
</sec>
<sec id="sec021">
<title>Experiments</title>
<p>We performed the following experiments to validate PF<sup>2</sup> <italic>fit</italic>. Each of the experiments inherently validates the search scheme introduced in this work. Additionally, they validate, compare and highlight aspects of one or more of our affinity functions and scores.
<list list-type="bullet"><list-item><p><italic>Validating different scoring terms using synthesized 3D EM map and comparison with other software</italic>. We applied our PF<sup>2</sup> <italic>fit</italic>—SE(3) and PF<sup>2</sup> <italic>fit</italic>—SO(3) algorithms using each of our target-target scores GCCS, NCCS and SCCS, independently, to predict the orientation of 𝓟′ that produces a good fit to <italic>B</italic>. Examples of this experiment are visualized in Figs <xref ref-type="fig" rid="pcbi.1004289.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1004289.g004">4</xref>.</p>
<p>We repeated the experiments with the complementary scoring term (CCCS) added in and compared our obtained results to the results reported in [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>] on similar experiments carried out with colores [<xref ref-type="bibr" rid="pcbi.1004289.ref018">18</xref>] and ADP_EM [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>]. We also compared the performance of PF<sup>2</sup> <italic>fit</italic> with other software in fitting electron microscope acquired data for subunit-subunit and subunit-assembly cases. Details are presented in the Discussions Section. See also [<xref ref-type="bibr" rid="pcbi.1004289.ref020">20</xref>].</p></list-item> <list-item><p><italic>Analyzing resolution robustness of scoring and search using synthesized 3D EM maps</italic>. In reality, the EM maps come in many different resolutions. To verify that our scoring models and search scheme preserves their applicability across a wide range of resolutions, while making fitting predictions with high accuracies, we progressively coarsened the resolution <italic>R</italic> of the target blurred 3D EM map <italic>B</italic>, and repeated the above experiments for each level of coarsening. Finally, the experiments were repeated with random Gaussian additive noise added to <italic>B</italic>.</p></list-item> <list-item><p><italic>Analyzing the effect of reranking using synthesized 3D EM map</italic>. To measure the efficacy of the reranking metrics, we examined the 53 PDBs in our synthesized dataset with resolutions between 5 and 15Å, with a step size of two, thus conducting 318 fitting experiments.</p></list-item> <list-item><p><italic>Analyzing the effect of various samplings using synthesized 3D EM map</italic>. To evaluate the speed-vs-accuracy tradeoff for PF<sup>2</sup> <italic>fit</italic>, we applied PF<sup>2</sup> <italic>fit</italic> on the synthesized dataset while varying the density of the sampling of SO(3) used in the search. For each of the structures, we used 1854, 4392, 8580, 14868, 29025, 68760, and 232020 samples on SO(3) corresponding to, respectively, rotational separations of 20, 15, 12, 10, 8, 6 and 4 degrees between samples. Additionally for the NCCS, we ran the same experiments while varying the expansion degree (L).</p></list-item> <list-item><p><italic>Performance on acquired 3D EM map Fitting</italic>. We applied PF<sup>2</sup> <italic>fit</italic> to acquired cryoEM data, which is more challenging than synthesized map fitting since it may contain non-random noise, differences in conformations of the molecule, and possibly more than one molecule in a complex. We performed three types of fitting with acquired EM maps. First, we used PF<sup>2</sup> <italic>fit</italic> —SE(3) and—SO(3) to fit PDB subunits to subunits segmented from the 3D EM map (subunit-subunit). Segmentation was performed using the methods reported in [<xref ref-type="bibr" rid="pcbi.1004289.ref052">52</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref053">53</xref>]. Second, we used PF<sup>2</sup> <italic>fit</italic> —SE(3) to fit a single PDB subunit into a larger 3D EM map (subunit-assembly). And third, we used PF<sup>2</sup> <italic>fit</italic> —SE(3) to fit multiple PDB subunits into a larger 3D EM map.</p></list-item></list></p>
<fig id="pcbi.1004289.g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.g003</object-id> <label>Fig 3</label> <caption><title>Comparison of PF<sup>2</sup> <italic>fit</italic> with other software in synthesized EM fitting at 3Å.</title> <p>A molecule is fitted into the synthetically generated EM map <italic>B</italic> with resolution 3Å(transparent green). The top-ranked result 𝓟<sub>1</sub> (red/yellow) is compared to the original PDB molecule 𝓟 (blue). (A) Top-ranked result using PF<sup>2</sup> <italic>fit</italic> —SE(3) with 8° uniform rotational sampling and 0.5Å translational step size. RMSD ≈ 0.88Å. (B) Top-ranked result using the Colores package; the ‘nopowell’ option is turned on. RMSD ≈ 3.2Å. (C) Top-ranked result using Colores with default options. RMSD ≈ 2.3Å. The fitted PDB 𝓟<sub>1</sub> is in yellow. (D) Top-ranked result using the ADP_EM package, with bandwidth <italic>L</italic> = 25. RMSD ≈ 0.94Å.</p></caption> <graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.g003"/></fig> <fig id="pcbi.1004289.g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.g004</object-id> <label>Fig 4</label> <caption><title>Comparison of PF<sup>2</sup> <italic>fit</italic> with other software in synthesized EM fitting at 10Å.</title>
<p>(A) The synthetically generated 3D EM map is a Gaussian blurred version of the PDB 7CAT (chains A and B), with resolution <italic>R</italic> = 10Å, and random noise added to obtain a signal-to-noise ratio of unity. The PDB 𝓟 (inset) is chain B of the same protein. The top-ranked result 𝓟<sub>1</sub> (red/yellow) is compared to the original PDB molecule 𝓟 (blue). (B) Top-ranked result using PF<sup>2</sup> <italic>fit</italic> —SE(3) with 8° uniform rotational sampling and 0.5Å translational step size has RMSD = 0.73Å. (C) Top-ranked result using Colores with default options has RMSD = 1.096Å. (D) Top-ranked result using the ADP_EM package, with bandwidth <italic>L</italic> = 25 has RMSD = 0.814Å.</p></caption> <graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.g004"/></fig>
</sec>
<sec id="sec022">
<title>Validation Metrics</title>
<p>For the experiments involving synthesized maps, the true position or true fitting is simply the original position of the PDB model 𝓟. After a randomly oriented copy 𝓟′ of the model is fitted using PF<sup>2</sup> <italic>fit</italic>, it produces a new position and orientation, 𝓟′′. For perfectly accurate fitting, 𝓟′′ should perfectly coincide with 𝓟. We simply compute the root mean square distance (RMSD) based on the positions of the atoms in 𝓟′′ and 𝓟, as a measure of the accuracy such that lower RMSD indicates a better fitting prediction.</p>
<p>For both synthesized and acquired EM maps, we additionally use the external total ratio (ETR) as a metric of fitting quality. ETR is the ratio of the number of atoms outside a suitably picked isocontour of the 3D EM map to the total number of atoms in the PDB. We term this score the external-total ratio (ETR) [<xref ref-type="bibr" rid="pcbi.1004289.ref020">20</xref>]. ETR is a very subjective measure as it depends on the choice of the isocontour and hence should only be used when a better metric (e.g. RMSD) cannot be computed.</p>
<p>Finally, as a measure of the confidence on the prediction, we use Z-score. The Z-score [<xref ref-type="bibr" rid="pcbi.1004289.ref054">54</xref>] of a fitting result is given by <inline-formula id="pcbi.1004289.e044"><alternatives><graphic id="pcbi.1004289.e044g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e044"/><mml:math id="M44" display="inline" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>x</mml:mi> <mml:mo>−</mml:mo> <mml:mi>μ</mml:mi></mml:mrow> <mml:mi>σ</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>x</italic> is the score of the fitting result, and <italic>μ</italic> and <italic>σ</italic> are respectively the average and the standard deviation of the population. The Z-score measures the degree to which a scoring function can discriminate between two different candidate solutions, with higher scores indicating better discriminatory ability.</p>
</sec>
</sec>
</sec>
<sec id="sec023" sec-type="conclusions">
<title>Results and Discussion</title>
<p>In this section, we discuss the relative performance of the different Cross Correlation Scoring (CCS) terms introduced in PF<sup>2</sup> <italic>fit</italic>, in terms of the results obtained from the experiments on both synthesized and electron microscope acquired data and compare the performance of PF<sup>2</sup> <italic>fit</italic> with Colores and ADP_EM [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>]. We also discuss the effect of reranking shemes, skeleton-secondary structure score (SSS) and the mutual information score (MIS). Finally, we discuss some unique advantages offered by PF<sup>2</sup> <italic>fit</italic>.</p>
<sec id="sec024">
<title>The scattering potential CCS is a valuable alternative to the Gaussian CCS</title>
<p>Gaussian blurring have usually been the method of choice for fitting software. In this paper, we introduced the scattering potential which provides a better model of the electron density than Gaussian. In our experiments on both synthesized and acquired EM data, we found that SCCS is a valuable alternative to the GCCS, one whose performance is similar and stable across a range of resolutions.</p>
<sec id="sec025">
<title>On synthetized EM data</title>
<p>We compare the GCCS with the SCCS in <xref ref-type="table" rid="pcbi.1004289.t001">Table 1</xref>, Figs <xref ref-type="fig" rid="pcbi.1004289.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1004289.g006">6</xref>. When compared to the GCCS, the SCCS produced results with lower RMSD for the same resolution, both in the presence and the absence of noise, cf. Figs <xref ref-type="fig" rid="pcbi.1004289.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1004289.g006">6</xref>. However, the average rank of the of the best RMSD result might be lower for SCCS than GCCS as can be seen in <xref ref-type="table" rid="pcbi.1004289.t001">Table 1</xref>.</p>
<table-wrap id="pcbi.1004289.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.t001</object-id>
<label>Table 1</label>
<caption>
<title>Average rank, rounded to the nearest integer, of best RMSD result returned by PF<sup>2</sup> <italic>fit</italic> —SE(3) in the initial search stage for synthetic maps at different resolutions.</title>
<p>The figure in brackets in the second and third columns denotes the rank in the presence of noise at SNR = 1. See the section on “Datasets” for a list of PDBs used in this experiment. Note that even if the rank of the best RMSD is lower for SCCS in some cases, the actual RMSDs are generally lower, cf. Figs <xref ref-type="fig" rid="pcbi.1004289.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1004289.g006">6</xref>.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004289.t001g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.t001"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="1" colspan="1">Resolution (Å)</th>
<th align="center" rowspan="1" colspan="1">Rank—GCCS</th>
<th align="center" rowspan="1" colspan="1">Rank—SCCS</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="1" colspan="1">5</td>
<td align="center" rowspan="1" colspan="1">1 (1)</td>
<td align="center" rowspan="1" colspan="1">1 (1)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">9</td>
<td align="center" rowspan="1" colspan="1">1 (1)</td>
<td align="center" rowspan="1" colspan="1">1 (1)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">13</td>
<td align="center" rowspan="1" colspan="1">1 (1)</td>
<td align="center" rowspan="1" colspan="1">1 (2)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">17</td>
<td align="center" rowspan="1" colspan="1">2 (2)</td>
<td align="center" rowspan="1" colspan="1">2 (3)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">21</td>
<td align="center" rowspan="1" colspan="1">1 (3)</td>
<td align="center" rowspan="1" colspan="1">2 (5)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">27</td>
<td align="center" rowspan="1" colspan="1">1 (3)</td>
<td align="center" rowspan="1" colspan="1">3 (5)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">31</td>
<td align="center" rowspan="1" colspan="1">2 (3)</td>
<td align="center" rowspan="1" colspan="1">3 (5)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">35</td>
<td align="center" rowspan="1" colspan="1">2 (5)</td>
<td align="center" rowspan="1" colspan="1">4 (7)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">39</td>
<td align="center" rowspan="1" colspan="1">2 (7)</td>
<td align="center" rowspan="1" colspan="1">5 (7)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">43</td>
<td align="center" rowspan="1" colspan="1">2 (7)</td>
<td align="center" rowspan="1" colspan="1">5 (7)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">47</td>
<td align="center" rowspan="1" colspan="1">2 (8)</td>
<td align="center" rowspan="1" colspan="1">6 (7)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1004289.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Resolution robustness and comparison of scattering potential (SCCS) and Gaussian (GCCS) scores for synthesized data.</title>
<p>We plot the RMSD of the top-ranked result as a function of the resolution of the EM map used for the fit. See the section titled “Dataset” for a list of PDBs used in this experiment. (A) Average resolution-dependent RMSD of the top-ranked result returned by PF<sup>2</sup> <italic>fit</italic> —SE(3) in the absence and presence of noise for the GCCS and the SCCS. (B) Average Z-Score for the ten top results in the absence of noise. Z-Scores in the presence of noise follow the same trend.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.g005"/>
</fig>
<fig id="pcbi.1004289.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Effect of complementary space scoring for synthesized data.</title>
<p>Using the complementary space scores from (A) <xref ref-type="disp-formula" rid="pcbi.1004289.e012">Eq (8)</xref> and (B) <xref ref-type="disp-formula" rid="pcbi.1004289.e013">Eq (9)</xref>, with <italic>w</italic><sub>comp</sub> = 1, <italic>w</italic><sub>target</sub> = 1 we plot the RMSD as a function of the resolution of the EM map. See the section titled “Dataset” for a list of PDBs used in this experiment.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.g006"/>
</fig>
<p>Another illuminating trend is the slope of each of the curves in <xref ref-type="fig" rid="pcbi.1004289.g005">Fig 5</xref>, which reveals that results returned by the GCCS degrade more sharply than those from the SCCS. Note that both the GCCS and the SCCS yielded better RMSDs on average than ADP_EM (see [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>], <xref ref-type="fig" rid="pcbi.1004289.g001">Fig 1</xref>), yielding on average lower RMSD results at the same synthesized EM resolution.</p>
<p>
<xref ref-type="table" rid="pcbi.1004289.t001">Table 1</xref> gives the the average rank of the best RMSD result returned by PF<sup>2</sup> <italic>fit</italic> —SE(3).</p>
</sec>
<sec id="sec026">
<title>On acquired EM data from the cryoEM challenge</title>
<p>We also compared results obtained from acquired cryo-EM 3D EM map fitting (Experiment 3) using both the GCCS and SCCS. In this experiment, the RMSD cannot be measured, as there is no atomic structure corresponding to 𝓜. Instead, we use the number of atoms excluded outside a given iso-contoured molecular surface to compare the performances of the rival CC scores. The results, in <xref ref-type="table" rid="pcbi.1004289.t002">Table 2</xref>, show that for fitting with acquired 3D EM maps, the SC yielded on average results that exclude 2–4 fewer residues than the GCCS. This is in keeping with the expectation that the SCCS is closer to acquired 3D EM map reconstructions than the GCCS, and is thus able to yield a better correlation in situations where such 3D EM maps are involved.</p>
<table-wrap id="pcbi.1004289.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.t002</object-id>
<label>Table 2</label>
<caption>
<title>Results of applying PF<sup>2</sup> <italic>fit</italic> —SE(3) on a selection of datasets from the cryoEM modeling challenge (Experiment 3) using both the GCCS and SCCS.</title>
<p>An error measure similar to ETR is provided as the number of residues excluded outside a given iso-contoured molecular surface. The SCCS yielded on average results that exclude 2–4 fewer residues than the GCCS.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004289.t002g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.t002"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">Type of Experiment</th>
<th align="left" rowspan="1" colspan="1">Data</th>
<th align="left" rowspan="1" colspan="1">GCCS</th>
<th align="left" rowspan="1" colspan="1">SCCS</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">subunit-subunit</td>
<td align="left" rowspan="1" colspan="1">GroEL <sub><sc>(𝓟 = 1AONb, 𝓜 = EMD 1461 @7.7 Å)</sc></sub></td>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">subunit-subunit</td>
<td align="left" rowspan="1" colspan="1">GroEL <sub><sc>(𝓟 = 1OELg, 𝓜 = EMD 5001 @4.2 Å)</sc></sub></td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">subunit-assembly</td>
<td align="left" rowspan="1" colspan="1">GroEL <sub><sc>(𝓟 = 1WE3b, 𝓜 = EMD 1180 @7.7 Å)</sc></sub></td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">subunit-subunit</td>
<td align="left" rowspan="1" colspan="1">mm-cpn <sub><sc>(𝓟 = 1Q3Qb, 𝓜 = EMD 5137 @ 4.3 Å)</sc></sub></td>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">subunit-subunit</td>
<td align="left" rowspan="1" colspan="1">Rotavirus <sub><sc>(𝓟 = 1QHDa, 𝓜 = EMD 1461 @ 3.8 Å)</sc></sub></td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">multiple subunit-assembly</td>
<td align="left" rowspan="1" colspan="1">SIV <sub><sc>(𝓟 = 3DNO, 𝓜 = EMD 5020 @ 20 Å)</sc></sub></td>
<td align="left" rowspan="1" colspan="1">17</td>
<td align="left" rowspan="1" colspan="1">10</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Put together, these observations imply that the SCCS is an effective alternative to the GCCS in microscope acquired density-map fitting scenarios, since it is a more realistic representation of a 3D EM map. This conclusion applies not just to the problem of rigid-body fitting, considered in this work, but to the harder problem of flexible fitting, where it is critical that the representation of 𝓟 be as close to the target 3D EM map as possible. We note that there is a tiny overhead in computing the SCCS relative to the GCCS due to the former being a sum of five Gaussians.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004289.g005">Fig 5</xref> suggests that for lower resolutions (&lt; 20Å), it might be sensible to use more resolution robust scoring functions like the cross-correlation score normalized with respect to mean value and standard deviation as proposed in [<xref ref-type="bibr" rid="pcbi.1004289.ref009">9</xref>]. These normalized scoring function could be used in a straightforward manner in our PF<sup>2</sup> <italic>fit</italic> software either as a preprocessing step for the EM maps or as an additional FFT-amenable scoring function.</p>
</sec>
</sec>
<sec id="sec027">
<title>Complementary space cross-correlation score improves predictions</title>
<p>The addition of the complementary space cross-correlation score (CCCS), or the pocket score, (<xref ref-type="fig" rid="pcbi.1004289.g006">Fig 6</xref>) to the scoring function resulted in tangible improvements to the quality of the obtained fit across the range of resolutions. This was observed with the GCCS (<xref ref-type="disp-formula" rid="pcbi.1004289.e007">Eq (5)</xref>), as well as the SCCS, and both in the presence and absence of noise. The improvement in the quality of the results obtained is most dramatic at values of <italic>R</italic> beyond 15Å.</p>
</sec>
<sec id="sec028">
<title>Low Discrepancy Sampling Results in Better Speed-Accuracy Trade-off</title>
<p>Fitting is essentially an optimization problem in a high dimensional configuration space. In PF<sup>2</sup> <italic>fit</italic>, and any other existing methods, the configuration space is discretized to a small number of discrete samples where the scoring terms are evaluated and the maximum/minimum is reported. Now, let 𝓕 be the scoring term and 𝓒 be the configuration space, from which <italic>N</italic> discrete samples are taken. Then if the true maximum value is <italic>m</italic>*(𝓕) = <italic>max</italic><sub><italic>x</italic>∈𝓒</sub>𝓕(<italic>X</italic>), and the sampled maximum value is <italic>m</italic><sup>𝓢</sup>(𝓕) = <italic>max</italic><sub><italic>x</italic>∈𝓢</sub>𝓕(<italic>X</italic>)- then it is guaranteed that <italic>m</italic>*(𝓕)−<italic>m</italic><sup>𝓢</sup>(𝓕) ≤ <italic>ω</italic><sub>𝓒</sub>(𝓕, <italic>d</italic><sub><italic>N</italic></sub>) (see Theorem 6.4 in [<xref ref-type="bibr" rid="pcbi.1004289.ref055">55</xref>]), where <italic>d</italic><sub><italic>N</italic></sub> is the dispersion of the samples in 𝓒, and <italic>ω</italic> is a measure of the continuity of 𝓕. So, for a given 𝓕 and 𝓒, the error is directly correlated with dispersion of the <italic>N</italic> discrete samples.</p>
<p>In PF<sup>2</sup> <italic>fit</italic>, we use the low-discrepancy and low-dispersion sampling scheme for SO(3) space described in [<xref ref-type="bibr" rid="pcbi.1004289.ref024">24</xref>]. By contrast, existing fitting software [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref047">47</xref>], due to their use of uniform-FFT, requires uniformity in the parameters used to represent the orientations in SO(3), for example uniform sampling of <italic>θ</italic>, <italic>ϕ</italic> and <italic>ψ</italic> Euler angles or icosahedral vertices on the sphere as in [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>]. But such uniform sampling of the parameters might lead to <italic>non-uniform</italic> set of samples in SO(3), leaving large gaps (high-dispersion) in some places, showing high discrepancy or not sufficiently reflecting the topological structure of the underlying domain, cf. [<xref ref-type="bibr" rid="pcbi.1004289.ref024">24</xref>]. Since, PF<sup>2</sup> <italic>fit</italic> uses a non-uniform polar FFT (NFSOFT [<xref ref-type="bibr" rid="pcbi.1004289.ref021">21</xref>]), it is able to handle non-uniformity in the Euler angles (which leads to uniformity, in low-discrepancy sense, in SO(3)). As a result PF<sup>2</sup> <italic>fit</italic> can achieve high accuracies even with very limited number of samples.</p>
<p>In <xref ref-type="fig" rid="pcbi.1004289.g007">Fig 7(A)</xref> we report the results of applying PF<sup>2</sup> <italic>fit</italic> on the synthesized EM dataset, with different number of low-discrepancy samples in SO(3). Notice that the results are stable with only around 5k samples (corresponding to about 15 degree separation in SO(3)) which runs in around 100 seconds in a single threaded execution. The Non-uniform inclusion potential cross-correlation score (NCCS) highlights another advantage of non-uniform FFT. NCCS incurs much smaller overhead than GCCS or SCCS, and the advantage becomes more pronounced when the overall runtime is smaller (see <xref ref-type="fig" rid="pcbi.1004289.g007">Fig 7(B)</xref>). For example, at 5k samples, the NCCS is about 20% faster than GCCS. Further advantages of NCCS, in terms of its speed-accuracy tradeoff is discussed in a later section.</p>
<fig id="pcbi.1004289.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Speed-accuracy trade-offs in PF<sup>2</sup> <italic>fit</italic>.</title>
<p>(A) The plot displays the average runtime (divided by 2000) using the GCCS scoring term, and the corresponding error (in RMSD) when PF<sup>2</sup> <italic>fit</italic> is applied on the synthesized EM dataset. Notice that the runtime increases linearly with the number of samples in SO(3), but the average error is quite steady between 0.4 to 0.5Å except for the case when only 2000 samples were used. We believe that such robustness stems from the low discrepancy of the sampling. (B) We compared the average speeds of PF<sup>2</sup> <italic>fit</italic> on the synthesized EM dataset with GCCS, SCCS and NCCS using the same expansion degree (L = 20). The plot shows that NCCS is faster than GCCS, specially when fewer samples are used. On the other hand SCCS is marginally slower (around 0.1%) than GCCS.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.g007"/>
</fig>
</sec>
<sec id="sec029">
<title>The performance of reranking increases with resolution</title>
<p>We discuss the result of applying two separate reranking schemes, the skeleton-secondary structure score (SSS) and the mutual information score (MIS) in terms of improving the ranks of the predictions from PF<sup>2</sup> <italic>fit</italic>’s FFT-amenable initial scoring phase which have low RMSD.</p>
<sec id="sec030">
<title>On synthetized EM data</title>
<p>We tested the described set of 53 models in our synthesized EM dataset for 6 different resolutions and then counted the instances in which the reranking replaced the top-ranked result of the initial stage with a previously lower ranked one, that has a better RMSD and is hence a better fit.</p>
<p>In <xref ref-type="table" rid="pcbi.1004289.t003">Table 3</xref>, we report the average rank of the lowest RMSD prediction, after applying the reranker in absence and presence of noise dependend on the resolution. We see that MIS is more resolution robust than the SSS and both perform better at higher resolutions.</p>
<table-wrap id="pcbi.1004289.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.t003</object-id>
<label>Table 3</label>
<caption>
<title>Average rank of best RMSD result returned by PF<sup>2</sup> <italic>fit</italic>—SE(3) after reranking.</title>
<p>In the initial stage GCCS was used. The figures in brackets denote the rank in the presence of noise at SNR = 1. We see a strong decrease in rank for the skeleton-secondary structure score with and without noise while the mutual information score remains predictable across the range of resolutions. See the section on “Datasets” for a list of PDBs used to generate the synthetic maps used in this experiment. Note that even if the ranks of the best RMSD solution, on average across all experments, show no improvement over <xref ref-type="table" rid="pcbi.1004289.t001">Table 1</xref> (mostly because GCCS already does an excellent job of ranking them)- the ranks actually improved for several of the experiments (73/318 for MIS, and 5/318 for MIS). Please see Section ‘The performance of reranking increases with resolution’ for details.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004289.t003g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.t003"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="1" colspan="1">Resolution (Å)</th>
<th align="center" rowspan="1" colspan="1">Rank SSS</th>
<th align="center" rowspan="1" colspan="1">Rank MIS</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="1" colspan="1">5</td>
<td align="center" rowspan="1" colspan="1">2.91 (7.72)</td>
<td align="center" rowspan="1" colspan="1">1.04 (1.67)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">7</td>
<td align="center" rowspan="1" colspan="1">2.95 (7.86)</td>
<td align="center" rowspan="1" colspan="1">1.05 (1.62)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">9</td>
<td align="center" rowspan="1" colspan="1">3.79 (8.86)</td>
<td align="center" rowspan="1" colspan="1">1.04 (1.74)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">11</td>
<td align="center" rowspan="1" colspan="1">8.93 (13.15)</td>
<td align="center" rowspan="1" colspan="1">1.06 (1.88)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">13</td>
<td align="center" rowspan="1" colspan="1">9.97 (25.89)</td>
<td align="center" rowspan="1" colspan="1">1.06 (1.75)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">15</td>
<td align="center" rowspan="1" colspan="1">15.89 (48.17)</td>
<td align="center" rowspan="1" colspan="1">1.08 (1.83)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The MIS replaced the top-ranked result of the initial stage with one that has a better RMSD 73 times, predominantly at resolutions below 10Å. These cases occured for all the PDBs listed in the section on datasets, except 1BVLba, 1AY1hl and 2BNH.</p>
<p>On the other hand, we notice that the usefulness of the SSS degraded sharply with decreasing resolution. There were only five cases out of the 318 experiments in which the SSS replaced the top-ranked result with a result that has better RMSD; all of these cases occured at resolutions &lt; 10Å, and for the PDBs 1FSKbc, 1BVLba, 1BDD, 2CTS and 1OELg. However, we expect the SSS to become a more effective gauge of fitting quality as the quality of density maps obtained from cryo-EM increases, and more density maps at resolutions between 3–5 Å are isolated.</p>
</sec>
<sec id="sec031">
<title>On acquired EM data from the cryoEM challenge</title>
<p>For finer resolution 3D EM maps, such the one corresponding to GroEL at 4.4Å, mm-cpn at 4.3Å, Rotavirus at 3.8Å, or GroEL at 7.7Å, SSS correlates with the MIS, as well as the FFT-amenable fitting metrics, about the quality of the fitted result, generating scores that range between 0.3 and 0.8 for the top ten fitting results. However, for 3D EM maps such as those of GroEL at 11Å or SIV at 20Å it diverges sharply from the MIS and the other measures introduced in this work, and yields results that are clearly, i.e., visually, incorrect, due simply to the quality of skeleton obtained.</p>
<p>We expect the SSS to become a more effective gauge of fitting quality as the quality of 3D EM maps obtained from cryo-EM increases, and more 3D EM maps at resolutions between 4–8Å are isolated.</p>
</sec>
</sec>
<sec id="sec032">
<title>PF<sup>2</sup> <italic>fit</italic> compares favourably with other publicly-available software</title>
<p>We tested PF<sup>2</sup> <italic>fit</italic> against the publicly available ADP_EM and Colores. Though these three programms have correlation-based fitting schemes, the exact formulation of the affinity functions, and just as importantly the sampling scheme are not the same. For instance the translational step of PF<sup>2</sup> <italic>fit</italic> is not directly comparable to the translational step of Colores. Also, the angular sampling density as well as the expansion degree affect the outcome. So, it is almost impossible to come up with parameters for each software which would result in the same measure of dispersion in the samples. Hence, we fixed the parameters of PF<sup>2</sup> <italic>fit</italic> such that its runtime is similar to those of ADP_EM and Colores in their default settings, and then compared the results.</p>
<sec id="sec033">
<title>Accuracy on synthetized data</title>
<p>In <xref ref-type="fig" rid="pcbi.1004289.g005">Fig 5</xref> we report the average RMSD of the top-ranked fitting predictions made by PF<sup>2</sup> <italic>fit</italic> over the set of 53 PDBs mentioned in the Validation and dataset section. As the PDBs were blurred, the accuracy (RMSD) of the prediction gradually got worse, as expected. We compared these to the plot in Fig 1 of [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>], where performance of ADP_EM and Colores is reported in the same manner (i.e. RMSD vs. resolution) for a smaller dataset. According to the data reported in [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>], the average RMSD of three variants of ADP_EM and Colores+Powell is above 1Å when the blurring is greater than 20Å, which is very similar to PF<sup>2</sup> <italic>fit</italic> using GCCS. However, PF<sup>2</sup> <italic>fit</italic> with SCCS achieved average RMSDs which are less than 1Å, even when the model is blurred upto 40Å, and is hence much more robust for fitting to low resolution maps. The lowest blurring resolution reported in [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>] is 10Å. At that resolution, the approximate average errors for Colores+Powell, the best variant of ADP_EM, PF<sup>2</sup> <italic>fit</italic> with GCCS and PF<sup>2</sup> <italic>fit</italic> with SCCS are respectively 0.25, 0.7, 0.4 and 0.3 respectively, indicating that PF<sup>2</sup> <italic>fit</italic> performs comparatively well when better maps are available as well.</p>
<p>For PF<sup>2</sup> <italic>fit</italic>, the top-ranking or second-ranking pose was observed to be usually the one with the least RMSD (<xref ref-type="fig" rid="pcbi.1004289.g005">Fig 5</xref>). This feature should be common to all global-optimisation-based fitting routines in which atomic structures are rigidly fit to blurred versions of themselves. However, we observed in our experiments that while the top ranked fitting result in Colores is usually also the one with the least RMSD, the ones ranked 2–10 have RMSDs that can range anywhere between 1.1 and 10 times the RMSD of the top-ranked result. We surmise that this spuriousness is an artifact of its Powell maximization step.</p>
<p>An example of how PF<sup>2</sup> <italic>fit</italic> performs relative to Colores and ADP_EM [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>] can be seen in <xref ref-type="fig" rid="pcbi.1004289.g003">Fig 3</xref>. This is an instance of Experiment 1 applied to a single chain atomic structure. The fitted result using PF<sup>2</sup> <italic>fit</italic> results in an RMSD of 0.88Å, the least of the three programs, while Colores and ADP_EM respectively return 3.2 and 0.94Å.</p>
<p>Another example, a variant of Experiment 1, can be seen in <xref ref-type="fig" rid="pcbi.1004289.g004">Fig 4</xref>. Here a random rigid-body transformation (<bold>R</bold>, <bold>t</bold>) is applied to a single chain 𝓟<sub><italic>a</italic></sub> of a two-chain atomic structure 𝓟<sub><italic>ab</italic></sub>. 𝓟<sub><italic>a</italic></sub> is then fitted to a synthesized EM density map generated from 𝓟<sub><italic>ab</italic></sub> to generate <inline-formula id="pcbi.1004289.e045"><alternatives><graphic id="pcbi.1004289.e045g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e045"/><mml:math id="M45" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>𝓟</mml:mo> <mml:mi>a</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, using one of PF<sup>2</sup> <italic>fit</italic>, Colores, or ADP_EM. The RMSD between <inline-formula id="pcbi.1004289.e046"><alternatives><graphic id="pcbi.1004289.e046g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004289.e046"/><mml:math id="M46" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>𝓟</mml:mo> <mml:mi>a</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and 𝓟<sub><italic>ab</italic></sub> is then measured. <xref ref-type="fig" rid="pcbi.1004289.g004">Fig 4</xref> shows that PF<sup>2</sup> <italic>fit</italic> obtains an RMSD of 0.73Å, while ADP_EM and Colores obtain an RMSD, respectively, of 0.814Å and 1.096Å.</p>
<p>All in all, our experiments showed that PF<sup>2</sup> <italic>fit</italic> can be considered as a viable alternate with features and tradeoffs that complements those available in ADP_EM and Colores.</p>
</sec>
<sec id="sec034">
<title>Performance on acquired EM data from the cryoEM challenge</title>
<p>An example of acquired EM data subunit-assembly fitting is provided in <xref ref-type="fig" rid="pcbi.1004289.g008">Fig 8</xref>. Here a single subunit of an atomic structure is fit to a larger density map which contains three repetitions of the subunit. An ideal fitting routine should be able to rank each of the symmetric positions of the fitted atomic structure above all other hypothetical positions. While PF<sup>2</sup> <italic>fit</italic> and ADP_EM achieve this, Colores is unable to find one of the three symmetric positions in its top ten results. Additionally, PF<sup>2</sup> <italic>fit</italic> attains the lowest ETR of the three fitting routines. The ETRs for PF<sup>2</sup> <italic>fit</italic>, Colores, and ADP_EM are, respectively, 0.03, 0.1, and 0.8.</p>
<fig id="pcbi.1004289.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Comparison of PF<sup>2</sup> <italic>fit</italic> with other software in subunit-assembly fitting.</title>
<p>Fitting the PDB molecule 𝓟 (1GC1) to the EM map 𝓜 of SIV 20Å(EMD5020), using the GCCS. Two different views of the molecules are given: (A) Results from PF<sup>2</sup> <italic>fit</italic>. The ETR is 0.03. (B) Results from colores with default options. The ETR is 0.1. (C) Results from ADP_EM with <italic>L</italic> = 25. The ETR is 0.08.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.g008"/>
</fig>
</sec>
<sec id="sec035">
<title>Timing</title>
<p>As previously mentioned, the parameters in PF<sup>2</sup> <italic>fit</italic> were set up to yield comparable runtimes to ADP_EM [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>] and Colores. An average PF<sup>2</sup> <italic>fit</italic> fitting exercise with <italic>L</italic> = 25 and angular sampling of 10° per rotational degree of freedom takes is around twice as much time as ADP_EM [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>] with default settings, and less time than Colores (even when Powell optimization is not done). For example, fitting the Beef Liver Catalase (PDBID: 7CAT) on a single-threaded 2.5GhZ processor with 8 GB main memory takes about 2.5 minutes for PF<sup>2</sup> <italic>fit</italic>, 65 seconds for [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>] (with the same value of <italic>L</italic>), and about 3.5 minutes for Colores. These reported times are averaged over 25 executions of each. Note that, for PF<sup>2</sup> <italic>fit</italic> most of the performance overhead is due to the non-uniform nature of the search algorithm, and in particular the NFFT.</p>
</sec>
</sec>
<sec id="sec036">
<title>Subunit-assembly benefits from the unique focusing ability of PF<sup>2</sup> <italic>fit</italic></title>
<p>Suppose an experimenter wants to refine the cryo-EM map of GroEL at 7.7Å (𝓜 = EMD 1180, 192 × 192 × 192 voxels) by fitting a single subunit of GroEL (𝓟 = 1AONa) into it. This is the subunit-assembly problem, in which the translational uncertainty is roughly twice the size of 𝓟, whereas the rotational uncertainty is the range of rotations from 0 to 2<italic>π</italic>. One way to effect the refinement would be to segment from 𝓜 a 3D EM subunit of GroEL 𝓜<sub><italic>s</italic></sub>, to which 𝓟 could be fitted using PF<sup>2</sup> <italic>fit</italic> —SE(3) (<xref ref-type="fig" rid="pcbi.1004289.g009">Fig 9A</xref>).</p>
<fig id="pcbi.1004289.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Fitting the PDB molecule 𝓟 (1AONb) to the GroEL 3D EM map 𝓜 (EMD 1461) at 7.7Å.</title>
<p>(A) Full 3D EM map 𝓜 with segmented subunit 𝓜<sub><italic>s</italic></sub> (inset, top). The molecule 𝓟 is fitted into 𝓜<sub><italic>s</italic></sub> using PF<sup>2</sup> <italic>fit</italic> (inset, bottom). (B) Initial guess for rigid-body fit into 𝓜. (C) PF<sup>2</sup> <italic>fit</italic> generates translational samples local to the initial guess to find the depicted correct result. Correctness is measured by deviation from the rigid-body fit in (A). The result has an RMSD of 0.3Å from the fitting result in (A) and is ranked at number four in a run of PF<sup>2</sup> <italic>fit</italic> with angular resolution of 10°.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.g009"/>
</fig>
<p>If a good segmentation is unavailable, a software like Chimera [<xref ref-type="bibr" rid="pcbi.1004289.ref010">10</xref>] could be used to refine an approximate placement. Another option is to use rigid-body fitting with Colores. Chimera surveys a fixed number (=50) distinct poses in its gradient-descent-based optimisation scheme, and the fit obtained is only locally optimal. On the other hand, Colores uses a uniform Cartesian grid with a default translational step equal to the voxel spacing of the map. With a default angular fineness of about 30° on a cubical Euler Angle grid, this results in 64<sup>3</sup> = 262144 translational samples and 864 rotational samples. Of these, several positions are redundant, as they lie outside the region of the initial guess. In general, there is no way in Colores to confine the translational search to a given region.</p>
<p>A third option is to use PF<sup>2</sup> <italic>fit</italic>. The focusing property of PF<sup>2</sup> <italic>fit</italic> mitigates both the above disadvantages (<xref ref-type="fig" rid="pcbi.1004289.g009">Fig 9B-9C</xref>). Since the GroEL assembly is symmetric, the experimenter could place the subunit approximately within the 3D EM map (<xref ref-type="fig" rid="pcbi.1004289.g009">Fig 9B</xref>), and then instruct PF<sup>2</sup> <italic>fit</italic> —SE(3) to do a comprehensive search in the local region around the 3D EM map. In such an experiment, translations are completely disabled, and the rotational search space is uniformly sampled. Using the uniform SO(3) sampling technique in Mitchell [<xref ref-type="bibr" rid="pcbi.1004289.ref024">24</xref>] yields 14868 samples at 10° angular step. The result in <xref ref-type="fig" rid="pcbi.1004289.g009">Fig 9C</xref> is obtained.</p>
<p>Using PF<sup>2</sup> <italic>fit</italic> in such scenarios has the following advantages. First, the comprehensive search in the local region essentially guarantees that PF<sup>2</sup> <italic>fit</italic> —SE(3), unlike iterative gradient-descent-based optimization techniques, is not sensitive to an initial guess. Second, unlike global search routines, PF<sup>2</sup> <italic>fit</italic> does not generate spurious rigid-body fits in regions that are spatially distant from the optimal fit. Third, the time-taken for the experiment is proportional to the number of local samples rather than for the (much larger) entire search space. PF<sup>2</sup> <italic>fit</italic> thus combines the merits of local and global search paradigms in its focused search.</p>
<p>Note that many rotational-FFT-based schemes, e.g. [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>] share the focusing property; however, since these techniques use a cubic Euler Angle grid, they do not ensure that the space of rotations is uniformly sampled.</p>
</sec>
<sec id="sec037">
<title>The non-uniform inclusion potential (NCCS) is highly efficient</title>
<p>The NCCS is a non-uniform-grid-based version of the envelope score in Vasishtan and Topf [<xref ref-type="bibr" rid="pcbi.1004289.ref013">13</xref>]. Along with PF<sup>2</sup> <italic>fit</italic>, the non-uniformity inherent to the inclusion potential enables a very high speed search of the space of rigid-body motions SE(3) available to 𝓟. We explain this by first noting that since the quantity of information in <italic>A</italic><sub><italic>nu</italic></sub>(<bold>x</bold>), cf. <xref ref-type="disp-formula" rid="pcbi.1004289.e004">Eq (2)</xref>, is exactly equal to the number of atoms in 𝓟<sub><italic>s</italic></sub>, a relatively low degree <italic>L</italic> in <xref ref-type="disp-formula" rid="pcbi.1004289.e015">Eq (10)</xref> suffices to represent it. In general, while the GCCS and SCCS each demand a degree at least equal to <italic>L</italic> = 20, with best results for <italic>L</italic> ≥ 25, the NCCS requires only a degree <italic>L</italic> = 5 (see <xref ref-type="fig" rid="pcbi.1004289.g010">Fig 10</xref>).</p>
<fig id="pcbi.1004289.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004289.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Speed-accuracy trade-offs for NCCS.</title>
<p>NCCS is computed on a non-uniform grid based on the atom positions. If the grid is sparse, then it is expected that a lower degree expansion of the spherical basis functions would sufficiently represent it. We applied NCCS with the expansion degree (L) varied between 5 to 20, on the synthesized EM dataset (blurring to 12A resolution) and using 30k samples in SO(3) space. The plot shows that the error decreases and runtime increases with L. However, the change is runtime is more pronounced than the change in error, for example, the runtime is 35% faster for L = 5 while the error is only 5% more than that of L = 20.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004289.g010"/>
</fig>
<p>By itself, however, this property is of limited use. In the uniform-FFT frameworks used in either [<xref ref-type="bibr" rid="pcbi.1004289.ref047">47</xref>] or [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>], the expansion degree is keyed directly to the coarseness of rotational sampling, because the underlying FFT grids are only as fine as the expansion degree allows them to be. Using a degree <italic>L</italic> = 5 in either of these approaches would mean conducting a rigid-body search over an angular grid with separation 360/(2 × 5) = 36°, an unacceptably coarse value for most rigid-body fitting exercises. By contrast, PF<sup>2</sup> <italic>fit</italic>, functioning as it does through the <italic>non-uniform</italic> SO(3) Fourier transform, enables an arbitrarily fine scan of the space of rigid-body motions at <italic>any expansion degree</italic>.</p>
<p>These advantages mean that the NCCS can play a central role in rigid-body fitting. If a coarse estimate of a fitted position of 𝓟 with respect to 𝓜 is desired, then a low expansion degree version of the NCCS can be used, whereas a more accurate estimate can be found using the SCCS at <italic>L</italic> ≥ 20. The typical time taken for a subunit-subunit fitting exercise on a single-threaded Macbook Pro at 2.5 GhZ with 8GB RAM is about 1.3 minutes.</p>
</sec>
<sec id="sec038">
<title>Concluding remarks</title>
<p>The results of this paper has contributed to existing methods and software on rigid-body fitting. In particular:
<list list-type="bullet"><list-item><p><italic>Cross Correlation scoring functions</italic>. We have introduced the non-uniform inclusion potential CCS in Eqs (<xref ref-type="disp-formula" rid="pcbi.1004289.e004">2</xref>), (<xref ref-type="disp-formula" rid="pcbi.1004289.e005">3</xref>). This score has been shown to be preferable to standard fitting metrics in terms of speed (cf. <xref ref-type="fig" rid="pcbi.1004289.g010">Fig 10</xref>). We have also introduced the concept of complementary space matching, and introduced the complementary space scoring function (CCCS). The addition of the CCCS results in significant improvements in the prediction accuracy across a range of resolutions, regardless of the target-target scoring function used. Finally, we have compared the scattering potential (SCCS) with the typically used Gaussian potential (GCCS), finding that it performs favourably in our application compared to the latter in both synthesized and microscope acquired density map fitting scenarios and hence provides a valuable alternative.</p></list-item> <list-item><p><italic>Search scheme</italic>. We have introduced a search scheme that is resolution-robust, capable of local fitting, and able to quickly and comprehensively survey the space of rigid-body motions SE(3) (cf. Results section). The search scheme we have introduced is capable of <italic>uniformly</italic> sampling the space of rigid-body rotations SO(3), where uniformity is defined according to a chosen metric. For instance, in the sampling technique from [<xref ref-type="bibr" rid="pcbi.1004289.ref024">24</xref>] we use throughout this work, uniformity involves the competing notions of <italic>local separation</italic> and <italic>global coverage</italic>. Equispaced Euler angular grids, the mainstay of all current rotationally exhaustive techniques, generate samples in SO(3) that possess neither of these desirable features. See also [<xref ref-type="bibr" rid="pcbi.1004289.ref029">29</xref>] for a more detailed consideration of sampling.</p></list-item> <list-item><p><italic>Reranking stage</italic>. We have introduced the skeleton-secondary structure score (SSS), whose performance we expect to improve as the resolution of experimental cryo-EM 3D EM maps improves.</p></list-item> <list-item><p><italic>Optional multi-basis framework</italic>. Our match and alignment (fitting) algorithms can use one of two popular basis expansions to perform an exhaustive search. PF<sup>2</sup> <italic>fit</italic> —SE(3) and—SO(3) is compatible with existing FFT-based fitting schemes, while being general enough to subsume the approaches that use these schemes, approaches such as those by [<xref ref-type="bibr" rid="pcbi.1004289.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1004289.ref047">47</xref>]. Because the NFFT is currently not as fast as the FFT, there may be situations in which the use of the FFT-based technique, regardless of its drawbacks, might be indicated. Suitable modifications of PF<sup>2</sup> <italic>fit</italic> —SE(3) and PF<sup>2</sup> <italic>fit</italic> —SO(3) would be applicable in these situations as well.</p></list-item></list></p>
</sec>
</sec>
<sec id="sec039">
<title>Software and Data Availability</title>
<p>The PF<sup>2</sup> <italic>fit</italic> software package along with a tutorial is free for academic users and available through our website: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.ices.utexas.edu/CVC/software/">http://www.ices.utexas.edu/CVC/software/</ext-link>.</p>
</sec>
</body>
<back>
<ack>
<p>Much of the work on this paper was accomplished when Dr. Antje Vollrath was visiting the University of Texas at Austin. Our in-house molecular modeling, image processing and visualization software tool, called VolumeRover, was used for producing <xref ref-type="fig" rid="pcbi.1004289.g004">Fig 4A</xref> in this paper, while all other figures were generated using PyMol. We owe sincere thanks to Dr. Deukhyun Cha for his help with PF<sup>2</sup> <italic>fit</italic> software testing and documentation.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004289.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wriggers</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Chacon</surname> <given-names>P</given-names></name> (<year>2001</year>) <article-title>Modeling tricks and fitting techniques for multiresolution structures</article-title>. <source>Structure</source> <volume>9</volume>: <fpage>771</fpage>–<lpage>778</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0969-2126(01)00648-7" xlink:type="simple">10.1016/S0969-2126(01)00648-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Milne</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Borgnia</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Rostapshov</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Subramaniam</surname> <given-names>S</given-names></name> <etal>et al</etal> (<year>2003</year>) <article-title>A core-weighted fitting method for docking atomic structures into low-resolution maps: Application to cryo-electron microscopy</article-title>. <source>Journal of Structural Biology</source> <volume>141</volume>: <fpage>63</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1047-8477(02)00570-1" xlink:type="simple">10.1016/S1047-8477(02)00570-1</ext-link></comment> <object-id pub-id-type="pmid">12576021</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Garçon</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Kovacs</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Abagyan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Chacón</surname> <given-names>P</given-names></name> (<year>2007</year>) <article-title>ADP_EM: fast exhaustive multi-resolution docking with high-throughput coverage</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>427</fpage>–<lpage>433</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl625" xlink:type="simple">10.1093/bioinformatics/btl625</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="other">Woetzel N, Lindert S, Stewart P, Meiler J (2011) Bcl::em-fit: Rigid body fitting of atomic structures into density maps using geometric hashing and real space refinement. Journal of Structural Biology 3.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zhang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Vasishtan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Topf</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Alber</surname> <given-names>F</given-names></name> (<year>2010</year>) <article-title>A fast mathematical programming procedure for simultaneous fitting of assembly components into cryoEM density maps</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>261</fpage>–<lpage>268</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq201" xlink:type="simple">10.1093/bioinformatics/btq201</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Baker</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Wedemeyer</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Rixon</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>D</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Ab initio modeling of the herpesvirus vp26 core domain assessed by CryoEM density</article-title>. <source>PLoS Comput Biol</source> <volume>2</volume>: <fpage>e146</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020146" xlink:type="simple">10.1371/journal.pcbi.0020146</ext-link></comment> <object-id pub-id-type="pmid">17069457</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kovacs</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Wriggers</surname> <given-names>W</given-names></name> (<year>2002</year>) <article-title>Fast rotational matching</article-title>. <source>Acta Crystallographica Section D</source> <volume>58</volume>: <fpage>1282</fpage>–<lpage>1286</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1107/S0907444902009794" xlink:type="simple">10.1107/S0907444902009794</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Roseman</surname> <given-names>A</given-names></name> (<year>2000</year>) <article-title>Docking structures of domains into maps from cryo-electron microscopy using local correlation</article-title>. <source>Acta Crystallographica</source> <volume>D56</volume>: <fpage>1332</fpage>–<lpage>1340</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hoang</surname> <given-names>TV</given-names></name>, <name name-style="western"><surname>Cavin</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Ritchie</surname> <given-names>DW</given-names></name> (<year>2013</year>) <article-title>gEMfitter: A highly parallel fft-based 3d density fitting tool with gpu texture memory acceleration</article-title>. <source>Journal of Structural Biology</source> <volume>184</volume>: <fpage>348</fpage>–<lpage>354</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jsb.2013.09.010" xlink:type="simple">10.1016/j.jsb.2013.09.010</ext-link></comment> <object-id pub-id-type="pmid">24060989</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pettersen</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Goddard</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Couch</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Greenblatt</surname> <given-names>DM</given-names></name> <etal>et al</etal> (<year>2004</year>) <article-title>Ucsf chimera–a visualization system for exploratory research and analysis</article-title>. <source>Journal of Computational Chemistry</source> <volume>25</volume>: <fpage>1605</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/jcc.20084" xlink:type="simple">10.1002/jcc.20084</ext-link></comment> <object-id pub-id-type="pmid">15264254</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wriggers</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Chacon</surname> <given-names>P</given-names></name> (<year>2002</year>) <article-title>Multi-resolution contour-based fitting of macromolecular structures</article-title>. <source>Journal of Molecular Biology</source> <volume>317</volume>: <fpage>375</fpage>–<lpage>384</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.2002.5438" xlink:type="simple">10.1006/jmbi.2002.5438</ext-link></comment> <object-id pub-id-type="pmid">11922671</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ceulemans</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Russell</surname> <given-names>RB</given-names></name> (<year>2004</year>) <article-title>Fast fitting of atomic structures to low-resolution electron density maps by surface overlap maximization</article-title>. <source>Journal of Molecular Biology</source>: <fpage>783</fpage>–<lpage>793</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmb.2004.02.066" xlink:type="simple">10.1016/j.jmb.2004.02.066</ext-link></comment> <object-id pub-id-type="pmid">15099745</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Vasishtan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Topf</surname> <given-names>M</given-names></name> (<year>2011</year>) <article-title>Scoring functions for cryoEM density fitting</article-title>. <source>Journal of Structural Biology</source> <volume>174</volume>: <fpage>333</fpage>–<lpage>343</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jsb.2011.01.012" xlink:type="simple">10.1016/j.jsb.2011.01.012</ext-link></comment> <object-id pub-id-type="pmid">21296161</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kawabata</surname> <given-names>T</given-names></name> (<year>2008</year>) <article-title>Multiple subunit fitting into a low-resolution density map of a macromolecular complex using a gaussian mixture model</article-title>. <source>Biophysical Journal</source> <volume>95</volume>: <fpage>4643</fpage>–<lpage>4658</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1529/biophysj.108.137125" xlink:type="simple">10.1529/biophysj.108.137125</ext-link></comment> <object-id pub-id-type="pmid">18708469</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wriggers</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Birmanns</surname> <given-names>S</given-names></name> (<year>2001</year>) <article-title>Using situs for flexible and rigid-body fitting of multiresolution single-molecule data</article-title>. <source>J Struct Biol</source> <volume>133</volume>: <fpage>193</fpage>–<lpage>202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jsbi.2000.4350" xlink:type="simple">10.1006/jsbi.2000.4350</ext-link></comment> <object-id pub-id-type="pmid">11472090</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fabiola</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Chapman</surname> <given-names>MS</given-names></name> (<year>2005</year>) <article-title>Fitting of high-resolution structures into electron microscopy reconstruction images</article-title>. <source>Structure</source> <volume>13</volume>: <fpage>389</fpage>–<lpage>400</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.str.2005.01.007" xlink:type="simple">10.1016/j.str.2005.01.007</ext-link></comment> <object-id pub-id-type="pmid">15766540</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Topf</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>John</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Chiu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Sali</surname> <given-names>A</given-names></name> (<year>2005</year>) <article-title>Structural characterization of components of protein assemblies by comparative modeling and electron cryo-microscopy</article-title>. <source>Journal of Structural Biology</source> <volume>149</volume>: <fpage>191</fpage>–<lpage>203</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jsb.2004.11.004" xlink:type="simple">10.1016/j.jsb.2004.11.004</ext-link></comment> <object-id pub-id-type="pmid">15681235</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wriggers</surname> <given-names>W</given-names></name> (<year>2010</year>) <article-title>Using situs for the integration of multi-resolution structures</article-title>. <source>Biophysical Reviews</source> <volume>2</volume>: <fpage>21</fpage>–<lpage>27</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s12551-009-0026-3" xlink:type="simple">10.1007/s12551-009-0026-3</ext-link></comment> <object-id pub-id-type="pmid">20174447</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Kovacs</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Chacón</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cong</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Metwally</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Wriggers</surname> <given-names>W</given-names></name> (<year>2003</year>) <chapter-title>Fast rotational matching of rigid bodies by fast fourier transform acceleration of five degrees of freedom</chapter-title>. <source>Acta Crystallographica Section D</source> <volume>D59</volume>: <fpage>1371</fpage>–<lpage>1376</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zhang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Bettadapura</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bajaj</surname> <given-names>C</given-names></name> (<year>2012</year>) <article-title>Macromolecular structure modeling from 3dem using volrover 2.0</article-title>. <source>Biopolymers</source> <volume>97</volume>: <fpage>709</fpage>–<lpage>731</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/bip.22052" xlink:type="simple">10.1002/bip.22052</ext-link></comment> <object-id pub-id-type="pmid">22696407</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Keiner</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Vollrath</surname> <given-names>A</given-names></name> (<year>2012</year>) <article-title>A new algorithm for the nonequispaced fast fourier transform on the rotation group</article-title>. <source>SIAM J Sci Comput</source> <volume>34</volume>: pp. <fpage>2599</fpage>–<lpage>2624</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/110835232" xlink:type="simple">10.1137/110835232</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Chirikjian</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Kyatkin</surname> <given-names>A</given-names></name> (<year>2001</year>) <source>Engineering applications of noncommutative harmonic analysis with emphasis on rotation and motion groups</source>. <publisher-loc>Boca Raton</publisher-loc>: <publisher-name>CRC Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gräf</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Potts</surname> <given-names>D</given-names></name> (<year>2009</year>) <article-title>Sampling sets and quadrature formulae on the rotation group</article-title>. <source>Numer Funct Anal Optim</source> <volume>30</volume>: <fpage>665</fpage>–<lpage>688</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01630560903163508" xlink:type="simple">10.1080/01630560903163508</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mitchell</surname> <given-names>JC</given-names></name> (<year>2007</year>) <article-title>Discrete uniform sampling of rotation groups using orthogonal images</article-title>. <source>SIAM Journal of Scientific Computing</source> <volume>30</volume>: <fpage>525</fpage>–<lpage>547</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/030601879" xlink:type="simple">10.1137/030601879</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="other">Yershova A, LaValle SM (2004) Deterministic sampling methods for spheres and SO(3). In: Proceedings. IEEE International Conference on Robotics and Automation. pp. 3974–3980.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Potts</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Prestin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Vollrath</surname> <given-names>A</given-names></name> (<year>2009</year>) <article-title>A fast algorithm for nonequispaced fourier transforms on the rotation group</article-title>. <source>Numerical Algorithms</source> <volume>52</volume>: <fpage>355</fpage>–<lpage>384</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11075-009-9277-0" xlink:type="simple">10.1007/s11075-009-9277-0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="other">Hadani R, Singer A (2011) Representation theoretic patterns in three dimensional cryo-electron microscopy I—the intrinsic reconstitution algorithm. Annals of Mathematics.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Chirikjian</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ebert-Uphoff</surname> <given-names>I</given-names></name> (<year>1998</year>) <article-title>Numerical convolution on the euclidean group with applications to workspace generation</article-title>. <source>IEEE Trans on Robotics and Automation</source> <volume>14</volume>: <fpage>123</fpage>–<lpage>136</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/70.660856" xlink:type="simple">10.1109/70.660856</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bajaj</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bauer</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bettadapura</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vollrath</surname> <given-names>A</given-names></name> (<year>2013</year>) <article-title>Non-uniform Fourier transforms for multi-dimensional rotational correlations</article-title>. <source>SIAM Journal of Scientific Computing</source> <volume>35</volume>: <fpage>821</fpage>–<lpage>845</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/120892386" xlink:type="simple">10.1137/120892386</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Shatsky</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Brenner</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Glaeser</surname> <given-names>R</given-names></name> (<year>2008</year>) <article-title>A method for the alignment of heterogeneous macromolecules from electron microscopy</article-title>. <source>Journal of Structural Biology</source> <volume>166</volume>: <fpage>67</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jsb.2008.12.008" xlink:type="simple">10.1016/j.jsb.2008.12.008</ext-link></comment> <object-id pub-id-type="pmid">19166941</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Bajaj</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gillette</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Goswami</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kwon</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Rivera</surname> <given-names>J</given-names></name> (<year>2011</year>) <chapter-title>Complementary space for enhanced uncertainty and dynamics visualization</chapter-title>. In: <name name-style="western"><surname>Pascucci</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Tricoche</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Hagen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Tierny</surname> <given-names>J</given-names></name>, editors, <source>Topological Methods in Data Analysis and Visualization</source>, <publisher-name>Springer</publisher-name> <publisher-loc>Berlin / Heidelberg</publisher-loc>. pp. <fpage>217</fpage>–<lpage>228</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Frank</surname> <given-names>J</given-names></name> (<year>2006</year>) <source>Three-Dimensional Electron Microscopy of Macromolecular Assemblies-Visualization of Biological Molecules in Their Native State</source>. <publisher-name>Oxford University Press</publisher-name>, <edition>second edition</edition>.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rullgard</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ofverstedt</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Masich</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Daneholt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Oktem</surname> <given-names>O</given-names></name> (<year>2011</year>) <article-title>Simulation of transmission electron microscope images of biological specimens</article-title>. <source>Journal of Microscopy</source> <volume>243</volume>: <fpage>234</fpage>–<lpage>256</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1365-2818.2011.03497.x" xlink:type="simple">10.1111/j.1365-2818.2011.03497.x</ext-link></comment> <object-id pub-id-type="pmid">21631500</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Peng</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Ren</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Dudarev</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Whelan</surname> <given-names>MJ</given-names></name> (<year>1996</year>) <article-title>Robust parameterization of elastic and absorptive electron atomic scattering factors</article-title>. <source>Acta Crystallographica Section A</source> <volume>52</volume>: <fpage>257</fpage>–<lpage>276</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gonen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Sliz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hiroaki</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Fujiyoshi</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Lipid–protein interactions in double- layered two-dimensional aqp0 crystals</article-title>. <source>Nature</source> <volume>438</volume>: <fpage>634</fpage>–<lpage>638</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature04321" xlink:type="simple">10.1038/nature04321</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Chapman</surname> <given-names>M</given-names></name> (<year>1995</year>) <article-title>Restrained real-space macromolecular atomic refinement restrained real-space macromolecular atomic refinement using a new resolution-dependent electron-density function</article-title>. <source>Acta Cryst</source> <volume>A51</volume>: <fpage>69</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1107/S0108767394007130" xlink:type="simple">10.1107/S0108767394007130</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jolley</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wells</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fromme</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Thorpe</surname> <given-names>M</given-names></name> (<year>2008</year>) <article-title>Fitting low-resolution cryo-em maps of proteins using constrained geometric simulations</article-title>. <source>Biophysical Journal</source> <volume>94</volume>: <fpage>3361</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1529/biophysj.107.115949" xlink:type="simple">10.1529/biophysj.107.115949</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="other">Trabuco LG, Villa E, Mitra K, Frank J, Schulten K (2008) Flexible fitting of atomic structures into electron microscopy maps using molecular dynamics. Structure.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Bajaj</surname> <given-names>C</given-names></name> (<year>2007</year>) <article-title>Extraction, visualization and quantification of protein pockets</article-title>. In: <source>Proc. of the 6th Annual International Conference on Computational Systems Bioinformatics</source>. volume <volume>6</volume>, pp. <fpage>275</fpage>–<lpage>286</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1142/9781860948732_0029" xlink:type="simple">10.1142/9781860948732_0029</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref040">
<label>40</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Mitchell</surname> <given-names>TM</given-names></name> (<year>1997</year>) <source>Machine Learning</source>. <publisher-loc>New York, NY, USA</publisher-loc>: <publisher-name>McGraw-Hill, Inc.</publisher-name>, <edition>1 edition</edition>.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref041">
<label>41</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Breiman</surname> <given-names>L</given-names></name> (<year>2001</year>) <article-title>Random forests</article-title>. <source>Machine Learning</source> <volume>45</volume>: <fpage>5</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1010933404324" xlink:type="simple">10.1023/A:1010933404324</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref042">
<label>42</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pham</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Jain</surname> <given-names>A</given-names></name> (<year>2006</year>) <article-title>Parameter estimation for scoring protein–ligand interactions using negative training data</article-title>. <source>J Med Chem</source> <volume>49</volume>: <fpage>5856</fpage>–<lpage>5868</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/jm050040j" xlink:type="simple">10.1021/jm050040j</ext-link></comment> <object-id pub-id-type="pmid">17004701</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref043">
<label>43</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Teramoto</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Fukunishi</surname> <given-names>H</given-names></name> (<year>2007</year>) <article-title>Supervised scoring models with docked ligand conformations for structure-based virtual screening</article-title>. <source>J Chem Inf Model</source> <volume>47</volume>: <fpage>1858</fpage>–<lpage>1867</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ci700116z" xlink:type="simple">10.1021/ci700116z</ext-link></comment> <object-id pub-id-type="pmid">17685604</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref044">
<label>44</label>
<mixed-citation xlink:type="simple" publication-type="other">Yuan Q, Rasheed M, Bajaj C (2012) Learning an optimized scoring function for molecular docking. Technical report, University of Texas at Austin.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref045">
<label>45</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Biedenharn</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Louck</surname> <given-names>J</given-names></name> (<year>1981</year>) <source>The Racah-Wigner algebra in quantum theory</source>. <publisher-name>Addison-Wesley</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref046">
<label>46</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ritchie</surname> <given-names>DW</given-names></name> (<year>2005</year>) <article-title>High order analytic translation matrix elements for real six-dimensional polar Fourier correlations</article-title>. <source>J Appl Cryst</source> <volume>38</volume>: <fpage>808</fpage>–<lpage>818</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1107/S002188980502474X" xlink:type="simple">10.1107/S002188980502474X</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref047">
<label>47</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ritchie</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Kozakov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Vajda</surname> <given-names>S</given-names></name> (<year>2008</year>) <article-title>Accelerating and focusing protein-protein docking correlations using multi-dimensional rotational fft generating functions</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>1865</fpage>–<lpage>1873</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn334" xlink:type="simple">10.1093/bioinformatics/btn334</ext-link></comment> <object-id pub-id-type="pmid">18591193</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref048">
<label>48</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bajaj</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Goswami</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Q</given-names></name> (<year>2012</year>) <article-title>Detection of secondary and supersecondary structures of proteins from cryo-electron microscopy</article-title>. <source>Journal of Structural Biology</source> <volume>177</volume>: <fpage>367</fpage>–<lpage>381</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jsb.2011.11.032" xlink:type="simple">10.1016/j.jsb.2011.11.032</ext-link></comment> <object-id pub-id-type="pmid">22186625</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref049">
<label>49</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Frishman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Argos</surname> <given-names>P</given-names></name> (<year>1995</year>) <article-title>Knowledge-based protein secondary structure assignment</article-title>. <source>Proteins: Structure, Function, and Genetics</source> <volume>23</volume>: <fpage>566</fpage>–<lpage>579</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.340230412" xlink:type="simple">10.1002/prot.340230412</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref050">
<label>50</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hwang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Vreven</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Janin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Weng</surname> <given-names>Z</given-names></name> (<year>2010</year>) <article-title>Protein–protein docking benchmark version 4.0</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source> <volume>78</volume>: <fpage>3111</fpage>–<lpage>3114</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.22830" xlink:type="simple">10.1002/prot.22830</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref051">
<label>51</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Xu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name> (<year>2010</year>) <article-title>How significant is a protein structure similarity with tm-score = 0.5?</article-title> <source>Bioinformatics</source> (Oxford, England) <volume>26</volume>: <fpage>889</fpage>–<lpage>895</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq066" xlink:type="simple">10.1093/bioinformatics/btq066</ext-link></comment> <object-id pub-id-type="pmid">20164152</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref052">
<label>52</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Baker</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Chiu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Bajaj</surname> <given-names>C</given-names></name> (<year>2006</year>) <article-title>Automated segmentation of molecular subunits in electron cryomicroscopy density maps</article-title>. <source>Journal of Structural Biology</source> <volume>156</volume>: <fpage>432</fpage>–<lpage>441</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jsb.2006.05.013" xlink:type="simple">10.1016/j.jsb.2006.05.013</ext-link></comment> <object-id pub-id-type="pmid">16908194</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004289.ref053">
<label>53</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Yu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Bajaj</surname> <given-names>C</given-names></name> (<year>2007</year>) <article-title>Computational approaches for automatic structural analysis of large biomolecular complexes</article-title>. <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source> <volume>5</volume>: <fpage>568</fpage>–<lpage>582</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref054">
<label>54</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Larsen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Marx</surname> <given-names>M</given-names></name> (<year>2000</year>) <source>An Introduction to Mathematical Statistics and Its Applications</source> (<edition>3rd Edition</edition>). <publisher-name>Prentice Hall</publisher-name>, 3rd edition.</mixed-citation>
</ref>
<ref id="pcbi.1004289.ref055">
<label>55</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Niederreiter</surname> <given-names>H</given-names></name> (<year>1992</year>) <source>Random Number Generation and quasi-Monte Carlo Methods</source>. <publisher-loc>Philadelphia, PA, USA</publisher-loc>: <publisher-name>Society for Industrial and Applied Mathematics</publisher-name>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>