<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01300</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005286</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Spectrum analysis techniques</subject><subj-group><subject>Spectrophotometry</subject><subj-group><subject>Fluorophotometry</subject><subj-group><subject>Fluorescence resonance energy transfer</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject><subj-group><subject>Hidden Markov models</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Clustering algorithms</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Clustering algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov processes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Markov processes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Systems science</subject><subj-group><subject>System stability</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Systems science</subject><subj-group><subject>System stability</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Decoding Single Molecule Time Traces with Dynamic Disorder</article-title>
<alt-title alt-title-type="running-head">Decoding Single Molecule Trajectories with Dynamic Disorder</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hwang</surname> <given-names>Wonseok</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Lee</surname> <given-names>Il-Buem</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hong</surname> <given-names>Seok-Cheol</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4844-7237</contrib-id>
<name name-style="western">
<surname>Hyeon</surname> <given-names>Changbong</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Korea Institute for Advanced Study, Seoul, Republic of Korea</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Physics, Korea University, Seoul, Republic of Korea</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>de Groot</surname> <given-names>Bert L.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Max Planck Institute for Biophysical Chemistry, GERMANY</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> WH CH.</p>
</list-item>
<list-item>
<p><bold>Data curation:</bold> IBL SCH WH.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> WH.</p>
</list-item>
<list-item>
<p><bold>Funding acquisition:</bold> SCH CH.</p>
</list-item>
<list-item>
<p><bold>Investigation:</bold> IBL SCH.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> WH CH.</p>
</list-item>
<list-item>
<p><bold>Project administration:</bold> SCH CH.</p>
</list-item>
<list-item>
<p><bold>Resources:</bold> IBL SCH.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> WH.</p>
</list-item>
<list-item>
<p><bold>Supervision:</bold> SCH CH.</p>
</list-item>
<list-item>
<p><bold>Validation:</bold> WH.</p>
</list-item>
<list-item>
<p><bold>Visualization:</bold> WH.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> WH CH.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> WH CH.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">hyeoncb@kias.re.kr</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>12</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>27</day>
<month>12</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>12</issue>
<elocation-id>e1005286</elocation-id>
<history>
<date date-type="received">
<day>11</day>
<month>8</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>7</day>
<month>12</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Hwang et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005286"/>
<abstract>
<p>Single molecule time trajectories of biomolecules provide glimpses into complex folding landscapes that are difficult to visualize using conventional ensemble measurements. Recent experiments and theoretical analyses have highlighted dynamic disorder in certain classes of biomolecules, whose dynamic pattern of conformational transitions is affected by slower transition dynamics of internal state hidden in a low dimensional projection. A systematic means to analyze such data is, however, currently not well developed. Here we report a new algorithm—Variational Bayes-double chain Markov model (VB-DCMM)—to analyze single molecule time trajectories that display dynamic disorder. The proposed analysis employing VB-DCMM allows us to detect the presence of dynamic disorder, if any, in each trajectory, identify the number of internal states, and estimate transition rates between the internal states as well as the rates of conformational transition within each internal state. Applying VB-DCMM algorithm to single molecule FRET data of H-DNA in 100 mM-Na<sup>+</sup> solution, followed by data clustering, we show that at least 6 kinetic paths linking 4 distinct internal states are required to correctly interpret the duplex-triplex transitions of H-DNA.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>We have developed a new algorithm to better decode single molecule data with dynamic disorder. Our new algorithm, which represents a substantial improvement over other methodologies, can detect the presence of dynamic disorder in each trajectory and quantify the kinetic characteristics of underlying energy landscape. As a model system, we applied our algorithm to the single molecule FRET time traces of H-DNA. While duplex-triplex transitions of H-DNA are conventionally interpreted in terms of two-state kinetics, slowly varying dynamic patterns corresponding to hidden internal states can also be identified from the individual time traces. Our algorithm reveals that at least 4 distinct internal states are required to correctly interpret the data.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003725</institution-id>
<institution>National Research Foundation of Korea</institution>
</institution-wrap>
</funding-source>
<award-id>2015R1D1A1A01060376</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Hong</surname> <given-names>Seok-Cheol</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This study was partly supported by National Research Foundation of Korea 704 NRF-2015R1D1A1A01060376 ("<ext-link ext-link-type="uri" xlink:href="https://www.nrf.re.kr" xlink:type="simple">https://www.nrf.re.kr</ext-link>"). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="0"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-01-11</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data are available from <ext-link ext-link-type="uri" xlink:href="https://github.com/TBiophysG/VBDCMM/tree/master/data/HDNA%20KINETICS" xlink:type="simple">https://github.com/TBiophysG/VBDCMM/tree/master/data/HDNA%20KINETICS</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Recent technological advances in single molecule experiments on biomolecules have provided an unprecedented chance to investigate dynamics of proteins and nucleic acids at single molecule (SM) level, which has previously been elusive in conventional experiments [<xref ref-type="bibr" rid="pcbi.1005286.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref007">7</xref>]. Folding/unfolding pathways gleaned from individual SM trajectories indicate rugged folding landscapes inherent to biomolecules [<xref ref-type="bibr" rid="pcbi.1005286.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref009">9</xref>]. Long time trajectories from SM measurements, which now can be extended more than hundreds seconds, allow us to address how a rugged conformational landscape is sampled over time [<xref ref-type="bibr" rid="pcbi.1005286.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref011">11</xref>]. One of the striking findings from these measurements is that even under the same folding condition, conformational dynamics of individual molecules differ substantially from one another while still maintaining their biological functions. Cofactor-induced conformational transitions of <italic>T</italic>. ribozymes [<xref ref-type="bibr" rid="pcbi.1005286.ref012">12</xref>], Holliday junctions [<xref ref-type="bibr" rid="pcbi.1005286.ref013">13</xref>], TPP-riboswitch [<xref ref-type="bibr" rid="pcbi.1005286.ref014">14</xref>], and preQ<sub>1</sub>-riboswitch [<xref ref-type="bibr" rid="pcbi.1005286.ref015">15</xref>] are the recent seminal examples that exhibit molecular heterogeneity at equilibrium. The variation in the velocities of individual RecBCD helicase motors along the dsDNA [<xref ref-type="bibr" rid="pcbi.1005286.ref016">16</xref>] is a good example of the molecular heterogeneity out of equilibrium, driven by ATP hydrolysis. Together with other reports [<xref ref-type="bibr" rid="pcbi.1005286.ref017">17</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref028">28</xref>], these could be merely a subset of more widespread, yet unrecognized cases that exhibit dynamical heterogeneity in SM time traces.</p>
<p>The chance of conformational frustration increases with the system size (<italic>N</italic><sub>sys</sub>). For a given <italic>N</italic><sub>sys</sub>, the time for conformational sampling (<italic>τ</italic><sub><italic>sample</italic></sub>) is expected to scale as <inline-formula id="pcbi.1005286.e001"><alternatives><graphic id="pcbi.1005286.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>a</mml:mi> <mml:mi>m</mml:mi> <mml:mi>p</mml:mi> <mml:mi>l</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>y</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1005286.ref029">29</xref>]. Suppose that <italic>T</italic><sub><italic>obs</italic></sub>, which is in practice limited by several factors [<xref ref-type="bibr" rid="pcbi.1005286.ref030">30</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref032">32</xref>], is long enough to observe many (more than hundreds) transitions along a trace generated from SM measurement. Two distinct scenarios arise depending on the length of <italic>τ</italic><sub><italic>sample</italic></sub> relative to <italic>T</italic><sub><italic>obs</italic></sub>, (i) If the sampling time is shorter than <italic>T</italic><sub><italic>obs</italic></sub> (<italic>τ</italic><sub><italic>sample</italic></sub> ≪ <italic>T</italic><sub><italic>obs</italic></sub>), then the conformational space of biomolecule is fully sampled. In this case, the ergodicity of the system is ensured such that for any molecule <italic>α</italic> (or time trace <italic>α</italic>) the time average of an observable <italic>O</italic><sub><italic>α</italic></sub>, <inline-formula id="pcbi.1005286.e002"><alternatives><graphic id="pcbi.1005286.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msub><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>O</mml:mi> <mml:mo>〉</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:msubsup> <mml:msub><mml:mi>O</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="3.33333pt"/><mml:mi>d</mml:mi> <mml:mi>τ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, is equivalent to the ensemble average of <italic>O</italic><sub><italic>α</italic></sub>(<italic>t</italic>) over all <italic>α</italic>’s (1 ≤ <italic>α</italic> ≤ <italic>N</italic><sub><italic>ens</italic></sub>) at any moment <italic>t</italic>, <inline-formula id="pcbi.1005286.e003"><alternatives><graphic id="pcbi.1005286.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>n</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>α</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>n</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:msubsup> <mml:msub><mml:mi>O</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>O</mml:mi> <mml:mo>〉</mml:mo></mml:mrow> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>n</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, i.e., 〈<italic>O</italic>〉<sub><italic>T</italic></sub> = 〈<italic>O</italic>〉<sub><italic>ens</italic></sub>; thus thermodynamic properties of the system can be read out by analyzing a single time trace. (ii) In contrast, if <italic>τ</italic><sub><italic>sample</italic></sub> ≫ <italic>T</italic><sub><italic>obs</italic></sub> is satisfied due to ruggedness of conformational space characterised with a number of deep local basins of attraction, then each time trace can sample only a local region of the conformational space. In this case, dynamic pattern from each time trace would look different, and a change in the dynamic pattern from one time interval to another would be observed only occasionally.</p>
<p>To be more precise about the second scenario (<italic>τ</italic><sub><italic>sample</italic></sub> ≫ <italic>T</italic><sub><italic>obs</italic></sub>), suppose that the average time scale for each local basin of attraction to be “sampled” by the conformational dynamics of molecule is <italic>τ</italic><sub><italic>conf</italic></sub> and that the time for the molecule to make transitions between different superbasins of attraction is <italic>τ</italic><sub><italic>int</italic></sub> (<xref ref-type="fig" rid="pcbi.1005286.g001">Fig 1</xref>). In principle the relaxation rates and energy barrier heights of biomolecules span continuous spectra. So, the clear time scale separation may not always be waranteed. However, to be able to grasp the presence of dynamic disorder, if any, in SM time traces straightforwardly, a separation between two distinct time scales is required such that <italic>τ</italic><sub><italic>conf</italic></sub> ≪ <italic>τ</italic><sub><italic>int</italic></sub> (or <inline-formula id="pcbi.1005286.e004"><alternatives><graphic id="pcbi.1005286.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>G</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>f</mml:mi></mml:mrow> <mml:mo>‡</mml:mo></mml:msubsup> <mml:mo>≪</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>G</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>‡</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>). If <italic>τ</italic><sub><italic>conf</italic></sub> and <italic>τ</italic><sub><italic>int</italic></sub> were comparable (or the spectra of relaxation rates were uniform and continuous), an algorithm we will propose here as well as others could hardly be of any help to conceive a concrete landscape model as the one illustrated in <xref ref-type="fig" rid="pcbi.1005286.g001">Fig 1</xref>. Therefore, here we consider <italic>τ</italic><sub><italic>conf</italic></sub> and <italic>τ</italic><sub><italic>int</italic></sub> as two disparate time scales as illustrated in <xref ref-type="fig" rid="pcbi.1005286.g001">Fig 1</xref>. <italic>τ</italic><sub><italic>conf</italic></sub> is the time at which the time average of an observable <inline-formula id="pcbi.1005286.e005"><alternatives><graphic id="pcbi.1005286.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msub><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>O</mml:mi> <mml:mo>〉</mml:mo></mml:mrow> <mml:mi>τ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>τ</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup> <mml:mi>O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> reaches its steady state value when <italic>τ</italic> &gt; <italic>τ</italic><sub><italic>conf</italic></sub>, corresponding to a time scale in which to fully sample the local basin of attraction. Alternatively, <italic>τ</italic><sub><italic>conf</italic></sub> is limited by a kinetic barrier with the greatest <inline-formula id="pcbi.1005286.e006"><alternatives><graphic id="pcbi.1005286.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>G</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>f</mml:mi></mml:mrow> <mml:mo>‡</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> within the local basin of attraction, so that <inline-formula id="pcbi.1005286.e007"><alternatives><graphic id="pcbi.1005286.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:mo>≳</mml:mo> <mml:mtext> </mml:mtext> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>G</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>f</mml:mi></mml:mrow> <mml:mo>‡</mml:mo></mml:msubsup> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. On the other hand, <italic>τ</italic><sub><italic>int</italic></sub> is the transition time that is expected to scale with the height of kinetic barriers (<inline-formula id="pcbi.1005286.e008"><alternatives><graphic id="pcbi.1005286.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>G</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>‡</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>) between the two superbasins as <inline-formula id="pcbi.1005286.e009"><alternatives><graphic id="pcbi.1005286.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>G</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>‡</mml:mo></mml:msubsup> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. When measurements are conducted with a finite duration of observation time (<italic>T</italic><sub><italic>obs</italic></sub>), we can conceive two entirely different dynamic patterns depending on the relationship between <italic>τ</italic><sub><italic>conf</italic></sub>, <italic>τ</italic><sub><italic>int</italic></sub>, and <italic>T</italic><sub><italic>obs</italic></sub>:</p>
<list list-type="bullet">
<list-item>
<p><italic>τ</italic><sub><italic>conf</italic></sub> ≪ <italic>T</italic><sub><italic>obs</italic></sub> ≪ <italic>τ</italic><sub><italic>int</italic></sub>: The interconversion time between distinct basins of attractions is far longer than the observation time. The dynamic patterns from individual trajectories that sample distinct basin of attraction are expected to differ from each other. Since <italic>T</italic><sub><italic>obs</italic></sub> ≪ <italic>τ</italic><sub><italic>int</italic></sub>, there is few chance to observe an exchange of dynamic pattern in a single time trace, which corresponds to a case with quenched disorder that each SM time trace looks entirely different. Such cases are reported in Holliday junction [<xref ref-type="bibr" rid="pcbi.1005286.ref013">13</xref>], <italic>T</italic>. ribozyme [<xref ref-type="bibr" rid="pcbi.1005286.ref012">12</xref>], and RecBCD [<xref ref-type="bibr" rid="pcbi.1005286.ref016">16</xref>].</p>
</list-item>
<list-item>
<p><italic>τ</italic><sub><italic>conf</italic></sub> ≪ <italic>τ</italic><sub><italic>int</italic></sub> ≲<italic>T</italic><sub><italic>obs</italic></sub>: The interconversion time between basins of attraction is shorter than or comparable to the observation time. In this case, it is possible to observe a few rounds (∼<italic>T</italic><sub><italic>obs</italic></sub>/<italic>τ</italic><sub><italic>int</italic></sub>) of pattern exchanges in a single time trace. Such SM time traces are called to have a dynamic disorder [<xref ref-type="bibr" rid="pcbi.1005286.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref036">36</xref>].</p>
</list-item>
</list>
<fig id="pcbi.1005286.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005286.g001</object-id>
<label>Fig 1</label>
<caption>
<title>A rugged energy-landscape with hierarchical structure and an emergence of multiple time scales of transitions.</title>
<p><italic>τ</italic><sub><italic>int</italic></sub> is the transition time between different superbasins of attraction whereas <italic>τ</italic><sub><italic>conf</italic></sub> is the time scale of conformational dynamics of molecule <italic>within</italic> each basin. Due to large difference in kinetic barriers (<inline-formula id="pcbi.1005286.e010"><alternatives><graphic id="pcbi.1005286.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>G</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>‡</mml:mo></mml:msubsup> <mml:mo>≫</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>G</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>f</mml:mi></mml:mrow> <mml:mo>‡</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>), <italic>τ</italic><sub><italic>int</italic></sub> ≫ <italic>τ</italic><sub><italic>conf</italic></sub>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.g001" xlink:type="simple"/>
</fig>
<p>While the most interesting and physically relevant question to ask about the heterogeneity in single molecule time traces is its molecular origin, detection and quantification of such heterogeneity should precede such question for a further analysis. For SM time traces with quenched disorder, it is relatively straightforward to analyze as one can use the criterion of ergodicity and partition each time trace into its dynamic subensembles [<xref ref-type="bibr" rid="pcbi.1005286.ref013">13</xref>]. It is, however, more challenging to analyze time traces with dynamic disorder.</p>
<p>In the ion-channel community, ion currents across a single ion-channel measured with patch-clamp technique often demonstrate time series that switch between multiple dynamic patterns, and such a phenomenon is called ‘mode-switching’ [<xref ref-type="bibr" rid="pcbi.1005286.ref037">37</xref>] or ‘modal gating’ [<xref ref-type="bibr" rid="pcbi.1005286.ref038">38</xref>]. An algorithm (aggregated Markov model, AMM) developed by ion-channel community to analyze time series exhibiting dynamics disorder is in principle of use, but when applied to our synthetic data, we found that the algorithm tends to overpredict the transitions between hidden states (see <xref ref-type="supplementary-material" rid="pcbi.1005286.s026">S25 Fig</xref> and discussion related to it below). Thus, here we have developed a more reliable and systematic algorithm—Variational Bayes-Double Chain Markov Model (VB-DCMM)—which combined variational Bayes method with Double Chain Markov Model (DCMM) [<xref ref-type="bibr" rid="pcbi.1005286.ref039">39</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref043">43</xref>], to analyze SM time traces with dynamic disorder in which dynamic pattern of conformational transition changes at much longer time scale than apparent conformational fluctuations due to a slower transition of a <italic>hidden</italic> variable.</p>
<p>We first explain the algorithm for VB-DCMM, and next apply our VB-DCMM method to synthetic data as a blind test to show that our method can accurately identify the hidden internal states and determine the kinetic rate constants associated with the data. The results from our analysis using VB-DCMM are reliable as long as a clear separation in time scales exists between the apparent conformational transition (<italic>τ</italic><sub><italic>conf</italic></sub>) and the interconversion times (<italic>τ</italic><sub><italic>int</italic></sub>).</p>
<p>As a prototypical example of single molecule time traces with dynamic disorder, data from H-DNA [<xref ref-type="bibr" rid="pcbi.1005286.ref044">44</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref045">45</xref>] that undergoes duplex-to-triplex conformational transitions (<xref ref-type="fig" rid="pcbi.1005286.g002">Fig 2A</xref>) are analyzed. A kinetic pattern of two-state like conformational transitions between duplex (low FRET ∼ 0.1) and triplex form of H-DNA (high FRET ∼ 0.9) observed in one time interval changes to another pattern in the next time interval (<xref ref-type="fig" rid="pcbi.1005286.g002">Fig 2B</xref>). DCMM models this peculiar dynamic pattern of H-DNA in <xref ref-type="fig" rid="pcbi.1005286.g002">Fig 2B</xref> by assuming a slowly varying dynamics of a hidden internal state. <xref ref-type="fig" rid="pcbi.1005286.g002">Fig 2C</xref> illustrates how the dynamic pattern of the original time trace of <italic>observable state</italic>, <italic>o</italic><sub><italic>n</italic></sub>(<italic>t</italic>) (gray traces in <xref ref-type="fig" rid="pcbi.1005286.g002">Fig 2C</xref>), changes with the <italic>internal state</italic> <italic>x</italic>(<italic>t</italic>) at a given time <italic>t</italic>. The dynamic pattern of <italic>o</italic><sub><italic>n</italic></sub>(<italic>t</italic>), displaying multiple transitions, is slave to the slowly changing value of <italic>x</italic>(<italic>t</italic>). DCMM implements this idea into an algorithm and allows us to extract the information of <italic>x</italic>(<italic>t</italic>) from <italic>o</italic><sub><italic>n</italic></sub>(<italic>t</italic>). Finally, we apply VB-DCMM to an ensemble of H-DNA time traces obtained from smFRET experiments and show that the dynamics of H-DNA at [Na<sup>+</sup>] = 100 mM should be modeled using at least 4 large basins of attraction.</p>
<fig id="pcbi.1005286.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005286.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Duplex-triplex transitions of H-DNA with dynamic disorder.</title>
<p>(A) Illustration of H-DNA dynamics. The sequences in blue and black form duplex via Watson-Crick base pairing; the sequences in red extended from 3’-end region of the black sequence can pair with the sequences in blue via Hoogsteen base pairs to form the triplex helix. (B) A time trace of H-DNA displaying dynamic disorder. (Top) The fluorescence signals from Cy3 (green) and Cy5 (red) dyes. (Bottom) FRET signal (gray) was calculated using the signals from Cy3 and Cy5. Blue line is the noise-filtered FRET signal obtained using HMM. The low-FRET (~0.1) and high-FRET state (~0.9) correspond to the duplex and triplex states, respectively. The dynamic pattern of the time trace changes occasionally from one time interval to another. For example, the transitions from low to high FRET state around 70 s are much slower compared with those around 140 s. (C) The model for H-DNA dynamics with dynamic disorder. Hierarchical transitions, (1) transitions within <italic>x</italic>(<italic>t</italic>) = <italic>i</italic>, and (2) interconversion between <italic>x</italic>(<italic>t</italic>) = <italic>i</italic> and <italic>x</italic>(<italic>t</italic>′) = <italic>j</italic> (<italic>i</italic> ≠ <italic>j</italic>), can be described using Double Chain Markov Model (DCMM). (D) Graphical representation of DCMM. <italic>x</italic>(<italic>t</italic>), <italic>o</italic>(<italic>t</italic>), and <italic>o<sub>n</sub></italic>(<italic>t</italic>) represent internal state, noise-filtered observable (blue line in (B)), and the original observable at time t (gray line in (B)), respectively. The black arrows signify how each state is determined by others. For example, the state of observable at time <italic>t</italic>, <italic>o</italic>(<italic>t</italic>) is determined by the previous observable state at time <italic>t</italic> − 1, o(<italic>t</italic> − 1), and the state of the previous internal state, <italic>x</italic>(<italic>t</italic> − 1).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec002">
<title>Algorithm</title>
<p>Here, we provide a general overview of the VB-DCMM algorithm, defining terms and parameters. More technical details of derivation and implementation of the algorithm are given in the Supplementary Information.</p>
<sec id="sec003">
<title>Modeling time series with dynamic disorder</title>
<p>Markov chain approach is ubiquitously used in modeling biological systems. For example, reversible conformational transitions of biomolecules probed by single molecule fluorescence resonance energy transfer (smFRET) or force spectroscopy are often modeled as a homogeneous Markov process in which the transition rates between experimentally discernible conformational states are uniquely decided. To decipher time series with dynamic disorder that change their dynamic pattern from one time interval to another we assume that there are hidden “internal states”, each of which determines the rate of conformational transitions. A signature of the transition between internal states, which gives rise to dynamic disorder in time series, are difficult to detect using the value of FRET efficiency or end-to-end distance alone when the values observed along the time series are indiscernible even if the internal state is altered. By assuming that the transition between internal states is described by a homogeneous Markov process, and that transition between observable (in this study, FRET) follows non-homogeneous Markov process, whose transition rates are slaved to the internal state at each time, we model time trajectories made of these two layers of Markov chains. This algorithm corresponds to the Double Chain Markov Model (DCMM) [<xref ref-type="bibr" rid="pcbi.1005286.ref039">39</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref043">43</xref>] (<xref ref-type="fig" rid="pcbi.1005286.g002">Fig 2C and 2D</xref>).</p>
<p>DCMM is characterized by the following model parameters: (i) Transition matrix <bold><italic>A</italic></bold> for homogeneous Markov chain, which describes the transition probability between the <italic>K</italic>-distinct internal states along the time series (<bold><italic>x</italic></bold> = (<italic>x</italic>(1), <italic>x</italic>(2), …, <italic>x</italic>(<italic>t</italic>), ⋯, <italic>x</italic>(<italic>T</italic> − 1))). Here <italic>K</italic> is a total number of internal states in the model, and <italic>x</italic>(<italic>t</italic>), specifying internal state at time <italic>t</italic>, takes one of the values between 1 and <italic>K</italic>. <italic>T</italic> is the total observation time. The internal state at time <italic>t</italic>+1 (<italic>x</italic>(<italic>t</italic> + 1)) is determined by the previous internal state at time <italic>t</italic> (<italic>x</italic>(<italic>t</italic>)), whose transition to <italic>x</italic>(<italic>t</italic> + 1) is determined by a <italic>K</italic> × <italic>K</italic> Markov transition matrix <bold><italic>A</italic></bold> as <inline-formula id="pcbi.1005286.e011"><alternatives><graphic id="pcbi.1005286.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>ν</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:msub><mml:mi>A</mml:mi> <mml:mrow><mml:mi>μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ν</mml:mi></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ν</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where <italic>P</italic>(<italic>x</italic>(<italic>t</italic>) = <italic>ν</italic>) denotes the probability of <italic>x</italic>(<italic>t</italic>) being in the <italic>ν</italic>-th internal state; (ii) <italic>K</italic> transition matrices <bold><italic>B</italic></bold><sup>(<italic>μ</italic>)</sup> with <italic>μ</italic> ∈ {1, 2, …, <italic>K</italic>} for non-homogeneous Markov chain describes the transition probability between the observable states along the time series (<bold><italic>o</italic></bold> = (<italic>o</italic>(1), <italic>o</italic>(2), …, <italic>o</italic>(<italic>T</italic>))). <italic>o</italic>(<italic>t</italic>) specifies the state of the observable among <italic>N</italic> possible states {1, 2, …, <italic>N</italic>} at time <italic>t</italic>. Transition from <italic>o</italic>(<italic>t</italic>) to <italic>o</italic>(<italic>t</italic> + 1) is determined by an <italic>N</italic> × <italic>N</italic> transition matrix <bold><italic>B</italic></bold><sup><italic>x</italic>(<italic>t</italic>)</sup>(<italic>t</italic>), the matrix elements of which are slave to the value of <italic>x</italic>(<italic>t</italic>)(= <italic>μ</italic> ∈ {1, 2, …, <italic>K</italic>}).</p>
<p>For example, if there are two (<italic>K</italic> = 2) internal states, and each internal state has three (<italic>N</italic> = 3) observables in a given time trace recorded with time resolution Δ<italic>t</italic>, then two transition matrices for <bold><italic>o</italic></bold> with <italic>μ</italic> = 1, 2 can be considered (i.e., <bold><italic>B</italic></bold><sup>(1)</sup> and <bold><italic>B</italic></bold><sup>(2)</sup>):
<disp-formula id="pcbi.1005286.e012"><alternatives><graphic id="pcbi.1005286.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mfenced close=")" open="("><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>→</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>→</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>→</mml:mo> <mml:mn>3</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>→</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>→</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>→</mml:mo> <mml:mn>3</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mn>3</mml:mn> <mml:mo>→</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mn>3</mml:mn> <mml:mo>→</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mn>3</mml:mn> <mml:mo>→</mml:mo> <mml:mn>3</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
Next, the transition matrix <bold><italic>A</italic></bold> for the interconversion between two internal states is:
<disp-formula id="pcbi.1005286.e013"><alternatives><graphic id="pcbi.1005286.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi> <mml:mo>=</mml:mo> <mml:mfenced close=")" open="("><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>→</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msup><mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>→</mml:mo> <mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo> <mml:mo>→</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msup><mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo> <mml:mo>→</mml:mo> <mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
In the above matrices, the matrix elements must satisfy, <inline-formula id="pcbi.1005286.e014"><alternatives><graphic id="pcbi.1005286.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>3</mml:mn></mml:msubsup> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for each <italic>i</italic> = 1, 2, 3 in <bold><italic>B</italic></bold><sup>(<italic>μ</italic>)</sup>, and <italic>γ</italic><sup>(1)→(1)</sup>Δ<italic>t</italic> + <italic>γ</italic><sup>(1)→(2)</sup>Δ<italic>t</italic> = <italic>γ</italic><sup>(2)→(1)</sup>Δ<italic>t</italic> + <italic>γ</italic><sup>(2)→(2)</sup>Δ<italic>t</italic> = 1 in <bold><italic>A</italic></bold>. More detailed descriptions about DCMM are available in the original papers [<xref ref-type="bibr" rid="pcbi.1005286.ref039">39</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref043">43</xref>] particularly in ref. [<xref ref-type="bibr" rid="pcbi.1005286.ref039">39</xref>] (see also <bold>SI</bold>). A similar but more general version of DCMM, which can accommodate inputs variables as well as multiple number of internal state sequences, has been suggested by extending the factorial hidden Markov model [<xref ref-type="bibr" rid="pcbi.1005286.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref047">47</xref>].</p>
</sec>
<sec id="sec004">
<title>Determining the number of internal states</title>
<p>DCMM can estimate the transition matrices <bold><italic>A</italic></bold> and <bold><italic>B</italic></bold><sup>(<italic>μ</italic>)</sup> quantitatively, and hence determine the most probable sequence of internal state and associated kinetic rates, <inline-formula id="pcbi.1005286.e015"><alternatives><graphic id="pcbi.1005286.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and {<italic>γ</italic><sup>(<italic>μ</italic>)→(<italic>ν</italic>)</sup>}. However, the likelihood (the probability of observing data for given model parameters), maximized by DCMM, <italic>P</italic>(<bold><italic>o</italic></bold>|<bold><italic>π</italic></bold>, <bold><italic>A</italic></bold>, <bold><italic>B</italic></bold>) where <bold><italic>π</italic></bold> ≡ (<italic>π</italic><sub>1</sub>, <italic>π</italic><sub>2</sub>, …, <italic>π</italic><sub><italic>K</italic></sub>) with <italic>π</italic><sub><italic>μ</italic></sub> = <italic>P</italic>(<italic>x</italic>(1) = <italic>μ</italic>|<bold><italic>o</italic></bold>, <bold><italic>A</italic></bold>, <bold><italic>B</italic></bold>), is prone to increase when more number of parameters are used in the model. DCMM can select the best set of parameters for a given model, but not suited to select the best model (i.e., cannot determine the optimal number of internal states <italic>K</italic> for a given time trace). To overcome this limitation, often used is the maximum evidence method, where the <italic>evidence</italic> (<italic>P</italic>(<bold><italic>o</italic></bold>|<italic>K</italic>), also called marginal likelihood) is defined as the conditional probability of observing data (<bold><italic>o</italic></bold>) for a given model (<italic>K</italic>), so that
<disp-formula id="pcbi.1005286.e016"><alternatives><graphic id="pcbi.1005286.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">o</mml:mi> <mml:mo>|</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">o</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">λ</mml:mi> <mml:mo>)</mml:mo> <mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">λ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where <bold><italic>λ</italic></bold> ≡ (<bold><italic>π</italic></bold>, <bold><italic>A</italic></bold>, <bold><italic>B</italic></bold>) represents the parameter space. In this method, the penalty against model complexity is naturally incorporated during the calculation, allowing to select the best model (see <bold>SI</bold>). By calculating the evidence for each different model (different <italic>K</italic>, the number of internal states in data), one can select the best model with an optimal number of internal states that maximizes the evidence. The calculation of the evidence, however, involves a massive computational cost to explore the entire parameter space for a given model.</p>
</sec>
<sec id="sec005">
<title>Variational Bayes double chain Markov model</title>
<p>To alleviate the computational cost in employing the maximum evidence method in <xref ref-type="disp-formula" rid="pcbi.1005286.e016">Eq 1</xref>, we employ the Variational Bayes [<xref ref-type="bibr" rid="pcbi.1005286.ref048">48</xref>], a method that effectively uses a mean-field approximation. The method has previously been used to determine the number of observable states (FRET states) from smFRET data [<xref ref-type="bibr" rid="pcbi.1005286.ref049">49</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref051">51</xref>], the number of diffusive states from single molecule tracking data [<xref ref-type="bibr" rid="pcbi.1005286.ref052">52</xref>], and the number of DNA-protein conformations from tethered particle motion data [<xref ref-type="bibr" rid="pcbi.1005286.ref053">53</xref>]. It has also been used inside the empirical Bayes method which can analyze several smFRET time series simultaneously [<xref ref-type="bibr" rid="pcbi.1005286.ref054">54</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref055">55</xref>]. In our study, the variational Bayes method combined with DCMM (VB-DCMM) was used to analyze single molecule time traces with dynamic disorder. The analytical expression of the lower bound of the <italic>evidence</italic> (<italic>F</italic>), offered by VB-DCMM, makes clear where the model penalty comes from, thus providing guidelines to choose the prior parameters to incorporate a prior knowledge of data (see <bold>SI</bold>). Once prior parameters are selected, VB-DCMM iteratively increases the lower bound of log(<italic>evidence</italic>)(= log <italic>P</italic>(<bold><italic>o</italic></bold>|<italic>K</italic>)) by identifying a better approximation to the true probability distribution.
<disp-formula id="pcbi.1005286.e017"><alternatives><graphic id="pcbi.1005286.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>log </mml:mtext> <mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi mathvariant="bold-italic">o</mml:mi> <mml:mo>|</mml:mo> <mml:mi>K</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>log </mml:mtext> <mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi mathvariant="bold-italic">o</mml:mi> <mml:mo>|</mml:mo> <mml:mi>K</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>q</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>q</mml:mi> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>≥</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msup><mml:mi>q</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>q</italic>(<bold><italic>Z</italic></bold>) is an arbitrary probability distribution of a set of variables, <bold><italic>Z</italic></bold>(≡ (<bold><italic>x</italic></bold>, <bold><italic>λ</italic></bold>)) consisting of parameters and hidden variables of model,
<disp-formula id="pcbi.1005286.e018"><alternatives><graphic id="pcbi.1005286.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mrow><mml:mi>F</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>q</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">log</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">o</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">Z</mml:mi> <mml:mo>|</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mi>q</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">Z</mml:mi> <mml:mo>)</mml:mo></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula>
and
<disp-formula id="pcbi.1005286.e019"><alternatives><graphic id="pcbi.1005286.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>q</mml:mi> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">log</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mi>q</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">Z</mml:mi> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">Z</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">o</mml:mi> <mml:mo>,</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo></mml:mfenced> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>D</italic><sub><italic>KL</italic></sub>(<italic>q</italic>||<italic>p</italic>) is the Kullback-Leibler divergence of <italic>q</italic>(<bold><italic>Z</italic></bold>) from <italic>P</italic>(<bold><italic>Z</italic></bold>|<bold><italic>o</italic></bold>, <italic>K</italic>), which we want to minimize. Once the solution from the algorithm converges, the approximate value of log <italic>P</italic>(<bold><italic>o</italic></bold>|<italic>K</italic>*)(≃ <italic>F</italic>[<italic>q</italic>*]) and the (locally) best model parameters (a set of the best kinetic rates), <bold><italic>π</italic></bold>*, <bold><italic>A</italic></bold>* and <bold><italic>B</italic></bold>*, which determines all the rate constants to describe the given time traces (<inline-formula id="pcbi.1005286.e020"><alternatives><graphic id="pcbi.1005286.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and {<italic>γ</italic><sup>(<italic>μ</italic>)→(<italic>ν</italic>)</sup>}), are acquired from an approximated probability distribution (See SI for the mathematical details). The performance of VB-DCMM is quite robust over a wide variation of prior parameters (<xref ref-type="supplementary-material" rid="pcbi.1005286.s022">S21</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005286.s023">S22</xref> Figs).</p>
</sec>
<sec id="sec006">
<title>Implementation of the algorithm</title>
<p>The observable sequence <bold><italic>o</italic></bold> is obtained by filtering the noise in the experimental data (<bold><italic>o</italic></bold><sub><italic>n</italic></sub>) using Hidden Markov Model (HMM) following a similar procedure as the previous studies [<xref ref-type="bibr" rid="pcbi.1005286.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref056">56</xref>] using a custom code written based on the code from Sagemath software [<xref ref-type="bibr" rid="pcbi.1005286.ref057">57</xref>]. Next, the <bold><italic>o</italic></bold> is analyzed using VB-DCMM to select the best model and to estimate the best model parameters. The optimal sequence of internal states <bold><italic>x</italic></bold> is determined by using Viterbi algorithm [<xref ref-type="bibr" rid="pcbi.1005286.ref039">39</xref>]. All the implementations and data analysis are done by using our custom code. VB-DCMM is freely available at “<ext-link ext-link-type="uri" xlink:href="https://github.com/TBiophysG/VBDCMM" xlink:type="simple">https://github.com/TBiophysG/VBDCMM</ext-link>”</p>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>Results and Discussion</title>
<sec id="sec008">
<title>Validation of VB-DCMM</title>
<p>To first validate the efficacy of VB-DCMM in identifying internal states in a given SM time trace, we applied VB-DCMM algorithm on synthetic data that mimic a SM time trajectory with dynamic disorder (see <xref ref-type="sec" rid="sec015">Methods</xref>). To generate a synthetic SM time trajectory, we first produce a time trajectory specifying the value of internal state from <italic>t</italic> = 1 to <italic>t</italic> = <italic>T</italic> − 1. The time trajectory of internal state is represented with a symbol <bold><italic>x</italic></bold> ≡ (<italic>x</italic>(1), <italic>x</italic>(2), ⋯, <italic>x</italic>(<italic>t</italic>), ⋯, <italic>x</italic>(<italic>T</italic> − 1)). When the total number of distinct internal states in the model is <italic>K</italic>, one of the values in {1, 2, ⋯, <italic>K</italic>} is assigned to <italic>x</italic>(<italic>t</italic>). Thus, for <italic>K</italic> = 2 a typical time trajectory of internal state <bold><italic>x</italic></bold> looks like (1, 1, 1, ⋯, 1, 1, 2, 2, 2, ⋯, 2, 2, 1, 1, ⋯, 1, 1), (1, 1, 1, ⋯, 1, 2, 2, ⋯, 2, 2), (2, 2, ⋯, 2, 1, 1, ⋯, 1, 1, 2, 2, ⋯, 2, 2, 2), etc. The time trajectory given in <xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3A(i)</xref> is an example generated with <italic>K</italic> = 2 and <italic>T</italic> = 8801. Next, similar to the structure of <bold><italic>x</italic></bold>, the time trajectory of noiseless observables is represented using <bold><italic>o</italic></bold> ≡ (<italic>o</italic>(1), <italic>o</italic>(2), ⋯, <italic>o</italic>(<italic>t</italic>), ⋯, <italic>o</italic>(<italic>T</italic>)). In <xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3A(ii)</xref>, a trajectory of <bold><italic>o</italic></bold> is shown, also demonstrating the influence of <bold><italic>x</italic></bold> on <bold><italic>o</italic></bold>. Finally, Gaussian noise was added on <bold><italic>o</italic></bold> and the range of signal was adjusted to produce the final trajectory <bold><italic>o</italic></bold><sub><italic>n</italic></sub> ≡ (<italic>o</italic><sub><italic>n</italic></sub>(1), <italic>o</italic><sub><italic>n</italic></sub>(2), ⋯, <italic>o</italic><sub><italic>n</italic></sub>(<italic>T</italic>)) which now resembles a time trajectory of SM FRET signal (<xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3A(iii)</xref>).</p>
<fig id="pcbi.1005286.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005286.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Validation of VB-DCMM on synthetic data.</title>
<p>(A) (i) A time trace of internal state generated with <italic>γ</italic><sup>(1)→(2)</sup>Δ<italic>t</italic> = γ<sup>(2)→(1)</sup>Δ<italic>t</italic> = 0.001. (ii) An observable time trace generated based on the trace of internal state in (i) by using internal state-dependent parameters <inline-formula id="pcbi.1005286.e021"><alternatives><graphic id="pcbi.1005286.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0.05</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e022"><alternatives><graphic id="pcbi.1005286.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0.00625</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e023"><alternatives><graphic id="pcbi.1005286.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0.025</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. (iii) An synthetic FRET data with Gaussian noise overlaid on the trace in (ii). (iv) Noised filtered FRET state by HMM (blue line). (v) Traces of internal state with different <italic>K</italic>, estimated using VB-DCMM on the noise-filtered FRET trace from (iv) (black line is the true internal state trace while red, orange, and blue are internal state estimated from the model with <italic>K</italic> = 1, 2, and 3, respectively. The indices of internal state were determined by comparing <bold><italic>B</italic></bold><sup>(<italic>μ</italic>)</sup> estimated for each internal state with <bold><italic>B</italic></bold><sup>(<italic>μ</italic>),true</sup> which is used to generate the synthetic data). (B) Estimated lower bound of the evidence function <italic>F</italic>(<italic>K</italic>) of DCMM models with <italic>K</italic> = 1, 2, and 3. (C) Accuracy of detecting internal states. The overlap function <italic>χ</italic> calculated for 100 synthetic FRET traces generated under the identical condition used for generating the trace of internal state shown in (A).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.g003" xlink:type="simple"/>
</fig>
<p>Deciphering the information of internal states from an observed time trace involves solving an inverse problem, i.e., decoding <bold><italic>o</italic></bold><sub><italic>n</italic></sub> to obtain <bold><italic>x</italic></bold>. To decode the trace of internal states from the synthetic data, we follow a 3-step procedure: (1) Filter the noise from <bold><italic>o</italic></bold><sub><italic>n</italic></sub> to obtain <bold><italic>o</italic></bold> using Hidden Markov Model (HMM) [<xref ref-type="bibr" rid="pcbi.1005286.ref056">56</xref>] (<xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3A(iv)</xref>, blue line); (2) Analyze <bold><italic>o</italic></bold> by applying VB-DCMM algorithm with different models 1, 2, …, <italic>K</italic> (again, <italic>K</italic> is the total number of internal states assumed in each model); (3) To select the best model we calculated the conditional probability of observing data for a given model parameter <italic>K</italic>, <italic>P</italic>(<bold><italic>o</italic></bold>|<italic>K</italic>), which is often called <italic>evidence</italic> or <italic>marginal likelihood</italic> in machine learning community (<xref ref-type="disp-formula" rid="pcbi.1005286.e017">Eq 2</xref>) [<xref ref-type="bibr" rid="pcbi.1005286.ref048">48</xref>]. Calculation of <italic>P</italic>(<bold><italic>o</italic></bold>|<italic>K</italic>) is conducted using the Variational Bayes (VB) method, which gives the lower bound of log <italic>P</italic>(<bold><italic>o</italic></bold>|<italic>K</italic>) denoted by <italic>F</italic>(<italic>K</italic>). Details of the evidence function <italic>F</italic>(<italic>K</italic>) and approximation procedure are provided in the Supplementary Information (SI). Finally, we select the best model <italic>K</italic>* which maximizes <italic>F</italic>(<italic>K</italic>), i.e., <italic>K</italic>* = arg max <italic>F</italic>(<italic>K</italic>).</p>
<p>To be specific, in order to identify the best model parameter <italic>K</italic> for the time trace <bold><italic>o</italic></bold>(<italic>t</italic>) given in <xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3A(iv)</xref>, we varied <italic>K</italic> from 1 to 3. The most probable trace of internal states, <inline-formula id="pcbi.1005286.e024"><alternatives><graphic id="pcbi.1005286.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, was calculated for each model with <italic>K</italic> = 1 (red), <italic>K</italic> = 2 (orange), <italic>K</italic> = 3 (blue) (see <xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3A(v)</xref>). The evidence <italic>F</italic>(<italic>K</italic>) calculated using VB method was maximized at <italic>K</italic> = <italic>K</italic>* = 2, and the resulting time trace of the internal states, <inline-formula id="pcbi.1005286.e025"><alternatives><graphic id="pcbi.1005286.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>K</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, most closely recovers the trajectory of <bold><italic>x</italic></bold> (black trace in <xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3A(v)</xref>) except at the time interval where the transitions of <italic>x</italic>(<italic>t</italic>) between 1 and 2 occur only transiently or at the boundaries of transitions (red arrows on <xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3A(v)</xref>). This result shows that VB-DCMM can avoid the over-fitting problem that other methods based on maximum likelihood are often fraught with [<xref ref-type="bibr" rid="pcbi.1005286.ref048">48</xref>].</p>
</sec>
<sec id="sec009">
<title>Conditions required for an accurate recovery of internal states</title>
<p>VB-DCMM detects a signature of change in internal state (<italic>x</italic>) from a given observable time trace (<bold><italic>o</italic></bold>) by evaluating the statistical difference in transition rates. Thus, in the absence of an enough number of transitions in the trace <bold><italic>o</italic></bold>, the algorithm becomes less reliable. For example, we obtained <italic>F</italic>(<italic>K</italic> = 2) ≈ <italic>F</italic>(<italic>K</italic> = 3) although <italic>F</italic>(2) ≫ <italic>F</italic>(3) is more desirable (<xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3B</xref>. See another example in <xref ref-type="supplementary-material" rid="pcbi.1005286.s002">S1 Fig</xref>). This is due to the lack of statistics in transition events in this particular test trace given in <xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3A</xref>. For example, when only a part of the time trace is selected and analyzed using HMM, the estimated rates of transition from high (<italic>H</italic>) to low (<italic>L</italic>) FRET value are <inline-formula id="pcbi.1005286.e026"><alternatives><graphic id="pcbi.1005286.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup> <mml:mspace width="3.33333pt"/><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>016</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> in 1500 ≲ <italic>t</italic> ≲ 4000, and <inline-formula id="pcbi.1005286.e027"><alternatives><graphic id="pcbi.1005286.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup> <mml:mspace width="3.33333pt"/><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>026</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> in 5700 ≲ <italic>t</italic> ≲ 8700. Thus, in (<italic>K</italic> = 3)-model the two time intervals, originally generated by using the same kinetic parameter (<inline-formula id="pcbi.1005286.e028"><alternatives><graphic id="pcbi.1005286.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mspace width="3.33333pt"/><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>025</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>), are determined to be distinct from each other (blue trace in <xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3A(v)</xref>). By contrast, in (<italic>K</italic> = 2)-model, <inline-formula id="pcbi.1005286.e029"><alternatives><graphic id="pcbi.1005286.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup> <mml:mspace width="3.33333pt"/><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>020</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> was estimated over these two time intervals. This type of statistical error is unavoidable for a small <italic>T</italic><sub><italic>obs</italic></sub>. A more systematic evaluation on the accuracy of the algorithm as a function of <italic>T</italic><sub><italic>obs</italic></sub> and transition rate between distinct internal states will be discussed in the next section.</p>
<p>To assess the accuracy of the best model <inline-formula id="pcbi.1005286.e030"><alternatives><graphic id="pcbi.1005286.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>K</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> predicted by VB-DCMM against the solution <bold><italic>x</italic></bold>, the following overlap function can be used.
<disp-formula id="pcbi.1005286.e031">
<alternatives>
<graphic id="pcbi.1005286.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e031" xlink:type="simple"/>
<mml:math display="block" id="M31">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mi>χ</mml:mi>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mi>T</mml:mi>
<mml:mo>-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
<mml:mo>-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:msub>
<mml:mi>δ</mml:mi>
<mml:mrow>
<mml:mi>x</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>,</mml:mo>
<mml:msubsup>
<mml:mi>x</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mi>K</mml:mi>
<mml:mo>*</mml:mo>
</mml:msup>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mtext>model</mml:mtext>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where <italic>δ</italic><sub><italic>i</italic>,<italic>j</italic></sub> is the Kronecker delta and <italic>T</italic> = <italic>T</italic><sub><italic>obs</italic></sub>/Δ<italic>t</italic> is the total number of data in the traces (Δ<italic>t</italic> denotes the temporal resolution of the data). For 100 synthetic time traces, generated under the identical parameters used for producing the time trace in <xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3A</xref>, we found that <italic>χ</italic> ≈ 0.9 on average (<xref ref-type="fig" rid="pcbi.1005286.g003">Fig 3C</xref>). Note, however, that <italic>x</italic>(<italic>t</italic>), only available for the case of “synthetic data”. Thus, to assess the accuracy of our method against a real time trace from SM experiments, we devised other metrics.</p>
<p>For a given time trace with dynamic disorder, our algorithm quantifies the kinetic features of the time trace in terms of the transition rate between the observable states <italic>a</italic> and <italic>b</italic> within the <italic>μ</italic>-th internal state <inline-formula id="pcbi.1005286.e032"><alternatives><graphic id="pcbi.1005286.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and the transition rate from the <italic>μ</italic>-th internal state to <italic>ν</italic>-th internal state <italic>γ</italic><sup>(<italic>μ</italic>)→(<italic>ν</italic>)</sup> (1 ≤ <italic>μ</italic>, <italic>ν</italic> ≤ <italic>K</italic>, 1 ≤ <italic>a</italic>, <italic>b</italic> ≤ <italic>N</italic>. Here, <italic>μ</italic> is the index for internal state whereas <italic>a</italic> and <italic>b</italic> are indices for observable (In FRET displaying low/high two state transitions, these states correspond to the low and high FRET values). <italic>K</italic> is the total number of hidden internal states, and <italic>N</italic> denotes the total number of observables). To be able to extract the information of multiple internal states reliably from a time trace using VB-DCMM, two general conditions are required for the time trace being analyzed.</p>
<list list-type="order">
<list-item>
<p>A large time scale separation should be present in the kinetics within each internal state, i.e., <inline-formula id="pcbi.1005286.e033"><alternatives><graphic id="pcbi.1005286.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005286.e034"><alternatives><graphic id="pcbi.1005286.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ν</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (<italic>μ</italic> ≠ <italic>ν</italic>) should be disparate.</p>
</list-item>
<list-item>
<p>There should be a clear time scale separation between intra-basins and inter-basin transitions (i.e., <italic>τ</italic><sub><italic>conf</italic></sub> and <italic>τ</italic><sub><italic>int</italic></sub>). More precisely, the intra-basin transition probability <inline-formula id="pcbi.1005286.e035"><alternatives><graphic id="pcbi.1005286.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mspace width="3.33333pt"/><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> should be much <italic>greater</italic> than the transition probability from the <italic>μ</italic>-th to any other internal state ∑<sub><italic>ν</italic>≠<italic>μ</italic></sub> <italic>γ</italic><sup>(<italic>μ</italic>)→(<italic>ν</italic>)</sup> Δ<italic>t</italic> (= 1 − <italic>γ</italic><sup>(<italic>μ</italic>)→(<italic>μ</italic>)</sup> Δ<italic>t</italic>).</p>
</list-item>
</list>
<p>To substantiate the above-mentioned conditions 1 and 2, we define two metrics <italic>D</italic><sub>conf</sub> and <italic>D</italic><sub>int</sub>, which compute the average Hamming-like distances between the distinct rate constants extracted from a given time trace using VB-DCMM analysis:
<disp-formula id="pcbi.1005286.e036"><alternatives><graphic id="pcbi.1005286.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>μ</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>a</mml:mi><mml:mo>≠</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>→</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>→</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>ν</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></alternatives> <label>(4)</label></disp-formula>
and
<disp-formula id="pcbi.1005286.e037"><alternatives><graphic id="pcbi.1005286.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>int</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>a</mml:mi><mml:mo>≠</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>→</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>ν</mml:mi><mml:mo>≠</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>ν</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math> </alternatives> <label>(5)</label></disp-formula> <italic>D</italic><sub>conf</sub> measures the dissimilarity between distinct internal states in terms of the intra-basin transition rates. Two distinct internal states (<italic>μ</italic>, <italic>ν</italic> (<italic>μ</italic> ≠ <italic>ν</italic>)) can be better discerned if the intra-basin transition rate of one internal state (say, <inline-formula id="pcbi.1005286.e038"><alternatives><graphic id="pcbi.1005286.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) differs greatly from that of other internal state (<inline-formula id="pcbi.1005286.e039"><alternatives><graphic id="pcbi.1005286.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ν</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>), so that <inline-formula id="pcbi.1005286.e040"><alternatives><graphic id="pcbi.1005286.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mo form="prefix">log</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ν</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is maximized. <italic>D</italic><sub>int</sub> measures the average number of intra-basin transitions in each internal state using the ratio between the transition probabilities, <inline-formula id="pcbi.1005286.e041"><alternatives><graphic id="pcbi.1005286.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mspace width="3.33333pt"/><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and ∑<sub><italic>ν</italic>≠<italic>μ</italic></sub> <italic>γ</italic><sup>(<italic>μ</italic>)→(<italic>ν</italic>)</sup>Δ<italic>t</italic> (= 1 − <italic>γ</italic><sup>(<italic>μ</italic>)→(<italic>μ</italic>)</sup> Δ<italic>t</italic>). A greater <italic>D</italic><sub>int</sub> ensures a large time scale separation in dynamics between intra-basin and inter-basin transitions, which improves the reliability of our method to decode the internal state from a given time trace. In general, <italic>D</italic><sub>int</sub> or <italic>D</italic><sub>conf</sub> shows a good correlation with 〈<italic>χ</italic>〉 (see below); thus, one can use (<italic>D</italic><sub>int</sub>, <italic>D</italic><sub>conf</sub>) to assess the accuracy of predicted internal states. Note that the metrics <italic>D</italic><sub>int</sub> and <italic>D</italic><sub>conf</sub> can be estimated for real data, while 〈<italic>χ</italic>〉 can be calculated only against the synthetic data. Since there is a good correlation between (<italic>D</italic><sub>int</sub>, <italic>D</italic><sub>conf</sub>) and <italic>χ</italic>, one can evaluate (<italic>D</italic><sub>int</sub>, <italic>D</italic><sub>conf</sub>), alternative to <italic>χ</italic>, to assess the reliability of a predicted result of <inline-formula id="pcbi.1005286.e042"><alternatives><graphic id="pcbi.1005286.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>K</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>To be more concrete, we applied VB-DCMM algorithm to analyze synthetic data generated with <italic>N</italic> = 2 (transitioning between high and low FRET values) and <italic>K</italic> = 2 (two internal states; <italic>μ</italic> = 1 and 2) under various scenarios.</p>
<list list-type="bullet">
<list-item>
<p>We fixed the transition rates in the state <italic>μ</italic> = 1 as <inline-formula id="pcbi.1005286.e043"><alternatives><graphic id="pcbi.1005286.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mspace width="3.33333pt"/><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mspace width="3.33333pt"/><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and varied the rates associated with the state <italic>μ</italic> = 2 over the range of <inline-formula id="pcbi.1005286.e044"><alternatives><graphic id="pcbi.1005286.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>125</mml:mn> <mml:mo>≤</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="3.33333pt"/><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>≤</mml:mo> <mml:mn>8</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1005286.g004">Fig 4A</xref>, left). For the interconversion probability between the two internal states we set <italic>γ</italic><sup>(1)→(2)</sup> Δ<italic>t</italic> = <italic>γ</italic><sup>(2)→(1)</sup> Δ<italic>t</italic> = 0.001. The accuracy of the model prediction (〈<italic>χ</italic>〉, <xref ref-type="disp-formula" rid="pcbi.1005286.e031">Eq (3)</xref>) is on average greater than 0.9 as long as the transition rates <inline-formula id="pcbi.1005286.e045"><alternatives><graphic id="pcbi.1005286.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>↔</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005286.e046"><alternatives><graphic id="pcbi.1005286.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>↔</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ν</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (<italic>μ</italic> ≠ <italic>ν</italic>) differ more than the factor of 4. Note that in <xref ref-type="fig" rid="pcbi.1005286.g004">Fig 4A</xref> (left), the value of 〈<italic>χ</italic>〉 is greater for <inline-formula id="pcbi.1005286.e047"><alternatives><graphic id="pcbi.1005286.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e048"><alternatives><graphic id="pcbi.1005286.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>≫</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> than for <inline-formula id="pcbi.1005286.e049"><alternatives><graphic id="pcbi.1005286.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e050"><alternatives><graphic id="pcbi.1005286.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>≪</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>; this is because a statistically sufficient number of transitions make the detection of internal states more reliable. In contrast, when <inline-formula id="pcbi.1005286.e051"><alternatives><graphic id="pcbi.1005286.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e052"><alternatives><graphic id="pcbi.1005286.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>≃</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, i.e. when the kinetics inside the two internal states are essentially identical, it is difficult to discern the two internal states. In this case, <italic>K</italic> = 1 instead of <italic>K</italic> = 2 is effectively the correct number of internal states. Indeed, when <italic>K</italic> = 1 is assumed (i.e., assuming true internal state <italic>x</italic>(<italic>t</italic>) = 1 for all <italic>t</italic> in <xref ref-type="disp-formula" rid="pcbi.1005286.e031">Eq (3)</xref>), the re-calculated 〈<italic>χ</italic>〉 is close to 1 (see <xref ref-type="supplementary-material" rid="pcbi.1005286.s003">S2 Fig</xref>).</p>
</list-item>
<list-item>
<p>To explore the effect of interconversion between distinct internal states on the performance of algorithm, we generated synthetic data with <inline-formula id="pcbi.1005286.e058"><alternatives><graphic id="pcbi.1005286.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mspace width="3.33333pt"/><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mspace width="3.33333pt"/><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e059"><alternatives><graphic id="pcbi.1005286.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>125</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1005286.e060"><alternatives><graphic id="pcbi.1005286.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>25</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> by, this time, varying <italic>γ</italic><sup>(1)→(2)</sup> Δ<italic>t</italic> and <italic>γ</italic><sup>(2)→(1)</sup> Δ<italic>t</italic> = 0.00025 ∼ 0.005 (<xref ref-type="fig" rid="pcbi.1005286.g004">Fig 4B</xref>, left). The results clearly show that the case with smaller <italic>γ</italic><sup>(<italic>μ</italic>)→(<italic>ν</italic>)</sup> results in a higher 〈<italic>χ</italic>〉, which is expected because each internal state can have more number of transitions in the traces <bold><italic>o</italic></bold> when the interconversion is slower (<xref ref-type="fig" rid="pcbi.1005286.g004">Fig 4B</xref>). Re-plotting 〈<italic>χ</italic>〉 as a function of <italic>D</italic><sub>conf</sub> and <italic>D</italic><sub>int</sub> reveals clear dependence of the accuracy on <italic>D</italic><sub>int</sub> (<xref ref-type="fig" rid="pcbi.1005286.g004">Fig 4B</xref>, right). Similar trends are observed for other conditions of <inline-formula id="pcbi.1005286.e061"><alternatives><graphic id="pcbi.1005286.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005286.e062"><alternatives><graphic id="pcbi.1005286.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="supplementary-material" rid="pcbi.1005286.s004">S3 Fig</xref>).</p>
</list-item>
<list-item>
<p>Analyses on synthetic data generated using the same input parameters with those in <xref ref-type="fig" rid="pcbi.1005286.g004">Fig 4</xref>, but with a different number of data points in each trace, <italic>T</italic><sub><italic>obs</italic></sub>/Δ<italic>t</italic> = 4400, and 2200 (<xref ref-type="supplementary-material" rid="pcbi.1005286.s005">S4 Fig</xref>) show a similar trend as observed in <xref ref-type="fig" rid="pcbi.1005286.g004">Fig 4</xref> with <italic>T</italic><sub><italic>obs</italic></sub>/Δ<italic>t</italic> = 8800 but with slightly smaller 〈<italic>χ</italic>〉 values.</p>
</list-item>
<list-item>
<p>Extension of VB-DCMM algorithm to a more complicated case for <italic>K</italic> &gt; 2 (<xref ref-type="supplementary-material" rid="pcbi.1005286.s006">S5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005286.s015">S14</xref> Figs) or <italic>N</italic> &gt; 2 (<xref ref-type="supplementary-material" rid="pcbi.1005286.s007">S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005286.s015">S14</xref> Figs) is straightforward. Application of VB-DCMM to a trajectory in which each internal state trajectory has different <italic>N</italic> is also straightforward (<xref ref-type="supplementary-material" rid="pcbi.1005286.s008">S7 Fig</xref>). In the latter case, the data is analyzed by assuming that all internal states have the same number of possible observables, <italic>N</italic>; but the analysis would indicate that transition associated with a small transition rate is essentially disallowed. In all situations considered for various <italic>K</italic> and <italic>N</italic>, VB-DCMM can be used for the reliable recovery of the sequence of true internal states.</p>
</list-item>
<list-item>
<p>Analyses of synthetic traces show that the accuracy of the algorithm improves with both <italic>D</italic><sub>conf</sub> and <italic>D</italic><sub>int</sub> (<xref ref-type="fig" rid="pcbi.1005286.g004">Fig 4</xref> right panels and <xref ref-type="fig" rid="pcbi.1005286.g005">Fig 5</xref>). Thus, these two metrics allow one to judge the reliability of the information on internal states extracted from a given time trace. Alternatively, a single parameter <italic>D</italic><sub>tot</sub>(= <italic>D</italic><sub>conf</sub> + <italic>αD</italic><sub>int</sub>) with an empirically acquired coefficient <italic>α</italic> ≈ 0.8) can be used to judge the reliability of the extracted information. Note that 〈<italic>χ</italic>〉 remains similar as long as <italic>D</italic><sub>tot</sub> remains constant (<xref ref-type="fig" rid="pcbi.1005286.g005">Fig 5B</xref>). Hence, when 〈<italic>χ</italic>〉 is plotted against <italic>D</italic><sub>tot</sub>, all synthetic data generated using different parameters approximately collapse onto a single universal curve (<xref ref-type="supplementary-material" rid="pcbi.1005286.s009">S8 Fig</xref>).</p>
</list-item>
<list-item>
<p>There are multiple ways of assessing the efficacy of VB-DCMM in decoding the internal states. In addition to 〈<italic>χ</italic>〉, <italic>D</italic><sub>conf</sub>, <italic>D</italic><sub>int</sub>, and <italic>D</italic><sub>tot</sub> as the possible measures for the assessment, one can also use the statistical property that the dwell times of homogeneous Markov process satisfies <inline-formula id="pcbi.1005286.e063"><alternatives><graphic id="pcbi.1005286.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:msqrt><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:msup><mml:mi>τ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>〉</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt> <mml:mo>/</mml:mo> <mml:mrow><mml:mo>〈</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (see <bold>SI</bold> for details).</p>
</list-item>
</list>
<fig id="pcbi.1005286.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005286.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Accuracy of VB-DCMM in detecting internal states under various conditions of <inline-formula id="pcbi.1005286.e053"><alternatives><graphic id="pcbi.1005286.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>↔</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <italic>γ</italic><sup>(1)↔(2)</sup> with <italic>T</italic><sub><italic>obs</italic></sub>/Δ<italic>t</italic> = 8800.</title>
<p>(A) The color bar denotes the accuracy of analysis in terms of 〈<italic>χ</italic>〉 under varying <inline-formula id="pcbi.1005286.e054"><alternatives><graphic id="pcbi.1005286.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> with <italic>K</italic> = 2, <inline-formula id="pcbi.1005286.e055"><alternatives><graphic id="pcbi.1005286.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e056"><alternatives><graphic id="pcbi.1005286.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and <italic>γ</italic><sup>(1)→(2)</sup>Δ<italic>t</italic> = <italic>γ</italic><sup>(2)→(1)</sup>Δ<italic>t</italic> = 0.001. (B) 〈<italic>χ</italic>〉 under varying <italic>γ</italic><sup>(1)→(2)</sup> and <italic>γ</italic><sup>(2)→(1)</sup> with <italic>K</italic> = 2, <inline-formula id="pcbi.1005286.e057"><alternatives><graphic id="pcbi.1005286.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>00625</mml:mn> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>0125</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. 〈<italic>χ</italic>〉 was calculated by averaging over the results from analysis of 100 traces in each condition. The panels on the right show the relation between the value of 〈<italic>χ</italic>〉 and pairs of <italic>D</italic><sub>int</sub> and <italic>D</italic><sub>conf</sub> values which are evaluated at varying kinetic parameters. Results from the analysis over the data with the same parameters but different length of time trace (or different number of data points <italic>T</italic><sub><italic>obs</italic></sub>/Δ<italic>t</italic> = 2200, 4400) are provided in <xref ref-type="supplementary-material" rid="pcbi.1005286.s005">S4 Fig</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.g004" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005286.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005286.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Average accuracy of internal state detection as a function of <italic>D</italic><sub>conf</sub>, and <italic>D</italic><sub>int</sub>.</title>
<p>To construct this diagram, we employed various synthetic data in <xref ref-type="fig" rid="pcbi.1005286.g004">Fig 4</xref> (circle, two internal states (<italic>K</italic> = 2), two FRET states (<italic>N</italic> = 2)), <xref ref-type="supplementary-material" rid="pcbi.1005286.s006">S5 Fig</xref> (left triangle, <italic>K</italic> = 3, <italic>N</italic> = 2), and <xref ref-type="supplementary-material" rid="pcbi.1005286.s007">S6 Fig</xref> (hexagon, <italic>K</italic> = 2, <italic>N</italic> = 3). The right triangle symbol denotes the result from the similar analysis shown in <xref ref-type="supplementary-material" rid="pcbi.1005286.s006">S5 Fig</xref> with <italic>K</italic> = 3 but with smaller relative differences in the transition rates, <italic>k</italic>’s. Pentagon represents the result obtained with <italic>K</italic> = 4 and <italic>N</italic> = 2. (A) Color code denotes the accuracy of internal states predictions in terms of 〈<italic>χ</italic>〉, averaged over 100 traces for each condition. (B) The dashed lines corresponding to Δ = <italic>D</italic><sub>conf</sub> + 0.8<italic>D</italic><sub>int</sub> = 4, 5, … 9 are overlaid on the 2-D scatter plot of 〈<italic>χ</italic>〉(<italic>D</italic><sub>conf</sub>, <italic>D</italic><sub>int</sub>) calculated in (A).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Application of VB-DCMM on H-DNA data</title>
<p>Now, to analyze the duplex-triplex transitions of H-DNA (<xref ref-type="fig" rid="pcbi.1005286.g006">Fig 6</xref>), we obtain <bold><italic>o</italic></bold> by filtering the noise from FRET signal (<xref ref-type="fig" rid="pcbi.1005286.g006">Fig 6(ii)</xref>, blue line) and apply the VB-DCMM algorithm to decode the hidden internal state in the signals. <xref ref-type="fig" rid="pcbi.1005286.g006">Fig 6(iii)</xref> shows time series of internal state, <inline-formula id="pcbi.1005286.e064"><alternatives><graphic id="pcbi.1005286.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, calculated from the VB-DCMM by varying <italic>K</italic> from 1 to 5. It is of note that the number of actually observed internal states in the <inline-formula id="pcbi.1005286.e065"><alternatives><graphic id="pcbi.1005286.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> for a given input parameter <italic>K</italic> does not change after some <italic>K</italic><sub><italic>obs</italic></sub>(≤ <italic>K</italic>) (<italic>K</italic><sub><italic>obs</italic></sub> = 2 (<xref ref-type="fig" rid="pcbi.1005286.g006">Fig 6A</xref>), 2 (<xref ref-type="fig" rid="pcbi.1005286.g006">Fig 6B</xref>), 2 (<xref ref-type="fig" rid="pcbi.1005286.g006">Fig 6C</xref>), and 1 (<xref ref-type="fig" rid="pcbi.1005286.g006">Fig 6D</xref>)). (See also other time traces of synthetic data and H-DNA analyzed in SI: <xref ref-type="supplementary-material" rid="pcbi.1005286.s002">S1A Fig</xref> (<italic>K</italic><sub><italic>obs</italic></sub> = 1), <xref ref-type="supplementary-material" rid="pcbi.1005286.s010">S9A Fig</xref> (<italic>K</italic><sub><italic>obs</italic></sub> = 3), <xref ref-type="supplementary-material" rid="pcbi.1005286.s010">S9B Fig</xref> (<italic>K</italic><sub><italic>obs</italic></sub> = 2), <xref ref-type="supplementary-material" rid="pcbi.1005286.s010">S9C Fig</xref> (<italic>K</italic><sub><italic>obs</italic></sub> = 3), <xref ref-type="supplementary-material" rid="pcbi.1005286.s010">S9D Fig</xref> (<italic>K</italic><sub><italic>obs</italic></sub> = 3), <xref ref-type="supplementary-material" rid="pcbi.1005286.s011">S10A Fig</xref> (<italic>K</italic><sub><italic>obs</italic></sub> = 4), <xref ref-type="supplementary-material" rid="pcbi.1005286.s011">S10B Fig</xref> (<italic>K</italic><sub><italic>obs</italic></sub> = 2), <xref ref-type="supplementary-material" rid="pcbi.1005286.s011">S10C Fig</xref> (<italic>K</italic><sub><italic>obs</italic></sub> = 2), <xref ref-type="supplementary-material" rid="pcbi.1005286.s011">S10D Fig</xref> (<italic>K</italic><sub><italic>obs</italic></sub> = 3), and <xref ref-type="supplementary-material" rid="pcbi.1005286.s013">S12 Fig</xref> (<italic>K</italic><sub><italic>obs</italic></sub> = 3)). A similar behavior is also observed when analyzing data using the variational Bayes Gaussian mixture model [<xref ref-type="bibr" rid="pcbi.1005286.ref048">48</xref>].</p>
<fig id="pcbi.1005286.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005286.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Representative time traces of H-DNA at [Na<sup>+</sup>] = 100 mM and their analysis.</title>
<p>(A) (i) Fluorescence signal and (ii) their FRET state. (iii) Internal states estimated for <italic>K</italic> = 1, 2, …, 5. Right panel shows <italic>G</italic>(<italic>K</italic>) (blue circle) where <italic>K</italic><sub><italic>obs</italic></sub> specifies the number of detected internal states in individual traces (blue). (B, C, D) Other representative time traces and their <italic>G</italic>(<italic>K</italic>) obtained under the same experimental condition.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.g006" xlink:type="simple"/>
</fig>
<p>To account for the contribution due to degeneracy in labeling the internal states, log <italic>K</italic>! term is conventionally considered in formulating the evidence function <italic>F</italic>(<italic>K</italic>) (See <bold>SI</bold> for the details); however, in our problems, the actual number of degeneracy in labeling internal states should be <inline-formula id="pcbi.1005286.e066"><alternatives><graphic id="pcbi.1005286.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:msub><mml:mrow/> <mml:mi>K</mml:mi></mml:msub> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub> <mml:mo>×</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mo>!</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> instead of <italic>K</italic>!. Therefore, we replace the log <italic>K</italic>! term in <italic>F</italic>(<italic>K</italic>) with log [<italic>K</italic>!/(<italic>K</italic> − <italic>K</italic><sub><italic>obs</italic></sub>)!], and considered a modified evidence function, <italic>G</italic>(<italic>K</italic>), to identify an optimal <italic>K</italic> for a given time trace:
<disp-formula id="pcbi.1005286.e067"><alternatives><graphic id="pcbi.1005286.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e067" xlink:type="simple"/><mml:math display="block" id="M67"><mml:mrow><mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo> <mml:mo>!</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula> <italic>G</italic>(<italic>K</italic>) shows a clear peak, allowing us to identify the optimal <italic>K</italic>(= <italic>K</italic>*) with ease (blue circles on the right side of Figs <xref ref-type="fig" rid="pcbi.1005286.g006">6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005286.s010">S9</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005286.s011">S10</xref>). Use of <italic>G</italic>(<italic>K</italic>) instead of <italic>F</italic>(<italic>K</italic>) in analyzing synthetic data does not alter <italic>K</italic>* (<xref ref-type="supplementary-material" rid="pcbi.1005286.s013">S12</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005286.s015">S14B</xref> Figs).</p>
<p>Among the time traces of H-DNA, traces with more than 3 interconversions between distinct internal states, which enables us to estimate <italic>γ</italic><sup>(<italic>μ</italic>)→(<italic>ν</italic>)</sup>, are rare, especially when [Na<sup>+</sup>] = 100 mM; thus it is not feasible to get a statistically meaningful scatter plot of (<italic>D</italic><sub>conf</sub>, <italic>D</italic><sub>int</sub>) (see <xref ref-type="supplementary-material" rid="pcbi.1005286.s024">S23D, S23E and S23F Fig</xref>); however, for those displayed in <xref ref-type="supplementary-material" rid="pcbi.1005286.s024">S23D, S23E and S23F Fig</xref>, 〈<italic>D</italic><sub>tot</sub>〉 ≈ 7 suggests that <italic>χ</italic> ≳ 0.9 (from <xref ref-type="fig" rid="pcbi.1005286.g005">Fig 5</xref>). Therefore, at least the intra-basin rate constants extracted from H-DNA data using VB-DCMM are reliable.</p>
<p>Time traces that have <italic>τ</italic><sub><italic>int</italic></sub> comparable to experimental observation time (<inline-formula id="pcbi.1005286.e068"><alternatives><graphic id="pcbi.1005286.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>≈</mml:mo> <mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>) would exhibit on average no or only a single transition event between distinct internal states. Indeed, we find that only a subset of total number of internal states is sampled by individual time traces due to the limited observation time. For instance, at [NaCl] = 100 mM, our analysis identified <italic>K</italic>* ≤ 2 in 265 out of 269 traces, and that only 4 time traces display <italic>K</italic>* &gt; 2 (<xref ref-type="supplementary-material" rid="pcbi.1005286.s012">S11 Fig</xref>). Therefore, in order to identify the internal states present in the transition dynamics of H-DNA, clustering analysis is required against the whole ensemble of time trajectories. We provide the procedure of clustering analysis and results in details in the following section.</p>
</sec>
<sec id="sec011">
<title>Clustering H-DNA data</title>
<p>VB-DCMM algorithm allows us to decompose individual H-DNA time traces with dynamic disorder into multiple “components”, each of which should satisfies the property of <italic>homogeneous Markov chain</italic>. In order to understand the structure of conformational space of H-DNA, the ensemble of components acquired from the VB-DCMM analysis should be clustered into the same kind. To this end, we produce scatter plots of (<italic>k</italic><sub><italic>L</italic>→<italic>H</italic></sub>, <italic>k</italic><sub><italic>H</italic>→<italic>L</italic></sub>), representing the kinetic property of the ensemble of time traces, using the transition rates estimated for individual time traces. The scatter plots of (<italic>k</italic><sub><italic>L</italic>→<italic>H</italic></sub>, <italic>k</italic><sub><italic>H</italic>→<italic>L</italic></sub>) were calculated for the ensemble of H-DNA time traces (i) before (<xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7A</xref>, left) and (ii) after decomposing the individual heterogeneous time traces retaining multiple components into the homogeneous ones (<xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7A</xref>, right). The scatter plot of (<italic>k</italic><sub><italic>L</italic>→<italic>H</italic></sub>, <italic>k</italic><sub><italic>H</italic>→<italic>L</italic></sub>) after the decomposition has a greater dispersion, which is expected since a data point (<italic>k</italic><sub><italic>L</italic>→<italic>H</italic></sub>, <italic>k</italic><sub><italic>H</italic>→<italic>L</italic></sub>) for a time trace with dynamic disorder is a mixture of <inline-formula id="pcbi.1005286.e069"><alternatives><graphic id="pcbi.1005286.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with <italic>μ</italic> = 1, 2, … <italic>K</italic>. In the presence of clear distinction between internal states (<italic>μ</italic> ≠ <italic>ν</italic>), the clustering of <inline-formula id="pcbi.1005286.e070"><alternatives><graphic id="pcbi.1005286.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> would be straightforward, which is indeed the case for the synthetic data (<xref ref-type="supplementary-material" rid="pcbi.1005286.s014">S13A Fig</xref>). However, for the H-DNA data, even after the decomposition, the clustering of data on (<italic>k</italic><sub><italic>L</italic>→<italic>H</italic></sub>, <italic>k</italic><sub><italic>H</italic>→<italic>L</italic></sub>) plane (<xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7A</xref>) is not that clear.</p>
<fig id="pcbi.1005286.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005286.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Clustering H-DNA data at [Na<sup>+</sup>] = 100 mM condition.</title>
<p>(A) The scatter plots of (<italic>k</italic><sub><italic>L</italic>→<italic>H</italic></sub>, <italic>k</italic><sub><italic>H</italic>→<italic>L</italic></sub>) before (left) and after (right) applying VB-DCMM from [Na<sup>+</sup>] = 100 mM data. (B) The “average pairing distance” <inline-formula id="pcbi.1005286.e071"><alternatives><graphic id="pcbi.1005286.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mrow><mml:mi mathvariant="script">D</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> as a function of the number of clusters (<inline-formula id="pcbi.1005286.e072"><alternatives><graphic id="pcbi.1005286.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mi mathvariant="script">K</mml:mi></mml:math></alternatives></inline-formula>)(see <xref ref-type="sec" rid="sec015">Methods</xref>). The minimum value of <inline-formula id="pcbi.1005286.e073"><alternatives><graphic id="pcbi.1005286.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:mi mathvariant="script">D</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is found at <inline-formula id="pcbi.1005286.e074"><alternatives><graphic id="pcbi.1005286.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mrow><mml:mi mathvariant="script">K</mml:mi> <mml:mo>=</mml:mo> <mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. (C) Left: the scatter plot of clustered data projected on <inline-formula id="pcbi.1005286.e075"><alternatives><graphic id="pcbi.1005286.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> plane. Right: scatter plot of clustered data projected on <inline-formula id="pcbi.1005286.e076"><alternatives><graphic id="pcbi.1005286.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> plane. The data belonging to different clusters are depicted in different colors, and the centroid of each cluster is marked with the × symbol. Total 98 data points were used for analysis. (D) The result of the above clustering is represented using 6 kinetic arrows which represent the centroids of each cluster represented in (<italic>k</italic><sub><italic>L</italic>→<italic>H</italic></sub>, <italic>k</italic><sub><italic>H</italic>→<italic>L</italic></sub>) plane. The starting point of the arrow is (<inline-formula id="pcbi.1005286.e077"><alternatives><graphic id="pcbi.1005286.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mrow><mml:mo>〈</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mtext>bf</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e078"><alternatives><graphic id="pcbi.1005286.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:mrow><mml:mo>〈</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mtext>bf</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>) whereas the ending point of the arrow is (<inline-formula id="pcbi.1005286.e079"><alternatives><graphic id="pcbi.1005286.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:mrow><mml:mo>〈</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mtext>af</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e080"><alternatives><graphic id="pcbi.1005286.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:mrow><mml:mo>〈</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mtext>af</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>), where the superscript <italic>μ</italic> represents the index of each cluster <italic>μ</italic> = 1, 2, … 6. The colors used for depicting kinetic arrows are consistent with the data points in (C). (E) A schematic of the conformational landscape of H-DNA.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.g007" xlink:type="simple"/>
</fig>
<p>To improve the quality of clustering, we extended the clustering of the kinetic data to a higher dimension by considering the kinetic information of internal states that are contiguous (kinetically linked) along time traces. To be specific, for a time trace exhibiting a transition from the <italic>μ</italic>-th to <italic>ν</italic>-th internal state (<italic>μ</italic> ≠ <italic>ν</italic>), one can consider that the inter-basin transition has occurred from the time interval represented by its pair of kinetic rate <inline-formula id="pcbi.1005286.e081"><alternatives><graphic id="pcbi.1005286.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to the next time interval represented by <inline-formula id="pcbi.1005286.e082"><alternatives><graphic id="pcbi.1005286.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ν</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ν</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where the superscripts, ‘bf’ and ‘af’ denotes ‘before’ and ‘after’ the transition, respectively. Thus, instead of (<italic>k</italic><sub><italic>L</italic>→<italic>H</italic></sub>, <italic>k</italic><sub><italic>H</italic>→<italic>L</italic></sub>), a clustering at a higher dimension can be carried out by measuring the Euclidean distance between a pair of the four-dimensional (4-dim) arrays, <inline-formula id="pcbi.1005286.e083"><alternatives><graphic id="pcbi.1005286.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>In order to cluster the 4-dim arrays we used the k-means clustering algorithm. Application of the algorithm to the H-DNA data at [Na<sup>+</sup>] = 100 mM reveals that the average pairing distance, <inline-formula id="pcbi.1005286.e084"><alternatives><graphic id="pcbi.1005286.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mrow><mml:mi mathvariant="script">D</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (see <xref ref-type="sec" rid="sec015">Methods</xref>), is minimized when the number of clusters is 6 (<inline-formula id="pcbi.1005286.e085"><alternatives><graphic id="pcbi.1005286.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:mrow><mml:mi mathvariant="script">K</mml:mi> <mml:mo>=</mml:mo> <mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>), namely, the model with 6 clusters provides the best interpretation of the data (<xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7B</xref>). Although the model with 14 clusters shows a smaller <inline-formula id="pcbi.1005286.e086"><alternatives><graphic id="pcbi.1005286.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mi mathvariant="script">D</mml:mi></mml:math></alternatives></inline-formula>, we selected <inline-formula id="pcbi.1005286.e087"><alternatives><graphic id="pcbi.1005286.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:mrow><mml:mi mathvariant="script">K</mml:mi> <mml:mo>=</mml:mo> <mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> as the best solution, since for <inline-formula id="pcbi.1005286.e088"><alternatives><graphic id="pcbi.1005286.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:mrow><mml:mi mathvariant="script">K</mml:mi> <mml:mo>=</mml:mo> <mml:mn>14</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> each of 12 clusters out of 14 has less than 10 data points, which makes the result of clustering statistically less significant (<xref ref-type="supplementary-material" rid="pcbi.1005286.s017">S16 Fig</xref>). This results remain qualitatively identical when <italic>L</italic>1 distance (so called “city block” distance) was used instead of “square-euclidean” distance (<xref ref-type="supplementary-material" rid="pcbi.1005286.s020">S19 Fig</xref>). Furthermore, the clustering algorithm using “affinity propagation” [<xref ref-type="bibr" rid="pcbi.1005286.ref058">58</xref>], which considers all the data points as possible exemplars (analogous to centroids in k-means clustering method) and iteratively exchanges messages between them, also gives qualitatively identical results, confirming the robustness of the conclusion on H-DNA dynamics obtained from VB-DCMM and k-mean clustering (see <xref ref-type="supplementary-material" rid="pcbi.1005286.s021">S20 Fig</xref>).</p>
<p>We present the result of clustering either (i) by projecting it on the two separate kinetic planes, <inline-formula id="pcbi.1005286.e089"><alternatives><graphic id="pcbi.1005286.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005286.e090"><alternatives><graphic id="pcbi.1005286.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which visualize the inter-basin transitions in terms of variable <italic>L</italic> → <italic>H</italic> and <italic>H</italic> → <italic>L</italic> transition rates (see <xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7C</xref>), or (ii) by using “interconversion arrows” linking the kinetic rates of two internal states, <inline-formula id="pcbi.1005286.e091"><alternatives><graphic id="pcbi.1005286.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mo>[</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>→</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:math></alternatives></inline-formula> on the (<italic>k</italic><sub><italic>L</italic>→<italic>H</italic></sub>, <italic>k</italic><sub><italic>H</italic>→<italic>L</italic></sub>) plane (<xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7D</xref>). Note that in the scatter plot visualized with <inline-formula id="pcbi.1005286.e092"><alternatives><graphic id="pcbi.1005286.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, the distinction between different clusters is clear (the right panel of <xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7C</xref>). Furthermore, for a system in equilibrium or at least near equilibrium, the interconversion between two internal states, say <italic>μ</italic> and <italic>ν</italic>, should occur in both directions, i.e., <italic>μ</italic> → <italic>ν</italic> and <italic>ν</italic> → <italic>μ</italic>. In the representation (i), a symmetry of <inline-formula id="pcbi.1005286.e093"><alternatives><graphic id="pcbi.1005286.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ν</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ν</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>→</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is expected in the both panels of <xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7C</xref>; and in the representation (ii), the “arrows”, amounting to the kinetic connectivity between distinct internal states, should be bi-directional. The symmetry of the data plotted in <xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7C</xref> or the bidirectionality of the kinetic arrows confirms the condition of detailed balance being satisfied in the system in equilibrium. <xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7D</xref> depicts 6 kinetic arrows (3 pairs of reversible kinetic arrows) connecting the centroids of <inline-formula id="pcbi.1005286.e094"><alternatives><graphic id="pcbi.1005286.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1005286.e095"><alternatives><graphic id="pcbi.1005286.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>bf</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mtext>af</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> data.</p>
<p>Application of the above clustering method to synthetic data with <italic>K</italic> = 3, <italic>N</italic> = 2 (<xref ref-type="supplementary-material" rid="pcbi.1005286.s014">S13 Fig</xref>) is straightforward. To check the efficacy of clustering method for a more complicated case, we have tested with synthetic data generated with <italic>K</italic> = 4, <italic>N</italic> = 4, i.e. when there are as many as 4 observable states in each internal state (<xref ref-type="supplementary-material" rid="pcbi.1005286.s015">S14</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005286.s016">S15</xref> Figs). In the case with 4 observable states, total 12 possible intrabasin transitions are conceivable. Thus, the dimension of the array associated with interbasin transition is 24. As long as there is a clear time scale separation, it is expected that the pairing distance <inline-formula id="pcbi.1005286.e096"><alternatives><graphic id="pcbi.1005286.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:mrow><mml:mi mathvariant="script">D</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>=</mml:mo> <mml:mn>12</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> shows minimum as there are 12 connection paths between 4 internal states. Indeed, <inline-formula id="pcbi.1005286.e097"><alternatives><graphic id="pcbi.1005286.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:mrow><mml:mi mathvariant="script">D</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is minimized at <inline-formula id="pcbi.1005286.e098"><alternatives><graphic id="pcbi.1005286.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mrow><mml:mi mathvariant="script">K</mml:mi> <mml:mo>=</mml:mo> <mml:mn>12</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="supplementary-material" rid="pcbi.1005286.s016">S15A Fig</xref>).</p>
<p>Lastly, it is noteworthy that the clustering method presented here is not limited to data analysis for systems in equilibrium, but can be extended to systems in nonequilibrium steady state [<xref ref-type="bibr" rid="pcbi.1005286.ref059">59</xref>] where the individual state-to-state kinetic transition rate is well defined using the reversible Markov process although the condition of detailed balance is no longer anticipated [<xref ref-type="bibr" rid="pcbi.1005286.ref060">60</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref061">61</xref>]. The symmetry of data point and bidirectionality of kinetic arrows as in <xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7C and 7D</xref> are still of use to cluster the kinetic information generated from a system in nonequilibrium steady states.</p>
</sec>
<sec id="sec012">
<title>Folding energy landscape of H-DNA</title>
<p>We classified the “components” of a similar kinetic pattern (<italic>k</italic><sub><italic>L</italic> → <italic>H</italic></sub>, <italic>k</italic><sub><italic>H</italic> → <italic>L</italic></sub>) obtained from VB-DCMM into a single cluster which represents a kinetic path linking two independent basins of attraction (or internal states). For example, the kinetic paths in <xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7D</xref> can be best understood by hypothesizing 4 internal states (four basins) linked by 6 kinetic paths. Thus, the conformational transition landscape of H-DNA at [Na<sup>+</sup>] = 100 mM condition consists of 4 internal states with 3 reversible kinetic paths being established as illustrated in <xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7E</xref>. At lower salt concentrations ([Na<sup>+</sup>] = 50 mM (<xref ref-type="supplementary-material" rid="pcbi.1005286.s018">S17 Fig</xref>) and [Na<sup>+</sup>] = 26 mM (<xref ref-type="supplementary-material" rid="pcbi.1005286.s019">S18 Fig</xref>)), H-DNA transitions slow down and the dispersion of data also increases; however, the overall structure of conformational landscape of H-DNA remains unchanged from the picture suggested in <xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7E</xref>; thus, there is a central superbasin to which three other superbasins are kinetically connected (<xref ref-type="supplementary-material" rid="pcbi.1005286.s018">S17</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005286.s019">S18</xref> Figs).</p>
</sec>
<sec id="sec013">
<title>Contributions of our work</title>
<p>In comparison to other pre-existing methods, the advantage of our VB-DCMM in decoding dynamic disorder from a given trajectory is highlighted as follows:</p>
<p>(1) Dynamic disorders in single molecule time trajectories are modeled using DCMM by assuming the presence of hidden internal states. While Aggregated Markov Model (AMM), which has been adopted in ion-channel community for time trace analysis of varying current [<xref ref-type="bibr" rid="pcbi.1005286.ref062">62</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref076">76</xref>], can be employed to analyze our data with dynamic disorder, DCMM is better in correctly decoding dynamic disorder than AMM. We found that AMM is prone to overpredict the transition between kinetic patterns (<xref ref-type="supplementary-material" rid="pcbi.1005286.s026">S25 Fig</xref>). Our method is more suitable to the data showing persistent dynamic patterns by suppressing unwanted frequent transition between kinetic patterns. Detailed explanations of connection and quantitative comparison between DCMM and AMM are provided in SI and <xref ref-type="supplementary-material" rid="pcbi.1005286.s026">S25 Fig</xref>.</p>
<p>(2) In this paper, Bayesian version of DCMM was developed by using variational Bayes (VB) method, which enabled us to determine the number of internal states straightforwardly. Although Bayesian version of DCMM using Markov chain Monte Carlo (MCMC) method has previously been developed for the credit portfolio modeling [<xref ref-type="bibr" rid="pcbi.1005286.ref077">77</xref>], the idea of Bayesian inference in ref. [<xref ref-type="bibr" rid="pcbi.1005286.ref077">77</xref>] was used only for the purpose of calculating a posterior distribution of model parameters. To determine the number of hidden states corresponding to the internal states in this study, the authors in ref. [<xref ref-type="bibr" rid="pcbi.1005286.ref077">77</xref>] used the economic cycle fluctuation model, instead. Our study combining VB with DCMM (i) can determine the number of internal states in a more objective fashion, (ii) offers intuitive way to incorporate prior knowledge, and (iii) is computationally more efficient than MCMC (See SI for details).</p>
<p>(3) We tested VB-DCMM under various conditions, by varying the kinetic rates, the number of observables, the number of hidden states, and prior parameters. New metrics were also devised to quantify the performance of algorithm systematically.</p>
<p>(4) Finally the connection paths (kinetic arrows) between internal states of H-DNA are clustered by using the kinetic components extracted from VB-DCMM and by applying k-means clustering algorithm to high dimensional arrays.</p>
<p>To recapitulate, our entire process of analyzing single molecule data is composed of three stages: (i) noise-filtering using HMM; (ii) decomposition of heterogeneous time traces into the homogeneous components using VB-DCMM; (iii) clustering the decomposed components into the same cluster.</p>
<p>In principle, this three-stage analysis can be made more systematic by combining the noise-filtering and clustering procedure with VB-DCMM. To be more specific, (1) The noise-filtering of observable trace (<italic>o</italic><sub><italic>n</italic></sub>) is processed, independently from the main VB-DCMM algorithm, by using HMM, which has been proved to be reliable in noise-filtering [<xref ref-type="bibr" rid="pcbi.1005286.ref056">56</xref>], and the maximum number of observables (<italic>N</italic>) are predetermined as an input parameter. Current version of algorithm can be further automated by combining with the Bayesian version of HMM [<xref ref-type="bibr" rid="pcbi.1005286.ref049">49</xref>], which can determine the number of observables while filtering the noise in data (See <xref ref-type="fig" rid="pcbi.1005286.g002">Fig 2D</xref>). The resulting model will have a similar structure with the modified factorial HMM [<xref ref-type="bibr" rid="pcbi.1005286.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref047">47</xref>]. (2) The heterogeneous components identified from individual time traces are clustered separately from our main algorithm. It would be also desirable to unify the post-processing step (clustering) with VB-DCMM using empirical Bayes method which has been applied recently to analyze single molecule data [<xref ref-type="bibr" rid="pcbi.1005286.ref054">54</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref055">55</xref>].</p>
<p>However, it should also be noted that a blind integration of noise-filtering and clustering steps inevitably complicates the implementation of VB-DCMM, as more number of prior parameters are ought to be decided by users. For example, Bayesian implementation of HMM for noise filtering demands manual determination of additional <italic>N</italic>(<italic>N</italic> + 5) prior-parameters [<xref ref-type="bibr" rid="pcbi.1005286.ref049">49</xref>]. Compared to this, currently VB-DCMM requires users to pre-determine only one prior parameter which characterizes the final transition rate matrix, <bold><italic>A</italic></bold> (see the subsection: <italic>Selection of prior parameters</italic> in SI). Moreover, the integration of other methods will obscure the flow of analysis, making it difficult to identify an error-causing step. Keeping each step in the algorithm separate makes the integration of VB-DCMM to other applications more transparent (for example, if noise-filtering by HMM is unsuccessful, other advanced method can be employed [<xref ref-type="bibr" rid="pcbi.1005286.ref049">49</xref>]). We leave it as our future work to develop an algorithm that integrates the above-mentioned three procedures (noise-filtering, VB-DCMM, and clustering) without increasing complexity or obscuring the flow of analysis.</p>
<p>In decoding SM FRET data, the most notable difference of our VB-DCMM from the previous studies employing the probabilistic models such as maximum likelihood and Bayesian statistics is that VB-DCMM explicitly considers the situation that transition rates can change from one time interval to another within individual time traces. The previous studies [<xref ref-type="bibr" rid="pcbi.1005286.ref049">49</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref051">51</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref056">56</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref078">78</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref080">80</xref>] assumed that the transition rates were constant within individual time traces. Also, currently, VB-DCMM is applicable to window-averaging FRET trajectories. It will be of great interest to extend VB-DCMM to analyzing time trajectories in which arrival times for individual photons are available. VB-DCMM is particularly powerful when there is a separation in time scales between <italic>τ</italic><sub><italic>int</italic></sub> and <italic>τ</italic><sub><italic>conf</italic></sub>.</p>
</sec>
<sec id="sec014">
<title>Concluding remarks</title>
<p>While the notion of dynamical heterogeneity or broken ergodicity seems better recognized in the research field of nucleic acids [<xref ref-type="bibr" rid="pcbi.1005286.ref081">81</xref>] than in proteins, which likely arises from more homopolymer-like nature of building block of nucleotides [<xref ref-type="bibr" rid="pcbi.1005286.ref082">82</xref>], biomolecules in general can have a rugged folding landscape with many local basins of attraction and kinetic barriers with varying heights [<xref ref-type="bibr" rid="pcbi.1005286.ref083">83</xref>]. Conformational dynamics of biomolecules on rugged landscapes can be heterogeneous, which gives rise to static or dynamic disorder depending on the time scale of observation or the height distribution of kinetic barrier. The presence of heterogeneity or disorder among individual molecules, unveiled by <italic>in vitro</italic> SM experiments could be surprising at first sight; however, it is also important to note that the general hypotheses in the conventional molecular biology towards a single native state have been put forward based on the observations from ensemble experiments where the heterogeneity, if any, is usually masked by the process of ensemble averaging. Given that the complexity of a molecular system increases with the system size (<italic>N</italic><sub>sys</sub>) as <inline-formula id="pcbi.1005286.e099"><alternatives><graphic id="pcbi.1005286.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:mrow><mml:mo>∼</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mtext>sys</mml:mtext></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1005286.ref029">29</xref>], it should not be too surprising to find such disorder in biomolecules in itself. Cells are equipped with molecular chaperones that can tame misfolding-prone biomolecules with rugged landscapes [<xref ref-type="bibr" rid="pcbi.1005286.ref084">84</xref>–<xref ref-type="bibr" rid="pcbi.1005286.ref087">87</xref>]; thus the principle of optimization in biology, if it fails at the level of a molecule in isolation, can be extended further to the molecular system including its environmental factors.</p>
<p>It is not easy to elucidate the molecular origin of disorder in a conclusive manner; yet, it has recently been suspected that interactions of biomolecules with cofactor such as ATP and multivalent metal-ions could be the microscopic causes for those molecules exhibiting dynamical heterogeneity [<xref ref-type="bibr" rid="pcbi.1005286.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref088">88</xref>, <xref ref-type="bibr" rid="pcbi.1005286.ref089">89</xref>]. Modulating the concentration of Mg<sup>2+</sup> ions from high to low and again to high induced inter-conversions of dynamic patterns in equilibrium conformational fluctuations of <italic>T</italic>. ribozyme [<xref ref-type="bibr" rid="pcbi.1005286.ref012">12</xref>] and Holliday junctions [<xref ref-type="bibr" rid="pcbi.1005286.ref013">13</xref>]. Distinct velocities of ATP-empowered individual RecBED helicase motors, which can move progressively along dsDNA by unwinding it into two separate strands, can be reset by introducing a long pause by halting the supply of ATP. For the time trajectories of biomolecules displaying quenched disorder, a method to analyze such data was proposed using a concept from glass physics [<xref ref-type="bibr" rid="pcbi.1005286.ref013">13</xref>]. Here, to deal with more general scenarios, we have developed a method to analyze single molecule time traces with dynamic disorder.</p>
<p>As demonstrated by testing the VB-DCMM algorithm on synthetic data, the algorithm is quite accurate in decoding dynamic disorder as long as a time trajectory of interest contains multiple time intervals, each of which display kinetic pattern distinct from others. When a clear separation in timescale is present between two distinct kinetic patterns, large value of <italic>D</italic><sub>conf</sub>, <italic>D</italic><sub>int</sub>, and <italic>D</italic><sub>tot</sub> would be acquired.</p>
<p>While we developed the VB-DCMM algorithm primarily to analyze dynamic disorder in duplex-triplex transitions of H-DNA, the method is applicable to any data in the form of one-dimensional time series with multiple transitions. Together with a further technical advance in SM, which eliminates experimental artifacts as well as extends the measurement time, our algorithm developed here will contribute to better understanding of biomolecules that display heterogeneous dynamics.</p>
</sec>
</sec>
<sec id="sec015" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec016">
<title>Generation of synthetic data</title>
<p>Internal state sequence <bold><italic>x</italic></bold> was generated by using Monte Carlo method with a constant transition matrix (homogeneous Markov chain model). The observable sequence <bold><italic>o</italic></bold> was generated by using the same method but with the transition matrix that was defined at each time <italic>t</italic> based on the internal state <italic>x</italic>(<italic>t</italic>). Finally, Gaussian noise was added on <bold><italic>o</italic></bold> to produce <bold><italic>o</italic></bold><sub><italic>n</italic></sub>.</p>
</sec>
<sec id="sec017">
<title>Single-molecule FRET measurements to monitor duplex-triplex transitions of H-DNA</title>
<p>We purchased triplex forming oligonucleotides from Integrated DNA Technologies (Coralville, IA, USA). The oligonucleotides were dissolved in T50 buffer solution (10 mM Tris-HCl, 50 mM NaCl, pH = 7.5) and were heated beyond the melting temperature of DNA duplex (∼ 90°C), and slowly cooled down on a heat block to room temperature over 8 hour to properly hybridize them. The DNA prepared as such is called “H-DNA” here. The sequences of the triplex forming strands (purine-rich and pyrimidine-rich) are: Purine-rich strand: 5’ AAG AAG AAG AAG AAG (Cy5) TGG CGA CGG CAG CGA (Biotin) 3’, Pyrimidine-rich strand: 5’ TCG CTG CCG TCG CCA CTT CTT CTT CTT CTT TTT TCT TCT TCT TCT TCT TC (Cy3) 3’. In the purine-rich strand, the biotin at 3’ terminus is used to attach the H-DNA molecule to a neutravidin-coated cover-glass. The Cy3 and Cy5 dyes in the H-DNA molecule correspond to a donor and an acceptor for FRET measurements, respectively. In order to observe the transition between folded triplex and unfolded DNA, we used the reaction buffer containing 50 mM HEPES(Sigma-Aldrich) and various concentrations of Na<sup>+</sup> (26, 50, 100 mM). These buffer solutions also contained 2 mM trolox, 10% glucose and gloxy for single-molecule fluorescence experiments. We utilized a home-made TIRF (Total Internal Reflection Fluorescence) microscope to measure the FRET efficiency between donor and acceptor dyes, which reveals the conformational state of the H-DNA molecule. A 532-nm laser (CrystaLaser DPSS, 10 mW) was used to excite donor molecules and fluorescence intensities of both dyes were measured by an EMCCD (Andor iXon DV887, Andor technology). To observe the change of FRET efficiency in real time, we measured the time-lapse FRET traces with the repetition rate of 10 Hz. To study kinetic features of the conformational transition with dynamic disorder, we acquired the FRET time traces for a long period (&gt;100 sec).</p>
</sec>
<sec id="sec018">
<title>Clustering at a higher dimension</title>
<p>For given <italic>N</italic> and <italic>K</italic>, total <italic>N</italic>(<italic>N</italic> − 1) intra-basin transition rates <inline-formula id="pcbi.1005286.e100"><alternatives><graphic id="pcbi.1005286.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (<italic>a</italic>, <italic>b</italic> ∈ {1, 2, ⋯, <italic>N</italic>}, <italic>a</italic> ≠ <italic>b</italic>) are defined in the <italic>μ</italic>-th basin (or <italic>μ</italic>-th internal state) and total <italic>K</italic>(<italic>K</italic> − 1) inter-basin transitions are conceivable. To cluster the kinetic information of H-DNA data obtained from VB-DCMM, we consider the <italic>kinetic arrow</italic>, 2<italic>N</italic>(<italic>N</italic> − 1)-dimensional array of data, which has the structure of <inline-formula id="pcbi.1005286.e101"><alternatives><graphic id="pcbi.1005286.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>≡</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>bf</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>af</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where the subscript <italic>i</italic> denotes an index referring to one of <italic>K</italic>(<italic>K</italic> − 1) possible inter-basin transitions linking two internal states (<italic>μ</italic> ≠ <italic>ν</italic>). For a kinetic scheme made of a network of reversible transitions between <italic>K</italic> internal states, the transition between two internal states should be bidirectional; thus for a given inter-basin transition path <italic>i</italic>, there should be a kinetic path <italic>j</italic> antiparallel to the path <italic>i</italic>, satisfying <inline-formula id="pcbi.1005286.e102"><alternatives><graphic id="pcbi.1005286.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:mrow><mml:mrow><mml:mo>∥</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">C</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>∥</mml:mo> <mml:mtext> </mml:mtext> <mml:mo>≈</mml:mo> <mml:mtext> </mml:mtext> <mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1005286.e103"><alternatives><graphic id="pcbi.1005286.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">C</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>≡</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>af</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>bf</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In our problem, the set of all the data generated as an outcome of VB-DCMM can in principle be clustered into the disjoint subsets of size 2 partitioning the <inline-formula id="pcbi.1005286.e104"><alternatives><graphic id="pcbi.1005286.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:mi mathvariant="script">K</mml:mi></mml:math></alternatives></inline-formula> transition paths, <inline-formula id="pcbi.1005286.e105"><alternatives><graphic id="pcbi.1005286.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:mrow><mml:mo>{</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>|</mml:mo> <mml:mn>1</mml:mn> <mml:mo>≤</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>K</mml:mi> <mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and one realization of such disjoint subsets will minimize the pairwise sum of Euclidean distances <inline-formula id="pcbi.1005286.e106"><alternatives><graphic id="pcbi.1005286.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:mrow><mml:mrow><mml:mo>∥</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">C</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>β</mml:mi></mml:msub> <mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for all <italic>α</italic> and <italic>β</italic>; however, the method suffers from high computational cost as the possible number of clusters increases rapidly with <italic>N</italic> and <italic>K</italic>.</p>
<p>To alleviate the computational cost for large <italic>N</italic> and <italic>K</italic>, we modified the original method. We first searched the the best partitioning set of data <inline-formula id="pcbi.1005286.e107"><alternatives><graphic id="pcbi.1005286.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for a given <inline-formula id="pcbi.1005286.e108"><alternatives><graphic id="pcbi.1005286.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:mi mathvariant="script">K</mml:mi></mml:math></alternatives></inline-formula> that minimizes the Euclidean distance between all the pairs of centroids,
<disp-formula id="pcbi.1005286.e109"><alternatives><graphic id="pcbi.1005286.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e109" xlink:type="simple"/><mml:math display="block" id="M109"><mml:mrow><mml:msup><mml:mi mathvariant="script">D</mml:mi> <mml:mi>c</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>2</mml:mn> <mml:mi mathvariant="script">K</mml:mi></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
where <inline-formula id="pcbi.1005286.e110"><alternatives><graphic id="pcbi.1005286.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>∥</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">C</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1005286.e111"><alternatives><graphic id="pcbi.1005286.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>≡</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mo>〈</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>bf</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mo>〈</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>af</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e112"><alternatives><graphic id="pcbi.1005286.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">C</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>≡</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mo>〈</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>af</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mo>〈</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>bf</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and 〈…〉 denotes the centroid of clustered data. To obtain the best clustering result for a given <inline-formula id="pcbi.1005286.e113"><alternatives><graphic id="pcbi.1005286.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:mi mathvariant="script">K</mml:mi></mml:math></alternatives></inline-formula>, we conducted k-means clustering using <italic>k</italic>_<italic>means</italic> function from scikit-learn libraries [<xref ref-type="bibr" rid="pcbi.1005286.ref090">90</xref>] with 20,000 different random initial conditions in each analysis. It is expected that <inline-formula id="pcbi.1005286.e114"><alternatives><graphic id="pcbi.1005286.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:mrow><mml:msup><mml:mi mathvariant="script">D</mml:mi> <mml:mi>c</mml:mi></mml:msup> <mml:mo stretchy="false">(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>2</mml:mn> <mml:mi mathvariant="script">K</mml:mi></mml:mfrac> <mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle> <mml:mo>≥</mml:mo> <mml:mfrac><mml:mn>2</mml:mn> <mml:mi mathvariant="script">K</mml:mi></mml:mfrac> <mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo stretchy="false">(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula>. The summation, ∑<sub>(<italic>i</italic>,<italic>j</italic>)</sub>, signifies that the sum is taken over the disjoint subsets of size 2 partitioning a set <inline-formula id="pcbi.1005286.e115"><alternatives><graphic id="pcbi.1005286.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:mrow><mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1005286.e116"><alternatives><graphic id="pcbi.1005286.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:mi mathvariant="script">K</mml:mi></mml:math></alternatives></inline-formula> being an even number) and <inline-formula id="pcbi.1005286.e117"><alternatives><graphic id="pcbi.1005286.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e117" xlink:type="simple"/><mml:math display="inline" id="M117"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the best partitioning set that minimizes the value of <inline-formula id="pcbi.1005286.e118"><alternatives><graphic id="pcbi.1005286.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e118" xlink:type="simple"/><mml:math display="inline" id="M118"><mml:mrow><mml:msup><mml:mi mathvariant="script">D</mml:mi> <mml:mi>c</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for a given <inline-formula id="pcbi.1005286.e119"><alternatives><graphic id="pcbi.1005286.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:mi mathvariant="script">K</mml:mi></mml:math></alternatives></inline-formula>. For example, provided that there are 4 kinetic arrows made of centroids (<italic>i</italic> = 1, 2, 3, 4), which minimizes <inline-formula id="pcbi.1005286.e120"><alternatives><graphic id="pcbi.1005286.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:msup><mml:mi mathvariant="script">D</mml:mi> <mml:mi>c</mml:mi></mml:msup></mml:math></alternatives></inline-formula> at <inline-formula id="pcbi.1005286.e121"><alternatives><graphic id="pcbi.1005286.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:mrow><mml:mi mathvariant="script">K</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> when <italic>i</italic> = 1 is paired with <italic>i</italic> = 3 and <italic>i</italic> = 2 with <italic>i</italic> = 4, then <italic>S</italic>*(2) = {{1, 3}, {2, 4}} and <inline-formula id="pcbi.1005286.e122"><alternatives><graphic id="pcbi.1005286.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:mrow><mml:msup><mml:mi mathvariant="script">D</mml:mi> <mml:mi>c</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mn>13</mml:mn> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mn>24</mml:mn> <mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Next, in order to decide the optimal <inline-formula id="pcbi.1005286.e123"><alternatives><graphic id="pcbi.1005286.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e123" xlink:type="simple"/><mml:math display="inline" id="M123"><mml:mi mathvariant="script">K</mml:mi></mml:math></alternatives></inline-formula>, we calculated pairing distance between paired clusters in <inline-formula id="pcbi.1005286.e124"><alternatives><graphic id="pcbi.1005286.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> again, but this time using all the elements in each cluster. The total pairing score
<disp-formula id="pcbi.1005286.e125"><alternatives><graphic id="pcbi.1005286.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e125" xlink:type="simple"/><mml:math display="block" id="M125"><mml:mrow><mml:mi mathvariant="script">D</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mn>2</mml:mn> <mml:mi mathvariant="script">K</mml:mi></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
where the average pairing distance between two clusters <italic>i</italic> and <italic>j</italic> is defined as <inline-formula id="pcbi.1005286.e126"><alternatives><graphic id="pcbi.1005286.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>M</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:msub><mml:mi>M</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msubsup> <mml:mrow><mml:mo>∥</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi> <mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">C</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msub><mml:mi>j</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:msub> <mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where <inline-formula id="pcbi.1005286.e127"><alternatives><graphic id="pcbi.1005286.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e127" xlink:type="simple"/><mml:math display="inline" id="M127"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi> <mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mtext>bf</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mtext>af</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e128"><alternatives><graphic id="pcbi.1005286.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e128" xlink:type="simple"/><mml:math display="inline" id="M128"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">C</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msub><mml:mi>j</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:msub><mml:mi>j</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mtext>af</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mrow><mml:msub><mml:mi>j</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mtext>bf</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and <italic>n</italic> refers to an index for the element in the <italic>i</italic>-th cluster and <italic>m</italic> to an index for the elements in the <italic>j</italic>-th cluster. <italic>M</italic><sub><italic>i</italic></sub> is the total number of the elements in the <italic>i</italic>-th cluster. Finally, the optimal <inline-formula id="pcbi.1005286.e129"><alternatives><graphic id="pcbi.1005286.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e129" xlink:type="simple"/><mml:math display="inline" id="M129"><mml:msup><mml:mi mathvariant="script">K</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, minimizing <inline-formula id="pcbi.1005286.e130"><alternatives><graphic id="pcbi.1005286.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e130" xlink:type="simple"/><mml:math display="inline" id="M130"><mml:mrow><mml:mi mathvariant="script">D</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, is selected, i.e., <inline-formula id="pcbi.1005286.e131"><alternatives><graphic id="pcbi.1005286.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e131" xlink:type="simple"/><mml:math display="inline" id="M131"><mml:mrow><mml:msup><mml:mi mathvariant="script">K</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo form="prefix">arg</mml:mo> <mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mi mathvariant="script">D</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and the interpretation of data is conducted for the best partitioning set <inline-formula id="pcbi.1005286.e132"><alternatives><graphic id="pcbi.1005286.e132g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e132" xlink:type="simple"/><mml:math display="inline" id="M132"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mi mathvariant="script">K</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>For H-DNA data at three different Na<sup>+</sup> concentrations, the optimal <inline-formula id="pcbi.1005286.e133"><alternatives><graphic id="pcbi.1005286.e133g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e133" xlink:type="simple"/><mml:math display="inline" id="M133"><mml:msup><mml:mi mathvariant="script">K</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula> are determined at <inline-formula id="pcbi.1005286.e134"><alternatives><graphic id="pcbi.1005286.e134g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e134" xlink:type="simple"/><mml:math display="inline" id="M134"><mml:mrow><mml:msup><mml:mi mathvariant="script">K</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for [Na<sup>+</sup>] = 100 mM (<xref ref-type="fig" rid="pcbi.1005286.g007">Fig 7A</xref>), <inline-formula id="pcbi.1005286.e135"><alternatives><graphic id="pcbi.1005286.e135g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e135" xlink:type="simple"/><mml:math display="inline" id="M135"><mml:mrow><mml:msup><mml:mi mathvariant="script">K</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>10</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for [Na<sup>+</sup>] = 50 mM (<xref ref-type="supplementary-material" rid="pcbi.1005286.s018">S17B Fig</xref>), <inline-formula id="pcbi.1005286.e136"><alternatives><graphic id="pcbi.1005286.e136g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e136" xlink:type="simple"/><mml:math display="inline" id="M136"><mml:mrow><mml:msup><mml:mi mathvariant="script">K</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>12</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for [Na<sup>+</sup>] = 26 mM (<xref ref-type="supplementary-material" rid="pcbi.1005286.s019">S18B Fig</xref>). This implies that the complexity of conformational space of H-DNA increases at low salt condition (also see the scatter plot of (<italic>k</italic><sub><italic>L</italic> → <italic>H</italic></sub>, <italic>k</italic><sub><italic>H</italic> → <italic>L</italic></sub>) in Figs <xref ref-type="fig" rid="pcbi.1005286.g007">7A</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005286.s018">S17A</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005286.s019">S18A</xref>).</p>
<p>The clustering results presented in this study remain robust regardless of the choice of distance metric. K-means clustering using <italic>L</italic>1 distance (“city block”) measure with 20,000 different random initial conditions also was led to qualitatively similar results (<xref ref-type="supplementary-material" rid="pcbi.1005286.s020">S19 Fig</xref>). Furthermore, as an alternative clustering algorithm, we also tested “affinity propagation” [<xref ref-type="bibr" rid="pcbi.1005286.ref058">58</xref>] on our data, and the results remain qualitatively identical (see <xref ref-type="supplementary-material" rid="pcbi.1005286.s021">S20 Fig</xref>). In the affinity propagation method, negative square-euclidean distance was employed as a similarity metric (<italic>s</italic>(<italic>i</italic>, <italic>j</italic>) = −||<bold><italic>x</italic></bold><sub><italic>i</italic></sub> − <bold><italic>x</italic></bold><sub><italic>j</italic></sub>||<sup>2</sup>) where <bold><italic>x</italic></bold><sub><italic>i</italic></sub> denotes the coordinate of the <italic>i</italic>-th data point. The objective of the algorithm is to optimize the factorized probability distribution which approximates the net similarity <inline-formula id="pcbi.1005286.e137"><alternatives><graphic id="pcbi.1005286.e137g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e137" xlink:type="simple"/><mml:math display="inline" id="M137"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula>, defined as <inline-formula id="pcbi.1005286.e138"><alternatives><graphic id="pcbi.1005286.e138g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e138" xlink:type="simple"/><mml:math display="inline" id="M138"><mml:mrow><mml:mi mathvariant="script">S</mml:mi> <mml:mo>∼</mml:mo> <mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Here, <italic>c</italic><sub><italic>i</italic></sub> is the index of the exemplar of <italic>i</italic>-th data point <bold><italic>x</italic></bold><sub><italic>i</italic></sub>. For example, if <italic>c</italic><sub><italic>i</italic></sub> = <italic>k</italic>, <bold><italic>x</italic></bold><sub><italic>k</italic></sub> is an exemplar of <bold><italic>x</italic></bold><sub><italic>i</italic></sub> and <bold><italic>x</italic></bold><sub><italic>i</italic></sub> belongs to the cluster represented by <bold><italic>x</italic></bold><sub><italic>k</italic></sub>. Multiple iterations of message passing are carried out until convergence is achieved in the result and the best result of clustering is acquired. For implementation, we used <italic>AffinityPropagation</italic> class from <italic>scikit</italic> [<xref ref-type="bibr" rid="pcbi.1005286.ref090">90</xref>] library with varying “preference” as an input parameter, where the preference denotes the logarithm of probability that <italic>i</italic>-th data point <italic>x</italic><sub><italic>i</italic></sub> selects itself as an exemplar. Further details of the algorithm are available in Ref. [<xref ref-type="bibr" rid="pcbi.1005286.ref058">58</xref>].</p>
</sec>
</sec>
<sec id="sec019">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005286.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supplementary Information.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>VB-DCMM analysis on synthetic data generated with the following parameters: <italic>K</italic><sup>true</sup> = 2, <italic>γ</italic><sup>(1)→(2)</sup>Δ<italic>t</italic> = γ<sup>(2)→(1)</sup>Δ<italic>t</italic> = 0.001, <inline-formula id="pcbi.1005286.e139"><alternatives><graphic id="pcbi.1005286.e139g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e139" xlink:type="simple"/><mml:math display="inline" id="M139"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0.05</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e140"><alternatives><graphic id="pcbi.1005286.e140g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e140" xlink:type="simple"/><mml:math display="inline" id="M140"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0.0025</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Re-calculated accuracy of model prediction (〈<italic>χ</italic>〉) by assuming “<italic>K</italic> = 1”.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Systematic validation of VB-DCMM on synthetic data generated under various conditions with <italic>T</italic><sub><italic>obs</italic></sub>/Δ<italic>t</italic> = 8800.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s005" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Accuracy of VB-DCMM on synthetic data with <italic>T</italic><sub><italic>obs</italic></sub>/Δ<italic>t</italic> = 4400 and 2200.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s006" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>VB-DCMM analysis on synthetic data having three internal states.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s007" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>VB-DCMM analysis on synthetic data having 3 observables.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s008" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>VB-DCMM analysis on synthetic data having 4 observables (<italic>o</italic> = 1, 2, 3, and 4) when internal state <italic>x</italic> = 1, or having 2 (<italic>o</italic> = 1, 3) observables when <italic>x</italic> = 2.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s009" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Average accuracy of the model prediction 〈<italic>χ</italic>〉 versus <italic>D</italic><sub>tot</sub> = <italic>D</italic><sub>conf</sub> + 0.8<italic>D</italic><sub>int</sub> from various synthetic data.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s010" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Representative time traces of H-DNA dynamics and their analysis using VB-DCMM at [Na<sup>+</sup>] = 50 mM.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s011" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Representative time traces of H-DNA dynamics and their analysis using VB-DCMM at [Na<sup>+</sup>] = 26 mM.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s012" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Representative time traces of H-DNA dynamics which display more than two internal states within the trace at [Na<sup>+</sup>] = 26 mM.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s013" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s013" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>VB-DCMM analysis on synthetic data generated with the following parameters: <italic>T</italic><sub><italic>obs</italic></sub>/Δ<italic>t</italic> = 4400, <italic>K</italic><sup>true</sup> = 2, <italic>γ</italic><sup>(1)→(2)</sup>Δ<italic>t</italic> = γ<sup>(2)→(1)</sup>Δ<italic>t</italic> = 0.001, <inline-formula id="pcbi.1005286.e141"><alternatives><graphic id="pcbi.1005286.e141g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e141" xlink:type="simple"/><mml:math display="inline" id="M141"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>→</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0.05</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e142"><alternatives><graphic id="pcbi.1005286.e142g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e142" xlink:type="simple"/><mml:math display="inline" id="M142"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0.00625</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005286.e143"><alternatives><graphic id="pcbi.1005286.e143g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005286.e143" xlink:type="simple"/><mml:math display="inline" id="M143"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>→</mml:mo> <mml:mi>H</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0.0125</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s014" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s014" xlink:type="simple">
<label>S13 Fig</label>
<caption>
<title>Clustering synthetic data with three internal states (<italic>K</italic> = 3) with two observable states (<italic>N</italic> = 2).</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s015" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s015" xlink:type="simple">
<label>S14 Fig</label>
<caption>
<title>VB-DCMM analysis on synthetic data having four internal states (<italic>K</italic> = 4) with four observable states (<italic>N</italic> = 4).</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s016" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s016" xlink:type="simple">
<label>S15 Fig</label>
<caption>
<title>Clustering synthetic data with three internal states (<italic>K</italic> = 4) with four observable states (<italic>N</italic> = 4).</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s017" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s017" xlink:type="simple">
<label>S16 Fig</label>
<caption>
<title>Clustering H-DNA data ([Na<sup>+</sup>] = 100 mM).</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s018" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s018" xlink:type="simple">
<label>S17 Fig</label>
<caption>
<title>Clustering H-DNA data ([Na<sup>+</sup>] = 50 mM).</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s019" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s019" xlink:type="simple">
<label>S18 Fig</label>
<caption>
<title>Clustering H-DNA data ([Na<sup>+</sup>] = 26 mM).</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s020" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s020" xlink:type="simple">
<label>S19 Fig</label>
<caption>
<title>H-DNA data ([Na<sup>+</sup>] = 100 mM) analyzed with k-means clustering algorithm using “city block” distance (<italic>L</italic>1-distance).</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s021" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s021" xlink:type="simple">
<label>S20 Fig</label>
<caption>
<title>Clustering results of H-DNA data ([Na<sup>+</sup>] = 100 mM) from “affinity propagation” method.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s022" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s022" xlink:type="simple">
<label>S21 Fig</label>
<caption>
<title>Accuracy of the model prediction in terms of 〈<italic>χ</italic>〉 under varying prior parameters <italic>u</italic><sub><italic>b</italic></sub>, and <italic>u</italic><sub><italic>bd</italic></sub>.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s023" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s023" xlink:type="simple">
<label>S22 Fig</label>
<caption>
<title>Accuracy of the model prediction in terms of 〈<italic>χ</italic>〉 under varying prior parameters <italic>u</italic><sub><italic>a</italic></sub>, and <italic>u</italic><sub><italic>ad</italic></sub>.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s024" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s024" xlink:type="simple">
<label>S23 Fig</label>
<caption>
<title>Effect of decomposing the original H-DNA time traces into its homogeneous Markov components.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s025" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s025" xlink:type="simple">
<label>S24 Fig</label>
<caption>
<title>Comparison of <italic>φ</italic><sub>20</sub> = <italic>σ</italic><sub>20</sub>/<italic>μ</italic><sub>20</sub> histograms on synthetic data before and after removing dynamic heterogeneity (red) by decomposing the original traces into the pieces according to estimated internal state trace.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005286.s026" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005286.s026" xlink:type="simple">
<label>S25 Fig</label>
<caption>
<title>Comparison between VB-DCMM and sticky-iAMM.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank the KIAS Center for Advanced Computation for providing computing resources.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005286.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liphardt</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Onoa</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Tinoco</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Bustamante</surname> <given-names>C</given-names></name>. <article-title>Reversible Unfolding of Single RNA Molecules by Mechanical Force</article-title>. <source>Science</source>. <year>2001</year>;<volume>292</volume>(<issue>5517</issue>):<fpage>733</fpage>–<lpage>737</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1058498" xlink:type="simple">10.1126/science.1058498</ext-link></comment> <object-id pub-id-type="pmid">11326101</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Karnchanaphanurach</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Louie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Rech</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Cova</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Protein conformational dynamics probed by single-molecule electron transfer</article-title>. <source>Science</source>. <year>2003</year>;<volume>302</volume>:<fpage>262</fpage>–<lpage>266</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1086911" xlink:type="simple">10.1126/science.1086911</ext-link></comment> <object-id pub-id-type="pmid">14551431</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Greenleaf</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Frieda</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Foster</surname> <given-names>DAN</given-names></name>, <name name-style="western"><surname>Woodside</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Block</surname> <given-names>SM</given-names></name>. <article-title>Direct Observation of Hierarchical Folding in Single Riboswitch Aptamers</article-title>. <source>Science</source>. <year>2008</year>;<volume>319</volume>(<issue>5863</issue>):<fpage>630</fpage>–<lpage>633</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1151298" xlink:type="simple">10.1126/science.1151298</ext-link></comment> <object-id pub-id-type="pmid">18174398</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhuang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Pereira</surname> <given-names>MJB</given-names></name>, <name name-style="western"><surname>Babcock</surname> <given-names>HP</given-names></name>, <name name-style="western"><surname>Walter</surname> <given-names>NG</given-names></name>, <name name-style="western"><surname>Chu</surname> <given-names>S</given-names></name>. <article-title>Correlating Structural Dynamics and Function in Single Ribozyme Molecules</article-title>. <source>Science</source>. <year>2002</year>;<volume>296</volume>(<issue>5572</issue>):<fpage>1473</fpage>–<lpage>1476</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1069013" xlink:type="simple">10.1126/science.1069013</ext-link></comment> <object-id pub-id-type="pmid">12029135</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rhoades</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gussakovsky</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Haran</surname> <given-names>G</given-names></name>. <article-title>Watching proteins fold one molecule at a time</article-title>. <source>Proc Natl Acad Sci</source>. <year>2003</year>;<volume>100</volume>(<issue>6</issue>):<fpage>3197</fpage>–<lpage>3202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.2628068100" xlink:type="simple">10.1073/pnas.2628068100</ext-link></comment> <object-id pub-id-type="pmid">12612345</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhuang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Rief</surname> <given-names>M</given-names></name>. <article-title>Single-molecule folding</article-title>. <source>Curr Opin Struct Biol</source>. <year>2003</year>;<volume>13</volume>(<issue>1</issue>):<fpage>88</fpage>–<lpage>97</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0959-440X(03)00011-3" xlink:type="simple">10.1016/S0959-440X(03)00011-3</ext-link></comment> <object-id pub-id-type="pmid">12581665</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stigler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ziegler</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gieseke</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gebhardt</surname> <given-names>JCM</given-names></name>, <name name-style="western"><surname>Rief</surname> <given-names>M</given-names></name>. <article-title>The Complex Folding Network of Single Calmodulin Molecules</article-title>. <source>Science</source>. <year>2011</year>;<volume>334</volume>(<issue>6055</issue>):<fpage>512</fpage>–<lpage>516</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1207598" xlink:type="simple">10.1126/science.1207598</ext-link></comment> <object-id pub-id-type="pmid">22034433</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thirumalai</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hyeon</surname> <given-names>C</given-names></name>. <article-title>RNA and Protein Folding: Common Themes and Variations†</article-title>. <source>Biochemistry</source>. <year>2005</year>;<volume>44</volume>(<issue>13</issue>):<fpage>4957</fpage>–<lpage>4970</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/bi047314+" xlink:type="simple">10.1021/bi047314+</ext-link></comment> <object-id pub-id-type="pmid">15794634</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mickler</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dima</surname> <given-names>RI</given-names></name>, <name name-style="western"><surname>Dietz</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hyeon</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Thirumalai</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rief</surname> <given-names>M</given-names></name>. <article-title>Revealing the bifurcation in the unfolding pathways of GFP by using single-molecule experiments and simulations</article-title>. <source>Proc Natl Acad Sci</source>. <year>2007</year>;<volume>104</volume>(<issue>51</issue>):<fpage>20268</fpage>–<lpage>20273</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0705458104" xlink:type="simple">10.1073/pnas.0705458104</ext-link></comment> <object-id pub-id-type="pmid">18079292</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rognoni</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Möst</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Žoldák</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Rief</surname> <given-names>M</given-names></name>. <article-title>Force-dependent isomerization kinetics of a highly conserved proline switch modulates the mechanosensing region of filamin</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2014</year>;<volume>111</volume>(<issue>15</issue>):<fpage>5568</fpage>–<lpage>5573</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1319448111" xlink:type="simple">10.1073/pnas.1319448111</ext-link></comment> <object-id pub-id-type="pmid">24706888</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>KT</given-names></name>, <name name-style="western"><surname>Sosnick</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Pan</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Scherer</surname> <given-names>NF</given-names></name>. <article-title>Single-molecule nonequilibrium periodic Mg<sup>2+</sup>-concentration jump experiments reveal details of the early folding pathways of a large RNA</article-title>. <source>Proc Natl Acad Sci</source>. <year>2008</year>;<volume>105</volume>(<issue>18</issue>):<fpage>6602</fpage>–<lpage>6607</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0801436105" xlink:type="simple">10.1073/pnas.0801436105</ext-link></comment> <object-id pub-id-type="pmid">18448679</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Solomatin</surname> <given-names>SV</given-names></name>, <name name-style="western"><surname>Greenfeld</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Herschlag</surname> <given-names>D</given-names></name>. <article-title>Multiple native states reveal persistent ruggedness of an RNA folding landscape</article-title>. <source>Nature</source>. <year>2010</year>;<volume>463</volume>(<issue>7281</issue>):<fpage>681</fpage>–<lpage>684</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08717" xlink:type="simple">10.1038/nature08717</ext-link></comment> <object-id pub-id-type="pmid">20130651</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hyeon</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yoon</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hohng</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Thirumalai</surname> <given-names>D</given-names></name>. <article-title>Hidden complexity in the isomerization dynamics of Holliday junctions</article-title>. <source>Nat Chem</source>. <year>2012</year>;<volume>4</volume>(<issue>11</issue>):<fpage>907</fpage>–<lpage>914</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nchem.1463" xlink:type="simple">10.1038/nchem.1463</ext-link></comment> <object-id pub-id-type="pmid">23089865</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Haller</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Altman</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Soulière</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Blanchard</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Micura</surname> <given-names>R</given-names></name>. <article-title>Folding and ligand recognition of the TPP riboswitch aptamer at single-molecule resolution</article-title>. <source>Proc Nat Acad Sci</source>. <year>2013</year>;<volume>110</volume>(<issue>11</issue>):<fpage>4188</fpage>–<lpage>4193</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1218062110" xlink:type="simple">10.1073/pnas.1218062110</ext-link></comment> <object-id pub-id-type="pmid">23440214</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rinaldi</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Lund</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Blanco</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Walter</surname> <given-names>NG</given-names></name>. <article-title>The Shine-Dalgarno sequence of riboswitch-regulated single mRNAs shows ligand-dependent accessibility bursts</article-title>. <source>Nat Commun</source>. <year>2016</year>;<volume>7</volume>:<fpage>1</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms9976" xlink:type="simple">10.1038/ncomms9976</ext-link></comment> <object-id pub-id-type="pmid">26781350</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Baskin</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Kowalczykowski</surname> <given-names>SC</given-names></name>. <article-title>DNA unwinding heterogeneity by RecBCD results from static molecules able to equilibrate</article-title>. <source>Nature</source>. <year>2013</year>;<volume>500</volume>(<issue>7463</issue>):<fpage>482</fpage>–<lpage>485</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12333" xlink:type="simple">10.1038/nature12333</ext-link></comment> <object-id pub-id-type="pmid">23851395</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lu</surname> <given-names>HP</given-names></name>, <name name-style="western"><surname>Xun</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>XS</given-names></name>. <article-title>Single-Molecule Enzymatic Dynamics</article-title>. <source>Science</source>. <year>1998</year>;<volume>282</volume>(<issue>5395</issue>):<fpage>1877</fpage>–<lpage>1882</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.282.5395.1877" xlink:type="simple">10.1126/science.282.5395.1877</ext-link></comment> <object-id pub-id-type="pmid">9836635</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>English</surname> <given-names>BP</given-names></name>, <name name-style="western"><surname>Min</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>van Oijen</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>KT</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Ever-fluctuating single enzyme molecules: Michaelis-Menten equation revisited</article-title>. <source>Nat Chem Biol</source>. <year>2005</year>;<volume>2</volume>(<issue>2</issue>):<fpage>87</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nchembio759" xlink:type="simple">10.1038/nchembio759</ext-link></comment> <object-id pub-id-type="pmid">16415859</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhuang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Pereira</surname> <given-names>MJB</given-names></name>, <name name-style="western"><surname>Babcock</surname> <given-names>HP</given-names></name>, <name name-style="western"><surname>Walter</surname> <given-names>NG</given-names></name>, <name name-style="western"><surname>Chu</surname> <given-names>S</given-names></name>. <article-title>Correlating Structural Dynamics and Function in Single Ribozyme Molecules</article-title>. <source>Science</source>. <year>2002</year>;<volume>296</volume>(<issue>5572</issue>):<fpage>1473</fpage>–<lpage>1476</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1069013" xlink:type="simple">10.1126/science.1069013</ext-link></comment> <object-id pub-id-type="pmid">12029135</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Oijen</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Blainey</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Crampton</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Ellenberger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>XS</given-names></name>. <article-title>Single-Molecule Kinetics of <italic>λ</italic> Exonuclease Reveal Base Dependence and Dynamic Disorder</article-title>. <source>Science</source>. <year>2003</year>;<volume>301</volume>(<issue>5637</issue>):<fpage>1235</fpage>–<lpage>1238</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1084387" xlink:type="simple">10.1126/science.1084387</ext-link></comment> <object-id pub-id-type="pmid">12947199</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Velonia</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Flomenbom</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Loos</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Masuo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cotlet</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Engelborghs</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Single-Enzyme Kinetics of CALB-Catalyzed Hydrolysis</article-title>. <source>Angew Chem Int Ed</source>. <year>2005</year>;<volume>44</volume>(<issue>4</issue>):<fpage>560</fpage>–<lpage>564</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/anie.200460625" xlink:type="simple">10.1002/anie.200460625</ext-link></comment> <object-id pub-id-type="pmid">15619259</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Flomenbom</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Velonia</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Loos</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Masuo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cotlet</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Engelborghs</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Stretched exponential decay and correlations in the catalytic activity of fluctuating single lipase molecules</article-title>. <source>Proc Natl Acad of Sci</source>. <year>2005</year>;<volume>102</volume>(<issue>7</issue>):<fpage>2368</fpage>–<lpage>2372</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0409039102" xlink:type="simple">10.1073/pnas.0409039102</ext-link></comment> <object-id pub-id-type="pmid">15695587</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Karnchanaphanurach</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Louie</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Rech</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Cova</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Protein Conformational Dynamics Probed by Single-Molecule Electron Transfer</article-title>. <source>Science</source>. <year>2003</year>;<volume>302</volume>(<issue>5643</issue>):<fpage>262</fpage>–<lpage>266</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1086911" xlink:type="simple">10.1126/science.1086911</ext-link></comment> <object-id pub-id-type="pmid">14551431</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Min</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Cherayil</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Kou</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>XS</given-names></name>. <article-title>Observation of a Power-Law Memory Kernel for Fluctuations within a Single Protein Molecule</article-title>. <source>Phys Rev Lett</source>. <year>2005</year>;<volume>94</volume>:<fpage>198302</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.94.198302" xlink:type="simple">10.1103/PhysRevLett.94.198302</ext-link></comment> <object-id pub-id-type="pmid">16090221</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cremer</surname> <given-names>GD</given-names></name>, <name name-style="western"><surname>Roeffaers</surname> <given-names>MBJ</given-names></name>, <name name-style="western"><surname>Baruah</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sliwa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sels</surname> <given-names>BF</given-names></name>, <name name-style="western"><surname>Hofkens</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Dynamic Disorder and Stepwise Deactivation in a Chymotrypsin Catalyzed Hydrolysis Reaction</article-title>. <source>J Am Chem Soc</source>. <year>2007</year>;<volume>129</volume>(<issue>50</issue>):<fpage>15458</fpage>–<lpage>15459</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ja077621d" xlink:type="simple">10.1021/ja077621d</ext-link></comment> <object-id pub-id-type="pmid">18031046</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rissin</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Gorris</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Walt</surname> <given-names>DR</given-names></name>. <article-title>Distinct and Long-Lived Activity States of Single Enzyme Molecules</article-title>. <source>J Am Chem Soc</source>. <year>2008</year>;<volume>130</volume>(<issue>15</issue>):<fpage>5349</fpage>–<lpage>5353</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ja711414f" xlink:type="simple">10.1021/ja711414f</ext-link></comment> <object-id pub-id-type="pmid">18318491</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Piwonski</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Goomanovsky</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bensimon</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Horovitz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Haran</surname> <given-names>G</given-names></name>. <article-title>Allosteric inhibition of individual enzyme molecules trapped in lipid vesicles</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2012</year>;<volume>109</volume>(<issue>22</issue>):<fpage>E1437</fpage>–<lpage>E1443</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1116670109" xlink:type="simple">10.1073/pnas.1116670109</ext-link></comment> <object-id pub-id-type="pmid">22562794</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>J</given-names></name>. <article-title>Functional Roles of Slow Enzyme Conformational Changes in Network Dynamics</article-title>. <source>Biophys J</source>. <year>2012</year>;<volume>103</volume>(<issue>5</issue>):<fpage>1052</fpage>–<lpage>1059</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2012.08.008" xlink:type="simple">10.1016/j.bpj.2012.08.008</ext-link></comment> <object-id pub-id-type="pmid">23009855</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Palmer</surname> <given-names>RG</given-names></name>. <article-title>Broken ergodicity</article-title>. <source>Adv Phys</source>. <year>1982</year>;<volume>31</volume>(<issue>6</issue>):<fpage>669</fpage>–<lpage>735</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/00018738200101438" xlink:type="simple">10.1080/00018738200101438</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hübner</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Renn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Renge</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Wild</surname> <given-names>UP</given-names></name>. <article-title>Direct observation of the triplet lifetime quenching of single dye molecules by molecular oxygen</article-title>. <source>J Chem Phys</source>. <year>2001</year>;<volume>115</volume>(<issue>21</issue>):<fpage>9619</fpage>–<lpage>9622</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.1421382" xlink:type="simple">10.1063/1.1421382</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Elenko</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Szostak</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>van Oijen</surname> <given-names>AM</given-names></name>. <article-title>Single-molecule binding experiments on long time scales</article-title>. <source>Rev Sci Instrum</source>. <year>2010</year>;<volume>81</volume>(<issue>8</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.3473936" xlink:type="simple">10.1063/1.3473936</ext-link></comment> <object-id pub-id-type="pmid">20815611</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hwang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Bae</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hohng</surname> <given-names>S</given-names></name>. <article-title>Autofocusing system based on optical astigmatism analysis of single-molecule images</article-title>. <source>Opt Express</source>. <year>2012</year>;<volume>20</volume>(<issue>28</issue>):<fpage>29353</fpage>–<lpage>29360</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1364/OE.20.029353" xlink:type="simple">10.1364/OE.20.029353</ext-link></comment> <object-id pub-id-type="pmid">23388762</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hyeon</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hinczewski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Thirumalai</surname> <given-names>D</given-names></name>. <article-title>Evidence of Disorder in Biological Molecules from Single Molecule Pulling Experiments</article-title>. <source>Phys Rev Lett</source>. <year>2014</year>;<volume>112</volume>:<fpage>138101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.112.138101" xlink:type="simple">10.1103/PhysRevLett.112.138101</ext-link></comment> <object-id pub-id-type="pmid">24745458</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hinczewski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hyeon</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Thirumalai</surname> <given-names>D</given-names></name>. <article-title>Directly measuring single molecule heterogeneity using force spectroscopy</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2016</year>;<volume>113</volume>:<fpage>E3852</fpage>–<lpage>E3861</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1518389113" xlink:type="simple">10.1073/pnas.1518389113</ext-link></comment> <object-id pub-id-type="pmid">27317744</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zwanzig</surname> <given-names>R</given-names></name>. <article-title>Dynamical disorder: Passage through a fluctuating bottleneck</article-title>. <source>The J Chem Phys</source>. <year>1992</year>;<volume>97</volume>(<issue>5</issue>):<fpage>3587</fpage>–<lpage>3589</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.462993" xlink:type="simple">10.1063/1.462993</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zwanzig</surname> <given-names>R</given-names></name>. <article-title>Rate processes with dynamical disorder</article-title>. <source>Acc Chem Res</source>. <year>1990</year>;<volume>23</volume>(<issue>5</issue>):<fpage>148</fpage>–<lpage>152</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ar00173a005" xlink:type="simple">10.1021/ar00173a005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>GF</given-names></name>, <name name-style="western"><surname>Kaczmarek</surname> <given-names>LK</given-names></name>. <article-title>Mode-switching of a voltage-gated cation channel is mediated by a protein kinase A-regulated tyrosine phosphatase</article-title>. <source>Nature</source>. <year>1993</year>;<volume>366</volume>(<issue>6454</issue>):<fpage>433</fpage>–<lpage>438</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/366433a0" xlink:type="simple">10.1038/366433a0</ext-link></comment> <object-id pub-id-type="pmid">8247151</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Siekmann</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Sneyd</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Crampin</surname> <given-names>EJ</given-names></name>. <article-title>Statistical analysis of modal gating in ion channels</article-title>. <source>Proc R Soc A</source>. <year>2014</year>;<volume>470</volume>(<issue>2166</issue>):<fpage>20140030</fpage>–<lpage>20140030</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspa.2014.0030" xlink:type="simple">10.1098/rspa.2014.0030</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref039">
<label>39</label>
<mixed-citation publication-type="other" xlink:type="simple">Berchtold A. The Double Chain Markov Model. Technical Report, Washington Univ. 1999;(348).</mixed-citation>
</ref>
<ref id="pcbi.1005286.ref040">
<label>40</label>
<mixed-citation publication-type="other" xlink:type="simple">Poritz A. Linear predictive hidden Markov models and the speech signal. In: Acoustics, Speech, and Signal Processing, IEEE International Conference on ICASSP’82. vol. 7; 1982. p. 1291–1294.</mixed-citation>
</ref>
<ref id="pcbi.1005286.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kenny</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lennig</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mermelstein</surname> <given-names>P</given-names></name>. <article-title>A linear predictive HMM for vector-valued observations with applications to speech recognition</article-title>. <source>IEEE Transactions on Acoustics, Speech, and Signal Processing</source>. <year>1990</year>;<volume>38</volume>(<issue>2</issue>):<fpage>220</fpage>–<lpage>225</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/29.103057" xlink:type="simple">10.1109/29.103057</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref042">
<label>42</label>
<mixed-citation publication-type="other" xlink:type="simple">Wellekens C. Explicit time correlation in hidden Markov models for speech recognition. In: Acoustics, Speech, and Signal Processing, IEEE International Conference on ICASSP’87. vol. 12; 1987. p. 384–386.</mixed-citation>
</ref>
<ref id="pcbi.1005286.ref043">
<label>43</label>
<mixed-citation publication-type="other" xlink:type="simple">Paliwal KK. Use of temporal correlation between successive frames in a hidden Markov model based speech recognizer. In: Acoustics, Speech, and Signal Processing, 1993. ICASSP-93., 1993 IEEE International Conference on. vol. 2; 1993. p. 215–218 vol.2.</mixed-citation>
</ref>
<ref id="pcbi.1005286.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>IB</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>NK</given-names></name>, <name name-style="western"><surname>Hong</surname> <given-names>SC</given-names></name>. <article-title>Direct observation of the formation of DNA triplexes by single-molecule FRET measurements</article-title>. <source>Curr Appl Phys</source>. <year>2012</year>;<volume>12</volume>(<issue>4</issue>):<fpage>1027</fpage>–<lpage>1032</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cap.2011.12.026" xlink:type="simple">10.1016/j.cap.2011.12.026</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>IB</given-names></name>, <name name-style="western"><surname>Hong</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>NK</given-names></name>, <name name-style="western"><surname>Johner</surname> <given-names>A</given-names></name>. <article-title>Kinetics of the Triplex-Duplex Transition in DNA</article-title>. <source>Biophys J</source>. <year>2012</year>;<volume>103</volume>(<issue>12</issue>):<fpage>2492</fpage>–<lpage>2501</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2012.10.029" xlink:type="simple">10.1016/j.bpj.2012.10.029</ext-link></comment> <object-id pub-id-type="pmid">23260051</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ghahramani</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>. <article-title>Factorial Hidden Markov Models</article-title>. <source>Mach Learn</source>. <year>1997</year>;<volume>29</volume>(<issue>2</issue>):<fpage>245</fpage>–<lpage>273</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1007425814087" xlink:type="simple">10.1023/A:1007425814087</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Ghahramani</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Saul</surname> <given-names>LK</given-names></name>. <article-title>Hidden Markov decision trees</article-title>. <source>Adv Neural Inf Process Syst</source>. <year>1997</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1005286.ref048">
<label>48</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Bishop</surname> <given-names>CM</given-names></name>. <source>Pattern Recognition and Machine Learning</source>. <publisher-loc>Springer</publisher-loc>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005286.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bronson</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Fei</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hofman</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Jr</surname> <given-names>RLG</given-names></name>, <name name-style="western"><surname>Wiggins</surname> <given-names>CH</given-names></name>. <article-title>Learning Rates and States from Biophysical Time Series: A Bayesian Approach to Model Selection and Single-Molecule FRET Data</article-title>. <source>Biophys J</source>. <year>2009</year>;<volume>97</volume>(<issue>12</issue>):<fpage>3196</fpage>–<lpage>3205</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2009.09.031" xlink:type="simple">10.1016/j.bpj.2009.09.031</ext-link></comment> <object-id pub-id-type="pmid">20006957</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bronson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hofman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fei</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gonzalez</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wiggins</surname> <given-names>C</given-names></name>. <article-title>Graphical models for inferring single molecule dynamics</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>(<issue>Suppl 8</issue>):<fpage>S2</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-11-S8-S2" xlink:type="simple">10.1186/1471-2105-11-S8-S2</ext-link></comment> <object-id pub-id-type="pmid">21034427</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Okamoto</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sako</surname> <given-names>Y</given-names></name>. <article-title>Variational Bayes Analysis of a Photon-Based Hidden Markov Model for Single-Molecule FRET Trajectories</article-title>. <source>Biophys J</source>. <year>2012</year>;<volume>103</volume>(<issue>6</issue>):<fpage>1315</fpage>–<lpage>1324</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2012.07.047" xlink:type="simple">10.1016/j.bpj.2012.07.047</ext-link></comment> <object-id pub-id-type="pmid">22995504</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Persson</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Linden</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Unoson</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Elf</surname> <given-names>J</given-names></name>. <article-title>Extracting intracellular diffusive states and transition rates from single-molecule tracking data</article-title>. <source>Nat Meth</source>. <year>2013</year>;<volume>10</volume>(<issue>3</issue>):<fpage>265</fpage>–<lpage>269</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2367" xlink:type="simple">10.1038/nmeth.2367</ext-link></comment> <object-id pub-id-type="pmid">23396281</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Johnson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>van de Meent</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Phillips</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wiggins</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Lindén</surname> <given-names>M</given-names></name>. <article-title>Multiple LacI-mediated loops revealed by Bayesian statistics and tethered particle motion</article-title>. <source>Nucleic Acids Res</source>. <year>2014</year>;<volume>42</volume>(<issue>16</issue>):<fpage>10265</fpage>–<lpage>10277</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gku563" xlink:type="simple">10.1093/nar/gku563</ext-link></comment> <object-id pub-id-type="pmid">25120267</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van de Meent</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Bronson</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Wood</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gonzalez</surname> <given-names>RL</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>Wiggins</surname> <given-names>CH</given-names></name>. <article-title>Hierarchically-coupled hidden Markov models for learning kinetic rates from single-molecule data</article-title>. <source>Proc Int Conf Machine Learn</source>. <year>2013</year>;<volume>28</volume>:<fpage>361</fpage>–<lpage>369</lpage>. <object-id pub-id-type="pmid">26985282</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van de Meent</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Bronson</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Wiggins</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Jr</surname> <given-names>RLG</given-names></name>. <article-title>Empirical Bayes Methods Enable Advanced Population-Level Analyses of Single-Molecule FRET Experiments</article-title>. <source>Biophys J</source>. <year>2014</year>;<volume>106</volume>(<issue>6</issue>):<fpage>1327</fpage>–<lpage>1337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2013.12.055" xlink:type="simple">10.1016/j.bpj.2013.12.055</ext-link></comment> <object-id pub-id-type="pmid">24655508</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McKinney</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Joo</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ha</surname> <given-names>T</given-names></name>. <article-title>Analysis of single-molecule FRET trajectories using hidden Markov modeling</article-title>. <source>Biophy J</source>. <year>2006</year>;<volume>91</volume>(<issue>5</issue>):<fpage>1941</fpage>–<lpage>1951</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1529/biophysj.106.082487" xlink:type="simple">10.1529/biophysj.106.082487</ext-link></comment> <object-id pub-id-type="pmid">16766620</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref057">
<label>57</label>
<mixed-citation publication-type="other" xlink:type="simple">A Stein W, et al. Sage Mathematics Software (Version 6.3.); 2014.</mixed-citation>
</ref>
<ref id="pcbi.1005286.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frey</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Dueck</surname> <given-names>D</given-names></name>. <article-title>Clustering by Passing Messages Between Data Points</article-title>. <source>Science</source>. <year>2007</year>;<volume>315</volume>(<issue>5814</issue>):<fpage>972</fpage>–<lpage>976</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1136800" xlink:type="simple">10.1126/science.1136800</ext-link></comment> <object-id pub-id-type="pmid">17218491</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>English</surname> <given-names>BP</given-names></name>, <name name-style="western"><surname>Min</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Van Oijen</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>KT</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Ever-fluctuating single enzyme molecules: Michaelis-Menten equation revisited</article-title>. <source>Nature Chem Biol</source>. <year>2006</year>;<volume>2</volume>(<issue>2</issue>):<fpage>87</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nchembio759" xlink:type="simple">10.1038/nchembio759</ext-link></comment> <object-id pub-id-type="pmid">16415859</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref060">
<label>60</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Beard</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Qian</surname> <given-names>H</given-names></name>. <source>Chemical Biophysics: Quantitative Analysis of Cellular Systems</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2008</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005286.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hyeon</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Klumpp</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Onuchic</surname> <given-names>JN</given-names></name>. <article-title>Kinesin’s backsteps under mechanical load</article-title>. <source>Phys Chem Chem Phys</source>. <year>2009</year>;<volume>11</volume>:<fpage>4899</fpage>–<lpage>4910</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1039/b903536b" xlink:type="simple">10.1039/b903536b</ext-link></comment> <object-id pub-id-type="pmid">19506765</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Donald R Fredkin</surname> <given-names>JAR</given-names></name>. <article-title>On Aggregated Markov Processes</article-title>. <source>J Appl Probab</source>. <year>1986</year>;<volume>23</volume>(<issue>1</issue>):<fpage>208</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/3214130" xlink:type="simple">10.2307/3214130</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kienker</surname> <given-names>P</given-names></name>. <article-title>Equivalence of Aggregated Markov Models of Ion-Channel Gating</article-title>. <source>Proc R Soc Lond B</source>. <year>1989</year>;<volume>236</volume>(<issue>1284</issue>):<fpage>269</fpage>–<lpage>309</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.1989.0024" xlink:type="simple">10.1098/rspb.1989.0024</ext-link></comment> <object-id pub-id-type="pmid">2471201</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Colquhoun</surname> <given-names>D</given-names></name> <name name-style="western"><surname>H</surname> <given-names>AG</given-names></name>. <article-title>On the Stochastic Properties of Single Ion Channels</article-title>. <source>Proc R Soc Lond B</source>. <year>1981</year>;<volume>211</volume>(<issue>1183</issue>):<fpage>205</fpage>–<lpage>235</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.1981.0003" xlink:type="simple">10.1098/rspb.1981.0003</ext-link></comment> <object-id pub-id-type="pmid">6111797</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Horn</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lange</surname> <given-names>K</given-names></name>. <article-title>Estimating kinetic constants from single channel data</article-title>. <source>Biophys J</source>. <year>1983</year>;<volume>43</volume>(<issue>2</issue>):<fpage>207</fpage>–<lpage>223</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(83)84341-0" xlink:type="simple">10.1016/S0006-3495(83)84341-0</ext-link></comment> <object-id pub-id-type="pmid">6311301</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qin</surname> <given-names>F</given-names></name>. <article-title>Restoration of Single-Channel Currents Using the Segmental k-Means Method Based on Hidden Markov Modeling</article-title>. <source>Biophys J</source>. <year>2004</year>;<volume>86</volume>(<issue>3</issue>):<fpage>1488</fpage>–<lpage>1501</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(04)74217-4" xlink:type="simple">10.1016/S0006-3495(04)74217-4</ext-link></comment> <object-id pub-id-type="pmid">14990476</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qin</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Auerbach</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sachs</surname> <given-names>F</given-names></name>. <article-title>Maximum likelihood estimation of aggregated Markov processes</article-title>. <source>Proc R Soc Lond B</source>. <year>1997</year>;<volume>264</volume>(<issue>1380</issue>):<fpage>375</fpage>–<lpage>383</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.1997.0054" xlink:type="simple">10.1098/rspb.1997.0054</ext-link></comment> <object-id pub-id-type="pmid">9107053</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wagner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Michalek</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Timmer</surname> <given-names>J</given-names></name>. <article-title>Estimating transition rates in aggregated Markov models of ion channel gating with loops and with nearly equal dwell times</article-title>. <source>Proc R Soc Lond B</source>. <year>1999</year>;<volume>266</volume>(<issue>1431</issue>):<fpage>1919</fpage>–<lpage>1926</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.1999.0867" xlink:type="simple">10.1098/rspb.1999.0867</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ball</surname> <given-names>FG</given-names></name>, <name name-style="western"><surname>Cai</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kadane</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>O’Hagan</surname> <given-names>A</given-names></name>. <article-title>Bayesian inference for ion–channel gating mechanisms directly from single–channel recordings, using Markov chain Monte Carlo</article-title>. <source>Proc R Soc Lond A</source>. <year>1999</year>;<volume>455</volume>(<issue>1988</issue>):<fpage>2879</fpage>–<lpage>2932</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspa.1999.0432" xlink:type="simple">10.1098/rspa.1999.0432</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref070">
<label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosales</surname> <given-names>RA</given-names></name>. <article-title>MCMC for hidden Markov models incorporating aggregation of states and filtering</article-title>. <source>Bull Math Biol</source>. <year>2004</year>;<volume>66</volume>(<issue>5</issue>):<fpage>1173</fpage>–<lpage>1199</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bulm.2003.12.001" xlink:type="simple">10.1016/j.bulm.2003.12.001</ext-link></comment> <object-id pub-id-type="pmid">15294422</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosales</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Stark</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Fitzgerald</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Hladky</surname> <given-names>SB</given-names></name>. <article-title>Bayesian Restoration of Ion Channel Records using Hidden Markov Models</article-title>. <source>Biophys J</source>. <year>2001</year>;<volume>80</volume>(<issue>3</issue>):<fpage>1088</fpage>–<lpage>1103</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(01)76087-0" xlink:type="simple">10.1016/S0006-3495(01)76087-0</ext-link></comment> <object-id pub-id-type="pmid">11222275</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wagner</surname> <given-names>LE</given-names></name>, <name name-style="western"><surname>Yule</surname> <given-names>DI</given-names></name>, <name name-style="western"><surname>Sneyd</surname> <given-names>J</given-names></name>. <article-title>Markov chain Monte Carlo fitting of single-channel data from inositol trisphosphate receptors</article-title>. <source>J Theor Biol</source>. <year>2009</year>;<volume>257</volume>(<issue>3</issue>):<fpage>460</fpage>–<lpage>474</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2008.12.020" xlink:type="simple">10.1016/j.jtbi.2008.12.020</ext-link></comment> <object-id pub-id-type="pmid">19168073</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref073">
<label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Siekmann</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>L</surname> <given-names>W</given-names> <suffix>II</suffix></name>, <name name-style="western"><surname>Yule</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Fox</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bryant</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Crampin</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>MCMC Estimation of Markov Models for Ion Channels</article-title>. <source>Biophys J</source>. <year>2011</year>;<volume>100</volume>(<issue>8</issue>):<fpage>1919</fpage>–<lpage>1929</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2011.02.059" xlink:type="simple">10.1016/j.bpj.2011.02.059</ext-link></comment> <object-id pub-id-type="pmid">21504728</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Siekmann</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Sneyd</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Crampin</surname> <given-names>E</given-names></name>. <article-title>MCMC Can Detect Nonidentifiable Models</article-title>. <source>Biophys J</source>. <year>2012</year>;<volume>103</volume>(<issue>11</issue>):<fpage>2275</fpage>–<lpage>2286</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2012.10.024" xlink:type="simple">10.1016/j.bpj.2012.10.024</ext-link></comment> <object-id pub-id-type="pmid">23283226</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref075">
<label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hodgson</surname> <given-names>MEA</given-names></name>, <name name-style="western"><surname>Green</surname> <given-names>PJ</given-names></name>. <article-title>Bayesian choice among Markov models of ion channels using Markov chain Monte Carlo</article-title>. <source>Proc R Soc Lond A</source>. <year>1999</year>;<volume>455</volume>(<issue>1989</issue>):<fpage>3425</fpage>–<lpage>3448</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspa.1999.0459" xlink:type="simple">10.1098/rspa.1999.0459</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref076">
<label>76</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hines</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Bankston</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Aldrich</surname> <given-names>R</given-names></name>. <article-title>Analyzing Single-Molecule Time Series via Nonparametric Bayesian Inference</article-title>. <source>Biophys J</source>. <year>2015</year>;<volume>108</volume>(<issue>3</issue>):<fpage>540</fpage>–<lpage>556</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2014.12.016" xlink:type="simple">10.1016/j.bpj.2014.12.016</ext-link></comment> <object-id pub-id-type="pmid">25650922</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref077">
<label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fitzpatrick</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Marchev</surname> <given-names>D</given-names></name>. <article-title>Efficient Bayesian estimation of the multivariate Double Chain Markov Model</article-title>. <source>Stat and Comput</source>. <year>2013</year>;<volume>23</volume>(<issue>4</issue>):<fpage>467</fpage>–<lpage>480</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11222-012-9323-y" xlink:type="simple">10.1007/s11222-012-9323-y</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref078">
<label>78</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schröder</surname> <given-names>GF</given-names></name>, <name name-style="western"><surname>Grubmüller</surname> <given-names>H</given-names></name>. <article-title>Maximum likelihood trajectories from single molecule fluorescence resonance energy transfer experiments</article-title>. <source>J Chem Phys</source>. <year>2003</year>;<volume>119</volume>(<issue>18</issue>):<fpage>9920</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.1616511" xlink:type="simple">10.1063/1.1616511</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref079">
<label>79</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Antonik</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Felekyan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gaiduk</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Seidel</surname> <given-names>CAM</given-names></name>. <article-title>Separating Structural Heterogeneities from Stochastic Variations in Fluorescence Resonance Energy Transfer Distributions via Photon Distribution Analysis</article-title>. <source>J Phys Chem B</source>. <year>2006</year>;<volume>110</volume>(<issue>13</issue>):<fpage>6970</fpage>–<lpage>6978</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/jp057257+" xlink:type="simple">10.1021/jp057257+</ext-link></comment> <object-id pub-id-type="pmid">16571010</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref080">
<label>80</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gopich</surname> <given-names>IV</given-names></name>, <name name-style="western"><surname>Szabo</surname> <given-names>A</given-names></name>. <article-title>Decoding the Pattern of Photon Colors in Single-Molecule FRET</article-title>. <source>J Phys Chem B</source>. <year>2009</year>;<volume>113</volume>(<issue>31</issue>):<fpage>10965</fpage>–<lpage>10973</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/jp903671p" xlink:type="simple">10.1021/jp903671p</ext-link></comment> <object-id pub-id-type="pmid">19588948</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref081">
<label>81</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Al-Hashimi</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Walter</surname> <given-names>NG</given-names></name>. <article-title>RNA dynamics: it is about time</article-title>. <source>Curr Opin Struct Biol</source>. <year>2008</year>;<volume>18</volume>(<issue>3</issue>):<fpage>321</fpage>–<lpage>329</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.sbi.2008.04.004" xlink:type="simple">10.1016/j.sbi.2008.04.004</ext-link></comment> <object-id pub-id-type="pmid">18547802</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref082">
<label>82</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thirumalai</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hyeon</surname> <given-names>C</given-names></name>. <article-title>RNA and Protein folding: Common Themes and Variations</article-title>. <source>Biochemistry</source>. <year>2005</year>;<volume>44</volume>(<issue>13</issue>):<fpage>4957</fpage>–<lpage>4970</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/bi047314+" xlink:type="simple">10.1021/bi047314+</ext-link></comment> <object-id pub-id-type="pmid">15794634</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref083">
<label>83</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thirumalai</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>O’Brien</surname> <given-names>EP</given-names></name>, <name name-style="western"><surname>Morrison</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hyeon</surname> <given-names>C</given-names></name>. <article-title>Theoretical Perspectives on Protein Folding</article-title>. <source>Annu Rev Biophys</source>. <year>2010</year>;<volume>39</volume>:<fpage>159</fpage>–<lpage>183</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev-biophys-051309-103835" xlink:type="simple">10.1146/annurev-biophys-051309-103835</ext-link></comment> <object-id pub-id-type="pmid">20192765</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref084">
<label>84</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bhaskaran</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Russell</surname> <given-names>R</given-names></name>. <article-title>Kinetic redistribution of native and misfolded RNAs by DEAD-box chaperone</article-title>. <source>Nature</source>. <year>2007</year>;<volume>449</volume>:<fpage>1014</fpage>–<lpage>1018</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature06235" xlink:type="simple">10.1038/nature06235</ext-link></comment> <object-id pub-id-type="pmid">17960235</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref085">
<label>85</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Woodson</surname> <given-names>SA</given-names></name>. <article-title>Taming free energy landscapes with RNA chaperones</article-title>. <source>RNA biology</source>. <year>2010</year>;<volume>7</volume>(<issue>6</issue>):<fpage>677</fpage>–<lpage>686</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4161/rna.7.6.13615" xlink:type="simple">10.4161/rna.7.6.13615</ext-link></comment> <object-id pub-id-type="pmid">21045544</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref086">
<label>86</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thirumalai</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lorimer</surname> <given-names>GH</given-names></name>. <article-title>Chaperonin-mediated protein folding</article-title>. <source>Ann Rev Biophys Biomol Struct</source>. <year>2001</year>;<volume>30</volume>:<fpage>245</fpage>–<lpage>269</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.biophys.30.1.245" xlink:type="simple">10.1146/annurev.biophys.30.1.245</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref087">
<label>87</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hyeon</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Thirumalai</surname> <given-names>D</given-names></name>. <article-title>Generalized iterative annealing model for the action of RNA chaperones</article-title>. <source>J Chem Phys</source>. <year>2013</year>;<volume>139</volume>(<issue>12</issue>):<fpage>121924</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.4818594" xlink:type="simple">10.1063/1.4818594</ext-link></comment> <object-id pub-id-type="pmid">24089736</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref088">
<label>88</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kowerko</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>König</surname> <given-names>SLB</given-names></name>, <name name-style="western"><surname>Skilandat</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kruschel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hadzic</surname> <given-names>MCAS</given-names></name>, <name name-style="western"><surname>Cardo</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Cation-induced kinetic heterogeneity of the intron–exon recognition in single group II introns</article-title>. <source>Proc Natl Acad Sci</source>. <year>2015</year>;<volume>112</volume>(<issue>11</issue>):<fpage>3403</fpage>–<lpage>3408</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1322759112" xlink:type="simple">10.1073/pnas.1322759112</ext-link></comment> <object-id pub-id-type="pmid">25737541</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref089">
<label>89</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Segev</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ben-Yehuda</surname> <given-names>S</given-names></name>. <article-title>RNA Dynamics in Aging Bacterial Spores</article-title>. <source>Cell</source>. <year>2012</year>;<volume>148</volume>(<issue>1–2</issue>):<fpage>139</fpage>–<lpage>149</lpage>. <object-id pub-id-type="pmid">22209493</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005286.ref090">
<label>90</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pedregosa</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Varoquaux</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gramfort</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Michel</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Thirion</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Grisel</surname> <given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Scikit-learn: Machine Learning in Python</article-title>. <source>J Mach Learn Res</source>. <year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>