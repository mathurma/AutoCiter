<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-1326R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000724</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Computer Science/Applications</subject><subject>Infectious Diseases</subject><subject>Public Health and Epidemiology</subject></subj-group></article-categories><title-group><article-title>Quantifying Aggregated Uncertainty in <italic>Plasmodium falciparum</italic> Malaria Prevalence and Populations at Risk <italic>via</italic> Efficient Space-Time Geostatistical Joint Simulation</article-title><alt-title alt-title-type="running-head">Geostatistical joint simulation of <italic>P. falciparum</italic></alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Gething</surname><given-names>Peter W.</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Patil</surname><given-names>Anand P.</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hay</surname><given-names>Simon I.</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
</contrib-group><aff id="aff1">          <addr-line>Spatial Ecology and Epidemiology Group, Department of Zoology, University of Oxford, Oxford, United Kingdom</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Pascual</surname><given-names>Mercedes</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">University of Michigan and Howard Hughes Med. Inst., United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">peter.gething@zoo.ox.ac.uk</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: PWG SIH. Performed the experiments: PWG. Analyzed the data: PWG APP. Contributed reagents/materials/analysis tools: PWG APP. Wrote the paper: PWG APP SIH.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>4</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>1</day><month>4</month><year>2010</year></pub-date><volume>6</volume><issue>4</issue><elocation-id>e1000724</elocation-id><history>
<date date-type="received"><day>29</day><month>10</month><year>2009</year></date>
<date date-type="accepted"><day>26</day><month>2</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Gething et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Risk maps estimating the spatial distribution of infectious diseases are required to guide public health policy from local to global scales. The advent of model-based geostatistics (MBG) has allowed these maps to be generated in a formal statistical framework, providing robust metrics of map uncertainty that enhances their utility for decision-makers. In many settings, decision-makers require spatially aggregated measures over large regions such as the mean prevalence within a country or administrative region, or national populations living under different levels of risk. Existing MBG mapping approaches provide suitable metrics of local uncertainty—the fidelity of predictions at each mapped pixel—but have not been adapted for measuring uncertainty over large areas, due largely to a series of fundamental computational constraints. Here the authors present a new efficient approximating algorithm that can generate for the first time the necessary joint simulation of prevalence values across the very large prediction spaces needed for global scale mapping. This new approach is implemented in conjunction with an established model for <italic>P. falciparum</italic> allowing robust estimates of mean prevalence at any specified level of spatial aggregation. The model is used to provide estimates of national populations at risk under three policy-relevant prevalence thresholds, along with accompanying model-based measures of uncertainty. By overcoming previously unchallenged computational barriers, this study illustrates how MBG approaches, already at the forefront of infectious disease mapping, can be extended to provide large-scale aggregate measures appropriate for decision-makers.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Reliable disease maps can support rational decision making. These maps are often made by interpolation: taking disease data from field studies and predicting values for the gaps between the data to make a complete map. Such maps always contain uncertainty, however, and measuring this uncertainty is vital so that the reliability of risk maps can be determined. A modern approach called model-based geostatistics (MBG) has led to increasingly sophisticated ways of mapping disease and measuring spatial uncertainty. Many health management decisions are made for administrative areas (e.g., districts, provinces, countries) and disease maps can support these decisions by averaging their values over the regions of interest. Carrying out this aggregation in conjunction with MBG techniques has not previously been possible for very large maps, however, due largely to the computational constraints involved. This study has addressed this problem by developing a new algorithm and allows aggregation of a global MBG disease map over very large areas. It is used to estimate <italic>Plasmodium falciparum</italic> malaria prevalence and corresponding populations at risk worldwide, aggregated across regions of different sizes. These estimates are a cornerstone for disease burden estimation and are provided in full to facilitate that process.</p>
</abstract><funding-group><funding-statement>SIH is funded by a Senior Research Fellowship (#079091) from the Wellcome Trust (<ext-link ext-link-type="uri" xlink:href="http://www.wellcome.ac.uk/" xlink:type="simple">http://www.wellcome.ac.uk/</ext-link>) that also supports PWG. APP is funded by the Wellcome Trust Principal Research Fellowship (#079080) of Professor Robert Snow. This work forms part of the output of the Malaria Atlas Project (MAP, <ext-link ext-link-type="uri" xlink:href="http://www.map.ox.ac.uk" xlink:type="simple">http://www.map.ox.ac.uk</ext-link>), principally funded by the Wellcome Trust, U.K. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="12"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Risk maps estimating the spatial distribution of infectious diseases in relation to underlying populations are required to support public health decision-making at local to global scales <xref ref-type="bibr" rid="pcbi.1000724-Hay1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1000724-Snow1">[3]</xref>. The advancement of theory, increasing availability of computation and growing recognition of the importance of robust handling of uncertainty have all contributed to the emergence in recent years of a new paradigm in the mapping of disease: the use of a special family of generalised linear models known as model-based geostatistics (MBG), generally implemented in a Bayesian framework <xref ref-type="bibr" rid="pcbi.1000724-Diggle1">[4]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Diggle2">[5]</xref>.</p>
<p>MBG models take point observations of disease prevalence from dispersed survey locations and generate continuous maps by interpolating prevalence at unsampled locations across raster grid surfaces. The most striking advantage of MBG in disease mapping is its handling of uncertainty. Interpolating sparse, often imperfectly sampled, survey data to predict disease prevalence across wide regions results in inherently uncertain risk maps, with the level of uncertainty varying spatially as a function of the density, quality, and sample size of available survey data, and moderated by the underlying spatial variability of the disease in question. MBG approaches allow these sources of uncertainty to be propagated to the final mapped output, predicting a probability distribution (known formally as a posterior predictive distribution) for the prevalence at each location of interest. Where predictions are made with small uncertainty, these distributions will be tightly concentrated around a central value; where uncertainty is large they will be more dispersed. These techniques have been used to generate robust and informative risk maps for malaria <xref ref-type="bibr" rid="pcbi.1000724-Hay3">[6]</xref>–<xref ref-type="bibr" rid="pcbi.1000724-Noor1">[12]</xref>, as well as a range of other infectious diseases <xref ref-type="bibr" rid="pcbi.1000724-Raso1">[13]</xref>–<xref ref-type="bibr" rid="pcbi.1000724-Raso2">[19]</xref>, at scales varying from national to global. Some studies have extended the handling of variation through space to also include the temporal dimension, allowing disease risk to be modelled and quantified over time as well as space <xref ref-type="bibr" rid="pcbi.1000724-Hay3">[6]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Gething1">[20]</xref>.</p>
<p>Implementation of MBG models over even relatively small areas is extremely computationally expensive. Not only are the matrix algebra operations required to generate predictions at each individual pixel costly compared to simpler interpolation methods <xref ref-type="bibr" rid="pcbi.1000724-Luo1">[21]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Eckstein1">[22]</xref>, but this cost must be multiplied many times because prediction uncertainty is evaluated by generating many, equally probable, “realisations” of prevalence at each pixel. Implementations of MBG disease models over large areas therefore tend to be <italic>via</italic> “per-pixel” computation whereby complete maps are built up by generating predictive realisations for each pixel independently. This allows the computational task to be broken down into many small, more easily manageable, operations. Such an approach yields appropriate measures of “local” uncertainty: the set of realisations for each pixel represents a posterior predictive distribution of prevalence from which summary statistics such as the mean, inter-quartile range or 95% credible intervals can be readily extracted, providing the user with valid uncertainty information for each individual location considered in isolation.</p>
<p>There is often a need to evaluate disease prevalence aggregated across spatial regions, temporal periods, or combinations of both <xref ref-type="bibr" rid="pcbi.1000724-Cibulskis1">[23]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-W.H.O.1">[24]</xref>. This may be to quantify and compare mean prevalence between countries or administrative units, for example, or to measure a shift in mean prevalence between the start and end of an intervention period or policy change. In addition, MBG prevalence models can be used to estimate derived quantities such as population totals living in regions at different levels of risk, or the burden of disease cases expected within individual countries or continents as a function of underlying prevalence <xref ref-type="bibr" rid="pcbi.1000724-Patil1">[25]</xref>, quantities that by definition exist only over aggregated space-time units. It is not possible, however, to construct posterior distributions for these aggregate quantities using a per-pixel approach. To estimate the mean of a region made up of multiple pixels, and the uncertainty around this estimate, the correlation between all the pixels in the region must be known. In a per-pixel approach, each pixel is modelled as independent of its neighbours, ignoring any spatial or temporal correlation. Failing to account for correlation between pixels leads to gross underestimates of the uncertainty in the aggregated quantity, especially over large regions <xref ref-type="bibr" rid="pcbi.1000724-Goovaerts1">[26]</xref>.</p>
<p>The solution to the problem outlined above is to replace per-pixel simulation of prevalence realisations with the simultaneous or ‘joint’ simulation of all pixels to be aggregated, recreating appropriate spatial and temporal correlation between them <xref ref-type="bibr" rid="pcbi.1000724-Goovaerts1">[26]</xref>. Crucially, the set of pixel values can then be aggregated in any way, or used as input in derived aggregated quantities, and realisations of these aggregations will have the appropriate posterior predictive distributions. Whilst conceptually simple, the extension from local to regional simulation induces a fundamental computational constraint in that the necessary calculations can no longer be disaggregated into separate tasks for each pixel. This constraint has thus far prevented any use of MBG in disease mapping for the evaluation of aggregate quantities over very large areas, despite the profound public health importance of such measures. Where examples of joint simulation in MBG disease mapping exist, they tend either to be over very small spatial regions <xref ref-type="bibr" rid="pcbi.1000724-Diggle3">[8]</xref> or are achieved by simply breaking larger regions down manually into smaller more manageable tiles <xref ref-type="bibr" rid="pcbi.1000724-Diggle4">[17]</xref>.</p>
<p>In this paper we use a new approximate algorithm for joint simulation to quantify, for the first time, aggregated uncertainty over space and time in a global scale MBG disease model for <italic>Plasmodium falciparum</italic> malaria prevalence <xref ref-type="bibr" rid="pcbi.1000724-Hay3">[6]</xref>. We exemplify how this approach allows uncertainty in prevalence predictions to be enumerated at the continental, national, and sub-national scales at which public-health decisions are usually made. We then extend the model architecture to estimate a second quantity of particular epidemiological interest: national populations at risk (PAR) under different policy-relevant strata of <italic>P. falciparum</italic> transmission intensity.</p>
<p>PAR estimates form a fundamental metric for malaria decision-makers at national and international levels <xref ref-type="bibr" rid="pcbi.1000724-W.H.O.1">[24]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Johansson1">[27]</xref> and have also been used to assess equity in donor funding distributions <xref ref-type="bibr" rid="pcbi.1000724-Snow2">[28]</xref>, chart the changing exposure of human populations to the disease <xref ref-type="bibr" rid="pcbi.1000724-Hay4">[29]</xref> and provide baselines for predicted changes in exposure under climate change scenarios <xref ref-type="bibr" rid="pcbi.1000724-Martens1">[30]</xref>. A range of techniques have been used to estimate PAR, including the use of MBG and other prevalence models to delineate risk strata in relation to underlying population distributions <xref ref-type="bibr" rid="pcbi.1000724-Hay3">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1000724-Hay4">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1000724-Guerra1">[31]</xref>–<xref ref-type="bibr" rid="pcbi.1000724-Snow3">[33]</xref>. None of these studies have incorporated the inherent uncertainty in prevalence estimates, however, and the resulting PAR estimates are presented as point values with no uncertainty metrics. Here we use the joint simulation framework to generate posterior predictive distributions of PAR living under conditions of low, medium, and high stable transmission within each malaria endemic country, allowing the uncertainty inherent in these estimates to be quantified in a formal statistical framework. These PAR estimates are presented in full with this paper, making them available to any interested parties to support theoretical and applied epidemiological and public health applications.</p>
<p>In the remainder of this introductory section we outline the computational challenges of large scale joint simulation and review existing approaches to overcoming them. In the <xref ref-type="sec" rid="s2">methods</xref> section we present our algorithm for efficient joint simulation over very large grids, detail its implementation and testing with the global <italic>P. falciparum</italic> model, and its extension to estimating PAR. The results section provides the outcome of the testing and validation procedures and examples of jointly simulated realisations of continental, national, and locally aggregated estimates of <italic>P. falciparum</italic> prevalence in 2007. We present our national level estimates of PAR and exemplify how the accompanying uncertainty metrics can be communicated effectively to enhance their utility to decision-makers. We conclude by discussing the strengths and weaknesses of our modelling architecture, the implications for the future of disease mapping, and useful directions for further research.</p>
<sec id="s1a">
<title>The Computational Challenge of Joint Simulation</title>
<p>A general form for MBG models can be defined as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e001" xlink:type="simple"/><label>(1)</label></disp-formula>such that in a disease survey of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e002" xlink:type="simple"/></inline-formula> individuals at a given location, the number observed to be infected <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e003" xlink:type="simple"/></inline-formula> is modelled as binomially distributed with probability of infections given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e004" xlink:type="simple"/></inline-formula>, the underlying prevalence of the disease in question, which is modelled as a transformation <italic>via</italic> an inverse link-function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e005" xlink:type="simple"/></inline-formula> of an unknown Gaussian process (GP) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e006" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000724-Abrahamsen1">[34]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Williams1">[35]</xref>. A Gaussian process in the context of disease mapping is a convenient probability distribution for 2-d surfaces (or 3-d cubes if considering time), describing probabilities associated with different forms of the surface (or cube). Using Bayesian inference, the Gaussian process can be updated to take account of the input data, providing a refined description of these probabilities. Possible surfaces can then be drawn from this updated Gaussian process which, after passing through the inverse link-function, provide realisations of the target disease surface. The Gaussian process can take a wide range of forms: the central tendency at any location is governed by the underlying mean function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e007" xlink:type="simple"/></inline-formula>, whilst textural properties (the roughness of the surface, and its tendency to fluctuate across space) are governed by the covariance function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e008" xlink:type="simple"/></inline-formula>. The symbol <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e009" xlink:type="simple"/></inline-formula> denotes a set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e010" xlink:type="simple"/></inline-formula> parameters that define the form of the covariance and mean, which can include covariate coefficients.</p>
<p>In MBG, the aim is to estimate the joint posterior distribution of the model parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e011" xlink:type="simple"/></inline-formula> and the values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e012" xlink:type="simple"/></inline-formula> evaluated at all locations and times for which a prediction is required - generally across the nodes of a regular raster grid. Computationally, this task can be split into two distinct phases. Firstly, Markov chain Monte Carlo (MCMC) can be used to generate realisations from the joint posterior of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e013" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e014" xlink:type="simple"/></inline-formula> at only the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e015" xlink:type="simple"/></inline-formula> space-time locations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e016" xlink:type="simple"/></inline-formula> where data exist, denoted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e017" xlink:type="simple"/></inline-formula>. This is intuitive because it is only at these locations that the fit of the Gaussian process is evaluated, and this means the MCMC must only consider a multivariate normal distribution of dimension <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e018" xlink:type="simple"/></inline-formula>, which is generally several orders of magnitude smaller than if all prediction locations across the raster grid were considered. A realisation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e019" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e020" xlink:type="simple"/></inline-formula> provides a ‘skeleton’ from which the Gaussian process can be evaluated at all prediction locations across a raster grid in a second computational stage. Conditional on these ‘skeleton’ realisations, the value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e021" xlink:type="simple"/></inline-formula> at each prediction location and time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e022" xlink:type="simple"/></inline-formula> can be sampled from its posterior predictive distribution:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e023" xlink:type="simple"/><label>(2)</label></disp-formula>where the posterior predictive mean and covariance parameters are given by the standard conditioning formulas for multivariate normal variables [<xref ref-type="bibr" rid="pcbi.1000724-West1">[36]</xref> (p.367)]:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e024" xlink:type="simple"/><label>(3)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e025" xlink:type="simple"/><label>(4)</label></disp-formula>By carrying out this two-step procedure over many realisations, samples are built up from the target posterior predictive distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e026" xlink:type="simple"/></inline-formula>.</p>
<p>In a per-pixel implementation, the predictive distributions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e027" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e028" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e029" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e030" xlink:type="simple"/></inline-formula> at all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e031" xlink:type="simple"/></inline-formula> prediction locations in the output raster are realised independently to generate local models of uncertainty. In this case, the largest single computational component is the population and factorisation (<italic>via</italic> a procedure known as the Cholesky decomposition <xref ref-type="bibr" rid="pcbi.1000724-Golub1">[37]</xref>) of the data-to-data covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e032" xlink:type="simple"/></inline-formula> which, in typical disease prevalence data sets where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e033" xlink:type="simple"/></inline-formula> is in the hundreds or thousands, is a relatively minor task that could generally be achieved on a standard desktop computer. The subsequent sampling from the posterior predictive distribution (as in Eq. 2) is trivial: the posterior predictive mean and covariance refer to a single prediction location and sampling therefore amounts to drawing from a univariate normal distribution. Total computation for each pixel is therefore modest, and the cost of generating the maps grows simply in proportion to the number of pixels involved, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e034" xlink:type="simple"/></inline-formula>.</p>
<p>Switching from a per-pixel implementation to a joint simulation over many prediction locations increases profoundly the computational challenge. The efficiency of a per-pixel approach arises from the effective reduction of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e035" xlink:type="simple"/></inline-formula> to one, as each pixel is considered in isolation. Joint simulation requires that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e036" xlink:type="simple"/></inline-formula> is preserved as the total number of prediction points, which can be many millions if large areas are considered at reasonably fine spatial resolution. In addition to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e037" xlink:type="simple"/></inline-formula> × <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e038" xlink:type="simple"/></inline-formula> data-to-data covariance matrix, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e039" xlink:type="simple"/></inline-formula> × <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e040" xlink:type="simple"/></inline-formula> prediction-to-prediction and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e041" xlink:type="simple"/></inline-formula> × <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e042" xlink:type="simple"/></inline-formula> data-to-prediction covariance matrices must be populated. More importantly, in the subsequent sampling from the posterior predictive multivariate normal distribution, the prediction-to-prediction covariance matrix must be factorised <xref ref-type="bibr" rid="pcbi.1000724-Golub1">[37]</xref>. The computational cost of this operation is proportional to the cube of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e043" xlink:type="simple"/></inline-formula>. To put this non-linear scaling in context, if a direct joint simulation of a 100×100 raster grid could be computed in one minute, a 1000×1000 grid would take approximately 6×10<sup>7</sup> seconds (around 694 days). In practice these scaling factors along with those of memory and storage requirements mean direct joint simulation using the equations outlined above is generally limited to predictions at a maximum of around 10,000 points <xref ref-type="bibr" rid="pcbi.1000724-Diggle4">[17]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Gneiting1">[38]</xref>, at least two orders of magnitude too few for global scale mapping at sub-10 km resolution, even at a single time period.</p>
</sec><sec id="s1b">
<title>Existing Solutions</title>
<p>In response to the strict computational limits of direct joint simulation outlined above, a wide range of algorithmic and mathematical tools have been developed that increase substantially the maximum number of prediction locations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e044" xlink:type="simple"/></inline-formula> that can be feasibly handled.</p>
<p>The most widely used family of joint simulation algorithms in geostatistics is known as sequential simulation <xref ref-type="bibr" rid="pcbi.1000724-Goovaerts2">[39]</xref>–<xref ref-type="bibr" rid="pcbi.1000724-Oz1">[41]</xref>. Instead of simulating the joint distribution across all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e045" xlink:type="simple"/></inline-formula> prediction locations simultaneously, sequential simulation evaluates each prediction location in turn. The properties of the multivariate normal model are preserved by conditioning each prediction location not only on the input data, but also on the values simulated at previously evaluated prediction locations, which are effectively treated as conditioning data in subsequent simulations. This approach means the data-to-data covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e046" xlink:type="simple"/></inline-formula> gains an additional row and column after each simulation, ultimately approaching <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e047" xlink:type="simple"/></inline-formula> elements, which becomes prohibitively large as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e048" xlink:type="simple"/></inline-formula> approaches around 10,000 points. In response, sequential simulation algorithms generally limit the conditioning data to a small neighbourhood of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e049" xlink:type="simple"/></inline-formula> points around each prediction location, specified either by number or by spatial proximity. This computational shortcut is justified by the declining influence of more distant data, which means a simulation conditioned on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e050" xlink:type="simple"/></inline-formula> data approximates asymptotically one conditioned on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e051" xlink:type="simple"/></inline-formula> data <xref ref-type="bibr" rid="pcbi.1000724-Goovaerts2">[39]</xref>. Whilst allowing potentially very large prediction grids to be evaluated, the restriction of conditioning data to local neighbourhoods necessitates that, for each prediction location, these <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e052" xlink:type="simple"/></inline-formula> data are identified <italic>via</italic> a search algorithm <xref ref-type="bibr" rid="pcbi.1000724-Deutsch1">[40]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Journel1">[42]</xref>, and bespoke linear algebra systems are evaluated and solved (Eqs. 3 and 4). The cost of the latter for each pixel is proportional to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e053" xlink:type="simple"/></inline-formula>, meaning that as the number of prediction locations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e054" xlink:type="simple"/></inline-formula> grows, the size of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e055" xlink:type="simple"/></inline-formula> that can be feasibly computed reduces sharply.</p>
<p>In a disease mapping context, the goal is to generate joint simulations conditioned by observed prevalence or incidence data. This precludes the direct use of a wider class of algorithms developed for unconditional joint simulation <xref ref-type="bibr" rid="pcbi.1000724-Diggle2">[5]</xref>, where the goal is simply to realise random fields with correct mean and covariance properties, unconstrained by any observations. Conditional simulation can, however, be split into an unconditional joint simulation and a per-pixel prediction task [<xref ref-type="bibr" rid="pcbi.1000724-Journel1">[42]</xref> (p.494),<xref ref-type="bibr" rid="pcbi.1000724-Gething2">[43]</xref>], as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e056" xlink:type="simple"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e057" xlink:type="simple"/></inline-formula> is the target conditioned field. In practical terms, this decomposition allows generation of the conditioned field in two stages: unconditional simulation is used to generate the unconditioned field (the first term above, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e058" xlink:type="simple"/></inline-formula>), which is then combined with the ‘skeleton’ of the conditioned field at the data points <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e059" xlink:type="simple"/></inline-formula> in a standard per-pixel prediction (the second right-hand term). The sum of these terms yields a conditioned field with an identical distribution to one generated directly <italic>via</italic> conditional simulation. The advantage in working with unconditional simulation algorithms arises because, in the absence of irregularly located data, all computations relate to locations arranged in a regular grid, a geometric convenience that can be exploited in a variety of ways <xref ref-type="bibr" rid="pcbi.1000724-Dietrich1">[44]</xref>–<xref ref-type="bibr" rid="pcbi.1000724-Mantoglou1">[47]</xref>. An elegant and widely used family of techniques for grid-based unconditional simulation is based on spectral decompositions, principally the fast Fourier transform, of which the ‘circulant embedding’ algorithm is particularly popular <xref ref-type="bibr" rid="pcbi.1000724-Dietrich2">[48]</xref>–<xref ref-type="bibr" rid="pcbi.1000724-Dietrich3">[50]</xref>. These techniques offer extremely efficient exact simulations but become infeasible for more than around one million prediction locations <xref ref-type="bibr" rid="pcbi.1000724-Gneiting1">[38]</xref>, due in part to memory requirements resulting from the necessary replication of large covariance matrices. Furthermore, such algorithms require the prediction grid to be regular, that is, for pixels to be arranged in rows and columns of equal spacing, which is not the case with global grids defined using spherical coordinates.</p>
</sec></sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<sec id="s2a">
<title>A Model-Based Geostatistical Model for <italic>P. falciparum</italic> Parasite Rate</title>
<p>A new global map of <italic>P. falciparum</italic> endemicity in 2007 has recently been published <xref ref-type="bibr" rid="pcbi.1000724-Hay3">[6]</xref>, the first such enumeration of global malaria risk in 40 years. This map was generated from an assembly of 7,953 community parasite surveys collated from 78 countries between 1985 and 2007 used with a Bayesian space-time MBG model to predict urban-adjusted <italic>P. falciparum</italic> parasite rate in the epidemiologically informative 2 up to 10 yr age range, <italic>Pf</italic>PR<sub>2–10</sub>, across a regular spherical grid within the limits of stable transmission <xref ref-type="bibr" rid="pcbi.1000724-Guerra1">[31]</xref>. The model form is described in full elsewhere <xref ref-type="bibr" rid="pcbi.1000724-Hay3">[6]</xref>. The original implementation of this model used an MCMC inference stage to generate 500 samples from the joint posterior distribution of the space-time Gaussian process at the 7,953 locations for which input parasite rate survey data existed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e060" xlink:type="simple"/></inline-formula>, and of a 13 element parameter vector, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e061" xlink:type="simple"/></inline-formula>. A per-pixel approach was then used to evaluate, for each realisation, values of the Gaussian process at all desired prediction locations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e062" xlink:type="simple"/></inline-formula>, which were then combined with an independently sampled Gaussian random noise component, and subjected to an inverse logit transform and multiplication with an age-correction factor to yield the target quantity <italic>Pf</italic>PR<sub>2–10</sub>. The set of realisations of <italic>Pf</italic>PR<sub>2–10</sub> for each pixel provided an appropriate measure of local uncertainty, with which the precision of <italic>Pf</italic>PR<sub>2–10</sub> predictions could be assessed at all individual pixel locations worldwide.</p>
<p>The aim of the current study was to implement the predictions described above <italic>via</italic> joint simulation, allowing quantification of uncertainty in predicted <italic>Pf</italic>PR<sub>2–10</sub> over spatially and temporally aggregated regions. This presented an unprecedented challenge in geostatistical disease modelling for a number of reasons. Firstly, the target prediction space was exceptionally large: a grid of resolution equivalent to 5×5 km at the equator spanning the extent of stable <italic>P. falciparum</italic> transmission in Africa (the largest contiguous region of interest), evaluated temporally for each of the 276 months of 1985–2007 (the study period of interest, corresponding to the temporal span of the collated <italic>Pf</italic>PR survey assembly) constituted approximately 623 million individual prediction locations, several orders of magnitude larger than any other MBG disease model extent in the published literature. Secondly, the model had a relatively complex form, particularly in the covariance function <xref ref-type="bibr" rid="pcbi.1000724-Stein2">[51]</xref> which was spatiotemporal (covariances were modelled between locations spread across time as well as space), spatially anisotropic (covariance between spatial locations was influenced by direction as well as separation distance), and included a periodic component in the temporal axis (to address observed seasonality). Finally, spatial locations of data and predictions were represented on a sphere, with their separations evaluated using great-circle distance, a geometric complication that was necessary to avoid the distorting effects of map projections when dealing with global scale phenomena. Together, these factors precluded the use of the existing approaches to joint simulation described above. Spectral decomposition-based algorithms for unconditional simulation would have required the data-to-data covariance matrix to be reflected along three axes, exceeding memory limits of currently available computers. More fundamentally, the incorporation of the curvature of the earth in the arrangement of prediction locations meant the matrix could not be considered to be in block Toeplitz form <xref ref-type="bibr" rid="pcbi.1000724-Gneiting1">[38]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Dietrich1">[44]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Dietrich2">[48]</xref>. Whilst a standard sequential simulation could, in principle, have been achieved within available memory constraints, the very large number of prediction locations would have meant limiting conditioning data to insufficiently small prediction neighbourhoods in space and time in order to achieve computation in a feasible timescale. Instead, a novel approximate algorithm for joint simulation was developed that overcame these constraints, and this is presented in the next section.</p>
</sec><sec id="s2b">
<title>Achieving a Very Large Joint Simulation</title>
<p>Sequential simulation algorithms maintain feasible memory and computation requirements over large grids by limiting conditioning data to small local neighbourhoods, but the repeated identification of local data, evaluation of local covariance matrices, and subsequent linear algebra calculations are prohibitively inefficient for very large numbers of prediction locations. The extremely efficient algorithms developed for unconditional joint simulation over regular grids, such as circulant embedding, also reach memory limits for very large prediction tasks, and are not suited to sphere-based grids. In this study a new algorithm was developed that adopted and extended the principle of traditional sequential simulation - that joint simulation over very large areas can be broken down into many small simulations conditioned on nearby values - but incorporated some of the efficiencies exploited by unconditional algorithms operating on a grid whilst overcoming the complications of sphere-based grid systems.</p>
<p>Firstly, the decomposition of a conditional joint simulation into an unconditional joint simulation and a per-pixel conditioning stage was exploited (Eq. 5). The bulk of the computational challenge therefore lay in generating unconditioned realisations of the zero-mean Gaussian process <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e063" xlink:type="simple"/></inline-formula> across the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e064" xlink:type="simple"/></inline-formula> nodes of the 3-d space-time prediction grid given only realisations of the scalar parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e065" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e066" xlink:type="simple"/></inline-formula> = 6.23×10<sup>8</sup> was the largest individual prediction task (for the Africa region, with 1718 columns, 1315 rows and 276 months). Each grid pixel was 0.04165 decimal degrees in height and width, corresponding to approximately 5×5 km at the equator. Defining a regular grid in terms of spherical coordinates meant that the width of pixels varied with latitude. A second stage was then required to condition the field <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e067" xlink:type="simple"/></inline-formula> given realisations of the field at the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e068" xlink:type="simple"/></inline-formula> data locations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e069" xlink:type="simple"/></inline-formula> These two stages are now discussed in more detail.</p>
<sec id="s2b1">
<title>Stage 1: Unconditional simulation of a random field</title>
<p>In this first stage the principle of sequential simulation was adapted. Rather than randomly visiting individual prediction locations in turn, each column of each monthly surface of the 3-d space-time prediction grid was jointly simulated in sequence, scanning left-to-right across each monthly surface and from the earliest month (January 1985) to the latest (December 2007). Each simulated column then became available for conditioning subsequent columns. As with conventional sequential simulation, the size of the conditioning set was prevented from becoming prohibitively large by limiting conditioning data to a set of local prediction locations. A key inefficiency in the use of local conditioning neighbourhoods in conventional sequential simulation algorithms is that, because the spatial (or spatiotemporal) configuration of data with respect to the target prediction location in each neighbourhood is likely to be unique, the data-to-data and data-to-prediction covariance evaluations must be repeated for every sequential prediction. In this algorithm, however, the locations of conditioning data relative to the prediction column were defined <italic>a priori</italic>, using a “conditioning footprint”. This footprint prescribed those previously simulated grid locations that were used to condition subsequent columns, identified by their relative rather than absolute position in relation to the prediction column. This allowed a single footprint (once edge-effects had been handled, discussed later) to be used repeatedly to define the location of conditioning pixels for every column.</p>
<p>This procedure resulted in a number of computational advantages over conventional sequential simulation. Firstly, since the locations of conditioning data, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e070" xlink:type="simple"/></inline-formula>, (where the “hat” denotes previously simulated values subsequently treated as conditioning data) were prescribed <italic>a priori</italic>, there was no requirement to repeatedly search for and identify conditioning data proximal to prediction locations. Secondly, because the relative positions of conditioning data were the same for all columns, the associated data-to-prediction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e071" xlink:type="simple"/></inline-formula>, prediction-to-prediction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e072" xlink:type="simple"/></inline-formula>, and data-to-data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e073" xlink:type="simple"/></inline-formula>, covariance matrices only needed to be evaluated once for each realisation, along with the factorisation of the latter matrix required in the evaluation of the posterior predictive covariance (Eq. 3) and mean (Eq. 4). Defining these components <italic>a priori</italic> meant that computations to be performed per realisation for each column were restricted to a single matrix multiplication to complete the evaluation of the posterior predictive mean (Eq. 4) and the subsequent joint sampling of the column pixel values from the multivariate normal posterior predictive distribution (Eq. 2), resulting in very large savings in memory and computation.</p>
<p>Because the algorithm scanned left-to-right, only columns to the left of the prediction column could be included from the same month. Preceding months could include columns both to the right, directly ‘below’ and to the left. The exact configuration of the footprint in terms of the number and spacing of preceding columns and the number and spacing of preceding months could be varied. Similarly, the density of included columns could be varied such that pixels from every 2nd, 5th, or 10th row of each column, for example, could be included rather than from every row. Analogous to the specification of conditioning neighbourhoods in conventional sequential simulation, the success of the procedure presented here was dependent on a suitable configuration of the conditioning footprint. This configuration represented a trade-off between the computational cost of the algorithm, which scaled sharply with larger and more dense footprints, and the extent to which the resulting unconditioned field approximated the hypothetical result obtained using a direct simulation. The appropriate tool for identifying a suitable footprint configuration was the extent to which the resulting simulated field reproduced the required covariance properties specified by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e074" xlink:type="simple"/></inline-formula>, and this is discussed further in subsequent sections.</p>
<p>A final algorithmic complication arose from the constraints placed on the footprint configuration by the spatial and temporal boundaries of the grid. Clearly a footprint using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e075" xlink:type="simple"/></inline-formula> columns to the left of the prediction column is truncated by the left-hand boundary of the grid until the algorithm scans to predict the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e076" xlink:type="simple"/></inline-formula> column. A similar truncation occurs as the algorithm approaches the right-hand grid boundary and applies also to the temporal dimension as columns from the preceding <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e077" xlink:type="simple"/></inline-formula> months are not available until the prediction month progresses to month <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e078" xlink:type="simple"/></inline-formula>. These edge effects were handled by simply defining a series of truncated footprints that gradually became larger as the algorithm scanned away from the left-hand margin, and from the early months. Similarly, as the scan-line approached the far right-hand margin and/or the later months, it again became progressively constrained. Prediction of the very first column, which by definition had no previously simulated data on which to be conditioned, was achieved simply by direct unconditional simulation. The geometric operation of the algorithm is illustrated schematically in <xref ref-type="fig" rid="pcbi-1000724-g001">Figure 1</xref>. Each unique footprint resulted in a corresponding unique data-to-data and data-to-prediction covariance matrix. As with the matrices supporting the non-truncated footprint, these were evaluated and factorised <italic>a priori</italic>, and were stored in memory to be available as the algorithm scanned across the columns of the grid. The up-front memory requirements of the algorithm were therefore heavily influenced by the number of different truncated footprints that needed to be defined, which in turn was determined by the spatial and temporal extent of the full footprint.</p>
<fig id="pcbi-1000724-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000724.g001</object-id><label>Figure 1</label><caption>
<title>Progression of footprint algorithm for efficient joint simulation of the space-time Gaussian random field.</title>
<p>The sequence of schematic diagrams shows the algorithm at six different stages. In this schematic, the prediction space is 25 columns by 25 rows by two months. In each diagram the target column to be predicted is marked in red, pixels already predicted to the left or below the target column are shaded, those yet to be predicted are left white. The ‘footprint’ of conditioning data used in each prediction is shaded blue. In this example the full footprint extent is specified to include, in the target month, seven columns to the left of the target column and, in the preceding month, seven columns to the left, seven to the right and the column directly below the target column. This full extent is thinned to include only every second column and row. Diagram 1 (lower left) shows the algorithm at an early stage: having already simulated values in the first three columns of the first month, the target column being simulated is the fourth from left. The full footprint is truncated and consists of only two columns to the left of the target column. As the algorithm scans across this first month, more columns become available to the left and the footprint grows (diagrams 2 and 3). In diagram 4 the algorithm has moved to the second month, and the footprint can now begin to include simulated pixels from the preceding month. In diagram 5 the full footprint is shown, truncated neither to the left nor right. As the algorithm scans further to the right to complete the second month, the footprint becomes truncated once more, this time by the right-hand margin (diagram 6).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000724.g001" xlink:type="simple"/></fig></sec><sec id="s2b2">
<title>Stage 2: Generation of a conditioned field</title>
<p>Values of the unconditioned field <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e079" xlink:type="simple"/></inline-formula> at each of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e080" xlink:type="simple"/></inline-formula> data locations were defined by assigning the values of the nearest prediction node in space and time (leading to a maximum spatial mismatch of &lt;2.5km which was considered acceptable in the global-scale model). A standard per-pixel prediction was then carried out to combine these values with the conditioning data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e081" xlink:type="simple"/></inline-formula> and the unconditioned field <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e082" xlink:type="simple"/></inline-formula>, to generate realisations of the target conditioned field <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e083" xlink:type="simple"/></inline-formula> as outlined in Eq. 5.</p>
<p>All code was written in the R <xref ref-type="bibr" rid="pcbi.1000724-R1">[52]</xref> and Python <xref ref-type="bibr" rid="pcbi.1000724-VanRossum1">[53]</xref> programming languages, incorporating only open-access libraries, and is available to download freely from <ext-link ext-link-type="uri" xlink:href="http://github.com/malaria-atlas-project/mbg-world/tree/generic" xlink:type="simple">http://github.com/malaria-atlas-project/mbg-world/tree/generic</ext-link>.</p>
</sec></sec><sec id="s2c">
<title>Predicting Aggregated Uncertainty in <italic>P. falciparum</italic> Endemicity Predictions</title>
<p>Having implemented the algorithm described above, the jointly-simulated conditioned field <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000724.e084" xlink:type="simple"/></inline-formula> was combined with per-pixel samples from an uncorrelated Gaussian noise component, subject to an inverse-logit transform, and multiplied by an age correction factor to yield realisations of <italic>Pf</italic>PR<sub>2–10</sub>. Crucially, in contrast to the original per-pixel implementation <xref ref-type="bibr" rid="pcbi.1000724-Hay3">[6]</xref>, each realisation represented a joint simulation of prevalence, so the back-transformed and age-corrected space-time cube could be aggregated into any arbitrary spatial, temporal, or space-time unit, with realisations of the aggregated quantity representing samples from the posterior predictive distribution. This was exemplified by generating realisations of mean <italic>Pf</italic>PR<sub>2–10</sub> across the 12 months of 2007 for three scales of spatial aggregation: continental, national, and at the first sub-national administrative unit level, quantities that span the spectrum of information scales required by malaria public-health decision-makers.</p>
</sec><sec id="s2d">
<title>Predicting Aggregated Uncertainty in Populations at Risk Under Different Strata of <italic>P. falciparum</italic> Endemicity</title>
<p>Previous approaches to estimating PAR have used modelled surfaces of <italic>P. falciparum</italic> prevalence to delineate the boundaries of various risk strata, and combine these mapped boundaries with population maps to calculate the population living in each strata <xref ref-type="bibr" rid="pcbi.1000724-Hay3">[6]</xref>. Because the prevalence modelling in this earlier work was set in a per-pixel framework, spatial uncertainty in the prevalence predictions could not be propagated into the PAR estimates since the latter is a spatially aggregated quantity. This limitation was removed in the current study since prevalence was modelled using a joint simulation framework. Population data <xref ref-type="bibr" rid="pcbi.1000724-Balk1">[54]</xref> were obtained and adjusted to form a 1×1 km grid surface for 2007, and a previously defined stratification <xref ref-type="bibr" rid="pcbi.1000724-Guerra1">[31]</xref> was used to delineate areas in which stable transmission of <italic>P. falciparum</italic> malaria was likely to occur (defined as areas where incidence is likely to exceed 0.1 case per 1000 per annum). These inputs are explained further in <xref ref-type="supplementary-material" rid="pcbi.1000724.s001">Protocol S1</xref>. Within these limits of stable transmission, each jointly simulated realization of <italic>Pf</italic>PR<sub>2–10</sub> was converted into a categorical map identifying pixels where prevalence was predicted as either low stable (<italic>Pf</italic>PR<sub>2–10</sub>≤5%), medium stable (<italic>Pf</italic>PR<sub>2–10</sub>&gt;5%≤40%) or high stable (<italic>Pf</italic>PR<sub>2–10</sub>&gt;40%) transmission. These prevalence classes have been proposed previously as of particular relevance to decision-makers when developing optimal strategies for intervention and control <xref ref-type="bibr" rid="pcbi.1000724-Smith1">[55]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Hay6">[56]</xref>. Each realized endemicity class map was downscaled to a 1×1 km grid and combined with the population grid and an additional grid identifying national boundaries to allow calculation of a realization of PAR in each of the three endemicity classes in each country. Repeating this procedure across all 500 realizations allowed posterior predictive distributions to be constructed, from which the posterior mean was extracted as a point estimate for each country-class and the inter-quartile range was extracted as an accompanying uncertainty metric.</p>
</sec><sec id="s2e">
<title>Testing and Validation</title>
<sec id="s2e1">
<title>Generating aggregated sets for validation</title>
<p>In the original implementation of the global <italic>P. falciparum</italic> map <xref ref-type="bibr" rid="pcbi.1000724-Hay3">[6]</xref>, two aspects of the model performance were tested: the ability (i) to accurately predict <italic>Pf</italic>PR<sub>2–10</sub> at individual pixel locations and, (ii) crucially, to provide posterior predictive distributions of <italic>Pf</italic>PR<sub>2–10</sub> that represented appropriate measures of local uncertainty for each pixel. Correspondingly, the joint simulation implemented in the current study was tested for the ability to (i) accurately predict mean <italic>Pf</italic>PR<sub>2–10</sub> over aggregated sets of pixels and (ii) generate appropriate posterior predictive distributions of these aggregated means. A hold-out set of 10% of the data was selected using a spatially-declustered stratified random sampling procedure described previously <xref ref-type="bibr" rid="pcbi.1000724-Hay3">[6]</xref>, and the modelling procedure was re-run using the remaining 90% of data to predict, <italic>via</italic> joint simulation, values at the hold-out locations. Aggregated sets of different sizes were made from this set of jointly simulated predictions. The ideal aggregated sets for testing would have consisted of complete spatial and temporal regions. Such test sets cannot exist, however, since it is both practically and theoretically impossible to measure <italic>Pf</italic>PR<sub>2–10</sub> continuously over large spatial regions and time periods. As an alternative, sets were made by aggregating non-contiguous pixels from the hold-out set dispersed through space and time. These sets were made by simple random sampling from the full hold-out set and consisted of 1000 sets each of sizes between 2 and 100 pixels. Sets made in this way were dispersed in both space and time and this was preferred to an alternative strategy of defining spatial or temporal-only sets so that the full space-time functionality of the algorithm could be assessed. Additionally, very few long time series of data existed at the same spatial location, preventing the definition of time-only validation sets. For each set, the true arithmetic mean <italic>Pf</italic>PR<sub>2–10</sub> was extracted, along with the corresponding posterior predictive distribution of the mean generated <italic>via</italic> joint simulation.</p>
</sec><sec id="s2e2">
<title>Testing point predictions of aggregated mean <italic>Pf</italic>PR<sub>2–10</sub></title>
<p>For each simulated set, a point estimate of the mean <italic>Pf</italic>PR<sub>2–10</sub> was derived using the mean of the posterior predictive distribution, and the error between this prediction and the observed true mean <italic>Pf</italic>PR<sub>2–10</sub> was calculated. A plot was constructed that plotted for each set the error value on the <italic>y</italic>-axis and the set size (number of aggregated pixels) on the <italic>x</italic>-axis, allowing a visualisation of the spread of errors associated with sets of different sizes. Additionally, the mean error and mean absolute error were calculated for each set size and overlaid for reference on the same plot.</p>
</sec><sec id="s2e3">
<title>Testing posterior predictive distributions of aggregated mean <italic>Pf</italic>PR<sub>2–10</sub></title>
<p>The following procedure was implemented to assess the fidelity of the posterior predictive distributions of mean <italic>Pf</italic>PR<sub>2–10</sub> for each set as models of uncertainty. Firstly, each distribution was summarised using 100 equally spaced quantiles. Secondly, each quantile was considered in turn and the proportion of true mean <italic>Pf</italic>PR<sub>2–10</sub> values, across all the aggregated sets, that exceeded the corresponding predicted mean <italic>Pf</italic>PR<sub>2–10</sub> value for that quantile was calculated. This proportion was interpreted as an “observed” probability threshold and was plotted against the “predicted” probability threshold associated with that quantile. In a perfect model it would be expected, for example, that 50% of the true set means would exceed the values predicted by the corresponding 0.5 quantile of each posterior predictive distribution, 90% would exceed the values predicted by the 0.1 quantile, and 99% the value predicted by the 0.01 quantile. By calculating the actual proportions of true means exceeding each of the 100 quantiles, a “coverage” plot was generated that compared these observed and predicted probability thresholds across the range of probabilities from zero to one. In a perfect model, all plotted values would lie on the 1∶1 line indicating an exact correspondence between predicted and observed probability thresholds, and an exact representation of the uncertainty in aggregated predictions. This procedure was carried out for 1000 sets each of size 1, 2, 5, 10, 15, 20, 30, 40, and 50 pixels drawn by simple random sampling from the full space-time hold-out set.</p>
</sec></sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Testing and Validation</title>
<sec id="s3a1">
<title>Testing point predictions and posterior predictive distributions of aggregated mean <italic>Pf</italic>PR<sub>2–10</sub></title>
<p><xref ref-type="fig" rid="pcbi-1000724-g002">Figure 2(A)</xref> shows the errors in the predicted mean <italic>Pf</italic>PR<sub>2–10</sub> values of many simulated sets of different sizes. The mean error, shown by the green line, was effectively zero for all set sizes, indicating that the model produces unbiased predictions with no overall tendency to over- or under-predict mean <italic>Pf</italic>PR<sub>2–10</sub>. As would be expected, the dispersion of these errors reduced with set size, as did their mean magnitude (shown by the mean absolute error line in red). Mean absolute error for sets of size 1, 25, 50 and 100 pixels was 11.4, 2.7, 1.9 and 1.3 <italic>Pf</italic>PR<sub>2–10</sub> respectively. <xref ref-type="fig" rid="pcbi-1000724-g002">Figure 2(B)</xref> shows the coverage plots for sets of different sizes. Comparison of predicted and observed probability thresholds revealed a similar pattern for aggregated sets regardless of their size. For probability thresholds between 0 and 0.5, the predicted and observed probabilities corresponded closely. Between thresholds of 0.5 and 1, the predicted probabilities tended to under-predict slightly the observed probability. This meant, for example, that around 80% of the true mean <italic>Pf</italic>PR<sub>2–10</sub> values exceeded the predicted 0.7 probability threshold, rather than the 70% predicted by the model. This suggested that the rising limb of the posterior predictive distributions tended to rise too gently towards the peak, thus underestimating slightly the probability of a given prediction taking values smaller than its point estimate. Taken as a whole, the coverage plot suggested that posterior predictive distributions were likely to represent predictive uncertainty reasonably well, albeit with slight deviations from a perfect model discussed above.</p>
<fig id="pcbi-1000724-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000724.g002</object-id><label>Figure 2</label><caption>
<title>Validation results.</title>
<p>A validation procedure generated many sets of aggregated pixels for which a posterior predictive distribution and point estimate of the set-mean <italic>Pf</italic>PR<sub>2–10</sub> could be compared to the true value. In (A) the error between the point estimate and true value is plotted against the size (number of pixels) of each aggregated set (black dots). Also shown are smoothed moving averages of the mean error (green line) and mean absolute error (red line) in relation to set size. (B) is a coverage plot comparing, for aggregated sets of different sizes, the correspondence between predicted probability thresholds (as provided by the modelled posterior predictive distributions of mean <italic>Pf</italic>PR<sub>2–10</sub> in the validation sets) and actual probability thresholds (defined as the observed proportions of true set means exceeding the predicted threshold values).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000724.g002" xlink:type="simple"/></fig></sec></sec><sec id="s3b">
<title>Predicting Aggregated Uncertainty in <italic>P. falciparum</italic> Endemicity Predictions</title>
<p><xref ref-type="fig" rid="pcbi-1000724-g003">Figure 3</xref> provides examples of five of the 500 jointly simulated realisations of <italic>Pf</italic>PR<sub>2–10</sub> within the global limits of stable transmission, aggregated temporally across the 12 months of 2007. None of these maps, taken individually, are intended to represent the true pattern of global prevalence. Each is driven by the underlying data but represents a random draw from a universe of possible maps given the model specification, the information in the data, and the resultant modelled uncertainty. Whilst the large-scale regional patterns of endemicity are similar in each realisation, small scale heterogeneity exists between each, and this variation across the 500 realisations defined the form of the posterior predictive distribution of the global surface. The validation procedures explained above provided evidence of the suitability of these surfaces to be aggregated spatially or temporally to provide appropriate posterior predictive distributions of mean <italic>Pf</italic>PR<sub>2–10</sub> within spatiotemporal units of different sizes. <xref ref-type="fig" rid="pcbi-1000724-g004">Figure 4</xref> provides examples of this functionality: posterior predictive distributions are shown for mean <italic>Pf</italic>PR<sub>2–10</sub> across the entire African continent, across three individual countries (Ghana, Democratic Republic of Congo (DRC) and Kenya), and across a first level administrative unit in each of these countries (Ashanti Region, Ghana; Kinshasa Province, DRC; Nyanza Province, Kenya). As would be expected, the dispersion of the distributions, which can be interpreted directly as the modelled uncertainty in the predicted mean <italic>Pf</italic>PR<sub>2–10</sub>, tended to decrease as aggregated predictions were made over progressively larger regions, such that the continent-wide mean was predicted with lower uncertainty than were national-level means which, in turn, were less uncertain than first-level administrative unit means. Dispersion was also moderated, however, by predictive uncertainty influenced by the availability of input survey data in different regions. This explains why the posterior predictive distribution for DRC, a country with very few available survey data, is substantially more dispersed than that for Kenya, for which many survey points exist, despite constituting a much larger spatial unit of aggregation. These example plots also illustrate in general terms why joint-simulation is necessary when predicting aggregated prevalence. Under a standard per-pixel implementation with all locations simulated independently, the variance of the aggregated mean <italic>Pf</italic>PR<sub>2–10</sub> would decline in proportion to the square-root of the number of pixels in the aggregated unit. At even the first administrative unit level, this would result in artificially small variances for the posterior predictive distributions. At national and continental levels the predicted uncertainty would effectively be zero. Under the joint simulation approach presented here, the space-time variance structure is preserved and this resulted in even the continent-wide prediction retaining a non-negligible level of uncertainty.</p>
<fig id="pcbi-1000724-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000724.g003</object-id><label>Figure 3</label><caption>
<title>Simulated global surfaces of <italic>Pf</italic>PR<sub>2–10</sub>.</title>
<p>Examples of five of the 500 realisations of <italic>Pf</italic>PR<sub>2–10</sub> generated <italic>via</italic> the joint simulation algorithm. Each of these maps represents an equally possible ‘reality’ and the full set of 500 provides a model of the probable prevalence at all locations. Because each map is jointly simulated, pixels within any spatial region can be aggregated together to define a regional mean, and the 500 different versions of that mean across the set of maps provides a model of the uncertainty for that mean value. Simulation is constrained to the global limits of stable transmission.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000724.g003" xlink:type="simple"/></fig><fig id="pcbi-1000724-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000724.g004</object-id><label>Figure 4</label><caption>
<title>Simulated posterior predictive distributions of <italic>Pf</italic>PR<sub>2–10</sub> at different spatial scales.</title>
<p>The crucial feature of the jointly simulated realisations of <italic>Pf</italic>PR<sub>2–10</sub> was that they could be aggregated over arbitrary spatial and/or temporal regions to generate posterior predictive distributions of mean <italic>Pf</italic>PR<sub>2–10</sub>, constituting appropriate models of regional uncertainty. In this example, such predicted distributions are provided at three different scales, predicting mean <italic>Pf</italic>PR<sub>2–10</sub> for the entire African continent (i); across the nations of Ghana (ii), Democratic Republic of Congo (iv) and Kenya (vi); and across a first administrative level unit of those countries (Ashanti Region, Ghana(iii); Kinshasa Province, DRC (v); Nyanza Province, Kenya (vii)).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000724.g004" xlink:type="simple"/></fig></sec><sec id="s3c">
<title>Predicting Aggregated Uncertainty in Populations at Risk under Different Strata of <italic>P. falciparum</italic> Endemicity</title>
<p>Estimated 2007 populations living under low, medium, and high stable transmission risk are presented by country in <xref ref-type="supplementary-material" rid="pcbi.1000724.s001">Protocol S1</xref> along with accompanying posterior inter-quartile ranges. <xref ref-type="fig" rid="pcbi-1000724-g005">Figure 5(A)</xref> provides an example of mapped national PAR estimates for the high stable transmission risk class (<italic>Pf</italic>PR<sub>2–10</sub>&gt;40%). <xref ref-type="fig" rid="pcbi-1000724-g005">Figure 5(B)</xref> shows a ranking of each country in terms of model-based uncertainty, quantified by comparing the width of the posterior inter quartile range associated with each PAR estimate. <xref ref-type="fig" rid="pcbi-1000724-g005">Figure 5(C)</xref> shows an equivalent uncertainty ranking for relative PAR (percentages of each country's population living under high stable conditions). Further details on the methods and interpretation of the presented results can be found in <xref ref-type="supplementary-material" rid="pcbi.1000724.s001">Protocol S1</xref>.</p>
<fig id="pcbi-1000724-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000724.g005</object-id><label>Figure 5</label><caption>
<title>Predicted national populations at risk of high stable transmission and associated ranked uncertainty metrics.</title>
<p>Map A shows the estimated population at risk of high stable transmission (<italic>Pf</italic>PR<sub>2–10</sub>&gt;40%) for each of the 80 <italic>P. falciparum</italic> malaria endemic countries considered, based on the mean of each posterior predictive distribution. Map B shows the ranked uncertainty associated with each of these national estimates, quantified using the width of each posterior inter-quartile range, and ordered into quintiles such that countries in quintile one have the largest uncertainty and quintile five the smallest. Map C presents the same uncertainty metric but based on national population proportions in this risk class rather than absolute numbers.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000724.g005" xlink:type="simple"/></fig></sec></sec><sec id="s4">
<title>Discussion</title>
<p>Numerous algorithms exist that seek to increase the efficiency of joint simulation, including the widely-used family of sequential simulation algorithms, and those based on spectral decompositions operating on regular lattices. Whilst these elegant algorithms expand considerably the magnitude of joint simulation tasks that can be achieved relative to a direct calculation, none of them could produce simulations on arbitrary input grids on the scale required for global-scale disease maps as addressed in this study. We have overcome these limitations using a practical elaboration of standard sequential simulation that is empirically highly efficient but does not put any special requirements on the input grid or covariance function. The approach represents an important increase in the feasibility of aggregated uncertainty assessment over very large prediction spaces, expanding the scope of geostatistical models in global scale epidemiology.</p>
<p>The current study builds on a modelling framework for the global mapping of <italic>P. falciparum</italic> prevalence defined in an earlier study <xref ref-type="bibr" rid="pcbi.1000724-Hay3">[6]</xref>. Like many large-scale MBG disease mapping studies published to date, this earlier work presented prevalence maps with per-pixel uncertainty metrics that could not be used to define uncertainty around aggregated prevalence predictions. Similarly, this per-pixel approach did not support the evaluation of uncertainty around important derived aggregate quantities such as populations at risk. By setting this earlier model in a joint simulation framework, the current study allows the formal prediction of aggregated <italic>P. falciparum</italic> prevalence and national populations under different prevalence strata with appropriate measures of uncertainty. <xref ref-type="fig" rid="pcbi-1000724-g005">Figure 5</xref> shows these national PAR estimates for populations living under conditions of high stable transmission. A prevalence threshold of <italic>Pf</italic>PR<sub>2–10</sub>&gt;40% has been proposed as separating lower transmission settings, where universal coverage of insecticide treated bed-nets could interrupt transmission <xref ref-type="bibr" rid="pcbi.1000724-Hay6">[56]</xref>, from higher transmission settings where this coverage alone would be insufficient and scale-up of additional interventions would be required to achieve elimination <xref ref-type="bibr" rid="pcbi.1000724-Smith1">[55]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Hay6">[56]</xref>. Under these recommendations, the quantification of PAR in this high stable transmission class has direct implications for national resource requirements as very large numbers of people in these nations will require more than universal coverage of bed-nets to interrupt transmission.</p>
<p>The direct practical utility to decision-makers of accompanying uncertainty metrics is less well established since they have not been available previously. Uptake by decision-makers will be aided by the packaging of uncertainty measures into easily understood information and the ranked uncertainty maps presented in <xref ref-type="fig" rid="pcbi-1000724-g005">Figure 5 (B and C)</xref> highlight one such approach. Recognising those countries where high-risk populations can be identified with least certainty provides a basis for rational deployment of global surveying, monitoring, and evaluation efforts for populations that will carry the largest burden of global malaria morbidity. <xref ref-type="fig" rid="pcbi-1000724-g005">Figure 5(B)</xref> illustrates that the least certain countries are, as would be expected, those which include areas of high transmission risk in conjunction with very large human populations, such as India, Myanmar, DRC and Nigeria. <xref ref-type="fig" rid="pcbi-1000724-g005">Figure 5(C)</xref> considers population proportions at risk and therefore standardises for absolute population size. This removes, amongst others, India, Nigeria and DRC from the set of least certain countries and adds some smaller high risk nations such as Togo, Liberia and Sierra Leone.</p>
<p>In this study we have presented the extension of a jointly simulated prediction framework for <italic>P. falciparum</italic> prevalence to estimates of PAR. The framework could readily be extended to the prediction of related aggregate quantities of substantial public health significance. An important example is the prediction of <italic>P. falciparum</italic> clinical case incidence which can be estimated empirically as a function of prevalence <xref ref-type="bibr" rid="pcbi.1000724-Patil1">[25]</xref> and the underlying population density <xref ref-type="bibr" rid="pcbi.1000724-Balk1">[54]</xref>. By basing these estimates on the jointly simulated prevalence predictions presented here, incidence estimates can be summed to provide national or continental-level estimates with appropriate credible intervals. A second important measure is the basic reproductive number, <italic>R</italic><sub>0</sub>, which provides biological insight into the intensity of malaria transmission and is particularly useful when assessing the effect of current or future interventions <xref ref-type="bibr" rid="pcbi.1000724-Smith2">[57]</xref>–<xref ref-type="bibr" rid="pcbi.1000724-Smith4">[59]</xref>. Again, <italic>R</italic><sub>0</sub> can be estimated as a function of prevalence <xref ref-type="bibr" rid="pcbi.1000724-Smith4">[59]</xref>,<xref ref-type="bibr" rid="pcbi.1000724-Smith5">[60]</xref> and the jointly simulated surfaces presented here can be incorporated with these models to provide country level estimates of <italic>R</italic><sub>0</sub> useful for strategic planning.</p>
<p>The approach presented in this study can be applied readily to any large-scale MBG prediction of infectious disease prevalence and corresponding populations at risk. An important caveat for further applications, however, is that the algorithm cannot be treated as a black-box that will generate appropriate output without user supervision. The algorithm relies on a key assumption: that the use of a relatively small proportion of conditioning data proximate to each target prediction column generates predicted values that are sufficiently similar to a theoretical (although infeasible) direct joint simulation based on all locations simultaneously. In reality, the footprint-based predictions will approach the theoretical “true” values asymptotically, such that the use of progressively more conditioning data in the footprint will result in progressively smaller increases in convergence between the two sets of values. This leads to a delicate trade-off between feasible computational demand and appropriate predictive precision. Suitable resolutions of this trade-off cannot be prescribed <italic>a priori</italic> since they rely on factors that will vary between settings. On one hand, the sparsest permissible footprint will be determined by the space-time covariance structure of the disease measure under study. On the other, the computational demand will scale non-linearly with the size of the study area and the spatial and temporal resolution at which it is to be modelled. In this study, appropriate footprint configurations were identified by systematically evaluating the empirical covariance functions of realisations generated under progressively sparser footprint configurations, and the necessary diagnostic scripts are freely available from the authors. In principle, appropriate configurations could be approximated in advance using the target covariance structure parameters, although the implications of the latter on the appropriateness of different configurations is likely to be complex and non-linear. Users of the algorithm should recognise that failure to consider these factors appropriately could lead to misleading or erroneous results.</p>
<p>Automatic optimization of the footprint would be a useful area for future research. Approaches to this problem, based on evaluation of the Markov properties of 2-d fields, have been proposed <xref ref-type="bibr" rid="pcbi.1000724-Cressie1">[61]</xref>–<xref ref-type="bibr" rid="pcbi.1000724-Rue2">[63]</xref> although as yet these have not been extended to the 3-d setting necessary for space-time simulation. A number of recent advances in computational infrastructure have emerged that also warrant further investigation in the context of efficient joint simulation over very large grids. In particular the re-purposing of graphic processing units (GPUs) to support extremely efficient parallel processing, and their application to matrix calculations, offers potential decreases in processing time of several orders of magnitude <xref ref-type="bibr" rid="pcbi.1000724-Buttari1">[64]</xref> for the current rate-limiting steps of the algorithms presented here: the population and factorisation of large covariance matrices.</p>
<p>The expansion of MBG in epidemiology has been rapid and led to major advances in the handling of uncertainty in disease risk maps. To date, fundamental computational constraints have precluded the use of such models for predictions of aggregated prevalence and populations at risk required by decision-makers across national and continental spatial scales. In this study we have designed, implemented and tested a new algorithm that overcomes the prohibitive computational barriers of large scale joint simulation allowing, for the first time, appropriate handling of aggregated uncertainty in global scale disease maps. This epidemiological insight has been extended to defining national populations at risk with appropriate confidence intervals which are released here in the public domain to support informed efforts in disease burden estimation.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000724.s001" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000724.s001" xlink:type="simple"><label>Protocol S1</label><caption>
<p>Populations at risk under different levels of <italic>Plasmodium falciparum</italic> malaria intensity.</p>
<p>(0.41 MB DOC)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>The data used in this paper were critically dependent on the contributions made by a large number of people in the malaria research and control communities and these individuals are listed on the MAP website (<ext-link ext-link-type="uri" xlink:href="http://www.map.ox.ac.uk/acknowledgements.html" xlink:type="simple">http://www.map.ox.ac.uk/acknowledgements.html</ext-link>). The authors thank Anja Bibby, Drs Archie Clements, David Smith, Andrew Tatem, Simon Brooker, and Abdisalan Noor and Professor Robert Snow for their helpful comments on earlier drafts of this manuscript. We thank three anonymous referees and an Associate Editor for their detailed reviews of an earlier version of this manuscript which have helped to refine the current paper. We are also grateful to Amazon Web Services for supporting our use of their Elastic Compute Cloud facility (URL: <ext-link ext-link-type="uri" xlink:href="http://aws.amazon.com/ec2" xlink:type="simple">http://aws.amazon.com/ec2</ext-link>).</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000724-Hay1"><label>1</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
<name name-style="western"><surname>Graham</surname><given-names>AJ</given-names></name>
<name name-style="western"><surname>Rogers</surname><given-names>DJ</given-names></name>
</person-group>             <year>2006</year>             <source>Global mapping of infectious diseases: methods, examples and emerging applications</source>             <publisher-loc>London</publisher-loc>             <publisher-name>Academic Press</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">446</size>           </element-citation></ref>
<ref id="pcbi.1000724-Hay2"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
<name name-style="western"><surname>Snow</surname><given-names>RW</given-names></name>
</person-group>             <year>2006</year>             <article-title>The Malaria Atlas Project: developing global maps of malaria risk.</article-title>             <source>PLoS Med</source>             <volume>3</volume>             <fpage>e473</fpage>          </element-citation></ref>
<ref id="pcbi.1000724-Snow1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Snow</surname><given-names>RW</given-names></name>
<name name-style="western"><surname>Marsh</surname><given-names>K</given-names></name>
<name name-style="western"><surname>LeSueur</surname><given-names>D</given-names></name>
</person-group>             <year>1996</year>             <article-title>The need for maps of transmission intensity to guide malaria control in Africa.</article-title>             <source>Parasitol Today</source>             <volume>12</volume>             <fpage>455</fpage>             <lpage>457</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Diggle1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Diggle</surname><given-names>PJ</given-names></name>
<name name-style="western"><surname>Tawn</surname><given-names>JA</given-names></name>
<name name-style="western"><surname>Moyeed</surname><given-names>RA</given-names></name>
</person-group>             <year>1998</year>             <article-title>Model-based geostatistics.</article-title>             <source>J Roy Stat Soc C-App</source>             <volume>47</volume>             <fpage>299</fpage>             <lpage>326</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Diggle2"><label>5</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Diggle</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Ribeiro</surname><given-names>PJ</given-names></name>
</person-group>             <year>2007</year>             <source>Model-based Geostatistics</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">228</size>           </element-citation></ref>
<ref id="pcbi.1000724-Hay3"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
<name name-style="western"><surname>Guerra</surname><given-names>CA</given-names></name>
<name name-style="western"><surname>Gething</surname><given-names>PW</given-names></name>
<name name-style="western"><surname>Patil</surname><given-names>AP</given-names></name>
<name name-style="western"><surname>Tatem</surname><given-names>AJ</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>A world malaria map: <italic>Plasmodium falciparum</italic> endemicity in 2007.</article-title>             <source>PLoS Med</source>             <volume>6</volume>             <fpage>e1000048</fpage>          </element-citation></ref>
<ref id="pcbi.1000724-Gosoniu1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gosoniu</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Vounatsou</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Sogoba</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>T</given-names></name>
</person-group>             <year>2006</year>             <article-title>Bayesian modelling of geostatistical malaria risk data.</article-title>             <source>Geospatial Health</source>             <volume>1</volume>             <fpage>127</fpage>             <lpage>139</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Diggle3"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Diggle</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Moyeed</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Rowlingson</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Thomson</surname><given-names>MC</given-names></name>
</person-group>             <year>2002</year>             <article-title>Childhood malaria in The Gambia: a case-study in model-based geostatistics.</article-title>             <source>J Roy Stat Soc C-App</source>             <volume>51</volume>             <fpage>493</fpage>             <lpage>506</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Gemperli1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gemperli</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Vounatsou</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Sogoba</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>T</given-names></name>
</person-group>             <year>2006</year>             <article-title>Malaria mapping using transmission models: application to survey data from Mali.</article-title>             <source>Am J Epidemiol</source>             <volume>163</volume>             <fpage>289</fpage>             <lpage>297</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Gosoniu2"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gosoniu</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Vounatsou</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Sogoba</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Maire</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>T</given-names></name>
</person-group>             <year>2009</year>             <article-title>Mapping malaria risk in West Africa using a Bayesian nonparametric non-stationary model.</article-title>             <source>Comput Stat Data An</source>             <volume>53</volume>             <fpage>3358</fpage>             <lpage>3371</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Gemperli2"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gemperli</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Sogoba</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Fondjo</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Mabaso</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Bagayoko</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Mapping malaria transmission in West and Central Africa.</article-title>             <source>Trop Med Int Health</source>             <volume>11</volume>             <fpage>1032</fpage>             <lpage>1046</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Noor1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Noor</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Clements</surname><given-names>ACA</given-names></name>
<name name-style="western"><surname>Gething</surname><given-names>PW</given-names></name>
<name name-style="western"><surname>Moloney</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Borle</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Spatial prediction of <italic>Plasmodium falciparum</italic> prevalence in Somalia.</article-title>             <source>Malaria J</source>             <volume>7</volume>             <fpage>159</fpage>          </element-citation></ref>
<ref id="pcbi.1000724-Raso1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Raso</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Vounatsou</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Singer</surname><given-names>BH</given-names></name>
<name name-style="western"><surname>N'Goran</surname><given-names>EK</given-names></name>
<name name-style="western"><surname>Tanner</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>An integrated approach for risk profiling and spatial prediction of <italic>Schistosoma mansoni</italic>-hookworm coinfection.</article-title>             <source>Proc Natl A Sci USA</source>             <volume>103</volume>             <fpage>6934</fpage>             <lpage>6939</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Clements1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Clements</surname><given-names>ACA</given-names></name>
<name name-style="western"><surname>Moyeed</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Brooker</surname><given-names>S</given-names></name>
</person-group>             <year>2006</year>             <article-title>Bayesian geostatistical prediction of the intensity of infection with <italic>Schistosoma mansoni</italic> in East Africa.</article-title>             <source>Parasitology</source>             <volume>133</volume>             <fpage>711</fpage>             <lpage>719</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-BeckWrner1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Beck-Wörner</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Raso</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Vounatsou</surname><given-names>P</given-names></name>
<name name-style="western"><surname>N'Goran</surname><given-names>EK</given-names></name>
<name name-style="western"><surname>Rigo</surname><given-names>G</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Bayesian spatial risk prediction of <italic>Schistosoma mansoni</italic> infection in western Côte d'Ivoire using a remotely-sensed digital elevation model.</article-title>             <source>Am J Trop Med Hyg</source>             <volume>76</volume>             <fpage>956</fpage>             <lpage>963</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Brooker1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brooker</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Clements</surname><given-names>ACA</given-names></name>
</person-group>             <year>2009</year>             <article-title>Spatial heterogeneity of parasite co-infection: determinants and geostatistical prediction at regional scales.</article-title>             <source>Int J Parasitol</source>             <volume>39</volume>             <fpage>591</fpage>             <lpage>597</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Diggle4"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Diggle</surname><given-names>PJ</given-names></name>
<name name-style="western"><surname>Thomson</surname><given-names>MC</given-names></name>
<name name-style="western"><surname>Christensen</surname><given-names>OF</given-names></name>
<name name-style="western"><surname>Rowlingson</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Obsomer</surname><given-names>V</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Spatial modelling and the prediction of <italic>Loa loa</italic> risk: decision making under uncertainty.</article-title>             <source>Ann Trop Med Parasitol</source>             <volume>101</volume>             <fpage>499</fpage>             <lpage>509</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Clements2"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Clements</surname><given-names>ACA</given-names></name>
<name name-style="western"><surname>Pfeiffer</surname><given-names>DU</given-names></name>
<name name-style="western"><surname>Martin</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Pittliglio</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Best</surname><given-names>N</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Spatial risk assessment of Rift Valley fever in Senegal.</article-title>             <source>Vector-Borne Zoonot</source>             <volume>7</volume>             <fpage>203</fpage>             <lpage>216</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Raso2"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Raso</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Matthys</surname><given-names>B</given-names></name>
<name name-style="western"><surname>N'Goran</surname><given-names>EK</given-names></name>
<name name-style="western"><surname>Tanner</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Vounatsou</surname><given-names>P</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>Spatial risk prediction and mapping of <italic>Schistosoma mansoni</italic> infections among schoolchildren living in western Cote d'Ivoire.</article-title>             <source>Parasitology</source>             <volume>131</volume>             <fpage>97</fpage>             <lpage>108</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Gething1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gething</surname><given-names>PW</given-names></name>
<name name-style="western"><surname>Noor</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Gikandi</surname><given-names>PW</given-names></name>
<name name-style="western"><surname>Ogara</surname><given-names>EAA</given-names></name>
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Improving imperfect data from health management information systems in Africa using space-time geostatistics.</article-title>             <source>PLoS Med</source>             <volume>3</volume>             <fpage>e271</fpage>          </element-citation></ref>
<ref id="pcbi.1000724-Luo1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Luo</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Taylor</surname><given-names>MC</given-names></name>
<name name-style="western"><surname>Parker</surname><given-names>SR</given-names></name>
</person-group>             <year>2007</year>             <article-title>A comparison of spatial interpolation methods to estimate continuous wind speed surfaces using irregularly distributed data from England and Wales.</article-title>             <source>Int J Climatol</source>             <volume>28</volume>             <fpage>947</fpage>             <lpage>959</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Eckstein1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Eckstein</surname><given-names>BA</given-names></name>
</person-group>             <year>1989</year>             <article-title>Evaluation of spline and weighted average interpolation algorithms.</article-title>             <source>Comput Geosci</source>             <volume>15</volume>             <fpage>79</fpage>             <lpage>94</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Cibulskis1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cibulskis</surname><given-names>RE</given-names></name>
<name name-style="western"><surname>Bell</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Christophel</surname><given-names>EM</given-names></name>
<name name-style="western"><surname>Hii</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Delacollette</surname><given-names>C</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Estimating trends in the burden of malaria at country level.</article-title>             <source>Am J Trop Med Hyg</source>             <volume>77</volume>             <fpage>133</fpage>             <lpage>137</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-W.H.O.1"><label>24</label><element-citation publication-type="other" xlink:type="simple">             <collab xlink:type="simple">W.H.O.</collab>             <year>2008</year>             <source>World malaria report 2008.WHO/HTM/GMP/2008.1</source>             <publisher-loc>Geneva</publisher-loc>             <publisher-name>World Health Organization</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">190</size>           </element-citation></ref>
<ref id="pcbi.1000724-Patil1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Patil</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Okiro</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Gething</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Guerra</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Sharma</surname><given-names>S</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Defining the relationship between <italic>Plasmodium falciparum</italic> parasite rate and clinical disease: statistical models for disease burden estimation.</article-title>             <source>Malaria J</source>             <volume>8</volume>          </element-citation></ref>
<ref id="pcbi.1000724-Goovaerts1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Goovaerts</surname><given-names>P</given-names></name>
</person-group>             <year>2001</year>             <article-title>Geostatistical modelling of uncertainty in soil science.</article-title>             <source>Geoderma</source>             <volume>103</volume>             <fpage>3</fpage>             <lpage>26</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Johansson1"><label>27</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Johansson</surname><given-names>EW</given-names></name>
<name name-style="western"><surname>Newby</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Renshaw</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Wardlaw</surname><given-names>T</given-names></name>
</person-group>             <year>2007</year>             <source>Malaria and children. Progress in intervention coverage</source>             <publisher-loc>New York, USA/Geneva, Switzerland</publisher-loc>             <publisher-name>United Nations Children's Fund (UNICEF)/The Roll Back Malaria Partnership (RBM)</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">69</size>           </element-citation></ref>
<ref id="pcbi.1000724-Snow2"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Snow</surname><given-names>RW</given-names></name>
<name name-style="western"><surname>Guerra</surname><given-names>CA</given-names></name>
<name name-style="western"><surname>Mutheu</surname><given-names>JJ</given-names></name>
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
</person-group>             <year>2008</year>             <article-title>International funding for malaria control in relation to populations at risk of stable <italic>Plasmodium falciparum</italic> transmission.</article-title>             <source>PLoS Med</source>             <volume>5</volume>             <fpage>e142</fpage>          </element-citation></ref>
<ref id="pcbi.1000724-Hay4"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
<name name-style="western"><surname>Guerra</surname><given-names>CA</given-names></name>
<name name-style="western"><surname>Tatem</surname><given-names>AJ</given-names></name>
<name name-style="western"><surname>Noor</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Snow</surname><given-names>RW</given-names></name>
</person-group>             <year>2004</year>             <article-title>The global distribution and population at risk of malaria: past, present, and future.</article-title>             <source>Lancet Infect Dis</source>             <volume>4</volume>             <fpage>327</fpage>             <lpage>473</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Martens1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Martens</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Kovats</surname><given-names>RS</given-names></name>
<name name-style="western"><surname>Nijhof</surname><given-names>S</given-names></name>
<name name-style="western"><surname>de Vries</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Livermore</surname><given-names>MTJ</given-names></name>
<etal/></person-group>             <year>1999</year>             <article-title>Climate change and future populations at risk of malaria.</article-title>             <source>Global Environ Chang</source>             <volume>9</volume>             <fpage>S89</fpage>             <lpage>S107</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Guerra1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Guerra</surname><given-names>CA</given-names></name>
<name name-style="western"><surname>Gikandi</surname><given-names>PW</given-names></name>
<name name-style="western"><surname>Tatem</surname><given-names>AJ</given-names></name>
<name name-style="western"><surname>Noor</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>DL</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>The limits and intensity of <italic>Plasmodium falciparum</italic> transmission: implications for malaria control and elimination worldwide.</article-title>             <source>PLoS Med</source>             <volume>5</volume>             <fpage>e38</fpage>          </element-citation></ref>
<ref id="pcbi.1000724-Hay5"><label>32</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
<name name-style="western"><surname>Guerra</surname><given-names>CA</given-names></name>
<name name-style="western"><surname>Snow</surname><given-names>RW</given-names></name>
</person-group>             <year>2004</year>             <article-title>Determination of country populations at malaria risk of different endemicities: report on agreement to perform work (APW) for WHO/Roll Back Malaria.</article-title>          </element-citation></ref>
<ref id="pcbi.1000724-Snow3"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Snow</surname><given-names>RW</given-names></name>
<name name-style="western"><surname>Guerra</surname><given-names>CA</given-names></name>
<name name-style="western"><surname>Noor</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Myint</surname><given-names>HY</given-names></name>
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
</person-group>             <year>2005</year>             <article-title>The global distribution of clinical episodes of <italic>Plasmodium falciparum</italic> malaria.</article-title>             <source>Nature</source>             <volume>434</volume>          </element-citation></ref>
<ref id="pcbi.1000724-Abrahamsen1"><label>34</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Abrahamsen</surname><given-names>P</given-names></name>
</person-group>             <year>1997</year>             <source>A review of Gaussian random fields and correlation functions</source>             <publisher-loc>Oslo</publisher-loc>             <publisher-name>Norwegian Computing Centre</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">64</size>           </element-citation></ref>
<ref id="pcbi.1000724-Williams1"><label>35</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Williams</surname><given-names>CKI</given-names></name>
</person-group>             <year>2002</year>             <article-title>Gaussian processes.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Arbib</surname><given-names>MA</given-names></name>
</person-group>             <source>The handbook of brain theory and neural networks</source>             <publisher-loc>Cambridge, MA</publisher-loc>             <publisher-name>The MIT Press</publisher-name>             <fpage>466</fpage>             <lpage>470</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-West1"><label>36</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>West</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Harrison</surname><given-names>J</given-names></name>
</person-group>             <year>1997</year>             <source>Bayesian forecasting and dynamic models</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">680</size>           </element-citation></ref>
<ref id="pcbi.1000724-Golub1"><label>37</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Golub</surname><given-names>GH</given-names></name>
<name name-style="western"><surname>Van Loan</surname><given-names>CF</given-names></name>
</person-group>             <year>1996</year>             <source>Matrix computations (Johns Hopkins studies in mathematical sciences)</source>             <publisher-loc>Baltimore</publisher-loc>             <publisher-name>The Johns Hopkins University Press</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">694</size>           </element-citation></ref>
<ref id="pcbi.1000724-Gneiting1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gneiting</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Sevcikova</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Percival</surname><given-names>DB</given-names></name>
<name name-style="western"><surname>Schlather</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Jiang</surname><given-names>YD</given-names></name>
</person-group>             <year>2006</year>             <article-title>Fast and exact simulation of large Gaussian lattice systems in R-2: Exploring the limits.</article-title>             <source>J Comput Graph Stat</source>             <volume>15</volume>             <fpage>483</fpage>             <lpage>501</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Goovaerts2"><label>39</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Goovaerts</surname><given-names>P</given-names></name>
</person-group>             <year>1997</year>             <source>Geostatistics for natural resource evaluation</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Oxford University Press</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">483</size>           </element-citation></ref>
<ref id="pcbi.1000724-Deutsch1"><label>40</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Deutsch</surname><given-names>CV</given-names></name>
<name name-style="western"><surname>Journel</surname><given-names>AG</given-names></name>
</person-group>             <year>1998</year>             <source>GSLIB: geostatistical software library and user's guide</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Oxford University Press</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">369</size>           </element-citation></ref>
<ref id="pcbi.1000724-Oz1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Oz</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Deutsch</surname><given-names>CV</given-names></name>
<name name-style="western"><surname>Tran</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Xie</surname><given-names>Y</given-names></name>
</person-group>             <year>2003</year>             <article-title>DSSIM-HR: A FORTRAN 90 program for direct sequential simulation with histogram reproduction.</article-title>             <source>Comput Geosci</source>             <volume>29</volume>             <fpage>39</fpage>             <lpage>51</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Journel1"><label>42</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Journel</surname><given-names>AG</given-names></name>
<name name-style="western"><surname>Huijbregts</surname><given-names>CJ</given-names></name>
</person-group>             <year>1978</year>             <source>Mining geostatistics</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Academic Press</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">600</size>           </element-citation></ref>
<ref id="pcbi.1000724-Gething2"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gething</surname><given-names>PW</given-names></name>
<name name-style="western"><surname>Noor</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Gikandi</surname><given-names>PW</given-names></name>
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
<name name-style="western"><surname>Nixon</surname><given-names>MS</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Developing geostatistical space-time models to predict outpatient treatment burdens from incomplete national data.</article-title>             <source>Geogr Anal</source>             <volume>40</volume>             <fpage>167</fpage>             <lpage>188</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Dietrich1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dietrich</surname><given-names>CR</given-names></name>
</person-group>             <year>1995</year>             <article-title>A simple and efficient space domain implementation of the turning bands method.</article-title>             <source>Water Resour Res</source>             <volume>31</volume>             <fpage>2861</fpage>             <lpage>2869</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Stein1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stein</surname><given-names>ML</given-names></name>
</person-group>             <year>2002</year>             <article-title>Fast and exact simulation of fractional Brownian surfaces.</article-title>             <source>J Comput Graph Stat</source>             <volume>11</volume>             <fpage>587</fpage>             <lpage>599</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Davis1"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Davis</surname><given-names>MW</given-names></name>
</person-group>             <year>1987</year>             <article-title>Production of conditional simulations via the lu triangular decomposition of the covariance-matrix.</article-title>             <source>Math Geol</source>             <volume>19</volume>             <fpage>91</fpage>             <lpage>98</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Mantoglou1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mantoglou</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Wilson</surname><given-names>JL</given-names></name>
</person-group>             <year>1982</year>             <article-title>The turning bands method for simulation of random-fields using line generation by a spectral method.</article-title>             <source>Water Resour Res</source>             <volume>18</volume>             <fpage>1379</fpage>             <lpage>1394</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Dietrich2"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dietrich</surname><given-names>CR</given-names></name>
<name name-style="western"><surname>Newsam</surname><given-names>GN</given-names></name>
</person-group>             <year>1993</year>             <article-title>A fast and exact method for multidimensional gaussian stochastic simulations.</article-title>             <source>Water Resour Res</source>             <volume>29</volume>             <fpage>2861</fpage>             <lpage>2869</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Chan1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chan</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Wood</surname><given-names>ATA</given-names></name>
</person-group>             <year>1997</year>             <article-title>An algorithm for simulating stationary Gaussian random fields.</article-title>             <source>J Roy Stat Soc C-App</source>             <volume>46</volume>             <fpage>171</fpage>             <lpage>181</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Dietrich3"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dietrich</surname><given-names>CR</given-names></name>
<name name-style="western"><surname>Newsam</surname><given-names>GN</given-names></name>
</person-group>             <year>1997</year>             <article-title>Fast and exact simulation of stationary Gaussian processes through circulant embedding of the covariance matrix.</article-title>             <source>SIAM J Sci Comput</source>             <volume>18</volume>             <fpage>1088</fpage>             <lpage>1107</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Stein2"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stein</surname><given-names>ML</given-names></name>
</person-group>             <year>2005</year>             <article-title>Space-time covariance functions.</article-title>             <source>J Am Stat Assoc</source>             <volume>100</volume>             <fpage>310</fpage>             <lpage>321</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-R1"><label>52</label><element-citation publication-type="other" xlink:type="simple">             <collab xlink:type="simple">R Development Core Team</collab>             <year>2008</year>             <article-title>R: a language and environment for statistical computing.</article-title>             <comment>Vienna, Austria: R Foundation for Statistical Computing, URL: <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org" xlink:type="simple">http://www.R-project.org</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000724-VanRossum1"><label>53</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Van Rossum</surname><given-names>G</given-names></name>
</person-group>             <year>2008</year>             <article-title>Python Programming Language - Official Website.</article-title>             <comment>Website: URL <ext-link ext-link-type="uri" xlink:href="http://www.python.org" xlink:type="simple">http://www.python.org</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000724-Balk1"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Balk</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>Deichmann</surname><given-names>U</given-names></name>
<name name-style="western"><surname>Yetman</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Pozzi</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Determining global population distribution: methods, applications and data.</article-title>             <source>Adv Parasitol</source>             <volume>62</volume>             <fpage>119</fpage>             <lpage>156</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Smith1"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smith</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
<name name-style="western"><surname>Noor</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Snow</surname><given-names>RW</given-names></name>
</person-group>             <year>2009</year>             <article-title>Predicting changing malaria risk after expanded insecticide-treated net coverage in Africa.</article-title>             <source>Trends Parasitol</source>             <volume>25</volume>             <fpage>511</fpage>             <lpage>516</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Hay6"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>Snow</surname><given-names>RW</given-names></name>
</person-group>             <year>2008</year>             <article-title>Measuring malaria endemicity from intense to interrupted transmission.</article-title>             <source>Lancet Infect Dis</source>             <volume>8</volume>             <fpage>369</fpage>             <lpage>378</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Smith2"><label>57</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smith</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
</person-group>             <year>2009</year>             <article-title>Endemicity response timelines for <italic>Plasmodium falciparum</italic> elimination.</article-title>             <source>Malaria J</source>             <volume>8</volume>             <fpage>87</fpage>          </element-citation></ref>
<ref id="pcbi.1000724-Smith3"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smith</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>McKenzie</surname><given-names>FE</given-names></name>
<name name-style="western"><surname>Snow</surname><given-names>RW</given-names></name>
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
</person-group>             <year>2007</year>             <article-title>Revisiting the basic reproductive number for malaria and its implications for malaria control.</article-title>             <source>PLoS Biol</source>             <volume>5</volume>             <fpage>e42</fpage>          </element-citation></ref>
<ref id="pcbi.1000724-Smith4"><label>59</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smith</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>Dushoff</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Snow</surname><given-names>RW</given-names></name>
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
</person-group>             <year>2005</year>             <article-title>The entomological inoculation rate and <italic>Plasmodium falciparum</italic> infection in African children.</article-title>             <source>Nature</source>             <volume>438</volume>             <fpage>492</fpage>             <lpage>495</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Smith5"><label>60</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smith</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>TA</given-names></name>
<name name-style="western"><surname>Hay</surname><given-names>SI</given-names></name>
</person-group>             <year>2009</year>             <article-title>Measuring malaria for elimination.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Feachem</surname><given-names>RGA</given-names></name>
<name name-style="western"><surname>Phillips</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>Targett</surname><given-names>GA</given-names></name>
</person-group>             <publisher-loc>San Fransisco</publisher-loc>             <publisher-name>The Global Health Group/UCSF Global Health Sciences</publisher-name>             <fpage>108</fpage>             <lpage>126</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Cressie1"><label>61</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cressie</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Verzelen</surname><given-names>N</given-names></name>
</person-group>             <year>2008</year>             <article-title>Conditional-mean least-squares fitting of Gaussian Markov random fields to Gaussian fields.</article-title>             <source>Comput Stat Data An</source>             <volume>52</volume>             <fpage>2794</fpage>             <lpage>2807</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Rue1"><label>62</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rue</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Martino</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Chopin</surname><given-names>N</given-names></name>
</person-group>             <year>2009</year>             <article-title>Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations.</article-title>             <source>J Roy Stat Soc B Met</source>             <volume>71</volume>             <fpage>319</fpage>             <lpage>392</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Rue2"><label>63</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rue</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Tjelmeland</surname><given-names>H</given-names></name>
</person-group>             <year>2002</year>             <article-title>Fitting Gaussian Markov random fields to Gaussian fields.</article-title>             <source>Scand J Stat</source>             <volume>29</volume>             <fpage>31</fpage>             <lpage>49</lpage>          </element-citation></ref>
<ref id="pcbi.1000724-Buttari1"><label>64</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Buttari</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Langou</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Kurzak</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Dongarra</surname><given-names>J</given-names></name>
</person-group>             <year>2009</year>             <article-title>A class of parallel tiled linear algebra algorithms for multicore architectures.</article-title>             <source>Parallel Comput</source>             <volume>35</volume>             <fpage>38</fpage>             <lpage>53</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>