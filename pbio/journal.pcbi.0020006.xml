<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="flc">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0020006</article-id><article-id pub-id-type="publisher-id">05-PLCB-RA-0215R2</article-id><article-id pub-id-type="sici">plcb-02-02-02</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Evolutionary Biology/Paleontology</subject><subject>Mathematics/Statistics</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>None</subject></subj-group></article-categories><title-group><article-title>Seriation in Paleontological Data Using Markov Chain Monte Carlo Methods</article-title><alt-title alt-title-type="running-head">Seriation using MCMC</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Puolamäki</surname><given-names>Kai</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Fortelius</surname><given-names>Mikael</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Mannila</surname><given-names>Heikki</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib></contrib-group><aff id="aff1">
				<label>1</label><addr-line> Laboratory of Computer and Information Science, Helsinki University of Technology, Espoo, Finland
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Department of Geology and Institute of Biotechnology, University of Helsinki, Helsinki, Finland
			</addr-line></aff><aff id="aff3">
				<label>3</label><addr-line> HIIT Basic Research Unit, University of Helsinki and Helsinki University of Technology, Helsinki, Finland
			</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Levin</surname><given-names>Simon</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Princeton University, United States of America</aff><author-notes><fn fn-type="con" id="ack1"><p>KP, MF, and HM conceived and designed the experiments. KP performed the experiments. KP, MF, and HM analyzed the data. KP, MF, and HM contributed reagents/materials/analysis tools. KP, MF, and HM wrote the paper.</p></fn><corresp id="cor1">* To whom correspondence shoud be addressed. E-mail: <email xlink:type="simple">Kai.Puolamaki@hut.fi</email></corresp><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>2</month><year>2006</year></pub-date><pub-date pub-type="epub"><day>10</day><month>2</month><year>2006</year></pub-date><volume>2</volume><issue>2</issue><elocation-id>e6</elocation-id><history><date date-type="received"><day>25</day><month>8</month><year>2005</year></date><date date-type="accepted"><day>20</day><month>12</month><year>2005</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2006</copyright-year><copyright-holder>Nabuurs et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Given a collection of fossil sites with data about the taxa that occur in each site, the task in biochronology is to find good estimates for the ages or ordering of sites. We describe a full probabilistic model for fossil data. The parameters of the model are natural: the ordering of the sites, the origination and extinction times for each taxon, and the probabilities of different types of errors. We show that the posterior distributions of these parameters can be estimated reliably by using Markov chain Monte Carlo techniques. The posterior distributions of the model parameters can be used to answer many different questions about the data, including seriation (finding the best ordering of the sites) and outlier detection. We demonstrate the usefulness of the model and estimation method on synthetic data and on real data on large late Cenozoic mammals. As an example, for the sites with large number of occurrences of common genera, our methods give orderings, whose correlation with geochronologic ages is 0.95.</p></abstract><abstract abstract-type="synopsis"><title>Synopsis</title><p>Seriation, the task of temporal ordering of fossil occurrences by numerical methods, and correlation, the task of determining temporal equivalence, are fundamental problems in paleontology. With the increasing use of large databases of fossil occurrences in paleontological research, the need is increasing for seriation methods that can be used on data with limited or disparate age information. This paper describes a simple probabilistic model of site ordering and taxon occurrences. As there can be several parameter settings that have about equally good fit with the data, the authors use the Bayesian approach and Markov chain Monte Carlo methods to obtain a sample of parameter values describing the data. As an example, the method is applied to a dataset on Cenozoic mammals. The orderings produced by the method agree well with the orderings of the sites with known geochronologic ages.</p></abstract><funding-group><funding-statement>This project was funded in part by the Academy of Finland.</funding-statement></funding-group><counts><page-count count="9"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>Citation:</meta-name><meta-value>Puolamäki K, Fortelius M, Mannila H (2006) Seriation in paleontological data using Markov chain Monte Carlo methods. PLoS Comput Biol 2(2): e6.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Seriation, the task of temporal ordering of fossil occurrences by numerical methods, and correlation, the task of determining temporal equivalence, are fundamental problems in paleontology. Fossils have been used for both tasks since the very beginnings of modern paleontology [<xref ref-type="bibr" rid="pcbi-0020006-b001">1</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b002">2</xref>]. However, the recent advent of large fossil databases [<xref ref-type="bibr" rid="pcbi-0020006-b003">3</xref>] and the increased emphasis on quantitative analysis of biological patterns in deep time (e.g., [<xref ref-type="bibr" rid="pcbi-0020006-b004">4</xref>–<xref ref-type="bibr" rid="pcbi-0020006-b007">7</xref>]) has to some extent changed both the nature and the primary purpose of these activities. The rules and procedures of conventional paleontological seriation (biostratigraphy) [<xref ref-type="bibr" rid="pcbi-0020006-b008">8</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b009">9</xref>] are not easy to apply in a satisfactory way to large datasets compiled from a wide variety of sources, often without associated data concerning the local distribution of fossil taxa in the rock sequences from which they derive. Conversely, occasional but valuable data regarding lithostratigraphic superposition, geochronologic age estimates, etc., are frequently available but difficult to apply in a global setting. The increasing use of large datasets in paleontological research implies a growing need for methods that do not only order the sites into a temporal sequence based on the distribution of taxon occurrences, but also can make use of a variety of other kinds of readily available stratigraphic information. This need is perhaps most acute in situations such as the continental record of the Eurasian Cenozoic (ca 23 million to 2 million years ago), where the majority of localities are from isolated quarries outside a rock-context and stratigraphic superposition therefore cannot be directly determined (e.g., [<xref ref-type="bibr" rid="pcbi-0020006-b010">10</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b011">11</xref>]).</p><p>In the past several decades, both seriation and correlation of fossil occurrences by numerical methods have in fact become practically feasible alternatives to conventional biostratigraphy. The computational solutions that have been developed for correlation and seriation have much in common, but the implementations differ depending on the purpose and the nature of the data (e.g., the CHRONOS [<xref ref-type="bibr" rid="pcbi-0020006-b012">12</xref>] and PAST [<xref ref-type="bibr" rid="pcbi-0020006-b013">13</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b014">14</xref>] initiatives; also see [<xref ref-type="bibr" rid="pcbi-0020006-b015">15</xref>]).</p><p>Here we are explicitly concerned with the task of seriation, for which methods based on several distinct approaches are available. These include the graph-theoretical unitary associations method by Guex et al. [<xref ref-type="bibr" rid="pcbi-0020006-b016">16</xref>–<xref ref-type="bibr" rid="pcbi-0020006-b018">18</xref>], parsimony analysis [<xref ref-type="bibr" rid="pcbi-0020006-b019">19</xref>–<xref ref-type="bibr" rid="pcbi-0020006-b022">22</xref>], and Bayesian methods [<xref ref-type="bibr" rid="pcbi-0020006-b023">23</xref>]. John Alroy [<xref ref-type="bibr" rid="pcbi-0020006-b005">5</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b024">24</xref>–<xref ref-type="bibr" rid="pcbi-0020006-b027">27</xref>] has developed and applied techniques based on estimating taxon ranges and maximizing the fit of these hypothesized ranges to independent stratigraphic information, including known stratigraphic superposition of localities. ([<xref ref-type="bibr" rid="pcbi-0020006-b005">5</xref>] gives the latest review of this approach.)</p><p>A fossil site (a collection of fossil remains collected from some location, typically in a sedimentary deposit) may be loosely regarded as a snapshot of the set of taxa that lived at a certain location at approximately the same time. Sites and their taxa may be described as an occurrence matrix, i.e., a 0–1 matrix, where the rows correspond to sites and the columns correspond to taxa: a one in entry (i,j) means that taxon j has been found at site i. The snapshot may capture a smaller or larger proportion of the taxa that were actually present, a smaller or larger area, and a shorter or longer time interval, and it may be biased in different ways. It is therefore clear that the ones and zeros in such a matrix are not all equal. Some presences will be weakly founded on single specimens, others on hundreds or thousands of specimens from many sites. Similarly, many absences will be nothing more than missing data, whereas absences in well-sampled sites may carry more meaning. These facts virtually call out for a probabilistic approach to the analysis of paleontological presence-absence data.</p><p>Here we describe a straightforward probabilistic model that contains parameters for the origination and extinction of taxa, for the ordering of the sites, and for the probabilities of errors (wrong zeros and wrong ones). Given the ordering of the sites, the origination and extinction parameters for a taxon specify the interval in which the taxon is assumed to be present. Any occurrence (a one in the matrix) of the taxon outside this interval is considered to be a false occurrence, and any nonoccurrence (a zero in the matrix) is considered to be a false occurrence as well. Given the parameters, the likelihood of the data depends on the number of false and true ones and zeros. The task we consider is to find parameter vectors that yield high likelihood, i.e., have a small number of false ones and zeros.</p><p>In more detail, our probabilistic model is as follows. Given a dataset with <italic>N</italic> sites and <italic>M</italic> taxa, we consider arbitrary orderings π of the sites. For each taxon <italic>m,</italic> we have the lifetime of the taxon, specified by the indices of the first and last occurrences <italic>a<sub>m</sub></italic> and <italic>b<sub>m</sub></italic> of taxon <italic>m</italic>. Additionally, we have parameters <italic>c</italic> for the probability of a false one (i.e., the presence of taxon <italic>m</italic> outside the bounds <italic>a<sub>m</sub></italic> and <italic>b<sub>m</sub></italic>) and <italic>d</italic> for the probability of a false zero (i.e., the absence of taxon <italic>m</italic> between the bounds <italic>a<sub>m</sub></italic> and <italic>b<sub>m</sub></italic>).</p><p>Denoting by θ the whole parameter vector (π, <overline><italic>a</italic></overline>, <overline><italic>b</italic></overline>, <italic>c</italic>, <italic>d</italic>), the likelihood of the data <italic>X</italic> has the form
				<disp-formula id="pcbi-0020006-e001"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>&alpha;</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mi>&beta;</mml:mi></mml:msup><mml:msup><mml:mi>d</mml:mi><mml:mi>&gamma;</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mi>&delta;</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where α is the number of false ones, β is the number of correct zeros, γ is the number of false zeros, and δ is the number of correct ones.
			</p><p>We could, in principle, find a parameter vector θ that maximizes the likelihood of the data (maximum likelihood solution). This parameter vector would give a total order for the fossil sites, implying a probability of zero or one for a site pre-dating another. However, we know that the data contain pairs of sites from the same time periods. We are interested in finding pairs of sites for which the seriation is uncertain, i.e., the probability of one site pre-dating another is close to one-half.</p><p>Therefore, we work in the Bayesian framework, and find a sample of parameter vectors where the probability of a vector is proportional to its posterior probability. To this end, we use the Markov chain Monte Carlo (MCMC) method [<xref ref-type="bibr" rid="pcbi-0020006-b028">28</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b029">29</xref>] to sample parameter combinations θ with probability proportional to their Bayesian posterior likelihood
				<disp-formula id="pcbi-0020006-e002"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&prop;</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where <italic>P</italic>(θ) is the prior probability of the parameters θ.
			</p><p>MCMC methods yield samples from the posterior distribution of the parameters, and this makes it possible to study the space of the parameters in many different ways. For example, we can determine, for each pair of sites, the probability that one precedes the other. We can also estimate for the probability of false zeros and false ones and find for a particular observation in the data the probability that it is a false zero or a false one.</p><p>A further useful property of the model is that it is easy to incorporate additional information. For example, the model allows us to freeze the ordering of certain sites. That is, if we know that site <italic>i</italic> is definitely older than site <italic>j</italic>, we can restrict the MCMC method to accept only permutations that satisfy this constraint.</p></sec><sec id="s2"><title>Results</title><sec id="s2a"><title>Generated Data</title><p>We first ran the experiment on synthetically generated data, with known “true” ordering and probabilities of false zeros and ones for varying numbers of sites and taxa, shown in <xref ref-type="table" rid="pcbi-0020006-t001">Table 1</xref>. The data were generated by forming <italic>N</italic> ordered sites and <italic>M</italic> taxa, assigning each taxon a lifespan (with median 0.18<italic>N</italic> sites) starting from a random position in the sitelist, and using the parameters <italic>c</italic> and <italic>d</italic> to produce false ones and false zeros.</p><table-wrap content-type="2col" id="pcbi-0020006-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020006.t001</object-id><label>Table 1</label><caption><p>Results for Artificially Generated Datasets</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="left" charoff="0" char=""/><col id="tb1col3" align="left" charoff="0" char=""/><col id="tb1col4" align="left" charoff="0" char=""/><col id="tb1col5" align="left" charoff="0" char=""/><col id="tb1col6" align="left" charoff="0" char=""/><col id="tb1col7" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/><italic>N</italic></td><td><hr/><italic>M</italic></td><td><hr/><italic>c</italic></td><td><hr/><italic>d</italic></td><td><hr/><italic>E</italic>&lcub;<italic>c</italic>&rcub;</td><td><hr/><italic>E</italic>&lcub;<italic>d</italic>&rcub;</td><td><hr/><italic>E</italic>&lcub;|corr(&pi;)|&rcub;</td></tr></thead><tbody><tr><td>100</td><td>100</td><td>0.003</td><td>0.2</td><td>0.0036</td><td>0.2042</td><td>0.9982</td></tr><tr><td>100</td><td>100</td><td>0.003</td><td>0.5</td><td>0.0029</td><td>0.5207</td><td>0.8775</td></tr><tr><td>100</td><td>100</td><td>0.03</td><td>0.2</td><td>0.0289</td><td>0.2172</td><td>0.9924</td></tr><tr><td>100</td><td>100</td><td>0.03</td><td>0.5</td><td>0.0320</td><td>0.4944</td><td>0.8164</td></tr><tr><td>500</td><td>100</td><td>0.003</td><td>0.2</td><td>0.0039</td><td>0.2052</td><td>0.9283</td></tr><tr><td>500</td><td>100</td><td>0.003</td><td>0.5</td><td>0.0031</td><td>0.4978</td><td>0.9398</td></tr><tr><td>500</td><td>100</td><td>0.03</td><td>0.2</td><td>0.0326</td><td>0.2095</td><td>0.9279</td></tr><tr><td>500</td><td>100</td><td>0.03</td><td>0.5</td><td>0.0317</td><td>0.5099</td><td>0.8629</td></tr><tr><td>300</td><td>200</td><td>0.003</td><td>0.2</td><td>0.0035</td><td>0.2032</td><td>0.9998</td></tr><tr><td>300</td><td>200</td><td>0.003</td><td>0.5</td><td>0.0033</td><td>0.4967</td><td>0.9942</td></tr><tr><td>300</td><td>200</td><td>0.03</td><td>0.2</td><td>0.0316</td><td>0.2032</td><td>0.9520</td></tr><tr><td>300</td><td>200</td><td>0.03</td><td>0.5</td><td>0.0307</td><td>0.5030</td><td>0.8837</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt101"><p>The median lifespan (<italic>b</italic>&thinsp;&minus;&thinsp;<italic>a</italic>) of taxa is 0.18&thinsp;&times;&thinsp;<italic>N</italic> sites.</p></fn><fn id="nt102"><p><italic>N</italic>, number of sites (<italic>N</italic>); <italic>M</italic>, number of taxa (<italic>M</italic>); <italic>c</italic>, probability of false one; <italic>d</italic>, probability of false zero; <italic>E&lcub;c&rcub;</italic>, the expected probability of false one; <italic>E&lcub;d&rcub;</italic>, the expected probability of false zero; <italic>E</italic>&lcub;|corr(&pi;)|&rcub;, the correlation with the original order.</p></fn></table-wrap-foot> --></table-wrap><p>The results on synthetic data show that the method quite accurately determines the parameters of the model: the expected values of <italic>d</italic> obtained from the MCMC simulation are close to the ones used in generating the data. The correlations between the original order and the MCMC orderings are also quite high; note that for high values of <italic>c</italic> and <italic>d</italic> it can be the case that some orderings different from the generating one fit the data better than the generating ordering.</p></sec><sec id="s2b"><title>Cenozoic Large Land Mammal Data</title><p>In MCMC simulations, different runs can converge to separate regions in the parameter space. This is indeed what happens with the datasets on genera of Cenozoic large land mammals. We ran 100 MCMC chains over the datasets, and computed the variance in negative log-likelihood within the first chain, and then included all chains with the expected negative log-likelihood within one sigma of the best chain to our analysis.</p><p>The results are summarized in <xref ref-type="table" rid="pcbi-0020006-t002">Table 2</xref>. The results show that the probability of a false one is quite low, whereas the probability of a false zero varies from 0.5 to 0.77, with the highest probabilities in the datasets where sites or genera with smaller occurrence frequencies are included. The correlation with the Mammal Neogene (MN) ordering and database age are also high.</p><table-wrap content-type="1col" id="pcbi-0020006-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020006.t002</object-id><label>Table 2</label><caption><p>Results on the Large Mammal Dataset</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.t002" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb2col1" align="char" charoff="0" char="."/><col id="tb2col2" align="char" charoff="0" char="."/><col id="tb2col3" align="left" charoff="0" char=""/><col id="tb2col4" align="left" charoff="0" char=""/><col id="tb2col5" align="left" charoff="0" char=""/><col id="tb2col6" align="left" charoff="0" char=""/><col id="tb2col7" align="left" charoff="0" char=""/><col id="tb2col8" align="left" charoff="0" char=""/><col id="tb2col9" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/><italic>n<sub>t</sub></italic></td><td><hr/><italic>n<sub>s</sub></italic></td><td><hr/><italic>N</italic></td><td><hr/><italic>M</italic></td><td><hr/>Chains</td><td><hr/><italic>E&lcub;c&rcub;</italic></td><td><hr/><italic>E&lcub;d&rcub;</italic></td><td><hr/>CORRMN</td><td><hr/>CORRDB</td></tr></thead><tbody><tr><td>10</td><td>10</td><td>124</td><td>139</td><td>8</td><td>0.0113</td><td>0.518</td><td>0.951</td><td>&minus;0.946</td></tr><tr><td>5</td><td>5</td><td>273</td><td>202</td><td>2</td><td>0.0068</td><td>0.661</td><td>0.925</td><td>&minus;0.912</td></tr><tr><td>10</td><td>2</td><td>501</td><td>139</td><td>2</td><td>0.0093</td><td>0.686</td><td>0.704</td><td>&minus;0.654</td></tr><tr><td>2</td><td>2</td><td>526</td><td>296</td><td>4</td><td>0.0033</td><td>0.768</td><td>0.717</td><td>&minus;0.674</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt201"><p><italic>n<sub>t</sub></italic>, the minimum number of occurrences of a genus; <italic>n<sub>s</sub></italic>, the minimum number of occurrences of genera per site; <italic>N</italic>, the number of sites; <italic>M</italic>, the number of taxa; Chains, the number of chains with likelihood within one standard deviation from the highest likelihood in 100 experiments; <italic>E&lcub;c&rcub;</italic>, the expected probability of false one; <italic>E&lcub;d&rcub;</italic>, the expected probability of false zero; CORRMN&thinsp;&equals;&thinsp;<italic>E</italic>&lcub;corr(&pi;,<italic>MN</italic>)&rcub;, correlation between the predicted order and MN classification; CORRDB&thinsp;&equals;&thinsp;<italic>E</italic>&lcub;corr(&pi;,<italic>DBAGE</italic>)&rcub;, correlation between the predicted order and database age.</p></fn></table-wrap-foot> --></table-wrap><p>The probability that a site <italic>i</italic> occurs before site <italic>j</italic> can be estimated simply by counting in how many of the samples <italic>i</italic> precedes <italic>j</italic> in the ordering π. The results are shown in <xref ref-type="fig" rid="pcbi-0020006-g001">Figure 1</xref>. The ordering of the sites is in general quite well determined, but for some blocks of observations the ordering seems to be not fixed. Note that if two sites have exactly the same taxa, then the probability <italic>P</italic>(π(<italic>i</italic>) &lt; π( <italic>j</italic>)) will be 0.5.</p><fig id="pcbi-0020006-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020006.g001</object-id><label>Figure 1</label><caption><title>The Pair-Order Matrix <italic>O<sub>ij</sub> = P</italic>(π(<italic>i</italic>) &lt; π(<italic>j</italic>)) between Sites for Dataset <italic>n<sub>t</sub></italic> = 10, <italic>n<sub>s</sub></italic> = 10 from the Eight Chains with the Best Likelihood</title><p>Black denotes probability one, and white denotes probability zero. For most pairs, the probability is close to zero or one, but some blocks of observations have many different orderings with high probability.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.g001" xlink:type="simple"/></fig><p>The pair-order matrices for all 100 chains are shown on our Web site (<ext-link ext-link-type="uri" xlink:href="http://www.cis.hut.fi/projects/patdis/paleo" xlink:type="simple">http://www.cis.hut.fi/projects/patdis/paleo</ext-link>). The chains outside the highest likelihood typically contain blocks of sites whose orders have been reversed; the MCMC method is fairly sensitive to initialization, and therefore running several chains with different initializations is useful.</p><p>For the dataset specified by <italic>n<sub>t</sub></italic> = 10 and <italic>n<sub>s</sub></italic> = 10, the original data are shown in <xref ref-type="fig" rid="pcbi-0020006-g002">Figure 2</xref>A. The probability of a genus being alive at site <italic>m</italic> is shown in <xref ref-type="fig" rid="pcbi-0020006-g002">Figure 2</xref>B. <xref ref-type="fig" rid="pcbi-0020006-g002">Figure 2</xref>C shows for each one in the data the probability that it is a false one, i.e., that it falls outside the interval (<italic>a<sub>m</sub></italic>, <italic>b<sub>m</sub></italic>). We note that certain observations are quite strongly assumed to be false ones. The list of the strongest false ones is given on our Web site. Examination of the list shows that some of the observations that the model considers false ones are probably real errors in the data, while others represent true outliers or pertain to genera with unusual species or genera with artificially truncated distributions, as discussed below.</p><fig id="pcbi-0020006-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020006.g002</object-id><label>Figure 2</label><caption><title>The Data Matrix for the Dataset with <italic>n<sub>t</sub></italic> = 10 and <italic>n<sub>s</sub></italic> = 10</title><p>The sites have been ordered by <italic>E</italic>{π(<italic>n</italic>)} and the genera by <italic>E</italic>{<italic>a<sub>m</sub></italic>} (top). Probability that genus <italic>m</italic> is alive on site <italic>n</italic> in the dataset specified by <italic>n<sub>t</sub></italic> = 10 and <italic>n<sub>s</sub></italic> = 10 (middle). Probability that one is false (bottom). Black color denotes probability of one, and white probability of zero.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.g002" xlink:type="simple"/></fig><p>We further verified the detection of false zeros and ones by preparing two datasets, based on data parametrized by <italic>n<sub>t</sub></italic> = 10 and <italic>n<sub>s</sub></italic> = 10. For the first set, we selected 100 random ones, and flipped them to zero (false zeros). For the second set, we randomly selected 100 zeros, and changed them to ones (false ones). We then performed the analysis, and computed median probability for all zeros to be alive in the first dataset and median probability for all ones to be alive in the second datasets. The probabilities corresponding to 92 of 100 added false zeros was below the median, and 88 of 100 added false ones were above median. The differences are statistically significant when compared to the null hypothesis that the false zeros or ones are equally likely to end up above or below the median (Fisher Sign Test). The median probability that the (site,genus) pair an inserted false one is alive is 0.004, and the median probability that an inserted false zero is alive is 0.92.</p><p>We also tested a model where each taxon has its own <italic>c</italic> and <italic>d</italic> parameters for false one and false zero. The results of the MCMC runs were almost identical to the ones obtained for the model with one <italic>c</italic> and one <italic>d</italic> parameter (unpublished data).</p></sec></sec><sec id="s3"><title>Discussion</title><p>We have described a probabilistic model for paleontological data and shown that MCMC methods can be used to obtain samples from the posterior distribution of the parameters. The parameters of the model have a natural interpretation, and the hard sites enable us to insert existing prior knowledge of the ordering in a natural way.</p><p>The task of finding the optimal ordering, or knowing for certain that a given ordering is optimal, is a very difficult problem. MCMC methods have the advantage of being able to explore various parts of the parameter space, but the issue of guaranteeing convergence of the sampling is always present in these methods. We have solved the problem of convergence by sampling 100 chains in parallel, and taking into account only the chains having the best log-likelihood. We have also checked that the pair-order matrices predicted by these best chains are consistent with each other. This way, we can state with reasonable confidence that our results are indeed an accurate description of the posterior distribution of the model. We also tested the method by adding false zeros and ones to the data randomly, and checking that they were identified correctly.</p><p>The results show that for generated data the method is able to reconstruct orderings and locate outliers with excellent accuracy. For the data on large late Cenozoic mammals, the results indicate a high level of agreement with existing orderings and correctly capture the basic feature of paleontological data that false absences are likely to be common and false presences rare.</p><p>For the past 40 years the main stratigraphic framework for the study of the Cenozoic land mammals from Europe has been the MN system [<xref ref-type="bibr" rid="pcbi-0020006-b030">30</xref>–<xref ref-type="bibr" rid="pcbi-0020006-b033">33</xref>]. The MN system rests on a complicated base of taxon appearances and associations that has been interpreted somewhat differently by different practitioners [<xref ref-type="bibr" rid="pcbi-0020006-b033">33</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b034">34</xref>], who nevertheless usually agree on the MN assignment of most sites and virtually always agree on the sequence of MN reference localities. The probability pattern seen in <xref ref-type="fig" rid="pcbi-0020006-g001">Figure 1</xref> is susceptible to a straightforward paleontological interpretation based on the ages assigned to them within the MN system and a general framework of climate change during the interval studied [<xref ref-type="bibr" rid="pcbi-0020006-b035">35</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b036">36</xref>]. Starting from the lower left, the sites up to number 50 contain a sequence from the beginning of the Miocene at about 23 million years ago to the main faunal turnover event known in western Europe during this interval, the “Vallesian Crisis,” at about 10 million years ago. Sites 51–63 represent mostly the first million years of post-crisis time, while the large block between sites 63 and 99 represents the relatively stable latest Miocene from 8 million to 5 million years ago, known as the Turolian. A major faunal turnover event separates the Turolian from the Pliocene sites 100–117, and sites 118–124 represent the beginning of the last epoch of the Cenozoic, the Pleistocene. Of the two blocks of localities that the model cannot order well internally, the first and largest thus corresponds to an interval during which little change happened in the mammal faunas. In contrast, the second block, spanning the later Pliocene and the early Pleistocene, corresponds to a time of rapid climatic and faunal change, characterized by the increasingly prominent alternation of cold and warm intervals and, especially in Europe, the cyclic alternation of their attendant “cold” and “warm” mammal assemblages. As emphasized by [<xref ref-type="bibr" rid="pcbi-0020006-b037">37</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b038">38</xref>], standard biochronology based on taxon ranges breaks down under conditions of cyclic change. The same is obviously true for our model, which assumes genus ranges to be continuous. However, the lack of resolution in this case can also be explained by the simple fact that all included localities are of very similar age, in particular since our data are at the genus level. It remains to be seen to what extent species-level data might resolve such blocks.</p><p>The structure just described is also evident in the patterns of <xref ref-type="fig" rid="pcbi-0020006-g002">Figure 2</xref>, where the observed and estimated taxon ranges of the ordered localities trace a pattern of three major faunal units separated by events where many genera go extinct and new, long-lived genera appear. Most marked of these is the turnover event associated with the Miocene–Pliocene transition at 5 million years ago, while the establishment of the two earlier faunal blocks appears more gradual. <xref ref-type="fig" rid="pcbi-0020006-g002">Figure 2</xref> suggests that the model is especially skeptical of the early occurrences of genera, especially when their record is spotty, as for <italic>Tapirus</italic> (genus number 117 on the lower right).</p><p>Most genus occurrences considered by the model to be false are either genuine outliers in time and/or space or actual data errors. For example, of the ten cases at the head of the list for the <italic>n<sub>t</sub></italic> = 10, <italic>n<sub>s</sub></italic> = 10 dataset, <italic>Plioviverrops</italic> at Laugnac, <italic>Thalassictis</italic> at Wintershof-West, <italic>Anancus</italic> at Concud, and Dorn Dürkheim are true early occurrences, <italic>Pliohyrax</italic> at Pasalar and <italic>Orycteropus</italic> at Çandir are isolated early European occurrences of a genus of African origin, <italic>Canis</italic> at Concud is a similar occurrence of a genus dispersing from North America, <italic>Plesiogulo</italic> at Pasalar is a misidentification from a published preliminary list, while <italic>Stephanorhinus</italic> at Belometchetskaya and <italic>Amphicyon</italic> at Stavropol are probable curatorial errors in the NOW database.</p><p>Some apparent false occurrences reflect the biology of the animal in question. For example, the genus <italic>Tapirus</italic>, noted above for its spotty record, occurs eight times in the first 50 rows of probable errors. Several carnivore genera are also examples of genuinely rare but long-lived lineages, e.g., <italic>Martes, Plesiogulo,</italic> and <italic>Mustela</italic>. It thus appears that the model is a powerful tool to detect not only possible errors in the data but also genera with unusual distributional or ecological characteristics. This suggests that the method could also be of value for the study of the evolutionary dynamics of fossil communities [<xref ref-type="bibr" rid="pcbi-0020006-b039">39</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b040">40</xref>]. It should be also noted that while the method is powerful and the results are useful, they should still be interpreted by an expert.</p><p>In [<xref ref-type="bibr" rid="pcbi-0020006-b023">23</xref>], Halekoh and Vach considered an analogous problem in archeology: reconstruction of relative chronology of graves, based on the absence or presence information of finds. They construct a probabilistic model, similar in spirit to ours, but having more nuisance parameters. For example, where the appearance distribution of finds is unimodal and find-specific, i.e., the probability of false zero varies depending on the site and find. They solve the model with an MCMC algorithm, heavily tuned to address the convergence problems, and analyze the resulting modalities in detail. We solve the convergence problem by inserting strong prior information in terms of the hard sites (and fixing the direction of time), optimizing the sampling rules, and analyzing the results from 100 independent runs.</p><p>Like Alroy's [<xref ref-type="bibr" rid="pcbi-0020006-b005">5</xref>] method, our model uses relative time, and ignores information about taphonomic regimes, sizes of collections, and biochronology; see [<xref ref-type="bibr" rid="pcbi-0020006-b005">5</xref>] for further discussion. Computationally, Alroy's model has a likelihood function that is based on looking at the probability of not observing a conjunction (co-occurrence) of two taxa. For each taxon <italic>i</italic>, the model uses an individual parameter <italic>κ<sub>i</sub></italic> (called the crypsis parameter), which corresponds to our Lazarus probability <italic>c</italic>. The probability that taxa <italic>i</italic> and <italic>j</italic> are not observed together in any site is in Alroy's model <inline-formula id="pcbi-0020006-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020006.ex001" xlink:type="simple"/></inline-formula>
				, where <italic>e</italic> is the number of sites for which the life spans of taxa <italic>i</italic> and <italic>j</italic> overlap and <italic>d</italic> is a parameter that typically is one. The taxon-specific probabilities of false ones and zeros can also be built into our model; the code available on our Web site provides for this. As mentioned, in the experiments this modification did not significantly change the results on real data. An interesting extension to the model would be to allow for temporal intervals for the sites.
			</p><p>One major difference between Alroy's model and ours is that we use MCMC methods to obtain a sample of the possible parameter values instead of looking for the maximum likelihood solution. This provides additional information about the robustness of the estimates. In particular, we tested our model by randomly adding false zeros and ones, and found that they were identified correctly.</p></sec><sec id="s4"><title>Materials and Methods</title><sec id="s4a"><title>The probabilistic model.</title><p>Formally, the <italic>dataset</italic> has <italic>N</italic> sites and <italic>M</italic> taxa, which are described with a 0–1 matrix <italic>X<sub>nm</sub></italic>,where <italic>n</italic> ∈ {1,…,<italic>N</italic>} and <italic>m</italic> ∈ {1,…,<italic>M</italic>}. <italic>X<sub>nm</sub></italic> = 1 signifies that remains of taxon <italic>m</italic> have been found from site <italic>n</italic>, while <italic>X<sub>nm</sub></italic> = 0 means that no such discovery has been made. In the following, we describe in detail a probabilistic model that we propose has <italic>generated</italic> this dataset.</p><p>First, we assume that the sites appear in some temporal order, denoted by <italic>permutation</italic> π:{1,…,<italic>N</italic>}→{1,…,<italic>N</italic>}. We say that the site <italic>i</italic> is older than site <italic>j</italic>, if π(<italic>i</italic>) &lt; π(<italic>j</italic>).</p><p>We further assume that there exists an ordering for all pairs of sites, i.e., for all <italic>i</italic> ≠ <italic>j</italic> we have either π(<italic>i</italic>) &lt; π(<italic>j</italic>) or π(<italic>j</italic>) &lt; π(<italic>i</italic>). Strictly speaking, this assumption is not always true. We may have two sites <italic>i</italic> and <italic>j</italic> that actually appeared more or less simultaneously. Should this be the case, our probabilistic model should predict <italic>P</italic>(π(<italic>i</italic>) &lt; π(<italic> j</italic>)) ≈ <italic>P</italic>(π( <italic>j</italic>) &lt; π(<italic>i</italic>)) ≈ 0.5; i.e., the probability of site <italic>i</italic> pre-dating site <italic>j</italic> should be about the same as site <italic>j</italic> pre-dating site <italic>i</italic>. We indeed find such sets of sites from our dataset.</p><p>We could take all <italic>N</italic>! permutations to be a priori equally likely. However, we know from various reasons outside of the dataset that some sites are, beyond any reasonable doubt, older than others. It would be foolish not to take this strong prior information into account when constructing the model. Formally, we introduce a set of pairs of sites, <italic>hard orderings,</italic> <italic>H</italic> = {(<italic>h</italic><sub><italic>i</italic>1</sub>, <italic>h</italic><sub><italic>h</italic>2</sub>)}<sub><italic>i</italic>∈{1, … , <italic>N<sub>H</sub></italic>}</sub>, order of which is known, i.e., π(<italic>h</italic><sub><italic>i</italic>1</sub>) &lt; π(<italic>h</italic><sub><italic>i</italic>2</sub>). We denote by Π<italic><sub>H</sub></italic> a set of permutations that satisfy this order,</p><disp-formula id="pcbi-0020006-e003"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>&Pi;</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo>&lcub;</mml:mo> <mml:mrow><mml:mi>&pi;</mml:mi><mml:mo>|</mml:mo><mml:mi>&pi;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>&pi;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mtext>&thinsp;</mml:mtext><mml:mtext>for</mml:mtext><mml:mtext>&thinsp;</mml:mtext><mml:mtext>all</mml:mtext><mml:mtext>&thinsp;</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo>&!isin;</mml:mo><mml:mi>H</mml:mi></mml:mrow> <mml:mo>&rcub;</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula><p>We assume that a priori all permutations in Π<italic><sub>H</sub></italic> are equally likely, and that permutations not appearing in Π<italic><sub>H</sub></italic> have a zero prior probability. The hard orderings make it possible to include existing information on the ordering of the sites into the model.</p><p>One should note that without hard ordering, i.e., when <italic>H</italic> is an empty set, our model is symmetric with respect to the time reversal. As a result, without hard orderings the posterior probability that site <italic>i</italic> pre-dates site <italic>j</italic> is always 0.5, making the pairwise time orderings of sites meaningless. Introducing hard orderings breaks this symmetry, after which the pairwise time orderings become non-trivial and meaningful. It should be noted that while the pairwise time ordering probability, <italic>P</italic>(π(<italic>i</italic>) &lt; π(<italic>j</italic>)) = 0.5, is trivial without hard orderings, we could still get a meaningful measures of higher-order quantities, e.g., for the probability that the age of site <italic>j</italic> is between the ages of sites <italic>i</italic> and <italic>k</italic>, i.e., <italic>P</italic>(π(<italic>i</italic>) &lt; π(<italic>j</italic>) &lt; π(<italic>k</italic>) or π(<italic>k</italic>) &lt; π(<italic>j</italic>) &lt; π(<italic>i</italic>)).</p><p>One of the most basic properties of the taxa is that they originate and then go extinct at some later time. Therefore, for each taxon <italic>m</italic> we propose two parameters: the first signifying a site during which the taxon was first alive, <italic>a<sub>m</sub></italic> ∈ [1, <italic>N</italic> + 1], and a site during which the taxon was first extinct, <italic>b<sub>m</sub></italic> ∈ [1, <italic>N</italic> + 1]. We say that taxon <italic>m</italic> is <italic>alive</italic> on site <italic>n</italic> if <italic>a<sub>m</sub></italic> ≤ π(<italic>n</italic>) &lt; <italic>b<sub>m</sub></italic>. Otherwise, the taxon is <italic>dead</italic>. We make the reasonable assumption that the taxa do not go extinct before they originate, i.e., <italic>a<sub>m</sub></italic> ≤ <italic>b<sub>m</sub></italic>. All pairs (<italic>a<sub>m</sub></italic>, <italic>b<sub>m</sub></italic>) satisfying this condition are a priori equally likely. <italic>a<sub>m</sub></italic> = <italic>b<sub>m</sub></italic> means the taxon <italic>m</italic> is not alive at any of the sites.</p><p>If our observations would be perfect, i.e., we would find samples of taxon if and only if it were alive (there would, e.g., be no Lasarus events), our time-ordered observation matrix <italic>Y</italic>, where <italic>Y</italic><sub>π(<italic>n</italic>)<italic>m</italic></sub> = <italic>X<sub>nm</sub></italic>, would consist of streaks of ones, signifying the presence of taxon (<italic>Y<sub>tm</sub></italic> = 1 if <italic>a<sub>m</sub></italic> ≤ <italic>Y<sub>tm</sub></italic> &lt; <italic>b<sub>m</sub></italic>, <italic>Y<sub>tm</sub></italic> = 0 otherwise). However, the observations are not perfect. Sometimes a taxon <italic>m</italic> is misidentified at site <italic>n</italic>, which may lead to false observation <italic>X<sub>nm</sub></italic> = 1 even though the taxon should be dead at that particular site. On the other hand, it may happen for various reasons that taxon is not found from a particular site even though the taxon is alive, which will lead to false zero, <italic>X<sub>nm</sub></italic> = 0.</p><p>We account for the imperfect observations by introducing two probabilities, the probability of false zero, <italic>c</italic> (we observe <italic>X<sub>nm</sub></italic> = 1 even if the taxon is dead); and the probability of false zero, <italic>d</italic> (we observe <italic>X<sub>nm</sub></italic> = 0 even if the taxon is alive). We assume log-uniform priors for <italic>c</italic> and <italic>d</italic> in the intervals 0.001 ≤ <italic>c</italic> ≤ 0.1 and 0.1 ≤ <italic>d</italic> ≤ 0.8, respectively. Summarizing, the parameters and priors of our model are given in <xref ref-type="table" rid="pcbi-0020006-t003">Table 3</xref>. We denote all parameters collectively with
					<disp-formula id="pcbi-0020006-e004"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>&theta;</mml:mi><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>&pi;</mml:mi><mml:mo>,</mml:mo><mml:mover accent='true'><mml:mi>a</mml:mi><mml:mo stretchy='true'>&macr;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent='true'><mml:mi>b</mml:mi><mml:mo stretchy='true'>&macr;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula>We also denote the prior of all parameters collectively by
					<disp-formula id="pcbi-0020006-e005"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&pi;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&Pi;</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mrow> <mml:mo>&lsqb;</mml:mo> <mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow> <mml:mo>&lsqb;</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula>Given the parameters, we can finally specify the likelihood of the data,
					<disp-formula id="pcbi-0020006-e006"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e006" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>&alpha;</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mi>&beta;</mml:mi></mml:msup><mml:msup><mml:mi>d</mml:mi><mml:mi>&gamma;</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mi>&delta;</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where α = ∑<sub><italic>n</italic>,<italic>m</italic></sub> (1 − <italic>e<sub>nm</sub></italic>)<italic>X<sub>nm</sub></italic> is the number of false ones, β = ∑<sub><italic>n</italic>,<italic>m</italic></sub> (1 − <italic>e<sub>nm</sub></italic>) (1 − <italic>X<sub>nm</sub></italic>) is the number of correct zeros, γ = ∑<sub><italic>n</italic>,<italic>m</italic></sub> <italic>e<sub>nm</sub></italic>(1 − <italic>X<sub>nm</sub></italic>) is the number of false zeros, and δ = ∑<sub><italic>n</italic>,<italic>m</italic></sub> <italic>e<sub>nm</sub>X<sub>nm</sub></italic> is the number of correct ones, where we have used auxiliary Boolean parameter <italic>e<sub>nm</sub></italic> to signify that the taxon is alive, i.e.,
				</p><table-wrap content-type="1col" id="pcbi-0020006-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020006.t003</object-id><label>Table 3</label><caption><p>Parameters of Our Model, with Prior Distributions</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.t003" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb3col1" align="left" charoff="0" char=""/><col id="tb3col2" align="left" charoff="0" char=""/><col id="tb3col3" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Parameter Type</td><td><hr/>Notation</td><td><hr/>Prior</td></tr></thead><tbody><tr><td>Permutation</td><td>&pi;</td><td><italic>P</italic>(&pi;)&thinsp;&equals;&thinsp;|&Pi;<italic><sub>H</sub></italic>|&thinsp;<sup>&minus;&thinsp;1</sup> , &pi;&thinsp;&isin;&thinsp;&Pi;<italic><sub>H</sub></italic></td></tr><tr><td>Time interval</td><td>&lsqb;<italic>a<sub>m</sub></italic>,<italic>b<sub>m</sub></italic>&rsqb;</td><td><italic>P</italic>(&lsqb;<italic>a<sub>m</sub></italic>,<italic>b<sub>m</sub></italic>&rsqb;)&thinsp;&equals;&thinsp;(&frac12;(<italic>N</italic>&thinsp;&plus;&thinsp;1)(<italic>N</italic>&thinsp;&plus;&thinsp;2))&thinsp;<sup>&minus;&thinsp;1</sup>, <italic>a<sub>m</sub></italic>&thinsp;&le;&thinsp;<italic>b<sub>m</sub></italic></td></tr><tr><td>Probability of false one</td><td><italic>c</italic></td><td><italic>P</italic>(log<italic>c</italic>)&thinsp;&equals;&thinsp;Uniform(log0.001;log0.1)</td></tr><tr><td>Probability of false zero</td><td><italic>d</italic></td><td><italic>P</italic>(log<italic>d</italic>)&thinsp;&equals;&thinsp;Uniform(log0.1;log0.8)</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt301"><p>We denote all parameters collectively by &theta; &equals; (&pi;,<overline><italic>a</italic></overline>,<overline><italic>b</italic></overline>,<italic>c</italic>,<italic>d</italic>). We denote the prior of all parameters collectively by <italic>P</italic>(&theta;) &equals; <italic>P</italic>(&pi;)(&Pi;<sub><italic>m</italic>&equals;1</sub><sup><italic>M</italic></sup><italic>P</italic>(&lsqb;<italic>a</italic><sub><italic>m</italic></sub>,<italic>b</italic><sub><italic>m</italic></sub>&rsqb;))<italic>P</italic>(<italic>c</italic>)<italic>P</italic>(<italic>d</italic>).</p></fn></table-wrap-foot> --></table-wrap><disp-formula id="pcbi-0020006-e007"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e007" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy="true">&lcub;</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mtext>&thinsp;</mml:mtext><mml:mtext>&thinsp;</mml:mtext><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&le;</mml:mo><mml:mi>&pi;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> </mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula></sec><sec id="s4b"><title>Dataset.</title><p>We used a dataset of European late Cenozoic large land mammals derived from the NOW database (<ext-link ext-link-type="uri" xlink:href="http://www.helsinki.fi/science/now" xlink:type="simple">http://www.helsinki.fi/science/now</ext-link>) on 17 July 2003. We restricted the dataset to the Eurasian continent and islands in the Mediterranean Sea, excluding localities with greater than 60 degrees eastern longitude. We also restricted the dataset to the large mammal orders Primates, Creodonta, Carnivora, Perissodactyla, Artiodactyla, Proboscidea, Hyracoidea, and Tubulidentata. We considered three different kinds of age: database age, MN age, and geochronologic age. The MN system [<xref ref-type="bibr" rid="pcbi-0020006-b030">30</xref>–<xref ref-type="bibr" rid="pcbi-0020006-b033">33</xref>] is a classification of late Cenozoic into 18 classes.</p><p>For each locality, we calculated a database age as the mean of the minimum and maximum ages given in the original downloaded file. By MN age, we refer to the mean of the temporal boundaries of MN units according to the correlations given in [<xref ref-type="bibr" rid="pcbi-0020006-b011">11</xref>]. This is given only for the subset of localities assigned in the database to a single MN unit or an interval expressed in MN units. For the MN 9 type locality Can Llobateres, we entered a regular MN 9 age in addition to the magnetostratigraphic age provided in the original NOW dataset. We also compiled a new age variable by copying all geochronologic (radiometric or magnetostratigraphic) age data in the original dataset to a separate variable. This new variable, referred to here as geochronologic age, was augmented by data taken from Appendix 2.1 of [<xref ref-type="bibr" rid="pcbi-0020006-b011">11</xref>] (the main chronology used in the NOW dataset) and from recent updates for a set of Greek localities [<xref ref-type="bibr" rid="pcbi-0020006-b041">41</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b042">42</xref>]. The dataset is available on our Web site (<ext-link ext-link-type="uri" xlink:href="http://www.cis.hut.fi/projects/patdis/paleo" xlink:type="simple">http://www.cis.hut.fi/projects/patdis/paleo</ext-link>).</p><p>We selected further data subsets as follows. First we selected the genera that occurred in at least <italic>n<sub>t</sub></italic> in the original dataset; then we selected the sites in which at least <italic>n<sub>s</sub></italic> such genera had been observed. We used the combinations (<italic>n<sub>t</sub></italic>, <italic>n<sub>s</sub></italic>) = (10,10), (5,5), (2,10) and (2,2). Note that, e.g., in the dataset with <italic>n<sub>t</sub></italic> = 10 and <italic>n<sub>s</sub></italic> = 10 several genera occur less than 10 times, as the selection on the number of genera is done first and then the sites are pruned.</p><p>We use the hard orderings of the sites, given by the MN reference sites,</p><p>π(Paulhiac)&lt;             π(MontaiguleBlin)&lt;</p><p>π(Laugnac)&lt;             π(WintershofWest)&lt;</p><p>π(LaRomieu)&lt;            π(Pontlevoy)&lt;</p><p>π(Sansan)&lt;             π(LaGriveM)&lt;</p><p>π(Can Llobateres I)&lt;           π(Masía del Barbo)&lt;</p><p>π(Crevillante 2)&lt;           π(Los Mansuetos)&lt;</p><p>π(Arquillo)&lt;              π(Perpignan)&lt;</p><p>π(Villafranca d′Asti (Arondelli))&lt;     π(Saint Vallier)</p><p>Notice that all reference sites do not appear in all of the datasets, e.g., the dataset for <italic>n<sub>t</sub></italic> = 10 and <italic>n<sub>s</sub></italic> = 10 contains 11 of the 16 hard sites.</p></sec><sec id="s4c"><title>The MCMC method.</title><p>Given the likelihood of Equation 6 and the prior of Equation 5, we can obtain the <italic>posterior distribution</italic> of the model parameters by applying the Bayes rule,
					<disp-formula id="pcbi-0020006-e008"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e008" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where the normalization factor is given by <italic>Z<sub>X</sub></italic> = ∫ <italic>P</italic>(<italic>X</italic>|θ)<italic>P</italic>(θ)<italic>d</italic>θ.
				</p><p>We are interested in computing various interesting expectation values from the parameter distribution. If we know the posterior distribution, we can compute the expectations from integrand</p><disp-formula id="pcbi-0020006-e009"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e009" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>&lcub;</mml:mo> <mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow> <mml:mo>&rcub;</mml:mo></mml:mrow><mml:mo>&equals;</mml:mo><mml:mo>&int;</mml:mo><mml:mi>d</mml:mi><mml:mi>&theta;</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula><p>However, the analytic solution or integration of the posterior distribution is infeasible. Instead of solving the integral of Equation 9 directly, we use numerical integration, namely the MCMC method.</p><p>The MCMC algorithm allows us to draw samples from the posterior distribution, without the need for actually solving the Bayes equation. The MCMC algorithm gives us <italic>T</italic> samples of the parameters θ<sup><italic>t</italic></sup>, <italic>t</italic> ∈ {, … , <italic>T</italic>}, that satisfy <italic>θ<sup>t</sup></italic> ~ <italic>P</italic>(<italic>θ</italic>|<italic>X</italic>) at the limit of large <italic>T</italic>. Given the samples, we can then approximate the integral of Equation 9 by</p><disp-formula id="pcbi-0020006-e010"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e010" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>&lcub;</mml:mo> <mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow> <mml:mo>&rcub;</mml:mo></mml:mrow><mml:mo>&ap;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mi>f</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msup><mml:mi>&theta;</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy='false'>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula><p>The Markov chain in the name of the MCMC algorithm comes from the fact that a posterior sample is a stochastic function of the previous posterior sample and the data, <italic>θ<sup>t+1</sup></italic> ~ <italic>g</italic>(<italic>θ<sup>t</sup></italic>, <italic>X</italic>). Thus, the MCMC samples form a <italic>chain</italic> in parameter space: θ<sup>1</sup>, θ<sup>2</sup>, …, θ<sup>T</sup>. The consecutive samples in the chain are not independent. If the chain is too short (<italic>T</italic> is small), one chain can effectively cover only a small fraction of the full probability mass.</p><p>We first initialize each chain with random values, as follows:</p><p>Initial permutation is drawn from the prior, π<sup>1</sup> ~ <italic>P</italic>(π). The initial ordering of the sites is thus totally random, with the restriction that the “hard” orderings given by the set Π<italic><sub>H</sub></italic> are enforced.</p><p>The initial intervals are set to smallest intervals that have no false ones <inline-formula id="pcbi-0020006-ex002"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020006.ex002" xlink:type="simple"/></inline-formula>
					, given the initial permutation π<sup>1</sup>.
				</p><p>The probabilities of false ones and zeros are initialized to <italic>c</italic><sup>1</sup> = 0.01 and <italic>d</italic><sup>1</sup> = 0.3.</p><p>After the initialization, we run the chain for the <italic>T<sub>B</sub></italic> = 10,000 step <italic>burn-in period</italic>. The posterior samples drawn during the burn-in period are ignored. The purpose of the burn-in period is to initialize the chain and to bring it to the area of large probability mass in the posterior distribution. We use the final state of the burn-in period, θ<italic><sup>T<sub>B</sub></sup></italic> to initialize the actual chain that we use to calculate the expectations. We run the chain for <italic>T′</italic> = 10,000 iterations and save every tenth sample, resulting in <italic>T</italic> = 1,000 samples per chain. We then use these stored samples to calculate the desired expectations.</p><p>In MCMC methods, the question of convergence always arises. The parameter space may have areas of large probability mass that are separate in the sense that it is very unlikely that a chain jumps from one of these regions to another. It is possible that a chain ends up in these regions, resulting in inaccurate expectations due to the fact that the integration effectively takes only a small subset of the posterior mass into account. Indeed, efficient sampling of the full parameter space is in a general case a very difficult problem. The problems of finding the maximum likelihood solution for these types of problems are typically NP-hard [<xref ref-type="bibr" rid="pcbi-0020006-b043">43</xref>,<xref ref-type="bibr" rid="pcbi-0020006-b044">44</xref>]. Therefore, the best we can do is to build our algorithm so that the chains of large probability mass can be identified with a reasonable confidence (see [<xref ref-type="bibr" rid="pcbi-0020006-b029">29</xref>] for review of convergence criteria).</p><p>We proceed in two steps: first, we run 100 chains in parallel, and compute the expected log-likelihood, <italic>E</italic>{<italic>logP</italic>(<italic>X</italic>|θ)}, of the data for each of the chains. We then compute the standard deviation of the log-likelihoods of the chains and then use only the chains with the expected log-likelihood within one standard deviation of the best chain into account. For example, with the dataset with <italic>n<sub>t</sub></italic> = 10 and <italic>n<sub>s</sub></italic> = 10 we end up selecting eight of the original 100 chains.</p><p>If the predictions given by the chains having the high log-likelihood are consistent with each other, we can conclude that the chains have converged well and that the results are reliable. However, if the predictions given by chains would differ, we could conclude that the chains have converged to separate regions in the parameter space and we also get an estimate for the error due to bad convergence.</p><p>Specifically, assume that we analyze <italic>K</italic> chains, each with unique initialization and <italic>T</italic> samples <inline-formula id="pcbi-0020006-ex003"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020006.ex003" xlink:type="simple"/></inline-formula>
					, after the burn-in period. The individual chains produce expectation of a function <italic>f</italic>(θ) of the parameters θ
					<disp-formula id="pcbi-0020006-e011"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e011" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>F</mml:mi><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>&lcub;</mml:mo> <mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow> <mml:mo>&rcub;</mml:mo></mml:mrow><mml:mo>&ap;</mml:mo><mml:msub><mml:mstyle displaystyle='true'><mml:mover accent='true'><mml:mi>F</mml:mi><mml:mo>&circ;</mml:mo></mml:mover></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mi>f</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msubsup><mml:mi>&theta;</mml:mi><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy='false'>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula>The expectation given by all <italic>K</italic> chains is given by
				</p><disp-formula id="pcbi-0020006-e012"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e012" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>F</mml:mi><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>&lcub;</mml:mo> <mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow> <mml:mo>&rcub;</mml:mo></mml:mrow><mml:mo>&ap;</mml:mo><mml:mover accent='true'><mml:mi>F</mml:mi><mml:mo>&circ;</mml:mo></mml:mover><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:msub><mml:mover accent='true'><mml:mi>F</mml:mi><mml:mo>&circ;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula><p>If the expectations <italic>F̂<sub>k</sub></italic> produced by individual chains are similar (using some suitable distance measure <italic>d</italic><sup>2</sup>) to the combined result, <italic>F̂</italic>, i.e., <italic>d</italic><sup>2</sup>(<italic>F̂<sub>k</sub></italic>, <italic>F̂</italic>) is small for all <italic>k</italic>, then we can have some confidence on the approximation <italic>F̂</italic> of the expectation <italic>F</italic>. Indeed, the distance measure <italic>d</italic><sup>2</sup>(<italic>F̂<sub>k</sub></italic>, <italic>F̂</italic>) gives an approximation of the error of the prediction <italic>F̂</italic> to the true expectation <italic>F</italic>, <italic>d</italic><sup>2</sup>(<italic>F</italic>,<italic>F̂</italic>).</p><p>We use the expectations of pair-order probabilities and their Hellinger divergences as <italic>d</italic><sup>2</sup> to measure the similarity of the chains (see below).</p><p>The actual sampling rules are given below. In our implementation run of one chain over the dataset with <italic>n<sub>t</sub></italic> = 10 and <italic>n<sub>s</sub></italic> = 10 (<italic>N</italic> = 124, <italic>M</italic> = 139), we used 10,000 burn-in iterations and equal number of actual sampling iterations. One run takes about 8 min on a low-end desktop (Mac mini with a 1.42 GHz G4 processor). Our C implementation is available for download from our Web site at <ext-link ext-link-type="uri" xlink:href="http://www.cis.hut.fi/projects/patdis/paleo" xlink:type="simple">http://www.cis.hut.fi/projects/patdis/paleo</ext-link>. The time and memory requirements of one sampling iteration scale linearly with the size of the data matrix, the time and memory usage being <italic>O</italic>(<italic>NM</italic>).</p></sec><sec id="s4d"><title>Sampling rules.</title><p>In this section, we describe the details of the sampling methods we have used. We use <italic>Y</italic> to denote the time-ordered matrix of observations, <italic>Y</italic><sub>π(<italic>i</italic>)<italic>j</italic></sub> = <italic>X<sub>ij</sub></italic>; and π<sup>−1</sup> to denote inverse permutation, defined by π <sup>−1</sup>(π(<italic>i</italic>)) = <italic>i</italic>.</p></sec><sec id="s4e"><title>Permutations.</title><p>The permutation of order, π, is most difficult to sample efficiently. To compensate for this difficulty, we have constructed four sampling iterations for the permutations, which we iterate five times for each MCMC step.</p><p>The first sampling method consists of moving site <italic>n</italic> from time π(<italic>n</italic>) to a new time <italic>i</italic>, simultaneously moving all sites and interval limits accordingly. We first define the following auxiliary methods, TOYOUNGER and TOOLDER:</p><p>TOYOUNGER(<italic>i</italic>, <italic>j</italic>):</p><p>Let <italic>aux</italic> ← π(<italic>i</italic>).</p><p>For <italic>k</italic> in <italic>i</italic>,…,<italic>j</italic> − 1:</p><p>Let π(<italic>k</italic>) ← π(<italic>k</italic> + 1).</p><p>Let π(<italic>j</italic>) ← <italic>aux</italic>.</p><p>Let <italic>a<sub>m</sub></italic> ← <italic>a<sub>m</sub></italic> − 1 for all <italic>a<sub>m</sub></italic> ∈ ]<italic>i</italic>,<italic>j</italic> + 1].</p><p>Let <italic>b<sub>m</sub></italic> ← <italic>b<sub>m</sub></italic> − 1 for all <italic>b<sub>m</sub></italic> ∈ ]<italic>i</italic>,<italic>j</italic> + 1].</p><p>TOOLDER(<italic>i</italic>, <italic>j</italic>):</p><p>Let <italic>aux</italic> ← π(<italic>j</italic>).</p><p>For <italic>k</italic> in <italic>j</italic>,…,<italic>i</italic> + 1:</p><p>Let π(<italic>k</italic>) ← π(<italic>k</italic> − 1).</p><p>Let π(<italic>i</italic>) ← <italic>aux</italic>.</p><p>Let <italic>a<sub>m</sub></italic> ← <italic>a<sub>m</sub></italic> + 1 for all <italic>a<sub>m</sub></italic> ∈ [<italic>i</italic>,<italic>j</italic> + 1[.</p><p>Let <italic>b<sub>m</sub></italic> ← <italic>b<sub>m</sub></italic> + 1 for all <italic>b<sub>m</sub></italic> ∈ [<italic>i</italic>,<italic>j</italic> + 1[.</p><p>The actual MCMC step consists of moving a site <italic>n</italic> with time index <italic>i</italic> = π(<italic>n</italic>) to time index <italic>j</italic>, simultaneously shifting all intervening sites and limits by one accordingly:</p><p>MOVEONESITE(<italic>i</italic>, <italic>j</italic>):</p><p>If <italic>i</italic> &lt; <italic>j</italic>:</p><p>TOYOUNGER(<italic>i</italic>, <italic>j</italic>)</p><p>Else if <italic>j</italic> &lt; <italic>i</italic>:</p><p>TOOLDER(<italic>j</italic>, <italic>i</italic>)</p><p>The sample is then taken by first selecting a random pair of indices, <italic>i</italic> and <italic>j</italic>, and then excuting the step MOVEONESITE(<italic>i</italic>, <italic>j</italic>) with Metropolis-Hastings probability (“SAMPLEPI1”).</p><p>The second part of sampling of π consists of selecting an interval [<italic>i</italic>,<italic>j</italic>[, and reversing the order of sites within the interval. In pseudocode, the transformation reads, where we have used π<sup>−1</sup>(<italic>i</italic>:<italic>j</italic>) to denote a vector of site indices, π<sup>−1</sup>(<italic>i</italic>:<italic>j</italic>) = (π<sup>−1</sup>(<italic>i</italic>),…,π<sup>−1</sup>(<italic>j</italic>)), and reverse(□) to denote the reverse of vector □.</p><p>REVERSE1(<italic>i</italic>, <italic>j</italic>, <italic>B</italic>):</p><p>Let π<sup>−1</sup>(<italic>i</italic>:<italic>j</italic>) ← reverse(π<sup>− 1</sup>(<italic>i</italic>:<italic>j</italic>)).</p><p>Let <italic>a<sub>m</sub></italic> ← <italic>i</italic> + <italic>j</italic> + 1 − <italic>a<sub>m</sub></italic> for all <italic>a<sub>m</sub></italic> ∈ <italic>B</italic>.</p><p>Let <italic>b<sub>m</sub></italic> ← <italic>i</italic> + <italic>j</italic> + 1 − <italic>b<sub>m</sub></italic> for all <italic>b<sub>m</sub></italic> ∈ <italic>B</italic>.</p><p>Swap <italic>a<sub>m</sub></italic> and <italic>b<sub>m</sub></italic>, if <italic>a<sub>m</sub></italic> ∈ <italic>B</italic> and <italic>b<sub>m</sub></italic> ∈ <italic>B</italic>.</p><p>The sample is then taken by first selecting a random interval <italic>i</italic>,<italic>j</italic> ∈ {1,…,<italic>N</italic> + 1}, <italic>i</italic> &lt; <italic>j</italic> and by selecting randomly one of the following sets: <italic>B</italic> = [<italic>i</italic>,<italic>j</italic> + 1[, <italic>B</italic> = [<italic>i</italic>,<italic>j</italic> + 1], <italic>B</italic> = ]<italic>i</italic>,<italic>j</italic> + 1[, <italic>B</italic> = ]<italic>i</italic>,<italic>j</italic> + 1]. The step REVERSE1(<italic>i</italic>, <italic>j</italic>, <italic>B</italic>) is then executed with the Metropolis-Hastings probability and denoted by “SAMPLEPI2”.</p><p>The third sampling rule for π, REVERSE2(<italic>i</italic>, <italic>j</italic>, <italic>B</italic>), is similar to REVERSE1, with the exception that only the order of non-hard sites is reversed, denoted by “SAMPLEPI3”. The hard sites are left untouched.</p><p>The fourth sampling rule consists of swapping neighboring sites, i.e.,</p><p>REVERSE1(<italic>i</italic>, <italic>i</italic> + 1), denoted by “SAMPLEPI4”.</p></sec><sec id="s4f"><title>Other parameters.</title><p>After sampling for the permutation, we proceed to sample the parameters <italic>c</italic> (probability of false one) and <italic>d</italic> (probability of false zero). This sampling is done with the aid of the Metropolis-Hastings algorithm. We propose an update to log<italic>c</italic> by sampling the proposal from the normal distribution, log<italic>c′</italic> ~ <italic>N</italic>(log<italic>c</italic>,0.15). We accept the proposal with the Metropolis-Hastings probability <italic>min</italic>(1,<italic>P</italic>(<italic>X</italic>|θ′)/<italic>P</italic>(<italic>X</italic>|θ)), where θ denotes the original parameters and θ′ the proposed parameters—in this case, the parameters with a new value of <italic>c</italic>. The sampling for the probability of false zero, <italic>d</italic>, proceeds analogously.</p><p>To sample for the parameters <italic>a<sub>m</sub></italic> (site where the taxon is first alive), for each <italic>m</italic> ∈ {1,…,<italic>M</italic>}, we calculate the relative likelihood of the data for all <italic>a<sub>m</sub></italic> ∈ [0,<italic>b<sub>m</sub></italic>]. This calculation can be done efficiently in <italic>O</italic>(<italic>N</italic>) steps. We then normalize these likelihoods to unity and sample new <italic>a<sub>m</sub></italic> from Multinomial(<italic>p</italic>;<italic>b<sub>m</sub></italic> + 1). The sampling for <italic>b<sub>m</sub></italic> proceeds analogously.</p><p>Summarizing, one sampling iteration consists of one sampling of <italic>c</italic>, <italic>d</italic>, <overline><italic>a</italic></overline>, <overline><italic>b</italic></overline> and SAMPLEPI4; and five iterations of SAMPLEPI1, SAMPLEPI2, and SAMPLEPI3. The actual sampling consists of 10,000 of these iterations, of which every tenth sample is stored for use in analysis. The C-implementation of the sampling program is available for download at <ext-link ext-link-type="uri" xlink:href="http://www.cis.hut.fi/projects/patdis/paleo" xlink:type="simple">http://www.cis.hut.fi/projects/patdis/paleo</ext-link>.</p></sec><sec id="s4g"><title>Experimental setup.</title><p>We can visualize a MCMC chain with a <italic>pair-order matrix,</italic> defined by
					<disp-formula id="pcbi-0020006-e013"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e013" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msubsup><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>&pi;</mml:mi><mml:msubsup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>&pi;</mml:mi><mml:msubsup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&ap;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:msub><mml:mo>&lcub;</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>&pi;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>&pi;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&rcub;</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where the indices <italic>i</italic> and <italic>j</italic> denote sites, <italic>k</italic> a particular chain and <italic>b</italic>(□) is a boolean function that equals one when □ is satisfied, and zero otherwise. Thus <inline-formula id="pcbi-0020006-ex004"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020006.ex004" xlink:type="simple"/></inline-formula>
					 equals the probability that the site <italic>i</italic> pre-dates the site <italic>j</italic>. Furthermore, the pair-order matrix satisfies <inline-formula id="pcbi-0020006-ex005"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020006.ex005" xlink:type="simple"/></inline-formula>
					. We can also compare two chains by defining a distance measure using the averaged Hellinger divergences [<xref ref-type="bibr" rid="pcbi-0020006-b045">45</xref>] over two pair-order matrices, i.e.,
					<disp-formula id="pcbi-0020006-e014"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020006.e014" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&ne;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy='true'>(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>&minus;</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow><mml:mo stretchy='true'>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where <inline-formula id="pcbi-0020006-ex006"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020006.ex006" xlink:type="simple"/></inline-formula>
					. The distance measure satisfies <italic>d</italic><sup>2</sup>(<italic>k</italic><sub>1</sub>, <italic>k</italic><sub>2</sub>) ∈ [0, 1] and it is equal to zero only if the pair-order matrices are equal. The average Hellinger distance between the pair-order matrices of the eight chains used in the analysis of the dataset with <italic>n<sub>t</sub></italic> = 10 and <italic>n<sub>s</sub></italic> = 10 is 0.010.
				</p></sec></sec></body><back><ack><p>We thank three anonymous referees for detailed and constructive comments that improved the manuscript significantly.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>MCMC</term><def><p>Markov chain Monte Carlo</p></def></def-item><def-item><term>MN</term><def><p>Mammal Neogene</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0020006-b001"><label>1</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>W</given-names></name></person-group>
					<year>1816</year>
					<source>Strata identified by organized fossils, containing prints on colored paper of the most characteristic specimens in each stratum</source>
					<publisher-loc>London</publisher-loc>
					<publisher-name>W</publisher-name>
					<comment>Arding.</comment>
				</element-citation></ref><ref id="pcbi-0020006-b002"><label>2</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lyell</surname><given-names>C</given-names></name></person-group>
					<year>1833</year>
					<source>Principles of geology, volume 3</source>
					<publisher-loc>London</publisher-loc>
					<publisher-name>John Murray</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">398</size>
					<comment>p.</comment>
				</element-citation></ref><ref id="pcbi-0020006-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Schiermeier</surname><given-names>Q</given-names></name></person-group>
					<year>2003</year>
					<article-title>Paleobiology: Setting the record straight.</article-title>
					<source>Nature</source>
					<volume>424</volume>
					<fpage>482</fpage>
					<lpage>483</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Erwin</surname><given-names>DH</given-names></name><name name-style="western"><surname>Wing</surname><given-names>SL</given-names></name></person-group>
					<year>2000</year>
					<article-title>Deep time—Paleobiology's perspective.</article-title>
					<source>Paleobiology (Suppl)</source>
					<volume>26</volume>
					<fpage>1</fpage>
					<lpage>371</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Alroy</surname><given-names>J</given-names></name></person-group>
					<year>2000</year>
					<article-title>New methods for quantifying macroevolutionary patterns and processes.</article-title>
					<source>Paleobiology</source>
					<volume>26</volume>
					<fpage>707</fpage>
					<lpage>733</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Alroy</surname><given-names>J</given-names></name></person-group>
					<year>1998</year>
					<article-title>Diachrony of mammalian appearance events: Implications for biochronology.</article-title>
					<source>Geology</source>
					<volume>26</volume>
					<fpage>23</fpage>
					<lpage>26</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jablonski</surname><given-names>D</given-names></name><name name-style="western"><surname>Roy</surname><given-names>K</given-names></name><name name-style="western"><surname>Valentine</surname><given-names>JW</given-names></name><name name-style="western"><surname>Price</surname><given-names>RM</given-names></name><name name-style="western"><surname>Anderson</surname><given-names>PS</given-names></name></person-group>
					<year>2003</year>
					<article-title>The impact of the pull of the recent on the history of marine diversity.</article-title>
					<source>Science</source>
					<volume>300</volume>
					<fpage>1133</fpage>
					<lpage>1135</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b008"><label>8</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hedberg</surname><given-names>HD</given-names></name></person-group>
					<year>1976</year>
					<source>International stratigraphic guide. A guide to stratigraphic classification, terminology and procedure</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>John Wiley and Sons</publisher-name>
					<comment>International Subcommittee on Stratigraphic Classification, IUGS Commission on Stratigraphy. 200 p.</comment>
				</element-citation></ref><ref id="pcbi-0020006-b009"><label>9</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Woodburne</surname><given-names>MO</given-names></name></person-group>
					<year>2004</year>
					<source>Late Cretaceous and Cenozoic mammals of North America: Biostratigraphy and geochronology</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Columbia University Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">376</size>
					<comment>p.</comment>
				</element-citation></ref><ref id="pcbi-0020006-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lindsay</surname><given-names>NG</given-names></name><name name-style="western"><surname>Haselock</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Harris</surname><given-names>AL</given-names></name></person-group>
					<year>1989</year>
					<article-title>The extent of Grampian orogenic activity in the Scottish Highlands.</article-title>
					<source>J Geol Soc London</source>
					<volume>146</volume>
					<fpage>733</fpage>
					<lpage>735</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b011"><label>11</label><element-citation publication-type="other" xlink:type="simple">
					<collab xlink:type="simple">Steininger FF, Berggren WA, Kent DV, Bernor RL, Sen S, et al.</collab>
					<year>1996</year>
					<article-title>Circum-Mediterranean neogene (Miocene and Pliocene) marine-continental chronologic correlations of European mammal units.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Bernor</surname><given-names>RL</given-names></name><name name-style="western"><surname>Fahlbusch</surname><given-names>V</given-names></name><name name-style="western"><surname>Mittmann</surname><given-names>HW</given-names></name></person-group>
					<source>The evolution of western Eurasian Neogene mammal faunas</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Columbia University Press</publisher-name>
					<comment>pp.</comment>
					<fpage>7</fpage>
					<lpage>46</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b012"><label>12</label><element-citation publication-type="other" xlink:type="simple">
					<collab xlink:type="simple">CHRONOS</collab>
					<year>2005</year>
					<source>Tool development</source>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://chronos.org/resources/tools.html" xlink:type="simple">http://chronos.org/resources/tools.html</ext-link>. Accessed 6 January 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020006-b013"><label>13</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hammer</surname><given-names>Ø</given-names></name><name name-style="western"><surname>Harper</surname><given-names>DAT</given-names></name><name name-style="western"><surname>Ryan</surname><given-names>PD</given-names></name></person-group>
					<year>2005</year>
					<publisher-loc>PAST</publisher-loc>
					<publisher-name>PAlaeontological STatistics</publisher-name>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://folk.uio.no/ohammer/past" xlink:type="simple">http://folk.uio.no/ohammer/past</ext-link>. Accessed 6 January 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020006-b014"><label>14</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hammer</surname><given-names>Ø</given-names></name><name name-style="western"><surname>Harper</surname><given-names>DAT</given-names></name></person-group>
					<year>2005</year>
					<source>Paleontological data analysis</source>
					<publisher-loc>Malden (Massachusetts)</publisher-loc>
					<publisher-name>Blackwell</publisher-name>
				</element-citation></ref><ref id="pcbi-0020006-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sadler</surname><given-names>PM</given-names></name></person-group>
					<year>2004</year>
					<article-title>Quantitative biostratigraphy—Achieving finer resolution in global correlation.</article-title>
					<source>Annu Rev Earth Planet Sci</source>
					<volume>32</volume>
					<fpage>187</fpage>
					<lpage>213</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Guex</surname><given-names>J</given-names></name><name name-style="western"><surname>Davaud</surname><given-names>E</given-names></name></person-group>
					<year>1984</year>
					<article-title>Unitary associations method: The use of graph theory and computer algorithm.</article-title>
					<source>Comp Geosc</source>
					<volume>10</volume>
					<fpage>69</fpage>
					<lpage>96</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Savary</surname><given-names>J</given-names></name><name name-style="western"><surname>Guex</surname><given-names>J</given-names></name></person-group>
					<year>1991</year>
					<article-title>Biograph, un nouveau programme de construction des corrélations biochronologiques basées sur les associations unitaires.</article-title>
					<source>Bull Lab Géol Univ Lausanne</source>
					<volume>313</volume>
					<fpage>317</fpage>
					<lpage>340</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Savary</surname><given-names>J</given-names></name><name name-style="western"><surname>Guex</surname><given-names>J</given-names></name></person-group>
					<year>1999</year>
					<article-title>Discrete biochronological scales and unitary associations: Description of the biograph computer programme.</article-title>
					<source>Mémoires de Géologie (Lausanne)</source>
					<volume>34</volume>
					<fpage>1</fpage>
					<lpage>282</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b019"><label>19</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hooker</surname><given-names>JJ</given-names></name></person-group>
					<year>1996</year>
					<article-title>Mammalian biostratigraphy across the Paleocene-Eocene boundary in the Paris, London and Belgian basins.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Knox</surname><given-names>RW</given-names></name><name name-style="western"><surname>Corfield</surname><given-names>RM</given-names></name><name name-style="western"><surname>Dunay</surname><given-names>RE</given-names></name></person-group>
					<source>Correlation of the Early Paleogene in northwestern Europe</source>
					<comment>pp.</comment>
					<fpage>205</fpage>
					<lpage>218</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hooker</surname><given-names>JJ</given-names></name><name name-style="western"><surname>Weidmann</surname><given-names>M</given-names></name></person-group>
					<year>2000</year>
					<article-title>The Eocene mammal faunas of Mormont, Switzerland.</article-title>
					<source>Schweiz Paläontol Abh</source>
					<volume>120</volume>
					<fpage>1</fpage>
					<lpage>143</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Martinez</surname><given-names>J</given-names></name></person-group>
					<year>1995</year>
					<article-title>Biochronologie et méthode de parcimonie.</article-title>
					<source>Bull Assoc Geogr Fr</source>
					<volume>166</volume>
					<fpage>517</fpage>
					<lpage>526</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b022"><label>22</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sadler</surname><given-names>PM</given-names></name><name name-style="western"><surname>Kemple</surname><given-names>WG</given-names></name><name name-style="western"><surname>Kooser</surname><given-names>MA</given-names></name></person-group>
					<year>2003</year>
					<article-title>Conop programs for solving the stratigraphic correlation and seriation problems as constrained optimization.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Harries</surname><given-names>PJ</given-names></name></person-group>
					<source>High resolution approaches in stratigraphic paleontology</source>
					<publisher-loc>Boston</publisher-loc>
					<publisher-name>Kluwer Academic Publishers</publisher-name>
					<comment>pp.</comment>
					<fpage>461</fpage>
					<lpage>465</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Halekoh</surname><given-names>U</given-names></name><name name-style="western"><surname>Vach</surname><given-names>W</given-names></name></person-group>
					<year>2004</year>
					<article-title>A Bayesian approach to seriation problems in archeology.</article-title>
					<source>Comput Statist Data Anal</source>
					<volume>45</volume>
					<fpage>651</fpage>
					<lpage>673</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Alroy</surname><given-names>J</given-names></name></person-group>
					<year>1992</year>
					<article-title>Conjunction among taxonomic distributions and the Miocene mammalian biochronology of the Great Plains.</article-title>
					<source>Paleobiology</source>
					<volume>18</volume>
					<fpage>326</fpage>
					<lpage>343</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Alroy</surname><given-names>J</given-names></name></person-group>
					<year>1994</year>
					<article-title>Appearence event ordination: A new biochronologic method.</article-title>
					<source>Paleobiology</source>
					<volume>20</volume>
					<fpage>191</fpage>
					<lpage>207</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b026"><label>26</label><element-citation publication-type="journal" xlink:type="simple">
					<collab xlink:type="simple">Alroy J, Marshall CR, Bambach RK, Bezusko K, Foote M, et al.</collab>
					<year>1998</year>
					<article-title>Effects of sampling standardization on estimates of phanerozoic marine diversification.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>98</volume>
					<fpage>6261</fpage>
					<lpage>6266</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b027"><label>27</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Azanza</surname><given-names>B</given-names></name><name name-style="western"><surname>Alberdi</surname><given-names>M</given-names></name><name name-style="western"><surname>Cerdeno</surname><given-names>E</given-names></name><name name-style="western"><surname>Prado</surname><given-names>J</given-names></name></person-group>
					<year>1997</year>
					<article-title>Biochronology from latest Miocene to middle Pleistocene in the western Mediterranean area.</article-title>
					<comment>In:</comment>
					<source>Actes du Congrès BiochroM '97</source>
					<publisher-name>Mémoires et Travaux de l'Institut de Montpellier</publisher-name>
					<comment>pp.</comment>
					<fpage>567</fpage>
					<lpage>574</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b028"><label>28</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gamerman</surname><given-names>D</given-names></name></person-group>
					<year>1997</year>
					<source>Markov chain Monte Carlo: Stochastic simulation for Bayesian inference. Texts in Statistical Science</source>
					<publisher-loc>London</publisher-loc>
					<publisher-name>Chapman &amp; Hall</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">264</size>
					<comment>p.</comment>
				</element-citation></ref><ref id="pcbi-0020006-b029"><label>29</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gelman</surname><given-names>A</given-names></name><name name-style="western"><surname>Carlin</surname><given-names>JB</given-names></name><name name-style="western"><surname>Stern</surname><given-names>HS</given-names></name><name name-style="western"><surname>Rubin</surname><given-names>DB</given-names></name></person-group>
					<year>1995</year>
					<source>Bayesian data analysis</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Chapman &amp; Hall</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">552</size>
					<comment>p.</comment>
				</element-citation></ref><ref id="pcbi-0020006-b030"><label>30</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mein</surname><given-names>P</given-names></name></person-group>
					<year>1975</year>
					<article-title>Résultats du groupe de travail des vertébrés: Biozonation du Neogène méditerranéen á partir des mammifères.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Senes</surname><given-names>J</given-names></name></person-group>
					<source>Report on Activity of the RCMNS Working Group (1971–1975)</source>
					<publisher-loc>Bratislava</publisher-loc>
					<publisher-name>RCMNS</publisher-name>
					<comment>pp.</comment>
					<fpage>78</fpage>
					<lpage>81</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b031"><label>31</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mein</surname><given-names>P</given-names></name></person-group>
					<year>1989</year>
					<article-title>Updating of MN zones.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Lindsay</surname><given-names>EH</given-names></name><name name-style="western"><surname>Fahlbusch</surname><given-names>V</given-names></name><name name-style="western"><surname>Mein</surname><given-names>P</given-names></name></person-group>
					<source>European Neogene mammal chronology</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Plenum Press</publisher-name>
					<comment>pp.</comment>
					<fpage>73</fpage>
					<lpage>90</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b032"><label>32</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Fahlbusch</surname><given-names>V</given-names></name></person-group>
					<year>1976</year>
					<article-title>Report on the International Symposium on Mammal Stratigraphy of the European Tertiary.</article-title>
					<source>Newsl Stratigr</source>
					<volume>5</volume>
					<fpage>160</fpage>
					<lpage>167</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b033"><label>33</label><element-citation publication-type="journal" xlink:type="simple">
					<collab xlink:type="simple">Bruijn HD, Daams R, Daxner-Höck G, Fahlbusch V, Ginsburg L, et al.</collab>
					<year>1992</year>
					<article-title>Report of the RCMNS working group on fossil mammals, Reisensburg 1990.</article-title>
					<source>Newsl Stratigr</source>
					<volume>26</volume>
					<fpage>65</fpage>
					<lpage>118</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Fahlbusch</surname><given-names>V</given-names></name></person-group>
					<year>1991</year>
					<article-title>Report on the international symposium on mammal stratigraphy of the European Tertiary.</article-title>
					<source>Newsl Stratigr</source>
					<volume>24</volume>
					<fpage>159</fpage>
					<lpage>173</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b035"><label>35</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Agusti</surname><given-names>J</given-names></name><name name-style="western"><surname>Rook</surname><given-names>L</given-names></name><name name-style="western"><surname>Andrews</surname><given-names>P</given-names></name></person-group>
					<year>1999</year>
					<source>Hominoid evolution and climate change in Europe. Volume 1, The evolution of Neogene terrestrial ecosystems in Europe</source>
					<publisher-loc>Cambridge</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">528</size>
					<comment>p.</comment>
				</element-citation></ref><ref id="pcbi-0020006-b036"><label>36</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bernor</surname><given-names>RL</given-names></name><name name-style="western"><surname>Fahlbusch</surname><given-names>V</given-names></name><name name-style="western"><surname>Mittmann</surname><given-names>HW</given-names></name><name name-style="western"><surname>Rietschel</surname><given-names>S</given-names></name></person-group>
					<year>1996</year>
					<source>The evolution of western Eurasian Neogene mammal faunas</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Columbia University Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">528</size>
					<comment>p.</comment>
				</element-citation></ref><ref id="pcbi-0020006-b037"><label>37</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>von Koenigswald</surname><given-names>W</given-names></name><name name-style="western"><surname>Heinrich</surname><given-names>WD</given-names></name></person-group>
					<year>1999</year>
					<article-title>Mittelpleistozäne Säugetierfaunen aus Mitteleurop—Der Versuch einer biostratigraphischen Zuordnung.</article-title>
					<source>Kaupia</source>
					<volume>9</volume>
					<fpage>53</fpage>
					<lpage>112</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b038"><label>38</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>von Koenigswald</surname><given-names>W</given-names></name></person-group>
					<year>2003</year>
					<article-title>Mode and causes for the Pleistocene turnovers in the mammalian fauna of Central Europe.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Reumer</surname><given-names>JWF</given-names></name><name name-style="western"><surname>Wessels</surname><given-names>W</given-names></name></person-group>
					<source>Distribution and migration of Tertiary mammals in Eurasia. A volume in honour of Hans de Bruijn</source>
					<publisher-loc>Utrecht (Netherlands)</publisher-loc>
					<publisher-name>Deinsea</publisher-name>
					<comment>pp.</comment>
					<fpage>305</fpage>
					<lpage>312</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b039"><label>39</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jernvall</surname><given-names>J</given-names></name><name name-style="western"><surname>Fortelius</surname><given-names>M</given-names></name></person-group>
					<year>2004</year>
					<article-title>Maintenance of trophic structure in fossil mammal communities: Site occupancy and taxon resilience.</article-title>
					<source>Am Nat</source>
					<volume>164</volume>
					<fpage>614</fpage>
					<lpage>624</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b040"><label>40</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Vermeij</surname><given-names>GJ</given-names></name><name name-style="western"><surname>Herbert</surname><given-names>GS</given-names></name></person-group>
					<year>2004</year>
					<article-title>Measuring relative abundance in fossil and living assemblages.</article-title>
					<source>Paleobiology</source>
					<volume>30</volume>
					<fpage>1</fpage>
					<lpage>4</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b041"><label>41</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Koufos</surname><given-names>G</given-names></name></person-group>
					<year>2003</year>
					<article-title>Late Miocene mammal events and biostratigraphy in the Eastern Mediterranean.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Reumer</surname><given-names>JWF</given-names></name><name name-style="western"><surname>Wessels</surname><given-names>W</given-names></name></person-group>
					<source>Distribution and migration of tertiary mammals in Eurasia. A volume in honour of Hans de Bruijn</source>
					<publisher-loc>Utrecht (Netherlands)</publisher-loc>
					<publisher-name>Deinsea</publisher-name>
					<comment>pp</comment>
					<fpage>343</fpage>
					<lpage>372</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b042"><label>42</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sen</surname><given-names>S</given-names></name><name name-style="western"><surname>Koufos</surname><given-names>G</given-names></name><name name-style="western"><surname>Kostopoulos</surname><given-names>D</given-names></name><name name-style="western"><surname>De Bonis</surname><given-names>L</given-names></name></person-group>
					<year>2000</year>
					<article-title>Magnetostratigraphy of late Miocene continental deposits of the Lower Axios valley, Macedonia, Greece.</article-title>
					<source>Geol Soc Greece Spec Publ</source>
					<volume>9</volume>
					<fpage>197</fpage>
					<lpage>206</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b043"><label>43</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Dell</surname><given-names>RF</given-names></name><name name-style="western"><surname>Kemple</surname><given-names>WG</given-names></name><name name-style="western"><surname>Tovey</surname><given-names>CA</given-names></name></person-group>
					<year>1992</year>
					<source>Heuristically solving the stratigraphic correlation problem. First Industrial Engineering Research Conference Proceedings</source>
					<comment>pp.</comment>
					<fpage>293</fpage>
					<lpage>297</lpage>
				</element-citation></ref><ref id="pcbi-0020006-b044"><label>44</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Garey</surname><given-names>MR</given-names></name><name name-style="western"><surname>Johnson</surname><given-names>DS</given-names></name></person-group>
					<year>1979</year>
					<source>Computers and intractability: A guide to the theory of NP-completeness</source>
					<publisher-loc>San Francisco</publisher-loc>
					<publisher-name>Freeman</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">338</size>
					<comment>p.</comment>
				</element-citation></ref><ref id="pcbi-0020006-b045"><label>45</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Cutler</surname><given-names>A</given-names></name><name name-style="western"><surname>Cordero-Braña</surname><given-names>OI</given-names></name></person-group>
					<year>1996</year>
					<article-title>Minimum Hellinger distance estimation for finite mixture models.</article-title>
					<source>J Amer Statist Assoc</source>
					<volume>91</volume>
					<fpage>1716</fpage>
					<lpage>1723</lpage>
				</element-citation></ref></ref-list></back></article>