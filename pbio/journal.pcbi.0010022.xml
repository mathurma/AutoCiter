<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="flc">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0010022</article-id><article-id pub-id-type="publisher-id">05-PLCB-RA-0104R2</article-id><article-id pub-id-type="sici">plcb-01-02-07</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Genetics and Genomics</subject><subject>Genetics and Genomics/Genome Projects</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Drosophila</subject><subject>Eukaryotes</subject><subject>None</subject></subj-group></article-categories><title-group><article-title>Combined Evidence Annotation of Transposable Elements in Genome Sequences</article-title><alt-title alt-title-type="running-head">Combined Evidence TE Annotation</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Quesneville</surname><given-names>Hadi</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Bergman</surname><given-names>Casey M</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="fn" rid="n104"><sup>¤</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Andrieu</surname><given-names>Olivier</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Autard</surname><given-names>Delphine</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Nouaud</surname><given-names>Danielle</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ashburner</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Anxolabehere</surname><given-names>Dominique</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff1">
				<label>1</label><addr-line> Laboratoire Dynamique du Génome et Evolution, Institut Jacques Monod, Paris, France
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Department of Genetics, University of Cambridge, Cambridge, United Kingdom
			</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Stormo</surname><given-names>Gary</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Washington University in St. Louis, United States of America</aff><author-notes><fn fn-type="con" id="ack2"><p>H. Quesneville, C. M. Bergman, M. Ashburner, and D. Anxolabehere conceived and designed the experiments. H. Quesneville, C. M. Bergman, and O. Andrieu performed the experiments. H. Quesneville, C. M. Bergman, O. Andrieu, D. Autard, and D. Nouaud analyzed the data. H. Quesneville, C. M. Bergman, O. Andrieu, D. Autard, and M. Ashburner contributed reagents/materials/analysis tools. H. Quesneville and C. M. Bergman wrote the paper.</p></fn><corresp id="cor1">*To whom correspondence should be addressed. E-mail: <email xlink:type="simple">hq@ccr.jussieu.fr</email></corresp><fn fn-type="current-aff" id="n104"><p>¤Current address: Faculty of Life Sciences, University of Manchester, Manchester, United Kingdom</p></fn><fn fn-type="conflict" id="ack1"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>7</month><year>2005</year></pub-date><pub-date pub-type="epub"><day>29</day><month>7</month><year>2005</year></pub-date><volume>1</volume><issue>2</issue><elocation-id>e22</elocation-id><history><date date-type="received"><day>11</day><month>5</month><year>2005</year></date><date date-type="accepted"><day>30</day><month>6</month><year>2005</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2005</copyright-year><copyright-holder>Quesneville et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Transposable elements (TEs) are mobile, repetitive sequences that make up significant fractions of metazoan genomes. Despite their near ubiquity and importance in genome and chromosome biology, most efforts to annotate TEs in genome sequences rely on the results of a single computational program, RepeatMasker. In contrast, recent advances in gene annotation indicate that high-quality gene models can be produced from combining multiple independent sources of computational evidence. To elevate the quality of TE annotations to a level comparable to that of gene models, we have developed a combined evidence-model TE annotation pipeline, analogous to systems used for gene annotation, by integrating results from multiple homology-based and de novo TE identification methods. As proof of principle, we have annotated “TE models” in <italic>Drosophila melanogaster</italic> Release 4 genomic sequences using the combined computational evidence derived from RepeatMasker, BLASTER, TBLASTX, all-by-all BLASTN, RECON, TE-HMM and the previous Release 3.1 annotation. Our system is designed for use with the Apollo genome annotation tool, allowing automatic results to be curated manually to produce reliable annotations. The euchromatic TE fraction of <italic>D. melanogaster</italic> is now estimated at 5.3% (cf. 3.86% in Release 3.1), and we found a substantially higher number of TEs (<italic>n</italic> = 6,013) than previously identified (<italic>n</italic> = 1,572). Most of the new TEs derive from small fragments of a few hundred nucleotides long and highly abundant families not previously annotated (e.g., <italic>INE-1</italic>). We also estimated that 518 TE copies (8.6%) are inserted into at least one other TE, forming a nest of elements. The pipeline allows rapid and thorough annotation of even the most complex TE models, including highly deleted and/or nested elements such as those often found in heterochromatic sequences. Our pipeline can be easily adapted to other genome sequences, such as those of the <italic>D. melanogaster</italic> heterochromatin or other species in the genus <italic>Drosophila</italic>.</p></abstract><abstract abstract-type="synopsis"><title>Synopsis</title><sec id="st1"><title/><p>A first step in adding value to the large-scale DNA sequences generated by genome projects is the process of annotation—marking biological features on the raw string of adenines, cytosines, guanines, and thymines. The predominant goal in genome annotation thus far has been to identify gene sequences that encode proteins; however, many functional sequences exist in non-protein-coding regions and their annotation remains incomplete. Mobile, repetitive DNA segments known as transposable elements (TEs) are one class of functional sequence in non-protein-coding regions, which can make up large fractions of genome sequences (e.g., about 45% in the human) and can play important roles in gene and chromosome structure and regulation. As a consequence, there has been increasing interest in the computational identification of TEs in genome sequences. Borrowing current ideas from the field of gene annotation, the authors have developed a pipeline to predict TEs in genome sequences that combines multiple sources of evidence from different computational methods. The authors' combined-evidence pipeline represents an important step towards raising the standards of TE annotation to the same quality as that of genes, and should help catalyze their understanding of the biological role of these fascinating sequences.</p></sec></abstract><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>Citation:</meta-name><meta-value>Quesneville H, Bergman CM, Andrieu O, Autard D, Nouaud D, et al. (2005) Combined evidence annotation of transposable elements in genome sequences. PLoS Comp Biol 1(2): e22.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Transposable elements (TEs) are mobile, repetitive DNA sequences that constitute a structurally dynamic component of genomes. The taxonomic distribution of TEs is virtually ubiquitous: they have been found in nearly all eukaryotic organisms studied, with few exceptions. TEs represent quantitatively important components of genome sequences (e.g., 44.4% of the human genome; [<xref ref-type="bibr" rid="pcbi-0010022-b01">1</xref>]), and there is no doubt that modern genomic DNA has evolved in close association with TEs. TEs show high species specificity, and the number and types of TE can differ quite dramatically between even closely related organisms. There is abundant circumstantial evidence that TEs may transfer horizontally between species by mechanisms that remain obscure. The forces controlling the dynamics of TE spread within a species are also poorly understood, as are the systemic effects of the elements on their host genomes. Insertions of individual TEs may lead to genome restructuring (e.g., the occurrence of inversions), mutations in genes, or changes in gene regulation. Some TE insertions may even have become domesticated to play roles in the normal functions of the host (see [<xref ref-type="bibr" rid="pcbi-0010022-b02">2</xref>] for review). Despite their manifold effects, abundance, and ubiquity, we understand very little about most aspects of TE biology.</p><p>One way of furthering our knowledge of TE biology is through the computational analysis of TEs in the growing number of complete genomic sequences. By detailed comparison of the abundance and distribution of TEs in entire genomes, we can infer the fundamental biological properties of TEs that are shared or that differ among species. However, meaningful inferences about TE biology based on computationally derived TE annotations can only be done if we are confident about the results of these analyses. The hallmark of a strong result in computational biology should be its robustness to the particular method used. The annotation of TEs, however, typically relies on the results of a single computational program, RepeatMasker (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org/" xlink:type="simple">http://www.repeatmasker.org/</ext-link>), which recent studies indicate may be “neither the most efficient nor the most sensitive approach” for TE annotation [<xref ref-type="bibr" rid="pcbi-0010022-b03">3</xref>]. By contrast, recent advances in the field of gene annotation indicate that high-quality gene models can be produced by combining multiple independent sources of computational evidence [<xref ref-type="bibr" rid="pcbi-0010022-b04">4</xref>–<xref ref-type="bibr" rid="pcbi-0010022-b09">9</xref>]. With the recent development of several new methods for TE and repeat detection [<xref ref-type="bibr" rid="pcbi-0010022-b10">10</xref>–<xref ref-type="bibr" rid="pcbi-0010022-b16">16</xref>], it is now possible to apply a similar “combined evidence” approach to elevate the quality of TE annotations to a level comparable to that of gene models.</p><p>To achieve this aim, we have developed a TE annotation pipeline that integrates results from multiple homology-based and de novo TE identification methods. Currently, our pipeline uses the combined computational evidence derived from RepeatMasker (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org/" xlink:type="simple">http://www.repeatmasker.org/</ext-link>), BLASTER [<xref ref-type="bibr" rid="pcbi-0010022-b13">13</xref>], TBLASTX [<xref ref-type="bibr" rid="pcbi-0010022-b17">17</xref>], all-by-all BLASTN [<xref ref-type="bibr" rid="pcbi-0010022-b17">17</xref>], RECON [<xref ref-type="bibr" rid="pcbi-0010022-b10">10</xref>], TE-HMM [<xref ref-type="bibr" rid="pcbi-0010022-b14">14</xref>], and previously published TE annotations [<xref ref-type="bibr" rid="pcbi-0010022-b18">18</xref>]. We have designed our system to use an “evidence-model” framework and the Apollo genome annotation tool [<xref ref-type="bibr" rid="pcbi-0010022-b19">19</xref>], allowing computational evidence to be manually curated in an efficient manner to produce reliable “TE models”. The pipeline allows rapid and thorough annotation of complex TE models, providing key structural details that allow insights into the origin of highly deleted and/or nested elements. In contrast to simply masking repeats, our method provides the means to a complete and accurate annotation of TEs, supported by multiple sources of computational evidence, a goal that has important implications for experimental studies of genome and chromosome biology.</p><p>As a test case we have chosen to annotate the euchromatic genomic sequence of the fruit fly, <italic>Drosophila melanogaster</italic>. The 116.8-Mb Release 3 genome sequence of <italic>D. melanogaster</italic> is among the highest quality genome sequences and is a particularly well suited sequence for genome-wide studies of TEs, since repetitive DNA sequences have been finished to high quality and systematically verified by restriction fingerprint analysis [<xref ref-type="bibr" rid="pcbi-0010022-b20">20</xref>]. Moreover, the Release 3.1 annotation of <italic>D. melanogaster</italic> includes a manually curated set of TE annotations [<xref ref-type="bibr" rid="pcbi-0010022-b18">18</xref>] that can be used as a benchmark for developing and refining TE annotation methodologies. Controlled tests performed here on the Release 3 sequence show that a combined-evidence approach has superior performance over individual TE detection methods, and that a substantially larger fraction of the genome is composed of TEs than previously estimated. We have applied our pipeline to the new 118.4-Mb Release 4 sequence (<ext-link ext-link-type="uri" xlink:href="http://www.fruitfly.org/annot/release4.html" xlink:type="simple">http://www.fruitfly.org/annot/release4.html</ext-link>), which has closed several of the gaps in Release 3 and has extended the sequence of the pericentomeric regions, to produce a systematic re-annotation of TEs in the <italic>D. melanogaster</italic> genome. The euchromatic TE fraction is now estimated at 5.3% (cf. 3.86% in Release 3.1), and we found a substantially higher number of TEs (<italic>n</italic> = 6,013) than previously identified (<italic>n</italic> = 1,572). We also estimated that 518 TE copies (8.6%) are inserted into at least one other TE, forming a nest of elements. Our pipeline can be easily adapted to other genome sequences, and could markedly increase the efficiency of annotating genomic regions with complex or abundant TE insertions such as heterochromatic sequences.</p></sec><sec id="s2"><title>Results</title><sec id="s2a"><title>Evaluation of Methods</title><p>The first step in the development of our pipeline was to evaluate the abilities of different computational tools that are available to annotate TEs in order to assess the strengths and weaknesses of each method. To do this we re-annotated the <italic>D. melanogaster</italic> Release 3 sequence using different TE detection methods and compared these results to the FlyBase Release 3.1 annotation (<ext-link ext-link-type="uri" xlink:href="http://www.flybase.org/annot/release3.html" xlink:type="simple">http://www.flybase.org/annot/release3.html</ext-link>), which includes the results of a manually curated set of TE annotations published previously by Kaminker et al. [<xref ref-type="bibr" rid="pcbi-0010022-b18">18</xref>].</p><p>Methods for TE annotation fall into two general classes: (i) methods designed for the annotation of known TE families, which utilize a specific reference sequence (also called a canonical sequence) and (ii) de novo methods designed for the annotation of anonymous TE families, for which no reference sequence has yet been identified. This distinction is necessary since it determines the relevant measures to evaluate different methods for TE detection.</p></sec><sec id="s2b"><title>Methods for the Annotation of Known TE Families</title><p>To allow direct comparison with previous results [<xref ref-type="bibr" rid="pcbi-0010022-b18">18</xref>], we used the Release 3 genomic sequence as a query to be scanned for similarity to reference sequences in version 7.1 of the Berkeley <italic>Drosophila</italic> Genome Project (BDGP) TE dataset (<ext-link ext-link-type="uri" xlink:href="http://www.fruitfly.org/p_disrupt/TE.html" xlink:type="simple">http://www.fruitfly.org/p_disrupt/TE.html</ext-link>), the same version that was used for the Release 3.1 FlyBase annotation. We initially tested three methods for TE prediction (see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details): (i) BLASTER using BLASTN followed by chaining with MATCHER (BLRn), (ii) RepeatMasker using default parameters (RM), and (iii) RM using default parameters followed by chaining with MATCHER (RMm). The last method was used to test the benefit of the “chaining algorithm” implemented in MATCHER.</p><p>We compared predictions to annotations by calculating sensitivity and specificity values for the number of nucleotides of TE sequence predicted by a method that overlapped (or did not overlap) TEs in the Release 3.1 FlyBase annotation (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). Note that the computation of specificity is biased here, since it assumes that all TEs in the Release 3.1 FlyBase annotation are known, which is certainly not true. We also compared different categories of overlap between prediction and annotation boundaries to gain deeper insight into the details of TE detection methods (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). These results are summarized in <xref ref-type="table" rid="pcbi-0010022-t001">Table 1</xref>.</p><table-wrap content-type="2col" id="pcbi-0010022-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0010022.t001</object-id><label>Table 1</label><caption><p>Results of Comparisons between TE Prediction Methods That Use Reference Sequences and the Release 3 FlyBase TE Annotations</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0010022.t001" xlink:type="simple"/><table-wrap-foot><fn id="nt101"><p>Relationships of predictions to annotations can be categorized as 1-to-1, 1-to-<italic>n,</italic> <italic>n</italic>-to-1, 1-to-0, or <italic>n</italic>-to-<italic>n</italic> (where <italic>n</italic> &gt; 1; see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details).</p></fn></table-wrap-foot><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="left" charoff="0" char=""/><col id="tb1col3" align="char" charoff="0" char="."/><col id="tb1col4" align="char" charoff="0" char="."/><col id="tb1col5" align="char" charoff="0" char="."/><col id="tb1col6" align="char" charoff="0" char="."/><col id="tb1col7" align="char" charoff="0" char="."/></colgroup><thead><tr><td><hr/>Relationship</td><td><hr/>Characteristic</td><td><hr/>BLRn</td><td><hr/>RM</td><td><hr/>RMm</td><td><hr/>Optimized RMBLR</td><td><hr/>RMBLR with Conservative Settings</td></tr></thead><tbody><tr><td></td><td>Sensitivity</td><td>96.9</td><td>94.3</td><td>95.8</td><td>97.8</td><td>97.8</td></tr><tr><td></td><td>Specificity</td><td>99.7</td><td>99.1</td><td>99.1</td><td>99.1</td><td>99.1</td></tr><tr><td>1-to-1</td><td>Exact</td><td>854</td><td>664</td><td>711</td><td>717</td><td>694</td></tr><tr><td></td><td>Near exact</td><td>98</td><td>190</td><td>178</td><td>169</td><td>172</td></tr><tr><td></td><td>Equivalent</td><td>3</td><td>20</td><td>18</td><td>17</td><td>17</td></tr><tr><td></td><td>Near equivalent</td><td>6</td><td>37</td><td>37</td><td>28</td><td>28</td></tr><tr><td></td><td>One side exact</td><td>176</td><td>154</td><td>192</td><td>177</td><td>182</td></tr><tr><td></td><td>Similar</td><td>48</td><td>76</td><td>87</td><td>75</td><td>74</td></tr><tr><td><italic>n</italic>-to-1</td><td>Method not joined</td><td>3</td><td>110</td><td>6</td><td>4</td><td>33</td></tr><tr><td></td><td>Annotation over-joined</td><td>14</td><td>71</td><td>28</td><td>6</td><td>8</td></tr><tr><td></td><td>Same TE nested</td><td>12</td><td>4</td><td>5</td><td>25</td><td>25</td></tr><tr><td></td><td>TE duplication</td><td>35</td><td>44</td><td>26</td><td>32</td><td>35</td></tr><tr><td>1-to-<italic>n</italic></td><td>Annotation not joined</td><td>63</td><td>45</td><td>71</td><td>61</td><td>61</td></tr><tr><td>1-to-0</td><td>New TE</td><td>1,515</td><td>4,561</td><td>4,764</td><td>4,957</td><td>4,996</td></tr><tr><td></td><td>New nest</td><td>34</td><td>24</td><td>23</td><td>30</td><td>30</td></tr><tr><td></td><td>Other strand</td><td>23</td><td>23</td><td>21</td><td>23</td><td>23</td></tr><tr><td></td><td>Different TE</td><td>31</td><td>45</td><td>45</td><td>44</td><td>44</td></tr><tr><td><italic>n</italic>-to-<italic>n</italic></td><td>Complex structure</td><td>20</td><td>11</td><td>12</td><td>21</td><td>16</td></tr></tbody></table> --></table-wrap><p>We found that both the sensitivity and the specificity to predict Release 3.1 TEs were higher for BLRn (96.9% and 99.7%, respectively) than for RM (94.3% and 99.1%, respectively). In addition, 28% more Release 3.1 TEs were predicted exactly by BLRn (<italic>n</italic> = 854) than by RM (<italic>n</italic> = 664). BLRn also made well over an order of magnitude fewer “method not joined” errors (<italic>n</italic> = 3) than RM (<italic>n</italic> = 110), indicating that the BLRn strategy makes high-quality automatic decisions about joining fragments of TEs. RMm had intermediate performance with respect to RM and BLRn for exactly predicting Release 3.1 annotations (<italic>n</italic> = 711), but, like BLRn, had few “method not joined” errors (<italic>n</italic> = 6). These results may be explained partly by the fact the Release 3.1 annotation was produced using BLAST-based methods [<xref ref-type="bibr" rid="pcbi-0010022-b18">18</xref>], and that the local alignment stop criterion significantly differs between the BLAST algorithm and the Smith and Waterman algorithm used by RM (in the final search phase). Thus, the good performance of BLRn for predicting Release 3.1 TE boundaries could result from the fact that the same local alignment stop criterion was used. However, differences in local alignment matching cannot explain these results entirely, since RMm outperformed RM to recover exact matches, indicating that the chaining algorithm implemented in MATCHER is a significant improvement over raw RM results for predicting Release 3.1 TE annotations.</p><p>RM identified approximately 3-fold more new TEs than BLRn, and thus appears to be a more sensitive method for the detection of previously unannotated TEs. But here also RMm had a better performance for detecting new TEs than RM, so the effects of chaining can also improve RM in this regard. The putative TEs predicted by RM in general were short, as can be seen by the relatively limited effect that an additional 3,000+ predictions had on the genome-wide specificity of RM and RMm.</p><p>Given the different performance of these approaches, we developed and tested a fourth strategy that attempts to capitalize on the strengths of both RM and BLRn. This method, called RepeatMasker-BLASTER (RMBLR), combined hits from both BLRn and RM and gave them to MATCHER for chaining. To do this, we normalized alignment scores from BLRn and RM to be the hit length for chaining. As shown in <xref ref-type="table" rid="pcbi-0010022-t001">Table 1</xref>, an optimized RMBLR had higher sensitivity than RM, RMm, or BLRn alone, produced the highest number of putative new TE annotations, and otherwise retained performance features similar to RMm and BLRn. These results show that a combined approach to TE annotation is more efficient at both recovering known TE annotations and predicting new ones than each method alone.</p><p>The results shown in <xref ref-type="table" rid="pcbi-0010022-t001">Table 1</xref> also suggest that there were errors in the Release 3.1 FlyBase annotation. Among them, the tools predicted cases where two annotations could be joined automatically (category “annotation not joined” in <xref ref-type="table" rid="pcbi-0010022-t001">Table 1</xref>) and others where an annotation might be split (category “annotation over-joined” in <xref ref-type="table" rid="pcbi-0010022-t001">Table 1</xref>). Using the Apollo annotation editor [<xref ref-type="bibr" rid="pcbi-0010022-b19">19</xref>] to inspect these errors visually, we found that the fragmented and the nested structures of TEs often could be recovered better with these tools than in the Release 3.1 FlyBase annotation. In addition, using Apollo we found that the many new copies appear to be bona fide remnants of TEs missing from the previous annotation; however, a detailed analysis of Release 4 revealed that many of these new TEs may result from spurious hits to simple repeats in the reference sequence (see below).</p></sec><sec id="s2c"><title>Methods for the Annotation of Anonymous TE Families</title><p>We also tested de novo methods to predict TEs that do not use a specific reference sequence, and evaluated the ability of these methods to find TEs in the Release 3.1 <italic>D. melanogaster</italic> annotation. These results serve to determine the ability of each method to identify anonymous TEs, and are important for the annotation of genome sequences where a manually curated reference set of TEs is not available. Individually, we found that these methods have lower performance than those that use specific reference sequences, but together they provide additional evidence that can be used to evaluate TE models in the final manual curation step.</p><p>TEs have been predicted anonymously using four different methods: (i) an all-by-all genome comparison with BLASTER using BLASTN followed by chaining with MATCHER and grouping with GROUPER (BLRa), (ii) RECON, using default parameters, (iii) BLASTER using TBLASTX with the entire Repbase Update as the database, followed by chaining with MATCHER (BLRtx), and (iv) a hidden Markov model that detects TE sequences based on nucleotide composition (TE-HMM). Note that for BLRa, we compared coordinates of the group of sequences obtained by GROUPER with a coverage of zero (i.e., all overlapping matches were merged; see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details).</p><p>As above, sensitivity, specificity, and the comparison of boundaries between predictions and annotations were used to evaluate the performance of each method. Note again that, as previously, specificity is here biased because it assumes for its computation that all TEs in the genome are known. Here, specificity may be less meaningful than above, since the ability of these methods to detect new TEs is enhanced, and methods detecting many new TEs would have a correspondingly low specificity. Therefore, we must be careful to interpret specificity here as the ability to detect only already known TEs.</p><p><xref ref-type="table" rid="pcbi-0010022-t002">Table 2</xref> shows that all de novo methods had relatively high overall specificity (&gt;88%) to detect Release 3.1 TE annotations, but that RECON gave the best performance to recover Release 3.1 TEs exactly. BLRtx had the highest overall sensitivity to detect Release 3.1 TEs (97.2%), which may be explained by the fact that this method uses Repbase Update, which includes most of the <italic>Drosophila</italic> TEs. This can be shown by a similar analysis with <italic>Drosophila</italic> TEs removed from the Repbase Update (see BLRtxNoDros in <xref ref-type="table" rid="pcbi-0010022-t002">Table 2</xref>), which gave lower sensitivity (44.2%), fewer new TEs (<italic>n</italic> = 8,110), and no “exact”, “near exact”, or “equivalent” cases. BLRtx and TE-HMM detected thousands more new putative TEs than RECON, BLRa, and the other methods detailed in <xref ref-type="table" rid="pcbi-0010022-t001">Table 1</xref>, indicating that many new TE families may remain to be described in the <italic>D. melanogaster</italic> genome [<xref ref-type="bibr" rid="pcbi-0010022-b13">13</xref>]. These new families are probably low in copy number and represented by nonoverlapping fragments, as suggested by the smaller number of new TEs found by BLRa and RECON. In fact RECON could only detect TEs that are repeated and have copies that are more or less well conserved to their extremities. BLRtx and TE-HMM would be able to detect TEs in few copies (even unique elements) that could be highly diverged and/or degenerate. It is perhaps surprising that BLRtx predicts the highest number of new TEs, since TE-HMM would be able to detect copies for which no distant TE reference sequence is known. However, the high number of BLRtx and BLRtxNoDros predictions may result from an under-joining of fragments of the same TE, as suggested by the large number of “method not joined” cases: <italic>n</italic> = 1,172 (BLRtx) and <italic>n</italic> = 3,587 (BLRtxNoDros). In contrast, the high number of predictions resulting from TE-HMM do not appear to result from under-joining (“method not joined”; <italic>n</italic> = 42), but rather (with their relatively low sensitivity and specificity) suggest a tendency to overpredict using the current parameters. Together these results demonstrate that de novo methods provide specific evidence that can be used to support TE models, but additional development is necessary to fine-tune these approaches to generate accurate TE annotations directly.</p><table-wrap content-type="2col" id="pcbi-0010022-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0010022.t002</object-id><label>Table 2</label><caption><p>Results of Comparisons between TE Prediction Methods That Do Not Use Reference Sequences and the Release 3 FlyBase TE Annotations</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0010022.t002" xlink:type="simple"/><table-wrap-foot><fn id="nt201"><p>Relationships of predictions to annotations can be categorized as 1-to-1, 1-to-<italic>n,</italic> <italic>n</italic>-to-1, 1-to-0, or <italic>n</italic>-to-<italic>n</italic> (where <italic>n</italic> &gt; 1; see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details).</p></fn></table-wrap-foot><!-- <table frame="hsides" rules="none"><colgroup><col id="tb2col1" align="left" charoff="0" char=""/><col id="tb2col2" align="left" charoff="0" char=""/><col id="tb2col3" align="char" charoff="0" char="."/><col id="tb2col4" align="char" charoff="0" char="."/><col id="tb2col5" align="char" charoff="0" char="."/><col id="tb2col6" align="char" charoff="0" char="."/><col id="tb2col7" align="char" charoff="0" char="."/></colgroup><thead><tr><td><hr/>Relationship</td><td><hr/>Characteristic</td><td><hr/>BLRa</td><td><hr/>RECON</td><td><hr/>BLRtx</td><td><hr/>BLRtxNoDros</td><td><hr/>TE-HMM</td></tr></thead><tbody><tr><td></td><td>Sensitivity</td><td>88.3</td><td>89.8</td><td>97.2</td><td>44.2</td><td>74.3</td></tr><tr><td></td><td>Specificity</td><td>98.6</td><td>98.9</td><td>98</td><td>98.9</td><td>88.9</td></tr><tr><td>1-to-1</td><td>Exact</td><td>5</td><td>202</td><td>126</td><td>0</td><td>0</td></tr><tr><td></td><td>Near exact</td><td>10</td><td>153</td><td>160</td><td>0</td><td>1</td></tr><tr><td></td><td>Equivalent</td><td>9</td><td>83</td><td>74</td><td>0</td><td>2</td></tr><tr><td></td><td>Near equivalent</td><td>14</td><td>40</td><td>75</td><td>16</td><td>23</td></tr><tr><td></td><td>One side exact</td><td>15</td><td>114</td><td>105</td><td>3</td><td>11</td></tr><tr><td></td><td>Similar</td><td>36</td><td>55</td><td>39</td><td>69</td><td>453</td></tr><tr><td><italic>n</italic>-to-1</td><td>Method not joined</td><td>9</td><td>457</td><td>1,172</td><td>3,587</td><td>42</td></tr><tr><td></td><td>Annotation over-joined</td><td>209</td><td>90</td><td>44</td><td>112</td><td>283</td></tr><tr><td></td><td>Same TE nested</td><td>409</td><td>1</td><td>281</td><td>428</td><td>155</td></tr><tr><td>1-to-<italic>n</italic></td><td>Annotation not joined</td><td>14</td><td>53</td><td>30</td><td>11</td><td>68</td></tr><tr><td>1-to-0</td><td>New TE</td><td>511</td><td>744</td><td>18,260</td><td>8,110</td><td>11,898</td></tr><tr><td><italic>n</italic>-to-<italic>n</italic></td><td>Complex structure</td><td>125</td><td>46</td><td>75</td><td>8</td><td>86</td></tr></tbody></table> --></table-wrap></sec><sec id="s2d"><title>The Annotation Pipeline</title><p>Based on these results, we designed an integrated pipeline to compute and store evidence and TE annotations for genome sequences (<xref ref-type="fig" rid="pcbi-0010022-g001">Figure 1</xref>). Our annotation pipeline is composed of (i) TE detection software such as BLASTER, RepeatMasker, TE-HMM, and RECON; (ii) satellite detection software such as RepeatMasker, Tandem Repeat Finder (TRF) [<xref ref-type="bibr" rid="pcbi-0010022-b21">21</xref>], and Mreps [<xref ref-type="bibr" rid="pcbi-0010022-b22">22</xref>], (iii) a MySQL database (<ext-link ext-link-type="uri" xlink:href="http://www.mysql.com/" xlink:type="simple">http://www.mysql.com/</ext-link>) to manage the results of these methods and the annotations generated from them; and (iv) Open Portable Batch System (<ext-link ext-link-type="uri" xlink:href="http://www.openpbs.org/" xlink:type="simple">http://www.openpbs.org/</ext-link>) for distributing jobs on a computer cluster. The flexible architecture of this system easily allows other methods for TE detection to be added to this pipeline in the future.</p><fig id="pcbi-0010022-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0010022.g001</object-id><label>Figure 1</label><caption><title>Schematic of Our TE Annotation Pipeline</title><p>The pipeline is composed of (i) known TE family detection methods such as BLRn, RM, and RMBLR; (ii) satellite detection software such as RM, TRF, and Mreps; (iii) anonymous TE detection methods such BLRa, TE-HMM, RECON, and BLRtx; and (iv) a MySQL database called REPET to manage the results and the annotations. GAME-XML files are then generated from the results stored in the database and loaded into the Apollo genome annotation tool, allowing automatic results to be manually curated to produce a reliable annotation. To facilitate manual curation, we automatically promoted RMBLR results to be the candidate annotation.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0010022.g001" xlink:type="simple"/></fig><p>To save computer time and reduce software memory requirements, we segmented the Release 4 genomic sequences into chunks of 200 kb overlapping by 10 kb. Each chunk was then independently analyzed by the different analysis programs, and the results were stored in the MySQL database. GAME-XML (<ext-link ext-link-type="uri" xlink:href="http://www.fruitfly.org/annot/apollo/game.rng.txt" xlink:type="simple">http://www.fruitfly.org/annot/apollo/game.rng.txt</ext-link>) files were then generated from the results stored in the database and loaded into the Apollo genome annotation tool, allowing automatic results to be manually curated to produce a reliable annotation. For this curation we used as evidence tiers (i) the Release 3.1 FlyBase annotations with coordinates mapped to the Release 4 sequences, (ii) BLRn, RM, and RMBLR results using version 9.0 of the BDGP TE reference set, (iii) BLRtx using Repbase Update 8.12, and (iv) RECON, BLRa, and TE-HMM (see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details). We required all annotations to be supported by at least one of the methods for detecting known TEs—BLRn, RM, or RMBLR. We did not include annotations based solely on anonymous prediction methods since these methods potentially suffer from high false positive rates (<xref ref-type="table" rid="pcbi-0010022-t002">Table 2</xref>), even though our analyses on Release 3 suggested that there may be additional families of TEs yet to be discovered in the <italic>D. melanogaster</italic> genome. We note that our pipeline is currently designed with the goal of achieving the best possible annotation set of known TEs in a genome sequence, not the discovery of new TE families, an important endeavor in its own right but outside the scope of the current work.</p><p>To facilitate manual curation, we automatically promoted the results of RMBLR to be the candidate annotation (defined as a set of one or more joined fragments), which could then be validated or modified by the curator in Apollo according to the evidence available in the GAME-XML file (see <xref ref-type="fig" rid="pcbi-0010022-g002">Figure 2</xref> for an example). In addition, we generated a candidate list of mis-joined matches that were contiguous but not joined by MATCHER because of the size of the deletion or the insertion in the genomic sequence. This list identified potential problem cases to be considered carefully for manual joins in Apollo. Moreover, we used RMBLR with conservative settings (gap penalty of 0.05), intentionally under-joining contiguous matches compared to the optimal setting (gap penalty of 0.04; see <xref ref-type="table" rid="pcbi-0010022-t001">Table 1</xref>). Hence, the join decision of the most difficult cases is left to the curator. Another consequence of this conservative approach is that only a few annotations were manually split. This happened when two small and distant fragments (generally neighboring copies of <italic>INE-1</italic> [<xref ref-type="bibr" rid="pcbi-0010022-b23">23</xref>]) were automatically joined, and the insert between the two fragments did not correspond to another TE (as would be the case for a nested TE). We considered these joins excessive because of the lack of knowledge about the biology of the <italic>INE-1</italic> TE family, for which it is difficult to find a reliable reference sequence. We initially split the five major chromosome arms among five curators for a first-pass manual curation, which was completed in less than 2 wk. Subsequent to this, a single curator performed a second-pass manual curation in order to improve the consistency of manual edit decisions. We examined 10,348 annotations, and only 523 (5%) of them needed to be edited. Finally, we obtained 9,053 unique TE annotations after merging annotations in the overlaps between chunks.</p><fig id="pcbi-0010022-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0010022.g002</object-id><label>Figure 2</label><caption><title>Screenshot of an Apollo View for a Peri-Centromeric Region with Extreme TE Density</title><p>Curated annotations on both forward strand (top) and reverse strand (bottom) are displayed in the light blue panels. Evidence tiers are shown in the black panels: TE-HMM (yellow), RECON (light purple), BLRa (violet), BLRtx (red), BLRn (teal), RM (blue), RMBLR (light green), and Release 3.1 FlyBase annotations (peach).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0010022.g002" xlink:type="simple"/></fig><p>During the manual curation step, we encountered an unexpectedly large number of apparently spurious hits to particular TE families resulting from similarity to simple repeats present in the reference sequence. For example, 236 of 373 predicted TEs for the <italic>roo</italic> family [<xref ref-type="bibr" rid="pcbi-0010022-b24">24</xref>] were generated only by matches to the [CA(A/G)]<italic><sub>n</sub></italic> repeat in the <italic>roo</italic> reference sequence. Since the number of spurious hits resulting from simple repeats is potentially quite large, we considered several alternative strategies for their automatic removal. We rejected the possibility of masking the reference sequences and/or the genome for simple repeats, because that could have decreased dramatically the sensitivity of the detection of TEs that have many simple repeats in their reference sequence. Moreover, this strategy does not guarantee the removal of simple repeats that are too degenerate from a regular pattern to be detected, but that could still produce spurious hits because of differences in simple repeat detection versus TE detection.</p><p>Instead, we settled on a two-step post-processing of our curated predictions that first identified all annotations that were less than a length threshold after removing regions that overlapped simple repeat regions. These putative spurious hits were then used as queries in a filtered BLAST against the BDGP TE reference set to “rescue” false spurious hits (i.e., real TEs) from true spurious hits. To develop this method, we used the <italic>roo</italic> family as a training set, for which we could easily partition spurious from real TE annotations. We tested the ability of three methods for simple repeat detection—RepeatMasker, Mreps, and TRF—to discriminate real from spurious <italic>roo</italic> annotations as a function of length remaining after simple repeat removal. We found that using RepeatMasker with a length threshold of 170 bp allowed all 236 spurious <italic>roo</italic> annotations to be identified with no real annotations identified as spurious (data not shown).</p><p>Using this threshold we detected 3,058 putative spurious hits, which were then searched with BLASTN (<italic>E</italic>-value &gt; 1 × 10<sup>−15</sup>) using the “dust” filtering option against our reference TE sequence set. We found that only 18 of the 3,058 putative spurious hits were rescued as real annotations, indicating that our simple repeat filtering thresholds have high specificity. These 3,040 putative spurious hits were removed from the final set of Release 4 TE annotations submitted to FlyBase. Finally, to understand the source of these spurious hits in the auto-promoted TE models, we analyzed the overlap of the 3,040 spurious hits with Release 4 predictions generated individually by BLRn and RM. We find that 2,898 (95%) of the spurious hits overlapped a RM prediction, whereas only 1,255 (41%) of the spurious hits overlapped a BLRn prediction, indicating that RM generated a greater proportion of the spurious hits than BLRn.</p></sec></sec><sec id="s3"><title>Discussion</title><p>We have developed and implemented a combined-evidence pipeline to annotate TEs in genome sequences and applied this novel system to detecting TEs in the Release 4 sequence of <italic>D. melanogaster</italic>. Our work fulfills the demand for a unified approach to TE annotation that capitalizes on the strength of multiple TE detection methods [<xref ref-type="bibr" rid="pcbi-0010022-b03">3</xref>] and places TE annotation on common conceptual framework with gene annotation [<xref ref-type="bibr" rid="pcbi-0010022-b05">5</xref>–<xref ref-type="bibr" rid="pcbi-0010022-b09">9</xref>]. Compared with annotations generated for the Release 3 sequence [<xref ref-type="bibr" rid="pcbi-0010022-b18">18</xref>], we confirmed precisely 743 out of 1,572 TE annotations. We adjusted the boundaries of 488, joined 80, changed the strand of 66, changed the name of 14, split 16, and described 4,573 new TE annotations. (Note that the number of modifications does not total 1,572 since multiple Release 3 elements were incorporated in a single join). These 4,573 new TE annotations are all supported by significant nucleotide homology to previously recognized families of TEs in <italic>Drosophila</italic>. According to our annotation the euchromatic TE fraction is now estimated to be 5.3% (cf. 3.86% in Release 3.1), and we found a substantially higher number of TEs (<italic>n</italic> = 6,013) than previously identified (<italic>n</italic> = 1,572). Most of the new TEs derive from small fragments of about a few hundred nucleotides long, and from highly abundant families not previously annotated (e.g., <italic>INE-1</italic>). Taking into account the heterochromatic TE fraction estimated by Hoskins et al. [<xref ref-type="bibr" rid="pcbi-0010022-b25">25</xref>] and the fraction of this compartment (1/3 of the genome), we can estimate that in <italic>D. melanogaster</italic> TEs represent about 20% of the whole genome (about 5% of the euchromatin and about 50% of the heterochromatin). The pipeline allows rapid and thorough annotation of even the most complex TE models, including highly deleted and/or nested elements. We now estimate that 518 TE copies (8.6%) are inserted into at least one other TE, forming a nest. A detailed description of abundance and distribution of TEs in Release 4 based on the result of this annotation is in preparation. The full annotation is available through FlyBase (<ext-link ext-link-type="uri" xlink:href="http://www.flybase.org" xlink:type="simple">http://www.flybase.org</ext-link>) and the REPET database (<ext-link ext-link-type="uri" xlink:href="http://dynagen.ijm.jussieu.fr/repet/" xlink:type="simple">http://dynagen.ijm.jussieu.fr/repet/</ext-link>).</p><sec id="s3a"><title>Performance</title><p>Our studies on the Release 3 sequence provide a first detailed genome-wide analysis of different methods for TE detection relative to a manually curated reference set of TE annotations. These results (see <xref ref-type="table" rid="pcbi-0010022-t001">Tables 1</xref> and <xref ref-type="table" rid="pcbi-0010022-t002">2</xref>) provide insight into the strengths and weaknesses of each method and therefore a deeper understanding of the consequences of algorithmic differences for TE detection. In general, our results suggest that BLRn can outperform RM with respect to the precise determination of TE boundaries, and that much of this improvement derives from the joining algorithm implemented in MATCHER. On the other hand, RM appears to be more sensitive for the detection of small and divergent TE copies. RM can detect small copies with less than 80% of identity with the reference sequence, while BLRn misses these small copies. This increase in sensitivity comes with a cost, as RM predicts many spurious hits for TE families with simple repeats in their reference sequence. Overall, we found that the differences between BLRn and RM make them very complementary for TE annotation when hits from both methods are chained with MATCHER, and that a simple-repeat-filtered version can be used to promote reliable TE models automatically.</p><p>There are many reasons why BLRn and RM perform differently. One obvious reason is that the initial word length used to seed the alignments is shorter for RM than for BLRn (nine for Cross_match versus 11 for BLASTN). Another reason is that RM chooses its scoring scheme (a match–mismatch matrix) according to the background percent guanine/cytosine composition. A third explanation could come from the final Smith–Waterman alignment performed by RM, allowing it to produce longer alignments in low identity regions. Likewise, in some particularly difficult cases where a genomic TE copy has a duplicated segment, BLRn gives a better annotation because it relies only on BLASTN hits that allow a small level of overlap between adjacent hits. The final Smith–Waterman alignment performed by RM is disturbed in these cases, at best placing a gap to face the duplicated segment. The first two reasons are a matter of parameter values, and the differences may simply be due to our use of default parameters. The more sensitive parameter set of RM has a cost in term of speed, and the trade-off between speed and sensitivity between BLRn and RM is not the same (BLRn is at least 3-fold faster). Using different parameter values could improve either BLRn sensitivity and/or RM speed. It remains to be determined to what degree the sensitivity of BLRn can be improved to a level equivalent to RM just by changing the BLASTN parameters, since the use of different match–mismatch matrices (each optimal for a background percent guanine/cytosine level) is an important difference between the two methods, and may limit BLRn sensitivity gains.</p></sec><sec id="s3b"><title>Pitfalls</title><p>From our manual edits, we were able to identify some pitfalls that could be avoided in future attempts at a fully automated TE annotation process. One of the most important problems arises from the annotation of symmetrical structures, such as terminal inverted repeats (TIRs) and long terminal repeats (LTRs). There may be palindromic structures, such as in the <italic>FB</italic> element [<xref ref-type="bibr" rid="pcbi-0010022-b26">26</xref>]. Often the two TIRs of a genomic <italic>FB</italic> element are detected on different strands, i.e., the 5′ TIR on the positive and the 3′ TIR on the negative strand. This happens because the two TIRs are not identical in the reference sequence. Thus, if the two TIRs of the genomic copy are more similar to each other than to the appropriate TIR in the reference sequence, only one TIR of the reference (the most similar one) is used to detect the two genomic TIRs, but on different strands. To avoid this type of manual edit, we suggest using a reference sequence with identical TIRs. A similar pitfall occurs with LTR retrotransposons. If the two LTRs are not identical on the reference, a genomic copy can be detected with two 5′ LTRs (or 3′ LTRs) if its LTRs are more similar to each other than to the appropriate LTRs of the reference sequence. If a join is necessary because of an indel in the genomic copy, our algorithm fails since the coordinates on the reference sequence are not collinear. To avoid this, we suggest using reference sequences with identical LTRs.</p><p>Some non-LTR retrotransposon genomic copies have to be extended in 3′ direction to encompass the entire polyadenine (poly[A]) tail. This occurs because the reference sequence has a shorter poly(A) tail than a particular genomic copy. In general, these cases are easily identified by observing an overlapping poly(A) simple repeat at the 3′ end of the element. One solution to this problem is to extend the poly(A) tail of non-LTR retrotransposons in the reference set to the length of the longest observed genomic copy.</p><p>The biggest pitfall we have encountered is the problem posed by simple repeats that exist in TE reference sequences. Without a specific treatment of this problem we would have included 3,040 spurious hits—approximately one-third of our original set of annotations. Filtering simple repeats on the genomic or reference sequences without affecting the sensitivity of TE detection is not easy. We have developed an effective (but ad hoc) two-step filtering strategy, but the magnitude of this problem leaves room for future improvements. Currently we employ RM to detect simple repeats, although refined parameter optimization may reveal that other more specialized simple repeat detection software, such as TRF [<xref ref-type="bibr" rid="pcbi-0010022-b21">21</xref>], Mreps [<xref ref-type="bibr" rid="pcbi-0010022-b22">22</xref>], or other methods (e.g., [<xref ref-type="bibr" rid="pcbi-0010022-b27">27</xref>]) might be more appropriate. A careful evaluation of methods and parameters for simple repeat detection may allow us to decrease our 170-bp threshold and avoid the rescue step.</p><p>Regardless of the best method or criteria to detect simple repeats, the existence of simple repeats in TE reference sequences raises an important problem, since it is difficult to unambiguously determine whether a simple repeat with homology to a TE is a spurious hit or reflects a true remnant of that TE in the genome. Our methods guarantee that if we leave a spurious hit in the annotation because of homology with a simple repeat, it is more than 170 bp long. Moreover, any potentially real TE labeled as spurious that did not survive our rescue strategy bears no unique hallmarks of being generated by a TE. Nevertheless, the possibility of the involvement of TEs in the genesis of microsatellites [<xref ref-type="bibr" rid="pcbi-0010022-b28">28</xref>] highlights the fundamental biological difficulty in resolving real from spurious simple repeats in a whole-genome TE annotation.</p></sec><sec id="s3c"><title>Conclusions and Future Directions</title><p>We have shown in this work that a combined-evidence framework can improve the quality and confidence of TE annotations in <italic>D. melanogaster</italic>. Our automated pipeline allows us to annotate TEs on a genomic scale quickly and accurately, and the integration of our pipeline with the Apollo annotation tool also allows rapid evaluation and manual editing of TE annotations for even complex TE models. Based on the lessons learned in this study, we are continuing to develop and improve our pipeline. We are automating several classes of the manual edits that we have identified and expect that progressively fewer manual edits will be necessary in the future, allowing application of our pipeline to larger genome sequences such as the human sequence. One possible solution to the simple repeat problem is to develop a “combined sensor” model that would seek to resolve competing signals between simple repeats and TE models. It may also be possible to predict nested elements that require manual edits by using a stochastic context-free grammar [<xref ref-type="bibr" rid="pcbi-0010022-b29">29</xref>] approach to model the different components of TE nests more generally; stochastic context-free grammars may also be useful in resolving problems encountered in annotating TEs with terminal repeats. The annotations presented here could be used as a training set to estimate the utility of these types of models.</p><p>We have observed several cases in the genome annotation where one or more de novo methods (RECON, BLRa, BLRtx, and TE-HMM) simultaneously support a potential sequence belonging to a new TE family. In addition, results of our analyses with tools that detect anonymous TEs (see <xref ref-type="table" rid="pcbi-0010022-t002">Table 2</xref>) suggest that there may be many additional families of TEs yet to be discovered in the <italic>D. melanogaster</italic> genome. Since the methods that support these predictions potentially suffer from a high false positive rate, we have chosen not to include them in our current annotation, since more work needs to be done to validate these potential new TE families. Nevertheless the combined evidence for some of these elements is compelling and such cases are available for mining in our current results.</p><p>In general, the problem of TE discovery remains a major challenge for TE annotation. A good TE annotation relies critically on an expertly assembled reference sequence set, data that currently cannot be obtained in an automatic fashion. This crucial step is now the bottleneck in any method or pipeline to annotate TEs in genome sequences (see also [<xref ref-type="bibr" rid="pcbi-0010022-b03">3</xref>]). The task to assemble such reference sets will be most difficult in genomes where only a few TE families are known. In these situations, we will need good de novo TE detection procedures [<xref ref-type="bibr" rid="pcbi-0010022-b10">10</xref>–<xref ref-type="bibr" rid="pcbi-0010022-b16">16</xref>] that can only be trained and evaluated properly using high-quality TE annotations in well-studied systems such as <italic>Drosophila</italic>. We hope that the TE annotations presented here will serve to further the development and refinement of TE discovery and annotation methods in general, as the Release 3.1 annotations have served for the development of our current methods.</p><p>Finally, we are also developing our pipeline to include methods for the detailed annotation of the structural features (open reading frames, LTRs, etc.) in TE sequences. Development of such detailed annotation methodologies will allow a detailed evaluation of the coding and expression potential of individual TE annotations in genomic sequences. Moreover, the ability to automatically annotate structural features of TEs will facilitate the manual curation and validation of candidate TE sequences resulting from one or several different de novo TE discovery methods [<xref ref-type="bibr" rid="pcbi-0010022-b10">10</xref>–<xref ref-type="bibr" rid="pcbi-0010022-b16">16</xref>]. Continued development of this pipeline, together with other advances in the field of TE genome informatics, will lead to a robust computational framework that can shed light on the origin and impact of TEs in modern genomes.</p></sec></sec><sec id="s4"><title>Materials and Methods</title><sec id="s4a"><title>Data.</title><p>The <italic>D. melanogaster</italic> genomic sequences and TE reference sets are available from BDGP (<ext-link ext-link-type="uri" xlink:href="http://www.fruitfly.org/p_disrupt/TE.html" xlink:type="simple">http://www.fruitfly.org/</ext-link>). The Release 3.1 <italic>D. melanogaster</italic> genomic sequences and their TE annotations have been extracted from the GAME-XML files. The Release 4 <italic>D. melanogaster</italic> genomic sequences have been downloaded as fasta files. TE reference sequence sets v.7.1 (used by Kaminker et al. [<xref ref-type="bibr" rid="pcbi-0010022-b18">18</xref>]) and v.9.0 have been downloaded from BDGP.</p><p>Sequences of the TEs were also obtained from the Repbase Update database release 8.12 [<xref ref-type="bibr" rid="pcbi-0010022-b30">30</xref>], which contains all known repeated sequences including TEs (downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.girinst.org" xlink:type="simple">http://www.girinst.org</ext-link>). We used them to detect unknown families by similarity with TEs from other species.</p></sec><sec id="s4b"><title>Sequence analysis software.</title><p>We have improved three C++ programs: BLASTER, MATCHER, and GROUPER, previously presented in Quesneville et al. [<xref ref-type="bibr" rid="pcbi-0010022-b13">13</xref>]. BLASTER can compare two sets of sequences: a query databank against a subject databank. For each sequence in the query databank, BLASTER launches one of the BLAST programs (BLASTN, TBLASTN, BLASTX, TBLASTX, BLASTP, or MegaBLAST) [<xref ref-type="bibr" rid="pcbi-0010022-b17">17</xref>,<xref ref-type="bibr" rid="pcbi-0010022-b31">31</xref>–<xref ref-type="bibr" rid="pcbi-0010022-b33">33</xref>] to search the subject databank. Each BLAST search is launched in parallel on a computer cluster. BLASTER is not limited by the length of sequences. It cuts long sequences before launching BLAST and reassembles the results afterwards. Hence, it can work on whole genomes, in particular, to compare a genome with itself to detect repeats. The results of BLASTER can then be treated by the MATCHER and GROUPER programs described below. For the experiments conducted here, NCBI-BLAST2 (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nlm.nih.gov/blast/" xlink:type="simple">ftp://ftp.ncbi.nlm.nih.gov/blast/</ext-link>) programs were used with default parameters, using as a query genomic fragments of 50 kb, overlapping by 100 bp.</p><p>MATCHER has been developed to map match results onto query sequences by first filtering overlapping hits. When two matches overlap on the genomic (query) sequence, the one with the best alignment score is kept; the other is truncated so that only nonoverlapping regions remain on the match. As a result of this procedure a match is totally removed only if it is included in a longer one with a best score. All matches that have <italic>E</italic>-value greater than 1 × 10<sup>−10</sup> or length of 20 or less are eliminated.</p><p>Long insertions (or deletions) in the query or subject could result in two matches, instead of one with a long gap. Thus, the remaining matches are chained by dynamic programming. A score is calculated by summing match scores and subtracting a gap penalty (0.05 times the gap length) and a mismatch penalty (0.2 times the mismatch length region) as in [<xref ref-type="bibr" rid="pcbi-0010022-b34">34</xref>].</p><p>The chaining algorithm ([<xref ref-type="bibr" rid="pcbi-0010022-b35">35</xref>], pp. 325–329) is modified to produce local alignments. A match is chained with a chain of other matches only if the resulting score is greater than the score of the match alone. Thus, the chaining is stopped if the score of the resulting chain of matches is less than if the match is not chained. The best-scoring chain is kept. Then to identify other match chains, the chain previously found is removed, and we search again for the next best match chain. This is done iteratively until no chain is found. This algorithm is repeated independently for match on strand +/+, +/−, and −/+. A maximum of 20% of overlap between the matches is allowed. The chaining algorithm allows the recovery of TEs containing long insertions, and therefore can identify nested elements accurately: they appear as a long insertion inside another TE.</p><p>GROUPER uses matches (or chained matches) to gather similar sequences into groups by simple link clustering. A match belongs to a group if one of the two matching sequence coordinates overlaps a sequence coordinate of this group by more than a given length coverage percentage threshold (a program parameter). If the two matches overlap with this constraint, their coordinates are merged, taking the extremum of the both. Groups that share sequence locations—not previously grouped because of a too low length coverage percentage—are regrouped into what we call a cluster. As a result of these procedures, each group contains sequences that are homogeneous in length. A given region may belong to several groups, but all of these groups belong to the same cluster.</p><p>RepeatMasker (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org" xlink:type="simple">http://www.repeatmasker.org</ext-link>) screens for TEs and low-complexity DNA sequences. It detects TEs in nucleic acid sequences by nucleic sequence alignment with previously characterized elements using the program Cross_match (<ext-link ext-link-type="uri" xlink:href="http://www.phrap.org/phredphrapconsed.html" xlink:type="simple">http://www.phrap.org/phredphrapconsed.html</ext-link>) or WU-BLAST (<ext-link ext-link-type="uri" xlink:href="http://blast.wustl.edu" xlink:type="simple">http://blast.wustl.edu</ext-link>) with the script MaskerAid [<xref ref-type="bibr" rid="pcbi-0010022-b36">36</xref>]. Both alignment programs perform their Smith–Waterman alignments by first identifying exact word matches and restricting the alignment to a band or matrix surrounding this exact match or matches. According to the background percent guanine/cytosine composition, different similarity matrices (each optimal for a background percent guanine/cytosine level) are used. RepeatMasker annotates the parts of sequences that are very similar to an element from a reference set of “known elements”. Low-complexity DNA regions are detected when stretches of nucleotides are GC- or AT-rich. Simple repeats are detected by searching all di- to pentameric and some hexameric repeats, allowing for possible variation within repeats.</p><p>RECON [<xref ref-type="bibr" rid="pcbi-0010022-b10">10</xref>] is an automated process for de novo identification of new repeat sequence families in sequenced genomes. It searches genomic sequences for long repeats and clusters them in groups of similar sequences. TE copies from a given family are expected to cluster together. Its algorithm clusters repeats obtained by an all-by-all sequence comparison (here using BLASTER with BLASTN) and redefines the clusters by the aggregation of endpoints in a multiple alignment of the identified regions. In this way it tends to distinguish true TE copies from copies in a segmental duplication.</p><p>We have shown previously how base compositional differences can be used as a tool for detection and analysis of novel TE sequences [<xref ref-type="bibr" rid="pcbi-0010022-b14">14</xref>]. Hidden Markov models are used to take into account the base composition of the sequences and the heterogeneity between coding and noncoding parts of sequences. We use three sets of sequences from <italic>D. melanogaster</italic> containing class I TEs, class II TEs, and cellular genes. Each of these sets has a distinct, homogeneous composition, enabling us to distinguish between the two classes of TEs and the genes. This approach can be used to detect and annotate TEs in genomic sequences and complements the current homology-based TE detection methods. Furthermore, the hidden Markov model method is able to identify the parts of a sequence in which the nucleotide composition resembles that of a coding region of a TE. This is useful for the detailed annotation of TE sequences, which may contain an ancient, highly diverged coding region that is no longer fully functional.</p></sec><sec id="s4c"><title>Comparison of predictions and annotations.</title><p>We automatically compared predictions obtained with different computational methods to the Release 3.1 TE reference annotations in two ways, each implemented in a custom Python script.</p><p>The first calculated the nucleotide overlaps between the predictions and reference annotations, and computed the genome-wide sensitivity and the specificity. These values were obtained from equations (1) and (2) and the counts of true positive (TP—correctly annotated as belonging to a TE), false positive (FP—falsely predicted as belonging to a TE), true negative (TN—correctly annotated as not belonging to a TE), and false negative (FN—falsely predicted as not belonging to a TE) nucleotides.</p><disp-formula id="pcbi-0010022-e001"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0010022.e001" xlink:type="simple"/><!-- <math display='block'><mrow><mtext>Sensitivity&equals;</mtext><mfrac><mrow><mtext>TP</mtext></mrow><mrow><mtext>TP&plus;FN</mtext></mrow></mfrac></mrow></math> --></disp-formula><disp-formula id="pcbi-0010022-e002"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0010022.e002" xlink:type="simple"/><!-- <math display='block'><mrow><mtext>Specificity</mtext><mo>&equals;</mo><mfrac><mrow><mtext>TN</mtext></mrow><mrow><mtext>TN</mtext><mo>&plus;</mo><mtext>FP</mtext></mrow></mfrac></mrow></math> --></disp-formula><p>A high sensitivity indicates that a method misses few TE nucleotides (few false negatives). A high specificity indicates that a method finds few false positive nucleotides.</p><p>The second Python script compared the boundaries of predictions to the boundaries of the reference annotations. For each prediction under test, we searched the reference annotations that overlapped on the same genomic region. Different cases could be distinguished according to one-to-one, one-to-many, many-to-one, or many-to-many relationships (see <xref ref-type="fig" rid="pcbi-0010022-g003">Figure 3</xref> for details).</p><fig id="pcbi-0010022-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0010022.g003</object-id><label>Figure 3</label><caption><title>Categories of Possible Boundary Comparisons between Predictions and Reference Annotations</title><p>The different cases taken into account can be grouped according to one-to-one (1-to-1), one-to-many (1-to-<italic>n</italic>), many-to-one (<italic>n</italic>-to-1), or many-to-many (<italic>n</italic>-to-<italic>n</italic>) relationships.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0010022.g003" xlink:type="simple"/></fig><p>For those that had a one-to-one correspondence with the same TE family, we calculated the difference in distances between predictions and annotations for their respective 5′ and 3′ coordinates. We categorized the differences in distance into three classes: ≤1 bp, ≤10 bp, or &gt;10 bp. We called “exact” annotations those that had distances at both extremities ≤ 1 bp, “near exact” those for which the distance at one extremity was ≤ 1 bp and that of the other was &gt;1 bp and ≤10 bp, and “one side exact” those for which one extremity was ≤1 bp and the other was &gt;10 bp. Cases where both distances were &gt; 1 bp and ≤ 10 bp were called “equivalent”; if one distance was &gt; 1 bp and ≤ 10 bp and the other was &gt;10 bp, the case was “near equivalent”; and if both distances were &gt; 10 bp, the case was “similar”.</p><p>We also considered many-to-one relationships. Some were method errors in which a genomic copy (given by the reference annotation) had a large insertion or deletion. In this case, the two fragments (flanking the indel) were predicted as two separate copies, and the fragments were not joined. We called this error class “method not joined”. We also found cases in which two predictions were falsely considered as one in the reference annotation. Here, a long region of mismatch separated two fragments and the most parsimonious explanation was the independent insertion of two copies. These were “annotation over-joined” cases. We also found cases considered as one copy by the reference annotation, but that were in fact copies with a self-duplicated region. If the duplication was nested we call it “same TE nested”, or if not nested, “TE duplication”.</p><p>One-to-many relationships were cases in which two annotations in the reference were found joined by the method. We called this “annotation not joined”.</p><p>One-to-zero relationships corresponded to cases in which a prediction did not correspond to a reference annotation. “New TE” cases were copies identified by the method under test but not present in the reference annotation, and “different TE” cases were those overlapping a reference annotation but with a different TE family name. A TE prediction included in a prediction of a different family already involved in a given relationship with reference annotations, was called “new nest” if no corresponding reference annotation could be found. Annotation correspondence of the same TE family but on different strand was called “other strand” if the relationship was one-to-one; otherwise they were “new TE”.</p><p>Finally we had a “complex structure” case when the relation was many-to-many.</p><p>The script could be also used in an anonymous mode to test boundaries of de novo predictions that do not use a specific reference sequence. The information used for such comparisons is of poorer quality since we do not have alignment coordinates on the reference sequence (i.e., RECON and TE-HMM), which renders several categories meaningless (e.g., “different TE”, but also “new nest”, “other strand”, and “TE duplication”).</p></sec></sec></body><back><ack><p>We thank Clémentine Vitte for help testing of BLASTER, Chris Mungall for early comparative analyses on Release 3, Emmanuel Mongin for the initial Release 4 mapping of Release 3.1 TE annotations, and Dave Emmert for assistance loading our Release 4 TE annotations into FlyBase. We thank Sima Misra, Chelsea Scholl, and three anonymous reviewers for helpful suggestions on the manuscript. This work was supported by the Centre National de Recherche Scientifique (CNRS), the Universities P. and M. Curie and D. Diderot (Institut Jacques Monod, UMR 7592, Dynamique du Génome et Evolution) and by the Programme Bio-Informatique (CNRS). CMB was supported by a USA Research Fellowship from the Royal Society. Work in MA's laboratory was supported by an MRC Programme Grant to MA and S. Russell.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>BDGP</term><def><p>Berkeley <italic>Drosophila</italic> Genome Project</p></def></def-item><def-item><term>BLRa</term><def><p>all-by-all genome comparison with BLASTER using BLASTN followed by chaining with MATCHER and grouping with GROUPER</p></def></def-item><def-item><term>BLRn</term><def><p>BLASTER using BLASTN followed by chaining with MATCHER</p></def></def-item><def-item><term>BLRtx</term><def><p>BLASTER using TBLASTX with the entire Repbase Update as the database, followed by chaining with MATCHER</p></def></def-item><def-item><term>BLRtxNoDros</term><def><p>BLASTER using TBLASTX with the Repbase Update with <italic>Drosophila</italic> TEs removed as the database, followed by chaining with MATCHER</p></def></def-item><def-item><term>LTR</term><def><p>long terminal repeat</p></def></def-item><def-item><term>poly(A)</term><def><p>polyadenine</p></def></def-item><def-item><term>RM</term><def><p>RepeatMasker using default parameters</p></def></def-item><def-item><term>RMBLR</term><def><p>RepeatMasker-BLASTER</p></def></def-item><def-item><term>RMm</term><def><p>RepeatMasker using default parameters followed by chaining with MATCHER</p></def></def-item><def-item><term>TE</term><def><p>transposable element</p></def></def-item><def-item><term>TE-HMM</term><def><p>hidden Markov Model that detects TE coding sequences based on nucleotide composition</p></def></def-item><def-item><term>TIR</term><def><p>terminal inverted repeat</p></def></def-item><def-item><term>TRF</term><def><p>Tandem Repeat Finder</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0010022-b01"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name><name name-style="western"><surname>Linton</surname><given-names>LM</given-names></name><name name-style="western"><surname>Birren</surname><given-names>B</given-names></name><name name-style="western"><surname>Nusbaum</surname><given-names>C</given-names></name><name name-style="western"><surname>Zody</surname><given-names>MC</given-names></name><etal/></person-group>
					<year>2001</year>
					<article-title>Initial sequencing and analysis of the human genome.</article-title>
					<source>Nature</source>
					<volume>409</volume>
					<fpage>860</fpage>
					<lpage>921</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b02"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kidwell</surname><given-names>MG</given-names></name><name name-style="western"><surname>Lisch</surname><given-names>DR</given-names></name></person-group>
					<year>2001</year>
					<article-title>Perspective: Transposable elements, parasitic DNA, and genome evolution.</article-title>
					<source>Evolution Int J Org Evolution</source>
					<volume>55</volume>
					<fpage>1</fpage>
					<lpage>24</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b03"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Juretic</surname><given-names>N</given-names></name><name name-style="western"><surname>Bureau</surname><given-names>TE</given-names></name><name name-style="western"><surname>Bruskiewich</surname><given-names>RM</given-names></name></person-group>
					<year>2004</year>
					<article-title>Transposable element annotation of the rice genome.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<fpage>155</fpage>
					<lpage>160</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b04"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Misra</surname><given-names>S</given-names></name><name name-style="western"><surname>Crosby</surname><given-names>MA</given-names></name><name name-style="western"><surname>Mungall</surname><given-names>CJ</given-names></name><name name-style="western"><surname>Matthews</surname><given-names>BB</given-names></name><name name-style="western"><surname>Campbell</surname><given-names>KS</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>Annotation of the <italic>Drosophila melanogaster</italic> euchromatic genome: A systematic review.</article-title>
					<source>Genome Biol</source>
					<volume>3</volume>
					<fpage>RESEARCH0083</fpage>
				</element-citation></ref><ref id="pcbi-0010022-b05"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mungall</surname><given-names>CJ</given-names></name><name name-style="western"><surname>Misra</surname><given-names>S</given-names></name><name name-style="western"><surname>Berman</surname><given-names>BP</given-names></name><name name-style="western"><surname>Carlson</surname><given-names>J</given-names></name><name name-style="western"><surname>Frise</surname><given-names>E</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>An integrated computational pipeline and database to support whole-genome sequence annotation.</article-title>
					<source>Genome Biol</source>
					<volume>3</volume>
					<fpage>RESEARCH0081</fpage>
				</element-citation></ref><ref id="pcbi-0010022-b06"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Allen</surname><given-names>JE</given-names></name><name name-style="western"><surname>Pertea</surname><given-names>M</given-names></name><name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name></person-group>
					<year>2004</year>
					<article-title>Computational gene prediction using multiple sources of evidence.</article-title>
					<source>Genome Res</source>
					<volume>14</volume>
					<fpage>142</fpage>
					<lpage>148</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b07"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ding</surname><given-names>L</given-names></name><name name-style="western"><surname>Sabo</surname><given-names>A</given-names></name><name name-style="western"><surname>Berkowicz</surname><given-names>N</given-names></name><name name-style="western"><surname>Meyer</surname><given-names>RR</given-names></name><name name-style="western"><surname>Shotland</surname><given-names>Y</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>EAnnot: A genome annotation tool using experimental evidence.</article-title>
					<source>Genome Res</source>
					<volume>14</volume>
					<fpage>2503</fpage>
					<lpage>2509</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b08"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ashurst</surname><given-names>JL</given-names></name><name name-style="western"><surname>Chen</surname><given-names>CK</given-names></name><name name-style="western"><surname>Gilbert</surname><given-names>JG</given-names></name><name name-style="western"><surname>Jekosch</surname><given-names>K</given-names></name><name name-style="western"><surname>Keenan</surname><given-names>S</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>The Vertebrate Genome Annotation (Vega) database.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>D459</fpage>
					<lpage>D465</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b09"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Haas</surname><given-names>BJ</given-names></name><name name-style="western"><surname>Wortman</surname><given-names>JR</given-names></name><name name-style="western"><surname>Ronning</surname><given-names>CM</given-names></name><name name-style="western"><surname>Hannick</surname><given-names>LI</given-names></name><name name-style="western"><surname>Smith</surname><given-names>RK</given-names><suffix>Jr</suffix></name><etal/></person-group>
					<year>2005</year>
					<article-title>Complete reannotation of the <italic>Arabidopsis</italic> genome: Methods, tools, protocols and the final release.</article-title>
					<source>BMC Biol</source>
					<volume>3</volume>
					<fpage>7</fpage>
				</element-citation></ref><ref id="pcbi-0010022-b10"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bao</surname><given-names>Z</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>2002</year>
					<article-title>Automated <italic>de novo</italic> identification of repeat sequence families in sequenced genomes.</article-title>
					<source>Genome Res</source>
					<volume>12</volume>
					<fpage>1269</fpage>
					<lpage>1276</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b11"><label>11</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Biedler</surname><given-names>J</given-names></name><name name-style="western"><surname>Tu</surname><given-names>Z</given-names></name></person-group>
					<year>2003</year>
					<article-title>Non-LTR retrotransposons in the African malaria mosquito, <italic>Anopheles gambiae:</italic> Unprecedented diversity and evidence of recent activity.</article-title>
					<source>Mol Biol Evol</source>
					<volume>20</volume>
					<fpage>1811</fpage>
					<lpage>1825</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b12"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>McCarthy</surname><given-names>EM</given-names></name><name name-style="western"><surname>McDonald</surname><given-names>JF</given-names></name></person-group>
					<year>2003</year>
					<article-title>LTR_STRUC: A novel search and identification program for LTR retrotransposons.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<fpage>362</fpage>
					<lpage>367</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b13"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Quesneville</surname><given-names>H</given-names></name><name name-style="western"><surname>Nouaud</surname><given-names>D</given-names></name><name name-style="western"><surname>Anxolabehere</surname><given-names>D</given-names></name></person-group>
					<year>2003</year>
					<article-title>Detection of new transposable element families in <italic>Drosophila melanogaster</italic> and <italic>Anopheles gambiae</italic> genomes.</article-title>
					<source>J Mol Evol</source>
					<volume>57</volume>
					<fpage>S50</fpage>
					<lpage>S59</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b14"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Andrieu</surname><given-names>O</given-names></name><name name-style="western"><surname>Fiston</surname><given-names>AS</given-names></name><name name-style="western"><surname>Anxolabehere</surname><given-names>D</given-names></name><name name-style="western"><surname>Quesneville</surname><given-names>H</given-names></name></person-group>
					<year>2004</year>
					<article-title>Detection of transposable elements by their compositional bias.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>5</volume>
					<fpage>94</fpage>
				</element-citation></ref><ref id="pcbi-0010022-b15"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name><name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name></person-group>
					<year>2005</year>
					<article-title>PILER: Identification and classification of genomic repeats.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>I152</fpage>
					<lpage>I158</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b16"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Price</surname><given-names>AL</given-names></name><name name-style="western"><surname>Jones</surname><given-names>NC</given-names></name><name name-style="western"><surname>Pevzner</surname><given-names>PA</given-names></name></person-group>
					<year>2005</year>
					<article-title>De novo identification of repeat families in large genomes.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>I351</fpage>
					<lpage>I358</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b17"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name><name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name><name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name></person-group>
					<year>1990</year>
					<article-title>Basic local alignment search tool.</article-title>
					<source>J Mol Biol</source>
					<volume>215</volume>
					<fpage>403</fpage>
					<lpage>410</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b18"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kaminker</surname><given-names>JS</given-names></name><name name-style="western"><surname>Bergman</surname><given-names>CM</given-names></name><name name-style="western"><surname>Kronmiller</surname><given-names>B</given-names></name><name name-style="western"><surname>Carlson</surname><given-names>J</given-names></name><name name-style="western"><surname>Svirskas</surname><given-names>R</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>The transposable elements of the <italic>Drosophila melanogaster</italic> euchromatin: A genomics perspective.</article-title>
					<source>Genome Biol</source>
					<volume>3</volume>
					<fpage>RESEARCH0084</fpage>
				</element-citation></ref><ref id="pcbi-0010022-b19"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lewis</surname><given-names>SE</given-names></name><name name-style="western"><surname>Searle</surname><given-names>SM</given-names></name><name name-style="western"><surname>Harris</surname><given-names>N</given-names></name><name name-style="western"><surname>Gibson</surname><given-names>M</given-names></name><name name-style="western"><surname>Lyer</surname><given-names>V</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>Apollo: A sequence annotation editor.</article-title>
					<source>Genome Biol</source>
					<volume>3</volume>
					<fpage>RESEARCH0082</fpage>
				</element-citation></ref><ref id="pcbi-0010022-b20"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Celniker</surname><given-names>SE</given-names></name><name name-style="western"><surname>Wheeler</surname><given-names>DA</given-names></name><name name-style="western"><surname>Kronmiller</surname><given-names>B</given-names></name><name name-style="western"><surname>Carlson</surname><given-names>JW</given-names></name><name name-style="western"><surname>Halpern</surname><given-names>A</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>Finishing a whole genome shotgun sequence assembly: Release 3 of the <italic>Drosophila</italic> euchromatic genome sequence.</article-title>
					<source>Genome Biol</source>
					<volume>3</volume>
					<fpage>RESEARCH0079</fpage>
				</element-citation></ref><ref id="pcbi-0010022-b21"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Benson</surname><given-names>G</given-names></name></person-group>
					<year>1999</year>
					<article-title>Tandem repeats finder: A program to analyze DNA sequences.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>27</volume>
					<fpage>573</fpage>
					<lpage>580</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b22"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kolpakov</surname><given-names>R</given-names></name><name name-style="western"><surname>Bana</surname><given-names>G</given-names></name><name name-style="western"><surname>Kucherov</surname><given-names>G</given-names></name></person-group>
					<year>2003</year>
					<article-title>mreps: Efficient and flexible detection of tandem repeats in DNA.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>3672</fpage>
					<lpage>3678</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b23"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Locke</surname><given-names>J</given-names></name><name name-style="western"><surname>Howard</surname><given-names>LT</given-names></name><name name-style="western"><surname>Aippersbach</surname><given-names>N</given-names></name><name name-style="western"><surname>Podemski</surname><given-names>L</given-names></name><name name-style="western"><surname>Hodgetts</surname><given-names>RB</given-names></name></person-group>
					<year>1999</year>
					<article-title>The characterization of <italic>DINE-1,</italic> a short, interspersed repetitive element present on chromosome and in the centric heterochromatin of <italic>Drosophila melanogaster</italic>.</article-title>
					<source>Chromosoma</source>
					<volume>108</volume>
					<fpage>356</fpage>
					<lpage>366</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b24"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Meyerowitz</surname><given-names>EM</given-names></name><name name-style="western"><surname>Hogness</surname><given-names>DS</given-names></name></person-group>
					<year>1982</year>
					<article-title>Molecular organization of a <italic>Drosophila</italic> puff site that responds to ecdysone.</article-title>
					<source>Cell</source>
					<volume>28</volume>
					<fpage>165</fpage>
					<lpage>176</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b25"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hoskins</surname><given-names>RA</given-names></name><name name-style="western"><surname>Smith</surname><given-names>CD</given-names></name><name name-style="western"><surname>Carlson</surname><given-names>JW</given-names></name><name name-style="western"><surname>Carvalho</surname><given-names>AB</given-names></name><name name-style="western"><surname>Halpern</surname><given-names>A</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>Heterochromatic sequences in a <italic>Drosophila</italic> whole-genome shotgun assembly.</article-title>
					<source>Genome Biol</source>
					<volume>3</volume>
					<fpage>RESEARCH0085</fpage>
				</element-citation></ref><ref id="pcbi-0010022-b26"><label>26</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Potter</surname><given-names>S</given-names></name><name name-style="western"><surname>Truett</surname><given-names>M</given-names></name><name name-style="western"><surname>Phillips</surname><given-names>M</given-names></name><name name-style="western"><surname>Maher</surname><given-names>A</given-names></name></person-group>
					<year>1980</year>
					<article-title>Eucaryotic transposable genetic elements with inverted terminal repeats.</article-title>
					<source>Cell</source>
					<volume>20</volume>
					<fpage>639</fpage>
					<lpage>647</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b27"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sagot</surname><given-names>MF</given-names></name><name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name></person-group>
					<year>1998</year>
					<article-title>Identifying satellites and periodic repetitions in biological sequences.</article-title>
					<source>J Comput Biol</source>
					<volume>5</volume>
					<fpage>539</fpage>
					<lpage>553</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b28"><label>28</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wilder</surname><given-names>J</given-names></name><name name-style="western"><surname>Hollocher</surname><given-names>H</given-names></name></person-group>
					<year>2001</year>
					<article-title>Mobile elements and the genesis of microsatellites in dipterans.</article-title>
					<source>Mol Biol Evol</source>
					<volume>18</volume>
					<fpage>384</fpage>
					<lpage>392</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b29"><label>29</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><name name-style="western"><surname>Mitchison</surname><given-names>G</given-names></name></person-group>
					<year>1999</year>
					<source>Biological sequence analysis: Probabilistic models of proteins and nucleic acids</source>
					<publisher-loc>Cambridge</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">368</size>
					<comment>p.</comment>
				</element-citation></ref><ref id="pcbi-0010022-b30"><label>30</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jurka</surname><given-names>J</given-names></name></person-group>
					<year>2000</year>
					<article-title>Repbase update: A database and an electronic journal of repetitive elements.</article-title>
					<source>Trends Genet</source>
					<volume>16</volume>
					<fpage>418</fpage>
					<lpage>420</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b31"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name><name name-style="western"><surname>States</surname><given-names>DJ</given-names></name></person-group>
					<year>1993</year>
					<article-title>Identification of protein coding regions by database similarity search.</article-title>
					<source>Nat Genet</source>
					<volume>3</volume>
					<fpage>266</fpage>
					<lpage>272</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b32"><label>32</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Madden</surname><given-names>TL</given-names></name><name name-style="western"><surname>Schaffer</surname><given-names>AA</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name><etal/></person-group>
					<year>1997</year>
					<article-title>Gapped BLAST and PSI-BLAST: A new generation of protein database search programs.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>25</volume>
					<fpage>3389</fpage>
					<lpage>3402</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b33"><label>33</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name><name name-style="western"><surname>Schwartz</surname><given-names>S</given-names></name><name name-style="western"><surname>Wagner</surname><given-names>L</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name></person-group>
					<year>2000</year>
					<article-title>A greedy algorithm for aligning DNA sequences.</article-title>
					<source>J Comput Biol</source>
					<volume>7</volume>
					<fpage>203</fpage>
					<lpage>214</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b34"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Chao</surname><given-names>KM</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name><name name-style="western"><surname>Ostell</surname><given-names>J</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name></person-group>
					<year>1995</year>
					<article-title>A local alignment tool for very long DNA sequences.</article-title>
					<source>Comput Appl Biosci</source>
					<volume>11</volume>
					<fpage>147</fpage>
					<lpage>153</lpage>
				</element-citation></ref><ref id="pcbi-0010022-b35"><label>35</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gusfield</surname><given-names>D</given-names></name></person-group>
					<year>1997</year>
					<source>Algorithms on strings, trees, and sequences: Computer science and computational biology</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">534</size>
					<comment>p.</comment>
				</element-citation></ref><ref id="pcbi-0010022-b36"><label>36</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bedell</surname><given-names>JA</given-names></name><name name-style="western"><surname>Korf</surname><given-names>I</given-names></name><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name></person-group>
					<year>2000</year>
					<article-title>MaskerAid: A performance enhancement to RepeatMasker.</article-title>
					<source>Bioinformatics</source>
					<volume>16</volume>
					<fpage>1040</fpage>
					<lpage>1041</lpage>
				</element-citation></ref></ref-list></back></article>