<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-11-01911</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002562</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Biophysics</subject>
            <subj-group>
              <subject>Biophysics theory</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Metabolic networks</subject>
              <subject>Systems biology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
          <subject>Biophysics</subject>
        </subj-group>
      </article-categories><title-group><article-title>A Scalable Algorithm to Explore the Gibbs Energy Landscape of Genome-Scale Metabolic Networks</article-title><alt-title alt-title-type="running-head">Exploring the Gibbs Energy Landscape of Metabolism</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>De Martino</surname>
            <given-names>Daniele</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Figliuzzi</surname>
            <given-names>Matteo</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>De Martino</surname>
            <given-names>Andrea</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Marinari</surname>
            <given-names>Enzo</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Dipartimento di Fisica, Sapienza Università di Roma, Roma, Italy</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>CNR-IPCF, Unità di Roma-Sapienza, Roma, Italy</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Beard</surname>
            <given-names>Daniel A.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Medical College of Wisconsin, United States of America</aff><author-notes>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: ADM EM. Performed the experiments: DDM MF. Analyzed the data: DDM MF. Contributed reagents/materials/analysis tools: DDM MF ADM EM. Wrote the paper: DDM MF ADM EM.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>6</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>21</day>
        <month>6</month>
        <year>2012</year>
      </pub-date><volume>8</volume><issue>6</issue><elocation-id>e1002562</elocation-id><history>
        <date date-type="received">
          <day>19</day>
          <month>12</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>2</day>
          <month>5</month>
          <year>2012</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>De Martino et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>The integration of various types of genomic data into predictive models of biological networks is one of the main challenges currently faced by computational biology. Constraint-based models in particular play a key role in the attempt to obtain a quantitative understanding of cellular metabolism at genome scale. In essence, their goal is to frame the metabolic capabilities of an organism based on minimal assumptions that describe the steady states of the underlying reaction network via suitable stoichiometric constraints, specifically <italic>mass balance</italic> and <italic>energy balance</italic> (i.e. thermodynamic feasibility). The implementation of these requirements to generate viable configurations of reaction fluxes and/or to test given flux profiles for thermodynamic feasibility can however prove to be computationally intensive. We propose here a fast and scalable stoichiometry-based method to explore the Gibbs energy landscape of a biochemical network at steady state. The method is applied to the problem of reconstructing the Gibbs energy landscape underlying metabolic activity in the human red blood cell, and to that of identifying and removing thermodynamically infeasible reaction cycles in the <italic>Escherichia coli</italic> metabolic network (iAF1260). In the former case, we produce consistent predictions for chemical potentials (or log-concentrations) of intracellular metabolites; in the latter, we identify a restricted set of loops (23 in total) in the periplasmic and cytoplasmic core as the origin of thermodynamic infeasibility in a large sample (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e001" xlink:type="simple"/></inline-formula>) of flux configurations generated randomly and compatibly with the prior information available on reaction reversibility.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>The operation of biological systems is constrained under all circumstances by the laws of physics. Thermodynamics, in particular, dictates preferential directions in which biochemical reactions should flow at stationarity. When applied to cellular reaction systems (like metabolic networks), it favors the emergence of some (thermodynamically feasible) ways to organize the flow of matter while prohibiting others. The development of detailed predictive models for the biochemical activity of a cell relies on the possibility to integrate the laws of thermodynamics in genome-scale reconstructions of cellular metabolic networks. In this work we have devised an efficient relaxation algorithm to implement thermodynamic constraints in genome-scale models. Besides allowing to check for thermodynamic feasibility of reaction flow configurations, it is also capable of providing information on other relevant physico-chemical quantities. We have applied it to two cellular metabolic networks of different complexity, namely that of human red blood cells and that of the bacterium <italic>Escherichia coli</italic>. In the former case, we have obtained predictions for the intracellular chemical state (in terms of metabolite concentrations and reaction free energies) consistent with empirical knowledge; in the latter, we have effectively corrected thermodynamically infeasible flux configurations.</p>
      </abstract><funding-group><funding-statement>Work was supported by the DREAM Seed Project of the Italian Institute of Technology (IIT) and by the joint IIT/Sapienza Lab “Nanomedicine”. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="12"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Constraint-based models of cellular metabolism are important tools to analyze and predict the chemical activity and response to perturbations of cells without relying on kinetic details that are often unavailable. In such frameworks, the metabolic capabilities of a cell are inferred from the overall configuration space compatible with minimal physico-chemical constraints describing the non-equilibrium steady state of the underlying reaction network. First, feasible reaction flux vectors need to satisfy mass-balance conditions. Then, according to the second law of thermodynamics, in an open chemical network at steady state and constant temperature and pressure the direction of each reaction should ensure a decrease in Gibbs energy. Thermodynamic consistency of flux configurations satisfying mass-balance alone is in general not guaranteed due to the presence of infeasible cycles <xref ref-type="bibr" rid="pcbi.1002562-Beard1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1002562-Beard3">[3]</xref>, even if reaction reversibility is pre-assigned based on careful estimations of chemical potentials in physiologic conditions <xref ref-type="bibr" rid="pcbi.1002562-Alberty1">[4]</xref> (a procedure that was recently extended to genome-scale <xref ref-type="bibr" rid="pcbi.1002562-Jankowski1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1002562-Fleming1">[6]</xref>). Besides the flux organization, several other aspects involved in the analysis of genome-scale metabolic networks hinge directly on the explicit inclusion of thermodynamic constraints into the models, like the estimation of metabolite concentrations or the identification of reactions subject to regulation <xref ref-type="bibr" rid="pcbi.1002562-Kmmel1">[7]</xref>.</p>
      <p>Much work has been concerned with implementing thermodynamic constraints in genome-scale models of metabolism. The removal of thermodynamic inconsistencies was proved to be useful in estimating concentrations and affinities besides fluxes in Flux-Balance-Analysis <xref ref-type="bibr" rid="pcbi.1002562-Kauffman1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002562-Orth1">[9]</xref>, whose goal is to identify mass-balanced flux configurations maximizing a pre-determined physiological objective function <xref ref-type="bibr" rid="pcbi.1002562-Schtz1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1002562-Feist1">[11]</xref>. This has been achieved for instance by building mixed integer-linear or non-linear optimization problems that minimize the Euclidean distance of concentration levels from experimentally known values <xref ref-type="bibr" rid="pcbi.1002562-Hoppe1">[12]</xref>, or ensure the absence of cycles in the resulting flux pattern <xref ref-type="bibr" rid="pcbi.1002562-Henry1">[13]</xref>–<xref ref-type="bibr" rid="pcbi.1002562-Beard4">[15]</xref>. On the other hand, information on feasible Gibbs energy ranges can be retrieved by exploiting the patterns of reaction interconnections encoded in the stoichiometry to narrow the experimental bounds <xref ref-type="bibr" rid="pcbi.1002562-Kmmel1">[7]</xref>. These procedures may however require reliable prior thermodynamic information on metabolites and/or reactions, a type of knowledge that is often unavailable. An important lesson of this kind of approaches is that the key input for the thermodynamic profiling of a reaction network is often provided by the stoichiometric matrix <xref ref-type="bibr" rid="pcbi.1002562-Yang1">[16]</xref>.</p>
      <p>The scalability of algorithms to solve mixed integer-linear (or non-linear) programming problems may become an issue when the underlying network size is large or when one is interested in sampling the solution space (for both free energies and fluxes) rather than focusing on a potentially small set of configurations (e.g. optima). Luckily, however, solutions to computationally hard problems can often be generated efficiently with the help of heuristic algorithms based on simple local rules. The use of message-passing algorithms to characterize the high-dimensional volume of the solution space of FBA models <xref ref-type="bibr" rid="pcbi.1002562-Braunstein1">[17]</xref> (with a convex, continuous solution space) or to solve large combinatorial constraint-satisfaction problems <xref ref-type="bibr" rid="pcbi.1002562-Mzard1">[18]</xref> (with a discrete and possibly fragmented solution space) is an example of the success of this kind of strategy.</p>
      <p>Our goal in this paper is to obtain information about the landscape of Gibbs free energies compatible with a given vector of reaction directions by following a route that allows to use all stoichiometric information via heuristics inspired by perceptron learning. In a nutshell, the method we propose consists in exploiting the network's structure to iteratively build up correlations between the chemical potentials of the reacting species starting from a seed of empirical biochemical knowledge, until a thermodynamically consistent profile is achieved. The resulting algorithm is completely scalable and can be employed for different purposes, like checking the feasibility of flux configurations, identifying and removing infeasible cycles, estimating reaction affinities, and obtaining bounds for (log−)concentrations and free energies of formation.</p>
      <p>In the following, we describe the method in detail, providing a mathematical proof of convergence as well as theoretical arguments highlighting the main idea behind the procedure. As applications, we focus on two metabolic networks of rather different complexity. First, we shall obtain a detailed reconstruction of the Gibbs energy landscape underlying metabolic activity in the human red blood cell (hRBC) starting from the flux maps obtained in <xref ref-type="bibr" rid="pcbi.1002562-Price1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1002562-DeMartino1">[20]</xref>. Then, the metabolic network of <italic>Escherichia coli</italic>, iAF1260 <xref ref-type="bibr" rid="pcbi.1002562-Feist2">[21]</xref>, will be analyzed to eliminate infeasible cycles from randomly generated flux configurations.</p>
    </sec>
    <sec id="s2" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s2a">
        <title>Materials</title>
        <p>The cellular systems analyzed in this study are (i) the model of the hRBC metabolism developed in <xref ref-type="bibr" rid="pcbi.1002562-Wiback1">[22]</xref> and discussed in <xref ref-type="bibr" rid="pcbi.1002562-Price1">[19]</xref>, and (ii) the reconstructed metabolic network of the bacterium <italic>Escherichia coli</italic> iAF1260, presented in <xref ref-type="bibr" rid="pcbi.1002562-Feist2">[21]</xref>. The former consists of 35 intracellular reactions among <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e002" xlink:type="simple"/></inline-formula> metabolites subject to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e003" xlink:type="simple"/></inline-formula> uptake fluxes. The latter includes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e004" xlink:type="simple"/></inline-formula> reactions among <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e005" xlink:type="simple"/></inline-formula> metabolites. The basic information extracted from these models is the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e006" xlink:type="simple"/></inline-formula> stoichiometric matrix (with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e007" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e008" xlink:type="simple"/></inline-formula> the number of metabolites and reactions, respectively), denoted below as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e009" xlink:type="simple"/></inline-formula>. For <italic>Escherichia coli</italic>, we will consider the inner matrix of periplasmic and cytoplasmic reactions without repetitions, which consists of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e010" xlink:type="simple"/></inline-formula> reactions among <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e011" xlink:type="simple"/></inline-formula> chemical species, once periplasmic and cytoplasmic metabolites are distinguished. According to the reversibility assignment given in <xref ref-type="bibr" rid="pcbi.1002562-Feist2">[21]</xref>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e012" xlink:type="simple"/></inline-formula> of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e013" xlink:type="simple"/></inline-formula> processes above are unidirectional, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e014" xlink:type="simple"/></inline-formula> being reversible. The biochemical data we shall refer to or make use of include the standard free energies of formation of metabolites, given in <xref ref-type="bibr" rid="pcbi.1002562-Kmmel2">[23]</xref>, where they are computed at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e015" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e016" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e017" xlink:type="simple"/></inline-formula> and ionic strenght <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e018" xlink:type="simple"/></inline-formula>, according to the prescriptions of <xref ref-type="bibr" rid="pcbi.1002562-Alberty1">[4]</xref>. The estimated intracellular concentration ranges for the hRBC were extracted from the Bionumbers database <xref ref-type="bibr" rid="pcbi.1002562-Milo1">[24]</xref> and refer to measurements in different settings. It is worth to notice that the experimental errors on such values reflect the intrinsic uncertainty due to statistical cell-to-cell fluctuations (since measurements of concentration levels are usually carried out by averaging over numbers of cells ranging from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e019" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e020" xlink:type="simple"/></inline-formula>) and analytical error. The stoichiometric matrix and thermodynamic potentials employed for the analysis of the hRBC are respectively available as Supporting <xref ref-type="supplementary-material" rid="pcbi.1002562.s001">Datasets S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002562.s002">S2</xref>.</p>
      </sec>
      <sec id="s2b">
        <title>Methods</title>
        <sec id="s2b1">
          <title>Algorithm to compute chemical potentials</title>
          <p>According to the second law of thermodynamics, in an open system at constant temperature <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e021" xlink:type="simple"/></inline-formula> and pressure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e022" xlink:type="simple"/></inline-formula> the Gibbs energy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e023" xlink:type="simple"/></inline-formula> (where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e024" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e025" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e026" xlink:type="simple"/></inline-formula> are respectively the energy, volume and entropy of the system) never increases spontaneously. This means that the direction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e027" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e028" xlink:type="simple"/></inline-formula> for forward, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e029" xlink:type="simple"/></inline-formula> for backward) of every chemical reaction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e030" xlink:type="simple"/></inline-formula> occurring in the system should be opposite to the Gibbs energy change <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e031" xlink:type="simple"/></inline-formula> induced by reaction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e032" xlink:type="simple"/></inline-formula>, i.e.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e033" xlink:type="simple"/><label>(1)</label></disp-formula>The equality holds if reaction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e034" xlink:type="simple"/></inline-formula> is in equilibrium. Denoting by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e035" xlink:type="simple"/></inline-formula> the stoichiometric coefficient of reactant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e036" xlink:type="simple"/></inline-formula> in reaction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e037" xlink:type="simple"/></inline-formula>, with the standard sign convention to distinguish substrates (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e038" xlink:type="simple"/></inline-formula>) from products (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e039" xlink:type="simple"/></inline-formula>), the vector of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e040" xlink:type="simple"/></inline-formula>'s for a well-mixed system can be written in terms of the chemical potentials <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e041" xlink:type="simple"/></inline-formula> (where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e042" xlink:type="simple"/></inline-formula> is the Gibbs energy per mole of species <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e043" xlink:type="simple"/></inline-formula>) as (see e.g. <xref ref-type="bibr" rid="pcbi.1002562-Beard1">[1]</xref>, Ch. 1)<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e044" xlink:type="simple"/><label>(2)</label></disp-formula>Given flux vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e045" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e046" xlink:type="simple"/></inline-formula> (i.e. steady-state flux configurations), equation (2) implies that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e047" xlink:type="simple"/></inline-formula>, i.e. that the ‘loop law’ holds. The Gibbs energy landscape reconstruction problem consists, given a vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e048" xlink:type="simple"/></inline-formula> of reaction directions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e049" xlink:type="simple"/></inline-formula>), in generating vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e050" xlink:type="simple"/></inline-formula> that satisfy the system of linear inequalities<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e051" xlink:type="simple"/><label>(3)</label></disp-formula>Note that the solution space of (3) for fixed directions is convex (while non-convexity can arise if directions are allowed to vary). Relaxation methods (see e.g. <xref ref-type="bibr" rid="pcbi.1002562-Schrijver1">[25]</xref>, Ch. 12, or <xref ref-type="bibr" rid="pcbi.1002562-Goffin1">[26]</xref>) are among the most effective procedures to find solutions of systems such as (3). These techniques date back at least to the Jacobi method for solving systems of linear equalities, and were extended to inequalities in the 1950's <xref ref-type="bibr" rid="pcbi.1002562-Agmon1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1002562-Motzkin1">[28]</xref>. In essence, they are iterative methods in which variables are updated so that at every iteration one of the violated inequalities is fixed. While this readjusts the entire vector without a guarantee that constraints that were previously satisfied will be broken, convergence to a solution (if it exists) is guaranteed if the update step is chosen wisely. We shall employ a relaxation algorithm known as MinOver, which was developed in the context of neural network learning <xref ref-type="bibr" rid="pcbi.1002562-Krauth1">[29]</xref>, and has been employed, in a slightly modified form <xref ref-type="bibr" rid="pcbi.1002562-DeMartino2">[30]</xref>, to explore the space of flux states compatible with minimal stability constraints <italic>à la Von Neumann</italic> <xref ref-type="bibr" rid="pcbi.1002562-Martelli1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1002562-DeMartino3">[32]</xref>. <xref ref-type="fig" rid="pcbi-1002562-g001">Figure 1</xref> displays a flowchart of the procedure for the present case. One starts from a ‘trial’ probability distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e052" xlink:type="simple"/></inline-formula> of chemical potential vectors. Its role for the moment is simply that of initializing the algorithm, which is done by generating a random vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e053" xlink:type="simple"/></inline-formula> under <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e054" xlink:type="simple"/></inline-formula>. For simplicity, one may think that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e055" xlink:type="simple"/></inline-formula>, with prescribed distributions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e056" xlink:type="simple"/></inline-formula>, e.g. uniform over a given interval: in this case each initial <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e057" xlink:type="simple"/></inline-formula> is selected randomly and independently from its trial distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e058" xlink:type="simple"/></inline-formula>. On the other hand, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e059" xlink:type="simple"/></inline-formula> might contain prior biochemical information, e.g. by being a uniform distribution centered around the known experimental values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e060" xlink:type="simple"/></inline-formula> and of sufficiently large width to span several orders of magnitude in concentrations. (The precise construction of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e061" xlink:type="simple"/></inline-formula> for our case studies is discussed below.) The algorithm is based on the following steps:</p>
          <list list-type="order">
            <list-item>
              <p>Generate a chemical potential vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e062" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e063" xlink:type="simple"/></inline-formula>.</p>
            </list-item>
            <list-item>
              <p>Compute <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e064" xlink:type="simple"/></inline-formula> from (3) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e065" xlink:type="simple"/></inline-formula> (i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e066" xlink:type="simple"/></inline-formula> is the index of the least satisfied constraint).</p>
            </list-item>
            <list-item>
              <p>If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e067" xlink:type="simple"/></inline-formula> then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e068" xlink:type="simple"/></inline-formula> is a thermodynamically consistent chemical potential vector for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e069" xlink:type="simple"/></inline-formula>; exit (or go to 1 to obtain a different solution).</p>
            </list-item>
            <list-item>
              <p>If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e070" xlink:type="simple"/></inline-formula>, update <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e071" xlink:type="simple"/></inline-formula> as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e072" xlink:type="simple"/><label>(4)</label></disp-formula>(where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e073" xlink:type="simple"/></inline-formula> is a constant and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e074" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e075" xlink:type="simple"/></inline-formula>-th column of matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e076" xlink:type="simple"/></inline-formula>), go to 2 and iterate.</p>
            </list-item>
          </list>
          <fig id="pcbi-1002562-g001" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002562.g001</object-id>
            <label>Figure 1</label>
            <caption>
              <title>Flowchart of the algorithm.</title>
              <p>Given a stoichiometric matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e077" xlink:type="simple"/></inline-formula> and a generic vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e078" xlink:type="simple"/></inline-formula> of reaction directions, the algorithm generates a vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e079" xlink:type="simple"/></inline-formula> of chemical potentials if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e080" xlink:type="simple"/></inline-formula> is thermodynamically feasible. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e081" xlink:type="simple"/></inline-formula> may for instance be taken from a steady state flux configuration.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.g001" xlink:type="simple"/>
          </fig>
          <p>As is generally true in MinOver schemes, the reinforcement term in (4) drives the gradual adjustment of chemical potentials by ensuring that, at every iteration, the least satisfied constraint (labeled <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e082" xlink:type="simple"/></inline-formula>) is improved. Convergence to a solution, if one exists, is guaranteed for any <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e083" xlink:type="simple"/></inline-formula>. To see it, suppose that a vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e084" xlink:type="simple"/></inline-formula> exists, such that<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e085" xlink:type="simple"/><label>(5)</label></disp-formula>with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e086" xlink:type="simple"/></inline-formula> a constant (in other words, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e087" xlink:type="simple"/></inline-formula> is a solution of (3)). From Eq. (4), the chemical potential vector at the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e088" xlink:type="simple"/></inline-formula>-th iteration step, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e089" xlink:type="simple"/></inline-formula>, satisfies<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e090" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e091" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e092" xlink:type="simple"/><label>(6)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e093" xlink:type="simple"/></inline-formula> is the value taken by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e094" xlink:type="simple"/></inline-formula> at step <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e095" xlink:type="simple"/></inline-formula>. Similarly, one finds<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e096" xlink:type="simple"/><label>(7)</label></disp-formula>with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e097" xlink:type="simple"/></inline-formula>. As a consequence,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e098" xlink:type="simple"/><label>(8)</label></disp-formula>However by the Cauchy-Swartz inequality <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e099" xlink:type="simple"/></inline-formula>, and an upper bound for the number of steps can be obtained from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e100" xlink:type="simple"/></inline-formula> which to leading orders in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e101" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e102" xlink:type="simple"/></inline-formula> gives<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e103" xlink:type="simple"/><label>(9)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e104" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e105" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e106" xlink:type="simple"/></inline-formula> are constants proportional to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e107" xlink:type="simple"/></inline-formula>. Hence starting from an initial random vector of chemical potentials the algorithm is able to obtain a new vector ensuring that (3) is satisfied. Re-initializing the algorithm from a different random vector sampled from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e108" xlink:type="simple"/></inline-formula> allows to retrieve another solution and in turn explore the space of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e109" xlink:type="simple"/></inline-formula>'s satisfying (3).</p>
          <p>In essence, the final outcome of multiple (random) initializations of the above algorithm is a set of <italic>correlated</italic> probability distributions for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e110" xlink:type="simple"/></inline-formula>'s (at odds with the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e111" xlink:type="simple"/></inline-formula>, which was assumed to be a product measure, so that no correlations were present initially). The algorithmic origin of such interdependencies can be understood considering that chemical potentials are updated dynamically through a series of reinforcement steps of the form <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e112" xlink:type="simple"/></inline-formula>. It follows that the final value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e113" xlink:type="simple"/></inline-formula> can be written as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e114" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e115" xlink:type="simple"/></inline-formula> is the trial chemical potential sampled from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e116" xlink:type="simple"/></inline-formula> (i.e. the initial value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e117" xlink:type="simple"/></inline-formula>) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e118" xlink:type="simple"/></inline-formula> is an index which is updated (increased or decreased by one according to the sign of the reaction) each time reaction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e119" xlink:type="simple"/></inline-formula> tries to invert. The connected correlations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e120" xlink:type="simple"/></inline-formula> between chemical potentials (where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e121" xlink:type="simple"/></inline-formula> is an average over all possible choices of the initial conditions) can thus be decomposed as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e122" xlink:type="simple"/><label>(10)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e123" xlink:type="simple"/></inline-formula> is the variance of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e124" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e125" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e126" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e127" xlink:type="simple"/></inline-formula> otherwise (so that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e128" xlink:type="simple"/></inline-formula>). In the Gaussian approximation for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e129" xlink:type="simple"/></inline-formula>, the leading term (of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e130" xlink:type="simple"/></inline-formula>) in the above sum is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e131" xlink:type="simple"/><label>(11)</label></disp-formula>Therefore to leading order, the dynamics tends to correlate (resp. anti-correlate) the chemical potentials of metabolites typically appearing on the same (resp. opposite) side of the reaction equations. In a sense, the above scheme allows to modify <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e132" xlink:type="simple"/></inline-formula> by building up correlations between chemical potentials according to the interconnections encoded in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e133" xlink:type="simple"/></inline-formula>. Note that, at odds with the method proposed in <xref ref-type="bibr" rid="pcbi.1002562-Kmmel1">[7]</xref>, the resulting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e134" xlink:type="simple"/></inline-formula>'s can exceed the initial bounds defined by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e135" xlink:type="simple"/></inline-formula>.</p>
          <p>If there is no prior information on the direction of some reactions (e.g. because they are putatively reversible), the corresponding constraints (3) are formally absent, as if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e136" xlink:type="simple"/></inline-formula>. However, the above method still allows to retrieve information about the chemical potential of a metabolite involved in them, provided it is not employed in reversible processes only, in which case its <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e137" xlink:type="simple"/></inline-formula> clearly is never updated.</p>
          <p>Finally, some observations are in order about the solution space of (3), which in general has the form of an unbounded cone passing trough the origin. If one is interested in uniform sampling the space of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e138" xlink:type="simple"/></inline-formula>'s making <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e139" xlink:type="simple"/></inline-formula> thermodynamically feasible, boundedness is an essential precondition. The simplest way to obtain a bounded solution space consist in clamping some <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e140" xlink:type="simple"/></inline-formula>'s, i.e. in keeping them fixed at definite values throughout the updating. Note that fixing some <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e141" xlink:type="simple"/></inline-formula>'s is also crucial to set a scale for chemical potentials. The same effect can be achieved by assigning hard ranges of variability for potentials in the form of bounds like <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e142" xlink:type="simple"/></inline-formula> (e.g. according to experimental or biochemical information). Such inequalities can simply be added to the list of thermodynamic constraints (3). Alternatively, one may add other types of global, non-homogeneous constraints bearing a physical justification. For instance, if uptake fluxes are included in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e143" xlink:type="simple"/></inline-formula>, the chemical potentials of the external metabolites should be fixed; or, volume constraints for the feasible ranges of concentrations could be added if the standard free energies of formation are known. Once this is done, the system (3) becomes inhomogeneous and its solution space is formed by the union of a convex polyhedron and a cone; boundedness can be achieved if and only if the cone shrinks to the null vector, which occurs if the related homogeneous system of equations has no solutions apart from the trivial one, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e144" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002562-Solodovnikov1">[33]</xref>. In synthesis, one can obtain a bounded solution space for (3) by clamping the chemical potential of a sufficient number of metabolites to ensure that the homogeneous system of equalities associated to the inhomogeneous system of inequalities obtained by clamping some <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e145" xlink:type="simple"/></inline-formula>'s in (3) admits the null vector as its only solution.</p>
          <p>A number of interesting theoretical and computational questions arise at this stage, regarding e.g. the minimal amount of prior information on chemical potentials needed to bound the solution space of (3), or computationally efficient and scalable methods to obtain uniform sampling (besides Monte Carlo, which may be infeasible at high dimensions as suggested by the “curse of dimensionality”, see e.g. <xref ref-type="bibr" rid="pcbi.1002562-Schellenberger2">[34]</xref>). To our knowledge, there is no mathematical proof that MinOver schemes are capable of sampling a bounded solution space uniformly, although low dimensional tests suggest that this might indeed be the case <xref ref-type="bibr" rid="pcbi.1002562-Martelli1">[31]</xref>. Our goal in the present paper, rather than uniformly sampling the space of chemical potentials granting feasibility, is that of exploring feasible configurations “close” to the prior biochemical information we have injected. To quantify this idea, we have explicitly compared the solutions obtained via the above procedure with those retrieved from the minimization of a cost function (the average Euclidean distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e146" xlink:type="simple"/></inline-formula> between the prior and the solution) and by a standard relaxation method (see <xref ref-type="sec" rid="s3">Results</xref>: Exploring the Gibbs energy landscape of the hRBC metabolic network). The heuristics we present indeed turns out to roughly minimize <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e147" xlink:type="simple"/></inline-formula>, with the advantage of being considerably faster than a penalty method. In addition, it allows to access refined information on the Gibbs energy landscape (i.e. compute chemical potentials and Gibbs energy changes) even when the initialization is complemented by a noisy or inconsistent biochemical prior, since the algorithm correctly identifies and gradually removes inconsistencies. The solutions thus obtained identify a restricted and statistically well-behaved set of chemical potentials with physiological significance. We are currently unable to go beyond this point. In addition, we shall see that by the same method one can verify the thermodynamic consistency of, and eventually adjust, specific flux configurations of biochemical reaction networks.</p>
        </sec>
        <sec id="s2b2">
          <title>Algorithm to identify and remove loops</title>
          <p>The algorithm just discussed generates chemical potential vectors given a thermodynamically feasible vector of reaction directions. A generic assignment of reaction directions, however, could be such that the system (3) has no solutions apart from the trivial one. In accordance with the Farkas-Minkowski lemma <xref ref-type="bibr" rid="pcbi.1002562-Solodovnikov1">[33]</xref> this happens if and only if there is at least one infeasible loop, i.e. if there is a set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e148" xlink:type="simple"/></inline-formula> of intracellular reactions for which positive constants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e149" xlink:type="simple"/></inline-formula> exist such that<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e150" xlink:type="simple"/><label>(12)</label></disp-formula>In presence of a loop, relaxation methods (MinOver included) do not converge, just because the least satisfied constraint moves along the loop causing the iteration to cycle indefinitely. More precisely, in presence of a loop the MinOver dynamics becomes periodic or almost periodic. For a periodic dynamics <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e151" xlink:type="simple"/></inline-formula> so that, using (4), for any <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e152" xlink:type="simple"/></inline-formula> we have<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e153" xlink:type="simple"/><label>(13)</label></disp-formula>Comparing this with (12) it can be gathered that reactions updated over a period define a loop of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e154" xlink:type="simple"/></inline-formula> (setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e155" xlink:type="simple"/></inline-formula> to the number of times constraint <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e156" xlink:type="simple"/></inline-formula> has been updated). This suggests a simple way to correct configurations of reaction directions that are thermodynamically infeasible to start with:</p>
          <list list-type="order">
            <list-item>
              <p>While running the algorithm to compute chemical potentials for a large number of iteration steps <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e157" xlink:type="simple"/></inline-formula>, keep track of the last say <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e158" xlink:type="simple"/></inline-formula> least unsatisfied constraints, i.e. store <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e159" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e160" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e161" xlink:type="simple"/></inline-formula> a reasonably large number (e.g. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e162" xlink:type="simple"/></inline-formula>), and count the number <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e163" xlink:type="simple"/></inline-formula> of different reactions appearing in the series.</p>
            </list-item>
            <list-item>
              <p>Search, within such subset of reactions, for a loop of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e164" xlink:type="simple"/></inline-formula> by looking for solutions to equation (12) with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e165" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e166" xlink:type="simple"/></inline-formula> reactions only, for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e167" xlink:type="simple"/></inline-formula>-uples, starting from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e168" xlink:type="simple"/></inline-formula> and increasing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e169" xlink:type="simple"/></inline-formula>.</p>
            </list-item>
            <list-item>
              <p>If a loop is found, change the direction of one of its reversible reactions chosen with uniform probability.</p>
            </list-item>
          </list>
          <p>In the <xref ref-type="sec" rid="s3">Results</xref> section we shall use this heuristics to spot loops and eliminate them in all of the infeasible configurations we shall generate for a large metabolic network (E. coli iAF 1260). For this network, it turns out that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e170" xlink:type="simple"/></inline-formula> in all runs and that accounting for short loops (of length up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e171" xlink:type="simple"/></inline-formula>) suffices to correct all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e172" xlink:type="simple"/></inline-formula> randomly-generated configurations we tested. This is rather important since, in principle, step (ii) of the above procedure could be exponential in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e173" xlink:type="simple"/></inline-formula>.</p>
          <p>A computer code implementing the algorithms to compute chemical potentials and identify and remove infeasible loops is downloadable <ext-link ext-link-type="uri" xlink:href="http://chimera.roma1.infn.it/SYSBIO/" xlink:type="simple">http://chimera.roma1.infn.it/SYSBIO/</ext-link>.</p>
        </sec>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <sec id="s3a">
        <title>Exploring the Gibbs energy landscape of the hRBC metabolic network</title>
        <p>As a first application, we have employed the MinOver scheme outlined above to analyze the thermodynamic landscape of the hRBC metabolic network. As a starting point, we have considered the flux configurations obtained in <xref ref-type="bibr" rid="pcbi.1002562-Price1">[19]</xref> and <xref ref-type="bibr" rid="pcbi.1002562-DeMartino1">[20]</xref> respectively by Monte Carlo sampling of the solution space of mass balance equations (MBE) and by MinOver sampling of states compatible with Von Neumann's constraints (VNC). In brief, MBE describe steady-state fluxes in terms of Kirchhoff-type laws enforced at metabolite nodes of the network as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e174" xlink:type="simple"/></inline-formula>. In such a scenario, intracellular concentrations are clamped. VNC, instead, ‘soften’ the mass-balance equations by requiring that, for intracellular metabolites, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e175" xlink:type="simple"/></inline-formula>. In the underlying steady state intracellular concentrations can grow in time if flux vectors allowing for it exist. Once the nutrient availability is set, VNC define a self-consistent flux problem where the system selects how much of the nutrients to use and, eventually, which metabolites are globally produced. For intracellular metabolites, VNC correspond to a stability requirement since, in a dynamical setup, a violation of one of the inequalities implies the existence of a metabolite whose total amount used as input in metabolic processes exceeds the total amount returned as output (see e.g. <xref ref-type="bibr" rid="pcbi.1002562-Gale1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1002562-DeMartino4">[36]</xref>). VNC are also closely linked to the metabolite producibility problem introduced in <xref ref-type="bibr" rid="pcbi.1002562-Imielinski1">[37]</xref>. We shall thus make use of the reaction direction vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e176" xlink:type="simple"/></inline-formula> obtained in <xref ref-type="bibr" rid="pcbi.1002562-Price1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1002562-DeMartino1">[20]</xref> for the hRBC. In summary:</p>
        <list list-type="bullet">
          <list-item>
            <p>according to <xref ref-type="bibr" rid="pcbi.1002562-Price1">[19]</xref>, the net flux of all reactions is in the forward direction, except PGI, R5PI and ApK, which are found to operate bidirectionally;</p>
          </list-item>
          <list-item>
            <p>according to <xref ref-type="bibr" rid="pcbi.1002562-DeMartino1">[20]</xref>, the net flux of all reactions is in the forward direction, except R5PI (which is found to be operating bidirectionally), and PGI and ApK (which are found to have a net backward flux).</p>
          </list-item>
        </list>
        <p>As a first step, we tested the thermodynamic feasibility of these direction assignments, solving (3) by starting from the vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e177" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e178" xlink:type="simple"/></inline-formula>. A solution is found for both MBE and VNC assignments. Both sets of assignments then turn out to be (expectedly) thermodynamically feasible. In this case, however, it is the emerging thermodynamic landscape that is of interest to us. As the initial distribution of chemical potentials <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e179" xlink:type="simple"/></inline-formula> we selected a product of independent uniform distributions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e180" xlink:type="simple"/></inline-formula>. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e181" xlink:type="simple"/></inline-formula> for compounds with known empirical bounds on concentrations were centered at a value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e182" xlink:type="simple"/></inline-formula> computed from the Gibbs energy of formation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e183" xlink:type="simple"/></inline-formula> and the estimated intracellular concentration <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e184" xlink:type="simple"/></inline-formula> under the hypothesis of a dilute solution, i.e. at<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e185" xlink:type="simple"/><label>(14)</label></disp-formula>and were taken to span two standard deviations in concentrations. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e186" xlink:type="simple"/></inline-formula> for metabolites whose concentration estimates were unavailable (namely 6PGL, RL5P, X5P, R5P, S7P) were taken to be centered again at (14) but with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e187" xlink:type="simple"/></inline-formula>, and were assumed to span four orders of magnitude uniformly in the chemical potential scale. Finally, the chemical potential of water was clamped.</p>
        <p>Results for the estimated concentrations and Gibbs energy changes (computed from (2) using the final chemical potential vectors) are showcased in <xref ref-type="fig" rid="pcbi-1002562-g002">Figures 2</xref> and <xref ref-type="fig" rid="pcbi-1002562-g003">3</xref>, respectively. Note that several of the bounds encoded in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e188" xlink:type="simple"/></inline-formula> (black markers) indicate that the Gibbs energy change in a reaction is positive and in contrast with the reaction direction assignment from the flux problem. Specifically this happens for GAPDH, PGK, PGM, LDH, G6PDH, TA and PNPase, due either to the actual experimental estimates for the affinities or to the initial uncertainty we place on concentrations. Such bounds turn out to be altered by MinOver in a direction compatible with direction assignments based on mass balance, as final affinities display significant changes with respect to the picture embedded in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e189" xlink:type="simple"/></inline-formula>. At the same time, we observe that in some cases the fluctuations of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e190" xlink:type="simple"/></inline-formula> do exceed the initial boxes defined by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e191" xlink:type="simple"/></inline-formula>, leading to an estimate for the concentration range also for metabolites whose level has not been experimentally probed (6PGL, RL5P, X5P, R5P, S7P). Our predictions for the levels of (1,3)-diphosphoglycerate ((1,3)-DPG), 2-phosphoglycerate (2PG) and phosphoenolpyruvate (PEP) slightly differ from the experimental estimates. This is most likely a consequence of the fact that we are forcing the phosphoglycerate kinase (PGK) and the glyceraldehyde phosphate dehydrogenase (GAPDH) reactions in the forward direction, in agreement with the steady state direction assignments for glycolysis, even if the experimental values would classify them as reversible. In addition, we obtain levels of key metabolites like ATP and inorganic phosphate that differ slightly from experimental estimates, while our predictions for ADP and AMP fail under the MBE and VNC direction assignments, respectively. On one hand this could be due to errors in the prior information on standard free energies but on the other hand, precise experimental estimates of the levels of such highly interchanging metabolites might be difficult to achieve.</p>
        <fig id="pcbi-1002562-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002562.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Estimated log-concentrations of metabolites in the hRBC metabolic network.</title>
            <p>The input information used to initialize the algorithm (with error bars) is denoted by black markers (see text for details). Values obtained starting from direction assignments corresponding to a sample of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e192" xlink:type="simple"/></inline-formula> MBE and VNC solutions are shown respectively as red and green markers.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.g002" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002562-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002562.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Estimated Gibbs energy changes of reactions in the hRBC metabolic network.</title>
            <p>The input information used to initialize the algorithm (with error bars) is denoted by black markers; the values obtained starting from direction assignments corresponding to MBE and VNC solutions are shown respectively as red and green markers. Note that the input information is consistent with reactions operating in the reverse direction for GAPDH, PGK, PGM, LDH, G6PDH, TA and PNPase. The algorithm is able to correct these inconsistencies starting from both MBE- and VNC-compatible direction assignments.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.g003" xlink:type="simple"/>
        </fig>
        <p>We can now quantify the extent to which the solutions we generate are “close” to the prior. In <xref ref-type="fig" rid="pcbi-1002562-g004">Figure 4</xref> we compare the Gibbs energy changes obtained for the hRBC using MBE directions in three different ways: (a) the MinOver algorithm introduced here, with update given by (4); (b) a penalty method defined by the update rule<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e193" xlink:type="simple"/><label>(15)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e194" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e195" xlink:type="simple"/></inline-formula> are constants and the sum extends over all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e196" xlink:type="simple"/></inline-formula>'s such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e197" xlink:type="simple"/></inline-formula>; (c) a standard relaxation method defined by the update rule<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e198" xlink:type="simple"/><label>(16)</label></disp-formula>In short, algorithm (b) minimizes the Euclidean distance between the prior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e199" xlink:type="simple"/></inline-formula> and the solution under the thermodynamic constraint, which is enforced through the term proportional to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e200" xlink:type="simple"/></inline-formula>. The relaxation method (c) simply corresponds to a particular choice of the constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e201" xlink:type="simple"/></inline-formula> appearing in (4): in specific, the step size is required to be proportional to the amount by which the least satisfied constraint is violated. One sees that the penalty method and MinOver produce almost identical solutions. Measuring explicitly the average Euclidean distance between the prior and the solution (the average being taken over the choice of the priors), one indeed finds <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e202" xlink:type="simple"/></inline-formula> (penalty method) versus <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e203" xlink:type="simple"/></inline-formula> (MinOver), while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e204" xlink:type="simple"/></inline-formula> for the relaxation method (c). Note that the gap between the performance of MinOver and that of the penalty method (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e205" xlink:type="simple"/></inline-formula>, corresponding to a relative error on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e206" xlink:type="simple"/></inline-formula> of just over 1%) provides a very rough estimate of the average distance between the solutions obtained by MinOver and those obtained by cost function minimization, and is much smaller than the spread of the initial configurations of chemical potentials, which in this case is about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e207" xlink:type="simple"/></inline-formula>. Comparing running times for this case, moreover, one sees that MinOver is about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e208" xlink:type="simple"/></inline-formula> times faster than the penalty method (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e209" xlink:type="simple"/></inline-formula> versus roughly <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e210" xlink:type="simple"/></inline-formula> seconds), while the standard relaxation method is even faster (about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e211" xlink:type="simple"/></inline-formula> seconds).</p>
        <fig id="pcbi-1002562-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002562.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Estimated Gibbs energy changes of reactions in the hRBC metabolic network: comparison of different algorithms.</title>
            <p>The results obtained starting from direction assignments corresponding to MBE solutions are shown here for three different methods: (a) MinOver with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e212" xlink:type="simple"/></inline-formula> (this paper, free markers); (b) a penalty method using the Euclidean distance between the solution and the prior as the cost function (blue markers); (c) a relaxation method optimized to be faster (red markers). For (b), we have set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e213" xlink:type="simple"/></inline-formula> while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e214" xlink:type="simple"/></inline-formula> is initialized at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e215" xlink:type="simple"/></inline-formula> and grows in steps of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e216" xlink:type="simple"/></inline-formula> each time a minimum is found, until the configuration is feasible. These results show that MinOver roughly minimizes the average Euclidean distance between the solution and the prior (as the penalty method), albeit with running times over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e217" xlink:type="simple"/></inline-formula> times shorter (see text for details).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.g004" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s3b">
        <title>Identifying and removing thermodynamically infeasible loops in the <italic>Escherichia coli</italic> metabolic network model iAF1260</title>
        <p>The application that we have just discussed shows that the algorithm we present can provide information on the Gibbs energy landscape, even correcting inconsistent input knowledge. We shall now employ the procedure outlined in the <xref ref-type="sec" rid="s2">Materials and Methods</xref> section to efficiently identify and eliminate loops from thermodynamically infeasible flux configurations of the reconstructed metabolic network of <italic>Escherichia coli</italic> iAF1260 <xref ref-type="bibr" rid="pcbi.1002562-Feist2">[21]</xref>. We shall focus specifically on the periplasmic and cytoplasmic core of the network, which presents the advantage that the cycles identified here are independent of the transport and environment selections. The network includes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e218" xlink:type="simple"/></inline-formula> reactions among <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e219" xlink:type="simple"/></inline-formula> chemical species.</p>
        <p>Since we are not focusing on the reconstruction of the Gibbs energy landscape but simply on the existence of solutions of (3), a detailed biochemical prior is not needed. Therefore, for the present purposes we have taken <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e220" xlink:type="simple"/></inline-formula> to be product of identical uniform distributions. To begin with, we have fixed the direction of reactions that are putatively irreversible in the reconstructed network (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e221" xlink:type="simple"/></inline-formula> in total) and verified that this assignment is indeed thermodynamically feasible by finding a solution of (3) restricted to irreversible processes. Then we integrated the above assignments by fixing randomly and independently with equal probability the directions of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e222" xlink:type="simple"/></inline-formula> processes that are putatively reversible. A large ensemble of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e223" xlink:type="simple"/></inline-formula> vectors (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e224" xlink:type="simple"/></inline-formula> instances) thus obtained was tested for thermodynamic feasibility. Note that by excluding the possibility that reactions are not operating we are considering a worst-case scenario in which all reactions bear a non-zero flux. Only about 1.5% of these configurations turned out to be thermodynamically feasible, i.e. free from loops. We focus on infeasible instances, for which no vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e225" xlink:type="simple"/></inline-formula> of chemical potentials was found to satisfy (3), applying to them the loop identification and removal protocol. <xref ref-type="fig" rid="pcbi-1002562-g005">Figure 5</xref> shows the histogram of convergence times for the above procedure, i.e. the times required to verify that a given vector of flux directions is thermodynamically infeasible and to correct it. On an Intel dual core at 3.06 GHz the average CPU time for convergence is of the order of a few seconds, while it exceeds 10 seconds in about 5% of the (random) instances. In the worst case within our ensemble, convergence time was around 100 seconds.</p>
        <fig id="pcbi-1002562-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002562.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Histogram of the convergence times of the algorithm.</title>
            <p>Convergence times shown are for the identification and elimination of the thermodynamically infeasible loops and for the verification of thermodynamic feasibility of randomly generated flux configurations from the <italic>Escherichia coli</italic> iA1260 metabolic network model (on an Intel dual core at 3.06 GHz).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.g005" xlink:type="simple"/>
        </fig>
        <p>We have furthermore studied the set of loops that were thus identified and corrected. Quite remarkably this analysis revealed that thermodynamical infeasibility is related to the presence of a small set of cycles, 23 in total. These are reported in <xref ref-type="table" rid="pcbi-1002562-t001">Table 1</xref> and three of them are depicted explicitly in <xref ref-type="fig" rid="pcbi-1002562-g006">Figure 6</xref>. Note that some of these cycles include a single reversible reaction. This implies that in order to ensure that such cycles will not be present in the final configuration it is necessary to fix the direction of the reactions SERt2rpp, GLUt2rpp, ACt2rpp, GLYCLTt2rpp, THRt2rpp, SUCOAS, PPAKr and PROt2rpp opposite to that shown in <xref ref-type="table" rid="pcbi-1002562-t001">Table 1</xref> (see the Supporting <xref ref-type="supplementary-material" rid="pcbi.1002562.s003">Table S1</xref> for abbreviations). In turn, this is easily seen to impose a further constraint on the direction of the reversible fluxes CAt6pp and GLUABUTt7pp (via cycles of length 4). Finally we checked that excluding these loops guarantees thermodynamic feasibility of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e226" xlink:type="simple"/></inline-formula> randomly generated flux configurations</p>
        <fig id="pcbi-1002562-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002562.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Three of the 23 thermodynamically infeasible cycles identified in the <italic>E. coli</italic> metabolic network iAF1260.</title>
            <p>Rectangles (resp. ellipses) denote metabolites (resp. reactions). The cycles depicted here are n. 8 (A, top left), 18 (B, top right) and 22 (C, bottom) from <xref ref-type="table" rid="pcbi-1002562-t001">Table 1</xref>. The star indicates reversible reactions according to <xref ref-type="bibr" rid="pcbi.1002562-Feist2">[21]</xref>. See Supporting <xref ref-type="supplementary-material" rid="pcbi.1002562.s003">Table S1</xref> for abbreviations.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.g006" xlink:type="simple"/>
        </fig>
        <table-wrap id="pcbi-1002562-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002562.t001</object-id><label>Table 1</label><caption>
            <title>Thermodynamically infeasible cycles for the <italic>E. coli</italic> metabolic reaction network iAF1260.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002562-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Cycle ID</td>
                <td align="left" colspan="1" rowspan="1">Length</td>
                <td align="left" colspan="1" rowspan="1">Formula</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">SERt4pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e227" xlink:type="simple"/></inline-formula>NAt3pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e228" xlink:type="simple"/></inline-formula>SERt2rpp(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">NAt3pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e229" xlink:type="simple"/></inline-formula>GLUt4pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e230" xlink:type="simple"/></inline-formula>GLUt2rpp(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">NAt3pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e231" xlink:type="simple"/></inline-formula>ACt2rpp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e232" xlink:type="simple"/></inline-formula>ACt4pp</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">NAt3pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e233" xlink:type="simple"/></inline-formula>GLYCLTt2rpp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e234" xlink:type="simple"/></inline-formula>GLYCLTt4pp</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">PROt4pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e235" xlink:type="simple"/></inline-formula>PROt2rpp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e236" xlink:type="simple"/></inline-formula>NAt3pp</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">6</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">HPYRRx<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e237" xlink:type="simple"/></inline-formula>TRSARr(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e238" xlink:type="simple"/></inline-formula>HPYRI(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">7</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">CRNDt2rpp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e239" xlink:type="simple"/></inline-formula>CRNt2rpp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e240" xlink:type="simple"/></inline-formula>CRNt8pp</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">8</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">VPAMT<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e241" xlink:type="simple"/></inline-formula>ALATAL(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e242" xlink:type="simple"/></inline-formula>VALTA(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">9</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">ABUTt2pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e243" xlink:type="simple"/></inline-formula>GLUABUTt7pp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e244" xlink:type="simple"/></inline-formula>GLUt2rpp(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">NAt3pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e245" xlink:type="simple"/></inline-formula>THRt2rpp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e246" xlink:type="simple"/></inline-formula>THRt4pp</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">11</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">ADK3(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e247" xlink:type="simple"/></inline-formula>ADK1(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e248" xlink:type="simple"/></inline-formula>NDPK1(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">12</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">ACCOAL<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e249" xlink:type="simple"/></inline-formula>PPCSCT<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e250" xlink:type="simple"/></inline-formula>SUCOAS(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">13</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">PPAKr(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e251" xlink:type="simple"/></inline-formula>ACCOAL<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e252" xlink:type="simple"/></inline-formula>PTA2</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">14</td>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">ACt4pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e253" xlink:type="simple"/></inline-formula>CAt6pp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e254" xlink:type="simple"/></inline-formula>ACt2rpp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e255" xlink:type="simple"/></inline-formula>CA2t3pp</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">15</td>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">CA2t3pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e256" xlink:type="simple"/></inline-formula>GLYCLTt2rpp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e257" xlink:type="simple"/></inline-formula>GLYCLTt4pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e258" xlink:type="simple"/></inline-formula>CAt6pp(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">16</td>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">SERt4pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e259" xlink:type="simple"/></inline-formula>CAt6pp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e260" xlink:type="simple"/></inline-formula>SERt2rpp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e261" xlink:type="simple"/></inline-formula>CA2t3pp</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">17</td>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">GLUt4pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e262" xlink:type="simple"/></inline-formula>CAt6pp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e263" xlink:type="simple"/></inline-formula>CA2t3pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e264" xlink:type="simple"/></inline-formula>GLUt2rpp(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">18</td>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">CA2t3pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e265" xlink:type="simple"/></inline-formula>PROt2rpp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e266" xlink:type="simple"/></inline-formula>PROt4pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e267" xlink:type="simple"/></inline-formula>CAt6pp(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">19</td>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">THRt4pp<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e268" xlink:type="simple"/></inline-formula>CAt6pp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e269" xlink:type="simple"/></inline-formula>THRt2rpp(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e270" xlink:type="simple"/></inline-formula>CA2t3pp</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">20</td>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">ADK1(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e271" xlink:type="simple"/></inline-formula>ACKr(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e272" xlink:type="simple"/></inline-formula>ACS<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e273" xlink:type="simple"/></inline-formula>PTAr(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e274" xlink:type="simple"/></inline-formula>PPKr(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">21</td>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">R15BPK<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e275" xlink:type="simple"/></inline-formula>PPM(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e276" xlink:type="simple"/></inline-formula>PRPPS(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e277" xlink:type="simple"/></inline-formula>ADK1(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e278" xlink:type="simple"/></inline-formula>R1PK</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">22</td>
                <td align="left" colspan="1" rowspan="1">6</td>
                <td align="left" colspan="1" rowspan="1">R1PK<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e279" xlink:type="simple"/></inline-formula>NDPK1(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e280" xlink:type="simple"/></inline-formula>PPM(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e281" xlink:type="simple"/></inline-formula>PRPPS(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e282" xlink:type="simple"/></inline-formula>R15BPK<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e283" xlink:type="simple"/></inline-formula>ADK3(R)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">23</td>
                <td align="left" colspan="1" rowspan="1">6</td>
                <td align="left" colspan="1" rowspan="1">ADK3(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e284" xlink:type="simple"/></inline-formula>ACKr(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e285" xlink:type="simple"/></inline-formula>PTAr(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e286" xlink:type="simple"/></inline-formula>NDPK1(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e287" xlink:type="simple"/></inline-formula>PPKr(R)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e288" xlink:type="simple"/></inline-formula>ACS</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>The list provides the complete set of cycles turned out in the thermodynamic feasibility analysis of a sample of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e289" xlink:type="simple"/></inline-formula> different randomly generated flux configurations. Plus (resp. minus) signs indicate that the reaction participates in the cycle in its forward (resp. backward) direction. (R) indicates that the corresponding reaction is putatively reversible according to <xref ref-type="bibr" rid="pcbi.1002562-Feist2">[21]</xref>. Analyzing interdependencies in the above cycles, one sees that the directions of the putatively reversible fluxes SERt2rpp, GLUt2rpp, ACt2rpp, GLYCLTt2rpp, THRt2rpp, SUCOAS, PPAKr, PROt2rpp, CAt6pp and GLUABUTt7pp are in fact constrained. See Supporting <xref ref-type="supplementary-material" rid="pcbi.1002562.s003">Table S1</xref> for abbreviations.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>We remark that the corrected flux configurations thus obtained, like the starting ones (which were drawn from a uniform product measure over reactions), are not guaranteed to be consistent with any steady state assumption. On the other hand, see Supporting <xref ref-type="supplementary-material" rid="pcbi.1002562.s004">Text S1</xref>, starting from a mass-balanced configuration one retrieves another mass-balanced configuration. Clearly, a method that directly generates thermodynamically steady state flux vectors and chemical potentials would be highly welcome. Nevertheless, we note that our analysis focuses on a worst-case scenario where all reactions bear a non-zero flux. In a more realistic case where reactions may be inactive it is reasonable to expect that the flux directions we generate will allow for a steady state. In turn, the identification of these loops might be weakly conditioned on the sample of flux assignments we employed. We can't rule out the possibility that assigning directions based e.g. on mass balance constraints provides a selection criterion for flux configurations that differs substantially from the uniform measure we employed. However we expect that our sample allows to correctly identify loops involving at most <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e290" xlink:type="simple"/></inline-formula> reversible reactions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002562.e291" xlink:type="simple"/></inline-formula> being the number of distinct direction assignments in our sample. Only loops that include a larger number of reversible processes might therefore play a role in a differently selected set of direction assignments.</p>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>Ideally, constraint-based models of metabolic activity allow to appraise the energetic potential of cells based on minimal constraints related to local mass-balance and thermodynamic feasibility rules, possibly complemented with optimization principles that can encode for functional constraints. As a result, the flow of matter in non-equilibrium steady states could be characterized in terms of the Gibbs energy change of reactions, which specifies the directionality of interconversions, and of the average number of turnovers per time per volume, i.e. the flux, without the need of detailed information on enzyme kinetics or transport mechanisms. Thermodynamic constraints, strongly linked to overall intracellular conditions like ionic strength and pH <xref ref-type="bibr" rid="pcbi.1002562-Maskow1">[38]</xref>, are particularly subtle and rich of consequences. It has indeed been argued that the Gibbs energy landscape contains important regulatory information <xref ref-type="bibr" rid="pcbi.1002562-Kmmel1">[7]</xref>. Reactions far from equilibrium are expected to be roughly insensitive to fluctuations in metabolite concentrations, so that they will be driven mostly by enzyme regulation. On the other hand, reactions close to equilibrium (i.e. with a net Gibbs energy change close to zero) bear a high sensitivity to variations in metabolite levels and are therefore unlikely targets for tight regulation. Besides, knowledge of reaction free energies (or more precisely of the chemical potentials of the metabolites involved) provides clues on metabolite levels which would be hard to obtain from mass-balance constraints only. Therefore, developing effective procedures to deal with the complexity of flux models encompassing both mass and energy constraints at genome scale is a central challenge for computational systems biology.</p>
      <p>Many important steps have been taken recently to tackle it. At one level, thermodynamic feasibility can be translated into topologic constraints (‘absence of loops’) for the flux configuration emerging from mass-balance constraints <xref ref-type="bibr" rid="pcbi.1002562-Price2">[39]</xref>. This suggests than an improvement in reversibility assignments (e.g. along the lines of <xref ref-type="bibr" rid="pcbi.1002562-Kmmel2">[23]</xref>) can be a key to ensure energy balance a priori in metabolic network reconstructions, with the caveat that the possibility that a reaction reverses can depend on the boundary conditions (e.g. the external supply of a certain metabolite) or on intracellular perturbations (e.g. a knockout causing the accumulation of an intermediate metabolite) <xref ref-type="bibr" rid="pcbi.1002562-Hoppe1">[12]</xref>. Another possibility consists in building mixed integer-linear constraint-based models that include thermodynamic requirements in the form of consensus rules (using information on standard Gibbs free energies) <xref ref-type="bibr" rid="pcbi.1002562-Henry1">[13]</xref> or as additional constraints on metabolite levels (using information on measured intracellular concentrations) <xref ref-type="bibr" rid="pcbi.1002562-Hoppe1">[12]</xref>. Here we have followed a different though related route that in our view complements the approaches just described. The starting point is the fact that, given a flux configuration, thermodynamic constraints can be written as simple stoichiometric inequalities for the chemical potentials. Feasibility implies the existence of a vector of chemical potentials satisfying such system. We have presented an algorithm that is able to construct solutions starting from a possibly limited and noisy biochemical prior. Our approach differs substantially from previous methods in that it relies on modifying the structure of correlations between chemical potentials (after fixing some variables to set a scale) using the stoichiometric information on reaction connectivity to drive the updating process. In this sense, the important difference with <xref ref-type="bibr" rid="pcbi.1002562-Kmmel1">[7]</xref> is that the prior information is used only to initialize the algorithm, and a large flexibility is allowed in deforming it until a viable solution is obtained.</p>
      <p>The usefulness of the algorithm in the analysis of genome-scale networks has been tested in two different cases. For the metabolic network of the human red blood cell, our approach has proved capable of reconstructing the Gibbs energy landscape correcting inconsistent prior information. In turn, this has lead to predictions for intracellular metabolite levels. It is important to stress that the bounds on concentrations we have obtained (which vary rather heterogeneously across compounds) only reflect stoichiometric information. For the metabolic network of <italic>Escherichia coli</italic>, instead, we have focused on the problem of correcting thermodynamically infeasible flux states in the core formed by the periplasmic and cytoplasmic matrix. We have thoroughly analyzed a large ensemble of configurations of reaction directions, identifying the cycles responsible for thermodynamic inconsistency and correcting them in a very modest amount of CPU time. Quite intriguingly, we have related infeasibility to the existence of a relatively small number of short cycles in the flux configuration, whose removal suffices to ensure thermodynamic feasibility in worst-case flux configurations.</p>
      <p>The main advantage of our method consists in our view in its efficient implementation. On the critical side, we point to two aspects that deserve further study. In first place, our tool requires flux configurations as inputs, i.e. it is still unable to produce thermodynamically feasible configurations of fluxes and chemical potentials starting from no previous reversibility hypothesis. However it may provide the basis of a more general procedure for the analysis of genome-scale metabolic networks that couples flux- and thermodynamic profiling, a challenging open problem in computational biology. Secondly, our method relies on prior biochemical information and it would be desirable for it to be effective even if much or most biochemical priors are unknown. As we pointed out, some information has to be injected into the problem for the sake of definiteness. The interesting question is therefore what is the minimum necessary prior needed to reconstruct the Gibbs energy landscape and how are predictions affected by restricted priors. Such problems are mathematical in nature and could bear a particularly high significance for modeling purposes.</p>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002562.s001" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.s001" xlink:type="simple">
        <label>Dataset S1</label>
        <caption>
          <p>Stoichiometric matrix of the human Red Blood Cell metabolic network employed in this study.</p>
          <p>(TXT)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002562.s002" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.s002" xlink:type="simple">
        <label>Dataset S2</label>
        <caption>
          <p>Thermodynamic potentials for the human Red Blood Cell metabolic network employed in this study.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002562.s003" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.s003" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <p>Detailed information about infeasible cycles (reactions and metabolites) identified in the <italic>Escherichia coli</italic> metabolic network iAF1260.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002562.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002562.s004" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p>A toy example of the computation of chemical potentials by MinOver with loop correction.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>The IIT Platform “Computation” is gratefully acknowledged.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002562-Beard1">
        <label>1</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Beard</surname><given-names>DA</given-names></name><name name-style="western"><surname>Qian</surname><given-names>H</given-names></name></person-group>             <year>2008</year>             <article-title>Chemical biophysics.</article-title>             <comment>Cambridge University Press: Cambridge, UK</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Beard2">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Beard</surname><given-names>D</given-names></name><name name-style="western"><surname>Liang</surname><given-names>S</given-names></name><name name-style="western"><surname>Qian</surname><given-names>H</given-names></name></person-group>             <year>2002</year>             <article-title>Energy balance for analysis of complex metabolic networks.</article-title>             <source>Biophys J</source>             <volume>83</volume>             <fpage>79</fpage>             <lpage>86</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Beard3">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Beard</surname><given-names>D</given-names></name><name name-style="western"><surname>Babson</surname><given-names>E</given-names></name><name name-style="western"><surname>Curtis</surname><given-names>E</given-names></name><name name-style="western"><surname>Qian</surname><given-names>H</given-names></name></person-group>             <year>2004</year>             <article-title>Thermodynamic constraints for biochemical networks.</article-title>             <source>J Theor Biol</source>             <volume>228</volume>             <fpage>327</fpage>             <lpage>333</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Alberty1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Alberty</surname><given-names>RA</given-names></name><name name-style="western"><surname>Cornish-Bowden</surname><given-names>A</given-names></name><name name-style="western"><surname>Goldberg</surname><given-names>RN</given-names></name><name name-style="western"><surname>Hammes</surname><given-names>GG</given-names></name><name name-style="western"><surname>Tipton</surname><given-names>K</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Recommendations for terminology and databases for biochemical thermodynamics.</article-title>             <source>Biophys Chem</source>             <volume>155</volume>             <fpage>89</fpage>             <lpage>103</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Jankowski1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jankowski</surname><given-names>MD</given-names></name><name name-style="western"><surname>Henry</surname><given-names>CS</given-names></name><name name-style="western"><surname>Broadbelt</surname><given-names>LJ</given-names></name><name name-style="western"><surname>Hatzimanikatis</surname><given-names>V</given-names></name></person-group>             <year>2008</year>             <article-title>Group contribution method for thermodynamic analysis of complex metabolic networks.</article-title>             <source>Biophys J</source>             <volume>95</volume>             <fpage>1487</fpage>             <lpage>1499</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Fleming1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fleming</surname><given-names>RMT</given-names></name><name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name><name name-style="western"><surname>Nasheuer</surname><given-names>HP</given-names></name></person-group>             <year>2009</year>             <article-title>Quantitative assignment of reaction directionality in constraint-based models of metabolism: application to <italic>Escherichia coli</italic>.</article-title>             <source>Biophys Chem</source>             <volume>145</volume>             <fpage>47</fpage>             <lpage>56</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Kmmel1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kümmel</surname><given-names>A</given-names></name><name name-style="western"><surname>Panke</surname><given-names>S</given-names></name><name name-style="western"><surname>Heinemann</surname><given-names>M</given-names></name></person-group>             <year>2006</year>             <article-title>Putative regulatory sites unraveled by network-embedded thermodynamic analysis of metabolome data.</article-title>             <source>Mol Sys Biol</source>             <volume>2</volume>             <fpage>2006.0034</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Kauffman1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kauffman</surname><given-names>KJ</given-names></name><name name-style="western"><surname>Prakash</surname><given-names>P</given-names></name><name name-style="western"><surname>Edwards</surname><given-names>JS</given-names></name></person-group>             <year>2003</year>             <article-title>Advances in flux-balance analysis.</article-title>             <source>Curr Opin Biotechnol</source>             <volume>14</volume>             <fpage>491</fpage>             <lpage>496</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Orth1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Orth</surname><given-names>JD</given-names></name><name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name><name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name></person-group>             <year>2010</year>             <article-title>What is flux balance analysis?</article-title>             <source>Nat Biotechnol</source>             <volume>28</volume>             <fpage>245</fpage>             <lpage>248</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Schtz1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schütz</surname><given-names>R</given-names></name><name name-style="western"><surname>Kuepfer</surname><given-names>L</given-names></name><name name-style="western"><surname>Sauer</surname><given-names>U</given-names></name></person-group>             <year>2007</year>             <article-title>Systematic evaluation of objective functions for predicting intracellular fluxes in <italic>Escherichia coli</italic>.</article-title>             <source>Mol Sys Biol</source>             <volume>3</volume>             <fpage>119</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Feist1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Feist</surname><given-names>AM</given-names></name><name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name></person-group>             <year>2010</year>             <article-title>The biomass objective function.</article-title>             <source>Curr Opin Microbiol</source>             <volume>13</volume>             <fpage>344</fpage>             <lpage>349</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Hoppe1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hoppe</surname><given-names>A</given-names></name><name name-style="western"><surname>Hoffmann</surname><given-names>S</given-names></name><name name-style="western"><surname>Holzhütter</surname><given-names>HG</given-names></name></person-group>             <year>2007</year>             <article-title>Including metabolite concentrations into flux-balance analysis: thermodynamic realizability as a constraint on flux distributions in metabolic networks.</article-title>             <source>BMC Syst Biol</source>             <volume>1</volume>             <fpage>23</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Henry1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Henry</surname><given-names>CS</given-names></name><name name-style="western"><surname>Broadbelt</surname><given-names>LJ</given-names></name><name name-style="western"><surname>Hatzimanikatis</surname><given-names>V</given-names></name></person-group>             <year>2007</year>             <article-title>Thermodynamics-based metabolic flux analysis.</article-title>             <source>Biophys J</source>             <volume>92</volume>             <fpage>1792</fpage>             <lpage>1805</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Schellenberger1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schellenberger</surname><given-names>J</given-names></name><name name-style="western"><surname>Lewis</surname><given-names>NE</given-names></name><name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name></person-group>             <year>2011</year>             <article-title>Elimination of thermodynamically infeasible loops in steady-state metabolic models.</article-title>             <source>Biophys J</source>             <volume>100</volume>             <fpage>544</fpage>             <lpage>553</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Beard4">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Beard</surname><given-names>DA</given-names></name><name name-style="western"><surname>Qian</surname><given-names>H</given-names></name></person-group>             <year>2005</year>             <article-title>Thermodynamic-based computational profiling of cellular regulatory control in hepatocyte metabolism.</article-title>             <source>Am J Physiol Endocrinol Metab</source>             <volume>288</volume>             <fpage>E633</fpage>             <lpage>E644</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Yang1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>F</given-names></name><name name-style="western"><surname>Qian</surname><given-names>H</given-names></name><name name-style="western"><surname>Beard</surname><given-names>DA</given-names></name></person-group>             <year>2005</year>             <article-title>Ab initio prediction of thermodynamically feasible reaction directions from biochemical network stoichiometry.</article-title>             <source>Metab Eng</source>             <volume>7</volume>             <fpage>251</fpage>             <lpage>259</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Braunstein1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Braunstein</surname><given-names>A</given-names></name><name name-style="western"><surname>Mulet</surname><given-names>R</given-names></name><name name-style="western"><surname>Pagnani</surname><given-names>A</given-names></name></person-group>             <year>2008</year>             <article-title>Estimating the size of the solution space of metabolic networks.</article-title>             <source>BMC Bioinformatics</source>             <volume>9</volume>             <fpage>240</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Mzard1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mézard</surname><given-names>M</given-names></name><name name-style="western"><surname>Parisi</surname><given-names>G</given-names></name><name name-style="western"><surname>Zecchina</surname><given-names>R</given-names></name></person-group>             <year>2002</year>             <article-title>Analytic and algorithmic solution of random satisfiability problems.</article-title>             <source>Science</source>             <volume>297</volume>             <fpage>812</fpage>             <lpage>815</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Price1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Price</surname><given-names>ND</given-names></name><name name-style="western"><surname>Schellenberger</surname><given-names>J</given-names></name><name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name></person-group>             <year>2004</year>             <article-title>Uniform sampling of steady-state flux spaces: means to design experiments and to interpret enzymopathies.</article-title>             <source>Biophys J</source>             <volume>87</volume>             <fpage>2172</fpage>             <lpage>2186</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-DeMartino1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>De Martino</surname><given-names>A</given-names></name><name name-style="western"><surname>Granata</surname><given-names>D</given-names></name><name name-style="western"><surname>Marinari</surname><given-names>E</given-names></name><name name-style="western"><surname>Martelli</surname><given-names>C</given-names></name><name name-style="western"><surname>Van Kerrebroeck</surname><given-names>V</given-names></name></person-group>             <year>2010</year>             <article-title>Optimal fluxes, reaction replaceability, and response to enzymopathies in the human red blood cell.</article-title>             <source>J Biomed Biotechol</source>             <volume>2010</volume>             <fpage>415148</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Feist2">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Feist</surname><given-names>AM</given-names></name><name name-style="western"><surname>Henry</surname><given-names>CS</given-names></name><name name-style="western"><surname>Reed</surname><given-names>JL</given-names></name><name name-style="western"><surname>Krummenacker</surname><given-names>M</given-names></name><name name-style="western"><surname>Joyce</surname><given-names>AR</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>A genome-scale metabolic reconstruction for <italic>Escherichia coli</italic> K-12 MG1655 that accounts for 1260 ORFs and thermodynamic information.</article-title>             <source>Mol Sys Biol</source>             <volume>3</volume>             <fpage>121</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Wiback1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wiback</surname><given-names>A</given-names></name><name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name></person-group>             <year>2002</year>             <article-title>Extreme pathway analysis of human red blood cell metabolism.</article-title>             <source>Biophys J</source>             <volume>83</volume>             <fpage>808</fpage>             <lpage>818</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Kmmel2">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kümmel</surname><given-names>A</given-names></name><name name-style="western"><surname>Panke</surname><given-names>S</given-names></name><name name-style="western"><surname>Heinemann</surname><given-names>M</given-names></name></person-group>             <year>2006</year>             <article-title>Systematic assignment of thermodynamic constraints in metabolic network models.</article-title>             <source>BMC Bionformatics</source>             <volume>7</volume>             <fpage>512</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Milo1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Milo</surname><given-names>R</given-names></name><name name-style="western"><surname>Jorensen</surname><given-names>P</given-names></name><name name-style="western"><surname>Moran</surname><given-names>U</given-names></name><name name-style="western"><surname>Weber</surname><given-names>G</given-names></name><name name-style="western"><surname>Springer</surname><given-names>M</given-names></name></person-group>             <year>2010</year>             <article-title>BioNumbers–the database of key numbers in molecular and cell biology.</article-title>             <source>Nucleic Acids Res</source>             <volume>38</volume>             <fpage>D750</fpage>             <lpage>D753</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Schrijver1">
        <label>25</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schrijver</surname><given-names>A</given-names></name></person-group>             <year>1986</year>             <source>Theory of linear and integer programming</source>             <publisher-name>John Wiley &amp; Sons Ltd</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Goffin1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Goffin</surname><given-names>JL</given-names></name></person-group>             <year>1980</year>             <article-title>The relaxation method for solving systems of linear inequalities.</article-title>             <source>Math Oper Res</source>             <volume>5</volume>             <fpage>388</fpage>             <lpage>414</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Agmon1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Agmon</surname><given-names>S</given-names></name></person-group>             <year>1954</year>             <article-title>The relaxation method for linear inequalities.</article-title>             <source>Canadian J Math</source>             <volume>6</volume>             <fpage>382</fpage>             <lpage>392</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Motzkin1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Motzkin</surname><given-names>TS</given-names></name><name name-style="western"><surname>Schoenberg</surname><given-names>IJ</given-names></name></person-group>             <year>1954</year>             <article-title>The relaxation method for linear inequalities.</article-title>             <source>Canadian J Math</source>             <volume>6</volume>             <fpage>393</fpage>             <lpage>404</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Krauth1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Krauth</surname><given-names>W</given-names></name><name name-style="western"><surname>Mézard</surname><given-names>M</given-names></name></person-group>             <year>1987</year>             <article-title>Learning algorithms with optimal stability in neural networks.</article-title>             <source>J Phys A: Math Gen</source>             <volume>20</volume>             <fpage>L745</fpage>             <lpage>L752</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-DeMartino2">
        <label>30</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>De Martino</surname><given-names>A</given-names></name><name name-style="western"><surname>Martelli</surname><given-names>C</given-names></name><name name-style="western"><surname>Monasson</surname><given-names>R</given-names></name><name name-style="western"><surname>Perez Castillo</surname><given-names>I</given-names></name></person-group>             <year>2007</year>             <article-title>Von Neumann's expanding model on random graphs.</article-title>             <source>J Stat Mech</source> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">P05012</size>           </element-citation>
      </ref>
      <ref id="pcbi.1002562-Martelli1">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Martelli</surname><given-names>C</given-names></name><name name-style="western"><surname>De Martino</surname><given-names>A</given-names></name><name name-style="western"><surname>Marinari</surname><given-names>E</given-names></name><name name-style="western"><surname>Marsili</surname><given-names>M</given-names></name><name name-style="western"><surname>Perez Castillo</surname><given-names>I</given-names></name></person-group>             <year>2009</year>             <article-title>Identifying essential genes in <italic>Escherichia coli</italic> from a metabolic optimization principle.</article-title>             <source>Proc Nat Acad Sci U S A</source>             <volume>106</volume>             <fpage>2607</fpage>             <lpage>2611</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-DeMartino3">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>De Martino</surname><given-names>A</given-names></name><name name-style="western"><surname>Marinari</surname><given-names>E</given-names></name></person-group>             <year>2010</year>             <article-title>The solution space of metabolic networks: producibility, robustness and fluctuations.</article-title>             <source>J Phys Conf Ser</source>             <volume>233</volume>             <fpage>012019</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Solodovnikov1">
        <label>33</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Solodovnikov</surname><given-names>AS</given-names></name></person-group>             <year>1980</year>             <source>Systems of linear inequalities</source>             <publisher-name>The University of Chicago Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Schellenberger2">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schellenberger</surname><given-names>J</given-names></name><name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name></person-group>             <year>2009</year>             <article-title>Use of Randomized Sampling for Analysis of Metabolic Networks.</article-title>             <source>J Biol Chem</source>             <volume>284</volume>             <fpage>5457</fpage>             <lpage>5461</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Gale1">
        <label>35</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gale</surname><given-names>D</given-names></name></person-group>             <year>1960</year>             <source>The theory of linear economic models</source>             <publisher-name>The University of Chicago Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-DeMartino4">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>De Martino</surname><given-names>A</given-names></name><name name-style="western"><surname>Marsili</surname><given-names>M</given-names></name></person-group>             <year>2005</year>             <article-title>Typical properties of optimal growth in the Von Neumann expanding model for large random economies.</article-title>             <source>J Stat Mech</source>             <fpage>L09003</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Imielinski1">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Imielinski</surname><given-names>M</given-names></name><name name-style="western"><surname>Belta</surname><given-names>C</given-names></name><name name-style="western"><surname>Rubin</surname><given-names>H</given-names></name><name name-style="western"><surname>Halasz</surname><given-names>A</given-names></name></person-group>             <year>2006</year>             <article-title>Systematic Analysis of Conservation Relations in Escherichia coli Genome-Scale Metabolic Network Reveals Novel Growth Media.</article-title>             <source>Biophys J</source>             <volume>90</volume>             <fpage>2659</fpage>             <lpage>2672</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Maskow1">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Maskow</surname><given-names>T</given-names></name><name name-style="western"><surname>Von Stockar</surname><given-names>U</given-names></name></person-group>             <year>2005</year>             <article-title>How reliable are thermodynamic feasibility statements of biochemical pathways?</article-title>             <source>Biotech Bioeng</source>             <volume>92</volume>             <fpage>223</fpage>             <lpage>230</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002562-Price2">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Price</surname><given-names>ND</given-names></name><name name-style="western"><surname>Famili</surname><given-names>I</given-names></name><name name-style="western"><surname>Beard</surname><given-names>DA</given-names></name><name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name></person-group>             <year>2002</year>             <article-title>Extreme pathways and Kirchhoff's second law.</article-title>             <source>Biophys J</source>             <volume>83</volume>             <fpage>2879</fpage>             <lpage>2882</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>