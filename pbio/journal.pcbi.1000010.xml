<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">07-PLCB-RA-0429R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000010</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Biochemistry/Transcription and Translation</subject><subject>Computational Biology/Sequence Motif Analysis</subject><subject>Computational Biology/Systems Biology</subject><subject>Computational Biology/Transcriptional Regulation</subject><subject>Genetics and Genomics/Gene Expression</subject></subj-group></article-categories><title-group><article-title>A Novel Bayesian DNA Motif Comparison Method for Clustering and Retrieval</article-title><alt-title alt-title-type="running-head">A Novel Motif Comparison Method</alt-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Habib</surname><given-names>Naomi</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Kaplan</surname><given-names>Tommy</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Margalit</surname><given-names>Hanah</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Friedman</surname><given-names>Nir</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>School of Computer Science and Engineering, The Hebrew University, Jerusalem, Israel</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Molecular Genetics and Biotechnology, Faculty of Medicine, The Hebrew University, Jerusalem, Israel</addr-line>       </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Fraenkel</surname><given-names>Ernest</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Massachusetts Institute of Technology, United States of America</aff><author-notes><corresp id="cor1">* E-mail: <email xlink:type="simple">nir@cs.huji.ac.il</email></corresp><fn fn-type="con"><p>Conceived and designed the experiments: NH TK HM NF. Performed the experiments: NH. Analyzed the data: NH TK. Wrote the paper: NH TK HM NF.</p></fn><fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>2</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>29</day><month>2</month><year>2008</year></pub-date><volume>4</volume><issue>2</issue><elocation-id>e1000010</elocation-id><history><date date-type="received"><day>19</day><month>7</month><year>2007</year></date><date date-type="accepted"><day>24</day><month>1</month><year>2008</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder>Habib et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Characterizing the DNA-binding specificities of transcription factors is a key problem in computational biology that has been addressed by multiple algorithms. These usually take as input sequences that are putatively bound by the same factor and output one or more DNA motifs. A common practice is to apply several such algorithms simultaneously to improve coverage at the price of redundancy. In interpreting such results, two tasks are crucial: <italic>clustering</italic> of redundant motifs, and attributing the motifs to transcription factors by <italic>retrieval</italic> of similar motifs from previously characterized motif libraries. Both tasks inherently involve motif comparison. Here we present a novel method for comparing and merging motifs, based on Bayesian probabilistic principles. This method takes into account both the similarity in positional nucleotide distributions of the two motifs and their dissimilarity to the background distribution. We demonstrate the use of the new comparison method as a basis for motif clustering and retrieval procedures, and compare it to several commonly used alternatives. Our results show that the new method outperforms other available methods in accuracy and sensitivity. We incorporated the resulting motif clustering and retrieval procedures in a large-scale automated pipeline for analyzing DNA motifs. This pipeline integrates the results of various DNA motif discovery algorithms and automatically merges redundant motifs from multiple training sets into a coherent annotated library of motifs. Application of this pipeline to recent genome-wide transcription factor location data in <italic>S. cerevisiae</italic> successfully identified DNA motifs in a manner that is as good as semi-automated analysis reported in the literature. Moreover, we show how this analysis elucidates the mechanisms of condition-specific preferences of transcription factors.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><p>Regulation of gene expression plays a central role in the activity of living cells and in their response to internal (e.g., cell division) or external (e.g., stress) stimuli. Key players in determining gene-specific regulation are transcription factors that bind sequence-specific sites on the DNA, modulating the expression of nearby genes. To understand the regulatory program of the cell, we need to identify these transcription factors, when they act, and on which genes. Transcription regulatory maps can be assembled by computational analysis of experimental data, by discovering the DNA recognition sequences (motifs) of transcription factors and their occurrences along the genome. Such an analysis usually results in a large number of overlapping motifs. To reconstruct regulatory maps, it is crucial to combine similar motifs and to relate them to transcription factors. To this end we developed an accurate fully-automated method, termed BLiC, based upon an improved similarity measure for comparing DNA motifs. By applying it to genome-wide data in yeast, we identified the DNA motifs of transcription factors and their putative target genes. Finally, we analyze motifs of transcription factor that alter their target genes under different conditions, and show how cells adjust their regulatory program in response to environmental changes.</p></abstract><funding-group><funding-statement>This study was supported by grants from the Israeli Science Foundation administered by the Israeli Academy of Sciences and Humanities (HM), The Israeli Cancer Research Foundation (HM), the Human Frontiers Science Program (NF), and the National Institutes of Health (NF).</funding-statement></funding-group><counts><page-count count="16"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Transcription initiation is modulated by transcription factors that recognize sequence-specific binding sites in regulatory regions. The organization of binding sites around a gene specifies which factors can bind to it and where, and consequently determines to what extent the gene is transcribed under different conditions. To understand this regulatory mechanism, one must specify the DNA binding preferences of transcription factors. These preferences are usually characterized by a motif that summarizes the commonalities among the binding sites of a transcription factor <xref ref-type="bibr" rid="pcbi.1000010-Stormo1">[1]</xref>. Multiple tools were developed for finding motifs (e.g., <xref ref-type="bibr" rid="pcbi.1000010-Liu1">[2]</xref>–<xref ref-type="bibr" rid="pcbi.1000010-Morozov1">[5]</xref>), however there are several problems in interpreting their output. Typically these algorithms output multiple results which require filtering and scoring. Moreover, different motif discovery methods have complementary successes, and therefore it is beneficial to apply multiple methods simultaneously and collate their results <xref ref-type="bibr" rid="pcbi.1000010-MacIsaac1">[6]</xref>. In addition, the motif discovery algorithms frequently produce a redundant output and the transcription factor that binds each motif is usually unknown. As similar motifs may represent binding sites of the same factor, eliminating this redundancy is essential for elucidating the true transcriptional regulatory program. The general strategy is thus to cluster similar motifs and merge motifs within each cluster to create a library of non-redundant motifs <xref ref-type="bibr" rid="pcbi.1000010-MacIsaac1">[6]</xref> (<xref ref-type="fig" rid="pcbi-1000010-g001">Figure 1B</xref>). Next, in order to interpret the meaning of the discovered motifs, they are compared to databases of previously characterized motifs (<xref ref-type="fig" rid="pcbi-1000010-g001">Figure 1C</xref>). In large-scale experiments, where the motif output set is very large, the tasks of scoring, merging and identifying motifs need to be automated. To address both the clustering and the retrieval challenges, we need an accurate and sensitive method for comparing DNA motifs.</p><fig id="pcbi-1000010-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000010.g001</object-id><label>Figure 1</label><caption><title>Overview of the challenges in DNA motif analysis.</title><p>(A) Identifying DNA binding motifs: Applying motif discovery algorithms to a group of related DNA sequences leads to the identification of putative transcription factor DNA binding sites. These algorithms output a set of DNA motifs, which are frequently redundant. To infer the correct transcription regulation map from the discovered motif set, it is crucial to reduce this redundancy and to relate the discovered motifs to known ones. (B) Reducing redundancy by clustering and merging motifs: A redundant set of DNA motifs can be reduced by clustering the motifs into groups of related ones and merging the motifs within each cluster. In this example, a redundant set of 16 DNA motifs (a partial output of several motif search algorithms) is clustered and merged to a final set consisting of three DNA motifs. (C) Relating motifs to known factors: The transcription factors that bind the newly discovered DNA motifs can be revealed based on similarities to previously defined motifs. In this example, comparison of a newly discovered motif to four known motifs reveals high similarity to the Gcn4 binding motif. From this comparison the transcription factor that binds the motif is identified with high probability.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.g001" xlink:type="simple"/></fig><p>In the literature there is an ongoing discussion regarding the best representation of DNA motifs <xref ref-type="bibr" rid="pcbi.1000010-Stormo1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000010-Osada1">[7]</xref>–<xref ref-type="bibr" rid="pcbi.1000010-Barash1">[10]</xref>. Here we use a Position Frequency Matrix (PFM), which has the benefits of being relatively simple yet flexible. A PFM is a matrix of positions in the binding site versus nucleotide preferences, where each row represents one residue and each column represents the nucleotide count at each position in a set of aligned binding sites. This representation assumes that the choice of nucleotides at different positions is independent of all other positions.</p><p>To compare two PFMs, we need to consider all possible alignments between them. Given two aligned PFMs, we utilize the position-independence assumption to decompose the similarity score into a sum of the similarities of single aligned positions. Several similarity scores can be used to compare a pair of aligned positions. One approach uses the Pearson correlation coefficient (e.g., <xref ref-type="bibr" rid="pcbi.1000010-Hughes1">[11]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Xie1">[12]</xref>). This measure, however, might inappropriately capture similarities between probabilities (<xref ref-type="fig" rid="pcbi-1000010-g002">Figure 2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000010.s001">Figure S1</xref>). Alternative approaches are based on similarity between two distributions. This can be a metric distance, such as the Euclidean distance <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref> or an information-theoretic measure, such as the Jensen-Shannon divergence <xref ref-type="bibr" rid="pcbi.1000010-Lin1">[14]</xref>. While these latter distances do not have the artifacts of the Pearson correlation, they equally weight positions with similar nucleotide distributions that are specific (e.g., a strong preference for an A) and similar positions that are non-informative (e.g., identical to the background distribution) (<xref ref-type="fig" rid="pcbi-1000010-g002">Figure 2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000010.s001">Figure S1</xref>). It is important to differentiate between these two situations: Two positions whose similarity is due to a resemblance to the background distribution are less relevant to motif similarity, as they do not contribute to sequence-specific binding of proteins <xref ref-type="bibr" rid="pcbi.1000010-Yona1">[15]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Wang1">[16]</xref>. In this work we use this intuition to develop a novel method for comparing and merging DNA motifs, based on Bayesian probabilistic reasoning. We define a new similarity score that combines the statistical similarity between the motifs with their dissimilarity to the background distribution. To calculate this score we estimate the probabilities of DNA nucleotides in each position of the DNA motif, by a Bayesian estimator with a Dirichlet mixture prior <xref ref-type="bibr" rid="pcbi.1000010-Sjolander1">[17]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Xing1">[18]</xref> to model the multi-modal nucleotide distribution at different binding site positions.</p><fig id="pcbi-1000010-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000010.g002</object-id><label>Figure 2</label><caption><title>Problematic aspects of previous motif similarity scores.</title><p>(A) Distinguishing between informative and non-informative positions: Two pairs of aligned motifs are demonstrated, both of which having three identical positions and two different ones. While the identical positions in the first pair (left) are non-informative, the identical positions in the second pair (right) are informative. The desired similarity score should distinguish between these two types of similarities and assign a higher score to pair number 2. The nucleotide distributions are visualized so that the height of each nucleotide is proportional to its probability (see a real life example in <xref ref-type="supplementary-material" rid="pcbi.1000010.s001">Figure S1</xref>). (B) Problematic aspects of motif similarity scores: The similarity score of two position frequency matrices (PFMs) decomposes into the sum of similarities of single aligned positions, due to the common position-independence assumption in the model. Here we present the similarity scores for various pairs of positions in DNA motifs according to several similarity functions, in addition to the desired score (scores are normalized to arbitrary scale of −1 to 1). The nucleotide distribution in each position is visualized as in (A) (the height of each nucleotide is proportional to its probability). As shown here, all scores (Pearson correlation, Jensen-Shannon divergence, and Euclidean distance) do not reflect the “true” similarity between two distributions or cannot differ between informative and uniform background positions. Specifically, position 1 should get a higher score than position 2, but the Pearson correlation scores for these positions are equal. Position 3 should get the lowest possible score, yet the Pearson correlation does not capture this. Both in positions 1 and 4 identical distributions are compared, but the informative position 1 should get a higher score than position 4. However, all three methods fail to obtain this. Both positions 4 and 5 analyze nearly-uniform distributions. While in position 4 two identical distributions are compared, in position 5 there are small variations, which alter the order of nucleotides. As we show, Pearson correlation grades position 5 substantially lower than position 4.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.g002" xlink:type="simple"/></fig><p>This motif similarity score is used by us to identify similar motifs that represent binding sites of the same factor and for clustering motifs. For the latter we devised a hierarchal agglomerative clustering procedure that is based on our motif similarity score. Our results show that the new method outperforms other alternatives in accuracy and sensitivity in both the clustering and retrieval tasks.</p><p>Using our new similarity score and the clustering method based upon it, we developed a large-scale analysis pipeline of DNA motif sets. This pipeline is designed for analysis following concurrent motif search by a combination of methods (using the TAMO package <xref ref-type="bibr" rid="pcbi.1000010-Gordon1">[19]</xref>). The goal is to process the set of DNA motifs into a set of reliable non-redundant motifs. We use our method to identify sets of DNA motifs from a large-scale ChIP-chip assay in <italic>S. cerevisiae</italic> <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref>. This allows us to examine how transcription factors alter their DNA binding preferences under various environmental conditions and elucidate mechanisms for condition-specific preferences.</p></sec><sec id="s2"><title>Results</title><sec id="s2a"><title>A Novel DNA Motif Similarity Score</title><p>Our goal is to determine whether two DNA motifs represent the same binding preferences. Since the less informative positions in a motif do not contribute to sequence-specific binding of proteins, we developed a similarity score that measures the similarity between two DNA motifs, while taking into account their dissimilarity from the background distribution.</p><p>We now develop the details of the score. We can view DNA motifs as a list of binding sites from which the nucleotide distribution at each position is estimated. This view allows us to perform statistical evaluations. We assume that each binding site was sampled independently from a common distribution over nucleotides, which satisfies the position independence properties (in correspondence with the motif PFM representation described above). Then, we can evaluate the likelihood ratio of different source distributions of the sampled binding sites. In practice, we keep only the <italic>sufficient statistics</italic> allowing us to evaluate the likelihood of the binding sites. These sufficient statistics are the counts of each nucleotide in each position, represented as a PFM.</p><p>Our score is composed of two components: the first measures whether the two motifs were generated from a common distribution, while the second reflects the distance of that common distribution from the background (see <xref ref-type="sec" rid="s4">Methods</xref>). Our Bayesian Likelihood 2-Component (BLiC) score for comparing motifs m<sub>1</sub> and m<sub>2</sub> is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.e001" xlink:type="simple"/><label>(1)</label></disp-formula>Under the position independence assumption, the score decomposes into a sum of local position scores. More precisely, our likelihood-based score measures the probability of the nucleotide counts in each position of the motif given a source distribution. For two aligned positions in the compared motifs, let n<sup>1</sup> and n<sup>2</sup> be the corresponding positions (count vectors) in the two motifs, the similarity score is then:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.e002" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000010.e003" xlink:type="simple"/></inline-formula> are the estimators for the source distribution of n<sup>1</sup>, n<sup>2</sup> and the common source distribution, respectively, <italic>P<sup>bg</sup></italic> is the background nucleotide distribution, and <italic>NT</italic> = {<italic>A</italic>,<italic>C</italic>,<italic>G</italic>,<italic>T</italic>}.</p><p>Since the source distribution is unknown, we must estimate it from the nucleotide counts at each position. We used a Bayesian estimator, where a priori knowledge and the number of samples were integrated into the estimation process. We considered two alternative priors. The first is a standard <italic>Dirichlet</italic> prior <xref ref-type="bibr" rid="pcbi.1000010-DeGroot1">[20]</xref>, which is conjugate to the multinomial distribution, enabling us to compute the estimations efficiently (see <xref ref-type="sec" rid="s4">Methods</xref>). However with this prior we cannot model our prior knowledge that a position in a DNA motif tends to have specific preference to one or more nucleotides. Such prior knowledge can be described with a <italic>Dirichlet mixture</italic> prior <xref ref-type="bibr" rid="pcbi.1000010-Sjolander1">[17]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Xing1">[18]</xref>, which represents a prior that consists of several “typical” distributions. Specifically, we used a five-component mixture prior, with four components representing an informative distribution, giving high probability for a single nucleotide: A, C, G, or T. The fifth component represents the uniform distribution (see <xref ref-type="sec" rid="s4">Methods</xref>).</p><p>In the above discussion we assumed that the motifs are aligned, but in practice, we compare unaligned motifs. Thus, we defined the similarity score for two motifs as the score of the best possible alignment (without gaps) between them, including the reverse complement alignment.</p><p>In addition, we need statistical calibration of the similarity scores, since a high similarity score might be due to chance events <xref ref-type="bibr" rid="pcbi.1000010-Gupta1">[21]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Bailey2">[22]</xref>. In particular, when comparing a single motif against motifs of different lengths, the probability of similarity by chance depends on the query motif and the length of the target. To circumvent these problems we use the <italic>p</italic>-value of the similarity score, which is computed empirically for each query against the distribution of scores of random motifs of a given length (see <xref ref-type="sec" rid="s4">Methods</xref> and <xref ref-type="fig" rid="pcbi-1000010-g003">Figure 3</xref>).</p><fig id="pcbi-1000010-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000010.g003</object-id><label>Figure 3</label><caption><title>Evaluation of motif comparison scores.</title><p>(A) Generating the test data set: Given a set of genomic binding sites for a transcription factor, we generate motifs by randomly sampling subsets of genomic binding sites (including 5, 15, or 35 samples per motif), aligning them, and then truncating the resulting motif to include only a part of the motif. By repeating this procedure, slightly different sets of binding sites were built for each factor. This “Yeast” data set consisted of noisy motifs for nine different <italic>S. cerevisiae</italic> transcription factors using the genomic sequences obtained by Harbison et al. <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref>, with a total of 240 motifs for each factor. (B) Sensitivity and specificity of different scoring methods: Comparison of different scoring methods on the “Yeast” data set using a subset of motifs generated from subsets of size 35 with altered lengths (not including the full length motifs, 685 motifs). Each similarity score was assigned an empirical statistical significance <italic>p</italic>-value. The ROC curve plots the true positive rate (TPR) vs. the false positive rate (FPR), as computed for different <italic>p</italic>-value thresholds, where pairs of motifs generated from genomic binding sites that were associated with the same factor are considered true positives. The BLiC score (green, using a <italic>Dirichlet</italic> prior, or blue, using a <italic>Dirichlet</italic>-mixture prior) outperformed all other similarity scores: Jensen-Shannon (JS) divergence (red), Euclidean distance (purple), and Pearson Correlation coefficient (cyan). The full arsenal of comparisons is shown in <xref ref-type="supplementary-material" rid="pcbi.1000010.s002">Figure S2</xref>. (C) Sensitivity and specificity estimated by structural data: Same as (B), but using the “Structural” data set of Mahony et al. <xref ref-type="bibr" rid="pcbi.1000010-Mahony1">[24]</xref>. Pairs of motifs from the same structural family are considered true positives.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.g003" xlink:type="simple"/></fig><sec id="s2a1"><title>Clustering motifs</title><p>An important application of motif similarity scores is clustering. There are many clustering methods <xref ref-type="bibr" rid="pcbi.1000010-Jain1">[23]</xref> that can be applied to motifs. Here we consider one of the simplest and straightforward clustering procedures where we combined a similarity score, such as our BLiC score, within a hierarchical agglomerative clustering algorithm. In each iteration, the algorithm computes the similarity between all pairs of motifs and then merges the most similar pair into a new motif based on the best alignment between the two motifs (see <xref ref-type="fig" rid="pcbi-1000010-g001">Figure 1</xref>). It then replaces the two original motifs by the new motif. These iterations are performed until we are left with a single motif. The order of merge operations results in a tree, where the leaves are the initial motifs, and inner nodes correspond to merged motifs that represent all motifs in the relevant sub-tree (see <xref ref-type="fig" rid="pcbi-1000010-g004">Figure 4A</xref>). We stress that this procedure is different than standard hierarchical clustering (such as UPGMA clustering). Since we merge motifs to create a new one, the similarity of the merged motif to another is different from the average similarity of each of the original motifs to that third motif.</p><p>We use the clustering tree to distill a large group of motifs into a concise non-redundant set, by splitting the tree into a subset of clusters, each representing a group of redundant motifs by choosing a frontier in the tree (see <xref ref-type="fig" rid="pcbi-1000010-g004">Figure 4A</xref> and <xref ref-type="sec" rid="s4">Methods</xref>).</p><fig id="pcbi-1000010-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000010.g004</object-id><label>Figure 4</label><caption><title>Evaluation of clustering DNA motifs.</title><p>(A) Motif clustering: In this example, the initial motif set consists of four motifs. The score assigned to each pair of motifs is the score of the best possible alignment between them (including the reverse complement form, as demonstrated in this example). In each step the highest scoring pair is merged into a new motif (by combining the evidence from both motifs). These steps are repeated until we are left with a single motif. The order of merge operations results in a tree, where the leaves are the initial motifs. Each frontier in this tree creates a set of motifs. A frontier in a tree is a subset of nodes, non-descendent to each other, with every leaf in the tree a descendant of one of them. In this example, a frontier resulting in two motifs is chosen, one is an initial motif and the other is a motif created by merging three initial motifs. These two motifs are the non-redundant set of motifs, derived from the initial set. (B) Evaluation of clustering with different scoring methods: Motifs from the “Yeast” data set, generated from subsets of size 15 (180 motifs), were clustered. We split the resulting clustering tree using different thresholds. Each such threshold defines a different tradeoff between true positive rate (percent of correctly classified motifs in the clustering tree) versus the number of clusters. In this graph we plotted the average of nine repeats of clustering sets of 180 motifs described above (total of 1620 different noisy motifs). This tradeoff curve demonstrates that our BLiC score (green, using a <italic>Dirichlet</italic> prior, and blue, using a <italic>Dirichlet</italic>-mixture prior) outperforms all other scoring methods, Pearson Correlation, Euclidean distance, and Jensen-Shannon. A more detailed evaluation of clustering noisy motifs using various similarity scores is shown in <xref ref-type="supplementary-material" rid="pcbi.1000010.s003">Figure S3</xref>. (C) Clustering evaluated by structural data: Tradeoff curves (as in (B)) for clustering motifs in the “Structural” data set <xref ref-type="bibr" rid="pcbi.1000010-Mahony1">[24]</xref>. Pairs of motifs from the same structural family are considered true positives.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.g004" xlink:type="simple"/></fig></sec></sec><sec id="s2b"><title>Comprehensive Evaluation of Similarity Scores</title><p>We set out to compare our similarity score to existing ones in the literature, in the context of both motif comparison and clustering. We use two different data sets.</p><p>The first data set, which we refer to as “Yeast” is a synthetic one where we know the true labeling of motifs and use it to benchmark different procedures by relating their results with the underlying truth. To generate synthetic motifs in a realistic manner that reflects true binding properties of transcription factors, we use the genome-wide catalogue of transcription factor binding locations in <italic>S. cerevisiae</italic> <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref>. This catalogue has high-confidence binding sites (based on combination of experimental assays with evolutionary conservation considerations). From these, we selected nine transcription factors to represent different binding patterns (in terms of inner arrangements of informative positions and length). From the binding sites of each factor we sampled sets of binding sites, and from each set generated a motif (see <xref ref-type="fig" rid="pcbi-1000010-g003">Figure 3A</xref>). For each factor we generated noisy motifs that differ in their quality. To do so, we varied the number of binding sites (sizes of 5, 15 or 35) and the coverage of the motif (full site, its beginning, middle, or end). We repeated this for each motif 20 times, creating a set of 240 random motifs for each of the nine transcription factors.</p><p>The second data set, which we refer to as “Structural”, was compiled by Mahony et al. <xref ref-type="bibr" rid="pcbi.1000010-Mahony1">[24]</xref>. Their evaluation is based on structural information. Since structurally related transcription factors often have similar DNA-binding preferences, the best match to a given motif is expected to be a motif associated with a member of the same structural class. Mahony et al. compiled a data set that contains the motifs of the families with four or more profiles in JASPAR <xref ref-type="bibr" rid="pcbi.1000010-Sandelin1">[25]</xref>.</p><p>Using these two data sets we compared different possible similarity scores for DNA motifs. Specifically, we compared the Pearson correlation coefficient; the information-theory based Jensen-Shannon divergence; the Euclidean distance; and our BLiC score.</p><sec id="s2b1"><title>Motif comparison evaluation—Identifying similar motifs</title><p>We evaluated the sensitivity and specificity of motif similarity scoring methods by comparing all possible pairs of motifs from the data sets described above, and testing whether pairs that have high similarity indeed were generated from the same source. In the “Yeast” data set we call a pair as true if the two motifs were generated from binding locations of the same transcription factor, and in the “Structural” data set we call a pair as true if the motifs are of factors from the same structural class. For each motif pair, if the similarity is statistically significant we label this as a positive pair, and otherwise call it a negative. We compared this prediction to the label of the pair, and calculated the sensitivity and specificity for each <italic>p</italic>-value threshold to create ROC curves (<xref ref-type="fig" rid="pcbi-1000010-g003">Figure 3B and 3C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000010.s002">Figure S2</xref>). Comparing the ROC curves of our score to those of previously suggested scores we see that the BLiC score outperformed all other scores throughout the range of possible sensitivity/specificity tradeoffs on both data sets.</p><p>The construction of the “Yeast” data set allows examining different parameters that make the task more challenging. We do so by restricting the number of binding sites or by checking whether the motif is partial or not. Using a smaller number of sites results in higher variability among motifs of the same factor, and using partial coverage means smaller overlap between compared motifs; see <xref ref-type="supplementary-material" rid="pcbi.1000010.s002">Figure S2</xref>. These results show that as the task becomes harder all the methods have reduced success rate: for 5% False Positive Rate (FPR), the True Positive Rates (TPR) vary from 65% (for partial overlapping motifs from samples of size 5) to 99% (for the motif with different offsets compared to the full length motifs from sample of size 35). Nonetheless, using our score improves the retrieval rates substantially in most tasks; for example, when looking at sub-motifs with partial overlap from samples of size 35, for 5% FPR using the BLiC score leads to 80% TPR, compared to 62% with the Euclidean distance or 57% with the Pearson Correlation (see <xref ref-type="fig" rid="pcbi-1000010-g003">Figure 3B</xref>). For some tasks, such as comparing the motifs of different offsets to the full length motifs, our method did not show statistically significant improvement (see <xref ref-type="supplementary-material" rid="pcbi.1000010.s002">Figure S2</xref>).</p><p>Comparing our two alternative priors, The <italic>Dirichlet</italic> prior versus the <italic>Dirichlet-Mixture</italic> prior, our results show that the more complex prior, which better models the nucleotide distribution in binding sites, leads to better results as the number of samples decreases (see <xref ref-type="supplementary-material" rid="pcbi.1000010.s002">Figure S2</xref>). When the number of samples is larger, the two priors result in similar performance.</p></sec><sec id="s2b2"><title>Motif clustering evaluation—Reducing the redundancy</title><p>To further evaluate the accuracy of the different similarity scores we used these scores in clustering motifs from the two data sets. For this, we used the hierarchical agglomerative clustering algorithm described above. We then examined whether clusters consisted of motifs that are considered similar (either from the same factor in the “Yeast“ data set, or the same structural family in the “Structural” data set). Examining the cluster hierarchy at different levels of granularity we get a tradeoff curve between two criteria, the True Positive Rate (TPR) of all clusters, and the number of clusters; see <xref ref-type="fig" rid="pcbi-1000010-g004">Figure 4</xref>. The results show that the BLiC score outperformed the other similarity scores in the “Yeast” data set and is better than other similarity scores in the “Structural” data set.</p><p>As in the motif comparison evaluation, we can perform the clustering evaluation on various subsets of the “Yeast” data set (see <xref ref-type="fig" rid="pcbi-1000010-g004">Figure 4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000010.s003">Figure S3</xref>). From these results we see that in harder tasks, all methods have reduced success rates. Using our score improves the clustering rates significantly when clustering all the motifs or different subsets of motifs as described above; for example, when looking at all motifs from sample sets of size 15, using our BLiC score we reach 95% TPR with less than 14 clusters, while all other do not get more than 57% TPR (see <xref ref-type="fig" rid="pcbi-1000010-g004">Figure 4B</xref>).</p></sec></sec><sec id="s2c"><title>Large-Scale DNA Motif Analyses</title><sec id="s2c1"><title>Motif analysis pipeline</title><p>To facilitate analysis of many motifs we developed an automatic motif analysis pipeline, based on our BLiC score. This is a three-step method for processing and integrating large-scale data of newly discovered DNA motifs into coherent and reliable sets of non-redundant motifs. The inputs for this procedure are multiple groups of co-regulated DNA sequences, and the output is a set of non-redundant motifs and a ranking of their relevance for each of the input groups (<xref ref-type="fig" rid="pcbi-1000010-g005">Figure 5</xref>). The three steps of the pipeline include:</p><fig id="pcbi-1000010-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000010.g005</object-id><label>Figure 5</label><caption><title>Overview of the motif analysis pipeline.</title><p>The first step of the pipeline involves searching for motifs in each input set of DNA sequences, using complementary motif discovery algorithms. The motifs are filtered according to their abundance in the input set. In the second step the redundancy in the newly discovered set of motifs is reduced by clustering and merging the similar motifs. These steps are performed separately for each set (top boxes). Then, the motifs found in each input set are clustered and merged to create a global non-redundant set of motifs. These motifs are then associated with known motifs from pre-existing libraries. The refined motif set is ranked and filtered according to their abundance in each input set.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.g005" xlink:type="simple"/></fig><sec id="s2c1a"><title>Step 1: Motif searching and filtering</title><p>We begin by applying complementary motif discovery algorithms to each group of sequences. This is done using the TAMO package <xref ref-type="bibr" rid="pcbi.1000010-Gordon1">[19]</xref>. Then, the newly discovered motifs undergo an initial filtration according to their abundance among the group of sequences (see <xref ref-type="sec" rid="s4">Methods</xref>).</p></sec><sec id="s2c1b"><title>Step 2: Clustering and merging motifs</title><p>The integrated sets of motifs (from all input groups) are clustered and merged to create a non-redundant set. First, the discovered motifs for each group are clustered and merged separately. Then, motifs from all groups are assembled, clustered and merged. After each stage of clustering, a subset of refined motifs is automatically chosen based on the clustering tree (see <xref ref-type="sec" rid="s4">Methods</xref>).</p></sec><sec id="s2c1c"><title>Step 3: Ranking and identifying motifs</title><p>Finally, the non-redundant set of motifs is ranked and filtered once again, using the abundance of the motifs in the original groups of DNA sequences (see <xref ref-type="sec" rid="s4">Methods</xref>). To know which motif is new and which was previously characterized, we compare the motifs to a library of known DNA motifs from the literature (TRASFAC <xref ref-type="bibr" rid="pcbi.1000010-Matys1">[26]</xref>, SCPD <xref ref-type="bibr" rid="pcbi.1000010-Zhu1">[27]</xref>, YPD <xref ref-type="bibr" rid="pcbi.1000010-Csank1">[28]</xref>). By this comparison we associate the motifs with transcription factors.</p></sec></sec></sec><sec id="s2d"><title>Genome-Wide Yeast Motif Library</title><p>As a real life application of this pipeline we examined genome wide ChIP-chip measurements in <italic>S. cerevisiae</italic> of 177 transcription factors under several environmental conditions. In total we analyzed 301 experiments for different factors and conditions <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref>. We used seven motif discovery algorithms to produce a set of motifs for each ChIP-chip experiment. These motifs were clustered, filtered, ranked and compared to known motifs from the literature (as described above and in the <xref ref-type="sec" rid="s4">Methods</xref>). This resulted in a concise set of DNA motifs attributed to each transcription factor under each environmental condition (all the motif sets can be found at the Supplementary Web site <ext-link ext-link-type="uri" xlink:href="http://compbio.cs.huji.ac.il/BLiC" xlink:type="simple">http://compbio.cs.huji.ac.il/BLiC</ext-link>).</p><p>To further analyze the resulting Yeast DNA motif library, we contrast it against the wealth of genomic annotations in the yeast literature. To do so, we scanned each motif in the library against the promoters of yeast genes (see <xref ref-type="sec" rid="s4">Methods</xref>) and created a target gene set for the motif. We then scored the enrichment of these motif gene sets against different types of gene annotations: the original ChIP-chip data <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref>, GO functional annotations <xref ref-type="bibr" rid="pcbi.1000010-Harris1">[29]</xref>, and groups of genes which are up or down regulated according to gene expression data (assembled by <xref ref-type="bibr" rid="pcbi.1000010-DeRisi1">[30]</xref>–<xref ref-type="bibr" rid="pcbi.1000010-Spellman1">[32]</xref>). This allowed us to relate each motif to specific genomic annotations. To visualize these relationships we created a combined clustering of motifs and annotations using EdgeCluster - a clustering algorithm recently developed in our lab <xref ref-type="bibr" rid="pcbi.1000010-Friedman1">[33]</xref>. The novelty of EdgeCluster is in the integration of various sources of information into the clustering process. These information sources can be attributes of motifs (e.g., extent of enrichment in different gene sets) and pairwise information about motifs (i.e., the similarity of motif pairs). <xref ref-type="supplementary-material" rid="pcbi.1000010.s004">Figure S4</xref> demonstrates the clustering of all the motifs. Clustering of a partial set of motifs is presented in <xref ref-type="fig" rid="pcbi-1000010-g006">Figure 6</xref>.</p><fig id="pcbi-1000010-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000010.g006</object-id><label>Figure 6</label><caption><title>Overview of the discovered motifs.</title><p>Investigation of the properties of discovered motifs. Each motif (column) is compared to other motifs using the BLiC score (rows, top square), to enrichment of putative targets among expressed or silenced genes within a compendium of gene expression at different cellular conditions (second group), to the enrichment of targets within various GO annotations (third groups) and in ChIP-chip location assays (bottom group). The rows and columns were clustered using EdgeCluster <xref ref-type="bibr" rid="pcbi.1000010-Friedman1">[33]</xref>, an agglomerative clustering procedure that integrates various sources of information into the clustering process. Shown is clustering for partial sets of motifs related to the transcription factors: Fhl1, Sfp1, Rap1, Hsf1, Ste12, Mcm1, Swi4, Swi6, and Mbp1 (the full clustering is presented in <xref ref-type="supplementary-material" rid="pcbi.1000010.s004">Figure S4</xref> and on <ext-link ext-link-type="uri" xlink:href="http://compbio.cs.huji.ac.il/BLiC" xlink:type="simple">http://compbio.cs.huji.ac.il/BLiC</ext-link>).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.g006" xlink:type="simple"/></fig></sec><sec id="s2e"><title>Comparison to Previous Work</title><p>In the works of Harbison et al. <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref> and MacIsaac et al. <xref ref-type="bibr" rid="pcbi.1000010-MacIsaac2">[34]</xref>, the same ChIP-chip data was used to construct a global transcriptional regulatory map in yeast. The motif analyses performed in these two works differ from ours in the similarity score used (the Euclidean distance) and in the different motif clustering and merging methods. In addition, the output of these two works was a single motif for each transcription factor. To be consistent with these previous works in the comparison, we narrowed down our set of motifs for each ChIP experiment to a single motif.</p><p>We first looked only at transcription factors with previously characterized motifs. Our criterion for comparison is measuring the similarity to known motifs from the literature (TRANSFAC <xref ref-type="bibr" rid="pcbi.1000010-Matys1">[26]</xref>, SCPD <xref ref-type="bibr" rid="pcbi.1000010-Zhu1">[27]</xref>, YPD <xref ref-type="bibr" rid="pcbi.1000010-Csank1">[28]</xref>), using our BLiC score. To narrow down our motif set to a single motif for each factor we chose (as done in these previous works) the motif most similar to the known motif. In 65% of the cases our motifs have the highest similarity to the known motifs (<xref ref-type="fig" rid="pcbi-1000010-g007">Figure 7</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000010.s007">Table S1</xref>). The motifs learned by the algorithms of MacIsaac et al. and Harbison et al., had the highest similarity only in 22% and 12% of the motifs, respectively.</p><fig id="pcbi-1000010-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000010.g007</object-id><label>Figure 7</label><caption><title>Comparison to previous analysis methods.</title><p>Comparing our discovered set of motifs to the ones learned by Harbison et al. <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref> and MacIsaac et al. <xref ref-type="bibr" rid="pcbi.1000010-MacIsaac2">[34]</xref>. We plot the fraction of motifs that obtained the highest score among all three sets. We first compare transcription factors with previously characterized motifs by their similarity to the known motif from the literature <xref ref-type="bibr" rid="pcbi.1000010-Matys1">[26]</xref>–<xref ref-type="bibr" rid="pcbi.1000010-Csank1">[28]</xref>, calculated using our BLiC score. For this comparison, we took for each transcription factor the motif most similar to the known binding site (as done in these two previous works). Our motifs received the highest similarity score (among all three studies) in 65% of the cases (right). The second comparison is for transcription factors with no characterized binding motif. This comparison is based on the enrichment of the motifs in the ChIP-chip data sets. For this comparison we took the most highly enriched motif for each factor and condition (for consistency with the two previous works). The same parameters were applied in the analysis of motifs from all three methods. In this setting, our motifs were found to have higher enrichments in 80% of the cases (left).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.g007" xlink:type="simple"/></fig><p>For transcription factors with no previously known binding motif in the literature, we compared the enrichment of the motifs within the ChIP-chip groups of sequences. For the comparison, we narrowed the motif sets by choosing the most significant motif for each factor and environmental condition (similarly to what was done in these previous studies). We scanned the genomic sequences and computed the enrichment of each motif (see <xref ref-type="sec" rid="s4">Methods</xref>), using the same procedure and parameters for motifs from all three methods. Our motifs were found to have the highest enrichments in 80% of the cases (see <xref ref-type="fig" rid="pcbi-1000010-g007">Figure 7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000010.s007">Table S1</xref>).</p><p>To ensure that the improvement we see is not due to differences in motif discovery methods, we repeated the analysis using the original output of the motif discovery of Harbison et al. (data not shown). This lead to slight changes in the output motifs, as our original analysis used a superset of these motifs. Comparing these modified results against the results of Harbison et al. and MacIssac et al. we see essentially improvement as the one we reported above (in 62% of the cases our motifs have the highest similarity to the known motifs, and in 65% of the cases our motifs were found to have the highest enrichments).</p></sec><sec id="s2f"><title>Elucidating Conditional Binding of Transcription Factors</title><p>Using the motif sets we have learned, we next turned to examine the change in the binding specificities of the transcription factors under different conditions. We distinguish between two types of factors. A <italic>condition-independent</italic> factor binds the same targets in multiple conditions, while a <italic>condition-dependent</italic> factor changes its set of targets between conditions. An example of a condition-independent transcription factor in yeast is Fhl1, a master regulator of ribosomal genes, which according to the ChIP data remains bound to 75% of its targets under different conditions (see <xref ref-type="supplementary-material" rid="pcbi.1000010.s005">Figure S5A</xref>). This is consistent with previous work <xref ref-type="bibr" rid="pcbi.1000010-Martin1">[35]</xref> and with the motif analysis, where similar motifs are related to Fhl1 in all three conditions (see <xref ref-type="supplementary-material" rid="pcbi.1000010.s005">Figure S5B</xref>).</p><p>A condition-dependent regulator can show a range of behaviors in response to a change in condition. It may expand and bind additional targets, it may alter and bind to a different set of targets, or it may even not bind any targets <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref>. Various mechanisms may be involved in monitoring condition-dependent binding. A factor may expand its targets, due to dosage change of the active transcription factor in the nucleus <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref>. Alternatively, a factor may alter its targets due to several probable mechanisms (see <xref ref-type="supplementary-material" rid="pcbi.1000010.s006">Figure S6</xref>). One mechanism is changing the factor's specificity to the DNA, which we can trace by identifying variations in the DNA motif (<xref ref-type="supplementary-material" rid="pcbi.1000010.s006">Figure S6A</xref>). Another possible mechanism is a change in the factor's binding partner, which may be detected through co-occurrence of motifs of different factors (<xref ref-type="supplementary-material" rid="pcbi.1000010.s006">Figure S6B</xref>). In addition, a change of targets may be caused by a change in the accessibility to the binding site, which we cannot identify by analyzing motifs (<xref ref-type="supplementary-material" rid="pcbi.1000010.s006">Figure S6C</xref>).</p><p>We focus here on factors that alter their targets under different conditions and try to elucidate the mechanism. We defined a transcription factor as altering its target genes between two conditions, if the number of target genes in the intersection is less than half of the number in each condition separately. In addition, we considered only factors with at least 20 target genes in each of the two conditions (a sufficient number for motif discovery). Out of the 72 transcription factors for which ChIP-chip experiments were carried out in more than one condition, 50 factors alter their target genes between two conditions (in total, 112 pairs of differential conditions) (<xref ref-type="supplementary-material" rid="pcbi.1000010.s008">Table S2</xref>). We searched for differential motifs in the motif set of each factor at every condition. We say a motif is differential if there is a significant difference (p&lt;0.05, chi-square test) in the fraction of ChIP targets containing the motif between the two conditions (excluding the genes in the intersection). This analysis can potentially elucidate the mechanism through which a factor changes its DNA targets, by finding different variants of motifs, or co-occurrence of motifs of different factors as explained above. In about half of these pairs we did not find statistically significant motifs in at least one of the compared conditions and thus could not search for differential motifs. Finding a motif only for one condition could be meaningful on its own, since this may indicate that in the other condition there is no direct binding of the factor to the DNA. On the other hand it could result from technical reasons, such as noise in the input set of sequences, and thus in this work we do not analyze these cases. Out of the remaining 52 pairs (spanned over 27 different transcription factors), we found differential motifs for 88% of the factors (47 cases spanned over 24 factors, see <xref ref-type="supplementary-material" rid="pcbi.1000010.s009">Table S3</xref>) with a <italic>p</italic>-value of less than 0.05.</p></sec><sec id="s2g"><title>Condition-Dependent Binding of Ste12 under Conditions of Mating and Filamentous Growth</title><p>An example of a transcription factor that shows condition-dependent binding is Ste12, which activates genes in two alternative pathways—mating and filamentous growth <xref ref-type="bibr" rid="pcbi.1000010-Zeitlinger1">[36]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Chou1">[37]</xref> (<xref ref-type="fig" rid="pcbi-1000010-g008">Figure 8A</xref>). Under filamentous growth signaling (Butanol induction) we found that Ste12 binds promoters enriched with its known motif <xref ref-type="bibr" rid="pcbi.1000010-Madhani1">[38]</xref>, as well as the known recognition sequence of Tec1 <xref ref-type="bibr" rid="pcbi.1000010-Madhani1">[38]</xref>, a co-factor that binds the DNA with Ste12 under filamentous growth <xref ref-type="bibr" rid="pcbi.1000010-Chou1">[37]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Chou2">[39]</xref> (<xref ref-type="fig" rid="pcbi-1000010-g008">Figure 8B</xref>). However, under mating conditions (Alpha factor induction) we find that Ste12 binds promoters with another variant of the motif more highly enriched than the known one. This variant is a near-perfect tandem repeat of its known site, suggesting that Ste12 binds the DNA as a homodimer following Alpha factor induction <xref ref-type="bibr" rid="pcbi.1000010-Schaber1">[40]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Wang2">[41]</xref> (<xref ref-type="fig" rid="pcbi-1000010-g008">Figure 8B</xref>). An additional player found in our analysis is Mcm1, whose known motif <xref ref-type="bibr" rid="pcbi.1000010-Gelli1">[42]</xref> is enriched among promoters bound by Ste12 under both conditions. This is consistent with the role of Mcm1 inhibiting expression of mating genes in diploid cells <xref ref-type="bibr" rid="pcbi.1000010-Gelli1">[42]</xref>. Mcm1 may play a similar role in the filamentous growth pathway, in which haploid cells undergo invasive growth, and diploid cells undergo pseudohyphal growth. Interestingly, the exact same motifs were learned for the ChIP targets of the cofactor Dig1, under all the conditions stated above, which indicates that Dig1 does not bind the DNA directly <xref ref-type="bibr" rid="pcbi.1000010-Chou1">[37]</xref>. Thus, looking at the discovered motif sets, we can reveal the regulators involved and propose a mechanism through which a transcription factor alters its targets under different conditions. Here we propose the altered binding is caused by a change in the DNA binding partner: Ste12 binds the DNA with Tec1 under filamentous growth and as a homodimer under mating conditions.</p><fig id="pcbi-1000010-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000010.g008</object-id><label>Figure 8</label><caption><title>Condition dependent behavior of Ste12.</title><p>(A) A Venn diagram representing the results of the ChIP-chip experiment <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref> for Ste12 under mating (induced by alpha factor) and filamentous growth (induced by butanol). Ste12 alters its targets substantially between these two conditions. (B) Analysis of the percent of sequences bound by Ste12 which contain the different motifs (when searching for motif occurrences at 2% false positive rate). Shown are the different motifs in the targets bound by Ste12 in filamentous growth condition only (yellow), in mating condition only (blue), or in both conditions (green). Each motif is shown as a sequence logo on the left and percent occurrence in each group as bar chart on the right. We can see that under filamentous growth there is enrichment for a motif similar to the previously characterized Ste12 motif (top motif), as well as the known recognition sequence of Tec1 (third from top). Under mating there is an enrichment for a near-perfect tandem repeat of Ste12 known binding site (second from top). A motif similar to the known Mcm1 motif (bottom motif) is found to be enriched under both conditions, especially under filamentous growth.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.g008" xlink:type="simple"/></fig></sec><sec id="s2h"><title>Condition-Dependent Binding of the Iron-Regulated Factor Aft2</title><p>Another interesting example is provided by the iron-regulated transcription factor Aft2, required for iron homeostasis and resistance to oxidative stress <xref ref-type="bibr" rid="pcbi.1000010-Courel1">[43]</xref>. This factor exhibits a significant environmental-dependent binding, switching targets between low and high H<sub>2</sub>O<sub>2</sub> conditions (<xref ref-type="fig" rid="pcbi-1000010-g009">Figure 9A</xref>). The role of Aft2 in iron homeostasis and resistance to oxidative stress is poorly understood. In low H<sub>2</sub>O<sub>2</sub>, we find that Aft2-bound promoters are highly enriched with a motif similar to the known recognition sequence of Aft2 (GgGTG) <xref ref-type="bibr" rid="pcbi.1000010-Courel1">[43]</xref>. However, in high H<sub>2</sub>O<sub>2</sub> we find abundant occurrences of a low complexity Poly-GT motif (<xref ref-type="fig" rid="pcbi-1000010-g009">Figure 9B</xref>). This result indicates that a possible explanation for the change in Aft2 DNA targets is a change in its DNA binding specificity over these conditions. We reach this conclusion due to the lack of the known motif or motifs of other factors in the bound targets under high H<sub>2</sub>O<sub>2</sub> and due to the similarity of the Poly-GT to the known motif. Furthermore, the poly-GT motif under high H<sub>2</sub>O<sub>2</sub> may suggest that Aft2 binds the DNA as a homodimer. Interestingly, the known motif of Aft1 (Rcs1) <xref ref-type="bibr" rid="pcbi.1000010-Courel1">[43]</xref>, a paralog of Aft2, was enriched among the Aft2-bound promoters in low H<sub>2</sub>O<sub>2</sub> condition. This implies a possible overlap between the targets of Aft2 and Aft1, supported by ChIP-chip data of the two factors (<xref ref-type="fig" rid="pcbi-1000010-g009">Figure 9B</xref>). Based on our analysis, we report two similar (but not identical) motifs for the two paralogs (as suggested by <xref ref-type="bibr" rid="pcbi.1000010-Courel1">[43]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Rutherford1">[44]</xref>). Since it is known that Aft2 and Aft1 have independent and partially redundant roles in iron regulation <xref ref-type="bibr" rid="pcbi.1000010-Courel1">[43]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Rutherford1">[44]</xref>, this strengths our assumption that Aft2 binding to the DNA does not depend on Aft1, but is due to a change in its specificity to the DNA. The ChIP-chip data and our motif analysis suggest that under high H<sub>2</sub>O<sub>2</sub> conditions Aft2 has a unique role in gene regulation. Here again, by looking at the motif sets, we propose a mechanism for condition dependent binding of a transcription factor. In this case we propose the cause is a change in the factor's specificity to the DNA.</p><fig id="pcbi-1000010-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000010.g009</object-id><label>Figure 9</label><caption><title>Condition dependent behavior of Aft2.</title><p>(A) Venn diagrams representing the results of the ChIP-chip experiment <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref> for the transcription factors Aft2 and Rcs1 under high and low H<sub>2</sub>O<sub>2</sub> stress. Aft2 alters its targets substantially between these two conditions. (B) Analysis of percent of sequences bound by Aft2, which contain the different motifs (when searching for motif occurrences at 2% false positive rate). Shown are the different motifs in the targets bound by Aft2 and Rcs1 in low H<sub>2</sub>O<sub>2</sub> stress only (yellow and blue, respectively), in high H<sub>2</sub>O<sub>2</sub> stress only (red and green, respectively) or in both conditions (orange and cyan, respectively). Each motif is shown as a sequence logo on the left and percent occurrence in each group as bar chart on the right. Under low H<sub>2</sub>O<sub>2</sub> stress there is enrichment for a motif similar to the previously characterized Aft2 motif (top motif), as well as for the known recognition sequence of Rcs1 (middle motif). Under high H<sub>2</sub>O<sub>2</sub> stress only abundant low-complexity repeats of Poly-GT (bottom motif) have been identified.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.g009" xlink:type="simple"/></fig></sec></sec><sec id="s3"><title>Discussion</title><p>An accurate motif comparison method is important for clustering redundant DNA motifs into coherent groups and for connecting the discovered motifs to previously characterized motifs. In this study we present a novel similarity score, the BLiC score, based on Bayesian probabilistic principles. We use the new comparison method as a basis for motif clustering and retrieval procedures, and compare it to several commonly used alternatives. This comparison shows that our BLiC score improves the specificity and sensitivity of motif comparisons and clustering tasks. The resulting motif clustering and retrieval procedures are incorporated in a large-scale automated pipeline for analyzing DNA motifs, which integrates the output of various DNA motif discovery algorithms and automatically merges redundant motifs from multiple training sets. The output of our pipeline is a coherent annotated library of motifs. Application of this pipeline to genome-wide location data of transcription factors in <italic>S. cerevisiae</italic>, successfully identified DNA motifs in a manner that is as good as semi-automated analyses reported in the literature. Moreover, we demonstrate how motif analysis can lead to insights into regulatory mechanisms.</p><sec id="s3a"><title>Hierarchical Agglomerative Clustering</title><p>We used our BLiC score to develop a hierarchical agglomerative clustering algorithm for merging similar motifs, in which we ensure that the motifs within every sub-tree are properly aligned. Furthermore, such an approach allows us to trim the cluster tree at various levels, thus allowing us to merge motifs at different resolutions. In our method a new agglomerative node results from aligning and merging the motifs of its descendent nodes, and then computing the similarly of this new motif to all other nodes. As a consequence, the hierarchical progression ensures that each sub-tree is coherent. This is in contrast to many clustering methods, such as k-means and typical hierarchical clustering <xref ref-type="bibr" rid="pcbi.1000010-Eisen1">[45]</xref> which find a set of motifs that are all similar to each other, but are not necessarily coherent in the sense that they cannot all be aligned.</p></sec><sec id="s3b"><title>Motif Analysis</title><p>Our motif analysis pipeline is designed to process discovered DNA motifs into a set of non-redundant motifs and compare these with known motifs. As we have shown, our approach improves the sensitivity and specificity in the analysis of the outputs of standard motif discovery methods. By automating all the steps, we enable the analysis of hundreds of input groups. In addition, we achieve a wide view on transcription regulation by running several motif discovery algorithms in parallel, and integrating their outputs. By comparing motifs from different input groups we are able to connect between transcription factors that play a role in different processes. Our analysis does not focus on finding the “best” single motif for each input group (e.g., targets of ChIP-chip assay), but rather we find a set of non-redundant motifs and their relations (enrichment) to each input group. This output better captures the complexity of the underlying regulatory program. For example, in many cases we find motifs of co-factors (e.g., Ste12 and Tec1). In other cases we see that a factor changes its binding specificity under different conditions (e.g., Aft2). For these cases, several DNA motifs better capture the DNA binding preferences of the transcription factor than a single motif.</p></sec><sec id="s3c"><title>Relations to Previous Work</title><p>There are several different approaches attempting to quantify similarities between DNA motifs. Two previous works <xref ref-type="bibr" rid="pcbi.1000010-Gupta1">[21]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Bailey2">[22]</xref> showed that using <italic>p</italic>-values when comparing motifs is more accurate than the actual similarity scores. Specifically, Gupta et al.<xref ref-type="bibr" rid="pcbi.1000010-Gupta1">[21]</xref>, compared seven motif-motif position similarity functions, including the Pearson Correlation coefficient (e.g., <xref ref-type="bibr" rid="pcbi.1000010-Hughes1">[11]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Pietrokovski1">[46]</xref>), average log-likelihood ratio (ALLR) <xref ref-type="bibr" rid="pcbi.1000010-Wang1">[16]</xref>, Kullback-Leibler divergence <xref ref-type="bibr" rid="pcbi.1000010-Roepcke1">[47]</xref>–<xref ref-type="bibr" rid="pcbi.1000010-Aerts1">[49]</xref>, and the Euclidean distance (ED) <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Choi1">[50]</xref>. They found that the Euclidean distance is slightly better than the alternatives they considered. The data set used by Gupta et al. has a similar design as our data set, but it is based on the TRANSFAC database <xref ref-type="bibr" rid="pcbi.1000010-Matys1">[26]</xref>. Not surprisingly, our results are consistent with theirs. Here we also use <italic>p</italic>-values to calibrate similarity scores, and show that our score is more accurate than the Euclidean distance, which is the second best.</p><p>Several resources are available for DNA motif analysis. There are many open access motif discovery tools available (e.g., <xref ref-type="bibr" rid="pcbi.1000010-Liu1">[2]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Bailey1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Hughes1">[11]</xref>) and motif comparison tools <xref ref-type="bibr" rid="pcbi.1000010-Hughes1">[11]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Gupta1">[21]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Mahony2">[51]</xref>. In addition there are several available tools that integrate multiple motif discovery tools, and supply additional tools for filtering, comparison and ranking motifs <xref ref-type="bibr" rid="pcbi.1000010-Gordon1">[19]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Aerts1">[49]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Che1">[52]</xref>. In our motif analysis pipeline we use the TAMO package <xref ref-type="bibr" rid="pcbi.1000010-Gordon1">[19]</xref>, for motif discovery and filtering, with a different genomic scan approach using statistical tools <xref ref-type="bibr" rid="pcbi.1000010-Barash2">[53]</xref>. The main difference is that for the motif comparison and clustering we use our new BLiC score and a hierarchical agglomerative clustering (as discussed above).</p></sec><sec id="s3d"><title>From DNA Motifs to Regulatory Mechanisms</title><p>Sequence information is a highly accessible resource, and thus it is interesting to ask whether it can help elucidate mechanisms of transcription regulation. We examined transcription factors that alter their targets in response to an environmental change, and found a differential motif in 88% of these cases (24/27 factors). These differential motifs can suggest the potential mechanism through which the factor changes its targets. We show that motifs provide an indication for potential mechanisms when the factor changes its binding partner (<xref ref-type="supplementary-material" rid="pcbi.1000010.s006">Figure S6A</xref>) or its specificity to the DNA (<xref ref-type="supplementary-material" rid="pcbi.1000010.s006">Figure S6B</xref>), as we discussed thoroughly for the case of Ste12 and Aft2. Nevertheless, motif analysis obviously does not reveal the whole regulatory picture. For example, chromatin-modeling mediated regulation cannot be inferred from motif analysis (<xref ref-type="supplementary-material" rid="pcbi.1000010.s006">Figure S6C</xref>). Thus, for a complete understanding of the regulatory mechanisms additional information is needed.</p><p>A significant limitation of motif analysis in general, is the discrepancy between putative binding sites and actual functional binding events. This raises the question addressed frequently before <xref ref-type="bibr" rid="pcbi.1000010-Barash1">[10]</xref>,<xref ref-type="bibr" rid="pcbi.1000010-Bulyk1">[54]</xref>, whether our representation of transcription factor binding preferences is sufficiently accurate.</p><p>In this study we overcome a basic obstacle in DNA motif analysis, by developing an accurate motif comparison method. Our motif analysis pipeline, which includes clustering and retrieval procedures based on our novel score, is fully automated and produces accurate results. This is highly important in large-scale analysis, such as the one reported here. We showed the power of motif analyses, which is useful not only for building regulatory maps, but also for understanding more profoundly regulatory mechanisms.</p></sec></sec><sec id="s4"><title>Methods</title><sec id="s4a"><title>Motif Representation</title><p>We use a Position Frequency Matrix (PFM) representation for a DNA motif. This is a n×4 matrix, where each i,j cell contains the count of nucleotide j in position i of the motif.</p></sec><sec id="s4b"><title>Scores</title><p>We define the similarity score for two aligned PFMs. Due to the positional independence assumption in PFMs, the score decomposes into the sum of scores for corresponding positions. Our score is composed of two components: The first measures whether the two motifs were generated from a common distribution. The second reflects the distance of that common distribution from the background. Thus, for positions n<sup>1</sup> and n<sup>2</sup>, our score is as described in Equation 2. Statistically, in the score we sum the log-likelihood-ratio of two pairs of hypotheses.</p><p>The first component:</p><p><bold>H<sub>0</sub></bold>: The two samples were drawn from a common source distribution.</p><p><bold>H<sub>1</sub></bold>: The two samples were drawn independently from different source distributions.</p><p>The second component:</p><p><bold>H<sub>0</sub></bold>: The two samples were drawn from a common source distribution that is distinct from the background.</p><p><bold>H<sub>1</sub></bold>: The two samples were drawn from the background distribution.</p></sec><sec id="s4c"><title>Estimation</title><p>We estimate the source distributions from the PFM using a Bayesian approach, with a <italic>Dirichlet</italic> prior. The <italic>Dirichlet</italic> prior is specified by a set of <italic>hyper-parameters</italic> α = (α<sub>1</sub>,α<sub>2</sub>,…α<italic><sub>n</sub></italic>) and has the form: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000010.e004" xlink:type="simple"/></inline-formula></p><p>Where Γ(<italic>x</italic>) is the <italic>Gamma function.</italic> We use two prior variants: The first is a standard <italic>Dirichlet</italic> prior <xref ref-type="bibr" rid="pcbi.1000010-DeGroot1">[20]</xref>, with hyper-parameters of (1,1,1,1). When using this prior, the estimated distribution for position n is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.e005" xlink:type="simple"/></disp-formula>where α is the vector of hyper-parameters.</p><p>The second prior we use is a five-component <italic>mixture of Dirichlet</italic> prior <xref ref-type="bibr" rid="pcbi.1000010-Sjolander1">[17]</xref>. We merge five Dirichlet priors using uniform weights. Four of the components give high probability for a single DNA nucleotide: A, C, G, or T. The fifth element represents the uniform distribution. We use the hyper-parameters (5,1,1,1) for A, (1,5,1,1) for C, etc., For the fifth component we use the hyper-parameters (2,2,2,2). Using this, the estimated distribution for position n is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.e006" xlink:type="simple"/></disp-formula>This is a weighted average, where the weights are the posterior probabilities of each component given the data. The posterior is: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000010.e007" xlink:type="simple"/></inline-formula>where, <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.e008" xlink:type="simple"/></disp-formula></p></sec><sec id="s4d"><title>Clustering and Comparing Motifs</title><sec id="s4d1"><title>Comparing motifs</title><p>The similarity score of two PFMs is the score of the best possible alignment (without gaps) between them, including the reverse complement alignment. The unaligned flanks of the motif are scored according to their distance from the background distribution multiplied by a relaxing factor of 0.2.</p></sec><sec id="s4d2"><title>Assigning <italic>p</italic>-values to motif similarity scores</title><p>We devised an empirical <italic>p</italic>-value estimation procedure for motif similarity scores. For each motif, we computed the score distribution against motifs of all possible lengths, by comparison to 1000 random motifs of a specified length. Since the BLiC score distribution depends on the specificity of each motif, the distribution is computed for each motif separately to retain the overall characteristics of the motif. The random motifs were generated by sampling positions of motifs from the TRANSFAC database <xref ref-type="bibr" rid="pcbi.1000010-Matys1">[26]</xref>. The <italic>p</italic>-value of the similarity of a given DNA motif to another, is calculated empirically from the score distribution of the first motif against random motifs of the same length as the second motif (calculating the fraction of random motifs that got the same score or higher).</p></sec></sec><sec id="s4e"><title>Clustering and Trimming the Tree</title><p>To cluster motifs, we implemented a hierarchical agglomerative clustering algorithm, using various motif comparison scores. In each iteration, the algorithm computes the similarity between all pairs of motifs and then merges the pair with the highest similarity score into a new motif (see <xref ref-type="fig" rid="pcbi-1000010-g004">Figure 4A</xref>). This merge includes aligning the motifs according to the best scoring alignment between them, and then combining the evidence from both of them, by summing their nucleotide counts at each position (i.e., the motifs are weighted according to their number of samples). These iterations are repeated until we are left with a single motif. The order of merge operations results in a tree, where the leaves represent initial motifs, and each inner node represents the merging of all original motif sub-tree below it.</p><p>The clustering tree is used to distill the input set into a non-redundant group, by splitting the tree into clusters representing groups of redundant motifs. To obtain this non-redundant set, which covers the initial set, we choose a frontier in the clustering tree. A frontier in a tree is a subset of nodes, non-descendent to each other, where every leaf in the tree is a descendant of one of them. This is done by a bottom-up traversal over the tree in which we choose the set of nodes in the required frontier. Specifically, we consider every two motifs that were merged into one in the tree. We want to identify situations where this merge resulted in a motif that is very different than each of the two motifs that were merged. To test that, we compare the degree of similarity between the two motifs to the maximal score we could have attained (the maximum of the similarity of each one to itself). If the observed score's ratio to this maximum is less than a preset threshold, the two motifs are added to the frontier. In the motif analysis pipeline, we use a stringent threshold of 60% of the maximum for creating non-redundant motifs (chosen according to hand-curated splits of 10 trees).</p></sec><sec id="s4f"><title>Motif Analysis</title><sec id="s4f1"><title>Motif discovery algorithms</title><p>In the analysis pipeline we applied several motif discovery algorithms—MDScan <xref ref-type="bibr" rid="pcbi.1000010-Liu1">[2]</xref>, AligneAce <xref ref-type="bibr" rid="pcbi.1000010-Hughes1">[11]</xref>, and MEME <xref ref-type="bibr" rid="pcbi.1000010-Bailey1">[3]</xref> were used through the TAMO package <xref ref-type="bibr" rid="pcbi.1000010-Gordon1">[19]</xref>, with the default parameters (apart from the MEME algorithm, for which we changed the parameters to output six motifs). We included conserved and abundant motifs in the yeast genome <xref ref-type="bibr" rid="pcbi.1000010-Kellis1">[55]</xref>, and the output of MEME_c <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref>, Converge <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref> and the SeedSearcher motif discovery algorithm <xref ref-type="bibr" rid="pcbi.1000010-Barash3">[56]</xref>. The discovered motifs underwent an initial filtration according to their enrichment among the initial group of sequences (<italic>p</italic>-value threshold of 10<sup>−5</sup>, calculated using the TAMO package <xref ref-type="bibr" rid="pcbi.1000010-Gordon1">[19]</xref>). All motifs are converted to a PFM representation.</p></sec><sec id="s4f2"><title>Clustering motifs</title><p>In the second step of the pipeline we cluster the motifs—first we clustered the motifs discovered for each transcription factor under each environmental condition separately, then the (merged) motifs for each factor under all conditions, and finally the entire set of motifs. The motifs are clustered and merged as described above.</p></sec><sec id="s4f3"><title>Truncating motifs</title><p>Uninformative positions at the two edges of motifs were truncated automatically. This was done by a chi-square test (threshold of 0.05), testing if the nucleotides at a motif position distribute according to the background.</p></sec><sec id="s4f4"><title>Identifying the motifs</title><p>Connecting between discovered motifs and transcription factors, we compared the motifs against a set of known motifs (TRANSFAC <xref ref-type="bibr" rid="pcbi.1000010-Matys1">[26]</xref>, SCPD <xref ref-type="bibr" rid="pcbi.1000010-Zhu1">[27]</xref>, YPD <xref ref-type="bibr" rid="pcbi.1000010-Csank1">[28]</xref>).</p></sec><sec id="s4f5"><title>Ranking motifs</title><p>In the third step of the pipeline, we rank and filter the merged motifs according to their enrichment (−log hyper-geometric <italic>p</italic>-value) in the input groups of DNA sequences. For filtering we use a threshold of 3 after applying a Bonferroni correction for multiple hypotheses. For this, we find the occurrences of each motif using a statistical tool for genomic scan, TestMotif program <xref ref-type="bibr" rid="pcbi.1000010-Barash2">[53]</xref>. To scan the genome with our motifs, we transferred them from PFMs (count matrices) to profiles (frequencies), using estimation with <italic>Dirichlet-mixture</italic> prior described above. After scanning with the TestMotif program <xref ref-type="bibr" rid="pcbi.1000010-Barash2">[53]</xref>, we combine evolutionary conservation data to find the occurrences of motifs. Particularly, we decide whether a DNA sequence contains a motif if one of two following criteria holds:</p><list list-type="bullet"><list-item><p>The sequence contains a highly statistically significant binding site, using a <italic>p</italic>-value threshold of 0.03 after Bonferroni correction for multiple hypotheses according to the average length of the scanned sequences (a good sequence match between the motif and the binding site).</p></list-item><list-item><p>A less statistically significant occurrence of the motif (threshold of 0.1), highly conserved among seven species of the genus <italic>Saccharomyces</italic> (average conservation of the motif is at least 0.6, according to the UCSC conservation track (phastCons <xref ref-type="bibr" rid="pcbi.1000010-Siepel1">[57]</xref>, through the UCSC Genome Browser Database <xref ref-type="bibr" rid="pcbi.1000010-Karolchik1">[58]</xref>).</p></list-item></list></sec><sec id="s4f6"><title>Parameter tuning</title><p>The threshold values listed above were chosen according to an extensive search of parameters that maximize the true positive rate, allowing up to 2% false positive calls. This optimization was based on location analysis data of Gcn4 <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref>, and location and expression data for Sko1 (unpublished data).</p></sec></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi.1000010.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.s001" xlink:type="simple"><label>Figure S1</label><caption><p>Distinguishing between informative and non-informative positions: Two pairs of aligned motifs are presented (by a sequence-logo). This is an alignment of the known motif for the invertebrate factor Dfd versus two variants of the vertebrate factor Pax4, all taken from TRANSFAC <xref ref-type="bibr" rid="pcbi.1000010-Matys1">[26]</xref> (matrix accessions I$DFD_01, V$PAX4_02, and V$PAX4_04, all from version 8.3). While it is clear the first motif (left) should get a lower similarity score than the second motif (right), scoring the two pairs of aligned motifs using the Jensen-Shannon divergence yields a higher score for the first motif. The desired similarity score should distinguish between high similarity of informative positions and non-informative positions.</p><p>(0.73 MB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi.1000010.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.s002" xlink:type="simple"><label>Figure S2</label><caption><p>Evaluation of motif comparison. Using different subsets of motifs out of the “Yeast” data set, we compare our BLiC score (green, using a Dirichlet prior, and blue, using a Dirichlet-mixture prior) with other similarity scores: Jensen-Shannon divergence (red), Euclidean distance (purple) and Pearson Correlation coefficient (cyan). Each of the nine panels represents a different comparison. The columns correspond to the number of samples used for constructing the motifs. The rows correspond to different choices of query sets and target sets for comparison (illustrated by the logos on the right): In the top row all motifs of partial offsets are queries against the same set. In the middle row, all motifs, including full-length motifs and partial offsets are compared against themselves. In the bottom row, we use partial offset motifs as queries and full motifs as targets. In each panel we plot True Positive Rate (y-axis) vs. False Positive Rate (x-axis) as in <xref ref-type="fig" rid="pcbi-1000010-g003">Figure 3B</xref>.</p><p>(1.67 MB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi.1000010.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.s003" xlink:type="simple"><label>Figure S3</label><caption><p>Evaluation of motif clustering. Using different subsets of motifs out of the “Yeast” data set, we compare our BLiC score (green, using a Dirichlet prior, and blue, using a Dirichlet-mixture prior) with other similarity scores: Jensen-Shannon divergence (red), Euclidean distance (purple) and Pearson Correlation coefficient (cyan). Each of the nine panels represents the average performance of 9 repeats of clustering over different motif sets. The columns correspond to the number of samples used for constructing the motifs. The rows correspond to different choices of motif sets (illustrated by the logos on the right): In the top row we cluster all motifs of partial offsets. In the middle row, we cluster all motifs, including full-length motifs and partial offsets. In the bottom row, we cluster only full motifs. In each panel we plot True Positive Rate (y-axis) vs. number of clusters (x-axis) as in <xref ref-type="fig" rid="pcbi-1000010-g004">Figure 4B</xref>.</p><p>(1.88 MB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi.1000010.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.s004" xlink:type="simple"><label>Figure S4</label><caption><p>Overview of the discovered motifs. Investigation of the properties of discovered motifs. Each motif (column) is compared to other motifs using the BLiC score (rows, top group), to average expression of its targets in different experiments <xref ref-type="bibr" rid="pcbi.1000010-DeRisi1">[30]</xref>–<xref ref-type="bibr" rid="pcbi.1000010-Spellman1">[32]</xref> (second group), to enrichment of its targets in GO annotations <xref ref-type="bibr" rid="pcbi.1000010-Harris1">[29]</xref> (third groups) and in ChIP-chip location assays <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref> (bottom groups). The rows and columns were clustered using the EdgeCluster <xref ref-type="bibr" rid="pcbi.1000010-Friedman1">[33]</xref> algorithm, which integrates various sources of information into the clustering process. These information sources are attributes of motifs and pairwise information about motifs. The results are clusters of motifs that have not only similar attributes, as in regular clustering algorithm, but also similar relations to motifs in other clusters.</p><p>(8.43 MB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi.1000010.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.s005" xlink:type="simple"><label>Figure S5</label><caption><p>Condition independent binding of Fhl1. (A) A Venn diagram representing the results of the ChIP-chip experiment <xref ref-type="bibr" rid="pcbi.1000010-Harbison1">[13]</xref> for the transcription factor Fhl1 under YPD conditions, amino-acid starvation and nutrient deprived conditions. The targets of Fhl1 do not change under these three environments. (B) Under all conditions the same motif is found to be highly enriched.</p><p>(2.70 MB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi.1000010.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.s006" xlink:type="simple"><label>Figure S6</label><caption><p>Possible mechanisms for condition-dependent binding of TFs. Motif analysis for condition-dependent transcription factors that bind different targets under different conditions. Here, three possible mechanisms that may be involved in monitoring condition-dependent binding, which lead to altered targets, are presented schematically. For each mechanism we show the scheme of the promoter organization of the target genes (above the dashed line) and the result of motif discovery (under the dashed line). (A) The first mechanism is through a change in the cofactor. This may be detected through co-occurrence of motifs of different factors. (B) The second mechanism is through a change in the specificity to the DNA. This change can be traced by identifying variations in the DNA motif. (C) The third mechanism is a change in the chromatin state. This change cannot be traced using motif analysis.</p><p>(0.98 MB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi.1000010.s007" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.s007" xlink:type="simple"><label>Table S1</label><caption><p>Comparison of the Yeast motif library to previous works</p><p>(0.02 MB XLS)</p></caption></supplementary-material><supplementary-material id="pcbi.1000010.s008" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.s008" xlink:type="simple"><label>Table S2</label><caption><p>Transcription factors with condition-dependent binding which alter their targets.</p><p>(0.02 MB XLS)</p></caption></supplementary-material><supplementary-material id="pcbi.1000010.s009" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000010.s009" xlink:type="simple"><label>Table S3</label><caption><p>List of differential motifs.</p><p>(0.04 MB XLS)</p></caption></supplementary-material></sec></body><back><ack><p>We thank Aviv Regev, Andrew Capaldi, and the members of Nir Friedman's and Hanah Margalit's labs for useful discussions related to this work. We thank Yoseph Barash for his help with the SeedSearcher motif discovery algorithm, Kenzie MacIsaac for help with the TAMO package, and Takis Benos for providing us with the data set of Mahoney et al. <xref ref-type="bibr" rid="pcbi.1000010-Mahony1">[24]</xref>.</p></ack><ref-list><title>References</title><ref id="pcbi.1000010-Stormo1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name></person-group>             <year>2000</year>             <article-title>DNA binding sites: representation and discovery.</article-title>             <source>Bioinformatics</source>             <volume>16</volume>             <fpage>16</fpage>             <lpage>23</lpage>          </element-citation></ref><ref id="pcbi.1000010-Liu1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>X</given-names></name><name name-style="western"><surname>Brutlag</surname><given-names>D</given-names></name><name name-style="western"><surname>Liu</surname><given-names>J</given-names></name></person-group>             <year>2002</year>             <article-title>An algorithm for finding protein-DNA binding sites with applications to chromatin-immunoprecipitation microarray experiments.</article-title>             <source>Nat Biotechnol</source>             <volume>20</volume>             <fpage>835</fpage>             <lpage>839</lpage>          </element-citation></ref><ref id="pcbi.1000010-Bailey1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bailey</surname><given-names>T</given-names></name><name name-style="western"><surname>Elkan</surname><given-names>C</given-names></name></person-group>             <year>1995</year>             <article-title>The value of prior knowledge in discovering motifs with MEME.</article-title>             <source>Proc Int Conf Intell Syst Mol Biol</source>             <volume>3</volume>             <fpage>21</fpage>             <lpage>29</lpage>          </element-citation></ref><ref id="pcbi.1000010-Kaplan1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kaplan</surname><given-names>T</given-names></name><name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name><name name-style="western"><surname>Margalit</surname><given-names>H</given-names></name></person-group>             <year>2005</year>             <article-title>Ab initio prediction of transcription factor targets using structural knowledge.</article-title>             <source>PLoS Comput Biol</source>             <volume>1</volume>             <fpage>e1</fpage>          </element-citation></ref><ref id="pcbi.1000010-Morozov1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Morozov</surname><given-names>A</given-names></name><name name-style="western"><surname>Havranek</surname><given-names>J</given-names></name><name name-style="western"><surname>Baker</surname><given-names>D</given-names></name><name name-style="western"><surname>Siggia</surname><given-names>E</given-names></name></person-group>             <year>2005</year>             <article-title>Protein-DNA binding specificity predictions with structural models.</article-title>             <source>Nucleic Acids Res</source>             <volume>33</volume>             <fpage>5781</fpage>             <lpage>5798</lpage>          </element-citation></ref><ref id="pcbi.1000010-MacIsaac1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>MacIsaac</surname><given-names>K</given-names></name><name name-style="western"><surname>Fraenkel</surname><given-names>E</given-names></name></person-group>             <year>2006</year>             <article-title>Practical strategies for discovering regulatory DNA sequence motifs.</article-title>             <source>PLoS Comput Biol</source>             <volume>2</volume>             <fpage>e36</fpage>          </element-citation></ref><ref id="pcbi.1000010-Osada1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Osada</surname><given-names>R</given-names></name><name name-style="western"><surname>Zaslavsky</surname><given-names>E</given-names></name><name name-style="western"><surname>Singh</surname><given-names>M</given-names></name></person-group>             <year>2004</year>             <article-title>Comparative analysis of methods for representing and searching for transcription factor binding sites.</article-title>             <source>Bioinformatics</source>             <volume>20</volume>             <fpage>3516</fpage>             <lpage>3525</lpage>          </element-citation></ref><ref id="pcbi.1000010-Day1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Day</surname><given-names>W</given-names></name><name name-style="western"><surname>McMorris</surname><given-names>F</given-names></name></person-group>             <year>1992</year>             <article-title>Critical comparison of consensus methods for molecular sequences.</article-title>             <source>Nucleic Acids Res</source>             <volume>20</volume>             <fpage>1093</fpage>             <lpage>1099</lpage>          </element-citation></ref><ref id="pcbi.1000010-Benos1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Benos</surname><given-names>P</given-names></name><name name-style="western"><surname>Bulyk</surname><given-names>M</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name></person-group>             <year>2002</year>             <article-title>Additivity in protein-DNA interactions: how good an approximation is it?</article-title>             <source>Nucleic Acids Res</source>             <volume>30</volume>             <fpage>4442</fpage>             <lpage>4451 L4443</lpage>          </element-citation></ref><ref id="pcbi.1000010-Barash1"><label>10</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Barash</surname><given-names>Y</given-names></name><name name-style="western"><surname>Elidan</surname><given-names>G</given-names></name><name name-style="western"><surname>Kaplan</surname><given-names>T</given-names></name><name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name></person-group>             <year>2003</year>             <article-title>Modeling Dependencies in Protein-DNA Binding Sites.</article-title>             <comment>Proc of the 7th Ann Int Conf in Comp Mol Bio (RECOMB)</comment>          </element-citation></ref><ref id="pcbi.1000010-Hughes1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hughes</surname><given-names>J</given-names></name><name name-style="western"><surname>Estep</surname><given-names>P</given-names></name><name name-style="western"><surname>Tavazoie</surname><given-names>S</given-names></name><name name-style="western"><surname>Church</surname><given-names>G</given-names></name></person-group>             <year>2000</year>             <article-title>Computational identification of cis-regulatory elements associated with groups of functionally related genes in Saccharomyces cerevisiae.</article-title>             <source>J Mol Biol</source>             <volume>296</volume>             <fpage>1205</fpage>             <lpage>1214</lpage>          </element-citation></ref><ref id="pcbi.1000010-Xie1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Xie</surname><given-names>X</given-names></name><name name-style="western"><surname>Lu</surname><given-names>J</given-names></name><name name-style="western"><surname>Kulbokas</surname><given-names>E</given-names></name><name name-style="western"><surname>Golub</surname><given-names>T</given-names></name><name name-style="western"><surname>VM</surname></name><name name-style="western"><surname>Lindblad-Toh</surname><given-names>K</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>Systematic discovery of regulatory motifs in human promoters and 3′ UTRs by comparison of several mammals.</article-title>             <source>Nature</source>             <volume>434</volume>             <fpage>338</fpage>             <lpage>345</lpage>          </element-citation></ref><ref id="pcbi.1000010-Harbison1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Harbison</surname><given-names>C</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>D</given-names></name><name name-style="western"><surname>Lee</surname><given-names>T</given-names></name><name name-style="western"><surname>Rinaldi</surname><given-names>N</given-names></name><name name-style="western"><surname>Macisaac</surname><given-names>K</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>Transcriptional regulatory code of a eukaryotic genome.</article-title>             <source>Nature</source>             <volume>431</volume>             <fpage>99</fpage>             <lpage>104</lpage>          </element-citation></ref><ref id="pcbi.1000010-Lin1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>J</given-names></name></person-group>             <year>1991</year>             <article-title>Divergence measures based on the Shannon entropy</article-title>             <fpage>145</fpage>             <lpage>151</lpage>          </element-citation></ref><ref id="pcbi.1000010-Yona1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yona</surname><given-names>G</given-names></name><name name-style="western"><surname>Levitt</surname><given-names>M</given-names></name></person-group>             <year>2002</year>             <article-title>Within the twilight zone: a sensitive profile-profile comparison tool based on information theory.</article-title>             <source>J Mol Biol</source>             <volume>315</volume>             <fpage>1257</fpage>             <lpage>1275</lpage>          </element-citation></ref><ref id="pcbi.1000010-Wang1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>T</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>             <year>2003</year>             <article-title>Combining phylogenetic data with co-regulated genes to identify regulatory motifs.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <fpage>2369</fpage>             <lpage>2380</lpage>          </element-citation></ref><ref id="pcbi.1000010-Sjolander1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sjolander</surname><given-names>K</given-names></name><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Brown</surname><given-names>M</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name><name name-style="western"><surname>AK</surname></name><name name-style="western"><surname>Mian</surname><given-names>I</given-names></name><etal/></person-group>             <year>1996</year>             <article-title>Dirichlet mixtures: a method for improved detection of weak but significant protein sequence homology.</article-title>             <source>Comput Appl Biosci</source>             <volume>12</volume>             <fpage>327</fpage>             <lpage>345</lpage>          </element-citation></ref><ref id="pcbi.1000010-Xing1"><label>18</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Xing</surname><given-names>EP</given-names></name><name name-style="western"><surname>Jordan</surname><given-names>MI</given-names></name><name name-style="western"><surname>Karp</surname><given-names>RM</given-names></name><name name-style="western"><surname>Russell</surname><given-names>R</given-names></name></person-group>             <year>2002</year>             <article-title>A Hierarchical Bayesian Markovian Model for Motifs in Biopolymer Sequences. NIPS 15.</article-title>             <comment>MIT Press</comment>          </element-citation></ref><ref id="pcbi.1000010-Gordon1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gordon</surname><given-names>D</given-names></name><name name-style="western"><surname>Nekludova</surname><given-names>L</given-names></name><name name-style="western"><surname>McCallum</surname><given-names>S</given-names></name><name name-style="western"><surname>Fraenkel</surname><given-names>E</given-names></name></person-group>             <year>2005</year>             <article-title>TAMO: a flexible, object-oriented framework for analyzing transcriptional regulation using DNA-sequence motifs.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>3164</fpage>             <lpage>3165</lpage>          </element-citation></ref><ref id="pcbi.1000010-DeGroot1"><label>20</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>DeGroot</surname><given-names>M</given-names></name></person-group>             <year>1970</year>             <source>Optimal Satistical Decisions</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>McGraw-Hill</publisher-name>          </element-citation></ref><ref id="pcbi.1000010-Gupta1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gupta</surname><given-names>S</given-names></name><name name-style="western"><surname>Stamatoyannopoulos</surname><given-names>JA</given-names></name><name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name><name name-style="western"><surname>Noble</surname><given-names>WS</given-names></name></person-group>             <year>2007</year>             <article-title>Quantifying similarity between motifs.</article-title>             <source>Genome Biol</source>             <volume>8</volume>             <fpage>R24</fpage>          </element-citation></ref><ref id="pcbi.1000010-Bailey2"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name><name name-style="western"><surname>Gribskov</surname><given-names>M</given-names></name></person-group>             <year>1998</year>             <article-title>Methods and statistics for combining motif match scores.</article-title>             <source>J Comput Biol</source>             <volume>5</volume>             <fpage>211</fpage>             <lpage>221</lpage>          </element-citation></ref><ref id="pcbi.1000010-Jain1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jain</surname><given-names>AK</given-names></name><name name-style="western"><surname>Murty</surname><given-names>MN</given-names></name><name name-style="western"><surname>Flynn</surname><given-names>PJ</given-names></name></person-group>             <year>1999</year>             <article-title>Data clustering: a review.</article-title>             <source>J ACM Comput Surv</source>             <volume>31</volume>             <fpage>264</fpage>             <lpage>323</lpage>          </element-citation></ref><ref id="pcbi.1000010-Mahony1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mahony</surname><given-names>S</given-names></name><name name-style="western"><surname>Auron</surname><given-names>PE</given-names></name><name name-style="western"><surname>Benos</surname><given-names>PV</given-names></name></person-group>             <year>2007</year>             <article-title>DNA familial binding profiles made easy: comparison of various motif alignment and clustering strategies.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e61</fpage>          </element-citation></ref><ref id="pcbi.1000010-Sandelin1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sandelin</surname><given-names>A</given-names></name><name name-style="western"><surname>Alkema</surname><given-names>W</given-names></name><name name-style="western"><surname>Engstrom</surname><given-names>P</given-names></name><name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name><name name-style="western"><surname>Lenhard</surname><given-names>B</given-names></name></person-group>             <year>2004</year>             <article-title>JASPAR: an open-access database for eukaryotic transcription factor binding profiles.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>D91</fpage>             <lpage>D94</lpage>          </element-citation></ref><ref id="pcbi.1000010-Matys1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Matys</surname><given-names>V</given-names></name><name name-style="western"><surname>Fricke</surname><given-names>E</given-names></name><name name-style="western"><surname>Geffers</surname><given-names>R</given-names></name><name name-style="western"><surname>Gossling</surname><given-names>E</given-names></name><name name-style="western"><surname>Haubrock</surname><given-names>M</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>TRANSFAC: transcriptional regulation, from patterns to profiles.</article-title>             <source>Nucleic Acids Res</source>             <volume>31</volume>             <fpage>374</fpage>             <lpage>378</lpage>          </element-citation></ref><ref id="pcbi.1000010-Zhu1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>J</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>M</given-names></name></person-group>             <year>1999</year>             <article-title>SCPD: a promoter database of the yeast Saccharomyces cerevisiae.</article-title>             <source>Bioinformatics</source>             <volume>15</volume>             <fpage>607</fpage>             <lpage>611</lpage>          </element-citation></ref><ref id="pcbi.1000010-Csank1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Csank</surname><given-names>C</given-names></name><name name-style="western"><surname>Costanzo</surname><given-names>M</given-names></name><name name-style="western"><surname>Hirschman</surname><given-names>J</given-names></name><name name-style="western"><surname>Hodges</surname><given-names>P</given-names></name><name name-style="western"><surname>Kranz</surname><given-names>J</given-names></name><etal/></person-group>             <year>2002</year>             <article-title>Three yeast proteome databases: YPD, PombePD, and CalPD (MycoPathPD).</article-title>             <source>Methods Enzymol</source>             <volume>350</volume>             <fpage>347</fpage>             <lpage>373</lpage>          </element-citation></ref><ref id="pcbi.1000010-Harris1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Harris</surname><given-names>M</given-names></name><name name-style="western"><surname>Clark</surname><given-names>J</given-names></name><name name-style="western"><surname>Ireland</surname><given-names>A</given-names></name><name name-style="western"><surname>Lomax</surname><given-names>J</given-names></name><name name-style="western"><surname>Ashburner</surname><given-names>M</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>The Gene Ontology (GO) database and informatics resource.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>D258</fpage>             <lpage>D261</lpage>          </element-citation></ref><ref id="pcbi.1000010-DeRisi1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>DeRisi</surname><given-names>JL</given-names></name><name name-style="western"><surname>Iyer</surname><given-names>VR</given-names></name><name name-style="western"><surname>Brown</surname><given-names>PO</given-names></name></person-group>             <year>1997</year>             <article-title>Exploring the metabolic and genetic control of gene expression on a genomic scale.</article-title>             <source>Science</source>             <volume>278</volume>             <fpage>680</fpage>             <lpage>686</lpage>          </element-citation></ref><ref id="pcbi.1000010-Gasch1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gasch</surname><given-names>AP</given-names></name><name name-style="western"><surname>Spellman</surname><given-names>PT</given-names></name><name name-style="western"><surname>Kao</surname><given-names>CM</given-names></name><name name-style="western"><surname>Carmel-Harel</surname><given-names>O</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>MB</given-names></name><etal/></person-group>             <year>2000</year>             <article-title>Genomic expression programs in the response of yeast cells to environmental changes.</article-title>             <source>Mol Biol Cell</source>             <volume>11</volume>             <fpage>4241</fpage>             <lpage>4257</lpage>          </element-citation></ref><ref id="pcbi.1000010-Spellman1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Spellman</surname><given-names>PT</given-names></name><name name-style="western"><surname>Sherlock</surname><given-names>G</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>MQ</given-names></name><name name-style="western"><surname>Iyer</surname><given-names>VR</given-names></name><name name-style="western"><surname>Anders</surname><given-names>K</given-names></name><etal/></person-group>             <year>1998</year>             <article-title>Comprehensive identification of cell cycle-regulated genes of the yeast Saccharomyces cerevisiae by microarray hybridization.</article-title>             <source>Mol Biol Cell</source>             <volume>9</volume>             <fpage>3273</fpage>             <lpage>3297</lpage>          </element-citation></ref><ref id="pcbi.1000010-Friedman1"><label>33</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name><name name-style="western"><surname>Jaimovich</surname><given-names>A</given-names></name></person-group>             <year>2008</year>             <article-title>EdgeCluster: Probabilistic Agglomerative Clustering of Genes with Relational Observations.</article-title>             <comment>School of Computer Science and Engineering, The Hebrew University TR-2008-2</comment>          </element-citation></ref><ref id="pcbi.1000010-MacIsaac2"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>MacIsaac</surname><given-names>K</given-names></name><name name-style="western"><surname>Wang</surname><given-names>T</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>D</given-names></name><name name-style="western"><surname>Gifford</surname><given-names>D</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>An improved map of conserved regulatory sites for Saccharomyces cerevisiae.</article-title>             <source>BMC Bioinformatics</source>             <volume>7</volume>             <fpage>113</fpage>          </element-citation></ref><ref id="pcbi.1000010-Martin1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Martin</surname><given-names>D</given-names></name><name name-style="western"><surname>Soulard</surname><given-names>A</given-names></name><name name-style="western"><surname>Hall</surname><given-names>M</given-names></name></person-group>             <year>2004</year>             <article-title>TOR regulates ribosomal protein gene expression via PKA and the Forkhead transcription factor FHL1.</article-title>             <source>Cell</source>             <volume>119</volume>             <fpage>969</fpage>             <lpage>979</lpage>          </element-citation></ref><ref id="pcbi.1000010-Zeitlinger1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zeitlinger</surname><given-names>J</given-names></name><name name-style="western"><surname>Simon</surname><given-names>I</given-names></name><name name-style="western"><surname>Harbison</surname><given-names>C</given-names></name><name name-style="western"><surname>Hannett</surname><given-names>N</given-names></name><name name-style="western"><surname>Volkert</surname><given-names>T</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>Program-specific distribution of a transcription factor dependent on partner transcription factor and MAPK signaling.</article-title>             <source>Cell</source>             <volume>113</volume>             <fpage>395</fpage>             <lpage>404</lpage>          </element-citation></ref><ref id="pcbi.1000010-Chou1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chou</surname><given-names>S</given-names></name><name name-style="western"><surname>Lane</surname><given-names>S</given-names></name><name name-style="western"><surname>Liu</surname><given-names>H</given-names></name></person-group>             <year>2006</year>             <article-title>Regulation of mating and filamentation genes by two distinct Ste12 complexes in Saccharomyces cerevisiae.</article-title>             <source>Mol Cell Biol</source>             <volume>26</volume>             <fpage>4794</fpage>             <lpage>4805</lpage>          </element-citation></ref><ref id="pcbi.1000010-Madhani1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Madhani</surname><given-names>H</given-names></name><name name-style="western"><surname>Fink</surname><given-names>G</given-names></name></person-group>             <year>1997</year>             <article-title>Combinatorial control required for the specificity of yeast MAPK signaling.</article-title>             <source>Science</source>             <volume>275</volume>             <fpage>1314</fpage>             <lpage>1317</lpage>          </element-citation></ref><ref id="pcbi.1000010-Chou2"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chou</surname><given-names>S</given-names></name><name name-style="western"><surname>Huang</surname><given-names>L</given-names></name><name name-style="western"><surname>Liu</surname><given-names>H</given-names></name></person-group>             <year>2004</year>             <article-title>Fus3-regulated Tec1 degradation through SCFCdc4 determines MAPK signaling specificity during mating in yeast.</article-title>             <source>Cell</source>             <volume>119</volume>             <fpage>981</fpage>             <lpage>990</lpage>          </element-citation></ref><ref id="pcbi.1000010-Schaber1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schaber</surname><given-names>J</given-names></name><name name-style="western"><surname>Kofahl</surname><given-names>B</given-names></name><name name-style="western"><surname>Kowald</surname><given-names>A</given-names></name><name name-style="western"><surname>Klipp</surname><given-names>E</given-names></name></person-group>             <year>2006</year>             <article-title>A modelling approach to quantify dynamic crosstalk between the pheromone and the starvation pathway in baker's yeast.</article-title>             <source>FEBS J</source>             <volume>273</volume>             <fpage>3520</fpage>             <lpage>3533</lpage>          </element-citation></ref><ref id="pcbi.1000010-Wang2"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name><name name-style="western"><surname>Dohlman</surname><given-names>H</given-names></name></person-group>             <year>2006</year>             <article-title>Pheromone-regulated sumoylation of transcription factors that mediate the invasive to mating developmental switch in yeast.</article-title>             <source>J Biol Chem</source>             <volume>281</volume>             <fpage>1964</fpage>             <lpage>1969</lpage>          </element-citation></ref><ref id="pcbi.1000010-Gelli1"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gelli</surname><given-names>A</given-names></name></person-group>             <year>2002</year>             <article-title>Rst1 and Rst2 are required for the a/alpha diploid cell type in yeast.</article-title>             <source>Mol Microbiol</source>             <volume>46</volume>             <fpage>845</fpage>             <lpage>854</lpage>          </element-citation></ref><ref id="pcbi.1000010-Courel1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Courel</surname><given-names>M</given-names></name><name name-style="western"><surname>Lallet</surname><given-names>S</given-names></name><name name-style="western"><surname>Camadro</surname><given-names>J</given-names></name><name name-style="western"><surname>Blaiseau</surname><given-names>P</given-names></name></person-group>             <year>2005</year>             <article-title>Direct activation of genes involved in intracellular iron use by the yeast iron-responsive transcription factor Aft2 without its paralog Aft1.</article-title>             <source>Mol Cell Biol</source>             <volume>25</volume>             <fpage>6760</fpage>             <lpage>6771</lpage>          </element-citation></ref><ref id="pcbi.1000010-Rutherford1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rutherford</surname><given-names>J</given-names></name><name name-style="western"><surname>Jaron</surname><given-names>S</given-names></name><name name-style="western"><surname>Ray</surname><given-names>E</given-names></name><name name-style="western"><surname>Brown</surname><given-names>P</given-names></name><name name-style="western"><surname>Winge</surname><given-names>D</given-names></name></person-group>             <year>2001</year>             <article-title>A second iron-regulatory system in yeast independent of Aft1p.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>98</volume>             <fpage>14322</fpage>             <lpage>14327</lpage>          </element-citation></ref><ref id="pcbi.1000010-Eisen1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Eisen</surname><given-names>MB</given-names></name><name name-style="western"><surname>Spellman</surname><given-names>PT</given-names></name><name name-style="western"><surname>Brown</surname><given-names>PO</given-names></name><name name-style="western"><surname>Botstein</surname><given-names>D</given-names></name></person-group>             <year>1998</year>             <article-title>Cluster analysis and display of genome-wide expression patterns.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>95</volume>             <fpage>14863</fpage>             <lpage>14868</lpage>          </element-citation></ref><ref id="pcbi.1000010-Pietrokovski1"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pietrokovski</surname><given-names>S</given-names></name></person-group>             <year>1996</year>             <article-title>Searching databases of conserved sequence regions by aligning protein multiple-alignments.</article-title>             <source>Nucleic Acids Res</source>             <volume>24</volume>             <fpage>3836</fpage>             <lpage>3845</lpage>          </element-citation></ref><ref id="pcbi.1000010-Roepcke1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Roepcke</surname><given-names>S</given-names></name><name name-style="western"><surname>Grossmann</surname><given-names>S</given-names></name><name name-style="western"><surname>Rahmann</surname><given-names>S</given-names></name><name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name></person-group>             <year>2005</year>             <article-title>T-Reg Comparator: an analysis tool for the comparison of position weight matrices.</article-title>             <source>Nucleic Acids Res</source>             <volume>33</volume>             <fpage>W438</fpage>             <lpage>W441</lpage>          </element-citation></ref><ref id="pcbi.1000010-Thijs1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Thijs</surname><given-names>G</given-names></name><name name-style="western"><surname>Marchal</surname><given-names>K</given-names></name><name name-style="western"><surname>Lescot</surname><given-names>M</given-names></name><name name-style="western"><surname>Rombauts</surname><given-names>S</given-names></name><name name-style="western"><surname>Moor</surname><given-names>B</given-names></name><etal/></person-group>             <year>2002</year>             <article-title>A Gibbs sampling method to detect overrepresented motifs in the upstream regions of coexpressed genes.</article-title>             <source>J Comput Biol</source>             <volume>9</volume>             <fpage>447</fpage>             <lpage>464</lpage>          </element-citation></ref><ref id="pcbi.1000010-Aerts1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Aerts</surname><given-names>S</given-names></name><name name-style="western"><surname>Thijs</surname><given-names>G</given-names></name><name name-style="western"><surname>Coessens</surname><given-names>B</given-names></name><name name-style="western"><surname>Staes</surname><given-names>M</given-names></name><name name-style="western"><surname>Moreau</surname><given-names>Y</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>Toucan: deciphering the cis-regulatory logic of coregulated genes.</article-title>             <source>Nucleic Acids Res</source>             <volume>31</volume>             <fpage>1753</fpage>             <lpage>1764</lpage>          </element-citation></ref><ref id="pcbi.1000010-Choi1"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Choi</surname><given-names>IG</given-names></name><name name-style="western"><surname>Kwon</surname><given-names>J</given-names></name><name name-style="western"><surname>Kim</surname><given-names>SH</given-names></name></person-group>             <year>2004</year>             <article-title>Local feature frequency profile: a method to measure structural similarity in proteins.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>101</volume>             <fpage>3797</fpage>             <lpage>3802</lpage>          </element-citation></ref><ref id="pcbi.1000010-Mahony2"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mahony</surname><given-names>S</given-names></name><name name-style="western"><surname>Benos</surname><given-names>PV</given-names></name></person-group>             <year>2007</year>             <article-title>STAMP: a web tool for exploring DNA-binding motif similarities.</article-title>             <source>Nucleic Acids Res</source>             <volume>35</volume>             <fpage>W253</fpage>             <lpage>W258</lpage>          </element-citation></ref><ref id="pcbi.1000010-Che1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Che</surname><given-names>D</given-names></name><name name-style="western"><surname>Jensen</surname><given-names>S</given-names></name><name name-style="western"><surname>Cai</surname><given-names>L</given-names></name><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name></person-group>             <year>2005</year>             <article-title>BEST: binding-site estimation suite of tools.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>2909</fpage>             <lpage>2911</lpage>          </element-citation></ref><ref id="pcbi.1000010-Barash2"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Barash</surname><given-names>Y</given-names></name><name name-style="western"><surname>Elidan</surname><given-names>G</given-names></name><name name-style="western"><surname>Kaplan</surname><given-names>T</given-names></name><name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name></person-group>             <year>2005</year>             <article-title>CIS: compound importance sampling method for protein-DNA binding site p-value estimation.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>596</fpage>             <lpage>600</lpage>          </element-citation></ref><ref id="pcbi.1000010-Bulyk1"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bulyk</surname><given-names>M</given-names></name><name name-style="western"><surname>Johnson</surname><given-names>P</given-names></name><name name-style="western"><surname>Church</surname><given-names>G</given-names></name></person-group>             <year>2002</year>             <article-title>Nucleotides of transcription factor binding sites exert interdependent effects on the binding affinities of transcription factors.</article-title>             <source>Nucleic Acids Res</source>             <volume>30</volume>             <fpage>1255</fpage>             <lpage>1261</lpage>          </element-citation></ref><ref id="pcbi.1000010-Kellis1"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kellis</surname><given-names>M</given-names></name><name name-style="western"><surname>Patterson</surname><given-names>N</given-names></name><name name-style="western"><surname>Endrizzi</surname><given-names>M</given-names></name><name name-style="western"><surname>Birren</surname><given-names>B</given-names></name><name name-style="western"><surname>Lander</surname><given-names>E</given-names></name></person-group>             <year>2003</year>             <article-title>Sequencing and comparison of yeast species to identify genes and regulatory elements.</article-title>             <source>Nature</source>             <volume>423</volume>             <fpage>241</fpage>             <lpage>254</lpage>          </element-citation></ref><ref id="pcbi.1000010-Barash3"><label>56</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Barash</surname><given-names>Y</given-names></name></person-group>             <year>2005</year>             <source>Unified Models for Regulatory Mechanisms. PhD thesis</source>             <publisher-loc>Jerusalem</publisher-loc>             <publisher-name>Hebrew University</publisher-name>          </element-citation></ref><ref id="pcbi.1000010-Siepel1"><label>57</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Siepel</surname><given-names>A</given-names></name><name name-style="western"><surname>Bejerano</surname><given-names>G</given-names></name><name name-style="western"><surname>Pedersen</surname><given-names>J</given-names></name><name name-style="western"><surname>Hinrichs</surname><given-names>A</given-names></name><name name-style="western"><surname>Hou</surname><given-names>M</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>Evolutionarily conserved elements in vertebrate, insect, worm, and yeast genomes.</article-title>             <source>Genome Res</source>             <volume>15</volume>             <fpage>1034</fpage>             <lpage>1050</lpage>          </element-citation></ref><ref id="pcbi.1000010-Karolchik1"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Karolchik</surname><given-names>D</given-names></name><name name-style="western"><surname>Baertsch</surname><given-names>R</given-names></name><name name-style="western"><surname>Diekhans</surname><given-names>M</given-names></name><name name-style="western"><surname>Furey</surname><given-names>T</given-names></name><name name-style="western"><surname>Hinrichs</surname><given-names>A</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>The UCSC Genome Browser Database.</article-title>             <source>Nucleic Acids Res</source>             <volume>31</volume>             <fpage>51</fpage>             <lpage>54</lpage>          </element-citation></ref></ref-list></back></article>