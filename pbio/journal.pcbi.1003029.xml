<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
   <journal-meta>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
      <journal-id journal-id-type="pmc">ploscomp</journal-id>
      <journal-title-group>
         <journal-title>PLoS Computational Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1553-734X</issn>
      <issn pub-type="epub">1553-7358</issn>
      <publisher>
         <publisher-name>Public Library of Science</publisher-name>
         <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
   </journal-meta>
   <article-meta>
      <article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-01883</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pcbi.1003029</article-id>
      <article-categories>
         <subj-group subj-group-type="heading">
            <subject>Research Article</subject>
         </subj-group>
<subj-group subj-group-type="Discipline-v2"><subject>Biology</subject>
<subj-group>
<subject>Plant science</subject>
<subj-group>
<subject>Botany</subject>
<subj-group>
<subject>Plant morphology</subject>
</subj-group>
</subj-group>
<subj-group>
<subject>Plants</subject>
<subj-group>
<subject>Flowering plants</subject>
<subject>Leafs</subject>
</subj-group>
</subj-group>
<subj-group>
<subject>Plant growth and development</subject>
<subject>Plant physiology</subject>
</subj-group>
</subj-group>
</subj-group>
<subj-group subj-group-type="Discipline-v2"><subject>Computer science</subject>
<subj-group>
<subject>Software engineering</subject>
<subj-group>
<subject>Software design</subject>
<subject>Software tools</subject>
</subj-group>
</subj-group>
</subj-group>
      </article-categories>
      <title-group>
         <article-title>Semi-automated 3D Leaf Reconstruction and Analysis of Trichome Patterning from Light Microscopic Images</article-title>
         <alt-title alt-title-type="running-head">3D Leaf Reconstruction and Trichome Patterning</alt-title>
      </title-group>
      <contrib-group>
         <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
            <name name-style="western"><surname>Failmezger</surname>
<given-names>Henrik</given-names>
            </name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff2"><sup>2</sup></xref>
         </contrib>
         <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
            <name name-style="western"><surname>Jaegle</surname>
<given-names>Benjamin</given-names>
            </name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref>
         </contrib>
         <contrib contrib-type="author" xlink:type="simple">
            <name name-style="western"><surname>Schrader</surname>
<given-names>Andrea</given-names>
            </name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref>
         </contrib>
         <contrib contrib-type="author" xlink:type="simple">
            <name name-style="western"><surname>Hülskamp</surname><given-names>Martin</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref>
         </contrib>
         <contrib contrib-type="author" xlink:type="simple">
            <name name-style="western"><surname>Tresch</surname><given-names>Achim</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref>
         </contrib>
      </contrib-group>
      <aff id="aff1"><label>1</label><addr-line>Max Planck Institute for Plant Breeding Research, Cologne, Germany</addr-line></aff>
      <aff id="aff2"><label>2</label><addr-line>Institute for Genetics, University of Cologne, Cologne, Germany</addr-line></aff>
      <aff id="aff3"><label>3</label><addr-line>Botanical Institute III, University of Cologne, Cologne, Germany</addr-line></aff>
      <contrib-group>
         <contrib contrib-type="editor" xlink:type="simple">
            <name name-style="western"><surname>Gonehal</surname>
<given-names>Venugopala Reddy</given-names>
            </name><role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
         </contrib>
      </contrib-group>
      <aff id="edit1"><addr-line>University of California Riverside, United States of America</addr-line></aff>
      <author-notes>
         <corresp id="cor1">* E-mail: <email xlink:type="simple">martin.huelskamp@uni-koeln.de</email> (MH); <email xlink:type="simple">tresch@mpipz.mpg.de</email> (AT)</corresp>
         <fn fn-type="conflict">
            <p>The authors have declared that no competing interests exist.</p>
         </fn>
         <fn fn-type="con">
            <p>Conceived and designed the experiments: MH AT. Performed the experiments: BJ AS. Analyzed the data: HF AT. Contributed reagents/materials/analysis tools: HF. Wrote the paper: HF BJ AS MH AT. Initiated the research: MH. Did the bioinformatics analysis: HF. Developed TrichEratops: HF. Designed the project and supervised the work: AS MH AT. All authors read and approved the final version of the manuscript. </p>
         </fn>
      </author-notes>
      <pub-date pub-type="collection">
         <month>4</month>
         <year>2013</year>
      </pub-date>
      <pub-date pub-type="epub">
         <day>18</day>
         <month>4</month>
         <year>2013</year>
      </pub-date>
      <volume>9</volume>
      <issue>4</issue>
      <elocation-id>e1003029</elocation-id>
      <history>
         <date date-type="received">
            <day>29</day>
            <month>11</month>
            <year>2012</year>
         </date>
         <date date-type="accepted">
            <day>26</day>
            <month>2</month>
            <year>2013</year>
         </date>
      </history>
      <permissions>
         <copyright-year>2013</copyright-year>
         <copyright-holder>Failmezger et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
      <abstract>
         <p>Trichomes are leaf hairs that are formed by single cells on the leaf surface. They are known to be involved in pathogen resistance. Their patterning is considered to emerge from a field of initially equivalent cells through the action of a gene regulatory network involving trichome fate promoting and inhibiting factors. For a quantitative analysis of single and double mutants or the phenotypic variation of patterns in different ecotypes, it is imperative to statistically evaluate the pattern reliably on a large number of leaves. Here we present a method that enables the analysis of trichome patterns at early developmental leaf stages and the automatic analysis of various spatial parameters. We focus on the most challenging young leaf stages that require the analysis in three dimensions, as the leaves are typically not flat. Our software TrichEratops reconstructs 3D surface models from 2D stacks of conventional light-microscope pictures. It allows the GUI-based annotation of different stages of trichome development, which can be analyzed with respect to their spatial distribution to capture trichome patterning events. We show that 3D modeling removes biases of simpler 2D models and that novel trichome patterning features increase the sensitivity for inter-accession comparisons.</p>
      </abstract>
      <abstract abstract-type="summary">
         <title>Author Summary</title>
         <p>The patterning of trichomes (leaf hair) on the surface of a leaf is a paradigm for studying gene regulation in developmental processes. The statistical analysis of trichome patterning requires automated methods for the location of trichomes on a curved leaf surface. This is particularly challenging for young, strongly bent leaves. We have developed the TrichEratops software that reconstructs 3D leaf surfaces from 2D stacks of conventional light-microscopy pictures. TrichEratops also calculates statistical patterning features, thereby greatly facilitating the whole data acquisition process. We show, using two <italic>Arabidopsis thaliana</italic> mutants, that 3D modeling removes biases and increases the discriminatory power of trichome pattern analysis.</p>
      </abstract>
      <funding-group>
         <funding-statement>This work was funded in parts by an SFB680 grant by Deutsche Forschungsgemeinschaft. AT is supported by a Jeff Schell professorship at the MPI for Plant Breeding research. BJ is supported by an IMPRS fellowship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
<counts>
<page-count count="10"/>
</counts>
</article-meta>
</front>
<body>
   <sec id="s1">
      <title>Introduction</title>
      <p>Leaf trichomes in <italic>Arabidopsis thaliana</italic> (<italic>A. thaliana</italic>) represent a well-studied model system for the analysis of patterning processes in plants. Leaf trichomes are single cells that are formed on young developing leaves <xref ref-type="bibr" rid="pcbi.1003029-Hulskamp1">[1]</xref>. At their first appearance trichomes are typically separated by three or more epidermal cells. Incipient trichomes undergo several rounds of endoreduplication accompanied by massive growth and branching. Concomitant with trichome differentiation, epidermal cells divide and expand resulting in a further separation of existing trichomes. At early stages of leaf development, three zones can be distinguished, the tip region containing only mature trichomes, an intermediate region with various stages of trichome development and a basal region in which trichomes are initiated. At later leaf developmental stages trichome initiation ceases and the expansion of the leaf through epidermal divisions/expansion <xref ref-type="bibr" rid="pcbi.1003029-Andriankaja1">[2]</xref> leads to the final distribution of trichomes.</p>
      <p>The genetic and molecular analysis of trichome development has revealed models that explain trichome development by a gene regulatory network of trichome promoting and inhibiting factors. Two probably in parallel acting mechanisms have been recognized <xref ref-type="bibr" rid="pcbi.1003029-Pesch1">[3]</xref>. One mechanism is based on a regulatory feedback loop of the trichome promoting genes <italic>TRANSPARENT TESTA GLABRA1</italic> (<italic>TTG1</italic>), <italic>GLABRA1</italic> (<italic>GL1</italic>) and <italic>GLABRA3</italic> (<italic>GL3</italic>)/<italic>ENHANCER OF GLABRA 3</italic> (<italic>EGL3</italic>) as well as the trichome inhibiting factors <italic>TRIPTYCHON</italic> (<italic>TRY</italic>) and <italic>CAPRICE</italic> (<italic>CPC</italic>) and their close homologs <xref ref-type="bibr" rid="pcbi.1003029-Pesch1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003029-TominagaWada1">[4]</xref>. In this activator-inhibitor scenario the activators transcriptionally activate the inhibitors that can move into the neighboring cells where they inhibit the activity of the activators. The second mechanism explains patterning by an activator-depletion mechanism <xref ref-type="bibr" rid="pcbi.1003029-Balkunde1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003029-Balkunde2">[6]</xref>. Here, <italic>TTG1</italic> can freely move between cells and is captured by GL3 in trichome precursor cells. As a result the activator <italic>TTG1</italic> is not available in the immediate vicinity of trichome initials. While many aspects of these models have been experimentally validated, it becomes increasingly clear that a mechanistic understanding of trichome patterning requires a more quantitative analysis. Towards this end, it would be necessary to have a high spatial resolution of the trichome distribution on mature and young leaves.</p>
      <p>Several approaches have been published that enable a high-resolution 3D reconstruction of mature as well as of young leaves. <italic>Lee</italic> and coworkers used the optical projection tomography method to create 3D reconstructions of various plant organs including leaves and showed that this method can be used for high-resolution morphological analysis in plants including trichomes on mature leaves <xref ref-type="bibr" rid="pcbi.1003029-Lee1">[7]</xref>. Kaminuma and coworkers applied micro X-ray computed tomography to visualize the trichome distribution and developed a strategy to automatically recognize trichomes on mature leaves <xref ref-type="bibr" rid="pcbi.1003029-Kaminuma1">[8]</xref>. The trichome distribution on young developing leaves was studied by Confocal Laser Scanning Microscopy. Young leaves were stained with propidium iodide and stacks of confocal images were assembled to 3D images that in turn were used to extract relevant leaf structures <xref ref-type="bibr" rid="pcbi.1003029-Greese1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003029-Bensch1">[10]</xref>. The three methods have in common that they require either instrumentations not easily available or that they are very time consuming. We therefore aimed to develop a new simple method that enables the rapid acquisition by conventional light microscopy and analysis of the trichome pattern on young and old leaves (<xref ref-type="supplementary-material" rid="pcbi.1003029.s007">Table S1</xref>).</p>
      <p>The method described here addresses an essential problem. Young <italic>A. thaliana</italic> leaves are typically not flat but bent at the leaf edges. Thus, the biologically relevant distances are shortest paths on the leaf surface and therefore require a 3D surface reconstruction. We propose a method for the modeling of planar surfaces of microscopic objects using simple light microscopy. By continuous variation of the microscope focus, a stack of images is generated such that each point in the plane is in focus in one stack image. Focus stacking is a well known method in microscopic imaging in order to capture sharp images of 3D objects. Different methods can be used for the determination of the sharpest point in the stack <xref ref-type="bibr" rid="pcbi.1003029-Valdecasas1">[11]</xref>–<xref ref-type="bibr" rid="pcbi.1003029-Piccinini1">[15]</xref>. We use the Sobel transform <xref ref-type="bibr" rid="pcbi.1003029-Kittler1">[16]</xref> as a measure of sharpness to determine for each point on the leaf its position in the image stack. We then fit an elastic map to this cloud of (x,y,z) tuples, which provides a smoothed, realistic fit of the object surface. As a convenient side product we generate a sharpened 2D image from the trichome image stack (see <xref ref-type="sec" rid="s4">Methods</xref>). We have developed TrichEratops, a software that covers all steps of this analysis: It allows the user to conveniently process the series of pictures into one sharp image, and to mark trichomes on the leaves; It estimates the 3D surface and calculates, among other spatial statistical features, the geodesic distances between the trichomes. We demonstrate the utility of our software and scan the leaf surfaces of challenging young leaves of Col-0 wild type and a genotype with Col-0 background carrying a T-DNA insertion the <italic>CPC</italic> gene. We discriminate the two genotypes by using summary statistics of their trichome distribution.</p>
   </sec>
   <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
         <title>Creation of a 3D surface model from a stack of 2D pictures</title>
         <p>As leaves, in particular young leaves, are frequently not flat but bent the distances between trichomes cannot appropriately be measured directly by their 2D Euclidean distance on the sharpened image. The 2D Euclidean distance systematically underestimates the real, i.e. geodesic distance, of two points on a curved surface. Depending on the bending of the leaf, the difference between Euclidean and geodesic distances can be large. As leaf bending in turn varies considerably among the leaves of one <italic>A. thaliana</italic> line it is important to generate a 3D leaf surface model. Towards this end we dissected young leaves and created a stack of pictures by continuously varying the focus in conventional bright field microscopy (<xref ref-type="fig" rid="pcbi-1003029-g001">Figure 1A,B</xref>). The pictures were captured by taking a movie. Once the leaf is dissected, the 2D picture stack can be generated in a few seconds.</p>
         <fig id="pcbi-1003029-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003029.g001</object-id><label>Figure 1</label>
            <caption>
               <title>Work flow for the creation of the 3D reconstruction.</title>
               <p>A: The 3rd true leaf is dissected from a one week old seedling. B: A stack of pictures is generated by varying the focus using a conventional light microscope. C: A height map of the leaf is created by taking for every (x,y) position the z position at which the vicinity of this point appears sharpest. Height values are color-coded, ranging from low (blue, green) to high (yellow, red). D: A sharp 2D image of the leaf is generated by taking for each (x,y) position the corresponding pixel intensity in the z-stack image specified by the height map. The position of trichomes and their stages are determined in this 2D view. E: A 3D surface model of the leaf is calculated from the picture stack by fitting an elastic map to the height map, and the trichomes are mapped onto this surface. Scale bars 100 µm.</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003029.g001" position="float" xlink:type="simple"/></fig>
         <p>We used the Sobel transform to assign to each (x,y) position a z-stack position for which its vicinity in the corresponding 2D image appears sharpest. The z-axis for each stack was properly scaled by acquiring a reference of known thickness positioned next to the leaves (<xref ref-type="bibr" rid="pcbi.1003029-XavierVidal1">[17]</xref>, see <xref ref-type="fig" rid="pcbi-1003029-g001">Figure 1C</xref>). Due to inaccuracies in z-positioning, this set of (x,y,z)-tuples merely defines a 3D cloud rather than a 2D leaf surface in 3D space. We therefore fit an elastic map (with an underlying rectangular 2D grid structure) to the cloud of (x,y,z) tuples <xref ref-type="bibr" rid="pcbi.1003029-Gorban1">[18]</xref>. Our elastic map is a continuous function f of the 2D coordinates (x,y). It can be viewed as a smoothing operator, which replaces the observed z position at given (x,y) coordinate by its smoothed fit z′ = f(x,y) (<xref ref-type="fig" rid="pcbi-1003029-g001">Figure 1D</xref>). The transformation of a 2D image stack into an elastic map takes about 5 min per leaf. The elastic map models the leaf surface as a 2D manifold, which allows us to use the geodesic distances between two points (i.e., the shortest path between them).</p>
      </sec>
      <sec id="s2b">
         <title>Efficient annotation and analysis of trichome stages by TrichEratops</title>
         <p>To identify moderate changes in trichome patterning, the different trichome developmental stages within young leaves have to be acquired (average leaf length of 320 µm for Col-0 wild type). Towards this end we define four developmental classes of trichomes. For the analysis of trichome patterning, we do not discriminate between all previously defined developmental stages <xref ref-type="bibr" rid="pcbi.1003029-Szymanski1">[19]</xref> but rather focus on four stages. The first class is formed by trichome initiation sites. This class includes all unbranched trichomes. The second and third class are trichomes with two and three branches, respectively. The last class consists of mature trichomes with a characteristic, incrusted cell wall (<xref ref-type="fig" rid="pcbi-1003029-g001">Figure 1E</xref>). Only leaves with one to six mature trichomes were analyzed. Together these classes define three zone: the patterning initiation zone (class 1), the differentiation zone (class 2 and 3) and the region containing the mature trichomes (class 4). TrichEratops facilitates the annotation of trichome stages on a leaf by providing a graphical user interface (<xref ref-type="fig" rid="pcbi-1003029-g002">Figure 2</xref>) for the marking of the four trichome classes on a sharpened 2D image of an <italic>A. thaliana</italic> leaf (this sharpened image is a side-product of the Sobel transform, see <xref ref-type="sec" rid="s4">Methods</xref>). Since subsequent feature extraction steps critically depend on the accuracy and completeness of the trichome annotation, we did not attempt to automate this step.</p>
         <fig id="pcbi-1003029-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003029.g002</object-id><label>Figure 2</label>
            <caption>
               <title>Graphical User Interface of TrichEratops.</title>
               <p>TrichEratops offers 4 different views of the leaf surface. The 2D sharpened image view (A) is used to mark trichome positions and their classes (red, purple, blue and green dots). Additionally, the leaf-centric xy-coordinate system can be set (blue axes), and the calibration marks for z-stacking can be specified (white and dark blue dot on the top half of the image). The 3D surface view (B) serves as a visual control of the reconstruction quality. The shortest paths between trichomes can be included optionally. The top control panel offers functionality for loading, saving, processing, and analysis of the image stacks.</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003029.g002" position="float" xlink:type="simple"/></fig>
         <p>In order to account for variation in leaf size and to obtain a unified leaf representation, we defined an orthogonal coordinate system on each leaf. The origin of the coordinate system is placed in the middle of the petiole at the leaf lamina's base. The y-axis and its scaling are determined manually by a unit vector pointing from the origin towards the top of the leaf, such that it separates the leaf into two equal halves. This implicitly defines the direction and scaling of the baseline x-axis (<xref ref-type="fig" rid="pcbi-1003029-g003">Figure 3A</xref>). The trichome positions of all leaves from one accession are then mapped onto a “meta leaf”, a comprehensive 2D representation of the class-specific trichome positions (<xref ref-type="fig" rid="pcbi-1003029-g003">Figure 3A</xref>). The meta leaf lays the basis for the calculation of relevant spatial characteristics and for their statistical comparison between different lines. The distributions of each trichome class along the basal-proximal axis are visualized in a 2D plot (<xref ref-type="fig" rid="pcbi-1003029-g003">Figure 3B</xref>) and in a 3D histogram showing the absolute frequencies as a function of their position on the meta leaf (<xref ref-type="fig" rid="pcbi-1003029-g003">Figure 3C</xref>). This type of analysis will enable a comparison of the spatial arrangement of the developmental zones between different <italic>A. thaliana</italic> genotypes (see <xref ref-type="supplementary-material" rid="pcbi.1003029.s005">Figure S5</xref>).</p>
         <fig id="pcbi-1003029-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003029.g003</object-id><label>Figure 3</label>
            <caption>
               <title>Meta leaf construction and analysis of spatial distribution of trichome classes for the Col-0 genotype.</title>
               <p>A: The meta leaf is generated by transforming all trichomes of all leaves of a given genotype to a common coordinate system (yellow axes) as illustrated by two sample leaves. The origin of each leaf is defined manually, and the unit vector in longitudinal axis direction is defined by the center of mass of the leaf. The basal axis is perpendicular to the longitudinal axis. The meta leaf shows the distribution of different trichome classes across the leaf, where red (respectively magenta, blue, green) dots indicate initiation (respectively two branch-, three branch-, and mature trichomes). B: The trichome localization along the longitudinal leaf axis is visualized. The vertical axis shows the proportion of different trichome classes at a given distance from the origin. C: The distribution of trichome classes on the meta leaf surface is shown in a 3D histogram. Trichome numbers at each position are shown as bars. The colors for the trichome classes are chosen as in A. Scale bars 100 µm.</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003029.g003" position="float" xlink:type="simple"/></fig>
      </sec>
      <sec id="s2c">
         <title>Accurate extraction of trichome patterning statistics by TrichEratops</title>
         <p>To evaluate the accuracy obtained by measuring the geodesic instead of the euclidean distances we compared the Col-0 wild type line with <italic>cpc</italic> mutant (<italic>cpc-2</italic>) known to have a higher trichome density at all leaf developmental stages tested <xref ref-type="bibr" rid="pcbi.1003029-Schellmann1">[20]</xref>.</p>
         <p>By combining the 2D trichome position information with the elastic map representation of a leaf, we can assign to each trichome a point on the 3D leaf surface (<xref ref-type="fig" rid="pcbi-1003029-g001">Figure 1</xref>). This suggests three distinct possibilities to measure the distance between two trichomes: The Euclidean distance on the 2D image, the Euclidean distance in the 3D reconstruction, and the geodesic distance on the 3D reconstruction of the leaf surface (<xref ref-type="fig" rid="pcbi-1003029-g004">Figure 4A</xref>). We assessed the systematic differences between the 2D Euclidean distance and the geodesic distance for each pair of trichomes (<xref ref-type="fig" rid="pcbi-1003029-g004">Figure 4B</xref>). The median deviation of the geodesic distance to the 2D distance is 9.05% for the wild type <italic>A. thaliana</italic> and 11.64% for the leaves of the <italic>cpc-2</italic> mutant. A closer investigation reveals that both steps, the transformation from 2D to 3D Euclidean distances, and the step from 3D Euclidean distance to geodesic distance, contribute substantially to this deviation (<xref ref-type="supplementary-material" rid="pcbi.1003029.s003">Figure S3B and S3A</xref>). The effect of the latter step is more pronounced, which demonstrates the importance of a realistic 3D leaf representation.</p>
         <fig id="pcbi-1003029-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003029.g004</object-id><label>Figure 4</label>
            <caption>
               <title>Comparison of Euclidean and geodesic distances.</title>
               <p>A: 3D reconstruction of an <italic>A. thaliana</italic> leaf surface. The two red dots mark the origins of two trichomes. They illustrate the difference between geodesic distance (white line), Euclidean distance with 3D coordinates (yellow line) and 2D coordinates (orange line). B: Calculation of the 2D distance relative to the geodesic distance (2D distance in percent of geodesic distance). These relative values are summarized in box plots, one for each leaf (wild type in green, <italic>cpc-2</italic> in blue). The orange boxes show the distribution of the median of these ratios for wild type (left) and <italic>cpc-2</italic> mutants (right). C: Spatial distortion (2D area divided by 3D area) of the leaf surface. We calculate the distortion for each triangle of the elastic map. Triangles are color-coded by their distortion value. D: Diagram of the 2D to 3D ratios of the triangles along the longitudinal leaf axis (green: wild type, blue: <italic>cpc-2</italic>). The colored bands show the 50% confidence bands for each genotype. Scale bars 100 µm.</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003029.g004" position="float" xlink:type="simple"/></fig>
         <p>Similarly, the leaf area calculations derived from 2D and 3D reconstructions can differ substantially (<xref ref-type="supplementary-material" rid="pcbi.1003029.s004">Figure S4</xref>). As the differences between the two calculation methods depend on the form of the particular leaf, we developed methods to visualize the local differences. We present the leaf surface as a network of triangles that are colored in blue for low differences in the leaf area and red for big differences (<xref ref-type="fig" rid="pcbi-1003029-g004">Figure 4C</xref>) or simply in a diagram focusing on the basal-distal axis (<xref ref-type="fig" rid="pcbi-1003029-g004">Figure 4D</xref>).</p>
         <p>When comparing wild type and <italic>cpc-2</italic> mutants (<xref ref-type="fig" rid="pcbi-1003029-g004">Figure 4B</xref>), we found no indication that local distortion differs. However, <italic>cpc-2</italic> distortion is systematically higher than in wild type for the distal parts of the leaf. Thus, 2D distance measurements would systematically underestimate trichome distances in distal parts of the <italic>cpc-2</italic> mutants relative to wild type distances and therefore bias their comparison. This shows that 3D modeling is required to generate reliable and meaningful features.</p>
      </sec>
      <sec id="s2d">
         <title>Comparison between wild type and mutant trichome patterns</title>
         <p>To facilitate the comparison of the trichome pattern between different lines we developed several methods to quantify different aspects of the spatial distribution of trichome classes and studied the differences between wild type and <italic>cpc-2</italic> mutants.</p>
         <p>In a first step, we compared the relative proportions of trichome classes along the basal-distal axis. We found similar proportions in wild type and the <italic>cpc-2</italic> mutant indicating that the speed of trichome development is in the same range (<xref ref-type="supplementary-material" rid="pcbi.1003029.s001">Figure S1</xref>). Next, we determined the distances of trichomes from the leaf basis and compared these values separately for all trichome classes (<xref ref-type="fig" rid="pcbi-1003029-g005">Figure 5A</xref>). We found no significant differences between wild type and <italic>cpc-2</italic> mutants. Thus the spatial distributions of the zones in the leaf are similar.</p>
         <fig id="pcbi-1003029-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003029.g005</object-id><label>Figure 5</label>
            <caption>
               <title>Analysis of trichome patterning by various spatial statistics.</title>
               <p>Left panel: Example of a Col-0 leaf, middle panel: Example of a <italic>cpc-2</italic> leaf, right panel: box plots of the statistics, stratified for trichome classes (red, magenta, blue, green) and genotypes (left box, right box). A: Distance from the leaf base line. B: Trichome density calculated as the number of trichomes divided by 3D leaf area. C: Voronoi areas of the trichomes defined by 2D Euclidean distance. D: Voronoi areas of the trichomes defined by 3D Euclidean distance. Scale bars 100 µm.</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003029.g005" position="float" xlink:type="simple"/></fig>
         <p>The meta leaf minimizes the influence of the leaf shape and areas by normalizing it to a unit shape. This is particularly important, because the wild type has a bigger leaf index (i.e., minor axis (leaf width) divided by major axis (leaf length)) than the <italic>cpc-2</italic> mutant (<xref ref-type="supplementary-material" rid="pcbi.1003029.s006">Figure S6</xref> C, Wilcoxon test:, p = 0.0051).</p>
         <p>The previous finding that trichome density (defined as the number of trichomes per leaf area) in <italic>cpc-2</italic> mutants is increased in young and mature leaves <xref ref-type="bibr" rid="pcbi.1003029-Schellmann1">[20]</xref> raises the question how the pattern originates. The class specific localization data enabled us to compare the trichome density for each class and thereby the developmental stages (<xref ref-type="fig" rid="pcbi-1003029-g005">Figure 5B</xref>). We found significant differences in the trichome densities for the three branched trichomes (Wilcoxon test, p-value&lt;0.05, <xref ref-type="supplementary-material" rid="pcbi.1003029.s009">Table S3</xref>) and no significant differences in the densities of initiation trichomes and 2 branched trichomes. Note that young leaves were selected by their number of mature trichomes (strictly less than 7), making a comparison of the mature trichome density meaningless (<xref ref-type="supplementary-material" rid="pcbi.1003029.s008">Table S2</xref>).</p>
         <p>There were no obvious differences in the regional distribution of trichome densities between wild type and <italic>cpc-2</italic> mutants (<xref ref-type="fig" rid="pcbi-1003029-g003">Figure 3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003029.s005">Figure S5</xref>). We therefore refined our analysis by calculating the Voronoi cells for all trichomes (see <xref ref-type="sec" rid="s4">Methods</xref>). The Voronoi tessellation decomposes the leaf in regions, one for each trichome. Each point on the leaf surface is assigned to its proximal trichome, where distance is either measured by 2D Euclidean distance (<xref ref-type="fig" rid="pcbi-1003029-g005">Figure 5C</xref>) or 3D Euclidean distance (<xref ref-type="fig" rid="pcbi-1003029-g005">Figure 5D</xref>). Note that there are no efficient algorithms for calculating the Voronoi tessellations with respect to geodesic distance. The area of a Voronoi cell is a local measure of the inhibition strength exerted by its central trichome. The Voronoi areas of marginal trichomes are infinite and thus excluded from our analysis. The comparison of the Voronoi cell areas between the wild type and the <italic>cpc</italic>-2 mutant reveals that trichomes have significantly smaller Voronoi regions in the <italic>cpc-2</italic> mutant for the first three trichome classes (consistently, p&lt;0.05 in a Wilcoxon test, <xref ref-type="supplementary-material" rid="pcbi.1003029.s011">Table S5</xref>). No statistical test was performed for the mature trichomes, for the reasons explained above. Alternatively, the geodesic distance of a trichome to its nearest neighbor can be considered as a measure of spatial inhibition. Again, we found a significant difference in geodesic distances between wild type and <italic>cpc-2</italic> (Wilcoxon test, p = 0.0003, <xref ref-type="supplementary-material" rid="pcbi.1003029.s012">Table S6</xref>).</p>
      </sec>
   </sec>
   <sec id="s3">
      <title>Discussion</title>
      <p>Although the final trichome pattern is generated by two events, the initiation in young leaves and the separation by epidermal cell divisions and expansion, most of the genetic analysis is based on the pattern seen in mature leaves. The analysis of trichome initiation is complicated by the fact that young leaves are typically not flat. One possibility is the reconstruction of propidium iodide stained Confocal Scanning Laser Microscopy images <xref ref-type="bibr" rid="pcbi.1003029-Greese1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003029-Bensch1">[10]</xref>. While this method has the advantage of a high resolution the generation of image stacks and subsequent analysis is time consuming. In contrast, picture acquisition with a light microscope leaves the tissue and thus avoids artifacts. To facilitate the analysis of young leaf stages and early stages of trichome initiation and -development we devised TrichEratops, a software that enables the analysis of relevant parameters on the three dimensional leaf surfaces derived from a rapidly acquired image stacks by conventional light microscopy. The actual acquisition of images takes only few seconds and TrichEratops enables a fast and convenient semi-automated analysis.</p>
      <sec id="s3a">
         <title>Geodesic versus Euclidean distances</title>
         <p>How relevant is it to calculate the geodesic rather than the Euclidean distances? When calculating the differences for individual leaves we found a 10%–20% difference between the two types of measurements (<xref ref-type="fig" rid="pcbi-1003029-g004">Figure 4</xref>). In the light that the differences in trichome density for each trichome class is rather small between the well-established trichome density mutant <italic>cpc</italic> and wild type (<xref ref-type="fig" rid="pcbi-1003029-g005">Figure 5</xref>), it is absolutely necessary to measure the geodesic distances when studying young leaves. Moreover, we found that the geodesic and Euclidean distances varied locally (<xref ref-type="fig" rid="pcbi-1003029-g004">Figure 4C</xref>). This in turn would lead to a misinterpretation of regional distances and densities depending on how much the leaves are bend.</p>
      </sec>
      <sec id="s3b">
         <title>Analysis tools, what do we learn from which method?</title>
         <p>For an evaluation of our analysis tools we chose the comparison of wild type with the trichome density mutant <italic>cpc</italic> <xref ref-type="bibr" rid="pcbi.1003029-Schellmann1">[20]</xref>. Our analysis tools are designed to capture most relevant aspects of trichome patterning step by step.</p>
         <p>In a first step, the whole leaf area and the leaf index are determined to detect gross variations in leaf shape that in turn may influence the trichome patterns. The second step is the creation of the meta leaf and the analysis of the trichome distribution along the longitudinal axis on a normalized leaf surface area. The distinction between different trichome developmental stages enables the detailed analysis of different aspects: 1) the relative size of the trichome initiation zone, the differentiation zone and the mature trichome zone. 2) the relative overlap of the three zones. As shown in <xref ref-type="fig" rid="pcbi-1003029-g003">Figure 3B</xref> there is already substantial overlap between the four trichome classes in wild type. Our finding that this is unchanged in <italic>cpc</italic> mutants indicates that the higher trichome density in <italic>cpc</italic> mutants originates during trichome initiation. The 2D presentation of the trichome distribution on a normalized leaf enables to recognize mutants in which the relative distribution on the leaf is changed as exemplified by lines overexpressing GL1 <xref ref-type="bibr" rid="pcbi.1003029-Larkin1">[21]</xref> in which trichome density is reduced in the mid region of the leaf.</p>
         <p>The third step is the analysis of global and local trichome density. The global trichome density is a coarse measure, as it simply relates the number of trichomes to the leaf area. The Voronoi area is a local measure of trichome density; it measures the area around trichomes that is free of other trichomes. All peripheral trichomes are not considered and therefore border effects are excluded. Therefore the Voronoi area analysis is likely to be more suitable to capture subtle changes in the trichome initiation caused by interactions between the trichomes. The difference between the two methods is demonstrated in <xref ref-type="fig" rid="pcbi-1003029-g005">Figure 5B and 5D</xref>. The Voronoi areas are smallest for the initiation stage and gradually increase for more advanced stages of trichome development.</p>
         <p>In summary, we provide a new semi-automated tool enabling the fast acquisition of image stacks, the 3D construction and analysis of relevant aspects of trichome patterning. This tool will enable a more detailed quantitative analysis of <italic>A. thaliana</italic> lines for a better understanding of the molecular mechanisms of trichome patterning. The combination of light microscopy and surface reconstruction has the potential of analyzing other plant material (root hair, seedlings, and flower sepal/petal). In general it could be applied for any 3D reconstruction tasks of a bent surface.</p>
      </sec>
   </sec>
   <sec id="s4" sec-type="methods">
      <title>Methods</title>
      <sec id="s4a">
         <title>Plant material and growth conditions</title>
         <p>For all experiments, the <italic>A. thaliana</italic> ecotype Columbia-0 and the <italic>cpc-2</italic> mutant <xref ref-type="bibr" rid="pcbi.1003029-Kurata1">[22]</xref> were grown on soil. Seeds were stratified (1 week, 4°C) and shifted to long day conditions (16 h white light, 90–120 µmol m<sup>−2</sup> s<sup>−1</sup>/8 h darkness; 21°C).</p>
      </sec>
      <sec id="s4b">
         <title>Microscopy</title>
         <p>The third true leaf was dissected from one week old seedlings. Dissected leaves were transferred to a slide previously covered by 1% agar to avoid desiccation. To allow comparison between leaves we selected leaves with a maximum of 6 matures trichomes. Manual stacks of the leaves were acquired with a Leica DM5000B microscope equipped with a LEICA DFC 360 FX camera using a 10× objective. While the experimenter manually focuses along the z-axis by turning the focus of the light microscope, the Leica LAS AF software automatically generates a series of pictures ( = z-stack) by acquiring one picture per 104 ms . Start and end point were the last and first unsharp layers. 50–70 pictures were taken per leaf. To scale the Z axis the “dissector Z-axis mechanical method” was used with a piece of a cover slide (#1, art Nr H878, ROTH, Karlsruhe) positioned next to the leaf as described before (Xavier-Vidal, 2010). The thickness of the cover slide was determined using a scaling slide, PYER SGI LIMITED (1mm/0,01 mm DIV, Kent, UK), to set the exact ratio pixel/mm. For this the piece of a cover slide was placed vertically in agar to allow a precise measurement of its thickness (see <xref ref-type="supplementary-material" rid="pcbi.1003029.s002">Figure S2</xref>).</p>
      </sec>
      <sec id="s4c">
         <title>Focus stacking and image sharpening</title>
         <p>In order to get a 3D map of Z positions from the stack, the sharpest value for every pixel needed to be found. For this purpose we used the fact that clear edges indicate sharp pixel. Edges in the Images were detected by the Sobel transform <xref ref-type="bibr" rid="pcbi.1003029-Kittler1">[16]</xref>. A position in the image was considered as sharp if its Sobel value or the Sobel value in spatial proximity (5*5 window) reached its maximum. This resulted in a z-map of stack positions (<xref ref-type="fig" rid="pcbi-1003029-g001">Figure 1</xref>).</p>
         <p>This approach was inspired by the Stack Focuser plugin for ImageJ by Michael Umorin. The z positions can be used to generate a sharpened 2D image from the image stack, by choosing for each (x,y) position the pixel intensity of the image at the corresponding z stack position (see <xref ref-type="fig" rid="pcbi-1003029-g001">Figure 1E</xref>).</p>
      </sec>
      <sec id="s4d">
         <title>Surface modeling by elastic maps</title>
         <p>Elastic maps are a tool to approximate non-linear principal manifolds <xref ref-type="bibr" rid="pcbi.1003029-Gorban1">[18]</xref>. Here, we use an elastic map for the robust reconstruction of the leaf ground from the Z-stack map.</p>
         <p>Let S bet the coordinates <italic>(x,y,z = stack position)</italic> of the pixels in the image. The image is covered by an <italic>n</italic>-dimensional grid.</p>
         <p>This grid defines a connected unordered graph <italic>G(Y,E)</italic> where <italic>Y</italic> is the collection of graphs nodes and <italic>E</italic> the collection between these nodes respectively. Furthermore, we define ribs, <italic>R</italic>, as a collection of edges between three consecutive nodes for which the bending energy is calculated.</p>
         <p>Every data point <italic>s</italic> in <italic>S</italic> is assigned to its host node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003029.e001" xlink:type="simple"/></inline-formula>, the closest node in the grid. Thus the dataset <italic>S</italic> is divided into sub-collections <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003029.e002" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003029.e003"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003029.e003" xlink:type="simple"/></disp-formula>Three energies are defined for the elastic map:<disp-formula id="pcbi.1003029.e004"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003029.e004" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003029.e005"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003029.e005" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003029.e006"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003029.e006" xlink:type="simple"/></disp-formula>Where <italic>U(y)</italic> is the average weighted square between pixels and the graph nodes, <italic>U(E)</italic> is the energy of elastic stretching of edges in the graph and <italic>U(R)</italic> is the energy of elastic bending of edges in the graph.</p>
         <p>The overall energy of the elastic map <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003029.e007" xlink:type="simple"/></inline-formula> is minimized by the EM algorithm.</p>
         <p>The overall energy of the elastic map <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003029.e008" xlink:type="simple"/></inline-formula> is minimized by the EM algorithm.</p>
      </sec>
      <sec id="s4e">
         <title>Leaf detection</title>
         <p>The leaf was identified by Otsu thresholding <xref ref-type="bibr" rid="pcbi.1003029-Otsu1">[23]</xref> of the grey values in the image. Large trichomes that extended over the leaf area were cut using morphological operations: Morphological opening by a disc shaped structuring element, larger than the broadest trichome was applied. This operation includes an erosion that deletes trichome structures and a deletion that rebuilds the leaf structure <xref ref-type="bibr" rid="pcbi.1003029-Soille1">[24]</xref>.</p>
         <p>Some leaves were difficult to segment as they were in spatial proximity to the cover slides. For these leaves we implemented a manual segmentation in our software that enables to draw a line around the leaf and to take the area in the convex hull of this line as leaf area.</p>
      </sec>
      <sec id="s4f">
         <title>TrichEratops</title>
         <p>All analysis steps were implemented in a software called TrichEratops (<xref ref-type="fig" rid="pcbi-1003029-g002">Figure 2</xref>). This software has a Graphical User Interface, in which z-stacks are loaded and first converted into a sharp image. Trichomes can be then marked with their individual classes. A coordinate system can be drawn into the image and trichome positions are transformed to this coordinate system to ensure comparability.</p>
         <p>From the z-stack, 3D surface and area are calculated and geodesic distance can be derived for the trichomes.</p>
         <p>The software can handle 3D images as well as 2D images (for older leaves). All the analysis steps were implemented in Matlab. The TrichEratops software is available under the GPL3.0 license at <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/tricheratops/" xlink:type="simple">https://sourceforge.net/projects/tricheratops/</ext-link>.</p>
      </sec>
      <sec id="s4g">
         <title>Spatial statistics of trichome patterning</title>
         <p>2D Euclidean distance is the simple vector length between two points. For the 3D Euclidean distance, the z coordinate was determined by the elastic map. For the geodesic distance the shortest path on the 3D mesh was calculated by the Fast Marching algorithm <xref ref-type="bibr" rid="pcbi.1003029-Deschamps1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003029-Sethian1">[26]</xref>. The Matlab implementation of Gabriel Peyré was used for this task (<ext-link ext-link-type="uri" xlink:href="http://www.mathworks.com/matlabcentral/fileexchange/6110" xlink:type="simple">http://www.mathworks.com/matlabcentral/fileexchange/6110</ext-link>). Voronoi diagrams are a known method to investigate biological patterning <xref ref-type="bibr" rid="pcbi.1003029-Greese1">[9]</xref>. Standard Matlab methods were used for the calculation of the voronoi cells.</p>
      </sec>
   </sec>
   <sec id="s5">
      <title>Supporting Information</title>
<supplementary-material id="pcbi.1003029.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s001" position="float" xlink:type="simple">
<label>Figure S1</label>
<caption><p>Relative abundance (in %) of trichome classes (red: initiation, magenta: 2-branch trichomes, blue: 3-branch trichomes, green: mature trichomes) for wildtype (left) and the <italic>cpc-2</italic> mutant leaves (right). Error bars show standard deviations.</p>
      <p>(TIF)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s002" position="float" xlink:type="simple">
<label>Figure S2</label>
<caption><p>Microscopic pictures used to scale the z-axis. A: A scaling slide PYER SGI LIMITED (1 mm/0.01 mm DIV, Kent, UK) used to scale the 2D distance of the microscope. From that the ratio pixel per µm was determined. Each graduation equals 10 µm. B: A piece of a cover slide used for the z-axis scaling was placed vertically into agar. The line shows how the thickness of the cover slide was precisely measured. Subsequently, this piece of a cover slide was placed flat next to an acquired leaf and served as a reference for the z-axis.</p>
      <p>(TIF)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s003" position="float" xlink:type="simple">
<label>Figure S3</label>
<caption><p>A: Relative increase (in %) of geodesic distances between two trichomes over the corresponding 3D Euclidean distances, summarized as separate boxplots for each leaf. Wildtype leafs are marked in green, leafs of <italic>cpc-2</italic> are marked in blue. The orange boxes show the distribution of the median increases for wild type (left) and <italic>cpc-2</italic> (right). B: Relative increase (in %) of 3D Euclidean distances between two trichomes over the corresponding 2D Euclidean distances. Coloring is as in A), identical leaves are shown in the same column as in A).</p>
      <p>(TIF)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s004" position="float" xlink:type="simple">
<label>Figure S4</label>
<caption><p>Comparison of 2D leaf area and 3D leaf area. Each line corresponds to one leaf (green: wild type, blue: <italic>cpc-2</italic>). The lower point of each vertical line corresponds to the 2D area, the upper point shows the 3D area. Leaf area is given in arbitrary units.</p>
      <p>(TIF)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s005" position="float" xlink:type="simple">
<label>Figure S5</label>
<caption><p>Meta leaf construction and analysis of spatial distribution of trichome classes for the <italic>cpc-2</italic> genotype. A: The meta leaf is generated by transforming all trichomes of all leaves of a given genotype to a common coordinate system. The meta leaf shows the distribution of different trichome classes across the leaf, where red (respectively magenta, blue, green) dots indicate initiation (respectively two branch-, three branch-, and mature trichomes). B: The trichome localization along the longitudinal leaf axis is visualized. The vertical axis shows the proportion of different trichome classes at a given distance from the origin. C: The distribution of trichome classes on the meta leaf surface is shown in a 3D histogram. Trichome numbers at each position are shown as bars.</p>
      <p>(TIF)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s006" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s006" position="float" xlink:type="simple">
<label>Figure S6</label>
<caption><p>Comparison of leaf area, leaf length and leaf index for Col-0 and <italic>cpc-2</italic>. A: Leaf Area, given by the surface area of the elastic map. B: Leaf length, distance between leaf top and leaf base point. C: Leaf index, given by the quotient of leaf minor axis and leaf major axis.</p>
      <p>(TIF)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s007" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s007" position="float" xlink:type="simple">
<label>Table S1</label>
<caption><p>Comparison between TrichEratops and other existing methods. Despite of all other methods TrichEratops combines light microscopy (without long sample preparation) and 3D reconstruction of the leaf surface. Furthermore it calculates patterning features similar to existing methods (voronoi area, metaleaf, coordinates).</p>
      <p>(DOCX)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s008" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s008" position="float" xlink:type="simple">
<label>Table S2</label>
<caption><p>Trichome counts for both genotypes and counts of finite Voronoi cells. Finite Voronoi cells are Voronoi regions that are bounded and whose edge points lie on the leaf surface.</p>
      <p>(DOCX)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s009" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s009" position="float" xlink:type="simple">
<label>Table S3</label>
<caption><p>Wilcoxon test for difference in trichome density between Col-0 and <italic>cpc-2</italic>.</p>
      <p>(DOCX)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s010" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s010" position="float" xlink:type="simple">
<label>Table S4</label>
<caption><p>Wilcoxon test for difference in 2D Voronoi Area between Col-0 and <italic>cpc-2</italic>.</p>
      <p>(DOCX)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s011" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s011" position="float" xlink:type="simple">
<label>Table S5</label>
<caption><p>Wilcoxon test for difference in 3D Voronoi Area between Col-0 and <italic>cpc-2</italic>.</p>
      <p>(DOCX)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s012" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s012" position="float" xlink:type="simple">
<label>Table S6</label>
<caption><p>Wilcoxon test for difference in geodesic distance to nearest neighbor between Col-0 and <italic>cpc-2</italic>.</p>
      <p>(DOCX)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003029.s013" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003029.s013" position="float" xlink:type="simple">
<label>Text S1</label>
<caption><p>Supplementary References.</p>
      <p>(DOCX)</p>
</caption></supplementary-material>
   </sec>
</body>
<back>
   <ref-list>
      <title>References</title>
      <ref id="pcbi.1003029-Hulskamp1"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hulskamp</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Misra</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Jurgens</surname><given-names>G</given-names></name> (<year>1994</year>) <article-title>Genetic dissection of trichome cell development in Arabidopsis</article-title>. <source>Cell</source> <volume>76</volume>: <fpage>555</fpage>–<lpage>566</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Andriankaja1"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andriankaja</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Dhondt</surname><given-names>S</given-names></name>, <name name-style="western"><surname>De Bodt</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Vanhaeren</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Coppens</surname><given-names>F</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Exit from proliferation during leaf development in Arabidopsis thaliana: a not-so-gradual process</article-title>. <source>Developmental cell</source> <volume>22</volume>: <fpage>64</fpage>–<lpage>78</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Pesch1"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pesch</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hulskamp</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>One, two, three…models for trichome patterning in Arabidopsis?</article-title> <source>Curr Opin Plant Biol</source> <volume>12</volume>: <fpage>587</fpage>–<lpage>592</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-TominagaWada1"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tominaga-Wada</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Ishida</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Wada</surname><given-names>T</given-names></name> (<year>2011</year>) <article-title>New insights into the mechanism of development of Arabidopsis root hairs and trichomes</article-title>. <source>International review of cell and molecular biology</source> <volume>286</volume>: <fpage>67</fpage>–<lpage>106</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Balkunde1"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balkunde</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Pesch</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hulskamp</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Trichome patterning in Arabidopsis thaliana from genetic to molecular models</article-title>. <source>Current topics in developmental biology</source> <volume>91</volume>: <fpage>299</fpage>–<lpage>321</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Balkunde2"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balkunde</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Bouyer</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Hulskamp</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>Nuclear trapping by GL3 controls intercellular transport and redistribution of TTG1 protein in Arabidopsis</article-title>. <source>Development</source> <volume>138</volume>: <fpage>5039</fpage>–<lpage>5048</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Lee1"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Avondo</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Morrison</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Blot</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Stark</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Visualizing plant development and gene expression in three dimensions using optical projection tomography</article-title>. <source>Plant Cell</source> <volume>18</volume>: <fpage>2145</fpage>–<lpage>2156</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Kaminuma1"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kaminuma</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Yoshizumi</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Wada</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Matsui</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Toyoda</surname><given-names>T</given-names></name> (<year>2008</year>) <article-title>Quantitative analysis of heterogeneous spatial distribution of Arabidopsis leaf trichomes using micro X-ray computed tomography</article-title>. <source>Plant J</source> <volume>56</volume>: <fpage>470</fpage>–<lpage>482</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Greese1"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Greese</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Wester</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Bensch</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Ronneberger</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Timmer</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Influence of cell-to-cell variability on spatial pattern formation</article-title>. <source>IET systems biology</source> <volume>6</volume>: <fpage>143</fpage>–<lpage>153</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Bensch1"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Bensch R, Ronneberger O, Greese B, Fleck C, Wester K, <etal>et al</etal>.. (2010) Image analysis of arabidopsis trichome patterning in 4D confocal datasets. In: International Symposium on Biomedical Imaging: From Nano to Macro; 28 June–1 July 2009 Boston, Massachusetts, United states. ISBI 2009. Available; <ext-link ext-link-type="uri" xlink:href="http://lmb.informatik.uni-freiburg.de/Publications/2009/BRB09/" xlink:type="simple">http://lmb.informatik.uni-freiburg.de/Publications/2009/BRB09/</ext-link></mixed-citation></ref>
      <ref id="pcbi.1003029-Valdecasas1"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Valdecasas</surname><given-names>AG</given-names></name>, <name name-style="western"><surname>Marshall</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Becerra</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Terrero</surname><given-names>J</given-names></name> (<year>2001</year>) <article-title>On the extended depth of focus algorithms for bright field microscopy</article-title>. <source>Micron</source> <volume>32</volume>: <fpage>559</fpage>–<lpage>569</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Forster1"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Forster</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Van De Ville</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Berent</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Sage</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Unser</surname><given-names>M</given-names></name> (<year>2004</year>) <article-title>Complex wavelets for extended depth‐of‐field: A new method for the fusion of multichannel microscopy images</article-title>. <source>Microscopy Research and technique</source> <volume>65</volume>: <fpage>33</fpage>–<lpage>42</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Aguet1"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Aguet F, Van De Ville D, Unser M (2008) Model-Based 2.5-D Deconvolution for Extended Depth of Field in Brightfield Microscopy. In: IEEE Transactions on Image Processing. pp. 1144–1153.</mixed-citation></ref>
      <ref id="pcbi.1003029-Tessens1"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Tessens L, Ledda A, Pizurica A, Philips W. (2007) Extending the depth of field in microscopy through curvelet-based frequency-adaptive image fusion. In: IEEE International Conference on Acoustics, Speech and Signal Processing; 15–20 April 2007. pp. I-861–I-864.</mixed-citation></ref>
      <ref id="pcbi.1003029-Piccinini1"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Piccinini</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Tesei</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Zoli</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Bevilacqua</surname><given-names>A</given-names></name> (<year>2012</year>) <article-title>Extended depth of focus in optical microscopy: Assessment of existing methods and a new proposal</article-title>. <source>Microscopy Research and Technique</source> <volume>75</volume>: <fpage>1582</fpage>–<lpage>1592</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Kittler1"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kittler</surname><given-names>J</given-names></name> (<year>1983</year>) <article-title>On the accuracy of the Sobel edge detector</article-title>. <source>Image and Vision Computing</source> <volume>1</volume>: <fpage>37</fpage>–<lpage>42</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-XavierVidal1"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xavier-Vidal</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Disector Z-axis mechanical method for stereology</article-title>. <source>Annals of the Brazilian Academy of Sciences</source> <volume>82</volume>: <fpage>539</fpage>–<lpage>544</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Gorban1"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gorban</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Zinovyev</surname><given-names>A</given-names></name> (<year>2005</year>) <article-title>Elastic principal graphs and manifolds and their practical applications</article-title>. <source>Computing</source> <volume>75</volume>: <fpage>359</fpage>–<lpage>379</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Szymanski1"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Szymanski</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Jilk</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Pollock</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Marks</surname><given-names>MD</given-names></name> (<year>1998</year>) <article-title>Control of GL2 expression in <italic>Arabidopsis</italic> leaves and trichomes</article-title>. <source>Development</source> <volume>125</volume>: <fpage>1161</fpage>–<lpage>1171</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Schellmann1"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schellmann</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Schnittger</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kirik</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Wada</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Okada</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>TRIPTYCHON and CAPRICE mediate lateral inhibition during trichome and root hair patterning in Arabidopsis</article-title>. <source>Embo J</source> <volume>21</volume>: <fpage>5036</fpage>–<lpage>5046</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Larkin1"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Larkin</surname><given-names>LC</given-names></name>, <name name-style="western"><surname>Oppenheimer</surname><given-names>DG</given-names></name>, <name name-style="western"><surname>Lloyd</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Paparozzi</surname><given-names>ET</given-names></name>, <name name-style="western"><surname>Marks</surname><given-names>MD</given-names></name> (<year>1994</year>) <article-title>The roles of the <italic>GLABROUS1</italic> and <italic>TRANPARENT TESTA GLABRA</italic> genes in <italic>Arabidopsis</italic> trichome development</article-title>. <source>The Plant Cell</source> <volume>6</volume>: <fpage>1065</fpage>–<lpage>1076</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Kurata1"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kurata</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Ishida</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Kawabata-Awai</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Noguchi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hattori</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Cell-to-cell movement of the CAPRICE protein in Arabidopsis root epidermal cell differentiation</article-title>. <source>Development</source> <volume>132</volume>: <fpage>5387</fpage>–<lpage>5398</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Otsu1"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Otsu</surname><given-names>N</given-names></name> (<year>1979</year>) <article-title>A Threshold Selection Method from Gray-Level Histograms</article-title>. <source>Systems, Man and Cybernetics, IEEE Transactions on</source> <volume>9</volume>: <fpage>62</fpage>–<lpage>66</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Soille1"><label>24</label><mixed-citation publication-type="other" xlink:type="simple">Soille P (2010) Morphological Image Analysis: Principles and Applications. Springer. 408 p.</mixed-citation></ref>
      <ref id="pcbi.1003029-Deschamps1"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Deschamps</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Cohen</surname><given-names>LD</given-names></name> (<year>2001</year>) <article-title>Fast extraction of minimal paths in 3D images and applications to virtual endoscopy</article-title>. <source>Medical Image Analysis</source> <volume>5</volume>: <fpage>281</fpage>–<lpage>299</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003029-Sethian1"><label>26</label><mixed-citation publication-type="other" xlink:type="simple">Sethian JA (1999) Level Set Methods and Fast Marching Methods: Evolving Interfaces in Computational Geometry, Fluid Mechanics, Computer Vision, and Materials Science. Cambridge University Press. 378 p.</mixed-citation></ref>
   </ref-list>
</back>
</article>