<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00303</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004343</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Automatic Prediction of Protein 3D Structures by Probabilistic Multi-template Homology Modeling</article-title>
<alt-title alt-title-type="running-head">Probabilistic Multi-template Homology Modeling</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Meier</surname> <given-names>Armin</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Söding</surname> <given-names>Johannes</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Quantitative and Computational Biology, Max Planck Institute for Biophysical Chemistry, Göttingen, Germany</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Gene Center, Ludwig-Maximilians-Universität München Munich, Munich, Germany</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ben-Tal</surname> <given-names>Nir</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Tel Aviv University, ISRAEL</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: JS AM. Analyzed the data: AM. Wrote the paper: JS AM.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">soeding@mpibpc.mpg.de</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>10</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>23</day>
<month>10</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>10</issue>
<elocation-id>e1004343</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>2</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>19</day>
<month>5</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Meier, Söding</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004343" xlink:type="simple"/>
<abstract>
<p>Homology modeling predicts the 3D structure of a query protein based on the sequence alignment with one or more template proteins of known structure. Its great importance for biological research is owed to its speed, simplicity, reliability and wide applicability, covering more than half of the residues in protein sequence space. Although multiple templates have been shown to generally increase model quality over single templates, the information from multiple templates has so far been combined using empirically motivated, heuristic approaches.</p>
<p>We present here a rigorous statistical framework for multi-template homology modeling. First, we find that the query proteins’ atomic distance restraints can be accurately described by two-component Gaussian mixtures. This insight allowed us to apply the standard laws of probability theory to combine restraints from multiple templates. Second, we derive theoretically optimal weights to correct for the redundancy among related templates. Third, a heuristic template selection strategy is proposed.</p>
<p>We improve the average GDT-<sc>ha</sc> model quality score by 11% over single template modeling and by 6.5% over a conventional multi-template approach on a set of 1000 query proteins. Robustness with respect to wrong constraints is likewise improved. We have integrated our multi-template modeling approach with the popular MODELLER homology modeling software in our free HHpred server <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://toolkit.tuebingen.mpg.de/hhpred">http://toolkit.tuebingen.mpg.de/hhpred</ext-link> and also offer open source software for running MODELLER with the new restraints at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="https://bitbucket.org/soedinglab/hh-suite">https://bitbucket.org/soedinglab/hh-suite</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Since a protein’s function is largely determined by its structure, predicting a protein’s structure from its amino acid sequence can be very useful to understand its molecular functions and its role in biological pathways. By far the most widely used computational approach for protein structure prediction relies on detecting a homologous relationship with a protein of known structure and using this protein as a template to model the structure of the query protein on it. The basic concepts of this homology modelling approach have not changed during the last 20 years. In this study we extend the probabilistic formulation of homology modelling to the consistent treatment of multiple templates. Our new theoretical approach allowed us to improve the quality of homology models by 11% over a baseline single-template approach and by 6.5% over a multi-template approach.</p>
</abstract>
<funding-group>
<funding-statement>This work was funded by the German Federal Ministry of Education and Research (BMBF) within the framework of e:Med (grant e:AtheroSysMed, 01ZX1313A-2014), by the Deutsche Forschungsgemeinschaft (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.dfg.de/en/">http://www.dfg.de/en/</ext-link>) grant numbers: GRK1721, SFB64 and by BioSysNet (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.biosysnet.de/">http://www.biosysnet.de/</ext-link>) to JS. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="3"/>
<page-count count="20"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>Data can be found in the supplemental files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Homology modeling is by far the most widely used computational approach to predict the 3D structures of proteins, and almost all protein structure prediction servers rely chiefly on homology modeling, as seen in the community-wide blind benchmark “Critical Assessment of Techniques for Protein Structure Prediction” (CASP) [<xref ref-type="bibr" rid="pcbi.1004343.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004343.ref003">3</xref>].</p>
<p>Homology modeling consists of four steps: (1) Finding homologous template proteins of known structure, (2) Selecting the best template or set of templates, (3) Optimizing the multiple sequence alignment (MSA) between query and template protein sequences, and (4) Building the homology model for the query sequence that resembles as closely as possible the structures of the templates, accommodating for deletions and insertions of query residues with respect to the template structures.</p>
<p>During the last 15 years, much progress has been made regarding the sequence-based steps 1 to 3. This is mainly owed to the development of more sensitive and accurate methods for sequence searching and alignment that compare sequence profiles or profile hidden Markov models (H<sc>mm</sc>s) with each other [<xref ref-type="bibr" rid="pcbi.1004343.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004343.ref006">6</xref>]. In contrast, improvements to the last step have been marginal. This is illustrated by the fact that, although a number of tools for protein homology modeling exist, to our knowledge all are older than 12 years (see [<xref ref-type="bibr" rid="pcbi.1004343.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1004343.ref008">8</xref>] for reviews). ModSeg/ENCAD [<xref ref-type="bibr" rid="pcbi.1004343.ref009">9</xref>] copies template coordinates and bridges gaps by short fragments that match the framework of the target structure. SWISS-MODEL [<xref ref-type="bibr" rid="pcbi.1004343.ref010">10</xref>] generates a core model by averaging template backbone atom positions. NEST [<xref ref-type="bibr" rid="pcbi.1004343.ref011">11</xref>] implements an artificial evolution algorithm where changes from the template structure such as substitutions, insertions and deletions are made one at a time, and each mutation is followed by an energy minimization. This process is repeated until the whole query is modeled.</p>
<p>These tools rely on of various heuristics. MODELLER [<xref ref-type="bibr" rid="pcbi.1004343.ref012">12</xref>], with 7500 citations clearly the most popular and according to two studies [<xref ref-type="bibr" rid="pcbi.1004343.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1004343.ref008">8</xref>] also the most successful homology modeling software to date, stands out by being based on a statistical approach to homology modeling. MODELLER is essentially unchanged at its core since its publication 22 years ago, while extensions such as refined energy functions [<xref ref-type="bibr" rid="pcbi.1004343.ref013">13</xref>] or loop modeling [<xref ref-type="bibr" rid="pcbi.1004343.ref014">14</xref>] have led to relatively minor improvements of its already excellent performance. We therefore believe M<sc>odeller</sc>’s success is owed to the consistent, statistical approach at its core.</p>
<p>M<sc>odeller</sc> proceeds in two steps: (1) Derive from the MSA and template structures a list of restraints and (2) find the model structure that minimizes the restraint violations. Each restraint is a probability density function. The most important class of template-dependent restraints are the probability density functions for the spatial distances of pairs of atoms in the query protein. The true distance <italic>d</italic> will be distributed around the distance <italic>d</italic><sub><italic>t</italic></sub> of the equivalent atoms in the template structure, where equivalent residues are those that are aligned to each other (<xref ref-type="fig" rid="pcbi.1004343.g001">Fig 1</xref>). MODELLER assumes for simplicity a Gaussian distribution for <italic>d</italic>. Its mean equals <italic>d</italic><sub><italic>t</italic></sub> and its standard deviation is predicted based on the sequence similarity between query and template. The restraint minimization in the second step amounts to a maximum likelihood optimization, where the likelihood is approximated as the product over the density functions of the individual restraints. This factorisation of the likelihood assumes that the individual restraints represent information independent of each other, because in probability theory the joint probability of two random variables (<italic>X</italic> and <italic>Y</italic>) is the product of their probabilities, <italic>p</italic>(<italic>X</italic>, <italic>Y</italic>) = <italic>p</italic>(<italic>X</italic>) <italic>p</italic>(<italic>Y</italic>), if and only if they are independent of each other. Although the assumption of independence of restraints sounds rather drastic, the approximation turned out to work well in practice.</p>
<fig id="pcbi.1004343.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004343.g001</object-id>
<label>Fig 1</label>
<caption>
<title>MODELLER’s statistical approach to homology modeling: The unknown distance <italic>d</italic> between two atoms in residues <italic>i</italic> and <italic>j</italic> of the query protein (Q) is described by a probability distribution Prob(<italic>d</italic>) that is peaked around the distance <italic>d</italic><sub><italic>t</italic></sub> between the corresponding atoms in residues <italic>i</italic>′ and <italic>j</italic>′ of the template protein (T).</title>
<p>This distribution Prob(<italic>d</italic>) is a probabilistic distance restraint for the distance <italic>d</italic>. To model a protein, tens to hundreds of thousands of such distance restraints between pairs of atoms in the query protein are derived. The product of all these restraint functions, which is called the likelihood function in statistics, quantifies how well a model structure satisfies all restraints at the same time. Therefore, the model structure that maximises the likelihood function represents the best solution.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.g001"/>
</fig>
<p>To aggregate the information from several templates, however, MODELLER does not multiply the density functions of all restraints as probability theory would suggest. Instead, it relies on an empirical observation that the distribution of the target distance informed by multiple template distances is multi-modal. Thus, MODELLER reverts to a heuristic approach and computes an additive mixture of the density functions, each derived from an individual template, to restrain a single target distance based on multiple templates.</p>
<p>Here, we develop a rigorous statistical treatment of multiple template homology modeling. We first show that the distance distributions for log(<italic>d</italic>) are very well described by two-component Gaussian mixture distributions. In contrast to MODELLER’s one-component densities, these two-component densities allow us to combine density functions by multiplication. Second, we derive an algorithm to compute weights that take the statistical dependence of the distance information from the templates into account. Third, we propose a heuristic scheme for template selection. We demonstrate that the new HHpred modeling pipeline and in particular the new constraints yield substantially improved model qualities.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec003">
<title>Modeling distance restraints</title>
<p>Our approach to multi-template homology modeling is based on the statistical approach to homology modeling introduced by M<sc>odeller</sc>. Our software computes improved spatial restraints and calls the M<sc>odeller</sc> software, which then reads in the restraints and finds a structure that optimally satisfies these restraints. We briefly recall M<sc>odeller</sc>’s approach of homology modeling here.</p>
<sec id="sec004">
<title>M<sc>odeller</sc>’s maximum likelihood approach to homology modeling</title>
<p>M<sc>odeller</sc> proceeds in two steps to compute a model structure for a query sequence that is aligned to a set of templates with known structures. In the first step, it generates a list of hundreds of thousands of restraints for the distance between pairs of atoms in the query, based on the distance of corresponding atoms in the templates. E.g. if residue <italic>i</italic> of the query <italic>q</italic> is aligned to residue <italic>i</italic>′ of a template <italic>t</italic> and similarly <italic>j</italic> is aligned to <italic>j</italic>′, then the distance <italic>d</italic> between the C<sub><italic>α</italic></sub> atoms of residues <italic>i</italic> and <italic>j</italic> in <italic>q</italic> will be restrained to be similar to the known distance <italic>d</italic><sub><italic>t</italic></sub> between the C<sub><italic>α</italic></sub> atoms of residues <italic>i</italic>′ and <italic>j</italic>′ in <italic>t</italic> (<xref ref-type="fig" rid="pcbi.1004343.g001">Fig 1</xref>). In statistics, a restraint is described as a probability density function <italic>p</italic>(<italic>d</italic>), and in M<sc>odeller</sc> this distance restraint is modelled by a Gaussian function with mean <italic>d</italic><sub><italic>t</italic></sub>. The standard deviation of the Gaussian describes the expected deviation of the distance <italic>d</italic> from <italic>d</italic><sub><italic>t</italic></sub>. Distance restraints are generated for each pair of residues (<italic>i</italic>, <italic>j</italic>) for which aligned residues <italic>i</italic>′ and <italic>j</italic>′ exist and for various combinations of atom types, for which equivalent atoms exist in the aligned template residues, e.g. C<sub><italic>α</italic></sub> − C<sub><italic>α</italic></sub>, N − O, C<sub><italic>α</italic></sub> − C<sub><italic>γ</italic></sub> etc.</p>
<p>In the second step, M<sc>odeller</sc> uses stochastic optimisation to find the model structure for the query sequence that maximises the likelihood. The likelihood is the probability of the data, i.e. the alignment and template structures, given the model structure. When a single template is used for modeling, M<sc>odeller</sc> approximates the likelihood as the product of the probability density functions over all restraints. Although this approximation corresponds to assuming the independence of all restraints, it has turned out to work well in practice.</p>
<p>Sali and Blundell [<xref ref-type="bibr" rid="pcbi.1004343.ref012">12</xref>] observed that the expected deviation <italic>d</italic> − <italic>d</italic><sub><italic>t</italic></sub> depended on (1) the fraction of identically aligned residues between the two sequences, (2) the average solvent accessibility of the two aligned residue pairs (<italic>i</italic>, <italic>i</italic>′) and (<italic>j</italic>, <italic>j</italic>′), (3) the average distance of <italic>i</italic>, <italic>i</italic>′, <italic>j</italic> and <italic>j</italic>′ from a gap, and (4) the distance <italic>d</italic><sub><italic>t</italic></sub>. They modelled the standard deviation of the Gaussian restraint as functions of the four discretized variables. To fit these functions, they analysed a large set of structurally aligned, homologous proteins for which they measured the distances <italic>d</italic> = <italic>d</italic><sub><italic>ij</italic></sub> and <italic>d</italic><sub><italic>t</italic></sub> = <italic>d</italic><sub><italic>i</italic>′<italic>j</italic>′</sub> between equivalent atoms in two pairs of structurally aligned residues, (<italic>i</italic>, <italic>i</italic>′) and (<italic>j</italic>, <italic>j</italic>′). Four different functions are trained, one for each of the following combinations of atom types: C<sub><italic>α</italic></sub> − C<sub><italic>α</italic></sub>, N − O, side chain—main chain, side chain—side chain.</p>
</sec>
<sec id="sec005">
<title>New distance restraints that account for alignment errors</title>
<p>Because the analysis in [<xref ref-type="bibr" rid="pcbi.1004343.ref012">12</xref>] relied on structurally alignable residue pairs in structure-based alignments, they were basically free of alignment errors and therefore the distance in the query was always similar to the distance in the template. In practice, the sequence alignment will contain errors and <italic>i</italic> and <italic>i</italic>′ (or <italic>j</italic> and <italic>j</italic>′) might not be homologous to each other. In this case, <italic>d</italic><sub><italic>t</italic></sub> does not contain information about <italic>d</italic> and may be vastly different. When the pairs of residues (<italic>i</italic>, <italic>i</italic>′) and (<italic>j</italic>, <italic>j</italic>′) are sampled from real sequence alignments, this may lead to a stark deviation of the distance distribution from a Gaussian.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004343.g002">Fig 2(A)–2(C)</xref> shows distributions of log(<italic>d</italic>) − log(<italic>d</italic><sub><italic>t</italic></sub>) for sets of residue pairs (<italic>i</italic>, <italic>i</italic>′) and (<italic>j</italic>, <italic>j</italic>′) sampled from alignments with successively lower quality. In <xref ref-type="fig" rid="pcbi.1004343.g002">Fig 2A</xref> only very reliable alignments have been sampled, with a posterior probability (pp) for (<italic>i</italic>, <italic>i</italic>′) and (<italic>j</italic>, <italic>j</italic>′) to be correctly aligned larger than 0.9 and with a sequence similarity (sim) above 0.75 bits per aligned pair. (See the Supporting Information for the definition of pp and sim.) Consequently, the empirical density distribution over log(<italic>d</italic>) − log(<italic>d</italic><sub><italic>t</italic></sub>) has a single peak and is well fitted by a single Gaussian. However, when the alignment quality deteriorates, as shown in <xref ref-type="fig" rid="pcbi.1004343.g002">Fig 2B and 2C</xref>, a second component in the distribution manifests itself. It stems from residues (<italic>i</italic>, <italic>i</italic>′) and (<italic>j</italic>, <italic>j</italic>′) for which either (<italic>i</italic>, <italic>i</italic>′) or (<italic>j</italic>, <italic>j</italic>′) or both are not homologous. These data points thus contribute a background distribution that does not depend on the distance <italic>d</italic><sub><italic>t</italic></sub> in the template.</p>
<fig id="pcbi.1004343.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004343.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Empirical log distance distributions between pairs of atoms are well modelled by a two-component Gaussian mixture composed of a signal component and a background component.</title>
<p>The background component originates from pairs of residues with an alignment error. The plots show the empirical distribution of log <italic>d</italic> − log <italic>d</italic><sub><italic>t</italic></sub> = log <italic>d</italic><sub><italic>ij</italic></sub> − log <italic>d</italic><sub><italic>i</italic>′<italic>j</italic>′</sub> for thousands of sampled pairs of residues (<italic>i</italic>, <italic>i</italic>′), (<italic>j</italic>, <italic>j</italic>′) from real, error-containing pairwise sequence alignments generated with HH<sc>align</sc> [<xref ref-type="bibr" rid="pcbi.1004343.ref015">15</xref>]. The two-component Gaussian mixture distribution predicted by the mixture density network in <xref ref-type="fig" rid="pcbi.1004343.g003">Fig 3B</xref> is plotted in red. From (<bold>A</bold>) to (<bold>C</bold>), the reliability of the alignments at (<italic>i</italic>, <italic>i</italic>′) and (<italic>j</italic>, <italic>j</italic>′) (as measured by pp and sim values) decreases. Consequently, the weight of the background component increases at the expense of the signal component. (<bold>D</bold>) Same as (C) but showing the distribution of N − O distances instead of C<sub><italic>α</italic></sub> − C<sub><italic>α</italic></sub> distances.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.g002"/>
</fig>
<p>These observations motivated us to model the restraint function <italic>p</italic>(log <italic>d</italic>∣ log <italic>d</italic><sub><italic>t</italic></sub>, pp, sim) = <italic>p</italic>(log <italic>d</italic>∣<italic>θ</italic>) using a two-component Gaussian mixture distribution (see <xref ref-type="fig" rid="pcbi.1004343.g003">Fig 3A</xref>) whose means, standard deviations and mixture weight <italic>w</italic> depend on <italic>θ</italic> = (log <italic>d</italic><sub><italic>t</italic></sub>, pp, sim) or <italic>θ</italic>′ = (pp, sim):
<disp-formula id="pcbi.1004343.e001"><alternatives><graphic id="pcbi.1004343.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:mi>μ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mtext>correctly</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>aligned</mml:mtext></mml:mrow></mml:munder> <mml:mspace width="0.277778em"/><mml:mo>+</mml:mo> <mml:mspace width="0.277778em"/><mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mtext>bg</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mtext>bg</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mtext>alignment</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>errors</mml:mtext></mml:mrow></mml:munder></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
The mixture weight <italic>w</italic>(<italic>θ</italic>) can be regarded as the probability that both (<italic>i</italic>, <italic>i</italic>′) and (<italic>j</italic>, <italic>j</italic>′) are correctly aligned. Locally unreliable alignments will lead to a stronger background component and hence to softer distance restraints. Note that, because distances cannot be negative, they are not well modelled by Gaussian distributions, whose left tail can penetrate into the negative domain. We therefore modeled the distribution of log <italic>d</italic> instead of <italic>d</italic>.</p>
<fig id="pcbi.1004343.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004343.g003</object-id>
<label>Fig 3</label>
<caption>
<p>(<bold>A</bold>) Illustration of the two-component Gaussians mixture distribution in <xref ref-type="disp-formula" rid="pcbi.1004343.e001">Eq (1)</xref>. (<bold>B</bold>) Mixture density network to predict the parameters (<italic>w</italic>, <italic>μ</italic>, <italic>σ</italic>, <italic>μ</italic><sub>bg</sub>, <italic>σ</italic><sub>bg</sub>) of the Gaussian mixture distribution given the three variables <italic>θ</italic> = (log <italic>d</italic><sub><italic>t</italic></sub>, pp, sim) (<italic>d</italic><sub><italic>t</italic></sub>: distance in template, pp: posterior probability for both aligned residue pairs to be correctly aligned, sim: sequence similarity). Since the background component does not depend on <italic>d</italic><sub><italic>t</italic></sub>, the nodes for <italic>μ</italic><sub>bg</sub> and <italic>σ</italic><sub>bg</sub> are only connected to the two lowest hidden nodes that are not connected to log <italic>d</italic><sub><italic>t</italic></sub>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.g003"/>
</fig>
</sec>
<sec id="sec006">
<title>Mixture density networks</title>
<p>To predict the five parameters of the Gaussians mixture distribution in <xref ref-type="disp-formula" rid="pcbi.1004343.e001">Eq (1)</xref>, we trained four mixture density networks [<xref ref-type="bibr" rid="pcbi.1004343.ref016">16</xref>], one for each combination of atom types listed above. A mixture density network is a special kind of neural network that learns the optimum adaptive functions for predicting the parameters of a Gaussian mixture distribution. It is trained by maximizing the likelihood of a set of training data that consists of the input features together with the value log <italic>d</italic> whose distribution should be learned. We used the R package <monospace>netlabR</monospace> to implement a mixture density network with five hidden nodes as illustrated in <xref ref-type="fig" rid="pcbi.1004343.g003">Fig 3(B)</xref>. As input features we used <italic>θ</italic> = (log <italic>d</italic><sub><italic>t</italic></sub>, pp, sim). The local alignment quality pp(<italic>i</italic>, <italic>j</italic>) and the global BLOSUM62 sequence similarity sim are parsed from the output of HH<sc>align</sc> in the hh-suite package [<xref ref-type="bibr" rid="pcbi.1004343.ref015">15</xref>], a widely used software for remote homology detection and sequence alignment (see <xref ref-type="fig" rid="pcbi.1004343.g008">Fig 8</xref>, green points). The set of three features was obtained by starting from a more redundant set of alignment features described in Table B in <xref ref-type="supplementary-material" rid="pcbi.1004343.s001">S1 Text</xref> and successively eliminating features whose omission did not significantly deteriorate the likelihood on the training set (in particular probability and raw score).</p>
</sec>
<sec id="sec007">
<title>Combining restraints from multiple templates</title>
<p>When several templates cover residues <italic>i</italic> and <italic>j</italic> of the query, the restraints on the distance <italic>d</italic> of atoms in residues <italic>i</italic> and <italic>j</italic> from those templates have to be combined. Multiplying the restraint functions as probability theory would suggest (see below) would not work in M<sc>odeller</sc>’s case. When one of the restraints is wrong due to an alignment error, for instance, the restraint function of the incorrect restraint would severely distort the model structure, because the probability density of its single-component Gaussian falls off very fast for increasing distance from its mean, which effectively forbids any gross violation of the restraint. Therefore, M<sc>odeller</sc> resorts to a heuristic to estimate the probability density <italic>p</italic>(<italic>d</italic>∣<italic>d</italic><sub>1</sub>, <italic>d</italic><sub>2</sub>) resulting from the restraints of two templates <italic>t</italic><sub>1</sub>, <italic>t</italic><sub>2</sub> with corresponding distances <italic>d</italic><sub>1</sub> and <italic>d</italic><sub>2</sub>: It adds both probability densities <italic>p</italic>(<italic>d</italic>∣<italic>d</italic><sub>1</sub>) and <italic>p</italic>(<italic>d</italic>∣<italic>d</italic><sub>2</sub>) (<xref ref-type="fig" rid="pcbi.1004343.g004">Fig 4A</xref>) using some weights:
<disp-formula id="pcbi.1004343.e002"><alternatives><graphic id="pcbi.1004343.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e002"/><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
Here <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> measure the average sequence similarity in the sequence neighbourhoods around the two pairs of aligned residues from <italic>q</italic> and <italic>t</italic><sub>1</sub> and from <italic>q</italic> and <italic>t</italic><sub>2</sub>, respectively. The optimum functions <italic>α</italic>(<italic>s</italic><sub>1</sub>), <italic>α</italic>(<italic>s</italic><sub>2</sub>) were found by training on a large number of structurally aligned triplets of proteins <italic>q</italic>, <italic>t</italic><sub>1</sub>, <italic>t</italic><sub>2</sub> [<xref ref-type="bibr" rid="pcbi.1004343.ref012">12</xref>].</p>
<fig id="pcbi.1004343.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004343.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Comparison of how restraints from multiple templates are combined in M<sc>odeller</sc> (top row) and in our new approach (bottom row).</title>
<p><bold>(A)</bold> In M<sc>odeller</sc>, two restraints functions (green and blue) are additively mixed with mixing weights that have to be learned on a set of triples of aligned protein structures. <bold>(B)</bold> Our new restraints are multiplied instead of being added. The background component ensures that the restraint function becomes constant and the restraint thus becomes inactive (i.e. ignored) when the distance <italic>d</italic> is far from the distance in the template. <bold>(C)</bold> M<sc>odeller</sc>’s additive mixing leads to a total restraint function that is wider than any of the single-template restraints, not narrower as it should. <bold>(D)</bold> The multiplication of restraints functions according to probability theory leads to the desired behaviour of the total restraint function becoming more pointed with each restraint. Note that our new restraints are expressed as odds instead of densities (see also <xref ref-type="disp-formula" rid="pcbi.1004343.e007">Eq 6</xref>).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.g004"/>
</fig>
<p>This heuristic approach leads to undesirable behaviour, as illustrated in <xref ref-type="fig" rid="pcbi.1004343.g004">Fig 4A and 4C</xref>. According to elementary statistical principles, a restraint function for a distance <italic>d</italic> based on restraints from multiple templates should contain more information and be more sharply resolved than any single-template restraint function. However, the additive mixture density restraint in <xref ref-type="disp-formula" rid="pcbi.1004343.e002">Eq (2)</xref> is wider, not narrower, than any single restraint.</p>
<p>The new two-component distance restraints allow us to apply the rules of probability to combine the information from the two templates. By Bayes’ theorem we obtain
<disp-formula id="pcbi.1004343.e003"><alternatives><graphic id="pcbi.1004343.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e003"/><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
If the information in the templates was approximately conditionally independent given <italic>d</italic>, i.e., <italic>p</italic>(<italic>d</italic><sub>1</sub>, <italic>d</italic><sub>2</sub>∣<italic>d</italic>) ≈ <italic>p</italic>(<italic>d</italic><sub>1</sub>∣<italic>d</italic>) <italic>p</italic>(<italic>d</italic><sub>2</sub>∣<italic>d</italic>) we would obtain
<disp-formula id="pcbi.1004343.e004"><alternatives><graphic id="pcbi.1004343.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e004"/><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>≈</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where Bayes’ theorem was applied to each factor in the second step.</p>
<p>In practice, the query and templates are related to each other through evolution along phylogenetic trees, and conditional independence cannot be assumed. We therefore approximate the dependence among the templates by weighting their odds ratios, with weights <italic>w</italic><sub><italic>k</italic></sub> ∈ [0, 1]. This method is analogous to weighting sequences according to their similarity with other sequences in a multiple sequence alignment in order to compute a sequence profile [<xref ref-type="bibr" rid="pcbi.1004343.ref017">17</xref>] or some other family-dependent features [<xref ref-type="bibr" rid="pcbi.1004343.ref018">18</xref>]. We will derive a method to determine optimal template-specific weights <italic>w</italic><sub><italic>k</italic></sub> in the following subsection. The previous formula can then be generalised to <italic>K</italic> templates, giving
<disp-formula id="pcbi.1004343.e005"><alternatives><graphic id="pcbi.1004343.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e005"/><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>≈</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
Here, <italic>p</italic>(<italic>d</italic>) is the probability independent of any template, i.e., the background distribution <inline-formula id="pcbi.1004343.e006"><alternatives><graphic id="pcbi.1004343.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e006"/><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mtext>bg</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mtext>bg</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. According to <xref ref-type="disp-formula" rid="pcbi.1004343.e001">Eq (1)</xref>, the restraint functions are now (for the sake of brevity we omit <italic>θ</italic> and <italic>θ</italic>′)
<disp-formula id="pcbi.1004343.e007"><alternatives><graphic id="pcbi.1004343.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e007"/><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>w</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mtext>bg</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mtext>bg</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>w</mml:mi> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mtext>bg</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mtext>bg</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mspace width="-0.166667em"/><mml:mo>-</mml:mo> <mml:mi>w</mml:mi> <mml:mspace width="-0.166667em"/><mml:mo>+</mml:mo> <mml:mi>w</mml:mi> <mml:mfrac><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mtext>bg</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mtext>bg</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula></p>
<p>Note that the ratio of the two Gaussians is again a Gaussian, because subtracting two quadratic functions of <italic>d</italic> again yields a quadratic function. <xref ref-type="fig" rid="pcbi.1004343.g004">Fig 4B and 4D</xref> illustrate how restraints from multiple templates are combined under our new statistical approach and that this leads to the expected desirable behaviour of the total restraint restraining more strongly than the one-component restraints.</p>
<p>Dividing by the background has two effects: first, it prevents the background to become dominant when the individual background components of all <italic>P</italic>(<italic>d</italic>∣<italic>d</italic><sub><italic>k</italic></sub>) are multiplied. Second, the negative logarithm of M<sc>odeller</sc>’s distance restraint is quadratic in <italic>d</italic>, and hence unsatisfiable restraints can lead to extreme values during optimization. Dividing by the background avoids this quadratic increase because <italic>P</italic>(<italic>d</italic>∣<italic>d</italic><sub><italic>k</italic></sub>)/<italic>P</italic>(<italic>d</italic>) has flat tails where it approaches a constant (1 − <italic>w</italic>). In cases of incorrect alignments with a wrong distance <italic>d</italic><sub><italic>t</italic></sub> in the template, the restraint will not disrupt the query’s model structure as <italic>d</italic> will be pulled away from <italic>d</italic><sub><italic>t</italic></sub> into the flat region of the restraint. Combining two component distance restraints as shown in <xref ref-type="fig" rid="pcbi.1004343.g004">Fig 4D</xref> thus reinforces consistent restraints while avoiding distortions from incorrect restraints.</p>
</sec>
<sec id="sec008">
<title>Running M<sc>odeller</sc> with the new distance restraints</title>
<p>After having picked a set of templates, we run the M<sc>odeller</sc> (version 9.10) <monospace>automodel.homcsr(0)</monospace> command that generates a file with the list of restraints from the query-template alignment. We parse the list of restraints and replace each template-dependent distance constraint (which is either a Gaussian function for a single-template restraint or a Gaussian mixture for a multi-template restraint) with a set of our own distance restraints, one for each template. For this purpose, we added a restraint function that computes the logarithm of <xref ref-type="disp-formula" rid="pcbi.1004343.e007">Eq (6)</xref> to M<sc>odeller</sc>. All template-independent restraints such as main chain and side chain dihedral angle restraints, bond lengths etc. are left unchanged. We run M<sc>odeller</sc> with the modified restraints list to generate a 3D model.</p>
</sec>
</sec>
<sec id="sec009">
<title>Template weighting</title>
<sec id="sec010">
<title>Motivation</title>
<p>As a motivation for the template weighting scheme, consider the case shown in <xref ref-type="fig" rid="pcbi.1004343.g005">Fig 5A</xref>. Giving all three templates the same weight ignores the dependencies described by the tree [<xref ref-type="bibr" rid="pcbi.1004343.ref018">18</xref>]. Template <italic>t</italic><sub>3</sub> should get a weight of 1, since conditioned on <italic>q</italic> it is independent of the other two templates. But templates <italic>t</italic><sub>1</sub> and <italic>t</italic><sub>2</sub> should get weights clearly smaller than 1, since they do not contribute independent information to <italic>d</italic>. On the other hand, they are not identical and hence should receive a weight clearly larger than 0.5. But how do we compute the exact optimum weights <italic>w</italic><sub><italic>k</italic></sub> for templates 1, …, <italic>K</italic> given a phylogenetic tree with known edge lengths?</p>
<fig id="pcbi.1004343.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004343.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Iterative scheme for computing weights for templates by transforming the phylogenetic tree connecting them and the query protein into an equivalent tree with star-like topology with the query in the center.</title>
<p><bold>(A)</bold> Templates <italic>t</italic><sub>1</sub> and <italic>t</italic><sub>2</sub> are closely related and should be down-weighted with respect to <italic>t</italic><sub>3</sub>. <bold>(B)</bold> Any tree <inline-formula id="pcbi.1004343.e008"><alternatives><graphic id="pcbi.1004343.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e008"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mi mathvariant="script">T</mml:mi></mml:math></alternatives></inline-formula> with a structure at an internal node with unknown distance <italic>d</italic><sub><italic>h</italic></sub> to which all templates are connected in a star-like topology (top) can be transformed into an equivalent tree <inline-formula id="pcbi.1004343.e009"><alternatives><graphic id="pcbi.1004343.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e009"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">T</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:math></alternatives></inline-formula> (bottom) with star-like topology, where equivalence means that the restraint on the distance <italic>d</italic><sub>0</sub> of the top node is the same for both trees. <italic>τ</italic><sub>1</sub>, … <italic>τ</italic><sub><italic>K</italic></sub> indicate evolutionary distances. <bold>(C)</bold> Iterative restructuring of a phylogenetic tree. In each step, the basic transformation from <xref ref-type="fig" rid="pcbi.1004343.g005">Fig 5B</xref> is applied to the subtree colored in blue. Weights and edge lengths get updated until all templates are directly connected to the query.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.g005"/>
</fig>
</sec>
<sec id="sec011">
<title>Iterative restructuring</title>
<p>We begin by rooting the phylogenetic tree at the query, and giving its leaf nodes initial weights of 1. By iteratively applying the elementary step in <xref ref-type="fig" rid="pcbi.1004343.g005">Fig 5B</xref> to subtrees, we can transform a tree with arbitrary topology into a tree with a star-like topology, as shown in <xref ref-type="fig" rid="pcbi.1004343.g005">Fig 5C</xref>. At each step, one inner node is removed and the procedure continues until all template leaves are directly connected to the query. At each step, we simply need to update the template weights to obtain the final weights <italic>w</italic><sub><italic>k</italic></sub> for the star-like tree. In the star-like tree which we finally obtain, all template distances <italic>d</italic><sub><italic>k</italic></sub> are conditionally independent, and hence we obtain for the odds ratio the result in <xref ref-type="disp-formula" rid="pcbi.1004343.e005">Eq 5</xref>, using the final weights <italic>w</italic><sub><italic>k</italic></sub> from this iterative process.</p>
</sec>
<sec id="sec012">
<title>Elementary step</title>
<p>For the elementary step, we will show that the upper (sub)tree <inline-formula id="pcbi.1004343.e010"><alternatives><graphic id="pcbi.1004343.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e010"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mi mathvariant="script">T</mml:mi></mml:math></alternatives></inline-formula> in <xref ref-type="fig" rid="pcbi.1004343.g005">Fig 5B</xref> yields exactly the same odds ratio for <italic>d</italic><sub>0</sub> as the transformed, star-topology tree <inline-formula id="pcbi.1004343.e011"><alternatives><graphic id="pcbi.1004343.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e011"/><mml:math id="M11" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">T</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:math></alternatives></inline-formula> below,
<disp-formula id="pcbi.1004343.e012"><alternatives><graphic id="pcbi.1004343.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e012"/><mml:math id="M12" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>…</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>…</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mi>K</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="script">T</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
if the new weights <inline-formula id="pcbi.1004343.e013"><alternatives><graphic id="pcbi.1004343.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e013"/><mml:math id="M13" display="inline" overflow="scroll"><mml:msubsup><mml:mi>w</mml:mi> <mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> are chosen according to
<disp-formula id="pcbi.1004343.e014"><alternatives><graphic id="pcbi.1004343.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e014"/><mml:math id="M14" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi> <mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
The updated weights are proportional to the old <italic>w</italic><sub><italic>k</italic></sub> with a proportionality factor approaching 1 for <italic>τ</italic><sub>0</sub> ≪ <italic>τ</italic><sub><italic>k</italic></sub>. The sum of weights over all <italic>K</italic> templates is <inline-formula id="pcbi.1004343.e015"><alternatives><graphic id="pcbi.1004343.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e015"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which goes to 1 for <italic>τ</italic><sub>0</sub> ≫ max{<italic>τ</italic><sub><italic>k</italic></sub>}, signifying that in this case the information in the templates is completely redundant.</p>
<p>To show that the odds ratio in <xref ref-type="disp-formula" rid="pcbi.1004343.e012">Eq (7)</xref> is conserved when transforming the tree <inline-formula id="pcbi.1004343.e016"><alternatives><graphic id="pcbi.1004343.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e016"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mi mathvariant="script">T</mml:mi></mml:math></alternatives></inline-formula> into <inline-formula id="pcbi.1004343.e017"><alternatives><graphic id="pcbi.1004343.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e017"/><mml:math id="M17" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">T</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:math></alternatives></inline-formula> in <xref ref-type="fig" rid="pcbi.1004343.g005">Fig 5B</xref>, we integrate over the unknown, hidden distance <italic>d</italic><sub><italic>h</italic></sub>,
<disp-formula id="pcbi.1004343.e018"><alternatives><graphic id="pcbi.1004343.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e018"/><mml:math id="M18" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>…</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>h</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>h</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>d</mml:mi> <mml:mn>1</mml:mn> <mml:mo>…</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi>d</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>h</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
and apply <xref ref-type="disp-formula" rid="pcbi.1004343.e005">Eq (5)</xref> to the second term in the integrand,
<disp-formula id="pcbi.1004343.e019"><alternatives><graphic id="pcbi.1004343.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e019"/><mml:math id="M19" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>…</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>…</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>h</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>h</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>h</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msup> <mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>d</mml:mi> <mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula></p>
<p>We now make the very reasonable assumption that the evolution of the distance between pairs of atoms manifests diffusive behaviour. This behaviour results if the change in distance can be modelled by many small, independent changes, each change being the consequence of a sequence mutation that will slightly change the protein structure. Concretely, this means the probability of observing a distance <italic>d</italic><sub><italic>l</italic></sub> after an evolutionary time <italic>τ</italic><sub><italic>kl</italic></sub>, when in the ancestor the distance was <italic>d</italic><sub><italic>k</italic></sub>, is given by
<disp-formula id="pcbi.1004343.e020"><alternatives><graphic id="pcbi.1004343.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e020"/><mml:math id="M20" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>γ</mml:mi> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
with some rate constant <italic>γ</italic>. Note that at time <italic>τ</italic><sub><italic>kl</italic></sub> = 0 the standard deviation vanishes and the right hand-side becomes equal to the delta functional, as it should. Substituting the conditional probabilities in the integral with these expressions, we see that the integral is over a product of Gaussians and can be solved analytically by the method of completing the square (see Suppl. Material). This results in a Gaussian distribution which is shown in the Supporting Information to be equivalent to the tree <inline-formula id="pcbi.1004343.e021"><alternatives><graphic id="pcbi.1004343.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e021"/><mml:math id="M21" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">T</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:math></alternatives></inline-formula> with transformed weights <inline-formula id="pcbi.1004343.e022"><alternatives><graphic id="pcbi.1004343.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e022"/><mml:math id="M22" display="inline" overflow="scroll"><mml:msubsup><mml:mi>w</mml:mi> <mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> given by <xref ref-type="disp-formula" rid="pcbi.1004343.e014">Eq (8)</xref>.</p>
<p>For simplicity, we use the UPGMA algorithm [<xref ref-type="bibr" rid="pcbi.1004343.ref019">19</xref>] to construct the initial tree <inline-formula id="pcbi.1004343.e023"><alternatives><graphic id="pcbi.1004343.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e023"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mi mathvariant="script">T</mml:mi></mml:math></alternatives></inline-formula>. The distances are computed as dist(<italic>t</italic><sub><italic>k</italic></sub>, <italic>t</italic><sub><italic>l</italic></sub>) = −log(TMscore<sub>pred</sub>(<italic>t</italic><sub><italic>k</italic></sub>, <italic>t</italic><sub><italic>l</italic></sub>)), where TMscore<sub>pred</sub> is the TM<sc>score</sc> [<xref ref-type="bibr" rid="pcbi.1004343.ref020">20</xref>] predicted by a neural network similar to the one in the next subsection (Supplemental Fig. S1), but without the experimental resolution as input feature. The tree constructed in this way is subsequently rearranged so that the query <italic>q</italic> is at its root.</p>
<p>Note that by its construction the final tree with star-like topology has the same edge lengths between the query and any template as the real tree. This is important, since the restraint function for template <italic>t</italic><sub><italic>k</italic></sub> from the mixture density network depends on the similarity between <italic>q</italic> and <italic>t</italic><sub><italic>k</italic></sub>. In order for the new star-like tree to be equivalent to the real one, it has to represent the same pairwise <italic>q</italic> − <italic>t</italic><sub><italic>k</italic></sub> similarities as the real tree.</p>
</sec>
</sec>
<sec id="sec013">
<title>Template selection</title>
<sec id="sec014">
<title>Single template selection</title>
<p>HH<sc>search</sc> ranks templates by the probability <italic>P</italic><sub>hom</sub> for the template to be homologous to the query protein. To pick the template best-suited for homology modeling, we trained a simple neural network with three hidden nodes (Supplemental Fig. S1) on the training set (see <xref ref-type="sec" rid="sec016">Results</xref>). The network predicts the TM<sc>score</sc> [<xref ref-type="bibr" rid="pcbi.1004343.ref020">20</xref>] of the model built with the query-template alignment, given various alignment features described in Table B in <xref ref-type="supplementary-material" rid="pcbi.1004343.s001">S1 Text</xref>. The idea is similar to [<xref ref-type="bibr" rid="pcbi.1004343.ref021">21</xref>], who proposed a neural network (NN) for picking the first template. We tried several feature combinations and, similar to previous work described in [<xref ref-type="bibr" rid="pcbi.1004343.ref022">22</xref>], found that the following features yielded the best results: HH<sc>search</sc> raw score, secondary structure similarity score divided by query length, expected number of correctly aligned target residues divided by query length, resolution of template structure in Angstroms. For each query, we picked the protein with highest predicted TM<sc>score</sc> among all proteins found by HH<sc>search</sc> as the first template.</p>
</sec>
<sec id="sec015">
<title>Multiple template selection</title>
<p>Picking the right set of templates for homology modeling is a difficult problem. The main beneficial effect of adding more templates is to increase the number of residues for which distance restraints can be generated [<xref ref-type="bibr" rid="pcbi.1004343.ref007">7</xref>]. However, picking too many templates can decrease the model quality because, as we discussed in the context of how M<sc>odeller</sc>’s restraints work, even a single bad template that gives rise to wrong distance restraints can severely distort the resulting 3D model.</p>
<p>To our knowledge, no theoretically well founded strategy for multi-template protein homology modeling has been developed so far, which contrasts with its widespread use in virtually every successful prediction pipeline. Contrary to single template selection, picking further templates is fundamentally complicated by complex dependencies between all selected structures. Current methods are therefore based on heuristics [<xref ref-type="bibr" rid="pcbi.1004343.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1004343.ref025">25</xref>]. Some methods [<xref ref-type="bibr" rid="pcbi.1004343.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004343.ref027">27</xref>] build a set of models based on several different template lists and then post-select a final model according to some quality measure [<xref ref-type="bibr" rid="pcbi.1004343.ref028">28</xref>].</p>
<p>As a simple baseline approach to multiple template selection, we employ the network of the previous section to select the first template. Further templates are added if 1) their predicted TM<sc>score</sc> is at least 90% of the first template, 2) they are structurally similar to the first template (TM<sc>align</sc> score &gt; 0.7) and 3) all selected templates are structurally similar to each other (pairwise TM<sc>align</sc> score &gt; 0.8).</p>
<p>Next, we propose here a heuristic method which aims to optimise the trade-off between increasing the query sequence coverage and decreasing the restraint quality of already covered residues due to adding more diverged templates with less reliable alignments.</p>
<p>We select the set of templates from among the top 100 found by HH<sc>search</sc> in the following way (<xref ref-type="fig" rid="pcbi.1004343.g006">Fig 6</xref>). The first template <italic>t</italic><sub>1</sub> is selected by the neural network that predicts the TM<sc>score</sc>. For each template in the template list <inline-formula id="pcbi.1004343.e024"><alternatives><graphic id="pcbi.1004343.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e024"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mi mathvariant="script">L</mml:mi></mml:math></alternatives></inline-formula> (lower dashed box in the figure) a score <italic>S</italic>(<italic>t</italic>) in (see <xref ref-type="disp-formula" rid="pcbi.1004343.e034">Eq 14</xref>) is (re)calculated that rewards a high coverage while penalising the addition of templates whose alignment quality is worse than that of already selected templates. The template with highest score (<italic>t</italic><sub>4</sub> in <xref ref-type="fig" rid="pcbi.1004343.g006">Fig 6</xref>) is added to the selected set if its score is still positive. The process is iterated until no template is left in <inline-formula id="pcbi.1004343.e025"><alternatives><graphic id="pcbi.1004343.e025g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e025"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mi mathvariant="script">L</mml:mi></mml:math></alternatives></inline-formula> that has a positive score.</p>
<fig id="pcbi.1004343.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004343.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Selection of multiple templates.</title>
<p>
<inline-formula id="pcbi.1004343.e026">
<alternatives>
<graphic id="pcbi.1004343.e026g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e026"/>
<mml:math id="M26" display="inline" overflow="scroll">
<mml:msub>
<mml:mi mathvariant="script">T</mml:mi>
<mml:mtext>acc</mml:mtext>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula> is the set of accepted templates, <inline-formula id="pcbi.1004343.e027"><alternatives><graphic id="pcbi.1004343.e027g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e027"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mi mathvariant="script">L</mml:mi></mml:math></alternatives></inline-formula> is the set of template candidates. For each template in <inline-formula id="pcbi.1004343.e028"><alternatives><graphic id="pcbi.1004343.e028g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e028"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mi mathvariant="script">L</mml:mi></mml:math></alternatives></inline-formula>, its score is calculated according to <xref ref-type="disp-formula" rid="pcbi.1004343.e034">Eq (14)</xref> and the template with the highest score (<italic>t</italic><sub>4</sub>) is added to <inline-formula id="pcbi.1004343.e029"><alternatives><graphic id="pcbi.1004343.e029g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e029"/><mml:math id="M29" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mtext>acc</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>. This process is iterated until there is no more template with a positive score, or <inline-formula id="pcbi.1004343.e030"><alternatives><graphic id="pcbi.1004343.e030g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e030"/><mml:math id="M30" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mtext>acc</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> contains more than 8 templates.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.g006"/>
</fig>
<p>To calculate the score <italic>S</italic>(<italic>t</italic>) (see <xref ref-type="disp-formula" rid="pcbi.1004343.e034">Eq 14</xref> below), we first define the local quality score,
<disp-formula id="pcbi.1004343.e031"><alternatives><graphic id="pcbi.1004343.e031g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e031"/><mml:math id="M31" display="block" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi mathvariant="normal">h</mml:mi> <mml:mi>o</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>◇</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
which is simply the product of the probability <italic>P</italic><sub>hom</sub> that template <italic>t</italic> is homologous to <italic>q</italic> times the probability <italic>p</italic>(<italic>i</italic> ◇ <italic>i</italic>′∣<italic>q</italic>, <italic>t</italic>) that residue <italic>i</italic> from <italic>q</italic> is homologous (i.e. correctly aligned) to residue <italic>i</italic>′ in <italic>t</italic>. The latter probability is estimated by HH<sc>align</sc> and HH<sc>search</sc> by a Forward-Backward algorithm. The local improvement (or impairment) of <italic>s</italic>(<italic>i</italic>, <italic>t</italic>) with respect to the best local score <italic>s</italic>(<italic>i</italic>, <italic>t</italic>′) among already selected templates <inline-formula id="pcbi.1004343.e032"><alternatives><graphic id="pcbi.1004343.e032g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e032"/><mml:math id="M32" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mtext>acc</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is
<disp-formula id="pcbi.1004343.e033"><alternatives><graphic id="pcbi.1004343.e033g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e033"/><mml:math id="M33" display="block" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:munder><mml:mo movablelimits="true" form="prefix">max</mml:mo> <mml:mrow><mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mtext>acc</mml:mtext></mml:msub></mml:mrow></mml:munder> <mml:mrow><mml:mo>{</mml:mo> <mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
To weight the positive values more strongly than the negative ones, we apply the exponential function to Δ<italic>s</italic>(<italic>i</italic>, <italic>t</italic>), subtract a per-residue threshold <italic>β</italic> and sum over all aligned residue pairs (<italic>i</italic>, <italic>i</italic>′) in the alignment <italic>A</italic>(<italic>q</italic>, <italic>t</italic>) between <italic>q</italic> and <italic>t</italic>:
<disp-formula id="pcbi.1004343.e034"><alternatives><graphic id="pcbi.1004343.e034g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004343.e034"/><mml:math id="M34" display="block" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mrow><mml:mo>[</mml:mo> <mml:mspace width="0.277778em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>s</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mi>β</mml:mi> <mml:mspace width="0.277778em"/><mml:mo>]</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
The parameters <italic>α</italic> and <italic>β</italic> influence the degree of non-linearity and greediness of the selection, respectively. They were optimised with a simple grid search on the optimisation set as explained in the Results section.</p>
</sec>
</sec>
</sec>
<sec id="sec016" sec-type="results">
<title>Results</title>
<sec id="sec017">
<title>Benchmark sets</title>
<p>We filtered the sequences from the PDB database of protein structures (May 2010) down to 20% and 70% maximum pairwise sequence identity and a minimal pairwise E-Value of 0.1 (using scripts <monospace>pdb2fasta.pl</monospace> and <monospace>pdbfilter.pl</monospace> in the HH<sc>suite</sc> package v2.0.16). For all sequences in the resulting pdb20 and pdb70 databases, we built multiple sequence alignments (MSAs) with our sensitive, iterative sequence search tool HH<sc>blits</sc> (v2.0.16) that is based on the pairwise alignment of profile hidden Markov models (H<sc>mm</sc>s) [<xref ref-type="bibr" rid="pcbi.1004343.ref015">15</xref>]. We used standard HH<sc>blits</sc> parameters with three search iterations against the uniprot20 database to get sufficiently diverse MSAs that are well suited to detect even remotely homologous proteins. The query sequences were picked from among the pdb20, and the template database was obtained from the pdb70 as explained below.</p>
<p>We extracted three disjoint query sets from the pdb20, a test, a training and an optimization set, with 1000, 1000, and 500 proteins, respectively. To achieve a good balance of easier and more challenging queries for modeling, we aimed to obtain the same distribution of query-template sequence identities as for the 108 queries in the CASP7 experiment shown in Supplemental Fig. S2 (which is similar to the distribution in CASP11, see Fig. S2). We computed the total amount of queries needed in each sequence identity bin (0%–5%, 5%–10%, …, 95%–100%). We then randomly picked query sequences from the pdb20 without replacement. For each picked query, we searched for possible templates in the pdb70 database and found the template most structurally similar to <italic>q</italic> according to TM<sc>align</sc> (excluding the query itself) and recorded the sequence identity given by TM<sc>align</sc>. <italic>q</italic> was then put into one of the three sets if the sequence identity bin for that set was not yet filled up. Otherwise, <italic>q</italic> was rejected. Finally, for each of the three query sets we constructed a template set by removing the sequences in the query set from the pdb70.</p>
<p>We then searched with each query sequence <italic>q</italic> in one of the three sets through the corresponding template database using HH<sc>search</sc>, a slower and slightly more sensitive version of HH<sc>blits</sc>, resulting in a list tlist(<italic>q</italic>) of potential templates.</p>
</sec>
<sec id="sec018">
<title>Distance restraints</title>
<sec id="sec019">
<title>Mixture density network</title>
<p>As training data for the mixture density networks for two-component distance restraints, we used the 3D models generated with single templates picked by the neural network. The alignment features for the network were again parsed from the HH<sc>search</sc> results. We fitted distributions of log(<italic>d</italic>) with the mixture of two Gaussians. M<sc>odeller</sc> includes four different classes of distances depending on the atom types involved: between two <italic>C</italic><sub><italic>α</italic></sub> atoms (<italic>C</italic><sub><italic>α</italic></sub>–<italic>C</italic><sub><italic>α</italic></sub>), N-O atoms, side chain—main chain and side chain—side chain. We generated four sets of training data with 3 million training cases for <italic>C</italic><sub><italic>α</italic></sub>–<italic>C</italic><sub><italic>α</italic></sub> and N–O pairs, 1 million for SC–MC and 300<italic>k</italic> for SC–SC. Optimizing the log-likelihood of the mixture density network was done by conjugate gradient ascent until convergence was reached. Bad local optima were avoided by picking the run with maximum likelihood from among 50 random initializations.</p>
</sec>
<sec id="sec020">
<title>Two-component distance restraints</title>
<p>We replaced all of M<sc>odeller</sc>’s template based distance restraints with our new two-component Gaussian mixture restraints. The optimization schedule was kept unchanged. The new restraints improved single-template modeling by 0.8% from a GDT-<sc>ha</sc> model quality score (GDT-<sc>ha</sc> is a high accuracy version of GDT-<sc>ts</sc>, see [<xref ref-type="bibr" rid="pcbi.1004343.ref029">29</xref>]) of 0.447 to 0.450, even though they were developed with multiple template modeling in mind. We then investigated the influence of replacing the new restraints when using our new multi-template selection strategy. We obtained an improvement of the average GDT-<sc>ha</sc> score over the 1000 queries in the test set by 2.5%, from 0.480 to 0.492 (<xref ref-type="table" rid="pcbi.1004343.t001">Table 1</xref> and <xref ref-type="fig" rid="pcbi.1004343.g007">Fig 7A</xref>), which is highly significant according to a paired t-test (P-value: &lt; 2.2 × 10<sup>−16</sup>).</p>
<table-wrap id="pcbi.1004343.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004343.t001</object-id>
<label>Table 1</label>
<caption>
<title>Average model quality scores for different variations of template selection strategies and restraints used with M<sc>odeller</sc> on a test set of 1000 single- and multi-domain proteins in the pdb20 database.</title>
<p>The GDC-all score is similar to GDT-<sc>ha</sc> but also includes side-chain atoms in its assessment. Percent improvements are with respect to the first line. P-values are calculated based on a paired t-test with respect to the GDT-<sc>ha</sc> score in the previous line.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004343.t001g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.t001"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th colspan="4" align="center" rowspan="1">Method</th>
<th rowspan="2" align="left" colspan="1">GDT-<sc>ha</sc></th>
<th rowspan="2" align="left" colspan="1">P-value</th>
<th rowspan="2" align="left" colspan="1">GDC-all</th>
</tr>
<tr>
<th align="left" rowspan="1" colspan="1">Name</th>
<th align="left" rowspan="1" colspan="1">Templates</th>
<th align="left" rowspan="1" colspan="1">Template selection</th>
<th align="left" rowspan="1" colspan="1">Restraints</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">s.1st.old</td>
<td align="left" rowspan="1" colspan="1">Single</td>
<td align="left" rowspan="1" colspan="1">first hit</td>
<td align="left" rowspan="1" colspan="1">M<sc>odeller</sc></td>
<td align="left" rowspan="1" colspan="1">0.443 (+0%)</td>
<td align="left" rowspan="1" colspan="1">-</td>
<td align="left" rowspan="1" colspan="1">51.9 (+0%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">s.NN.old</td>
<td align="left" rowspan="1" colspan="1">Single</td>
<td align="left" rowspan="1" colspan="1">neural network</td>
<td align="left" rowspan="1" colspan="1">M<sc>odeller</sc></td>
<td align="left" rowspan="1" colspan="1">0.447 (+0.9%)</td>
<td align="left" rowspan="1" colspan="1">1.5E-6</td>
<td align="left" rowspan="1" colspan="1">52.4 (+1.0%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">s.NN.new</td>
<td align="left" rowspan="1" colspan="1">Single</td>
<td align="left" rowspan="1" colspan="1">neural network</td>
<td align="left" rowspan="1" colspan="1">new</td>
<td align="left" rowspan="1" colspan="1">0.450 (+1.5%)</td>
<td align="left" rowspan="1" colspan="1">8E-6</td>
<td align="left" rowspan="1" colspan="1">52.8 (+1.7%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">m.ss.old</td>
<td align="left" rowspan="1" colspan="1">Multiple</td>
<td align="left" rowspan="1" colspan="1">simple selection</td>
<td align="left" rowspan="1" colspan="1">M<sc>odeller</sc></td>
<td align="left" rowspan="1" colspan="1">0.462 (+4.3%)</td>
<td align="left" rowspan="1" colspan="1">1E-10</td>
<td align="left" rowspan="1" colspan="1">53.5 (+3.1%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">m.mt.old</td>
<td align="left" rowspan="1" colspan="1">Multiple</td>
<td align="left" rowspan="1" colspan="1">new multi-template</td>
<td align="left" rowspan="1" colspan="1">M<sc>odeller</sc></td>
<td align="left" rowspan="1" colspan="1">0.480 (+8.4%)</td>
<td align="left" rowspan="1" colspan="1">2E-16</td>
<td align="left" rowspan="1" colspan="1">55.1 (+6.2%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">m.mt.new</td>
<td align="left" rowspan="1" colspan="1">Multiple</td>
<td align="left" rowspan="1" colspan="1">new multi-template</td>
<td align="left" rowspan="1" colspan="1">new</td>
<td align="left" rowspan="1" colspan="1">0.492 (+11.1%)</td>
<td align="left" rowspan="1" colspan="1">2E-16</td>
<td align="left" rowspan="1" colspan="1">56.3 (+8.5%)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1004343.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004343.g007</object-id>
<label>Fig 7</label>
<caption>
<p>(A) Our two-component mixture restraints improve GDT-<sc>ha</sc> model quality over M<sc>odeller</sc>’s default restraints in multi-template modelling by 2.5% on average. (B) Our multi-template selection strategy improves GDT-<sc>ha</sc> scores over the simple multi-template selection strategy by 3.9% on average. (C) Multi-template modeling improves GDT-<sc>ha</sc> scores over single-template modelling (using M<sc>odeller</sc> restraints) by 4.3% on average. (D) Overall improvements through new restraints, template weights, and the new multiple template selection over the baseline, single-template version (s.1st.old in <xref ref-type="table" rid="pcbi.1004343.t001">Table 1</xref>) is 11.1%.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.g007"/>
</fig>
</sec>
</sec>
<sec id="sec021">
<title>Template selection</title>
<sec id="sec022">
<title>Single template neural network</title>
<p>We selected the first template based on the query-template alignment features produced by HH<sc>search</sc> using the neural network with three hidden nodes shown in Fig. S1 (see <xref ref-type="sec" rid="sec002">Methods</xref>). To train the network, we built 3D models with M<sc>odeller</sc> (version 9.10) for each query in the training set and each of the maximal 10 best-ranked HH<sc>search</sc> hits in tlist(<italic>q</italic>) as templates. This yielded 9212 models (since some queries had less than 10 database matches), whose model quality we evaluated using TM<sc>score</sc>. To learn the network parameters we ran a standard back-propagation procedure. In order to avoid local optima, training was started from several random initializations, which all turned out to optimise to a similar likelihood on the training-set. The correlation between the network predictions and the true TM<sc>score</sc> values was 0.89. Compared to selecting the first hit in the HH<sc>search</sc> results list for single template modeling, the neural network-based template selection led to a 0.9% increase of the average GDT-<sc>ha</sc> from 0.443 to 0.447 (<xref ref-type="table" rid="pcbi.1004343.t001">Table 1</xref>).</p>
</sec>
<sec id="sec023">
<title>Multiple template selection</title>
<p>Choosing multiple templates increases both the coverage and the probability to detect a correct template. However, a higher number of templates leads to accumulation of noise and wrong templates which decreases the model quality. As described in the Methods section, our template selection heuristic has two parameters, <italic>α</italic> and <italic>β</italic>. They were optimized on a grid (<italic>α</italic>, <italic>β</italic>) ∈ {0.9, 0.95, 1, 1.05, 1.1} ⊗ {0.8, 0.9, 1, 1.1, 1.2} using all sequences in the optimization set as queries. For each parameter combination, templates were selected according to the score in <xref ref-type="disp-formula" rid="pcbi.1004343.e034">formula (14)</xref>. The alignment features between the query and all templates then served as input for M<sc>odeller</sc> and 3<italic>D</italic> structures were generated. We found <italic>α</italic> = 0.95 and <italic>β</italic> = 1 to maximize the cumulative TM<sc>score</sc> of all models.</p>
<p>The new multi-template selection strategy picked on average 4.6 templates per query (Supplemental Fig. S3), which resulted in a mean coverage of 94% of the query residues (i.e. 94% of query residues where aligned to at least one template residue). The new selection strategy leads to an improvement of 3.9% from an average GDT-<sc>ha</sc> score of 0.462 to 0.480 (<xref ref-type="fig" rid="pcbi.1004343.g007">Fig 7B</xref>) compared to the following baseline selection strategy: We sorted all templates with respect to their predicted TM<sc>score</sc> given by the single template neural network. The first template in this list is always selected and up to 10 templates along this ranking are chosen as long as their predicted TM<sc>score</sc> is at least 90% of the very first one (<xref ref-type="table" rid="pcbi.1004343.t001">Table 1</xref>).</p>
<p>Compared to the single template modeling approach, the improvement of multiple-template modeling without any further refinements (using the simple selection strategy and M<sc>odeller</sc> restraints) was 4.3%, from average GDT-<sc>ha</sc> 0.443 to 0.462 (<xref ref-type="table" rid="pcbi.1004343.t001">Table 1</xref> and <xref ref-type="fig" rid="pcbi.1004343.g007">Fig 7C</xref>). The total improvement from the baseline, single template modelling to the most refined multi-template modelling strategy sums up to 11.1% (<xref ref-type="fig" rid="pcbi.1004343.g007">Fig 7D</xref>, fist and last line in <xref ref-type="table" rid="pcbi.1004343.t001">Table 1</xref>).</p>
<p>Note that the improvement in modelling quality of multiple vs. single template modelling does not show a dependence on GDT-HA scores or sequence identities. In other words, difficult targets profit to the same degree as simpler targets from using multiple templates. This is consistent with the observation that both for single- and multi-domain targets, the average number of selected templates was similar across the entire range of sequence identities tested, from 0% to 80% (Supplemental Fig. S3).</p>
</sec>
</sec>
<sec id="sec024">
<title>Evaluation on cores</title>
<p>Most model quality assessment scores, such as the GDT-<sc>ha</sc>, do not penalize incorrect regions and thus reward adding more templates to increase the fraction of the query structure for which restraints can be derived. [<xref ref-type="bibr" rid="pcbi.1004343.ref030">30</xref>] assessed the effect of using a single or multiple templates on model quality and concluded that most of the gains are due to increased coverage of query residues by template residues. We wanted to discriminate between improvements in model quality due simply to increased coverage and improvements owed to reducing statistical noise by increasing the number of distance restraints on “core residues”, conveniently defined here as residues covered by the alignment to the first, top-ranked template. We remove all non-core residues in the input alignment to M<sc>odeller</sc>. In that way, distance constraints can only be generated on cores. Then we evaluate the resulting models on core residues only and we compare the GDT-<sc>ha</sc>s with the general case.</p>
<p>
<xref ref-type="table" rid="pcbi.1004343.t002">Table 2</xref> shows that, first, using multiple templates leads to a clear improvement over single templates both in the core regions and overall. This shows that the effect of adding further templates to the first selected template does indeed improve model quality to a similar extent in the core and non-core regions. Similarly, the improvements due to our new two-component restraints are of the same order in the core regions (+2.0%) as overall (+2.5%), leading to a similar conclusion, that the new restraints improve the model to the same extent in the core and non-core regions.</p>
<table-wrap id="pcbi.1004343.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004343.t002</object-id>
<label>Table 2</label>
<caption>
<title>Multi-template homology modeling and the new restraints improve models within core regions independent of increased query sequence coverage.</title>
<p>Mean GDT-<sc>ha</sc>s on query protein core regions, defined as the residues that are covered by the first template. Percent improvement with respect to the previous line.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004343.t002g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.t002"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="1" colspan="1">Templates</th>
<th align="center" rowspan="1" colspan="1">Selection</th>
<th align="center" rowspan="1" colspan="1">Restraints</th>
<th align="left" rowspan="1" colspan="1">GDT-<sc>ha</sc> score overall</th>
<th align="left" rowspan="1" colspan="1">GDT-<sc>ha</sc> score cores only</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="1" colspan="1">Single</td>
<td align="center" rowspan="1" colspan="1">first hit</td>
<td align="center" rowspan="1" colspan="1">M<sc>odeller</sc></td>
<td align="left" rowspan="1" colspan="1">0.443 (-)</td>
<td align="left" rowspan="1" colspan="1">0.464 (-)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">Multiple</td>
<td align="center" rowspan="1" colspan="1">new multi-template</td>
<td align="center" rowspan="1" colspan="1">M<sc>odeller</sc></td>
<td align="left" rowspan="1" colspan="1">0.480 (+8.4%)</td>
<td align="left" rowspan="1" colspan="1">0.504 (+8.6%)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">Multiple</td>
<td align="center" rowspan="1" colspan="1">new multi-template</td>
<td align="center" rowspan="1" colspan="1">new</td>
<td align="left" rowspan="1" colspan="1">0.492 (+2.5%)</td>
<td align="left" rowspan="1" colspan="1">0.514 (+2.0%)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec025">
<title>Robustness with respect to wrong restraints</title>
<p>Our probabilistic multi-template modeling approach should have the advantage over the M<sc>odeller</sc> restraints of being more robust towards wrong restraints, because the new distance restraints become flat when log <italic>d</italic> deviates strongly from log <italic>d</italic><sub><italic>t</italic></sub>, i.e., when the restraint cannot be satisfied at all. Therefore, completely wrong restraints practically get ignored in the new approach. Note that this was not a design target of our method but it is simply a consequence of a correct statistical treatment. To test our hypothesis on the robustness of the new restraints, we modified the template selection as follows.</p>
<p>For each query in the test set, we constructed three different template sets (<xref ref-type="table" rid="pcbi.1004343.t003">Table 3</xref>). The three sets contained two good templates each, and 0, 1 or 2 bad templates, respectively. The good templates were the top two templates according to the TM<sc>score</sc>s predicted by the neural network in Fig. S1 that also attained a true TM<sc>score</sc> of &gt; 0.5. The bad templates were the lowest ranked templates with a true TM<sc>score</sc> &lt; 0.3. The average model quality obtained with these three selections are shown in <xref ref-type="table" rid="pcbi.1004343.t003">Table 3</xref>. As expected, the models built with the new restraints proved to be considerably more robust than the models built with the standard M<sc>odeller</sc> pipeline.</p>
<table-wrap id="pcbi.1004343.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004343.t003</object-id>
<label>Table 3</label>
<caption>
<title>The probabilistic multi-template modeling approach is less negatively affected by bad templates.</title>
<p>Mean GDT-<sc>ha</sc> scores of 1000 models built with templates sets containing 0, 1 and 2 bad templates (TM<sc>score</sc> &lt; 0.3) along with two good templates (TM<sc>score</sc> &gt; 0.5).</p>
</caption>
<alternatives>
<graphic id="pcbi.1004343.t003g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.t003"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="1" colspan="1">Good templates</th>
<th align="center" rowspan="1" colspan="1">Bad templates</th>
<th align="left" rowspan="1" colspan="1">M<sc>odeller</sc> restraints</th>
<th align="left" rowspan="1" colspan="1">New restraints</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="1" colspan="1">2</td>
<td align="center" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0.474 (-)</td>
<td align="left" rowspan="1" colspan="1">0.480 (-)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">2</td>
<td align="center" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.466 (−1.7%)</td>
<td align="left" rowspan="1" colspan="1">0.475 (−1.0%)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">2</td>
<td align="center" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">0.458 (−3.4%)</td>
<td align="left" rowspan="1" colspan="1">0.471 (−1.9%)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec026">
<title>CASP assessment</title>
<p>CASP (Critical Assessment of Structure Prediction) is a community wide, double-blind experiment that takes place every second year to objectively test the performance of various predictors. HH<sc>pred</sc> regularly participates in the server based structure prediction category competing with 70–80 other servers. For CASP9 and CASP10, we integrated all methods described above into the HH<sc>pred</sc> pipeline.</p>
<p>Depending on whether there existed a suitable template in the databases, all queries are subdivided into two categories: template based (TBM) and free (FM). Due to the ever increasing database sizes, most of the queries are TBM (121 vs. 26 in CASP9 and 111 vs. 15 in CASP10). As <xref ref-type="fig" rid="pcbi.1004343.g008">Fig 8</xref> shows, for TBM HH<sc>pred</sc> is among the most accurate servers (top 1 in CASP9 and top 7 in CASP10 according to the official CASP ranking—all three servers differ only in minor technical details, see [<xref ref-type="bibr" rid="pcbi.1004343.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004343.ref032">32</xref>]). At the same time HH<sc>pred</sc> is faster by a factor of ∼ 350 compared with the other leading groups. <xref ref-type="fig" rid="pcbi.1004343.g008">Fig 8</xref> summarizes the official results in the TBM category from two community-wide assessments of techniques for protein structure prediction, CASP9 (121 query proteins) and CASP10 (111 query proteins) [<xref ref-type="bibr" rid="pcbi.1004343.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004343.ref003">3</xref>]. The values used in the figure were downloaded from the official CASP website (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://predictioncenter.org/">http://predictioncenter.org/</ext-link>). For detailed results, see Supporting Information. When replacing the new restraints with M<sc>odeller</sc>’s default restraints for the CASP10 set on the same selection of templates, the gdtts-score decreased by 3%.</p>
<fig id="pcbi.1004343.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004343.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Cumulative Z-score of all server predictions in the template-based modeling category of the CASP9 and CASP10 community-wide assessment of techniques for protein structure prediction [<xref ref-type="bibr" rid="pcbi.1004343.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004343.ref003">3</xref>].</title>
<p>HH<sc>pred</sc> servers are red, other servers using our HH<sc>suite</sc> software are shown in green.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.g008"/>
</fig>
<p>When considering HHpred’s performance in CASP9 and CASP10, note that assessors filtered out targets that will be too simple to predict by eliminating targets for which a high-confidence homologous template could be found using HHsearch. This procedure thus selectively biases the targets at the detriment of HHpred by eliminating targets that would be easy for HHpred to predict.</p>
</sec>
</sec>
<sec id="sec027" sec-type="conclusions">
<title>Discussion</title>
<p>Protein structure prediction is a mature field, in which the best methods differ only by a few percent in performance according to recent CASP benchmarks. Even so, great progress has been made in the last 10 to 15 years in template-based protein structure prediction, fuelled by advances in techniques for remote homology detection and alignment [<xref ref-type="bibr" rid="pcbi.1004343.ref006">6</xref>] and techniques for model quality assessment [<xref ref-type="bibr" rid="pcbi.1004343.ref003">3</xref>]. In contrast, most successful servers in CASP employ M<sc>odeller</sc> to build their 3D homology models, a software whose core has changed very little since its publication 22 years ago. This speaks to the enormous success of M<sc>odeller</sc>’s statistical approach to homology modeling. In this study we have shown how to generalize the statistical approach by taking account of alignment errors and treating restraints from multiple templates in a probabilistically satisfactory way.</p>
<p>These theoretical insights have led to improvements in average model quality (around 6.5%) that are somewhat smaller than what we expected initially. In hindsight, M<sc>odeller</sc>’s heuristic to derive multi-template restraints works surprisingly well. Also, since M<sc>odeller</sc>’s internal workings (e.g. the stochastic optimization) are optimized together with its own restraints, it might well be possible to improve on the presented results by specifically optimizing M<sc>odeller</sc>’s model building procedure with our new restraints. We note, however, that an average model score improvement of 4.4% (m.ss.old versus m.mt.new in GDT-<sc>ts</sc>, see Table A in <xref ref-type="supplementary-material" rid="pcbi.1004343.s001">S1 Text</xref>) corresponds to the difference in GDT-<sc>ts</sc> scores between the 3rd best and 14th best server in CASP10 [<xref ref-type="bibr" rid="pcbi.1004343.ref005">5</xref>]. This is a considerable success in particular because our theoretical approach is quite general and can be transferred to other homology modelling methods and to the up-and-coming field of modeling large protein complexes from heterogeneous experimental data [<xref ref-type="bibr" rid="pcbi.1004343.ref033">33</xref>].</p>
<p>We noted during our tests that the positive impact of the new restraints on model quality is strongest when evaluated with the strictest score, GDT-<sc>ha</sc>, as compared to the less strict GDT-<sc>ts</sc> or TM<sc>score</sc> (Table A in <xref ref-type="supplementary-material" rid="pcbi.1004343.s001">S1 Text</xref>). Here, strictness refers to how severely already small deviations of the model from the true structure are penalized. This observation shows that the improvements of our new restraints are to a substantial degree in the high-precision regime, i.e., below 1 Å, by further improving regions of the model that are already fairly well modeled. Since the best-modeled regions are expected to largely coincide with the highly conserved and hence functionally most important parts of the protein, we expect the new restraints to have the strongest impact on the functionally most important regions of the model.</p>
<p>We are convinced of the power of probability theory in describing quantitative phenomena under uncertainty. M<sc>odeller</sc> is an excellent case in point. An interesting idea is to carry the probabilistic view further by probabilistically integrating structural and sequence information. All approaches so far start from a fixed query-template alignment (or from a set of alternative alignments) and try to find the 3D model that is best compatible with the alignment. To allow information from the 3D modelling to be fed back to the alignment stage and vice versa, it seems promising to explore the joint posterior probability distribution of alignment and 3D structure. One way to do this would be by Markov Chain Monte Carlo Gibbs sampling of the alignment and the model structure from appropriate conditional distributions.</p>
</sec>
<sec id="sec028">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004343.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.s001" mimetype="application/pdf" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Contains supplemental figures (single template neural network, sequence identity distributions), tables (model quality scores, alignment features, CASP results) and methods (details of template weighting).</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004343.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004343.s002" mimetype="application/zip" xlink:type="simple">
<label>S1 Fasta</label>
<caption>
<title>Training, optimization and test set.</title>
<p>These correspond to the supplemental files S2_training_set, S2_test_set.fasta and S2_optimization_set.fasta, respectively.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Andrei Sali (UCSF), Markus Meier, and Jessica Andreani for discussions, and Milot Mirdita for bioinformatics support.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004343.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mariani</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kiefer</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Schmidt</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Haas</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schwede</surname> <given-names>T</given-names></name> (<year>2011</year>) <article-title>Assessment of template based protein structure predictions in CASP9</article-title>. <source>Proteins</source> <volume>79</volume> <issue>Suppl 1</issue>: <fpage>37</fpage>–<lpage>58</lpage>. <object-id pub-id-type="pmid">22002823</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kinch</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Yong Shi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cong</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Liao</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>CASP9 assessment of free modeling target predictions</article-title>. <source>Proteins</source> <volume>79</volume> <issue>Suppl 10</issue>: <fpage>59</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.23181" xlink:type="simple">10.1002/prot.23181</ext-link></comment> <object-id pub-id-type="pmid">21997521</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Huang</surname> <given-names>Yea</given-names></name> (<year>2013</year>) <article-title>Assessment of template-based protein structure predictions in CASP10</article-title>. <source>Proteins</source> <volume>2</volume>: <fpage>43</fpage>–<lpage>56</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004343.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Yan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Walker</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name> (<year>2013</year>) <article-title>A comparative assessment and analysis of 20 representative sequence alignment methods for protein structure prediction</article-title>. <source>Scientific reports</source> <volume>3</volume>: <fpage>2619</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/srep02619" xlink:type="simple">10.1038/srep02619</ext-link></comment> <object-id pub-id-type="pmid">24018415</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kryshtafovych</surname> <given-names>Aea</given-names></name> (<year>2014</year>) <article-title>CASP10 results compared to those of previous CASP experiments</article-title>. <source>Proteins</source> <volume>82</volume>: <fpage>164</fpage>–<lpage>174</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.24448" xlink:type="simple">10.1002/prot.24448</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Söding</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Remmert</surname> <given-names>M</given-names></name> (<year>2011</year>) <article-title>Protein sequence comparison and fold recognition: progress and good-practice benchmarking</article-title>. <source>Current opinion in structural biology</source> <volume>21</volume>: <fpage>404</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.sbi.2011.03.005" xlink:type="simple">10.1016/j.sbi.2011.03.005</ext-link></comment> <object-id pub-id-type="pmid">21458982</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wallner</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Elofsson</surname> <given-names>A</given-names></name> (<year>2005</year>) <article-title>All are not equal: A benchmark of different homology modeling programs</article-title>. <source>Protein Science</source> <volume>15</volume>: <fpage>1315</fpage>–<lpage>1327</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1110/ps.041253405" xlink:type="simple">10.1110/ps.041253405</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dalton</surname> <given-names>JaR</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>RM</given-names></name> (<year>2007</year>) <article-title>An evaluation of automated homology modelling methods at low target template sequence similarity</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>1901</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm262" xlink:type="simple">10.1093/bioinformatics/btm262</ext-link></comment> <object-id pub-id-type="pmid">17510171</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Levitt</surname> <given-names>M</given-names></name> (<year>1996</year>) <article-title>Accurate modeling of protein conformation by automatic segment matching</article-title>. <source>J Mol Biol</source> <volume>226</volume>: <fpage>507</fpage>–<lpage>533</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0022-2836(92)90964-L" xlink:type="simple">10.1016/0022-2836(92)90964-L</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Schwede</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kopp</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Guex</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Peitsch</surname> <given-names>M</given-names></name> (<year>2003</year>) <article-title>Swiss-model: an automated protein homology-modeling server</article-title>. <source>Nuc Acid Res</source> <volume>31</volume>: <fpage>3381</fpage>–<lpage>85</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkg520" xlink:type="simple">10.1093/nar/gkg520</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Petrey</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Xiang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Gimpelev</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>Using multiple structure alignments, fast model building, and energetic analysis in fold recognition and homology modeling</article-title>. <source>Proteins</source> <volume>53</volume> <issue>Suppl 6</issue>: <fpage>430</fpage>–<lpage>435</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.10550" xlink:type="simple">10.1002/prot.10550</ext-link></comment> <object-id pub-id-type="pmid">14579332</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Sali</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Blundell</surname> <given-names>T</given-names></name> (<year>1993</year>) <article-title>Comparative Protein Modelling by Satisfaction of Spatial Restraints</article-title>. <source>J Mol Biol</source> <volume>234</volume>: <fpage>779</fpage>–<lpage>815</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.1993.1626" xlink:type="simple">10.1006/jmbi.1993.1626</ext-link></comment> <object-id pub-id-type="pmid">8254673</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Joo</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Seo</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>BG</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>All-atom chain-building by optimizing MODELLER energy function using conformational space annealing</article-title>. <source>Proteins</source> <volume>75</volume>: <fpage>1010</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.22312" xlink:type="simple">10.1002/prot.22312</ext-link></comment> <object-id pub-id-type="pmid">19089941</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fiser</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Do</surname> <given-names>RK</given-names></name>, <name name-style="western"><surname>Sali</surname> <given-names>A</given-names></name> (<year>2000</year>) <article-title>Modeling of loops in protein structures</article-title>. <source>Protein science: a publication of the Protein Society</source> <volume>9</volume>: <fpage>1753</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1110/ps.9.9.1753" xlink:type="simple">10.1110/ps.9.9.1753</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Remmert</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Biegert</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hauser</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Söding</surname> <given-names>J</given-names></name> (<year>2012</year>) <article-title>HHblits: lightning-fast iterative protein sequence searching by HMM-HMM alignment</article-title>. <source>Nature methods</source> <volume>9</volume>: <fpage>173</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1818" xlink:type="simple">10.1038/nmeth.1818</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Bishop</surname> <given-names>C</given-names></name> (<year>1994</year>) <chapter-title>Mixture Density Networks</chapter-title>. <source>Technical report</source>, <publisher-name>Aston University</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004343.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mitchison</surname> <given-names>G</given-names></name> (<year>1998</year>) <source>Biological sequence analysis: Probabilistic Models of Proteins and Nucleic Acids</source>. <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004343.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Altschul</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Carroll</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>DJ</surname> <given-names>L</given-names></name> (<year>1989</year>) <article-title>Weights for data related by a tree</article-title>. <source>J Mol Biol</source> <volume>207</volume>: <fpage>647</fpage>–<lpage>653</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0022-2836(89)90234-9" xlink:type="simple">10.1016/0022-2836(89)90234-9</ext-link></comment> <object-id pub-id-type="pmid">2760928</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Sokal</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Michener</surname> <given-names>C</given-names></name> (<year>1958</year>) <article-title>A statistical method for evaluating systematic relationships</article-title>. <source>University of Kansas Science Bulletin</source> <volume>38</volume>: <fpage>1409</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004343.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Skolnick</surname> <given-names>J</given-names></name> (<year>2005</year>) <article-title>TM-align: a protein structure alignment algorithm based on the TM-score</article-title>. <source>Nucleic acids research</source> <volume>33</volume>: <fpage>2302</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gki524" xlink:type="simple">10.1093/nar/gki524</ext-link></comment> <object-id pub-id-type="pmid">15849316</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Xu</surname> <given-names>J</given-names></name> (<year>2005</year>) <article-title>Fold recognition by predicted alignment accuracy</article-title>. <source>IEEE/ACM transactions on computational biology and bioinformatics / IEEE, ACM</source> <volume>2</volume>: <fpage>157</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2005.24" xlink:type="simple">10.1109/TCBB.2005.24</ext-link></comment> <object-id pub-id-type="pmid">17044180</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hildebrand</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Remmert</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Biegert</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Söding</surname> <given-names>J</given-names></name> (<year>2009</year>) <article-title>Fast and accurate automatic structure prediction with HHpred</article-title>. <source>Proteins</source> <volume>77</volume> <issue>Suppl 9</issue>: <fpage>128</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.22499" xlink:type="simple">10.1002/prot.22499</ext-link></comment> <object-id pub-id-type="pmid">19626712</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Peng</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>J</given-names></name> (<year>2011</year>) <article-title>RaptorX: exploiting structure information for protein alignment by statistical inference</article-title>. <source>Proteins</source> <volume>79</volume> <issue>Suppl 1</issue>: <fpage>161</fpage>–<lpage>71</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.23175" xlink:type="simple">10.1002/prot.23175</ext-link></comment> <object-id pub-id-type="pmid">21987485</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cheng</surname> <given-names>J</given-names></name> (<year>2008</year>) <article-title>A multi-template combination algorithm for protein comparative modeling</article-title>. <source>BMC structural biology</source> <volume>8</volume>: <fpage>18</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1472-6807-8-18" xlink:type="simple">10.1186/1472-6807-8-18</ext-link></comment> <object-id pub-id-type="pmid">18366648</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fernandez-Fuentes</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Rai</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Madrid-Aliste</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Fajardo</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Fiser</surname> <given-names>A</given-names></name> (<year>2007</year>) <article-title>Comparative protein structure modeling by combining multiple templates and optimizing sequence-to-structure alignments</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>2558</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm377" xlink:type="simple">10.1093/bioinformatics/btm377</ext-link></comment> <object-id pub-id-type="pmid">17823132</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Eickholt</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>J</given-names></name> (<year>2010</year>) <article-title>MULTICOM: a multi-level combination approach to protein structure prediction and its assessments in CASP8</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>882</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq058" xlink:type="simple">10.1093/bioinformatics/btq058</ext-link></comment> <object-id pub-id-type="pmid">20150411</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name> (<year>2008</year>) <article-title>I-TASSER server for protein 3D structure prediction</article-title>. <source>BMC bioinformatics</source> <volume>9</volume>: <fpage>40</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-9-40" xlink:type="simple">10.1186/1471-2105-9-40</ext-link></comment> <object-id pub-id-type="pmid">18215316</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Skolnick</surname> <given-names>J</given-names></name> (<year>2004</year>) <article-title>SPICKER: A Clustering Approach to Identify Near-Native</article-title>. <source>J Comput Chem</source> <volume>25</volume>: <fpage>865</fpage>–<lpage>871</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/jcc.20011" xlink:type="simple">10.1002/jcc.20011</ext-link></comment> <object-id pub-id-type="pmid">15011258</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Read</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Chavali</surname> <given-names>G</given-names></name> (<year>2007</year>) <article-title>Assessment of CASP7 predictions in the high accuracy template-based modeling category</article-title>. <source>Proteins</source> <volume>69</volume>: <fpage>27</fpage>–<lpage>37</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.21662" xlink:type="simple">10.1002/prot.21662</ext-link></comment> <object-id pub-id-type="pmid">17894351</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Larsson</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wallner</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lindahl</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Elofsson</surname> <given-names>A</given-names></name> (<year>2008</year>) <article-title>Using multiple templates to improve quality of homology models in automated homology modeling</article-title>. <source>Protein Science</source>: <fpage>990</fpage>–<lpage>1002</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1110/ps.073344908" xlink:type="simple">10.1110/ps.073344908</ext-link></comment> <object-id pub-id-type="pmid">18441233</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004343.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="other">Casp9 abstract book: the embo conference (2010). URL <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://predictioncenter.org/casp9/doc/Abstracts.pdf">http://predictioncenter.org/casp9/doc/Abstracts.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004343.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="other">Casp10 abstract book: the embo conference (2012). URL <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://predictioncenter.org/casp10/doc/CASP10_Abstracts.pdf">http://predictioncenter.org/casp10/doc/CASP10_Abstracts.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004343.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Russel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lasker</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Webb</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Velazquez-Muriel</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tjioe</surname> <given-names>E</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Putting the pieces together: Integrative modeling platform software for strucutre determination of macromolecular assemblies</article-title>. <source>PLoS Biol</source> <volume>10</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1001244" xlink:type="simple">10.1371/journal.pbio.1001244</ext-link></comment> <object-id pub-id-type="pmid">22272186</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>