<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01729</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004235</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Quantification of Interactions between Dynamic Cellular Network Functionalities by Cascaded Layering</article-title>
<alt-title alt-title-type="running-head">Quantifying Interactions between Functionalities by Cascaded Layering</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Prescott</surname> <given-names>Thomas P.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Lang</surname> <given-names>Moritz</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Papachristodoulou</surname> <given-names>Antonis</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Engineering Science, University of Oxford, Oxford, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Life Sciences Interface Doctoral Training Centre, University of Oxford, Oxford, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Biosystems Science and Engineering, ETH Zürich, Basel, Switzerland</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Swiss Institute of Bioinformatics, Basel, Switzerland</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Miyano</surname> <given-names>Satoru</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Tokyo, JAPAN</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Wrote the paper: TPP ML AP. Software design: ML.</p>
</fn>
<fn fn-type="other" id="econtrib001">
<p>‡ Contributed equally</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">antonis@eng.ox.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>5</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>1</day>
<month>5</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>5</issue>
<elocation-id>e1004235</elocation-id>
<history>
<date date-type="received">
<day>22</day>
<month>9</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>8</day>
<month>3</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Prescott et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004235" xlink:type="simple"/>
<abstract>
<p>Large, naturally evolved biomolecular networks typically fulfil multiple functions. When modelling or redesigning such systems, functional subsystems are often analysed independently first, before subsequent integration into larger-scale computational models. In the design and analysis process, it is therefore important to quantitatively analyse and predict the dynamics of the interactions between integrated subsystems; in particular, how the incremental effect of integrating a subsystem into a network depends on the existing dynamics of that network. In this paper we present a framework for simulating the contribution of any given functional subsystem when integrated together with one or more other subsystems. This is achieved through a cascaded layering of a network into functional subsystems, where each layer is defined by an appropriate subset of the reactions. We exploit symmetries in our formulation to exhaustively quantify each subsystem’s incremental effects with minimal computational effort. When combining subsystems, their isolated behaviour may be amplified, attenuated, or be subject to more complicated effects. We propose the concept of mutual dynamics to quantify such nonlinear phenomena, thereby defining the incompatibility and cooperativity between all pairs of subsystems when integrated into any larger network. We exemplify our theoretical framework by analysing diverse behaviours in three dynamic models of signalling and metabolic pathways: the effect of crosstalk mechanisms on the dynamics of parallel signal transduction pathways; reciprocal side-effects between several integral feedback mechanisms and the subsystems they stabilise; and consequences of nonlinear interactions between elementary flux modes in glycolysis for metabolic engineering strategies. Our analysis shows that it is not sufficient to just specify subsystems and analyse their pairwise interactions; the environment in which the interaction takes place must also be explicitly defined. Our framework provides a natural representation of nonlinear interaction phenomena, and will therefore be an important tool for modelling large-scale evolved or synthetic biomolecular networks.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>To better understand the dynamic behaviour of cells and their interaction with the environment, mathematical models describing the interplay between proteins, metabolites or signalling molecules are used extensively in Systems Biology. Typically, such models focus on single functional subsystems and neglect the rest of the biochemical reaction network. However, the behaviour of multiple functional subsystems when integrated together can differ significantly from each subsystem’s isolated behaviour. In this article we describe a methodology for assessing the nonlinear effects of combining multiple functional subsystems of a biological system. This is key for answering questions related to Systems and Synthetic Biology as well as Metabolic Engineering. For example, if we can identify the isolated behaviours of two subsystems, we can determine if they persist when the subsystems interact. Similarly, we can show how modifications to single functional subsystems (such as increasing particular metabolic yields) have different effects in the context of the integrated system.</p>
</abstract>
<funding-group>
<funding-statement>AP is funded through the UK Engineering &amp; Physical Sciences Research Council (EPSRC, <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.epsrc.ac.uk">http://www.epsrc.ac.uk</ext-link>) through projects EP/M002454/1, EP/J012041/1, EP/I031944/1, and EP/J010537/1. TPP is funded through UK EPSRC project EP/F500394/1. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscipt.</funding-statement>
</funding-group>
<counts>
<fig-count count="12"/>
<table-count count="0"/>
<page-count count="31"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>A fully functioning MATLAB toolbox applied to the publicly available Biomodels SBML models discussed in the paper is available to download from <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://sysos.eng.ox.ac.uk/control/sysos/index.php/User:Prescott/Code">http://sysos.eng.ox.ac.uk/control/sysos/index.php/User:Prescott/Code</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Complex biochemical reaction networks serve a broad variety of different tasks within the cell. Systems Biology researchers apply a range of systems analysis techniques to these networks to identify and model functional subsystems and their interaction structure. In the context of biomolecular networks, the subsystems that can be identified often have biological interpretations: for example, the heat shock response and the chemotaxis pathways represent two functional subsystems within a model describing the complete biomolecular reaction network of <italic>Escherichia coli</italic>; the synthesis pathways of individual products represent distinct functional subsystems within a metabolic network; and so on. Other functional subsystems may also have system-theoretic interpretations: for example, interacting, distributed feedback control mechanisms; or subsystems which can sense, compute, or actuate on the cell and its environment. This tangle of different objectives within the same network leads to trade-off situations: evolutionary or synthetic changes to one functional subsystem can lead to declining performance or unexpected side effects with respect to another.</p>
<p>A fundamental challenge of Systems Biology is to not only establish the behaviour of each functional subsystem in isolation, but also to understand how they dynamically influence one another. This problem is particularly acute when applying the modelling and analysis tools of Systems Biology to adapt and redesign modular biomolecular networks in Synthetic Biology [<xref ref-type="bibr" rid="pcbi.1004235.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004235.ref003">3</xref>]. The dynamics of many functional subsystems, whether evolved biochemical networks or synthetic devices, often do not proceed as modelled when integrated into a cell due to their interactions with one another and the environment of their cellular host. Possible sources of nonlinear interactions between pairs of functional subsystems and the cellular environment include retroactivity in genetic [<xref ref-type="bibr" rid="pcbi.1004235.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004235.ref006">6</xref>] and signalling [<xref ref-type="bibr" rid="pcbi.1004235.ref007">7</xref>] networks, crosstalk between parallel signalling pathways [<xref ref-type="bibr" rid="pcbi.1004235.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004235.ref009">9</xref>], and the coupling of multiple transcription or translation rates through competition for shared resources [<xref ref-type="bibr" rid="pcbi.1004235.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1004235.ref012">12</xref>]. In each of these settings, the change in input–output behaviour of a given subsystem upon integration with its context is examined. There are two complementary goals of this paper. First, we investigate the behaviour of each subsystem between the two extremes of ‘isolated’ or ‘integrated’, when it is integrated with any subset of the other subsystems. The second goal, which is achieved as a consequence of the first, is to then systematically quantify each of the pairwise interactions between the network’s subsystems.</p>
<p>The approach we will take in this work is to define a <italic>functionality</italic> as a group of reactions which corresponds to an identified functional subsystem of a biomolecular network. The reactions that determine each functionality can be selected either through biological insight, or by applying existing computational approaches such as elementary flux mode (EFM) analysis [<xref ref-type="bibr" rid="pcbi.1004235.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1004235.ref015">15</xref>] (see also <xref ref-type="sec" rid="sec007">Results</xref>). We characterise the behaviour, or effect, of a functionality as the solution of an ordinary differential equation (ODE) model determined by the particular group of reactions. This approach exploits the recently-introduced decomposition technique known as <italic>layering</italic> [<xref ref-type="bibr" rid="pcbi.1004235.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004235.ref017">17</xref>]. As depicted in <xref ref-type="fig" rid="pcbi.1004235.g001">Fig 1</xref>, such an approach is distinct from established modular approaches to network decomposition, which are characterised by identifying sets of species with a high connectivity inside the module, and significantly lower connectivity to species in other modules [<xref ref-type="bibr" rid="pcbi.1004235.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004235.ref026">26</xref>]. While often many species and reactions in a given network are implicated in multiple network functions, these modular approaches generally do not allow for such a high degree of overlap between modules. For example, if a network of two pathways responds to two external signals with a single output species, a modular decomposition of this network requires the common output species to be assigned to a module representing exactly one of the pathways, or potentially to an additional separate module. Either way, the input–output behaviour of both pathways cannot be easily defined. However, in the layered framework, the common output is associated with both layers, and hence the output of each layer can be defined in terms of its biological function. Thus, in some cases, layers are preferable to modules for defining the functional subsystems of the network, since the layered framework explicitly allows for overlap in species and reaction subsets [<xref ref-type="bibr" rid="pcbi.1004235.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004235.ref017">17</xref>], as will be illustrated further in ‘Mapping Functionalities to Layers’ below.</p>
<fig id="pcbi.1004235.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Modularization, non-cascaded and cascaded layering of a simplified model of the glycolytic pathway (see [<xref ref-type="bibr" rid="pcbi.1004235.ref046">46</xref>] p.88 ff.).</title>
<p>Nodes represent metabolites, coloured arrows reactions, and grey arrows information transfer. Intermediate metabolites and cofactors are omitted, and several enzymatic reactions are merged. Modules (A) or layers (B and C) are delineated by blue and green boxes. In each panel the blue subnetwork corresponds to the single functional subsystem Glc→Glyc of glycolysis, where the conversion from GAP into Pyr has been removed. All panels consider the integration of the Glc→Glyc pathway (blue arrows) with the missing (merged) reaction GAP→Pyr. A) Modularization of the pathway [<xref ref-type="bibr" rid="pcbi.1004235.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004235.ref026">26</xref>]. Modules are typically defined by non-overlapping sets of species, and can be interconnected by mass flow (red arrow, representing the load of the new species) and information transfer. Here, there is mass flow when the blue module is integrated with the green module, leading to retroactive effects [<xref ref-type="bibr" rid="pcbi.1004235.ref004">4</xref>]. The combined dynamics will be in feedback, and hence both modules must be considered simultaneously. B) Non-cascaded layering [<xref ref-type="bibr" rid="pcbi.1004235.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004235.ref017">17</xref>]. Layers are defined by non-overlapping sets of reactions, while species may take part in multiple layers; species’ affiliation to layers is indicated in superscript. The dynamics of species in multiple layers are summed (e.g. GAP(<italic>t</italic>) = GAP<sup>1</sup>(<italic>t</italic>) + GAP<sup>2</sup>(<italic>t</italic>) + GAP(<italic>t</italic> = 0)). Layers are interconnected only by information transfer (grey arrows) and their models are not modified when combined. However, as in the modular case, the layers are in feedback and must be considered simultaneously. C) Cascaded layering of the pathway, as introduced in this article. By allowing the layers to overlap in ‘altered reactions’ (green broken arrows) as well as species, the layers become cascaded as information (grey arrows) is only transferred in one direction. The states of the green layer directly capture the incremental effect of extending the isolated Glc→Glyc pathway with the additional (merged) reaction GAP→Pyr. Since the information transfer between the layers is cascaded, they can be numerically integrated and analysed sequentially.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g001"/>
</fig>
<p>Most importantly, we make it explicit that the behaviour of any functionality also depends on the other functionalities with which it is integrated, to which we refer as the context of the functionality. This contextual dependence is formalised by developing a notational framework that will unambiguously define a functionality’s behaviour in a particular context. The resulting concept of <italic>conditional dynamics</italic> will be key to our understanding of each functionality as being defined only in the context of others, allowing us to systematically investigate the interdependence of an entire network’s functionalities.</p>
<p>The subsequent aim of this framework is to characterise all of the interactions between each pair of functionalities, each of which is also context-dependent. Our approach is a formalisation and extension of previous investigations into additive (i.e. independent), synergistic, or antagonistic subsystem interactions. Examples of these phenomena include the cytokine secretion by macrophages in response to stimulation with different sets of ligands [<xref ref-type="bibr" rid="pcbi.1004235.ref027">27</xref>], the response of bacteria to different combinations of drugs [<xref ref-type="bibr" rid="pcbi.1004235.ref028">28</xref>], or calcium signalling responses to different stimuli [<xref ref-type="bibr" rid="pcbi.1004235.ref029">29</xref>]. Importantly, we demonstrate how the strength and the type of interactions between functionalities depends on mediated indirect interactions with the other functionalities comprising their context. The relationship of our approach to the concepts in [<xref ref-type="bibr" rid="pcbi.1004235.ref027">27</xref>–<xref ref-type="bibr" rid="pcbi.1004235.ref029">29</xref>] is further discussed in the section “Calculating With Layers”.</p>
<p>In addition to the previous literature on context-dependent dynamics, our theoretical framework is also related to steady-state methods. For instance, the third of our examples will exploit EFMs, a technique designed to analyse the steady-state flux distribution in metabolic networks [<xref ref-type="bibr" rid="pcbi.1004235.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1004235.ref015">15</xref>]. Furthermore, modular and hierarchical control/response analysis is concerned with the different behaviour of subsystems both in isolation and integrated in larger systems, with particular reference to the steady-state responses of biochemical networks to parameter perturbations [<xref ref-type="bibr" rid="pcbi.1004235.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004235.ref030">30</xref>–<xref ref-type="bibr" rid="pcbi.1004235.ref034">34</xref>]. The key distinction between our method and these is that we analyse the dynamics of kinetic models [<xref ref-type="bibr" rid="pcbi.1004235.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004235.ref036">36</xref>] represented by sets of ODEs, rather than steady states. Moreover, our method is not based on linearisation, allowing us to adequately capture nonlinear interactions between functionalities. Quantifying the dynamic interactions of each pair of functionalities in all possible contexts requires multiple ODE simulations; for its practical applicability, it is important to minimise the computational effort involved.</p>
<p>This paper is structured as follows: in the Methods section we show how to use a layered decomposition to identify the incremental effect of a functionality, making its context-dependence explicit. We continue by defining the interdependence, or <italic>mutual dynamics</italic>, between any two functionalities. We summarise this interdependence by the incompatibility and the cooperativity between functionalities. In the final part of the Methods section we describe how to analyse all functionalities and their dependencies with minimal computation. We demonstrate our method on three familiar biomolecular networks in the Results section. The first example is of two signalling pathways with two crosstalk mechanisms, in which we use our approach to quantify the nonlinear interactions between crosstalk mechanisms. In the second example we analyse an unstable pathway stabilised by two integral feedback loops, finding the interactions between each controller and the pathway, and also between the controllers. Finally, we consider the glycolytic pathway in <italic>Saccharomyces cerevisiae</italic>, with functionalities defined by an EFM analysis. We apply our approach to compare how different knock-out strategies in metabolic engineering influence the yield of ethanol, industrially relevant in biofuel production.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Network Representation and Layering</title>
<p>Consider a biochemical reaction network with <italic>N</italic><sub><italic>X</italic></sub> species <italic>X</italic><sub><italic>i</italic></sub> of time-varying concentrations <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>), taking part in <italic>N</italic><sub><italic>R</italic></sub> reactions <italic>R</italic><sub>1</sub>, …, <italic>R</italic><sub><italic>N</italic><sub><italic>R</italic></sub></sub>, each of which proceeds at the concentration-dependent rate <italic>v</italic><sub><italic>j</italic></sub>(<italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>N</italic><sub><italic>X</italic></sub></sub>) for <italic>j</italic> = 1, …, <italic>N</italic><sub><italic>R</italic></sub>. Forming vectors <italic>v</italic> = (<italic>v</italic><sub>1</sub>, …, <italic>v</italic><sub><italic>N</italic><sub><italic>R</italic></sub></sub>)<sup><italic>T</italic></sup> and <italic>x</italic> = (<italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>N</italic><sub><italic>X</italic></sub></sub>)<sup><italic>T</italic></sup> gives an ODE model of the system
<disp-formula id="pcbi.1004235.e001"><alternatives><graphic id="pcbi.1004235.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>S</mml:mi> <mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where the stoichiometric matrix <italic>S</italic> maps reaction rates to the rate of change of concentrations.</p>
<p>The layered decomposition strategy [<xref ref-type="bibr" rid="pcbi.1004235.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004235.ref017">17</xref>] defines <italic>N</italic><sub><italic>L</italic></sub> new stoichiometric matrices <inline-formula id="pcbi.1004235.e002"><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>L</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula> such that <inline-formula id="pcbi.1004235.e003"><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>+</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>L</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula>, and defines <italic>N</italic><sub><italic>L</italic></sub> associated state variables <italic>x</italic><sup><italic>l</italic></sup> taking values <inline-formula id="pcbi.1004235.e004"><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mi>l</mml:mi></mml:msup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∈</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="pcbi.1004235.g001">Fig 1B</xref>). Each layer’s state <italic>x</italic><sup><italic>l</italic></sup> has dynamics
<disp-formula id="pcbi.1004235.e005"><alternatives><graphic id="pcbi.1004235.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e005"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mi>l</mml:mi></mml:msup> <mml:mi>v</mml:mi> <mml:mspace width="1pt"/> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mi>l</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
from initial conditions <italic>x</italic><sup><italic>l</italic></sup>(0) = 0, for <italic>l</italic> = 1, …, <italic>N</italic><sub><italic>L</italic></sub>. The original state’s dynamics are recovered by summing the layers’ states <inline-formula id="pcbi.1004235.e006"><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>L</mml:mi></mml:msub></mml:msubsup> <mml:msup><mml:mi>x</mml:mi> <mml:mi>l</mml:mi></mml:msup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Denote by <italic>r</italic> = rank(<italic>S</italic>) the dimension of the original system, which defines the dimension of the manifold in <inline-formula id="pcbi.1004235.e007"><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mo>ℝ</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula> in which <italic>x</italic>(<italic>t</italic>) evolves. It follows that <italic>r</italic><sup><italic>l</italic></sup> = rank(<italic>S</italic><sup><italic>l</italic></sup>) defines the dimension of the state space of each layer. Hence, even though the state space of each layer is also embedded in <inline-formula id="pcbi.1004235.e008"><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mo>ℝ</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula>, each layer is a lower-dimensional system than the original system if <italic>r</italic><sup><italic>l</italic></sup> &lt; <italic>r</italic>.</p>
<p>In our previous work, we have applied this decomposition strategy by choosing the matrices <italic>S</italic><sup><italic>l</italic></sup> to reflect timescale separation [<xref ref-type="bibr" rid="pcbi.1004235.ref017">17</xref>], and to reflect the propagation of steady-state responses to parametric perturbations [<xref ref-type="bibr" rid="pcbi.1004235.ref016">16</xref>]. A feature of both of these approaches was that, in the form (<xref ref-type="disp-formula" rid="pcbi.1004235.e005">2</xref>), each layer’s dynamics depend on all other layers’ states (as in <xref ref-type="fig" rid="pcbi.1004235.g001">Fig 1B</xref>, for example). Consequently, all layers had to be numerically integrated together, and the effect of one specific layer on all others could not be easily determined. Also, the approach was constrained to define layers by strict partitions of the reaction set, somewhat limiting its flexibility to capture the widest possible range of functional subsystems. In this article, we significantly extend the layering framework in two ways. First, we introduce the concept of functionalities, which are possibly overlapping sets of reactions working together for a common purpose. To enforce a cascade structure between the functionalities, we adapt the layered dynamics corresponding to each functionality depending on its position in the cascade. The following section will use this cascade structure to define the incremental dynamic effect of each functionality.</p>
</sec>
<sec id="sec004">
<title>Mapping Functionalities to Layers</title>
<p>Let a functionality <italic>F</italic><sup><italic>i</italic></sup> of a network be defined for <italic>i</italic> = 1, …, <italic>N</italic><sub><italic>L</italic></sub> to be a subset of <inline-formula id="pcbi.1004235.e009"><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mi>R</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> reactions <italic>F</italic><sup><italic>i</italic></sup> ⊆ {<italic>R</italic><sub>1</sub>, …, <italic>R</italic><sub><italic>N</italic><sub><italic>R</italic></sub></sub>} necessary to fulfil a given task of the network, where superscript integers index functionalities and their properties. It is assumed for the remainder of this section that these subsets are given, and that all reactions take part in at least one functionality.</p>
<p>The question of how to choose each subset <italic>F</italic><sup><italic>i</italic></sup> ⊆ {<italic>R</italic><sub>1</sub>, …, <italic>R</italic><sub><italic>N</italic><sub><italic>R</italic></sub></sub>} remains out of the scope of this work. Nevertheless, there are numerous non-modular decomposition strategies taken in recent related research that we can use to justify this definition of a functionality. For example, Oishi and Klavins [<xref ref-type="bibr" rid="pcbi.1004235.ref037">37</xref>] identify control blocks as specific groups of reactions, connected by shared species. Kurata <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1004235.ref038">38</xref>] identified reaction groups forming ‘flux modules’ in the <italic>Escherichia coli</italic> heat shock response system. Similarly, the decomposition of signalling networks into component pathways exhibiting crosstalk [<xref ref-type="bibr" rid="pcbi.1004235.ref008">8</xref>] also identifies functionalities as groups of reactions. Finally, we can also consider elementary flux modes (EFMs) of metabolic networks [<xref ref-type="bibr" rid="pcbi.1004235.ref013">13</xref>] as being sets of reactions with the specific ‘task’ of converting one or more substrates into given products. Several of these examples are explored further in the Results section of this paper.</p>
<p>In this section, we will assume that the functionalities are ordered by their index <inline-formula id="pcbi.1004235.e010"><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>L</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula>. We first identify the dynamics of the isolated functionality <italic>F</italic><sup>1</sup> as the dynamics of a biomolecular network consisting of only the reactions associated with <italic>F</italic><sup>1</sup>. We then identify the <italic>conditional dynamics</italic> of the next functionality in the cascade as the effect of extending the pre-existing network with the reactions in the new functionality.</p>
<p>First consider, without loss of generality, the network defined by only the subset of reactions making up functionality <italic>F</italic><sup>1</sup> ⊆ {<italic>R</italic><sub>1</sub>, …, <italic>R</italic><sub><italic>N</italic><sub><italic>R</italic></sub></sub>}, taken in isolation from the other reactions. For given initial conditions <italic>x</italic><sub>0</sub>, we now identify the isolated dynamics of this functionality as the solution to the layer
<disp-formula id="pcbi.1004235.e011"><alternatives><graphic id="pcbi.1004235.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e011"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
Here, the stoichiometric matrix <italic>S</italic><sup>1</sup> is defined
<disp-formula id="pcbi.1004235.e012"><alternatives><graphic id="pcbi.1004235.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e012"/><mml:math id="M12" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd> <mml:mtd columnalign="left"><mml:mtext>otherwise,</mml:mtext></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
by copying the columns of the original stoichiometric matrix <italic>S</italic> in (<xref ref-type="disp-formula" rid="pcbi.1004235.e001">1</xref>) corresponding to the reactions in <italic>F</italic><sup>1</sup> and setting the other columns to zero. We will denote this trajectory <italic>x</italic><sup>1</sup> = <italic>L</italic>(<italic>F</italic><sup>1</sup>), where the notation <italic>L</italic> represents a map from the functionality <italic>F</italic><sup>1</sup> to the solution <italic>x</italic><sup>1</sup> of the dynamics (<xref ref-type="disp-formula" rid="pcbi.1004235.e011">3</xref>) from initial conditions <italic>x</italic><sup>1</sup>(0) = 0.</p>
<p>Note that <italic>L</italic>(<italic>F</italic><sup>1</sup>) depends on the specific initial condition <italic>x</italic><sub>0</sub> of the network (<xref ref-type="disp-formula" rid="pcbi.1004235.e011">3</xref>), which is in general distinct from the initial condition <italic>x</italic><sup>1</sup>(0) = 0 of the layer’s state. To make this dependence explicit, it is sometimes helpful (see Examples 2 and 3) to define a ‘zero layer’ <italic>F</italic><sup>0</sup> with constant trajectory <italic>L</italic>(<italic>F</italic><sup>0</sup>) = <italic>x</italic><sub>0</sub>. We can then make clear that <italic>L</italic>(<italic>F</italic><sup>1</sup>) is dependent on the initial conditions by writing it as <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>). The layered framework also implies that the absolute concentrations in this network are modelled by the translated trajectory <italic>x</italic><sub>0</sub> + <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>).</p>
<p>We next consider extending the functionality <italic>F</italic><sup>1</sup> by combining it with the reactions in <italic>F</italic><sup>2</sup>. The extended network can be simulated through a similar process to the original network above, as follows. Define <italic>S</italic><sup>1,2</sup> as
<disp-formula id="pcbi.1004235.e013"><alternatives><graphic id="pcbi.1004235.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e013"/><mml:math id="M13" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>∪</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd> <mml:mtd columnalign="left"><mml:mtext>otherwise,</mml:mtext></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
considering only the reactions in at least one of <italic>F</italic><sup>1</sup> or <italic>F</italic><sup>2</sup>. Using <italic>S</italic><sup>1,2</sup> we can then simulate the layer corresponding to the extended network
<disp-formula id="pcbi.1004235.e014"><alternatives><graphic id="pcbi.1004235.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e014"/><mml:math id="M14" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
the solution of which can be written <italic>L</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>0</sup>) = <italic>x</italic><sup>1,2</sup>. This denotes the trajectory of the combined functionalities <italic>F</italic><sup>1</sup> and <italic>F</italic><sup>2</sup>.</p>
<p>The fact that each of (<xref ref-type="disp-formula" rid="pcbi.1004235.e011">3</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004235.e014">4</xref>) are layers with states in <inline-formula id="pcbi.1004235.e015"><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mo>ℝ</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula> implies that we can calculate the difference between each of the trajectories. This difference is clearly interpreted as the incremental effect of extending a network made up of the initial conditions <italic>F</italic><sup>0</sup> and the isolated functionality <italic>F</italic><sup>1</sup>, by also including <italic>F</italic><sup>2</sup>. We thus define
<disp-formula id="pcbi.1004235.e016"><alternatives><graphic id="pcbi.1004235.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e016"/><mml:math id="M16" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
as the <italic>conditional dynamics</italic> of <italic>F</italic><sup>2</sup>, given the specified context of <italic>F</italic><sup>1</sup> and the initial condition layer <italic>F</italic><sup>0</sup>.</p>
<p>However, rather than simulating the layer (<xref ref-type="disp-formula" rid="pcbi.1004235.e014">4</xref>) representing the combined functionalities, we may further exploit the layered framework described above to directly simulate <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>0</sup>). Suppose we already have <italic>x</italic><sup>1</sup> = <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>), found as the solution to the dynamics (<xref ref-type="disp-formula" rid="pcbi.1004235.e011">3</xref>). We now define the layer
<disp-formula id="pcbi.1004235.e017"><alternatives><graphic id="pcbi.1004235.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e017"/><mml:math id="M17" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
with <italic>S</italic><sup>1</sup> and <italic>S</italic><sup>1,2</sup> given above. Note that this layer is downstream of (<xref ref-type="disp-formula" rid="pcbi.1004235.e011">3</xref>), since it depends on the state <italic>x</italic><sup>1</sup>. It is clear from summing the vector fields in (<xref ref-type="disp-formula" rid="pcbi.1004235.e011">3</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004235.e017">6</xref>) that the sum (<italic>x</italic><sup>1</sup> + <italic>x</italic><sup>2</sup>) of the layers’ states follows exactly the same dynamics as the combined network’s state <italic>x</italic><sup>1,2</sup> in (<xref ref-type="disp-formula" rid="pcbi.1004235.e014">4</xref>). Thus, since <italic>x</italic><sup>2</sup> = <italic>x</italic><sup>1,2</sup> − <italic>x</italic><sup>1</sup> it follows that the dynamics (<xref ref-type="disp-formula" rid="pcbi.1004235.e017">6</xref>) directly simulate <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>0</sup>), with the input <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>) simulated by (<xref ref-type="disp-formula" rid="pcbi.1004235.e011">3</xref>).</p>
<p>We can rewrite the dynamics (<xref ref-type="disp-formula" rid="pcbi.1004235.e017">6</xref>) corresponding to the simulation of <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>0</sup>) as
<disp-formula id="pcbi.1004235.e018"><alternatives><graphic id="pcbi.1004235.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e018"/><mml:math id="M18" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>l</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7a)</label></disp-formula>
where <italic>S</italic><sup>2</sup> = <italic>S</italic><sup>1,2</sup> − <italic>S</italic><sup>1</sup> corresponds to the reactions in <italic>F</italic><sup>2</sup>\<italic>F</italic><sup>1</sup>, and
<disp-formula id="pcbi.1004235.e019"><alternatives><graphic id="pcbi.1004235.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e019"/><mml:math id="M19" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>l</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7b)</label></disp-formula>
are the rates of the ‘altered reactions’: the rates of reactions in <italic>F</italic><sup>1</sup> which are modified by the presence of <italic>F</italic><sup>2</sup> (shown as broken green arrows in <xref ref-type="fig" rid="pcbi.1004235.g001">Fig 1C</xref>). This description allows us to see the degree to which <italic>F</italic><sup>2</sup> is ‘downstream’ of <italic>F</italic><sup>1</sup>. For example, if <italic>v</italic><sub><italic>alt</italic></sub> = 0, then we can say that the reactions in <italic>F</italic><sup>1</sup> are independent of those in <italic>F</italic><sup>2</sup> and that <italic>F</italic><sup>2</sup> is strictly downstream of <italic>F</italic><sup>1</sup>. Note that, especially for larger networks, many of the altered reaction rates in <italic>v</italic><sub><italic>alt</italic></sub> are zero and can be omitted (see Example 3), simplifying simulation. Given that the trajectory of <italic>x</italic><sup>1</sup> is already determined from simulating (<xref ref-type="disp-formula" rid="pcbi.1004235.e011">3</xref>), we can simulate either (<xref ref-type="disp-formula" rid="pcbi.1004235.e017">6</xref>) or (<xref ref-type="disp-formula" rid="pcbi.1004235.e018">7a</xref>), using <italic>x</italic><sup>1</sup>(<italic>t</italic>) as a time-dependent input to obtain the conditional dynamics <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>1</sup>). The latter approach is taken in our examples (see <xref ref-type="sec" rid="sec007">Results</xref> section).</p>
<p>The definitions above easily extend to larger combinations of functionalities. In full generality, we can consider the network defined by the combination of <italic>n</italic><sub>1</sub> functionalities <inline-formula id="pcbi.1004235.e020"><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula>, and its extension through the additional <italic>n</italic><sub>2</sub> functionalities <inline-formula id="pcbi.1004235.e021"><mml:math id="M21" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>F</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. By writing <inline-formula id="pcbi.1004235.e022"><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>‾</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>∪</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>∪</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="pcbi.1004235.e023"><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>‾</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∪</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>∪</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, the definitions above can apply in the simulation of
<disp-formula id="pcbi.1004235.e024"><alternatives><graphic id="pcbi.1004235.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e024"/><mml:math id="M24" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mi>n</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msup> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Here we have defined a notation for the trajectory <inline-formula id="pcbi.1004235.e025"><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msup> <mml:mo stretchy="false">∣</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the biochemical network made up of the reactions which comprise an arbitrary combination of functionalities <inline-formula id="pcbi.1004235.e026"><mml:math id="M26" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula>. We have also defined the change in trajectory <inline-formula id="pcbi.1004235.e027"><mml:math id="M27" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo stretchy="false">∣</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> incurred by extending that network with the additional reactions in <inline-formula id="pcbi.1004235.e028"><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>F</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Finally, we have shown how to identify the dynamical systems that can simulate these trajectories.</p>
<p>Consider the two layers <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>1</sup>) and <italic>L</italic>(<italic>F</italic><sup>2</sup>) that both describe the effect of the functionality <italic>F</italic><sup>2</sup>. This effect is different depending on the presence or absence of <italic>F</italic><sup>1</sup>. The difference between these two trajectories defines how the presence of <italic>F</italic><sup>1</sup> changes the behaviour of <italic>F</italic><sup>2</sup>; that is, the dependence of <italic>F</italic><sup>2</sup> on <italic>F</italic><sup>1</sup>. We will now demonstrate how our layered analysis allows us to define the interdependence between two functionalities, thereby capturing the nonlinear effects arising from modelling a biomolecular network as being constructed from a combination of functional subsystems.</p>
</sec>
<sec id="sec005">
<title>Calculating with Layers</title>
<p>In order to quantify the interactions between functionalities, we can exploit the layered formulation above. For simplicity, from this point on we suppress the <italic>F</italic><sup>0</sup> notation, with the acknowledgement that all of the trajectories depend on the system’s initial conditions <italic>L</italic>(<italic>F</italic><sup>0</sup>) = <italic>x</italic><sub>0</sub>. The definition of conditional dynamics in (<xref ref-type="disp-formula" rid="pcbi.1004235.e016">5</xref>) implies that <italic>L</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) = <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>1</sup>) + <italic>L</italic>(<italic>F</italic><sup>1</sup>). This represents a layered cascade, where the dynamics of an integrated network are the linear combination of the conditional dynamics of its functionalities. There are two natural questions associated with this approach. First, how is the contribution of functionality <italic>F</italic><sup>2</sup>, considered in isolation, different from the conditional dynamics of <italic>F</italic><sup>2</sup> when integrated with <italic>F</italic><sup>1</sup>? Secondly, how is the behaviour of the integrated <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup> network different from the linear combination of the isolated functionalities? That is, how different is <italic>L</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) from <italic>L</italic>(<italic>F</italic><sup>1</sup>) + <italic>L</italic>(<italic>F</italic><sup>2</sup>)?</p>
<p>The answers to these two questions are the same. We denote the error incurred by approximating the integrated system as the linear combination of the isolated dynamics by the quantity <italic>M</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>), defined as
<disp-formula id="pcbi.1004235.e029"><alternatives><graphic id="pcbi.1004235.e029g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e029"/><mml:math id="M29" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
which we call <italic>mutual dynamics</italic>. This can be interpreted as the nonlinearity that arises from integrating the two functionalities together. Note that, since <italic>M</italic> is defined symmetrically, we can use (<xref ref-type="disp-formula" rid="pcbi.1004235.e016">5</xref>) to rewrite <italic>M</italic> as
<disp-formula id="pcbi.1004235.e030"><alternatives><graphic id="pcbi.1004235.e030g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e030"/><mml:math id="M30" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
Therefore <italic>M</italic> measures how the function of <italic>F</italic><sup>2</sup> (or <italic>F</italic><sup>1</sup>) is changed when considered in the context of <italic>F</italic><sup>1</sup> (or <italic>F</italic><sup>2</sup>). Thus <italic>M</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>) is a symmetric measure of the interdependence between the two functionalities. We use (<xref ref-type="disp-formula" rid="pcbi.1004235.e030">8</xref>) to calculate the the mutual dynamics between two functionalities, which requires us to first obtain either both trajectories <italic>L</italic>(<italic>F</italic><sup>1</sup>) and <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>2</sup>), or alternatively both trajectories <italic>L</italic>(<italic>F</italic><sup>2</sup>) and <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>1</sup>). These trajectories can be simulated, as described in the previous section, or calculated by the methods described in ‘Reducing Computational Burden’ below.</p>
<p>We have been careful to make explicit through our Bayesian-style notation that the dynamics of all functionalities are context-dependent. It is also the case that the interdependence between any two functionalities is context-dependent. Therefore, we need to extend the definition of mutual dynamics to consider how the interdependence between <italic>F</italic><sup>1</sup> and <italic>F</italic><sup>2</sup> is dependent on the wider context of the network, which we denote by another functionality, <italic>F</italic><sup>3</sup>. Similarly to the definition above, we can define the <italic>conditional mutual dynamics</italic> between <italic>F</italic><sup>1</sup> and <italic>F</italic><sup>2</sup>, given <italic>F</italic><sup>3</sup>, with the formula
<disp-formula id="pcbi.1004235.e031"><alternatives><graphic id="pcbi.1004235.e031g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e031"/><mml:math id="M31" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
to quantify the difference between the dynamics of the integrated and isolated functionalities <italic>F</italic><sup>1</sup> and <italic>F</italic><sup>2</sup>, in the context of <italic>F</italic><sup>3</sup>. As before, this can also be expressed in terms of layered dynamics as
<disp-formula id="pcbi.1004235.e032"><alternatives><graphic id="pcbi.1004235.e032g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e032"/><mml:math id="M32" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
to quantify how the effect of <italic>F</italic><sup>2</sup> on its context changes with the presence of <italic>F</italic><sup>1</sup>, and vice versa. The geometric intuition underlying the conditional mutual dynamics can be seen in <xref ref-type="fig" rid="pcbi.1004235.g002">Fig 2</xref>. The key interpretation of <italic>M</italic> is that it captures the nonlinearities that arise from combining <italic>F</italic><sup>1</sup> and <italic>F</italic><sup>2</sup> into a single network, conditioned on <italic>F</italic><sup>3</sup> if necessary.</p>
<fig id="pcbi.1004235.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g002</object-id>
<label>Fig 2</label>
<caption>
<title>(Conditional) layer dynamics, mutual dynamics, incompatibility, and cooperativity.</title>
<p>The joint dynamics <italic>L</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) is equal to the sum of the isolated dynamics <italic>L</italic>(<italic>F</italic><sup>1</sup>) [solid blue] and the conditional dynamics <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>1</sup>) [dashed red], or <italic>vice versa</italic> <italic>L</italic>(<italic>F</italic><sup>2</sup>) + <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>2</sup>) [solid red and dashed blue]. The mutual dynamics <italic>M</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>) [solid lilac] corresponds to the error made when approximating the joint dynamics <italic>L</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) with the sum of isolated dynamics <italic>L</italic>(<italic>F</italic><sup>1</sup>) + <italic>L</italic>(<italic>F</italic><sup>2</sup>). The cooperativity <italic>C</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>) is the cosine of the angle between −<italic>M</italic> and the sum of the isolated dynamics. In the example shown, the cooperativity is negative, indicating that the isolated behaviour <italic>L</italic>(<italic>F</italic><sup>1</sup>) + <italic>L</italic>(<italic>F</italic><sup>2</sup>) is attenuated when <italic>F</italic><sup>1</sup> and <italic>F</italic><sup>2</sup> are integrated together, although also with some orthogonal effects. The strength of their interaction is proportional to the incompatibility <italic>I</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>), defined as the ratio between the lengths of <italic>M</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>) and <italic>L</italic>(<italic>F</italic><sup>1</sup>) + <italic>L</italic>(<italic>F</italic><sup>2</sup>).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g002"/>
</fig>
<p>The conditional mutual dynamics <italic>M</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>3</sup>) is a time-varying, vector trajectory. We can base on <italic>M</italic> the following time-varying scalar, which we call the <italic>incompatibility</italic> and denote <italic>I</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>3</sup>) with formula
<disp-formula id="pcbi.1004235.e033"><alternatives><graphic id="pcbi.1004235.e033g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e033"/><mml:math id="M33" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>∥</mml:mo> <mml:mi>M</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo> <mml:mo>∥</mml:mo></mml:mrow> <mml:mrow><mml:mrow><mml:mo>∥</mml:mo> <mml:mrow><mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>∥</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
Here, ‖.‖ represents the Euclidean norm. In this paper we use the unweighted Euclidean norm, but in certain cases it might be appropriate to introduce a weight, for example if the concentrations of the species in a network are at different orders of magnitude. One might also decide to set the weight of certain intermediate species of limited interest to zero (see below).</p>
<p>This incompatibility measures the relative size of the error made by approximating the integration of two functionalities as the sum of their individual behaviour. To gain some intuition about this number, we can consider a number of special cases. If <italic>I</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>3</sup>) = 0, then this indicates that the trajectory of the integrated functionalities is simply the sum of the isolated functionalities’ trajectories: <italic>L</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>3</sup>) = <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>3</sup>) + <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>3</sup>). If the incompatibility is nonzero but small then <italic>L</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>3</sup>) ≈ <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>3</sup>) + <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>3</sup>) is a reasonable approximation, since the incurred error is relatively small. However, if <italic>I</italic> is of significant size, then the dynamics of the integrated functionalities can be expected to significantly differ from their individual behaviours.</p>
<p>Besides <italic>I</italic>, which measures the relative size of the mutual dynamics <italic>M</italic>, the direction of <italic>M</italic> is also important, since this determines if the integration of two functionalities together enhances or attenuates their individual dynamics, or causes other effects. We define the cooperativity <italic>C</italic> as the cosine of the angle between −<italic>M</italic> and the sum of the isolated layers:
<disp-formula id="pcbi.1004235.e034"><alternatives><graphic id="pcbi.1004235.e034g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e034"/><mml:math id="M34" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mrow><mml:mo>∥</mml:mo> <mml:mrow><mml:mi>M</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow/><mml:mo>∥</mml:mo></mml:mrow> <mml:mrow><mml:mo>∥</mml:mo> <mml:mrow><mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>∥</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
with ⋅ denoting the scalar product. See <xref ref-type="fig" rid="pcbi.1004235.g002">Fig 2</xref> for a geometric representation of <italic>C</italic>. Note that when using a weighted norm, the scalar product should be weighted accordingly. Again, we consider a number of special cases. Suppose that <italic>C</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>3</sup>) equals or is close to minus one, so that <italic>M</italic> is approximately parallel to and pointing in the same direction as <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>3</sup>) + <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>3</sup>). In this case the integrated dynamics can be approximated as an attenuation of the isolated behaviour
<disp-formula id="pcbi.1004235.e035"><alternatives><graphic id="pcbi.1004235.e035g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e035"/><mml:math id="M35" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>≈</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>I</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Conversely, if the cooperativity equals or is close to one, the two functionalities enhance each other, in the sense that we can approximate the integrated behaviour as an amplification of the isolated behaviours
<disp-formula id="pcbi.1004235.e036"><alternatives><graphic id="pcbi.1004235.e036g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e036"/><mml:math id="M36" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>I</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
However, once the cooperativity <italic>C</italic> equals or is close to zero, the mutual dynamics <italic>M</italic> are orthogonal to <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>3</sup>) + <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>3</sup>). This means that when the functionalities are integrated, both isolated functionalities are maintained, but there are also additional interactions (with an effect of strength <italic>I</italic>) in directions orthogonal to the summed isolated dynamics. For example, suppose that the functionalities <italic>F</italic><sup>1</sup> and <italic>F</italic><sup>2</sup> correspond to sets of reactions responsible for mediating the cellular responses to two different input signals. By setting the influence of all but the common output (measured) species to zero, an incompatibility <italic>I</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>) close to zero corresponds to an additive interaction of the input signals. If <italic>I</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>) is larger, it may correspond to either a synergetic (for <italic>C</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>) = 1) or antagonistic (for <italic>C</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>) = −1) interaction (see e.g. [<xref ref-type="bibr" rid="pcbi.1004235.ref028">28</xref>]). Note that for a scalar output, orthogonal dynamics are not possible.</p>
<p>For systems composed of many different functionalities, one might also take the time averages ⟨<italic>I</italic>⟩ and ⟨<italic>C</italic>⟩ of the incompatibility, respectively the cooperativity, over the simulation time Δ<italic>T</italic> to obtain single measures quantifying the interactions between layers:
<disp-formula id="pcbi.1004235.e037"><alternatives><graphic id="pcbi.1004235.e037g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e037"/><mml:math id="M37" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>⟨</mml:mo> <mml:mi>I</mml:mi> <mml:mo>⟩</mml:mo> <mml:mspace width="1pt"/> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:mfrac> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:msubsup> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>⟨</mml:mo> <mml:mi>C</mml:mi> <mml:mo>⟩</mml:mo> <mml:mspace width="1pt"/> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:mfrac> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:msubsup> <mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Although they are useful for obtaining a first impression of how functionalities interact, time averages should be carefully applied. They can hide transient interactions between functionalities, including potential sign changes of the state-dependent cooperativities (see Example 1).</p>
<p>We have now identified how to measure the interdependence between two functionalities, which we have defined as the change in the dynamics of one functionality when the other is present. We have made explicit how this interdependence is itself dependent on the context of the rest of the network. In the remainder of this section we will describe how to minimise the computational burden incurred when calculating all possible interactions between functionalities.</p>
</sec>
<sec id="sec006">
<title>Reducing Computational Burden</title>
<p>The notation <italic>L</italic>(<italic>F</italic><sup>1</sup>) and <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>1</sup>) describing the map from a functionality (or set of functionalities) to the resulting trajectory simplifies the calculations we may wish to carry out to understand how the functionalities combine. Using the key definition of ‘conditional dynamics’ given by (<xref ref-type="disp-formula" rid="pcbi.1004235.e016">5</xref>), we can prove a number of rules for combining layers which appear analogous to those known from Information Theory [<xref ref-type="bibr" rid="pcbi.1004235.ref039">39</xref>]. For example, for two random variables <italic>X</italic> and <italic>Y</italic>, the well-known quantities of joint entropy <italic>H</italic>(<italic>X</italic>, <italic>Y</italic>) = <italic>H</italic>(<italic>X</italic>) + <italic>H</italic>(<italic>Y</italic>∣<italic>X</italic>) and mutual information <italic>I</italic>(<italic>X</italic>; <italic>Y</italic>) = <italic>H</italic>(<italic>X</italic>) − <italic>H</italic>(<italic>X</italic>∣<italic>Y</italic>) are each definitions of the same form as those given above of conditional dynamics (<xref ref-type="disp-formula" rid="pcbi.1004235.e016">5</xref>) and mutual dynamics (<xref ref-type="disp-formula" rid="pcbi.1004235.e030">8</xref>) respectively. However, it is important to note that this similarity is only superficial, and any intuition gained by seeking analogies between our work and information theoretic concepts should be applied carefully. This caveat applies in particular to the two results below.</p>
<p>Two lemmas allowing the quick combination of layer dynamics can be easily proved directly from the definitions of <italic>L</italic>(<italic>F</italic><sup>1</sup>) and <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>1</sup>), their extensions to larger combinations of functionalities, and <xref ref-type="disp-formula" rid="pcbi.1004235.e016">Eq (5)</xref>. The first is an analogue of Bayes’ Rule, given by
<disp-formula id="pcbi.1004235.e038"><alternatives><graphic id="pcbi.1004235.e038g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e038"/><mml:math id="M38" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
We will demonstrate how this rule can be used for quickly deducing the incremental effects of layers when combined in a different order. This is fundamental, since a natural ordering of the layers is generally not given. A second rule, which is analogous to Bayes’ Factor, is given by
<disp-formula id="pcbi.1004235.e039"><alternatives><graphic id="pcbi.1004235.e039g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e039"/><mml:math id="M39" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mtext>Posterior</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>Dynamics</mml:mtext></mml:mrow></mml:munder> <mml:mo>=</mml:mo> <mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mtext>Bayes</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>Factor</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>B</mml:mi> <mml:mrow><mml:mn>32</mml:mn> <mml:mo>|</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mo>+</mml:mo> <mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mtext>Prior</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>dynamics</mml:mtext></mml:mrow></mml:munder> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
This rule applies when we have a choice between integrating two functionalities to the <italic>F</italic><sup>1</sup>-only network. The difference in their effects is decomposed into the difference <italic>L</italic>(<italic>F</italic><sup>3</sup>) − <italic>L</italic>(<italic>F</italic><sup>2</sup>) between their isolated behaviours, summed with the difference <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>3</sup>) − <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>2</sup>) in the incremental effect of <italic>F</italic><sup>1</sup> on each. We can use these rules to compute all possible functionality combinations with a minimal amount of simulation.</p>
<p>In order to answer particular biological questions, we may be interested in the incremental effect of a given functionality on a specific ‘base’ network, such as those described in Examples 1 and 2 in the <italic>Results</italic> section. In other cases we may be interested in all possible interactions between the functionalities, such as the situation in Example 3. In a biochemical network whose reactions are decomposed into <italic>N</italic><sub><italic>L</italic></sub> functionalities, the latter case suggests that we must simulate all <italic>N</italic><sub><italic>L</italic></sub> layers for each of the <italic>N</italic><sub><italic>L</italic></sub>! different orderings of the functionalities, resulting in (<italic>N</italic><sub><italic>L</italic></sub> + 1)! − <italic>N</italic><sub><italic>L</italic></sub>! layers to be numerically solved. This burden can be significantly reduced using the calculation rules deduced above.</p>
<p>The cascaded layers representing all possible orderings of functionalities can be arranged in an acyclic directed graph, shown in <xref ref-type="fig" rid="pcbi.1004235.g003">Fig 3</xref>. Each node represents the trajectory arising from the incremental addition of a new functionality, given those already present. The graph is organised into levels, corresponding to the position of the new layer in the sequence. The root of the layering graph (referred to as Level 0) represents the given initial conditions <italic>x</italic><sub>0</sub>. Each of the subsequent levels <italic>l</italic> = 1, …, <italic>N</italic><sub><italic>L</italic></sub> consists of <inline-formula id="pcbi.1004235.e040"><mml:math id="M40" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> nodes. Each node represents the dynamics of a functionality <italic>F</italic><sup><italic>i</italic></sup> conditioned on a subset of size <italic>l</italic> − 1 of the remaining functionalities <italic>F</italic><sup><italic>j</italic></sup>, <italic>j</italic> ≠ <italic>i</italic>. A directed edge from a node in Level <italic>l</italic> to a node in Level <italic>l</italic> + 1 exists if the node in Level <italic>l</italic> + 1 is conditioned on all functionalities taking part in the node in Level <italic>l</italic>.</p>
<fig id="pcbi.1004235.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Layering graph with the (conditional) dynamics of <italic>N</italic><sub><italic>L</italic></sub> = 3 functionalities in all orders.</title>
<p>The root of the graph at Level 0 represents the initial conditions of the network (<italic>L</italic>(<italic>F</italic><sup>0</sup>) = <italic>x</italic><sub>0</sub>, with <italic>F</italic><sup>0</sup> = {}). Each path from the root to a leaf represents a different ordering of the functionalities <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>, and <italic>F</italic><sup>3</sup>. The nodes correspond to the layers for a given ordering of functionalities. Due to symmetries, only seven of the twelve (conditional) layer dynamics have to be obtained by integration of the respective models of the layers to get to know the dynamics of all layers in all orderings. A possible choice for these layer dynamics is indicated by double boundaries around the respective nodes. The dynamics of the other layers can be obtained by applying Bayes’ rule. Graph drawn with Graphviz [<xref ref-type="bibr" rid="pcbi.1004235.ref057">57</xref>].</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g003"/>
</fig>
<p>Each directed path from Level 0 to Level <italic>N</italic><sub><italic>L</italic></sub> (i.e. from the root to a leaf) represents one of the <italic>N</italic><sub><italic>L</italic></sub>! possible orderings of functionalities. By adding up the layer dynamics corresponding to the nodes in each path, the trajectory of the complete network is obtained. Each node in Level 1 represents the dynamics of an isolated functionality. The dynamics represented by the nodes at the leaves of the layering graph are also of specific interest. Multiplying the layer dynamics in a given node in Level <italic>N</italic><sub><italic>L</italic></sub> (corresponding to a particular functionality <italic>F</italic><sup><italic>i</italic></sup>) by −1 gives the change in the dynamics that results from <italic>removing</italic> <italic>F</italic><sup><italic>i</italic></sup> from the system while keeping all other functionalities intact (see Example 3).</p>
<p>To obtain the dynamics of all layers for all orderings of functionalities, we can use rules (<xref ref-type="disp-formula" rid="pcbi.1004235.e038">11</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004235.e039">12</xref>) to exploit certain symmetries in the layering graph and reduce the number of numerical integrations of layer ODE systems. If all of the dynamics in Level <italic>l</italic> − 1 are already known, it is only necessary to numerically solve <inline-formula id="pcbi.1004235.e041"><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>N</mml:mi> <mml:mi>L</mml:mi></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="center"><mml:mi>l</mml:mi></mml:mtd></mml:mtr></mml:mtable> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> layer dynamics in Level <italic>l</italic>. The rest of the level can then be deduced using Bayes’ rule (<xref ref-type="disp-formula" rid="pcbi.1004235.e038">11</xref>). For example, suppose we have the trajectories of all nodes in Layer 1, and have simulated <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>2</sup>) in Level 2. Using (<xref ref-type="disp-formula" rid="pcbi.1004235.e038">11</xref>) we can deduce <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>) without having to simulate again. In fact, when considering a network with <italic>N</italic><sub><italic>L</italic></sub> functionalities, only
<disp-formula id="pcbi.1004235.e042"><alternatives><graphic id="pcbi.1004235.e042g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e042"/><mml:math id="M42" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>L</mml:mi></mml:msub></mml:munderover> <mml:mo>(</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>N</mml:mi> <mml:mi>L</mml:mi></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>l</mml:mi></mml:mtd></mml:mtr></mml:mtable> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:msup><mml:mn>2</mml:mn> <mml:msub><mml:mi>N</mml:mi> <mml:mi>L</mml:mi></mml:msub></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
layers have to be numerically integrated (see Example 1), compared to (<italic>N</italic><sub><italic>L</italic></sub> + 1)! − <italic>N</italic><sub><italic>L</italic></sub>! integrations necessary when analyzing all orderings separately. Although the number of integrations still exponentially grows with <italic>N</italic><sub><italic>L</italic></sub>, it nevertheless becomes possible to analyse systems with up to ten or more distinct functionalities in reasonable time. For <italic>N</italic><sub><italic>L</italic></sub> = 10, integrating every layer would require more than 3.5 ⋅ 10<sup>4</sup> times as much computational time as is required by exploiting (<xref ref-type="disp-formula" rid="pcbi.1004235.e038">11</xref>).</p>
<p>Furthermore, the symmetry of the layering graph allows a certain degree of freedom in choosing which layers to simulate, and which to deduce from (<xref ref-type="disp-formula" rid="pcbi.1004235.e038">11</xref>). In particular, one should always choose to simulate the simplest layers, with respect to the number of states or reactions in the respective ODE system. <xref ref-type="fig" rid="pcbi.1004235.g003">Fig 3</xref> shows the situation where <italic>N</italic><sub><italic>L</italic></sub> = 3: we need to simulate 2<sup>3</sup> − 1 = 7 layers. We have decided to, wherever possible, simulate <italic>F</italic><sup>3</sup>, ahead of <italic>F</italic><sup>2</sup>, ahead of <italic>F</italic><sup>1</sup>. After simulating the isolated behaviour <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>) of the functionality <italic>F</italic><sup>1</sup>, we can calculate its behaviour in any other context without having to simulate it again. For example, <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>2</sup>) can be calculated, using (<xref ref-type="disp-formula" rid="pcbi.1004235.e038">11</xref>), as <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>) + <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>) − <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>0</sup>). Similarly, substituting the resulting trajectory into (<xref ref-type="disp-formula" rid="pcbi.1004235.e038">11</xref>) once more means that we can calculate <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>2</sup>, <italic>F</italic><sup>3</sup>) as the linear combination <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) + <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>2</sup>) − <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>2</sup>). As can be seen by the indicated nodes in <xref ref-type="fig" rid="pcbi.1004235.g003">Fig 3</xref>, only one layer corresponding to <italic>F</italic><sup>1</sup> had to be numerically simulated, whereas we simulated layers corresponding to <italic>F</italic><sup>2</sup> twice, and layers corresponding to <italic>F</italic><sup>3</sup> four times. Thus we can reduce computation time even further by avoiding the repeated simulation of high-dimensional layers.</p>
</sec>
</sec>
<sec id="sec007" sec-type="results">
<title>Results</title>
<p>We now apply our layered approach to three examples of multi-functional biomolecular systems. In each case, we can show how the effect of each functionality in a network is dependent on the others. We exploit the formulation of mutual dynamics to quantify the interdependence between different functionalities.</p>
<sec id="sec008">
<title>Example 1: Crosstalk</title>
<p>The high osmolarity glycerol and the pheromone response mitogen-activated protein (MAP) kinase pathways in <italic>S. cerevisiae</italic> share the common species <italic>Ste11</italic> [<xref ref-type="bibr" rid="pcbi.1004235.ref040">40</xref>]. Such a common species can constitute a mutually excitatory crosstalk mechanism by cross-activating one pathway upon activation of the other. However, McClean <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1004235.ref008">8</xref>] observed that only one pathway responds, and deduced that a second, mutually inhibitory crosstalk mechanism exists. They constructed a model, available as Model 115 in the BioModels Database [<xref ref-type="bibr" rid="pcbi.1004235.ref041">41</xref>], that includes both crosstalk mechanisms.</p>
<p>As an initial example of our approach we implemented a layered decomposition of this model, shown in <xref ref-type="fig" rid="pcbi.1004235.g004">Fig 4</xref>. The mathematical description of the complete model and of all layers can be found in the Supporting Information. We applied our framework to systematically investigate the function of each of the crosstalk mechanisms. We first considered the effects of each crosstalk mechanism on the signalling pathways. This gives some indication of the function of each crosstalk mechanism, but our framework takes this analysis further. The effect of excitatory crosstalk on the network is altered by the presence of inhibitory crosstalk, and <italic>vice versa</italic>. The conditional mutual dynamics between the two crosstalk mechanisms, integrated with the crosstalk-free network, can be used to quantify their interdependence.</p>
<fig id="pcbi.1004235.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Signalling pathways with crosstalk.</title>
<p>This figure shows two signalling pathways, with two crosstalk mechanisms. Functionality <italic>F</italic><sup>1</sup> = {<italic>R</italic><sub>1</sub>, <italic>R</italic><sub>2</sub>, <italic>R</italic><sub>3</sub>} is the <italic>X</italic> pathway; <italic>F</italic><sup>2</sup> = {<italic>R</italic><sub>4</sub>, <italic>R</italic><sub>5</sub>, <italic>R</italic><sub>6</sub>} is the <italic>Y</italic> pathway; the mutually inhibiting crosstalk <italic>F</italic><sup>3</sup> = {<italic>R</italic><sub>7</sub>, <italic>R</italic><sub>8</sub>}; and the mutually excitatory crosstalk <italic>F</italic><sup>4</sup> = {<italic>R</italic><sub>9</sub>, <italic>R</italic><sub>10</sub>}. Model adopted from [<xref ref-type="bibr" rid="pcbi.1004235.ref008">8</xref>].</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g004"/>
</fig>
<p>In the model, we set the strength of the mutually excitatory crosstalk to <italic>k</italic><sub><italic>a</italic></sub> = 0.1 and the strength of the mutually inhibitory crosstalk to <italic>k</italic><sub><italic>d</italic></sub> = 1, corresponding to a monostable network (see Fig. 1 in [<xref ref-type="bibr" rid="pcbi.1004235.ref008">8</xref>]). We assume zero initial conditions. The three reactions <italic>R</italic><sub>1</sub>, <italic>R</italic><sub>2</sub>, and <italic>R</italic><sub>3</sub> represent the first signal transduction pathway, which affects species concentrations <italic>X</italic><sub>1</sub>–<italic>X</italic><sub>3</sub>, so that we define the functionality <italic>F</italic><sup>1</sup> = {<italic>R</italic><sub>1</sub>, <italic>R</italic><sub>2</sub>, <italic>R</italic><sub>3</sub>}. Similarly, we choose <italic>F</italic><sup>2</sup> = {<italic>R</italic><sub>4</sub>, <italic>R</italic><sub>5</sub>, <italic>R</italic><sub>6</sub>} to represent the second signal transduction pathway, affecting species <italic>Y</italic><sub>1</sub>–<italic>Y</italic><sub>3</sub>. The mutually inhibiting crosstalk between the two pathways comprises <italic>F</italic><sup>3</sup> = {<italic>R</italic><sub>7</sub>, <italic>R</italic><sub>8</sub>}. Finally, the mutually excitatory crosstalk is given by <italic>F</italic><sup>4</sup> = {<italic>R</italic><sub>9</sub>, <italic>R</italic><sub>10</sub>}.</p>
<p>We first calculated all of the possible incremental effects of each functionality <italic>F</italic><sup><italic>i</italic></sup> integrated with each possible subset {<italic>F</italic><sup><italic>j</italic></sup> ∣ <italic>j</italic> ≠ <italic>i</italic>} of the others. Since we have <italic>N</italic><sub><italic>L</italic></sub> = 4 functionalities we only need to simulate <inline-formula id="pcbi.1004235.e043"><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mn>2</mml:mn> <mml:msub><mml:mi>N</mml:mi> <mml:mi>L</mml:mi></mml:msub></mml:msup> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula> layers to be able to calculate all <italic>N</italic><sub><italic>L</italic></sub> ⋅ <italic>N</italic><sub><italic>L</italic></sub>! = 96 layer dynamics for all orderings of the functionalities. <xref ref-type="fig" rid="pcbi.1004235.g005">Fig 5</xref> shows the trajectories corresponding to several of these nodes. The plots were generated for time-varying inputs <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> given by
<disp-formula id="pcbi.1004235.e044"><alternatives><graphic id="pcbi.1004235.e044g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e044"/><mml:math id="M44" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mn>20</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>[</mml:mo> <mml:mn>5</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>20</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mn>40</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>[</mml:mo> <mml:mn>5</mml:mn> <mml:mo>,</mml:mo> <mml:mn>5</mml:mn> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>40</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mn>80</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>5</mml:mn> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>80</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mn>100</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>[</mml:mo> <mml:mn>5</mml:mn> <mml:mo>,</mml:mo> <mml:mn>5</mml:mn> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>100</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<fig id="pcbi.1004235.g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g005</object-id> <label>Fig 5</label> <caption><title>Layer dynamics of the crosstalk example.</title> <p>Dynamics of the layers for switching between different input combinations: (-/-) <italic>S</italic><sub>1</sub> = <italic>S</italic><sub>2</sub> = 0; (+/-) <italic>S</italic><sub>1</sub> = 5, <italic>S</italic><sub>2</sub> = 0; (+/+) <italic>S</italic><sub>1</sub> = <italic>S</italic><sub>2</sub> = 5; and (-/+) <italic>S</italic><sub>1</sub> = 0, <italic>S</italic><sub>2</sub> = 5. The top left figure corresponds to the dynamics of the complete network, the central and right top figure to the dynamics of the two isolated signalling pathways without any crosstalk. If the mutually inhibitory crosstalk <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) is added first, the network becomes bistable, then monostable again by then including the mutually excitatory crosstalk <italic>L</italic>(<italic>F</italic><sup>4</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>, <italic>F</italic><sup>3</sup>). Adding first the excitatory crosstalk <italic>L</italic>(<italic>F</italic><sup>4</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) leads to strong cross-activation of the pathways, which is significantly weakened by the mutual inhibitory crosstalk <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>, <italic>F</italic><sup>4</sup>).</p></caption> <graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g005"/></fig>
The switching times between the input combinations were chosen such that, at the end of each period, the species of the network have converged to their corresponding steady-state concentrations.</p>
<p>The top-left plot in <xref ref-type="fig" rid="pcbi.1004235.g005">Fig 5</xref> shows the response <italic>L</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>, <italic>F</italic><sup>3</sup>, <italic>F</italic><sup>4</sup>) of the entire network to this input pattern. Each of the other plots depicts the incremental effects of integrating a certain functionality with a group of others. <xref ref-type="fig" rid="pcbi.1004235.g006">Fig 6</xref> depicts the trajectories of the mutual dynamics between several pairs of functionalities, also calculated from the 15 simulations of layered ODE systems. Below these trajectories we plot their corresponding incompatibilities <italic>I</italic> and cooperativities <italic>C</italic>.</p>
<fig id="pcbi.1004235.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Mutual dynamics, incompatibilities and cooperativities between the layers of the crosstalk example.</title>
<p>See the caption of <xref ref-type="fig" rid="pcbi.1004235.g005">Fig 5</xref> for details. The first column considers the nonlinear interaction of mutual inhibition with the isolated pathways; the second column replaces mutual inhibition with mutual excitation; the third column captures the nonlinear effects of combining the inhibition and excitation crosstalk mechanisms.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g006"/>
</fig>
<p>We consider the basic network comprised only of <italic>F</italic><sup>1</sup> and <italic>F</italic><sup>2</sup>, where neither crosstalk mechanism is active. From <italic>L</italic>(<italic>F</italic><sup>1</sup>) and <italic>L</italic>(<italic>F</italic><sup>2</sup>) in <xref ref-type="fig" rid="pcbi.1004235.g005">Fig 5</xref> we see that after <italic>t</italic> = 20 (respectively, <italic>t</italic> = 40) the concentrations of species <italic>X</italic><sub>1</sub>–<italic>X</italic><sub>3</sub> (respectively, <italic>Y</italic><sub>1</sub>–<italic>Y</italic><sub>3</sub>) quickly saturate. It is easily shown that the mutual dynamics between the two isolated pathways <italic>M</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>) = 0. This means that there is no interdependency between the pathways, and their integrated dynamics equal the sum of their isolated dynamics. Of course, this conclusion is intuitively clear because we are considering a network with neither crosstalk mechanism active. We are now in a position to investigate what each crosstalk mechanism does to this basic network, by identifying the effects of each of <italic>F</italic><sup>3</sup> and <italic>F</italic><sup>4</sup> in turn.</p>
<p>We first identify the effect of the mutual inhibitory crosstalk <italic>F</italic><sup>3</sup> on the basic network. This is depicted in <xref ref-type="fig" rid="pcbi.1004235.g005">Fig 5</xref> by <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>). The input signals <italic>S</italic><sub>1</sub> = <italic>S</italic><sub>2</sub> = 5 are both ‘on’ during two time intervals <italic>t</italic> ∈ [40, 80] and <italic>t</italic> ≥ 100. In each of these time intervals, we can observe in <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) two different steady states of <italic>X</italic><sub>1</sub>–<italic>X</italic><sub>3</sub> and <italic>Y</italic><sub>1</sub>–<italic>Y</italic><sub>3</sub>. Thus one effect of mutual inhibition is that the resulting network is bistable. We can also observe that the <italic>X</italic><sub>1</sub>–<italic>X</italic><sub>3</sub> values of <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>), which show the effect of <italic>F</italic><sup>3</sup> on the <italic>X</italic><sub><italic>i</italic></sub> concentrations, become sufficiently negative during <italic>t</italic> ∈ [80, 100] that they cancel out the positive values of <italic>X</italic><sub>1</sub>–<italic>X</italic><sub>3</sub> in <italic>L</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>). Hence, we can conclude that, by integrating mutual inhibition with the basic network, the removal of <italic>S</italic><sup>1</sup> at <italic>t</italic> = 80 now causes the corresponding pathway to deactivate. We can also analyse the interaction between mutual inhibition and the basic network in terms of the mutual dynamics <italic>M</italic>(<italic>F</italic><sup>3</sup>; <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>), as depicted in <xref ref-type="fig" rid="pcbi.1004235.g006">Fig 6</xref>. For <italic>t</italic> ≥ 40, the cooperativity <italic>C</italic>(<italic>F</italic><sup>3</sup>; <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) is always negative, and the incompatibility <italic>I</italic>(<italic>F</italic><sup>3</sup>; <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) is high. Thus, the effect of integrating <italic>F</italic><sup>3</sup> with (<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) is to strongly attenuate the levels of all species from their saturated state.</p>
<p>We next consider the effect on the basic network of mutually excitatory crosstalk <italic>F</italic><sup>4</sup>, depicted by <italic>L</italic>(<italic>F</italic><sup>4</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) in <xref ref-type="fig" rid="pcbi.1004235.g005">Fig 5</xref>. We will focus in particular on the time interval <italic>t</italic> ∈ [20, 40], where <italic>S</italic><sub>1</sub> is first activated. For this time interval, the concentrations of <italic>Y</italic><sub>2</sub> and <italic>Y</italic><sub>3</sub> increase, while the concentrations of <italic>X</italic><sub>1</sub>–<italic>X</italic><sub>3</sub> are transiently reduced. Thus the effect of including mutual excitation is that a non-zero input <italic>S</italic><sub>1</sub> is sufficient to activate the second pathway, as well as the first. As in the previous case, we can also analyse the interaction between mutual excitation and the basic network in terms of the mutual dynamics <italic>M</italic>(<italic>F</italic><sup>4</sup>; <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>), as depicted in <xref ref-type="fig" rid="pcbi.1004235.g006">Fig 6</xref>. In this time interval, the cooperativity <italic>C</italic>(<italic>F</italic><sup>4</sup>; <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) is briefly negative before returning to zero, while the incompatibility <italic>I</italic>(<italic>F</italic><sup>4</sup>; <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) increases monotonically and converges to around 0.81. Negative cooperativity implies that mutual excitation attenuates the isolated dynamics, although only marginally since <italic>I</italic> is small. This attenuation is also only transient; <italic>C</italic> approaches zero and <italic>I</italic> approaches approximately 0.81 as <italic>t</italic>→40. Thus, by the end of this time interval, integrating mutual excitation creates a significant additional effect in a direction orthogonal to the isolated dynamics. This is intuitively clear, since the incremental effect of mutual excitation is the additive excitation of <italic>Y</italic><sub>2</sub> and <italic>Y</italic><sub>3</sub>, orthogonal to the saturation of <italic>X</italic><sub>1</sub>–<italic>X</italic><sub>3</sub> during <italic>t</italic> ∈ [20, 40].</p>
<p>We have identified the effect of each crosstalk mechanism on the basic network. However, we can see from the plots of <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>, <italic>F</italic><sup>4</sup>) and <italic>L</italic>(<italic>F</italic><sup>4</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>, <italic>F</italic><sup>3</sup>) that the function of each crosstalk mechanism (when defined as its incremental effect on a network) is very different when the other crosstalk mechanism is present. We can see from the first of these trajectories that one effect of integrating inhibition into the cross-activated network is to effectively insulate the <italic>Y</italic><sub>1</sub>–<italic>Y</italic><sub>3</sub> pathway, since the excitation shown by <italic>L</italic>(<italic>F</italic><sup>4</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) during <italic>t</italic> ∈ [20, 40] is cancelled out by the values of <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>, <italic>F</italic><sup>4</sup>). Furthermore, on comparing <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>, <italic>F</italic><sup>4</sup>) with <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) we can see that mutual inhibition has remarkably different incremental effects depending on whether or not mutual excitation is present. This can be quantified by observing the trajectory of
<disp-formula id="pcbi.1004235.e045"><alternatives><graphic id="pcbi.1004235.e045g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e045"/><mml:math id="M45" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>4</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mn>4</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and the associated <italic>C</italic> and <italic>I</italic> values in the right-hand plots of <xref ref-type="fig" rid="pcbi.1004235.g006">Fig 6</xref>. For <italic>t</italic> ∈ [20, 40], the value of <italic>I</italic>(<italic>F</italic><sup>3</sup>; <italic>F</italic><sup>4</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) is large, and <italic>C</italic>(<italic>F</italic><sup>3</sup>; <italic>F</italic><sup>4</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) is close to −1. This confirms the assertion above that, in this time interval, the interdependence between crosstalk mechanisms causes them to approximately cancel each other out, so that the behaviour of the entire system is much like that of the isolated pathways. We can observe that, in this time interval, the effect of mutual inhibition on the basic network <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) is zero. However, non-zero mutual dynamics <italic>M</italic>(<italic>F</italic><sup>3</sup>; <italic>F</italic><sup>4</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) in this time interval means that the presence of mutual excitation causes the inhibition crosstalk to have a non-zero function.</p>
<p>To summarise, we have demonstrated how to use the concepts of conditional dynamics <italic>L</italic>(<italic>F</italic><sup><italic>i</italic></sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) and mutual dynamics <italic>M</italic>(<italic>F</italic><sup><italic>i</italic></sup>; <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) to analyse the effect of each crosstalk mechanism on a pair of isolated pathways. We extended this analysis by using <italic>M</italic>(<italic>F</italic><sup>3</sup>; <italic>F</italic><sup>4</sup>∣<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) to quantify how, by integrating the crosstalk mechanisms together, they influence one another’s isolated functions.</p>
</sec>
<sec id="sec009">
<title>Example 2: Controller</title>
<p>This example illustrates the application of our layered framework to a toy network, comprised of a biomolecular cascade containing two integral feedback motifs (<xref ref-type="fig" rid="pcbi.1004235.g007">Fig 7</xref>). This toy network was adapted from a motif identified in [<xref ref-type="bibr" rid="pcbi.1004235.ref042">42</xref>] as sufficient to exhibit perfect adaptation to changing external input concentrations, and underlying the ability of the chemotaxis pathway in <italic>E. coli</italic> to show near-perfect adaptation to extracellular chemoattractant concentrations [<xref ref-type="bibr" rid="pcbi.1004235.ref043">43</xref>–<xref ref-type="bibr" rid="pcbi.1004235.ref045">45</xref>].</p>
<fig id="pcbi.1004235.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Interacting feedback control for perfect adaptation.</title>
<p>A single pathway representing the concentration of two intermediates <italic>Y</italic><sub>1</sub> and <italic>Y</italic><sub>2</sub>, the level of each of which needs to be kept at equilibrium. This system applies two integral feedback controllers, assuming parameters <italic>m</italic><sub>−<italic>a</italic></sub> and <italic>m</italic><sub>−<italic>b</italic></sub> are small relative to concentrations <italic>a</italic> and <italic>b</italic>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g007"/>
</fig>
<p>The network consists of two intermediates, <italic>Y</italic><sub>1</sub> and <italic>Y</italic><sub>2</sub>. The species <italic>Y</italic><sub>1</sub> is produced with a time-varying rate <italic>k</italic>(<italic>t</italic>) depending on the concentrations of one or more external species. Intermediate <italic>Y</italic><sub>1</sub> is irreversibly converted to <italic>Y</italic><sub>2</sub> at rate <italic>V</italic><sub>1</sub>(<italic>y</italic><sub>1</sub>) and <italic>Y</italic><sub>2</sub> is consumed with rate <italic>V</italic><sub>2</sub>(<italic>y</italic><sub>2</sub>), each following Michaelis-Menten kinetics (see <xref ref-type="fig" rid="pcbi.1004235.g007">Fig 7</xref>). For certain production rates of <italic>Y</italic><sub>1</sub>, <italic>V</italic><sub>1</sub> is close to saturation so that the concentration of <italic>Y</italic><sub>1</sub> eventually becomes unstable for high rates <italic>k</italic>(<italic>t</italic>).</p>
<p>To stabilise the network and achieve perfect adaptation of the concentrations of <italic>Y</italic><sub>1</sub> and <italic>Y</italic><sub>2</sub> to slowly changing production rates <italic>k</italic>(<italic>t</italic>), the network needs to be controlled. Such controllers can be implemented through additional Michaelis-Menten reactions <italic>V</italic><sub><italic>a</italic></sub>(<italic>y</italic><sub>1</sub>) and <italic>V</italic><sub><italic>b</italic></sub>(<italic>y</italic><sub>2</sub>) forming species <italic>A</italic> and <italic>B</italic> from <italic>Y</italic><sub>1</sub> and <italic>Y</italic><sub>2</sub>, respectively. <italic>A</italic> and <italic>B</italic> are consumed with Michaelis-Menten rates <italic>V</italic><sub>−<italic>a</italic></sub>(<italic>a</italic>) and <italic>V</italic><sub>−<italic>b</italic></sub>(<italic>b</italic>) respectively, both of which are assumed to be close to saturation. The two control loops are closed by non-competitive inhibition of the production of <italic>Y</italic><sub>1</sub> and of the conversion of <italic>Y</italic><sub>1</sub> to <italic>Y</italic><sub>2</sub> modelled by adapting the production rates with the factors <italic>ϕ</italic><sub><italic>a</italic></sub>(<italic>a</italic>) and <italic>ϕ</italic><sub><italic>b</italic></sub>(<italic>b</italic>) respectively, as shown in <xref ref-type="fig" rid="pcbi.1004235.g007">Fig 7</xref>.</p>
<p>The dynamics of the system can be modelled by the following ODEs:
<disp-formula id="pcbi.1004235.e046"><alternatives><graphic id="pcbi.1004235.e046g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e046"/><mml:math id="M46" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>︸</mml:mo></mml:munder></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mo>:</mml:mo> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:munder> <mml:mo>=</mml:mo> <mml:munder><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>︸</mml:mo></mml:munder></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mo>:</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:munder> <mml:munder><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>︸</mml:mo></mml:munder></mml:mrow> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
with
<disp-formula id="pcbi.1004235.e047"><alternatives><graphic id="pcbi.1004235.e047g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e047"/><mml:math id="M47" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="3.33333pt"/><mml:mspace width="1.em"/><mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Reactions <italic>V</italic><sub><italic>a</italic></sub> and <italic>V</italic><sub><italic>b</italic></sub> have two distinct effects on the pathway: first, they decrease the concentration of <italic>Y</italic><sub><italic>i</italic></sub> independently of any interaction of the controller; and second, they increase the concentration of <italic>A</italic> and <italic>B</italic> and are thus the means by which the controller observes the state of the network. To distinguish these two effects mathematically, in the dynamics above we have distributed each of <italic>V</italic><sub><italic>a</italic></sub> and <italic>V</italic><sub><italic>b</italic></sub> into two reactions with the same rates, one only affecting the controller, and the other only the pathway.</p>
<p>To analyse the system, we define three functionalities, corresponding to the uncontrolled pathway <italic>F</italic><sup>1</sup> (columns 1–4 and 7 in <italic>S</italic>) and the two controllers <italic>F</italic><sup>2</sup> (columns 5 and 6) and <italic>F</italic><sup>3</sup> (columns 8 and 9). The initial condition <italic>x</italic><sub>0</sub> was set to represent the steady state concentrations of the species for <italic>k</italic> = 3. Note that, in order to make explicit the dependency of the layered dynamics on this initial condition, we created a ‘zero layer’ <italic>F</italic><sup>0</sup> with constant trajectory <italic>L</italic>(<italic>F</italic><sup>0</sup>) = <italic>x</italic><sub>0</sub> as described in the Methods section. The ODEs describing the layers’ dynamics for each ordering of the functionalities, the parameter values, as well as the precise initial conditions for this example can be found in the Supporting Information. We then determined the dynamics of the layers when applying a step change of the <italic>Y</italic><sub>1</sub> production rate from <italic>k</italic> = 3 to <italic>k</italic> = 10 at <italic>t</italic> = 50. <xref ref-type="fig" rid="pcbi.1004235.g008">Fig 8</xref> displays the dynamics of the pathway, the conditional dynamics of the controllers given the pathway for both orderings of the controllers, and the complete dynamics of the system.</p>
<fig id="pcbi.1004235.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Dynamics of the layers of the perfect adaptation network.</title>
<p>The network is equilibrated for a <italic>Y</italic><sub>1</sub> production level of <italic>k</italic> = 3. At <italic>t</italic> = 50, the input is changed to <italic>k</italic> = 10. The plots show the dynamics of the layers for two different orderings of the functionalities: <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>) are the dynamics of the uncontrolled pathway; <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>) and <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>) are the effects of each controller on the unstable pathway; and <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>3</sup>) and <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) are the incremental effects of including the other controller given the first. Finally, <italic>L</italic>(<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>, <italic>F</italic><sup>3</sup>) represents the dynamics of the complete network.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g008"/>
</fig>
<p>Similarly to the previous example, we will consider a basic network consisting of only the uncontrolled pathway, <italic>F</italic><sup>1</sup>. We are then able to identify the effect of each controller as the conditional dynamics of <italic>F</italic><sup>2</sup> and <italic>F</italic><sup>3</sup> given the basic network. However, the effect on the basic network of both controllers will be different to the sum of each controller’s individual effect. We will thus compute the mutual dynamics between the two controllers in order to analyse how the controllers interact with one another when both are integrated in the context of the basic network.</p>
<p>We first consider the isolated dynamics <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>) of the uncontrolled pathway which makes up the basic network, depicted in <xref ref-type="fig" rid="pcbi.1004235.g008">Fig 8</xref>. After the step increase at <italic>t</italic> = 50, the two reactions decreasing <italic>Y</italic><sub>1</sub> quickly saturate. The isolated system is therefore unstable, and the <italic>Y</italic><sub>1</sub> component of <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>0</sup>) increases to infinity at a positive constant slope. We will now use this basic network to define the function of each of the controllers.</p>
<p>Integrating the controller <italic>F</italic><sup>2</sup> with the pathway stabilises the network. This is indicated by the trajectory of <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>) in <xref ref-type="fig" rid="pcbi.1004235.g008">Fig 8</xref>. In particular, the <italic>Y</italic><sub>1</sub> component of this trajectory decreases to minus infinity with approximately −1 times the rate of increase of <italic>Y</italic><sub>1</sub> in the isolated pathway. Another way to observe this stabilising effect is to consider the mutual dynamics <italic>M</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>) between the pathway and the controller, shown in <xref ref-type="fig" rid="pcbi.1004235.g009">Fig 9</xref>. The inconsistency <italic>I</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>0</sup>) between pathway and controller approaches one, while the cooperativity <italic>C</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>0</sup>) minus one. We interpret these values as the two functionalities cancelling one another out; in other words, <italic>F</italic><sup>2</sup> stabilising <italic>F</italic><sup>1</sup>.</p>
<fig id="pcbi.1004235.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Mutual dynamics, incompatibilities and cooperativities between the functionalities of the perfect adaptation network.</title>
<p>The first column shows the interaction of the pathway (<italic>F</italic><sup>1</sup>) with the first controller (<italic>F</italic><sup>2</sup>), the second column the interaction of the pathway with the second controller (<italic>F</italic><sup>3</sup>), and the third column the interaction of the two controllers given the pathway.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g009"/>
</fig>
<p>We next consider the effect of the second controller <italic>F</italic><sup>3</sup>, depicted in <xref ref-type="fig" rid="pcbi.1004235.g008">Fig 8</xref> by <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>). The <italic>Y</italic><sub>1</sub> component of <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>) also diverges to positive infinity, albeit at a much slower rate than that of the basic network. Intuitively, the second controller cannot stabilise the basic network, since it has no means to observe the unstable <italic>Y</italic><sub>1</sub> component. Instead, its interventions further destabise the pathway. We can quantify this through the mutual dynamics between the controller and pathway. Indeed, since <italic>C</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>) ≈ 1, the second controller amplifies the unstable dynamics. However, since <italic>I</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>) ≪ 1, this effect is only minimal.</p>
<p>We now consider the interaction between the two controllers when combined with the uncontrolled pathway. Interestingly, the effect of the second controller when combined with the first is only transient, as shown by <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>) in <xref ref-type="fig" rid="pcbi.1004235.g008">Fig 8</xref>. However, the mutual dynamics <italic>M</italic>(<italic>F</italic><sup>2</sup>; <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>) between the two controllers have a <italic>Y</italic><sub>1</sub> component increasing slowly to infinity, and the cooperativity between the controllers <italic>C</italic>(<italic>F</italic><sup>2</sup>; <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>) approaches 1. This positive cooperativity indicates that the first controller increases its interventions to stabilise the network when the second controller is present.</p>
<p>That the two controllers given the pathway act cooperatively might initially appear surprising, since the first controller stabilises the network while the second destabilises the network. This indicates the utility of our notation in allowing a rigorous quantification of how functionalities interact, given their environment. Consider the following three cases for how the two controllers <italic>F</italic><sup>2</sup> and <italic>F</italic><sup>3</sup> interact. First consider the interaction <italic>M</italic>(<italic>F</italic><sup>2</sup>; <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>) between the two controllers when integrated with the pathway. Since the presence of <italic>F</italic><sup>3</sup> increases the control action by <italic>F</italic><sup>2</sup> necessary to stabilise the pathway, the cooperativity given the pathway <italic>C</italic>(<italic>F</italic><sup>2</sup>; <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>) approaches 1, as described above. Next, consider the interaction <italic>M</italic>(<italic>F</italic><sup>2</sup>; <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>) between the two controllers <italic>without</italic> the pathway. They cannot influence each other since the respective subnetworks are not connected. Consequently they do not interact and hence <italic>M</italic>(<italic>F</italic><sup>2</sup>; <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>) = <italic>C</italic>(<italic>F</italic><sup>2</sup>; <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>) = <italic>I</italic>(<italic>F</italic><sup>2</sup>; <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>) = 0. Finally, consider the interaction <italic>M</italic>(<italic>F</italic><sup>2</sup>; (<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>3</sup>)∣<italic>F</italic><sup>0</sup>) between the first controller <italic>F</italic><sup>2</sup> and the unstable network comprised of the pathway <italic>F</italic><sup>1</sup> extended with <italic>F</italic><sup>3</sup>. The first controller stabilises the extended pathway, which is represented by the cooperativity <italic>C</italic>(<italic>F</italic><sup>2</sup>; (<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>3</sup>)∣<italic>F</italic><sup>0</sup>) approaching minus one, as <italic>F</italic><sup>2</sup> acts to attenuate the instability of <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>3</sup>. Thus, we have demonstrated that the rigorous definition of interdependence using our cascaded layering framework allows us to identify which components of a network amplify or attenuate each other, by defining the components which interact and the context in which they do so.</p>
</sec>
<sec id="sec010">
<title>Example 3: Metabolic Fluxes in Glycolysis</title>
<p>Glycolysis is a central ten-step process in most organisms responsible for the production of energy in form of ATP and NADH by catabolism of glucose and other sugars (see [<xref ref-type="bibr" rid="pcbi.1004235.ref046">46</xref>], p. 88 ff.). Besides being one of the best studied metabolic pathways, it is also an important starting point for biotechnological processes [<xref ref-type="bibr" rid="pcbi.1004235.ref047">47</xref>]. For non-growing <italic>S. cerevisiae</italic> cells, a kinetic model of the glycolytic pathway was created by Hynne <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1004235.ref048">48</xref>], including fermentation, glycerol production, lactonitrile and glycogen formation, and cellular import and export processes for glucose and other metabolites. We will use this model (available at the BioModels Database [<xref ref-type="bibr" rid="pcbi.1004235.ref041">41</xref>], model 61) to exemplify how to apply our layering approach in the context of metabolic engineering.</p>
<p>In this section we use Elementary Flux Modes (EFMs) [<xref ref-type="bibr" rid="pcbi.1004235.ref013">13</xref>], minimal functional pathways which can carry non-zero fluxes at steady state and which fulfil positivity constraints for irreversible reactions. From the unique set of EFMs of a network, all steady-state flux distributions can be obtained by non-negative linear combinations of EFMs. Due to their simplicity, EFMs can often be associated with certain elementary ‘tasks’ of a network, like the production of one or more final products from various available extracellular substrates. Thus EFMs are natural candidates to represent functionalities.</p>
<p>The model in [<xref ref-type="bibr" rid="pcbi.1004235.ref048">48</xref>] includes the dynamics of the cofactors <italic>NAD</italic><sup>+</sup>, <italic>NADH</italic>, <italic>AMP</italic>, <italic>ADP</italic>, and <italic>ATP</italic>, with the consumption of <italic>ATP</italic> by the rest of the cell modelled by first order mass action kinetics. The cofactor concentrations can be interpreted as control inputs to the junctions of the glycolytic pathway dynamically channelling the metabolite flux into the different branches depending on cellular requirements, e.g. during hyperosmotic conditions [<xref ref-type="bibr" rid="pcbi.1004235.ref049">49</xref>]. The feedback loop is closed by an integral controller ‘observing’ the consumption and production of the cofactors by the glycolytic pathway and other cellular processes.</p>
<p>We established a mixed layer structure for the glycolysis model (<xref ref-type="fig" rid="pcbi.1004235.g010">Fig 10</xref>). This mixed layer structure consists of the EFMs (not taking into account mass balance of the cofactors) as functionalities in a cascaded layer structure. The dynamics of cofactors, together with ATP consumption (<italic>ATP</italic>→<italic>ADP</italic>, Reaction 23 in [<xref ref-type="bibr" rid="pcbi.1004235.ref048">48</xref>]) and the AK reaction (<italic>ATP</italic> + <italic>AMP</italic> ↔ 2<italic>ADP</italic>, Reaction 24) form a control layer that communicates with all layers in the cascade without being part of the cascade.</p>
<fig id="pcbi.1004235.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Layering of the glycolytic pathway.</title>
<p>A) Mixed layer structure (simplified). Each EFM corresponds to a functionality in the cascaded layer structure. The control layer communicates with all other layers by sending to each the current cofactor concentrations <italic>C</italic>[cofact.], and by receiving the cofactor production/consumption rate <italic>V</italic><sup><italic>i</italic></sup>[cofact.], <italic>i</italic> ∈ 1, …, <italic>N</italic><sup><italic>L</italic></sup>, of each EFM, but also of other cellular processes (<italic>V</italic><sup><italic>E</italic></sup>[cofact.]). B) Graph representing the common reactions of the EFMs. Each note represents a set of reactions shared by the indicated EFMs. The binary tree structure of this graph is a special property of the glycolytic model [<xref ref-type="bibr" rid="pcbi.1004235.ref048">48</xref>]. C) Species-reaction graph (compare [<xref ref-type="bibr" rid="pcbi.1004235.ref018">18</xref>]) representing the models of the cascaded layers as well as the inter-layer information transfer. Rounded rectangles represent metabolite concentrations, diamonds reactions. An arrow is drawn from a metabolite to a reaction if the reaction rate depends on the metabolite, and an arrow from a reaction to a metabolite if firing of the reaction changes the metabolite’s concentration. Colours and super-scripts indicate the layer to which species and reactions belong. Reactions with only one border correspond to altered reactions. Black arrows are dependencies inside the model of the respective layer, red arrows indicate information transfer between layers. Grey arrows represent links to cofactors in the control layer; reactions <italic>R</italic>23 and <italic>R</italic>24 are part of the control layer. Graphs (B) and (C) drawn with Graphviz [<xref ref-type="bibr" rid="pcbi.1004235.ref057">57</xref>].</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g010"/>
</fig>
<p>Using the software efmtool [<xref ref-type="bibr" rid="pcbi.1004235.ref050">50</xref>], we identified eight EFMs for the modified network where the cofactor dynamics were removed by setting the appropriate rows in the stoichiometric matrix to zero. Three of the identified EFMs were non-negative linear combinations of other EFMs, a consequence of treating each reversible reaction as two separate irreversible reactions. Based on the concept of simplicity (condition <italic>C3</italic> in [<xref ref-type="bibr" rid="pcbi.1004235.ref013">13</xref>]), we removed the linearly-dependent EFMs with the lowest number of zero entries. The remaining five EFMs can be interpreted as representing elementary ‘tasks’ of the network:
<list list-type="order"><list-item><p>Glycogen buildup: production and storage of glucose-6-phospate <italic>G</italic>6<italic>P</italic></p></list-item> <list-item><p>Production and excretion of glycerol <italic>Glyc</italic></p></list-item> <list-item><p>Fermentation: production and excretion of ethanol <italic>EtOH</italic></p></list-item> <list-item><p>Production and excretion of acetaldehyde <italic>ACA</italic></p></list-item> <list-item><p>Lactonitrile <italic>lacto</italic> formation.</p></list-item></list>
Since the cofactors participate in many of the reactions, our approach to not take them into account when calculating the EFMs is conceptually similar to classifying metabolites taking part in more than a threshold number of reactions as ‘external’, as proposed in [<xref ref-type="bibr" rid="pcbi.1004235.ref051">51</xref>]. Both approaches result in the same significantly simpler and biologically interpretable set of EFMs. However, unlike the subnetworks identified in [<xref ref-type="bibr" rid="pcbi.1004235.ref048">48</xref>], the EFMs are not necessarily redox neutral. We will briefly discuss the consequences of this at the end of this section.</p>
<p>In <xref ref-type="fig" rid="pcbi.1004235.g010">Fig 10</xref> we represent the common reactions of the five EFMs by a graph. Surprisingly, the graph is a binary tree, indicating that, while there are junctions in the reaction pathway of the metabolites, there are no joins. Furthermore, there exists one main branch, consisting of Reactions 1 − 11 and Reaction 18, and each EFM can be represented by a unique junction from this main branch: EFM <italic>F</italic><sup>1</sup> is the junction after Reaction 3, <italic>F</italic><sup>2</sup> after Reactions 6 and 7, <italic>F</italic><sup>3</sup> after Reaction 11, and <italic>F</italic><sup>4</sup> and <italic>F</italic><sup>5</sup> after Reaction 18. This property provides a natural order for the EFMs, with <italic>F</italic><sup>1</sup> at the top of the cascade and <italic>F</italic><sup>5</sup> at the bottom. The ODEs describing the layers’ dynamics for this ordering of the functionalities, the dynamics of the control layer, the parameter values, and the initial conditions can be found in the Supporting Information.</p>
<p>The layers and their interconnection can be represented as a species-reaction graph (SR graph, see [<xref ref-type="bibr" rid="pcbi.1004235.ref018">18</xref>]) depicting the reactions, the non-zero altered reactions, the species with non-zero dynamics in each layer, and the inter-layer communication (<xref ref-type="fig" rid="pcbi.1004235.g010">Fig 10</xref>). Recall from (<xref ref-type="disp-formula" rid="pcbi.1004235.e019">7b</xref>) that the vector of altered reactions for layer <italic>i</italic> is defined by
<disp-formula id="pcbi.1004235.e048"><alternatives><graphic id="pcbi.1004235.e048g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e048"/><mml:math id="M48" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>l</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≔</mml:mo> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
In this example we identified reactions <italic>j</italic> where <italic>v</italic><sub><italic>j</italic></sub>(<italic>x</italic><sup>1</sup> + … + <italic>x</italic><sup><italic>i</italic></sup>) = <italic>v</italic><sub><italic>j</italic></sub>(<italic>x</italic><sup>1</sup> + … + <italic>x</italic><sup><italic>i</italic>−1</sup>), meaning the rate of the reaction is not altered by the interconnection of functionality <italic>F</italic><sup><italic>i</italic></sup>. A sufficient condition [<xref ref-type="bibr" rid="pcbi.1004235.ref018">18</xref>] to conclude that altered reaction <italic>j</italic> does not change the dynamics of Layer <italic>i</italic> and thus can be omitted is if the <italic>j</italic>th element of
<disp-formula id="pcbi.1004235.e049"><alternatives><graphic id="pcbi.1004235.e049g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004235.e049"/><mml:math id="M49" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>I</mml:mi> <mml:mo>(</mml:mo> <mml:mfrac><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>δ</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac> <mml:mi>v</mml:mi> <mml:mo>)</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mi>I</mml:mi> <mml:mo>(</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msup><mml:mi>S</mml:mi> <mml:mi>k</mml:mi></mml:msup> <mml:mo>)</mml:mo> <mml:mi>I</mml:mi> <mml:mo>(</mml:mo> <mml:mfrac><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>δ</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac> <mml:mi>v</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>·</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
is zero. Here, exp(.) represents the matrix exponent, <italic>S</italic><sup><italic>k</italic></sup> the stoichiometric matrix of layer <italic>k</italic>, <italic>I</italic> the element-wise indicator function being one if the respective element is non-zero and zero otherwise, and <bold>1</bold> the <italic>N</italic><sub><italic>R</italic></sub> × 1 vector with all elements being one. Similarly, the integration of a species can be omitted in a layer if it is not affected by any of that layer’s reactions.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004235.g010">Fig 10</xref> shows that each layer is comparatively small and includes few altered reactions. Furthermore, since reactions <italic>R</italic><sub>13</sub> and <italic>R</italic><sub>14</sub> are linear (in the metabolites), information about the metabolite concentrations involved in these reactions is not required to be transmitted between the layers (for example, <italic>EtOH</italic><sup>3</sup> and <italic>EtOHX</italic><sup>3</sup> are not transmitted to Layer 4 and 5). This demonstrates that, for many biological networks, layers and the interfaces between them are comparatively simple.</p>
<p>We equilibrated the model for a mixed flow glucose concentration of 10 mM and initialised the dynamics of the initial condition layer <italic>L</italic>(<italic>F</italic><sup>0</sup>) = <italic>x</italic><sub>0</sub> to these steady-state values. This corresponds to low glucose conditions in the range of the <italic>K</italic><sub><italic>m</italic></sub> values of high-affinity glucose transporters [<xref ref-type="bibr" rid="pcbi.1004235.ref052">52</xref>], and slightly below the mixed flow glucose concentration for which the parameters of the model were identified (18.5 mM) to prevent glycogenic oscillations (see [<xref ref-type="bibr" rid="pcbi.1004235.ref048">48</xref>]). All other parameters and medium conditions were kept unchanged as compared to the version of the glycolysis model [<xref ref-type="bibr" rid="pcbi.1004235.ref048">48</xref>] available at the BioModels Database. We then calculated the layer dynamics for each ordering of the EFMs into all possible cascade structures by simulating the layering graph for 1000 min as described in Methods. This requires the simulation of 2<sup>5</sup> − 1 = 31 layers to populate the 5 ⋅ 5! = 600 nodes of the graph.</p>
<p>Based on the layering graph we then analysed all pairwise interactions between <italic>F</italic><sup><italic>i</italic></sup> and <italic>F</italic><sup><italic>j</italic></sup>, given all possible combinations of other functionalities. In <xref ref-type="fig" rid="pcbi.1004235.g011">Fig 11</xref>, we display the steady-state incompatibilities and cooperativities between the EFMs after convergence at the end of the simulation. Note that although the incompatibilities and cooperativities converge, this is not necessarily true for the corresponding layer and mutual dynamics, which diverge for some EFMs (compare <xref ref-type="fig" rid="pcbi.1004235.g009">Fig 9</xref>). Several pairs have an incompatibility close to one and a cooperativity close to minus one. This combination is typical if one of the functionalities (given its environment) is unstable but is stabilised by the other. For example, in the isolated layer <italic>L</italic>(<italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>), pyruvate increases to infinity since the PDC reaction (Reaction 11 in [<xref ref-type="bibr" rid="pcbi.1004235.ref048">48</xref>]) is saturated and becomes rate limiting. Integrating either <italic>F</italic><sup>1</sup> or <italic>F</italic><sup>2</sup> with <italic>F</italic><sup>3</sup> reduces the production rate of pyruvate and thus stabilises the network, since both <italic>L</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>) and <italic>L</italic>(<italic>F</italic><sup>2</sup>, <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>0</sup>) are stable. On the other hand, in the isolated layer <italic>L</italic>(<italic>F</italic><sup>5</sup>∣<italic>F</italic><sup>0</sup>) both pyruvate and acetaldehyde (<italic>ACA</italic>) concentrations are unstable, the latter due to limited cyanide (<italic>CNX</italic>) availability. Integrating <italic>F</italic><sup>1</sup> or <italic>F</italic><sup>2</sup> with <italic>F</italic><sup>5</sup> only stabilises the pyruvate concentration, but not acetaldehyde. The prediction of infinite growth of species concentrations is unlikely to be observed experimentally. Instead, the instability might indicate that the conversion of pyruvate to acetaldehyde catalysed by the pyruvate decarboxylase (pdc) becomes a rate limiting step when synthetically increasing the flow through the respective EFM. Indeed, it was experimentally validated [<xref ref-type="bibr" rid="pcbi.1004235.ref053">53</xref>] that under certain conditions over-expression of pdc after reducing glycerol synthesis can lead to increased growth rates and ethanol yield.</p>
<fig id="pcbi.1004235.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Compatibility of EFMs in the glycolytic pathway.</title>
<p>The background shade of the matrix elements depict the steady-state incompatibility between the respective functionalities on the y-axis, given the functionalities on the x-axis, at a mixed flow glucose concentration of 10 mM (for notational convenience, dependencies on <italic>F</italic><sup>0</sup> were assumed). For example, the shade of the element on the second row and twelfth column depicts <italic>I</italic>(<italic>F</italic><sup>1</sup>; <italic>F</italic><sup>3</sup>∣<italic>F</italic><sup>2</sup>, <italic>F</italic><sup>4</sup>). The direction of the arrows depict the steady-state cooperativity between the respective elements, with straight upwards corresponding to cooperativity equal one, straight downwards equal minus one, and horizontal equal zero. Finally, the colour of the arrows provides further information about the interaction: (black) the sum of both conditioned functionalities alone as well as the mutual dynamics are stable, and the overall network is stable; (grey) same as black, only the overall network is unstable. Thus, the instability is in a layer the two functionalities are conditioned on; (green) the sum and the mutual dynamics are unstable and the overall network stable. The interaction stabilises the network; (yellow) same as green, but the overall network is unstable. Typical when the interaction only stabilises some of the species, or if the speed of divergence is smaller; (blue) the sum is unstable and the mutual dynamics and the overall network are stable. Typical if the instability was in a layer the functionalities are conditioned on, and one of the functionalities stabilises the network.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g011"/>
</fig>
<p>The incompatibilities between two EFMs, given the three other EFMs, are of specific interest (rightmost ten interactions in <xref ref-type="fig" rid="pcbi.1004235.g011">Fig 11</xref>). They indicate that <italic>F</italic><sup>1</sup> and <italic>F</italic><sup>3</sup> are significantly more incompatible than <italic>F</italic><sup>2</sup> and <italic>F</italic><sup>3</sup>. Recall that <italic>F</italic><sup>3</sup> corresponds to the fermentation capability of the network. To increase biofuel production one would intuitively expect that the highest yields could be obtained by knocking out or down the EFMs which are most incompatible to <italic>F</italic><sup>3</sup>, thereby removing EFMs which act to attenuate its function. Recall that the effect of knocking-out a certain functionality <italic>F</italic><sup><italic>i</italic></sup> on the overall dynamics of the network is equal to −<italic>L</italic>(<italic>F</italic><sup><italic>i</italic></sup>∣<italic>F</italic><sup><italic>j</italic></sup>, <italic>j</italic> ≠ <italic>i</italic>). Thus, the effect of knocking out <italic>GPD</italic> (Reaction 15) and, thus, glycerol production <italic>F</italic><sup>2</sup> is −<italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>1</sup>, <italic>F</italic><sup>3</sup>, <italic>F</italic><sup>4</sup>, <italic>F</italic><sup>5</sup>). The effect of a double knock-out of glycerol production together with glycogen build-up <italic>F</italic><sup>1</sup> corresponds to −<italic>L</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>3</sup>, <italic>F</italic><sup>4</sup>, <italic>F</italic><sup>5</sup>). The theoretical effect on fermentation efficiency of all possible combinations of knock-outs (<xref ref-type="fig" rid="pcbi.1004235.g012">Fig 12</xref>) can thus be directly derived, given the layering graph. Indeed, this analysis confirms that fermentation <italic>F</italic><sup>3</sup> is significantly more incompatible with glycogen build-up <italic>F</italic><sup>1</sup> than with glycerol production <italic>F</italic><sup>2</sup> at the given experimental setup. The effect of knocking out more than one functionality is non-linear, and a double knock-out of the two functionalities yielding the highest gains when knocked out separately is not necessarily optimal, as shown in <xref ref-type="fig" rid="pcbi.1004235.g012">Fig 12</xref>. Thus, the layering graph provides an effective tool to analyse such potential interactions.</p>
<fig id="pcbi.1004235.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004235.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Potential ethanol production gains by knock-outs of functionalities.</title>
<p>The bars represent the potential gain in ethanol production for a mixed flow glucose concentration of 10 mM if one or more of the EFMs are knocked out, e.g. by gene deletions of corresponding enzymes. These values can be directly obtained from the respective steady-state extracellular ethanol concentrations in the layers in the layering graph. For example, the expected gain for knocking out functionalities <italic>F</italic><sup>1</sup> and <italic>F</italic><sup>4</sup> corresponds to −<italic>L</italic><sub><italic>EtOHX</italic></sub>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>4</sup>∣<italic>F</italic><sup>0</sup>, <italic>F</italic><sup>2</sup>, <italic>F</italic><sup>3</sup>, <italic>F</italic><sup>5</sup>)/<italic>L</italic><sub><italic>EtOHX</italic></sub>(<italic>F</italic><sup>0</sup>) as <italic>t</italic> → ∞. Note that for some knock-outs the resulting networks become unstable (see main text), although not in the concentration of ethanol.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.g012"/>
</fig>
<p>It is out of the scope of this article to take side effects of the proposed genetic modifications into account, such as possible viability issues when knocking out some of the pathways. Our intention was to provide a proof of principle of how to apply our layering framework in the context of metabolic engineering. Notably, our analysis is based on a model of a non-industrial strain of <italic>S. cerevisia</italic> cells grown under glucose starvation, and which was created mainly to explain glycogenic oscillations at low glucose conditions [<xref ref-type="bibr" rid="pcbi.1004235.ref048">48</xref>] rather than being optimised for metabolic engineering purposes. Furthermore, we essentially avoided the challenge of balancing the redox state (<italic>NAD</italic><sup>+</sup>/<italic>NADH</italic> ratio) by our mixed layering approach (<xref ref-type="fig" rid="pcbi.1004235.g010">Fig 10</xref>) in which the control layer was always receiving the cofactor consumption and production rates of all cascaded layers while simulating the layering graph. Nevertheless, our analysis indicates that ethanol yield can be increased by approximately 6% by knocking out glycerol formation (<italic>F</italic><sup>2</sup>). This prediction is in good agreement with a reported [<xref ref-type="bibr" rid="pcbi.1004235.ref054">54</xref>] experimental increase of about 7% after inhibition of glycerol formation from dihydroxyacetone phosphate (<italic>DHAP</italic>) by knock-down of glycerol-3-phosphate dehydrogenase (<italic>GPD</italic>). In [<xref ref-type="bibr" rid="pcbi.1004235.ref054">54</xref>] the redox state was balanced by synthetically engineering an alternative route in the endogeneous Embden–Meyerhof–Parnas pathway based on <italic>NADP</italic><sup>+</sup> and <italic>NADPH</italic> instead of <italic>NAD</italic><sup>+</sup> and <italic>NADH</italic>.</p>
</sec>
</sec>
<sec id="sec011" sec-type="conclusions">
<title>Discussion</title>
<p>We have described a cascaded layering approach which can be used to systematically identify the interactions of functionalities (i.e. functional subsystems) in a decomposed network. Functionalities are defined as sets of reactions which together accomplish a given purpose. We have identified the dynamics of an isolated functionality as the dynamics of the subnetwork made up of only those reactions. However, the dynamics of a functionality are different when it is in the context of others. We have formulated the conditional dynamics of a functionality as the incremental change to the dynamics caused by integrating it with its context. We have also demonstrated that the computational burden associated with this layered framework can be minimised by exploiting symmetries within the definitions of interdependence.</p>
<p>We have used the conditional dynamics to define the mutual dynamics, which describe the context-dependent interaction between any pair of functionalities. We can thus identify if the interaction between them is strong or weak (<italic>incompatibility</italic>), and to what extent they amplify or attenuate each other (<italic>cooperativity</italic>). This interdependence is also context-dependent, so that two functionalities may interact in vastly different ways depending on the wider system in which they are integrated. Our framework allows the unambiguous quantification of nonlinear interactions between functionalities.</p>
<p>Finally, we illustrated our layering framework with three examples. The first considered signalling pathways interconnected by two distinct crosstalk mechanisms, a mutually inhibiting and a mutually excitatory crosstalk. We not only quantified how each mechanism separately influences the dynamics, but also how the crosstalk mechanisms interact with each other. Our second example concerned a pathway stabilised by two integral feedback mechanisms. For certain input signals, the pathway alone becomes unstable. It gets stabilised by the first integral feedback, but the second feedback further destabilises the system, as displayed by the negative and positive cooperativity respectively. Thus each feedback has an opposite effect on the pathway to the other when each is considered in isolation. However, when they are integrated together they interact cooperatively, due to the first controller increasing its strength to stabilise the network when the second controller is present. Third, we showed how to apply our layering framework in the context of metabolic engineering to analyse the dynamic interactions between elementary flux modes in glycolysis. Interestingly, the effect of abolishing an EFM by knocking out its enzymes can be easily described as the negative of the conditional dynamics of that EFM, given the rest of the network. The incompatibility between two EFMs, on the other hand, gives information about the expected increase in the flux through one EFM if the other one is knocked out. These interpretations allowed us to efficiently calculate the expected increase of ethanol yield in biofuel production when knocking out arbitrary combinations of EFMs. Interestingly, this yield is not additive, and a double knock-out of the two EFMs giving the highest increases in ethanol yield alone is not necessarily optimal. Instead, our method to calculate the integrated effect of all combinations of knock-outs allowed us to assess the best metabolic engineering strategy with a minimum amount of simulations required.</p>
<p>As discussed in the Introduction, the layering framework [<xref ref-type="bibr" rid="pcbi.1004235.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004235.ref017">17</xref>] differs from modularization approaches [<xref ref-type="bibr" rid="pcbi.1004235.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004235.ref026">26</xref>]. Each of these frameworks allows different network architectures to be considered, reflecting a distinction between vertical and horizontal network decomposition [<xref ref-type="bibr" rid="pcbi.1004235.ref055">55</xref>]. Layered networks represent the overlay of multiple (possibly competing) functional subnetworks, while the modular framework interprets biological networks in terms of engineered interconnections of input–output systems. Although it is a modular phenomenon, previous work on quantifying retroactivity [<xref ref-type="bibr" rid="pcbi.1004235.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004235.ref005">5</xref>] can be related to our layered formulation. A goal of both techniques is to measure the difference in a given subsystem’s isolated and integrated behaviours. In particular, an upper bound on the Euclidean norm of the difference in a module’s isolated and integrated trajectories has been derived in terms of the system parameters in [<xref ref-type="bibr" rid="pcbi.1004235.ref005">5</xref>]. In the Supporting Information to this paper, we show in detail how this norm relates to our formulation of the incremental dynamics <italic>L</italic>(<italic>F</italic><sup>2</sup>∣<italic>F</italic><sup>1</sup>), and the mutual dynamics <italic>M</italic>(<italic>F</italic><sup>1</sup>, <italic>F</italic><sup>2</sup>). Although our layering framework and the concept of retroactivity were developed to quantify the interactions between different kinds of subsystems, this comparison suggests that our additional measures of incompatibility and cooperativity as defining an interaction <italic>direction</italic> may also be applicable to further understand retroactivity in multi-dimensional modular systems.</p>
<p>The computational method employed to quantify the interaction strength between a given functionality pair is clearly dependent on the kinetic constants and other parameter values in the model, including the initial conditions. A repetition of this computation across a range of such values may give a more informative picture of how uncertain biological functionalities interact, but will be difficult to visualise and expensive to evaluate. Possible directions for future work may include the derivation of analytical estimates in terms of the system’s parameter values for the mutual dynamics, incompatibility, or cooperativity, of the type produced for layered steady state perturbations in [<xref ref-type="bibr" rid="pcbi.1004235.ref016">16</xref>] or retroactive perturbations in [<xref ref-type="bibr" rid="pcbi.1004235.ref005">5</xref>]. It would also be interesting to consider if any estimates of our measures can be computationally derived to hold for all parameters, similarly to the structural results on the direction of steady state responses to parameter perturbations given in [<xref ref-type="bibr" rid="pcbi.1004235.ref034">34</xref>]. Alternatively, semi-definite programming may be used to calculate worst-case estimates of the difference between the trajectories <italic>L</italic>(<italic>F</italic><sup>1</sup>) and <italic>L</italic>(<italic>F</italic><sup>1</sup>∣<italic>F</italic><sup>2</sup>) without resorting to simulation, similarly to previous work on model reduction error estimation [<xref ref-type="bibr" rid="pcbi.1004235.ref056">56</xref>].</p>
<p>An important assumption made in this paper was that the network functionalities <italic>F</italic><sup><italic>i</italic></sup> are given. The examples in this paper provide two different strategies for how the functionalities necessary for our layering framework can be defined. In the first two examples this was done by intuition and prior knowledge, while in the third example we applied an already available method to group functionally related reactions in metabolic pathways, namely EFMs. Clearly, this is not a comprehensive list of how functionalities can be defined, and (depending on the precise application) other strategies might be more promising. One such example may arise in the context of Synthetic Biology, from the specification of synthetic biomolecular devices such as toggle switches, oscillators, and so on, the dynamics of which are significantly affected when combined into large-scale systems [<xref ref-type="bibr" rid="pcbi.1004235.ref002">2</xref>]. Such an application of our framework to Synthetic Biology would require these biomolecular devices–typically designed and modelled as modules–to be mathematically expressed as layers, respectively functionalities. If this is possible without requiring modifications in the biomolecular implementation remains a question for future research.</p>
<p>Our layering approach provides a general and concise framework for the quantification of the nonlinear interactions between functionalities of signalling and metabolic pathways. It offers a great flexibility since it only requires that each reaction must be part of a functionality, but allows reactions to be part of more or even all functionalities. Besides the mathematical definition of the model, the only input data needed is the problem-specific definition of the sets of reactions which make up a functionality. For many signalling pathways these definitions are typically given by biological insight, and for metabolic networks implementations of efficient algorithms to determine the sets of EFMs are available (e.g. [<xref ref-type="bibr" rid="pcbi.1004235.ref050">50</xref>]). To allow a quick assessment of our approach, we have implemented a MATLAB (The MathWorks, Natick, MA) toolbox, available under the GNU General Public License from <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://sysos.eng.ox.ac.uk/control/sysos/index.php/User:Prescott/Code">sysos.eng.ox.ac.uk/control/sysos/index.php/User:Prescott/Code</ext-link>. This toolbox provides algorithms to automatically construct the models of the layers from SBML files, to derive the layering graph with minimal numerical simulation, and to easily assess the mutual dynamics, the incompatibility and the cooperativity between functionalities. We hope that our implementation can serve as a starting point to integrate our layering framework into standard software solutions for the analysis of biomolecular networks.</p>
</sec>
<sec id="sec012">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004235.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004235.s001" mimetype="application/pdf" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Mathematical details for the example networks, and relationship to retroactivity.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We are grateful to Jörg Stelling for valuable discussions on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004235.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cardinale</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Arkin</surname> <given-names>AP</given-names></name> (<year>2012</year>) <article-title>Contextualizing context for synthetic biology-identifying causes of failure of synthetic biological systems</article-title>. <source>Biotechnology Journal</source> <volume>7</volume>: <fpage>856</fpage>–<lpage>866</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/biot.201200085" xlink:type="simple">10.1002/biot.201200085</ext-link></comment> <object-id pub-id-type="pmid">22649052</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Slusarczyk</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weiss</surname> <given-names>R</given-names></name> (<year>2012</year>) <article-title>Foundations for the design and implementation of synthetic genetic circuits</article-title>. <source>Nature Reviews Genetics</source> <volume>13</volume>: <fpage>406</fpage>–<lpage>420</lpage>. <object-id pub-id-type="pmid">22596318</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="other">Prescott TP, Papachristodoulou A (2014) Synthetic biology: A control engineering perspective. In: Proceedings of the European Control Conference (ECC). pp. 1182–1186.</mixed-citation>
</ref>
<ref id="pcbi.1004235.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Del Vecchio</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ninfa</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Sontag</surname> <given-names>ED</given-names></name> (<year>2008</year>) <article-title>Modular cell biology: retroactivity and insulation</article-title>. <source>Molecular Systems Biology</source> <volume>4</volume>: <fpage>161</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb4100204" xlink:type="simple">10.1038/msb4100204</ext-link></comment> <object-id pub-id-type="pmid">18277378</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gyorgy</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Del Vecchio</surname> <given-names>D</given-names></name> (<year>2014</year>) <article-title>Modular composition of gene transcription networks</article-title>. <source>PLoS computational biology</source> <volume>10</volume>: <fpage>e1003486</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003486" xlink:type="simple">10.1371/journal.pcbi.1003486</ext-link></comment> <object-id pub-id-type="pmid">24626132</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Sontag</surname> <given-names>ED</given-names></name> (<year>2011</year>) <chapter-title>Modularity, retroactivity, and structural identification</chapter-title>. In: <source>Design and Analysis of Biomolecular Circuits</source>, <publisher-name>Springer</publisher-name>. pp. <fpage>183</fpage>–<lpage>200</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004235.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ossareh</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Ventura</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Merajver</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Del Vecchio</surname> <given-names>D</given-names></name> (<year>2011</year>) <article-title>Long signaling cascades tend to attenuate retroactivity</article-title>. <source>Biophysical Journal</source> <volume>100</volume>: <fpage>1617</fpage>–<lpage>1625</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2011.02.014" xlink:type="simple">10.1016/j.bpj.2011.02.014</ext-link></comment> <object-id pub-id-type="pmid">21463574</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>McClean</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Mody</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Broach</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Ramanathan</surname> <given-names>S</given-names></name> (<year>2007</year>) <article-title>Cross-talk and decision making in MAP kinase pathways</article-title>. <source>Nature Genetics</source> <volume>39</volume>: <fpage>409</fpage>–<lpage>414</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng1957" xlink:type="simple">10.1038/ng1957</ext-link></comment> <object-id pub-id-type="pmid">17259986</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rowland</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Fontana</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Deeds</surname> <given-names>EJ</given-names></name> (<year>2012</year>) <article-title>Crosstalk and competition in signaling networks</article-title>. <source>Biophysical Journal</source> <volume>103</volume>: <fpage>2389</fpage>–<lpage>2398</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2012.10.006" xlink:type="simple">10.1016/j.bpj.2012.10.006</ext-link></comment> <object-id pub-id-type="pmid">23283238</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="other">Algar R, Ellis T, Stan GB (2013) Modelling the burden caused by gene expression: an in silico investigation into the interactions between synthetic gene circuits and their chassis cell. arXiv preprint arXiv:13097798.</mixed-citation>
</ref>
<ref id="pcbi.1004235.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="other">Siegal-Gaskins D, Noireaux V, Murray RM (2013) Biomolecular resource utilization in elementary cell-free gene circuits. In: Proceedings of the American Control Conference (ACC). IEEE, pp. 1531–1536.</mixed-citation>
</ref>
<ref id="pcbi.1004235.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="other">Gyorgy A, Del Vecchio D (2014) Limitations and trade-offs in gene expression due to competition for shared cellular resources. In: Proceedings of the IEEE Conference on Decision and Control(CDC).</mixed-citation>
</ref>
<ref id="pcbi.1004235.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Schuster</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hilgetag</surname> <given-names>C</given-names></name> (<year>1994</year>) <article-title>On elementary flux modes in biochemical reaction systems at steady state</article-title>. <source>Journal of Biological Systems</source> <volume>2</volume>: <fpage>165</fpage>–<lpage>182</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1142/S0218339094000131" xlink:type="simple">10.1142/S0218339094000131</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Stelling</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Klamt</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bettenbrock</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Schuster</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gilles</surname> <given-names>ED</given-names></name> (<year>2002</year>) <article-title>Metabolic network structure determines key aspects of functionality and regulation</article-title>. <source>Nature</source> <volume>420</volume>: <fpage>190</fpage>–<lpage>193</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature01166" xlink:type="simple">10.1038/nature01166</ext-link></comment> <object-id pub-id-type="pmid">12432396</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Klamt</surname> <given-names>S</given-names></name> (<year>2005</year>) <article-title>Generalized concept of minimal cut sets in biochemical networks</article-title>. <source>Biosystems</source> <volume>83</volume>. <object-id pub-id-type="pmid">16303240</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="other">Prescott TP, Papachristodoulou A (2014) Signal propagation across layered biochemical networks. In: Proceedings of the American Control Conference (ACC). pp. 3399–3404.</mixed-citation>
</ref>
<ref id="pcbi.1004235.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Prescott</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Papachristodoulou</surname> <given-names>A</given-names></name> (<year>2014</year>) <article-title>Layered decomposition for the model order reduction of timescale separated biochemical reaction networks</article-title>. <source>Journal of Theoretical Biology</source> <volume>356</volume>: <fpage>113</fpage>–<lpage>122</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2014.04.007" xlink:type="simple">10.1016/j.jtbi.2014.04.007</ext-link></comment> <object-id pub-id-type="pmid">24732263</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lang</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Summers</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stelling</surname> <given-names>J</given-names></name> (<year>2014</year>) <article-title>Cutting the wires: Modularization of cellular networks for experimental design</article-title>. <source>Biophysical journal</source> <volume>106</volume>: <fpage>321</fpage>–<lpage>331</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2013.11.2960" xlink:type="simple">10.1016/j.bpj.2013.11.2960</ext-link></comment> <object-id pub-id-type="pmid">24411264</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ravasz</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Somera</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Mongru</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Oltvai</surname> <given-names>ZN</given-names></name>, <name name-style="western"><surname>Barabási</surname> <given-names>AL</given-names></name> (<year>2002</year>) <article-title>Hierarchical organization of modularity in metabolic networks</article-title>. <source>science</source> <volume>297</volume>: <fpage>1551</fpage>–<lpage>1555</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1073374" xlink:type="simple">10.1126/science.1073374</ext-link></comment> <object-id pub-id-type="pmid">12202830</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bowsher</surname> <given-names>CG</given-names></name> (<year>2011</year>) <article-title>Information processing by biochemical networks: a dynamic approach</article-title>. <source>J R Soc Interface</source> <volume>8</volume>: <fpage>186</fpage>–<lpage>200</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2010.0287" xlink:type="simple">10.1098/rsif.2010.0287</ext-link></comment> <object-id pub-id-type="pmid">20685691</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Clauset</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Newman</surname> <given-names>MEJ</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>C</given-names></name> (<year>2004</year>) <article-title>Finding community structure in very large networks</article-title>. <source>Phys Rev E</source> <volume>70</volume>: <fpage>066111-1</fpage>–<lpage>066111-6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.70.066111" xlink:type="simple">10.1103/PhysRevE.70.066111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Girvan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Newman</surname> <given-names>MEJ</given-names></name> (<year>2002</year>) <article-title>Community structure in social and biological networks</article-title>. <source>P Natl Acad Sci USA</source> <volume>99</volume>: <fpage>7821</fpage>–<lpage>7826</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.122653799" xlink:type="simple">10.1073/pnas.122653799</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Newman</surname> <given-names>ME</given-names></name> (<year>2006</year>) <article-title>Modularity and community structure in networks</article-title>. <source>P Natl Acad Sci USA</source> <volume>103</volume>: <fpage>8577</fpage>–<lpage>8582</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0601602103" xlink:type="simple">10.1073/pnas.0601602103</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Saez-Rodriguez</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kremling</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gilles</surname> <given-names>ED</given-names></name> (<year>2005</year>) <article-title>Dissecting the puzzle of life: modularization of signal transduction networks</article-title>. <source>Computers &amp; Chemical Engineering</source> <volume>29</volume>: <fpage>619</fpage>–<lpage>629</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.compchemeng.2004.08.035" xlink:type="simple">10.1016/j.compchemeng.2004.08.035</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Saez-Rodriguez</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gayer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ginkel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gilles</surname> <given-names>ED</given-names></name> (<year>2008</year>) <article-title>Automatic decomposition of kinetic models of signaling networks minimizing the retroactivity among modules</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>i213</fpage>–<lpage>i219</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn289" xlink:type="simple">10.1093/bioinformatics/btn289</ext-link></comment> <object-id pub-id-type="pmid">18689828</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Kaltenbach</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Stelling</surname> <given-names>J</given-names></name> (<year>2012</year>) <chapter-title>Modular analysis of biological networks</chapter-title>. In: <name name-style="western"><surname>Goryanin</surname> <given-names>II</given-names></name>, <name name-style="western"><surname>Goryachev</surname> <given-names>AB</given-names></name>, editors, <source>Advances in Systems Biology</source>, <publisher-name>Springer</publisher-name>. pp. <fpage>3</fpage>–<lpage>17</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004235.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hsueh</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Natarajan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Pond</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Deciphering signaling outcomes from a system of complex networks</article-title>. <source>Science signaling</source> <volume>2</volume>: <fpage>ra22</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/scisignal.2000054" xlink:type="simple">10.1126/scisignal.2000054</ext-link></comment> <object-id pub-id-type="pmid">19454649</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bollenbach</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Quan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chait</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kishony</surname> <given-names>R</given-names></name> (<year>2009</year>) <article-title>Nonoptimal microbial response to antibiotics underlies suppressive drug interactions</article-title>. <source>Cell</source> <volume>139</volume>: <fpage>707</fpage>–<lpage>718</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2009.10.025" xlink:type="simple">10.1016/j.cell.2009.10.025</ext-link></comment> <object-id pub-id-type="pmid">19914165</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Geva-Zatorsky</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Dekel</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Danon</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>L</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Protein dynamics in drug combinations: a linear superposition of individual-drug responses</article-title>. <source>Cell</source> <volume>140</volume>: <fpage>643</fpage>–<lpage>651</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2010.02.011" xlink:type="simple">10.1016/j.cell.2010.02.011</ext-link></comment> <object-id pub-id-type="pmid">20211134</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bruggeman</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Westerhoff</surname> <given-names>HV</given-names></name>, <name name-style="western"><surname>Hoek</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Kholodenko</surname> <given-names>BN</given-names></name> (<year>2002</year>) <article-title>Modular response analysis of cellular regulatory networks</article-title>. <source>Journal of theoretical biology</source> <volume>218</volume>: <fpage>507</fpage>–<lpage>520</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jtbi.2002.3096" xlink:type="simple">10.1006/jtbi.2002.3096</ext-link></comment> <object-id pub-id-type="pmid">12384053</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bruggeman</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Snoep</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Westerhoff</surname> <given-names>HV</given-names></name> (<year>2008</year>) <article-title>Control, responses and modularity of cellular regulatory networks: a control analysis perspective</article-title>. <source>IET Systems Biology</source> <volume>2</volume>: <fpage>397</fpage>–<lpage>410</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1049/iet-syb:20070065" xlink:type="simple">10.1049/iet-syb:20070065</ext-link></comment> <object-id pub-id-type="pmid">19045835</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kholodenko</surname> <given-names>BN</given-names></name>, <name name-style="western"><surname>Kiyatkin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bruggeman</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Sontag</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Westerhoff</surname> <given-names>HV</given-names></name> (<year>2002</year>) <article-title>Untangling the wires: A strategy to trace functional interactions in signaling and gene networks</article-title>. <source>PNAS</source> <volume>99</volume>: <fpage>12841</fpage>–<lpage>12846</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.192442699" xlink:type="simple">10.1073/pnas.192442699</ext-link></comment> <object-id pub-id-type="pmid">12242336</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hofmeyr</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Westerhoff</surname> <given-names>HV</given-names></name> (<year>2001</year>) <article-title>Building the cellular puzzle: control in multi-level reaction networks</article-title>. <source>Journal of Theoretical Biology</source> <volume>208</volume>: <fpage>261</fpage>–<lpage>285</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jtbi.2000.2216" xlink:type="simple">10.1006/jtbi.2000.2216</ext-link></comment> <object-id pub-id-type="pmid">11207090</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Sontag</surname> <given-names>ED</given-names></name> (<year>2014</year>) <article-title>A technique for determining the signs of sensitivities of steady states in chemical reaction networks</article-title>. <source>IET Systems Biology</source> <volume>8</volume>: <fpage>251</fpage>–<lpage>267</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1049/iet-syb.2014.0025" xlink:type="simple">10.1049/iet-syb.2014.0025</ext-link></comment> <object-id pub-id-type="pmid">25478700</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Alexander</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Emonet</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Gerstein</surname> <given-names>MB</given-names></name> (<year>2009</year>) <article-title>Understanding modularity in molecular networks requires dynamics</article-title>. <source>Science Signalling</source> <volume>2</volume>: <fpage>pe44</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004235.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Przytycka</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Slonim</surname> <given-names>DK</given-names></name> (<year>2010</year>) <article-title>Toward the dynamic interactome: it’s about time</article-title>. <source>Briefings in Bioinformatics</source>: <fpage>bbp057</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004235.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Oishi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Klavins</surname> <given-names>E</given-names></name> (<year>2011</year>) <article-title>Biomolecular implementation of linear I/O systems</article-title>. <source>Systems Biology, IET</source> <volume>5</volume>: <fpage>252</fpage>–<lpage>260</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1049/iet-syb.2010.0056" xlink:type="simple">10.1049/iet-syb.2010.0056</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kurata</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>El-Samad</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Iwasaki</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ohtake</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Doyle</surname> <given-names>JC</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Module-based analysis of robustness tradeoffs in the heat shock response system</article-title>. <source>PLoS computational biology</source> <volume>2</volume>: <fpage>e59</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020059" xlink:type="simple">10.1371/journal.pcbi.0020059</ext-link></comment> <object-id pub-id-type="pmid">16863396</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Cover</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>JA</given-names></name> (<year>2006</year>) <source>Elements of Information Theory (Wiley Series in Telecommunications and Signal Processing)</source>. <publisher-name>Wiley-Interscience</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004235.ref040">
<label>40</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>O’Rourke</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Herskowitz</surname> <given-names>I</given-names></name> (<year>1998</year>) <article-title>The Hog1 MAPK prevents cross talk between the HOG and pheromone response MAPK pathways in Saccharomyces cerevisiae</article-title>. <source>Genes &amp; development</source> <volume>12</volume>: <fpage>2874</fpage>–<lpage>2886</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gad.12.18.2874" xlink:type="simple">10.1101/gad.12.18.2874</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref041">
<label>41</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Donizelli</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rodriguez</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Dharuri</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Endler</surname> <given-names>L</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>BioModels Database: An enhanced, curated and annotated resource for published quantitative kinetic models</article-title>. <source>BMC Syst Biol</source> <volume>4</volume>: <fpage>92</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1752-0509-4-92" xlink:type="simple">10.1186/1752-0509-4-92</ext-link></comment> <object-id pub-id-type="pmid">20587024</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref042">
<label>42</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Yi</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Simon</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Doyle</surname> <given-names>JC</given-names></name> (<year>2000</year>) <article-title>Robust perfect adaptation in bacterial chemotaxis through integral feedback control</article-title>. <source>PNAS</source> <volume>97</volume>: <fpage>4649</fpage>–<lpage>4653</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.97.9.4649" xlink:type="simple">10.1073/pnas.97.9.4649</ext-link></comment> <object-id pub-id-type="pmid">10781070</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref043">
<label>43</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Barkal</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Leibler</surname> <given-names>S</given-names></name> (<year>1997</year>) <article-title>Robustness in simple biochemical networks</article-title>. <source>Nature</source> <volume>387</volume>: <fpage>913</fpage>–<lpage>917</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/43199" xlink:type="simple">10.1038/43199</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref044">
<label>44</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Spiro</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Parkinson</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Othmer</surname> <given-names>HG</given-names></name> (<year>1997</year>) <article-title>A model of excitation and adaptation in bacterial chemotaxis</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>94</volume>: <fpage>7263</fpage>–<lpage>7268</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.94.14.7263" xlink:type="simple">10.1073/pnas.94.14.7263</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref045">
<label>45</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mello</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Tu</surname> <given-names>Y</given-names></name> (<year>2003</year>) <article-title>Perfect and near-perfect adaptation in a model of bacterial chemotaxis</article-title>. <source>Biophysical journal</source> <volume>84</volume>: <fpage>2943</fpage>–<lpage>2956</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(03)70021-6" xlink:type="simple">10.1016/S0006-3495(03)70021-6</ext-link></comment> <object-id pub-id-type="pmid">12719226</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref046">
<label>46</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Alberts</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Raff</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Roberts</surname> <given-names>K</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <source>Molecular biology of the cell</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Garland Science</publisher-name>, <edition>fifth edition</edition>.</mixed-citation>
</ref>
<ref id="pcbi.1004235.ref047">
<label>47</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>van Maris</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Abbott</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Bellissimi</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>van den Brink</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kuyper</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Alcoholic fermentation of carbon sources in biomass hydrolysates by Saccharomyces cerevisiae: current status</article-title>. <source>Antonie Van Leeuwenhoek</source> <volume>90</volume>: <fpage>391</fpage>–<lpage>418</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10482-006-9085-7" xlink:type="simple">10.1007/s10482-006-9085-7</ext-link></comment> <object-id pub-id-type="pmid">17033882</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref048">
<label>48</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hynne</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Danø</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sørensen</surname> <given-names>PG</given-names></name> (<year>2001</year>) <article-title>Full-scale model of glycolysis in Saccharomyces cerevisiae</article-title>. <source>Biophysical Chemistry</source> <volume>94</volume>: <fpage>121</fpage>–<lpage>163</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0301-4622(01)00229-0" xlink:type="simple">10.1016/S0301-4622(01)00229-0</ext-link></comment> <object-id pub-id-type="pmid">11744196</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref049">
<label>49</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Blomberg</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Adler</surname> <given-names>L</given-names></name> (<year>1989</year>) <article-title>Roles of glycerol and glycerol-3-phosphate dehydrogenase (NAD+) in acquired osmotolerance of Saccharomyces cerevisiae</article-title>. <source>Journal of Bacteriology</source> <volume>171</volume>: <fpage>1087</fpage>–<lpage>1092</lpage>. <object-id pub-id-type="pmid">2644223</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref050">
<label>50</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Terzer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Stelling</surname> <given-names>J</given-names></name> (<year>2008</year>) <article-title>Large-scale computation of elementary flux modes with bit pattern trees</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>2229</fpage>–<lpage>2235</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn401" xlink:type="simple">10.1093/bioinformatics/btn401</ext-link></comment> <object-id pub-id-type="pmid">18676417</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref051">
<label>51</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Schuster</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pfeiffer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Moldenhauer</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Dandekar</surname> <given-names>T</given-names></name> (<year>2002</year>) <article-title>Exploring the pathway structure of metabolism: decomposition into subnetworks and application to Mycoplasma pneumoniae</article-title>. <source>Bioinformatics</source> <volume>18</volume>: <fpage>351</fpage>–<lpage>361</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/18.2.351" xlink:type="simple">10.1093/bioinformatics/18.2.351</ext-link></comment> <object-id pub-id-type="pmid">11847093</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref052">
<label>52</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Boles</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hollenberg</surname> <given-names>CP</given-names></name> (<year>1997</year>) <article-title>The molecular genetics of hexose transport in yeasts</article-title>. <source>FEMS microbiology reviews</source> <volume>21</volume>: <fpage>85</fpage>–<lpage>111</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1574-6976.1997.tb00346.x" xlink:type="simple">10.1111/j.1574-6976.1997.tb00346.x</ext-link></comment> <object-id pub-id-type="pmid">9299703</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref053">
<label>53</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Yu</surname> <given-names>KO</given-names></name>, <name name-style="western"><surname>Jung</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ramzi</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>C</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Improvement of ethanol yield from glycerol via conversion of pyruvate to ethanol in metabolically engineered Saccharomyces cerevisiae</article-title>. <source>Applied biochemistry and biotechnology</source> <volume>166</volume>: <fpage>856</fpage>–<lpage>865</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s12010-011-9475-9" xlink:type="simple">10.1007/s12010-011-9475-9</ext-link></comment> <object-id pub-id-type="pmid">22161213</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref054">
<label>54</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Guo</surname> <given-names>ZP</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ding</surname> <given-names>ZY</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>ZX</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>GY</given-names></name> (<year>2011</year>) <article-title>Improving ethanol productivity by modification of glycolytic redox factor generation in glycerol-3-phosphate dehydrogenase mutants of an industrial ethanol yeast</article-title>. <source>Journal of Industrial Microbiology &amp; Biotechnology</source> <volume>38</volume>: <fpage>935</fpage>–<lpage>943</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10295-010-0864-9" xlink:type="simple">10.1007/s10295-010-0864-9</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref055">
<label>55</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Chiang</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Low</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Calderbank</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Doyle</surname> <given-names>JC</given-names></name> (<year>2007</year>) <article-title>Layering as optimization decomposition: A mathematical theory of network architectures</article-title>. <source>Proceedings of the IEEE</source> <volume>95</volume>: <fpage>255</fpage>–<lpage>312</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/JPROC.2006.887322" xlink:type="simple">10.1109/JPROC.2006.887322</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref056">
<label>56</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Prescott</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Papachristodoulou</surname> <given-names>A</given-names></name> (<year>2012</year>) <article-title>Guaranteed error bounds for structured complexity reduction of biochemical networks</article-title>. <source>Journal of Theoretical Biology</source> <volume>302</volume>: <fpage>172</fpage>–<lpage>182</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2012.04.002" xlink:type="simple">10.1016/j.jtbi.2012.04.002</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004235.ref057">
<label>57</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Ellson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gansner</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Koutsofios</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>North</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Woodhull</surname> <given-names>G</given-names></name> (<year>2001</year>) <chapter-title>Graphviz—open source graph drawing tools</chapter-title>. In: <source>Lecture Notes in Computer Science</source>. <publisher-name>Springer-Verlag</publisher-name>, pp. <fpage>483</fpage>–<lpage>484</lpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>