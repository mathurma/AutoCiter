<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006643</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-00453</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Motion</subject><subj-group><subject>Velocity</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Waves</subject><subj-group><subject>Wave propagation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Animal models</subject><subj-group><subject>Marmosets</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Amniotes</subject><subj-group><subject>Mammals</subject><subj-group><subject>Primates</subject><subj-group><subject>Monkeys</subject><subj-group><subject>New World monkeys</subject><subj-group><subject>Marmosets</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Signal filtering</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Algebra</subject><subj-group><subject>Linear algebra</subject><subj-group><subject>Singular value decomposition</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Waves</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Multivariate analysis</subject><subj-group><subject>Principal component analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Multivariate analysis</subject><subj-group><subject>Principal component analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Detection and analysis of spatiotemporal patterns in brain activity</article-title>
<alt-title alt-title-type="running-head">Spatiotemporal patterns in brain activity</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4574-3727</contrib-id>
<name name-style="western">
<surname>Townsend</surname>
<given-names>Rory G.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Gong</surname>
<given-names>Pulin</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>School of Physics, The University of Sydney, NSW, Australia</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>ARC Centre of Excellence for Integrative Brain Function, The University of Sydney, NSW, Australia</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Bush</surname>
<given-names>Daniel</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University College London, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">pulin.gong@sydney.edu.au</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>3</day>
<month>12</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<month>12</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>12</issue>
<elocation-id>e1006643</elocation-id>
<history>
<date date-type="received">
<day>19</day>
<month>3</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>14</day>
<month>11</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Townsend, Gong</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006643"/>
<abstract>
<p>There is growing evidence that population-level brain activity is often organized into propagating waves that are structured in both space and time. Such spatiotemporal patterns have been linked to brain function and observed across multiple recording methodologies and scales. The ability to detect and analyze these patterns is thus essential for understanding the working mechanisms of neural circuits. Here we present a mathematical and computational framework for the identification and analysis of multiple classes of wave patterns in neural population-level recordings. By drawing a conceptual link between spatiotemporal patterns found in the brain and coherent structures such as vortices found in turbulent flows, we introduce velocity vector fields to characterize neural population activity. These vector fields are calculated for both phase and amplitude of oscillatory neural signals by adapting optical flow estimation methods from the field of computer vision. Based on these velocity vector fields, we then introduce order parameters and critical point analysis to detect and characterize a diverse range of propagating wave patterns, including planar waves, sources, sinks, spiral waves, and saddle patterns. We also introduce a novel vector field decomposition method that extracts the dominant spatiotemporal structures in a recording. This enables neural data to be represented by the activity of a small number of independent spatiotemporal modes, providing an alternative to existing dimensionality reduction techniques which separate space and time components. We demonstrate the capabilities of the framework and toolbox with simulated data, local field potentials from marmoset visual cortex and optical voltage recordings from whole mouse cortex, and we show that pattern dynamics are non-random and are modulated by the presence of visual stimuli. These methods are implemented in a MATLAB toolbox, which is freely available under an open-source licensing agreement.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Structured activity such as propagating wave patterns at the level of neural circuits can arise from highly variable firing activity of individual neurons. This property makes the brain, a quintessential example of a complex system, analogous to other complex physical systems such as turbulent fluids, in which structured patterns like vortices similarly emerge from molecules that behave irregularly. In this study, by uniquely adapting techniques for the identification of coherent structures in fluid turbulence, we develop new analytical and computational methods for the reliable detection of a diverse range of propagating wave patterns in large-scale neural recordings, for comprehensive analysis and visualization of these patterns, and for analysis of their dominant spatiotemporal modes. We demonstrate that these methods can be used to uncover the essential spatiotemporal properties of neural population activity recorded by different modalities, thus offering new insights into understanding the working mechanisms of neural systems.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000923</institution-id>
<institution>Australian Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>DP160104368 and DP160104316</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Gong</surname>
<given-names>Pulin</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>PG was supported by Australian Research Council grants DP160104368 and DP160104316 (<ext-link ext-link-type="uri" xlink:href="http://www.arc.gov.au/" xlink:type="simple">http://www.arc.gov.au/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="11"/>
<table-count count="0"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-12-13</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Our methods toolbox is freely available under an open-source licensing agreement: <ext-link ext-link-type="uri" xlink:href="https://github.com/BrainDynamicsUSYD/NeuroPattToolbox" xlink:type="simple">https://github.com/BrainDynamicsUSYD/NeuroPattToolbox</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Recent advances in brain recording techniques have led to a rapid influx of high spatial- and temporal-resolution datasets of large neural populations [<xref ref-type="bibr" rid="pcbi.1006643.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006643.ref004">4</xref>]. One of the major challenges in modern neuroscience is to identify and extract important population-level structures and dynamics from these datasets [<xref ref-type="bibr" rid="pcbi.1006643.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref006">6</xref>]. Traditionally, neural population activity has been mainly studied from the perspective of temporal synchrony or correlation, and relating correlated neural activity to brain functions has been the major focus of many studies in neuroscience during the past two decades [<xref ref-type="bibr" rid="pcbi.1006643.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref008">8</xref>].</p>
<p>However, growing evidence indicates that population-level brain activity is often organized into patterns that are structured in both space and time. Such spatiotemporal patterns, including planar traveling waves [<xref ref-type="bibr" rid="pcbi.1006643.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1006643.ref011">11</xref>], spiral waves which rotate around a central point [<xref ref-type="bibr" rid="pcbi.1006643.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1006643.ref014">14</xref>], source and sink patterns which expand or contract from a point [<xref ref-type="bibr" rid="pcbi.1006643.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref015">15</xref>], and saddle patterns which are formed by the interaction of multiple waves [<xref ref-type="bibr" rid="pcbi.1006643.ref013">13</xref>], have been observed at different neural levels within multiple recording techniques, including multi-electrode arrays [<xref ref-type="bibr" rid="pcbi.1006643.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1006643.ref018">18</xref>], voltage sensitive dye (VSD) imaging [<xref ref-type="bibr" rid="pcbi.1006643.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref019">19</xref>], and electroencephalography (EEG), electrocorticography (ECoG), magnetoencephalography (MEG) and functional magnetic resonance imaging (fMRI) [<xref ref-type="bibr" rid="pcbi.1006643.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1006643.ref024">24</xref>].</p>
<p>The functional role of these spatiotemporal patterns is a subject of active research: In spontaneous activity, propagating patterns have been shown to follow repeated temporal motifs instead of occurring randomly [<xref ref-type="bibr" rid="pcbi.1006643.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref015">15</xref>], and are postulated to facilitate information transfer across brain regions [<xref ref-type="bibr" rid="pcbi.1006643.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref017">17</xref>] and carry out distributed dynamical computation [<xref ref-type="bibr" rid="pcbi.1006643.ref025">25</xref>]. In sensory cortices, stimuli can elicit repeatable propagating patterns [<xref ref-type="bibr" rid="pcbi.1006643.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref026">26</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref027">27</xref>], and the properties of these waves can be linked to stimulus features. For instance, the phase and amplitude of traveling waves in the motor cortex and visual cortex correlate with reach target location [<xref ref-type="bibr" rid="pcbi.1006643.ref017">17</xref>] and with saccade size [<xref ref-type="bibr" rid="pcbi.1006643.ref018">18</xref>], respectively, and the propagation direction of moving patterns in the visual cortex is sensitive to visual movement orientation [<xref ref-type="bibr" rid="pcbi.1006643.ref028">28</xref>]. These studies thus indicate that the ability to detect and analyze these patterns is essential for uncovering the principled dynamics of neural population activity and for understanding the working mechanisms of neural circuits [<xref ref-type="bibr" rid="pcbi.1006643.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref026">26</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref029">29</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref030">30</xref>].</p>
<p>In this study, to detect changes of neural signals happening across both space and time, we introduce velocity vector fields which represent the speed and direction of local spatiotemporal propagations. These vector fields allow us to make a novel conceptual link between spatiotemporal patterns in neural activity and complex patterns such as vortices or eddies found in the field of fluid turbulence [<xref ref-type="bibr" rid="pcbi.1006643.ref031">31</xref>–<xref ref-type="bibr" rid="pcbi.1006643.ref033">33</xref>], in which these patterns are similarly characterized by using velocity fields of the underlying moving molecules. Velocity vector fields in our methods are computed by adapting optical flow estimation methods originally developed in the field of computer vision [<xref ref-type="bibr" rid="pcbi.1006643.ref034">34</xref>]. Optical flow techniques have previously been implemented to analyze brain activity [<xref ref-type="bibr" rid="pcbi.1006643.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1006643.ref028">28</xref>], but here we extend these methods to consider the amplitude and phase of oscillatory neural signals, allowing for a comprehensive analysis of neural spatiotemporal patterns. When constructed from oscillation phase, velocity vector fields are conceptually similar to phase gradient vector fields as often used in previous studies [<xref ref-type="bibr" rid="pcbi.1006643.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref018">18</xref>]. However, velocity vector fields provide a conceptual basis for us to adapt methods from turbulence to develop a unified methodological framework for analyzing neural spatiotemporal patterns.</p>
<p>We show that by examining the critical points in a velocity vector field (also called “stationary points” or “singularity points”), where the local velocity is zero [<xref ref-type="bibr" rid="pcbi.1006643.ref035">35</xref>], different types of spatiotemporal patterns including spiral waves (“foci”), source/sink patterns (“nodes”) and saddles can be detected. In addition to these complex wave patterns, neural systems can exhibit widespread synchrony and planar travelling waves. These types of activity are common to many physical and biological systems, and can be detected by introducing global order parameters calculated from velocity vector fields [<xref ref-type="bibr" rid="pcbi.1006643.ref036">36</xref>]. These methods thus enable the automatic detection of a diverse range of spatiotemporal patterns after user-defined parameters have been chosen; these parameters are discussed in detail in <xref ref-type="sec" rid="sec013">Methods and Materials</xref>.</p>
<p>Aside from detecting these patterns, our methods can provide systematic analysis of pattern dynamics including their evolution pathways and their underlying spatiotemporal modes that exhibit intrinsic and inseparable spatial and temporal features, thus providing a novel alternative to existing dimensionality reduction techniques which instead separate space and time components [<xref ref-type="bibr" rid="pcbi.1006643.ref006">6</xref>]. We validate the effectiveness of all methods and their implementation in the toolbox through multiple approaches. Using synthetic data with known pattern activity, we show that spatiotemporal pattern detection is accurate and reliable even in noisy conditions. We then analyze local field potentials from multi-electrode arrays in marmoset visual cortex and whole-brain optical imaging data from mouse cortex to test our methodological framework across different recording modalities, species, and neural scales. We find that pattern properties including location and propagation direction are modulated by visual stimulus, and that patterns evolve along structured pathways following preferred transitions.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>Here we outline a methodological framework for detecting and analyzing wave patterns in neural recordings using velocity vector fields. These methods can be applied to any recording methodology with high spatial and temporal resolution, including multi-electrode LFPs, VSD and optical imaging, ECoG, EEG, and MEG. Some of these methods have been briefly described in our previous work [<xref ref-type="bibr" rid="pcbi.1006643.ref013">13</xref>], but in this paper we examine them in more depth and show how they can be uniquely combined with new techniques to form a systematic framework for pattern detection and analysis. We also discuss their implementation into a freely available MATLAB toolbox, the NeuroPatt toolbox. Neural data from a two-dimensional spatiotemporal recording are represented by a four-dimensional matrix, <inline-formula id="pcbi.1006643.e001"><alternatives><graphic id="pcbi.1006643.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mi>z</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>, where <italic>z</italic> is the recorded signal with regular spatial coordinates <inline-formula id="pcbi.1006643.e002"><alternatives><graphic id="pcbi.1006643.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>, time <italic>t</italic>, and trial presentation <italic>p</italic>. Recordings without repeated trials or averaged across all trials have <inline-formula id="pcbi.1006643.e003"><alternatives><graphic id="pcbi.1006643.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>, although we caution that trial-averaged signals typically do not capture the spatiotemporal patterns present in single trials [<xref ref-type="bibr" rid="pcbi.1006643.ref024">24</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref028">28</xref>].</p>
<sec id="sec003">
<title>Velocity vector fields</title>
<p>Neural activity, although appearing highly disordered at the single-neuron level, can form dynamical coherent structures such as propagating waves at the population level [<xref ref-type="bibr" rid="pcbi.1006643.ref037">37</xref>]. There are many other complex systems that display similar emergent pattern dynamics, including fluid turbulence, in which coherent flows and vortices emerge from interacting molecules that behave irregularly [<xref ref-type="bibr" rid="pcbi.1006643.ref031">31</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref032">32</xref>]. Velocity vector fields, which represent the direction and speed of fluid motion, are essential mathematical tools for detecting and analyzing coherent activity patterns embedded in turbulent flow [<xref ref-type="bibr" rid="pcbi.1006643.ref032">32</xref>]; studies using this approach typically separate activity patterns at different scales, independently detecting both large-scale flows and small-scale eddies [<xref ref-type="bibr" rid="pcbi.1006643.ref033">33</xref>]. In turbulent flow, velocity vector fields are typically measured by following the movement of tracer particles within the fluid [<xref ref-type="bibr" rid="pcbi.1006643.ref038">38</xref>]. Here, we introduce a method for calculating analogous velocity vector fields in neural signals, representing the local direction and speed of propagating activity at each recording site. As for in studies of coherent structures in turbulence, these velocity fields obtained in neural data provide a powerful conceptual framework for analyzing a diverse range of propagating wave patterns in the brain.</p>
<p>For a data sequence <italic>D(x</italic>,<italic>y</italic>,<italic>t)</italic>, which may represent the raw recorded signal <italic>z</italic> or the amplitude <italic>A</italic> or phase <italic>θ</italic> of an oscillatory neural signal, extracted by using either the Hilbert transform [<xref ref-type="bibr" rid="pcbi.1006643.ref039">39</xref>] or complex Morlet wavelets [<xref ref-type="bibr" rid="pcbi.1006643.ref040">40</xref>] (see Oscillatory data filtering in <xref ref-type="sec" rid="sec013">Methods and Materials</xref>), the velocity vector field <inline-formula id="pcbi.1006643.e004"><alternatives><graphic id="pcbi.1006643.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> represents the velocity in <italic>x</italic>- and <italic>y</italic>-directions at each location between time <italic>t</italic> and <italic>t+δt</italic>, where <italic>δt</italic> is the time step specified by the sampling frequency. If data contain multiple trials, the velocity vector field is computed iteratively for each trial.</p>
<p>To calculate the velocity field <italic>w(x</italic>,<italic>y</italic>,<italic>t)</italic>, we adapt optical flow estimation techniques from the field of computer science, which were first developed by Horn and Shunck to track the motion between successive frames of a sequence of images [<xref ref-type="bibr" rid="pcbi.1006643.ref034">34</xref>]. In their original formulation, the optical flow is calculated by solving two constraints. The first is the data constancy constraint,
<disp-formula id="pcbi.1006643.e005">
<alternatives>
<graphic id="pcbi.1006643.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
which specifies that the same data is present at time <italic>t</italic> and time <inline-formula id="pcbi.1006643.e006"><alternatives><graphic id="pcbi.1006643.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>, only shifted in space. To first order, this can be expressed as
<disp-formula id="pcbi.1006643.e007">
<alternatives>
<graphic id="pcbi.1006643.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
where <inline-formula id="pcbi.1006643.e008"><alternatives><graphic id="pcbi.1006643.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the error in the data constancy, <inline-formula id="pcbi.1006643.e009"><alternatives><graphic id="pcbi.1006643.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006643.e010"><alternatives><graphic id="pcbi.1006643.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> denote spatial derivatives, and <inline-formula id="pcbi.1006643.e011"><alternatives><graphic id="pcbi.1006643.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> denotes the temporal derivative at the point <inline-formula id="pcbi.1006643.e012"><alternatives><graphic id="pcbi.1006643.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>. The second is the spatial smoothness constraint, which specifies that the computed velocity fields contain smooth and continuous motion where possible. This constraint can be expressed as
<disp-formula id="pcbi.1006643.e013">
<alternatives>
<graphic id="pcbi.1006643.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e013" xlink:type="simple"/>
<mml:math display="block" id="M13">
<mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where <inline-formula id="pcbi.1006643.e014"><alternatives><graphic id="pcbi.1006643.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> quantifies the overall departure from smoothness, and <inline-formula id="pcbi.1006643.e015"><alternatives><graphic id="pcbi.1006643.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mo>∇</mml:mo><mml:mo>≐</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>∂</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>∂</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> denotes the gradient operator. The velocity vector field can uniquely be defined by minimizing both these error terms:
<disp-formula id="pcbi.1006643.e016">
<alternatives>
<graphic id="pcbi.1006643.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e016" xlink:type="simple"/>
<mml:math display="block" id="M16">
<mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>∬</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">E</mml:mi><mml:mi mathvariant="italic">d</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">E</mml:mi><mml:mi mathvariant="italic">s</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi mathvariant="italic">d</mml:mi><mml:mi mathvariant="italic">x</mml:mi><mml:mi mathvariant="italic">d</mml:mi><mml:mi mathvariant="italic">y</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
for some regularization parameter <italic>α</italic> and penalty function <inline-formula id="pcbi.1006643.e017"><alternatives><graphic id="pcbi.1006643.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mi>ρ</mml:mi></mml:math></alternatives></inline-formula>. Horn and Shunck used a quadratic penalty, <inline-formula id="pcbi.1006643.e018"><alternatives><graphic id="pcbi.1006643.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mi>ρ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, but this can lead to inaccuracies if the underlying data contains hard edges and adjacent regions moving in different directions [<xref ref-type="bibr" rid="pcbi.1006643.ref041">41</xref>]. More accurate velocity vector fields can be obtained by using the Charbonnier penalty, <inline-formula id="pcbi.1006643.e019"><alternatives><graphic id="pcbi.1006643.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, for a small positive constant <italic>β</italic> [<xref ref-type="bibr" rid="pcbi.1006643.ref042">42</xref>]. <xref ref-type="disp-formula" rid="pcbi.1006643.e016">Eq 4</xref> can be solved by linearizing its corresponding Euler-Lagrange equations, creating a unique velocity vector field <italic>w</italic> (see Solving optical flow equations in <xref ref-type="sec" rid="sec013">Methods and Materials</xref>).</p>
</sec>
<sec id="sec004">
<title>Complex wave pattern detection by critical point analysis</title>
<p>Turbulence studies typically separate activity at different scales based on velocity fields [<xref ref-type="bibr" rid="pcbi.1006643.ref033">33</xref>]. We similarly implement independent procedures to detect global patterns (plane waves and synchronous activity), which are active across the whole recording area, and complex wave patterns, including source, sink, spiral and saddle patterns, which are characterized by local activity around their central points. Complex spatiotemporal wave patterns, which are analogous to eddies, are organized around critical points where the velocity field has zero magnitude [<xref ref-type="bibr" rid="pcbi.1006643.ref035">35</xref>]. These complex wave patterns generate distinctive dynamics around their central critical points; in our methodology, we exploit this dynamical property to automatically detect and classify such patterns. In velocity fields, we identify critical points as locations where both <italic>x</italic>- and <italic>y</italic>-components of the velocity are zero by finding intersections of the bilinearly interpolated zero-level contours lines of <italic>u</italic> and <italic>v</italic> [<xref ref-type="bibr" rid="pcbi.1006643.ref043">43</xref>]. Each critical point is then categorized by the Jacobian matrix,
<disp-formula id="pcbi.1006643.e020">
<alternatives>
<graphic id="pcbi.1006643.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e020" xlink:type="simple"/>
<mml:math display="block" id="M20">
<mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
which is estimated at the critical point using bilinear interpolation from the corners of the surrounding 4-element cell of recording sites. Depending on the trace (τ) and determinant (Δ) of the Jacobian, critical points are classified as a node (<inline-formula id="pcbi.1006643.e021"><alternatives><graphic id="pcbi.1006643.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mo>∆</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006643.e022"><alternatives><graphic id="pcbi.1006643.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>4</mml:mn><mml:mo>∆</mml:mo></mml:math></alternatives></inline-formula>), focus (<inline-formula id="pcbi.1006643.e023"><alternatives><graphic id="pcbi.1006643.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mo>∆</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006643.e024"><alternatives><graphic id="pcbi.1006643.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>4</mml:mn><mml:mo>∆</mml:mo></mml:math></alternatives></inline-formula>), or saddle (<inline-formula id="pcbi.1006643.e025"><alternatives><graphic id="pcbi.1006643.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mo>∆</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula>), and node and focus points are further classified as stable (<inline-formula id="pcbi.1006643.e026"><alternatives><graphic id="pcbi.1006643.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mi>τ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula>) or unstable (<inline-formula id="pcbi.1006643.e027"><alternatives><graphic id="pcbi.1006643.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mi>τ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula>).</p>
<p>These classes of critical points correspond to different types of wave patterns (<xref ref-type="fig" rid="pcbi.1006643.g001">Fig 1</xref>): Nodes expand or contract from a critical point, forming sources or sinks, respectively; saddles have one stable axis and one unstable axis, and are typically formed through interactions between different waves; and foci rotate around the critical point, thereby corresponding to spiral waves. In addition to their rotating motion, foci can also involve expansion or contraction from the critical point, forming spiral-out or spiral-in wave patterns, respectively. However, previous studies of spiral waves have not distinguished between spirals-out and spirals-in [<xref ref-type="bibr" rid="pcbi.1006643.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref014">14</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref044">44</xref>]. In our methods and toolbox, these patterns can therefore optionally be combined to facilitate direct comparison with other published results.</p>
<fig id="pcbi.1006643.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006643.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Critical points in vector fields.</title>
<p>Schematic of critical point types in velocity vector fields. Dots and triangles show critical points, arrows show typical surrounding vector fields for all 2D critical point classes. Unstable and stable nodes correspond to source and sink patterns respectively, unstable and stable foci correspond to spirals-out and spirals-in respectively. Saddle pattern has stable (solid line) and unstable (dashed line) axes indicated, these axes can occur at any orientation in general.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006643.g001" xlink:type="simple"/>
</fig>
<p>Although complex wave patterns are classified only by the local properties of their central critical point, they can spread over larger regions of space. We thus develop a method for characterizing the spatial extent of complex wave patterns by using the winding number (Poincaré index), which has a value of +1 for node and focus patterns and <inline-formula id="pcbi.1006643.e028"><alternatives><graphic id="pcbi.1006643.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> for saddle patterns for all closed paths within the pattern’s extent around the location of the critical point [<xref ref-type="bibr" rid="pcbi.1006643.ref043">43</xref>]. We create approximately circular paths around the location of the critical point, and the winding number is estimated in each of these paths as
<disp-formula id="pcbi.1006643.e029">
<alternatives>
<graphic id="pcbi.1006643.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e029" xlink:type="simple"/>
<mml:math display="block" id="M29">
<mml:mrow><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mspace width="0.25em"/><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mtext>n</mml:mtext></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
where <inline-formula id="pcbi.1006643.e030"><alternatives><graphic id="pcbi.1006643.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the angle of the <italic>k</italic>-th vector around a closed counter-clockwise path with <italic>n</italic> points, angles are subtracted circularly, and where <inline-formula id="pcbi.1006643.e031"><alternatives><graphic id="pcbi.1006643.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. We compute the winding number in paths of expanding size around a pattern’s center, and its spatial extent is defined by the largest area within which all computed winding numbers are consistent with the critical point type. This procedure therefore provides an efficient estimate how far wave patterns spread across the cortex, an important property of neural oscillatory activity.</p>
</sec>
<sec id="sec005">
<title>Synchrony and plane wave detection by order parameters</title>
<p>We next introduce methods for detecting and analyzing simple, large-scale patterns such as synchrony and planar waves by defining order parameters based on the velocity vector fields. We detect planar waves using an order parameter defined as the average normalized velocity [<xref ref-type="bibr" rid="pcbi.1006643.ref036">36</xref>]:
<disp-formula id="pcbi.1006643.e032">
<alternatives>
<graphic id="pcbi.1006643.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e032" xlink:type="simple"/>
<mml:math display="block" id="M32">
<mml:mrow><mml:mi>φ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle displaystyle="true" mathsize="140%"><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>∑</mml:mo></mml:mrow></mml:mstyle><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula></p>
<p>This statistic is equivalent to phase gradient directionality [<xref ref-type="bibr" rid="pcbi.1006643.ref017">17</xref>] except it uses velocity vector fields instead of the phase gradient. Normalized velocity ranges from zero to one, with <inline-formula id="pcbi.1006643.e033"><alternatives><graphic id="pcbi.1006643.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mi>φ</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> as velocity vectors align to one direction, reflecting coherent motion across the recording area. Plane wave activity is therefore detected at times when <italic>φ</italic> is greater than some threshold value <inline-formula id="pcbi.1006643.e034"><alternatives><graphic id="pcbi.1006643.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, which should be close to one (<inline-formula id="pcbi.1006643.e035"><alternatives><graphic id="pcbi.1006643.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.85</mml:mn></mml:math></alternatives></inline-formula> by default in the toolbox).</p>
<p>If data has been band-pass filtered to extract the oscillation phase <italic>θ</italic>, we also detect large-spread synchronous activity using another order parameter, which is defined as the resultant vector length of phase across the recording area [<xref ref-type="bibr" rid="pcbi.1006643.ref045">45</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref046">46</xref>],
<disp-formula id="pcbi.1006643.e036">
<alternatives>
<graphic id="pcbi.1006643.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e036" xlink:type="simple"/>
<mml:math display="block" id="M36">
<mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>θ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
where <italic>N</italic> is the number of spatial recording sites in phase maps. The resultant vector also ranges from zero to one, with <inline-formula id="pcbi.1006643.e037"><alternatives><graphic id="pcbi.1006643.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> as the phase of oscillations at all recording sites align to the same value, reflecting wide-spread synchrony. We note that the order parameter as defined in <xref ref-type="disp-formula" rid="pcbi.1006643.e036">Eq 8</xref> is similar to that used to characterize global synchrony in coupled phase oscillators [<xref ref-type="bibr" rid="pcbi.1006643.ref047">47</xref>], and <inline-formula id="pcbi.1006643.e038"><alternatives><graphic id="pcbi.1006643.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>R</mml:mi></mml:math></alternatives></inline-formula> is commonly defined as the circular variance [<xref ref-type="bibr" rid="pcbi.1006643.ref045">45</xref>]. Synchronous activity is therefore detected at times when <italic>R</italic> is higher than another threshold value <inline-formula id="pcbi.1006643.e039"><alternatives><graphic id="pcbi.1006643.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, the default of which is <inline-formula id="pcbi.1006643.e040"><alternatives><graphic id="pcbi.1006643.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:math></alternatives></inline-formula> in the toolbox.</p>
</sec>
<sec id="sec006">
<title>Critical point detection accuracy in simulated data</title>
<p>To test the performance of our pattern detection methods, we generated artificial data sets with simultaneous source and sink patterns active at the same frequency, located at random positions and propagating in random directions within a 12×12 spatial grid (see Simulated data in <xref ref-type="sec" rid="sec013">Methods and Materials</xref>). We then added Gaussian white noise, band-pass filtered the signal, calculated velocity vector fields, searched for complex wave patterns in the velocity fields, and compared the detected pattern centers with their true locations. An example of this procedure is shown in <xref ref-type="fig" rid="pcbi.1006643.g002">Fig 2</xref>, which shows calculated velocity fields and pattern centers between two frames of a simulated data set (<xref ref-type="fig" rid="pcbi.1006643.g002">Fig 2A</xref>). The velocity fields depend on two parameters in the optical flow estimation procedure (<xref ref-type="disp-formula" rid="pcbi.1006643.e016">Eq 4</xref>): The smoothness regularization parameter <italic>α</italic>, and non-linear penalty constant <italic>β</italic>.</p>
<fig id="pcbi.1006643.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006643.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Effect of optical flow parameters on computed velocity fields.</title>
<p><bold>A,</bold> Consecutive snapshots separated by arbitrary time step <italic>δt</italic> of artificial noisy phase data, containing an expanding source and contracting sink pattern, both drifting slowly across the array. <bold>B,</bold> Velocity fields between images in <bold>A</bold> calculated using optical flow with varying smoothness parameter <italic>α</italic> and non-linear penalty parameter <italic>β</italic>. Filled red circles indicate detected critical points, open blue circles indicate true critical point locations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006643.g002" xlink:type="simple"/>
</fig>
<p>The smoothness regularization parameter <italic>α</italic> determines the weighting of the smoothness constraint compared to the data constraint, and thereby the overall smoothness of the velocity fields. Small values of <italic>α</italic> generate velocity fields that primarily capture local changes and are therefore sensitive to added noise, potentially leading to the detection of spurious, noise-driven patterns (<xref ref-type="fig" rid="pcbi.1006643.g002">Fig 2B</xref>, left column, α = 0.1). Large values of <italic>α</italic> are more robust to noise, but can over-smooth the data, creating mostly uniform flow fields that do not capture the underlying dynamics (<xref ref-type="fig" rid="pcbi.1006643.g002">Fig 2B</xref>, right column, <italic>α</italic> = 1.5). Reasonable values for <italic>α</italic> can range from ~0.1 to ~20, depending on the size of the data, the dynamics of the propagations, and the level of noise; for example, reducing the spatial sampling frequency of a dataset reduces the number of grid spaces between complex patterns, typically requiring a lower value of <italic>α</italic> to effectively resolve individual patterns. The non-linear penalty constant <italic>β</italic> determines the degree of non-linearity of the penalty functions, with large values <inline-formula id="pcbi.1006643.e041"><alternatives><graphic id="pcbi.1006643.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mi>β</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> resulting in a quadratic penalty and small values <inline-formula id="pcbi.1006643.e042"><alternatives><graphic id="pcbi.1006643.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mi>β</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> in a more robust non-linear penalty. Small values of <italic>β</italic> give more accurate velocity vector fields for any regions with discontinuous motion in the underlying data [<xref ref-type="bibr" rid="pcbi.1006643.ref041">41</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref048">48</xref>], but we find that such discontinuities are rare in neural recordings, so using large values of <italic>β</italic> generally gives similar results (<xref ref-type="fig" rid="pcbi.1006643.g002">Fig 2B</xref>). In addition, when <italic>β</italic> is large and the equations are effectively quadratic, the optical flow procedure can typically converge much faster.</p>
<p>The choice of appropriate values for <italic>α</italic> and <italic>β</italic> cannot be fully automated for a real dataset without making assumptions about the dynamics of the data. However, pattern detection accuracy can be evaluated in simulated datasets with specified properties and pattern dynamics, which can then be used to guide parameter choices in real data. <xref ref-type="fig" rid="pcbi.1006643.g003">Fig 3</xref> illustrates the effectiveness of the pattern detection algorithm for one such set of properties and dynamics (see Simulated data in <xref ref-type="sec" rid="sec013">Methods and Materials</xref>). The detected spatial position of patterns is most accurate when using small values of <inline-formula id="pcbi.1006643.e043"><alternatives><graphic id="pcbi.1006643.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mi>α</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>, <xref ref-type="fig" rid="pcbi.1006643.g003">Fig 3A</xref>). Using a quadratic penalty function (<inline-formula id="pcbi.1006643.e044"><alternatives><graphic id="pcbi.1006643.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math></alternatives></inline-formula>) generally gives more consistent results across a range of <inline-formula id="pcbi.1006643.e045"><alternatives><graphic id="pcbi.1006643.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> values than a non-linear penalty function (<inline-formula id="pcbi.1006643.e046"><alternatives><graphic id="pcbi.1006643.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:math></alternatives></inline-formula>) and results in fewer missing patterns (<xref ref-type="fig" rid="pcbi.1006643.g003">Fig 3B</xref>), but using the non-linear penalty can give a lower false positive rate (<xref ref-type="fig" rid="pcbi.1006643.g003">Fig 3C</xref>). Plotting the true positive rate against the false positive rate provides a clear way to examine the effectiveness of pattern detection across a range of parameters (<xref ref-type="fig" rid="pcbi.1006643.g003">Fig 3D</xref>). We generally recommend using large values of <italic>β</italic> when examining new data sets, as this provides more reliable performance and faster processing overall. Additionally, pattern detection is largely unaffected by noise if the variance of the noise is equal or less than the variance of the pattern oscillations and remains fairly accurate for significantly greater noise levels (<xref ref-type="fig" rid="pcbi.1006643.g003">Fig 3E–3G</xref>).</p>
<fig id="pcbi.1006643.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006643.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Critical point pattern detection performance in simulated data.</title>
<p><bold>A,</bold> Mean displacement (in grid spaces) between detected and true critical point location across <italic>n</italic> = 50 sequences of simulated random critical point patterns for different values of optical flow parameters <italic>α</italic> and <italic>β</italic>. Error bars indicate SEM. Outlined points indicate <italic>α</italic> parameter value used for plots <bold>D</bold>-<bold>F</bold>. <bold>B,</bold> Mean percentage of true patterns missed or misclassified by pattern detection algorithm. <bold>C,</bold> Mean number of extra, spurious patterns detected per time step. <bold>D,</bold> Mean false patterns detected per time step (false positive rate) against the percentage of patterns correctly identified (true positive rate) for different parameter values. <bold>E-G,</bold> Same as <bold>A</bold>-<bold>C</bold>, but showing performance under different levels of noise with a fixed value of <italic>α</italic>. Noise levels are given as the common logarithm of the standard deviation of added white noise relative to average signal amplitude. Outlined points indicate noise level used for plots <bold>A-C</bold>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006643.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec007">
<title>Propagating wave patterns in large-scale neural data</title>
<p>To validate our methods and test for wave pattern activity in real neural data from different scales and imaging techniques, we examined previously published LFP recordings from the MT area of anaesthetized marmosets [<xref ref-type="bibr" rid="pcbi.1006643.ref049">49</xref>] and optogenetic voltage imaging recordings from a complete cortical hemisphere in awake mice [<xref ref-type="bibr" rid="pcbi.1006643.ref050">50</xref>] (see Experimental recordings in <xref ref-type="sec" rid="sec013">Methods and Materials</xref>). Using our methodology, we searched for wave patterns within the phase and amplitude of oscillations across a range of frequency bands. Both datasets exhibited a rich repertoire of wave patterns which were successfully detected. Some examples of common pattern activity for each modality are shown in <xref ref-type="fig" rid="pcbi.1006643.g004">Fig 4</xref>.</p>
<fig id="pcbi.1006643.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006643.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Complex wave patterns in marmoset area MT and mouse cortex.</title>
<p><bold>A, B, C,</bold> Complex wave patterns in phase maps of 4 Hz LFP oscillations during ongoing activity recorded from marmoset area MT. Velocity vector fields (black arrows) were calculated between consecutive phase maps separated by 1 ms; we use larger time gaps between snapshots here to show wave propagation more clearly. Critical points are indicated by symbols corresponding to the classes in <xref ref-type="fig" rid="pcbi.1006643.g001">Fig 1</xref>. <bold>D, E,</bold> Complex wave patterns in phase maps of 4 Hz optical voltage imaging oscillations in awake mouse cortex. Velocity vector fields are calculated from phase maps separated by 20 ms. <bold>F,</bold> Localized propagating activity in amplitude maps of 10 Hz optical voltage imaging oscillations in awake mouse cortex.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006643.g004" xlink:type="simple"/>
</fig>
<p>In delta-band phase of the marmoset data, complex waves were commonly present across the whole 16 mm<sup>2</sup> recording area, including saddle (<xref ref-type="fig" rid="pcbi.1006643.g004">Fig 4A</xref>) and spiral-out (<xref ref-type="fig" rid="pcbi.1006643.g004">Fig 4B</xref>) patterns. We also observed multiple complex wave patterns active simultaneously in different areas of the cortex, as shown for sink and saddle patterns in <xref ref-type="fig" rid="pcbi.1006643.g004">Fig 4C</xref>. In the mouse data, complex waves were present in the phase of slow (4 Hz) oscillations, and these waves sometimes spread across the whole cortical hemisphere, including sink (<xref ref-type="fig" rid="pcbi.1006643.g004">Fig 4D</xref>) and spiral-in (<xref ref-type="fig" rid="pcbi.1006643.g004">Fig 4E</xref>) patterns. Large-scale propagating patterns were also present in the amplitude of 10 Hz oscillations, where multiple spreading patterns often interacted to form saddles (<xref ref-type="fig" rid="pcbi.1006643.g004">Fig 4F</xref>). These examples demonstrate that complex wave patterns are present at multiple scales of brain activity, and that these patterns can be detected and quantified through our methodology.</p>
</sec>
<sec id="sec008">
<title>Analysis of wave pattern properties</title>
<p>Having presented our pattern detection methods, we now demonstrate how these techniques can be used to examine the properties and dynamics of waves patterns in more detail, and how these properties can be further related to brain function. Directly tracking simple and complex wave patterns allows their location, movement direction, prevalence, duration and other properties to be collated across many occurrences. To validate the results of the pattern detection procedure, the properties of patterns detected in a real dataset can be compared to those of patterns detected in a surrogate dataset comprised of noise with similar characteristics to the original data (see Pattern detection parameters and result validation in <xref ref-type="sec" rid="sec013">Methods and Materials</xref>). The processes of band-pass filtering and velocity vector field estimation can smooth data and may therefore generate spurious wave patterns in noise-driven surrogates. However, these patterns in surrogate data are typically more localized and transient than real neural wave patterns and can therefore be mostly removed if the minimum pattern spatial extent and duration parameters are sufficiently large. In neural recordings with genuine wave pattern activity, all pattern types will typically occur more frequently (<xref ref-type="fig" rid="pcbi.1006643.g005">Fig 5A</xref>), be present for a larger proportion of recording time (<xref ref-type="fig" rid="pcbi.1006643.g005">Fig 5B</xref>) and last longer per occurrence (<xref ref-type="fig" rid="pcbi.1006643.g005">Fig 5C</xref>) than equivalent patterns in noise-driven surrogates.</p>
<fig id="pcbi.1006643.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006643.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Wave pattern properties in real data compared to noise-driven surrogate data.</title>
<p><bold>A,</bold> Mean number of 6 Hz phase patterns detected per second per trial in real data (white bars, marmoset LFPs during dot-field stimulus) and surrogate data (shaded bars, white noise with equal mean and variance per recording channel to real data). Error bars indicate SEM across 100 trials for both datasets. PW, plane wave; SY, synchrony; SI, sink; SO, source; SP-I, spiral-in, SP-O, spiral-out, SA, saddle. <bold>B</bold>, Same as <bold>A</bold>, but showing percentage of recording time active. <bold>C,</bold> Same as <bold>A</bold>, but showing mean pattern duration.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006643.g005" xlink:type="simple"/>
</fig>
<p>The properties of wave patterns can vary depending on brain state, recording location, or cognitive task, revealing relevant dynamical changes in the recorded neural system. An example of this is shown in <xref ref-type="fig" rid="pcbi.1006643.g006">Fig 6</xref>, which compares properties of patterns in spontaneous and stimulus-evoked phase velocity fields from the same animal. During ongoing activity (sustained blank screen stimulus), plane waves were active for much of the recording time and propagated in a range of directions (<xref ref-type="fig" rid="pcbi.1006643.g006">Fig 6A</xref>, mean resultant vector length 0.28). Complex wave patterns were also common and did not form randomly in space. Instead their central critical points were clustered around preferred locations (<xref ref-type="fig" rid="pcbi.1006643.g006">Fig 6B</xref>), which were situated at different points in the recording array for node and saddle patterns. When relevant stimulus was presented (coherently propagating dot fields turned on and off every two seconds), relatively fewer plane waves were active overall, but their propagations were more tightly distributed around one preferred direction (<xref ref-type="fig" rid="pcbi.1006643.g006">Fig 6C</xref>, mean resultant vector length 0.42). The presence of stimulus also affected the overall prevalence of critical point patterns, increasing the number of stable and unstable nodes and decreasing the number of saddles, and changed their patterns of distribution across space (<xref ref-type="fig" rid="pcbi.1006643.g006">Fig 6D</xref>). Our methods can therefore be used to quantify changes in spatiotemporal pattern dynamics driven by different stimuli, cognitive tasks or behavioral states.</p>
<fig id="pcbi.1006643.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006643.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Distributions of plane wave propagation direction and complex pattern center location in ongoing and stimulus-evoked PVFs.</title>
<p><bold>A,</bold> Histogram of plane wave propagation direction in 6 Hz phase of ongoing activity. Also shown is the percentage of time across the recording in which plane wave activity occurred. <bold>B,</bold> Spatial distribution within the recording array of critical points across all occurrences of node and saddle patterns. Note that foci have been combined with nodes for this analysis. <bold>C, D,</bold> Same as <bold>A</bold>, <bold>B</bold>, but for a recording visually evoked by moving dot fields.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006643.g006" xlink:type="simple"/>
</fig>
<p>Detected wave patterns can also be processed to reveal their temporal evolution dynamics. Brain activity evolves between different activity patterns in a complex and non-random way, but the mechanisms of these transitions are not well-understood [<xref ref-type="bibr" rid="pcbi.1006643.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref015">15</xref>]. Our methodology provides an ideal framework for exploring such dynamics: Once all patterns in a recording have been identified, common pattern transitions and motifs can easily be identified. We demonstrate some of these evolution dynamics in stimulus-evoked LFP recordings (see Pattern evolution dynamics in <xref ref-type="sec" rid="sec013">Methods and Materials</xref>). Patterns were typically active for tens to hundreds of milliseconds, often then transitioning into a different pattern (<xref ref-type="fig" rid="pcbi.1006643.g007">Fig 7A</xref>). The total number of transitions between all pairs of pattern types were counted across a recording, and the significance of these observed counts was established by comparison to the expected number of counts if all patterns began and ended at random times (<xref ref-type="fig" rid="pcbi.1006643.g007">Fig 7B</xref>). Using this simple analysis, we observed that periods of plane wave and synchronous activity were usually interspersed by other pattern types, synchronous activity was highly likely to transition to or from all other pattern types, and patterns commonly evolved from sources to sinks and vice versa. This analysis illuminates the temporal dynamics of the spatiotemporal activity patterns present in the recording and provides quantitative measurements which can be linked to cognitive tasks or used to constrain models of cortical dynamics. Similar analyses can also facilitate tracking the movement of neural structures of interest across brain regions [<xref ref-type="bibr" rid="pcbi.1006643.ref015">15</xref>], detecting repeated motifs in pattern dynamics [<xref ref-type="bibr" rid="pcbi.1006643.ref013">13</xref>], or examining gradual changes in pattern dynamics corresponding to changes in brain states [<xref ref-type="bibr" rid="pcbi.1006643.ref050">50</xref>].</p>
<fig id="pcbi.1006643.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006643.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Tracking pattern evolution dynamics.</title>
<p><bold>A,</bold> Snapshots of 6 Hz phase and phase velocity fields from marmoset area MT LFPs during dot field stimulus, showing evolution from a plane wave pattern to a sink pattern. Black dot marks stable node location. <bold>B,</bold> Mean percentage difference between number of observed and expected pattern transitions (within 50 ms) for recording shown in <bold>A</bold>. Rows give initial pattern, columns give following pattern. Bold values indicate significant differences between observed and expected counts across all trials (p&lt;0.05, paired t-test with Bonferroni correction). PW, plane wave; SY, synchrony; SI, sink; SO, source; SA, saddle. Node and focus critical points are combined.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006643.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Phase and amplitude patterns</title>
<p>In neural recordings, amplitude and phase data at the same frequency reflect different properties of brain activity, with amplitude representing a combination of the coherence and overall activity of a local ensemble and phase representing the timing of its oscillations. Accordingly, these signals typically contain different spatiotemporal patterns, and both phase and amplitude patterns can be relevant and informative. <xref ref-type="fig" rid="pcbi.1006643.g008">Fig 8</xref> illustrates the spatiotemporal profile of raw LFP data, filtered LFP data, and the amplitude and phase of filtered LFP data, again taken from marmoset visual area MT. The spatiotemporal dynamics in the raw data (<xref ref-type="fig" rid="pcbi.1006643.g008">Fig 8A</xref>) primarily reflect those in the oscillations with greatest power, but also contain a large amount of noise from other frequencies. Filtering the data to a narrow-band signal (<xref ref-type="fig" rid="pcbi.1006643.g008">Fig 8B</xref>) reduces the noise by extracting the patterns present in the chosen frequency band alone, but these wave patterns are typically complicated as they are influenced by two different types of propagating activity: amplitude patterns (<xref ref-type="fig" rid="pcbi.1006643.g008">Fig 8C</xref>), which capture the movement of the overall shape of the wave and travel at the group velocity [<xref ref-type="bibr" rid="pcbi.1006643.ref051">51</xref>], and phase patterns (<xref ref-type="fig" rid="pcbi.1006643.g008">Fig 8D</xref>), which capture the progression of timing differences between electrodes and travel at the phase velocity.</p>
<fig id="pcbi.1006643.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006643.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Oscillatory filtering and velocity vector field calculation in LFPs from marmoset visual area MT during dot field stimulus.</title>
<p><bold>A,</bold> Left: LFP waveforms from two nearby recording sites. Black lines indicate times at which snapshots are shown. Stimulus onset was at 0 s. Centre: Snapshots of LFPs across all recording channels at the indicated times. Right: Velocity vector field estimating the motion between the two snapshots. <bold>B,</bold> Same as <bold>A</bold>, but with waveforms filtered with Morlet wavelets to extract 8 Hz oscillations. <bold>C,</bold> Same as <bold>B</bold>, but only the amplitude of the 8 Hz oscillations. <bold>D,</bold> Same as <bold>B</bold>, but only the phase of the 8 Hz oscillations. All velocity fields have normalized average magnitude.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006643.g008" xlink:type="simple"/>
</fig>
<p>In a general oscillating system, the phase and amplitude are independent properties which have no a priory reason to affect each other. However, there is some evidence that phase and amplitude patterns can be related in some neural systems: Phase patterns in rabbit sensory cortices are more commonly observed around the formation of new amplitude patterns [<xref ref-type="bibr" rid="pcbi.1006643.ref052">52</xref>], and spiral waves in mammalian neocortex exhibit consistently reduced amplitudes at their centers [<xref ref-type="bibr" rid="pcbi.1006643.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref044">44</xref>]. Examining both phase and amplitude separately may therefore uncover similar relationships in other experimental protocols and can reveal a more comprehensive understanding of the underlying dynamics of cortical circuits. For example, two simple patterns can be resolved from the complicated activity in <xref ref-type="fig" rid="pcbi.1006643.g008">Fig 8B</xref>: A gradually expanding activation from a point near the center of the recording array, as revealed by the amplitude velocity field in <xref ref-type="fig" rid="pcbi.1006643.g008">Fig 8C</xref>, and a plane wave propagating across the recording area, as revealed by the phase velocity field in <xref ref-type="fig" rid="pcbi.1006643.g008">Fig 8D</xref>.</p>
</sec>
<sec id="sec010">
<title>Analysis of spatiotemporal modes</title>
<p>Whilst direct identification of wave patterns in velocity fields as described in the previous sections allows for patterns’ individual dynamics to be fully characterized, the procedure does not specify the extent to which these patterns contribute to the overall spatiotemporal dynamics of a recording. To address this, we introduce a complementary method for studying wave activity in neural recordings by using velocity field decomposition, which finds low-dimensional spatiotemporal modes that capture the majority of variance in the system. Dimensionality reduction techniques are commonly used for uncovering underlying neural mechanisms of brain function [<xref ref-type="bibr" rid="pcbi.1006643.ref006">6</xref>]. However, the majority of existing techniques use principal component analysis (PCA) or similar procedures that decompose data into independent spatial and temporal modes, obscuring activity that is not time-space separable such as propagating waves and patterns [<xref ref-type="bibr" rid="pcbi.1006643.ref053">53</xref>]. Some studies have used decomposition techniques to specifically detect waves by examining phase gradients in complex decompositions of data [<xref ref-type="bibr" rid="pcbi.1006643.ref026">26</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref029">29</xref>]. To identify dominant spatiotemporal patterns in our framework, we again obtain inspiration from the field of turbulence, in which dimensionality reduction is often directly applied to velocity fields, capturing low-dimensional spatiotemporal dynamics [<xref ref-type="bibr" rid="pcbi.1006643.ref033">33</xref>].</p>
<p>In turbulence, dimensionality reduction can be performed through a variety of different decomposition methods, including Reynolds decomposition, principal component analysis (or proper orthogonal decomposition), and dynamic mode decomposition [<xref ref-type="bibr" rid="pcbi.1006643.ref054">54</xref>]. These techniques find modes capturing the majority of the energy in the system, which is not well-defined for velocity fields of neural data as it is in fluid flows, but some of these methods nonetheless can be adapted to find low-dimensional representations of the primary spatiotemporal dynamics of a neural recording. We implement a simple singular value decomposition (SVD) to extract the dominant spatiotemporal patterns from a time series of velocity fields in an efficient and parameter-free way.</p>
<p>To reorganize the velocity fields <inline-formula id="pcbi.1006643.e047"><alternatives><graphic id="pcbi.1006643.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mfenced separators="|"><mml:mrow><mml:mi>u</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> into standard form for decomposition with variables in columns and observations in rows, we combine spatial dimensions and rearrange indices to define <inline-formula id="pcbi.1006643.e048"><alternatives><graphic id="pcbi.1006643.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mfenced separators="|"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>, for time <italic>t</italic> and recording site <italic>r</italic>. We then use two alternate approaches to combine <italic>ũ</italic> and <italic>ṽ</italic>. In the first approach, we concatenate the two matrices across recording sites to define the real matrix <inline-formula id="pcbi.1006643.e049"><alternatives><graphic id="pcbi.1006643.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>'</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In the second, we represent the velocity field as a complex number to form the complex matrix <inline-formula id="pcbi.1006643.e050"><alternatives><graphic id="pcbi.1006643.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In either case, the singular vector decomposition (SVD) is defined as
<disp-formula id="pcbi.1006643.e051">
<alternatives>
<graphic id="pcbi.1006643.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e051" xlink:type="simple"/>
<mml:math display="block" id="M51">
<mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>Σ</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
where <inline-formula id="pcbi.1006643.e052"><alternatives><graphic id="pcbi.1006643.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math></alternatives></inline-formula> denotes <bold><inline-formula id="pcbi.1006643.e053"><alternatives><graphic id="pcbi.1006643.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></bold> or <inline-formula id="pcbi.1006643.e054"><alternatives><graphic id="pcbi.1006643.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">o</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, <bold><italic>T</italic></bold> and <bold><italic>R</italic></bold> are unitary matrices, * denotes the conjugate transpose, and <italic>Σ</italic> is a rectangular diagonal matrix of positive numbers <inline-formula id="pcbi.1006643.e055"><alternatives><graphic id="pcbi.1006643.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, called the singular values [<xref ref-type="bibr" rid="pcbi.1006643.ref055">55</xref>]. This operation finds orthogonal linear combinations of recording sites that explain the greatest variance in the velocity fields, and is closely related to PCA: if <inline-formula id="pcbi.1006643.e056"><alternatives><graphic id="pcbi.1006643.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math></alternatives></inline-formula> has been shifted so that each recording site has zero sample mean, then <bold><italic>R</italic></bold> comprises exactly the principal component loadings, and <inline-formula id="pcbi.1006643.e057"><alternatives><graphic id="pcbi.1006643.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are the principal component scores [<xref ref-type="bibr" rid="pcbi.1006643.ref056">56</xref>]. However, normalizing the velocities at each recording site is counterproductive in this application, as biases in propagation direction are an important component of wave dynamics. The <italic>k</italic>-th spatial mode, defined by the velocity field in the <italic>k</italic>-th column of <bold><italic>R</italic></bold>, explains a proportion of the overall variance given by <inline-formula id="pcbi.1006643.e058"><alternatives><graphic id="pcbi.1006643.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and has a time course given by the <italic>k</italic>-th row of <bold><italic>T</italic></bold>.</p>
<p>The vector SVD procedure is closely related to traditional PCA methods, as both techniques reduce the dimensionality of a dataset by extracting patterns that comprise the bulk of the variance and their evolution over time. The differences between these approaches are illustrated in <xref ref-type="fig" rid="pcbi.1006643.g009">Fig 9</xref>, which again shows marmoset LFP data during moving dot-field stimulation. PCA typically decomposes data into orthogonal spatial modes (<xref ref-type="fig" rid="pcbi.1006643.g009">Fig 9A</xref>), which comprise linear combinations of recording sites [<xref ref-type="bibr" rid="pcbi.1006643.ref006">6</xref>]. Vector SVD instead processes the velocity vector fields to extract spatial modes which are vector fields themselves (<xref ref-type="fig" rid="pcbi.1006643.g009">Fig 9B</xref>), and therefore represent distinct propagation patterns in the underlying data. In both cases, each spatial mode has a corresponding time-course (or temporal mode), describing its evolution across the duration of a recording (<xref ref-type="fig" rid="pcbi.1006643.g009">Fig 9C and 9D</xref>).</p>
<fig id="pcbi.1006643.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006643.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Dominant principal component analysis and vector singular value decomposition modes in 10Hz marmoset LFP oscillations during dot-field stimuli.</title>
<p><bold>A,</bold> Top spatial PCA modes of filtered LFPs, with percentage variance explained. <bold>B,</bold> Top spatial SVD modes of phase velocity fields, showing coherent spatiotemporal activity patterns. <bold>C,</bold> Temporal evolution of PCA modes, averaged across all trials. Stimulus onset at 0 s. Non-causal effects are due to time smoothing of signal filtering. <bold>D,</bold> Same as <bold>C</bold>, but for SVD modes.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006643.g009" xlink:type="simple"/>
</fig>
<p>Although the dominant PCA modes explain more variance than their SVD counterparts, their temporal components reveal structured interactions between the dominant spatial modes (<xref ref-type="fig" rid="pcbi.1006643.g009">Fig 9C</xref>), generating spatiotemporal activity patterns which are difficult or impossible to determine directly from the PCA modes. In contrast, SVD spatial modes directly reflect these spatiotemporal patterns, and their evolution over time represents the strength of different pattern types in response to stimulus. In <xref ref-type="fig" rid="pcbi.1006643.g009">Fig 9</xref>, stimulus onset generates large, clear changes in spatiotemporal pattern dynamics revealed by SVD (<xref ref-type="fig" rid="pcbi.1006643.g009">Fig 9D</xref>): Sink pattern activity increases dramatically but transiently (shown by the large deflection in mode 3); plane waves (modes 1 and 2) increase in activity more modestly, but change direction soon after stimulus onset (as indicated by the sign change of mode one at 300 ms) and are sustained for a longer period. These results suggest that stimuli can directly affect the dynamics of propagating wave patterns, but that these changes are obscured when using PCA or other decomposition methods that separate space and time.</p>
<p>We find that in both spontaneous and stimulus-evoked LFP recordings, velocity vector fields in phase and amplitude at all frequencies display consistent dynamics: the most dominant modes typically reflect orthogonal directions of plane wave motion, and the next most dominant modes contain complex patterns including sources, sinks, spirals and saddles (<xref ref-type="fig" rid="pcbi.1006643.g010">Fig 10A</xref>). Despite these similarities, the disparities between spatial modes in different recordings or conditions can reveal major differences in the underlying pattern dynamics, including the primary directions of plane wave motion, the center location of complex patterns, and the relative prevalence of different pattern types. As an example, we compare the dominant SVD modes during stimulus-evoked activity in <xref ref-type="fig" rid="pcbi.1006643.g009">Fig 9B</xref> to those during ongoing activity in the same recording (<xref ref-type="fig" rid="pcbi.1006643.g010">Fig 10A</xref>). The four most dominant modes represent the same activity patterns, but they display slightly different dynamics: The primary propagation direction of plane waves changes (shown by the direction of mode 1); the central locus of source, sink and saddle activity changes location (shown by the critical point in nodes 3 and 4); and ongoing activity overall contains more plane wave and less source, sink and saddle activity (as revealed by the percentage of variance explained).</p>
<fig id="pcbi.1006643.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006643.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Real and complex vector singular value decomposition modes in 10 Hz phase velocity fields.</title>
<p>LFPs were taken from the same recording as in <xref ref-type="fig" rid="pcbi.1006643.g009">Fig 9</xref>, but during ongoing activity. <bold>A,</bold> Top spatial SVD modes in velocity fields, with percentage variance explained. Modes correspond to spatiotemporal patterns, which are scaled but not rotated as they evolve over time. <bold>B,</bold> Top spatial cSVD modes, with percentage variance explained. These modes are both scaled and rotated over time, effectively combining multiple SVD modes as indicated by colors: cSVD mode 1 contains SVD modes 1 and 2; cSVD mode 2 contains SVD modes 3 and 6; and cSVD mode 3 contains SVD modes 4 and 5.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006643.g010" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec011">
<title>Real and complex singular value decomposition</title>
<p>In the SVD method discussed thus far, each class of spatiotemporal pattern may be represented across multiple modes (e.g., modes one and two both reflect plane wave activity), making their overall prevalence more difficult to calculate. To address this issue, we also implement a modified SVD procedure that we call complex singular value decomposition (cSVD), which treats velocity vectors as complex numbers. In this approach, temporal modes have both a real and imaginary component, allowing spatial modes to both scale and rotate over time: The amplitude of the temporal mode gives the relative strength of the pattern, and the argument of the real and imaginary components gives the angle by which all vectors are rotated. This approach effectively combines real SVD modes together (<xref ref-type="fig" rid="pcbi.1006643.g010">Fig 10</xref>): Modes with plane waves travelling in any direction are combined, as are modes containing source, sink and spiral patterns with the same center location, or saddles with the same center location. This allows the overall relative contribution of each type of activity pattern (plane waves, expanding or contracting waves, saddle patterns) to be accurately evaluated, but information about the direction of patterns is removed to the complex time evolution.</p>
</sec>
</sec>
<sec id="sec012" sec-type="conclusions">
<title>Discussion</title>
<p>In this paper, we have introduced a methodological framework and associated MATLAB toolbox for the classification and analysis of propagating wave patterns in neural recordings, and illustrated these methods using simulated data, LFP recordings from marmoset visual area MT and whole-brain optical imaging data from mouse cortex. The toolbox is freely available under an open source agreement from [<ext-link ext-link-type="uri" xlink:href="https://github.com/BrainDynamicsUSYD/NeuroPattToolbox" xlink:type="simple">https://github.com/BrainDynamicsUSYD/NeuroPattToolbox</ext-link>]. As we have demonstrated, our methods provide a framework for uncovering the spatiotemporal organization principles of these patterns and for examining how they are related to brain function.</p>
<p>We have introduced velocity vector fields to characterize how neural oscillatory signals change across space and time. Based on these vector fields a range of mathematical techniques including order parameters, critical point analysis and winding number calculation are uniquely combined to detect a diverse range of wave patterns and to characterize their key spatiotemporal organization properties. Our methods thus build upon the application of optical flow analysis for detecting wave patterns developed in previous studies [<xref ref-type="bibr" rid="pcbi.1006643.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref057">57</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref030">30</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref058">58</xref>]. As we have demonstrated, order parameters can be used to detect the presence of large-scale plane waves or synchronous activity, and critical point analysis can detect complex wave patterns, comprising sources, sinks, spirals-in, spirals-out, and saddles. Calculation of the winding number around critical points can then be used to measure the precise size of wave patterns, which may be useful in future studies to examine the spatial scale of neural features and effects across different frequencies [<xref ref-type="bibr" rid="pcbi.1006643.ref059">59</xref>]. These approaches allow multiple classes of waves to be tracked simultaneously and systematically.</p>
<p>Applying these methods to experimental data, we successfully identified both small-scale wave patterns in LFP recordings from anaesthetized marmoset visual cortex and large-scale patterns in whole-brain optical recordings from awake mice. In both datasets, multiple coexisting patterns were commonly active and all patterns were significantly more prevalent than in noise-driven surrogate data (<xref ref-type="fig" rid="pcbi.1006643.g005">Fig 5</xref>). Furthermore, we showed that visual stimulation can change the direction of plane wave activity and the position of complex waves in marmoset area MT (<xref ref-type="fig" rid="pcbi.1006643.g006">Fig 6</xref>), and that these waves evolve between different types in a structured way beyond what is expected by chance (<xref ref-type="fig" rid="pcbi.1006643.g007">Fig 7</xref>). These results are consistent with previous studies associating visual stimuli and traveling waves [<xref ref-type="bibr" rid="pcbi.1006643.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref019">19</xref>], and showing that neural dynamics evolve following preferred pathways [<xref ref-type="bibr" rid="pcbi.1006643.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref060">60</xref>]. However, unlike previous work, our methodology allows these patterns and their dynamics to be simultaneously detected and quantified, and places them into a framework of explicit pattern behavior to more precisely study underlying neural dynamics.</p>
<p>In our methods, dominant spatiotemporal activity patterns can be extracted from a recording using novel vector field decomposition methods. These present a promising approach to the task of dimensionality reduction in large-scale neural recordings. Current dimensionality reduction methods typically process data into separable temporal and spatial modes which reproduce the dynamics of a recording [<xref ref-type="bibr" rid="pcbi.1006643.ref006">6</xref>]. However, these approaches find population structures that are often dominated by single-cell response properties and correlated activity [<xref ref-type="bibr" rid="pcbi.1006643.ref061">61</xref>], and do not adequately capture activity patterns that are not time-space separable, such as propagating waves [<xref ref-type="bibr" rid="pcbi.1006643.ref053">53</xref>]. In contrast, vector field decomposition specifically targets propagating waves by directly extracting spatiotemporal pattern modes from data. We showed that stimulus onset in marmoset LFP recordings generated complicated responses in spatial PCA modes that are difficult to interpret, but clear effects on the activity of spatiotemporal pattern modes. We also showed that the dominant spatiotemporal modes are consistent across recordings but change in dynamics depending on cognitive function. In the future, this approach could be useful for examining how sensory stimuli and cognitive tasks affect wave dynamics of population-level responses, and for visualization and exploration of the underlying spatiotemporal activity in large neural data sets. Together, the detailed wave pattern tracking approach, and broad, parameter-free velocity decomposition approach provide a comprehensive analysis of spatiotemporal activity patterns in neural recordings.</p>
<p>There are many ways that our methodology can be extended to explore spatiotemporal neural pattern dynamics beyond what has been presented in this paper. For instance, plane waves and synchronous activity are currently detected as global patterns active across the whole recording area, but it would be advantageous (particularly in large-scale recordings) to identify discrete local regions exhibiting these patterns. This would support accurate simultaneous analysis of brain areas displaying different dynamics, be useful for studying the spread of synchrony or plane wave propagations, and provide consistency with the localized nature of complex patterns as defined by the winding number. However, implementing localized order parameters across regions of different sizes would significantly slow the pattern detection procedure and introduce additional free parameters to the framework. Future work may develop more efficient methods to characterize localized regions displaying synchrony or planar propagations, potentially allowing entire cortical sheets to be fully and dynamically segmented into multiple interacting patterns.</p>
<p>Additionally, our methods can be further extended to explore currently unknown mechanisms of wave pattern interactions in the brain. Firstly, localized patterns with complex dynamics that are active simultaneously may directly interact. Such interactions are prevalent in modelling studies including spiking neural networks [<xref ref-type="bibr" rid="pcbi.1006643.ref037">37</xref>] and neural firing rate models [<xref ref-type="bibr" rid="pcbi.1006643.ref062">62</xref>], and they are theorized to be directly involved in distributed dynamic computation [<xref ref-type="bibr" rid="pcbi.1006643.ref025">25</xref>]. In experimental studies, interactions between sharp-wave ripple patterns in rat hippocampus can result in their reflection or annihilation [<xref ref-type="bibr" rid="pcbi.1006643.ref063">63</xref>], but more complex interactions have not been examined. Secondly, patterns may interact across oscillations at different frequencies. Currently, the phase of low-frequency oscillations is known to influence the amplitude of high frequency oscillations in the brain [<xref ref-type="bibr" rid="pcbi.1006643.ref064">64</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref065">65</xref>], but it is not clear how this cross-frequency coupling actually influences or is influenced by the underlying patterns in these systems. Finally, wave pattern dynamics may interact across multiple spatial and temporal scales in more complex ways, creating cascades of pattern dynamics comparable to energy cascades in turbulence studies [<xref ref-type="bibr" rid="pcbi.1006643.ref066">66</xref>]. By effectively detecting and analyzing neural spatiotemporal activity patterns simultaneously across multiple scales, our methods provide a framework for further exploring these key questions in future studies.</p>
</sec>
<sec id="sec013" sec-type="materials|methods">
<title>Methods and materials</title>
<p>In this section we describe how the methodological framework introduced in the Results section is implemented in the NeuroPatt toolbox and outline how user-set parameters affect computations. We also briefly describe the experimental protocols of the data shown in the figures of this manuscript. The NeuroPatt Toolbox was written in MATLAB 2016b, and is freely available from [<ext-link ext-link-type="uri" xlink:href="https://github.com/BrainDynamicsUSYD/NeuroPattToolbox" xlink:type="simple">https://github.com/BrainDynamicsUSYD/NeuroPattToolbox</ext-link>].</p>
<p>NeuroPatt follows the workflow shown in <xref ref-type="fig" rid="pcbi.1006643.g011">Fig 11</xref> and includes data filtering to extract oscillatory activity; optical flow estimation to quantify the direction and speed of propagations by constructing velocity vector fields; turbulence-inspired classification and tracking of simple waves (synchrony, planar travelling waves) and complex patterns (sources, sinks, spiral waves, saddles); and vector field decompositions to find dominant spatiotemporal dynamics.</p>
<fig id="pcbi.1006643.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006643.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Schematic of data flow in the methodological framework and NeuroPatt toolbox.</title>
<p>Neural recordings can either contain oscillatory (e.g. EEG, LFP) or intensity (e.g. VSD) data, and these inputs are processed to find the spatiotemporal patterns present. White boxes indicate data entities; shaded boxes represent analysis methods.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006643.g011" xlink:type="simple"/>
</fig>
<sec id="sec014">
<title>Oscillatory data filtering</title>
<p>NeuroPatt includes two complementary methods to band-pass filter oscillatory neural data to extract amplitude or phase at a chosen frequency prior to detection of spatiotemporal patterns. The first method uses an eighth-order Butterworth filter as implemented in MATLAB’s Signal Processing Toolbox to filter data to a specified frequency range. This filter is applied in both forward and reverse directions to minimize phase distortion. The oscillation amplitude, <italic>A</italic>, and phase, <italic>θ</italic>, are then extracted from the analytic signal, <inline-formula id="pcbi.1006643.e059"><alternatives><graphic id="pcbi.1006643.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006643.e060"><alternatives><graphic id="pcbi.1006643.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the Hilbert transform [<xref ref-type="bibr" rid="pcbi.1006643.ref039">39</xref>] of the filtered data <inline-formula id="pcbi.1006643.e061"><alternatives><graphic id="pcbi.1006643.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. The second method estimates the analytic signal at a specified center frequency using the complex Morlet wavelet transform to filter data and extract phase and amplitude with an optimal trade-off between time and frequency resolution [<xref ref-type="bibr" rid="pcbi.1006643.ref040">40</xref>], as implemented by MATLAB’s Wavelet Toolbox.</p>
<p>These two procedures give comparable outputs [<xref ref-type="bibr" rid="pcbi.1006643.ref067">67</xref>], but each has advantages in different situations: The Hilbert transform allows the properties of the filtering to be precisely specified but can be invalid if the underlying frequency is not sufficiently narrow-band; the wavelet transform is usually faster to compute and always results in a valid analytic signal, but gives a less concretely defined frequency range. Both procedures are included in the toolbox, with the wavelet transform as the default option. Users without access to either the Signal Processing Toolbox or the Wavelet Toolbox can detect spatiotemporal patterns in unfiltered data, which are valid but can be contaminated by noise from multiple frequencies as illustrated in <xref ref-type="fig" rid="pcbi.1006643.g008">Fig 8</xref>, or can calculate the analytic signal through other implementations of the Hilbert or wavelet transform for use in the later steps of the toolbox. Any band-pass filtering procedure necessarily involves some degree of temporal smoothing [<xref ref-type="bibr" rid="pcbi.1006643.ref068">68</xref>], which can inhibit the extraction of precise timing information in later analysis steps. We note that this effect will not change the timing of maxima or minima in time series, as both wavelet and Hilbert filtering techniques do not distort signal phase, but they will smear out activity between these points.</p>
</sec>
<sec id="sec015">
<title>Solving optical flow equations</title>
<p>Velocity vector fields are calculated by solving the Euler-Lagrange equations corresponding to the minimization problem given by <xref ref-type="disp-formula" rid="pcbi.1006643.e016">Eq 4</xref>:
<disp-formula id="pcbi.1006643.e062">
<alternatives>
<graphic id="pcbi.1006643.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e062" xlink:type="simple"/>
<mml:math display="block" id="M62">
<mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>∇</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∇</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1006643.e063">
<alternatives>
<graphic id="pcbi.1006643.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e063" xlink:type="simple"/>
<mml:math display="block" id="M63">
<mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>∇</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∇</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
Where <inline-formula id="pcbi.1006643.e064"><alternatives><graphic id="pcbi.1006643.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msqrt><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Note that for large values of <italic>β</italic>, <inline-formula id="pcbi.1006643.e065"><alternatives><graphic id="pcbi.1006643.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:msup><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> is approximately constant, and the optical flow for the Charbonnier penalty approaches that of the quadratic penalty. For clarity, we let <inline-formula id="pcbi.1006643.e066"><alternatives><graphic id="pcbi.1006643.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>α</mml:mi></mml:mfrac><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006643.e067"><alternatives><graphic id="pcbi.1006643.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and rewrite these equations as
<disp-formula id="pcbi.1006643.e068">
<alternatives>
<graphic id="pcbi.1006643.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e068" xlink:type="simple"/>
<mml:math display="block" id="M68">
<mml:mrow><mml:msub><mml:mo>ρ</mml:mo><mml:mtext>d</mml:mtext></mml:msub><mml:msub><mml:mtext>D</mml:mtext><mml:mtext>x</mml:mtext></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mtext>D</mml:mtext><mml:mtext>x</mml:mtext></mml:msub><mml:mtext>u</mml:mtext><mml:mo>+</mml:mo><mml:msub><mml:mtext>D</mml:mtext><mml:mtext>y</mml:mtext></mml:msub><mml:mtext>v</mml:mtext><mml:mo>+</mml:mo><mml:msub><mml:mtext>D</mml:mtext><mml:mtext>t</mml:mtext></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mo>ρ</mml:mo><mml:mtext>s</mml:mtext></mml:msub><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mtext>u</mml:mtext><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mo>ρ</mml:mo><mml:mtext>s</mml:mtext></mml:msub><mml:mo>⋅</mml:mo><mml:mo>∇</mml:mo><mml:mtext>u</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1006643.e069">
<alternatives>
<graphic id="pcbi.1006643.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e069" xlink:type="simple"/>
<mml:math display="block" id="M69">
<mml:mrow><mml:msub><mml:mo>ρ</mml:mo><mml:mi>d</mml:mi></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mo>∇</mml:mo><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
where <inline-formula id="pcbi.1006643.e070"><alternatives><graphic id="pcbi.1006643.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>≐</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mo>∂</mml:mo><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mo>∂</mml:mo><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> denotes the Laplace operator. These equations can be solved through fixed point iteration for the functions <inline-formula id="pcbi.1006643.e071"><alternatives><graphic id="pcbi.1006643.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006643.e072"><alternatives><graphic id="pcbi.1006643.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> after linearizing all other terms. In the toolbox, we approximate partial first derivatives with a five-point stencil <inline-formula id="pcbi.1006643.e073"><alternatives><graphic id="pcbi.1006643.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1,8</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>8,1</mml:mn></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> where possible (or with centered or forward differences when close to edges), and approximate the Laplacian with a 2D five-point stencil [<xref ref-type="bibr" rid="pcbi.1006643.ref069">69</xref>]. If <italic>D</italic> represents phase data, it will contain temporal and spatial discontinuities where phase wraps from -π to +π, which invalidate linear difference stencils taken near these points. Instead, we approximate partial derivatives with centered or forward differences calculated using circular subtraction, <inline-formula id="pcbi.1006643.e074"><alternatives><graphic id="pcbi.1006643.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:math></alternatives></inline-formula>. All figures in this report use parameters <inline-formula id="pcbi.1006643.e075"><alternatives><graphic id="pcbi.1006643.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006643.e076"><alternatives><graphic id="pcbi.1006643.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math></alternatives></inline-formula> unless otherwise specified.</p>
</sec>
<sec id="sec016">
<title>Toolbox input data format restrictions</title>
<p>To create valid velocity vector fields, NeuroPatt has some restrictions on the format and content of input data sets. Firstly, data must be spatially arranged in a 2D square lattice of recording sites. This restriction exists primarily because of the optical flow estimation methods implemented in the toolbox, which assume spatial uniformity to maximize efficiency and accuracy. Alternate optical flow estimation methods exist for 3D data sets sampled volumetrically [<xref ref-type="bibr" rid="pcbi.1006643.ref070">70</xref>] or from non-uniform surfaces [<xref ref-type="bibr" rid="pcbi.1006643.ref071">71</xref>], but these implementations require significant modifications to the methodology described here and are much more computationally intensive. Secondly, data must be consistent across multiple recording sites: Because velocity vector fields are computed based on local dynamics, any recording sites with erroneous activity can significantly influence the surrounding velocity vectors. As in previous studies using optical flow for brain recordings [<xref ref-type="bibr" rid="pcbi.1006643.ref058">58</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref072">72</xref>], we recommend that highly noisy data are spatially filtered prior to the application of optical flow methods, and that any invalid or discontinuous recording channels are interpolated over. When amplitude spatiotemporal patterns are being examined, data should also be normalized across recording sites by subtracting the baseline or z-scoring to remove factors that could cause any regional bias, such as uneven electrode impedance or dye intensity. These processes are included as optional pre-processing steps in the toolbox.</p>
<p>Finally, the changes between consecutive time steps in recorded signals must also be sufficiently small, as optical flow cannot be estimated if there are large discontinuities between frames. Such discontinuities can occur if signals are changing on a shorter time scale than the sampling frequency, which may be an issue for fast neural signals such as action potentials and high-frequency oscillations, or for recording techniques with low temporal resolution such as fMRI. There is no strict rule to determine if the sampling frequency is sufficiently high, but as a general guideline we suggest that signals at a single recording site should typically change by less than 10% of their maximum range between consecutive time steps. The toolbox will warn if this condition is not satisfied, potentially leading to non-convergent optical flow estimation or invalid velocity vector fields, or if the change in data is significantly below this threshold, indicating that it can be safely down-sampled for computational efficiency.</p>
</sec>
<sec id="sec017">
<title>Tracking spatiotemporal patterns</title>
<p>The toolbox includes multiple parameters for the identification and tracking of spatiotemporal patterns. Firstly, the user can specify a minimum distance from the edge of the recorded area <inline-formula id="pcbi.1006643.e077"><alternatives><graphic id="pcbi.1006643.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (default 2 grid spaces) for critical points to occupy, as velocity fields can be inaccurate and contain spurious critical points close to the boundary (mainly due to the use of forward differences to approximate derivatives at these points). The user can also specify a minimum radius <inline-formula id="pcbi.1006643.e078"><alternatives><graphic id="pcbi.1006643.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (default 2 grid spaces) for critical point patterns to occupy, to exclude small-scale and potentially noise-driven local patterns from analysis.</p>
<p>Once both simple and complex patterns are detected in individual velocity fields, these individual observations are combined across time to identify persistent spatiotemporal patterns. NeuroPatt allows the user to specify a minimum duration <inline-formula id="pcbi.1006643.e079"><alternatives><graphic id="pcbi.1006643.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (default 5 time steps) for all patterns (including global synchrony and plane waves): patterns which persist for less than this amount of time are discarded. To add some error tolerance to the process of linking patterns together over time, a maximum time gap <inline-formula id="pcbi.1006643.e080"><alternatives><graphic id="pcbi.1006643.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (default 1 time step) can be specified between successive instances of a pattern for it to still be counted as one spatiotemporal structure. Finally, complex patterns can move over time, so critical points of the same type in successive time steps are considered part of the same spatiotemporal pattern only if they are separated by less than a maximum displacement <inline-formula id="pcbi.1006643.e081"><alternatives><graphic id="pcbi.1006643.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (default 0.5 grid spaces).</p>
<p>The pattern detection methods and all relevant parameters can therefore be summarized as follows: Synchrony occurs when <inline-formula id="pcbi.1006643.e082"><alternatives><graphic id="pcbi.1006643.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mi>R</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> at least every <inline-formula id="pcbi.1006643.e083"><alternatives><graphic id="pcbi.1006643.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> time steps for a period of at least <inline-formula id="pcbi.1006643.e084"><alternatives><graphic id="pcbi.1006643.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. Plane waves occur when <inline-formula id="pcbi.1006643.e085"><alternatives><graphic id="pcbi.1006643.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:mi>φ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> at least every <inline-formula id="pcbi.1006643.e086"><alternatives><graphic id="pcbi.1006643.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> time steps for a period of at least <inline-formula id="pcbi.1006643.e087"><alternatives><graphic id="pcbi.1006643.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. Nodes, foci and saddles occur when a critical point, at least <inline-formula id="pcbi.1006643.e088"><alternatives><graphic id="pcbi.1006643.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> away from the edge of the grid with a minimum spatial radius of <inline-formula id="pcbi.1006643.e089"><alternatives><graphic id="pcbi.1006643.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, can be linked to another critical point of the same type within <inline-formula id="pcbi.1006643.e090"><alternatives><graphic id="pcbi.1006643.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> time steps and distance <inline-formula id="pcbi.1006643.e091"><alternatives><graphic id="pcbi.1006643.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, and this chain of critical points persists for at least <inline-formula id="pcbi.1006643.e092"><alternatives><graphic id="pcbi.1006643.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> time steps. Nodes and foci with the same stability properties are typically treated as separate patterns. However, they represent the same type of motion (expansion from or contraction to the critical point), so the toolbox can optionally group these critical points together for a more robust characterization of these pattern types.</p>
</sec>
<sec id="sec018">
<title>Pattern detection parameters and result validation</title>
<p>NeuroPatt contains a few key parameters that must be carefully selected by the user to ensure valid and accurate results. As illustrated in <xref ref-type="fig" rid="pcbi.1006643.g002">Fig 2</xref>, the optical flow smoothness parameter <inline-formula id="pcbi.1006643.e093"><alternatives><graphic id="pcbi.1006643.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> controls many properties of the computed velocity vector fields and can over-smooth the data and create spurious plane wave activity if too large or generate flow fields dominated by local noise if too small. To assist with the selection of appropriate values of these parameters, the NeuroPatt toolbox can automatically generate simulated datasets with recording size, sampling frequency and oscillation frequency identical to input data, allowing <inline-formula id="pcbi.1006643.e094"><alternatives><graphic id="pcbi.1006643.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006643.e095"><alternatives><graphic id="pcbi.1006643.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mi>β</mml:mi></mml:math></alternatives></inline-formula> to be optimized based on the user’s data, as shown in <xref ref-type="fig" rid="pcbi.1006643.g003">Fig 3</xref>. Because the pattern dynamics are typically unknown prior to processing they must be guessed for the simulated data, but we find that in most cases the optimal parameter choices do not change significantly with the pattern types or sizes present.</p>
<p>Even within valid velocity fields, the detection of plane waves and synchronized activity is largely dependent upon the thresholds <inline-formula id="pcbi.1006643.e096"><alternatives><graphic id="pcbi.1006643.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006643.e097"><alternatives><graphic id="pcbi.1006643.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, which are typically arbitrary parameters set by the user. This is a persistent problem in the detection of such activity patterns: Previous studies have identified plane waves using template matching [<xref ref-type="bibr" rid="pcbi.1006643.ref024">24</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref030">30</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref073">73</xref>] or though alignment statistics [<xref ref-type="bibr" rid="pcbi.1006643.ref017">17</xref>]; and synchronous activity through correlation or coherence measures [<xref ref-type="bibr" rid="pcbi.1006643.ref074">74</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref075">75</xref>]. All these methods rely on largely arbitrary thresholds to explicitly detect patterns. To assist with the choice of these thresholds in our methodology, we implement an optional visual inspection step in the toolbox, allowing users to view sample periods of plane wave and synchronous activity for various thresholds and display distributions of the underlying velocity field statistics across a recording. If such distributions are multi-modal, they can suggest meaningful boundary points for threshold values.</p>
<p>To help to validate results, the NeuroPatt toolbox implements surrogate data generation to test results obtained from real data against results obtained from noise with the same basic dynamics as the input data. To achieve this, we construct time series comprising white noise for each recording site with the same mean and standard deviation of the corresponding site in the original data. We then repeat all processing steps including pre-processing, filtering, optical flow estimation and pattern detection with multiple random surrogate datasets and compare identified pattern statistics and dynamics with those obtained from the true data. If results are comparable between the real and surrogate datasets, it suggests that they may have been introduced through smoothing or other processing steps rather than being real effects in the data. This surrogate data testing process will therefore flag most false positive detections made by the toolbox. To ensure that all findings are robust to changes in parameters, we recommend that users verify that their results are consistent across a range of values for key parameters in the pattern detection process.</p>
</sec>
<sec id="sec019">
<title>Pattern evolution dynamics</title>
<p>Once simple and complex spatiotemporal patterns have been detected, the evolution dynamics between different pattern types can be quantified. For each pair of pattern types (<inline-formula id="pcbi.1006643.e098"><alternatives><graphic id="pcbi.1006643.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>), the observed number of transitions from <inline-formula id="pcbi.1006643.e099"><alternatives><graphic id="pcbi.1006643.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> to <inline-formula id="pcbi.1006643.e100"><alternatives><graphic id="pcbi.1006643.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>, can be counted in each trial by searching for instances where <inline-formula id="pcbi.1006643.e101"><alternatives><graphic id="pcbi.1006643.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> starts within a short time gap <inline-formula id="pcbi.1006643.e102"><alternatives><graphic id="pcbi.1006643.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> of <inline-formula id="pcbi.1006643.e103"><alternatives><graphic id="pcbi.1006643.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> ending. This can be compared to the expected number of transitions if the patterns in the trial occurred at random times,
<disp-formula id="pcbi.1006643.e104">
<alternatives>
<graphic id="pcbi.1006643.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e104" xlink:type="simple"/>
<mml:math display="block" id="M104">
<mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
where <inline-formula id="pcbi.1006643.e105"><alternatives><graphic id="pcbi.1006643.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006643.e106"><alternatives><graphic id="pcbi.1006643.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> are the observed number of patterns <inline-formula id="pcbi.1006643.e107"><alternatives><graphic id="pcbi.1006643.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006643.e108"><alternatives><graphic id="pcbi.1006643.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> within the trial and <inline-formula id="pcbi.1006643.e109"><alternatives><graphic id="pcbi.1006643.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e109" xlink:type="simple"/><mml:math display="inline" id="M109"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the total length of the trial in seconds. The fractional change between observed and expected transition counts is then defined as <inline-formula id="pcbi.1006643.e110"><alternatives><graphic id="pcbi.1006643.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>. We used paired t-tests with the Bonferroni correction for multiple comparisons to evaluate whether <inline-formula id="pcbi.1006643.e111"><alternatives><graphic id="pcbi.1006643.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006643.e112"><alternatives><graphic id="pcbi.1006643.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> were significantly different for each pattern transition across multiple trials of a recording.</p>
</sec>
<sec id="sec020">
<title>Simulated data</title>
<p>We test the pattern detection procedures in NeuroPatt by generating data sets with known pattern properties. To create a simulated wave pattern <italic>z</italic><sub><italic>sim</italic></sub> with wavenumber <italic>k</italic> and angular frequency <italic>w</italic>, we use the formula
<disp-formula id="pcbi.1006643.e113">
<alternatives>
<graphic id="pcbi.1006643.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e113" xlink:type="simple"/>
<mml:math display="block" id="M113">
<mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula>
where <italic>A</italic>(<italic>x</italic>,<italic>y</italic>,<italic>t</italic>) is a function giving the spatial amplitude profile of the wave, and <italic>s</italic>(<italic>x</italic>,<italic>y</italic>,<italic>t</italic>) is a function giving the spatial phase profile. Using different functions for <italic>s</italic> allows different types of critical point patterns to be generated. All patterns are specified with an initial location (<italic>x</italic><sub><italic>0</italic></sub>,<italic>y</italic><sub><italic>0</italic></sub>), and a constant velocity (<italic>v</italic><sub><italic>x</italic></sub>,<italic>v</italic><sub><italic>y</italic></sub>), given in grid spaces per time step, so the location of a pattern at time <italic>t</italic> is <inline-formula id="pcbi.1006643.e114"><alternatives><graphic id="pcbi.1006643.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. For source or sink patterns, we use
<disp-formula id="pcbi.1006643.e115">
<alternatives>
<graphic id="pcbi.1006643.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e115" xlink:type="simple"/>
<mml:math display="block" id="M115">
<mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
for spiral patterns we use
<disp-formula id="pcbi.1006643.e116">
<alternatives>
<graphic id="pcbi.1006643.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e116" xlink:type="simple"/>
<mml:math display="block" id="M116">
<mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:mtext>atan</mml:mtext><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula>
where atan2 is the multi-valued inverse tangent, and for saddle patterns we use
<disp-formula id="pcbi.1006643.e117">
<alternatives>
<graphic id="pcbi.1006643.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e117" xlink:type="simple"/>
<mml:math display="block" id="M117">
<mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>d</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula></p>
<p>To ensure that all patterns are localized, we define <italic>A</italic>(<italic>x</italic>,<italic>y</italic>,<italic>t</italic>) as a symmetric two-dimensional Gaussian centered on the critical point location:
<disp-formula id="pcbi.1006643.e118">
<alternatives>
<graphic id="pcbi.1006643.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006643.e118" xlink:type="simple"/>
<mml:math display="block" id="M118">
<mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula>
where <italic>A</italic><sub><italic>0</italic></sub> is the maximum amplitude and <italic>c</italic> is the Gaussian width parameter.</p>
<p>To generate complex datasets, we add multiple wave patterns and then add normally distributed white noise with mean 0 and standard deviation proportional to the amplitude of each grid point. For <xref ref-type="fig" rid="pcbi.1006643.g003">Fig 3</xref>, we used a 12×12×10 spatiotemporal grid to generate datasets comprising two random critical point patterns, both with parameters <italic>w</italic> = 2π×0.01 and <italic>k</italic> = 2π/5. Start positions, velocities, maximum amplitudes and Gaussian width parameters were randomized in each dataset: <italic>x</italic><sub><italic>0</italic></sub> and <italic>y</italic><sub><italic>0</italic></sub> were picked uniformly randomly but rejected if patterns were within 2 grid spaces of each other or an edge, <italic>v</italic><sub><italic>x</italic></sub> and <italic>v</italic><sub><italic>y</italic></sub> were picked randomly between −0.1 and +0.1, <italic>A</italic><sub><italic>0</italic></sub> was picked between 1 and 2 and <italic>c</italic> was picked between 3 and 5. Pattern detection in simulated data was performed with default parameters.</p>
</sec>
<sec id="sec021">
<title>Experimental recordings</title>
<p>To demonstrate methods in NeuroPatt, we analyze recordings from the middle temporal area of adult male marmosets (Callithrix jacchus). Details of preparation are given previously [<xref ref-type="bibr" rid="pcbi.1006643.ref049">49</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref076">76</xref>]. Anesthesia and analgesia were maintained by intravenous infusion of sufentanil citrate (6–30 μg kg<sup>−1</sup> h<sup>−1</sup>) and inspired 70:30 mix of N<sub>2</sub>O and carbogen (5% CO<sub>2</sub>, 95% O<sub>2</sub>). Dominance of low frequencies (1–5 Hz) in the EEG recording and absence of EEG or electrocardiogram changes under noxious stimulus (tail pinch) were taken as the chief signs of an adequate level of anesthesia. Drifts towards higher frequencies (5–10 Hz) in the EEG record were counteracted by increasing the rate of venous infusion or the concentration of anesthetic. The typical duration of a recording session was 48–72 h.</p>
<p>Stimuli were presented on a cathode-ray-tube monitor (Sony G500, refreshed at 100 Hz, viewing distance 45 cm, mean luminance 45–55 cd m<sup>−2</sup>), and comprised either a grey screen held at constant luminance for the duration of the recording (5–25 minutes, ongoing activity), or a pattern alternating every two seconds between a grey screen and a field of drifting circular white dots (Weber contrast 1.0; dot diameter 0.4°; drift velocity 20 deg/s) presented in a large, stationary circular window (30°). For dot fields, different motion directions (90° steps) were presented pseudo-randomly, and the procedure was repeated until 100 repetitions were made for each of the four directions. Data were recorded using multielectrode arrays (10×10 electrodes, 1.5 mm length, electrode spacing 400 μm, Blackrock Microsystems). Recording surface insertion depth was targeted to 1 mm.</p>
<p>To demonstrate pattern dynamics at a larger spatial scale and during waking activity, we also examine optical voltage recordings from awake mice, obtained with permission from Thomas Knöpfel. Details of recording have been described previously [<xref ref-type="bibr" rid="pcbi.1006643.ref050">50</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref077">77</xref>,<xref ref-type="bibr" rid="pcbi.1006643.ref078">78</xref>]. Briefly, excitatory neurons in mouse layer 2/3 were targeted with the gene encoding VSFS Butterfly 1.2 [<xref ref-type="bibr" rid="pcbi.1006643.ref079">79</xref>], and mice were implanted with a head post and thinned skull cranial window. Image acquisition was performed with a dual emission wide-field epifluorescence macroscope during anesthesia induced by pentobarbital sodium (40 mg/kg i.p.). The data presented here were taken as anesthesia was wearing off, when mice were responsive to touch and exhibited spontaneous whisker and limb movement between recordings. Image sequences of 60 s duration were acquired at 50 Hz temporal resolution and 320 × 240 pixel spatial resolution, with each pixel corresponding to 33 × 33 μm of a projected cortical area. The voltage imaging signal was calculated as the ratio of mKate2 to mCitrine fluorescence after equalization of heartbeat-related fluorescence modulation. The resulting ratiometric sequences of voltage maps were then spatially down-sampled by a factor of 5 using the MATLAB function <italic>imfilter</italic>, to smooth over noise and reduce the density of calculated velocity fields.</p>
</sec>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Paul R. Martin and Samuel G. Solomon for sharing the marmoset LFP data from [<xref ref-type="bibr" rid="pcbi.1006643.ref049">49</xref>], and Changsong Zhou and Thomas Knöpfel for sharing the mouse imaging data from [<xref ref-type="bibr" rid="pcbi.1006643.ref050">50</xref>].</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006643.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Obien</surname> <given-names>MEJ</given-names></name>, <name name-style="western"><surname>Deligkaris</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Bullmann</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bakkum</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Frey</surname> <given-names>U</given-names></name>. <article-title>Revealing neuronal function through microelectrode array recordings</article-title>. <source>Front Neurosci</source>. <year>2015</year>;<volume>8</volume>: <fpage>423</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fnins.2014.00423" xlink:type="simple">10.3389/fnins.2014.00423</ext-link></comment> <object-id pub-id-type="pmid">25610364</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peron</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>T-W</given-names></name>, <name name-style="western"><surname>Svoboda</surname> <given-names>K</given-names></name>. <article-title>Comprehensive imaging of cortical networks</article-title>. <source>Curr Opin Neurol</source>. <year>2015</year>;<volume>32</volume>: <fpage>115</fpage>–<lpage>123</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2015.03.016" xlink:type="simple">10.1016/j.conb.2015.03.016</ext-link></comment> <object-id pub-id-type="pmid">25880117</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nguyen</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Shipley</surname> <given-names>FB</given-names></name>, <name name-style="western"><surname>Linder</surname> <given-names>AN</given-names></name>, <name name-style="western"><surname>Plummer</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Setru</surname> <given-names>SU</given-names></name>, <etal>et al</etal>. <article-title>Whole-brain calcium imaging with cellular resolution in freely behaving Caenorhabditis elegans</article-title>. <source>PNAS</source>. <year>2016</year>;<volume>113</volume>: <fpage>E1074</fpage>–<lpage>E1081</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1507110112" xlink:type="simple">10.1073/pnas.1507110112</ext-link></comment> <object-id pub-id-type="pmid">26712014</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cong</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Chai</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Shang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Rapid whole brain imaging of neural activity in freely behaving larval zebrafish (Danio rerio)</article-title>. <source>Elife</source>. <year>2017</year>;<volume>6</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.28158" xlink:type="simple">10.7554/eLife.28158</ext-link></comment> <object-id pub-id-type="pmid">28930070</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>. <article-title>Large-scale recording of neuronal ensembles</article-title>. <source>Nat Neurosci</source>. <year>2004</year>;<volume>7</volume>: <fpage>446</fpage>–<lpage>451</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1233" xlink:type="simple">10.1038/nn1233</ext-link></comment> <object-id pub-id-type="pmid">15114356</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cunningham</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>BM</given-names></name>. <article-title>Dimensionality reduction for large-scale neural recordings</article-title>. <source>Nat Neurosci</source>. <year>2014</year>;<volume>17</volume>: <fpage>1500</fpage>–<lpage>1509</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3776" xlink:type="simple">10.1038/nn.3776</ext-link></comment> <object-id pub-id-type="pmid">25151264</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Gray</surname> <given-names>CM</given-names></name>. <article-title>Visual feature integration and the temporal correlation hypothesis</article-title>. <source>Annu Rev Neurosci</source>. <year>1995</year>;<volume>18</volume>: <fpage>555</fpage>–<lpage>586</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev.ne.18.030195.003011" xlink:type="simple">10.1146/annurev.ne.18.030195.003011</ext-link></comment> <object-id pub-id-type="pmid">7605074</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>. <article-title>Neural correlations, population coding and computation</article-title>. <source>Nat Rev Neurosci</source>. <year>2006</year>;<volume>7</volume>: <fpage>358</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn1888" xlink:type="simple">10.1038/nrn1888</ext-link></comment> <object-id pub-id-type="pmid">16760916</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname> <given-names>J-Y</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>C</given-names></name>. <article-title>Propagating waves of activity in the neocortex: What they are, what they do</article-title>. <source>Neuroscientist</source>. <year>2008</year>;<volume>14</volume>: <fpage>487</fpage>–<lpage>502</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1177/1073858408317066" xlink:type="simple">10.1177/1073858408317066</ext-link></comment> <object-id pub-id-type="pmid">18997124</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sato</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Nauhaus</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Carandini</surname> <given-names>M</given-names></name>. <article-title>Traveling waves in visual cortex</article-title>. <source>Neuron</source>. <year>2012</year>;<volume>75</volume>: <fpage>218</fpage>–<lpage>229</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2012.06.029" xlink:type="simple">10.1016/j.neuron.2012.06.029</ext-link></comment> <object-id pub-id-type="pmid">22841308</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Muller</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Chavane</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Reynolds</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <article-title>Cortical travelling waves: mechanisms and computational principles</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2018</year>;<volume>19</volume>: <fpage>255</fpage>–<lpage>268</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn.2018.20" xlink:type="simple">10.1038/nrn.2018.20</ext-link></comment> <object-id pub-id-type="pmid">29563572</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Liang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Takagaki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>J-Y</given-names></name>. <article-title>Spiral wave dynamics in neocortex</article-title>. <source>Neuron</source>. <year>2010</year>;<volume>68</volume>: <fpage>978</fpage>–<lpage>990</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2010.11.007" xlink:type="simple">10.1016/j.neuron.2010.11.007</ext-link></comment> <object-id pub-id-type="pmid">21145009</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Townsend</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Solomon</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Pietersen</surname> <given-names>ANJ</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Solomon</surname> <given-names>SG</given-names></name>, <etal>et al</etal>. <article-title>Emergence of complex wave patterns in primate cerebral cortex</article-title>. <source>J Neurosci</source>. <year>2015</year>;<volume>35</volume>: <fpage>4657</fpage>–<lpage>4662</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.4509-14.2015" xlink:type="simple">10.1523/JNEUROSCI.4509-14.2015</ext-link></comment> <object-id pub-id-type="pmid">25788682</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Muller</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Piantoni</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Koller</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Cash</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Halgren</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <article-title>Rotating waves during human sleep spindles organize global patterns of activity that repeat precisely through the night</article-title>. <source>eLife</source>. <year>2016</year>;<volume>5</volume>: <fpage>e17267</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.17267" xlink:type="simple">10.7554/eLife.17267</ext-link></comment> <object-id pub-id-type="pmid">27855061</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mohajerani</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Mohsenvand</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>LeDue</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>McVea</surname> <given-names>DA</given-names></name>, <etal>et al</etal>. <article-title>Spontaneous cortical activity alternates between motifs defined by regional axonal projections</article-title>. <source>Nat Neurosci</source>. <year>2013</year>;<volume>16</volume>: <fpage>1426</fpage>–<lpage>1435</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3499" xlink:type="simple">10.1038/nn.3499</ext-link></comment> <object-id pub-id-type="pmid">23974708</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Freeman</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Barrie</surname> <given-names>JM</given-names></name>. <article-title>Analysis of spatial patterns of phase in neocortical gamma EEGs in rabbit</article-title>. <source>J Neurophysiol</source>. <year>2000</year>;<volume>84</volume>: <fpage>1266</fpage>–<lpage>1278</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.2000.84.3.1266" xlink:type="simple">10.1152/jn.2000.84.3.1266</ext-link></comment> <object-id pub-id-type="pmid">10980001</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rubino</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Robbins</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Hatsopoulos</surname> <given-names>NG</given-names></name>. <article-title>Propagating waves mediate information transfer in the motor cortex</article-title>. <source>Nat Neurosci</source>. <year>2006</year>;<volume>9</volume>: <fpage>1549</fpage>–<lpage>1557</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1802" xlink:type="simple">10.1038/nn1802</ext-link></comment> <object-id pub-id-type="pmid">17115042</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zanos</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Mineault</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Nasiotis</surname> <given-names>KT</given-names></name>, <name name-style="western"><surname>Guitton</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pack</surname> <given-names>CC</given-names></name>. <article-title>A sensorimotor role for traveling waves in primate visual cortex</article-title>. <source>Neuron</source>. <year>2015</year>;<volume>85</volume>: <fpage>615</fpage>–<lpage>627</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2014.12.043" xlink:type="simple">10.1016/j.neuron.2014.12.043</ext-link></comment> <object-id pub-id-type="pmid">25600124</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Muller</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Reynaud</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Chavane</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Destexhe</surname> <given-names>A</given-names></name>. <article-title>The stimulus-evoked population response in visual cortex of awake monkey is a propagating wave</article-title>. <source>Nat Commun</source>. <year>2014</year>;<volume>5</volume>: <fpage>3675</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms4675" xlink:type="simple">10.1038/ncomms4675</ext-link></comment> <object-id pub-id-type="pmid">24770473</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goldman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Santelmann</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>Vivian</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>Goldman</surname> <given-names>D</given-names></name>. <article-title>Traveling waves in the brain</article-title>. <source>Science</source>. <year>1949</year>;<volume>109</volume>: <fpage>524</fpage>–<lpage>524</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.109.2838.524" xlink:type="simple">10.1126/science.109.2838.524</ext-link></comment> <object-id pub-id-type="pmid">17830010</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ribary</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Ioannides</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Hasson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bolton</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Lado</surname> <given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Magnetic field tomography of coherent thalamocortical 40-Hz oscillations in humans</article-title>. <source>PNAS</source>. <year>1991</year>;<volume>88</volume>: <fpage>11037</fpage>–<lpage>11041</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.88.24.11037" xlink:type="simple">10.1073/pnas.88.24.11037</ext-link></comment> <object-id pub-id-type="pmid">1763020</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>S-H</given-names></name>, <name name-style="western"><surname>Blake</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Heeger</surname> <given-names>DJ</given-names></name>. <article-title>Travelling waves of activity in primary visual cortex during binocular rivalry</article-title>. <source>Nat Neurosci</source>. <year>2005</year>;<volume>8</volume>: <fpage>22</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1365" xlink:type="simple">10.1038/nn1365</ext-link></comment> <object-id pub-id-type="pmid">15580269</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Patten</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Gong</surname> <given-names>P</given-names></name>. <article-title>Human cortical traveling waves: Dynamical properties and correlations with responses</article-title>. <source>PLOS ONE</source>. <year>2012</year>;<volume>7</volume>: <fpage>e38392</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0038392" xlink:type="simple">10.1371/journal.pone.0038392</ext-link></comment> <object-id pub-id-type="pmid">22675555</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alexander</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Jurica</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Trengove</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Nikolaev</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Gepshtein</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zvyagintsev</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Traveling waves and trial averaging: The nature of single-trial and averaged brain responses in large-scale cortical signals</article-title>. <source>NeuroImage</source>. <year>2013</year>;<volume>73</volume>: <fpage>95</fpage>–<lpage>112</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2013.01.016" xlink:type="simple">10.1016/j.neuroimage.2013.01.016</ext-link></comment> <object-id pub-id-type="pmid">23353031</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gong</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>van Leeuwen</surname> <given-names>C</given-names></name>. <article-title>Distributed dynamical computation in neural circuits with propagating coherent activity patterns</article-title>. <source>PLoS Comput Biol</source>. <year>2009</year>;<volume>5</volume>: <fpage>e1000611</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000611" xlink:type="simple">10.1371/journal.pcbi.1000611</ext-link></comment> <object-id pub-id-type="pmid">20019807</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Prechtl</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>LB</given-names></name>, <name name-style="western"><surname>Pesaran</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Mitra</surname> <given-names>PP</given-names></name>, <name name-style="western"><surname>Kleinfeld</surname> <given-names>D</given-names></name>. <article-title>Visual stimuli induce waves of electrical activity in turtle cortex</article-title>. <source>PNAS</source>. <year>1997</year>;<volume>94</volume>: <fpage>7621</fpage>–<lpage>7626</lpage>. <object-id pub-id-type="pmid">9207142</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Takagaki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>J</given-names></name>. <article-title>Compression and reflection of visually evoked cortical waves</article-title>. <source>Neuron</source>. <year>2007</year>;<volume>55</volume>: <fpage>119</fpage>–<lpage>129</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2007.06.016" xlink:type="simple">10.1016/j.neuron.2007.06.016</ext-link></comment> <object-id pub-id-type="pmid">17610821</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Townsend</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Solomon</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Solomon</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Gong</surname> <given-names>P</given-names></name>. <article-title>Visual Motion Discrimination by Propagating Patterns in Primate Cerebral Cortex</article-title>. <source>J Neurosci</source>. <year>2017</year>;<volume>37</volume>: <fpage>10074</fpage>–<lpage>10084</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1538-17.2017" xlink:type="simple">10.1523/JNEUROSCI.1538-17.2017</ext-link></comment> <object-id pub-id-type="pmid">28912155</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mitra</surname> <given-names>PP</given-names></name>, <name name-style="western"><surname>Pesaran</surname> <given-names>B</given-names></name>. <article-title>Analysis of dynamic brain imaging data</article-title>. <source>Biophys J</source>. <year>1999</year>;<volume>76</volume>: <fpage>691</fpage>–<lpage>708</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0006-3495(99)77236-X" xlink:type="simple">10.1016/S0006-3495(99)77236-X</ext-link></comment> <object-id pub-id-type="pmid">9929474</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Takagaki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>J-Y</given-names></name>, <name name-style="western"><surname>Ohl</surname> <given-names>FW</given-names></name>. <article-title>Flow detection of propagating waves with temporospatial correlation of activity</article-title>. <source>J Neurosci Methods</source>. <year>2011</year>;<volume>200</volume>: <fpage>207</fpage>–<lpage>218</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jneumeth.2011.05.023" xlink:type="simple">10.1016/j.jneumeth.2011.05.023</ext-link></comment> <object-id pub-id-type="pmid">21664934</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hussain</surname> <given-names>AKMF</given-names></name>. <article-title>Coherent structures and turbulence</article-title>. <source>J Fluid Mech</source>. <year>1986</year>;<volume>173</volume>: <fpage>303</fpage>–<lpage>356</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S0022112086001192" xlink:type="simple">10.1017/S0022112086001192</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sreenivasan</surname> <given-names>KR</given-names></name>. <article-title>Fluid turbulence</article-title>. <source>Rev Mod Phys</source>. <year>1999</year>;<volume>71</volume>: <fpage>S383</fpage>–<lpage>S395</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/RevModPhys.71.S383" xlink:type="simple">10.1103/RevModPhys.71.S383</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adrian</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Christensen</surname> <given-names>KT</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Z-C</given-names></name>. <article-title>Analysis and interpretation of instantaneous turbulent velocity fields</article-title>. <source>Exp Fluids</source>. <year>2000</year>;<volume>29</volume>: <fpage>275</fpage>–<lpage>290</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s003489900087" xlink:type="simple">10.1007/s003489900087</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Horn</surname> <given-names>BKP</given-names></name>, <name name-style="western"><surname>Schunck</surname> <given-names>BG</given-names></name>. <article-title>Determining optical flow</article-title>. <source>Artif Intell</source>. <year>1981</year>;<volume>17</volume>: <fpage>185</fpage>–<lpage>203</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0004-3702(81)90024-2" xlink:type="simple">10.1016/0004-3702(81)90024-2</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Perry</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Chong</surname> <given-names>MS</given-names></name>. <article-title>A description of eddying motions and flow patterns using critical-point concepts</article-title>. <source>Annu Rev Fluid Mech</source>. <year>1987</year>;<volume>19</volume>: <fpage>125</fpage>–<lpage>155</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev.fl.19.010187.001013" xlink:type="simple">10.1146/annurev.fl.19.010187.001013</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vicsek</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Zafeiris</surname> <given-names>A</given-names></name>. <article-title>Collective motion</article-title>. <source>Phys Rep</source>. <year>2012</year>;<volume>517</volume>: <fpage>71</fpage>–<lpage>140</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.physrep.2012.03.004" xlink:type="simple">10.1016/j.physrep.2012.03.004</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Keane</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gong</surname> <given-names>P</given-names></name>. <article-title>Propagating waves can explain irregular neural dynamics</article-title>. <source>J Neurosci</source>. <year>2015</year>;<volume>35</volume>: <fpage>1591</fpage>–<lpage>1605</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1669-14.2015" xlink:type="simple">10.1523/JNEUROSCI.1669-14.2015</ext-link></comment> <object-id pub-id-type="pmid">25632135</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref038"><label>38</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Adrian</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Westerweel</surname> <given-names>J</given-names></name>. <source>Particle Image Velocimetry</source>. <publisher-loc>Cambridge; New York</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>2011</year>.</mixed-citation></ref>
<ref id="pcbi.1006643.ref039"><label>39</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Hahn</surname> <given-names>SL</given-names></name>. <source>Hilbert transforms in signal processing</source>. <publisher-loc>Boston</publisher-loc>: <publisher-name>Artech House</publisher-name>; <year>1996</year>.</mixed-citation></ref>
<ref id="pcbi.1006643.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Torrence</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Compo</surname> <given-names>GP</given-names></name>. <article-title>A practical guide to wavelet analysis</article-title>. <source>Bull Amer Meteor Soc</source>. <year>1998</year>;<volume>79</volume>: <fpage>61</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1175/1520-0477(1998)079&lt;0061:APGTWA&gt;2.0.CO;2" xlink:type="simple">10.1175/1520-0477(1998)079&lt;0061:APGTWA&gt;2.0.CO;2</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref041"><label>41</label><mixed-citation publication-type="other" xlink:type="simple">Sun D, Roth S, Black MJ. Secrets of optical flow estimation and their principles. Proceedings of the 2010 IEEE Conference on Computer Vision and Pattern Recognition. 2010. pp. 2432–2439. doi:10.1109/CVPR.2010.5539939</mixed-citation></ref>
<ref id="pcbi.1006643.ref042"><label>42</label><mixed-citation publication-type="other" xlink:type="simple">Charbonnier P, Blanc-Feraud L, Aubert G, Barlaud M. Two deterministic half-quadratic regularization algorithms for computed imaging. Proceedings of 1st International Conference on Image Processing. 1994. pp. 168–172. doi:10.1109/ICIP.1994.413553</mixed-citation></ref>
<ref id="pcbi.1006643.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Effenberger</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Weiskopf</surname> <given-names>D</given-names></name>. <article-title>Finding and classifying critical points of 2D vector fields: a cell-oriented approach using group theory</article-title>. <source>Comput Visual Sci</source>. <year>2010</year>;<volume>13</volume>: <fpage>377</fpage>–<lpage>396</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00791-011-0152-x" xlink:type="simple">10.1007/s00791-011-0152-x</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Troy</surname> <given-names>WC</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Laing</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Schiff</surname> <given-names>SJ</given-names></name>, <etal>et al</etal>. <article-title>Spiral waves in disinhibited mammalian neocortex</article-title>. <source>J Neurosci</source>. <year>2004</year>;<volume>24</volume>: <fpage>9897</fpage>–<lpage>9902</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2705-04.2004" xlink:type="simple">10.1523/JNEUROSCI.2705-04.2004</ext-link></comment> <object-id pub-id-type="pmid">15525774</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref045"><label>45</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Batschelet</surname> <given-names>E</given-names></name>. <source>Circular statistics in biology</source>. <publisher-loc>London; New York</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>1981</year>.</mixed-citation></ref>
<ref id="pcbi.1006643.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>. <article-title>CircStat: a MATLAB toolbox for circular statistics</article-title>. <source>J Stat Softw</source>. <year>2009</year>;<volume>31</volume>: <fpage>1</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v031.i10" xlink:type="simple">10.18637/jss.v031.i10</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Strogatz</surname> <given-names>SH</given-names></name>. <article-title>From Kuramoto to Crawford: exploring the onset of synchronization in populations of coupled oscillators</article-title>. <source>Physica D</source>. <year>2000</year>;<volume>143</volume>: <fpage>1</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0167-2789(00)00094-4" xlink:type="simple">10.1016/S0167-2789(00)00094-4</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bruhn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weickert</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schnörr</surname> <given-names>C</given-names></name>. <article-title>Lucas/Kanade meets Horn/Schunck: Combining local and global optic flow methods</article-title>. <source>Int J Comput Vis</source>. <year>2005</year>;<volume>61</volume>: <fpage>211</fpage>–<lpage>231</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006643.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McDonald</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Clifford</surname> <given-names>CWG</given-names></name>, <name name-style="western"><surname>Solomon</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Solomon</surname> <given-names>SG</given-names></name>. <article-title>Integration and segregation of multiple motion signals by neurons in area MT of primate</article-title>. <source>J Neurophysiol</source>. <year>2014</year>;<volume>111</volume>: <fpage>369</fpage>–<lpage>378</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00254.2013" xlink:type="simple">10.1152/jn.00254.2013</ext-link></comment> <object-id pub-id-type="pmid">24155007</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shimaoka</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Knöpfel</surname> <given-names>T</given-names></name>. <article-title>State-dependent modulation of slow wave motifs towards awakening</article-title>. <source>Front Cell Neurosci</source>. <year>2017</year>;<volume>11</volume>: <fpage>108</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncel.2017.00108" xlink:type="simple">10.3389/fncel.2017.00108</ext-link></comment> <object-id pub-id-type="pmid">28484371</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref051"><label>51</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Brillouin</surname> <given-names>L</given-names></name>. <source>Wave Propagation and Group Velocity</source>. <publisher-loc>New York; London</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1006643.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Freeman</surname> <given-names>WJ</given-names></name>. <article-title>Origin, structure, and role of background EEG activity. Part 2. Analytic phase</article-title>. <source>Clin Neurophysiol</source>. <year>2004</year>;<volume>115</volume>: <fpage>2089</fpage>–<lpage>2107</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.clinph.2004.02.028" xlink:type="simple">10.1016/j.clinph.2004.02.028</ext-link></comment> <object-id pub-id-type="pmid">15294211</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alexander</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Trengove</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>van Leeuwen</surname> <given-names>C</given-names></name>. <article-title>Donders is dead: cortical traveling waves and the limits of mental chronometry in cognitive neuroscience</article-title>. <source>Cogn Process</source>. <year>2015</year>;<volume>16</volume>: <fpage>365</fpage>–<lpage>375</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10339-015-0662-4" xlink:type="simple">10.1007/s10339-015-0662-4</ext-link></comment> <object-id pub-id-type="pmid">26139038</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref054"><label>54</label><mixed-citation publication-type="other" xlink:type="simple">Taira K, Brunton SL, Dawson STM, Rowley CW, Colonius T, McKeon BJ, et al. Modal analysis of fluid flows: An overview. arXiv:170201453 [physics]. 2017; Available: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1702.01453" xlink:type="simple">http://arxiv.org/abs/1702.01453</ext-link></mixed-citation></ref>
<ref id="pcbi.1006643.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klema</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Laub</surname> <given-names>A</given-names></name>. <article-title>The singular value decomposition: Its computation and some applications</article-title>. <source>IEEE Trans Autom Control</source>. <year>1980</year>;<volume>25</volume>: <fpage>164</fpage>–<lpage>176</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TAC.1980.1102314" xlink:type="simple">10.1109/TAC.1980.1102314</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref056"><label>56</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Skillicorn</surname> <given-names>D</given-names></name>. <source>Understanding Complex Datasets: Data Mining with Matrix Decompositions</source>. <edition>1st ed</edition>. <publisher-loc>Boca Raton</publisher-loc>: <publisher-name>Chapman and Hall/CRC</publisher-name>; <year>2007</year>.</mixed-citation></ref>
<ref id="pcbi.1006643.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Inouye</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Shinosaki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Iyama</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Matsumoto</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Toi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ishihara</surname> <given-names>T</given-names></name>. <article-title>Potential flow of frontal midline theta activity during a mental task in the human electroencephalogram</article-title>. <source>Neuroscience Letters</source>. <year>1994</year>;<volume>169</volume>: <fpage>145</fpage>–<lpage>148</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0304-3940(94)90377-8" xlink:type="simple">10.1016/0304-3940(94)90377-8</ext-link></comment> <object-id pub-id-type="pmid">8047272</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Afrashteh</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Inayat</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mohsenvand</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mohajerani</surname> <given-names>MH</given-names></name>. <article-title>Optical-flow analysis toolbox for characterization of spatiotemporal dynamics in mesoscale optical imaging of brain activity</article-title>. <source>NeuroImage</source>. <year>2017</year>;<volume>153</volume>: <fpage>58</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2017.03.034" xlink:type="simple">10.1016/j.neuroimage.2017.03.034</ext-link></comment> <object-id pub-id-type="pmid">28351691</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kopell</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ermentrout</surname> <given-names>GB</given-names></name>, <name name-style="western"><surname>Whittington</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Traub</surname> <given-names>RD</given-names></name>. <article-title>Gamma rhythms and beta rhythms have different synchronization properties</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2000</year>;<volume>97</volume>: <fpage>1867</fpage>–<lpage>1872</lpage>. <object-id pub-id-type="pmid">10677548</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Milo</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Shen-Orr</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Itzkovitz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kashtan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Chklovskii</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Alon</surname> <given-names>U</given-names></name>. <article-title>Network motifs: Simple building blocks of complex networks</article-title>. <source>Science</source>. <year>2002</year>;<volume>298</volume>: <fpage>824</fpage>–<lpage>827</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.298.5594.824" xlink:type="simple">10.1126/science.298.5594.824</ext-link></comment> <object-id pub-id-type="pmid">12399590</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref061"><label>61</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Elsayed</surname> <given-names>GF</given-names></name>, <name name-style="western"><surname>Cunningham</surname> <given-names>JP</given-names></name>. <article-title>Structure in neural population recordings: an expected byproduct of simpler phenomena?</article-title> <source>Nat Neurosci</source>. <year>2017</year>;<volume>20</volume>: <fpage>1310</fpage>–<lpage>1318</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4617" xlink:type="simple">10.1038/nn.4617</ext-link></comment> <object-id pub-id-type="pmid">28783140</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref062"><label>62</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Gong</surname> <given-names>P</given-names></name>. <article-title>Dynamic patterns in a two-dimensional neural field with refractoriness</article-title>. <source>Phys Rev E</source>. <year>2015</year>;<volume>92</volume>: <fpage>022702</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.92.022702" xlink:type="simple">10.1103/PhysRevE.92.022702</ext-link></comment> <object-id pub-id-type="pmid">26382427</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Patel</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schomburg</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Berényi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fujisawa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>. <article-title>Local generation and propagation of ripples along the septotemporal axis of the hippocampus</article-title>. <source>J Neurosci</source>. <year>2013</year>;<volume>33</volume>: <fpage>17029</fpage>–<lpage>17041</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2036-13.2013" xlink:type="simple">10.1523/JNEUROSCI.2036-13.2013</ext-link></comment> <object-id pub-id-type="pmid">24155307</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref064"><label>64</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Canolty</surname> <given-names>RT</given-names></name>, <name name-style="western"><surname>Edwards</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dalal</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Soltani</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nagarajan</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Kirsch</surname> <given-names>HE</given-names></name>, <etal>et al</etal>. <article-title>High gamma power is phase-locked to theta oscillations in human neocortex</article-title>. <source>Science</source>. <year>2006</year>;<volume>313</volume>: <fpage>1626</fpage>–<lpage>1628</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1128115" xlink:type="simple">10.1126/science.1128115</ext-link></comment> <object-id pub-id-type="pmid">16973878</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref065"><label>65</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tort</surname> <given-names>ABL</given-names></name>, <name name-style="western"><surname>Komorowski</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Eichenbaum</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kopell</surname> <given-names>N</given-names></name>. <article-title>Measuring Phase-Amplitude Coupling Between Neuronal Oscillations of Different Frequencies</article-title>. <source>J Neurophysiol</source>. <year>2010</year>;<volume>104</volume>: <fpage>1195</fpage>–<lpage>1210</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00106.2010" xlink:type="simple">10.1152/jn.00106.2010</ext-link></comment> <object-id pub-id-type="pmid">20463205</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref066"><label>66</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Leonard</surname> <given-names>A</given-names></name>. <chapter-title>Energy Cascade in Large-Eddy Simulations of Turbulent Fluid Flows</chapter-title>. In: <name name-style="western"><surname>Frenkiel</surname> <given-names>FN</given-names></name>, <name name-style="western"><surname>Munn</surname> <given-names>RE</given-names></name>, editors. <source>Advances in Geophysics</source>. <publisher-name>Elsevier</publisher-name>; <year>1975</year>. pp. <fpage>237</fpage>–<lpage>248</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0065-2687(08)60464-1" xlink:type="simple">10.1016/S0065-2687(08)60464-1</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref067"><label>67</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Le Van Quyen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Foucher</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lachaux</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rodriguez</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lutz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Martinerie</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Comparison of Hilbert transform and wavelet methods for the analysis of neuronal synchrony</article-title>. <source>J Neurosci Methods</source>. <year>2001</year>;<volume>111</volume>: <fpage>83</fpage>–<lpage>98</lpage>. <object-id pub-id-type="pmid">11595276</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref068"><label>68</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Widmann</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schröger</surname> <given-names>E</given-names></name>. <article-title>Filter effects and filter artifacts in the analysis of electrophysiological data</article-title>. <source>Front Psychol</source>. <year>2012</year>;<volume>3</volume>: <fpage>233</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fpsyg.2012.00233" xlink:type="simple">10.3389/fpsyg.2012.00233</ext-link></comment> <object-id pub-id-type="pmid">22787453</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref069"><label>69</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Thomas</surname> <given-names>JW</given-names></name>. <source>Numerical Partial Differential Equations: Finite Difference Methods</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>1995</year>.</mixed-citation></ref>
<ref id="pcbi.1006643.ref070"><label>70</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kalmoun</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Köstler</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Rüde</surname> <given-names>U</given-names></name>. <article-title>3D optical flow computation using a parallel variational multigrid scheme with application to cardiac C-arm CT motion</article-title>. <source>Image Vis Comput</source>. <year>2007</year>;<volume>25</volume>: <fpage>1482</fpage>–<lpage>1494</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.imavis.2006.12.017" xlink:type="simple">10.1016/j.imavis.2006.12.017</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref071"><label>71</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kirisits</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lang</surname> <given-names>LF</given-names></name>, <name name-style="western"><surname>Scherzer</surname> <given-names>O</given-names></name>. <article-title>Optical flow on evolving surfaces with space and time regularisation</article-title>. <source>J Math Imaging Vis</source>. <year>2015</year>;<volume>52</volume>: <fpage>55</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10851-014-0513-4" xlink:type="simple">10.1007/s10851-014-0513-4</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref072"><label>72</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sun</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Roth</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Black</surname> <given-names>MJ</given-names></name>. <article-title>A quantitative analysis of current practices in optical flow estimation and the principles behind them</article-title>. <source>Int J Comput Vis</source>. <year>2014</year>;<volume>106</volume>: <fpage>115</fpage>–<lpage>137</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11263-013-0644-x" xlink:type="simple">10.1007/s11263-013-0644-x</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006643.ref073"><label>73</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gabriel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Eckhorn</surname> <given-names>R</given-names></name>. <article-title>A multi-channel correlation method detects traveling gamma-waves in monkey visual cortex</article-title>. <source>J Neurosci Methods</source>. <year>2003</year>;<volume>131</volume>: <fpage>171</fpage>–<lpage>184</lpage>. <object-id pub-id-type="pmid">14659837</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref074"><label>74</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thiele</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stoner</surname> <given-names>G</given-names></name>. <article-title>Neuronal synchrony does not correlate with motion coherence in cortical area MT</article-title>. <source>Nature</source>. <year>2003</year>;<volume>421</volume>: <fpage>366</fpage>–<lpage>370</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature01285" xlink:type="simple">10.1038/nature01285</ext-link></comment> <object-id pub-id-type="pmid">12540900</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref075"><label>75</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Palanca</surname> <given-names>BJA</given-names></name>, <name name-style="western"><surname>DeAngelis</surname> <given-names>GC</given-names></name>. <article-title>Does neuronal synchrony underlie visual feature grouping?</article-title> <source>Neuron</source>. <year>2005</year>;<volume>46</volume>: <fpage>333</fpage>–<lpage>346</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2005.03.002" xlink:type="simple">10.1016/j.neuron.2005.03.002</ext-link></comment> <object-id pub-id-type="pmid">15848810</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref076"><label>76</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Solomon</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Morley</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Solomon</surname> <given-names>SG</given-names></name>. <article-title>Local and global correlations between neurons in the middle temporal area of primate visual cortex</article-title>. <source>Cereb Cortex</source>. <year>2015</year>;<volume>25</volume>: <fpage>3182</fpage>–<lpage>3196</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/bhu111" xlink:type="simple">10.1093/cercor/bhu111</ext-link></comment> <object-id pub-id-type="pmid">24904074</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref077"><label>77</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Akemann</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Mutoh</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Perron</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>YK</given-names></name>, <name name-style="western"><surname>Iwamoto</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Knöpfel</surname> <given-names>T</given-names></name>. <article-title>Imaging neural circuit dynamics with a voltage-sensitive fluorescent protein</article-title>. <source>J Neurophysiol</source>. <year>2012</year>;<volume>108</volume>: <fpage>2323</fpage>–<lpage>2337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00452.2012" xlink:type="simple">10.1152/jn.00452.2012</ext-link></comment> <object-id pub-id-type="pmid">22815406</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref078"><label>78</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Akemann</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Sasaki</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mutoh</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Imamura</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Honkura</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Knöpfel</surname> <given-names>T</given-names></name>. <article-title>Two-photon voltage imaging using a genetically encoded voltage indicator</article-title>. <source>Sci Rep</source>. <year>2013</year>;<volume>3</volume>: <fpage>2231</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep02231" xlink:type="simple">10.1038/srep02231</ext-link></comment> <object-id pub-id-type="pmid">23868559</object-id></mixed-citation></ref>
<ref id="pcbi.1006643.ref079"><label>79</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Knöpfel</surname> <given-names>T</given-names></name>. <article-title>Genetically encoded optical indicators for the analysis of neuronal circuits</article-title>. <source>Nat Rev Neurosci</source>. <year>2012</year>;<volume>13</volume>: <fpage>687</fpage>–<lpage>700</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn3293" xlink:type="simple">10.1038/nrn3293</ext-link></comment> <object-id pub-id-type="pmid">22931891</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>