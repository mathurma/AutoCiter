<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-11-01591</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002447</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Evolutionary biology</subject>
            <subj-group>
              <subject>Evolutionary processes</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genetics</subject>
            <subj-group>
              <subject>Population genetics</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Population biology</subject>
            <subj-group>
              <subject>Population genetics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Evolutionary Biology</subject>
        </subj-group>
      </article-categories><title-group><article-title>The Rate of Beneficial Mutations Surfing on the Wave of a Range Expansion</article-title><alt-title alt-title-type="running-head">Beneficial Mutations on a Range-Expansion Wave</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Lehe</surname>
            <given-names>Rémi</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Hallatschek</surname>
            <given-names>Oskar</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Peliti</surname>
            <given-names>Luca</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Physico-Chimie Curie, UMR 168, Institut Curie, Paris, France</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>École Normale Supérieure, Paris, France</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Biophysics and Evolutionary Dynamics Group, Max Planck Institute for Dynamics and Self-Organization, Göttingen, Germany</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Dipartimento di Scienze Fisiche and Sezione INFN, Università “Federico II”, Complesso Monte S. Angelo, Napoli, Italy</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Neher</surname>
            <given-names>Richard A.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Max-Planck Institute for Developmental Biology, Germany</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">peliti@na.infn.it</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: OH. Performed the experiments: RL. Analyzed the data: RL OH LP. Wrote the paper: RL OH LP.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>3</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>29</day>
        <month>3</month>
        <year>2012</year>
      </pub-date><volume>8</volume><issue>3</issue><elocation-id>e1002447</elocation-id><history>
        <date date-type="received">
          <day>26</day>
          <month>10</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>13</day>
          <month>2</month>
          <year>2012</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>Lehe et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Many theoretical and experimental studies suggest that range expansions can have severe consequences for the gene pool of the expanding population. Due to strongly enhanced genetic drift at the advancing frontier, neutral and weakly deleterious mutations can reach large frequencies in the newly colonized regions, as if they were <italic>surfing</italic> the front of the range expansion. These findings raise the question of how frequently beneficial mutations successfully surf at shifting range margins, thereby promoting adaptation towards a range-expansion phenotype. Here, we use individual-based simulations to study the surfing statistics of recurrent beneficial mutations on wave-like range expansions in linear habitats. We show that the <italic>rate</italic> of surfing depends on two strongly antagonistic factors, the probability of surfing given the spatial location of a novel mutation and the rate of occurrence of mutations at that location. The surfing probability strongly increases towards the tip of the wave. Novel mutations are unlikely to surf unless they enjoy a spatial head start compared to the bulk of the population. The needed head start is shown to be proportional to the inverse fitness of the mutant type, and only weakly dependent on the carrying capacity. The precise location dependence of surfing probabilities is derived from the non-extinction probability of a branching process within a moving field of growth rates. The second factor is the mutation occurrence which strongly decreases towards the tip of the wave. Thus, most successful mutations arise at an intermediate position in the front of the wave. We present an analytic theory for the tradeoff between these factors that allows to predict how frequently substitutions by beneficial mutations occur at invasion fronts. We find that small amounts of genetic drift increase the fixation rate of beneficial mutations at the advancing front, and thus could be important for adaptation during species invasions.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>When a life form expands its range, the individuals close to the expanding front are more likely to dominate the gene pool of the newly colonized territory. This leads to the sweeping of pioneer genes across the newly colonized, a process which has been named gene surfing. We investigate how this effect interferes with natural selection by evaluating the probability that an advantageous mutant, appearing close to the edge of an advancing population wave, is eventually able to dominate the population range expansion. By numerical simulations and heuristic analysis, we find that the surfing of even strongly beneficial mutations requires that they are introduced with a certain spatial head start compared to the bulk of the population. However, as one moves ahead of the wave, one finds fewer and fewer individuals which can possibly mutate. As a consequence, successful mutations are most likely to arise at an intermediate position in front of the wave. For small selective advantage, the success probability is enhanced by an even smaller amount of genetic drift. This effect could be important in aiding adaptation to local conditions in a range-expansion process.</p>
      </abstract><funding-group><funding-statement>The work was supported in part by the National Science Foundation under Grant No.∼NSF PHY05-51164. LP acknowledges the support of FARO. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="13"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>While theoretical population genetics has traditionally focused on stable populations, it is increasingly recognized that departures from demographic equilibrium are a source of major changes in the gene pool of natural populations <xref ref-type="bibr" rid="pcbi.1002447-Excoffier1">[1]</xref>. Understanding these non-equilibrium scenarios often requires the development of new theoretical models that are beyond the standard methods of population genetics.</p>
      <p>One of the most frequently observed non-equilibrium scenarios are range expansions, which can be triggered by environmental changes, such as the recent global warming, by adaptive sweeps or species invasions <xref ref-type="bibr" rid="pcbi.1002447-Excoffier2">[2]</xref>. In the simplest case, range expansion take the form of an expansion wave, as first described theoretically by R. A. Fisher <xref ref-type="bibr" rid="pcbi.1002447-Fisher1">[3]</xref>. Range expansions lead to a strong reduction in the genetic diversity of the population because the dynamics is dominated by the few individuals that happen to be at the front of the wave. These <italic>pioneers</italic> <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek1">[4]</xref> are the only ones that have access to empty space and are therefore more likely to proliferate. Moreover, their offspring can, by mere random migration, remain close to the tip of the advancing wave, so that they too can enjoy high resources and continue to proliferate. By this mechanism, the pioneer genotypes are continually transmitted forward and <italic>surf</italic> along with the wave <xref ref-type="bibr" rid="pcbi.1002447-Edmonds1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1002447-Klopfstein1">[6]</xref>. Thus, all other things being equal, genetic variants which are closer to the front of the wave will have higher probability to fix in the advancing population.</p>
      <p>So far, most studies have been concerned with the surfing of neutral alleles. The goal was to understand the patterns created by stochastic drift during range expansion in order to infer past range expansions from observed patterns of genetic diversity. The importance of the surfing of neutral mutations has been quantified by considering the <italic>surfing probability</italic> that a mutation introduced at a specific location close to the front of an advancing population will fix at the front. The larger this probability, the more likely it is that surfing alleles will dominate the gene pool after the range expansion is complete, and the stronger becomes the associated loss in genetic diversity. It was found that surfing is a fast-acting mechanism that is hard to avoid in simple models. Mutation surfing was found to be relevant even in the expansion of large microbial colonies, in which genetic drift would be virtually absent if the population was well-mixed <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek2">[7]</xref>. In these two-dimensional populations, surfing generates a clear sectoring pattern, later reproduced by simulations <xref ref-type="bibr" rid="pcbi.1002447-Excoffier1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek3">[8]</xref>.</p>
      <p>It thus seems that the surfing phenomenon can lead to a severe alteration of the gene pool, which may sometimes appear like a “genetic revolution” <xref ref-type="bibr" rid="pcbi.1002447-Excoffier1">[1]</xref>. The fact that new mutations can quickly rise in frequency is phenotypically inconsequential for neutral mutations, but if beneficial or deleterious mutations surf, this can lead to rapid evolution–be it adaptive or maladaptive. Several simulation studies <xref ref-type="bibr" rid="pcbi.1002447-Klopfstein1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002447-Travis1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1002447-Miller1">[10]</xref> have therefore been carried out to investigate the effect of selection during range expansions. These studies suggest that selection is less efficient at shifting range margins and even deleterious alleles may be able to benefit from the surfing phenomenon. Other simulation studies <xref ref-type="bibr" rid="pcbi.1002447-Burton1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002447-Mnkemller1">[12]</xref> have focused in identifying the traits which are more strongly selected close to the expanding front and have suggested that natural selection tends to increase the dispersal and reproduction rates in the expanding population front with neutral or even deleterious consequences for the fitness at carrying capacity (competitive ability). This effect could be enhanced by assortative mating between fast-dispersing individuals <xref ref-type="bibr" rid="pcbi.1002447-Shine1">[13]</xref>. The trade-off between traits selected at the front and those selected in the bulk are consistent with common-garden experiments <xref ref-type="bibr" rid="pcbi.1002447-Lachmuth1">[14]</xref>, with observations in the ongoing range expansions of cane toads in Australia <xref ref-type="bibr" rid="pcbi.1002447-Brown1">[15]</xref> and genealogical records of expanding human populations <xref ref-type="bibr" rid="pcbi.1002447-Moreau1">[16]</xref>.</p>
      <p>These observations raise the question of how fast pioneer populations can potentially adapt at shifting range margins in the presence of recurrent beneficial mutations of a certain effect. This question actually entails two basic theoretical questions that have to be answered jointly. On the one hand, it is necessary to quantify the long term survival of newly introduced beneficial mutations. This leads to an analysis of the surfing probability of beneficial mutations, in the spirit of earlier studies described above. And as previously observed, the surfing probability strongly increases with distance from the bulk the of the wave. The second determinant of adaptation is the mutational input of beneficial mutations, which is proportional to the population density. At shifting range margins, the population density is like the surfing probability strongly location dependent, however, in the opposite direction: The population density decreases approximately exponentially with distance. As a consequence, the surfing <italic>rate</italic> of recurrent beneficial mutations must be controlled by a subtle tradeoff between surfing probability and mutational input. The principal goal of the present study is to establish the first analysis of this tradeoff with the goal to reveal the demographic key parameters that control evolution towards a range-expansion phenotype <xref ref-type="bibr" rid="pcbi.1002447-VanBocxlaer1">[17]</xref>.</p>
      <p>In the first step of our study, we investigate quantitatively the surfing probability of a single mutation arising at a specific position with respect to the front of a population advancing in a linear habitat. We consider just one genetic locus so that recombination does not complicate the dynamics. We concentrate on the fate of mutations that provide an advantage at the front but are neutral in the bulk of the population. As mentioned above, some recent studies have indeed suggest that natural selection during range expansions seems to focus on traits of the pioneer population: e.g., it was shown in <xref ref-type="bibr" rid="pcbi.1002447-Moreau1">[16]</xref> that pioneer women in a Canadian range expansion in the 19th century had higher fertility at the front, but not in the bulk. For such front-adjusted mutations, we then evaluate the surfing probability as a function of the position at which the mutation arises and of the linear growth rates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e001" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e002" xlink:type="simple"/></inline-formula> of the wild type and of the mutant respectively. The investigation is carried out by individual-based simulations, augmented by a heuristic mathematical analysis based on branching processes.</p>
      <p>In the second step, we convolute the surfing probability with the density profile of the expanding population waves to predict the substitution rate for beneficial mutations at the front of a range expansion. Ultimately, this substitution rate describes whether the surfing of beneficial mutations is rare or abundant, and thus serves as a proxy for the rate of adaptation during range expansions.</p>
      <sec id="s1a">
        <title>Model</title>
        <p>Our model is a variant of Kimura's stepping-stone model <xref ref-type="bibr" rid="pcbi.1002447-Kimura1">[18]</xref> for a population in a linear habitat, and has been used in Ref. <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek1">[4]</xref> to quantify the surfing of neutral mutations. In this model, colonization sites (which are called “demes”) are regularly distributed along the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e003" xlink:type="simple"/></inline-formula> axis. Due to limited resources, each deme can only carry up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e004" xlink:type="simple"/></inline-formula> individuals. Individuals have a certain probability to “hop” from one deme to a neighboring one. Within one deme, logistic, stochastic growth is assumed. Namely, if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e005" xlink:type="simple"/></inline-formula> is the number of wild type individuals in a given deme, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e006" xlink:type="simple"/></inline-formula> the corresponding number of mutants, we define the corresponding ratios by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e007" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e008" xlink:type="simple"/></inline-formula>. Then the average growth rates of wild types and mutants per unit time are given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e009" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e010" xlink:type="simple"/></inline-formula>, respectively. This description assumes that the individuals are haploid, but the model describes also diploids, if the fitness of the heterozygote is equal to the mean of the fitness of the homozygotes, and if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e011" xlink:type="simple"/></inline-formula> is taken to mean the double of the carrying capacity of the deme.</p>
        <p>In order to implement this model, we use a discrete algorithm, which is similar to that used by Hallatschek and Nelson <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek1">[4]</xref>. We consider a <italic>box</italic> made up by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e012" xlink:type="simple"/></inline-formula> neighboring demes, and kept centered on the advancing population wave as explained below. Each deme is filled with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e013" xlink:type="simple"/></inline-formula> <italic>particles</italic>, which can be of three types: wildtype, mutant and vacancies. (The presence of vacancies means that the deme is not yet saturated and that the population can still grow within it.) Then the state of the box is updated at each time step according to the following process.</p>
        <p><bold>Migration step:</bold> Two neighboring demes are chosen at random. Within each of these demes, a particle is chosen at random, then those two particles are exchanged. (If the two particles chosen are of the same type, this leads to no change.)</p>
        <p><bold>Duplication step:</bold> One deme is chosen at random. Within this deme, two particles are chosen at random, then the second particle is replaced by a duplicate of the first one, with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e014" xlink:type="simple"/></inline-formula>. (Again, if the two particles chosen are of the same type, this leads to no change.) The probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e015" xlink:type="simple"/></inline-formula> is equal to one for all processes, except for the replacement of a wild type or a mutant by a vacancy, which happen with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e016" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e017" xlink:type="simple"/></inline-formula> respectively. It is possible to show that this choice indeed results in average growth rates of the form <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e018" xlink:type="simple"/></inline-formula> for wildtype and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e019" xlink:type="simple"/></inline-formula> for mutants.</p>
        <p>Notice that the probability that a mutant replaces a wildtype individual is equal to that of the opposite event. Therefore, in a full deme, mutants have no competitive advantage over wildtype individuals. However, the relative proportion of mutant and wildtype individuals will be subject to stochastic fluctuations. We define our unit of time so that the diffusion constant of the particles is equal to one.</p>
      </sec>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <p>Let us consider a single mutant introduced at a position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e020" xlink:type="simple"/></inline-formula> measured from the advancing population wave at a certain time. Our first goal is to evaluate the probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e021" xlink:type="simple"/></inline-formula> that this mutant becomes the ancestor of the population in the front of the wave. The function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e022" xlink:type="simple"/></inline-formula> thus represents the probability that the mutation becomes fixed in the front population, given it arose at location <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e023" xlink:type="simple"/></inline-formula>. One can consider this <italic>surfing probability</italic> as a spatial analog of the classical Haldane formula for the fixation probabity of mutant genotypes in well-mixed populations <xref ref-type="bibr" rid="pcbi.1002447-Haldane1">[19]</xref>. Relying on 1D simulations, Hallatschek and Nelson <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek1">[4]</xref> searched for an analytical expression of this specific function. Their work focused on the relatively simpler case of neutral mutations. Progress even in this neutral case was only possible through approximations <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek1">[4]</xref>. However, most recently an exact approach could be devised that relies on modifying the logistic interaction in the population dynamics <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek4">[20]</xref>.</p>
      <p><xref ref-type="fig" rid="pcbi-1002447-g001">Figure 1</xref> shows the typical shape of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e024" xlink:type="simple"/></inline-formula> for a weakly beneficial mutant, and defines the different characteristic parameters of the curve. It can be seen that, when the mutant starts in the bulk of the wave, the probability that it fixes in the front virtually vanishes. This is indeed what would be expected from the qualitative picture of the surfing mechanism. However, when the mutant starts at a distance of order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e025" xlink:type="simple"/></inline-formula> from the front, this probability starts to increase. This is due to the fact that, in this case, the mutant population has access to more empty space and is likely to grow for a while, before the wildtype front eventually reaches it. Finally, far ahead of the front, this probability saturates. Importantly, our simulations revealed that the saturation value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e026" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e027" xlink:type="simple"/></inline-formula> is always equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e028" xlink:type="simple"/></inline-formula>. An interpretation of this fact is given in the discussion. We evaluated the dependence of the characteristic length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e029" xlink:type="simple"/></inline-formula> as a function of the parameters defining the model. As shown in <xref ref-type="fig" rid="pcbi-1002447-g002">Figure 2</xref>, the variations of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e030" xlink:type="simple"/></inline-formula> are consistent with the expression:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e031" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e032" xlink:type="simple"/></inline-formula> is a slowly decreasing function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e033" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e034" xlink:type="simple"/></inline-formula>. In this expression, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e035" xlink:type="simple"/></inline-formula> is the carrying capacity of each colonization site (“deme”), and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e036" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e037" xlink:type="simple"/></inline-formula> are, respectively, the wildtype and mutant growth rates (see <xref ref-type="sec" rid="s4">Methods</xref>). A similar expression is derived from a simple model in the discussion. It can be seen that the dependence on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e038" xlink:type="simple"/></inline-formula> is consistent with intuition: the fitter the mutants, the fewer resources they will need in order to invade the front. Therefore, they may start closer to the front, and still have a substantial probability to fix. The dependence on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e039" xlink:type="simple"/></inline-formula> is less intuitive. However, it was already remarked in ref. <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek1">[4]</xref> that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e040" xlink:type="simple"/></inline-formula> shifted away from the front for increasing values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e041" xlink:type="simple"/></inline-formula>. Within the neutral frame work of ref. <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek1">[4]</xref>, an approximate (but general) expression for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e042" xlink:type="simple"/></inline-formula> in terms of the wave profile was obtained that was quantitatively consistent with these observations.</p>
      <fig id="pcbi-1002447-g001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002447.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Fixation probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e043" xlink:type="simple"/></inline-formula> as a function of the position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e044" xlink:type="simple"/></inline-formula> where the mutant is introduced (for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e045" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e046" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e047" xlink:type="simple"/></inline-formula>).</title>
          <p>The wildtype wave profile (arbitrarily rescaled) is shown by the dashed line. The probability profile <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e048" xlink:type="simple"/></inline-formula> virtually vanishes in the bulk of the wave, but suddenly rises at a characteristic distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e049" xlink:type="simple"/></inline-formula> from the front, and then saturates. The shape of the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e050" xlink:type="simple"/></inline-formula> is characterized by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e051" xlink:type="simple"/></inline-formula>, defined as the distance between the two points at which the curves reach half of their saturation values, by the characteristic width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e052" xlink:type="simple"/></inline-formula> over which the curve rises, and by its saturation height <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e053" xlink:type="simple"/></inline-formula>.</p>
        </caption>
        <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.g001" xlink:type="simple"/>
      </fig>
      <fig id="pcbi-1002447-g002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002447.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>The measured characteristic distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e054" xlink:type="simple"/></inline-formula>, rescaled by the factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e055" xlink:type="simple"/></inline-formula>, as a function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e056" xlink:type="simple"/></inline-formula>.</title>
          <p>The data shown corresponds to various values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e057" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e058" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e059" xlink:type="simple"/></inline-formula>. Values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e060" xlink:type="simple"/></inline-formula> range from 100 to 1000, and values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e061" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e062" xlink:type="simple"/></inline-formula> range from 0.05 to 0.5. The data points corresponding to the same value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e063" xlink:type="simple"/></inline-formula> group on straight lines, with slopes weakly dependent on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e064" xlink:type="simple"/></inline-formula>. Compare (1).</p>
        </caption>
        <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.g002" xlink:type="simple"/>
      </fig>
      <sec id="s2a">
        <title>The basic surfing scenario</title>
        <p>The results just described as well as the direct inspection of particular realizations, guided us in drafting a rough scenario for the fate of the mutants:</p>
        <list list-type="bullet">
          <list-item>
            <p>When the mutants start behind the front (i.e., in the bulk of the wave), it is practically impossible for them to grow, since they are surrounded by nearly full demes. The dynamics is dominated by random birth and death, with no net growth rate, and the population is bound to die out at some point. Therefore the survival probability vanishes.</p>
          </list-item>
          <list-item>
            <p>When the mutants start immediately ahead of the front, they have access to partially empty demes and <italic>may</italic> grow for a while. More precisely, during a first stage in which the number of mutants is still low, the population may die out, due to stochastic fluctuations in births and deaths. However in realizations in which that does not happen, the population reaches a number for which fluctuations are negligible, and thus enters a second stage in which it grows rapidly. Yet, in this case, while they grow, the advancing wildtype wave is progressively reaching them. As a result, they will soon be surrounded by full demes, and will not be able to grow anymore. They are therefore left behind. On the whole, the survival probability is relatively large (but still smaller than 1, due to stochastic death in the first stage), while the fixation probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e065" xlink:type="simple"/></inline-formula> is small.</p>
          </list-item>
          <list-item>
            <p>Eventually, when the mutants start far ahead of the front (at a distance larger than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e066" xlink:type="simple"/></inline-formula>), they have–as before–the possibility to grow rapidly, but it also takes a longer time for the wildtype wave to reach their starting position. Meanwhile, the mutant population may grow to such a large number that they can actually stop the wildtype wave, and develop their own advancing front. In other words, if the mutants survive the stochastic fluctuations of the early stage, they are certain to reach fixation. Therefore the fixation probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e067" xlink:type="simple"/></inline-formula> equals the survival probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e068" xlink:type="simple"/></inline-formula> in this case.</p>
          </list-item>
        </list>
        <p>We can now begin to provide explanations for the quantitative results of our simulations.</p>
      </sec>
      <sec id="s2b">
        <title>Maximal surfing probability in the wave tip</title>
        <p>According to the basic scenario outlined above, mutants arising far in the tip of the wave fix depending on whether or not they avoid a stochastic death in the first stage of their growth. Notice that the presence of a wildtype wave plays no role here, since it has not yet reached this position. In a large well-mixed population, this survival probability is simply given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e069" xlink:type="simple"/></inline-formula> for a branching process with growth rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e070" xlink:type="simple"/></inline-formula> and death rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e071" xlink:type="simple"/></inline-formula>, which is a classical Haldane formula for the establishment probability of a beneficial mutation <xref ref-type="bibr" rid="pcbi.1002447-Haldane1">[19]</xref>. This standard result remains unchanged in the present spatial model with local logistic growth, as is shown in the subsection on nondimensionalized equations by a simple argument. Indeed, our simulations show that the probability of survival (and fixation) probability saturates at the value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e072" xlink:type="simple"/></inline-formula> for sufficiently beneficial mutations in the tip of the population wave.</p>
      </sec>
      <sec id="s2c">
        <title>Onset of surfing in the tip of the wave</title>
        <p>In the Results section, we defined <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e073" xlink:type="simple"/></inline-formula> as the typical distance, measured from the front, where the surfing probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e074" xlink:type="simple"/></inline-formula> changes from 0 to its maximal value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e075" xlink:type="simple"/></inline-formula>. In other words, mutants have very small chance to reach fixation if they are introduced at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e076" xlink:type="simple"/></inline-formula>, whereas they will almost surely fix if they start at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e077" xlink:type="simple"/></inline-formula>, provided that they survive the stochastic fluctuations in the first stage of their growth. In the basic scenario described above, we suggested that this meant in fact that mutants starting further than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e078" xlink:type="simple"/></inline-formula> have enough time to grow, so that they are then numerous enough to stop the advancing wildtype wave.</p>
        <p>This argument can be turned into a quantitative estimate of the magnitude of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e079" xlink:type="simple"/></inline-formula>. According to the classical Fisher wave speed and our numerical measurements, our model (cf. equation (9)) implies that the wildtype wave propagates at a velocity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e080" xlink:type="simple"/></inline-formula>. Therefore, the wildtype wave will reach the growing mutant population at a time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e081" xlink:type="simple"/></inline-formula> (where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e082" xlink:type="simple"/></inline-formula> is the distance from the front to the starting position). Let us now estimate how much the mutant population will have grown before this arrival time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e083" xlink:type="simple"/></inline-formula> of the wild type wave. To this end, we assume that the mutant clone grows unaffected by the wildtype population up until time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e084" xlink:type="simple"/></inline-formula>. Then, the total mutant population <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e085" xlink:type="simple"/></inline-formula> grows exponentially on average, according to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e086" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e087" xlink:type="simple"/></inline-formula>. However, we know from the previous subsection that, after some time, the mutant population is non-zero in only a fraction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e088" xlink:type="simple"/></inline-formula> of the realizations. Therefore, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e089" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e090" xlink:type="simple"/></inline-formula> is the average over realizations in which the mutant population has not died out. Thus we have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e091" xlink:type="simple"/></inline-formula>.</p>
        <p>Now we make the simple-minded assumption that the probability to fix is large if the total mutant population has grown above a characteristic number on the order of the typical number <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e092" xlink:type="simple"/></inline-formula> of mutants in an all-mutant wave before the wildtype wave reaches it (i.e., at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e093" xlink:type="simple"/></inline-formula>) and is small otherwise. Hence, we expect<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e094" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e095" xlink:type="simple"/></inline-formula> is a weakly varying function of its two arguments. We will show in the <xref ref-type="sec" rid="s4">Methods</xref> section, that indeed the only relevant parameters that govern the surfing probabilities are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e096" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e097" xlink:type="simple"/></inline-formula>, which appear as arguments in (2).</p>
        <p>Our estimate of the “edge” of surfing in (2) should be considered as an upper bound because a clone may not need to grow to a size as large as the number of individuals in a mutant wave front, as we have assumed in our argument. Nevertheless, the estimate in (2) sets a useful bound on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e098" xlink:type="simple"/></inline-formula>, which works very well for small populations and large fitness effects, as documented by our data in <xref ref-type="fig" rid="pcbi-1002447-g002">Figure 2</xref>.</p>
      </sec>
      <sec id="s2d">
        <title>Functional form of the surfing probability</title>
        <p>With the onset of surfing in the tip of the wave and the maximum surfing probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e099" xlink:type="simple"/></inline-formula>, we have discussed two characteristic features of the sigmoidal function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e100" xlink:type="simple"/></inline-formula>. A more detailed analysis is required, however, to describe the transition region where most of the surfing beneficial mutations are generated, which is a pre-requisite for dissecting the substitution rate below. Therefore, we sought for a differential equation that may determine the functional form <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e101" xlink:type="simple"/></inline-formula>. An equation of this kind was already found in ref. <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek1">[4]</xref>, for the case of a neutral mutation, on the basis of a backward Fokker-Planck formalism. However, the approach that these authors use is specific to neutral mutations and cannot be extended to the non-neutral case.</p>
        <p>For sufficiently beneficial mutations, it is however possible to derive an approximate differential equation for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e102" xlink:type="simple"/></inline-formula> by employing the theory of branching random walks. To this end, we approximate the proliferation of newly introduced mutant by a linear birth-death process: A mutant at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e103" xlink:type="simple"/></inline-formula> has a constant birth rate of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e104" xlink:type="simple"/></inline-formula> per generation. The death rate on the other hand depends on location. Far in the tip of the wave, the death rate of the mutants approaches a constant of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e105" xlink:type="simple"/></inline-formula>, and it approaches <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e106" xlink:type="simple"/></inline-formula> in the bulk of the wave as there is no net growth in the saturated region of the population. By construction of our model, the net <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e107" xlink:type="simple"/></inline-formula>-dependent growth rate is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e108" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e109" xlink:type="simple"/></inline-formula> is the number of wildtypes in a deme located at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e110" xlink:type="simple"/></inline-formula> at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e111" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e112" xlink:type="simple"/></inline-formula> is the analogous quantity for the mutants. Thus the net growth rate is in general fluctuating due to the fluctuating occupancy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e113" xlink:type="simple"/></inline-formula> of deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e114" xlink:type="simple"/></inline-formula>. We now make two important assumptions. First, we assume that the survival of the mutants is decided early on when the mutant population is so small that we can well approximate its growth rate by the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e115" xlink:type="simple"/></inline-formula>, i.e., by neglecting the non-linear effect of the mutant population on its own survival. This approximation is justified when the growth rate advantage of the mutants is sufficiently large, and breaks down in the neutral or nearly neutral case. Second, we average the growth rates over all realization and assume a growth rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e116" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e117" xlink:type="simple"/></inline-formula> is the average density profile of an all wildtype wave. This simplification holds provided that that the carrying capacity is so large that fluctuations in the wave profile are weak. Under these assumptions, we can use a standard result for branching random walks, namely that the survival probability, which in our case equals the surfing probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e118" xlink:type="simple"/></inline-formula>, satisfies<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e119" xlink:type="simple"/><label>(3)</label></disp-formula>In the <xref ref-type="sec" rid="s4">Methods</xref> section, we provide a heuristic rational of this differential equation, but for a strict derivation the reader is referred to standard text books, such as ref. <xref ref-type="bibr" rid="pcbi.1002447-Harris1">[21]</xref>.</p>
        <p>Equation (3) has a form very similar to the differential equation for a deterministic Fisher-Kolmogorov wave running in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e120" xlink:type="simple"/></inline-formula> direction. This explains the overall sigmoidal “wave profile” of the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e121" xlink:type="simple"/></inline-formula>. Notice however that the term <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e122" xlink:type="simple"/></inline-formula> approaches <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e123" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e124" xlink:type="simple"/></inline-formula> where the wildtype occupancy saturates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e125" xlink:type="simple"/></inline-formula>. Thus, (3) should be regarded as a classical Fisher-Kolomgorov equation with a <italic>cut-off</italic> <xref ref-type="bibr" rid="pcbi.1002447-Brunet1">[22]</xref>, an observation which will be important in the following section. To quantitatively compare the branching process theory with our individual based simulations, we integrated equation (3) numerically. As shown in <xref ref-type="fig" rid="pcbi-1002447-g003">Figures 3</xref> and <xref ref-type="fig" rid="pcbi-1002447-g004">4</xref>, the agreement is very good, and remains so when the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e126" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e127" xlink:type="simple"/></inline-formula> are varied as long as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e128" xlink:type="simple"/></inline-formula>.</p>
        <fig id="pcbi-1002447-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002447.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Fixation probability profile <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e129" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e130" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e131" xlink:type="simple"/></inline-formula>, and different values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e132" xlink:type="simple"/></inline-formula>.</title>
            <p>The dots represent simulation data and the continuous lines correspond to the result of the numerical integration. The dashed line represents the (arbitrarily rescaled) average profile <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e133" xlink:type="simple"/></inline-formula> of an all wildtype wave.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.g003" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002447-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002447.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Fixation probability profile <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e134" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e135" xlink:type="simple"/></inline-formula>, and different values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e136" xlink:type="simple"/></inline-formula>.</title>
            <p>The dots represent simulation data and the continuous lines correspond to the result of the numerical integration. As before, the dashed line represents <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e137" xlink:type="simple"/></inline-formula>, arbitrarily rescaled.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.g004" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2e">
        <title>Rate of substitutions</title>
        <p>As a proxy for the speed of adaptation at shifting range margins, we finally ask how frequently beneficial mutations <italic>fix</italic> in the pioneer population for a given mutation rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e138" xlink:type="simple"/></inline-formula>. Clearly, the surfing probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e139" xlink:type="simple"/></inline-formula> is one important factor as it governs the chances of success for a mutation inserted at location <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e140" xlink:type="simple"/></inline-formula>. We have seen that, generically, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e141" xlink:type="simple"/></inline-formula> steeply increases towards the tip of the wave due to the location advantage appreciated there. However, only few individuals reside in the tip region and can thus provide mutational input for adaptation. This effect is described, of course, by the wave profile <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e142" xlink:type="simple"/></inline-formula>. The product <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e143" xlink:type="simple"/></inline-formula> describes the tradeoff between the higher success probability in the tip and the higher mutational input in the bulk of the wave. More precisely, the integral<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e144" xlink:type="simple"/><label>(4)</label></disp-formula>controls the substitution rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e145" xlink:type="simple"/></inline-formula> for beneficial mutations of effect <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e146" xlink:type="simple"/></inline-formula> and mutation rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e147" xlink:type="simple"/></inline-formula>.</p>
        <p>As argued earlier, for sufficiently beneficial mutations, the survival of a beneficial mutation is well-described by our mean-field description that only depends on the mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e148" xlink:type="simple"/></inline-formula>. We may thus approximate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e149" xlink:type="simple"/></inline-formula> by setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e150" xlink:type="simple"/></inline-formula>, and use our above results for the average survival probability and population density to estimate the integral on the right hand side. The value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e151" xlink:type="simple"/></inline-formula> is plotted in <xref ref-type="fig" rid="pcbi-1002447-g005">Figure 5</xref> as a function of the selective advantage of the mutants. These results show that, for carrying capacities ranging from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e152" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e153" xlink:type="simple"/></inline-formula>, the substitution rate depends only weakly on selection coefficients. Even for selection coefficients of 10%, the substitution rate in the most dense population (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e154" xlink:type="simple"/></inline-formula>) is merely increased by a factor 4 compared to the neutral base line. Also note, as shown in <xref ref-type="fig" rid="pcbi-1002447-g006">Figure 6</xref>, that the substitution rate does increase more slowly than linear with population size (as parameterized by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e155" xlink:type="simple"/></inline-formula>) quite in contrast to well-mixed population models (in the absence of clonal interference <xref ref-type="bibr" rid="pcbi.1002447-Sniegowski1">[23]</xref>).</p>
        <fig id="pcbi-1002447-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002447.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>The substitution rate at the front of an advancing population compared to the neutral substitution rate is described by the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e156" xlink:type="simple"/></inline-formula>, which is displayed here as a function of the selective advantage of the mutants.</title>
            <p>Notice that the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e157" xlink:type="simple"/></inline-formula> axis is logarithmic. Blue, red and yellow symbols correspond to the carrying capacity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e158" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e159" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e160" xlink:type="simple"/></inline-formula>. All curves approach <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e161" xlink:type="simple"/></inline-formula> in the neutral case, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e162" xlink:type="simple"/></inline-formula>, in which the substitution and mutation rates are equal. Notice the rather slow increase of substitution rates with increasing selection coefficient, for small values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e163" xlink:type="simple"/></inline-formula>: even for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e164" xlink:type="simple"/></inline-formula> and the highest carrying capacity, the substitution rates are merely 4 times higher than the neutral baseline, illustrating the ineffectiveness of selection at expanding fronts. For larger selection coefficients, however, the substitution rate grows roughly exponentially with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e165" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.g005" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002447-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002447.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Substitution rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e166" xlink:type="simple"/></inline-formula> divided by the deme carrying capacity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e167" xlink:type="simple"/></inline-formula> as a function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e168" xlink:type="simple"/></inline-formula> for several values of the selection coefficient <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e169" xlink:type="simple"/></inline-formula> of the mutant.</title>
            <p>It appears quite clearly that the substitution rate increases less than linearly with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e170" xlink:type="simple"/></inline-formula>, as suggested by equation (26).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.g006" xlink:type="simple"/>
        </fig>
        <p>Our simulated data for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e171" xlink:type="simple"/></inline-formula> are hard to model from first principles, as this would require a solution to the long-standing problem of noisy Fisher waves for rather small values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e172" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek4">[20]</xref>. However, for large carrying capacities such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e173" xlink:type="simple"/></inline-formula>, where genetic drift is weak, an analytical approach is feasible. The analysis, described in the <xref ref-type="sec" rid="s4">Methods</xref> section, not only allows us to answer the question as to how the substitution rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e174" xlink:type="simple"/></inline-formula> behaves in the deterministic limit, or relatively close to it. It also provides us with a qualitative picture of how genetic drift, mutations and selection compete during a population expansion. These asymptotic results are meant to guide the intuition as to how weakly selection affects the substitution process.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>When a beneficial mutation arises in the front of an expanding population, it has a high risk of being immediately lost from the front population either by extinction or because the mutant clone cannot keep up with the shifting wave front. Rarely, however, mutants become entirely fixed in the front population, a phenomenon referred to as gene surfing. In this paper, we have studied the results of a one-dimensional individual-based simulation to measure and explain i) the probability of surfing of a newly introduced beneficial mutations on a population range expansion and ii) the rate of these surfing events if beneficial mutations occur at a certain rate and have a certain effect.</p>
      <p>In agreement with earlier studies <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002447-Klopfstein1">[6]</xref>, , we found that the probability of surfing crucially depends on the location of the first mutant with respect to the advancing wave. We have quantified this location advantage in two ways. First, we estimated heuristically the spatial head start required for a clone of beneficial mutations to grow large in the wave tip before the bulk of the wave arrives. This head start was found to be inversely proportional to the growth rate of the mutants and only grows logarithmically with the carrying capacity. If mutations arises sufficiently far ahead of the front of a population-expansion wave, they can fix even if fitness effects are small, which is consistent with earlier observations <xref ref-type="bibr" rid="pcbi.1002447-Klopfstein1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002447-Travis1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1002447-Miller1">[10]</xref>. A more systematic and accurate analysis based on the theory of branching processes could be given to describe how fast the surfing probabilities rise as one moves into the tip of the wave until it eventually saturates. Further analysis, reported in the <xref ref-type="sec" rid="s4">Methods</xref> section, shows that in the deterministic limit of infinite carrying capacities, the characteristic distance at which surfing becomes significant scales as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e175" xlink:type="simple"/></inline-formula> for small selective advantage <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e176" xlink:type="simple"/></inline-formula> (cf. equation (23)). For any reasonable carrying capacity, however, surfing probabilities are found to be significantly higher than expected from a deterministic analysis, which shows that genetic drift is essential for the surfing of weakly beneficial mutations.</p>
      <p>Our analytical description of the location-dependent survival probability enabled us to get at our second key question: At what rate do surfing events occur for a given mutation rate and selective advantage? This rate of surfing events may be viewed a proxy for how quickly a population may evolve toward a range expansion phenotype <xref ref-type="bibr" rid="pcbi.1002447-VanBocxlaer1">[17]</xref>. The surfing rate is determined by two factors. One is, of course, the surfing probability, which increases towards the tip of the wave, the other is the mutational process by which new potential surfers are introduced. Clearly the mutational supply is highest in the bulk of the wave because of its saturated population density, but there the surfing probability is lowest. It turned out that, due the trade-off between both effects, most surfers are generated at an intermediate position within the front of the wave. We were able to determine analytically the substitution rate for large populations and small mutational fitness effects. This analysis shows that, in the deterministic limit, surfing rates for small selection coefficients are strongly suppressed. Mathematically, this is manifest in an essential singularity of the substitution rates at vanishing selection coefficients. For large but finite carrying capacities, however, substitution rates are strongly increased due to even tiny amounts of genetic drift. Our theory predicts a generally quite strong positive correlation between surfing rates and genetic drift (as quantified by inverse carrying capacities) for small selection coefficients. Interestingly, our simulations show that this correlation is qualitatively inverted for large selection coefficients: Very large effect mutations do not require genetic drift to prevail, so that their rate is mainly controlled by the mutational supply which increases with increasing carrying capacities. However, our results suggests for beneficial mutations of intermediate and small effects that long-term survival during a range expansions is mostly a matter of luck to arise far in the wave tip than of fitness.</p>
      <p>In summary, we have for the first time analyzed not only the fate of newly introduced mutations, but also the rate of surfing events for a given mutation rate. Our results suggest that genetic drift is not required to promote mutation surfing of strongly beneficial mutations for which selection is strong enough. Importantly, however, our results suggest that some amount of genetic drift strongly increases substitution rates at advancing fronts for weakly beneficial mutations and thus can be important for promoting adaptation towards an invasion phenotype.</p>
      <p>Finally, we discuss the assumptions at the base of our study, and its possible generalizations. First, we only considered mutations that are beneficial to the pioneer population but neutral for the bulk population. Several experimental studies suggest that such mutations towards a range-expansion phenotype are actually disadvantageous in the bulk of the population <xref ref-type="bibr" rid="pcbi.1002447-Lachmuth1">[14]</xref>–<xref ref-type="bibr" rid="pcbi.1002447-Moreau1">[16]</xref>. While such mutations gradually disappear from the bulk population, we expect that their surfing propensity will be almost identical to mutations that are neutral or beneficial in the bulk. This is because the bulk phenotype matters so far from the wave tip that it cannot influence the genetic composition of the wave tip. The analysis would change qualitatively if the selective advantage in the bulk is so large that the ensuing genetic wave of the beneficial mutation within the saturated bulk population would be faster than the range expansion. However, this situation only occurs for extreme selective differences on the order of one.</p>
      <p>We have also assumed that population expansions proceed according to R.A. Fisher's standard model, in which the Malthusian growth rate of individuals in the tip of the wave is constant. However, many species are characterized by a reduced Malthusian growth rate when densities become too small. This effect arises when individuals need to cooperate with others in order to proliferate, for instance in the case of sexual reproduction. Such Allee effects <xref ref-type="bibr" rid="pcbi.1002447-Allee1">[24]</xref> have been found to considerably lessen the role of genetic drift in the gene surfing phenomenon: The <italic>effective</italic> population size associated with the expanding population front was strongly positively correlated with the strength of the Allee effect <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek1">[4]</xref>. We expect that such Allee effects will also alter surfing probability and rates of beneficial mutations, because they lessen the extreme location advantage of mutations arising in the far wave tip. As a consequence, the surfing beneficial mutations arise closer to the bulk of the population for stronger Allee effects. Also the total rate of surfing events would be strongly increased. We thus expect that larger Allee effects will significantly enhance adaptation towards a range expansion phenotype.</p>
      <p>Another interesting extension of our study concerns expansion waves in planar habitats. In this case, the location advantage for deleterious mutants is likely to be less relevant, since the wildtype population is able to overcome the mutant and constrain it to a bounded region. As in the one-dimensional case, successful long-term surfing of deleterious mutations will require that the mutant clone takes over the entire colonization front. As a consequence, the surfing probability will sensitively depend on the habitat's extension transverse to the expansion direction. Also, the analysis of the surfing of beneficial mutations will be more complex: Surfing beneficial mutations give rise to <italic>sectors</italic> <xref ref-type="bibr" rid="pcbi.1002447-Hallatschek3">[8]</xref> with sector angles that characterize their selective advantage against the surrounding wild type population. Furthermore, at any given time, some parts of the colonization front will be more advanced than others, due to the inevitable random front undulations. If a mutation arises in one of those more advanced region of the habitat, it will have higher long-term surfing probabilities than in the less advanced regions. Nevertheless, simulations of the kind carried out in this study should quite generally allow to investigate the establishment probabilities in any model of expanding populations.</p>
    </sec>
    <sec id="s4" sec-type="methods">
      <title>Methods</title>
      <p>We initialize our simulations by letting the demes in the left half of the box be full of wildtype individuals, while the demes in the right half of the box are empty (i.e., full of vacancies). Thus, the initial configuration evolves into a wave profile that propagates to the right. The algorithm follows the wave front by shifting the box at the same velocity, by introducing from time to time new empty demes at the right extremity while removing the leftmost demes. In the subsection on nondimensionalized equations, we show that our simulations can be described a set of stochastic differential equations. The form of these equations show that, although our model is characterized by three parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e177" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e178" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e179" xlink:type="simple"/></inline-formula>, there are in fact only two control parameters: The relative fitness <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e180" xlink:type="simple"/></inline-formula> measures the growth rate advantage of mutants. The parameter combination <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e181" xlink:type="simple"/></inline-formula> quantifies the strength of number fluctuations in the tip of the wave. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e182" xlink:type="simple"/></inline-formula> is analogous to the parameter “<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e183" xlink:type="simple"/></inline-formula>” in many well-mixed population genetic models, with the replacements <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e184" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e185" xlink:type="simple"/></inline-formula>. The relevant population size <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e186" xlink:type="simple"/></inline-formula> represents the typical number of individuals in the nose of a purely wildtype wave, because <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e187" xlink:type="simple"/></inline-formula> is the occupancy of saturated demes and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e188" xlink:type="simple"/></inline-formula> measures the width of the wave front in units of deme sizes. When no mutant is present, the dynamics reduces to the well-known noisy Fisher-Kolmogorov-Petrovski-Piskounov (FKPP) equation <xref ref-type="bibr" rid="pcbi.1002447-Murray1">[25, p. 400]</xref> in one spatial dimension. This is confirmed by control simulations of all wildtype waves, which show that the velocity of the wave tends to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e189" xlink:type="simple"/></inline-formula> for large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e190" xlink:type="simple"/></inline-formula>, consistent with the known deterministic wave speed of FKPP waves.</p>
      <p>To investigate the surfing phenomenon, we studied the wave propagation under the influence of newly introduced mutants. Specifically, a mutant was added in a chosen deme within the co-moving simulation box once the wave has reached a steady profile. The fate of the mutant clone was then recorded. Three types of final events were distinguished:</p>
      <list list-type="bullet">
        <list-item>
          <p><italic>Fixation:</italic> the mutants invade the front of the wave and the wildtype population is left behind. A given realization is considered as a fixation event if no wildtype individual remains in the box at the end of the simulation.</p>
        </list-item>
        <list-item>
          <p><italic>Failure:</italic> the mutants survive, but they fail to invade the front and are left behind. This corresponds to realizations in which no mutant remains in the box at the end <italic>but</italic> in which it has been detected that <italic>at least one</italic> mutant has crossed the left boundary of the box, for instance when the box was shifted.</p>
        </list-item>
        <list-item>
          <p><italic>Death:</italic> the mutant population dies out due to stochastic fluctuations. This corresponds to the remaining realizations in which the mutants disappear before reaching the left boundary.</p>
        </list-item>
      </list>
      <p>Failure corresponds quite likely to a situation in which the mutant population eventually dies off, due to neutral sampling fluctuations. Even if the mutants had a higher growth rate than the wild types in full demes, if they are able to establish a mutant population in the bulk, they would then expand by Fisher waves with a speed determined by the difference in growth rates with respect to wild types. This wave will not have a chance to catch the wave front unless this difference is unreasonably large. Thus it is safe to neglect the occurrence of failure when focusing on the events on the front of the advancing population wave, also considering that the definition of failure depends on the width of the simulation box. These considerations justify focusing only on the fixation probability at the front of the wave. Therefore, for each starting position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e191" xlink:type="simple"/></inline-formula>, we ran many realizations of the process, and from their results we deduced the probability of fixation. The number of realizations over which the algorithm evaluated those probabilities was usually set to 10 000, for each position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e192" xlink:type="simple"/></inline-formula>. The position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e193" xlink:type="simple"/></inline-formula> was then varied to obtain the dependence of this probability on the starting position.</p>
      <sec id="s4a">
        <title>Master equation and its nondimensionalized expression</title>
        <p>In the present subsection we show that the different parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e194" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e195" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e196" xlink:type="simple"/></inline-formula> which define the model enter in fact only in the combinations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e197" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e198" xlink:type="simple"/></inline-formula>. In particular, this explains the behavior of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e199" xlink:type="simple"/></inline-formula> shown in <xref ref-type="fig" rid="pcbi-1002447-g002">Figure 2</xref>.</p>
        <p>In order to do so, we recast the dynamics of the model in terms of stochastic differential equations. Let us denote by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e200" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e201" xlink:type="simple"/></inline-formula>) the position of the deme. Then the state of the system is identified by the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e202" xlink:type="simple"/></inline-formula>-dimensional vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e203" xlink:type="simple"/></inline-formula>. Thus the algorithm described in the previous section can be represented by a master equation of the form<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e204" xlink:type="simple"/><label>(5)</label></disp-formula>where the index <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e205" xlink:type="simple"/></inline-formula> runs over all the allowed types of events that lead to a change in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e206" xlink:type="simple"/></inline-formula> (birth, death, migration to a neighboring deme, etc.), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e207" xlink:type="simple"/></inline-formula> is the probability of such an event per unit time and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e208" xlink:type="simple"/></inline-formula> is the resulting variation of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e209" xlink:type="simple"/></inline-formula> vector. The expressions of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e210" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e211" xlink:type="simple"/></inline-formula> for each allowed event <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e212" xlink:type="simple"/></inline-formula> are detailed in <xref ref-type="table" rid="pcbi-1002447-t001">Table 1</xref>.</p>
        <table-wrap id="pcbi-1002447-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002447.t001</object-id><label>Table 1</label><caption>
            <title>Transition probabilities.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002447-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Event</td>
                <td align="left" colspan="1" rowspan="1">Probability per time step</td>
                <td align="left" colspan="1" rowspan="1">Change in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e213" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">Birth of a wildtype individual in deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e214" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e215" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e216" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Death of a wildtype individual in deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e217" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e218" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e219" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Birth of a mutant in deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e220" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e221" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e222" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Death of a mutant in deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e223" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e224" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e225" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Replacement of a wildtype by a mutant in deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e226" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e227" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e228" xlink:type="simple"/></inline-formula>,</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e229" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Replacement of a mutant by a wildtype in deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e230" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e231" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e232" xlink:type="simple"/></inline-formula>,</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e233" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">A wildtype from deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e234" xlink:type="simple"/></inline-formula> comes to the neighboring deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e235" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e236" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e237" xlink:type="simple"/></inline-formula>,</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e238" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">A mutant from deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e239" xlink:type="simple"/></inline-formula> comes to the neighboring deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e240" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e241" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e242" xlink:type="simple"/></inline-formula>,</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e243" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">A wildtype from deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e244" xlink:type="simple"/></inline-formula> swaps with a mutant from deme <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e245" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e246" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e247" xlink:type="simple"/></inline-formula>,</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e248" xlink:type="simple"/></inline-formula>,</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e249" xlink:type="simple"/></inline-formula>,</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e250" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>Transition probabilities for the different events <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e251" xlink:type="simple"/></inline-formula> appearing in the master equation (5).</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>Expanding equation (5) to first order in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e252" xlink:type="simple"/></inline-formula> (see, e.g., <xref ref-type="bibr" rid="pcbi.1002447-vanKampen1">[26, chap.∼X]</xref>) leads to a Fokker-Planck equation, and a corresponding set of Langevin equations can then be found. Under the assumptions that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e253" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e254" xlink:type="simple"/></inline-formula>, we may approximate the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e255" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e256" xlink:type="simple"/></inline-formula> by the continuous functions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e257" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e258" xlink:type="simple"/></inline-formula>. If we further assume that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e259" xlink:type="simple"/></inline-formula>, and that stochastic deviations from the average diffusion term are negligible, these equations read:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e260" xlink:type="simple"/><label>(6)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e261" xlink:type="simple"/><label>(7)</label></disp-formula>In this expression, the Gaussian noises <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e262" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e263" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e264" xlink:type="simple"/></inline-formula> are uncorrelated, and one has, for instance, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e265" xlink:type="simple"/></inline-formula>. This set of equations corresponds to a stochastic reaction-diffusion system, where the reaction term is logistic, and where, by construction, the diffusion constant is equal to 1. Notice that the last term corresponds to the stochastic replacement of a mutant by a wildtype individual (or conversely) and is responsible for stochastic fluctuations within a full deme.</p>
        <p>The equations can be made nondimensional by setting<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e266" xlink:type="simple"/><label>(8)</label></disp-formula>We obtain therefore<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e267" xlink:type="simple"/><label>(9)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e268" xlink:type="simple"/><label>(10)</label></disp-formula>The nondimensionalized equations reveal, as anticipated, that the problem only depends on two relevant parameters: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e269" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e270" xlink:type="simple"/></inline-formula>.</p>
      </sec>
      <sec id="s4b">
        <title>Survival probability of a branching process</title>
        <p>The survival probability of a linear branching process with birth rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e271" xlink:type="simple"/></inline-formula> and death rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e272" xlink:type="simple"/></inline-formula> can be easily determined by the following discrete reasoning: let us denote the total number of individuals <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e273" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e274" xlink:type="simple"/></inline-formula>, and consider the probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e275" xlink:type="simple"/></inline-formula> that a population of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e276" xlink:type="simple"/></inline-formula> individuals will survive. Diffusion events do not change <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e277" xlink:type="simple"/></inline-formula>; it is only affected by duplication events (births or deaths). However, death events are always <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e278" xlink:type="simple"/></inline-formula> times less likely than birth events (see the definition of the model). Thus, a given duplication event is a birth with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e279" xlink:type="simple"/></inline-formula> and a death with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e280" xlink:type="simple"/></inline-formula>. By conservation of the probability after such an event we have<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e281" xlink:type="simple"/><label>(11)</label></disp-formula>with the boundary conditions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e282" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e283" xlink:type="simple"/></inline-formula>. We obtain therefore<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e284" xlink:type="simple"/><label>(12)</label></disp-formula>Thus the probability that the population stemming from one single mutant will survive is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e285" xlink:type="simple"/><label>(13)</label></disp-formula>In the bulk, the only possible events are the replacement of a mutant by a wildtype individual (or the opposite), which take place with the same probability. Thus the size of an isolated mutant population in the bulk undergoes a critical branching process in the presence of an infinite reservoir of wildtype individuals, and its survival probability vanishes.</p>
      </sec>
      <sec id="s4c">
        <title>Heuristic derivation of the differential equation for the surfing probability</title>
        <p>Here, we provide a heuristic rational for the differential equation (3) for the surfing probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e286" xlink:type="simple"/></inline-formula>. Let us consider the introduction of a mutant at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e287" xlink:type="simple"/></inline-formula> and position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e288" xlink:type="simple"/></inline-formula>. We denote the probability to find a mutant at a position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e289" xlink:type="simple"/></inline-formula> and at a later time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e290" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e291" xlink:type="simple"/></inline-formula>. Now, let us place ourselves in the conditions in which</p>
        <list list-type="bullet">
          <list-item>
            <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e292" xlink:type="simple"/></inline-formula> is close to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e293" xlink:type="simple"/></inline-formula>, so that the average mutant population is not yet very large. In this case, the wildtype profile <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e294" xlink:type="simple"/></inline-formula> is not yet perturbed by the mutants, and in particular, it is steady in the moving frame, i.e., in the frame that goes at the same velocity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e295" xlink:type="simple"/></inline-formula> as the wildtype wave: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e296" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e297" xlink:type="simple"/></inline-formula> is the initial average profile of the wildtype wave.</p>
          </list-item>
          <list-item>
            <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e298" xlink:type="simple"/></inline-formula> is so small that, most of the time, mutants will disappear from the front.</p>
          </list-item>
        </list>
        <p>In this case, if we find a mutant at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e299" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e300" xlink:type="simple"/></inline-formula>, its situation is essentially the same as if it had just been introduced in a wave consisting only of wildtype individuals, since <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e301" xlink:type="simple"/></inline-formula> and since, if there are other mutants in the wave at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e302" xlink:type="simple"/></inline-formula>, they will probably not perturb its dynamics. Indeed, for small <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e303" xlink:type="simple"/></inline-formula>, other mutants will disappear, in most realizations, before getting a chance to interact effectively with the mutant we consider. Therefore, for this mutant at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e304" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e305" xlink:type="simple"/></inline-formula>, the probability to fix is by definition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e306" xlink:type="simple"/></inline-formula>.</p>
        <p>We may therefore decompose the probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e307" xlink:type="simple"/></inline-formula> as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e308" xlink:type="simple"/><label>(14)</label></disp-formula>However, this formula is an overestimate of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e309" xlink:type="simple"/></inline-formula>. Rare realizations in which two mutants are present at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e310" xlink:type="simple"/></inline-formula>, and in which the issues of both survive, should be counted as one single fixation event, but are in fact double-counted by the formula (14). Therefore, we expect a negative correction of order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e311" xlink:type="simple"/></inline-formula> when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e312" xlink:type="simple"/></inline-formula> becomes larger.</p>
        <p>If, however, we neglect for the moment this correction, differentiating equation (14) with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e313" xlink:type="simple"/></inline-formula> leads to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e314" xlink:type="simple"/><label>(15)</label></disp-formula>Notice that, in fact, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e315" xlink:type="simple"/></inline-formula>. Since the mutant population is not very large at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e316" xlink:type="simple"/></inline-formula>, we can neglect the term <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e317" xlink:type="simple"/></inline-formula> in equation (7), and replace <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e318" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e319" xlink:type="simple"/></inline-formula>. Therefore, in the frame moving with the velocity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e320" xlink:type="simple"/></inline-formula> of the wave, equation (7) becomes, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e321" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e322" xlink:type="simple"/><label>(16)</label></disp-formula>Upon substituting this expression of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e323" xlink:type="simple"/></inline-formula> in equation (15), integrating by parts, and noticing that the equation is valid for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e324" xlink:type="simple"/></inline-formula>, we obtain the necessary condition<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e325" xlink:type="simple"/><label>(17)</label></disp-formula></p>
        <p>Because of the assumptions that were used in its derivation, this equation is only valid when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e326" xlink:type="simple"/></inline-formula> is small, i.e., close to the bulk of the wave. However, far ahead of the front, equation (17) does <italic>not</italic> predict the observed saturation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e327" xlink:type="simple"/></inline-formula> at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e328" xlink:type="simple"/></inline-formula>. We attribute this to the fact that we neglected corrections of order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e329" xlink:type="simple"/></inline-formula>. Therefore, we may add a <italic>phenomenological</italic> non-linear term to equation (17):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e330" xlink:type="simple"/><label>(18)</label></disp-formula>This term leaves equation (17) unchanged when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e331" xlink:type="simple"/></inline-formula> is small, but leads to the correct saturation at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e332" xlink:type="simple"/></inline-formula> far from the front.</p>
      </sec>
      <sec id="s4d">
        <title>Analysis of the substitution rate</title>
        <p>Our analysis of the substitution rate starts from the observation that the integrand in the expression for the substitution rate in equation (4) has mainly support in the region where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e333" xlink:type="simple"/></inline-formula> decays exponentially, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e334" xlink:type="simple"/></inline-formula> increases exponentially, see <xref ref-type="fig" rid="pcbi-1002447-g001">Figure 1</xref>. This reflects the tradeoff between high population density (required for the production of mutations) and high surfing probability (required for the fixation of mutations) that determines the substitution process. In the regions that significantly contribute to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e335" xlink:type="simple"/></inline-formula>, we may thus approximate the wild type wave profile by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e336" xlink:type="simple"/><label>(19)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e337" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e338" xlink:type="simple"/></inline-formula> otherwise. Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e339" xlink:type="simple"/></inline-formula> is the actual speed observed for the wild type wave. Secondly, we approximate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e340" xlink:type="simple"/></inline-formula> by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e341" xlink:type="simple"/><label>(20)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e342" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e343" xlink:type="simple"/></inline-formula> otherwise. Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e344" xlink:type="simple"/></inline-formula> is the deterministic speed of a mutant wave.</p>
        <p>Using these exponential approximations, we can estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e345" xlink:type="simple"/></inline-formula> as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e346" xlink:type="simple"/><label>(21)</label></disp-formula>Equation (21) is hard to evaluate for general <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e347" xlink:type="simple"/></inline-formula> and selection strength. However, one can derive an asymptotically correct expression for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e348" xlink:type="simple"/></inline-formula> in the limit of large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e349" xlink:type="simple"/></inline-formula> for fixed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e350" xlink:type="simple"/></inline-formula>, where the exponential approximation is the leading order description of the wave profile <xref ref-type="bibr" rid="pcbi.1002447-Brunet1">[22]</xref>. In this limit, the equation for the survival probability describes a Fisher wave running in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e351" xlink:type="simple"/></inline-formula> direction with a cutoff far in the tip of the wave, as discussed after Eq. (3). The cutoff (due to the net growth rate being proportional to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e352" xlink:type="simple"/></inline-formula> in (3)) has the effect of lowering the wave speed from the deterministic value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e353" xlink:type="simple"/></inline-formula> to the wildtype value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e354" xlink:type="simple"/></inline-formula>. With the cut-off at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e355" xlink:type="simple"/></inline-formula> one obtains an asymptotic wave speed of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e356" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002447-Brunet1">[22]</xref>. For this lowered wave speed to equal the wildtype speed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e357" xlink:type="simple"/></inline-formula>, we find<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e358" xlink:type="simple"/><label>(22)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e359" xlink:type="simple"/><label>(23)</label></disp-formula>where the last equation holds for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e360" xlink:type="simple"/></inline-formula>. Since we have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e361" xlink:type="simple"/></inline-formula> in the limit <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e362" xlink:type="simple"/></inline-formula>, we can now express (21) in terms of our model parameters, obtaining<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e363" xlink:type="simple"/><label>(24)</label></disp-formula>which holds for small <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e364" xlink:type="simple"/></inline-formula>. Notice that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e365" xlink:type="simple"/></inline-formula> is characterized by an essential singularity for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e366" xlink:type="simple"/></inline-formula>, which causes very small substitution rates for small <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e367" xlink:type="simple"/></inline-formula>, indicating that selection is very inefficient at advancing fronts.</p>
        <p>Our analysis neglected so far the effects of a finite carrying capacity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e368" xlink:type="simple"/></inline-formula>. We can account for finite <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e369" xlink:type="simple"/></inline-formula> to leading order by taking advantage of known results for noisy traveling waves, i.e., the fact that to leading order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e370" xlink:type="simple"/></inline-formula> is given by <xref ref-type="bibr" rid="pcbi.1002447-Brunet1">[22]</xref><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e371" xlink:type="simple"/><label>(25)</label></disp-formula>Inserting this expression in (22) yields a substitution rate of<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e372" xlink:type="simple"/><label>(26)</label></disp-formula>In <xref ref-type="fig" rid="pcbi-1002447-g007">Figure 7</xref>, we plot the theoretical predictions for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e373" xlink:type="simple"/></inline-formula> vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e374" xlink:type="simple"/></inline-formula>, while simulation data are shown in <xref ref-type="fig" rid="pcbi-1002447-g006">Figure 6</xref>. Notice that the expression with finite <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e375" xlink:type="simple"/></inline-formula> stays far below the deterministic limit for any reasonable value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e376" xlink:type="simple"/></inline-formula>, which results in a non-trivial power law dependence on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e377" xlink:type="simple"/></inline-formula>. From the expression in (26), it is clear that the effect of a finite carrying capacity is important unless <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e378" xlink:type="simple"/></inline-formula>, which requires extremely large populations for reasonable selection coefficients. In the opposite quasi-neutral case, the expression for lead <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e379" xlink:type="simple"/></inline-formula> reduces to the position of the cutoff in a noisy Fisher wave, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e380" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002447-Brunet1">[22]</xref>.</p>
        <fig id="pcbi-1002447-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002447.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Theoretical approximations for the substitution rate at the front of an advancing population for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e381" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e382" xlink:type="simple"/></inline-formula>.</title>
            <p>The red curve represents the deterministic approximation (24), the blue curve corresponds to the approximation in (26), which accounts for the leading order effects of a finite carrying capacity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e383" xlink:type="simple"/></inline-formula>. Notice the large enhancement of the substitution rate due to a finite (even if large) value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002447.e384" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002447.g007" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
  </body>
  <back>
    <ack>
      <p>This work was done during RL's internship at the Laboratoire Physico-Chimie Curie, UMR 168, Institut Curie, Paris. It was started during a visit by the authors at the Kavli Institute for Theoretical Physics, University of California at Santa Barbara, during the program VIRAL11. The authors are grateful to the organizers and the host of the program to have made our collaboration possible.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002447-Excoffier1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Excoffier</surname><given-names>L</given-names></name><name name-style="western"><surname>Ray</surname><given-names>N</given-names></name></person-group>             <year>2008</year>             <article-title>Surfing during population expansions promotes genetic revolutions and structuration.</article-title>             <source>Trends Ecol Evol</source>             <volume>23</volume>             <fpage>347</fpage>             <lpage>351</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Excoffier2">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Excoffier</surname><given-names>L</given-names></name><name name-style="western"><surname>Foll</surname><given-names>M</given-names></name><name name-style="western"><surname>Petit</surname><given-names>R</given-names></name></person-group>             <year>2009</year>             <article-title>Genetic consequences of range expansions.</article-title>             <source>Ann Rev Ecol Evol S</source>             <volume>40</volume>             <fpage>481</fpage>             <lpage>501</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Fisher1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fisher</surname><given-names>RA</given-names></name></person-group>             <year>1937</year>             <article-title>The wave of advance of advantageous genes.</article-title>             <source>Ann Eugenic</source>             <volume>7</volume>             <fpage>355</fpage>             <lpage>369</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Hallatschek1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hallatschek</surname><given-names>O</given-names></name><name name-style="western"><surname>Nelson</surname><given-names>DR</given-names></name></person-group>             <year>2008</year>             <article-title>Gene surfing in expanding populations.</article-title>             <source>Theor Popul Biol</source>             <volume>73</volume>             <fpage>158</fpage>             <lpage>170</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Edmonds1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Edmonds</surname><given-names>CA</given-names></name><name name-style="western"><surname>Lillie</surname><given-names>AS</given-names></name><name name-style="western"><surname>Cavalli-Sforza</surname><given-names>LL</given-names></name></person-group>             <year>2004</year>             <article-title>Mutations arising in the wave front of an expanding population.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>101</volume>             <fpage>975</fpage>             <lpage>979</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Klopfstein1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Klopfstein</surname><given-names>S</given-names></name><name name-style="western"><surname>Currat</surname><given-names>M</given-names></name><name name-style="western"><surname>Excoffier</surname><given-names>L</given-names></name></person-group>             <year>2006</year>             <article-title>The fate of mutations surfing on the wave of a range expansion.</article-title>             <source>Mol Biol Evol</source>             <volume>23</volume>             <fpage>482</fpage>             <lpage>490</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Hallatschek2">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hallatschek</surname><given-names>O</given-names></name><name name-style="western"><surname>Hersen</surname><given-names>P</given-names></name><name name-style="western"><surname>Ramanathan</surname><given-names>S</given-names></name><name name-style="western"><surname>Nelson</surname><given-names>D</given-names></name></person-group>             <year>2007</year>             <article-title>Genetic drift at expanding frontiers promotes gene segregation.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>19926</fpage>             <lpage>19930</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Hallatschek3">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hallatschek</surname><given-names>O</given-names></name><name name-style="western"><surname>Nelson</surname><given-names>D</given-names></name></person-group>             <year>2010</year>             <article-title>Life at the front of an expanding population.</article-title>             <source>Evolution</source>             <volume>64</volume>             <fpage>193</fpage>             <lpage>206</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Travis1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Travis</surname><given-names>JMJ</given-names></name><name name-style="western"><surname>Münkemüller</surname><given-names>T</given-names></name><name name-style="western"><surname>Burton</surname><given-names>OJ</given-names></name><name name-style="western"><surname>Best</surname><given-names>A</given-names></name><name name-style="western"><surname>Dytham</surname><given-names>C</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Deleterious mutations can surf to high densities on the wave front of an expanding population.</article-title>             <source>Mol Biol Evol</source>             <volume>24</volume>             <fpage>2334</fpage>             <lpage>2343</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Miller1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Miller</surname><given-names>J</given-names></name></person-group>             <year>2010</year>             <article-title>Survival of mutations arising during invasions.</article-title>             <source>Evol Appl</source>             <volume>3</volume>             <fpage>109</fpage>             <lpage>121</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Burton1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Burton</surname><given-names>OJ</given-names></name><name name-style="western"><surname>Travis</surname><given-names>JMJ</given-names></name></person-group>             <year>2008</year>             <article-title>Landscape structure and boundary e_ects determine the fate of mutations occurring during range expansions.</article-title>             <source>Heredity</source>             <volume>101</volume>             <fpage>329</fpage>             <lpage>340</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Mnkemller1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Münkemüller</surname><given-names>T</given-names></name><name name-style="western"><surname>Travis</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Burton</surname><given-names>OJ</given-names></name><name name-style="western"><surname>Schiffers</surname><given-names>K</given-names></name><name name-style="western"><surname>Johst</surname><given-names>K</given-names></name></person-group>             <year>2011</year>             <article-title>Density-regulated population dynamics and conditional dispersal alter the fate of mutations occurring at the front of an expanding population.</article-title>             <source>Heredity</source>             <volume>106</volume>             <fpage>678</fpage>             <lpage>689</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Shine1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shine</surname><given-names>R</given-names></name><name name-style="western"><surname>Brown</surname><given-names>GP</given-names></name><name name-style="western"><surname>Phillips</surname><given-names>BL</given-names></name></person-group>             <year>2011</year>             <article-title>An evolutionary process that assembles phenotypes through space rather than through time.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>108</volume>             <fpage>5708</fpage>             <lpage>5711</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Lachmuth1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lachmuth</surname><given-names>S</given-names></name><name name-style="western"><surname>Durka</surname><given-names>W</given-names></name><name name-style="western"><surname>Schurr</surname><given-names>FM</given-names></name></person-group>             <year>2011</year>             <article-title>Differentiation of reproductive and competitive ability in the invaded range of Senecio inaequidens: the role of genetic Allee effects, adaptive and nonadaptive evolution.</article-title>             <source>New Phytol</source>             <volume>192</volume>             <fpage>529</fpage>             <lpage>541</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Brown1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>G</given-names></name><name name-style="western"><surname>Shilton</surname><given-names>C</given-names></name><name name-style="western"><surname>Phillips</surname><given-names>B</given-names></name><name name-style="western"><surname>Shine</surname><given-names>R</given-names></name></person-group>             <year>2007</year>             <article-title>Invasion, stress, and spinal arthritis in cane toads.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>17698</fpage>             <lpage>17700</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Moreau1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Moreau</surname><given-names>C</given-names></name><name name-style="western"><surname>Bhérer</surname><given-names>C</given-names></name><name name-style="western"><surname>Vézina</surname><given-names>H</given-names></name><name name-style="western"><surname>Jomphe</surname><given-names>M</given-names></name><name name-style="western"><surname>Labuda</surname><given-names>D</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Deep human genealogies reveal a selective advantage to be on an expanding wave front.</article-title>             <source>Science</source>             <volume>334</volume>             <fpage>1148</fpage>             <lpage>1150</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-VanBocxlaer1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Van Bocxlaer</surname><given-names>I</given-names></name><name name-style="western"><surname>Loader</surname><given-names>S</given-names></name><name name-style="western"><surname>Roelants</surname><given-names>K</given-names></name><name name-style="western"><surname>Biju</surname><given-names>S</given-names></name><name name-style="western"><surname>Menegon</surname><given-names>M</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Gradual adaptation toward a range-expansion phenotype initiated the global radiation of toads.</article-title>             <source>Science</source>             <volume>327</volume>             <fpage>679</fpage>             <lpage>682</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Kimura1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kimura</surname><given-names>M</given-names></name><name name-style="western"><surname>Weiss</surname><given-names>GH</given-names></name></person-group>             <year>1964</year>             <article-title>The stepping stone model of population structure and the decrease of genetic correlation with distance.</article-title>             <source>Genetics</source>             <volume>49</volume>             <fpage>561</fpage>             <lpage>576</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Haldane1">
        <label>19</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Haldane</surname><given-names>J</given-names></name></person-group>             <year>1927</year>             <article-title>A mathematical theory of natural and artificial selection, Part V: Selection and mutation.</article-title>             <publisher-name>Math. Proc. Cambridge Phil. Soc. Cambridge University Press, volume 23</publisher-name>             <fpage>838</fpage>             <lpage>844</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Hallatschek4">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hallatschek</surname><given-names>O</given-names></name></person-group>             <year>2011</year>             <article-title>The noisy edge of traveling waves.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>108</volume>             <fpage>1783</fpage>             <lpage>1787</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Harris1">
        <label>21</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Harris</surname><given-names>TE</given-names></name></person-group>             <year>2002</year>             <source>The theory of branching processes</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Dover Publications</publisher-name>             <comment>. Reprint. Originally published by Springer Verlag, 1963</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Brunet1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brunet</surname><given-names>E</given-names></name><name name-style="western"><surname>Derrida</surname><given-names>B</given-names></name></person-group>             <year>1997</year>             <article-title>Shift in the velocity of a front due to a cutoff.</article-title>             <source>Phys Rev E</source>             <volume>56</volume>             <fpage>2597</fpage>             <lpage>2604</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Sniegowski1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sniegowski</surname><given-names>P</given-names></name><name name-style="western"><surname>Gerrish</surname><given-names>P</given-names></name></person-group>             <year>2010</year>             <article-title>Beneficial mutations and the dynamics of adaptation in asexual populations.</article-title>             <source>Philos T Roy Soc B</source>             <volume>365</volume>             <fpage>1255</fpage>             <lpage>1263</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Allee1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Allee</surname><given-names>W</given-names></name></person-group>             <year>1931</year>             <article-title>Co-operation among animals.</article-title>             <source>Am J  Sociol</source>             <fpage>386</fpage>             <lpage>398</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-Murray1">
        <label>25</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Murray</surname><given-names>JD</given-names></name></person-group>             <year>2007</year>             <source>Mathematical Biology: I. An Introduction. 3rd edition</source>             <publisher-loc>Berlin</publisher-loc>             <publisher-name>Springer</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002447-vanKampen1">
        <label>26</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>van Kampen</surname><given-names>NG</given-names></name></person-group>             <year>2007</year>             <source>Stochastic Processes in Physics and Chemistry. 3rd edition</source>             <publisher-loc>Amsterdam</publisher-loc>             <publisher-name>North Holland</publisher-name>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>