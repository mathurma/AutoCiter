<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">10-PLCB-RA-2880</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002098</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Genomics</subject>
              <subj-group>
                <subject>Genome analysis tools</subject>
                <subj-group>
                  <subject>Transcriptomes</subject>
                </subj-group>
              </subj-group>
              <subj-group>
                <subject>Functional genomics</subject>
                <subject>Genome expression analysis</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Regulatory networks</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Developmental biology</subject>
            <subj-group>
              <subject>Embryology</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genetics</subject>
            <subj-group>
              <subject>Gene expression</subject>
              <subj-group>
                <subject>DNA transcription</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Gene function</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Computer modeling</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Computational Biology</subject>
          <subject>Computer Science</subject>
          <subject>Developmental Biology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Automatic Annotation of Spatial Expression Patterns via Sparse Bayesian Factor Models</article-title><alt-title alt-title-type="running-head">Spatial Expression Pattern Annotation</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Pruteanu-Malinici</surname>
            <given-names>Iulian</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Mace</surname>
            <given-names>Daniel L.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Ohler</surname>
            <given-names>Uwe</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Institute for Genome Sciences and Policy, Duke University, Durham, North Carolina, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>University of Washington, Seattle, Washington, United States of America</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Bader</surname>
            <given-names>Joel S.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Johns Hopkins University, United States of America</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">uwe.ohler@duke.edu</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: IPM DLM UO. Performed the experiments: IPM. Analyzed the data: IPM UO. Contributed reagents/materials/analysis tools: DLM. Wrote the paper: IPM UO.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>7</month>
        <year>2011</year>
      </pub-date><pub-date pub-type="epub">
        <day>21</day>
        <month>7</month>
        <year>2011</year>
      </pub-date><volume>7</volume><issue>7</issue><elocation-id>e1002098</elocation-id><history>
        <date date-type="received">
          <day>23</day>
          <month>9</month>
          <year>2010</year>
        </date>
        <date date-type="accepted">
          <day>8</day>
          <month>5</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Pruteanu-Malinici et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Advances in reporters for gene expression have made it possible to document and quantify expression patterns in 2D–4D. In contrast to microarrays, which provide data for many genes but averaged and/or at low resolution, images reveal the high spatial dynamics of gene expression. Developing computational methods to compare, annotate, and model gene expression based on images is imperative, considering that available data are rapidly increasing. We have developed a sparse Bayesian factor analysis model in which the observed expression diversity of among a large set of high-dimensional images is modeled by a small number of hidden common factors. We apply this approach on embryonic expression patterns from a <italic>Drosophila</italic> RNA <italic>in situ</italic> image database, and show that the automatically inferred factors provide for a meaningful decomposition and represent common co-regulation or biological functions. The low-dimensional set of factor mixing weights is further used as features by a classifier to annotate expression patterns with functional categories. On human-curated annotations, our sparse approach reaches similar or better classification of expression patterns at different developmental stages, when compared to other automatic image annotation methods using thousands of hard-to-interpret features. Our study therefore outlines a general framework for large microscopy data sets, in which both the generative model itself, as well as its application for analysis tasks such as automated annotation, can provide insight into biological questions.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>High throughput image acquisition is a quickly increasing new source of data for problems in computational biology, such as phenotypic screens. Given the very diverse nature of imaging technology, samples, and biological questions, approaches are oftentimes very tailored and ad hoc to a specific data set. In particular, the image-based genome scale profiling of gene expression patterns via approaches like <italic>in situ</italic> hybridization requires the development of accurate and automatic image analysis systems for understanding regulatory networks and development of multicellular organisms. Here, we present a computational method for automated annotation of <italic>Drosophila</italic> gene expression images. This framework allows us to extract, identify and compare spatial expression patterns, of essence for higher organisms. Based on a sparse feature extraction technique, we successfully cluster and annotate expression patterns with high reliability, and show that the model represents a “vocabulary” of basic patterns reflecting common function or regulation.</p>
      </abstract><funding-group><funding-statement>Funding for this work was provided by the National Institutes of Health (P50-GM081883) and the National Science Foundation (DBI-0953184) to U.O. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="16"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Detailed knowledge of the precise location and time span of gene expression is mandatory to deciphering dynamic cellular mechanisms. The application of microarray technology has led to genome-wide quantitative overviews of the relative changes of transcript levels in many organisms (such as <italic>Drosophila</italic> embryonic development <xref ref-type="bibr" rid="pcbi.1002098-Arbeitman1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1002098-Tomancak1">[4]</xref>), but these rarely provide spatial information. In contrast, microscopy of colored or fluorescent probes, followed by imaging, is able to deliver spatial quantitative phenotype information such as gene expression at high resolution <xref ref-type="bibr" rid="pcbi.1002098-Ljosa1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1002098-Walter1">[6]</xref>. For instance, RNA <italic>in situ</italic> hybridization localizes specific mRNA sequences by hybridizing complementary mRNA-binding oligonucleotides and a suitable dye <xref ref-type="bibr" rid="pcbi.1002098-Tautz1">[7]</xref>. This approach has been used as part of large scale compendia of gene expression in <italic>Drosophila</italic> embryos <xref ref-type="bibr" rid="pcbi.1002098-Tomancak1">[4]</xref>,  and the adult mouse brain <xref ref-type="bibr" rid="pcbi.1002098-Carson1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1002098-Lein1">[10]</xref>.</p>
      <p>Available image data therefore constitute a repertoire of distinctive spatial expression patterns, allowing us to obtain significant insights on gene regulation during development or in complex organs. One of the fastest growing expression pattern data collections is the Berkeley <italic>Drosophila</italic> Genome Project RNA <italic>in situ</italic> hybridization database <xref ref-type="bibr" rid="pcbi.1002098-Tomancak2">[8]</xref>), which contains annotations of spatial expression patterns using a controlled vocabulary, following the example of the Gene Ontology (GO) <xref ref-type="bibr" rid="pcbi.1002098-Ashburner1">[11]</xref>. The annotation terms integrate the spatial gene expression dimensions of a developing “path” from the cellular blastoderm stage until organs are formed. Over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e001" xlink:type="simple"/></inline-formula> images for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e002" xlink:type="simple"/></inline-formula> genes have thus been manually acquired, curated and annotated <xref ref-type="bibr" rid="pcbi.1002098-Tomancak1">[4]</xref>. Due to the complex nature of the task, these <italic>Drosophila</italic> images were manually annotated by human experts.</p>
      <p>Automatic image annotation systems are fairly routinely used in cell-based assays, <italic>e.g.</italic> for the classification of protein subcellular localization in budding yeast <xref ref-type="bibr" rid="pcbi.1002098-Chen1">[12]</xref>. The increasing number of expression images for complex organisms has motivated the design of computational methods to automate these analyses <xref ref-type="bibr" rid="pcbi.1002098-Kumar1">[13]</xref>. In general, this requires solving two sub-problems: identifying objects in a potentially noisy image and normalizing the morphology of the objects, followed by analysis on the actual expression patterns. Typically, studies have focused on the task to recapitulate the expert-provided annotation, based on bottom-up approaches utilizing large sets of low-level features extracted from the images. For instance, Ji <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002098-Ji1">[14]</xref> proposed a bag-of-words scheme in which invariant visual features were first extracted from local patches on the images, followed by a feature quantization based on precomputed “visual codebooks” and finally classification. Peng <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002098-Peng1">[15]</xref> developed an automatic image annotation framework using three different feature representations (based on Gaussian Mixture Models, Principal Component Analysis (PCA) and wavelet functions) and several classifiers, including Linear Discriminant Analysis (LDA), Support Vector Machines (SVM) and Quadratic Discriminant Analysis (QDA). Heffel <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002098-Heffel1">[16]</xref> proposed an embryo outline extraction and transformation and conversion to Fourier coefficients-based feature representation.</p>
      <p>One potential drawback of the above mentioned approaches is the high dimensional and complex feature space (thousands of features per image) which implies a potential for high redundancy and computational difficulties. In contrast to such large feature sets, a spatial expression pattern typically consists of a limited number of discrete domains, defined by a small set of upstream regulatory factors. As an alternative, Frise <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002098-Frise1">[17]</xref> therefore set out to identify a concise set of basic expression patterns in <italic>Drosophila</italic>. Starting with an unsupervised clustering approach on a manually selected small set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e003" xlink:type="simple"/></inline-formula> distinct images, the clusters were extended to a broader data set comprising <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e004" xlink:type="simple"/></inline-formula> lateral views of early development through a binary SVM classification. This pipeline revealed a set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e005" xlink:type="simple"/></inline-formula> well defined clusters describing specific regions of expression with good correspondence to developmental structures and shared biological functions of the genes within clusters. While the authors gave many individual examples for the possible meaning of clusters, they did not use them in further applications to annotate patterns or infer regulatory relationships. As with most of the described approaches, the study involved significant human intervention, which generally includes manual selection of “good” images for training, clustering, and/or evaluation: selection of a subset of viewpoints (images show different embryo orientations, <italic>e.g.</italic> lateral or dorsal/ventral), or selection of successfully registered images only. While this may lead to highly encouraging results, the significant work for manual image selection represents a potential shortcoming, considering that available data are rapidly increasing and an automatic computational method is essential.</p>
      <p>We here propose a new approach to close the gap between the feature-oriented approaches for pattern annotation, and the identification of expression domains to gain functional insights. The central part is the application of sparse Bayesian factor analysis (sBFA), which describes a large number of observed variables (image features) by linear combinations of a much smaller number of unobserved variables (factors). This framework aims at explaining the variability of the original high dimensional feature space by a much smaller set of latent factors, through a completely unsupervised process. [Note that the mathematical usage of the word “factor” is distinct from its biological meaning]. It can also be seen as a clustering method, where samples belong to different clusters, based on their corresponding linear combination mixing weights. Another advantage of the sBFA model is that any information about the underlying structure can be easily incorporated through priors <xref ref-type="bibr" rid="pcbi.1002098-Pournara1">[18]</xref>; for instance, we here use a sparseness prior placed on the number of factors used to “reconstruct” each image.</p>
      <p>Using such sparse Bayesian approaches we identify a basic expression vocabulary directly from the image data, and show that this small subset of features is highly interpretable in terms of biological function or co-regulation. This vocabulary is then used for gene annotation with performance comparable or exceeding current systems, and stability when applied on the complete and noisy data set, without any human intervention or selection of “representative” images. The top-down generative nature of this approach (rather than traditional bottom-up approaches) also promises high utility in other application areas, by integrating the model with various information on gene expression and regulation.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <p>Our study describes the application of an sBFA framework for gene expression pattern annotation. The model converts every segmented image of a <italic>Drosophila</italic> embryo into a sparse feature representation of the spatial gene expression pattern, suitable for downstream quantitative analysis based on widely used classifiers. This technique is fully automatic, and not specific to any data or feature set. In the analysis presented here, we employ factor models where data (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e006" xlink:type="simple"/></inline-formula>) are modeled by a linear combination of factors (rows of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e007" xlink:type="simple"/></inline-formula>) given the corresponding mixing weights (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e008" xlink:type="simple"/></inline-formula>) and some additive Gaussian noise (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e009" xlink:type="simple"/></inline-formula>) while sparseness is promoted on the factor loading matrix (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e010" xlink:type="simple"/></inline-formula>). The model jointly infers both the factors and the mixing weights; we can then analyze the factors regarding their representation of biological concepts, and use the mixing weights for analysis tasks such as automatic annotation.</p>
      <sec id="s2a">
        <title><italic>Drosophila</italic> image data sets</title>
        <p>One of the most popular data sets to explore the use of image expression data is the Berkeley <italic>Drosophila</italic> Genome Project (BDGP) data set. It consists of over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e011" xlink:type="simple"/></inline-formula> images which document embryonic expression patterns for over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e012" xlink:type="simple"/></inline-formula> of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e013" xlink:type="simple"/></inline-formula> protein-coding genes identified in the <italic>Drosophila melanogaster</italic> genome. A gene's expression pattern can be reflected in the accumulation of its product in subsets of cells as embryonic development progresses. In this case, the patterns of mRNA expression were studied by RNA <italic>in situ</italic> hybridization, which has the potential to reveal the spatial aspects of gene expression during development at genome-wide scale. The RNA <italic>in situ</italic> hybridization used digoxygenin-labeled RNA probes derived primarily from sequenced cDNAs to visualize gene expression patterns and documented them by digital microscopy. For each expressed gene, representative low and high magnification images were captured at key developmental stages. These developmental stages clearly define emerging embryonic structures such as gastrulation, midblastula transition and organogenesis onset. For practical reasons, the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e014" xlink:type="simple"/></inline-formula> hours of <italic>Drosophila</italic> development, spanning embryonic stages<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e015" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e016" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e017" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e018" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e019" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e020" xlink:type="simple"/></inline-formula>, were chosen for analysis, as this interval is manageable in terms of data annotation. As examples, stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e021" xlink:type="simple"/></inline-formula> are associated with the time interval 1h20min–3h, while the later developmental stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e022" xlink:type="simple"/></inline-formula> occur between 5h20min–9h20min.</p>
        <p>Genes are annotated with ontology terms from a controlled vocabulary describing developmental expression patterns (<italic>cf.</italic> <xref ref-type="bibr" rid="pcbi.1002098-Ashburner1">[11]</xref>). Any gene is thus associated to one or multiple terms, and often represented by more than one image. Images can display non-informative patterns due to poor quality staining/washing, and a gene can show distinct and different expression patterns due to different embryo orientations or the relatively long developmental time spanned by a stage range. Images with lateral orientation have now been annotated as such, information not available until recently.</p>
        <p>As proof of concept, the model is demonstrated on a variety of images, covering two distinct developmental stage ranges (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e023" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e024" xlink:type="simple"/></inline-formula>) and multiple orientations (lateral, dorsal/ventral). The first data set (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e025" xlink:type="simple"/></inline-formula>) includes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e026" xlink:type="simple"/></inline-formula> genes (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e027" xlink:type="simple"/></inline-formula> images) with arbitrary orientation (mostly lateral and dorsal/ventral), acquired during the time window of developmental stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e028" xlink:type="simple"/></inline-formula>. The second data set (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e029" xlink:type="simple"/></inline-formula>) covers a subset of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e030" xlink:type="simple"/></inline-formula> genes (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e031" xlink:type="simple"/></inline-formula> images) restricted to lateral views; we used this smaller data set to evaluate the effect of integrating images from multiple views, and to be able to compare against earlier approaches which were frequently applied on lateral views only. Genes in these two sets were annotated with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e032" xlink:type="simple"/></inline-formula> non-trivial terms (i.e. excluding no or ubiquitous expression). The third data set (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e033" xlink:type="simple"/></inline-formula>) covers <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e034" xlink:type="simple"/></inline-formula> genes (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e035" xlink:type="simple"/></inline-formula> images) with arbitrary orientation from the later developmental stage range <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e036" xlink:type="simple"/></inline-formula>. At this point, the problem is complicated by the more developed embryo morphology, which gives rise to intricate spatial expression patterns. Consequently, genes in this set were annotated with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e037" xlink:type="simple"/></inline-formula> unique non-trivial terms. The last data set (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e038" xlink:type="simple"/></inline-formula>) contains <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e039" xlink:type="simple"/></inline-formula> manually selected genes from data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e040" xlink:type="simple"/></inline-formula> as used in a previous study <xref ref-type="bibr" rid="pcbi.1002098-Peng1">[15]</xref>, comprising <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e041" xlink:type="simple"/></inline-formula> images with lateral view only.</p>
        <p>The image registration process used throughout this paper was previously introduced by Mace <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002098-Mace1">[19]</xref> in which individual embryos were extracted and rotated in an automatic fashion. We then scaled the registered images to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e042" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e043" xlink:type="simple"/></inline-formula> pixel resolution and extracted grid-based features by calculating the mean pixel value within each patch. Details can be found in the “<xref ref-type="sec" rid="s4">Materials and Methods</xref>” section.</p>
      </sec>
      <sec id="s2b">
        <title>Factor inference and decomposition of expression patterns</title>
        <p>To illustrate the potential of a sparse set of factors to represent complex expression patterns, we started with data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e044" xlink:type="simple"/></inline-formula>. We evaluated different values for the number of factors in the model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e045" xlink:type="simple"/></inline-formula>) and different resolution – <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e046" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e047" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e048" xlink:type="simple"/></inline-formula> factors for grid sizes of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e049" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e050" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e051" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e052" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e053" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e054" xlink:type="simple"/></inline-formula>, respectively. Representative images (original, grid-based, and reconstructed factor-based) for the annotation terms with the highest number of associated genes are shown in <xref ref-type="fig" rid="pcbi-1002098-g001">Figure 1</xref>. While the resulting images are somewhat noisier, they clearly recapitulate the overall expression domains.</p>
        <fig id="pcbi-1002098-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Original, grid-based and reconstructed factor-based images, using the estimated factors and factor loading matrix.</title>
            <p>Selected annotation terms with the highest number of associated genes; each annotation term is represented by two of its corresponding genes (with the original, the grid-based factor-based embryo images), from the time window of developmental stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e055" xlink:type="simple"/></inline-formula>. These examples reveal that images with the same annotation term can show different orientations and quite different patterns, for instance because they are taken during a relatively large temporal window during which expression can change. In the false color display, blue color indicates strong <italic>in situ</italic> staining while red indicates no staining.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.g001" xlink:type="simple"/>
        </fig>
        <p>sBFA was successful in automatically extracting interpretable patterns based on our choice of pixel intensities as input features. <xref ref-type="fig" rid="pcbi-1002098-g002">Figure 2</xref> illustrates this for an example grid size of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e056" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e057" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e058" xlink:type="simple"/></inline-formula> factors, and the estimated sparse factor loading matrix is shown in <xref ref-type="supplementary-material" rid="pcbi.1002098.s001">Figure S1</xref>. In particular, many factors correspond to prototypical lateral view patterns along the anterior/posterior axis, reflecting the activity of the segmentation network. Others represent expression differences along the dorsal/ventral axis, and patterns from different views, showcasing the ability of the method to automatically extract distinct patterns for different embryo orientations. In addition, some factors do not represent distinct expression patterns but rather the embryo shape or lighting artifacts. While these factors certainly reflect commonalities among the input data, they show the potential of sBFA to automatically separate meaningful patterns from noise.</p>
        <fig id="pcbi-1002098-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Selected factors estimated from a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e059" xlink:type="simple"/></inline-formula> factors, for a grid size of 80×40 (data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e060" xlink:type="simple"/></inline-formula>.</title>
            <p>As factors can have negative loadings, patterns may be inverse to the <italic>in situ</italic> staining pattern. The different background colors are an artifact and not part of the model. The bordered factors are the centroids of the largest clusters, while representative occurrences of genes shared among clusters are indicated by the weighted lines.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.g002" xlink:type="simple"/>
        </fig>
        <p>Besides image reconstruction, the factor loading matrix provides for an elegant way for clustering and co-expression analysis: the factors (rows in the factor matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e061" xlink:type="simple"/></inline-formula>) represent cluster centroids and the mixing weights (entries in the factor loading matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e062" xlink:type="simple"/></inline-formula>) describe co-expression between genes. Each cluster can then be referred to through its corresponding factor. To illustrate this, we selected the entry/factor in the factor loading matrix with the highest absolute value for each gene in data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e063" xlink:type="simple"/></inline-formula>. The resulting clusters divided the expression landscape into distinct categories, defining clusters of genes with various expression patterns. Compared to Frise et al. <xref ref-type="bibr" rid="pcbi.1002098-Frise1">[17]</xref>, who illustrated the correspondence of clusters to a developmental fate map, the sBFA framework was thus able to discover highly similar expression domains and the underlying relationships among them, but with no prior manual initialization. Within the largest clusters (<xref ref-type="fig" rid="pcbi-1002098-g002">Figure 2</xref>), we noticed broadly expressed genes, anteriorly expressed genes, posteriorly expressed genes, as well as dorsal/ventral expression. We further investigated co-expression by identifying instances where two clusters shared genes (two columns in the factor loading matrix contain informative mixing weights for common genes; for informative weights, we selected all loading matrix entries within <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e064" xlink:type="simple"/></inline-formula> of the absolute highest value, in accordance with the sparsity assumption of the model). In most of the cases, linked clusters correspond to a general trend of temporally progressing gene expression, from larger expression domains to more narrowly defined spatial expression (<xref ref-type="fig" rid="pcbi-1002098-g002">Figure 2</xref>). Categorizing the factors revealed that among lateral views, a larger number of genes in the data set were expressed anteriorly and ventrally, and fewer genes posteriorly and dorsally (<xref ref-type="fig" rid="pcbi-1002098-g003">Figure 3A</xref>). Among dorsal/ventral views, most of the expressed genes have ventral view and predominantly anterior orientation.</p>
        <fig id="pcbi-1002098-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Distribution of expression patterns in Drosophila image data from stages 4–6.</title>
            <p>(A) Distribution of gene expression patterns. The height of the bars corresponds to the percentage of patterns in the indicated direction (lateral view for the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e065" xlink:type="simple"/></inline-formula> bars and dorsal/ventral view for the remaining <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e066" xlink:type="simple"/></inline-formula> bars, shaded area). Pred. D = predominantly dorsal (lateral view), Pred. V = predominantly ventral (lateral view), Pred. A = predominantly anterior (lateral view), Pred. P = predominantly posterior (lateral view), D (d/v view) = dorsal (dorsal/ventral view), V (d/v view) = ventral (dorsal/ventral view), Pred. A (d/v view) = predominantly anterior (dorsal/ventral view), Pred. P (d/v view) = predominantly posterior (dorsal/ventral view). (B) Example factor contributions. The top three rows show significant factors contributing to the original image decomposition, for lateral (anterior/posterior) and dorsal/ventral gene expressions. The bottom row corresponds to a non-informative (maternal expression only) case, where all factors share similar low weights for their image decomposition. Overall, for any given image (arbitrary orientation), factors which show that particular gene expression orientation are more likely to contribute to the image decomposition, through more informative weights.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.g003" xlink:type="simple"/>
        </fig>
        <p>As mentioned earlier, data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e067" xlink:type="simple"/></inline-formula> covered <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e068" xlink:type="simple"/></inline-formula> images with arbitrary orientation (lateral, dorsal/ventral). The inferred set of factors and factor loading matrix unveiled another important strength of the proposed framework: for any given image, factors which represent the same embryo orientation are more likely to contribute to the image decomposition, through more informative weights. As a result, estimated factors that show a clear lateral gene expression would be highly used by lateral gene expressed images in their corresponding factor linear combination; furthermore, estimated factors with dorsal/ventral expressions would be most likely used by dorsal/ventral input gene patterns. The four examples in <xref ref-type="fig" rid="pcbi-1002098-g003">Figure 3B</xref> illustrate lateral, dorsal/ventral, and non-informative expression. As expected, for non-informative maternal expression, all factors share relatively low weights in their image decomposition.</p>
        <p>As co-regulated genes are frequently co-regulated by transcription factors, we next inspected the similarities between estimated factors (matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e069" xlink:type="simple"/></inline-formula> in our model) and the FlyTF database of <italic>Drosophila</italic> site-specific transcription factors <xref ref-type="bibr" rid="pcbi.1002098-Adryan1">[20]</xref>. This database contains <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e070" xlink:type="simple"/></inline-formula> manually annotated site-specific transcription factors, identified from a list of candidate proteins with transcription-related GO annotation as well as structural DNA-binding domains assignments. Careful visual inspection revealed that a number of inferred factors were close to the expression patterns of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e071" xlink:type="simple"/></inline-formula> experimentally verified transcription factors (<xref ref-type="fig" rid="pcbi-1002098-g004">Figure 4</xref>), thus suggesting that the model factors are reflecting underlying biological functions. Moreover, the majority of the discovered similarities (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e072" xlink:type="simple"/></inline-formula> out of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e073" xlink:type="simple"/></inline-formula> cases) correspond to the top ranked factors shown in <xref ref-type="fig" rid="pcbi-1002098-g002">Figure 2</xref>.</p>
        <fig id="pcbi-1002098-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Similarities between estimated factors in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e074" xlink:type="simple"/></inline-formula> and entries in the FlyTF database.</title>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.g004" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2c">
        <title>Biological correlates of inferred factors</title>
        <p>Clusters of co-regulated genes inferred from microarray analyses have frequently been shown to reflect groups of genes with distinct functions. A popular approach is to determine enrichments of functional annotations, such as provided by the Gene Ontology, to genes within each cluster. For this aim, we selected the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e075" xlink:type="simple"/></inline-formula> absolute highest value entries from the factor loading matrix to find enriched GO biological process terms (corrected p-value<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e076" xlink:type="simple"/></inline-formula> for hypergeometric test). The early development during stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e077" xlink:type="simple"/></inline-formula> is largely centered on specifying the body axes and layout, and we thus examined the later stage data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e078" xlink:type="simple"/></inline-formula> which included a broader range of ontology terms (<xref ref-type="fig" rid="pcbi-1002098-g005">Figure 5</xref>). Compared to the stage <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e079" xlink:type="simple"/></inline-formula> analysis, we used a larger matrix with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e080" xlink:type="simple"/></inline-formula> factors to allow for the identification of a larger number of distinct patterns.</p>
        <fig id="pcbi-1002098-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Enrichment of GO terms in the biological process (GO:0009987) category, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e081" xlink:type="simple"/></inline-formula> representative factors (cluster centroids), developmental stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e082" xlink:type="simple"/></inline-formula>–<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e083" xlink:type="simple"/></inline-formula>.</title>
            <p>The level of significance of each GO term (vertical axis) is displayed as color intensity between yellow (p-value<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e084" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e085" xlink:type="simple"/></inline-formula>) and red (p-value<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e086" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e087" xlink:type="simple"/></inline-formula>), as indicated by the color bar on the left side; smaller p-values correspond to more enriched genes. The blue color corresponds to GO terms with a p-value<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e088" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e089" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.g005" xlink:type="simple"/>
        </fig>
        <p>Among the entire selection of biological process terms (GO:0009987), we found <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e090" xlink:type="simple"/></inline-formula> biological processes with significant enrichments mapping to one or more of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e091" xlink:type="simple"/></inline-formula> out of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e092" xlink:type="simple"/></inline-formula> clusters. In particular, cluster <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e093" xlink:type="simple"/></inline-formula> had a clear enrichment of genes with heart development function (GO:0007507) which agrees with the gene expression showed by the factor itself (at stage <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e094" xlink:type="simple"/></inline-formula>, heart precursors have been specified within the dorsal mesoderm). Cluster <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e095" xlink:type="simple"/></inline-formula>, with a pattern localized around the germ band, is highly enriched in germ cell migration genes (GO:0008354). Finally, cluster <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e096" xlink:type="simple"/></inline-formula> shows central/posterior development, related to the enrichment of genes with gonad development function (GO:0008406).</p>
        <p>The availability of recent genome-wide regulatory information made it possible to additionally investigate regulatory relationships between transcription factors and their target genes. Using the same clusters as for the GO enrichment analysis, we examined the agreement of factors with the “physical” regulatory network published by the modENCODE consortium <xref ref-type="bibr" rid="pcbi.1002098-Roy1">[21]</xref>). This static network was inferred from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e097" xlink:type="simple"/></inline-formula> TFs with experimentally derived binding profiles, combining chromatin immunoprecipitation data from multiple cultured cell lines with chromatin information and conserved sequence elements. It covers more than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e098" xlink:type="simple"/></inline-formula> target genes; on average, genes were targeted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e099" xlink:type="simple"/></inline-formula> TFs, with up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e100" xlink:type="simple"/></inline-formula> regulatory inputs. We carefully selected the subset of TFs with demonstrated expression during <italic>Drosophila</italic> embryogenesis as profiled in the BDGP database as well as FlyBase, and identified the significant ones for every set of genes with high value entries in the factor loading matrix (following the GO analysis described before). For developmental stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e101" xlink:type="simple"/></inline-formula>, we found <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e102" xlink:type="simple"/></inline-formula> significant TFs (corrected p-value<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e103" xlink:type="simple"/></inline-formula> for Pearson's Chi-square test) mapping to one or more of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e104" xlink:type="simple"/></inline-formula> out of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e105" xlink:type="simple"/></inline-formula> clusters (<xref ref-type="fig" rid="pcbi-1002098-g006">Figure 6</xref>). Out of these <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e106" xlink:type="simple"/></inline-formula> significant clusters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e107" xlink:type="simple"/></inline-formula> are shared with the clusters found in the GO analysis (<xref ref-type="fig" rid="pcbi-1002098-g005">Figure 5</xref>). There are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e108" xlink:type="simple"/></inline-formula> clusters that only show significant enrichments among biological functions and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e109" xlink:type="simple"/></inline-formula> clusters with solely significant TFs (shaded areas). Nevertheless, most of the clusters of interest share biological functions as well as physical regulatory relationships and illustrate a strong consistency between the two analyses.</p>
        <fig id="pcbi-1002098-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Significant transcription factors, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e110" xlink:type="simple"/></inline-formula> representative factors (cluster centroids), developmental stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e111" xlink:type="simple"/></inline-formula>–<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e112" xlink:type="simple"/></inline-formula>.</title>
            <p>The level of significance of each TFs (vertical axis) is displayed as color intensity between yellow (p-value<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e113" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e114" xlink:type="simple"/></inline-formula>) and red (p-value<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e115" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e116" xlink:type="simple"/></inline-formula>), as indicated by the color bar on the left side; smaller p-values correspond to more significant genes. The blue color corresponds to TFs with a corrected p-value<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e117" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e118" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.g006" xlink:type="simple"/>
        </fig>
        <p>Moreover, clusters with significance for both biological function and transcription regulation revealed term associations between transcription factors and biological processes currently not found in the Gene Ontology database. For instance, Trl targets (FBgn0013263) are enriched in germ cell migration (cluster <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e119" xlink:type="simple"/></inline-formula>) and heart development (cluster <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e120" xlink:type="simple"/></inline-formula>); Trl mutants have been reported to exhibit defects in oogenesis <xref ref-type="bibr" rid="pcbi.1002098-Ogienko1">[22]</xref>. Twi targets (FBgn0003900) are associated with cell adhesion (cluster <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e121" xlink:type="simple"/></inline-formula>), consistent with findings from genome wide ChIP analyses <xref ref-type="bibr" rid="pcbi.1002098-Sandmann1">[23]</xref>; a complete list with term associations between transcription factors and biological processes can be found in <xref ref-type="supplementary-material" rid="pcbi.1002098.s002">Figure S2</xref>.</p>
        <p>To put these results into context, we identified the set of modENCODE TFs enriched within the gene sets of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e122" xlink:type="simple"/></inline-formula> most frequent developmental terms of the controlled vocabulary as annotated by human experts (<xref ref-type="supplementary-material" rid="pcbi.1002098.s003">Figure S3</xref>). Among the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e123" xlink:type="simple"/></inline-formula> enriched TFs, a subset of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e124" xlink:type="simple"/></inline-formula> TFs are shared with the sBFA cluster-based transcription regulation analysis. The TFs that were only identified in the CV analysis are mostly general regulators; <italic>e.g.</italic> involved in chromatin remodeling and silencing (trx, BEAF-32, CTCF, TfllB, or CBP). These enrichments are not function-specific and therefore spurious hits. On the other hand, there are only four TFs specific to the sBFA cluster-based analysis: among them, bab1 targets (FBgn0004870) are enriched during ectoderm development, consistent with recent reports based on sequence motif analyses <xref ref-type="bibr" rid="pcbi.1002098-Jaebum1">[24]</xref>. The automatically inferred factors are therefore more enriched in specific TF targets, and lead to a cleaner and more extensive set of links between TFs, expression patterns, and biological functions.</p>
        <p>Lastly, we visually inspected similarities between spatial expression of estimated sparse model factors (cluster centroids) and corresponding TFs with significant p-values. Three example cases are shown in <xref ref-type="supplementary-material" rid="pcbi.1002098.s004">Figure S4</xref>, and they suggest that the estimated factors not only reflect biological functions but also explain correlations within the physical regulatory network.</p>
        <p>In conclusion, our method can be used to find physical/functional networks that are relevant to <italic>Drosophila</italic> embryonic developmental stages of interest. In this case, the network associated to stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e125" xlink:type="simple"/></inline-formula> appears to be a highly modular cohesive component of the full physical regulatory network introduced in <xref ref-type="bibr" rid="pcbi.1002098-Roy1">[21]</xref>; the multitude of highly significant TFs advance the hypothesis of a self-contained, highly evolvable structure.</p>
      </sec>
      <sec id="s2d">
        <title>Gene classification into developmental expression domains</title>
        <p>While gene expression data is often analyzed in an unsupervised fashion, the expert annotation of images with anatomical terms also allows for a direct evaluation whether extracted features reflect distinct biological patterns. To demonstrate the effectiveness of the sparse factor analysis in exploiting the hidden structure shared among different genes, entries in the factor loading matrix (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e126" xlink:type="simple"/></inline-formula>) were subsequently used as features by two state-of-the-art classifiers: the SVM (polynomial kernel) <xref ref-type="bibr" rid="pcbi.1002098-Burges1">[25]</xref> and a sparse multinomial logistic regression model, SMLR <xref ref-type="bibr" rid="pcbi.1002098-Krishnapuram1">[26]</xref>.</p>
        <p>In evaluating the relative performance of the classifiers for individual annotation terms, we trained binary classifiers, one for each anatomical annotation term. We only considered terms associated to more than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e127" xlink:type="simple"/></inline-formula> genes; terms with too few annotated genes were statistically too weak to be learned and evaluated effectively (for the developmental stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e128" xlink:type="simple"/></inline-formula>, this selection translated into removing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e129" xlink:type="simple"/></inline-formula> of the initial non-trivial terms mentioned before). For each of these remaining terms, the question was whether the factor loadings would be effective features to discriminate genes with a particular annotation term from those without one (to automatically identify the anatomical regions that express a gene, given a training set of annotations). We chose sparse classifiers, as some factors appeared to reflect common sources of noise (<italic>e.g.</italic> illumination differences) and should thus be uninformative for annotation. The accuracy of sBFA-based classifiers is represented by the area under the ROC curve (AUC values, <xref ref-type="bibr" rid="pcbi.1002098-Gribskov1">[27]</xref>).</p>
        <p>We started with data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e130" xlink:type="simple"/></inline-formula>, which contained 1,231 genes annotated with a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e131" xlink:type="simple"/></inline-formula> terms, and the SMLR classifier, which allows one to assess the importance of features for a classification task by the weights assigned to each feature. We first analyzed the SMLR weights <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e132" xlink:type="simple"/></inline-formula> on the entire set of features (three different resolutions with corresponding number of factors of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e133" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e134" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e135" xlink:type="simple"/></inline-formula> leading to a combined <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e136" xlink:type="simple"/></inline-formula> factors), and examined the number of times factors were selected as relevant by the SMLR algorithm during leave-one-out cross-validation (LOO-CV). During cross-validation, all images corresponding to a single gene were left out and the model was trained on the remaining set of images. A few common factors were not selected as relevant by any annotation term model, which confirmed our initial belief that some factors were uninformative for at least some annotations. In addition, there is strong consistency in factor selection, and most factors are either always or never included. <xref ref-type="fig" rid="pcbi-1002098-g007">Figure 7</xref> shows the mixing weights on the factors for two randomly selected annotation terms, as well as a histogram of the number of times each factor is selected as relevant over the entire set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e137" xlink:type="simple"/></inline-formula> trials, with a cut-off value for feature selection at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e138" xlink:type="simple"/></inline-formula>. Specifically, for the ‘amnioserosa anlage in statu nascendi’ annotation term, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e139" xlink:type="simple"/></inline-formula> factors were never selected while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e140" xlink:type="simple"/></inline-formula> were always selected.</p>
        <fig id="pcbi-1002098-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>SMLR analysis on the estimated sBFA factors on data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e141" xlink:type="simple"/></inline-formula>, for two randomly selected annotation terms.</title>
            <p>The top row shows the SMLR mixing weights on the factors, for a regularization parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e142" xlink:type="simple"/></inline-formula>; the x-axis represents the FA factors: the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e143" xlink:type="simple"/></inline-formula> factors for a grid size of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e144" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e145" xlink:type="simple"/></inline-formula>, the next <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e146" xlink:type="simple"/></inline-formula> factors for a grid size of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e147" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e148" xlink:type="simple"/></inline-formula> and the last <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e149" xlink:type="simple"/></inline-formula> factors for a grid size of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e150" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e151" xlink:type="simple"/></inline-formula>. The bottom row contains histograms with the number of factors selected as relevant over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e152" xlink:type="simple"/></inline-formula> LOO-CV trials, with a cut-off value at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e153" xlink:type="simple"/></inline-formula>. Each feature appears once in the graph. The more mass concentrated at the two ends, the more consistent the classifier is in identifying relevant factors.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.g007" xlink:type="simple"/>
        </fig>
        <p>To evaluate the success of annotation prediction, we computed AUC values achieved by the SMLR framework on data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e154" xlink:type="simple"/></inline-formula> using LOO-CV (<xref ref-type="fig" rid="pcbi-1002098-g008">Figure 8A</xref>). To assess the influence of a particular classifier, we compared the SMLR results to those achieved by polynomial SVMs. The AUC value for each annotation term was computed using majority voting across all genes (see ‘<xref ref-type="sec" rid="s4">Materials and Methods</xref>’). We see that on average, the annotation process reached similar performances with both classifiers, above <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e155" xlink:type="simple"/></inline-formula> across all terms (exception are the ‘pole cell’ and ‘ventral ectoderm anlage’ annotation terms; the ‘pole cell’ lower performance can be explained by the fact that these germline precursor cells migrate and may have little overlapping spatial expression during stage <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e156" xlink:type="simple"/></inline-formula>).</p>
        <fig id="pcbi-1002098-g008" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.g008</object-id>
          <label>Figure 8</label>
          <caption>
            <title>SMLR and SVM comparison on (A) data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e157" xlink:type="simple"/></inline-formula> and (B) data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e158" xlink:type="simple"/></inline-formula>: the AUC of individual annotation terms from the time window of developmental stages 4–6.</title>
            <p>(A) We consider two different scenarios: using the factors corresponding to the highest resolution, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e159" xlink:type="simple"/></inline-formula> (SVM-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e160" xlink:type="simple"/></inline-formula> and SMLR-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e161" xlink:type="simple"/></inline-formula>), or using the entire set of factors available (SVM-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e162" xlink:type="simple"/></inline-formula> and SMLR-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e163" xlink:type="simple"/></inline-formula>). The last <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e164" xlink:type="simple"/></inline-formula> annotation terms correspond to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e165" xlink:type="simple"/></inline-formula> genes or less, too few to count for a strong statistical evaluation (shaded area). (B) We consider two different scenarios: using the factors corresponding to the highest resolution, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e166" xlink:type="simple"/></inline-formula> (SVM-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e167" xlink:type="simple"/></inline-formula> and SMLR-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e168" xlink:type="simple"/></inline-formula>), or using the entire set of factors available (SVM-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e169" xlink:type="simple"/></inline-formula> and SMLR-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e170" xlink:type="simple"/></inline-formula>). The last <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e171" xlink:type="simple"/></inline-formula> annotation terms correspond to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e172" xlink:type="simple"/></inline-formula> genes or less, and results are less reliable due to the stronger variance and impact of results on individual samples (shaded area).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.g008" xlink:type="simple"/>
        </fig>
        <p>In the next phase, we evaluated the effect of integrating images with multiple views at early stages in <italic>Drosophila</italic> development, by running the sBFA on data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e173" xlink:type="simple"/></inline-formula>; as previously mentioned, it covers <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e174" xlink:type="simple"/></inline-formula> genes (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e175" xlink:type="simple"/></inline-formula> images) with arbitrary orientation (most lateral and dorsal/ventral). Similar to the previous case, we carefully examined different numbers of factors for different image resolutions and observed the following good matches: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e176" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e177" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e178" xlink:type="simple"/></inline-formula> factors for a grid size of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e179" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e180" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e181" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e182" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e183" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e184" xlink:type="simple"/></inline-formula>, respectively. On the images in this set, the SVM-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e185" xlink:type="simple"/></inline-formula> slightly outperforms the SVM-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e186" xlink:type="simple"/></inline-formula> and both SMLR-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e187" xlink:type="simple"/></inline-formula> and SMLR-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e188" xlink:type="simple"/></inline-formula> results and leads to overall consistent results despite the large variety of patterns, inconsistency among patterns associated with the same term, and variable orientation (<xref ref-type="fig" rid="pcbi-1002098-g008">Figure 8B</xref>). AUC values fall largely between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e189" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e190" xlink:type="simple"/></inline-formula> with a few exceptions, where we believe that either the annotation terms were assigned to the wrong images, or the corresponding images had some tilted viewing angle, making the understanding of the 2D pattern difficult to accomplish. <xref ref-type="supplementary-material" rid="pcbi.1002098.s005">Figure S5</xref> shows two scenarios where several images corresponding to the same genes are either uninformative, out of focus or under tilted viewing angles, or show expression at different time points, making it impossible for an automated annotation process to reach perfect accuracy.</p>
        <p>To assess how the good performance of the sBFA model would translate to later development, we applied it to the full set of images from stage 11–12 (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e191" xlink:type="simple"/></inline-formula>), representing a more complicated image annotation problem, given the variety of orientations (lateral, dorsal/ventral) and very intricate spatial expression patterns. The sBFA framework was run on both the complete data and the lateral subset; classifiers were trained/tested on the top <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e192" xlink:type="simple"/></inline-formula> most frequent annotation terms. As the above results did not show a clear advantage of using features from multiple resolutions, we used the highest resolution (grid size) of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e193" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e194" xlink:type="simple"/></inline-formula> on the complete set, and a total number of factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e195" xlink:type="simple"/></inline-formula>. Due to the larger number of images, training and test data sets were generated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e196" xlink:type="simple"/></inline-formula> times by randomly selecting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e197" xlink:type="simple"/></inline-formula> each with and without a specific annotation from the total set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e198" xlink:type="simple"/></inline-formula> images. On the set of lateral view images only (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e199" xlink:type="simple"/></inline-formula> images), the sBFA model was run on the same grid-size and a smaller number of factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e200" xlink:type="simple"/></inline-formula>; in this case, the training and test data sets were generated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e201" xlink:type="simple"/></inline-formula> times by randomly selecting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e202" xlink:type="simple"/></inline-formula> from lateral views (to achieve a comparable number of images between the two scenarios). The AUC values for each annotation term obtained by the sBFA framework (SVM classifier) were computed using both minority and majority voting, i.e. counting a gene as a true positive hit if it had at least one of its images, or the majority of images, correctly classified. According to our expectations, minority voting reaches AUC values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e203" xlink:type="simple"/></inline-formula>–<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e204" xlink:type="simple"/></inline-formula>, with a high <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e205" xlink:type="simple"/></inline-formula> performance corresponding to ‘posterior midgut primordium’. When using majority voting, the performance is in the same range (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e206" xlink:type="simple"/></inline-formula>–<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e207" xlink:type="simple"/></inline-formula>) as on the images from early development, this time with a slight advantage of SMLR over SVM, indicating that sBFA was successfully able to represent more complex expression patterns (<xref ref-type="table" rid="pcbi-1002098-t001">Table 1</xref>).</p>
        <table-wrap id="pcbi-1002098-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.t001</object-id><label>Table 1</label><caption>
            <title>Annotation performance in terms of AUC (mean and standard deviation), using the LOO-CV scheme, data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e208" xlink:type="simple"/></inline-formula>.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002098-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Classifier</td>
                <td align="left" colspan="1" rowspan="1">PMP</td>
                <td align="left" colspan="1" rowspan="1">AMP</td>
                <td align="left" colspan="1" rowspan="1">BP</td>
                <td align="left" colspan="1" rowspan="1">VNCP</td>
                <td align="left" colspan="1" rowspan="1">TMP</td>
                <td align="left" colspan="1" rowspan="1">HPP</td>
                <td align="left" colspan="1" rowspan="1">DEP</td>
                <td align="left" colspan="1" rowspan="1">FP</td>
                <td align="left" colspan="1" rowspan="1">HMP</td>
                <td align="left" colspan="1" rowspan="1">SMP</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e209" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">77.4<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e210" xlink:type="simple"/></inline-formula>0.71</td>
                <td align="left" colspan="1" rowspan="1">77.1<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e211" xlink:type="simple"/></inline-formula>0.39</td>
                <td align="left" colspan="1" rowspan="1">75.2<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e212" xlink:type="simple"/></inline-formula>0.97</td>
                <td align="left" colspan="1" rowspan="1">73.9<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e213" xlink:type="simple"/></inline-formula>1.12</td>
                <td align="left" colspan="1" rowspan="1">74.3<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e214" xlink:type="simple"/></inline-formula>1.03</td>
                <td align="left" colspan="1" rowspan="1">75.8<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e215" xlink:type="simple"/></inline-formula>0.86</td>
                <td align="left" colspan="1" rowspan="1">73.5<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e216" xlink:type="simple"/></inline-formula>0.28</td>
                <td align="left" colspan="1" rowspan="1">73.2<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e217" xlink:type="simple"/></inline-formula>0.33</td>
                <td align="left" colspan="1" rowspan="1">73.7<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e218" xlink:type="simple"/></inline-formula>0.58</td>
                <td align="left" colspan="1" rowspan="1">73.9<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e219" xlink:type="simple"/></inline-formula>1.32</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e220" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">92.4<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e221" xlink:type="simple"/></inline-formula>1.74</td>
                <td align="left" colspan="1" rowspan="1">90.6<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e222" xlink:type="simple"/></inline-formula>1.19</td>
                <td align="left" colspan="1" rowspan="1">89.7<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e223" xlink:type="simple"/></inline-formula>1.26</td>
                <td align="left" colspan="1" rowspan="1">87.6<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e224" xlink:type="simple"/></inline-formula>0.65</td>
                <td align="left" colspan="1" rowspan="1">82.2<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e225" xlink:type="simple"/></inline-formula>0.78</td>
                <td align="left" colspan="1" rowspan="1">83.4<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e226" xlink:type="simple"/></inline-formula>1.12</td>
                <td align="left" colspan="1" rowspan="1">79.9<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e227" xlink:type="simple"/></inline-formula>1.70</td>
                <td align="left" colspan="1" rowspan="1">79.7<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e228" xlink:type="simple"/></inline-formula>1.11</td>
                <td align="left" colspan="1" rowspan="1">77.1<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e229" xlink:type="simple"/></inline-formula>1.09</td>
                <td align="left" colspan="1" rowspan="1">80.8<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e230" xlink:type="simple"/></inline-formula>1.48</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e231" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">77.5<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e232" xlink:type="simple"/></inline-formula>0.43</td>
                <td align="left" colspan="1" rowspan="1">76.6<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e233" xlink:type="simple"/></inline-formula>0.52</td>
                <td align="left" colspan="1" rowspan="1">77.2<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e234" xlink:type="simple"/></inline-formula>0.64</td>
                <td align="left" colspan="1" rowspan="1">74.1<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e235" xlink:type="simple"/></inline-formula>0.36</td>
                <td align="left" colspan="1" rowspan="1">74.8<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e236" xlink:type="simple"/></inline-formula>0.42</td>
                <td align="left" colspan="1" rowspan="1">76.2<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e237" xlink:type="simple"/></inline-formula>0.26</td>
                <td align="left" colspan="1" rowspan="1">75.2<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e238" xlink:type="simple"/></inline-formula>0.77</td>
                <td align="left" colspan="1" rowspan="1">74.5<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e239" xlink:type="simple"/></inline-formula>0.65</td>
                <td align="left" colspan="1" rowspan="1">74.8<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e240" xlink:type="simple"/></inline-formula>0.68</td>
                <td align="left" colspan="1" rowspan="1">75.1<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e241" xlink:type="simple"/></inline-formula>0.83</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e242" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">71.2<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e243" xlink:type="simple"/></inline-formula>1.14</td>
                <td align="left" colspan="1" rowspan="1">72.5<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e244" xlink:type="simple"/></inline-formula>1.49</td>
                <td align="left" colspan="1" rowspan="1">71.1<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e245" xlink:type="simple"/></inline-formula>0.96</td>
                <td align="left" colspan="1" rowspan="1">72.8<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e246" xlink:type="simple"/></inline-formula>0.91</td>
                <td align="left" colspan="1" rowspan="1">72.2<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e247" xlink:type="simple"/></inline-formula>0.73</td>
                <td align="left" colspan="1" rowspan="1">70.6<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e248" xlink:type="simple"/></inline-formula>1.27</td>
                <td align="left" colspan="1" rowspan="1">70.1<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e249" xlink:type="simple"/></inline-formula>1.41</td>
                <td align="left" colspan="1" rowspan="1">67.3<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e250" xlink:type="simple"/></inline-formula>1.44</td>
                <td align="left" colspan="1" rowspan="1">70.4<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e251" xlink:type="simple"/></inline-formula>0.72</td>
                <td align="left" colspan="1" rowspan="1">69.6<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e252" xlink:type="simple"/></inline-formula>1.29</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e253" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">87.4<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e254" xlink:type="simple"/></inline-formula>0.88</td>
                <td align="left" colspan="1" rowspan="1">88.1<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e255" xlink:type="simple"/></inline-formula>1.31</td>
                <td align="left" colspan="1" rowspan="1">87.5<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e256" xlink:type="simple"/></inline-formula>1.74</td>
                <td align="left" colspan="1" rowspan="1">86.1<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e257" xlink:type="simple"/></inline-formula>0.82</td>
                <td align="left" colspan="1" rowspan="1">81.1<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e258" xlink:type="simple"/></inline-formula>0.52</td>
                <td align="left" colspan="1" rowspan="1">80.3<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e259" xlink:type="simple"/></inline-formula>1.05</td>
                <td align="left" colspan="1" rowspan="1">77.5<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e260" xlink:type="simple"/></inline-formula>1.46</td>
                <td align="left" colspan="1" rowspan="1">80.6<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e261" xlink:type="simple"/></inline-formula>1.08</td>
                <td align="left" colspan="1" rowspan="1">75.8<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e262" xlink:type="simple"/></inline-formula>1.35</td>
                <td align="left" colspan="1" rowspan="1">78.9<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e263" xlink:type="simple"/></inline-formula>0.55</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e264" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">70.5<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e265" xlink:type="simple"/></inline-formula>0.95</td>
                <td align="left" colspan="1" rowspan="1">72.1<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e266" xlink:type="simple"/></inline-formula>0.57</td>
                <td align="left" colspan="1" rowspan="1">73.5<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e267" xlink:type="simple"/></inline-formula>0.88</td>
                <td align="left" colspan="1" rowspan="1">73.7<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e268" xlink:type="simple"/></inline-formula>0.38</td>
                <td align="left" colspan="1" rowspan="1">72.9<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e269" xlink:type="simple"/></inline-formula>0.74</td>
                <td align="left" colspan="1" rowspan="1">71.1<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e270" xlink:type="simple"/></inline-formula>0.48</td>
                <td align="left" colspan="1" rowspan="1">71.9<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e271" xlink:type="simple"/></inline-formula>1.01</td>
                <td align="left" colspan="1" rowspan="1">69.5<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e272" xlink:type="simple"/></inline-formula>1.18</td>
                <td align="left" colspan="1" rowspan="1">72.2<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e273" xlink:type="simple"/></inline-formula>1.22</td>
                <td align="left" colspan="1" rowspan="1">69.7<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e274" xlink:type="simple"/></inline-formula>1.23</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e275" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e276" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e277" xlink:type="simple"/></inline-formula> denote the performance obtained by the SVM and SMLR classifiers on lateral view images only, using both majority (maj) and minority voting (min). For more details on majority and minority voting, please see ‘<xref ref-type="sec" rid="s4">Materials and methods</xref>’. For each case, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e278" xlink:type="simple"/></inline-formula> random partitions of the training and testing data sets are generated, on the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e279" xlink:type="simple"/></inline-formula> most popular annotation terms. Abbreviations of the anatomical annotations: AMP - anterior midgut primordium; BP - brain primordium; DEP - dorsal epidermis primordium; FP - foregut primordium; HMP - head mesoderm primordium; HPP - hindgut proper primordium; PMP - posterior midgut primordium; SMP - somatic muscle primordium; TMP - trunk mesoderm primordium; VNCP - ventral nerve cord primordium.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>The overall improved performance of minority over majority voting (in the range of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e280" xlink:type="simple"/></inline-formula>–<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e281" xlink:type="simple"/></inline-formula> AUC percent points) is a direct reflection of the nature of the actual images used by our model. For a given gene, this can happen when most, but not all, of the images are of poor quality (out of focus, poor quality of staining/washing); the existence of at least one clear and representative image can lead to a successful minority classification. Additional complications arise from errors in the automatic normalization (such as incorrect orientation), and outlier images from different views. Several such examples are shown in <xref ref-type="supplementary-material" rid="pcbi.1002098.s006">Figure S6</xref>: gene FBgn0033227 is annotated with ‘posterior midgut primordium’ on a total of three images, two of which were impossible to classify due to poor quality staining and washing; FBgn0002174 is incorrectly annotated on a total of three images, two of which contain non-informative patterns; FBgn0015774 was incorrectly majority voted for two different controlled vocabulary terms, in both cases, images are either out of focus, with non-informative patterns or improperly rotated by the automated registration process.</p>
        <p>The analysis of integrating images with multiple views revealed that, for stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e282" xlink:type="simple"/></inline-formula>, the annotation performance consistently increased when incorporating images from views other than lateral. In comparison, the average AUC performance on the lateral view only data set from stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e283" xlink:type="simple"/></inline-formula> slightly outperformed the annotation using multiple views. In <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e284" xlink:type="simple"/></inline-formula>, the additional views increased the number of genes as much as the number of images, meaning that most genes were represented by either lateral or other views. Additional dorsal/ventral view images are less informative for annotating purposes during early stages in <italic>Drosophila</italic> embryogenesis, which generally follows simple expression dynamics oriented along the A/P or D/V axis. In contrast, at later developmental stages with more complex patterns, the dorsal/ventral view images become more informative for embryo annotation, as certain expression patterns cannot be fully represented by one 2D view only.</p>
        <p>In summary, our results confirm that a fully automatic image analysis pipeline without any human intervention can lead to highly successful expression pattern classification, despite variations in orientation and the presence of uninformative images and/or registration errors. Since both classifiers (SVM and SMLR) achieved similar annotation results, it further demonstrates the general effectiveness of the sparse Bayesian factor representation.</p>
      </sec>
      <sec id="s2e">
        <title>Comparison to previous automatic annotation efforts</title>
        <p>To put our approach in context, we compared our results to two state-of-the-art systems representing bottom-up approaches using many low-level features. The automatic image annotation platform IANO was introduced by Peng <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002098-Peng1">[15]</xref>; in the original study, it used three different feature representations and several classifiers to predict annotations, which were reported on lateral-view images only. To provide for a fair comparison on the same set of genes, we ran the first comparison on data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e285" xlink:type="simple"/></inline-formula>, using the IANO code as provided by the authors. In its current version, SVMs were the only available classifier; furthermore, binary prediction labels were provided, which prevented the use of AUC as evaluation metric. Instead, we followed the authors' example and used the absolute recognition rate, despite its flaws on unbalanced data sets which leads to inflated results, as opposed to the balanced view obtained by AUC (for more details, see ‘<xref ref-type="sec" rid="s4">Materials and Methods</xref>’). With this in mind, the results from both sBFA (majority voting) and IANO systems on the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e286" xlink:type="simple"/></inline-formula> most frequent annotation terms showed that the sBFA model clearly outperformed IANO (<xref ref-type="table" rid="pcbi-1002098-t002">Table 2</xref>), at lower dimensionality. The proposed sBFA model consists of a fixed grid-based feature extraction technique followed by a sparse Bayesian factor analysis framework, whereas IANO considers three local and global feature extraction analyses which might result in higher-dimensional feature spaces.</p>
        <table-wrap id="pcbi-1002098-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.t002</object-id><label>Table 2</label><caption>
            <title>Overall recognition rate (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e287" xlink:type="simple"/></inline-formula>) of the sBFA and IANO models, data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e288" xlink:type="simple"/></inline-formula> (stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e289" xlink:type="simple"/></inline-formula>).</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002098-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.t002" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Classifier</td>
                <td align="left" colspan="1" rowspan="1">DEASN</td>
                <td align="left" colspan="1" rowspan="1">PrEASN</td>
                <td align="left" colspan="1" rowspan="1">VEASN</td>
                <td align="left" colspan="1" rowspan="1">CB</td>
                <td align="left" colspan="1" rowspan="1">PoEASN</td>
                <td align="left" colspan="1" rowspan="1">YN</td>
                <td align="left" colspan="1" rowspan="1">AEASN</td>
                <td align="left" colspan="1" rowspan="1">MASN</td>
                <td align="left" colspan="1" rowspan="1">HASN</td>
                <td align="left" colspan="1" rowspan="1">FASN</td>
                <td align="left" colspan="1" rowspan="1">Mean</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e290" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">53.8</td>
                <td align="left" colspan="1" rowspan="1">56.5</td>
                <td align="left" colspan="1" rowspan="1">58.2</td>
                <td align="left" colspan="1" rowspan="1">77.1</td>
                <td align="left" colspan="1" rowspan="1">77.2</td>
                <td align="left" colspan="1" rowspan="1">78.6</td>
                <td align="left" colspan="1" rowspan="1">76.8</td>
                <td align="left" colspan="1" rowspan="1">77.3</td>
                <td align="left" colspan="1" rowspan="1">78.7</td>
                <td align="left" colspan="1" rowspan="1">80.4</td>
                <td align="left" colspan="1" rowspan="1">71.46</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e291" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">65.4</td>
                <td align="left" colspan="1" rowspan="1">67.9</td>
                <td align="left" colspan="1" rowspan="1">68.1</td>
                <td align="left" colspan="1" rowspan="1">80.2</td>
                <td align="left" colspan="1" rowspan="1">81.7</td>
                <td align="left" colspan="1" rowspan="1">78.5</td>
                <td align="left" colspan="1" rowspan="1">81.2</td>
                <td align="left" colspan="1" rowspan="1">84.4</td>
                <td align="left" colspan="1" rowspan="1">86.3</td>
                <td align="left" colspan="1" rowspan="1">85.9</td>
                <td align="left" colspan="1" rowspan="1">77.96</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt102">
              <label/>
              <p>Image level recognition rates on the top <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e292" xlink:type="simple"/></inline-formula> most frequent annotation terms from the time window of developmental stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e293" xlink:type="simple"/></inline-formula>; majority voting (maj) was used for the sBFA model. Abbreviations of the anatomical annotations: AEASN - anterior endoderm anlage in statu nascendi; CB - cellular blastoderm; DEASN - dorsal ectoderm anlage in statu nascendi; FASN - foregut anlage in statu nascendi; HASN - hindgut anlage in statu nascendi; MASN - mesoderm anlage in statu nascendi; PoEASN - posterior endoderm anlage in statu nascendi; PrEASN - procephalic ectoderm anlage in statu nascendi; VEASN - ventral ectoderm anlage in statu nascendi; YN - yolk nuclei.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>The original IANO results focused on a manually selected data set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e294" xlink:type="simple"/></inline-formula> representative gene images with lateral views from stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e295" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002098-Peng1">[15]</xref>. While we were able to obtain identifiers for the genes, the exact images used in their work were no longer available from the authors; as a result, for the second comparison, we considered all BDGP images from stage <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e296" xlink:type="simple"/></inline-formula> for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e297" xlink:type="simple"/></inline-formula> genes (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e298" xlink:type="simple"/></inline-formula> images, data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e299" xlink:type="simple"/></inline-formula>). Using sBFA with a polynomial kernel SVM classifier, we obtained results using both minority and majority voting. The average recognition rate for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e300" xlink:type="simple"/></inline-formula> annotation terms evaluated by Peng <italic>et al.</italic> are shown in <xref ref-type="table" rid="pcbi-1002098-t003">Table 3</xref>; minority voting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e301" xlink:type="simple"/></inline-formula> is the measure most likely to recapitulate the IANO results reported for the smaller, manually curated data set <xref ref-type="bibr" rid="pcbi.1002098-Peng1">[15]</xref>. Altogether, sBFA lead to clearly improved results when applied on the same data sets, or on a prediction scheme aimed at recapitulating the original scenario, demonstrating the robustness of our generative feature extraction method when using SVM classifiers.</p>
        <table-wrap id="pcbi-1002098-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.t003</object-id><label>Table 3</label><caption>
            <title>Overall recognition rate (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e302" xlink:type="simple"/></inline-formula>) of the sBFA and IANO models, data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e303" xlink:type="simple"/></inline-formula> (stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e304" xlink:type="simple"/></inline-formula>).</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002098-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.t003" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Classifier</td>
                <td align="left" colspan="1" rowspan="1">HPP</td>
                <td align="left" colspan="1" rowspan="1">PMP</td>
                <td align="left" colspan="1" rowspan="1">AMP</td>
                <td align="left" colspan="1" rowspan="1">PP/BP</td>
                <td align="left" colspan="1" rowspan="1">DEP</td>
                <td align="left" colspan="1" rowspan="1">Mean</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e305" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">83</td>
                <td align="left" colspan="1" rowspan="1">80</td>
                <td align="left" colspan="1" rowspan="1">84</td>
                <td align="left" colspan="1" rowspan="1">86</td>
                <td align="left" colspan="1" rowspan="1">88</td>
                <td align="left" colspan="1" rowspan="1">84.2</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e306" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">91</td>
                <td align="left" colspan="1" rowspan="1">89</td>
                <td align="left" colspan="1" rowspan="1">91</td>
                <td align="left" colspan="1" rowspan="1">97</td>
                <td align="left" colspan="1" rowspan="1">95</td>
                <td align="left" colspan="1" rowspan="1">92.6</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e307" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">90.1</td>
                <td align="left" colspan="1" rowspan="1">85.5</td>
                <td align="left" colspan="1" rowspan="1">86.4</td>
                <td align="left" colspan="1" rowspan="1">78.3</td>
                <td align="left" colspan="1" rowspan="1">93.9</td>
                <td align="left" colspan="1" rowspan="1">85.8</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e308" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">96.5</td>
                <td align="left" colspan="1" rowspan="1">95.3</td>
                <td align="left" colspan="1" rowspan="1">95.1</td>
                <td align="left" colspan="1" rowspan="1">95.8</td>
                <td align="left" colspan="1" rowspan="1">98.1</td>
                <td align="left" colspan="1" rowspan="1">96.16</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt103">
              <label/>
              <p>The updated controlled vocabulary replaced the PP (protocerebrum primordium) annotation term with BP (brain primordium); minority voting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e309" xlink:type="simple"/></inline-formula> is the closest measure to the SVM(IANO) results based on a manually selected data set. In the one case where our performance ranks below IANO, numbers may not be exactly comparable, as the updated database release we used had rephrased the ontology term and reannotated some images. Abbreviations of the anatomical annotations: AMP - anterior midgut primordium; BP - brain primordium; DEP - dorsal epidermis primordium; HPP - hindgut proper primordium; PMP - posterior midgut primordium; PP - protocerebrum primordium.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>A more recent study used dense Scale-Invariant Feature Transform (SIFT) descriptors <xref ref-type="bibr" rid="pcbi.1002098-Mikolajczyk1">[28]</xref> that were converted into sparse codes to form a codebook to represent registered images, and proposed a local regularization procedure for the learning process <xref ref-type="bibr" rid="pcbi.1002098-Ji1">[14]</xref>. An unbiased comparison between our model and this system was hard to establish since the image IDs were not published in detail, results were based at least partially on selected orientations and not full sets, and annotation terms did not exactly correspond to the BDGP ontology. However, our results based on a much smaller feature space (effectively around <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e310" xlink:type="simple"/></inline-formula> features for the SMLR classifiers, as opposed to several thousand), are in a similar range to the ones reported by their system.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>Digital images are a quickly increasing new source of data for problems in computational biology. Given the very diverse nature of imaging technology, samples, and biological questions, approaches are oftentimes very tailored and ad hoc to a specific data set. At the same time, high content screening of phenotypes is moving from cell-based assays to whole organisms, and phenotypes can no longer be manually annotated due to large volumes of data. In this paper we presented a general method for the automatic decomposition of spatial quantitative information, applied on the dissection and annotation of gene expression images. The algorithm is based on a fully Bayesian factor analysis formulation, and annotates images based on a trained SVM or SMLR model. We also employed the biologically justified prior assumption that the models for both factor inference and classification are sparse, implying that only a small subset of factors are used to define expression domains. Indeed, the classifiers make use of only a dozen or two of features, orders of magnitude less than state-of-the-art approaches addressing the same problem. We also demonstrated that genes with strong weights to the same factor share specific biological functions or are targets of the same transcription factor, providing important starting point for future in-depth analysis.</p>
      <p>Our approach is probably closest to Pan <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002098-Pan1">[29]</xref>, which introduced an image mining system to discover latent spatial “themes” of gene expressions, by using PCA and independent component analysis (ICA) based features. ICA assumes independence at the regulatory level, and the resulting decomposition may lack the physical or biological association to sBFA factors, by not imposing sparsity within the model (as the biological prior assumption). Unlike PCA, sBFA includes sparseness constraints and allows for independent additive measurement errors on the observed variables. Whereas the earlier study was mostly exploratory and did not include a specific application, we provided extensive results on fruit fly embryonic expression pattern annotation from early and late stages.</p>
      <p>Our results showed that sBFA automatically identifies and separates patterns corresponding to different views, and subsequently makes successful predictions even when presented with images of the same gene taken from different angles. In addition to the automatic pattern separation, factor loadings can also automatically identify and filter non-informative (such as ubiquitous) gene expression patterns. To illustrate this, we manually selected a set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e311" xlink:type="simple"/></inline-formula> informative images (lateral, dorsal/ventral expression) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e312" xlink:type="simple"/></inline-formula> non-informative images (mostly maternal expression) from data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e313" xlink:type="simple"/></inline-formula> and computed the Euclidean distances between their corresponding estimated sparse mixing weights (rows in matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e314" xlink:type="simple"/></inline-formula>) and the null vector as reference. Choosing a threshold to separate the informative images from non-informative images (please see <xref ref-type="supplementary-material" rid="pcbi.1002098.s007">Figure S7</xref>), we succesfully filtered the original data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e315" xlink:type="simple"/></inline-formula> by removing a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e316" xlink:type="simple"/></inline-formula> non-informative images (about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e317" xlink:type="simple"/></inline-formula> of the total number of images). The subsequently obtained AUC values on the filtered data set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e318" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e319" xlink:type="simple"/></inline-formula> images) displayed the further improvement achieved by this simple Euclidean-based analysis (<xref ref-type="supplementary-material" rid="pcbi.1002098.s008">Figure S8</xref>). For future work, we plan to extend the sparse Bayesian analysis to the entire BDGP database (multiple developmental stage analysis); after extracting stage-window specific factors, a classifier taking factor weights from different stage windows as input may be able to increase the baseline performance obtained on one stage window only.</p>
      <p>In constructing the sparse FA representation, we only used simple grid-based features. This provided for an easy human interpretation of the factors and was possible because we used previously registered data as input. However, results from other groups have shown that multiple feature integration (over features including wavelet and rotation/translation invariant coefficients) can improve performance. Given that we are addressing spatial patterns, features can also take the correlation to neighboring features into account (cf. Frise <italic>et al.</italic>, <xref ref-type="bibr" rid="pcbi.1002098-Frise1">[17]</xref>). As preliminary example, we ran the sparse Bayesian factor analysis on the features used by the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e320" xlink:type="simple"/></inline-formula> platform which was concurrently developed to our system <xref ref-type="bibr" rid="pcbi.1002098-Puniyani1">[30]</xref>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e321" xlink:type="simple"/></inline-formula> registers every raw <italic>Drosophila</italic> ISH image via foreground object extraction, alignment, orientation detection and concise gene expression pattern extraction (using a Markov random field model). Resulting images are then converted into a low-dimensional feature representation using the ‘triangulated image’ idea, first introduced in <xref ref-type="bibr" rid="pcbi.1002098-Frise1">[17]</xref>, in which embryo expression is represented on a deformable mesh of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e322" xlink:type="simple"/></inline-formula> equilateral triangles in the shape of an ellipse. A comparison between the sparse Bayesian factor analysis applied on fixed grid-based filtered registered images used here <xref ref-type="bibr" rid="pcbi.1002098-Mace1">[19]</xref>, and the ‘triangulated’ <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e323" xlink:type="simple"/></inline-formula> features <xref ref-type="bibr" rid="pcbi.1002098-Puniyani1">[30]</xref>, is shown in <xref ref-type="supplementary-material" rid="pcbi.1002098.s009">Figure S9</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002098.s010">Table S1</xref>. Overall, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e324" xlink:type="simple"/></inline-formula> features showed a slight advantage over the fixed grid-based technique. However, the mean absolute recognition rates achieved by both feature sets when used in a sparse Bayesian factor analysis model were in a highly similar range, and filtering of non-informative images as discussed above showed a comparatively stronger positive effect. This demonstrated the robustness of the sBFA framework, and its ability to identify and separate gene expression patterns, regardless of the complexity of the feature space. In the future, application of the sBFA model on the actual set of registered <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e325" xlink:type="simple"/></inline-formula> images may potentially generate accuracies even better than the mesh-based features.</p>
      <p>The correspondence of inferred factors to expression patterns of regulatory proteins, as well as the enrichment of targets for specific TFs, suggests the potential for a more sophisticated model that incorporates known transcription factor expression patterns into the factor analysis, possibly in the shape of prior information, or as higher level information in hierarchical models. Finally, the approach can be extended by the integration of image data with other genomic sources. A previous study automatically inferred positive (spatial gene co-expression) and negative pairwise constraints (distinctive spatial expression patterns) from image data, and used them in a semi-supervised analysis of microarray time-course data <xref ref-type="bibr" rid="pcbi.1002098-Costa1">[31]</xref>.</p>
      <p>In summary, factor analysis provides a flexible unsupervised framework to identify the basic vocabulary in complex image (expression) data, which leads to competitive prediction results while using only a small set of features. This sparse approach is general and applicable in other microscopy application domains, such as protein localization in subcellular domains and expression data from other organisms, and as such holds promise as a general framework for high-throughput screeening, to identify candidate gene sets with consistent altered expression under changed environmental or genetic conditions.</p>
    </sec>
    <sec id="s4" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title>Factor analysis - model specification</title>
        <p>Factor analysis is a statistical method first introduced by Gorsuch <xref ref-type="bibr" rid="pcbi.1002098-Gorsuch1">[32]</xref> when modeling many dependent random variables with linear combinations of a few hidden variables. Hinton <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002098-Hinton1">[33]</xref> pioneered an Expectation-Maximization (EM) algorithm for factor analysis in order to model the manifolds of digitized images of handwritten digits. West <xref ref-type="bibr" rid="pcbi.1002098-West1">[34]</xref> was the first to introduce a framework for using factor analysis on gene expression data.</p>
        <p>In matrix notation, the Bayesian factor analysis on image data can be represented as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e326" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e327" xlink:type="simple"/></inline-formula> is a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e328" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e329" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e330" xlink:type="simple"/></inline-formula> dimensional data matrix, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e331" xlink:type="simple"/></inline-formula> the number of features, quantifying the associated gene-expression values for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e332" xlink:type="simple"/></inline-formula> images (genes) under investigation. Each row of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e333" xlink:type="simple"/></inline-formula> is called a <italic>gene pattern</italic> with dimension <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e334" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e335" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e336" xlink:type="simple"/></inline-formula>. Here, we assume that each gene pattern is already normalized to zero mean. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e337" xlink:type="simple"/></inline-formula> is the factor loading matrix with dimension <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e338" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e339" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e340" xlink:type="simple"/></inline-formula>, which contains the linear weights. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e341" xlink:type="simple"/></inline-formula> is the factor matrix with dimension <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e342" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e343" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e344" xlink:type="simple"/></inline-formula>, with each element modeled by a standard normal distribution. Each <italic>column</italic> of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e345" xlink:type="simple"/></inline-formula> is the factor score for feature <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e346" xlink:type="simple"/></inline-formula> and each <italic>row</italic> is called a factor. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e347" xlink:type="simple"/></inline-formula> is the additive Gaussian noise with dimension <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e348" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e349" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e350" xlink:type="simple"/></inline-formula>. Both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e351" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e352" xlink:type="simple"/></inline-formula> are inferred by the model simultaneously.</p>
        <p>From the model we can see that each row of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e353" xlink:type="simple"/></inline-formula> is modeled by a linear combination of the factors (rows of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e354" xlink:type="simple"/></inline-formula>), indicating that the variability of the original <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e355" xlink:type="simple"/></inline-formula> feature patterns can be explained by only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e356" xlink:type="simple"/></inline-formula> latent factors. The model can also be written in a vector form as follows<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e357" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e358" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e359" xlink:type="simple"/></inline-formula> denote the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e360" xlink:type="simple"/></inline-formula> row of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e361" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e362" xlink:type="simple"/></inline-formula>, respectively and the basis matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e363" xlink:type="simple"/></inline-formula> is shared across all samples. Indeed, factor analysis is an unsupervised dimensionality reduction method used widely in data analysis and signal processing <xref ref-type="bibr" rid="pcbi.1002098-Prince1">[35]</xref>.</p>
        <p>To promote sparseness required by the underlying biological assumption of gene expression data, West <xref ref-type="bibr" rid="pcbi.1002098-West1">[34]</xref> suggested the use of a mixture prior on the factor loading matrix. Thus each row of the matrix should only have a small number of non-zero elements in order to comply with the biological assumption and to make the model more interpretable. In order to follow the biological assumption where spatial gene expression patterns are modeled only by a few domains (factors), coupled with the benefit of a relatively simple inference, we employed the Student-t distribution as sparseness prior, which takes the following hierarchical form<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e364" xlink:type="simple"/><label>(3)</label></disp-formula>with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e365" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e366" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e367" xlink:type="simple"/></inline-formula> indicating the precision parameters and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e368" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e369" xlink:type="simple"/></inline-formula> the shape and scale parameters of the gamma prior distribution on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e370" xlink:type="simple"/></inline-formula>. By integrating out the precision parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e371" xlink:type="simple"/></inline-formula>, the marginal prior on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e372" xlink:type="simple"/></inline-formula> is a sparseness inducing Student-t distribution. The sparseness is controlled by the precision parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e373" xlink:type="simple"/></inline-formula>. The objective of imposing this sparse prior is to automatically shrink most elements in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e374" xlink:type="simple"/></inline-formula> to near zero, in order to yield a more interpretable model. A comprehensive review of sparse factor analysis for gene expression data analysis is given by Pournara and Wernisch <xref ref-type="bibr" rid="pcbi.1002098-Pournara1">[18]</xref>, with various sparse priors taken into consideration.</p>
        <p>The full likelihood for the Student-t sparse factor analysis model can be expressed as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e375" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e376" xlink:type="simple"/></inline-formula> denotes the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e377" xlink:type="simple"/></inline-formula> column of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e378" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e379" xlink:type="simple"/></inline-formula> represents the precision parameters on the additive noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e380" xlink:type="simple"/></inline-formula>, while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e381" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e382" xlink:type="simple"/></inline-formula> indicate the shape and scale hyperparameters on precision <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e383" xlink:type="simple"/></inline-formula>, respectively.</p>
        <p>The posterior distribution for the sparse factor analysis framework is approximated using a Markov Chain Monte Carlo (MCMC) inference.</p>
      </sec>
      <sec id="s4b">
        <title>Detailed update equations</title>
        <p>–Sample the factor matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e384" xlink:type="simple"/></inline-formula> from<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e385" xlink:type="simple"/><label>(5)</label></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e386" xlink:type="simple"/><label>(6)</label></disp-formula>and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e387" xlink:type="simple"/></inline-formula> denotes conditional density of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e388" xlink:type="simple"/></inline-formula> on all other random variables.</p>
        <p>–Sample the factor loading matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e389" xlink:type="simple"/></inline-formula> from<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e390" xlink:type="simple"/><label>(7)</label></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e391" xlink:type="simple"/><label>(8)</label></disp-formula>Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e392" xlink:type="simple"/></inline-formula> denotes the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e393" xlink:type="simple"/></inline-formula> row of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e394" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e395" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e396" xlink:type="simple"/></inline-formula> are similarly defined.</p>
        <p>–Sample the precision parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e397" xlink:type="simple"/></inline-formula> from<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e398" xlink:type="simple"/><label>(9)</label></disp-formula>with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e399" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e400" xlink:type="simple"/></inline-formula>, where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e401" xlink:type="simple"/><label>(10)</label></disp-formula>–Sample the precision parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e402" xlink:type="simple"/></inline-formula> from<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e403" xlink:type="simple"/><label>(11)</label></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e404" xlink:type="simple"/><label>(12)</label></disp-formula></p>
        <p>The sBFA algorithm was generally run for a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e405" xlink:type="simple"/></inline-formula> Gibbs iterations, discarding the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e406" xlink:type="simple"/></inline-formula> and estimating the model parameters on the remaining <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e407" xlink:type="simple"/></inline-formula> iterations. The sparse prior on the factor loading matrix (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e408" xlink:type="simple"/></inline-formula>) was controlled by the hyperparameter on the precision parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e409" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e410" xlink:type="simple"/></inline-formula>, while the scale parameter of the Gamma prior distribution on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e411" xlink:type="simple"/></inline-formula> was set to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e412" xlink:type="simple"/></inline-formula>. Running on a typical modern PC (Quad-core Intel Xeon 1.86 GHz processors and 4.0 GB memory), the computation times for data sets <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e413" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e414" xlink:type="simple"/></inline-formula> are summarized in <xref ref-type="table" rid="pcbi-1002098-t004">Table 4</xref>.</p>
        <table-wrap id="pcbi-1002098-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002098.t004</object-id><label>Table 4</label><caption>
            <title>Representative relative CPU times of the sBFA algorithm (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e415" xlink:type="simple"/></inline-formula> Gibbs iterations), data sets <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e416" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e417" xlink:type="simple"/></inline-formula>.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002098-t004-4" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.t004" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="2" rowspan="1">CPU Time (hours)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e418" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e419" xlink:type="simple"/></inline-formula></td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">Factor Analysis (20 factors, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e420" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e421" xlink:type="simple"/></inline-formula> grid size)</td>
                <td align="left" colspan="1" rowspan="1">6.1</td>
                <td align="left" colspan="1" rowspan="1">3.3</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Factor Analysis (40 factors, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e422" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e423" xlink:type="simple"/></inline-formula> grid size)</td>
                <td align="left" colspan="1" rowspan="1">6.9</td>
                <td align="left" colspan="1" rowspan="1">3.9</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Factor Analysis (60 factors, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e424" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e425" xlink:type="simple"/></inline-formula> grid size)</td>
                <td align="left" colspan="1" rowspan="1">10.5</td>
                <td align="left" colspan="1" rowspan="1">5.1</td>
              </tr>
            </tbody>
          </table></alternatives></table-wrap>
      </sec>
      <sec id="s4c">
        <title>Automatic annotation by different classifiers</title>
        <sec id="s4c1">
          <title>SVM classification</title>
          <p>the SVM model is a supervised learning method; given a set of training examples, each marked as belonging to one of the two classes (categories), the SVM training algorithm builds a model that predicts whether a new example falls into one category or the other. Intuitively, an SVM model is a representation of the examples as points in space, mapped so that the examples of the separate categories are divided by a clear gap (decision boundary or functional margin) that is as wide as possible. New examples are then mapped into that same space and predicted to belong to a category based on which side of the gap they fall on. We used the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e426" xlink:type="simple"/></inline-formula> implementation <xref ref-type="bibr" rid="pcbi.1002098-Joachims1">[36]</xref> with a polynomial kernel function and a unity trade-off between the training error and the functional margin.</p>
        </sec>
        <sec id="s4c2">
          <title>SMLR classification</title>
          <p>the SMLR model learns a classifier and simultaneously performs feature selection to identify a small subset of features (factors) relevant to the class distinctions. The learned classifier reports the probability of a sample (gene expression) belonging to each of the classes given a set of feature weights, one for each class, and also estimates the mixing weights on all features. In order to achieve sparsity, the model incorporates a sparsity-promoting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e427" xlink:type="simple"/></inline-formula> prior on the mixing weights entries and then estimates the weights using a MAP (Maximum a Posteriori) criterion. Explicitly, the model computes<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e428" xlink:type="simple"/><label>(13)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e429" xlink:type="simple"/></inline-formula> is a prior distribution on the mixing weight entries <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e430" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e431" xlink:type="simple"/></inline-formula> is the log-likelihood<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e432" xlink:type="simple"/><label>(14)</label></disp-formula>with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e433" xlink:type="simple"/></inline-formula> the number of training samples, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e434" xlink:type="simple"/></inline-formula> the number of classes (in our work we have a binary model, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e435" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e436" xlink:type="simple"/></inline-formula> the class label for training sample <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e437" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e438" xlink:type="simple"/></inline-formula> the weight vector corresponding to class <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e439" xlink:type="simple"/></inline-formula>.</p>
          <p>Sparsity-promoting Laplacian priors on the mixing weights can be written as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e440" xlink:type="simple"/><label>(15)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e441" xlink:type="simple"/></inline-formula> acts as a tunable regularization parameter (the larger is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e442" xlink:type="simple"/></inline-formula>, the greater is the sparsity). Excessively large values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e443" xlink:type="simple"/></inline-formula> can result in the nonselection of relevant factors, while excessively small values can result in the selection of irrelevant features. We evaluated values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e444" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e445" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e446" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e447" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e448" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e449" xlink:type="simple"/></inline-formula> and noticed very similar best classification results at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e450" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e451" xlink:type="simple"/></inline-formula>, choosing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e452" xlink:type="simple"/></inline-formula> throughout the paper.</p>
        </sec>
      </sec>
      <sec id="s4d">
        <title>Performance assessment</title>
        <p>The sBFA model is demonstrated on a large set of image expression data collected within the Berkeley <italic>Drosophila</italic> Genome Project. The use of brightfield microscopy and the color of the staining made it hard to separate object and expression pattern from the same image, although heuristic normalization steps have been proposed <xref ref-type="bibr" rid="pcbi.1002098-Frise1">[17]</xref>. We here used previously segmented and registered images <xref ref-type="bibr" rid="pcbi.1002098-Mace1">[19]</xref>, in which a state-of-the-art framework provided simultaneous, fully automated image segmentation and registration without human intervention. Due to the complex nature of this task, the final registration process was not perfectly accurate in terms of precise embryo extraction as well as orientation, which increased the challenge of automatic annotation. We scaled the registered images to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e453" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e454" xlink:type="simple"/></inline-formula> pixel resolution, containing a single embryo and no background. We defined a grid of fixed size (<italic>e.g.</italic>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e455" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e456" xlink:type="simple"/></inline-formula> patches) and calculated the mean pixel value within each patch; all mean values were stacked into a single feature vector.</p>
        <p>Each scaled and registered image was classified individually, with each gene being represented by one or more images. As a results of a one gene to a multiple image mapping, many earlier approaches chose representative images, one per gene, with a clearly defined informative pattern. However, for a fully automated approach, the data offer the possibility to combine results from several images to annotate a gene. The challenge is illustrated by the examples in <xref ref-type="supplementary-material" rid="pcbi.1002098.s005">Figure S5</xref>, which demonstrate inconsistencies and presence of noise in large image data sets; as a result, some images are more informative than others and may even lead to contradicting images within the same gene. Regardless of evaluation metric, we here use two strategies: (i) majority voting, in which a label is assigned based on the predominant label over all images associated to a particular gene; (ii) minority voting, in which a gene is considered correctly classified if at least one image has been predicted with the correct annotation term. While the latter is not a realistic metric for unseen data, it provides for a reasonably fair evaluation when comparing against previous approaches which evaluated manually selected single representative images for each gene.</p>
        <p>The agreement between the predicted annotations and the ground truth provided by human curators was measured using AUC values for a leave-one-out cross-validation procedure. To allow for a fair comparison to previously published work, we also used the absolute recognition rate (ARR) to measure the classification accuracy. When a data set is unbalanced, this metric is not representative of the true performance of the classifier: if the larger class comprises <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e457" xlink:type="simple"/></inline-formula> of the data, an ARR of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e458" xlink:type="simple"/></inline-formula> is trivially achieved by classifying all samples into the larger class. Image data sets are heavily unbalanced, as only comparatively few out of a total set of images are annotated with any given term.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002098.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.s001" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>BDGP analysis, data set </bold><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e459" xlink:type="simple"/></inline-formula><bold>: estimated factor loading matrix, for a grid size of 80×40, with </bold><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e460" xlink:type="simple"/></inline-formula><bold> factors.</bold> The sBFA algorithm was run for a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e461" xlink:type="simple"/></inline-formula> Gibbs iterations, with a burn-in of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e462" xlink:type="simple"/></inline-formula> iterations. Most factor loadings are near zero (light green color), illustrating the sparseness of the solution.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002098.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.s002" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p>
            <bold>A complete list with term associations between transcription factors and biological processes, developmental stages 11–12.</bold>
          </p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002098.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.s003" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p><bold>Significant transcription factors, for the top </bold><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e463" xlink:type="simple"/></inline-formula><bold> most frequent annotation terms (developmental stages </bold><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e464" xlink:type="simple"/></inline-formula><bold>–</bold><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e465" xlink:type="simple"/></inline-formula><bold>).</bold> The level of significance of each TFs (vertical axis) is displayed as color intensity between green (p-value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e466" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e467" xlink:type="simple"/></inline-formula>) and red (p-value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e468" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e469" xlink:type="simple"/></inline-formula>), as indicated by the color bar on the left side; smaller p-values correspond to more significant genes. The blue color corresponds to TFs with a corrected p-value<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e470" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e471" xlink:type="simple"/></inline-formula>.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002098.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.s004" xlink:type="simple">
        <label>Figure S4</label>
        <caption>
          <p>
            <bold>Visual similarities between spatial expressions of estimated sparse model factors and corresponding TFs with significant p-values (data set </bold>
            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e472" xlink:type="simple"/></inline-formula>
            <bold>).</bold>
          </p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002098.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.s005" xlink:type="simple">
        <label>Figure S5</label>
        <caption>
          <p><bold>Complexity of the image data (focal distance and viewing angles).</bold> Two examples where several images corresponding to two individual genes (at stages 4–6 and 11–12, respectively) are either out of focus, with no visible gene expression pattern, or under tilted viewing angles, making the annotation process more difficult.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002098.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.s006" xlink:type="simple">
        <label>Figure S6</label>
        <caption>
          <p><bold>Spatial expression patterns of genes with successful classification within the minority voting scenario, data set </bold><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e473" xlink:type="simple"/></inline-formula><bold>.</bold> Several examples where, for a given gene, there is only one correct annotated image, due to out of focus, non-informative patterns or an improper rotation by the registration process. In each case, the original gene spatial expression patterns and the automatically extracted individual embryos are shown.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002098.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.s007" xlink:type="simple">
        <label>Figure S7</label>
        <caption>
          <p><bold>Euclidean distance based informative/non-informative gene selection.</bold> Informative images (lateral, dorsal/ventral expressions) are separated from non-informative images (mostly maternal expressions) through the use of Euclidean distance between their corresponding estimated mixing weights (rows in matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e474" xlink:type="simple"/></inline-formula>) and a reference vector. The chosen threshold is further employed to succesfully remove a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e475" xlink:type="simple"/></inline-formula> non-informative images from data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e476" xlink:type="simple"/></inline-formula>.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002098.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.s008" xlink:type="simple">
        <label>Figure S8</label>
        <caption>
          <p><bold>SVM analysis on developmental stages 4–6.</bold> The AUC values achieved by the SVM framework on the filtered data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e477" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e478" xlink:type="simple"/></inline-formula> images) in comparison to the AUC results on the original data set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e479" xlink:type="simple"/></inline-formula>.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002098.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.s009" xlink:type="simple">
        <label>Figure S9</label>
        <caption>
          <p><bold>SVM analysis on developmental stages 4–6: the AUC of individual annotation terms using the sBFA model.</bold> We consider two different scenarios: using the grid-based features (grid size of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e480" xlink:type="simple"/></inline-formula>×<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e481" xlink:type="simple"/></inline-formula>), or using the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e482" xlink:type="simple"/></inline-formula>-based features. The common set between the two studies extends to a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e483" xlink:type="simple"/></inline-formula> images, with different views (lateral, dorsal/ventral). During the sBFA estimation, we used a number of factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e484" xlink:type="simple"/></inline-formula>, for both scenarios; the polynomial SVM generated the AUC of individual annotation terms.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002098.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002098.s010" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <p><bold>Overall recognition rate (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e485" xlink:type="simple"/></inline-formula>) of the sBFA model on grid-based features and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e486" xlink:type="simple"/></inline-formula>-based features, developmental stages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e487" xlink:type="simple"/></inline-formula>.</bold> Image level recognition rates on the top <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e488" xlink:type="simple"/></inline-formula> most frequent annotation terms from the time window of developmental stage <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e489" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002098.e490" xlink:type="simple"/></inline-formula> images), as used as metric in <xref ref-type="bibr" rid="pcbi.1002098-Puniyani1">[30]</xref>. Abbreviations of the anatomical annotations: AEASN - anterior endoderm anlage in statu nascendi; CB - cellular blastoderm; DEASN - dorsal ectoderm anlage in statu nascendi; HASN - hindgut anlage in statu nascendi; MASN - mesoderm anlage in statu nascendi; PoEASN - posterior endoderm anlage in statu nascendi; PrEASN - procephalic ectoderm anlage in statu nascendi; TMASN - trunk mesoderm anlage in statu nascendi; VEASN - ventral ectoderm anlage in statu nascendi; YN - yolk nuclei.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank Erwin Frise for assistance with the data used in this paper. We also thank Pavel Tomancak and Manonmani Arunachalam for helpful comments.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002098-Arbeitman1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Arbeitman</surname><given-names>MN</given-names></name><name name-style="western"><surname>Furlong</surname><given-names>EEM</given-names></name><name name-style="western"><surname>Imam</surname><given-names>F</given-names></name><name name-style="western"><surname>Johnson</surname><given-names>E</given-names></name><name name-style="western"><surname>Null</surname><given-names>BH</given-names></name><etal/></person-group>             <year>2002</year>             <article-title>Gene expression during the life cycle of Drosophila melanogaster.</article-title>             <source>Science</source>             <volume>297</volume>             <fpage>2270</fpage>             <lpage>2275</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1072152" xlink:type="simple">10.1126/science.1072152</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Hooper1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hooper</surname><given-names>SD</given-names></name><name name-style="western"><surname>Boue</surname><given-names>S</given-names></name><name name-style="western"><surname>Krause</surname><given-names>R</given-names></name><name name-style="western"><surname>Jensen</surname><given-names>LJ</given-names></name><name name-style="western"><surname>Mason</surname><given-names>CE</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Identification of tightly regulated groups of genes during Drosophila melanogaster embryogenesis.</article-title>             <source>Mol Sys Biol</source>             <volume>3</volume>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb4100112" xlink:type="simple">10.1038/msb4100112</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Stolc1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stolc</surname><given-names>V</given-names></name><name name-style="western"><surname>Gauhar</surname><given-names>Z</given-names></name><name name-style="western"><surname>Mason</surname><given-names>C</given-names></name><name name-style="western"><surname>Halasz</surname><given-names>G</given-names></name><name name-style="western"><surname>vanBatenburg</surname><given-names>MF</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>A gene expression map for the euchromatic genome of Drosophila melanogaster.</article-title>             <source>Science</source>             <volume>306</volume>             <fpage>655</fpage>             <lpage>660</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1101312" xlink:type="simple">10.1126/science.1101312</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Tomancak1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tomancak</surname><given-names>P</given-names></name><name name-style="western"><surname>Berman</surname><given-names>BP</given-names></name><name name-style="western"><surname>Beaton</surname><given-names>A</given-names></name><name name-style="western"><surname>Weiszmann</surname><given-names>R</given-names></name><name name-style="western"><surname>Kwan</surname><given-names>E</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Global analysis of patterns of gene expression during Drosophila embryogenesis.</article-title>             <source>Genome Biol</source>             <volume>8</volume>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2007-8-7-r145" xlink:type="simple">10.1186/gb-2007-8-7-r145</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Ljosa1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ljosa</surname><given-names>V</given-names></name><name name-style="western"><surname>Carpenter</surname><given-names>AE</given-names></name></person-group>             <year>2009</year>             <article-title>Introduction to the quantitative analysis of two-dimensional fluorescence microscopy images for cell-based screening.</article-title>             <source>PLoS Comp Biol</source>             <volume>5</volume>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000603" xlink:type="simple">10.1371/journal.pcbi.1000603</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Walter1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Walter</surname><given-names>T</given-names></name><name name-style="western"><surname>Shattuck</surname><given-names>DW</given-names></name><name name-style="western"><surname>Baldock</surname><given-names>R</given-names></name><name name-style="western"><surname>Bastin</surname><given-names>ME</given-names></name><name name-style="western"><surname>Carpenter</surname><given-names>AE</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Visualization of image data from cells to organisms.</article-title>             <source>Nat Methods</source>             <volume>7</volume>             <fpage>26</fpage>             <lpage>41</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1431" xlink:type="simple">10.1038/nmeth.1431</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Tautz1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tautz</surname><given-names>D</given-names></name><name name-style="western"><surname>Pfeifle</surname><given-names>C</given-names></name></person-group>             <year>1989</year>             <article-title>A non-radioactive in situ hybridization method for the localization of specific RNAs in Drosophila embryos reveals translational control of the segmentation gene hunchback.</article-title>             <source>Chromosoma</source>             <volume>98</volume>             <fpage>81</fpage>             <lpage>85</lpage>             <comment>PMID: 2476281</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Tomancak2">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tomancak</surname><given-names>P</given-names></name><name name-style="western"><surname>Beaton</surname><given-names>A</given-names></name><name name-style="western"><surname>Weiszmann</surname><given-names>R</given-names></name><name name-style="western"><surname>Kwan</surname><given-names>E</given-names></name><name name-style="western"><surname>Hartenstein</surname><given-names>V</given-names></name><etal/></person-group>             <year>2002</year>             <article-title>Systematic determination of patterns of gene expression during Drosophila embryogenesis.</article-title>             <source>Genome Biol</source>             <volume>3</volume>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2002-3-12-research0088" xlink:type="simple">10.1186/gb-2002-3-12-research0088</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Carson1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Carson</surname><given-names>JP</given-names></name><name name-style="western"><surname>Ju</surname><given-names>T</given-names></name><name name-style="western"><surname>Lu</surname><given-names>HC</given-names></name><name name-style="western"><surname>Thaller</surname><given-names>C</given-names></name><name name-style="western"><surname>Xu</surname><given-names>M</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>A digital atlas to characterize the mouse brain transcriptome.</article-title>             <source>PLoS Comp Biol</source>             <volume>1</volume>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0010041" xlink:type="simple">10.1371/journal.pcbi.0010041</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Lein1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lein</surname><given-names>ES</given-names></name><name name-style="western"><surname>Hawrylycz</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Ao</surname><given-names>N</given-names></name><name name-style="western"><surname>Ayres</surname><given-names>M</given-names></name><name name-style="western"><surname>Bensnger</surname><given-names>A</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Genome-wide atlas of gene expression in the adult mouse brain.</article-title>             <source>Nature</source>             <volume>445</volume>             <fpage>168</fpage>             <lpage>176</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature05453" xlink:type="simple">10.1038/nature05453</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Ashburner1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ashburner</surname><given-names>M</given-names></name><name name-style="western"><surname>Ball</surname><given-names>CA</given-names></name><name name-style="western"><surname>Blake</surname><given-names>JA</given-names></name><name name-style="western"><surname>Botstein</surname><given-names>D</given-names></name><name name-style="western"><surname>Butler</surname><given-names>H</given-names></name><etal/></person-group>             <year>2000</year>             <article-title>Gene ontology: tool for the unification of biology - The Gene Ontology Consortium.</article-title>             <source>Nat Genet</source>             <volume>25</volume>             <fpage>25</fpage>             <lpage>29</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/75556" xlink:type="simple">10.1038/75556</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Chen1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>SC</given-names></name><name name-style="western"><surname>Zhao</surname><given-names>T</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>GJ</given-names></name><name name-style="western"><surname>Murphy</surname><given-names>RF</given-names></name></person-group>             <year>2007</year>             <article-title>Automated image analysis of protein localization in budding yeast.</article-title>             <source>Intel Sys for Mol Biol/European Conf on Comp Biol</source>             <volume>23</volume>             <fpage>66</fpage>             <lpage>71</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm206" xlink:type="simple">10.1093/bioinformatics/btm206</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Kumar1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kumar</surname><given-names>S</given-names></name><name name-style="western"><surname>Jayaraman</surname><given-names>K</given-names></name><name name-style="western"><surname>Panchanathan</surname><given-names>S</given-names></name><name name-style="western"><surname>Gurunathan</surname><given-names>R</given-names></name><name name-style="western"><surname>Marti-Subirana</surname><given-names>A</given-names></name><etal/></person-group>             <year>2002</year>             <article-title>BEST: a novel computational approach for comparing gene expression patterns from early stages of Drosophila melanogaster development.</article-title>             <source>Genetics</source>             <volume>162</volume>             <fpage>2037</fpage>             <lpage>2047</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Ji1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ji</surname><given-names>S</given-names></name><name name-style="western"><surname>Li</surname><given-names>YX</given-names></name><name name-style="western"><surname>Zhou</surname><given-names>ZH</given-names></name><name name-style="western"><surname>Kumar</surname><given-names>S</given-names></name><name name-style="western"><surname>Ye</surname><given-names>J</given-names></name></person-group>             <year>2009</year>             <article-title>A bag-of-words approach for Drosophila gene expression pattern annotation.</article-title>             <source>BMC Bioinformatics</source>             <volume>10</volume>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-10-119" xlink:type="simple">10.1186/1471-2105-10-119</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Peng1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Peng</surname><given-names>H</given-names></name><name name-style="western"><surname>Long</surname><given-names>F</given-names></name><name name-style="western"><surname>Zhou</surname><given-names>J</given-names></name><name name-style="western"><surname>Leung</surname><given-names>G</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>MB</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Automatic image analysis for gene expression patterns of fly embryos.</article-title>             <source>BMC Cell Biol</source>             <volume>8</volume>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2121-8-S1-S7" xlink:type="simple">10.1186/1471-2121-8-S1-S7</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Heffel1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Heffel</surname><given-names>A</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name><name name-style="western"><surname>Prohaska</surname><given-names>SJ</given-names></name><name name-style="western"><surname>Kauer</surname><given-names>G</given-names></name><name name-style="western"><surname>Kuska</surname><given-names>JP</given-names></name></person-group>             <year>2008</year>             <article-title>Process flow for classification and clustering of fruit fly gene expression patterns.</article-title>             <source>IEEE Int Conf on Im Proc</source>             <volume>1</volume>             <fpage>721</fpage>             <lpage>724</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/ICIP.2008.4711856" xlink:type="simple">10.1109/ICIP.2008.4711856</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Frise1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Frise</surname><given-names>E</given-names></name><name name-style="western"><surname>Hammonds</surname><given-names>AS</given-names></name><name name-style="western"><surname>Celniker</surname><given-names>SE</given-names></name></person-group>             <year>2010</year>             <article-title>Systematic image-driven analysis of the spatial Drosophila embryonic expression landscape.</article-title>             <source>Mol Sys Biol</source>             <volume>6</volume>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2009.102" xlink:type="simple">10.1038/msb.2009.102</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Pournara1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pournara</surname><given-names>I</given-names></name><name name-style="western"><surname>Wernisch</surname><given-names>L</given-names></name></person-group>             <year>2007</year>             <article-title>Factor analysis for gene regulatory networks and transcription factor activity profiles.</article-title>             <source>BMC Bioinformatics</source>             <volume>8</volume>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-8-61" xlink:type="simple">10.1186/1471-2105-8-61</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Mace1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mace</surname><given-names>DL</given-names></name><name name-style="western"><surname>Varnado</surname><given-names>N</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>W</given-names></name><name name-style="western"><surname>Frise</surname><given-names>E</given-names></name><name name-style="western"><surname>Ohler</surname><given-names>U</given-names></name></person-group>             <year>2010</year>             <article-title>Extraction and comparison of gene expression patterns from 2D RNA in situ hybridization images.</article-title>             <source>Bioinformatics</source>             <volume>26</volume>             <fpage>761</fpage>             <lpage>769</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp658" xlink:type="simple">10.1093/bioinformatics/btp658</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Adryan1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Adryan</surname><given-names>B</given-names></name><name name-style="western"><surname>Teichmann</surname><given-names>SA</given-names></name></person-group>             <year>2006</year>             <article-title>FlyTF: a systematic review of site-specific transcription factors in the fruit fly Drosophila melanogaster.</article-title>             <source>BMC Bioinformatics</source>             <volume>22</volume>             <fpage>1532</fpage>             <lpage>1533</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl143" xlink:type="simple">10.1093/bioinformatics/btl143</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Roy1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Roy</surname><given-names>S</given-names></name><name name-style="western"><surname>Ernst</surname><given-names>J</given-names></name><name name-style="western"><surname>Kharchenko</surname><given-names>PV</given-names></name><name name-style="western"><surname>Kheradpour</surname><given-names>P</given-names></name><name name-style="western"><surname>Negre</surname><given-names>N</given-names></name></person-group>             <year>2010</year>             <article-title>Identification of functional elements and regulatory circuits by Drosophila modENCODE.</article-title>             <source>Science</source>             <volume>330</volume>             <fpage>1787</fpage>             <lpage>1797</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1198374" xlink:type="simple">10.1126/science.1198374</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Ogienko1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ogienko</surname><given-names>AA</given-names></name><name name-style="western"><surname>Karagodin</surname><given-names>DA</given-names></name><name name-style="western"><surname>Pavlova</surname><given-names>NV</given-names></name><name name-style="western"><surname>Fedorova</surname><given-names>SA</given-names></name><name name-style="western"><surname>Voloshina</surname><given-names>MV</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Molecular and genetic description of a new hypomorphic mutation of Trithorax -like gene and analysis of its effect on Drosophila melanogaster oogenesis.</article-title>             <source>Russian J Dev Biol</source>             <volume>39</volume>             <fpage>108</fpage>             <lpage>115</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1134/S1062360408020070" xlink:type="simple">10.1134/S1062360408020070</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Sandmann1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sandmann</surname><given-names>T</given-names></name><name name-style="western"><surname>Girardot</surname><given-names>C</given-names></name><name name-style="western"><surname>Brehme</surname><given-names>M</given-names></name><name name-style="western"><surname>Tongprasit</surname><given-names>W</given-names></name><name name-style="western"><surname>Stolc</surname><given-names>V</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>A core transcriptional network for early mesoderm development in Drosophila melanogaster.</article-title>             <source>Genes Dev</source>             <volume>21</volume>             <fpage>436</fpage>             <lpage>449</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gad.1509007" xlink:type="simple">10.1101/gad.1509007</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Jaebum1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jaebum</surname><given-names>K</given-names></name><name name-style="western"><surname>Cunningham</surname><given-names>R</given-names></name><name name-style="western"><surname>James</surname><given-names>B</given-names></name><name name-style="western"><surname>Wyder</surname><given-names>S</given-names></name><name name-style="western"><surname>Gibson</surname><given-names>JD</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Functional characterization of transcription factor motifs using cross-species comparison across large evolutionary distances.</article-title>             <source>PLoS Comp Biol</source>             <volume>6</volume>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000652" xlink:type="simple">10.1371/journal.pcbi.1000652</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Burges1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Burges</surname><given-names>CJC</given-names></name></person-group>             <year>1998</year>             <article-title>A tutorial on support vector machines for pattern recognition.</article-title>             <source>Data Min Knowl Discov</source>             <volume>2</volume>             <fpage>121</fpage>             <lpage>167</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1009715923555" xlink:type="simple">10.1023/A:1009715923555</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Krishnapuram1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Krishnapuram</surname><given-names>B</given-names></name><name name-style="western"><surname>Carin</surname><given-names>L</given-names></name><name name-style="western"><surname>Figueiredo</surname><given-names>MAT</given-names></name><name name-style="western"><surname>Hartemink</surname><given-names>AJ</given-names></name></person-group>             <year>2005</year>             <article-title>Learning sparse Bayesian classifiers: multi-class formulation, fast algorithms and generalization bounds.</article-title>             <source>IEEE Trans Pattern Anal Mach Intell</source>             <volume>27</volume>             <fpage>957</fpage>             <lpage>968</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TPAMI.2005.127" xlink:type="simple">10.1109/TPAMI.2005.127</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Gribskov1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gribskov</surname><given-names>M</given-names></name><name name-style="western"><surname>Robinson</surname><given-names>NL</given-names></name></person-group>             <year>1996</year>             <article-title>Use of receiver operating characteristic (ROC) analysis to evaluate sequence matching.</article-title>             <source>Comp Chem</source>             <volume>20</volume>             <fpage>25</fpage>             <lpage>33</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0097-8485(96)80004-0" xlink:type="simple">10.1016/S0097-8485(96)80004-0</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Mikolajczyk1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mikolajczyk</surname><given-names>K</given-names></name><name name-style="western"><surname>Schmid</surname><given-names>C</given-names></name></person-group>             <year>2005</year>             <article-title>A performance evaluation of local descriptors.</article-title>             <source>IEEE Trans Pattern Anal Mach Intell</source>             <volume>27</volume>             <fpage>1615</fpage>             <lpage>1630</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TPAMI.2005.188" xlink:type="simple">10.1109/TPAMI.2005.188</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Pan1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pan</surname><given-names>JY</given-names></name><name name-style="western"><surname>Balan</surname><given-names>AGR</given-names></name><name name-style="western"><surname>Xing</surname><given-names>EP</given-names></name><name name-style="western"><surname>Traina</surname><given-names>AJM</given-names></name><name name-style="western"><surname>Faloutsos</surname><given-names>C</given-names></name></person-group>             <year>2006</year>             <article-title>Automatic mining of fruit fly embryo images.</article-title>             <source>Proc of the 12th ACM SIGKDD</source>             <fpage>693</fpage>             <lpage>698</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1145/1150402.1150489" xlink:type="simple">10.1145/1150402.1150489</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Puniyani1">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Puniyani</surname><given-names>K</given-names></name><name name-style="western"><surname>Faloutsos</surname><given-names>C</given-names></name><name name-style="western"><surname>Xing</surname><given-names>EP</given-names></name></person-group>             <year>2010</year>             <article-title>SPEX<sup>2</sup>: automated concise extraction of spatial gene expression patterns from fly embryo ISH images.</article-title>             <source>Bioinformatics</source>             <volume>26</volume>             <fpage>i47</fpage>             <lpage>i56</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq172" xlink:type="simple">10.1093/bioinformatics/btq172</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Costa1">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Costa</surname><given-names>IG</given-names></name><name name-style="western"><surname>Krause</surname><given-names>R</given-names></name><name name-style="western"><surname>Opitz</surname><given-names>L</given-names></name><name name-style="western"><surname>Schliep</surname><given-names>A</given-names></name></person-group>             <year>2007</year>             <article-title>Semi-supervised learning for the identification of syn-expressed genes from fused microarray and in situ image data.</article-title>             <source>BMC Bioinformatics</source>             <volume>8</volume>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-8-S10-S3" xlink:type="simple">10.1186/1471-2105-8-S10-S3</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Gorsuch1">
        <label>32</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gorsuch</surname><given-names>RL</given-names></name></person-group>             <year>1983</year>             <source>Factor analysis</source>             <publisher-name>Lawrence Erlbaum Associates</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Hinton1">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hinton</surname><given-names>GE</given-names></name><name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name><name name-style="western"><surname>Revow</surname><given-names>M</given-names></name></person-group>             <year>1997</year>             <article-title>Modeling the manifolds of images of handwritten digits.</article-title>             <source>IEEE Trans on Neural Networks</source>             <volume>8</volume>             <fpage>65</fpage>             <lpage>74</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/72.554192" xlink:type="simple">10.1109/72.554192</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-West1">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>West</surname><given-names>M</given-names></name></person-group>             <year>2003</year>             <article-title>Bayesian factor regression models in the “large p, small n” paradigm.</article-title>             <source>Bayesian Stat</source>             <volume>7</volume>             <fpage>733</fpage>             <lpage>742</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Prince1">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Prince</surname><given-names>SJD</given-names></name><name name-style="western"><surname>Warrell</surname><given-names>J</given-names></name><name name-style="western"><surname>Elder</surname><given-names>JH</given-names></name><name name-style="western"><surname>Felisberti</surname><given-names>FM</given-names></name></person-group>             <year>2008</year>             <article-title>Tied factor analysis for face recognition across large pose differences.</article-title>             <source>IEEE Trans Pattern Anal Mach Intell</source>             <volume>30</volume>             <fpage>970</fpage>             <lpage>984</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TPAMI.2008.48" xlink:type="simple">10.1109/TPAMI.2008.48</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002098-Joachims1">
        <label>36</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Joachims</surname><given-names>T</given-names></name></person-group>             <year>1999</year>             <source>Making large-Scale SVM Learning Practical - Advances in Kernel Methods -Support Vector Learning</source>             <publisher-name>MIT-Press</publisher-name>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>