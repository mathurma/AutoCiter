<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01869</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003737</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>A Scalable and Accurate Targeted Gene Assembly Tool (SAT-Assembler) for Next-Generation Sequencing Data</article-title>
<alt-title alt-title-type="running-head">Scalable and Accurate Targeted Gene Assembly</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>Yuan</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Sun</surname><given-names>Yanni</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Cole</surname><given-names>James R.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Computer Science and Engineering, Michigan State University, East Lansing, Michigan, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Center for Microbial Ecology, Michigan State University, East Lansing, Michigan, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>McHardy</surname><given-names>Alice Carolyn</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Heinrich Heine University, Germany</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">yannisun@msu.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: YZ YS JRC. Performed the experiments: YZ YS JRC. Analyzed the data: YZ YS JRC. Contributed reagents/materials/analysis tools: YZ YS JRC. Wrote the paper: YZ YS JRC.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>8</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>14</day><month>8</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>8</issue>
<elocation-id>e1003737</elocation-id>
<history>
<date date-type="received"><day>28</day><month>10</month><year>2013</year></date>
<date date-type="accepted"><day>5</day><month>6</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Zhang et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="RA1" related-article-type="companion" ext-link-type="uri" page="e1002972" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1002972"> <article-title>New Methods Section in PLOS Computational Biology</article-title></related-article>
<abstract>
<p>Gene assembly, which recovers gene segments from short reads, is an important step in functional analysis of next-generation sequencing data. Lacking quality reference genomes, <italic>de novo</italic> assembly is commonly used for RNA-Seq data of non-model organisms and metagenomic data. However, heterogeneous sequence coverage caused by heterogeneous expression or species abundance, similarity between isoforms or homologous genes, and large data size all pose challenges to <italic>de novo</italic> assembly. As a result, existing assembly tools tend to output fragmented contigs or chimeric contigs, or have high memory footprint. In this work, we introduce a targeted gene assembly program SAT-Assembler, which aims to recover gene families of particular interest to biologists. It addresses the above challenges by conducting family-specific homology search, homology-guided overlap graph construction, and careful graph traversal. It can be applied to both RNA-Seq and metagenomic data. Our experimental results on an <italic>Arabidopsis</italic> RNA-Seq data set and two metagenomic data sets show that SAT-Assembler has smaller memory usage, comparable or better gene coverage, and lower chimera rate for assembling a set of genes from one or multiple pathways compared with other assembly tools. Moreover, the family-specific design and rapid homology search allow SAT-Assembler to be naturally compatible with parallel computing platforms. The source code of SAT-Assembler is available at <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/sat-assembler/" xlink:type="simple">https://sourceforge.net/projects/sat-assembler/</ext-link>. The data sets and experimental settings can be found in supplementary material.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Next-generation sequencing (NGS) provides an efficient and affordable way to sequence the genomes or transcriptomes of a large amount of organisms. With fast accumulation of the sequencing data from various NGS projects, the bottleneck is to efficiently mine useful knowledge from the data. As NGS platforms usually generate short and fragmented sequences (reads), one key step to annotate NGS data is to assemble short reads into longer contigs, which are then used to recover functional elements such as protein-coding genes. Short read assembly remains one of the most difficult computational problems in genomics. In particular, the performance of existing assembly tools is not satisfactory on complicated NGS data sets. They cannot reliably separate genes of high similarity, recover under-represented genes, and incur high computational time and memory usage. Hence, we propose a targeted gene assembly tool, SAT-Assembler, to assemble genes of interest directly from NGS data with low memory usage and high accuracy. Our experimental results on a transcriptomic data set and two microbial community data sets showed that SAT-Assembler used less memory and recovered more target genes with better accuracy than existing tools.</p>
</abstract>
<funding-group><funding-statement>This work is supported by MSU start-up funding and the grant number is GA016811. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="16"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods article.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>Advances in next-generation sequencing (NGS) technologies enable sequencing of transcriptoms of a large number of non-model organisms (RNA-Seq) and species from various environmental samples (metagenomic data). Functional annotation is an important step in analyzing these NGS data sets. For RNA-Seq of non-model organisms and metagenomic data, which lack quality reference genomes, a commonly used functional annotation pipeline conducts <italic>de novo</italic> assembly first and applies functional annotation analysis to the assembled contigs. This pipeline has been widely adopted in functional analysis of RNA-Seq data <xref ref-type="bibr" rid="pcbi.1003737-MutasaGttgens1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1003737-Schmid1">[4]</xref> and gene-centric metagenomic analysis <xref ref-type="bibr" rid="pcbi.1003737-Tringe1">[5]</xref>–<xref ref-type="bibr" rid="pcbi.1003737-Aziz1">[9]</xref>. One of the most informative and practical steps in functional analysis is homology search, which assigns functions to contigs using significant matches against non-redundant protein sequence databases or secondary databases including protein families, domains and functional sites. The performance of downstream functional analysis largely depends on the quality of the <italic>de novo</italic> assembly, which is still a challenging problem for RNA-Seq and metagenomic data.</p>
<p>The problem of assembling NGS reads has received considerable effort <xref ref-type="bibr" rid="pcbi.1003737-Jeffrey1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1003737-Zerbino1">[11]</xref>. Different programs have been developed for transcriptome assembly <xref ref-type="bibr" rid="pcbi.1003737-Schulz1">[12]</xref>–<xref ref-type="bibr" rid="pcbi.1003737-Trapnell1">[17]</xref> and metagenomic assembly <xref ref-type="bibr" rid="pcbi.1003737-Namiki1">[18]</xref>–<xref ref-type="bibr" rid="pcbi.1003737-Wu1">[24]</xref>. <italic>De novo</italic> RNA-Seq assembly aims to identify transcribed genes, separate isoforms, and quantify gene expression while metagenomic assembly intends to recover individual genomes from environmental samples. Often there are specific sets of genes in pathways that are of special interest, for example carbon and nitrogen cycling pathways in the response of permafrost to global warming <xref ref-type="bibr" rid="pcbi.1003737-Mackelprang1">[25]</xref> in soil metagenomic data, while much of bulk <italic>de novo</italic> assemblies consist of less interesting "housekeeping genes" and genes with unknown function that give little insight to the specific question at hand. Thus, gene-centric analysis using homology search is a direct and effective strategy to study complicated transcriptomic and metagenomic data.</p>
<p><italic>De novo</italic> gene assembly for RNA-Seq and metagenomic data share similar challenges in algorithm design. First, genes that have divergent expression levels in RNA-Seq data or highly different abundance in metagenomic data lead to a wide range of sequence coverage. Even worse, the sequence coverage along the same gene can be highly different due to bias in sequencing protocols. Using one set of assembly parameters for all genes or even for different regions of the same gene leads to unsatisfactory performance, resulting in either fragmented contigs or chimeric contigs. Although methods using multiple <italic>k-mer</italic> sizes have been developed to identify transcripts in a broader coverage range, the choice of <italic>k-mer</italic> size is still ad hoc. Second, expression of gene isoforms due to alternative splicing (AS) events and expression of genes with shared short identical sequence regions in RNA-Seq data as well as the high similarity of orthologous genes in metagenomic data grossly compound <italic>de novo</italic> assembly. Chimeric contigs tend to be produced between highly similar transcripts or gene homologs. Third, existing assembly programs suffer from either long computational time or high memory usage or both. New developments in sequencing technology such as today's Illumina HiSeq can produce up to 150 bp <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e001" xlink:type="simple"/></inline-formula> 180 million reads of a total of 27 Gbp in a single run in single-end mode. Using all seven lanes can output up to 189 Gbp in one run and close to double that in paired-end mode. Two popular RNA-Seq assembly programs, Trinity and Oases, incur the longest running time and the maximum memory usage in comparison with other assembly tools <xref ref-type="bibr" rid="pcbi.1003737-Zhao1">[26]</xref>, respectively. Using small <italic>k-mer</italic> size in Osases may require resources exceeding the memory space of a typical computing server on existing data <xref ref-type="bibr" rid="pcbi.1003737-Zhao1">[26]</xref>. Thus, scalable methods and tools are urgently needed to analyze new sequencing data.</p>
<p>To improve gene assembly in RNA-Seq and metagenomic data that lack quality reference genomes, we propose a different scheme, which conducts homology search first and then family-specific gene assembly. The proposed assembly method takes genes of interest as input, which can include specific sets of genes in pathways that are of special interest or well-characterized protein or domain families in existing databases. Note that although we conduct homology search for reads, assembly is still indispensable for functional analysis because the preferred products for a majority of users are relatively complete genes.</p>
<p>The main novelties of our method and how those are used to address the above challenges are summarized below. First, by conducting homology search on reads directly, all reads will be first classified into different gene families. <italic>De novo</italic> assembly will only be conducted for reads in each family. The input size for assembly is significantly decreased compared to bulk assembly. Second, the alignments output by homology search are used to guide family-specific gene assembly. We propose a novel overlap graph construction algorithm that can achieve maximum connectivity and accuracy for genes of both low and high sequence coverage. Third, we use a modified depth-first-search (DFS) that carefully incorporates multiple information including paired-end reads, transitive edges, and coverage information to guide graph traversal. The novel graph construction algorithm together with the carefully designed traversal algorithm can maximumly avoid generation of chimeric contigs.</p>
<sec id="s2a">
<title>Related work</title>
<p>As gene families of interest are used as input, our algorithm employs homology search against gene families in assembly graph construction. Using genomes or proteome of related species to boost and optimize genome assembly has been proposed or implemented in a group of assembly programs <xref ref-type="bibr" rid="pcbi.1003737-Salzberg1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1003737-Wu1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1003737-Pop1">[27]</xref>–<xref ref-type="bibr" rid="pcbi.1003737-Li2">[35]</xref>. The contigs belonging to a single gene or a block of genome in the related species are ordered, oriented, and assembled. Most of these programs are designed to improve genome assembly. A few of these comparative or gene-boosted assembly programs are specifically designed for RNA-Seq or metagenomic assembly. For example, Surget-Groba et al. <xref ref-type="bibr" rid="pcbi.1003737-SurgetGroba1">[30]</xref> carefully considered the highly heterogeneous sequence coverage of transcripts and employed multi-k and proteome of a related species to optimize transcriptome assembly. Dutilh et al. <xref ref-type="bibr" rid="pcbi.1003737-Dutilh1">[29]</xref> used one closely related reference genome to increase assembly performance of microbial genomes in metagenomic data. Ye's group used homologous genes to stitch gene fragments for gene assembly in metagenomic data <xref ref-type="bibr" rid="pcbi.1003737-Wu1">[24]</xref>.</p>
<p>Our work is different from existing comparative assembly approaches in the following aspects. First, our tool does not require any related species as input. Most of the existing comparative approaches are limited by the availability of closely related reference genomes. Low similarity between the to-be-assembled genes or genomes and the related genes or genomes can lead to wrongly assembled contigs. Our tool uses well-characterized genes of particular interest or ubiquitously represented sequence families such as those from family databases of proteins, domains, or functional sites as input to guide assembly. Second, as we use sequence families rather than a single sequence as reference, profile-based alignment methods rather than pairwise sequence alignment or exact sequence mapping are applied to conduct homology search. Profile-based methods tend to be more sensitive for remote homology search. Third, to our best knowledge, SAT-Assembler is the first tool that uses consistency between sequence overlap and alignment overlap for edge creation in an overlap graph.</p>
<p>Another type of RNA-Seq assembly tool, Cufflinks, assembles gene isoforms due to alternative transcription and splicing and improves transcriptome-based genome annotation <xref ref-type="bibr" rid="pcbi.1003737-Trapnell1">[17]</xref>. Cufflinks and SAT-Assembler require different types of input and are targeted at different applications. Their major differences are summarized below. First, Cufflinks needs the reference genome as input while SAT-Assembler uses sequence families as input. The input families do not need to contain any genomic sequence or protein products from the reference genome. Instead, they may contain a large number of gene or protein sequences from other species with variable evolutionary distances. For example, the average sequence identity of protein (domain) families in Pfam ranges from 20% to over 90%. The conservation and evolutionary changes of the member sequences are summarized into a profile HMM, which can share high or low similarity with the genes in the reference genome. Second, Cufflinks and SAT-Assembler have different applications. Cufflinks is used to annotate transcripts and gene isoforms for species with known reference genomes. SAT-Assembler is applied to RNA-Seq data of non-model organisms or metagenomic data, which do not have reference genomes. Third, although both tools conduct sequence alignment between reads and the reference genomes or sequence families in the first step, the alignment algorithms are highly different. The read alignment in Cufflinks relies on read mapping tools such as TopHat <xref ref-type="bibr" rid="pcbi.1003737-Trapnell2">[36]</xref> and Bowtie <xref ref-type="bibr" rid="pcbi.1003737-Langmead1">[37]</xref>, which allow only minor changes caused by, for example, sequencing errors. On the other hand, the profile HMM-based alignment in SAT-Assembler can handle a large number of evolutionary changes including substitutions, insertions, and deletions.</p>
</sec></sec><sec id="s3" sec-type="methods">
<title>Methods</title>
<sec id="s3a">
<title>Overview of SAT-assembler</title>
<p>Our tool can be divided into two main stages. First, we align reads against profile hidden Markov models (HMMs), which effectively represent the underlying gene families. This stage classifies the whole input data set into subsets of reads sequenced from different gene families. Second, SAT-Assembler constructs a family-specific overlap graph and assembles reads from the same family into contigs using a graph traversal algorithm. The graph construction is supervised by the alignment information from the first stage and aims to obtain maximum connectivity between reads while avoiding false connections. In particular, it can accurately capture small overlaps between reads from lowly sequenced regions and improves the assembly of lowly transcribed or encoded genes. The graph traversal is guided by multiple types of information to avoid generation of chimeric contigs. Finally, paired-end reads are used to scaffold contigs from the same genes into <italic>super contigs</italic>, which are sets of contigs that are from the same scaffolds. <xref ref-type="fig" rid="pcbi-1003737-g001">Fig. 1</xref> is a schematic representation of the pipeline of SAT-Assembler.</p>
<fig id="pcbi-1003737-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.g001</object-id><label>Figure 1</label><caption>
<title>The pipeline of SAT-Assembler.</title>
<p>Reads of the same color belong to the same gene family. Reads from different genes of the same family are distinguished using different patterns. Reads shared by multiple genes from the same family have multiple patterns.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.g001" position="float" xlink:type="simple"/></fig></sec><sec id="s3b">
<title>Profile HMM-based homology search</title>
<p>Our method conducts homology search on reads first. Depending on the algorithms and the target databases, homology search methods can be divided into two types. The first type compares the sequences against protein sequence databases using pairwise alignment tools such as BLAST <xref ref-type="bibr" rid="pcbi.1003737-Altschul1">[38]</xref>. The second type uses profile-based homology search to classify queries into characterized protein domain or family databases such as Pfam <xref ref-type="bibr" rid="pcbi.1003737-Finn1">[39]</xref>, <xref ref-type="bibr" rid="pcbi.1003737-Punta1">[40]</xref>, TIGRFAM <xref ref-type="bibr" rid="pcbi.1003737-Haft1">[41]</xref>, FIGfams <xref ref-type="bibr" rid="pcbi.1003737-Meyer1">[42]</xref>, InterProScan <xref ref-type="bibr" rid="pcbi.1003737-Quevillon1">[43]</xref>, etc.</p>
<p>Applying profile-based homology search to NGS reads has several advantages. First, the number of gene families is significantly smaller than the number of sequences, rendering a much smaller search space. For example, there are only about 13,000 manually curated protein families in Pfam. Together these cover nearly 80% of the UniProt Knowledgebase and the coverage is increasing every year as enough information becomes available to form new families <xref ref-type="bibr" rid="pcbi.1003737-Punta1">[40]</xref>. As the profile-based homology search tool HMMER is as fast as BLAST <xref ref-type="bibr" rid="pcbi.1003737-Eddy1">[44]</xref>, using profile-based search provides a shorter search time. Second, previous work <xref ref-type="bibr" rid="pcbi.1003737-Durbin1">[45]</xref> has shown that using family information can improve the sensitivity of remote protein homology search. For the transcriptomes of non-model organism and metagenomic data, sensitive remote homology search is especially important for identifying possible new homologs. Third, although short reads can pose challenges to both types of homology search <xref ref-type="bibr" rid="pcbi.1003737-Wommack1">[46]</xref>, <xref ref-type="bibr" rid="pcbi.1003737-Zhang1">[47]</xref>, empirical studies on thousands of families <xref ref-type="bibr" rid="pcbi.1003737-Zhang1">[47]</xref> showed that the performance of profile-based homology search improved quickly with increasing read size. For a read length of 85 bases, the sensitivity is close to 1.0 for moderately and highly conserved domains. Thus, for read lengths produced by modern NGS technologies, profile-based homology search methods are capable of classifying many reads into their native families with high specificity.</p>
<p>SAT-Assembler aligns query reads against input families using HMMER with the default E-value threshold 10. Reads that generate HMMER hits are classified into the corresponding family and fed into the next stage. In most cases, a read can only be classified into a single family. However, because some input families share similarities, some reads may be classified into multiple input families. In practice, we only classify a read into at most three families with the three smallest E-values.</p>
</sec><sec id="s3c">
<title>Alignment-informed graph construction</title>
<p>The first stage not only classifies query reads into their native families but provides important alignment information for <italic>de novo</italic> assembly. The alignment positions are used to guide overlap graph construction. A standard overlap graph is defined as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e002" xlink:type="simple"/></inline-formula>, where each non-duplicate read is a node and an overlap larger than a given cutoff is indicated by a directed edge. Our overlap graph is different from a standard overlap graph <xref ref-type="bibr" rid="pcbi.1003737-Myers1">[48]</xref>–<xref ref-type="bibr" rid="pcbi.1003737-Simpson2">[50]</xref> in the edge creation criteria and graph construction procedure.</p>
<p>In a standard overlap graph, edge creation only depends on the sequence overlap, which is not ideal for genes of heterogeneous sequence coverage. We add edges by considering the relationship between two types of overlaps: alignment overlap and sequence overlap. As HMMER outputs alignments represented by amino acids, all overlaps are converted into the unit of bp for consistency. For simplicity of explanation, a read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e003" xlink:type="simple"/></inline-formula> corresponds to vertex <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e004" xlink:type="simple"/></inline-formula> in G. For two reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e005" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e006" xlink:type="simple"/></inline-formula>, an edge is created from the corresponding node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e007" xlink:type="simple"/></inline-formula> to node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e008" xlink:type="simple"/></inline-formula> if the following criteria are satisfied: i) the alignment position of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e009" xlink:type="simple"/></inline-formula> is smaller than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e010" xlink:type="simple"/></inline-formula>; ii) the alignments of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e011" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e012" xlink:type="simple"/></inline-formula> overlap by at least <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e013" xlink:type="simple"/></inline-formula>, a user-defined threshold; iii) the sequence overlap of the two reads is consistent with the overlap in their alignment positions. Suppose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e014" xlink:type="simple"/></inline-formula> aligns to the model between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e015" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e016" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e017" xlink:type="simple"/></inline-formula> aligns to the model between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e018" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e019" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e020" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e021" xlink:type="simple"/></inline-formula> are alignment starting positions in the model and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e022" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e023" xlink:type="simple"/></inline-formula> are alignment ending positions in the model. The alignment overlap is the number of bases converted from the number of amino acids in the overlapping region between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e024" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e025" xlink:type="simple"/></inline-formula>. For example, the overlapping region between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e026" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e027" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1003737-g002">Fig. 2</xref>.(C) contains 22 amino acids, which are converted into 66 bases of alignment overlap. Criterion 3 is the key observation to connect reads that are sequenced from the same gene rather than from orthologous or paralogous genes because the latter can have very different sequence and alignment overlaps. An example is given in <xref ref-type="fig" rid="pcbi-1003737-g002">Fig. 2</xref>, in which read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e028" xlink:type="simple"/></inline-formula> and read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e029" xlink:type="simple"/></inline-formula> are from two homologous genes. Their sequence overlap and alignment overlap are 25 and 66 respectively. Other assembly tools such as Trinity will create an edge between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e030" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e031" xlink:type="simple"/></inline-formula> when the <italic>k-mer</italic> size is 25. However, because their alignment overlap and sequence overlap are inconsistent, SAT-Assembler does not connect them, avoiding a wrong connection between reads from homologous genes.</p>
<fig id="pcbi-1003737-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.g002</object-id><label>Figure 2</label><caption>
<title>Alignment overlap and sequence overlap.</title>
<p>(A) Two reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e032" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e033" xlink:type="simple"/></inline-formula> sequenced from different genes of the same family are aligned to the profile HMM of the family. Their sequence overlap is indicated in red. (B) Read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e034" xlink:type="simple"/></inline-formula> and read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e035" xlink:type="simple"/></inline-formula> have an alignment overlap of 66 and a sequence overlap of 25 (in bold). (C) Sequenced from homologous genes, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e036" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e037" xlink:type="simple"/></inline-formula> show higher similarity in their translated peptide sequences than in their DNA sequences.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.g002" position="float" xlink:type="simple"/></fig>
<p>The consistency-based edge creation also allows us to improve connectivity in regions with low sequence coverage. For relatively small overlaps, we still allow an edge if the alignment overlap and sequence overlap are similar to each other. The intuition is that the chance that reads with random overlaps can be aligned to the same model with similar alignment overlap is small.</p>
<p>To quantify the consistency between the two types of overlaps, we introduce the <italic>relative overlap difference</italic> defined by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e038" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e039" xlink:type="simple"/></inline-formula> is alignment overlap and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e040" xlink:type="simple"/></inline-formula> is sequence overlap. Criterion 3 is satisfied only when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e041" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e042" xlink:type="simple"/></inline-formula> is a predefined cutoff with a default value of 0.15. We examined relative overlap difference in both real RNA-Seq and metagenomic data sets. For reads sequenced from the same gene and from different genes, the average relative overlap differences are 0.072 and 0.89 respectively. To avoid small random overlaps, we use 20 as the default value for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e043" xlink:type="simple"/></inline-formula>, the alignment overlap threshold.</p>
<p>Our overlap graph construction is different from standard overlap graph construction in that it does not need all-against-all sequence comparison. We first sort the reads by their alignment positions in a non-decreasing order. We only check the sequence overlap between two reads if their alignment overlap passes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e044" xlink:type="simple"/></inline-formula>. Therefore, the alignment information increases the efficiency of graph construction (running time analysis can be found in the section of Running Time Analysis). To incorporate substitution sequencing errors introduced by some NGS platforms, we allow a certain number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e045" xlink:type="simple"/></inline-formula> of mismatches in the sequence overlap. That is, the overlap between two hits <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e046" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e047" xlink:type="simple"/></inline-formula> is the longest suffix of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e048" xlink:type="simple"/></inline-formula> that has a Hamming distance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e049" xlink:type="simple"/></inline-formula> to a prefix of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e050" xlink:type="simple"/></inline-formula>. In our current implementation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e051" xlink:type="simple"/></inline-formula>. The parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e052" xlink:type="simple"/></inline-formula> can be adjusted to fit the error rate of the input data.</p>
</sec><sec id="s3d">
<title>Pruning and optimization of overlap graphs</title>
<p>Transitive edges correspond to edges whose two end nodes are connected by an alternative path (usually with higher coverage). They add unnecessary edges without contributing to the connectivity of the graph and are removed before <italic>de novo</italic> assembly. Before removing them, SAT-Assembler keeps a record of all the pairs of nodes connected by transitive edges because a transitive edge indicates that a pair of nodes are from the same gene region. This information will be used to guide the graph traversal.</p>
<p>If a node has only one outgoing edge that points to another node that has only one incoming edge these two nodes can be merged as one node. Tips are identified and removed using the topology-based pruning methods as in Velvet <xref ref-type="bibr" rid="pcbi.1003737-Zerbino1">[11]</xref>.</p>
<p>Although our edge creation method excludes most random sequence overlaps, some erroneous edges still exist. An edge is highly likely to be erroneous if it is inferior to another edge that shares a head node or tail node with it. An edge <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e053" xlink:type="simple"/></inline-formula> is inferior to another edge <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e054" xlink:type="simple"/></inline-formula> if the following two criteria are met: i) the sequence overlap of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e055" xlink:type="simple"/></inline-formula> is smaller than half of that of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e056" xlink:type="simple"/></inline-formula>; ii) the Hamming distance of sequence overlap of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e057" xlink:type="simple"/></inline-formula> is larger than that of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e058" xlink:type="simple"/></inline-formula>. A random overlap is more likely to be much smaller and have more mismatches than a true overlap. Therefore, these two criteria will help us remove most erroneous edges.</p>
</sec><sec id="s3e">
<title>Guided graph traversal using multiple types of information</title>
<p>Once a family-specific graph is constructed and optimized, the goal is to conduct a graph traversal to output paths corresponding to genes. The traversal starts with nodes without incoming edges. The challenge arises when two or more genes contain a common or similar subsequence, leading to <italic>chimeric nodes</italic> such as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e059" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e060" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1003737-g003">Fig. 3</xref>.</p>
<fig id="pcbi-1003737-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.g003</object-id><label>Figure 3</label><caption>
<title>Graph traversal using multiple types of information.</title>
<p>A graph containing reads from two different genes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e061" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e062" xlink:type="simple"/></inline-formula>. Nodes in red (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e063" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e064" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e065" xlink:type="simple"/></inline-formula>) and in blue (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e066" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e067" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e068" xlink:type="simple"/></inline-formula>) are from gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e069" xlink:type="simple"/></inline-formula> and gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e070" xlink:type="simple"/></inline-formula> respectively. Nodes in black (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e071" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e072" xlink:type="simple"/></inline-formula>) are chimeric nodes because they are shared by the two genes. Arrows with solid lines are real edges. Arrows with dotted lines and dashed lines indicate transitive edges and paired-end reads between two nodes respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.g003" position="float" xlink:type="simple"/></fig>
<p>Chimeric nodes add to the complexity of the graph traversal by leading to chimeric contigs. For example, the path <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e073" xlink:type="simple"/></inline-formula> contains nodes exclusively from both genes and thus is a chimeric path. SAT-Assembler employs three types of information to guide the graph traversal to recover correct gene paths: transitive edges, paired-end reads, and coverage. We describe the key steps of our graph traversal algorithm using <xref ref-type="fig" rid="pcbi-1003737-g003">Fig. 3</xref>. The goal is to output two correct paths corresponding to the two genes.</p>
<p>A paired-end read represents two reads appearing in the same genome with known order (by our homology search) and distance range (insert size). Although transitive edges are removed at the stage of graph pruning they can act as a paired-end read with a small insert size. Therefore, both transitive edges and paired-end reads can be used to examine whether two nodes are from the same gene. Two nodes that are not connected by an edge are said to have <italic>supports</italic> or be <italic>supported</italic> if there are transitive edges or paired-end reads between them. For paired-end read supports, we further require that their distance in the path be consistent with the insert size.</p>
<p>Different from previous traversal algorithms, we divide supports into two types, <italic>critical supports</italic> and <italic>non-critical supports</italic>. Critical supports can be used to resolve branching in graph traversal while non-critical supports are not able to distinguish different gene paths. For example, a graph traversal generates a path <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e074" xlink:type="simple"/></inline-formula>. The node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e075" xlink:type="simple"/></inline-formula> has two outgoing edges <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e076" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e077" xlink:type="simple"/></inline-formula>. If there is a support between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e078" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e079" xlink:type="simple"/></inline-formula>, such as the transitive edge in <xref ref-type="fig" rid="pcbi-1003737-g003">Fig. 3</xref>, the traversal will be guided to visit <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e080" xlink:type="simple"/></inline-formula> in next step. This transitive edge provides a critical support for correct traversal. However, the support between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e081" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e082" xlink:type="simple"/></inline-formula> is not "critical" for guiding the graph traversal because any path that has visited <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e083" xlink:type="simple"/></inline-formula> needs to visit <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e084" xlink:type="simple"/></inline-formula>. In <xref ref-type="fig" rid="pcbi-1003737-g003">Fig. 3</xref>, the support between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e085" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e086" xlink:type="simple"/></inline-formula> is a non-critical support while all the other supports are critical supports.</p>
<p>When there is no support between two non-chimeric nodes, <italic>node coverage</italic> will be used to resolve the branches. The coverage of a node is the total size of reads normalized by the length of the assembled sequence of the node. For protein-coding genes, although the sequence coverage is usually not uniform along the genes its change is gradual rather than sharp. Thus, the coverage of two consecutive non-chimeric nodes in the same path should reflect this observation. Any sharp change indicates a wrong path. For example, in <xref ref-type="fig" rid="pcbi-1003737-g003">Fig. 3</xref>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e087" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e088" xlink:type="simple"/></inline-formula> have similar coverage, as do <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e089" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e090" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e091" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e092" xlink:type="simple"/></inline-formula>, however, have significantly different coverage. Therefore, a path that has visited <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e093" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e094" xlink:type="simple"/></inline-formula> should next visit <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e095" xlink:type="simple"/></inline-formula> instead of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e096" xlink:type="simple"/></inline-formula>.</p>
<p>We use a bounded depth-first search (DFS) algorithm to generate correct paths. While a typical DFS takes exponential time to generate all simple paths between two nodes, our graph traversal method makes use of critical supports to bound the search and only visits the correct paths, effectively reducing the time complexity of path generation. During search, we will proceed to those successors of the current node that provide critical supports. If none of the successive non-chimeric nodes has supports with any of the previously visited non-chimeric nodes, we will proceed to the one that has a similar coverage to the recently visited non-chimeric node given that their coverage is similar enough. Otherwise, it is highly likely that the current node is not from the same gene as any of its successors. Therefore, we will output the current path and start a new path from its successors. The traversal stops when there is no appropriate successive node available. All paths with critical supports above a given threshold will be output.</p>
</sec><sec id="s3f">
<title>Contig scaffolding</title>
<p>Assembly tools may output multiple contigs from the same gene. There are two main reasons for the fragmentation: i) some regions between contigs are not sequenced due to sequencing bias, PCR bias, low transcription level or abundance; ii) reads from lowly conserved regions of the gene may not pass the homology search and thus are not used to construct the graph. The contigs are oriented and connected using their alignment positions against the underlying profile HMM and paired-end reads. The scaffolding results in super contigs.</p>
</sec><sec id="s3g">
<title>Distinguish gene isoforms due to alternative splicing</title>
<p>SAT-Assembler can distinguish not only different target genes but also gene isoforms caused by AS events. Here we classify the seven different types of alternative splicing events <xref ref-type="bibr" rid="pcbi.1003737-Keren1">[51]</xref> into four different groups. <xref ref-type="fig" rid="pcbi-1003737-g004">Fig. 4</xref> shows how overlap graphs are constructed for these four groups of AS events. Each of the group is represented by one AS event in <xref ref-type="bibr" rid="pcbi.1003737-Keren1">[51]</xref>. All the other types fall into one of these groups.</p>
<fig id="pcbi-1003737-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.g004</object-id><label>Figure 4</label><caption>
<title>Distinguish gene isoforms due to alternative splicing.</title>
<p>Overlap graphs constructed from different groups of AS events. Each case consists of the isoforms due to AS events (left), the positions of reads from the isoforms (middle), and the overlap graphs constructed from these isoforms (right). Constitutive exons are shown in blue and alternatively spliced regions in yellow. Introns are represented by solid lines, and dashed lines indicate splicing options. In the middle panel of each case, the red lines represent reads sequenced from exons shared by both isoforms. The green and purple lines represent reads that are exclusively sequenced from each isoform. In the right panel of each case, the red nodes represent reads sequenced from exons shared by both isoforms. The green and purple nodes represent reads that are exclusively sequenced from each isoform. Cases (A), (B), (C), and (D) represent four different groups of AS events.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.g004" position="float" xlink:type="simple"/></fig>
<p>In Cases (A), (C), and (D) of <xref ref-type="fig" rid="pcbi-1003737-g004">Fig. 4</xref>, different isoforms correspond to different paths of the overlap graphs. Therefore, isoforms generated by AS events from these groups can be distinguished by generating contigs from these paths. In Case (B), there are two paths that begin with a root node and end with a sink node: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e097" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e098" xlink:type="simple"/></inline-formula>. The first path recovers the first isoform and the second path corresponds to a chimeric contig. However, reads in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e099" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e100" xlink:type="simple"/></inline-formula> are not from the same isoform. Therefore, there will be no paired end support between them. Our graph traversal algorithm will stop in node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e101" xlink:type="simple"/></inline-formula> without proceeding to node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e102" xlink:type="simple"/></inline-formula>. Therefore, SAT-Assembler can still correctly recover both isoforms in this case. In practice, different types of alternative splicing events can occur together, further compounding the assembly. In these cases, SAT-Assembler relies on multiple types of information such as paired end reads, transitive edges, and coverage to distinguish different isoforms, as described in the section of Guided Graph Traversal Using Multiple Types of Information. The performance of assembly tools on distinguishing gene isoforms can be found in the section of Performance of Recovering Gene Isoforms.</p>
</sec><sec id="s3h">
<title>Running time analysis</title>
<p>Let the number of input reads be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e103" xlink:type="simple"/></inline-formula> and the average read length be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e104" xlink:type="simple"/></inline-formula>. The time complexity of the homology search stage is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e105" xlink:type="simple"/></inline-formula> for one input family, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e106" xlink:type="simple"/></inline-formula> is length of the profile HMM and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e107" xlink:type="simple"/></inline-formula>. Suppose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e108" xlink:type="simple"/></inline-formula> reads have passed the homology search stage. Usually, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e109" xlink:type="simple"/></inline-formula>. The time complexity of graph construction is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e110" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e111" xlink:type="simple"/></inline-formula> is the average number of overlapping alignments longer than a given cutoff. During graph construction, we use alignment positions to guide the overlap computation, avoiding the all-against-all comparison needed in a standard overlap graph construction. The time complexity of graph traveral is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e112" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e113" xlink:type="simple"/></inline-formula> is the number of nodes, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e114" xlink:type="simple"/></inline-formula> is the number of edges, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e115" xlink:type="simple"/></inline-formula> is the number of read pairs that have critical supports, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e116" xlink:type="simple"/></inline-formula> is the number of correct paths in the graph. The time complexity of the scaffoding stage is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e117" xlink:type="simple"/></inline-formula>. Because of various optimization techniques and heuristics, the latest version of HMMER is as fast as BLAST <xref ref-type="bibr" rid="pcbi.1003737-Eddy1">[44]</xref>. Considering <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e118" xlink:type="simple"/></inline-formula>, the time complexity of scaffolding is much smaller than graph traversal. Therefore, the overall running time is determined by the graph traversal stage.</p>
</sec></sec><sec id="s4">
<title>Results</title>
<p>To show the utility of SAT-Assembler, we applied it to an <italic>Arabidopsis</italic> RNA-Seq data set and two metagenomic data sets. The first metagenomic data set was sequenced from highly diverse <italic>bacterial</italic> and <italic>archaeal</italic> synthetic communities and the second data set was sequenced from human gut microbial communities. We compared the completeness and correctness of assembly, length of contigs, memory usage, and running time of different <italic>de novo</italic> assembly tools, including SAT-Assembler, Velvet, Oases, Trinity, IDBA-Tran, Trans-ABySS, IDBA-UD, and MetaVelvet.</p>
<p>For targeted gene assembly, we are interested in evaluating the performance of each tool in recovering the target genes. Thus, for bulk assembly tools which output contigs containing multiple genes and intergenic regions, we first extract <italic>gene segments</italic> from the contigs. <xref ref-type="fig" rid="pcbi-1003737-g005">Fig. 5</xref> shows examples of gene segments inside contigs. In each contig, only segments overlapping target genes are used for performance evaluation. For all experiments, by mapping reads to an annotated reference genome or characterized genes from existing databases, we constructed a set of reference/target genes, which are transcribed or encoded in an NGS data set. All contigs output by assembly tools were compared (BLAST) against reference genes for identifying gene segments.</p>
<fig id="pcbi-1003737-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.g005</object-id><label>Figure 5</label><caption>
<title>A schematic representation of gene segments.</title>
<p>Three contigs and their gene segments. Gene 1 and gene 2 are target genes. Contigs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e119" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e120" xlink:type="simple"/></inline-formula> each contain one gene segment (green parts). Contig <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e121" xlink:type="simple"/></inline-formula> contains two gene segments (green parts). The blue parts of the contigs are not gene segments.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.g005" position="float" xlink:type="simple"/></fig>
<p>To quantify the completeness, correctness, and length of gene segments, we propose four metrics: gene coverage, chimera rate, contig length, and contig coverage. For one reference gene, gene coverage is defined as the fraction of bases in the reference gene covered by at least one gene segment. The chimera rate is defined as the fraction of chimeric gene segments among all gene segments recovered by assembled contigs. As read mapping results can be used to determine the origin of each read, we can evaluate whether a gene segment is chimeric by checking the origin of each read in the gene segment. Contig coverage is the length of the gene segment normalized by the length of the target gene. This normalized contig length is used to prevent gene segments of long reference genes from dominating the average contig coverage of an assembly tool. Moreover, to evaluate the performance of assembly tools on recovering complete transcripts for RNA-Seq data using single contigs, we calculate the percentage of single contigs that can recover complete gene isoforms as well as the percentage of non-chimeric contigs among them. These experimental results can be found in the section of Performance of Recovering Gene Isoforms.</p>
<p>In <xref ref-type="fig" rid="pcbi-1003737-g005">Fig. 5</xref>, the length of gene 1 is 1000 bp and the combined length of the gene segments from contig <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e122" xlink:type="simple"/></inline-formula> and contig <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e123" xlink:type="simple"/></inline-formula> is 700 bp. Therefore, the gene coverage of gene 1 by contigs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e124" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e125" xlink:type="simple"/></inline-formula> is 70%. The contig coverages of the two gene segments are 40% and 30% respectively. Suppose a bulk assembly tool outputs contig <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e126" xlink:type="simple"/></inline-formula>, which covers both gene 1 and gene 2. Contig <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e127" xlink:type="simple"/></inline-formula> thus contains two gene segments. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e128" xlink:type="simple"/></inline-formula> is a correctly assembled contig, it will generate 100% gene coverage for both gene 1 and gene 2. And, the chimera rate is zero for contig <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e129" xlink:type="simple"/></inline-formula> as the two gene segments are not chimeric. To compare the performance of assembly tools on all input families, we first calculate a metric for each family and then report the average of the values of the metric over all families.</p>
<sec id="s4a">
<title>Gene assembly in an <italic>Arabidopsis</italic> RNA-seq data set</title>
<p>In this experiment, we applied SAT-Assembler to an RNA-Seq data set sequenced from a normalized cDNA library of <italic>Arabidopsis</italic> generated using paired-end Illumina sequencing <xref ref-type="bibr" rid="pcbi.1003737-Marquez1">[52]</xref>. There were a total of 9,559,784 paired-end reads of 76 bp. Pfam was used as our database of input families. Some Pfam families use sequences from <italic>Arabidopsis</italic> to train their profile HMMs. Therefore, we eliminated <italic>Arabidopsis</italic> sequences from these families and recomputed the profile HMMs for them. We compared the performance of SAT-Assembler with Velvet, Oases, Trinity, IDBA-Tran, and Trans-ABySS. Velvet is a widely used short read <italic>de novo</italic> assembly tool. Oases, Trinity, IDBA-Tran, and Trans-ABySS are assembly tools specially designed for transcriptomic data.</p>
<p>To determine which genes are transcribed in this data set, we conducted read mapping (using Bowtie <xref ref-type="bibr" rid="pcbi.1003737-Langmead1">[37]</xref>) on all the coding sequences (CDS) of <italic>Arabidopsis thaliana</italic> of version TAIR10 <xref ref-type="bibr" rid="pcbi.1003737-Carnegie1">[53]</xref>. 59.62% of the input reads were mapped to the CDS with at most 2 mismaches allowed. There is no commonly accepted criterion to define transcribed genes. In this work, we defined CDS with at least 10 mapped reads as transcribed CDS. Assembly results of different tools were compared on these transcribed CDS. There are 29,030 different transcribed gene isoforms corresponding to 21,452 genes. A total of 3,163 protein or domain families from Pfam that can be aligned to these CDS using HMMER with gathering thresholds (GAs) were used as input to SAT-Assembler. Among the mapped reads, 65.39% generated HMMER hits against these protein or domain families using HMMER's default E-value threshold 10. The rest of the mapped reads failed to be aligned by HMMER due to the following main reasons: i) some <italic>Arabidopsis</italic> genes are not covered by Pfam families; ii) the average sequence identities of some Pfam families that Arabidopisis genes belong to are low, rendering marginal alignment scores, especially for short reads <xref ref-type="bibr" rid="pcbi.1003737-Zhang1">[47]</xref>; iii) some <italic>Arabidopsis</italic> genes are too remotely related to the Pfam families.</p>
<sec id="s4a1">
<title>Edge creation performance</title>
<p>Before we evaluate the assembly performance of SAT-Assembler, we first evaluate the performance of the proposed edge creation strategy. We name the overlap threshold of SAT-Assembler <italic>20+consistency</italic> (or <italic>consistency</italic> for simplicity), where 20 is the default threshold for alignment overlap and consistency stands for the consistency between alignment overlap and sequence overlap. We compared edge creation performance of three strategies that used different overlap thresholds: i) 20; ii) 38; iii) consistency. Three metrics were used in the comparison: the number of true positive edges (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e130" xlink:type="simple"/></inline-formula>), the number of false positive edges (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e131" xlink:type="simple"/></inline-formula>), and positive predictive value (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e132" xlink:type="simple"/></inline-formula>), which is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e133" xlink:type="simple"/></inline-formula>. True positive edges connect nodes that are from the same genes. As the number of correct connections is the same for these strategies, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e134" xlink:type="simple"/></inline-formula> is proportional to the sensitivity. Higher <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e135" xlink:type="simple"/></inline-formula> indicates higher sensitivity. False positive edges connect nodes that are from different genes. The performance comparison of three strategies is shown in <xref ref-type="table" rid="pcbi-1003737-t001">Table 1</xref>.</p>
<table-wrap id="pcbi-1003737-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.t001</object-id><label>Table 1</label><caption>
<title>Edge creation performance of three strategies on the <italic>Arabidopsis</italic> RNA-Seq data set.</title>
</caption><alternatives><graphic id="pcbi-1003737-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Strategy</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e136" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e137" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e138" xlink:type="simple"/></inline-formula></td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">20</td>
<td align="left" rowspan="1" colspan="1">1,891,448</td>
<td align="left" rowspan="1" colspan="1">184,792</td>
<td align="left" rowspan="1" colspan="1">91.10%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">38</td>
<td align="left" rowspan="1" colspan="1">1,658,268</td>
<td align="left" rowspan="1" colspan="1">13,469</td>
<td align="left" rowspan="1" colspan="1">99.19%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">consistency</td>
<td align="left" rowspan="1" colspan="1">1,823,196</td>
<td align="left" rowspan="1" colspan="1">69,004</td>
<td align="left" rowspan="1" colspan="1">96.35%</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>The metrics are evaluated on all edges in overlap graphs of 3,163 families.</p></fn></table-wrap-foot></table-wrap>
<p>The consistency strategy provided a better trade-off for edge creation than the stringent overlap threshold of 38 and the very loose overlap threshold of 20. Compared with the 20 threshold strategy, the consistency strategy avoided 115,788 false positive connections at the expense of missing 68,252 positive connections, leading to 5.25% increase in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e139" xlink:type="simple"/></inline-formula>. Compared with the 38 threshold strategy, it successfully captured 164,928 more positive connections, leading to 9.94% increase in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e140" xlink:type="simple"/></inline-formula> at the expense of 2.84% decrease in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e141" xlink:type="simple"/></inline-formula>. This showed that the consistency constraint successfully eliminated a large number of random overlaps while preserving overlaps between many reads from the same genes.</p>
<p>The conservation between transcripts and the input gene family will affect the performance of edge creation. When the conservation is good, the alignment overlap and sequence overlap are generally consistent. Therefore, the consistency strategy is able to capture the true overlaps between reads that are sequenced from the same transcripts. When the conservation between transcripts and the input family is poor, the alignment positions become less accurate. Thus, the two types of overlaps may not be consistent, making the reads from these transcripts fail to be connected by our consistency strategy. This is one main reason that the consistency strategy generated fewer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e142" xlink:type="simple"/></inline-formula> cases than the overlap threshold of 20 in <xref ref-type="table" rid="pcbi-1003737-t001">Table 1</xref>. In our future work, we will incorporate the conservation of genes in our edge creation strategy to increase the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e143" xlink:type="simple"/></inline-formula> edges while maintaining the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e144" xlink:type="simple"/></inline-formula> at a high level.</p>
</sec><sec id="s4a2">
<title>Performance comparison with other assembly tools</title>
<p>Velvet takes a single <italic>k-mer</italic> value for <italic>de novo</italic> assembly. Therefore, we tried <italic>k-mer</italic> sizes from 35 to 61 with a step size of 2. Oases, IDBA-Tran, and Trans-ABySS accept a range of <italic>k-mer</italic> sizes. All of them first generate assemblies on different <italic>k-mer</italic> sizes and then merge them. We ran them with a range of <italic>k-mer</italic> sizes from 35 to 61 with a step size of 2. Trinity uses a fixed <italic>k-mer</italic> size of 25 in its current implementation. We ran it with its default parameters. For SAT-Assembler, we used "consistency" as its edge creation strategy and default values for the other parameters. To compare the consistency strategy with the simple overlap threshold strategy, we also ran SAT-Assembler with an overlap threshold from 35 to 45 with a step size of 2 without the consistency constraint. <xref ref-type="fig" rid="pcbi-1003737-g006">Fig. 6</xref> shows chimera rate versus gene coverage when we changed <italic>k-mer</italic> sizes or overlap thresholds for Velvet, Trinity, and SAT-Assembler. Oases, IDBA-Tran, and Trans-ABySS use a range of <italic>k-mer</italic> sizes and their performance is compared in <xref ref-type="table" rid="pcbi-1003737-t002">Table 2</xref>.</p>
<fig id="pcbi-1003737-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.g006</object-id><label>Figure 6</label><caption>
<title>Chimera rate versus gene coverage.</title>
<p>Chimera rate versus gene coverage when <italic>k-mer</italic> size or overlap threshold changes for different assembly tools. These values are average values of the assemblers' performance on 3,163 input families.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.g006" position="float" xlink:type="simple"/></fig><table-wrap id="pcbi-1003737-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.t002</object-id><label>Table 2</label><caption>
<title>Performance comparison between different assembly tools on the <italic>Arabidopsis</italic> RNA-seq data set.</title>
</caption><alternatives><graphic id="pcbi-1003737-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Tool</td>
<td align="left" rowspan="1" colspan="1">Velvet</td>
<td align="left" rowspan="1" colspan="1">Oases</td>
<td align="left" rowspan="1" colspan="1">Trinity</td>
<td align="left" rowspan="1" colspan="1">IDBA-Tran</td>
<td align="left" rowspan="1" colspan="1">Trans-ABySS</td>
<td align="left" rowspan="1" colspan="1">SAT</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Gene coverage</td>
<td align="left" rowspan="1" colspan="1">82.36%</td>
<td align="left" rowspan="1" colspan="1">81.12%</td>
<td align="left" rowspan="1" colspan="1">81.88%</td>
<td align="left" rowspan="1" colspan="1">81.81%</td>
<td align="left" rowspan="1" colspan="1">78.31%</td>
<td align="left" rowspan="1" colspan="1">80.87%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Chimera rate</td>
<td align="left" rowspan="1" colspan="1">13.36%</td>
<td align="left" rowspan="1" colspan="1">29.24%</td>
<td align="left" rowspan="1" colspan="1">26.14%</td>
<td align="left" rowspan="1" colspan="1">21.74%</td>
<td align="left" rowspan="1" colspan="1">16.41%</td>
<td align="left" rowspan="1" colspan="1">9.05%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Contig length (bp)</td>
<td align="left" rowspan="1" colspan="1">346.89</td>
<td align="left" rowspan="1" colspan="1">455.75</td>
<td align="left" rowspan="1" colspan="1">418.62</td>
<td align="left" rowspan="1" colspan="1">450.64</td>
<td align="left" rowspan="1" colspan="1">355.08</td>
<td align="left" rowspan="1" colspan="1">434.24</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Contig coverage</td>
<td align="left" rowspan="1" colspan="1">63.25%</td>
<td align="left" rowspan="1" colspan="1">84.61%</td>
<td align="left" rowspan="1" colspan="1">71.64%</td>
<td align="left" rowspan="1" colspan="1">78.19%</td>
<td align="left" rowspan="1" colspan="1">62.59%</td>
<td align="left" rowspan="1" colspan="1">76.65%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Memory (MB)</td>
<td align="left" rowspan="1" colspan="1">8034</td>
<td align="left" rowspan="1" colspan="1">22475</td>
<td align="left" rowspan="1" colspan="1">34691</td>
<td align="left" rowspan="1" colspan="1">3770</td>
<td align="left" rowspan="1" colspan="1">4427</td>
<td align="left" rowspan="1" colspan="1">2431</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Time (m)</td>
<td align="left" rowspan="1" colspan="1">140.85</td>
<td align="left" rowspan="1" colspan="1">5128.74</td>
<td align="left" rowspan="1" colspan="1">1145.05</td>
<td align="left" rowspan="1" colspan="1">2774.73</td>
<td align="left" rowspan="1" colspan="1">3593.06</td>
<td align="left" rowspan="1" colspan="1">215.39</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p>The memory usage for all tools is based on a single overlap threshold or <italic>k-mer</italic> and is evaluated as the peak memory usage of the tools. The running time was the average running time on all input families. SAT represents SAT-Assembler here and in all tables hereafter.</p></fn></table-wrap-foot></table-wrap>
<p>Velvet was sensitive to the change of <italic>k-mer</italic> sizes. The largest and smallest gene coverage of Velvet were 82.36% and 60.01% respectively. Its best overall performance was achieved when the <italic>k-mer</italic> size was 39. We also ran VelvetOptimiser <xref ref-type="bibr" rid="pcbi.1003737-Victorian1">[54]</xref> to search for the best assembly result by trying <italic>k</italic>-mer sizes from 35 to 61 bp with “<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e145" xlink:type="simple"/></inline-formula>” as the optimization function. It reported an optimal <italic>k-mer</italic> size of 57, which generated a gene coverage of 66.39% and a chimera rate of 19.74%. The performance of SAT-Assembler was stable when the simple overlap threshold was changed. Overall, using the consistency strategy showed better gene coverage while keeping similar chimera rate compared with the simple overlap threshold.</p>
<p>We further compared the metrics of gene coverage, chimera rate, contig length, contig coverage, memory usage, and running time of different assembly tools when their best performance of gene coverage and chimera rate were achieved in <xref ref-type="table" rid="pcbi-1003737-t002">Table 2</xref>. Contigs generated by all assembly tools covered about 80% of genes on average. SAT-Assembler had the lowest chimera rate due to our consistency-based edge creation strategy and graph traversal algorithm. Oases generated the longest contigs (indicated by contig length and contig coverage) on average. But the price paid was the highest chimera rate, longest running time, and second highest memory usage, even with a single <italic>k-mer</italic> size. As users will likely apply a range of <italic>k-mer</italic> sizes, its memory usage will be further increased. SAT-Assembler had the lowest memory usage and second shortest running time because of the effective classification in the homology search stage. The memory usage and running time of SAT-Assembler include both stages of homology search and <italic>de novo</italic> assembly. Our current implementation of SAT-Assembler uses the Python library of Networkx <xref ref-type="bibr" rid="pcbi.1003737-Hagberg1">[55]</xref>, which contributes to a large portion of both memory usage and running time. We plan to implement SAT-Assembler using C++ in the future.</p>
</sec><sec id="s4a3">
<title>Performance of recovering gene isoforms</title>
<p>The metric of gene coverage in the section of Performance Comparison with Other Assembly Tools shows the overall completeness of assembled contigs in recovering gene isoforms. Some gene isoforms with high gene coverage may be recovered by multiple contigs, which is not desirable for targeted gene assembly. In this section, we focus on the performance of assembly tools on producing contigs that recover complete gene isoforms of <italic>Arabidopsis</italic>. If a single contig recovers more than 90% of a gene isoform, it is defined as a <italic>complete contig</italic>. To compare the ability of different assembly tools in producing complete contigs, we evaluated the percentage of complete contigs generated by different assembly tools. Moreover, to evaluate how accurately these complete contigs recovered gene isoforms, we calculated the percentage of non-chimeric contigs among complete contigs. <xref ref-type="table" rid="pcbi-1003737-t003">Table 3</xref> shows the values of both metrics for different assembly tools.</p>
<table-wrap id="pcbi-1003737-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.t003</object-id><label>Table 3</label><caption>
<title>Performance comparison of different assembly tools on recovering complete gene isoforms of <italic>Arabidopsis</italic>.</title>
</caption><alternatives><graphic id="pcbi-1003737-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.t003" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Metric</td>
<td align="left" rowspan="1" colspan="1">Velvet</td>
<td align="left" rowspan="1" colspan="1">Oases</td>
<td align="left" rowspan="1" colspan="1">Trinity</td>
<td align="left" rowspan="1" colspan="1">IDBA-Tran</td>
<td align="left" rowspan="1" colspan="1">Trans-ABySS</td>
<td align="left" rowspan="1" colspan="1">SAT</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Percentage of complete contigs</td>
<td align="left" rowspan="1" colspan="1">54.76%</td>
<td align="left" rowspan="1" colspan="1">80.17%</td>
<td align="left" rowspan="1" colspan="1">70.40%</td>
<td align="left" rowspan="1" colspan="1">74.73%</td>
<td align="left" rowspan="1" colspan="1">65.22%</td>
<td align="left" rowspan="1" colspan="1">73.93%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Percentage of non-chimeric contigs among complete contigs</td>
<td align="left" rowspan="1" colspan="1">79.12%</td>
<td align="left" rowspan="1" colspan="1">70.37%</td>
<td align="left" rowspan="1" colspan="1">75.65%</td>
<td align="left" rowspan="1" colspan="1">79.03%</td>
<td align="left" rowspan="1" colspan="1">77.97%</td>
<td align="left" rowspan="1" colspan="1">85.78%</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>Oases generated the highest percentage of complete contigs, which was consistent with its high gene coverage and contig length. Velvet had the lowest percentage of complete contigs, showing that it generated a lot of short gene segments. All the other tools had a percentage of complete contigs around 70%. IDBA-Tran had a good overall performance for recovering complete gene isoforms with 74.73% as the percentage of complete contigs and 79.03% as the percentage of non-chimeric contigs. SAT-Assembler had the highest percentage of non-chimeric contigs with 73.93% of its contigs as complete contigs. Its percentage of complete contigs is 0.8% lower than that of IDBA-Tran and its percentage of non-chimeric rate is 6.75% higher than that of IDBA-Tran. Because some true gene reads did not pass the homology search stage, some contigs generated by SAT-Assembler were segmented and not able to recover complete gene isoforms. However, it had the best performance on distinguising gene isoforms due to AS events. We plan to increase the sensitivity of the homology search stage using strategies such as PSST <xref ref-type="bibr" rid="pcbi.1003737-Zhang1">[47]</xref>, <xref ref-type="bibr" rid="pcbi.1003737-Zhang2">[56]</xref> to achieve better overall performance of recovering gene isoforms for RNA-Seq data.</p>
</sec></sec><sec id="s4b">
<title>Targeted gene assembly in a metagenomic data set from synthetic communities</title>
<p>In this experiment, we conducted targeted gene assembly using a metagenomic data set sequenced from highly diverse <italic>bacterial</italic> and <italic>archaeal</italic> synthetic communities with 16 <italic>archaea</italic> members and 48 <italic>bacteria</italic> members <xref ref-type="bibr" rid="pcbi.1003737-Shakya1">[57]</xref>. We downloaded all reference genomes from NCBI ftp site (ftp.ncbi.nih.gov/genomes/). The metagenomic data set was downloaded from NCBI Sequence Read Archive (SRA) (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sra" xlink:type="simple">http://www.ncbi.nlm.nih.gov/sra</ext-link>) using Accession No. SRA059004. After we trimmed low-quality reads, there were 51,933,622 paired-end reads with an average read length of 100 bp. We were interested in assembling the family of butyrate kinase pathway genes, which play important roles in butyrate synthesis. We downloaded the profile HMM of the family from RDP's functional gene repository <xref ref-type="bibr" rid="pcbi.1003737-Fish1">[58]</xref>. It was built from 77 seed butyrate kinase pathway genes. The seed genes are not in the genomes. We annotated the butyrate kinase gene regions in the genomes by aligning reference genomes against the gene family using HMMER with gathering thresholds (GAs). We compared the performance of Velvet, IDBA-UD, MetaVelvet, and SAT-Assembler on assembling contigs from these regions. IDBA-UD and MetaVelvet are both de Bruijn graph based and specially designed for <italic>de novo</italic> assembly of metagenomic data.</p>
<p>We used VelvetOptimiser to search for the best assembly result by trying <italic>k-mer</italic> sizes from 53 to 83 bp with “<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e146" xlink:type="simple"/></inline-formula>” as the optimization function. VelvetOptimiser reported 55 as the optimal <italic>k-mer</italic> size. For IDBA-UD, which accepts multiple <italic>k-mer</italic> values, we used the same range of <italic>k-mer</italic> sizes as Velvet in a single run. Meta-Velvet used the hash table generated by Velvet and its <italic>k-mer</italic> size was thus 55 as well. For SAT-Assembler, we used its default parameters. A total of 15,254 reads were classified into the butyrate kinase family by the homology search stage, which accounted for 0.15% of the query reads. <xref ref-type="table" rid="pcbi-1003737-t004">Table 4</xref> shows a performance comparison between these assembly tools.</p>
<table-wrap id="pcbi-1003737-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.t004</object-id><label>Table 4</label><caption>
<title>Performance comparison between different assembly tools in assembling genes from butyrate kinase family on the synthetic metagenomic data set.</title>
</caption><alternatives><graphic id="pcbi-1003737-t004-4" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.t004" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Assembly tool</td>
<td align="left" rowspan="1" colspan="1">Velvet</td>
<td align="left" rowspan="1" colspan="1">IDBA-UD</td>
<td align="left" rowspan="1" colspan="1">MetaVelvet</td>
<td align="left" rowspan="1" colspan="1">SAT-Assembler</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Gene coverage</td>
<td align="left" rowspan="1" colspan="1">68.17%</td>
<td align="left" rowspan="1" colspan="1">75.08%</td>
<td align="left" rowspan="1" colspan="1">79.68%</td>
<td align="left" rowspan="1" colspan="1">88.37%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Chimera rate</td>
<td align="left" rowspan="1" colspan="1">26.31%</td>
<td align="left" rowspan="1" colspan="1">12.54%</td>
<td align="left" rowspan="1" colspan="1">16.12%</td>
<td align="left" rowspan="1" colspan="1">8.43%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Contig length (bp)</td>
<td align="left" rowspan="1" colspan="1">367.89</td>
<td align="left" rowspan="1" colspan="1">592.29</td>
<td align="left" rowspan="1" colspan="1">440.94</td>
<td align="left" rowspan="1" colspan="1">487.68</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Contig coverage</td>
<td align="left" rowspan="1" colspan="1">35.81%</td>
<td align="left" rowspan="1" colspan="1">56.62%</td>
<td align="left" rowspan="1" colspan="1">42.35%</td>
<td align="left" rowspan="1" colspan="1">46.69%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Memory usage (MB)</td>
<td align="left" rowspan="1" colspan="1">41404</td>
<td align="left" rowspan="1" colspan="1">15162</td>
<td align="left" rowspan="1" colspan="1">18340</td>
<td align="left" rowspan="1" colspan="1">307</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Time (m)</td>
<td align="left" rowspan="1" colspan="1">1262.87</td>
<td align="left" rowspan="1" colspan="1">956.38</td>
<td align="left" rowspan="1" colspan="1">817.11</td>
<td align="left" rowspan="1" colspan="1">1093.86</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt103"><label/><p>The memory usage for all tools is based on a single overlap threshold or <italic>k-mer</italic> and is evaluated as the peak memory usage of the tools. The running time was the average running time on all input families.</p></fn></table-wrap-foot></table-wrap>
<p>SAT-Assembler had the best gene coverage, chimera rate, and memory usage. Its contigs were usually shorter than IDBA-UD. A closer examination reveals the reason: a number of reads did not pass the profile HMM homology search and thus were not used as input to assembly. Gene coverage of assembly tools in this experiment was much lower than in the first experiment because of lower sequencing depth and higher data complexity. MetaVelvet had the best running time performance because it directly used the optimal <italic>k-mer</italic> size and hash table from VelvetOptimiser while Velvet and IDBA-UD both ran a range of <italic>k-mer</italic> sizes. The low memory usage of SAT-Assembler further showed the advantage of using homology search in targeted gene assembly for large-scale NGS data. Due to the high complexity of the metagenomic data set, SAT-Assembler constructed a much more complex overlap graph compared with the overlap graphs in the first experiment, leading to higher runtime overhead. <xref ref-type="table" rid="pcbi-1003737-t004">Table 4</xref> shows that none of the tested assembly tools is the best in all metrics. If users prefer high gene coverage and high accuracy, especially on hardware with limited resources, we recommend SAT-Assembler. If long contigs and high contig coverage are more important, IDBA-UD is the best choice.</p>
</sec><sec id="s4c">
<title>Targeted gene assembly in a human gut metagenomic data set</title>
<p>In this experiment, we compared the performance of SAT-Assembler with Velvet, IDBA-UD, and MetaVelvet on a human gut metagenomic data set. There were 47,117,906 paired-end and 5,528,102 unpaired reads of various lengths. The average length of the query reads was 95.72 bp and 75% of them were 100 bp. We were interested in assembling butyrate kinase pathway genes as in the second experiment. The profile HMM of the gene family was built from 77 seed genes from RDP's functional gene repository <xref ref-type="bibr" rid="pcbi.1003737-Fish1">[58]</xref>. We also downloaded a set of 2,352 annotated genes of butyrate kinase family and eliminated the seed genes from them. By using read mapping, a total of 58 genes with at least 10 mapped reads were identified and were used to evaluate the performance of all assembly tools.</p>
<p>We used VelvetOptimiser to search for the best assembly result by trying <italic>k-mer</italic> sizes from 51 to 81 bp with “<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e147" xlink:type="simple"/></inline-formula>” as the optimization function. VelvetOptimiser reported 51 as the optimal <italic>k-mer</italic> size. For IDBA-UD, which accepts multiple <italic>k-mer</italic> values, we used the same range of <italic>k-mer</italic> sizes as Velvet in a single run. Meta-Velvet used the hash table generated by Velvet and its <italic>k-mer</italic> size was thus 51 as well. For SAT-Assembler, we used its default parameters. A total of 16,136 reads were classified into the butyrate kinase family by the homology search stage, which accounted for 0.31% of the query reads. <xref ref-type="table" rid="pcbi-1003737-t005">Table 5</xref> shows a performance comparison between these assembly tools.</p>
<table-wrap id="pcbi-1003737-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.t005</object-id><label>Table 5</label><caption>
<title>Performance comparison between different assembly tools in assembling genes from butyrate kinase family on the human gut metagenomic data set.</title>
</caption><alternatives><graphic id="pcbi-1003737-t005-5" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.t005" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Assembly tool</td>
<td align="left" rowspan="1" colspan="1">Velvet</td>
<td align="left" rowspan="1" colspan="1">IDBA-UD</td>
<td align="left" rowspan="1" colspan="1">MetaVelvet</td>
<td align="left" rowspan="1" colspan="1">SAT-Assembler</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Gene coverage</td>
<td align="left" rowspan="1" colspan="1">51.97%</td>
<td align="left" rowspan="1" colspan="1">60.55%</td>
<td align="left" rowspan="1" colspan="1">43.52%</td>
<td align="left" rowspan="1" colspan="1">68.89%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Chimera rate</td>
<td align="left" rowspan="1" colspan="1">59.26%</td>
<td align="left" rowspan="1" colspan="1">36.67%</td>
<td align="left" rowspan="1" colspan="1">36.73%</td>
<td align="left" rowspan="1" colspan="1">16.87%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Contig length (bp)</td>
<td align="left" rowspan="1" colspan="1">505.70</td>
<td align="left" rowspan="1" colspan="1">738.64</td>
<td align="left" rowspan="1" colspan="1">672.66</td>
<td align="left" rowspan="1" colspan="1">661.35</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Contig coverage</td>
<td align="left" rowspan="1" colspan="1">38.99%</td>
<td align="left" rowspan="1" colspan="1">62.06%</td>
<td align="left" rowspan="1" colspan="1">49.30%</td>
<td align="left" rowspan="1" colspan="1">48.56%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Memory usage (MB)</td>
<td align="left" rowspan="1" colspan="1">41248</td>
<td align="left" rowspan="1" colspan="1">16648</td>
<td align="left" rowspan="1" colspan="1">20330</td>
<td align="left" rowspan="1" colspan="1">283</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Time (m)</td>
<td align="left" rowspan="1" colspan="1">1736.08</td>
<td align="left" rowspan="1" colspan="1">1065.77</td>
<td align="left" rowspan="1" colspan="1">834.10</td>
<td align="left" rowspan="1" colspan="1">1530.63</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt104"><label/><p>The memory usage for all tools is based on a single overlap threshold or <italic>k-mer</italic> and is evaluated as the peak memory usage of the tools. The running time was the average running time on all input families.</p></fn></table-wrap-foot></table-wrap>
<p>In this experiment, the result of performance comparison was similar to the second experiment. SAT-Assembler still had the best gene coverage, chimera rate, and memory usage. IDBA-UD had the best contig length and contig coverage. Compared with the second experiment, the chimera rates of all assembly tools increased. Without knowing all reference genomes, the computed chimera rates might be an over-estimation for all tools because the assembled contigs may contain novel members of the family.</p>
</sec></sec><sec id="s5">
<title>Discussion</title>
<p>The experiments on RNA-Seq and metagenomic data sets show that our novel consistency-based edge creation strategy and guided graph traversal can effectively avoid chimeric contigs. Moreover, by reducing the original search space into a much smaller subset of reads from targeted genes, the memory usage was significantly decreased, making it a more economical tool for the assembly of targeted genes from a single or multiple pathways. We have also tried to use Velvet and Trinity on the reads that passed the homology search stage on the <italic>Arabidopsis</italic> RNA-Seq data set. The gene coverage and chimera rate of Velvet were 64.38% and 17.25% respectively. The gene coverage and chimera rate of Trinity were 78.72% and 22.90% respectively. Compared with the performance when using Velvet and Trinity directly on the input data set, their gene coverages were decreased. One reason is that the homology search stage does not have 100% sensitivity. The missed reads may lead to poorer performance of Velvet and Trinity.</p>
<p>SAT-Assembler also provides an easier way for users to set the parameters. Our edge creation strategy is based on both the overlap threshold (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e148" xlink:type="simple"/></inline-formula>) and the consistency between alignment overlap and sequence overlap (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e149" xlink:type="simple"/></inline-formula>). The consistency strategy poses a strong constraint on the overlap between two reads. The alignment overlap threshold <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e150" xlink:type="simple"/></inline-formula> is mainly used to avoid random overlaps, which are generally very small. The default overlap threshold 20 is chosen based on the length of the reads in our experimental data sets. This value is smaller than the <italic>k-mer</italic> value chosen by VelvetOptimiser for other assembly tools. This helps us generate better connectivity between reads from the same genes. At the same time, the consistency constraint guarantees the accuracy of the edge creation (<xref ref-type="table" rid="pcbi-1003737-t001">Table 1</xref>). We have also tried different <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e151" xlink:type="simple"/></inline-formula> values from 15 to 30 and found that the edge creation performance is not sensitive to the choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e152" xlink:type="simple"/></inline-formula> unless a very large value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e153" xlink:type="simple"/></inline-formula> is used. The values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e154" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e155" xlink:type="simple"/></inline-formula> control the trade-off between sensitivity and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e156" xlink:type="simple"/></inline-formula> of edge creation. Users can adjust them based on their specific need. Based on our observation, an overlap threshold that is 20% of the read length is recommended. The value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003737.e157" xlink:type="simple"/></inline-formula> is independent of the read length and we suggest that users use the default value.</p>
<p>There are still some challenges to address to further improve SAT-Assembler's performance. First, gene segments from some poorly conserved gene regions are fragmented because some reads from these regions fail to pass the homology search. We have aligned all the reads in the human gut metagenomic data set against protein/domain families in Pfam using HMMER and 38.65% of them have HMMER hits. There are three main reasons for the low coverage of Pfam domains in the metagenomic data set: i) Pfam is a collection of protein/domain families. Therefore, reads sequenced from intergenic regions will not have hits. In addition, even reads sequenced from protein-coding regions may not be part of any domain. They will not have hits either. ii) Some genes of the microbial species are very remotely homologous to the families in Pfam. iii) Some reads in the metagenomic data set are very short, resulting in low sensitivity of HMMER <xref ref-type="bibr" rid="pcbi.1003737-Zhang1">[47]</xref>. This problem can be alleviated by increasing the sensitivity of the homology search. In the future, we will incorporate our proposed position-specific score threshold (PSST) <xref ref-type="bibr" rid="pcbi.1003737-Zhang1">[47]</xref>, <xref ref-type="bibr" rid="pcbi.1003737-Zhang2">[56]</xref> into SAT-Assembler to classify more reads into their native families.</p>
<p>Second, although the edge creation strategy of SAT-Assembler captured more overlaps between reads from the same genes, some positive overlaps still failed to be captured. When the conservation between the input family and target genes is not good, the alignment overlap and sequence overlap may not always be consistent. Therefore, reads from poorly conserved regions of the genes may lose consistency between their alignment overlaps and sequence overlaps. In this case, connectivity between these reads will not be captured by SAT-Assembler's edge creation strategy, leading to segmented contigs in the final assemblies. <xref ref-type="fig" rid="pcbi-1003737-g007">Fig. 7</xref> shows an example of missing edge connection due to poor conservation between gene isoforms and the input family. Both gene isoforms are from the same family X. The first gene isoform has a global alignment against Family X while the skipped exon 2 in the second gene isoform leads to two local alignments. According to our edge creation strategy, all the reads in the first gene isoform can be correctly connected. However, because the green read shares sequence overlap but no alignment overlap with neighboring reads, there will be no edge between the green read and its neighboring reads, leading to two disconnected contigs. In this case, the two contigs can usually be connected in our scaffolding stage using paired-end reads. As part of our future work, we will take into consideration the conservation between target genes and the family to improve our edge creation strategy. Moreover, insertion/deletion (indel) or substitution errors in the overlapping regions may also lead to false negative connections. Masella et al. <xref ref-type="bibr" rid="pcbi.1003737-Masella1">[59]</xref> proposed a sophisticated method that can probabilistically correct these errors based on the overlap data from the paired-end reads. HMM-FRAME <xref ref-type="bibr" rid="pcbi.1003737-Zhang3">[60]</xref> can be used to accurately detect and correct indel errors using profile HMM-based homology search. We plan to incorporate these methods in our edge creation strategy to generate more positive connections.</p>
<fig id="pcbi-1003737-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003737.g007</object-id><label>Figure 7</label><caption>
<title>Poor conservation can lead to loss of edge connection.</title>
<p>(A) Gene isoforms due to AS events. Constitutive exons are shown in blue and alternatively spliced regions in yellow. Introns are represented by solid lines, and dashed lines indicate splicing options. (B) Two gene isoforms and their sequenced reads. The red lines represent reads sequenced from exons shared by both isoforms. The purple and green lines represent reads that are exclusively sequenced from each isoform. Both isoforms can be aligned with Family X. The isoform containing exons 1, 2, and 3 has a global alignment while the isoform containing exons 1 and 3 produces two local alignments.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003737.g007" position="float" xlink:type="simple"/></fig>
<p>Third, the running time of the graph traversal stage is the bottleneck of SAT-Assembler, especially for complex metagenomic data. Therefore, we plan to add more bounding strategies into the graph traversal, such as a more stringent threshold for critical supports. Moreover, we will implement SAT-Assembler using C++ to reduce its running time.</p>
</sec><sec id="s6">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003737.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003737.s001" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Supplementary material.</bold> Pseudocodes and experimental settings.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank C. Titus Brown for helpful discussions about the experiments.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003737-MutasaGttgens1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mutasa-Göttgens</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Joshi</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Holmes</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Hedden</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Gottgens</surname><given-names>B</given-names></name> (<year>2012</year>) <article-title>A new RNAseq-based reference transcriptome for sugar beet and its application in transcriptome-scale analysis of vernalization and gibberellin responses</article-title>. <source>BMC Genomics</source> <volume>13</volume>: <fpage>99</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Orshinsky1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Orshinsky</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Hu</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Opiyo</surname><given-names>SO</given-names></name>, <name name-style="western"><surname>Reddyvari-Channarayappa</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Mitchell</surname><given-names>TK</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>RNA-seq analysis of the Sclerotinia homoeocarpa Creeping Bentgrass Pathosystem</article-title>. <source>PLOS ONE</source> <volume>7</volume>: <fpage>e41150</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Li1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Yan</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Fei</surname><given-names>Z</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>RNA-seq improves annotation of proteincoding genes in the cucumber genome</article-title>. <source>BMC Genomics</source> <volume>12</volume>: <fpage>540</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Schmid1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schmid</surname><given-names>MW</given-names></name>, <name name-style="western"><surname>Schmidt</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Klostermeier</surname><given-names>UC</given-names></name>, <name name-style="western"><surname>Barann</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rosenstiel</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>A powerful method for transcriptional profiling of specific cell types in eukaryotes: laser-assisted microdissection and RNA sequencing</article-title>. <source>PLOS ONE</source> <volume>7</volume>: <fpage>e29685</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Tringe1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tringe</surname><given-names>SG</given-names></name>, <name name-style="western"><surname>Von Mering</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Kobayashi</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Salamov</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Comparative metagenomics of microbial communities</article-title>. <source>Science</source> <volume>308</volume>: <fpage>554</fpage>–<lpage>557</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Markowitz1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Markowitz</surname><given-names>VM</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>IM</given-names></name>, <name name-style="western"><surname>Palaniappan</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Chu</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Szeto</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>IMG: the Integrated Microbial Genomes database and comparative analysis system</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>D115</fpage>–<lpage>122</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Hunter1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hunter</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Corbett</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Denise</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Fraser</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gonzalez-Beltran</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>EBI metagenomics - a new resource for the analysis and archiving of metagenomic data</article-title>. <source>Nucleic Acids Research</source> <volume>42</volume>: <fpage>D600</fpage>–<lpage>D606</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Lingner1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lingner</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Aβhauer</surname><given-names>KP</given-names></name>, <name name-style="western"><surname>Schreiber</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Meinicke</surname><given-names>P</given-names></name> (<year>2011</year>) <article-title>CoMet - a web server for comparative functional profiling of metagenomes</article-title>. <source>Nucleic Acids Research</source> <volume>39</volume>: <fpage>W518</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Aziz1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aziz</surname><given-names>RK</given-names></name>, <name name-style="western"><surname>Bartels</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Best</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>DeJongh</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Disz</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>The RAST Server: rapid annotations using subsystems technology</article-title>. <source>BMC Genomics</source> <volume>9</volume>: <fpage>75</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Jeffrey1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jeffrey</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Zhong</surname><given-names>W</given-names></name> (<year>2011</year>) <article-title>Next-generation transcriptome assembly</article-title>. <source>Nature Reviews Genetics</source> <volume>12</volume>: <fpage>671</fpage>–<lpage>682</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Zerbino1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zerbino</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Birney</surname><given-names>E</given-names></name> (<year>2008</year>) <article-title>Velvet: Algorithms for de novo short read assembly using de Bruijn graphs</article-title>. <source>Genome Res</source> <volume>18</volume>: <fpage>821</fpage>–<lpage>829</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Schulz1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schulz</surname><given-names>HM</given-names></name>, <name name-style="western"><surname>Daniel</surname><given-names>RZ</given-names></name>, <name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Birney</surname><given-names>E</given-names></name> (<year>2012</year>) <article-title>Oases: robust de novo RNA-seq assembly across the dynamic range of expression levels</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>1086</fpage>–<lpage>1092</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Grabherr1"><label>13</label>
<mixed-citation publication-type="other" xlink:type="simple">Grabherr MG, Haas BJ, Yassour M, Levin JZ, Thompson DA, <etal>et al</etal>.. (2011) Full-length transcriptome assembly from RNA-Seq data without a reference genome. Nature Biotechnology: 644–652.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Birol1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Birol</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Jackman</surname><given-names>SD</given-names></name>, <name name-style="western"><surname>Nielsen</surname><given-names>CB</given-names></name>, <name name-style="western"><surname>Qian</surname><given-names>JQ</given-names></name>, <name name-style="western"><surname>Varhol</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>De novo transcriptome assembly with ABySS</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>2872</fpage>–<lpage>2877</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Peng1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peng</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Leung</surname><given-names>HC</given-names></name>, <name name-style="western"><surname>Yiu</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Lv</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>XG</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>IDBA-tran: a more robust de novo de Bruijn graph assembler for transcriptomes with uneven expression levels</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>i326</fpage>–<lpage>334</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Robertson1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robertson</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Schein</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Chiu</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Corbett</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Field</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>De novo assembly and analysis of RNA-seq data</article-title>. <source>Nat Methods</source> <volume>7</volume>: <fpage>909</fpage>–<lpage>912</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Trapnell1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trapnell</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>BA</given-names></name>, <name name-style="western"><surname>Pertea</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Mortazavi</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kwan</surname><given-names>G</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat Biotechnol</source> <volume>28</volume>: <fpage>511</fpage>–<lpage>515</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Namiki1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Namiki</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hachiya</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Tanaka</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Sakakibara</surname><given-names>Y</given-names></name> (<year>2012</year>) <article-title>MetaVelvet: an extension of Velvet assembler to de novo metagenome assembly from short sequence reads</article-title>. <source>Nucleic Acids Research</source> <volume>40</volume>: <fpage>e155</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Treangen1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Treangen</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Koren</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sommer</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Astrovskaya</surname><given-names>I</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>MetAMOS: a modular and open source metagenomic assembly and analysis pipeline</article-title>. <source>Genome Biology</source> <volume>14</volume>: <fpage>R2</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Laserson1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Laserson</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Jojic</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Koller</surname><given-names>D</given-names></name> (<year>2011</year>) <article-title>Genovo: de novo assembly for metagenomes</article-title>. <source>J Comput Biol</source> <volume>18</volume>: <fpage>429</fpage>–<lpage>443</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Peng2"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peng</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Leung</surname><given-names>HCM</given-names></name>, <name name-style="western"><surname>Yiu</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Chin</surname><given-names>FYL</given-names></name> (<year>2011</year>) <article-title>Meta-IDBA: a de novo assembler for metagenomic data</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>i94</fpage>–<lpage>i101</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Luo1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Luo</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Tsementzi</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Kyrpides</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Konstantinidis</surname><given-names>K</given-names></name> (<year>2012</year>) <article-title>Individual genome assembly from complex community short-read metagenomic datasets</article-title>. <source>ISME J</source> <volume>6</volume>: <fpage>898</fpage>–<lpage>901</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Salzberg1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Sommer</surname><given-names>DD</given-names></name>, <name name-style="western"><surname>Puiu</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>VT</given-names></name> (<year>2008</year>) <article-title>Gene-boosted assembly of a novel bacterial genome from very short reads</article-title>. <source>PLOS Comput Biol</source> <volume>4</volume>: <fpage>e1000186</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Wu1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>YW</given-names></name>, <name name-style="western"><surname>Rho</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Doak</surname><given-names>TG</given-names></name>, <name name-style="western"><surname>Ye</surname><given-names>Y</given-names></name> (<year>2012</year>) <article-title>Stitching gene fragments with a network matching algorithm improves gene assembly for metagenomics</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>i363</fpage>–<lpage>i369</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Mackelprang1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mackelprang</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Waldrop</surname><given-names>MP</given-names></name>, <name name-style="western"><surname>DeAngelis</surname><given-names>KM</given-names></name>, <name name-style="western"><surname>David</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Chavarria</surname><given-names>KL</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Metagenomic analysis of a permafrost microbial community reveals a rapid response to thaw</article-title>. <source>Nature</source> <volume>480</volume>: <fpage>368</fpage>–<lpage>371</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Zhao1"><label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Zhao Q, Wang Y, Kong Y, Luo D, Li XL, <etal>et al</etal>.. (2011) Optimizing de novo transcriptome assembly from short-read RNA-Seq data: a comparative study. BMC Bioinformatics <volume>12</volume> (Suppl 14).</mixed-citation>
</ref>
<ref id="pcbi.1003737-Pop1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pop</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Phillippy</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Delcher</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2004</year>) <article-title>Comparative genome assembly</article-title>. <source>Briefings in Bioinformatics</source> <volume>5</volume>: <fpage>237</fpage>–<lpage>248</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Rausch1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rausch</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Koren</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Denisov</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Weese</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Emde</surname><given-names>AK</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>A consistency-based consensus algorithm for de novo and reference-guided sequence assembly of short reads</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>1118</fpage>–<lpage>1124</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Dutilh1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dutilh</surname><given-names>BE</given-names></name>, <name name-style="western"><surname>Huynen</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Strous</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Increasing the coverage of a metapopulation consensus genome by iterative read mapping and assembly</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>2878</fpage>–<lpage>2881</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-SurgetGroba1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Surget-Groba</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Montoya-Burgos</surname><given-names>JI</given-names></name> (<year>2010</year>) <article-title>Optimization of de novo transcriptome assembly from next-generation sequencing data</article-title>. <source>Genome Research</source> <volume>20</volume>: <fpage>1432</fpage>–<lpage>1440</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Nijkamp1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nijkamp</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Winterbach</surname><given-names>W</given-names></name>, <name name-style="western"><surname>van den Broek</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Daran</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Reinders</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Integrating genome assemblies with MAIA</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>i433</fpage>–<lpage>439</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Klein1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klein</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Ossowski</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Schneeberger</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Weigel</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Huson</surname><given-names>DH</given-names></name> (<year>2011</year>) <article-title>LOCAS–a low coverage assembly tool for resequencing projects</article-title>. <source>PLOS ONE</source> <volume>6</volume>: <fpage>e23455</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Ji1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ji</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Shi</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Ding</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>Y</given-names></name> (<year>2011</year>) <article-title>A new strategy for better genome assembly from very short reads</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>493</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Nishito1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nishito</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Osana</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Hachiya</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Popendorf</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Toyoda</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Whole genome assembly of a natto production strain Bacillus subtilis natto from very short read data</article-title>. <source>BMC Genomics</source> <volume>11</volume>: <fpage>243</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Li2"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>YI</given-names></name>, <name name-style="western"><surname>Copley</surname><given-names>RR</given-names></name> (<year>2013</year>) <article-title>Scaffolding low quality genomes using orthologous protein sequences</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>160</fpage>–<lpage>165</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Trapnell2"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trapnell</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2009</year>) <article-title>TopHat: discovering splice junctions with RNASeq</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>1105</fpage>–<lpage>1111</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Langmead1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Langmead</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Trapnell</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Pop</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2009</year>) <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome Biol</source> <volume>10</volume>: <fpage>R25</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Altschul1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>, <name name-style="western"><surname>Gish</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name>, <name name-style="western"><surname>Lipmanl</surname><given-names>DJ</given-names></name> (<year>1990</year>) <article-title>Basic local alignment search tool</article-title>. <source>Journal of Molecular Biology</source> <volume>215</volume>: <fpage>403</fpage>–<lpage>410</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Finn1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Finn</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Mistry</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Tate</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Coggill</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Heger</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Research</source> <volume>38</volume>: <fpage>D211</fpage>–<lpage>D222</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Punta1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Punta</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Coggill</surname><given-names>PC</given-names></name>, <name name-style="western"><surname>Eberhardt</surname><given-names>RY</given-names></name>, <name name-style="western"><surname>Mistry</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Tate</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>290</fpage>–<lpage>301</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Haft1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haft</surname><given-names>DH</given-names></name>, <name name-style="western"><surname>Selengut</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>White</surname><given-names>O</given-names></name> (<year>2003</year>) <article-title>The TIGRFAMs database of protein families</article-title>. <source>Nucleic Acids Research</source> <volume>31</volume>: <fpage>371</fpage>–<lpage>373</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Meyer1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Overbeek</surname><given-names>R</given-names></name>, <name name-style="western"><surname>A</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>FIGfams: yet another set of protein families</article-title>. <source>Nucleic Acids Research</source> <volume>37</volume>: <fpage>6643</fpage>–<lpage>6654</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Quevillon1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quevillon</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Silventoinen</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Pillai</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Harte</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Mulder</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>InterProScan: protein domains identifier</article-title>. <source>Nucleic Acids Research</source> <volume>33</volume>: <fpage>W116</fpage>–<lpage>W120</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Eddy1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name> (<year>2009</year>) <article-title>A new generation of homology search tools based on probabilistic inference</article-title>. <source>Genome Inform</source> <volume>23</volume>: <fpage>205</fpage>–<lpage>11</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Durbin1"><label>45</label>
<mixed-citation publication-type="other" xlink:type="simple">Durbin R, Eddy SR, Krogh A, Mitchison G (1998) Biological Sequence Analysis Probabilistic Models of Proteins and Nucleic Acids. UK: Cambridge University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Wommack1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wommack</surname><given-names>KE</given-names></name>, <name name-style="western"><surname>Bhavsar</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ravel</surname><given-names>J</given-names></name> (<year>2008</year>) <article-title>Metagenomics: read length matters</article-title>. <source>Appl Environ Microbiol</source> <volume>74</volume>: <fpage>1453</fpage>–<lpage>1463</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Zhang1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>Y</given-names></name> (2012) <article-title>Metadomain: a profile HMM-based protein domain classification tool for short sequences</article-title>. <source>Pac Symp Biocomput</source>: <fpage>271</fpage>–<lpage>282</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Myers1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name> (<year>2005</year>) <article-title>The fragment assembly string graph</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>ii79</fpage>–<lpage>ii85</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Simpson1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simpson</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Efficient construction of an assembly string graph using the FM-index</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>i367</fpage>–<lpage>i373</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Simpson2"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simpson</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name> (<year>2012</year>) <article-title>Efficient de novo assembly of large genomes using compressed data structures</article-title>. <source>Genome Res</source> <volume>22</volume>: <fpage>549</fpage>–<lpage>556</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Keren1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Keren</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lev-Maor</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Ast</surname><given-names>G</given-names></name> (<year>2010</year>) <article-title>Alternative splicing and evolution: diversification, exon definition and function</article-title>. <source>Nat Rev Genet</source> <volume>11</volume>: <fpage>345</fpage>–<lpage>355</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Marquez1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marquez</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>WJ</given-names></name>, <name name-style="western"><surname>Simpson</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Barta</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kalyna</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>Transcriptome survey reveals increased complexity of the alternative splicing landscape in Arabidopsis</article-title>. <source>Genome Res</source> <volume>22</volume>: <fpage>1184</fpage>–<lpage>1195</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Carnegie1"><label>53</label>
<mixed-citation publication-type="other" xlink:type="simple">Carnegie Institution for Science Department of Plant Biology (2013). TAIR: The Arabidopsis Information Resource. Available: <ext-link ext-link-type="uri" xlink:href="http://www.arabidopsis.org" xlink:type="simple">www.arabidopsis.org</ext-link>. Accessed 1 October 2013.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Victorian1"><label>54</label>
<mixed-citation publication-type="other" xlink:type="simple">Victorian Bioinformatics Consortium (2012). Velvetoptimiser. Available: bioinformatics. net.au/software.velvetoptimiser.shtml. Accessed 22 October 2012.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Hagberg1"><label>55</label>
<mixed-citation publication-type="other" xlink:type="simple">Hagberg A, Schult D, Swart P (2013). NetworkX: High-productivity software for complex networks. Available: <ext-link ext-link-type="uri" xlink:href="http://networkx.github.io/" xlink:type="simple">http://networkx.github.io/</ext-link>. Accessed August 2013.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Zhang2"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Cole</surname><given-names>JR</given-names></name> (<year>2013</year>) <article-title>A Sensitive and Accurate protein domain classification Tool (SALT) for short reads</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>2103</fpage>–<lpage>2111</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Shakya1"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shakya</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Quince</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Campbell</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>ZK</given-names></name>, <name name-style="western"><surname>Schadt</surname><given-names>CW</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Comparative metagenomic and rRNA microbial diversity characterization using archaeal and bacterial synthetic communities</article-title>. <source>Environ Microbiol</source> <volume>15</volume>: <fpage>1882</fpage>–<lpage>1899</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Fish1"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fish</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Chai</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>CT</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>FunGene: the functional gene pipeline and repository</article-title>. <source>Front Microbiol</source> <volume>4</volume>: <fpage>291</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Masella1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Masella</surname><given-names>AP</given-names></name>, <name name-style="western"><surname>Bartram</surname><given-names>AK</given-names></name>, <name name-style="western"><surname>Truszkowski</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>DG</given-names></name>, <name name-style="western"><surname>Neufeld</surname><given-names>JD</given-names></name> (<year>2012</year>) <article-title>PANDAseq: paired-end assembler for illumina sequences</article-title>. <source>BMC Bioinformatics</source> <volume>13</volume>: <fpage>31</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003737-Zhang3"><label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>Y</given-names></name> (<year>2011</year>) <article-title>HMM-FRAME: accurate protein domain classification for metagenomic sequences containing frameshift errors</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>198</fpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>