<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-00398</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006361</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Software engineering</subject><subj-group><subject>Preprocessing</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Software engineering</subject><subj-group><subject>Preprocessing</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Industrial engineering</subject><subj-group><subject>Quality control</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Information technology</subject><subj-group><subject>Data processing</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Gene mapping</subject><subj-group><subject>Exon mapping</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Gene mapping</subject><subj-group><subject>Exon mapping</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical elements</subject><subj-group><subject>Chromium</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Software engineering</subject><subj-group><subject>Software tools</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Software engineering</subject><subj-group><subject>Software tools</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>scPipe: A flexible R/Bioconductor preprocessing pipeline for single-cell RNA-sequencing data</article-title>
<alt-title alt-title-type="running-head">scPipe: An R/Bioconductor preprocessing pipeline for single-cell RNA-sequencing data</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3420-3685</contrib-id>
<name name-style="western">
<surname>Tian</surname> <given-names>Luyi</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Su</surname> <given-names>Shian</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Dong</surname> <given-names>Xueyi</given-names></name>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Amann-Zalcenstein</surname> <given-names>Daniela</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Biben</surname> <given-names>Christine</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Seidi</surname> <given-names>Azadeh</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hilton</surname> <given-names>Douglas J.</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Naik</surname> <given-names>Shalin H.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7383-0609</contrib-id>
<name name-style="western">
<surname>Ritchie</surname> <given-names>Matthew E.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Molecular Medicine Division, The Walter and Eliza Hall Institute of Medical Research, Parkville, Australia</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Medical Biology, The University of Melbourne, Parkville, Australia</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>College of Life Science, Zhejiang University, Hangzhou, Zhejiang Province, P.R. China</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Australian Genome Research Facility, Parkville, Australia</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>School of Mathematics and Statistics, The University of Melbourne, Parkville, Australia</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Pertea</surname> <given-names>Mihaela</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Johns Hopkins University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">tian.l@wehi.edu.au</email> (LT); <email xlink:type="simple">mritchie@wehi.edu.au</email> (MER)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>10</day>
<month>8</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>8</issue>
<elocation-id>e1006361</elocation-id>
<history>
<date date-type="received">
<day>11</day>
<month>3</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>7</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Tian et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006361"/>
<abstract>
<p>Single-cell RNA sequencing (scRNA-seq) technology allows researchers to profile the transcriptomes of thousands of cells simultaneously. Protocols that incorporate both designed and random barcodes have greatly increased the throughput of scRNA-seq, but give rise to a more complex data structure. There is a need for new tools that can handle the various barcoding strategies used by different protocols and exploit this information for quality assessment at the sample-level and provide effective visualization of these results in preparation for higher-level analyses. To this end, we developed <italic>scPipe</italic>, an R/Bioconductor package that integrates barcode demultiplexing, read alignment, UMI-aware gene-level quantification and quality control of raw sequencing data generated by multiple protocols that include CEL-seq, MARS-seq, Chromium 10X, Drop-seq and Smart-seq. <italic>scPipe</italic> produces a count matrix that is essential for downstream analysis along with an HTML report that summarises data quality. These results can be used as input for downstream analyses including normalization, visualization and statistical testing. <italic>scPipe</italic> performs this processing in a few simple R commands, promoting reproducible analysis of single-cell data that is compatible with the emerging suite of open-source scRNA-seq analysis tools available in R/Bioconductor and beyond. The <italic>scPipe</italic> R package is available for download from <ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/scPipe" xlink:type="simple">https://www.bioconductor.org/packages/scPipe</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Biotechnologies that allow researchers to measure gene activity in individual cells are growing in popularity. This has resulted in an avalanche of custom analysis methods designed to deal with the complex data that arises from this technology. Although hundreds of analysis methods are available, relatively few deal with raw data processing in a holistic way. Our <italic>scPipe</italic> software has been developed to fill this gap. <italic>scPipe</italic> is the first fully integrated R package that deals with the raw sequencing reads from single cell gene expression studies, processing them to the point where biologically interesting downstream analyses can take place. By following community developed standards, <italic>scPipe</italic> is compatible with many other software packages for single cell analysis available from the open-source Bioconductor project, facilitating a complete beginning to end analysis of single cell gene expression data. This allows various biological questions to be answered, ranging from the identification of novel cell types to the discovery of new marker genes. <italic>scPipe</italic> promotes reproducibility and makes it easier for researchers to share results and code.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000925</institution-id>
<institution>National Health and Medical Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>GNT1143163, GNT1104924</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7383-0609</contrib-id>
<name name-style="western">
<surname>Ritchie</surname> <given-names>Matthew E.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000925</institution-id>
<institution>National Health and Medical Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>GNT1124812, GNT1062820</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Naik</surname> <given-names>Shalin H.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001782</institution-id>
<institution>University of Melbourne</institution>
</institution-wrap>
</funding-source>
<award-id>Melbourne Research Scholarship</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3420-3685</contrib-id>
<name name-style="western">
<surname>Tian</surname> <given-names>Luyi</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution>Chan Zuckerberg Initiative DAF, an advised fund of Silicon Valley Community Foundation</institution>
</funding-source>
<award-id>2018-182819</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7383-0609</contrib-id>
<name name-style="western">
<surname>Ritchie</surname> <given-names>Matthew E.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by the National Health and Medical Research Council (NHMRC) Project Grants (GNT1143163 to MER, GNT1124812 to SHN and MER, GNT1062820 to SHN), Fellowship GNT1104924 to MER, the Chan Zuckerberg Initiative DAF, an advised fund of Silicon Valley Community Foundation (grant number 2018-182819 to MER), a Melbourne Research Scholarship to LT, Genomics Innovation Hub, Victorian State Government Operational Infrastructure Support and Australian Government NHMRC IRIISS. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="15"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-08-22</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Datasets are available under GEO accession numbers GSE109999 and GSE111108 or from the Human Cell Atlas Preview Datasets webpage (<ext-link ext-link-type="uri" xlink:href="https://preview.data.humancellatlas.org/" xlink:type="simple">https://preview.data.humancellatlas.org/</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Advances in single-cell transcriptomic profiling technologies allow researchers to measure gene activity in thousands of cells simultaneously, enabling exploration of gene expression variability [<xref ref-type="bibr" rid="pcbi.1006361.ref001">1</xref>], identification of new cell types [<xref ref-type="bibr" rid="pcbi.1006361.ref002">2</xref>] and the study of transcriptional programs involved in cell differentiation [<xref ref-type="bibr" rid="pcbi.1006361.ref003">3</xref>]. The introduction of cellular barcodes, sequences distinct for each cell attached to the dT-primer, has increased the throughput and substantially reduced the cost of single-cell RNA sequencing (scRNA-seq). These barcodes allow for the demultiplexing of reads after cells are pooled together for sequencing. Apart from cellular barcodes, molecular barcodes or unique molecular identifiers (UMIs), are frequently employed to remove PCR duplicates and allow identification of unique mRNA molecules, thereby reducing technical noise. The multiple levels of barcoding used in scRNA-seq experiments create additional challenges in data processing together with new opportunities for quality control (QC). Different protocols use different barcode configurations, which means a flexible approach to data preprocessing is required.</p>
<p>A large number of software tools have already been tailored to scRNA-seq analysis [<xref ref-type="bibr" rid="pcbi.1006361.ref004">4</xref>], the majority of which are focused on downstream tasks such as clustering and trajectory analysis. Methods for preprocessing tend to focus on specific tasks such as <italic>UMI-tools</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref005">5</xref>], <italic>umitools</italic> (<ext-link ext-link-type="uri" xlink:href="http://brwnj.github.io/umitools/" xlink:type="simple">http://brwnj.github.io/umitools/</ext-link>) and <italic>umis</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref006">6</xref>] which have been developed for handling random UMIs and correcting UMI sequencing errors. Other tools such as <italic>CellRanger</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref007">7</xref>], <italic>dropEst</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref008">8</xref>] and <italic>dropseqPipe</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/Hoohm/dropSeqPipe" xlink:type="simple">https://github.com/Hoohm/dropSeqPipe</ext-link>) on the other hand offer a complete preprocessing solution for data generated by droplet based protocols. Other packages such as <italic>scater</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref009">9</xref>], and <italic>scran</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref010">10</xref>] work further downstream by preprocessing the counts to perform general QC and normalization of scRNA-seq data.</p>
<p><italic>scPipe</italic> was developed to address the lack of a comprehensive R-based workflow for processing sequencing data from different protocols that can accommodate both UMIs and sample barcodes, map reads to the genome and summarise these results into gene-level counts. Additionally this pipeline collates useful metrics for QC during preprocessing that can be later used to filter genes and samples. In the remainder of this article we provide an overview of the main features of our <italic>scPipe</italic> software and demonstrate its use on various in-house generated and publicly available scRNA-seq datasets.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Design and implementation</title>
<sec id="sec003">
<title>Single-cell RNA-seq datasets analysed</title>
<sec id="sec004">
<title>Mouse hematopoietic lineage dataset</title>
<p>Single cell expression profiling of the main hematopoietic lineages in mouse (erythroid, myeloid, lymphoid, stem/progenitors) was performed using a modified CEL-seq2 [<xref ref-type="bibr" rid="pcbi.1006361.ref011">11</xref>] protocol. B lymphocytes (B220+ FSC-Alow), erythroblasts (Ter119+ CD44+, FSC-Amid/high), granulocytes (Mac1+ Gr1+) and high-end progenitor/stem (Lin- Kit+ Sca1+) were sorted from the bone marrow of a C57BL/6 10-13 week old female mouse. T cells (CD3+ FSC-Alow) were isolated from the thymus of the same mouse. Bone marrow and thymus were dissociated mechanically, washed and stained with antibodies for 1hr on ice. Single cells were deposited on a 384 well plate using an Aria cell sorter (Beckman). Index data was collected and our adapted CEL-seq2 protocol used to generate a library for sequencing. The reads were sequenced by an Illumina Nextseq 500 and processed by <italic>scPipe</italic>. This dataset is available under GEO accession number GSE109999.</p>
</sec>
<sec id="sec005">
<title>Human lung adenocarcinoma cell line dataset</title>
<p>The cell lines H2228, NCI-H1975 and HCC827 were retrieved from ATCC (<ext-link ext-link-type="uri" xlink:href="https://www.atcc.org/" xlink:type="simple">https://www.atcc.org/</ext-link>) and cultured in Roswell Park Memorial Institute (RPMI) 1640 medium with 10% fetal calf serum (FCS) and 1% Penicillin-Streptomycin. The cells were grown independently at 37°C with 5% carbon dioxide until near 100% confluency. Cells were PI stained and 120,000 live cells were sorted for each cell line by FACS to acquire an accurate equal mixture of live cells from the three cell lines. This mixture was then processed by the Chromium 10X single cell platform using the manufacturer’s (10X Genomics) protocol and sequenced with an Illumina Nextseq 500. Filtered gene expression matrices were generated using <italic>CellRanger</italic> (10X Genomics) and <italic>scPipe</italic> independently. For <italic>CellRanger</italic>, we used the default parameters, with <monospace>--expect-cells = 4000</monospace>. For <italic>scPipe</italic>, we processed the 4,000 most enriched cell barcodes. The GRCh38 human genome and ENSEMBL v91 human gene annotation were used for both the <italic>scPipe</italic> and <italic>CellRanger</italic> analysis. In <italic>scPipe</italic>, the number of components used in the outlier detection step was set to <monospace>comp = 2</monospace> for quality control to remove poor quality cells. This dataset is available under GEO accession number GSE111108.</p>
</sec>
<sec id="sec006">
<title>Ischaemic sensitivity of human tissue dataset</title>
<p>A publicly available Chromium 10X dataset from the Human Cell Atlas project (<ext-link ext-link-type="uri" xlink:href="https://preview.data.humancellatlas.org/" xlink:type="simple">https://preview.data.humancellatlas.org/</ext-link>) was also preprocessed using <italic>scPipe</italic> and analysed with highly compatible Bioconductor packages. This dataset of roughly 2,000 cells comes from the first spleen harvested in a project seeking to study sensitivity to ischaemia in 3 different tissue types [<xref ref-type="bibr" rid="pcbi.1006361.ref012">12</xref>]. For this sample, <italic>scPipe</italic> was run with quality and sequence filters turned off in <monospace>sc_trim_barcode</monospace> and cellular barcodes were detected from a sample of the first 5 million reads using <monospace>sc_detect_bc</monospace>, which resulted in 2,273 detected barcodes. The sequences were aligned to the GRCh38 human genome using <italic>Rsubread</italic> and counts were assigned based on ENSEMBL v91 human gene annotations using <italic>scPipe</italic> and outliers were detected with <monospace>comp = 2</monospace> in the automatic outlier detection step.</p>
</sec>
</sec>
<sec id="sec007">
<title><italic>scPipe</italic> implementation details</title>
<p><italic>scPipe</italic> is an R [<xref ref-type="bibr" rid="pcbi.1006361.ref013">13</xref>] / Bioconductor [<xref ref-type="bibr" rid="pcbi.1006361.ref014">14</xref>] package that can handle data generated from all popular 3’ end scRNA-seq protocols and their variants, such as CEL-seq, MARS-seq, Chromium 10X and Drop-seq. Data from non-UMI protocols generated by Smart-seq and Smart-seq2 can also be handled. The pipeline begins with FASTQ files and outputs both a gene count matrix and a variety of QC statistics. These are presented in a standalone HTML report generated by <italic>rmarkdown</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref015">15</xref>] that includes various plots of QC metrics and other data summaries. The <italic>scPipe</italic> package is written in R and C<monospace>++</monospace> and uses the <italic>Rcpp</italic> package [<xref ref-type="bibr" rid="pcbi.1006361.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1006361.ref017">17</xref>] to wrap the C<monospace>++</monospace> code into R functions and the <italic>Rhtslib</italic> package [<xref ref-type="bibr" rid="pcbi.1006361.ref018">18</xref>] for BAM input/output. The key aspects are implemented in C<monospace>++</monospace> for efficiency.</p>
</sec>
</sec>
<sec id="sec008" sec-type="results">
<title>Results</title>
<sec id="sec009">
<title>The <italic>scPipe</italic> workflow</title>
<sec id="sec010">
<title>FASTQ reformatting</title>
<p>The <italic>scPipe</italic> workflow (<xref ref-type="fig" rid="pcbi.1006361.g001">Fig 1</xref>) generally begins with paired-end FASTQ data which is passed to the function <monospace>sc_trim_barcode</monospace>, which reformats the reads by trimming the barcode and UMI from the reads and moving this information into the read header. There are options to perform some basic filtering in this step, including removing reads with low quality sequence in the barcode and UMI regions and filtering out low complexity reads, most of which are non-informative repetitive sequences such as polyA. The output FASTQ file contains transcript sequences, with barcode information merged into the read names.</p>
<fig id="pcbi.1006361.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006361.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The <italic>scPipe</italic> workflow.</title>
<p><italic>scPipe</italic> is an R/Bioconductor package that uses functionality from a number of other packages, including <italic>Rsubread</italic> to align reads to a reference genome (although in practice any aligner that produces BAM files can be used for read alignment) and <italic>SingleCellExperiment</italic> to organise the counts and sample annotation information. The major steps in the preprocessing pipeline of <italic>scPipe</italic> are shown along with the quality control (QC) statistics collected at each stage. The final output of this process is a matrix of counts and QC metrics for use in downstream analysis and an HTML report that summarises the analysis. The resulting <italic>SingleCellExperiment</italic> object can be used as input to other Bioconductor packages to perform further downstream analysis. <italic>scPipe</italic> logo created by Roberto Bonelli published under a CC0 1.0 license (<ext-link ext-link-type="uri" xlink:href="https://github.com/Bioconductor/BiocStickers/blob/master/scPipe/README.md" xlink:type="simple">https://github.com/Bioconductor/BiocStickers/blob/master/scPipe/README.md</ext-link>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006361.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec011">
<title>Read alignment, exon mapping and barcode demultiplexing</title>
<p>The next stage of preprocessing involves sequence alignment. For this task, any popular RNA-seq read aligner that produces BAM formatted output can be used. By default, <italic>scPipe</italic> uses the fast and convenient R-based <italic>Rsubread</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref019">19</xref>] aligner which is available on Linux and Mac OS operating systems. For publicly available datasets from sources such as GEO, FASTQ files are often available per cell and these need to be aligned first before they can be processed further using <italic>scPipe</italic>. For all different types of data, aligned reads in the BAM file are then assigned to exons by the <monospace>sc_exon_mapping</monospace> function according to a user provided annotation. Using a similar strategy to <italic>featureCounts</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref020">20</xref>], we divide chromosomes into non-overlapping bins and assess the overlap of aligned fragments with exons that fall within the bin to reduce the search complexity. This function records the mapping result, together with the UMI and cell barcodes available from the optional fields of the BAM file with specific BAM tags. By default we use the official BAM tag BC for cell barcode and OX for UMI sequence.</p>
<p>Next, the <monospace>sc_demultiplex</monospace> function is used to demultiplex results per cell using the sample barcode information. For CEL-seq and MARS-seq, the demultiplexing is based on the list of designed barcode sequences that the user provides, and allows for mismatches during the cell barcode matching step. For 10X and Drop-seq where the cell barcode sequences need to be identified from the reads, the function <monospace>sc_detect_bc</monospace> can be applied to identify enriched barcodes in the data that can then be supplied to <monospace>sc_demultiplex</monospace>. This function can accept a list of possible barcodes that may be present in the dataset (if available), such as the white list provided by 10X. Data from non-UMI protocols such as Smart-seq and Smart-seq2 can be handled by setting <monospace>has_UMI</monospace> to <monospace>FALSE</monospace> when running <monospace>sc_demultiplex</monospace>. The <monospace>sc_detect_bc</monospace> function summarises the sequences in the cell barcode region, collapsing reads with a small edit distance, which are indicative of sequencing errors. It can report a given number of cell barcodes or keep the cell barcodes based on a read number cutoff. A relaxed threshold is generally recommended when one specifies the number of barcodes to retain, for instance if the estimated number of cells in the library is 1,000-5,000, a threshold of 10,000 would ensure data for all cells is collected. The motivation behind this is that unlike <italic>CellRanger</italic>, we don’t recommend detecting low quality cells or empty barcodes solely based on the number of reads or UMI counts per cell. Instead, more robust and meaningful results can be produced using multiple QC metrics. Hence the <monospace>sc_detect_bc</monospace> function should be run to allow more barcodes than cells. The quality control function in <italic>scPipe</italic> can be used to remove erroneous cell barcodes at a later stage. The demultiplexed data are output in a csv file for each cell, where each row corresponds to a read that maps to a specific gene, and columns that include gene id, UMI sequence and mapping position. The overall barcode demultiplexing results are recorded and can be plotted as shown in <xref ref-type="fig" rid="pcbi.1006361.g002">Fig 2A</xref> for the mouse blood cells generated by the CEL-seq2 protocol.</p>
<fig id="pcbi.1006361.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006361.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Example QC plots that can be created using output from <italic>scPipe</italic> to assess data quality both within and between experiments.</title>
<p>Within experiment displays include (<bold>A</bold>) a bar plot illustrating the overall cell barcode matching results to assess sequencing accuracy across all samples and (<bold>B</bold>) a stacked bar plot showing the mapping rate, separated into reads that map to exon, intron and ERCCs and those that are ambiguously mapped, map elsewhere in the genome and are unaligned for each cell in an experiment (ordered by exon mapping rate). Between experiment displays include (<bold>C</bold>) a stacked bar plot showing the cell barcode matching results from panel (A) from multiple experiments and (<bold>D</bold>) a ridgeline plot presenting the distribution of proportions of non-mitochondrial read counts for cells across multiple experiments.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006361.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Obtaining a gene count matrix and performing quality assessment</title>
<p>The next stage of preprocessing makes use of the <monospace>sc_gene_counting</monospace> function to remove PCR duplicates (also known as UMI deduplication) to generate a gene count matrix. <italic>scPipe</italic> uses a greedy approach based on hamming distance to do this. The detected UMIs are compared to each other and if two UMI sequences are found to be within a certain hamming distance apart (the default is 1) and one UMI has more than twice the count of the other, then the two different UMIs will be treated as instances of the same UMI. The approach is based on the fact that erroneous UMI sequences due to sequencing error usually just have one or two reads. PCR errors, however, can be more problematic, and other more sophisticated network-based methods such as the approach taken in <italic>UMI-tools</italic> have been developed to deal with such errors. When PCR error rates are low, the approach used in <italic>scPipe</italic> should give good results. Our pipeline outputs the raw UMI sequences that map to each gene, which can be used as input for more sophisticated UMI correction methods when the PCR error rate is high. After UMI deduplication we get a gene count matrix that can be used for further analysis. QC information is collected at each step (<xref ref-type="fig" rid="pcbi.1006361.g001">Fig 1</xref>) and includes the total number of mapped reads per cell, UMI deduplication statistics, per cell barcode demultiplexing statistics, UMI correction statistics and External RNA Controls Consortium (ERCC) spike-in control statistics (where present).</p>
<p><italic>scPipe</italic> uses the S4 infrastructure provided by the <italic>SingleCellExperiment</italic> package [<xref ref-type="bibr" rid="pcbi.1006361.ref021">21</xref>] for data storage. A <monospace>SingleCellExperiment</monospace> object can be constructed by the <monospace>create_sce_by_dir</monospace> function using the data folder generated during preprocessing, or by manually specifying all the required slots. Alongside the gene count matrix, this object stores QC information obtained during preprocessing, and the type of gene id and organism name, which can both be useful in downstream functional enrichment analysis.</p>
<p>Next, alignment statistics for each cell can be plotted using the <monospace>plotMapping</monospace> function (<xref ref-type="fig" rid="pcbi.1006361.g002">Fig 2B</xref>). Data shown here is again from the mouse blood cell dataset described previously. Monitoring these QC statistics across experiments (<xref ref-type="fig" rid="pcbi.1006361.g002">Fig 2C and 2D</xref>) can be particularly useful for labs that routinely process single-cell data, allowing them to assess the impact changes in lab processes and protocols have on data quality. Pairwise scatter plots of QC metrics such as the total molecules per cell and the number of genes detected can be generated with the <monospace>plotQC_pair</monospace> function (<xref ref-type="fig" rid="pcbi.1006361.g003">Fig 3</xref>).</p>
<fig id="pcbi.1006361.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006361.g003</object-id>
<label>Fig 3</label>
<caption>
<title>A pairwise scatter plot of the quality control metrics collected by <italic>scPipe</italic> for the mouse blood cell dataset.</title>
<p>Sample-specific metrics include the total read count, the number of genes detected and the proportion of non-ERCC or non-mitocondrial reads. The good quality and outlier samples detected by <italic>scPipe</italic>’s automatic outlier detection method are indicated in each panel by a different colour.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006361.g003" xlink:type="simple"/>
</fig>
<p><italic>scPipe</italic> implements a multivariate outlier detection method for discovering low quality cells to remove from further analysis. The method uses up to 5 metrics (log-transformed number of molecules detected, the number of genes detected, the percentage of reads mapping to ribosomal, or mitochondrial genes and ERCC recovery (where available)) as input (<xref ref-type="fig" rid="pcbi.1006361.g003">Fig 3</xref>) to a Gaussian mixture model (GMM). There are three stages in the outlier detection process. First the Mahalanobis distances between cells based on the quality control metrics chosen are calculated, with extreme cells removed before fitting the GMM using the <italic>mclust</italic> package [<xref ref-type="bibr" rid="pcbi.1006361.ref022">22</xref>]. The QC metrics of the remaining cells are used to capture the overall heterogeneity in the dataset. The mixture component with systematically lower QC metrics, such as lower numbers of genes detected and lower numbers of molecular counts are marked as outliers. In the final stage, the Mahalanobis distance is calculated for cells from the mixture component with the highest QC metric values with outliers automatically detected based on this distance. Outlier detection can then be reconciled with visual inspection of the QC metrics through the afore-mentioned QC plotting options to fine tune the sample-specific filtering thresholds chosen. Depending on the data, the only argument that needs to be specified is the maximum number of components in the GMM. In most cases, this is set to 1 or 2 for good quality data with only a small proportion of poor quality cells. For data generated by droplet-based protocols where larger proportions of poor quality cells may be expected, the number of components can be set to 2 or 3 to model extra components that correspond to the good and poor quality cells. Apart from the number of components, the user can also adjust the confidence interval for choosing outliers (0.99 by default).</p>
<p>An HTML report generated using <italic>rmarkdown</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref015">15</xref>] that includes all run parameters used, QC statistics and various types of dimension reduction plots of both the gene expression data and QC metrics can be generated using the <monospace>create_report</monospace> function (<xref ref-type="fig" rid="pcbi.1006361.g004">Fig 4</xref>). As <italic>scPipe</italic> generates consistent QC measures across different protocols and experiments, these QC metrics can be easily combined (<xref ref-type="fig" rid="pcbi.1006361.g002">Fig 2C and 2D</xref>) to facilitate comparisons between multiple datasets.</p>
<fig id="pcbi.1006361.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006361.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Screenshot of an HTML report created by <italic>scPipe</italic> for the mouse blood cell dataset.</title>
<p>This report organises the output of <italic>scPipe</italic>, including run parameters and QC metrics and also generates basic dimension reduction plots of the data. Such reports provide a convenient format for communicating basic QC information to collaborators to help them evaluate the overall quality of an experiment.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006361.g004" xlink:type="simple"/>
</fig>
<p>After QC, the data can be easily passed to downstream packages. Use of the <italic>SingleCellExperiment</italic> class ensures the output of <italic>scPipe</italic> is fully interoperable with a range of other Bioconductor packages. For instance, packages such as <italic>scater</italic>, <italic>scran</italic> and <italic>BASiCS</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref023">23</xref>] can be used for normalization, <italic>zinbwave</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref024">24</xref>] for dealing with zero inflation in the data and removing unwanted variation, <italic>SC3</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref025">25</xref>] and <italic>clusterExperiment</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref026">26</xref>] for clustering and <italic>MAST</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref027">27</xref>] and <italic>scDD</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref028">28</xref>] for differential expression analysis.</p>
</sec>
<sec id="sec013">
<title>Using <italic>scPipe</italic></title>
<p>A vignette accompanying the package provides further details on implementation and an example use case on the CEL-seq2 mouse blood dataset.</p>
<p>This example dataset contains 100 million reads and takes under 2 hours to process on a standard Linux server. <italic>scPipe</italic> creates a <italic>SingleCellExperiment</italic> object from the count matrix and mapping statistics output by the pipeline which can be manipulated using other Bioconductor packages for single cell analysis. <italic>scPipe</italic>’s outlier detection has been used to remove low quality cells (<xref ref-type="fig" rid="pcbi.1006361.g003">Fig 3</xref>). For the mouse blood dataset, scPipe’s outlier removal retained 359 of 383 cells for further analysis and in the human spleen dataset, 1,397 of the 2,273 detected cells were retained for further analysis. We applied <italic>scran</italic> to compute size factors for normalization. Differential expression analysis was performed between the <italic>a priori</italic> defined B-lymphocyte and T-lymphocyte cells (based on FACS sorting information available for the cells in each well) using a generalised linear model from <italic>edgeR</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref029">29</xref>] after performing conversion to a <italic>DGEList</italic> using <italic>scater</italic> (<xref ref-type="fig" rid="pcbi.1006361.g005">Fig 5A</xref>). From this analysis 636 differentially expressed genes were discovered based on likelihood-ratio testing (LRT) at a 0.05 false-discovery-rate (FDR) threshold.</p>
<fig id="pcbi.1006361.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006361.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Analysis results produced with <italic>SingleCellExperiment</italic>-compatible packages from Bioconductor.</title>
<p>(<bold>A</bold>) Differential gene expression results from comparing B-lymphocytes and T-lymphocytes known <italic>a priori</italic> in the CEL-seq2 mouse blood dataset. Highlighted points are genes determined to be significantly differentially expressed from LRT with 0.05 FDR cutoff. (<bold>B</bold>) tSNE coloured by cell type predictions obtained for <italic>SC3</italic> clusters for the first spleen sample from the Human Cell Atlas ischaemic sensitivity dataset. The 10 clusters from <italic>SC3</italic> were assigned to 5 distinct cell types from the reference set of 12 lineages.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006361.g005" xlink:type="simple"/>
</fig>
<p>A second example uses data from the pilot Human Cell Atlas ischaemic sensitivity dataset, which was again preprocessed by <italic>scPipe</italic>, with automatic outlier detection leaving 1,397 cells, which were then normalized using <italic>scran</italic>. Next, we performed cell clustering with <italic>SC3</italic>, where the number of clusters produced was optimised by <italic>SC3</italic>’s <monospace>estimate_k</monospace> function to give 10 clusters. To annotate these clusters, the mean normalized expression of each cluster was correlated with a microarray dataset of 12 immunological lineages [<xref ref-type="bibr" rid="pcbi.1006361.ref030">30</xref>]. The lineage with the highest correlation was considered the most likely cell type candidate for each cluster. Using this method, the 10 clusters identified by <italic>SC3</italic> were assigned to 5 of the 12 potential candidate lineages (<xref ref-type="fig" rid="pcbi.1006361.g005">Fig 5B</xref>).</p>
<p>A third example of running <italic>scPipe</italic> on the Chromium 10X cell line data is, which has 400 million reads from around 1,000 cells takes about 10 hours on a standard Linux server. We also provide examples of using <italic>scPipe</italic> with an alternate aligner (STAR [<xref ref-type="bibr" rid="pcbi.1006361.ref031">31</xref>]). Code for each of these example analyses is provided as Supplementary Information from <ext-link ext-link-type="uri" xlink:href="http://bioinf.wehi.edu.au/scPipe/" xlink:type="simple">http://bioinf.wehi.edu.au/scPipe/</ext-link>.</p>
<p><italic>scPipe</italic> is a fully modular pipeline, with each step generating independent results. It is also flexible with its inputs, accepting FASTQ as outlined above, or BAM files produced by <italic>CellRanger</italic> and Dropseq tools (<ext-link ext-link-type="uri" xlink:href="http://mccarrolllab.com/dropseq/" xlink:type="simple">http://mccarrolllab.com/dropseq/</ext-link>) from which a gene count matrix can be generated. This approach ensures interoperability with tools both inside and outside of Bioconductor to give the data analyst maximum flexibility when configuring their scRNA-seq analysis pipelines.</p>
</sec>
<sec id="sec014">
<title>Comparing <italic>scPipe</italic> with other pipelines</title>
<p>We reviewed the tools currently available for scRNA-seq data preprocessing identified through the ‘Alignment’ and ‘UMIs’ categories provided by the <ext-link ext-link-type="uri" xlink:href="https://www.scrna-tools.org/" xlink:type="simple">https://www.scrna-tools.org/</ext-link> website [<xref ref-type="bibr" rid="pcbi.1006361.ref004">4</xref>]. The search revealed 9 tools that have overlapping functionality with <italic>scPipe</italic>, summarised in <xref ref-type="table" rid="pcbi.1006361.t001">Table 1</xref>. Our software is the only Bioconductor package that spans all major single cell platforms (both plate and droplet-based) and the full range of preprocessing tasks (alignment, UMI handling and QC). The shell program <italic>zUMIs</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref032">32</xref>] is another program that covers the breadth of platforms and preprocessing tasks. Other software tools, such as <italic>dropSeqPipe</italic>, <italic>CellRanger</italic> and <italic>dropEst</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref008">8</xref>] only deal with data from droplet-based protocols, <italic>Sharq</italic> [<xref ref-type="bibr" rid="pcbi.1006361.ref033">33</xref>] is suitable for plate-based approaches, and the remaining handle the UMI processing step only. <italic>CellRanger</italic> is the only tool that also offers downstream analysis, with clustering and differential expression testing included in its default output.</p>
<table-wrap id="pcbi.1006361.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006361.t001</object-id>
<label>Table 1</label>
<caption>
<title>Summary of the data preprocessing software currently available for scRNA-seq analysis and the particular tasks covered by each package.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006361.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006361.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="2" style="background-color:#D8D9D8">Software</th>
<th align="center" rowspan="2" style="background-color:#D8D9D8">Language</th>
<th align="center" rowspan="2" style="background-color:#D8D9D8">Input</th>
<th align="center" rowspan="2" style="background-color:#D8D9D8">Multiple technologies</th>
<th align="center" colspan="4" style="background-color:#D8D9D8">Analysis task</th>
</tr>
<tr>
<th align="center" style="background-color:#D8D9D8">Alignment</th>
<th align="center" style="background-color:#D8D9D8">UMI handling</th>
<th align="center" style="background-color:#D8D9D8">QC metrics</th>
<th align="center" style="background-color:#D8D9D8">Downstream analysis</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">scPipe</td>
<td align="center">R</td>
<td align="center">FASTQ</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">×</td>
</tr>
<tr>
<td align="center" style="background-color:#F2F2F2">zUMIs</td>
<td align="center" style="background-color:#F2F2F2">Shell</td>
<td align="center" style="background-color:#F2F2F2">FASTQ</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">×</td>
</tr>
<tr>
<td align="center">dropSeqPipe</td>
<td align="center">Snakemake</td>
<td align="center">FASTQ</td>
<td align="center">×</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">×</td>
</tr>
<tr>
<td align="center" style="background-color:#F2F2F2">Sharq</td>
<td align="center" style="background-color:#F2F2F2">Python/Perl/R</td>
<td align="center" style="background-color:#F2F2F2">FASTQ</td>
<td align="center" style="background-color:#F2F2F2">×</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">×</td>
</tr>
<tr>
<td align="center">CellRanger</td>
<td align="center">Python/R</td>
<td align="center">BCL/FASTQ</td>
<td align="center">×</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="center" style="background-color:#F2F2F2">dropEst</td>
<td align="center" style="background-color:#F2F2F2">C++/R</td>
<td align="center" style="background-color:#F2F2F2">FASTQ</td>
<td align="center" style="background-color:#F2F2F2">×</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">×</td>
</tr>
<tr>
<td align="center">UMI-tools</td>
<td align="center">Python</td>
<td align="center">FASTQ</td>
<td align="center">✓</td>
<td align="center">×</td>
<td align="center">✓</td>
<td align="center">×</td>
<td align="center">×</td>
</tr>
<tr>
<td align="center" style="background-color:#F2F2F2">umis</td>
<td align="center" style="background-color:#F2F2F2">Python</td>
<td align="center" style="background-color:#F2F2F2">FASTQ</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">×</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">×</td>
<td align="center" style="background-color:#F2F2F2">×</td>
</tr>
<tr>
<td align="center">sircel</td>
<td align="center">Python</td>
<td align="center">FASTQ</td>
<td align="center">✓</td>
<td align="center">×</td>
<td align="center">✓</td>
<td align="center">×</td>
<td align="center">×</td>
</tr>
<tr>
<td align="center" style="background-color:#F2F2F2">TRUmiCount</td>
<td align="center" style="background-color:#F2F2F2">R/Shell</td>
<td align="center" style="background-color:#F2F2F2">BAM</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">×</td>
<td align="center" style="background-color:#F2F2F2">✓</td>
<td align="center" style="background-color:#F2F2F2">×</td>
<td align="center" style="background-color:#F2F2F2">×</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>In order to highlight the differences between <italic>scPipe</italic> and the popular <italic>CellRanger</italic> pipeline that processes raw data from the Chromium 10X platform, we performed a benchmark experiment that included 3 human lung adenocarcinoma cell lines (see <xref ref-type="sec" rid="sec002">Materials and methods</xref>) and processed the raw data using both <italic>scPipe</italic> and <italic>CellRanger</italic> (<xref ref-type="fig" rid="pcbi.1006361.g006">Fig 6A</xref>). The dataset contains about 1,000 cells. <italic>CellRanger</italic> returns 1,027 cells and <italic>scPipe</italic> 981 cells after QC (<xref ref-type="fig" rid="pcbi.1006361.g006">Fig 6B</xref>). The t-SNE plot [<xref ref-type="bibr" rid="pcbi.1006361.ref034">34</xref>] generated from the <italic>CellRanger</italic> output shows that the 48 cells that appear in the <italic>CellRanger</italic> results but not in <italic>scPipe</italic> tend to cluster together (<xref ref-type="fig" rid="pcbi.1006361.g006">Fig 6C</xref>). Inspection of their QC metrics (<xref ref-type="fig" rid="pcbi.1006361.g006">Fig 6D</xref>) shows that these cells have higher proportions of mitochondrial gene counts, suggesting they may be dead cells that should be excluded from downstream analysis. Since <italic>CellRanger</italic> only uses the UMI counts per cell as a QC cutoff, the results generated by <italic>CellRanger</italic> may contain dead cells and benefit from a further round of QC. The <italic>scPipe</italic> analysis on the other hand uses multiple QC metrics by default (<xref ref-type="fig" rid="pcbi.1006361.g003">Fig 3</xref>) to achieve a robust measure of cell quality to ensure low quality cells are discarded. This comparison shows the benefit of <italic>scPipe</italic>’s built-in QC step.</p>
<fig id="pcbi.1006361.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006361.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Comparing <italic>scPipe</italic> and <italic>CellRanger</italic>.</title>
<p>(<bold>A</bold>) The workflow for the comparison. An equal mixture of cells from three cell lines are sequenced using the Chromium 10X platform (see <xref ref-type="sec" rid="sec002">Materials and methods</xref>). Data were processed by <italic>scPipe</italic> and <italic>CellRanger</italic>. (<bold>B</bold>) The pie chart shows the overlap of cell barcode detected by <italic>scPipe</italic> and <italic>CellRanger</italic>. (<bold>C</bold>) The t-SNE plot generated using <italic>CellRanger</italic> output. Cell barcodes that only exist in <italic>CellRanger</italic> are highlighted. (<bold>D</bold>) Box plots showing the percentage of mitochondrial gene counts in cells that overlap with <italic>scPipe</italic> or only exist in the <italic>CellRanger</italic> results.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006361.g006" xlink:type="simple"/>
</fig>
</sec>
</sec>
</sec>
<sec id="sec015">
<title>Availability and future directions</title>
<p>The <italic>scPipe</italic> package is available from <ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/scPipe" xlink:type="simple">https://www.bioconductor.org/packages/scPipe</ext-link>. Code for each of the example analyses described in the ‘<italic>Using scPipe</italic>’ section above is available from <ext-link ext-link-type="uri" xlink:href="http://bioinf.wehi.edu.au/scPipe/" xlink:type="simple">http://bioinf.wehi.edu.au/scPipe/</ext-link>. Bug reports and questions about using <italic>scPipe</italic> should be posted on the Bioconductor support site (<ext-link ext-link-type="uri" xlink:href="https://support.bioconductor.org/" xlink:type="simple">https://support.bioconductor.org/</ext-link>).</p>
<p>With the growing popularity of scRNA-seq technology, many tools have been developed for normalization, dimensionality reduction and clustering. There are relatively few packages designed to handle the raw data obtained from the various 3’ end sequencing protocols with their associated UMIs and cell-specific barcodes from beginning to end and collect detailed quality control information. The <italic>scPipe</italic> package bridges this gap between the raw FASTQ files with mixed barcode types and transcript sequences and the gene count matrix that is the entry point for all downstream analyses. <italic>scPipe</italic> outputs numerous QC metrics obtained at each preprocessing step and displays these results in an HTML report to assist end users in QC evaluations. Future improvements that are planned for <italic>scPipe</italic> include support for new scRNA-seq protocols as they emerge and parallelization of the various preprocessing steps to enable scalability to larger datasets. We also plan to generate a more comprehensive scRNA-seq benchmark dataset to ensure the default UMI correction and quality control methods used in <italic>scPipe</italic> are optimal that will also allow for a more detailed comparison of <italic>scPipe</italic> with other relevant analysis pipelines, such as <italic>zUMIs</italic>.</p>
</sec>
</body>
<back>
<ack>
<p>The authors are grateful to Saskia Freytag, Carolyn de Graaf, Aaron Lun, Rowland Mosbergen, Othmar Korn and Valerie Obenchain for their advice and feedback on the <italic>scPipe</italic> software, Roberto Bonelli for designing the <italic>scPipe</italic> logo and Clare Weeden and Marie-Liesse Asselin-Labat for providing the cell lines used in the Chromium 10X experiment.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006361.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Patel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tirosh</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Trombetta</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Shalek</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gillespie</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wakimoto</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>. <source>Science</source>. <year>2014</year>;<volume>344</volume>(<issue>6190</issue>):<fpage>1396</fpage>–<lpage>1401</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1254257" xlink:type="simple">10.1126/science.1254257</ext-link></comment> <object-id pub-id-type="pmid">24925914</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macosko</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Basu</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Satija</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Nemesh</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Shekhar</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Goldman</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>(<issue>5</issue>):<fpage>1202</fpage>–<lpage>1214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2015.05.002" xlink:type="simple">10.1016/j.cell.2015.05.002</ext-link></comment> <object-id pub-id-type="pmid">26000488</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cacchiarelli</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Grimsby</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pokharel</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Morse</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat Biotechnol</source>. <year>2014</year>;<volume>32</volume>(<issue>4</issue>):<fpage>381</fpage>–<lpage>386</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.2859" xlink:type="simple">10.1038/nbt.2859</ext-link></comment> <object-id pub-id-type="pmid">24658644</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zappia</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Phipson</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Oshlack</surname> <given-names>A</given-names></name>. <article-title>Exploring the single-cell RNA-seq analysis landscape with the scRNA-tools database</article-title>. <source>PLoS Comput Biol</source>. <year>2018</year>;<volume>14</volume>(<issue>6</issue>):<fpage>e1006245</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1006245" xlink:type="simple">10.1371/journal.pcbi.1006245</ext-link></comment> <object-id pub-id-type="pmid">29939984</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Heger</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sudbery</surname> <given-names>I</given-names></name>. <article-title>UMI-tools: modeling sequencing errors in Unique Molecular Identifiers to improve quantification accuracy</article-title>. <source>Genome Res</source>. <year>2017</year>;<volume>27</volume>(<issue>3</issue>):<fpage>491</fpage>–<lpage>99</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.209601.116" xlink:type="simple">10.1101/gr.209601.116</ext-link></comment> <object-id pub-id-type="pmid">28100584</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Svensson</surname> <given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Power analysis of single-cell RNA-sequencing experiments</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>4</issue>):<fpage>381</fpage>–<lpage>87</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.4220" xlink:type="simple">10.1038/nmeth.4220</ext-link></comment> <object-id pub-id-type="pmid">28263961</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zheng</surname> <given-names>GXY</given-names></name>, <name name-style="western"><surname>Terry</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Belgrader</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ryvkin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Bent</surname> <given-names>ZW</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>:<fpage>14049</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms14049" xlink:type="simple">10.1038/ncomms14049</ext-link></comment> <object-id pub-id-type="pmid">28091601</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Petukhov</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Baryawno</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Severe</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Scadden</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Samsonova</surname> <given-names>MG</given-names></name>, <etal>et al</etal>. <article-title>dropEst: pipeline for accurate estimation of molecular counts in droplet-based single-cell RNA-seq experiments</article-title>. <source>Genome Biol</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>78</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-018-1449-6" xlink:type="simple">10.1186/s13059-018-1449-6</ext-link></comment> <object-id pub-id-type="pmid">29921301</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McCarthy</surname> <given-names>DJ</given-names></name>, <etal>et al</etal>. <article-title>Scater: pre-processing, quality control, normalisation and visualisation of single-cell RNA-seq data in R</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>8</issue>):<fpage>1179</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btw777" xlink:type="simple">10.1093/bioinformatics/btw777</ext-link></comment> <object-id pub-id-type="pmid">28088763</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lun</surname> <given-names>ATL</given-names></name>, <name name-style="western"><surname>McCarthy</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Marioni</surname> <given-names>JC</given-names></name>. <article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor</article-title>. <source>F1000Res</source>. <year>2016</year>;<volume>5</volume>:<fpage>2122</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.12688/f1000research.9501.2" xlink:type="simple">10.12688/f1000research.9501.2</ext-link></comment> <object-id pub-id-type="pmid">27909575</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hashimshony</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Senderovich</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Avital</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Klochendler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>de Leeuw</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Anavy</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>CEL-Seq2: sensitive highly-multiplexed single-cell RNA-Seq</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>:<fpage>77</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-016-0938-8" xlink:type="simple">10.1186/s13059-016-0938-8</ext-link></comment> <object-id pub-id-type="pmid">27121950</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref012">
<label>12</label>
<mixed-citation publication-type="other" xlink:type="simple">Harding P, Wilbrey-Clark A, Polanski K, Loudon K, Ferdinand JR, Mahbubani K, et al. Ischaemic Sensitivity of Human Tissue; 2018. Available from: <ext-link ext-link-type="uri" xlink:href="https://preview.data.humancellatlas.org/" xlink:type="simple">https://preview.data.humancellatlas.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006361.ref013">
<label>13</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>; <year>2017</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/" xlink:type="simple">https://www.R-project.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006361.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huber</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Carey</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Gentleman</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Anders</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Carlson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Carvalho</surname> <given-names>BS</given-names></name>, <etal>et al</etal>. <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nat Methods</source>. <year>2015</year>;<volume>12</volume>(<issue>2</issue>):<fpage>115</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3252" xlink:type="simple">10.1038/nmeth.3252</ext-link></comment> <object-id pub-id-type="pmid">25633503</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref015">
<label>15</label>
<mixed-citation publication-type="other" xlink:type="simple">Allaire JJ, Xie Y, McPherson J, Luraschi J, Ushey K, Atkins A, et al. rmarkdown: Dynamic Documents for R; 2017. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=rmarkdown" xlink:type="simple">https://CRAN.R-project.org/package=rmarkdown</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006361.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eddelbuettel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>François</surname> <given-names>R</given-names></name>. <article-title>Rcpp: Seamless R and C++ Integration</article-title>. <source>Journal of Statistical Software</source>. <year>2011</year>;<volume>40</volume>(<issue>8</issue>):<fpage>1</fpage>–<lpage>18</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v040.i08" xlink:type="simple">10.18637/jss.v040.i08</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref017">
<label>17</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Eddelbuettel</surname> <given-names>D</given-names></name>. <source>Seamless R and C++ Integration with Rcpp</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2013</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006361.ref018">
<label>18</label>
<mixed-citation publication-type="other" xlink:type="simple">Hayden N, Morgan M. Rhtslib: HTSlib high-throughput sequencing library as an R package; 2017. Available from: <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/Rhtslib" xlink:type="simple">https://bioconductor.org/packages/Rhtslib</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006361.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Smyth</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>W</given-names></name>. <article-title>The Subread aligner: fast, accurate and scalable read mapping by seed-and-vote</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>(<issue>10</issue>):<fpage>e108</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkt214" xlink:type="simple">10.1093/nar/gkt214</ext-link></comment> <object-id pub-id-type="pmid">23558742</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Smyth</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>W</given-names></name>. <article-title>featureCounts: an efficient general-purpose program for assigning sequence reads to genomic features</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>7</issue>):<fpage>923</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btt656" xlink:type="simple">10.1093/bioinformatics/btt656</ext-link></comment> <object-id pub-id-type="pmid">24227677</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref021">
<label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">Lun A, Risso D. SingleCellExperiment: S4 Classes for Single Cell Data; 2017. Available from: <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/SingleCellExperiment" xlink:type="simple">https://bioconductor.org/packages/SingleCellExperiment</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006361.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scrucca</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Fop</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>TB</given-names></name>, <name name-style="western"><surname>Raftery</surname> <given-names>AE</given-names></name>. <article-title>mclust 5: clustering, classification and density estimation using Gaussian finite mixture models</article-title>. <source>The R Journal</source>. <year>2016</year>;<volume>8</volume>(<issue>1</issue>):<fpage>205</fpage>–<lpage>233</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006361.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vallejos</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Marioni</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>S</given-names></name>. <article-title>BASiCS: Bayesian Analysis of Single-Cell Sequencing Data</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>6</issue>):<fpage>e1004333</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004333" xlink:type="simple">10.1371/journal.pcbi.1004333</ext-link></comment> <object-id pub-id-type="pmid">26107944</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Risso</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Perraudeau</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gribkova</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dudoit</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Vert</surname> <given-names>JP</given-names></name>. <article-title>A general and flexible method for signal extraction from single-cell RNA-seq data</article-title>. <source>Nat Commun</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>284</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41467-017-02554-5" xlink:type="simple">10.1038/s41467-017-02554-5</ext-link></comment> <object-id pub-id-type="pmid">29348443</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kiselev</surname> <given-names>VY</given-names></name>, <name name-style="western"><surname>Kirschner</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Schaub</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Andrews</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yiu</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Chandra</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>5</issue>):<fpage>483</fpage>–<lpage>486</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.4236" xlink:type="simple">10.1038/nmeth.4236</ext-link></comment> <object-id pub-id-type="pmid">28346451</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Risso</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Purvis</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Fletcher</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ngai</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dudoit</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>clusterExperiment and RSEC: A Bioconductor package and framework for clustering of single-cell and other large gene expression datasets</article-title>. <source>bioRxiv</source>. <year>2018</year>;</mixed-citation>
</ref>
<ref id="pcbi.1006361.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Finak</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>McDavid</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yajima</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gersuk</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Shalek</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>MAST: A Flexible Statistical Framework for Assessing Transcriptional Changes and Characterizing Heterogeneity in Single-Cell RNA Sequencing Data</article-title>. <source>Genome Biol</source>. <year>2015</year>;<volume>16</volume>:<fpage>278</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-015-0844-5" xlink:type="simple">10.1186/s13059-015-0844-5</ext-link></comment> <object-id pub-id-type="pmid">26653891</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Korthauer</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Newton</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yuan</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stewart</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>A statistical approach for identifying differential distributions in single-cell RNA-seq experiments</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>222</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-016-1077-y" xlink:type="simple">10.1186/s13059-016-1077-y</ext-link></comment> <object-id pub-id-type="pmid">27782827</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McCarthy</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Smyth</surname> <given-names>GK</given-names></name>. <article-title>Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume>(<issue>10</issue>):<fpage>4288</fpage>–<lpage>4297</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gks042" xlink:type="simple">10.1093/nar/gks042</ext-link></comment> <object-id pub-id-type="pmid">22287627</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Novershtern</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Subramanian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lawton</surname> <given-names>LN</given-names></name>, <name name-style="western"><surname>Mak</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Haining</surname> <given-names>WN</given-names></name>, <name name-style="western"><surname>McConkey</surname> <given-names>ME</given-names></name>, <etal>et al</etal>. <article-title>Densely interconnected transcriptional circuits control cell states in human hematopoiesis</article-title>. <source>Cell</source>. <year>2011</year>;<volume>144</volume>(<issue>2</issue>):<fpage>296</fpage>–<lpage>309</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2011.01.004" xlink:type="simple">10.1016/j.cell.2011.01.004</ext-link></comment> <object-id pub-id-type="pmid">21241896</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dobin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Schlesinger</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Drenkow</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zaleski</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Jha</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>1</issue>):<fpage>15</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bts635" xlink:type="simple">10.1093/bioinformatics/bts635</ext-link></comment> <object-id pub-id-type="pmid">23104886</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Parekh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ziegenhain</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Vieth</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Enard</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Hellmann</surname> <given-names>I</given-names></name>. <article-title>zUMIs—A fast and flexible pipeline to process RNA sequencing data with UMIs</article-title>. <source>Gigascience</source>. <year>2018</year>;<volume>7</volume>(<issue>6</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/gigascience/giy059" xlink:type="simple">10.1093/gigascience/giy059</ext-link></comment> <object-id pub-id-type="pmid">29846586</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006361.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Candelli</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lijnzaad</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Muraro</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Kerstens</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kemmeren</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Sharq, a versatile preprocessing and QC pipeline for Single Cell RNA-seq</article-title>. <source>bioRxiv</source>. <year>2018</year>;</mixed-citation>
</ref>
<ref id="pcbi.1006361.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van der Maaten</surname> <given-names>LJP</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>GE</given-names></name>. <article-title>Visualizing High-Dimensional Data Using t-SNE</article-title>. <source>Journal of Machine Learning Research</source>. <year>2008</year>;<volume>9</volume>:<fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>