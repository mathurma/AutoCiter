<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-11-01679</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002417</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Genomics</subject>
            </subj-group>
            <subj-group>
              <subject>Population genetics</subject>
            </subj-group>
            <subj-group>
              <subject>Population modeling</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Evolutionary biology</subject>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
          <subj-group>
            <subject>Microbiology</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Computational Biology</subject>
          <subject>Evolutionary Biology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Highly Sensitive and Specific Detection of Rare Variants in Mixed Viral Populations from Massively Parallel Sequence Data</article-title><alt-title alt-title-type="running-head">Rare Variant Detection in Mixed Viral Populations</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Macalalad</surname>
            <given-names>Alexander R.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Zody</surname>
            <given-names>Michael C.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Charlebois</surname>
            <given-names>Patrick</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Lennon</surname>
            <given-names>Niall J.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Newman</surname>
            <given-names>Ruchi M.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Malboeuf</surname>
            <given-names>Christine M.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Ryan</surname>
            <given-names>Elizabeth M.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Boutwell</surname>
            <given-names>Christian L.</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Power</surname>
            <given-names>Karen A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Brackney</surname>
            <given-names>Doug E.</given-names>
          </name>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Pesko</surname>
            <given-names>Kendra N.</given-names>
          </name>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Levin</surname>
            <given-names>Joshua Z.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Ebel</surname>
            <given-names>Gregory D.</given-names>
          </name>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Allen</surname>
            <given-names>Todd M.</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Birren</surname>
            <given-names>Bruce W.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Henn</surname>
            <given-names>Matthew R.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Broad Institute of MIT &amp; Harvard, Cambridge, Massachusetts, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Biostatistics, Harvard University, Boston, Massachusetts, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Ragon Institute of MGH, MIT and Harvard, Boston, Massachusetts, United States of America</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Department of Pathology, University of New Mexico School of Medicine, Albuquerque, New Mexico, United States of America</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Kosakovsky Pond</surname>
            <given-names>Sergei L.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">University of California San Diego, United States of America</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">mhenn@broadinstitute.org</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: ARM MRH. Performed the experiments: ARM MCZ PC MRH. Analyzed the data: ARM MCZ PC TMA MRH. Contributed reagents/materials/analysis tools: ARM MCZ PC NJL RMN CMM EMR CLB KAP DEB KNP JZL GDE TMA BWB MRH. Wrote the paper: ARM MCZ MRH.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>3</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>15</day>
        <month>3</month>
        <year>2012</year>
      </pub-date><volume>8</volume><issue>3</issue><elocation-id>e1002417</elocation-id><history>
        <date date-type="received">
          <day>11</day>
          <month>11</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>20</day>
          <month>1</month>
          <year>2012</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>Macalalad et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Viruses diversify over time within hosts, often undercutting the effectiveness of host defenses and therapeutic interventions. To design successful vaccines and therapeutics, it is critical to better understand viral diversification, including comprehensively characterizing the genetic variants in viral intra-host populations and modeling changes from transmission through the course of infection. Massively parallel sequencing technologies can overcome the cost constraints of older sequencing methods and obtain the high sequence coverage needed to detect rare genetic variants (&lt;1%) within an infected host, and to assay variants without prior knowledge. Critical to interpreting deep sequence data sets is the ability to distinguish biological variants from process errors with high sensitivity and specificity. To address this challenge, we describe <italic>V-Phaser</italic>, an algorithm able to recognize rare biological variants in mixed populations. <italic>V-Phaser</italic> uses covariation (i.e. phasing) between observed variants to increase sensitivity and an expectation maximization algorithm that iteratively recalibrates base quality scores to increase specificity. Overall, <italic>V-Phaser</italic> achieved &gt;97% sensitivity and &gt;97% specificity on control read sets. On data derived from a patient after four years of HIV-1 infection, <italic>V-Phaser</italic> detected 2,015 variants across the ∼10 kb genome, including 603 rare variants (&lt;1% frequency) detected only using phase information. <italic>V-Phaser</italic> identified variants at frequencies down to 0.2%, comparable to the detection threshold of allele-specific PCR, a method that requires prior knowledge of the variants. The high sensitivity and specificity of <italic>V-Phaser</italic> enables identifying and tracking changes in low frequency variants in mixed populations such as RNA viruses.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>New sequencing technologies provide unprecedented resolution to study pathogen populations, such as the single stranded RNA viruses HIV, dengue (DENV), and West Nile (WNV), and how they evolve within infected individuals in response to immune, therapeutic, and vaccine pressures. While these new technologies provide high volumes of data, these data contain process errors. To detect biological variants, especially those occurring at low frequencies in the population, these technologies require a method to differentiate biological variants from process errors with high sensitivity and specificity. To address this challenge, we introduce the <italic>V-Phaser</italic> algorithm, which distinguished the covariation of biological variants from that of process errors. We validate the method by measuring how frequently it correctly identifies variants and errors on actual read sets with known variation. Further, using data derived from a patient following four years of HIV-1 infection, we show that <italic>V-Phaser</italic> can detect biological variants at frequencies comparable to approaches that require prior knowledge. <italic>V-Phaser</italic> is available for download at: <ext-link ext-link-type="uri" xlink:href="http://www.broadinstitute.org/scientific-community/software" xlink:type="simple">http://www.broadinstitute.org/scientific-community/software</ext-link>.</p>
      </abstract><funding-group><funding-statement>This project has been funded with Federal funds from the National Institute of Allergy and Infectious Diseases National Institutes of Health, Department of Health and Human Services, under Contract No.: HHSN27220090018C and HHSN272200900006C (BWB) and grant No: NIAIDP01-AI074415 (TMA, MRH) with additional support from the Bill &amp; Melinda Gates Foundation (TMA, MRH) through the Collaboration for AIDS Vaccine Discovery. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="10"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Genetic differences can arise among individual viral particles within an infected host, and detecting these viral genetic variants can reveal how viruses adapt to challenges such as host immune responses, antiviral medications, and transmission bottlenecks. However, detecting rare variants is difficult with existing sequencing technologies due to low sensitivity, high error rates, and/or poor scalability. For example, bulk-sequencing approaches generate a consensus assembly, but they have limited sensitivity to detect intra-host variation <xref ref-type="bibr" rid="pcbi.1002417-Gunthard1">[1]</xref>. One approach to increase sensitivity is to amplify and clone selected fragments of viral nucleic acids into proliferating targets that are subsequently isolated and sequenced <xref ref-type="bibr" rid="pcbi.1002417-Zhu1">[2]</xref>, but this method has a higher false positive rate and poor scalability. To reduce errors, the single genome amplification (SGA) method isolates individual viral genomes through dilution, and then amplifies and sequences each genome individually to minimize introduced errors <xref ref-type="bibr" rid="pcbi.1002417-Palmer1">[3]</xref>–<xref ref-type="bibr" rid="pcbi.1002417-SalazarGonzalez1">[5]</xref>, although scalability remains an issue. Rare variant detection requires deep coverage that is not cost-effective with current methods of cloning or SGA. To address scalability, massively parallel sequencing technologies can isolate and sequence individual DNA or cDNA molecules en masse from the population of viral genomes and generate millions of short read sequences that can increase the sensitivity and decrease the cost to detect variants <xref ref-type="bibr" rid="pcbi.1002417-Margulies1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002417-Bentley1">[7]</xref>. Still, increased error rates can somewhat impact potential gains in sensitivity. Here, we report on a novel method to detect rare variants that increases sensitivity even in the presence of process errors.</p>
      <p>Detecting biological variants involves not only finding them, which deep sequencing technologies can do with high sensitivity, but also differentiating them from process (i.e. amplification or sequencing) errors. One way to do this is to compare variants to a distribution of errors. For example, several authors have reported using a Poisson or binomial probability model to define the error distribution, and they can call candidates that fall outside the distribution variants <xref ref-type="bibr" rid="pcbi.1002417-Wang1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1002417-Prosperi1">[13]</xref>. These models, however, assume that all bases have equal quality scores, where the base quality score is a measure of how accurate the base call is. This assumption is invalid for bases measured by massively parallel sequencing technologies, as Brockman et al. <xref ref-type="bibr" rid="pcbi.1002417-Brockman1">[14]</xref> have shown, since base quality can vary by several criteria; in fact, sequencing technologies take criteria such as these into account when assigning base quality scores. To avoid this assumption, probability models can incorporate base quality scores. Such probability models exist in tools that call single nucleotide polymorphisms (SNPs) in human and other diploid genomes, including MAQ <xref ref-type="bibr" rid="pcbi.1002417-Li1">[15]</xref>, SoapSNP <xref ref-type="bibr" rid="pcbi.1002417-Li2">[16]</xref>, Unified Genotyper <xref ref-type="bibr" rid="pcbi.1002417-DePristo1">[17]</xref>, SNVMix <xref ref-type="bibr" rid="pcbi.1002417-Goya1">[18]</xref>, or Slider <xref ref-type="bibr" rid="pcbi.1002417-Malhis1">[19]</xref>. In contrast, instead of an explicit error probability model, Hoffman et al. <xref ref-type="bibr" rid="pcbi.1002417-Hoffmann1">[20]</xref> compare variants to an empirical control data set. Archer et al. <xref ref-type="bibr" rid="pcbi.1002417-Archer1">[21]</xref> and Rozera et al. <xref ref-type="bibr" rid="pcbi.1002417-Rozera1">[22]</xref> report methods that correct read sequences for suspected process errors prior to calculating variant frequencies. Archer et al. <xref ref-type="bibr" rid="pcbi.1002417-Archer1">[21]</xref> use a k-mer mapping approach to position reads on a consensus template and refine alignments locally, and Rozera et al. <xref ref-type="bibr" rid="pcbi.1002417-Rozera1">[22]</xref> turn to heuristic rules to filter out errors based on cutoffs for base quality scores and other criteria. Both strategies avoid using an explicit probability model of error and hence assume that all process errors take a specific form, and that no biological variants take the same form as the process errors.</p>
      <p>The above models separate variants from error using specific forms or heuristics or a probabilistic distribution. An alternative approach is to consider patterns of candidate variants. For example, Eriksson et al. <xref ref-type="bibr" rid="pcbi.1002417-Eriksson1">[9]</xref> use Fisher's exact test to find patterns that occur more frequently than expected by chance to call variants. Refining this approach further, several authors probabilistically cluster patterns to infer variant haplotypes <xref ref-type="bibr" rid="pcbi.1002417-Eriksson1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1002417-Zagordi2">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002417-Zagordi3">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1002417-Quince1">[23]</xref>; the cluster centers are haplotypes, and process errors can be removed by collapsing variation within the cluster. Since patterns of variants are essentially groups of variants that occur at the same loci on multiple reads, i.e. in phase, we can analyze them together as a group of phased variants, and we can compare them to phased errors in the same pattern. Phased errors presumably occur much less frequently than errors in general, making it easier to recognize phased variants.</p>
      <p>To address the challenge of calling rare genetic variants in diverse populations in the presence of error, we introduce <italic>V-Phaser</italic>, a single nucleotide variant calling tool that uses phase and quality filtering with a probability model that incorporates and recalibrates individual base quality scores. To increase sensitivity, <italic>V-Phaser</italic> looks not only for variants that fall outside the distribution of errors but also for patterns of variants in phase. To increase specificity, it incorporates individual base quality scores into a composite Bernoulli model that allows error rates to vary from base to base. It also uses a pre-processing filter to screen out low quality bases and improve the fit of the model. We calculate the theoretical gain in sensitivity of detecting variants using phase to increase specificity. We then validate <italic>V-Phaser</italic> on read sets with known variation generated by the 454 sequencing platform to estimate sensitivity and specificity. To determine the effect of each algorithmic step on performance, we evaluate the method with each of three features (phasing, recalibration, and filtering) turned off and compare these results to those achieved on the same data with several other viral variant callers. Finally, we use <italic>V-Phaser</italic> on data from a chronically HIV-1 infected subject to demonstrate its utility to detect low frequency variants in viral populations.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>Using phased variants to increase sensitivity</title>
        <p>Variant calling algorithms typically use a probabilistic or empirical error model to define the distribution of errors, and they recognize those candidates that fall outside of this distribution as variants. We define the boundary between variants and errors to be the <italic>variant detection threshold frequency</italic> (<italic>VDTF</italic>). To this definition, we add the concept of phasing, where phased variants co-occur on the same reads, to distinguish <italic>unphased VDTFs</italic> from <italic>phased VDTFs</italic>, which separate phased variants from phased errors. <italic>V-Phaser</italic> uses both <italic>phased</italic> and <italic>unphased VDTFs</italic> to increase sensitivity. If errors are distributed uniformly at a rate <italic>p</italic>, we cannot use <italic>unphased VDTFs</italic> to find variants that occur below this rate no matter how deeply we sequence the population, since the <italic>unphased VDTF</italic> cannot fall below <italic>p</italic>. In contrast, paired errors occur at the much lower rate of <italic>p</italic><sup>2</sup>, and correlated variant pairs can be detected at much lower frequencies than <italic>p</italic>, so long as that frequency remains above <italic>p</italic><sup>2</sup> and the depth of sequencing is sufficient. Theoretically, we can define <italic>phased VDTFs</italic> for any pattern of variants, but in practice the only patterns <italic>V-Phaser</italic> considers are paired variants in phase.</p>
        <p><italic>V-Phaser</italic> can call paired variants at a lower frequency using <italic>phased VDTFs</italic> compared to <italic>unphased VDTFs</italic>, and given comparable frequencies, <italic>V-Phaser</italic> can call phased variants at lower coverage. We can calculate <italic>phased</italic> and <italic>unphased VDTFs</italic> as a function of coverage and error rate (<xref ref-type="fig" rid="pcbi-1002417-g001">Figure 1</xref>). At any level of coverage and error rate, the <italic>phased VDTF</italic> is lower than the <italic>unphased VDTF</italic>. In addition, the <italic>phased VDTF</italic> remains relatively flat over a range of error rates, whereas the <italic>unphased VDTF</italic> manifests more dynamic range, which suggests that compared to the <italic>unphased VDTF</italic>, even if the probability model grossly misspecifies error rates, the <italic>phased VDTF</italic> is relatively robust.</p>
        <fig id="pcbi-1002417-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002417.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Phase increased sensitivity to detect variants.</title>
            <p>Phase increased sensitivity to detect variants, as seen over a range of error rates at coverages of 100-fold, 250-fold, and 500-fold. The <italic>phased variant detection threshold frequency (VDTF)</italic> is the lowest frequency of reads with variants at two specific loci that <italic>V-Phaser</italic> can distinguish from error among reads that span both loci. The <italic>unphased VDTF</italic> is the lowest frequency of one variant that <italic>V-Phaser</italic> can distinguish from error among reads that cover that locus. 100-fold <italic>phased</italic> sequence coverage achieves comparable detection thresholds as 500-fold <italic>unphased</italic>. We use Equation 7 to calculate the <italic>phased</italic> and <italic>unphased VDTFs</italic>. (See the <xref ref-type="sec" rid="s4">Materials and Methods</xref> section for Equation 7 and its derivation.)</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.g001" xlink:type="simple"/>
        </fig>
        <p><italic>V-Phaser</italic> detects variants in phase when they occur on the same reads, so to be on the same reads, variants need to be close to each other. When variants are close together, many of the reads that cover one variant will also cover the other variant, but when variants are farther apart, fewer and fewer reads will begin and end in just the right places to span both. At some point, the gain from phase will be offset by the loss of shared coverage. To capture this concept, we define the <italic>phase distance</italic> to be the farthest distance from a locus such that compared to the <italic>unphased VDTF</italic> at that locus, the <italic>phased VDTF</italic> is lower (i.e. more informative). If variants are farther apart than the <italic>phase distance</italic>, they do not have enough shared coverage to increase sensitivity. We show that the <italic>phase distance</italic> is longer than half of the average read length for coverage more than 65-fold, and as coverage increases, it approaches the length of the average read (<xref ref-type="fig" rid="pcbi-1002417-g002">Figure 2</xref>). Just as increasing coverage increases sensitivity to detect variants, it also increases the chances to detect phased variants that are farther apart.</p>
        <fig id="pcbi-1002417-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002417.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Phase distance approached length of average read as coverage increased.</title>
            <p>The <italic>phase distance</italic> was longer than half the average read length for loci covered more than 65-fold, and as coverage increased, it approached the length of the average read. The <italic>phase distance</italic> is a measure of how far apart phased variants can be and still be detected at lower frequencies than variants not in phase. We show the phase distance as a percentage of average read length.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.g002" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2b">
        <title>Pre-process filtering and recalibration of base quality scores to increase specificity</title>
        <p>Errors introduced by massively parallel sequencing technologies can be correlated, and models to detect correlated variants can also detect correlated errors, as well. On control read sets without variants, we found that errors vary with base quality score, the position of the base on the read, and the transition from the previous base (<xref ref-type="fig" rid="pcbi-1002417-g003">Figure 3 a–c</xref>). DePristo et al. <xref ref-type="bibr" rid="pcbi.1002417-DePristo1">[17]</xref> use recalibration equations in their Unified Genotyper to adjust for these associations and call SNPs. <italic>V-Phaser</italic> minimizes false positive correlated errors by filtering out errors and modeling the correlations among errors. First, as detailed in the <xref ref-type="sec" rid="s4">Materials and Methods</xref> section, <italic>V-Phaser</italic> uses a read cleanup algorithm, <italic>ReadClean454</italic> <xref ref-type="bibr" rid="pcbi.1002417-Henn1">[24]</xref>, to identify and correct process errors in the reads and then utilizes a Neighborhood Quality Standard (NQS) criteria to filter out low quality bases. From the remaining high quality bases, <italic>V-Phaser</italic> builds an error probability model to adjust for correlations.</p>
        <fig id="pcbi-1002417-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002417.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Error rates were not uniformly distributed.</title>
            <p>Error rates varied by (<bold>A</bold>) read position, (<bold>B</bold>) base transition, and (<bold>C</bold>) base quality score. We counted as errors any mismatches to the consensus assembly for each of the two runs in the control read set under the assumption that the NL-43 infectious clone had no diversity. We defined the read position relative to the beginning or end of the read, whichever was closer. We defined a base transition as a dinucleotide representing the transition from the preceding base to the current base, and we scored a transition as an error if the current base was a mismatch. Base quality scores came from the sequencing process.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.g003" xlink:type="simple"/>
        </fig>
        <p>Modeling base quality well is the key to achieving high specificity, but highly variable viral sequences pose a difficult challenge. To estimate the parameters, models are often fit to highly conserved genomic regions without variation, but such regions do not exist for small, diverse viral genomes. Models can also be fit to empiric negative controls, but error rates can vary from lane to lane or from run to run. Instead, <italic>V-Phaser</italic> uses an expectation-maximization (EM) algorithm to iteratively fit its probability model as it calls variants. Initially, <italic>V-Phaser</italic> treats all mismatches as errors and estimates the parameters accordingly using the recalibration equations of the Unified Genotyper <xref ref-type="bibr" rid="pcbi.1002417-DePristo1">[17]</xref>. In the E step, <italic>V-Phaser</italic> uses the model to calculate the <italic>VDTFs</italic> to call variants and remove them from the error list. Then in the M step, <italic>V-Phaser</italic> updates the parameters to the model. <italic>V-Phaser</italic> iterates until the number of variants called stabilizes.</p>
      </sec>
      <sec id="s2c">
        <title>Validating <italic>V-Phaser</italic></title>
        <p>To evaluate <italic>V-Phaser</italic>'s performance, we used read sets with known variability generated by the 454 FLX sequencing platform. Using these control data, we validated the variants called by the comprehensive algorithm and also evaluated the contribution of each core component of <italic>V-Phaser</italic> to the model's sensitivity and specificity. First, we assessed the effect of using or not using phased variants by invoking a version of <italic>V-Phaser</italic> that only used <italic>unphased VDTFs</italic> to identify variants. Second, we measured the effect of using individual base quality scores utilizing a version of <italic>V-Phaser</italic> that estimates two uniform error rates, for homopolymer and nonhomopolymer regions. Finally, we tested the impact of low quality base filtering invoking a version of <italic>V-Phaser</italic> without NQS pre-processing filters. The positive control data were 454 read sets derived from an artificial mixture of eight strains of West Nile Virus (WNV) for which we knew the individual strain sequence. We limited our analysis to regions of the genome covered by all eight individual sequences. Differences among the individual consensus assemblies defined the WNV variant set; a total of 110 variants were defined. We scored any error call that <italic>V-Phaser</italic> made on this set of variants as a false negative, and any variant call as a true positive.</p>
        <p>Of the 110 variants in the WNV variant set, 102 variants were detected with frequencies ranging from 0.3% to 47.5%, and a median frequency of 11.3% (<xref ref-type="supplementary-material" rid="pcbi.1002417.s002">Table S1</xref>). Eight variants were not observed on any sequence reads. <italic>V-Phaser</italic> called 100/102 variants present in the data resulting in a sensitivity of 98% (<xref ref-type="fig" rid="pcbi-1002417-g004">Figure 4a</xref>), including 15/17 (88%) of the variants at frequencies under 1% (<xref ref-type="fig" rid="pcbi-1002417-g005">Figure 5 a–d</xref>). All versions of <italic>V-Phaser</italic> could detect 100% of the variants above 2.5%, but without <italic>phased VDTFs V-Phaser</italic> could detect only 9/17 (53%) of the minor variants present at less than 1.0% in frequency, and it still missed other variants with frequencies as high as 2.4%. Of the remaining 10,004 loci assumed to be non-variant based on consensus sequence comparison, <italic>V-Phaser</italic> called 143 variants, for a putative specificity of 99%. Out of 555 loci that showed variation in the mixture read set but not in the parental strains, <italic>V-Phaser</italic> correctly called 74% of them as errors. It is possible that many or most of the mistaken variant calls could be artificial variants or mutations that were introduced somewhere in the process of creating the mixture, rather than sequencing errors.</p>
        <fig id="pcbi-1002417-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002417.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Phase information increased sensitivity, and base quality scores increased specificity.</title>
            <p>We compared <italic>V-Phaser</italic> to alternate versions of <italic>V-Phaser</italic> with specific components disabled. In the No Phase version, <italic>V-Phaser</italic> called variants without phase information. In the Uniform Errors version, <italic>V-Phaser</italic> estimated uniform error rates within homopolymer and nonhomopolymer regions without regard to assigned base qualities. In the No Filtering version, <italic>V-Phaser</italic> did not filter out low quality bases. (<bold>A</bold>) Phase information increased sensitivity. The version without phase information attained a sensitivity of 90%, but all other versions of <italic>V-Phaser</italic> used phase information and attained a sensitivity of 97% or more. We calculated sensitivity as the percentage of known variants correctly identified. Data are from WNV mixed population control dataset. (<bold>B</bold>) Individual base quality scores increased specificity. Among loci with mismatches, the Uniform Errors version had only 91% specificity, but all other versions incorporated base quality scores in their probability model and attained 97% specificity or more. We calculated specificity as the percentage of loci in the control sample correctly identified as having no variants among loci that had at least one candidate variant. Data are from infectious clone (HIV NL4-3) control dataset.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.g004" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002417-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002417.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Phase information increased sensitivity to detect minor variants.</title>
            <p>Phase information increased sensitivity to detect low frequency variants, as shown by these histograms of variants under 2.5%. All versions of <italic>V-Phaser</italic> detected 100% of the variants above 2.5% frequency, so these variants are not shown here. All versions of <italic>V-Phaser</italic> with phase information (<bold>A</bold>), (<bold>C</bold>), and (<bold>D</bold>) detected most variants below 1% in frequency, but the No Phase version (<bold>B</bold>) missed many variants below 1% and some variants as high as 2.5%. Data are from control WNV mixed population.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.g005" xlink:type="simple"/>
        </fig>
        <p>Because of the unknown rate of novel variants introduced during passage of the WNV samples, we used an infectious clone (HIV NL4-3) as a negative control to more accurately measure the specificity of <italic>V-Phaser</italic>. We scored any variant calls that <italic>V-Phaser</italic> made on the negative control as a false positive, and any error calls as a true negative. Among all loci in the negative control read set, 87% had no mismatches. Considering only the loci that harbored variation, all versions of <italic>V-Phaser</italic> maintained specificity greater than 97% if they incorporated individual base quality scores, but for the version using uniform errors, the specificity fell to 91% (<xref ref-type="fig" rid="pcbi-1002417-g004">Figure 4b</xref>). Among these sites with variation, <italic>V-Phaser</italic> called 29 sites that ranged in frequency from 0.4% to 5.6% as true variants; some of these sites may actually be biological variants and not process errors (see <xref ref-type="sec" rid="s3">discussion</xref> below). If the composite Bernoulli model correctly described the error distribution, then 95% of the time <italic>V-Phaser</italic> would not make any false positive calls on the entire sample. Clearly, the composite Bernoulli model fits the error distribution better than a uniform error model, but the false positives are evidence that at least some errors did not follow the model.</p>
        <p>We tested the validity of the composite Bernoulli model by assessing how well the model fit the error distribution with and without filtering using a quantile-quantile (q-q) plot as described in the <xref ref-type="sec" rid="s4">Materials and Methods</xref> section. Compared to the unfiltered data, the filtered data produced a model that fit the observed error distribution better (<xref ref-type="fig" rid="pcbi-1002417-g006">Figure 6 a–b</xref>). Without pre-processing filters, <italic>V-Phaser</italic> systematically overestimated the probability of error. This overestimation of the model seemed to be a function of the number of low quality bases. As we sampled without replacement from 1% to 100% of the reads, we saw an increasing skew in the q-q plot (<xref ref-type="supplementary-material" rid="pcbi.1002417.s001">Figure S1</xref> a–f). In addition, to test whether homopolymer related artifacts in 454 sequencing were causing <italic>V-Phaser</italic> to overcall variants, we examined the error calls made by <italic>V-Phaser</italic> on the clonal HIV NL4-3 data. Since homopolymer related artifacts systematically violate model assumptions, the resulting overcalls would be expected to cluster in or near homopolymer regions. False positives were not significantly more likely to be observed in homopolymer nucleotide runs, nor in regions proximal to these runs, as compared to residues outside of these regions, regardless of whether a variant is called with phase or without phase (χ<sup>2</sup> test p&gt;0.4 in all comparisons). These results were consistent if we extended the homopolymer flanking regions to three or four instead of two bases. Therefore, false positives appear to be unrelated to homopolymer related artifacts and <italic>V-Phaser</italic> appears to have no strong susceptibility to errors induced by system error on the 454 sequencing platform.</p>
        <fig id="pcbi-1002417-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002417.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>NQS filtering improves fit of probability model to data.</title>
            <p>(<bold>A</bold>) Quantile-quantile (q-q) plots under NQS filtering show good fit of the probability model to the observed distribution of errors. Since the probability model is discrete, p values are projected onto a uniform distribution, and the distribution of projected p values is compared with the expected null distribution. See <xref ref-type="sec" rid="s4">Materials and Methods</xref> section for details. (<bold>B</bold>) In contrast, q-q plots under no filtering show that no filtering skews the calibration of the probability model used by <italic>V-Phaser</italic>. Q-q plots of models based on subsets of the reads demonstrate that this effect becomes more pronounced with increasing coverage (see <xref ref-type="supplementary-material" rid="pcbi.1002417.s001">Figure S1</xref>). Q-q plots are scaled to fit curve, so y = x line is not at a 45 degree angle.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.g006" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2d">
        <title>Comparison to other variant calling algorithms</title>
        <p>We ran several other variant calling programs on our control data sets. The programs <italic>ShoRAH</italic> <xref ref-type="bibr" rid="pcbi.1002417-Zagordi3">[12]</xref> and <italic>ViSPa</italic> <xref ref-type="bibr" rid="pcbi.1002417-Astrovskaya1">[25]</xref> both generated compute errors that were not easily resolved by the software's authors when run on our data set. We successfully ran <italic>Segminator II</italic> <xref ref-type="bibr" rid="pcbi.1002417-Archer1">[21]</xref> and <italic>QuRe</italic> <xref ref-type="bibr" rid="pcbi.1002417-Prosperi1">[13]</xref>. <italic>QuRe</italic> filters regions of the genome that have less than 30-fold read coverage or are below the 5<sup>th</sup> percentile of coverage (defaults); as such comparison of sensitivity and specificity across the various algorithms was computed only across the bases interrogated by <italic>QuRe</italic>. Sensitivity and specificity of the three programs, in addition to results for <italic>V-Phaser</italic> with phasing turned off, are shown in <xref ref-type="table" rid="pcbi-1002417-t001">Table 1</xref>. <italic>V-Phaser</italic> outperformed both of the other programs in specificity. Although <italic>Segminator II</italic> had 100% sensitivity, it achieved this at the expense of a very high false positive rate, calling variants at more than 20% of the examined invariant sites. Notably, the counting of inserted or deleted bases as false positives can significantly impact reported specificities. <italic>V-Phaser</italic> reports a deleted base in two instances while <italic>QuRe</italic> and <italic>Segminator II</italic> report 841 and six respectively. Inclusion of indels in the measure of specificity decreases <italic>QuRe</italic>'s specificity considerably (<xref ref-type="table" rid="pcbi-1002417-t001">Table 1</xref>), but this likely a less accurate measure of the algorithms specificity since such errors could be easily filtered.</p>
        <table-wrap id="pcbi-1002417-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002417.t001</object-id><label>Table 1</label><caption>
            <title>Comparison of <italic>V-Phaser</italic> to other viral variant callers.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002417-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Program</td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Segminator II</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>QuRe</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>V-Phaser</italic>
                </td>
                <td align="left" colspan="1" rowspan="1"><italic>V-Phaser</italic> (no phasing)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">Sensitivity</td>
                <td align="left" colspan="1" rowspan="1">100.0%</td>
                <td align="left" colspan="1" rowspan="1">89.0%</td>
                <td align="left" colspan="1" rowspan="1">96.0%</td>
                <td align="left" colspan="1" rowspan="1">89.0%</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Specificity</td>
                <td align="left" colspan="1" rowspan="1">88.% (88.8%)</td>
                <td align="left" colspan="1" rowspan="1">97.1% (88.7%)</td>
                <td align="left" colspan="1" rowspan="1">99.9% (99.9%)</td>
                <td align="left" colspan="1" rowspan="1">99.7% (99.6%)</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>Sensitivities and specificities reported across residues interrogated by all programs. Sensitivity is measured as the fraction of the known variants found by each program in the WNV mixed population control data set. Specificity is the fraction of sites not containing known variants that were called as invariant in the HIV NL4-3 control data set; values reported in parentheses include inserted and deleted bases (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>).</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
      <sec id="s2e">
        <title>Applying <italic>V-Phaser</italic> to clinical data</title>
        <p>We applied <italic>V-Phaser</italic> to data from an individual with chronic HIV-1 infection taken from a larger study <xref ref-type="bibr" rid="pcbi.1002417-Henn1">[24]</xref>, and we analyzed called variants by the frequency of these variants among the reads at that position. Using just <italic>unphased VDTFs</italic>, <italic>V-Phaser</italic> called only 485 variants, none of which were &lt;1%; using no filtering, <italic>V-Phaser</italic> called 1,778 variants; with <italic>phased VDTFs</italic> and filtering, <italic>V-Phaser</italic> detected 2,015 variants, including 603 variants with frequency &lt;1% (<xref ref-type="fig" rid="pcbi-1002417-g007">Figure 7</xref>). Notably, <italic>V-Phaser</italic> detected variants down to 0.2%, a detection threshold comparable to allele-specific PCR <xref ref-type="bibr" rid="pcbi.1002417-Boltz1">[26]</xref>. More than one out of every five loci had a recognized variant. Assuming the specificity of <italic>V-Phaser</italic> remained constant, the positive predictive value was estimated as 98%. Of note, <italic>V-Phaser</italic> identified 42 insertions or deletions (indels) as variants, and <italic>V-Phaser</italic> detected 198 triallelic loci and 19 quadallelic loci.</p>
        <fig id="pcbi-1002417-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002417.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Low frequency variants overwhelmingly called with phase.</title>
            <p>Histogram shows low frequency variants overwhelmingly called with phase thresholds. Variants frequencies are estimated by the frequencies of variants among the reads at that position. Versions of <italic>V-Phaser</italic> with and without phase thresholds called variants on a clinical sample that are binned by their frequency at their locus. Most variants &lt;5% were detected only be <italic>V-Phaser</italic> with phase thresholds, and the version without phase thresholds detected no variants &lt;1%.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.g007" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p><italic>V-Phaser</italic> called rare variants in the presence of error in massively parallel sequencing data of highly diverse viral populations with &gt;97% sensitivity and &gt;97% specificity. Applied to a sample from a chronically HIV-1 infected individual, <italic>V-Phaser</italic> could identify as many as 603 minor variants at population frequencies of &lt;1%. These variants were detected without <italic>a priori</italic> knowledge of the specific mutations, and biological variants at frequencies as low as 0.2% were identified, comparable to the detection threshold of allele-specific PCR, which is restricted to assaying known mutations. In these data, <italic>V-Phaser</italic> called 42 indels and identified more than 200 loci (roughly 2% of the genome) with more than one variant.</p>
      <p>In direct comparisons to two other recently published variant callers, <italic>Segminator II</italic> <xref ref-type="bibr" rid="pcbi.1002417-Archer1">[21]</xref> and <italic>QuRe</italic> <xref ref-type="bibr" rid="pcbi.1002417-Prosperi1">[13]</xref>, <italic>V-Phaser</italic> outperformed both algorithms on specificity and outperformed <italic>QuRe</italic> on both specificity and sensitivity. This is not surprising since <italic>QuRe</italic> implements the error correction model of Wang <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002417-Wang2">[27]</xref>, which only considers pileup information. In fact, if we turn off the phasing portion of <italic>V-Phaser</italic>, it performs identically to <italic>QuRe</italic> on sensitivity, but even better on specificity (<xref ref-type="table" rid="pcbi-1002417-t001">Table 1</xref>). <italic>Segminator II</italic> identifies all the true variants in the WNV mixed population data set, but at the cost of an unacceptably high false positive rate. Its alignment-based read filtering only removes errors arising from process-based indels while ignoring errors from other sources, such as random substitution errors due to sequence misreads or PCR errors in library construction.</p>
      <p>The comprehensive <italic>V-Phaser</italic> model clearly outperformed the model using uniform error rates, but the number of false positives was higher than expected with the Bonferroni correction. Some of these false positives detected in the negative-control might actually be low level variants present in the HIV NL4-3 cDNA libraries used to generate the read set that had not been previously detected. Some might be errors introduced early and amplified to create correlated errors not modeled by <italic>V-Phaser</italic>. Particularly when considering the 454 sequencing process, which generates systematic errors in regions around homopolymers, correlated error may occur in such regions. However, we have multiple reasons to believe that this has a small impact on the final <italic>V-Phaser</italic> calls. First, <italic>V-Phaser</italic>'s base context model in the quality recalibration accounts for some amount of homopolymer error. Second, our <italic>ReadClean454</italic> read cleanup step during the alignment phase removes or marks as low quality the majority of errors derived from homopolymer misreads or “carry forward and incomplete extension” (CAFIE) errors (a related 454 error mode) <xref ref-type="bibr" rid="pcbi.1002417-Henn1">[24]</xref>. Third, we examined the error calls made by <italic>V-Phaser</italic> on the clonal HIV NL4-3 data to see if they clustered in or near homopolymer regions, and we found them to be randomly distributed with respect to homopolymer regions. While the false positive rate was very low for the highly diverse clinical sample we used, it could be higher for samples with very low diversity since the false positive rate is inversely proportional to the total number of true variants. Another potential weakness of the model is the modeling of indels. DePristo et al. <xref ref-type="bibr" rid="pcbi.1002417-DePristo1">[17]</xref> suggest that indel errors distribute differently from other errors and need to be modeled differently. We did not explicitly test <italic>V-Phaser</italic> for indel detection in the artificial mixture used as the positive control, since the set of variants had no indels.</p>
      <p><italic>V-Phaser</italic> uses phase information to increase sensitivity. Correlated errors under the model are rarer than errors in general, making it easier to call correlated variants. One potential problem is the presence of chimeras, where one read is a composite from two different genomes. Chimeras can decrease the correlation between variants, but data from Hedskog, et al. <xref ref-type="bibr" rid="pcbi.1002417-Hedskog1">[28]</xref> suggest that chimeras occur rarely, making it difficult to significantly obscure any correlation. The biggest limitation to using phase information is the read length generated by the sequencing platform. We saw that correlated variants need to be close enough to add to the sensitivity, and that this phase distance is bounded by the average read length (<xref ref-type="fig" rid="pcbi-1002417-g002">Figure 2</xref>). For the 454 platform the average read length is over 500 bp, but for other platforms the average read length is much shorter. This limitation could be overcome by utilizing paired-end reads to extend the phase distance to cover variants significantly farther apart.</p>
      <p><italic>V-Phaser</italic> is a variant calling tool that uses phase information to increase sensitivity and models base quality to increase specificity. <italic>V-Phaser</italic> is an effective tool to call variants in the presence of errors from massively parallel sequencing data with high specificity and high sensitivity. We designed <italic>V-Phaser</italic> to overcome specific challenges to calling variants in small, diverse viral genomes, but <italic>V-Phaser</italic> is general enough to analyze read sets from other populations as well, such as metagenomic data and tumor sequencing data, making it a novel algorithm with wide utility.</p>
    </sec>
    <sec id="s4" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title>Ethics statement</title>
        <p>The subject gave written informed consent and the study was approved by the Massachusetts General Hospital and granted exemption by the Massachusetts Institute of Technology Review Boards.</p>
      </sec>
      <sec id="s4b">
        <title>Statistical model</title>
        <p>We construct a composite model of independent Bernoulli random variables that are not identically distributed to allow error rates to vary from base to base. We suppose that the base <italic>b<sub>ik</sub></italic> at genomic locus <italic>i</italic> and read <italic>k</italic> is measured at an error rate <italic>p<sub>ik</sub></italic>, where reads are aligned to a reference assembly with loci numbered from 1 to <italic>l</italic>, and reads at locus <italic>i</italic> are numbered from 1 to <italic>n<sub>i</sub></italic>, the coverage at locus <italic>i</italic>. We define the error random variable <italic>E<sub>ik</sub></italic> to be 1 if <italic>b<sub>ik</sub></italic> is measured incorrectly, and 0 otherwise. Let the random variable <italic>X<sub>i</sub></italic> be the number of errors that occur at locus <italic>i</italic>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.e001" xlink:type="simple"/><label>(1)</label></disp-formula></p>
        <p>Under the special case that the errors are independent and identically distributed Bernoulli random variables, such that <italic>p<sub>ik</sub></italic> = <italic>p<sub>i</sub></italic> for all reads <italic>k</italic> at locus <italic>i</italic>, <italic>X<sub>i</sub></italic> follows a binomial distribution, so the probability <italic>f<sub>i</sub></italic>(<italic>x</italic>) that <italic>x</italic> or more errors occur at locus <italic>i</italic> with coverage of <italic>n<sub>i</sub></italic> reads is as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.e002" xlink:type="simple"/><label>(2)</label></disp-formula></p>
        <p>More generally, if <italic>X<sub>i</sub></italic> is the sum of independent Bernoulli random variables that are not identically distributed, we can calculate <italic>f<sub>i</sub></italic>(<italic>x</italic>) with the recursive application of the discrete convolution formula, where we define the random variable <italic>U<sub>ir</sub></italic> as the number of errors that occur at locus <italic>i</italic> in the first <italic>r</italic> reads:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.e003" xlink:type="simple"/><label>(3)</label></disp-formula></p>
        <p>We define the unphased variant detection threshold <italic>t<sub>i</sub></italic> as the smallest <italic>t</italic> such that <italic>f<sub>i</sub></italic>(<italic>t</italic>) is statistically significant. To adjust for multiple testing, we use the Bonferroni correction since errors are uncorrelated under the null hypothesis. At a significance level α, and applying the Bonferroni correction for testing the total number of positions sequenced <italic>c</italic>, we calculate <italic>t<sub>i</sub></italic> as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.e004" xlink:type="simple"/><label>(4)</label></disp-formula></p>
        <p>If mismatches at position <italic>i</italic> occurred in <italic>t</italic> reads, we can infer if the mismatches are variants by comparing <italic>t</italic> to <italic>t<sub>i</sub></italic>. If <italic>t</italic> is greater than or equal to <italic>t<sub>i</sub></italic>, then we infer that not all of the mismatches are errors, and at least one of them is a variant. If <italic>t</italic> is less than <italic>t<sub>i</sub></italic>, then we infer that we cannot distinguish these mismatches from error.</p>
        <p>Under the probability model, errors are independent, but variants can be phylogenetically related. Thus, we can also distinguish variants from errors if mismatches at one locus are correlated with mismatches at a different locus. In particular, we define the error random variable <italic>E<sub>ijk</sub></italic> to be 1 if errors occur at both loci <italic>i</italic> and <italic>j</italic> on read <italic>k</italic> and 0 otherwise. Then the number of errors <italic>X<sub>ij</sub></italic> that occur in phase at both loci <italic>i</italic> and <italic>j</italic>, with shared coverage of <italic>n<sub>ij</sub></italic> reads that span both <italic>i</italic> and <italic>j</italic>, is the sum of error random variables as before. In the special case that errors are identically distributed Bernoulli random variables, where <italic>p<sub>ik</sub></italic> = <italic>p<sub>i</sub></italic> and <italic>p<sub>jk</sub></italic> = <italic>p<sub>j</sub></italic> for all reads <italic>k</italic> that cover both loci <italic>i</italic> and <italic>j</italic>, we calculate the phase probability <italic>g<sub>ij</sub></italic>(<italic>x</italic>) as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.e005" xlink:type="simple"/><label>(5)</label></disp-formula></p>
        <p>In the more general case, we can calculate <italic>g<sub>ij</sub></italic>(<italic>x</italic>) by recursively applying the discrete convolution formula as before, where we define the random variable <italic>U<sub>ijr</sub></italic> as the number of reads with errors that occur at locus <italic>i</italic> and locus <italic>j</italic> among the first <italic>r</italic> shared reads:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.e006" xlink:type="simple"/></disp-formula></p>
        <p>At a significance level α and applying the Bonferroni correction for testing the total number <italic>b</italic> of pairs of loci <italic>i</italic> and <italic>j</italic> such that <italic>g<sub>ij</sub></italic> is defined, we can calculate the phased variant detection threshold <italic>t<sub>ij</sub></italic> as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.e007" xlink:type="simple"/><label>(6)</label></disp-formula></p>
        <p>If we find phased mismatches at locus <italic>i</italic> and locus <italic>j</italic> on <italic>t</italic> reads, we can infer if they are variants by comparing <italic>t</italic> to <italic>t<sub>ij</sub></italic>. If <italic>t</italic> is greater than or equal to <italic>t<sub>ij</sub></italic>, then we infer that not all of these mismatches are errors. Otherwise, we cannot distinguish these mismatches from errors.</p>
        <p>We define the <italic>unphased variant detection threshold frequency</italic> (<italic>VDTF</italic>) <italic>F<sub>i</sub></italic> to be the frequency at which we begin to distinguish variants from errors at locus <italic>i</italic> and depth <italic>n<sub>i</sub></italic>. Similarly, we define the <italic>phased VDTF F<sub>ij</sub></italic> to be the frequency at which we begin to distinguish phased variants from errors at loci <italic>i</italic> and <italic>j</italic> and shared depth <italic>n<sub>ij</sub></italic>. We calculate <italic>F<sub>i</sub></italic> and <italic>F<sub>ij</sub></italic> as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.e008" xlink:type="simple"/><label>(7)</label></disp-formula></p>
      </sec>
      <sec id="s4c">
        <title>Sample preparation, assembly, and annotation of control and sample read sets</title>
        <p>We sequenced an HIV infectious clone (NL4-3) to serve as a negative control for our validations and HIV RNA derived from a clinical sample as previously described <xref ref-type="bibr" rid="pcbi.1002417-Henn1">[24]</xref>. We derived the positive control read set from eight individual primary WNV strains isolated from mosquitoes and birds. Individual strains were passaged once in C6/36 cells for amplification, and equal concentrations of each strain were then pooled and used to infect C6/36 cells at a multiplicity of infection of 0.1. Viral RNA was isolated from these cultures (QIAmp viral RNA mini kit, Qiagen) and the RNA genome reverse transcribed to cDNA using Superscript III reverse transcriptase (Invitrogen), random hexamers (Roche) and a specific oligonucleotide targeting the 3′ end of the target genome sequences. Four overlapping PCR products, each of size ∼3 kb, were designed to capture the WNV coding region. PCR products were then pooled and sheared prior to library construction.</p>
        <p>To generate each read set, whole viral genomes were sequenced using the Broad Institute's viral genome sequencing and assembly pipeline. Pooled PCR products (∼3 kb) were amplified using primer sets specific to either HIV or WNV, acoustically sheared, and sequenced on the 454 Genome Sequencer FLX Titanium (Roche) using standard protocols. The library was loaded into a picotiter plate (PTP) to yield &gt;200-fold read coverage. Resulting sequence reads were trimmed of primer sequences, filtered for high quality, assembled <italic>de novo</italic> and annotated using the Broad Institute's <italic>AssembleViral454</italic> algorithm <xref ref-type="bibr" rid="pcbi.1002417-Henn1">[24]</xref> and an in-house annotation algorithm. Reference consensus assemblies used in analyses are available from NCBI's GenBank under accessions HQ505665, JN819311, JN819312, JN819313, JN819315, JN819318, JN819319, JN819320, JN819315, JQ403053, and JQ403055; read data are available from NCBI's Short Read Archive (Project Accessions SRA045000 and SRA045569).</p>
      </sec>
      <sec id="s4d">
        <title>Alignment and preprocessing filters</title>
        <p>Once we generated the sequence data, we aligned and processed them using <italic>ReadClean454</italic> algorithm as previously described <xref ref-type="bibr" rid="pcbi.1002417-Henn1">[24]</xref>. In particular, the algorithm corrects typical errors introduced by the 454 sequences, including carry forward and incomplete extension errors, homopolymer errors, and indels that break the open reading frame (ORF). Any base rearrangements do not affect the assigned base quality. Any insertions to preserve the ORF consist of N bases with an assigned base quality of 1.</p>
        <p>We then flagged each base to indicate if it passed the NQS criteria <xref ref-type="bibr" rid="pcbi.1002417-Altshuler1">[29]</xref>. A base met NQS criteria if its quality score was 20 or higher and the five bases to either side all had quality scores of 15 or higher. We omitted the final NQS criterion that at least nine of the ten flanking bases were perfect matches, since we expected the HIV genome to be variable enough that variants among the flanking bases could be relatively common <xref ref-type="bibr" rid="pcbi.1002417-Henn1">[24]</xref>. For calling variants, <italic>V-Phaser</italic> ignored any bases flagged as not meeting the NQS criteria.</p>
      </sec>
      <sec id="s4e">
        <title>Estimation of model parameters by EM algorithm</title>
        <p>Once we aligned and preprocessed the sequence data, we estimated the model parameters and applied the model to the data to call variants. In the uniform error case, we estimated error rates in homopolymer and nonhomopolymer regions, where homopolymer regions are defined by runs of 3 or more identical nucleotides in a row. In the general case, we estimated error rates overall, per base transition (where each transition was a dinucleotide consisting of a base and its preceding base in the read sequence), and per read position (distance from the start or end of the read, whichever was closer). We then used these estimates in calibration equations <xref ref-type="bibr" rid="pcbi.1002417-DePristo1">[17]</xref> to estimate the error rate for each base.</p>
        <p>As <italic>V-Phaser</italic> called variants, it iteratively adjusted model parameters using an EM algorithm. It initialized the algorithm by treating all mismatches as errors to estimate error rates. In the E step, it derived phased and unphased thresholds, called variants, and removed these variants from the list of errors. In the M step, it updated error rates due to the removal of called variants from the error list. <italic>V-Phaser</italic> continued to iterate until it could call no more variants.</p>
      </sec>
      <sec id="s4f">
        <title>Correlation of <italic>V-Phaser</italic> errors with homopolymers</title>
        <p>To test whether homopolymer-related artifacts in 454 sequencing which violated the model assumptions were causing <italic>V-Phaser</italic> to overcall variants, we divided the reference sequence of the clonal HIV NL4-3 genome into three categories: homopolymeric regions (defined as 3 or more of the same nucleotide in a row), homopolymer flanking regions (defined as 2 bases to either side of an homopolymeric region, representing the region in which CAFIE errors are expected to occur), and non-homopolymeric regions (the remainder of the genome). We then assigned each of the false positive calls made by <italic>V-Phaser</italic> to one of these categories and used a χ<sup>2</sup> test (2 d.f.) to determine whether any region had more variants than expected.</p>
      </sec>
      <sec id="s4g">
        <title>Construction of quantile-quantile plots</title>
        <p>We use quantile-quantile (q-q) plots to assess the fit of our probability models under the null. To assess the fit of the model to the observed data, we compute the probability of observing each datum under the model using <italic>F</italic>(<italic>x</italic>), the cumulative distribution function (CDF), and compare the distribution of these observed probabilities against the expected distribution of cumulative probabilities under the null. For random variables with continuous CDFs, the expected distribution under the null is the uniform distribution between 0 and 1. For our probability models, the expected distribution of probabilities under the null is more difficult to calculate, since the CDF is discrete and varies from locus to locus with the base qualities at that locus. Since our models use discrete rather than continuous random variables, we redistribute the mass of the probability mass function to construct a uniform distribution. We define <italic>G</italic>(<italic>x</italic>), a projection of the cumulative distribution function (PCDF) that maps the CDF probabilities onto the uniform distribution in the following way:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.e009" xlink:type="simple"/></disp-formula>Conceptually, the PCDF redistributes massed probabilities uniformly to bridge discontinuities in the CDF. For example, if <italic>X</italic> is a random Bernoulli variable with success probability <italic>p</italic> and failure probability <italic>q</italic> = 1−<italic>p</italic> and CDF <italic>F<sub>X</sub></italic>, then <italic>F<sub>X</sub></italic>(<italic>k</italic>) = 0 for <italic>k</italic>&lt;0, <italic>F<sub>X</sub></italic>(<italic>k</italic>) = <italic>q</italic> for 0≤<italic>k</italic>&lt;1, and <italic>F<sub>X</sub></italic>(<italic>k</italic>) = 1 for <italic>k</italic>≥1. The discontinuities at <italic>k</italic> = 0 and <italic>k</italic> = 1 correspond to the massed probabilities for <italic>X</italic> at those values. <italic>G</italic> redistributes this mass uniformly to bridge the discontinuity. So whenever <italic>X</italic> = 0, <italic>G</italic>(<italic>F<sub>X</sub></italic>(<italic>k</italic> = 0)) uniformly takes on a value between 0 and <italic>q</italic>, and whenever <italic>X</italic> = 1, <italic>G</italic>(<italic>F<sub>X</sub></italic>(<italic>k</italic> = 1)) uniformly takes on a value between <italic>q</italic> and 1. <italic>X</italic> can take on no other values, so <italic>G</italic>(<italic>F<sub>X</sub>(k</italic> = <italic>X</italic>)) follows a uniform distribution between 0 and 1. So if we have <italic>n</italic> observations of <italic>X</italic>, about <italic>p</italic>/<italic>n</italic> of them will be 1 and about <italic>q</italic>/<italic>n</italic> of them will be 0. The expected cumulative probabilities for each observed 0 will all be <italic>q</italic>, but their projected probabilities will be uniformly distributed between 0 and <italic>q</italic>. Similarly, the projected probabilities for each observed 1 will be uniformly distributed between <italic>q</italic> and 1. If we sort the observations by their projected probabilities, then the projected probability for the <italic>i</italic>th observation will be very close to <italic>i</italic>/<italic>n</italic>. By construction, these projected probabilities are uniformly distributed between 0 and 1 under the null. So even though the CDFs vary by locus with the mix of error rates among bases at that locus, the PCDF remains uniform. Thus, we can compare the projected distribution of PCDF probabilities against the expected distribution under the null, which by design is the uniform distribution.</p>
      </sec>
      <sec id="s4h">
        <title>Comparison to other variant callers</title>
        <p>We evaluated <italic>V-Phaser</italic>'s performance in terms of sensitivity and specificity to detect variants relative to four other programs designed for variant detection in viral quasispecies populations: <italic>ShoRAH</italic> <xref ref-type="bibr" rid="pcbi.1002417-Zagordi3">[12]</xref>, <italic>ViSPa</italic> <xref ref-type="bibr" rid="pcbi.1002417-Astrovskaya1">[25]</xref>, <italic>Segminator II</italic> <xref ref-type="bibr" rid="pcbi.1002417-Archer1">[21]</xref>, and <italic>QuRe</italic> <xref ref-type="bibr" rid="pcbi.1002417-Prosperi1">[13]</xref>. All programs were run according to standard parameters defined by the software authors. In all cases, we used the alignment and read cleaning (if any) methods recommended by the authors. Only the <italic>Segminator II</italic> and <italic>QuRe</italic> software packages successfully ran on our datasets. For <italic>V-Phaser</italic>, we used our standard process including <italic>ReadClean454</italic> <xref ref-type="bibr" rid="pcbi.1002417-Henn1">[24]</xref> to error correct and align the reads. In all cases, we used our sample-specific consensus assemblies as the reference for alignment. Sensitivity was computed using our WNV mixed population control data set and specificity was determined using the HIV NL4-3 infectious clone control data set. In scoring the resulting calls, we ignored all inserted and deleted bases called (6 by <italic>Segminator II</italic>, 2 by <italic>V-Phaser</italic>, and 841 by <italic>QuRe</italic>), because we could not determine the exact number of discrete indel events called by <italic>QuRe</italic> and felt that it would be unfair to count all 841 as errors since such errors could be filtered (the data have no known indels based on the input strain sequences).</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002417.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.s001" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>Impact of not filtering by NQS on model calibration with increased coverage.</bold> Quantile-quantile (q-q) plots for no NQS filtering data model show that the skew in the calibration of the probability model used by <italic>V-Phaser</italic> increases with increased sequence coverage. The impact of the skew is demonstrated for (<bold>A</bold>) 5-fold, (<bold>B</bold>) 27-fold, (<bold>C</bold>) 52-fold, (<bold>D</bold>) 131-fold, (<bold>E</bold>) 262-fold, and (<bold>F</bold>) 528-fold sequence coverage.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002417.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002417.s002" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <p><bold><italic>V-Phaser</italic></bold><bold> variant calls in experimental WNV mixed population.</bold> Eight parental strains of WNV were mixed at equal proportions and then infected into mosquito cells and allowed to proliferate, resulting in a final mixture with ratios set by the relative replicative success of the strains. The nucleotide sequence in each parental strain at residues known to contain a mutation are shown and a “.” indicates the strain has the dominant allele at that particular residue. Dominant residues are noted in the variant column. The true proportion of the parental strains in the sequenced mixture is not set, but since we know the strain or strains of origin for all of the variants, we can infer the mix of parental strain proportions that maximizes the likelihood of observing the actual counts (including zero) of all parental alleles in the sequencing data. The resultant frequencies are presented in the “expected” column to provide an estimate of the true frequency of the variants in the population. This allows us to capture the full effect of stochastic variation in the sequencing process on our ability to detect variants of any given population frequency.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank J. Quackenbush, A. Price, C. Lange, K. Munger, M. DePristo, E. Banks, R. Poplin, and G. Del Angel for their helpful comments during the development of these ideas. We thank Leslie Gaffney for assistance with figure preparations.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002417-Gunthard1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gunthard</surname><given-names>HF</given-names></name><name name-style="western"><surname>Wong</surname><given-names>JK</given-names></name><name name-style="western"><surname>Ignacio</surname><given-names>CC</given-names></name><name name-style="western"><surname>Havlir</surname><given-names>DV</given-names></name><name name-style="western"><surname>Richman</surname><given-names>DD</given-names></name></person-group>             <year>1998</year>             <article-title>Comparative performance of high-density oligonucleotide sequencing and dideoxynucleotide sequencing of HIV type 1 pol from clinical samples.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>14</volume>             <fpage>869</fpage>             <lpage>76</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Zhu1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>T</given-names></name><name name-style="western"><surname>Mo</surname><given-names>H</given-names></name><name name-style="western"><surname>Wang</surname><given-names>N</given-names></name><name name-style="western"><surname>Nam</surname><given-names>DS</given-names></name><name name-style="western"><surname>Cao</surname><given-names>Y</given-names></name><etal/></person-group>             <year>1993</year>             <article-title>Genotypic and Phenotypic Characterization of HIV-1 in Patients with Primary Infection.</article-title>             <source>Science</source>             <volume>261</volume>             <fpage>1179</fpage>             <lpage>1181</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Palmer1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Palmer</surname><given-names>S</given-names></name><name name-style="western"><surname>Kearney</surname><given-names>M</given-names></name><name name-style="western"><surname>Maldarelli</surname><given-names>F</given-names></name><name name-style="western"><surname>Halvas</surname><given-names>EK</given-names></name><name name-style="western"><surname>Bixby</surname><given-names>CJ</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>Multiple, Linked Human Immunodeficiency Virus Type 1 Drug Resistance Mutations in Treatment-Experienced Patients Are Missed by Standard Genotype Analysis.</article-title>             <source>J Clin Microbiol</source>             <volume>43</volume>             <fpage>406</fpage>             <lpage>413</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/jcm.43.1.406-413.2005" xlink:type="simple">10.1128/jcm.43.1.406-413.2005</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Zhang1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>LQ</given-names></name><name name-style="western"><surname>Simmonds</surname><given-names>P</given-names></name><name name-style="western"><surname>Ludlam</surname><given-names>CA</given-names></name><name name-style="western"><surname>Brown</surname><given-names>AJ</given-names></name></person-group>             <year>1991</year>             <article-title>Detection, quantification and sequencing of HIV-1 from the plasma of seropositive individuals and from factor VIII concentrates.</article-title>             <source>AIDS</source>             <volume>5</volume>             <fpage>675</fpage>             <lpage>81</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-SalazarGonzalez1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Salazar-Gonzalez</surname><given-names>JF</given-names></name><name name-style="western"><surname>Bailes</surname><given-names>E</given-names></name><name name-style="western"><surname>Pham</surname><given-names>KT</given-names></name><name name-style="western"><surname>Salazar</surname><given-names>MG</given-names></name><name name-style="western"><surname>Guffey</surname><given-names>MB</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Deciphering Human Immunodeficiency Virus Type 1 Transmission and Early Envelope Diversification by Single-Genome Amplification and Sequencing.</article-title>             <source>J Virol</source>             <volume>82</volume>             <fpage>3952</fpage>             <lpage>3970</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/jvi.02660-07" xlink:type="simple">10.1128/jvi.02660-07</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Margulies1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Margulies</surname><given-names>M</given-names></name><name name-style="western"><surname>Egholm</surname><given-names>M</given-names></name><name name-style="western"><surname>Altman</surname><given-names>WE</given-names></name><name name-style="western"><surname>Attiya</surname><given-names>S</given-names></name><name name-style="western"><surname>Bader</surname><given-names>JS</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>Genome sequencing in microfabricated high-density picolitre reactors.</article-title>             <source>Nature</source>             <volume>437</volume>             <fpage>376</fpage>             <lpage>380</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Bentley1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bentley</surname><given-names>DR</given-names></name><name name-style="western"><surname>Balasubramanian</surname><given-names>S</given-names></name><name name-style="western"><surname>Swerdlow</surname><given-names>HP</given-names></name><name name-style="western"><surname>Smith</surname><given-names>GP</given-names></name><name name-style="western"><surname>Milton</surname><given-names>J</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Accurate whole human genome sequencing using reversible terminator chemistry.</article-title>             <source>Nature</source>             <volume>456</volume>             <fpage>53</fpage>             <lpage>59</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Wang1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>C</given-names></name><name name-style="western"><surname>Mitsuya</surname><given-names>Y</given-names></name><name name-style="western"><surname>Gharizadeh</surname><given-names>B</given-names></name><name name-style="western"><surname>Ronaghi</surname><given-names>M</given-names></name><name name-style="western"><surname>Shafer</surname><given-names>RW</given-names></name></person-group>             <year>2007</year>             <article-title>Characterization of mutation spectra with ultra-deep pyrosequencing: Application to HIV-1 drug resistance.</article-title>             <source>Genome Res</source>             <volume>17</volume>             <fpage>1195</fpage>             <lpage>1201</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Eriksson1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Eriksson</surname><given-names>N</given-names></name><name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name><name name-style="western"><surname>Mitsuya</surname><given-names>Y</given-names></name><name name-style="western"><surname>Rhee</surname><given-names>S-Y</given-names></name><name name-style="western"><surname>Wang</surname><given-names>C</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Viral Population Estimation Using Pyrosequencing.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>e1000074</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Zagordi1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zagordi</surname><given-names>O</given-names></name><name name-style="western"><surname>Geyrhofer</surname><given-names>L</given-names></name><name name-style="western"><surname>Roth</surname><given-names>V</given-names></name><name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name></person-group>             <year>2010</year>             <article-title>Deep sequencing of a genetically heterogeneous sample: local haplotype reconstruction and read error correction. J Comput.</article-title>             <source>Biol</source>             <volume>17</volume>             <fpage>417</fpage>             <lpage>428</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2009.0164" xlink:type="simple">10.1089/cmb.2009.0164</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Zagordi2">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zagordi</surname><given-names>O</given-names></name><name name-style="western"><surname>Klein</surname><given-names>R</given-names></name><name name-style="western"><surname>Däumer</surname><given-names>M</given-names></name><name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name></person-group>             <year>2010</year>             <article-title>Error correction of next-generation sequencing data and reliable estimation of HIV quasispecies.</article-title>             <source>Nucleic Acids Res</source>             <volume>38</volume>             <fpage>7400</fpage>             <lpage>7409</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkq655" xlink:type="simple">10.1093/nar/gkq655</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Zagordi3">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zagordi</surname><given-names>O</given-names></name><name name-style="western"><surname>Bhattacharya</surname><given-names>A</given-names></name><name name-style="western"><surname>Eriksson</surname><given-names>N</given-names></name><name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name></person-group>             <year>2011</year>             <article-title>ShoRAH: estimating the genetic diversity of a mixed sample from next-generation sequencing data.</article-title>             <source>BMC Bioinf</source>             <volume>12</volume>             <fpage>119</fpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-119" xlink:type="simple">10.1186/1471-2105-12-119</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Prosperi1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Prosperi</surname><given-names>MCF</given-names></name><name name-style="western"><surname>Salemi</surname><given-names>M</given-names></name></person-group>             <year>2012</year>             <article-title>QuRe: software for viral quasispecies reconstruction from next-generation sequencing data.</article-title>             <source>Bioinformatics</source>             <volume>28</volume>             <fpage>132</fpage>             <lpage>133</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr627" xlink:type="simple">10.1093/bioinformatics/btr627</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Brockman1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brockman</surname><given-names>W</given-names></name><name name-style="western"><surname>Alvarez</surname><given-names>P</given-names></name><name name-style="western"><surname>Young</surname><given-names>S</given-names></name><name name-style="western"><surname>Garber</surname><given-names>M</given-names></name><name name-style="western"><surname>Giannoukos</surname><given-names>G</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Quality scores and SNP detection in sequencing-by-synthesis systems.</article-title>             <source>Genome Res</source>             <volume>18</volume>             <fpage>763</fpage>             <lpage>70</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/gr.070227.107" xlink:type="simple">gr.070227.107</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Li1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name><name name-style="western"><surname>Ruan</surname><given-names>J</given-names></name><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name></person-group>             <year>2008</year>             <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores.</article-title>             <source>Genome Res</source>             <volume>18</volume>             <fpage>1851</fpage>             <lpage>8</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/gr.078212.108" xlink:type="simple">gr.078212.108</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Li2">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>R</given-names></name><name name-style="western"><surname>Li</surname><given-names>Y</given-names></name><name name-style="western"><surname>Fang</surname><given-names>X</given-names></name><name name-style="western"><surname>Yang</surname><given-names>H</given-names></name><name name-style="western"><surname>Wang</surname><given-names>J</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>SNP detection for massively parallel whole-genome resequencing.</article-title>             <source>Genome Res</source>             <volume>19</volume>             <fpage>1124</fpage>             <lpage>32</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/gr.088013.108" xlink:type="simple">gr.088013.108</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-DePristo1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>DePristo</surname><given-names>MA</given-names></name><name name-style="western"><surname>Banks</surname><given-names>E</given-names></name><name name-style="western"><surname>Poplin</surname><given-names>R</given-names></name><name name-style="western"><surname>Garimella</surname><given-names>K</given-names></name><name name-style="western"><surname>Maguire</surname><given-names>JD</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>A Framework for Variation Discovery and Genotyping Using Next-Generation DNA Sequencing Data.</article-title>             <source>Nat Genet</source>             <volume>43</volume>             <fpage>491</fpage>             <lpage>498</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Goya1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Goya</surname><given-names>R</given-names></name><name name-style="western"><surname>Sun</surname><given-names>MG</given-names></name><name name-style="western"><surname>Morin</surname><given-names>RD</given-names></name><name name-style="western"><surname>Leung</surname><given-names>G</given-names></name><name name-style="western"><surname>Ha</surname><given-names>G</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>SNVMix: predicting single nucleotide variants from next-generation sequencing of tumors.</article-title>             <source>Bioinformatics</source>             <volume>26</volume>             <fpage>730</fpage>             <lpage>6</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/btq040" xlink:type="simple">btq040</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Malhis1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Malhis</surname><given-names>N</given-names></name><name name-style="western"><surname>Butterfield</surname><given-names>YS</given-names></name><name name-style="western"><surname>Ester</surname><given-names>M</given-names></name><name name-style="western"><surname>Jones</surname><given-names>SJ</given-names></name></person-group>             <year>2009</year>             <article-title>Slider–maximum use of probability information for alignment of short sequence reads and SNP detection.</article-title>             <source>Bioinformatics</source>             <volume>25</volume>             <fpage>6</fpage>             <lpage>13</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/btn565" xlink:type="simple">btn565</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Hoffmann1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hoffmann</surname><given-names>C</given-names></name><name name-style="western"><surname>Minkah</surname><given-names>N</given-names></name><name name-style="western"><surname>Leipzig</surname><given-names>J</given-names></name><name name-style="western"><surname>Wang</surname><given-names>G</given-names></name><name name-style="western"><surname>Arens</surname><given-names>MQ</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>DNA bar coding and pyrosequencing to identify rare HIV drug resistance mutations.</article-title>             <source>Nucleic Acids Res</source>             <volume>35</volume>             <fpage>e91</fpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkm435" xlink:type="simple">10.1093/nar/gkm435</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Archer1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Archer</surname><given-names>J</given-names></name><name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name><name name-style="western"><surname>Taillon</surname><given-names>BE</given-names></name><name name-style="western"><surname>Harrigan</surname><given-names>PR</given-names></name><name name-style="western"><surname>Lewis</surname><given-names>M</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>The Evolutionary Analysis of Emerging Low Frequency HIV-1 CXCR<sub>4</sub> Using Variants through Time - An Ultra-Deep Approach.</article-title>             <source>PLoS Comput Biol</source>             <volume>6</volume>             <fpage>e1001022</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Rozera1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rozera</surname><given-names>G</given-names></name><name name-style="western"><surname>Abbate</surname><given-names>I</given-names></name><name name-style="western"><surname>Bruselles</surname><given-names>A</given-names></name><name name-style="western"><surname>Vlassi</surname><given-names>C</given-names></name><name name-style="western"><surname>D'Offizi</surname><given-names>G</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Massively parallel pyrosequencing highlights minority variants in the HIV-1 env quasispecies deriving from lymphomonocyte sub-populations.</article-title>             <source>Retrovirology</source>             <volume>6</volume>             <fpage>15</fpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/1742-4690-6-15" xlink:type="simple">1742-4690-6-15</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Quince1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Quince</surname><given-names>C</given-names></name><name name-style="western"><surname>Lanzen</surname><given-names>A</given-names></name><name name-style="western"><surname>Davenport</surname><given-names>RJ</given-names></name><name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name></person-group>             <year>2011</year>             <article-title>Removing noise from pyrosequenced amplicons.</article-title>             <source>BMC Bioinf</source>             <volume>12</volume>             <fpage>38</fpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-38" xlink:type="simple">10.1186/1471-2105-12-38</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Henn1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Henn</surname><given-names>MR</given-names></name><name name-style="western"><surname>Boutwell</surname><given-names>CL</given-names></name><name name-style="western"><surname>Charlebois</surname><given-names>P</given-names></name><name name-style="western"><surname>Lennon</surname><given-names>NJ</given-names></name><name name-style="western"><surname>Power</surname><given-names>KA</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Whole Genome Deep Sequencing of HIV-1 Reveals the Impact of Early Minor Variants Upon Immune Recognition During Acute Infection.</article-title>             <source>PLoS Pathog</source>             <volume>8</volume>             <comment>In press</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Astrovskaya1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Astrovskaya</surname><given-names>I</given-names></name><name name-style="western"><surname>Tork</surname><given-names>B</given-names></name><name name-style="western"><surname>Mangul</surname><given-names>S</given-names></name><name name-style="western"><surname>Westbrooks</surname><given-names>K</given-names></name><name name-style="western"><surname>Măndoiu</surname><given-names>I</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Inferring viral quasispecies spectra from 454 pyrosequencing reads.</article-title>             <source>BMC Bioinf</source>             <volume>12</volume>             <fpage>S1</fpage>             <lpage>S1</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-S6-S1" xlink:type="simple">10.1186/1471-2105-12-S6-S1</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Boltz1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Boltz</surname><given-names>VF</given-names></name><name name-style="western"><surname>Maldarelli</surname><given-names>F</given-names></name><name name-style="western"><surname>Martinson</surname><given-names>N</given-names></name><name name-style="western"><surname>Morris</surname><given-names>L</given-names></name><name name-style="western"><surname>McIntyre</surname><given-names>JA</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Optimization of allele-specific PCR using patient-specific HIV consensus sequences for primer design.</article-title>             <source>J Virol Methods</source>             <volume>164</volume>             <fpage>122</fpage>             <lpage>6</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/S0166-0934(09)00509-6" xlink:type="simple">S0166-0934(09)00509-6</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Wang2">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>C</given-names></name><name name-style="western"><surname>Mitsuya</surname><given-names>Y</given-names></name><name name-style="western"><surname>Gharizadeh</surname><given-names>B</given-names></name><name name-style="western"><surname>Ronaghi</surname><given-names>M</given-names></name><name name-style="western"><surname>Shafer</surname><given-names>RW</given-names></name></person-group>             <year>2007</year>             <article-title>Characterization of mutation spectra with ultra-deep pyrosequencing: application to HIV-1 drug resistance.</article-title>             <source>Genome Res</source>             <volume>17</volume>             <fpage>1195</fpage>             <lpage>1201</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.6468307" xlink:type="simple">10.1101/gr.6468307</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Hedskog1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hedskog</surname><given-names>C</given-names></name><name name-style="western"><surname>Mild</surname><given-names>M</given-names></name><name name-style="western"><surname>Jernberg</surname><given-names>J</given-names></name><name name-style="western"><surname>Sherwood</surname><given-names>E</given-names></name><name name-style="western"><surname>Bratt</surname><given-names>G</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Dynamics of HIV-1 Quasispecies during Antiviral Treatment Dissected Using Ultra-Deep Pyrosequencing.</article-title>             <source>PLoS ONE</source>             <volume>5</volume>             <fpage>e11345</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002417-Altshuler1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altshuler</surname><given-names>D</given-names></name><name name-style="western"><surname>Pollara</surname><given-names>VJ</given-names></name><name name-style="western"><surname>Cowles</surname><given-names>CR</given-names></name><name name-style="western"><surname>Van Etten</surname><given-names>WJ</given-names></name><name name-style="western"><surname>Baldwin</surname><given-names>J</given-names></name><etal/></person-group>             <year>2000</year>             <article-title>An SNP map of the human genome generated by reduced representation shotgun sequencing.</article-title>             <source>Nature</source>             <volume>407</volume>             <fpage>513</fpage>             <lpage>516</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35035083" xlink:type="simple">10.1038/35035083</ext-link></comment>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>