<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">08-PLCB-RA-0031R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000131</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Neuroscience/Animal Cognition</subject><subject>Neuroscience/Behavioral Neuroscience</subject><subject>Neuroscience/Cognitive Neuroscience</subject><subject>Neuroscience/Theoretical Neuroscience</subject></subj-group></article-categories><title-group><article-title>Modeling the Violation of Reward Maximization and Invariance in Reinforcement Schedules</article-title><alt-title alt-title-type="running-head">Violation of Invariance in Reinforcement Schedules</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>La Camera</surname><given-names>Giancarlo</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Richmond</surname><given-names>Barry J.</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1">          <addr-line>Laboratory of Neuropsychology, National Institute of Mental Health, National Institutes of Health, Department of Health and Human Services, Bethesda, Maryland, United States of America</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Friston</surname><given-names>Karl J.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">University College London, United Kingdom</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">bjr@ln.nimh.nih.gov</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: GLC BJR. Performed the experiments: GLC BJR. Analyzed the data: GLC BJR. Contributed reagents/materials/analysis tools: GLC BJR. Wrote the paper: GLC BJR.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>8</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>8</day><month>8</month><year>2008</year></pub-date><volume>4</volume><issue>8</issue><elocation-id>e1000131</elocation-id><history>
<date date-type="received"><day>22</day><month>1</month><year>2008</year></date>
<date date-type="accepted"><day>18</day><month>6</month><year>2008</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Public Domain declaration which stipulates that, once placed in the public domain, this work may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose.</license-p></license></permissions><abstract>
<p>It is often assumed that animals and people adjust their behavior to maximize reward acquisition. In visually cued reinforcement schedules, monkeys make errors in trials that are not immediately rewarded, despite having to repeat error trials. Here we show that error rates are typically smaller in trials equally distant from reward but belonging to longer schedules (referred to as “schedule length effect”). This violates the principles of reward maximization and invariance and cannot be predicted by the standard methods of Reinforcement Learning, such as the method of temporal differences. We develop a heuristic model that accounts for all of the properties of the behavior in the reinforcement schedule task but whose predictions are not different from those of the standard temporal difference model in choice tasks. In the modification of temporal difference learning introduced here, the effect of schedule length emerges spontaneously from the sensitivity to the immediately preceding trial. We also introduce a policy for general Markov Decision Processes, where the decision made at each node is conditioned on the motivation to perform an instrumental action, and show that the application of our model to the reinforcement schedule task and the choice task are special cases of this general theoretical framework. Within this framework, Reinforcement Learning can approach contextual learning with the mixture of empirical findings and principled assumptions that seem to coexist in the best descriptions of animal behavior. As examples, we discuss two phenomena observed in humans that often derive from the violation of the principle of invariance: “framing,” wherein equivalent options are treated differently depending on the context in which they are presented, and the “sunk cost” effect, the greater tendency to continue an endeavor once an investment in money, effort, or time has been made. The schedule length effect might be a manifestation of these phenomena in monkeys.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Theories of rational behavior are built on a number of principles, including the assumption that subjects adjust their behavior to maximize their long-term returns and that they should work equally hard to obtain a reward in situations where the effort to obtain reward is the same (called the invariance principle). Humans, however, are sensitive to the manner in which equivalent choices are presented, or “framed,” and often have a greater tendency to continue an endeavor once an investment in money, effort, or time has been made, a phenomenon known as “sunk cost” effect. In a similar manner, when monkeys must perform different numbers of trials to obtain a reward, they work harder as the number of trials already performed increases, even though both the work remaining and the forthcoming reward are the same in all situations. Methods from the theory of Reinforcement Learning, which usually provide learning strategies aimed at maximizing returns, cannot model this violation of invariance. Here we generalize a prominent method of Reinforcement Learning so as to explain the violation of invariance, without losing the ability to model behaviors explained by standard Reinforcement Learning models. This generalization extends our understanding of how animals and humans learn and behave.</p>
</abstract><funding-group><funding-statement>Work supported by the Intramural Research Program, NIMH. The views expressed in this article do not necessarily represent the views of the NIMH, NIH, or the United States Government.</funding-statement></funding-group><counts><page-count count="17"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>In studying reward-seeking behavior it is often assumed that animals attempt to maximize long term returns. This postulate often forms the basis of normative models of decision making <xref ref-type="bibr" rid="pcbi.1000131-Bell1">[1]</xref>, choice behavior <xref ref-type="bibr" rid="pcbi.1000131-Schweighofer1">[2]</xref>–<xref ref-type="bibr" rid="pcbi.1000131-Dickson1">[4]</xref>, and motivation <xref ref-type="bibr" rid="pcbi.1000131-Niv1">[5]</xref>, and plays a prominent role in the field of Reinforcement Learning (RL; see, e.g., <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref>). RL is a set of methods for learning to predict rewarding outcomes from their association with environmental cues, and to exploit these predictions to generate effective behavioral policies. These are policies that comply with principles of reward maximization <xref ref-type="bibr" rid="pcbi.1000131-Simon1">[7]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Schoemaker1">[8]</xref> and invariance <xref ref-type="bibr" rid="pcbi.1000131-Arrow1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Tversky1">[10]</xref>. Applied to reward-seeking behavior, the principle of reward maximization states that subjects should maximize the reward/cost ratio, and the invariance principle that subjects should be equally motivated when facing situations with identical reward/cost ratios.</p>
<p>The idea of maximizing reward over time or effort is general and has provided an effective basis for describing decision-making where the choice between available options is basically a matter of preference. RL methods such as the method of temporal differences (TD) constitute an efficient way of solving decision problems in tasks where a subject must choose between a larger vs. a smaller reward, or between a more probable vs. a less probable reward, and predict courses of actions comparable to the actual behavior observed in animals performing the same tasks <xref ref-type="bibr" rid="pcbi.1000131-Samejima1">[11]</xref>–<xref ref-type="bibr" rid="pcbi.1000131-Haruno1">[13]</xref>.</p>
<p>RL methods have proven less successful, however, in situations where motivation, defined as the incentive to be engaged in a task at all, plays a strong role <xref ref-type="bibr" rid="pcbi.1000131-Dayan1">[14]</xref>–<xref ref-type="bibr" rid="pcbi.1000131-Dayan3">[16]</xref>. A case in point is the behavior of monkeys performing visually-cued reinforcement schedules <xref ref-type="bibr" rid="pcbi.1000131-Bowman1">[17]</xref>, wherein a series of identical actions is required to obtain reward, and a visual cue indicates how many trials remain to be completed before a reward is delivered (“reward schedule task,” see <xref ref-type="fig" rid="pcbi-1000131-g001">Figure 1</xref>). In this task, the error rate of the monkeys is proportional to the number of unrewarded trials remaining before reward, indicating that the value of the trial is modified by knowing the number of remaining trials. This violates the principle of reward-maximization: monkeys make errors in unrewarded trials that will have to be repeated, thus preventing optimal reward-harvesting behavior.</p>
<fig id="pcbi-1000131-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000131.g001</object-id><label>Figure 1</label><caption>
<title>Behavioral paradigm used in the reward schedule task.</title>
<p>(A) Color discrimination task. Each trial begins with the monkey touching a bar. A visual cue (horizontal black bar) appears immediately. Four hundred milliseconds later a red dot (WAIT signal) appears in the center of the cue. After a random interval of 500–1500 ms the dot turns green (GO signal). The monkey is required to release the touch-bar between 200 and 800 ms after the green dot appeared, in which case the dot turns blue (OK signal), and a drop of water is delivered 250 to 350 ms later. If the monkey fails to release the bar within the 200–800 ms interval after the GO signal, an error is registered, and no water is delivered. An anticipated bar release (&lt;200 ms) is also counted as an error. (Red, green and blue dots are enlarged for the purpose of illustration). (B) 2-trial schedule. Each trial is a color discrimination task as in panel <italic>A</italic>, with cues of different brightness for different trials (see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details). In the 2-trial schedule, completion of the first trial is not rewarded and is followed by the second trial after an inter-trial interval (ITI) of 1–2 seconds. An error at any point during a trial causes the trial to be aborted and then started again after the ITI interval. The same applies to schedules of any length. Schedules of different length are randomly interleaved. Note that after an error, the schedule is resumed from the current trial and not from the first trial of the schedule.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.g001" xlink:type="simple"/></fig>
<p>Here we show that in trials equally far from reward, monkeys make fewer errors in longer schedules, when more trials have already been performed (“schedule length effect”). Thus, the value of the current trial is also modified by the number of trials already completed. This behavior violates the principle of invariance: monkeys perform differently in trials equally far from reward, depending on the number of trials already completed in the current schedule. Taken together, these results suggest that the behavior in the reward schedule task does not develop under the principles of invariance and reward-optimization, as commonly assumed when applying RL methods to understanding reward-seeking behavior.</p>
<p>We present a RL rule which predicts the monkeys' behavior in the reward schedule task. Such a rule is a heuristic generalization of TD learning. When applied to the reward schedule task, it predicts all aspects of monkeys' behavior, including the sensitivity to the contextual effect due to schedule length leading to the violation of the invariance principle. When applied to a task involving choice preference, the new method predicts the same behavior as does the standard TD model. Thus, the behaviors in the reward schedule and in choice tasks can be the consequence of the same learning rule.</p>
<p>Building on the special cases of the reward schedule and choice tasks, we then provide a general theory for Markov Decision Processes, wherein the transition to the next state is governed in a manner similar to a choice task, but is conditioned on whether the agent is sufficiently motivated to act at all, like in the reward schedule task. Finally, we link the schedule length effect to instances of “framing” <xref ref-type="bibr" rid="pcbi.1000131-Tversky2">[18]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Kahneman1">[19]</xref> and “sunk cost” effects <xref ref-type="bibr" rid="pcbi.1000131-Arkes1">[20]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Arkes2">[21]</xref>, which also emerge in conjunction with the violation of the principle of invariance.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Behavior</title>
<p>In this work we collate the behavior of 24 monkeys tested in the reward schedule task <xref ref-type="bibr" rid="pcbi.1000131-Bowman1">[17]</xref>, and analyze the entire set of data as a group (see <xref ref-type="sec" rid="s4">Material and Methods</xref>). In this task, a series of trials had to be completed successfully to obtain reward at the end of the series. This series is defined to be a schedule, which is then characterized by its length measured in number of trials (<xref ref-type="sec" rid="s4">Materials and Methods</xref> and <xref ref-type="fig" rid="pcbi-1000131-g001">Figure 1</xref>). The monkey starts each trial by holding a bar which causes a visual cue to appear on a computer screen, followed by the appearance of a red dot in the middle of the screen. The monkey must wait for the red dot to turn green (“GO” signal), at which point it must release the bar within a 200–1000 ms window. If the bar is released correctly, the monkey proceeds to the next trial of the schedule. Each trial must be repeated until performed correctly.</p>
<p>In the presence of visual cues informing the monkey of the progress through the schedule (Valid Cue condition), the percentage of errors in all monkeys was directly related to the number of trials remaining to be completed in the schedule, i.e., the largest number of errors occurred in the trials that are furthest from the reward (<italic>χ</italic><sup>2</sup> test, <italic>p</italic>&lt;0.05; <xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2A and 2B</xref>, circles; each trial is labeled by the fraction <italic>τ</italic>/<italic>s</italic>, where <italic>τ</italic> stands for current trial and <italic>s</italic> stands for current schedule length). The performance in terminal trials was indistinguishable across schedules for each monkey, was above 94% correct in 14 out of 24 monkeys, and above 90% in 19 out of 24 monkeys.</p>
<fig id="pcbi-1000131-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000131.g002</object-id><label>Figure 2</label><caption>
<title>Monkeys' behavior in the reward schedule task.</title>
<p>(A–B) Error rates as a function of schedule state for two monkeys, for both valid (circles) and random cues (“x”). Each schedule state is labeled by the fraction <italic>τ</italic>/<italic>s</italic>, where <italic>τ</italic> stands for current trial and <italic>s</italic> stands for current schedule length. Maximal schedule length was 3 for monkey A and 4 for monkey B. In both monkeys, error rates with valid cues are significantly different (<italic>χ</italic><sup>2</sup> test, <italic>p</italic>&lt;10<sup>−10</sup>). In monkey A, the error rate in states 1/2 is larger than in state 2/3 (Marasquilo test for multiple comparisons, <italic>p</italic>&lt;0.005); in monkey B, the error rate in state 2/3 is larger than in state 3/4, and error rate in state 1/2 is larger than in state 2/3 (Marasquilo test, <italic>p</italic>&lt;0.05). Original data from refs. <xref ref-type="bibr" rid="pcbi.1000131-SugaseMiyamoto1">[25]</xref> (<italic>A</italic>) and <xref ref-type="bibr" rid="pcbi.1000131-Shidara2">[44]</xref> (<italic>B</italic>). (C) scatter plot of the difference in error rates between states 1/2 and 2/3 (<italic>E</italic>(1/2)−<italic>E</italic>(2/3)) vs. the maximal error rate for all 24 monkeys. Filled circles mark positive differences <italic>E</italic>(1/2)−<italic>E</italic>(2/3) which are significant (Marasquilo test for multiple comparisons, <italic>p</italic>&lt;0.05). (D) error rates (dots) for the 12 monkeys corresponding to the closed circles in panel <italic>C</italic>. Thick grey lines: medians.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.g002" xlink:type="simple"/></fig>
<p>In the Random Cue condition the visual cues were selected at random and bore no relationship to schedule state. In such a condition, error rates were indistinguishable across all schedule states (or idiosyncratic; “x” in <xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2A and 2B</xref>; <italic>χ</italic><sup>2</sup> test, <italic>p</italic>&gt;0.05 in 10 out of 15 monkeys tested in the Random Cue condition), and close to the error rates in terminal trials in the Valid Cue condition. Thus, performance in unrewarded trials in the Valid Cue condition was well below the ability of the monkeys. Since the individual trials of each schedule have the same perceptual and motor demands, we interpret the different error rates as being related to the different levels of motivation. This interpretation is also supported by the observation that, in most monkeys, the reaction times become faster as the end of the schedule is approached <xref ref-type="bibr" rid="pcbi.1000131-Bowman1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1000131-Liu1">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1000131-SugaseMiyamoto1">[25]</xref>.</p>
<p>In the penultimate trials of each schedule (i.e., 1/2, 2/3, and 3/4 when available) 20 of 24 monkeys made progressively fewer errors as the schedule became longer (sign test, <italic>p</italic>&lt;0.005). The error rate in state 1/2 was significantly larger than in state 2/3 in 12 out of 20 monkeys (Marascuilo procedure, <italic>p</italic>&lt;0.05, see <xref ref-type="sec" rid="s4">Materials and Methods</xref> and <xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2C and 2D</xref>). In two of three monkeys tested with 4 schedules, the error rate in state 2/3 was also significantly larger than in state 3/4. The third monkey tested with 4 schedules showed small error rates, and multiple comparisons between penultimate trials were not significant (monkeys often will not perform the task with 4 schedules <xref ref-type="bibr" rid="pcbi.1000131-Bowman1">[17]</xref>).</p>
<p>In many of these studies the cues were distinguished by their brightness, where their brightness had been set according to the number of trials remaining in the schedule (<xref ref-type="sec" rid="s4">Material and Methods</xref>), raising the possibility that performance was related to judging the brightness. However, this seems unlikely because the behavioral sensitivity was also seen when unique stimuli, e.g., Walsh patterns, were used as cues (e.g., <xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2</xref> of <xref ref-type="bibr" rid="pcbi.1000131-Liu2">[26]</xref>), where no feature of the visual stimulus is a graded function of reward proximity or progress through the schedule. In conclusion, in a population of monkeys there was a significant tendency for motivation to increase with the number of trials already performed, at parity of proximity to reward. We refer this phenomenon to as the “schedule length effect.”</p>
</sec><sec id="s2b">
<title>Model</title>
<p>In the reward schedule task, all trials have the same cost because they all require the same action in response to the same trigger (the appearance of the green dot); trials differ only in their proximity to reward, which in turn does not depend on how many trials have already been performed. A standard reinforcement learning method can only learn to predict the proximity to reward correctly, and thus, unlike the behavior shown by the monkeys, is insensitive to the context introduced by the schedule length. We address this issue in detail in the remainder of this manuscript.</p>
<sec id="s2b1">
<title>The basic model</title>
<p>We assume that performance, here measured as the percentage of correct trials in each schedule state, reflects the monkey's motivation, which in turn reflects the value of that schedule state. Both rewarded and unrewarded trials acquire value: if unrewarded trials had no value, the monkeys would not perform them because there would be no motivation to do so. Thus, value acquisition must be based on a mechanism capable of learning to predict delayed rewards, like the method of temporal differences <xref ref-type="bibr" rid="pcbi.1000131-Sutton2">[27]</xref>. The values of the trials reflect any attribute that will affect motivation such as temporal discounting or intrinsic reward value, and thus will be referred to as motivational values. Performance accuracy will be guided completely by the motivational values, whereas other factors such as sensory or motor thresholds will be ignored, given that all monkeys found the color-discrimination task required in each trial (<xref ref-type="fig" rid="pcbi-1000131-g001">Figure 1A</xref>) easy to learn and perform (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>).</p>
<p>The model below establishes the functional connection between performance and motivational values, and provides a recipe for learning the values. In general terms, the model assumes that the agent, on any given state <italic>S</italic>, performs the required action correctly with a probability proportional to the value of that state, <italic>V</italic>(<italic>S</italic>), through a softmax “performance function”:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e001" xlink:type="simple"/><label>(1)</label></disp-formula></p>
<p>The parameter <italic>β</italic> controls the steepness of the performance function in the region around <italic>V</italic>(<italic>S</italic>) = 0. Thus, <italic>P</italic>(<italic>m</italic>|<italic>S</italic>) is the probability of being motivated enough to perform the action required to leave state <italic>S</italic>. Its complement, <italic>P</italic>(<italic>m̅</italic>|<italic>S</italic>), is the probability that the agent is not motivated enough to perform correctly, i.e., the model correlate of the error rate in state <italic>S</italic>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e002" xlink:type="simple"/><label>(2)</label></disp-formula></p>
<p>In the particular case of the reward schedule, Equation 1 specifies completely the “policy” followed by the agent. We shall clarify in a later section that Equation 1 is a special case of the policy we propose for general Markov Decision Processes. <italic>V</italic>(<italic>S</italic>) is updated trial-by-trial according to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e003" xlink:type="simple"/><label>(3)</label></disp-formula>where <italic>t</italic> is the trial number, <italic>V<sub>t</sub></italic><sub>+1</sub>(<italic>S<sub>t</sub></italic>) is the value of current state <italic>S<sub>t</sub></italic> at trial <italic>t</italic>+1, <italic>α</italic> is a learning rate (here a constant), and <italic>δ</italic> is the temporal difference term of TD learning:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e004" xlink:type="simple"/><label>(4)</label></disp-formula><italic>V<sub>t</sub></italic>(<italic>S<sub>t</sub></italic><sub>+1</sub>) is the <italic>current</italic> value of the state expected to follow the action taken. <italic>r<sub>t</sub></italic> is the reward delivered as a consequence of that action (<italic>r</italic> = 0 in all incorrect trials and in correct, unrewarded trials, and <italic>r</italic> = 1 in correct, rewarded trials). Parameter γ, with 0≤<italic>γ</italic>&lt;1, is a temporal discount factor that establishes the importance of the next state's value for updating the value of the current state (<xref ref-type="fig" rid="pcbi-1000131-g003">Figure 3A</xref>). When <italic>γ</italic> = 0, the value of the current state is only related to the immediate reward contingency; when <italic>γ</italic>&gt;0, <italic>all</italic> future contingencies affect the value of the current state, weighted by proximity, allowing learning to predict delayed contingencies, see, e.g., <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref>. Learning is accomplished by minimizing the difference <italic>δ<sub>t</sub></italic>. When an error is made, a negative <italic>δ</italic> follows, decreasing the value of the current state, thereby increasing the probability of making an error upon the next occurrence of that state. By performing correctly (by chance or otherwise), the algorithm reinforces the values of the schedule states, increasing the probability of correct performance in the future. At equilibrium, the average <italic>δs</italic> vanish in each schedule state, and the state-values fluctuate around their equilibrium values. So far the main difference from the more common implementations of TD learning is that these latter implementations use <italic>δ</italic> also to improve the action selection process directly, whereas here the parameters of the performance function (Equation 1) are held constant. When the TD signal <italic>δ</italic> is also used to improve the action selection process, this typically leads to the development of an optimal policy, i.e., a policy which maximizes the long-term acquisition of reward <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref>. Following Sutton <xref ref-type="bibr" rid="pcbi.1000131-Sutton2">[27]</xref>, we interpret TD learning as a general means of learning to predict delayed contingencies, and not necessarily for learning an optimal policy.</p>
<fig id="pcbi-1000131-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000131.g003</object-id><label>Figure 3</label><caption>
<title>Models.</title>
<p>(A) Diagrammatic representation of the basic model for 3- and 2-trial schedules. (B) General pattern of error rates predicted by the basic model. For trials with the same reward proximity (pre-reward number, <italic>preRN</italic>, plotted in the same color) the model predicts equal error rates. (C) Diagrammatic representation of the context-sensitive model for the 3-trial schedule. (D) General pattern of error rates predicted by the context-sensitive model. For trials with the same reward proximity (in same color) the model predicts smaller error rates in longer schedules.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.g003" xlink:type="simple"/></fig>
<p>In the reward schedule, a state is defined by the pair {<italic>τ</italic>,<italic>s</italic>}, where <italic>τ</italic> stands for current trial and <italic>s</italic> stands for current schedule length, so that Equation 4 reads<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e005" xlink:type="simple"/><label>(5)</label></disp-formula>If an error is made, <italic>τ</italic>+1 is replaced by <italic>τ</italic> because the trial is repeated. In a correct terminal trial (<italic>τ</italic> = <italic>s</italic> and <italic>r<sub>t</sub></italic>&gt;0), the next state <italic>S<sub>t</sub></italic><sub>+1</sub> is unknown, and its value is set to zero (the common choice in RL, see, e.g., <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref>). An alternative option would be to endow the model with some “post-reward expectation” and assign some positive value to the next state (for example, the mean value of the first trials). This approach scales all values by a constant factor, producing the same qualitative behavior (see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details).</p>
<p>In the validly-cued reward schedule, learning continues until the average <italic>δ</italic> vanishes in all states. In terminal trials, <italic>V</italic> = <italic>r</italic>, where <italic>r</italic> is the amount of reward received in each rewarded trial. For non-terminal trials (<italic>τ</italic>&lt;<italic>s</italic>), the equilibrium condition is <italic>V</italic>(<italic>τ</italic>,<italic>s</italic>) = <italic>γV</italic>(<italic>τ</italic>+1,<italic>s</italic>), i.e., trials more proximal to reward are more valuable, and by iteration<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e006" xlink:type="simple"/><label>(6)</label></disp-formula>Here, <italic>V</italic> depends only on the difference between <italic>s</italic> and <italic>τ</italic>, i.e., the proximity to reward. Therefore, it can be written as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e007" xlink:type="simple"/><label>(7)</label></disp-formula>where <italic>preRN</italic> = <italic>s</italic>−<italic>τ</italic> is the pre-reward number (defined to be zero in terminal trials), and <italic>V</italic>(<italic>i</italic>|<italic>s</italic>) is the value of the state having <italic>preRN</italic> = <italic>i</italic>, conditioned on schedule length being <italic>s</italic> (which, as Equation 7 shows, does <italic>not</italic> depend on <italic>s</italic>). Trials with larger <italic>preRN</italic> have smaller values (since <italic>γ</italic>&lt;1). The actual values will converge to the theoretical values given above only in the absence of errors, i.e., if the policy is to execute every trial correctly independently of its value. If the policy is given by Equation 1, then the correct values must be found by solving self-consistent equations (given in the <xref ref-type="sec" rid="s4">Materials and Methods</xref>, Equation 13). However, the results are qualitatively the same and for simplicity we shall use the values of Equation 7 in the following.</p>
<p>As Equation 7 shows, trials equally distant from reward will acquire the same value and thus produce the same error rate under any policy (<xref ref-type="fig" rid="pcbi-1000131-g003">Figure 3B</xref>). Thus, the basic model is not sensitive to the contextual effect of schedule length observed in the data, i.e., the difference in performance between penultimate trials belonging to schedules of different length. This phenomenon can be seen as a broken symmetry between trials with the same proximity to reward, which are equivalent in the basic model. In the next section we propose a different TD learning rule which is sensitive to the context produced by schedule length.</p>
</sec><sec id="s2b2">
<title>Context-sensitive model: the effect of schedule length</title>
<p>In the schedule length effect, the value of each trial is larger than predicted by proximity to reward alone. A simple speculation on how this might arise is that the value of each trial is enhanced by having completed any previous trial in the current schedule. This idea can be implemented by modifying the temporal difference rule as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e008" xlink:type="simple"/><label>(8)</label></disp-formula>In this rule, the value of the immediately preceding trial is also taken into account. The parameter <italic>σ</italic> quantifies the fraction of value carried forward to the next trial, with 0&lt;<italic>σ</italic>&lt;1. This is just the basic model when <italic>σ</italic> = 0. In first trials we set <italic>σ</italic> = 0, i.e., the value of rewarded trials is not carried forward. This seems a natural choice because the terminal states of each schedule are not part of the next sequence required to obtain reward. However, no qualitatively different behavior would result from keeping <italic>σ</italic>&gt;0 in first trials also (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). All other details are as in the basic model, including Equation 3 which remains unchanged. In this rule, a trial acquires value due to both the next trial and the previous one (<xref ref-type="fig" rid="pcbi-1000131-g003">Figure 3C</xref>). When learning has occurred (i.e., <italic>δ</italic> fluctuating around zero), the new learning rule gives <italic>V</italic>(<italic>τ</italic>,<italic>s</italic>) = <italic>r</italic>+<italic>γV</italic>(<italic>τ</italic>+1,<italic>s</italic>)+<italic>σV</italic>(<italic>τ</italic>−1,<italic>s</italic>) (compare with the value in the basic model, <italic>r</italic>+<italic>γV</italic>(<italic>τ</italic>+1,<italic>s</italic>)). This gives <italic>V</italic>(<italic>τ</italic>,<italic>s</italic>) a dependence on schedule length <italic>s</italic>, unlike Equation 7. In the absence of errors, the equilibrium values for the first three schedules are:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e009" xlink:type="simple"/><label>(9)</label></disp-formula>If errors are made according to Equation 2, a more involved set of self-consistent equations defines the values implicitly (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>), but this does not affect the qualitative pattern of behavior described next. The relation <italic>V</italic><sub>1<italic>s</italic></sub> = <italic>γV</italic><sub>2<italic>s</italic></sub>, that in the basic model holds for the values of all pairs of successive schedule states, applies here only to first trials, whereas the value of the intermediate trial <italic>V</italic><sub>23</sub> is augmented by a factor (1−<italic>γσ</italic>)<sup>−1</sup>&gt;1 due to the temporal accumulation of values of past trials. This gives <italic>V</italic><sub>23</sub>&gt;<italic>V</italic><sub>12</sub>, i.e., the value of state 2/3 is greater than that of state 1/2, as observed in the experiments. In general, the error rates will be different in trials with the same <italic>preRN</italic> but belonging to different schedules (<xref ref-type="fig" rid="pcbi-1000131-g003">Figure 3D</xref>). We refer to this model as “context-sensitive” because the motivational context due to the schedule length is an emergent property of, and not an input to, the model itself (e.g., through a redefinition of the schedule states). For <italic>σ</italic> = 0, Equation 6 of the basic model reappears.</p>
</sec><sec id="s2b3">
<title>Predictions of the models in the Random Cue condition</title>
<p>The model predicts equal values for random cues that bear no relationship to schedule state. This results in uniform error rates, with a small spread around the mean due to the stochasticity in the cue selection and the learning processes. Any TD-based model would make the same prediction, which is a consequence of a symmetry contained in the design of the task, i.e., all cues are associated with reward with the same frequency. In the absence of errors, the mean value of random cues is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e010" xlink:type="simple"/><label>(10)</label></disp-formula>where 0&lt;<italic>N</italic><sub>+</sub>&lt;1 is the fraction of rewarded trials, and is equal to the number of schedules divided by the number of schedule states (<xref ref-type="sec" rid="s4">Materials and Methods</xref>). Uniform performance is indeed observed in the data (black crosses in <xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2A and 2B</xref>). Thus, the context-sensitive model can explain all the qualitative properties of the behavior in the reward schedule task.</p>
<p>The same properties can also be captured quantitatively, as shown by the best fits of the context-sensitive model to the data (<xref ref-type="fig" rid="pcbi-1000131-g004">Figure 4A and 4B</xref>). The parameters of the model were tuned to minimize the difference between the model fits and the experimental error rates (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>), and the same parameters values were used for valid and random cues. The best-fit values of <italic>γ</italic> and <italic>σ</italic> ranged from 0.2 to 0.8 and from 0.1 to 0.8, respectively (24 monkeys), and were strongly anti-correlated (<italic>r</italic> = −0.82, <italic>r</italic><sup>2</sup> = 0.67, <italic>p</italic>&lt;10<sup>−6</sup>). The negative correlation between <italic>σ</italic> and <italic>γ</italic> is to be expected since <italic>σ</italic> is a measure of the strength of the schedule length effect, which is stronger when the maximal error rate is larger (<xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2C</xref>), and the latter is in turn inversely related to the discount rate <italic>γ</italic>. We emphasize that although we fit the model to individual experimental cases, the qualitative behavior predicted by the model is independent of the actual choice of parameters (provided that the value of <italic>σ</italic> is within the allowed range, see <xref ref-type="sec" rid="s4">Materials and Methods</xref>).</p>
<fig id="pcbi-1000131-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000131.g004</object-id><label>Figure 4</label><caption>
<title>Predictions of the context-sensitive model in the reward schedule task.</title>
<p>(A–B) Theoretical error rates predicted by the context-sensitive model (black) for both valid (circles) and random (“x”) cues. The model parameters were tuned to match the experimental error rates of <xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2A and 2B</xref> respectively using least-square minimization as described in <xref ref-type="sec" rid="s4">Materials and Methods</xref>. The experimental data from <xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2</xref> are reproduced in grey for comparison. Parameters for Monkey A (B): <italic>β</italic> = 3.6 (3.2), <italic>σ</italic> = 0.3 (0.8), <italic>γ</italic> = 0.4 (0.3). (C) Error rate (Equation 2) as a function of schedule state values (full curve) for the model of panel <italic>B</italic>. Black dots are the actual values of valid cues in the standard model (i.e., with <italic>σ</italic> = 0; see Equation 6); larger dots are the mean values of valid (black) and random (grey) cues. The inset shows the predicted mean values of valid (black) and random (grey) cues for paradigms with 2 to 10 schedules (basic model). Larger dots correspond to the case of main figure (4 schedules). (D) Linear regression of the median error rates with valid cues against the median error rates with random cues for the 13 monkeys tested in both conditions (<italic>r</italic><sup>2</sup> = 0.69, <italic>p</italic>&lt;0.0005).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.g004" xlink:type="simple"/></fig></sec><sec id="s2b4">
<title>Predictions of the context-sensitive model in the reward schedule task</title>
<p>Both the basic and context-sensitive models predict that valid and random cues have roughly the same average value, as shown in <xref ref-type="fig" rid="pcbi-1000131-g004">Figure 4C</xref>, which depicts the error rate as a function of the values of schedule states (Equation 2). The larger dots represent the mean values of valid (black) and random (grey) cues respectively, which are generally close to each other. In the inset of <xref ref-type="fig" rid="pcbi-1000131-g004">Figure 4C</xref> this is shown for 2 to 10 schedules. The mean values decrease with the number of schedules, since the average fraction of rewarded trials also decreases with the number of schedules. The prediction that valid and random cues have approximately the same average value does not have a direct experimental correlate, since one only has access to the error rates. Intuitively, however, the correlation between the mean values of valid and random cues should be reflected in the correlation between the median error rates in the two paradigms. This correlation was present in the data (<xref ref-type="fig" rid="pcbi-1000131-g004">Figure 4D</xref>, <italic>r</italic><sup>2</sup> = 0.69, <italic>p</italic>&lt;0.0005).</p>
<p><xref ref-type="fig" rid="pcbi-1000131-g004">Figure 4C</xref> suggests that the overall level of motivation (as measured by the average values) is approximately the same with either valid or random cues. The non-linearity of the performance function explains why the overall performance is better in the Random Cue condition than in the Valid Cue condition. The values of valid cues (black dots in <xref ref-type="fig" rid="pcbi-1000131-g004">Figure 4C</xref>) spread around their mean (larger black dot), producing distributed error rates which depend on schedule state, whereas random cues' values have a limited spread (not shown) around their mean (grey dot) due only to random fluctuations, producing indistinguishable error rates. As shown in <xref ref-type="fig" rid="pcbi-1000131-g004">Figure 4C</xref>, the complement of the performance function (Equation 2) tends to flatten towards larger values more than for smaller ones. As a consequence, performance with random cues is much closer to the performance in validly cued rewarded, rather than unrewarded, trials (as, e.g., in <xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2A and 2B</xref>).</p>
</sec><sec id="s2b5">
<title>Predictions of the context-sensitive model in choice tasks</title>
<p>To be a valid generalization of TD learning, the context-sensitive model must predict the same qualitative behavior is situations where animal behavior is well described by the standard model. We show here that this is generally true in situations involving behavioral choices. In particular, this means that the context-sensitive model does not predict a suboptimal behavior in tasks where this is not observed.</p>
<p>A simple choice task entails the offer of two alternative options, say <italic>A</italic> and <italic>B</italic>, to an agent which has the freedom to choose between the two and will get rewarded accordingly. In the deterministic version of this task, one option is always rewarded, the other is never rewarded; in the probabilistic version, one of the options is rewarded more often than the other, and neither of them is rewarded with certainty; or both options are rewarded with equal probability but in different amounts; and so on (<xref ref-type="fig" rid="pcbi-1000131-g005">Figure 5A</xref>). A standard reinforcement model would predict a preference (as measured by choice ratio) for the more rewarded option in all cases, and will learn to choose always the rewarded option in the deterministic choice task. The context-sensitive model predicts exactly the same behavior (<xref ref-type="fig" rid="pcbi-1000131-g005">Figure 5B</xref>). This is most easily explained in the fully deterministic case where option <italic>A</italic> gives always a reward <italic>r</italic> whereas option <italic>B</italic> gives no reward (i.e., <italic>P</italic><sub>rew(<italic>A</italic>)</sub> = 1 in <xref ref-type="fig" rid="pcbi-1000131-g005">Figure 5B</xref>). In this case, for <italic>σ</italic> = 0 the values of the two options approximate the amount of reward obtained, i.e., <italic>V<sub>A</sub></italic> = <italic>r</italic> and <italic>V<sub>B</sub></italic> = 0. When 0&lt;<italic>σ</italic>&lt;1, the value of each option is increased on average by the same amount, i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e011" xlink:type="simple"/></inline-formula>, where <italic>P</italic><sub>sel(<italic>A</italic>)</sub> is the observed frequency of selecting <italic>A</italic>. Under the standard assumption that the action with larger value is selected more often, such preference will not be reversed in the context-sensitive model. For example, under a softmax model for <italic>P</italic><sub>sel(<italic>A</italic>)</sub>, e.g., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e012" xlink:type="simple"/></inline-formula>, the probability of selecting <italic>A</italic> depends only on the difference <italic>V<sub>A</sub></italic>−<italic>V<sub>B</sub></italic>, which is left unchanged. Similar results are found for the probabilistic version of the task, where the best option is rewarded with probability <italic>P</italic><sub>rew(<italic>A</italic>)</sub>&gt;0.5 and the other with probability 1−<italic>P</italic><sub>rew(<italic>A</italic>)</sub> (<xref ref-type="fig" rid="pcbi-1000131-g005">Figure 5B</xref>). The two models give the same results also under a “greedy” policy, which by definition selects always the action with larger value (this can be obtained from the softmax function by letting <italic>β</italic>→∞). These conclusions hold also for variations of this two-choice task where the probability that one choice is the better option increases with the number of consecutive selections of the alternative choice, typically resulting in matching behavior (see, e.g., <xref ref-type="bibr" rid="pcbi.1000131-Lau1">[28]</xref>; not shown).</p>
<fig id="pcbi-1000131-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000131.g005</object-id><label>Figure 5</label><caption>
<title>Predictions of the context-sensitive model in choice tasks.</title>
<p>(A) Two-choice task. At decision node <italic>N</italic> (of value <italic>V<sub>N</sub></italic>) the agent can either choose action <italic>A</italic> (which gives a larger or more probable reward) or action <italic>B</italic> (smaller or less probable reward). The same value <italic>σV<sub>N</sub></italic> is carried over to whatever outcome of the choice (curved arrows). (B) Mean frequency of choosing action <italic>A</italic> in the two-choice task of panel <italic>5A</italic> (<italic>P</italic><sub>sel(<italic>A</italic>)</sub>) vs. the probability that action <italic>A</italic> is rewarded (<italic>P</italic><sub>rew(<italic>A</italic>)</sub>) for different values of <italic>σ</italic> (see the text). For each value of <italic>P</italic><sub>rew</sub>(<italic>A</italic>), four values of <italic>σ</italic> were used (0. 0.1, 0.2, and 0.3). Shown are means (dots) and standard deviations (error bars) over 20 simulations with <italic>β</italic> = 3 and <italic>r</italic> = 1 together with the theoretical prediction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e013" xlink:type="simple"/></inline-formula> (dashed line). For <italic>σ</italic> = 0, the model is the standard TD model. Choice preference does not depend on the value of <italic>σ</italic>. (C) 4-armed bandit task. At decision node <italic>N</italic> the agent can choose between 4 possible actions, each rewarding the agent according to a predefined probability distribution. The same value <italic>σV<sub>N</sub></italic> is carried over to whatever outcome of the choice. (D) Mean frequency of choosing each of the four alternative actions of the 4-armed bandit task of panel <italic>5C</italic> for different values of <italic>σ</italic> (same values as in panel <italic>5B</italic>). Each choice was rewarded according to a Gaussian distribution truncated at negative values, with mean <italic>μ</italic> = 0.25, 0.5, 0.75, 1 and standard deviation 0.25. Shown are means (dots) and standard deviations (error bars) over 20 simulations with <italic>β</italic> = 3, together with the theoretical prediction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e014" xlink:type="simple"/></inline-formula> (dashed line). Choice frequencies do not depend on the value of <italic>σ</italic>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.g005" xlink:type="simple"/></fig>
<p>The argument can be generalized to an <italic>n</italic>-choice task (<xref ref-type="fig" rid="pcbi-1000131-g005">Figure 5C</xref>), where each choice gives a reward drawn from a given distribution (sometimes called the <italic>n</italic>-armed bandit task in the RL literature, see, e.g., <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref>). Also in this case, all values are increased by the same amount <italic>c</italic> in the context-sensitive model, and the softmax function,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e015" xlink:type="simple"/><label>(11)</label></disp-formula>is invariant under the scaling <italic>V<sub>j</sub></italic>→<italic>V<sub>j</sub></italic>+<italic>c</italic>. As a consequence, the frequency of each choice does not depend on the value of <italic>σ</italic> (<xref ref-type="fig" rid="pcbi-1000131-g005">Figure 5D</xref>).</p>
<p>The reason for which a positive <italic>σ</italic> will not make a difference in a choice task is that at each decision node the same value (<italic>σV<sub>N</sub></italic> in <xref ref-type="fig" rid="pcbi-1000131-g005">Figure 5A and 5C</xref>) will be carried over to whatever the outcome of the choice. For <italic>σ</italic>&gt;0 to have an effect on the choice, the choice must be followed by a sequence of states or actions, with different amounts of previous value carried over in different sequences. To illustrate this point, consider a combination of a choice task and a reward schedule task which we shall name “two-choice schedule task” (<xref ref-type="fig" rid="pcbi-1000131-g006">Figure 6A</xref>). Assume that an agent can choose whether to receive a reward <italic>R</italic> now and a smaller reward <italic>r</italic> later on ({<italic>R</italic>,<italic>r</italic>}, schedule <italic>A</italic>), or the smaller reward now and the larger one later on ({<italic>r</italic>,<italic>R</italic>}, schedule <italic>B</italic>). This task is more complex than the simple choice task, because here the initial action or choice affects the return obtainable from subsequent ones. A standard TD model predicts a preference for schedule <italic>A</italic>, since this model discounts later rewards, penalizing reward <italic>R</italic> in schedule <italic>B</italic> more than in schedule <italic>A</italic>. Numerically, <italic>V</italic><sub>sch.<italic>A</italic></sub>−<italic>V</italic><sub>sch.<italic>B</italic></sub> = (1−<italic>γ</italic>)(<italic>R</italic>−<italic>r</italic>)&gt;0, and the “immediate-reward” schedule <italic>A</italic> is chosen more often than the “delayed-reward” schedule <italic>B</italic>. This is modified into <italic>V<sub>σ</sub></italic><sub>;sch.<italic>A</italic></sub>−<italic>V<sub>σ</sub></italic><sub>;sch.<italic>B</italic></sub> = (1−<italic>γσ</italic>)<sup>−1</sup>(1−<italic>γ</italic>)(<italic>R</italic>−<italic>r</italic>)&gt;<italic>V</italic><sub>sch.<italic>A</italic></sub>−<italic>V</italic><sub>sch.<italic>B</italic></sub> in the context-dependent model. The difference between the values of the two schedules not only keeps its sign, but is increased in magnitude. This is because in the immediate-reward schedule <italic>A</italic>, a larger value is carried over to the next trial compared to the delayed-reward schedule. Thus, the context-sensitive model amplifies the existing preference for the immediate-reward schedule (<xref ref-type="fig" rid="pcbi-1000131-g006">Figure 6B</xref>). However, no new qualitative behavior emerges.</p>
<fig id="pcbi-1000131-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000131.g006</object-id><label>Figure 6</label><caption>
<title>Predictions of the context-sensitive model in choice-schedule tasks.</title>
<p>(A) Description of the choice-schedule task with 2-trial schedules. At decision node <italic>N</italic> (of value <italic>V<sub>N</sub></italic>) the agent can either choose the immediate-reward schedule <italic>A</italic> (which gives a larger reward, <italic>R</italic>, sooner and a smaller reward, <italic>r</italic>, later) or the delayed-reward schedule <italic>B</italic> (smaller reward sooner and larger reward later). The same value <italic>σV<sub>N</sub></italic> is carried over to whatever outcome of the choice, but following trials in each schedule modify the value of <italic>A</italic> or <italic>B</italic> differently (curved grey arrows, shown for schedule <italic>A</italic> only. See the text for details). (B) Mean frequency of choosing the immediate-reward schedule (schedule <italic>A</italic>) in the task of panel <italic>6A</italic> predicted by the model as a function of <italic>σ</italic>. Shown are means (dots) and standard deviations (error bars) over 20 simulations with <italic>β</italic> = 3, <italic>γ</italic> = 0.55, <italic>R</italic> = 1 and <italic>r</italic> = 0.5. Dashed line: theoretical prediction according to the equation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e016" xlink:type="simple"/></inline-formula> with <italic>V</italic><sub>sch.<italic>A</italic></sub>−<italic>V</italic><sub>sch.<italic>B</italic></sub> = (1−<italic>γσ</italic>)<sup>−1</sup>(1−γ)(<italic>R</italic>−<italic>r</italic>). A positive value of <italic>σ</italic> enhances the existing preference for the immediate-reward schedule. (C) Choice-schedule task between two 3-trial schedules, a generalization of the task in panel <italic>6A</italic>. (D) mean frequency of choosing the immediate-reward schedule (schedule <italic>A</italic>) in the task of panel <italic>6C</italic> predicted by the model as a function of <italic>σ</italic>. Shown are means (dots) and standard deviations (error bars) over 20 simulations with the same parameters as in <italic>6B</italic>. Dashed line: theoretical prediction according to the equation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e017" xlink:type="simple"/></inline-formula> with <italic>V</italic><sub>sch.<italic>A</italic></sub>−<italic>V</italic><sub>sch.<italic>B</italic></sub> = (1−2<italic>γσ</italic>)<sup>−1</sup>(1−<italic>γ</italic>−<italic>γ</italic><sup>2</sup>−<italic>γσ</italic>)(<italic>R</italic>−<italic>r</italic>). Dotted line: indifference point <italic>P</italic><sub>sel</sub>(sch.<italic>A</italic>) = 0.5, i.e., the situation where the agent has no preference for either schedule. For <italic>σ</italic> larger than ≈0.268, choice preference is reversed and the delayed-reward schedule is chosen more often.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.g006" xlink:type="simple"/></fig>
<p>These conclusions hold for any choice schedule with two schedule states (i.e., with any choice of rewards and parameters values). In this more general case, parameters can be chosen so that a preference for either schedule could emerge; however, a positive value of <italic>σ</italic> can only amplify the existing preference (not shown).</p>
<p>A positive <italic>σ</italic> can alter an existing preference if the schedules comprise more than two trials. Consider for example the case where upon selection of schedule <italic>A</italic> the agent receives reward <italic>R</italic> at the first step and then a smaller reward <italic>r</italic> at the next two steps, i.e., a schedule of type {<italic>R</italic>,<italic>r</italic>,<italic>r</italic>}; whereas schedule <italic>B</italic> gives the smaller reward first, followed by the larger reward in the next two steps: {<italic>r</italic>,<italic>R</italic>,<italic>R</italic>} (<xref ref-type="fig" rid="pcbi-1000131-g006">Figure 6C</xref>). Since in this case <italic>V</italic><sub>sch.<italic>A</italic></sub>−<italic>V</italic><sub>sch.<italic>B</italic></sub> = (1−<italic>γ</italic>−<italic>γ</italic><sup>2</sup>)(<italic>R</italic>−<italic>r</italic>), the immediate-reward schedule (schedule <italic>A</italic>) will be preferred only if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e018" xlink:type="simple"/></inline-formula>. Depending on the value of the discount factor <italic>γ</italic>, both schedules may be preferred in this task under standard TD learning. For <italic>γ</italic> just above its critical value <italic>γ</italic>ˆ, a positive value of <italic>σ</italic> can only increase the agent's preference for the delayed-reward schedule <italic>B</italic>; but for <italic>γ</italic> just below its critical value <italic>γ</italic>ˆ, a positive value of <italic>σ</italic> can bias preference away from the immediate-reward schedule <italic>A</italic> and towards the delayed-reward schedule <italic>B</italic>. This is shown in <xref ref-type="fig" rid="pcbi-1000131-g006">Figure 6D</xref>, where <italic>γ</italic> = 0.55, <italic>R</italic> = 1, and <italic>r</italic> = 0.5. With these parameters, a reversal in preference occurs at <italic>σ</italic>≈0.268. It can be shown that for any choice schedule task with three states, a preference for the delayed-reward schedule will always be amplified by a positive <italic>σ</italic>, whereas a preference for the immediate-reward schedule could be reversed if some conditions are met. However, either schedule could be favored in the standard model also, depending on the value of the discount factor <italic>γ</italic>. In a choice task between two <italic>n</italic>-trial schedules, of type {<italic>R</italic>,<italic>r</italic>,<italic>r</italic>,…,<italic>r</italic>} and {<italic>r</italic>,<italic>R</italic>,<italic>R</italic>,…,<italic>R</italic>}, respectively, the critical value of <italic>γ</italic> is given by the real solution of 1−<italic>γ</italic>−<italic>γ</italic><sup>2</sup>−…−<italic>γ<sup>n</sup></italic><sup>−1</sup> = 0. This value decreases with <italic>n</italic> and approaches 0.5 when <italic>n</italic> tends to infinite (practically, for <italic>n</italic>&gt;10). Since preference for one schedule or the other can be obtained in the standard model by adjusting the value of <italic>γ</italic>, there is no new qualitative behavior emerging from the context-sensitive model in this task. We conclude that in simple choice tasks and in choice-schedule tasks the context-sensitive model predicts the same qualitative behavior as the standard TD model.</p>
</sec><sec id="s2b6">
<title>General model for Markov Decision Processes (MDPs)</title>
<p>Reinforcement schedules and choice tasks are examples of MDPs. Formally, a MDP is a collection of states, each with an associated cost or reward, and a set of transition probabilities that govern the transitions between those states. We shall indicate with <italic>P<sub>ij</sub></italic> the probability to move to state <italic>j</italic> from state <italic>i</italic> (<xref ref-type="fig" rid="pcbi-1000131-g007">Figure 7A</xref>). The numbers <italic>P<sub>ij</sub></italic> must satisfy a number of properties, among which: (a) the transition from <italic>i</italic> to <italic>j</italic> must depend on current state <italic>i</italic> but not on any state previously visited (the Markov property), and (b) starting from <italic>i</italic>, a transition to some other state must occur, i.e., ∑<italic><sub>j</sub> P<sub>ij</sub></italic> = 1 (see, e.g., <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref> for an introductory exposition of the theory of MDPs). A MDP is a very general framework and is widely used as an abstract setting for RL problems <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref>, where the transition probability rule <italic>P<sub>ij</sub></italic> is called a “policy.” However, this framework does not consider the effort due to an instrumental action required to leave the current state, which could induce some motivational reluctance to the subject, as shown in the reward schedule. This is also true in choice tasks, where even in the case of excellent performance, the percentage of correct trials is typically less than 100%. In defining a policy for the reward schedule (Equation 1) we have, in effect, introduced an example of what we shall call “instrumental MDP,” i.e., a MDP where each transition is conditioned on an instrumental action being performed correctly, otherwise an error results and no transition is possible, represented by a self-link to the current state in <xref ref-type="fig" rid="pcbi-1000131-g007">Figure 7A</xref>. We show in this section that a general policy can be introduced for an instrumental MDP, of which the policy Equation 1 for the reward schedule task, and the softmax function Equation 11 used in the choice tasks of <xref ref-type="fig" rid="pcbi-1000131-g005">Figures 5</xref> and <xref ref-type="fig" rid="pcbi-1000131-g006">6</xref> are special cases.</p>
<fig id="pcbi-1000131-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000131.g007</object-id><label>Figure 7</label><caption>
<title>Model for the general Markov Decision Process (MDP).</title>
<p>(A) Policy for the general MDP. In the fragment of MDP shown, the agent is in state <italic>i</italic> and must decide (1) whether to leave the state (with probability <italic>P</italic>(<italic>m</italic>|<italic>i</italic>)), and (2) in which state to go in case of a positive decision (weighting each choice with probability P(<italic>i</italic>→<italic>j</italic>|<italic>m</italic>)). Decision 1 depends on the motivational value of current state; decision 2 depends on the relative values of the possible arrival states, or choices. Both the motivational and the choice values are learned with the TD method of the main text. If the agent is not motivated to perform the trial, it will find itself in the same state one time step later (curved arrow). If the agent is sufficiently motivated to perform the trial correctly, it proceeds to make a choice. In the figure, this situation is represented by the curved shaded region from which the arrows to the possible choices reach out. In the general case, the transition probability <italic>P<sub>ij</sub></italic> is the product of the probabilities <italic>P</italic>(<italic>m</italic>|<italic>i</italic>) and <italic>P</italic>(<italic>i</italic>→<italic>j</italic>|<italic>m</italic>). (B) Policy in the reward schedule task. In this case, <italic>P</italic>(<italic>i</italic>→<italic>j</italic>|<italic>m</italic>) because there is no choice and <italic>j</italic> can only be the next schedule state (in this example, <italic>i</italic> = 1/2, <italic>j</italic> = 2/2). Thus, <italic>P<sub>ij</sub></italic> = <italic>P</italic>(<italic>m</italic>|<italic>i</italic>). (C) Policy in the choice task when considering only correct trials. In this case, <italic>P</italic>(<italic>m</italic>|<italic>i</italic>) is determined to be 1 and thus <italic>P<sub>ij</sub></italic> = (<italic>i</italic>→<italic>j</italic>|<italic>m</italic>).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.g007" xlink:type="simple"/></fig>
<p>In the more general case of an instrumental MDP, we shall define the policy, i.e. the probability of making a transition from <italic>i</italic> to <italic>j</italic>, as the product of the probability <italic>P</italic>(<italic>m</italic>|<italic>i</italic>) of leaving the current state <italic>i</italic> (by performing correctly), times the probability <italic>P</italic>(<italic>i</italic>→<italic>j</italic>|<italic>m</italic>) of transitioning to state <italic>j</italic>, given that the agent is motivated to do so:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e019" xlink:type="simple"/><label>(12)</label></disp-formula> (<xref ref-type="fig" rid="pcbi-1000131-g007">Figure 7A</xref>). In the reward schedule, <italic>P</italic>(<italic>i</italic>→<italic>j</italic>|<italic>m</italic>) equals 1 if <italic>j</italic> is the next state in the schedule, otherwise it equals zero, hence the policy reduces to <italic>P<sub>ij</sub></italic> = <italic>P</italic>(<italic>m</italic>|<italic>i</italic>) (<xref ref-type="fig" rid="pcbi-1000131-g007">Figure 7B</xref>). In a choice task, the full policy Equation 12 should be used, which takes in account also the fraction of incorrectly performed trials. However, choice behavior is typically analyzed on correct trials only (as we have done in the previous section), since these are the trials where an actual choice occurs. On the subset of correct trials, <italic>P</italic>(<italic>m</italic>|<italic>i</italic>) is determined to be 1, and the policy reduces to <italic>P<sub>ij</sub></italic>(<italic>i</italic>→<italic>j</italic>|<italic>m</italic>) (<xref ref-type="fig" rid="pcbi-1000131-g007">Figure 7C</xref>). This explains our use of different policies for reinforcement schedules and choice tasks, respectively.</p>
<p>Regarding the specific choice of policies we have adopted, note that <italic>P</italic>(<italic>i</italic>→<italic>j</italic>|<italic>m</italic>) need not be a softmax function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e020" xlink:type="simple"/></inline-formula> as in <xref ref-type="fig" rid="pcbi-1000131-g005">Figures 5</xref> and <xref ref-type="fig" rid="pcbi-1000131-g006">6</xref>, but could be any other suitable policy (e.g., a greedy or an ε-greedy policy, see <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref> for details). As for <italic>P</italic>(<italic>m</italic>|<italic>i</italic>), the reward schedule data presented in this manuscript imply that <italic>P</italic>(<italic>m</italic>|<italic>i</italic>) cannot be taken to be the choice type, i.e., of the same type as <italic>P</italic>(<italic>i</italic>→<italic>j</italic>|<italic>m</italic>), regardless of the actual functional form used for it. This point can be illustrated with the following simple argument. Since error trials must be repeated, one might be tempted to frame the motivational process of performing the trial as a choice between proceeding to the next state in the schedule, say <italic>j</italic>, or remaining in the current state <italic>i</italic>: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e021" xlink:type="simple"/></inline-formula>. However, in the task with random cues this policy would give a 50% error rate, which is never observed. The motivation to perform at all, therefore, cannot be framed as a decision process of the choice type. In mathematical terms, <italic>P</italic>(<italic>m</italic>|<italic>i</italic>) can only depend on the current state and be an increasing function of its value. A softmax function, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e022" xlink:type="simple"/></inline-formula>, where the parameter <italic>x</italic>&gt;0 may be required for proper normalization, is a natural choice <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Daw1">[29]</xref>. We have provided additional evidence for this choice because of its ability to explain detailed aspects of the behavior (<xref ref-type="fig" rid="pcbi-1000131-g004">Figure 4</xref>). The actual value of <italic>x</italic> is immaterial and could be tuned to maximize the agreement with the data in each dataset. However, we found one free parameter (<italic>β</italic>) to be sufficient, and we set <italic>x</italic> = 1 in Equation 1: this reduces the number of degrees of freedom and thus offers the most parsimonious account of the data. The same principle would demand <italic>β</italic> to be the same in both Equation 1 and in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e023" xlink:type="simple"/></inline-formula>, although it need not be.</p>
<p>Regarding the general policy Equation 12, note that ∑<italic><sub>j</sub> P<sub>ij</sub></italic>≤1, since <italic>P</italic>(<italic>m</italic>|<italic>i</italic>)≤1: the sum over <italic>j</italic> now represents the percentage of correct trials. Also, note that <italic>j</italic> can also be state <italic>i</italic>, if the agent is given the choice of remaining in the current state as a result of executing the corresponding action correctly. In such a case, the probability of remaining in state <italic>i</italic> is formally the product of the probability of leaving the state times the probability of choosing to return to it. This possibility is relevant if, for example, error trials need not be repeated. Thus, remaining in the current state can be the consequence of a choice (with probability <italic>P</italic>(<italic>i</italic>→<italic>i</italic>|<italic>m</italic>)·<italic>P</italic>(<italic>m</italic>|<italic>i</italic>)), or the consequence of an error (with probability <italic>P</italic>(<italic>m̅</italic>|<italic>i</italic>)), if error trials must be repeated. These two possibilities need to be kept conceptually distinct. If, after an error, the agent is positioned in a different state, the self-link in <xref ref-type="fig" rid="pcbi-1000131-g007">Figure 7A and B</xref> is replaced by a link to the corresponding state (with transition probability <italic>P</italic>(<italic>m̅</italic>|<italic>i</italic>)). In general, <italic>P</italic>(<italic>i</italic>→<italic>i</italic>|<italic>m</italic>) and <italic>P</italic>(<italic>m</italic>|<italic>i</italic>) depend on the same value <italic>V<sub>i</sub></italic>, but in different ways. All values are learned with the same learning rule, which might be the standard TD method, or its generalization introduced here to account for the schedule length effect. If the latter method is used together with the full policy Equation 12, a schedule length effect for the error rates will emerge also in the choice-schedule tasks of <xref ref-type="fig" rid="pcbi-1000131-g006">Figure 6</xref> (not shown).</p>
<p>Finally, this framework can be generalized to the case of transitions in continuous time. So far, transitions (including errors) could only happen at discrete time steps indexed by trial number, an adequate simplification for the purpose of this study. Formally, this means that <italic>P<sub>ij</sub></italic> = <italic>P<sub>ij</sub></italic>(<italic>τ</italic>), where <italic>τ</italic> is the trial number. However, one could define an arbitrary time unit <italic>t</italic>, much smaller than <italic>τ</italic>, so that each trial (or any event of duration longer than <italic>t</italic>) can unfold in time, like in the “serial compound representation” implementations of RL models (see, e.g., <xref ref-type="bibr" rid="pcbi.1000131-Schultz1">[30]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Montague1">[31]</xref>). Each transition would thus occur at a variable time, <italic>P<sub>ij</sub></italic>(<italic>t</italic>) = <italic>P</italic>(<italic>i</italic>→<italic>j</italic>|<italic>m</italic>)·<italic>P</italic>(<italic>m</italic>|<italic>i</italic>;<italic>t</italic>), depending on <italic>P</italic>(<italic>m</italic>|<italic>i</italic>;<italic>t</italic>). In this scenario, at each time step <italic>t</italic> the agent “decides” to make a transition depending on <italic>P</italic>(<italic>m</italic>|<italic>i</italic>;<italic>t</italic>), and when it does, the final state of the transition is regulated by <italic>P</italic>(<italic>i</italic>→<italic>j</italic>|<italic>m</italic>), which may also depend on time, if the nature of the decision problem requires it. An error trial could be defined accordingly. For example, in the reward schedule, where reaction times are of the order of 300–600 ms, <italic>t</italic> could be chosen to be, e.g., 20 ms and the requirement of performing a correct trial would translate into a transition occurring between <italic>t</italic><sub>GO</sub>+10<italic>t</italic> and <italic>t</italic><sub>GO</sub>+50<italic>t</italic>, where <italic>t</italic><sub>GO</sub> marks the time onset of the GO signal. A lack of transition within this window is counted as an error: the agent is held in a “null” state for the duration of the inter-trial interval, during which no transitions are allowed, and then repositioned into the previous state at the beginning of the next trial. This implementation also allows the introduction of reaction time as the time elapsed since <italic>t</italic><sub>GO</sub> and when a transition occurs. It is predicted that the larger the motivational value, the faster the reaction time, and the smaller the number of errors, as observed in the experiments <xref ref-type="bibr" rid="pcbi.1000131-Bowman1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1000131-Liu1">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1000131-SugaseMiyamoto1">[25]</xref>.</p>
</sec></sec></sec><sec id="s3">
<title>Discussion</title>
<p>In reward schedule tasks, monkeys make substantially more errors in validly cued unrewarded trials than in rewarded trials. The number of errors decreases with reward proximity. Also, the error rates are typically smaller in trials equally distant from reward, but belonging to longer schedules (schedule length effect; <xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2</xref>). Both of these features disappear and monkeys make fewer errors in the absence of valid cues.</p>
<p>The monkeys do not maximize the amount of reward over the smallest number of trials, violating a principle requiring maximization of reward over time, and also violate the principle of invariance in trials equally far from reward, especially penultimate trials (<xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2</xref>). This behavioral pattern occurs in most monkeys, thus it is robust and reliable. It only occurs after the meanings of the cues are learned, and persists over long periods (months or years despite constant practice in the task). Therefore, it should not be construed as maladaptive simply because it violates the principles of reward-maximization and invariance. Since the monkeys were allowed to work until they stopped by themselves, it can be inferred that they would get a sufficient amount of liquid reward, and were simply not interested in maximizing the amount over time.</p>
<p>We have argued that the monkeys' behavior is a direct consequence of learning the motivational values attached to each trial by using the cues. Either randomizing the cues or damaging the rhinal cortex prevents the formation of this typical error rates pattern <xref ref-type="bibr" rid="pcbi.1000131-Liu2">[26]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Liu3">[32]</xref>, and damaging orbitofrontal cortex blunts it <xref ref-type="bibr" rid="pcbi.1000131-Simmons1">[33]</xref>. In the model introduced here, the motivational values of the schedule states arise through trial-and-error learning and lead to suboptimal behavior. In its basic form, i.e., with <italic>σ</italic> = 0, this model can be described as TD-learning for solving the value prediction problem <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Sutton2">[27]</xref>. The standard RL approach is usually concerned with the development of behavioral strategies that adapt towards optimality, and less often with the simpler value prediction problem, i.e., the problem of learning to predict the long term return obtainable starting from each behavioral state and following a given policy. Our interpretation of the RL method used in this work follows this thread, because the policy (the performance function Equation 1) is fixed and is not modified by the learning algorithm (of course its arguments, the values, are). This has been called “learning with an indirect actor” by Dayan and Abbott <xref ref-type="bibr" rid="pcbi.1000131-Dayan4">[34]</xref>. The particular policy used for the reward schedule departs from previous accounts because it depends on the value of the current state only. This is one of two core departures of our model from existing ones (e.g., <xref ref-type="bibr" rid="pcbi.1000131-Egelman1">[35]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-McClure1">[36]</xref>). The second is the modification of the learning rule so as to capture the schedule length effect.</p>
<sec id="s3a">
<title>Properties and Predictions of the Model in the Reward Schedule Task</title>
<p>In our model, a single algorithm explains the differential behavior with valid and random cues. Assuming that the average value of the schedule states is a measure of overall motivation, the model predicts that the overall motivation is similar in the valid and random cue conditions. The difference in performance in the two paradigms is a consequence of the non-linear (sigmoidal) shape of the performance function Equation 1 (cf. <xref ref-type="fig" rid="pcbi-1000131-g004">Figure 4C</xref>). The finding that the same overall level of motivation leads to different patterns of error rates with valid and random cues is not built into the model but is an emergent property of the learning process.</p>
<p>The context-sensitive model also predicts that, although the behavior appears to be the same in all terminal trials, terminal trials may acquire different values (see, e.g., Equation 9). This difference is not reflected in the behavior since the latter depends on both the values (which might be different) and the performance function (Equation 1), which tends to remove value differences in the high value region (<xref ref-type="fig" rid="pcbi-1000131-g004">Figure 4C</xref>). In this region the performance function (or its complement) is almost flat and slight differences in value will be unlikely to produce observable differences in error rate.</p>
<p>The context-sensitive behavior is also an emergent property of the model. The model does not change the definition of the schedule states to accommodate their contextual meaning. Valid cues come to “label” the schedule states via predictive learning. The basic model translates these labels into a pattern of motivational values and error rates which only depend on reward proximity, and thus are the same in penultimate trials. This symmetry is broken in the context-sensitive model as a consequence of generalizing the temporal difference so as to look backwards as well as forward, and not through a redefinition of the schedule states.</p>
<p>It might seem at first that the model does not take into account the cost of performing a trial, i.e., the cost of releasing the bar at the GO signal. In fact, this cost could be interpreted as the origin of the residual, non-zero error rate given by the performance function (Equation 1) when the values are maximal (approximately, the error rate in validly-cued rewarded trials). It is also possible to implement this cost so as to affect the values of each state, <italic>V</italic>(<italic>S</italic>)→<italic>V</italic>(<italic>S</italic>)−<italic>c</italic>, where <italic>c</italic> stands for cost. However, since the cost of the action is the same for all trials, it could not account for the differential error rates in different schedule states.</p>
</sec><sec id="s3b">
<title>Inadequacy and Generalization of Standard TD Learning</title>
<p>Our analysis unveils the inadequacy of standard TD learning for the reward schedule task. The general statement can be proved that it is not possible to capture the schedule length effect with RL methods inspired to TD learning, including TD(<italic>λ</italic>) <xref ref-type="bibr" rid="pcbi.1000131-Sutton2">[27]</xref>, if these only take into account the values of trials remaining in the current schedule (cfr. Equation 4; see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details). Thus, for a method based on temporal differences to capture the schedule length effect, its learning prescription must have access either to the value of a past trial in the current schedule, as proposed in this manuscript, or to the value of a trial belonging to a different schedule, a method that is not clear how to generalize beyond the reward schedule task.</p>
<p>The predictions of the context-sensitive model are the same as standard TD learning in a wide class of other tasks involving choice, where the values of states at decision nodes apply equally to whatever outcome of the decision. In simple choice tasks (cf. <xref ref-type="fig" rid="pcbi-1000131-g005">Figure. 5</xref>), both models predict a preference for more probable rewards, either always—under a greedy policy—or with occasional, temporary reversals of preference when the policy allows exploratory behavior—like the softmax function Equation 11. In the choice-schedule task of <xref ref-type="fig" rid="pcbi-1000131-g006">Figure 6A</xref>, the context-sensitive model predicts the same preference as the standard model. With schedules comprising more than two trials, choice preference of one model can be mapped into the choice preference of the other by readjusting the value of the discount rate <italic>γ</italic> appropriately. Thus the context-sensitive model, although heuristic in its derivation, appears to be a generalization of standard TD learning: it predicts the same behavior in tasks where human and animal subjects tprefer the choice leading to more probable or larger rewards; but it also predicts the violation of the principle of invariance occurring in the reward schedule task, not captured by the standard model; and it predicts the “procrastination-like” behavior of monkeys in the same task. The latter is to be generally expected in tasks requiring a step-wise approach to reward, where the willingness to act in each single trial exerts a powerful influence on the behavior. More work is required to characterize fully the mathematical properties of the model, and explore its possible derivation from well-defined principles as is customary in the fields of Machine Learning and RL, which is beyond the scope of this work.</p>
</sec><sec id="s3c">
<title>Extension to General Markov Decision Processes</title>
<p>The reward schedule and choice tasks represent two particular cases of general MDPs where the problem of making a decision can be factorized into two sub-problems, the motivation to perform at all, and the selection of one among alternative choices given the motivation to act. We have used the strategy of dividing this general problem into two parts: we have analyzed the behavior as driven by motivational value using the reward schedule task, and the behavior as driven by choice preference using choice tasks. In both cases, we have compared the standard and the novel TD model using the same policy for both. These two components are simply multiplied in general MDPs, where by definition both the motivation to act and choice selection can occur.</p>
<p>Our results indicate that only in the choice selection problem does the actor-critic architecture of RL <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Joel1">[37]</xref> potentially have a significant role. In the actor-critic architecture, the RL problem is solved by two related “structures,” one responsible for performing the action (the actor), the other responsible for criticizing those actions based on evaluative feedback (the critic). Actor-critic architectures usually lead to policies that maximize the long-term return, and thus they seem to have only a small role in the reward schedule task. If an underlying actor-critic is present, its effectiveness in producing optimal control might be blunted by an opposing force deriving from the purely motivational nature of the problem encountered in this task, i.e., whether or not to comply with its demands. Indeed, we have shown that it is sufficient for the critic to assess the value of the current trial and use it to direct the level of engagement in the task, without the need for a more specialized actor structure as would be required for action selection <xref ref-type="bibr" rid="pcbi.1000131-Atallah1">[38]</xref>. Instead, the process of valuation of several alternatives, potentially leading to different courses of actions and rewards as it typically occurs in general decision problems, could benefit more from an actor-critic organization of the behavior.</p>
</sec><sec id="s3d">
<title>Related Work</title>
<p>The extension of RL to capture the fundamental role of motivation in reinforcement schedules is currently a major challenge for the field, and other authors have also considered how to include motivation in RL <xref ref-type="bibr" rid="pcbi.1000131-Dayan1">[14]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Dayan2">[15]</xref>. These authors focused on incorporating overall drive (e.g., such as degree of hunger or thirst) so as to describe how habitual responses can be modified by the current motivational level, which is, in turn, assumed to influence generalized drive through sensitivity to average reward levels <xref ref-type="bibr" rid="pcbi.1000131-Niv2">[39]</xref>. In the reward schedule, however, we focused on how motivation orients behavior in a trial-specific, not generalized, manner. In such a case, an alternative solution to ascribing errors to a decreased level of motivation is Pavlovian-instrumental competition, which has been used to explain suboptimal behavior <xref ref-type="bibr" rid="pcbi.1000131-Dayan3">[16]</xref>. Applied to the reward schedule task, this solution would posit that error trials would result from the competition between the negative valence of the valid cue associated to an unrewarded trial (acquired through a Pavlovian-like mechanism), and the incentive to perform the same trial correctly to reach the end of the schedule and obtain reward. This interpretation is supported somewhat by the fact that the visual cues have no instrumental role in the reward schedule (they are neither triggers nor instructors of correct behavioral actions). The schedule length effect, however, escapes explanations in terms of Pavlovian-instrumental competition and would still have to be taken into account. Instead, the single motivational mechanism put forward in this work accounts for all the aspects of the behavior; has a natural interpretation in terms of learned motivation to act, however originated; and can be extended to general MDPs.</p>
<p>A dependence on the value of the preceding state implemented in our learning rule suggests an explanation of the schedule length effect as a history effect. When environmental cues are not perfect predictors of the availability of resources, monkeys' decisions about where to forage depend on past information like the history of preceding reinforcements <xref ref-type="bibr" rid="pcbi.1000131-Sugrue1">[40]</xref>, or stored information about recent trends in weather <xref ref-type="bibr" rid="pcbi.1000131-Janmaat1">[41]</xref>. Lau and Glimcher <xref ref-type="bibr" rid="pcbi.1000131-Lau1">[28]</xref> have found that past choices, in addition to past reinforcements, must be taken into account to predict the trial-by-trial behavior of rhesus monkeys engaged in a choice task resulting in matching behavior. However, contrary to the statistical description of Lau and Glimcher <xref ref-type="bibr" rid="pcbi.1000131-Lau1">[28]</xref>, past information in our model bears an effect on the learning rule, not directly on the action selection process, and it does so through the value of the previous state, as opposed to past reinforcements or past choice history. Taken together, these findings point to some form of sensitivity to preceding actions and visited states (or their values) in primates' foraging behavior, and the schedule length effect might be a side effect of such a mechanism, perhaps also present in other forms of reinforcement learning.</p>
</sec><sec id="s3e">
<title>Relation to Neural Data</title>
<p>Current theories of reinforcement learning posit that dopaminergic neurons code for a prediction error signal analogous to <italic>δ</italic> in our model and in TD learning in general <xref ref-type="bibr" rid="pcbi.1000131-Schultz1">[30]</xref>. Data from dopaminergic neurons of monkeys performing a reward schedule task, however, are not in sufficient accord with the predictions of such theories <xref ref-type="bibr" rid="pcbi.1000131-Ravel1">[24]</xref>. For example, one prediction is that <italic>δ</italic>, and therefore dopamine neurons, after sufficient training should cease to respond to predicted reward, and this was not observed. Recent developments <xref ref-type="bibr" rid="pcbi.1000131-Fiorillo1">[42]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Kobayashi1">[43]</xref> rule out that this could be the consequence of the small temporal jitter around reward delivery. Despite the incongruence with the assumed role of dopamine neurons as signaling some form of prediction error, there is clear evidence of the involvement of dopamine in learning. In the reward schedule, the importance of dopamine D2 receptors for learning the meaning of new valid cues has been demonstrated in perirhinal cortex <xref ref-type="bibr" rid="pcbi.1000131-Liu2">[26]</xref>, and Ravel and Richmond <xref ref-type="bibr" rid="pcbi.1000131-Ravel1">[24]</xref> have argued that salient events may drive dopaminergic neurons, whose activity may be required for enhancing the connection of the stimulus with its prediction in perirhinal cortex.</p>
<p>The contextual impact of the organization of the task in schedules has been found in the event-related responses of neurons in all neural structures investigated thus far in the reward schedule task, except perhaps for neurons of the area TE <xref ref-type="bibr" rid="pcbi.1000131-Liu1">[22]</xref>. The brain area where the neural modulation with schedule state is most apparent is the anterior cingulate cortex <xref ref-type="bibr" rid="pcbi.1000131-Shidara2">[44]</xref>. One third of the neurons recorded in this area keep track of the progress through the schedule in the Valid Cue condition, and could reflect the (motivational) value of the schedule states and their being linked to one another in a chain of states culminating in the rewarded trial. Another candidate structure for the representation of the schedule states is the perirhinal cortex, whose neurons become selective for the meaning of the visual cues, as opposed to, e.g., TE neurons' responses that are locked to their physical identity <xref ref-type="bibr" rid="pcbi.1000131-Liu1">[22]</xref>.</p>
<p>In some brain regions, neuronal responses are different in trials of different schedules that might be regarded as homologous, particularly last trials of different schedules. Dopamine neurons <xref ref-type="bibr" rid="pcbi.1000131-Ravel1">[24]</xref>, perirhinal neurons <xref ref-type="bibr" rid="pcbi.1000131-Liu1">[22]</xref> and ventral striatum neurons <xref ref-type="bibr" rid="pcbi.1000131-Shidara1">[23]</xref> respond differently to valid cues in last trials (predicting the same reward, but in different schedules). This is reminiscent of the phenomenon that the context-sensitive model assigns different values to terminal trials belonging to different schedules.</p>
<p>Neurons of the basolateral complex of the amygdala often have differential post-cue activity in first trials <xref ref-type="bibr" rid="pcbi.1000131-SugaseMiyamoto1">[25]</xref>. In these neurons another, different effect related to the organization in schedules has also been observed: these neurons increase their activity in the pre-cue period before the beginning of each schedule. No pre-cue activity was observed in the Random Cue condition, supporting the hypothesis that pre-cue activity is related to the contextual imprint of the task's organization in schedules <xref ref-type="bibr" rid="pcbi.1000131-SugaseMiyamoto1">[25]</xref>. This activity could be related to a context-sensitive representation of the values of the states, either in the amygdala itself, or in areas connected to the amygdala like perirhinal cortex <xref ref-type="bibr" rid="pcbi.1000131-Liu1">[22]</xref>, anterior cingulate cortex <xref ref-type="bibr" rid="pcbi.1000131-Shidara2">[44]</xref> and ventral striatum <xref ref-type="bibr" rid="pcbi.1000131-Shidara1">[23]</xref>, where the schedule state meaning of valid cues is strongly represented. The possibility of a more specific role of the amygdala for the emergence of the schedule length effect will be considered later when discussing the analogous phenomenon of “framing” in humans.</p>
<p>Finally, there is evidence for the role of the primate striatum in learned action selection, with some authors <xref ref-type="bibr" rid="pcbi.1000131-ODoherty1">[45]</xref> proposing for its ventral part coding for the values of states (reminiscent of the critic in actor-critic RL methods), and its dorsal part coding for the values of actions and for action selection (reminiscent of the actor <xref ref-type="bibr" rid="pcbi.1000131-Samejima1">[11]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Haruno1">[13]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-ODoherty1">[45]</xref>; but see <xref ref-type="bibr" rid="pcbi.1000131-Atallah1">[38]</xref>). In the reward schedule, the largest population of ventral striatum neurons which are responsive around the time of bar release, do so in rewarded trials, with the second larger population being responsive in all trials <xref ref-type="bibr" rid="pcbi.1000131-Shidara1">[23]</xref>. Comparison of latency and periods of peak activity between these neurons and neurons of the orbitofrontal cortex suggest that the latter are better positioned for representing the reward contingency and thus for guiding action, whereas the former are more related to executing the action <xref ref-type="bibr" rid="pcbi.1000131-Simmons2">[46]</xref>. This role is usually ascribed to more dorsal regions of the striatum, but the involvement of the ventral striatum is conceivable in the reward schedule, given the simple action selection required (it amounts to the timely execution of the bar release in all contingencies), and it is compatible with our model, where the probability of a correct bar release is based solely on the value of the current state and not on action values.</p>
</sec><sec id="s3f">
<title>Interpretation of the Schedule Length Effect: Framing and Sunk Cost</title>
<p>In the context-sensitive model, the mechanism responsible for the schedule length effect leads to the violation of invariance. The violation of this principle was invoked by Tversky and Kahneman in their description of “framing” <xref ref-type="bibr" rid="pcbi.1000131-Tversky2">[18]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Kahneman1">[19]</xref>. Framing describes the process whereby the choice made is influenced by the manner or context in which the choice is presented. Thaler <xref ref-type="bibr" rid="pcbi.1000131-Thaler1">[47]</xref> and Tversky and Kahneman <xref ref-type="bibr" rid="pcbi.1000131-Tversky2">[18]</xref> showed that humans often act as if they kept separate accounts for gains and losses, rather than estimate the total value. A consequence of keeping separate accounts is that the manner in which a problem is cast, in terms of gains, of losses, or of total value influences choices. For example, people purchasing two items, costing respectively $15 and $125, are more willing to put an effort (for example by driving to another store) to save $5 when this is presented as a discount on the $15 item, than when presented as a discount on the $125 item, even though the total saving is the same <xref ref-type="bibr" rid="pcbi.1000131-Tversky2">[18]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Thaler1">[47]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Savage1">[48]</xref>. Similarly, monkeys are willing to put more effort in a trial if the total effort to get there had been larger, even though this does not affect the upcoming reward. A “minimal account” would consider only the proximity to reward, whereas the behavior of the monkeys shows that a combination of minimal (reward proximity) and topical (workload) accounts affects their motivation when facing a reward schedule. From this point of view, reward proximity could be seen as a property defining the state (in accord with Equation 7), much like the $5 discount defines the saving in the example above, independently of the item to which it is nominally attached. In both cases, it is the comparison with some truly contextual attribute that assigns a different motivational value to the same action. Thus, especially on penultimate trials, the length of the schedule seems to exert a contextual effect on the monkeys' motivation analogous to framing. A more direct, preliminary example of framing in monkeys has been reported recently <xref ref-type="bibr" rid="pcbi.1000131-So1">[49]</xref> using a task similar to one previously used with starlings <xref ref-type="bibr" rid="pcbi.1000131-Marsh1">[50]</xref>.</p>
<p>The schedule length effect is also reminiscent of the so-called “sunk cost” effect <xref ref-type="bibr" rid="pcbi.1000131-Arkes1">[20]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Arkes2">[21]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Kacelnik1">[51]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Pompilio1">[52]</xref>, “a maladaptive behavior that is manifested in a greater tendency to continue an endeavor once an investment in money, effort or time has been made” <xref ref-type="bibr" rid="pcbi.1000131-Arkes2">[21]</xref>. The sunk cost phenomenon comes in different varieties and with different interpretations (to the point of having different names, like “Concorde effect,” “cognitive dissonance,” “work ethics,” see <xref ref-type="bibr" rid="pcbi.1000131-Arkes1">[20]</xref> for a review), some of which come close to framing. In one interpretation, sunk cost derives from the violation of the principle that “a prior investment should not influence one's consideration of current options; only the incremental costs and benefits of the current options should influence one's decision” <xref ref-type="bibr" rid="pcbi.1000131-Arkes1">[20]</xref>. The similarity with the schedule length effect and with the previous discussion about its interpretation in terms of framing seems obvious. A relevant example is Experiment 2 of Arkes and Blumer <xref ref-type="bibr" rid="pcbi.1000131-Arkes2">[21]</xref>. In this experiment, three groups of patrons were sold season tickets for the Ohio University Theater at three different prices, and those who purchased tickets at either of the discounted prices attended fewer plays during the season. In this case, the money spent at the beginning of the season influenced the patrons' choice to attend the plays.</p>
<p>It could be argued that, in the reward schedule task, the cost of performing trials is not strictly a “sunk” (wasted) cost, as it would be if the monkeys had to start the schedule anew after each error trial. However, this would only be a minor difference with other instantiations of sunk cost effects; and it could similarly be argued that the money spent in Experiment 2 of Arkes and Blumer <xref ref-type="bibr" rid="pcbi.1000131-Arkes2">[21]</xref> is not a wasted cost, since it is necessary to attend the plays.</p>
<p>Various explanations of sunk cost and framing have been proposed. Arkes and Ayton <xref ref-type="bibr" rid="pcbi.1000131-Arkes1">[20]</xref> explain the sunk cost fallacy as an overgeneralization of the “don't waste” rule, since based on their review of the literature, the effect is not unambiguously present in lower animals, and is not found in children <xref ref-type="bibr" rid="pcbi.1000131-Arkes1">[20]</xref>. Even if the schedule length effect can legitimately be interpreted in terms of sunk cost or framing, we think that this is unlikely to be the correct explanation. A better explanation may be linked to emotional factors. A functional imaging study <xref ref-type="bibr" rid="pcbi.1000131-DeMartino1">[53]</xref> points to an important emotional component in the susceptibility to frames in humans. This study found the susceptibility to framing linked to amygdala activations, with the ability to resist the frame linked to activation of the orbital and medial frontal cortex. Similarly, we believe that there is a strong emotional component responsible for the monkey's reaction to unrewarded cues (leading to larger error rates), and possibly for the schedule length effect. Thus, a connection between this emotional component and parameter <italic>σ</italic>, which quantifies the schedule length effect in our model, could be speculated on the basis that a larger <italic>σ</italic> implies a larger schedule length effect, in the same way as a larger emotional component would imply a stronger susceptibility to framing <xref ref-type="bibr" rid="pcbi.1000131-DeMartino1">[53]</xref>. We do not reject this idea as a possibility, but our data are not sufficient evidence for it.</p>
<p>Our model does make a clear prediction in one case where framing has been found, i.e., in the increase in preference due to training with a larger cost <xref ref-type="bibr" rid="pcbi.1000131-Kacelnik1">[51]</xref>, a case of state-dependent learned valuation. In this experiment, starlings preferred to choose stimuli which had previously associated with a larger effort (16 1-m flights vs. four 1-m flights) to obtain an otherwise identical reward. Since this paradigm pitted two reinforcement schedules of different length against each other, there are obvious similarities with our reward schedule task. Indeed, it would be possible to run a similar test in monkeys by associating different cues to terminal trials in different schedules (e.g., cue H for the longer schedule and cue L for the shorter), and then test the monkeys' preference in a choice task where there is no cost (or equal cost) to obtain the same reward from two sources, one cued with H, the other with L. Would the monkey prefer the cue associated during training with the longer schedule, as found in starlings <xref ref-type="bibr" rid="pcbi.1000131-Kacelnik1">[51]</xref>? Our model predicts exactly this. Because of the accumulation of previous values, the values of terminal trials are larger in longer schedules in the model with <italic>σ</italic>&gt;0. Assuming that in the choice task preference depends on the same learned values, the source of reward cued by H (previously associated with the longer schedule) would be preferred. This also means that our model implies state-dependent learned valuation when the state of the animal is defined by the cumulative effort expended to obtain the reward.</p>
<p>We stress, however, that our learning model is not meant to be a general model of the effects that frames, or sunk costs, have on humans and animals. For example, Pompilio et al <xref ref-type="bibr" rid="pcbi.1000131-Pompilio1">[52]</xref> offer additional evidence of state-dependent valuation in an invertebrate (the grasshopper), but in their case the state of the animals at the time of learning is defined by their nutritional state (e.g., more or less hungry) as opposed to their expended cost. They found that the grasshoppers, in a later choice task with equal cost, prefer the food experienced when in a lower nutritional state during learning. We do not see a connection between this finding and the schedule length effect, or the role of the parameter <italic>σ</italic>. This should not be surprising. As Pompilio et al. <xref ref-type="bibr" rid="pcbi.1000131-Pompilio1">[52]</xref> point out, there may be more than a single mechanism responsible for state-dependent valuation, depending on the animal and, in the same animal, depending on the paradigm used for training.</p>
</sec><sec id="s3g">
<title>Conclusions</title>
<p>In the heuristic modification of TD learning introduced in this work, the schedule length effect emerges spontaneously from the sensitivity to the immediately preceding trial, leading to the violation of the invariance principle. Since this principle is violated in instances of framing and sunk cost effects, we have interpreted the monkeys' behavior using the framing and sunk cost analogies, even though monkeys might not be susceptible to framing or sunk cost the way humans are. We are not aware of alternative RL models predicting the violation of the principle of invariance.</p>
</sec></sec><sec id="s4">
<title>Materials and Methods</title>
<sec id="s4a">
<title>Subjects and Behavioral Paradigm</title>
<p>In this work we collate the behavioral data from earlier studies on monkeys (<italic>Macaca mulatta</italic>) tested in the reward schedule task <xref ref-type="bibr" rid="pcbi.1000131-Liu1">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1000131-Liu2">[26]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Liu3">[32]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Shidara2">[44]</xref>. In all of these studies, randomly interleaved schedules of one, two or three trials must be completed to obtain a reward. In <italic>n</italic> = 3 monkeys, schedules with 4 trials were also used. A trial begins when the monkey touches a bar (<xref ref-type="fig" rid="pcbi-1000131-g001">Figure 1A</xref>), causing the appearance of a visual cue. Four hundred milliseconds later a red dot (WAIT signal) appears in the center of the cue. After a random interval of 500–1500 ms the dot turns green (GO signal). The monkey is required to release the touch-bar between 200 and 800 ms after the green dot appeared, in which case the dot turns blue (OK signal), and a drop of liquid reward is delivered 250 to 350 ms later. If the monkey releases the bar outside the 200–800 ms interval after the GO signal, an error is registered, and no reward is delivered. To start, monkeys are trained on this simple color discrimination task, with or without the presence of a cue, and are rewarded for every correct trial. When performance reaches criterion (at least 75% correct), reward schedules start. Each reward schedule is a sequence of 1, or 2, or 3, …, or <italic>N<sub>s</sub></italic> trials, where <italic>N<sub>s</sub></italic> is the maximal schedule length for that session (3 or 4; see <xref ref-type="fig" rid="pcbi-1000131-g001">Figure 1B</xref> for a 2-trial schedule). All schedules are selected with equal probability, and within a schedule error trials must be repeated until performed correctly. Only correct terminal trials are rewarded. After a correct terminal trial, a new schedule is selected pseudo-randomly. Each schedule state is labeled by the pair {<italic>τ</italic>,<italic>s</italic>}, where <italic>τ</italic> = 1, 2, …, <italic>s</italic> stands for trial and <italic>s</italic> = 1, 2, …, <italic>N<sub>s</sub></italic> stands for schedule. Terminal trials have <italic>τ</italic> = <italic>s</italic>. Trials of different schedules representing the same schedule fraction (e.g., 1/2 and 2/4) are considered different schedule states, even though they might have been associated to the same visual cue (Valid Cue condition, see below). Different cue sets have been used in different studies <xref ref-type="bibr" rid="pcbi.1000131-Bowman1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1000131-Liu1">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1000131-Liu2">[26]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Liu3">[32]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Shidara2">[44]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Simmons3">[54]</xref>, producing similar behavioral results. For the data shown in <xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2</xref>, collected by Sugase-Miyamoto and Richmond <xref ref-type="bibr" rid="pcbi.1000131-SugaseMiyamoto1">[25]</xref> (panel <italic>A</italic>) and Shidara and Richmond <xref ref-type="bibr" rid="pcbi.1000131-Shidara2">[44]</xref> (panel <italic>B</italic>), horizontal bars with different brightness were used as cues, and the cues were brighter as the schedule progressed. Other cue sets have also been used. Some, still based on cue brightness, had the opposite relationship between brightness and proximity to reward, e.g., cues were darker towards the end of the schedule, as, e.g., in <xref ref-type="fig" rid="pcbi-1000131-g001">Figure 1</xref> <xref ref-type="bibr" rid="pcbi.1000131-Liu1">[22]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Ravel1">[24]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Liu3">[32]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Simmons3">[54]</xref>, to ensure that the behavior of the monkeys was not biased by the direction of brightness. Other cue sets were based on bar length <xref ref-type="bibr" rid="pcbi.1000131-Liu2">[26]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Liu3">[32]</xref>; still others consisted of unique stimuli like, e.g., Walsh patterns <xref ref-type="bibr" rid="pcbi.1000131-Liu2">[26]</xref>, to establish that the behavior was not a consequence of having a sensory attribute (like length or brightness) increasing or decreasing with proximity to reward. The typical behavioral patterns that are the main focus of this work were similar across individual experiments and cue sets.</p>
<p>In the paradigm with random cues, the same visual stimuli are present, but each stimulus is selected pseudo-randomly with equal probability in each trial (Random Cue condition). In such a case, there is no relationship between cues and schedule states, although the schedules are still in effect.</p>
<p>The monkeys were not taught the “rules” of the reward schedule task but were simply exposed to it. The behavior reported in <xref ref-type="fig" rid="pcbi-1000131-g002">Figure 2</xref> emerges spontaneously, typically within a week of the first exposure, depending on the monkey (in some cases, it emerges on the very first day), and it generalizes rapidly (in less than 3 days) to different cue sets.</p>
</sec><sec id="s4b">
<title>Data Analysis and Statistics</title>
<p>For each monkey, the error rates were calculated as the ratio of the total number of incorrect trials (in all sessions) to the total number of trials for each schedule state. Differences in error rates across schedule states were tested with a <italic>χ</italic><sup>2</sup> test of the contingency table obtained from the numbers of correct and incorrect trials (confidence was taken at the 5% level). Pair-wise comparisons of the error rates in different schedule states were tested with the Marascuilo procedure after a significant <italic>χ</italic><sup>2</sup> test <xref ref-type="bibr" rid="pcbi.1000131-NISTSEMATECH1">[55]</xref>. If the <italic>χ</italic><sup>2</sup> test is significant at the <italic>α</italic> level, the Marascuilo procedure <xref ref-type="bibr" rid="pcbi.1000131-NISTSEMATECH1">[55]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Marascuilo1">[56]</xref> provides a confidence interval of 100(1−<italic>α</italic>)% for each pair-wise difference of error rates |<italic>p<sub>i</sub></italic>−<italic>p<sub>j</sub></italic>|, where <italic>p<sub>i</sub></italic> = <italic>e<sub>i</sub></italic>/<italic>n<sub>i</sub></italic> is the error rate in schedule state <italic>i</italic>, and <italic>e<sub>i</sub></italic>, <italic>n<sub>i</sub></italic> are, respectively, the number of error trials and total trials in schedule state <italic>i</italic>. The Marasquilo confidence interval on |<italic>p<sub>i</sub></italic>−<italic>p<sub>j</sub></italic>| is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e024" xlink:type="simple"/></inline-formula>. In this formula, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e025" xlink:type="simple"/></inline-formula> is the critical value of <italic>χ</italic><sup>2</sup> with <italic>N</italic>−1 degrees of freedom at <italic>α</italic> level of significance (the point of the distribution which leaves an area of α in the upper tail of the distribution). <italic>N</italic> is the number of different schedule states. Schedule states with |<italic>p<sub>i</sub></italic>−<italic>p<sub>j</sub></italic>|&gt;<italic>p</italic>ˆ<italic><sub>ij</sub></italic> are significantly different at the <italic>α</italic> level.</p>
<p>A sign test <xref ref-type="bibr" rid="pcbi.1000131-Zar1">[57]</xref> was run on the number (<italic>n</italic><sub>+</sub>) of monkeys showing better performance in penultimate trials belonging to longer schedules, as compared to the number (<italic>n</italic><sub>−</sub>) of monkeys where either the inverted pattern, or no difference, was observed. The “exact” binomial probability for <italic>n</italic><sub>+</sub> successes in <italic>n</italic><sub>+</sub>+<italic>n</italic><sub>−</sub> trials was used.</p>
<p>Reaction times were defined as the time elapsed since the appearance of the GO signal and the bar release, and, as reported previously, were generally shorter in trials more proximal to reward <xref ref-type="bibr" rid="pcbi.1000131-Bowman1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1000131-Liu1">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1000131-SugaseMiyamoto1">[25]</xref>. Reaction times had a similar relationship to schedule states as did error rates. Since they provide no new qualitative interpretation, they were not analyzed further.</p>
</sec><sec id="s4c">
<title>Model Fitting</title>
<p>For each monkey, the theoretical error rates (<italic>p</italic><sub>th</sub>) were fitted to the experimental error rates (<italic>p</italic><sub>ex</sub>) by minimizing a weighted sum of squares, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e026" xlink:type="simple"/></inline-formula>, where the sum goes over all schedule states in both the Valid and Random Cue conditions, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e027" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000131-LaCamera1">[58]</xref>. The reason for this choice is that the interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e028" xlink:type="simple"/></inline-formula> is approximately a 68% confidence interval around <italic>p</italic><sub>ex,<italic>i</italic></sub> based on Wilson's “score” equation <xref ref-type="bibr" rid="pcbi.1000131-Brown1">[59]</xref>,<xref ref-type="bibr" rid="pcbi.1000131-Meyer1">[60]</xref>, and (<italic>L<sub>i</sub></italic><sub>,+</sub>−<italic>L<sub>i</sub></italic><sub>,−</sub>)/2 = Δ<italic>p<sub>i</sub></italic>. The theoretical error rates were given by Equations 2, 9, and 10. The minimization of <italic>χ</italic><sup>2</sup> was accomplished with a full factorial search of the best-fit values for parameters <italic>β</italic>, <italic>γ</italic>, and <italic>σ</italic> of Equations 2, 9, and 10.</p>
</sec><sec id="s4d">
<title>Solution of the Model</title>
<p>The formula Equation 6 of the main text for the equilibrium values of the basic model is exact only in the absence of errors, otherwise the values are smaller and are given by the self-consistent, recursion formula:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e029" xlink:type="simple"/><label>(13)</label></disp-formula>Here, <italic>S</italic>′ is the next state in the schedule, <italic>P<sub>c</sub></italic><sub>|<italic>V</italic>(<italic>S</italic>)</sub>≡P(<italic>c</italic>|<italic>V</italic>(<italic>S</italic>)) is the probability of correct performance in (current) state <italic>S</italic>, conditioned on the value of that state, <italic>V</italic>(<italic>S</italic>). <italic>V</italic>(<italic>S</italic>) appears also on the left hand side, and for this reason the formula defines <italic>V</italic>(<italic>S</italic>) only implicitly. If <italic>S</italic> is a terminal trial, <italic>γV</italic>(<italic>S</italic>′) must be replaced by <italic>r</italic> in Equation 13. By iteration, Equation 13 gives<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e030" xlink:type="simple"/><label>(14)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e031" xlink:type="simple"/></inline-formula> to simplify the notation. This set of equations must be solved self-consistently for <italic>V<sub>τs</sub></italic> as the <italic>P<sub>τs</sub></italic> depend on <italic>V<sub>τs</sub></italic>. Under the optimal policy of not making any errors, i.e., with each <italic>P<sub>c</sub></italic><sub>|<italic>V</italic></sub>≡1 independently of <italic>V</italic> instead of Equation 1, Equation 14 becomes the explicit solution given by Equation 6 reported in the main text.</p>
<p>Equation 13 can be derived as follows: at equilibrium, <italic>V</italic>(<italic>S</italic>) is the average of the value obtained after an error (<italic>V<sub>e</sub></italic>, occurring with probability <italic>P<sub>e</sub></italic><sub>|<italic>V</italic></sub>≡1−<italic>P<sub>c</sub></italic><sub>|<italic>V</italic></sub>) and the value obtained after a correct trial (<italic>V<sub>c</sub></italic>, probability <italic>P<sub>c</sub></italic><sub>|<italic>V</italic></sub>), conditioned on current average value being <italic>V</italic>, i.e.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e032" xlink:type="simple"/><label>(15)</label></disp-formula>with <italic>V<sub>c</sub></italic>(<italic>V</italic>) = <italic>V</italic>+<italic>α</italic>(<italic>γV</italic>′−<italic>V</italic>) and <italic>V<sub>e</sub></italic> = <italic>V</italic>+<italic>α</italic>(<italic>γV</italic>−<italic>V</italic>). The last two equations are simply the update equation for <italic>V</italic> after a correct and an incorrect trial respectively; <italic>V</italic>′≡<italic>V</italic>(<italic>S</italic>′) is the value of the next schedule state after a correct trial (<italic>γV</italic>′ must be replaced by <italic>r</italic> in terminal trials). Solving Equation 15 for <italic>V</italic> gives Equation 13.</p>
<p>The same procedure, though more involved algebraically, gives the values in the context-sensitive model:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e033" xlink:type="simple"/></disp-formula>where <italic>P<sub>rs</sub></italic> is defined as for the basic model. This system of equations must be solved self-consistently for the values <italic>V<sub>rs</sub></italic>. In the absence of errors, each <italic>P<sub>rs</sub></italic> = 1 and Equations 9 of the main text follow. We have checked with simulations that the approximate solution given by Equations 9 gives a good approximation to the correct values on our dataset of monkeys' data. For this reason, Equations 2 and 9 were used to estimate the theoretical values when fitting the theoretical error rates to the experimental error rates.</p>
<p>In the Random Cue condition, the cues define the states of the model. The model learns the values of the cues using the same algorithm specified by Equations 1, 3, and 8, with <italic>S<sub>t</sub></italic>≡<italic>cue<sub>t</sub></italic>. The next cue is selected at random with equal probability for all cues if the trial is performed correctly, otherwise the current cue remains as the next. We set <italic>δ</italic> = <italic>r<sub>t</sub></italic>+<italic>σV</italic>(<italic>cue<sub>t</sub></italic><sub>−1</sub>)−<italic>V</italic>(<italic>cue<sub>t</sub></italic>) in terminal trials, in keeping with the rule adopted with valid cues. The average value of random cues can be obtained by averaging the update equation over all trial types that produce a different temporal difference <italic>δ</italic>, obtaining<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e034" xlink:type="simple"/><label>(16)</label></disp-formula>i.e., ∑<italic><sub>i</sub> f<sub>i</sub>δ<sub>i</sub></italic>(<italic>V</italic>) = 0, where <italic>V</italic> is the sought average value, <italic>f<sub>i</sub></italic> is the average frequency with which trial <italic>i</italic> occurs, and <italic>δ<sub>i</sub></italic> is the temporal difference in trial <italic>i</italic>. In the basic model, it is sufficient to distinguish three trial types: correct terminal trials, incorrect terminal trials, and non terminal trials. The frequency (<italic>f</italic>) of correct terminal trials is <italic>N</italic><sub>+</sub><italic>P<sub>c</sub></italic><sub>|<italic>V</italic></sub>, where <italic>N</italic><sub>+</sub> is the average fraction of rewarded trials, equal to the number of schedules divided by the number of schedule states. In correct terminal trials the temporal difference is <italic>δ</italic> = <italic>r</italic>−<italic>V</italic>. Incorrect terminal trials occur with frequency <italic>N</italic><sub>+</sub>(1−<italic>P<sub>c</sub></italic><sub>|<italic>V</italic></sub>) and have <italic>δ</italic> = −<italic>V</italic>; non-terminal trials occur with frequency 1−<italic>N</italic><sub>+</sub> and generate a temporal difference <italic>δ</italic> = (<italic>γ</italic>−1)<italic>V</italic>, whether the trial is correct or not. Replacing these values in Equation 16 and solving for <italic>V</italic> gives<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e035" xlink:type="simple"/><label>(17)</label></disp-formula></p>
<p>Equation 17 defines <italic>V</italic> only implicitly and must be solved self-consistently to give the exact value of <italic>V</italic>. For the small error rates usually encountered with random cues, Equation 17 is well approximated by its version in the absence of errors (<italic>P<sub>c</sub></italic><sub>|<italic>V</italic></sub> = 1 for any <italic>V</italic>), i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e036" xlink:type="simple"/></inline-formula>. Note how <italic>V</italic> increases with <italic>γ</italic> and is constrained between the average collected reward <italic>N</italic><sub>+</sub><italic>r</italic> (for <italic>γ</italic> = 0) and <italic>r</italic> (for <italic>γ</italic> = 1). Setting γ = 0 (value at which <italic>V</italic> is minimal) is the same as assuming that the next cue is always unknown and its value is zero (cfr. Equation 4). This implies that having some expectation about the next state, even a random expectation as for the random cues, increases the values and hence the motivation to perform correctly.</p>
<p>The context-sensitive model can be solved in a similar way, with in addition non-first trials to be taken into account. The final result is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e037" xlink:type="simple"/></inline-formula>, from which Equation 10 of the main text follows under the approximation of small error rates, i.e., <italic>P<sub>c</sub></italic><sub>|<italic>V</italic></sub>≈1. Similar results are obtained in the case of post-reward expectation, where the value of the next state after a rewarded trial is not set to zero, as shown in a later subsection.</p>
<p>Since it is required that <italic>V</italic>&gt;0, this result requires (<italic>γ</italic>+<italic>σ</italic>)(1−<italic>N</italic><sub>+</sub>)&lt;1, or (<italic>γ</italic>+<italic>σ</italic>)&lt;(<italic>N<sub>s</sub></italic>+1)(<italic>N<sub>s</sub></italic>−1)<sup>−1</sup>. This inequality is never violated in the basic model (where <italic>σ</italic> = 0), but it might be, and must be imposed, in the context-sensitive model, especially for long maximal schedule lengths. Similar restrictions coming from the values of valid cues also apply (e.g., <italic>σ</italic>&lt;1/2<italic>γ</italic> from Equation 9).</p>
</sec><sec id="s4e">
<title>Insufficiency of Forward-Type Methods of Temporal Difference Learning (Including TD(<italic>λ</italic>))</title>
<p>Here we show that it is not possible to obtain values dependent on schedule length (like in the context-sensitive model) by using a standard TD learning rule, which considers only future trials within the current schedule. The most general such rule can be written as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e038" xlink:type="simple"/></inline-formula>, where the coefficients {<italic>a<sub>i</sub></italic>}<italic><sub>i</sub></italic><sub> = 1,2,…,<italic>T</italic></sub> may depend on pre-reward number (i.e., the number of trials remaining before reward), but not on schedule length. <italic>t</italic>+<italic>T</italic> is the time at which the terminal trial is reached: when <italic>S<sub>t</sub></italic> is a terminal trial, the states <italic>S<sub>t</sub></italic><sub>+<italic>i</italic></sub> are not defined and their values are set to zero. It is more convenient to express the values as a function of the number, <italic>n</italic>, of trials remaining before reward (“0” being the terminal trial), conditioned on schedule length being <italic>s</italic>, <italic>V</italic>(<italic>n</italic>|<italic>s</italic>), as in Equation 7 of the main text. At equilibrium (<italic>δ<sub>t</sub></italic> = 0) one has <italic>V</italic>(1|<italic>s</italic>) = <italic>a</italic><sub>1</sub><italic>V</italic>(0|<italic>s</italic>). Since <italic>V</italic>(0|<italic>s</italic>) = <italic>r</italic> does not depend on <italic>s</italic>, <italic>V</italic>(1|<italic>s</italic>) does not depend on <italic>s</italic>, which in turn implies that <italic>V</italic>(2|<italic>s</italic>) = <italic>a</italic><sub>1</sub><italic>V</italic>(1|<italic>s</italic>)+<italic>a</italic><sub>2</sub><italic>V</italic>(0|<italic>s</italic>) does not depend on <italic>s</italic>, and so on. It follows by induction that <italic>V</italic>(<italic>n</italic>|<italic>s</italic>) does not depend on <italic>s</italic> for all pre-reward numbers <italic>n</italic>, and for any value of the coefficients <italic>a<sub>n</sub></italic> (some of which may vanish). This result holds also in the case of post-reward expectation, where the value of the next state after a rewarded trial is not set to zero and the forward terms in the series ∑ <italic>a<sub>i</sub>V</italic>(<italic>S<sub>t</sub></italic><sub>+<italic>i</italic></sub>) are taken to the (<italic>T</italic>+1)th term. As shown later, all values are re-scaled by a constant factor which does not depend on <italic>s</italic>, leaving the above argument unchanged.</p>
<p>It follows from this argument that, to obtain the schedule-length effect, it is necessary either to look backwards at the values of previous trials in the same schedule (as in the context-sensitive model of the main text), or to take into account trials belonging to different schedules <xref ref-type="bibr" rid="pcbi.1000131-LaCamera2">[61]</xref>. The notable TD(<italic>λ</italic>) rule (see, e.g., <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref>), that has been suggested to be implemented by dopamine neurons of rats <xref ref-type="bibr" rid="pcbi.1000131-Pan1">[62]</xref>, considers only forward trials within the current schedule, and therefore cannot produce the contextual effect due to schedule length. In fact, here we show that for the reward schedule, the equilibrium values in the TD(<italic>λ</italic>) rule are the same as those obtained with the basic model. In TD(<italic>λ</italic>), all forward trials within a schedule are considered, weighted by imminence. Formally, when in state <italic>S<sub>t</sub></italic> at time <italic>t</italic>, the TD term is evaluated as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e039" xlink:type="simple"/><label>(18)</label></disp-formula>where the sum is over all states remaining until the terminal one (reached after <italic>T</italic> steps). <italic>λ</italic> is a parameter between zero and one; <italic>N<sub>T</sub></italic>≡1+<italic>λ</italic>+λ<sup>2</sup>+…+<italic>λ<sup>T</sup></italic><sup>−1</sup> is a normalization factor; and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e040" xlink:type="simple"/></inline-formula> is the <italic>i</italic>-steps-ahead prediction starting from <italic>S<sub>t</sub></italic>. (If <italic>λ</italic> = 0, Equation 18 reduces to <italic>δ<sub>t</sub></italic> = <italic>r<sub>t</sub></italic>+<italic>γV</italic>(<italic>S<sub>t</sub></italic><sub>+1</sub>)−<italic>V</italic>(<italic>S<sub>t</sub></italic>), the basic model of the main text.) The values are updated in the usual way: <italic>V<sub>t</sub></italic><sub>+1</sub> = <italic>αδ<sub>t</sub></italic>. In the reward schedule it is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e041" xlink:type="simple"/></inline-formula> (only the terminal trial is rewarded), and Equation 18 reads<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e042" xlink:type="simple"/><label>(19)</label></disp-formula>where <italic>t</italic>+<italic>T</italic> is the time at which the terminal trial is reached. The solution to <italic>δ<sub>t</sub></italic> = 0, with <italic>δ<sub>t</sub></italic> given by Equation 19, is the same as for the basic rule (Equations 3 and 4 of the main text), i.e., <italic>V</italic>(<italic>S<sub>t</sub></italic><sub>+<italic>i</italic></sub>) = <italic>γ<sup>T</sup></italic><sup>−<italic>i</italic></sup><italic>r</italic>, or <italic>V</italic>(<italic>τ</italic>,<italic>s</italic>) = <italic>γ<sup>s</sup></italic><sup>−<italic>τ</italic></sup><italic>r</italic> if <italic>S<sub>t</sub></italic>≡{<italic>τ</italic>,<italic>s</italic>}, as can be proved, e.g., by direct substitution. This was confirmed in simulations of TD(<italic>λ</italic>)-learning of the reward schedule implemented through the use of eligibility traces, an alternative approach to TD(<italic>λ</italic>) (see <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref> for details).</p>
</sec><sec id="s4f">
<title>Solution of the Model with Post-Reward Expectation</title>
<p>So far, the value of the next state at the end of each schedule had been to set to zero. In other words, the learning rule following a rewarded trial is <italic>δ<sub>t</sub></italic> = <italic>r<sub>t</sub></italic>+<italic>σV</italic>(<italic>S<sub>t</sub></italic><sub>−1</sub>)−<italic>V</italic>(<italic>S<sub>t</sub></italic>), which written in this form applies to all cases, including the case of random cues and the basic model (where <italic>σ</italic> = 0). As said in the main text, this is the common choice in RL <xref ref-type="bibr" rid="pcbi.1000131-Sutton1">[6]</xref>. Here we show that behavior predicted by the model does not change if we assign a positive value to the next state (“post-reward expectation”). The reason is that, in a terminal trial, the next trial is not known and thus the same value must be assumed independently of current schedule. The actual value is immaterial, but for the sake of argument we shall make a choice. In the Random Cue condition, the current value of any cue chosen at random will do; in the Valid Cue condition, since the only available information is that the next state will be one of the initial trials {1,<italic>s</italic>}, the average value of all first trials will be taken, i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e043" xlink:type="simple"/></inline-formula>. It can be shown that the average value of each state is increased by a constant factor (1−<italic>γϑ</italic>)<sup>−1</sup>, where <italic>ϑ</italic> is the ratio of the value of the state post-reward to the value of rewarded trials. For the value chosen above (average of first trials), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e044" xlink:type="simple"/></inline-formula> (note that this choice gives <italic>γϑ</italic>&lt;1). Similarly, the value of random cues changes from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e045" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000131.e046" xlink:type="simple"/></inline-formula>. Thus, there is no qualitative difference with respect to the case of no post-reward expectation of the main text. A similar argument also shows that the qualitative behavior does not change if <italic>σ</italic>&gt;0 in first trials of each schedule in the context-sensitive model.</p>
</sec></sec></body>
<back>
<ack>
<p>We thank S. Fusi, J. Hertz, and A. Lerchner for useful discussions; S. Bouret, A. Clark, W. Lerchner, T. Minamimoto, J. Simmons, and C. Quaia for a careful reading of a previous version of this manuscript and for useful discussions; and two anonymous reviewers for valuable comments and suggestions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000131-Bell1"><label>1</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bell</surname><given-names>DE</given-names></name>
<name name-style="western"><surname>Raiffa</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Tversky</surname><given-names>A</given-names></name>
</person-group>             <year>1988</year>             <source>Decision making: Descriptive, normative, and prescriptive interactions</source>             <publisher-loc>Cambridge, New York</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000131-Schweighofer1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schweighofer</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Shishida</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Han</surname><given-names>CE</given-names></name>
<name name-style="western"><surname>Okamoto</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Tanaka</surname><given-names>SC</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Humans can adopt optimal discounting strategy under real-time constraints.</article-title>             <source>PLoS Comput Biol</source>             <volume>2</volume>             <fpage>e152</fpage>             <comment>doi:10.1371/journal.pcbi.0020152</comment>          </element-citation></ref>
<ref id="pcbi.1000131-Kirby1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kirby</surname><given-names>KN</given-names></name>
</person-group>             <year>1997</year>             <article-title>Bidding on the future: evidence against normative discounting of delayed rewards.</article-title>             <source>J Exp Psychol Gen</source>             <volume>126</volume>             <fpage>54</fpage>             <lpage>70</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Dickson1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dickson</surname><given-names>JW</given-names></name>
</person-group>             <year>1978</year>             <article-title>The effect of normative models on individual and group choice.</article-title>             <source>Eur J Soc Psychol</source>             <volume>8</volume>             <fpage>91</fpage>             <lpage>107</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Niv1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Niv</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Joel</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>
</person-group>             <year>2006</year>             <article-title>A normative perspective on motivation.</article-title>             <source>Trends Cogn Sci</source>             <volume>10</volume>             <fpage>375</fpage>             <lpage>381</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Sutton1"><label>6</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sutton</surname><given-names>RS</given-names></name>
<name name-style="western"><surname>Barto</surname><given-names>AG</given-names></name>
</person-group>             <year>1998</year>             <source>Reinforcement learning: An introduction</source>             <publisher-loc>Cambridge (Massachusetts)</publisher-loc>             <publisher-name>MIT Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000131-Simon1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Simon</surname><given-names>HA</given-names></name>
</person-group>             <year>1986</year>             <article-title>Rationality in psychology and economics.</article-title>             <source>J Bus</source>             <volume>59</volume>             <fpage>S209</fpage>             <lpage>S224</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Schoemaker1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schoemaker</surname><given-names>PJ</given-names></name>
</person-group>             <year>1982</year>             <article-title>The expected utility model: its variants, purposes, evidence and limitations.</article-title>             <source>J Econ Lit</source>             <volume>20</volume>             <fpage>529</fpage>             <lpage>563</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Arrow1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Arrow</surname><given-names>KJ</given-names></name>
</person-group>             <year>1982</year>             <article-title>Risk perception in psychology and economics.</article-title>             <source>Econ Inq</source>             <volume>20</volume>             <fpage>1</fpage>             <lpage>9</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Tversky1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tversky</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Kahneman</surname><given-names>D</given-names></name>
</person-group>             <year>1986</year>             <article-title>Rational choice and the framing of decisions.</article-title>             <source>J Bus</source>             <volume>59</volume>             <fpage>S251</fpage>             <lpage>S278</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Samejima1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Samejima</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Ueda</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Doya</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Kimura</surname><given-names>M</given-names></name>
</person-group>             <year>2005</year>             <article-title>Representation of action-specific reward values in the striatum.</article-title>             <source>Science</source>             <volume>310</volume>             <fpage>1337</fpage>             <lpage>1340</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Pessiglione1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pessiglione</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Seymour</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Flandin</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Dolan</surname><given-names>RJ</given-names></name>
<name name-style="western"><surname>Frith</surname><given-names>CD</given-names></name>
</person-group>             <year>2006</year>             <article-title>Dopamine-dependent prediction errors underpin reward-seeking behaviour in humans.</article-title>             <source>Nature</source>             <volume>442</volume>             <fpage>1042</fpage>             <lpage>1045</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Haruno1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Haruno</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Kawato</surname><given-names>M</given-names></name>
</person-group>             <year>2006</year>             <article-title>Different neural correlates of reward expectation and reward expectation error in the putamen and caudate nucleus during stimulus-action-reward association learning.</article-title>             <source>J Neurophysiol</source>             <volume>95</volume>             <fpage>948</fpage>             <lpage>959</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Dayan1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Balleine</surname><given-names>BW</given-names></name>
</person-group>             <year>2002</year>             <article-title>Reward, motivation, and reinforcement learning.</article-title>             <source>Neuron</source>             <volume>36</volume>             <fpage>285</fpage>             <lpage>298</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Dayan2"><label>15</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>
</person-group>             <year>2002</year>             <article-title>Motivated reinforcement learning.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Dietterich</surname><given-names>TG</given-names></name>
<name name-style="western"><surname>Becker</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Ghahramani</surname><given-names>Z</given-names></name>
</person-group>             <source>Advances in Neural Information Processing Systems 14.</source>             <publisher-loc>Cambridge (Massachusetts)</publisher-loc>             <publisher-name>MIT Press</publisher-name>             <fpage>11</fpage>             <lpage>18</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Dayan3"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Niv</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Seymour</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Daw</surname><given-names>ND</given-names></name>
</person-group>             <year>2006</year>             <article-title>The misbehavior of value and the discipline of the will.</article-title>             <source>Neural Netw</source>             <volume>19</volume>             <fpage>1153</fpage>             <lpage>1160</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Bowman1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bowman</surname><given-names>EM</given-names></name>
<name name-style="western"><surname>Aigner</surname><given-names>TG</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
</person-group>             <year>1996</year>             <article-title>Neural signals in the monkey ventral striatum related to motivation for juice and cocaine rewards.</article-title>             <source>J Neurophysiol</source>             <volume>75</volume>             <fpage>1061</fpage>             <lpage>1073</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Tversky2"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tversky</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Kahneman</surname><given-names>D</given-names></name>
</person-group>             <year>1981</year>             <article-title>The framing of decisions and the psychology of choice.</article-title>             <source>Science</source>             <volume>211</volume>             <fpage>453</fpage>             <lpage>458</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Kahneman1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kahneman</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Tversky</surname><given-names>A</given-names></name>
</person-group>             <year>1984</year>             <article-title>Choices, values, and frames.</article-title>             <source>Am Psychol</source>             <volume>39</volume>             <fpage>341</fpage>             <lpage>350</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Arkes1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Arkes</surname><given-names>HR</given-names></name>
<name name-style="western"><surname>Ayton</surname><given-names>P</given-names></name>
</person-group>             <year>1999</year>             <article-title>The sunk cost and Concorde effect: are humans less rational than lower animals?</article-title>             <source>Psychol Bull</source>             <volume>125</volume>             <fpage>591</fpage>             <lpage>600</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Arkes2"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Arkes</surname><given-names>HR</given-names></name>
<name name-style="western"><surname>Blumer</surname><given-names>C</given-names></name>
</person-group>             <year>1985</year>             <article-title>The psychology of sunk cost.</article-title>             <source>Organ Behav Hum Decis Process</source>             <volume>35</volume>             <fpage>124</fpage>             <lpage>140</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Liu1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Liu</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
</person-group>             <year>2000</year>             <article-title>Response differences in monkey TE and perirhinal cortex: stimulus association related to reward schedules.</article-title>             <source>J Neurophysiol</source>             <volume>83</volume>             <fpage>1677</fpage>             <lpage>1692</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Shidara1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shidara</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Aigner</surname><given-names>TG</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
</person-group>             <year>1998</year>             <article-title>Neuronal signals in the monkey ventral striatum related to progress through a predictable series of trials.</article-title>             <source>J Neurosci</source>             <volume>18</volume>             <fpage>2613</fpage>             <lpage>2625</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Ravel1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ravel</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
</person-group>             <year>2006</year>             <article-title>Dopamine neuronal responses in monkeys performing visually cued reward schedules.</article-title>             <source>Eur J Neurosci</source>             <volume>24</volume>             <fpage>277</fpage>             <lpage>290</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-SugaseMiyamoto1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sugase-Miyamoto</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
</person-group>             <year>2005</year>             <article-title>Neuronal signals in the monkey basolateral amygdala during reward schedules.</article-title>             <source>J Neurosci</source>             <volume>25</volume>             <fpage>11071</fpage>             <lpage>11083</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Liu2"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Liu</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
<name name-style="western"><surname>Murray</surname><given-names>EA</given-names></name>
<name name-style="western"><surname>Saunders</surname><given-names>RC</given-names></name>
<name name-style="western"><surname>Steenrod</surname><given-names>S</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>DNA targeting of rhinal cortex D2 receptor protein reversibly blocks learning of cues that predict reward.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>101</volume>             <fpage>12336</fpage>             <lpage>12341</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Sutton2"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sutton</surname><given-names>RS</given-names></name>
</person-group>             <year>1988</year>             <article-title>Learning to predict by the methods of temporal differences.</article-title>             <source>Mach Learn</source>             <volume>3</volume>             <fpage>9</fpage>             <lpage>44</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Lau1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lau</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Glimcher</surname><given-names>PW</given-names></name>
</person-group>             <year>2005</year>             <article-title>Dynamic response-by-response models of matching behavior in rhesus monkeys.</article-title>             <source>J Exp Anal Behav</source>             <volume>84</volume>             <fpage>555</fpage>             <lpage>579</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Daw1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Daw</surname><given-names>ND</given-names></name>
<name name-style="western"><surname>O'Doherty</surname><given-names>JP</given-names></name>
<name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Seymour</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Dolan</surname><given-names>RJ</given-names></name>
</person-group>             <year>2006</year>             <article-title>Cortical substrates for exploratory decisions in humans.</article-title>             <source>Nature</source>             <volume>441</volume>             <fpage>876</fpage>             <lpage>879</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Schultz1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schultz</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Montague</surname><given-names>PR</given-names></name>
</person-group>             <year>1997</year>             <article-title>A neural substrate of prediction and reward.</article-title>             <source>Science</source>             <volume>275</volume>             <fpage>1593</fpage>             <lpage>1599</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Montague1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Montague</surname><given-names>PR</given-names></name>
<name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Sejnowski</surname><given-names>TJ</given-names></name>
</person-group>             <year>1996</year>             <article-title>A framework for mesencephalic dopamine systems based on predictive Hebbian learning.</article-title>             <source>J Neurosci</source>             <volume>16</volume>             <fpage>1936</fpage>             <lpage>1947</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Liu3"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Liu</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Murray</surname><given-names>EA</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
</person-group>             <year>2000</year>             <article-title>Learning motivational significance of visual cues for reward schedules requires rhinal cortex.</article-title>             <source>Nat Neurosci</source>             <volume>3</volume>             <fpage>1307</fpage>             <lpage>1315</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Simmons1"><label>33</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Simmons</surname><given-names>JM</given-names></name>
<name name-style="western"><surname>Minamimoto</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Murray</surname><given-names>EA</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
</person-group>             <year>2007</year>             <source>Lesions of orbitofrontal cortex in rhesus monkeys disrupt assessments of outcome value as a function of cost. Neuroscience Meeting Planner</source>             <publisher-loc>San Diego, , CA</publisher-loc>             <publisher-name>Society for Neuroscience</publisher-name>             <comment>Program No. 311-4 2007</comment>          </element-citation></ref>
<ref id="pcbi.1000131-Dayan4"><label>34</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Abbott</surname><given-names>LF</given-names></name>
</person-group>             <year>2005</year>             <source>Theoretical neuroscience: computational and mathematical modeling of neural systems</source>             <publisher-loc>Cambridge, London, Mass.</publisher-loc>             <publisher-name>MIT.</publisher-name>             <fpage> 576 p</fpage>          </element-citation></ref>
<ref id="pcbi.1000131-Egelman1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Egelman</surname><given-names>DM</given-names></name>
<name name-style="western"><surname>Person</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Montague</surname><given-names>PR</given-names></name>
</person-group>             <year>1998</year>             <article-title>A computational role for dopamine delivery in human decision-making.</article-title>             <source>J Cogn Neurosci</source>             <volume>10</volume>             <fpage>623</fpage>             <lpage>630</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-McClure1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>McClure</surname><given-names>SM</given-names></name>
<name name-style="western"><surname>Daw</surname><given-names>ND</given-names></name>
<name name-style="western"><surname>Montague</surname><given-names>PR</given-names></name>
</person-group>             <year>2003</year>             <article-title>A computational substrate for incentive salience.</article-title>             <source>Trends Neurosci</source>             <volume>26</volume>             <fpage>423</fpage>             <lpage>428</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Joel1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Joel</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Niv</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Ruppin</surname><given-names>E</given-names></name>
</person-group>             <year>2002</year>             <article-title>Actor-critic models of the basal ganglia: new anatomical and computational perspectives.</article-title>             <source>Neural Netw</source>             <volume>15</volume>             <fpage>535</fpage>             <lpage>547</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Atallah1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Atallah</surname><given-names>HE</given-names></name>
<name name-style="western"><surname>Lopez-Paniagua</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Rudy</surname><given-names>JW</given-names></name>
<name name-style="western"><surname>O'Reilly</surname><given-names>RC</given-names></name>
</person-group>             <year>2007</year>             <article-title>Separate neural substrates for skill learning and performance in the ventral and dorsal striatum.</article-title>             <source>Nat Neurosci</source>             <volume>10</volume>             <fpage>126</fpage>             <lpage>131</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Niv2"><label>39</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Niv</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Daw</surname><given-names>ND</given-names></name>
<name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>
</person-group>             <year>2005</year>             <article-title>How fast to work: Response vigor, motivation and tonic dopamine.</article-title>             <source>Neural Information Processing Systems</source>             <publisher-loc>Cambridge (Massachusetts)</publisher-loc>             <publisher-name>MIT Press</publisher-name>             <fpage>1019</fpage>             <lpage>1026</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Sugrue1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sugrue</surname><given-names>LP</given-names></name>
<name name-style="western"><surname>Corrado</surname><given-names>GS</given-names></name>
<name name-style="western"><surname>Newsome</surname><given-names>WT</given-names></name>
</person-group>             <year>2004</year>             <article-title>Matching behavior and the representation of value in the parietal cortex.</article-title>             <source>Science</source>             <volume>304</volume>             <fpage>1782</fpage>             <lpage>1787</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Janmaat1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Janmaat</surname><given-names>KR</given-names></name>
<name name-style="western"><surname>Byrne</surname><given-names>RW</given-names></name>
<name name-style="western"><surname>Zuberbuhler</surname><given-names>K</given-names></name>
</person-group>             <year>2006</year>             <article-title>Primates take weather into account when searching for fruits.</article-title>             <source>Curr Biol</source>             <volume>16</volume>             <fpage>1232</fpage>             <lpage>1237</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Fiorillo1"><label>42</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fiorillo</surname><given-names>CD</given-names></name>
<name name-style="western"><surname>Schultz</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Newsome</surname><given-names>WT</given-names></name>
</person-group>             <year>2007</year>             <source>The temporal precision of reward prediction in dopamine neurons. Neuroscience Meeting Planner</source>             <publisher-loc>San Diego, , CA</publisher-loc>             <publisher-name>Society for Neuroscience</publisher-name>             <comment>Program No. 622-20 2007</comment>          </element-citation></ref>
<ref id="pcbi.1000131-Kobayashi1"><label>43</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kobayashi</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Schultz</surname><given-names>W</given-names></name>
</person-group>             <year>2007</year>             <source>Temporal discounting in the activity of dopamine neurons during a Pavlovian task. Neuroscience Meeting Planner</source>             <publisher-loc>San Diego, , CA</publisher-loc>             <publisher-name>Society for Neuroscience</publisher-name>             <comment>Program No. 933-3 2007</comment>          </element-citation></ref>
<ref id="pcbi.1000131-Shidara2"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shidara</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
</person-group>             <year>2002</year>             <article-title>Anterior cingulate: single neuronal signals related to degree of reward expectancy.</article-title>             <source>Science</source>             <volume>296</volume>             <fpage>1709</fpage>             <lpage>1711</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-ODoherty1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>O'Doherty</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Schultz</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Deichmann</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Friston</surname><given-names>K</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Dissociable roles of ventral and dorsal striatum in instrumental conditioning.</article-title>             <source>Science</source>             <volume>304</volume>             <fpage>452</fpage>             <lpage>454</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Simmons2"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Simmons</surname><given-names>JM</given-names></name>
<name name-style="western"><surname>Ravel</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Shidara</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
</person-group>             <year>2007</year>             <article-title>A comparison of reward-contingent neuronal activity in monkey orbitofrontal cortex and ventral striatum: guiding actions toward rewards.</article-title>             <source>Ann N Y Acad Sci</source>             <volume>1121</volume>             <fpage>376</fpage>             <lpage>394</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Thaler1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thaler</surname><given-names>R</given-names></name>
</person-group>             <year>1980</year>             <article-title>Toward a positive theory of consumer choice.</article-title>             <source>J Econ Behav Organ</source>             <volume>5</volume>             <fpage>39</fpage>             <lpage>60</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Savage1"><label>48</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Savage</surname><given-names>LJ</given-names></name>
</person-group>             <year>1954</year>             <source>The Foundations of Statistics</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Wiley</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000131-So1"><label>49</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>So</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Stuphorn</surname><given-names>V</given-names></name>
</person-group>             <year>2007</year>             <source>Framing effects on decision-making under risk in macaque monkeys. Abstract Viewer/Itinerary Planner</source>             <publisher-loc>Washington, DC</publisher-loc>             <publisher-name>Society for Neuroscience</publisher-name>             <comment>Program No. 210-20 2007</comment>          </element-citation></ref>
<ref id="pcbi.1000131-Marsh1"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Marsh</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Kacelnik</surname><given-names>A</given-names></name>
</person-group>             <year>2002</year>             <article-title>Framing effects and risky decisions in starlings.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>99</volume>             <fpage>3352</fpage>             <lpage>3355</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Kacelnik1"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kacelnik</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Marsh</surname><given-names>B</given-names></name>
</person-group>             <year>2002</year>             <article-title>Cost can increase preference in starlings.</article-title>             <source>Anim Behav</source>             <volume>63</volume>             <fpage>245</fpage>             <lpage>250</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Pompilio1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pompilio</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Kacelnik</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Behmer</surname><given-names>ST</given-names></name>
</person-group>             <year>2006</year>             <article-title>State-dependent learned valuation drives choice in an invertebrate.</article-title>             <source>Science</source>             <volume>311</volume>             <fpage>1613</fpage>             <lpage>1615</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-DeMartino1"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>De Martino</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Kumaran</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Seymour</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Dolan</surname><given-names>RJ</given-names></name>
</person-group>             <year>2006</year>             <article-title>Frames, biases, and rational decision-making in the human brain.</article-title>             <source>Science</source>             <volume>313</volume>             <fpage>684</fpage>             <lpage>687</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Simmons3"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Simmons</surname><given-names>JM</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
</person-group>             <year>2008</year>             <article-title>Dynamic changes in representations of preceding and upcoming reward in monkey orbitofrontal cortex.</article-title>             <source>Cereb Cortex</source>             <volume>18</volume>             <fpage>93</fpage>             <lpage>103</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-NISTSEMATECH1"><label>55</label><element-citation publication-type="other" xlink:type="simple">             <collab xlink:type="simple">NIST/SEMATECH</collab>             <year>2006</year>             <article-title>e-Handbook of Statistical Methods: Online Publication.</article-title>             <comment><ext-link ext-link-type="uri" xlink:href="http://www.itl.nist.gov/div898/handbook/prc/section4/prc474.htm" xlink:type="simple">http://www.itl.nist.gov/div898/handbook/prc/section4/prc474.htm</ext-link>, Section 7.4.7.4</comment>          </element-citation></ref>
<ref id="pcbi.1000131-Marascuilo1"><label>56</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Marascuilo</surname><given-names>LA</given-names></name>
</person-group>             <year>1971</year>             <source>Statistical Methods for Behavioral Science Research</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>McGraw-Hill</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000131-Zar1"><label>57</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zar</surname><given-names>JH</given-names></name>
</person-group>             <year>1999</year>             <source>Biostatistical Analysis</source>             <publisher-loc>Upper Saddle River (New Jersey)</publisher-loc>             <publisher-name>Prentice Hall</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000131-LaCamera1"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>La Camera</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Rauch</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Thurbon</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Luscher</surname><given-names>HR</given-names></name>
<name name-style="western"><surname>Senn</surname><given-names>W</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Multiple time scales of temporal response in pyramidal and fast spiking cortical neurons.</article-title>             <source>J Neurophysiol</source>             <volume>96</volume>             <fpage>3448</fpage>             <lpage>3464</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Brown1"><label>59</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brown</surname><given-names>LD</given-names></name>
<name name-style="western"><surname>Tony Cai</surname><given-names>T</given-names></name>
<name name-style="western"><surname>DasGupta</surname><given-names>A</given-names></name>
</person-group>             <year>2001</year>             <article-title>Interval estimation for a binomial proportion.</article-title>             <source>Stati Sci</source>             <volume>16</volume>             <fpage>101</fpage>             <lpage>133</lpage>          </element-citation></ref>
<ref id="pcbi.1000131-Meyer1"><label>60</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Meyer</surname><given-names>PL</given-names></name>
</person-group>             <year>1965</year>             <source>Introductory Probability and Statistical Applications</source>             <publisher-loc>Reading (Massachusetts)</publisher-loc>             <publisher-name>Addison-Wesley.</publisher-name>             <fpage> 287 p</fpage>          </element-citation></ref>
<ref id="pcbi.1000131-LaCamera2"><label>61</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>La Camera</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Pritchett</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>Richmond</surname><given-names>BJ</given-names></name>
</person-group>             <year>2005</year>             <source>Modeling the behavior of monkeys in reward schedules with context-dependent and adaptive reinforcement learning. Abstract Viewer/Itinerary Planner</source>             <publisher-loc>Washington, DC</publisher-loc>             <publisher-name>Society for Neuroscience</publisher-name>             <comment>Program No. 1000-7 2005</comment>          </element-citation></ref>
<ref id="pcbi.1000131-Pan1"><label>62</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pan</surname><given-names>WX</given-names></name>
<name name-style="western"><surname>Schmidt</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Wickens</surname><given-names>JR</given-names></name>
<name name-style="western"><surname>Hyland</surname><given-names>BI</given-names></name>
</person-group>             <year>2005</year>             <article-title>Dopamine cells respond to predicted events during classical conditioning: evidence for eligibility traces in the reward-learning network.</article-title>             <source>J Neurosci</source>             <volume>25</volume>             <fpage>6235</fpage>             <lpage>6242</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>