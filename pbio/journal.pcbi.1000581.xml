<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-0151R4</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000581</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Comparative Sequence Analysis</subject><subject>Computational Biology/Evolutionary Modeling</subject><subject>Computer Science/Applications</subject><subject>Mathematics/Statistics</subject><subject>Virology/Immunodeficiency Viruses</subject></subj-group></article-categories><title-group><article-title>An Evolutionary Model-Based Algorithm for Accurate Phylogenetic Breakpoint Mapping and Subtype Prediction in HIV-1</article-title><alt-title alt-title-type="running-head">Evolutionary Algorithm for HIV Subtype Prediction</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Kosakovsky Pond</surname><given-names>Sergei L.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Posada</surname><given-names>David</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Stawiski</surname><given-names>Eric</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Chappey</surname><given-names>Colombe</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Poon</surname><given-names>Art F.Y.</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hughes</surname><given-names>Gareth</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Fearnhill</surname><given-names>Esther</given-names></name><xref ref-type="aff" rid="aff6"><sup>6</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Gravenor</surname><given-names>Mike B.</given-names></name><xref ref-type="aff" rid="aff7"><sup>7</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Leigh Brown</surname><given-names>Andrew J.</given-names></name><xref ref-type="aff" rid="aff8"><sup>8</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Frost</surname><given-names>Simon D.W.</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff9"><sup>9</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Medicine, University of California San Diego, La Jolla, California, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Biochemistry, Genetics and Immunology, University of Vigo, Vigo, Spain</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Monogram Biosciences, South San Francisco, California, United States of America</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Department of Pathology, University of California San Diego, La Jolla, California, United States of America</addr-line>       </aff><aff id="aff5"><label>5</label><addr-line>Health Protection Agency East of England Regional Epidemiology Unit, Cambridge, United Kingdom</addr-line>       </aff><aff id="aff6"><label>6</label><addr-line>Medical Research Council Clinical Trials Unit, London, United Kingdom</addr-line>       </aff><aff id="aff7"><label>7</label><addr-line>School of Medicine, University of Swansea, Swansea, United Kingdom</addr-line>       </aff><aff id="aff8"><label>8</label><addr-line>Institute of Evolutionary Biology, University of Edinburgh, Edinburgh, United Kingdom</addr-line>       </aff><aff id="aff9"><label>9</label><addr-line>Department of Veterinary Medicine, University of Cambridge, Cambridge, United Kingdom</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Fraser</surname><given-names>Christophe</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Imperial College London, United Kingdom</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">spond@ucsd.edu</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: SLKP DP AJLB SDWF. Performed the experiments: SLKP. Analyzed the data: SLKP DP ES GH. Contributed reagents/materials/analysis tools: SLKP DP ES CC AFYP GH EF MBG SDWF. Wrote the paper: SLKP DP AFYP SDWF.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>11</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>26</day><month>11</month><year>2009</year></pub-date><volume>5</volume><issue>11</issue><elocation-id>e1000581</elocation-id><history>
<date date-type="received"><day>10</day><month>2</month><year>2009</year></date>
<date date-type="accepted"><day>28</day><month>10</month><year>2009</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2009</copyright-year><copyright-holder>Kosakovsky Pond et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Genetically diverse pathogens (such as Human Immunodeficiency virus type 1, HIV-1) are frequently stratified into phylogenetically or immunologically defined subtypes for classification purposes. Computational identification of such subtypes is helpful in surveillance, epidemiological analysis and detection of novel variants, e.g., circulating recombinant forms in HIV-1. A number of conceptually and technically different techniques have been proposed for determining the subtype of a query sequence, but there is not a universally optimal approach. We present a model-based phylogenetic method for automatically subtyping an HIV-1 (or other viral or bacterial) sequence, mapping the location of breakpoints and assigning parental sequences in recombinant strains as well as computing confidence levels for the inferred quantities. Our Subtype Classification Using Evolutionary ALgorithms (SCUEAL) procedure is shown to perform very well in a variety of simulation scenarios, runs in parallel when multiple sequences are being screened, and matches or exceeds the performance of existing approaches on typical empirical cases. We applied SCUEAL to all available polymerase (pol) sequences from two large databases, the Stanford Drug Resistance database and the UK HIV Drug Resistance Database. Comparing with subtypes which had previously been assigned revealed that a minor but substantial (≈5%) fraction of pure subtype sequences may in fact be within- or inter-subtype recombinants. A free implementation of SCUEAL is provided as a module for the HyPhy package and the Datamonkey web server. Our method is especially useful when an accurate automatic classification of an unknown strain is desired, and is positioned to complement and extend faster but less accurate methods. Given the increasingly frequent use of HIV subtype information in studies focusing on the effect of subtype on treatment, clinical outcome, pathogenicity and vaccine design, the importance of accurate, robust and extensible subtyping procedures is clear.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>There are nine different subtypes of the main group of HIV-1, each originating as a distinct subepidemic of HIV-1. The distribution of subtypes is often unique to a given geographic region of the world and constitutes a useful epidemiological and surveillance resource. The effects of viral subtype on disease progression, treatment outcome and vaccine design are being actively researched, and the importance of accurate subtyping procedures is clear. In HIV-1, subtype assignment is complicated by frequent recombination among co-circulating strains, creating new genetic mosaics or recombinant forms: 43 have been characterized to date, and many more likely exist. We present an automated phylogenetic method (SCUEAL) to accurately characterize both simple and complex HIV-1 mosaics. Using computer simulations and biological data we demonstrate that SCUEAL performs very well under various conditions, especially when some of the existing classification procedures fail. Furthermore, we show that a small, but noticeable proportion of subtype characterization stored in public databases may be incomplete or incorrect. The computational technique introduced here should provide a much more accurate characterization of HIV-1 strains, especially novel recombinants, and lead to new insights into molecular history, epidemiology and geographical distribution of the virus.</p>
</abstract><funding-group><funding-statement>This research was supported by the Joint DMS/NIGMS Mathematical Biology Initiative through Grant NSF-0714991, the National Institutes of Health (AI43638, AI47745, and AI57167), the University of California Universitywide AIDS Research Program (grant number IS02-SD-701), a University of California, San Diego Center for AIDS Research/NIAID Developmental Award to SDWF and SLKP (AI36214), and grant BIO2007-61411 (Spanish Ministry of Science) to DP. SDWF is supported in part by a Royal Society Wolfson Research Merit Award. This work was facilitated by IBM Deep Computing. GH was supported by the Medical Research Council. EF and the UK HIV Drug Resistance Database are partly funded by the UK Department of Health. Additional support is provided by Boehringer Ingelheim, Bristol-Myers Squibb, Gilead, Tibotec (a division of Janssen-Cilag Ltd) and Roche. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="21"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Many RNA viruses have evolutionary rates that hover near the mutational speed limit <xref ref-type="bibr" rid="pcbi.1000581-Zeldovich1">[1]</xref> permitting them to generate incredible sequence variability among circulating strains in a relatively short time <xref ref-type="bibr" rid="pcbi.1000581-Gaschen1">[2]</xref>. Bottleneck events, such as viral introduction to new populations or species of hosts, followed by diversification in the new environments, create easily discernible substructures within individual viral species. For HIV-1, this substructure consists of 3 groups (M, N and O), 9 “pure” subtypes (A–D, F, G, H, J and K) of group M, and sub-subtypes (e.g. A1, A2, F1 and F2), defined entirely on the basis of phylogenetic clustering and monophyly of sequences from a given subtype in relation to all other subtypes <xref ref-type="bibr" rid="pcbi.1000581-Robertson1">[3]</xref>. The geographic distribution of HIV-1 subtypes is decidedly non-random <xref ref-type="bibr" rid="pcbi.1000581-Hemelaar1">[4]</xref>; for example <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e001" xlink:type="simple"/></inline-formula> of HIV-1 circulating in North America is classified as subtype B, whereas the same subtype accounts for only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e002" xlink:type="simple"/></inline-formula> of infections in Southern Africa. This observation immediately suggests that reliable determination of viral subtypes is highly informative for epidemiological surveillance. HIV-1 diversity is sufficiently high to permit further stratification of subtypes by the geographic region of origin, yielding further clues to epidemiological history of modern epidemics <xref ref-type="bibr" rid="pcbi.1000581-Gifford1">[5]</xref>. However, because several established subtypes often circulate concurrently in one host population <xref ref-type="bibr" rid="pcbi.1000581-Papathanasopoulos1">[6]</xref>, and because HIV has exceptionally high recombination rates <xref ref-type="bibr" rid="pcbi.1000581-Rhodes1">[7]</xref>, novel recombinant forms are frequently generated. If at least three epidemiologically unrelated viral isolates show an identical novel recombination structure in terms of the pure subtype reference strains, a new circulating recombinant form (CRF) is added to the compendium maintained by the Los Alamos National Laboratory (<ext-link ext-link-type="uri" xlink:href="http://www.hiv.lanl.gov/content/sequence/HIV/CRFs/CRFs.html" xlink:type="simple">http://www.hiv.lanl.gov/content/sequence/HIV/CRFs/CRFs.html</ext-link>). There are currently 43 described CRFs, differing widely in their prevalence, range and the complexity of the recombinant structure. However, the relationship between CRFs and their parental strains is not always clear cut; for example CRF02, originally thought to have been the product of recombination between subtype A and subtype G strains could in fact be ancestral to subtype G strains <xref ref-type="bibr" rid="pcbi.1000581-Abecasis1">[8]</xref>.</p>
<p>A number of computational approaches have been proposed to classify viral strains into subtypes or to describe recombinant strains as mosaics of subtypes. Unlike with methods geared towards a more general problem of detecting recombination from sequence alignments <xref ref-type="bibr" rid="pcbi.1000581-Posada1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000581-Posada2">[10]</xref>, there are no comprehensive comparative benchmarking studies for subtyping methods in the literature. The methods can be conceptually categorized by whether or not they explicitly use a phylogeny to assign subtypes, whether or not they require a multiple sequence alignment and by the degree of automation that they afford: full, partial or none. The de facto standard for accurately describing novel recombinant forms has changed little since its introduction in <xref ref-type="bibr" rid="pcbi.1000581-Salminen1">[11]</xref>. It consists of an initial sliding-window phylogenetic bootstrap (bootscanning) analysis of the query sequence aligned against the set reference strain used to generate the set of apparent breakpoints which are then confirmed by detailed phylogenetic analysis of putative non-recombinant fragments. This is a powerful and intuitively attractive, but laborious method–the entire process frequently lacks automation (e.g. <xref ref-type="bibr" rid="pcbi.1000581-Triques1">[12]</xref>,<xref ref-type="bibr" rid="pcbi.1000581-GomezCarrillo1">[13]</xref>, but see <xref ref-type="bibr" rid="pcbi.1000581-Martin1">[14]</xref>), has many user-adjustable parameters, such as the alignment procedure, reference sequences, sliding window size and stride, precise location of breakpoints, phylogenetic bootstrap values that are selected subjectively, and can lead to ambiguous or not fully resolved results (e.g. <xref ref-type="bibr" rid="pcbi.1000581-Gao1">[15]</xref> vs <xref ref-type="bibr" rid="pcbi.1000581-Paraskevis1">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1000581-Casado1">[17]</xref>). Perhaps the single greatest criticism of the bootscan/phylogeny approach may be that two alternative characterizations of the same query sequence are not assigned a statistically meaningful goodness-of-fit score, and hence cannot be objectively compared.</p>
<p>On the other end of the spectrum are fully automated techniques, including a sophisticated phylogeny and alignment based REGA v2.0 tool <xref ref-type="bibr" rid="pcbi.1000581-deOliveira1">[18]</xref>, henceforth referred to as REGA, and several phylogeny and/or alignment free tools: a classification method based on subtype-specific distributions of short nucleotide strings <xref ref-type="bibr" rid="pcbi.1000581-Wu1">[19]</xref>; a sliding window analysis based on BLAST scores of the query and each of the subtype reference sequences <xref ref-type="bibr" rid="pcbi.1000581-Rozanov1">[20]</xref>; a phylogeny free position/subtype specific amino-acid subtype analyzer (STAR) which assigns each residue in a multiple sequence alignment a subtype discriminating score <xref ref-type="bibr" rid="pcbi.1000581-Myers1">[21]</xref>; and a probabilistic jumping alignment approach jpHMM <xref ref-type="bibr" rid="pcbi.1000581-Schultz1">[22]</xref> that uses a hidden Markov model to align the query to the locally most similar reference sequence.</p>
<p>Alignment and/or phylogeny free techniques are fundamentally approximate in nature, because the <italic>definition</italic> of a subtype is rooted in the concept of a clade and hence is intrinsically phylogenetic in nature. Approximate approaches have been developed to address the very practical issues of automation, speed and the fact that a phylogenetic definition of a subtype becomes complicated when reference strains are permitted to have recombined themselves. On the other hand, these methods often produce conflicting or indeterminate results, may be unable to classify novel or rare mosaics, and frequently disagree with manually performed phylogenetic analyses, causing considerable consternation among practitioners and clinicians (e.g. <xref ref-type="bibr" rid="pcbi.1000581-Loveday1">[23]</xref>–<xref ref-type="bibr" rid="pcbi.1000581-Holguin1">[25]</xref>). A recent comparative study of three automated subtyping tools on 10537 partial polymerase sequences from the UK <xref ref-type="bibr" rid="pcbi.1000581-Gifford2">[26]</xref> found that methods agreed poorly (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e003" xlink:type="simple"/></inline-formula>) for subtypes other than B,C and H, failed to classify <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e004" xlink:type="simple"/></inline-formula> of sequences and returned discordant results in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e005" xlink:type="simple"/></inline-formula> cases of divergent sequences, which were revealed to be unusual recombinant forms by a laborious follow-up analysis.</p>
<p>Hence, we are convinced that it is necessary to adopt a phylogeny-based method for accurate subtyping. Statistical evidence of phylogenetic incongruence, i.e. instances when different regions of an alignment support discordant phylogenies, is a hallmark of recombination <xref ref-type="bibr" rid="pcbi.1000581-Posada3">[27]</xref>. A statistically robust phylogenetic approach to detecting phylogenetic incongruence in a multiple sequence alignment has been proposed in the Bayesian framework by <xref ref-type="bibr" rid="pcbi.1000581-Minin1">[28]</xref> and in the information theory framework by <xref ref-type="bibr" rid="pcbi.1000581-KosakovskyPond1">[29]</xref>. These methods are powerful but too slow to be practical for large reference phylogenies needed to describe extant HIV diversity–for example our HIV-1 polymerase reference alignment contains nearly 300 sequences. Because subtyping is a particular case of more general recombination analyses, we devised an algorithm whose run time is effectively constant in the size of the reference alignment. Importantly, this is achieved without collapsing the alignment into a collection of attributes, such as substring frequencies or position-specific alignment scoring matrices, as is frequently done by phylogeny-free methods.</p>
<p>Our design objectives for SCUEAL included: (i) a completely automatic method, which returns a predicted subtype, existing CRF or a recombinant form mapped in terms of the former; (ii) every estimated quantity including the recombinant structure, the location of each breakpoint and the assignment of a parental/sister lineage should be estimated with statistical confidence/support values to allow an objective evaluation of how robust the estimates are; (iii) the algorithm runs sufficiently quickly (2–3 CPU minutes to screen a simple sequence, and up to a CPU hour for highly complex mosaics) to permit the screening of thousands of sequences on a computer cluster. We implemented an easy-to-use web interface to SCUEAL running on the datamonkey.org <xref ref-type="bibr" rid="pcbi.1000581-KosakovskyPond2">[30]</xref> platform); (iv) accepts large reference sequence alignments which can be easily updated when new references (e.g. CRF) become available. SCUEAL is conceptually based on the more general method (GARD) for detecting recombination in multiple sequence alignments presented in <xref ref-type="bibr" rid="pcbi.1000581-KosakovskyPond1">[29]</xref>, but is an entirely new algorithm and software implementation. Whereas GARD is primarily concerned with detecting the number and location of breakpoints in an alignment, and not in identifying recombinant lineages and clades (which is critically important for subtyping), SCUEAL explicitly searches for both using a significantly modified and improved genetic algorithm. Also, by screening a single sequence against a fixed reference alignment, SCUEAL gains significant power and an order of magnitude speed-up over GARD, which assumes that any sequence can be a recombinant.</p>
<p>We assessed various performance metrics of SCUEAL using an extensive set of simulations and biological data; to our knowledge no other method has been subjected to a comparably exhaustive benchmarking study.</p>
</sec><sec id="s2">
<title>Methods</title>
<p>Consider an alignment of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e006" xlink:type="simple"/></inline-formula> reference sequences on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e007" xlink:type="simple"/></inline-formula> bases, each labeled with its subtype. We require that none of the reference sequences have undergone detectable recombination, hence their evolutionary history can be accurately described with a single phylogenetic tree, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e008" xlink:type="simple"/></inline-formula>; note that this framework can be used to handle recombinant reference sequences represented as multiple partial sequences (see below). In this manuscript, the evolution of extant sequences from their most recent common ancestor along the phylogenetic tree is described by the general time reversible model of nucleotide substitution <xref ref-type="bibr" rid="pcbi.1000581-Tavar1">[31]</xref> and site-to-site rate variation is accommodated via a 3-bin general discrete distribution (e.g. <xref ref-type="bibr" rid="pcbi.1000581-KosakovskyPond3">[32]</xref>). Substitution models for codon and protein evolution can be easily accommodated by the testing framework; however because they incur considerable additional computational expense they are not considered here.</p>
<sec id="s2a">
<title>Phylogenetic mosaics</title>
<p>The objective of our methodology is to enable automatic identification of the number (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e009" xlink:type="simple"/></inline-formula>) and location of any recombination breakpoints in a query sequence, that is assumed to be homologous and alignable to the reference sequences, together with the identities of sister lineages in each non-recombinant fragment. An example of such an assignment can be found in Figure 0: the query sequence (labeled Q) has two recombination breakpoints, at nucleotide positions 750 and 1250. Over the first 750 nucleotides, the query sequence shares a common ancestor with reference sequence 1, over the next 500 nucleotides - with reference sequence 7, and over the last 750 nucleotides - with sequence 1 again. Such an arrangement might arise if the query is the result of a recombination event between the ancestors of sequences 1 and 7.</p>
<p>The term ‘mosaic’ has come to encompass the combination of breakpoint placements and lineage assignments in HIV-1 subtyping literature. The number of possible mosaics with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e010" xlink:type="simple"/></inline-formula> breakpoints is proportional to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e011" xlink:type="simple"/></inline-formula>, hence it is not practical to undertake an exhaustive search of all possible mosaics, unless <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e012" xlink:type="simple"/></inline-formula> is small (<italic>i.e.</italic> B = 1 or B = 2).</p>
</sec><sec id="s2b">
<title>Model fitting and fitness evaluation</title>
<p>In order to select credible mosaics from the set of all possible models we must be able to compute a goodness-of-fit value for each proposed mosaic.</p>
<p>We begin by computing the maximum likelihood based score for each model. First, we fit the reference tree to the reference alignment using standard phylogenetic maximum likelihood. Assuming unrooted bifurcating trees, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e013" xlink:type="simple"/></inline-formula> branch length estimates and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e014" xlink:type="simple"/></inline-formula> substitution model estimates, such as relative nucleotide substitution rates, base frequencies and site-to-site rate variation parameters will be obtained. These <italic>baseline</italic> parameters are estimated once for a reference alignment, and can be reused if multiple query sequences are run against the same reference.</p>
<p>For computational efficiency we fix all substitution model parameters at their baseline values instead of re-estimating them for each mosaic. If the reference alignment is sufficiently large, the effect of one additional sequence on substitution model parameters will be insignificant. Furthermore, we posit that grafting the query sequence onto a branch in the reference tree will only affect three branch lengths for each non-recombinant fragment. For instance, for the mosaic shown in <xref ref-type="fig" rid="pcbi-1000581-g001">Figure 1</xref> the algorithm will estimate three branch lengths for the first segment (those leading to 1 and Q as well as the branch leading to their MRCA), three branch lengths of the second segment (Q,7 and the MRCA of Q and 7) and three branch lengths for the third segment (1,Q and the MRCA of 1 and Q). All other branch lengths are maintained at the values derived from the reference tree. Similar approximations are routinely made in phylogenetic inference (e.g. <xref ref-type="bibr" rid="pcbi.1000581-Guindon1">[33]</xref>,<xref ref-type="bibr" rid="pcbi.1000581-Stamatakis1">[34]</xref>). The fitness of mosaic <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e015" xlink:type="simple"/></inline-formula> is evaluated using Schwartz's Bayesian Information Criterion (BIC, <xref ref-type="bibr" rid="pcbi.1000581-Schwarz1">[35]</xref>), with the number of model parameters for a mosaic with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e016" xlink:type="simple"/></inline-formula> breakpoints given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e017" xlink:type="simple"/></inline-formula>: <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e018" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e019" xlink:type="simple"/></inline-formula> is the likelihood of the data under the mosaic model maximized over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e020" xlink:type="simple"/></inline-formula> parameters and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e021" xlink:type="simple"/></inline-formula> is the number of sites in the alignment, used to approximate the number of independent observations. A lower BIC score indicates a better fit to the data. BIC was selected because it had the best power/accuracy performance in our initial simulation studies, comparing AIC <xref ref-type="bibr" rid="pcbi.1000581-Akaike1">[36]</xref>, AIC-c <xref ref-type="bibr" rid="pcbi.1000581-Sugiura1">[37]</xref> and BIC (results not shown).</p>
<fig id="pcbi-1000581-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.g001</object-id><label>Figure 1</label><caption>
<title>An example to illustrate the concepts of a mosaic and its binary encoding upon which the genetic algorithm operates.</title>
<p>Panel A: a phylogenetic breakpoint/lineage model which “threads” a query sequence (labeled ‘Q’) onto the reference tree with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e022" xlink:type="simple"/></inline-formula> sequences. Panel B: the example individual model (mosaic) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e023" xlink:type="simple"/></inline-formula> is encoded by a 36-bit binary vector on 5 fragments (genes)–2 for placing the breakpoints (Gray-binary encoded) and 3 for identifying sister lineages, binary encoded using the post-order traversal scheme shown in the reference tree of Panel A.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.g001" xlink:type="simple"/></fig>
<p>The immediate benefit of allowing only three branch lengths to vary per segment is that the computational cost for fitting individual mosaics no longer depends on the size of the reference alignment, at least when time-reversible models of substitutions are used. This observation has been exploited in many phylogenetic applications and is discussed in detail for example in <xref ref-type="bibr" rid="pcbi.1000581-Yang1">[38]</xref>. Briefly, as a part of standard phylogenetic likelihood evaluation <xref ref-type="bibr" rid="pcbi.1000581-Felsenstein1">[39]</xref>, each node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e024" xlink:type="simple"/></inline-formula> (both tips and internal nodes) of the phylogenetic tree is populated with a vector of partial probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e025" xlink:type="simple"/></inline-formula> that containts the probability of observing the subtree rooted at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e026" xlink:type="simple"/></inline-formula> if the character (i.e. a nucleotide in our case) at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e027" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e028" xlink:type="simple"/></inline-formula>. To evaluate the likelihood of the entire tree (for a single site), the following expression is computed at the root: <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e029" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e030" xlink:type="simple"/></inline-formula> iterates over the children of the root node, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e031" xlink:type="simple"/></inline-formula> gives the stationary frequency of nucleotide <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e032" xlink:type="simple"/></inline-formula> (estimated by counts from the data) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e033" xlink:type="simple"/></inline-formula> denotes the probability of substituting nucleotide <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e034" xlink:type="simple"/></inline-formula> with nucleotide <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e035" xlink:type="simple"/></inline-formula> along the branch that ends in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e036" xlink:type="simple"/></inline-formula>. The critical observation to be made here is that if nothing but the lengths of branch emanating from the root node change during optimization (i.e. only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e037" xlink:type="simple"/></inline-formula> changes), then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e038" xlink:type="simple"/></inline-formula> do not have to be recomputed, reducing the complexity optimization problem to that on a star tree with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e039" xlink:type="simple"/></inline-formula>( = 3 for standard phylogenetic applications) tips.</p>
<p>For time-reversible models, the root can be arbitrarily placed on any branch of the phylogenetic tree. Hence, we can reroot the tree at the point where the query sequence is grafted and reduce the computational complexity as explained above. To do this, in addition to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e040" xlink:type="simple"/></inline-formula>, we also precompute (for every node except the root and only once per analysis) the collection of vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e041" xlink:type="simple"/></inline-formula>, that contain conditional probabilities of the <italic>parent</italic> node of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e042" xlink:type="simple"/></inline-formula>, when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e043" xlink:type="simple"/></inline-formula> is considered as the root node. For every non-root node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e044" xlink:type="simple"/></inline-formula> the likelihood of the bifurcating reference tree can be equivalently expressed as: <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e045" xlink:type="simple"/></disp-formula>The last expression is simply the likelihood of the tree rerooted exactly at node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e046" xlink:type="simple"/></inline-formula>. Grafting the query sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e047" xlink:type="simple"/></inline-formula> onto the branch leading to node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e048" xlink:type="simple"/></inline-formula> will create three branches: the branch leading to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e049" xlink:type="simple"/></inline-formula>, the branch leading to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e050" xlink:type="simple"/></inline-formula> and the branch leading from the ancestor of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e051" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e052" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e053" xlink:type="simple"/></inline-formula>) to the parent of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e054" xlink:type="simple"/></inline-formula> For the first partition in <xref ref-type="fig" rid="pcbi-1000581-g001">Figure 1</xref>, for example, the single branch of the reference tree leading to tip 1, was transformed into three branches by grafting Q–the branch leading to tip <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e055" xlink:type="simple"/></inline-formula>, the branch leading to query <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e056" xlink:type="simple"/></inline-formula> and the branch leading to the parent of 1 and Q. Consequently, the likelihood of the tree with the query sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e057" xlink:type="simple"/></inline-formula> grafted onto the branch leading to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e058" xlink:type="simple"/></inline-formula> can be computed as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e059" xlink:type="simple"/></disp-formula>This expression is the likelihood of a three-taxon star tree with the root at node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e060" xlink:type="simple"/></inline-formula> (sum over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e061" xlink:type="simple"/></inline-formula>) and three children: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e062" xlink:type="simple"/></inline-formula> (sum over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e063" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e064" xlink:type="simple"/></inline-formula> (sum over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e065" xlink:type="simple"/></inline-formula>) and the parent of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e066" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e067" xlink:type="simple"/></inline-formula> (sum over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e068" xlink:type="simple"/></inline-formula>). Note that because <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e069" xlink:type="simple"/></inline-formula> is always a tip, the conditional probabilities in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e070" xlink:type="simple"/></inline-formula> are trivial to compute, and it follows that the cost of evaluating the likelihood of the reference tree with a grafted tip (given precomputed quantities, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e071" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e072" xlink:type="simple"/></inline-formula>–done only once for the reference alignment, independent of the query sequence) is equivalent to the three-taxon case.</p>
</sec><sec id="s2c">
<title>Mosaic selection using a genetic algorithm</title>
<p>We use an aggressive genetic algorithm (GA) with elitist selection that is based on the CHC procedure <xref ref-type="bibr" rid="pcbi.1000581-Eshelman1">[40]</xref> to rapidly search a combinatorially large space of possible mosaics for a fixed number of breakpoints. The algorithm operates on a population of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e073" xlink:type="simple"/></inline-formula> binary strings (individuals), each representing an encoded mosaic with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e074" xlink:type="simple"/></inline-formula> breakpoints. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e075" xlink:type="simple"/></inline-formula> fragments (‘genes’) are needed to encode the mosaic - <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e076" xlink:type="simple"/></inline-formula> for the location of breakpoints, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e077" xlink:type="simple"/></inline-formula> for lineage assignments on each non-recombinant fragment (see <xref ref-type="fig" rid="pcbi-1000581-g001">Figure 1</xref>). We restrict breakpoints to only occur at variable alignment sites as was done previously in our GARD method <xref ref-type="bibr" rid="pcbi.1000581-KosakovskyPond1">[29]</xref>. In addition, the breakpoints must be a minimum distance (denoted as a tunable parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e078" xlink:type="simple"/></inline-formula>) away from each other or from the ends of the sequence; this simply reflects the fact that a minimum number of sites is necessary to resolve the phylogenetic placement of a sequence.</p>
<p>The placement of the query sequence in the reference tree is represented by the binary-encoded position of the branch in post-order traversal (cf. <xref ref-type="fig" rid="pcbi-1000581-g001">Figure 1</xref>). Breakpoint positions are represented using Gray binary coding, to ensure any two consecutive locations differ by a single bit, and hence can be reached by a single mutation <xref ref-type="bibr" rid="pcbi.1000581-Goldberg1">[41]</xref>. For example, to change the position of a breakpoint from 7 (traditional binary 0111, Gray code 0100) to 8 (1000; 1100) it would be necessary to mutate all four bits in the traditional binary code, but only one bit in the Gray code. Breakpoints are always maintained in left-to-right ordering and any operations that disrupt this order are followed by resorting of breakpoints left to right (equivalent to gene order rearrangement).</p>
<p>Starting with the initial population of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e079" xlink:type="simple"/></inline-formula> mosaics, the algorithm proceeds as follows (refer to <xref ref-type="fig" rid="pcbi-1000581-g002">Figures 2</xref> and <xref ref-type="fig" rid="pcbi-1000581-g003">3</xref> for a graphical description of the procedure). First, fitness of each mosaic <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e080" xlink:type="simple"/></inline-formula> (Eq. 1) is computed and the mosiac is assigned a mating probability inversely proportional to its fitness rank <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e081" xlink:type="simple"/></inline-formula>. The most fit mosaic reproduces becomes a parent for an offspring with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e082" xlink:type="simple"/></inline-formula>, while the least fit mosaic–with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e083" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e084" xlink:type="simple"/></inline-formula>. The algorithm maintains a global lookup table (implemented as an AVL tree keyed on the bit string of the mosaic) to ensure that the maximum likelihood fitting of any given mosaic is carried out only once. Second, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e085" xlink:type="simple"/></inline-formula> pairs of parents are selected based on their mating probabilities to generate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e086" xlink:type="simple"/></inline-formula> offspring. The mating operator uses free recombination, where every bit of the child has a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e087" xlink:type="simple"/></inline-formula> probability of coming from either parent; this ensures rapid mixing of mosaic features. With probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e088" xlink:type="simple"/></inline-formula> the algorithm also induces genomic rearrangement in the offspring mosaic, by swapping adjacent fragments around a randomly selected breakpoint. Third, the existing population is augmented with the offspring, resulting in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e089" xlink:type="simple"/></inline-formula> mosaics, ranked according to BIC and filtered to include <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e090" xlink:type="simple"/></inline-formula> top-scoring mosaics in the next generation; this induces a strong selective pressure to remove mosaics with low fitness scores.</p>
<fig id="pcbi-1000581-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.g002</object-id><label>Figure 2</label><caption>
<title>Algorithmic flowchart of SCUEAL.</title>
<p>Algorithmic logic underlying SCUEAL; see <xref ref-type="fig" rid="pcbi-1000581-g003">Figure 3</xref> for a description of the genetic algorithm itself. Refer to the text for more detailed descriptions of individual procedures and parameter definitions.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.g002" xlink:type="simple"/></fig><fig id="pcbi-1000581-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.g003</object-id><label>Figure 3</label><caption>
<title>Algorithmic flowchart of the genetic algorithm in SCUEAL.</title>
<p>A flowchart description of the genetic algorithm applied to a given starting population and controlled by input parameter values. Refer to the text and <xref ref-type="fig" rid="pcbi-1000581-g002">Figure 2</xref> for further description of individual steps and parameter definitions.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.g003" xlink:type="simple"/></fig>
<p>Mutational processes are available to re-introduce genetic variability into inbred populations. First, hypermutation is triggered if the diversity of the population, measured as the relative difference between in BIC between the best and worst fitting mosaic (i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e091" xlink:type="simple"/></inline-formula>), drops below a fixed threshold, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e092" xlink:type="simple"/></inline-formula>. All mosaics in the population, except the best fitting one, have their bits toggled with fixed probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e093" xlink:type="simple"/></inline-formula>. Second, if no generation-to-generation BIC improvement was observed for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e094" xlink:type="simple"/></inline-formula> consecutive generations, local mutation is carried out. The bottom two thirds of the population are replaced by mutated versions of the best fitting mosaic, generated by selecting a fragment to mutate at random and providing local coverage for that fragment. Local coverage is introduced by first drawing a random branch if the gene encodes a lineage, or a random position within <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e095" xlink:type="simple"/></inline-formula> bp of the current position for a breakpoint location gene, and then generating <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e096" xlink:type="simple"/></inline-formula> consecutive values for the gene. For example, if the new random position for the breakpoint is drawn as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e097" xlink:type="simple"/></inline-formula>, then mosaics with the breakpoint at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e098" xlink:type="simple"/></inline-formula> will be placed in the population.</p>
<p>The algorithm terminates if no BIC improvement has been obtained for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e099" xlink:type="simple"/></inline-formula> consecutive generations. The number of breakpoints is increased from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e100" xlink:type="simple"/></inline-formula> until no BIC improvement has been found for two consecutive values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e101" xlink:type="simple"/></inline-formula>. The case of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e102" xlink:type="simple"/></inline-formula> is solved exhaustively; the initial population for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e103" xlink:type="simple"/></inline-formula> is generated randomly; the initial population for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e104" xlink:type="simple"/></inline-formula> is seeded by the best mosaic from the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e105" xlink:type="simple"/></inline-formula> run, with a randomly placed additional breakpoint and lineage assignment. For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e106" xlink:type="simple"/></inline-formula>, we also add a step down procedure to confirm that the improvement in score obtained by incrementing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e107" xlink:type="simple"/></inline-formula> was due to a genuine additional breakpoint and not due to premature termination at the previous step (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e108" xlink:type="simple"/></inline-formula>); to do so, we generate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e109" xlink:type="simple"/></inline-formula> mosaics by randomly removing a breakpoint from the best-fitting mosaic with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e110" xlink:type="simple"/></inline-formula> breakpoints (randomly assigning the query sequence to one of the two parental lineages, and introducing mutations at rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e111" xlink:type="simple"/></inline-formula>) and run an iteration of the GA with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e112" xlink:type="simple"/></inline-formula> points using the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e113" xlink:type="simple"/></inline-formula> mosaics as a starting population. If the follow-up GA with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e114" xlink:type="simple"/></inline-formula> breakpoints matches or improves upon the score with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e115" xlink:type="simple"/></inline-formula> breakpoints, then the next phase of the GA is run on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e116" xlink:type="simple"/></inline-formula> breakpoints, otherwise, the next phase operates on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e117" xlink:type="simple"/></inline-formula> breakpoints. To further enhance algorithm robustness, we evolve three independent populations (from completely random starting mosaics) to convergence, compose the mixed population by taking the top-scoring third of each population and evolve the combined population until convergence.</p>
<p>While it is possible to use the GA to also search for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e118" xlink:type="simple"/></inline-formula> directly (e.g. by duplicating or removing fragments), we found that the incremental search for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e119" xlink:type="simple"/></inline-formula> with the step-down verification stage has better convergence properties and runs considerably faster.</p>
<p>Algorithm parameter values selected for the analyses in this paper are as follows: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e120" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e121" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e122" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e123" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e124" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e125" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e126" xlink:type="simple"/></inline-formula>. parameter values were selected based on our previous experience with GARD <xref ref-type="bibr" rid="pcbi.1000581-KosakovskyPond1">[29]</xref>, and further adjusted based on how well the algorithm performed on simulated data and run time.</p>
</sec><sec id="s2d">
<title>Result processing</title>
<p>After a GA run, BIC scores and mosaics from a large (typically <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e127" xlink:type="simple"/></inline-formula>) number (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e128" xlink:type="simple"/></inline-formula>) of fitted mosaics is available for processing. Instead of basing inference on the single best fitting mosaic, we adopt a multi-model inference procedure, whereby the contribution of each fitted mosaic is weighted based on its goodness-of-fit. Given the BIC score (fitness) of the best mosaic from the run, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e129" xlink:type="simple"/></inline-formula>, for every mosaic <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e130" xlink:type="simple"/></inline-formula>, we compute its Akaike weight, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e131" xlink:type="simple"/></inline-formula> defined in terms of its BIC score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e132" xlink:type="simple"/></inline-formula> as <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e133" xlink:type="simple"/></disp-formula>The constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e134" xlink:type="simple"/></inline-formula> is chosen so that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e135" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e136" xlink:type="simple"/></inline-formula> can be interpreted as the probability that the <italic>i</italic>-th mosaic provides the best fit to the data <xref ref-type="bibr" rid="pcbi.1000581-Burnham1">[42]</xref>.</p>
<p>We report the following quantities for each GA mosaic screen</p>
<list list-type="order"><list-item>
<p>The structure of the best fitting mosaic, represented as the location of inferred breakpoints and lineage assignments, e.g. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e137" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>The model averaged support for the mosaic structure of the best model. This is defined as the sum of Akaike weights of all those models which agree with the best fitting model in everything except the coordinates of the breakpoints. E.g. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e138" xlink:type="simple"/></inline-formula> is consistent with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e139" xlink:type="simple"/></inline-formula>, but <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e140" xlink:type="simple"/></inline-formula> is not. High values (e.g. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e141" xlink:type="simple"/></inline-formula>) of the model averaged support indicate that there are no other discordant mosaic structures that explain the evolutionary history of the query sequence.</p>
</list-item><list-item>
<p>Model-averaged support for the locations of the breakpoints, that is computed by tabulating the model-averaged probability of observing a breakpoint at a given site over all sites in the alignment, based on the normalized Akaike weights of the models whose mosaics are consistent with the best fitting model. For instance the model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e142" xlink:type="simple"/></inline-formula> will contribute its Akaike weight to sites <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e143" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e144" xlink:type="simple"/></inline-formula>. To determine <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e145" xlink:type="simple"/></inline-formula> confidence intervals for each breakpoint from the best fitting model, we build symmetric intervals around each breakpoint that contain at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e146" xlink:type="simple"/></inline-formula> the support. Note that confidence intervals are not uniquely defined in this setting (for example, we could extend the interval in the direction where the site immediately outside the current interval has greater model averaged support of a breakpoint), and we adopt symmetric intervals for simplicity.</p>
</list-item></list>
</sec><sec id="s2e">
<title>Automated sequence alignment</title>
<p>The genetic algorithm requires the alignment of reference sequences with the query sequence as input that can be generated by any of the multiple sequence alignment programs. However because the reference alignment does not depend on the query sequence, it does not need to be re-aligned every time a new sequence is queried against it and the following simple heuristic can be employed. We preprocess the reference alignment by fitting an evolutionary model (nucleotide or codon for coding alignments) using the reference tree and inferring the root sequence for the reference tree using the joint maximum likelihood of <xref ref-type="bibr" rid="pcbi.1000581-Pupko1">[43]</xref>. Gaps in the alignment are treated as missing data from the purposes of root sequence reconstruction. In particular, the root sequence will not contain any gaps when reconstructed under standard nucleotide evolutionary models, because no sites in the reference alignment consist solely of gaps. This inferred root sequence can then be directly aligned with the query sequence using the Needleman-Wunsch dynamic programming algorithm <xref ref-type="bibr" rid="pcbi.1000581-Needleman1">[44]</xref>, with affine gap costs and zero prefix and suffix gap costs on nucleotide or translated amino-acid data, and then up-converted into a multiple sequence alignment with all reference sequences consistent with the reference alignment. When aligning HIV or other viral sequences, organism specific scoring matrices <xref ref-type="bibr" rid="pcbi.1000581-Nickle1">[45]</xref> can be used to improve alignment quality. In addition to being very fast, this alignment heuristic is unlikely to introduce difficult-to-quantify biases common in progressive alignment approaches (e.g. <xref ref-type="bibr" rid="pcbi.1000581-Wong1">[46]</xref>).</p>
</sec><sec id="s2f">
<title>Reference alignment generation</title>
<p>We adopted a step-wise procedure of HIV-1 reference alignment construction. Beginning with a seed alignment of three sequences (e.g. one each from A, B and C for HIV-1), screened by GARD to ensure that the seed sequences are not recombinant, we augment the seed alignment from a collection of potential subtype reference sequences downloaded from the LANL HIV database. If a database sequence is labelled as pure subtype in LANL, is at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e147" xlink:type="simple"/></inline-formula> distant (Tamura-Nei 93 <xref ref-type="bibr" rid="pcbi.1000581-Tamura1">[47]</xref> genetic distance) from every sequence in the seed alignment, and is reported as being non-recombinant by SCUEAL, then it is added to the reference alignment. The process repeats until the collection of potential reference sequences has been exhausted.</p>
<p>Reference sequences for circulating recombinant forms (CRFs) are processed in a similar way, except that if the CRF sequence has <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e148" xlink:type="simple"/></inline-formula> breakpoints in the region for which the reference alignment is being built (e.g. the pol gene), then it is represented by up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e149" xlink:type="simple"/></inline-formula> sequences in the final alignment. For instance, a 1000 bp sequence with the mosaic structure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e150" xlink:type="simple"/></inline-formula>, will be represented by a sequence that clusters with the A clade and contains bases from 1–199 and 700–1000 and gaps between positions 200 and 699, and a complementary sequence (bases between 200 and 699, gaps elsewhere) that clusters with clade B. This is necessary to correctly place a recombinant sequence on the single reference tree. The GA disallows mosaic structures in which a query sequence would cluster with artificially introduced gaps in CRF component sequences. SCUEAL will correctly interpret clustering with the constituent sequences as clustering with the single CRF for the purposes of subsequent inference.</p>
<p>The resulting full length HIV-1 reference polymerase alignment comprised <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e151" xlink:type="simple"/></inline-formula> sequences encompassing the “pure” subtypes (including <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e152" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e153" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e154" xlink:type="simple"/></inline-formula> clades), SIVcpz and a reference strain from each of the CRFs (except CRF26,CRF38 and CRF41–43) for which no full length pol reference sequences were present in the database) listed in the Los Alamos HIV CRF compendium (<ext-link ext-link-type="uri" xlink:href="http://www.hiv.lanl.gov/content/sequence/HIV/CRFs/CRFs.html" xlink:type="simple">http://www.hiv.lanl.gov/content/sequence/HIV/CRFs/CRFs.html</ext-link> accessed December 17th, 2008). We note that this procedure is not guaranteed to avoid mislabeling recombinant sequences as pure subtypes. Indeed if the recombinant strain is added to the reference before the parental strains, the latter will be incorrectly described as recombinants. For example, the original classification of subtype G sequences as a “pure” subtype is likely an artifact of the order in which A,G and CRF02 sequences were added to public databases <xref ref-type="bibr" rid="pcbi.1000581-Abecasis1">[8]</xref>. Nonetheless, our procedure is undoubtedly an improvement over simply taking a collection of database sequences as a reference and assuming that they can be adequately described by a single tree; this practice should be avoided.</p>
</sec><sec id="s2g">
<title>Simulated data</title>
<p>Each of the simulation scenarios summarized in <xref ref-type="table" rid="pcbi-1000581-t001">Table 1</xref> comprised <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e155" xlink:type="simple"/></inline-formula> parametrically generated alignments, using the general time reversible model of nucleotide substitution <xref ref-type="bibr" rid="pcbi.1000581-Tavar1">[31]</xref>, equilibrium base frequencies of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e156" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e157" xlink:type="simple"/></inline-formula>, substitution rate parameters of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e158" xlink:type="simple"/></inline-formula>, and site-to-site rate heterogeneity modeled a G+I distribution with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e159" xlink:type="simple"/></inline-formula> of invariant sites and the shape parameter of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e160" xlink:type="simple"/></inline-formula>; all these parameters were selected to resemble values found in biological alignments of HIV-1. Recombination was introduced by generating alignments of fixed lengths along different tree topologies and then concatenating them; the spacing between breakpoints, tree topologies used and recombinant lineages are shown in the middle pane of each each figure; simulated data are available at <ext-link ext-link-type="uri" xlink:href="http://www.hyphy.org/pubs/SCUEAL/" xlink:type="simple">http://www.hyphy.org/pubs/SCUEAL/</ext-link>. The trees were constrained to conform to the assumptions of the model–only one sequence (the query) was permitted to migrate from lineage to lineage. The correct tree and reference sequences were used for screening. The evolutionary scenarios used for simulation were designed to cover a range of recombination patterns with respect to the distribution of breakpoints, the level of sequence divergence and how far in the tree the recombinant sequence moved (close, medium or divergent). A subset of scenarios dealt with ‘ancient’ recombination events, i.e. lineage assignments to internal tree branches (for HIV-1 this would be equivalent to the recombination event predating the proliferation of the subtype). Several examples were specifically selected to mimic different divergence levels of HIV-1. An example of one recombination scenario is given in <xref ref-type="fig" rid="pcbi-1000581-g004">Figure 4</xref> and the number and location of breakpoints can be found in <xref ref-type="table" rid="pcbi-1000581-t001">Table 1</xref>. The collection of analogous figures for every simulation scenario can be found in <xref ref-type="supplementary-material" rid="pcbi.1000581.s001">Protocol S1</xref>.</p>
<fig id="pcbi-1000581-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.g004</object-id><label>Figure 4</label><caption>
<title>A simulation scenario example.</title>
<p>One of the simulation scenarios used to asses our detection method with the results over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e161" xlink:type="simple"/></inline-formula> replicates (scenario 5/close in <xref ref-type="table" rid="pcbi-1000581-t002">Table 2</xref>). The query sequence (2) was simulated to move from reference lineage 1 to reference lineage 3 every 400 bp as shown in the tree panel. The clustering chart depicts model and replicate averaged support for assigning the query sequence to a particular reference lineage, as estimated by the genetic algorithm over 100 simulated data replicates, whereas black impulse plots indicate the inferred placements of breakpoints. The y-axis does not reach <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e162" xlink:type="simple"/></inline-formula> because each replicate contributes the model averaged support for the best inferred mosaic type–a value that is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e163" xlink:type="simple"/></inline-formula>; the upper limit on the y-axis is, therefore, the mean (over replicates) model-averaged support for the best-fitting mosaic (0.92 in this case).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.g004" xlink:type="simple"/></fig><table-wrap id="pcbi-1000581-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.t001</object-id><label>Table 1</label><caption>
<title>SCUEAL performance on simulated data.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000581-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Scenario</td>
<td align="left" colspan="1" rowspan="1">Seq., sites</td>
<td align="left" colspan="1" rowspan="1">Type/Distance</td>
<td align="center" colspan="2" rowspan="1">Inferred Mosaics</td>
<td align="center" colspan="2" rowspan="1">Breakpoints</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Type</td>
<td align="left" colspan="1" rowspan="1">Count (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e164" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1">Simulated Location, Parents</td>
<td align="left" colspan="1" rowspan="1">Inferred. #/Median Location Std.Dev. (95% Range)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">1. No recombination</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e165" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">N/A</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">100 (100)</td>
<td align="left" colspan="1" rowspan="1">None</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">2. An evident breakpoint</td>
<td align="left" colspan="1" rowspan="1">8,2000</td>
<td align="left" colspan="1" rowspan="1">Close (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e166" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">100 (88)</td>
<td align="left" colspan="1" rowspan="1">1000 bp 1∶3</td>
<td align="left" colspan="1" rowspan="1">100/990,18.99 (931,1015)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Divergent (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e167" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">100 (75)</td>
<td align="left" colspan="1" rowspan="1">1000 bp 1∶7</td>
<td align="left" colspan="1" rowspan="1">100/1000, 5.04 (987,1007)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Ancient (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e168" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">92 (86)</td>
<td align="left" colspan="1" rowspan="1">1000 bp 1/2∶5/6</td>
<td align="left" colspan="1" rowspan="1">96/992,16.62 (947,1017)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">7 (6)</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">1 (1)</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">3. Two evident breakpoints</td>
<td align="left" colspan="1" rowspan="1">8,2000</td>
<td align="left" colspan="1" rowspan="1">Close (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e169" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">98 (96)</td>
<td align="left" colspan="1" rowspan="1">750 bp 1∶3</td>
<td align="left" colspan="1" rowspan="1">99/749,10.23 (720,769)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e170" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">1 (1)</td>
<td align="left" colspan="1" rowspan="1">1250 bp 7∶1</td>
<td align="left" colspan="1" rowspan="1">99/1251,15.26 (1201,1273)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">1 (1)</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e171" xlink:type="simple"/></inline-formula> Divergent</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">95 (89)</td>
<td align="left" colspan="1" rowspan="1">750 bp 1∶7</td>
<td align="left" colspan="1" rowspan="1">98/751, 5.61 (735,762)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e172" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">5 (5)</td>
<td align="left" colspan="1" rowspan="1">1250 bp 7∶1</td>
<td align="left" colspan="1" rowspan="1">100/1251, 5.92 (1237,1265)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Ancient (69%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">91 (90)</td>
<td align="left" colspan="1" rowspan="1">750 bp 1/2∶5/6</td>
<td align="left" colspan="1" rowspan="1">96/749,22.37 (697,824)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">69%</td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">5 (4)</td>
<td align="left" colspan="1" rowspan="1">1250 bp 5/6∶1/2</td>
<td align="left" colspan="1" rowspan="1">96/1250,20.09 (1192,1283)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">4 (4)</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">4. Two close breakpoints</td>
<td align="left" colspan="1" rowspan="1">8, 2000</td>
<td align="left" colspan="1" rowspan="1">Close (42%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">22 (21)</td>
<td align="left" colspan="1" rowspan="1">950 bp 1∶3</td>
<td align="left" colspan="1" rowspan="1">22/948,15.35 (888,960)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1">Subset</td>
<td align="left" colspan="1" rowspan="1">77 (76)</td>
<td align="left" colspan="1" rowspan="1">1050 bp 3∶1</td>
<td align="left" colspan="1" rowspan="1">22/1050, 7.77 (1031,1066)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">1 (1)</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Divergent (102%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">73 (69)</td>
<td align="left" colspan="1" rowspan="1">950 bp 1∶7</td>
<td align="left" colspan="1" rowspan="1">73/951, 6.40 (932,960)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1">Subset</td>
<td align="left" colspan="1" rowspan="1">11 (0)</td>
<td align="left" colspan="1" rowspan="1">1050 bp 7∶1</td>
<td align="left" colspan="1" rowspan="1">73/1051, 5.79 (1038,1068)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">16 (15)</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">5. Four breakpoints</td>
<td align="left" colspan="1" rowspan="1">8, 2000</td>
<td align="left" colspan="1" rowspan="1">Close (42%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">96 (96)</td>
<td align="left" colspan="1" rowspan="1">400 bp 1∶3</td>
<td align="left" colspan="1" rowspan="1">98/399,16.86 (342,428)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">3 (2)</td>
<td align="left" colspan="1" rowspan="1">800 bp 3∶1</td>
<td align="left" colspan="1" rowspan="1">97/803, 9.63 (784,837)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">1 (1)</td>
<td align="left" colspan="1" rowspan="1">1200 bp 1∶3</td>
<td align="left" colspan="1" rowspan="1">98/1200,11.34 (1161,1220)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1600 bp 3∶1</td>
<td align="left" colspan="1" rowspan="1">99/1602,12.24 (1570,1634)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Divergent (102%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">96 (96)</td>
<td align="left" colspan="1" rowspan="1">400 bp 1∶7</td>
<td align="left" colspan="1" rowspan="1">98/401, 5.08 (389,413)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">2 (2)</td>
<td align="left" colspan="1" rowspan="1">800 bp 7∶1</td>
<td align="left" colspan="1" rowspan="1">99/802, 5.00 (785,809)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">2 (2)</td>
<td align="left" colspan="1" rowspan="1">1200 bp 1∶7</td>
<td align="left" colspan="1" rowspan="1">99/1201, 5.73 (1188,1211)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1600 bp 7∶1</td>
<td align="left" colspan="1" rowspan="1">99/1602, 4.19 (1594,1613)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Ancient (69%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">54 (54)</td>
<td align="left" colspan="1" rowspan="1">400 bp 1/2∶5/6</td>
<td align="left" colspan="1" rowspan="1">65/402,14.88 (357,434)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">69%</td>
<td align="left" colspan="1" rowspan="1">Subset</td>
<td align="left" colspan="1" rowspan="1">22 (3)</td>
<td align="left" colspan="1" rowspan="1">800 bp 5/6∶1/2</td>
<td align="left" colspan="1" rowspan="1">67/802,15.74 (745,826)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">69%</td>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">20 (19)</td>
<td align="left" colspan="1" rowspan="1">1200 bp 1/2∶5/6</td>
<td align="left" colspan="1" rowspan="1">69/1201,19.67 (1169,1270)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">69%</td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">4 (4)</td>
<td align="left" colspan="1" rowspan="1">1600 bp 5/6∶1/2</td>
<td align="left" colspan="1" rowspan="1">69/1602,18.04 (1550,1627)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">6. Nine breakpoints</td>
<td align="left" colspan="1" rowspan="1">8,2000</td>
<td align="left" colspan="1" rowspan="1">Close (42%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">30 (30)</td>
<td align="left" colspan="1" rowspan="1">200 bp 1∶3</td>
<td align="left" colspan="1" rowspan="1">68/201,11.72 (176,235)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1">Subset</td>
<td align="left" colspan="1" rowspan="1">13 (2)</td>
<td align="left" colspan="1" rowspan="1">400 bp 3∶1</td>
<td align="left" colspan="1" rowspan="1">62/403, 8.18 (391,420))</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">9 (7)</td>
<td align="left" colspan="1" rowspan="1">600 bp 1∶3</td>
<td align="left" colspan="1" rowspan="1">68/601,14.69 (561,634)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">48 (25)</td>
<td align="left" colspan="1" rowspan="1">800 bp 3∶1</td>
<td align="left" colspan="1" rowspan="1">71/803,10.72 (783,838)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1000 bp 1∶3</td>
<td align="left" colspan="1" rowspan="1">71/1001,10.95 (974,1021)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1200 bp 3∶1</td>
<td align="left" colspan="1" rowspan="1">72/1203,13.14 (1177,1253)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1400 bp 1∶3</td>
<td align="left" colspan="1" rowspan="1">75/1401,11.45 (1364,1414)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1600 bp 3∶1</td>
<td align="left" colspan="1" rowspan="1">73/1602, 8.52 (1582,1626)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1800 bp 1∶3</td>
<td align="left" colspan="1" rowspan="1">77/1801,13.40 (1746,1816)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Divergent</td>
<td align="left" colspan="1" rowspan="1">(102%) Correct</td>
<td align="left" colspan="1" rowspan="1">64 (64)</td>
<td align="left" colspan="1" rowspan="1">200 bp 1∶7</td>
<td align="left" colspan="1" rowspan="1">96/202, 4.87 (188,212)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">9(7)</td>
<td align="left" colspan="1" rowspan="1">400 bp 7∶1</td>
<td align="left" colspan="1" rowspan="1">94/402, 7.98 (386,415)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">27 (25)</td>
<td align="left" colspan="1" rowspan="1">600 bp 1∶7</td>
<td align="left" colspan="1" rowspan="1">93/601, 5.95 (591,625)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">800 bp 7∶1</td>
<td align="left" colspan="1" rowspan="1">93/802, 5.37 (790,815)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1000 bp 1∶7</td>
<td align="left" colspan="1" rowspan="1">92/1002, 5.35 (985,1015)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1200 bp 7∶1</td>
<td align="left" colspan="1" rowspan="1">93/1202, 6.17 (1191,1228)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1400 bp 1∶7</td>
<td align="left" colspan="1" rowspan="1">93/1402, 4.52 (1391,1411)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1600 bp 7∶1</td>
<td align="left" colspan="1" rowspan="1">93/1602, 4.05 (1594,1612)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">102%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1800 bp 1∶7</td>
<td align="left" colspan="1" rowspan="1">89/1802, 3.80 (1794,1814)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">7. Complex mosaic</td>
<td align="left" colspan="1" rowspan="1">8, 2000</td>
<td align="left" colspan="1" rowspan="1">42%</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">88 (86)</td>
<td align="left" colspan="1" rowspan="1">400 bp 1∶2</td>
<td align="left" colspan="1" rowspan="1">94/400,11.89 (375,440)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">12%</td>
<td align="left" colspan="1" rowspan="1">Subset</td>
<td align="left" colspan="1" rowspan="1">3 (1)</td>
<td align="left" colspan="1" rowspan="1">800 bp 3∶4</td>
<td align="left" colspan="1" rowspan="1">89/793,28.29 (737,853)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">108%</td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">5 (4)</td>
<td align="left" colspan="1" rowspan="1">1200 bp 4∶7</td>
<td align="left" colspan="1" rowspan="1">98/1202, 4.02 (1192,1211)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">48%</td>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">4(4)</td>
<td align="left" colspan="1" rowspan="1">1600 bp 7∶5</td>
<td align="left" colspan="1" rowspan="1">98/1601.5,11.08 (1586,1640)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">8. HIV within-patient</td>
<td align="left" colspan="1" rowspan="1">13, 2000</td>
<td align="left" colspan="1" rowspan="1">Close (0.4%)</td>
<td align="left" colspan="1" rowspan="1">Subset</td>
<td align="left" colspan="1" rowspan="1">96 (96)</td>
<td align="left" colspan="1" rowspan="1">750 bp 1∶2</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">0.4%</td>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">4 (4)</td>
<td align="left" colspan="1" rowspan="1">1250 bp 2∶1</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Divergent (2.3%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">38 (36)</td>
<td align="left" colspan="1" rowspan="1">750 bp 1∶9</td>
<td align="left" colspan="1" rowspan="1">38/741.5,34.62 (666,790)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">2.3%</td>
<td align="left" colspan="1" rowspan="1">Subset</td>
<td align="left" colspan="1" rowspan="1">4 (2)</td>
<td align="left" colspan="1" rowspan="1">1250 bp 9∶1</td>
<td align="left" colspan="1" rowspan="1">39/1256,36.11 (1156,1326)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">1 (1)</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">57 (55)</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">9. HIV within-patient</td>
<td align="left" colspan="1" rowspan="1">13, 2000</td>
<td align="left" colspan="1" rowspan="1">Close (0.4%)</td>
<td align="left" colspan="1" rowspan="1">Subset</td>
<td align="left" colspan="1" rowspan="1">97 (97)</td>
<td align="left" colspan="1" rowspan="1">400 bp 1∶2</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">0.4%</td>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">3 (3)</td>
<td align="left" colspan="1" rowspan="1">800 bp 2∶1</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">0.4%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1200 bp 1∶2</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">0.4%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1650 bp 2∶1</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Divergent (2.9%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">7 (7)</td>
<td align="left" colspan="1" rowspan="1">400 bp 1∶9</td>
<td align="left" colspan="1" rowspan="1">16/391.5,32.00 (349,475)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">2.9%</td>
<td align="left" colspan="1" rowspan="1">Subset</td>
<td align="left" colspan="1" rowspan="1">2 (1)</td>
<td align="left" colspan="1" rowspan="1">800 bp 9∶1</td>
<td align="left" colspan="1" rowspan="1">21/808,39.70 (730,868)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">2.9%</td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">1 (0)</td>
<td align="left" colspan="1" rowspan="1">1200 bp 1∶9</td>
<td align="left" colspan="1" rowspan="1">22/1202.5,42.90 (1118,1284)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">2.9%</td>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">90 (70)</td>
<td align="left" colspan="1" rowspan="1">1600 bp 9∶1</td>
<td align="left" colspan="1" rowspan="1">20/1610.5,32.87 (1551,1676)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">10. HIV within-subtype</td>
<td align="left" colspan="1" rowspan="1">5, 2000</td>
<td align="left" colspan="1" rowspan="1">4%</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">16 (16)</td>
<td align="left" colspan="1" rowspan="1">400 bp 1∶2</td>
<td align="left" colspan="1" rowspan="1">30/402,31.53 (317,460)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">4%</td>
<td align="left" colspan="1" rowspan="1">Subset</td>
<td align="left" colspan="1" rowspan="1">80 (77)</td>
<td align="left" colspan="1" rowspan="1">800 bp 2∶1</td>
<td align="left" colspan="1" rowspan="1">21/802,35.56 (716,885)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">4%</td>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">4 (4)</td>
<td align="left" colspan="1" rowspan="1">1200 bp 1∶2</td>
<td align="left" colspan="1" rowspan="1">20/1209,30.18 (1151,1266)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">4%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1600 bp 2∶1</td>
<td align="left" colspan="1" rowspan="1">35/1589,38.80 (1506,1689)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">11. HIV mosaic</td>
<td align="left" colspan="1" rowspan="1">12, 10000</td>
<td align="left" colspan="1" rowspan="1">Close (12%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">95 (95)</td>
<td align="left" colspan="1" rowspan="1">2000 bp 1∶2</td>
<td align="left" colspan="1" rowspan="1">94/2002.5,30.11 (1925,2092)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">12%</td>
<td align="left" colspan="1" rowspan="1">Subset</td>
<td align="left" colspan="1" rowspan="1">1 (0)</td>
<td align="left" colspan="1" rowspan="1">4000 bp 2∶1</td>
<td align="left" colspan="1" rowspan="1">93/4000,29.62 (3928,4085)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">12%</td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">2(2)</td>
<td align="left" colspan="1" rowspan="1">6000 bp 1∶2</td>
<td align="left" colspan="1" rowspan="1">94/6002.5,26.99 (5941,6067)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">12%</td>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">2(2)</td>
<td align="left" colspan="1" rowspan="1">8000 bp 2∶1</td>
<td align="left" colspan="1" rowspan="1">92/7996,33.39 (7929,8078)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Intermediate (12%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">100 (100)</td>
<td align="left" colspan="1" rowspan="1">2000 bp 1∶6</td>
<td align="left" colspan="1" rowspan="1">100/2000,17.40 (1959,2042)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">12%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">4000 bp 6∶1</td>
<td align="left" colspan="1" rowspan="1">99/4003,21.62 (3964,4053)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">12%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">6000 bp 1∶6</td>
<td align="left" colspan="1" rowspan="1">100/6001,18.61 (5952,6040))</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">12%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">8000 bp 6∶1</td>
<td align="left" colspan="1" rowspan="1">99/8004,16.88 (7968,8046)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Divergent (11.5%)</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">99 (97)</td>
<td align="left" colspan="1" rowspan="1">2000 bp 1∶9</td>
<td align="left" colspan="1" rowspan="1">99/2002,20.92 (1956,2043)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">11.5%</td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">1 (1)</td>
<td align="left" colspan="1" rowspan="1">4000 bp 9∶1</td>
<td align="left" colspan="1" rowspan="1">100/4002.5,19.85 (3945,4056)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">11.5%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">6000 bp 1∶9</td>
<td align="left" colspan="1" rowspan="1">98/6000,21.89 (5937,6042)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">11.5%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">8000 bp 9∶1</td>
<td align="left" colspan="1" rowspan="1">99/7999,22.49 (7953,8070)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Complex 12%</td>
<td align="left" colspan="1" rowspan="1">Correct</td>
<td align="left" colspan="1" rowspan="1">94 (93)</td>
<td align="left" colspan="1" rowspan="1">2000 bp 1∶2</td>
<td align="left" colspan="1" rowspan="1">96/2003,27.61 (1940,2070)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">14%</td>
<td align="left" colspan="1" rowspan="1">Superset</td>
<td align="left" colspan="1" rowspan="1">5 (4)</td>
<td align="left" colspan="1" rowspan="1">4000 bp 2∶6</td>
<td align="left" colspan="1" rowspan="1">99/4000,18.14 (3969,4053)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">12%</td>
<td align="left" colspan="1" rowspan="1">M/M</td>
<td align="left" colspan="1" rowspan="1">1 (1)</td>
<td align="left" colspan="1" rowspan="1">6000 bp 6∶1</td>
<td align="left" colspan="1" rowspan="1">100/6003,20.35 (5959,6068)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">11.5%</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">8000 bp 1∶9</td>
<td align="left" colspan="1" rowspan="1">97/8000,21.34 (7947,8062)</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label/><p><bold>Scenario provides a brief description a given simulation scenario. Seq., sites</bold> lists the number and length of simulated sequences. <bold>Type/distance</bold> classifies the simulation scenario by type and mean divergence between parental strains, measured as the total branch length (expected number of substitutions/site 100%) between the strains. <bold>Inferred Mosaics</bold> tabulates the number of cases (and the number of those that matched or bested the BIC score of the correct model) that fell into each of the classification categories (see main text for further detail). Correct: the simulated mosaic was recovered; superset: the simulated mosaic and superfluous breakpoints were inferred; subset: a partial correct mosaic was recapitulated (some breakpoints missing); and M/M - the inferred mosaic was a mismatch with the generating one. <bold>Breakpoints</bold> enumerates the location of each simulated breakpoint and its parental lineages, the number of times the breakpoint was recovered by SCUEAL, and the median (2.5%–97.5% range) of the distribution of distances between the simulated and inferred breakpoints.</p></fn></table-wrap-foot></table-wrap>
<p>Because mosaic analyses are frequently used in HIV-1 research, we also generated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e173" xlink:type="simple"/></inline-formula> sequences by concatenating fragments from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e174" xlink:type="simple"/></inline-formula> sequences of partial HIV-1 polymerase genes, spanning all of protease up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e175" xlink:type="simple"/></inline-formula> nucleotides of reverse transcriptase obtained from the Los Alamos HIV sequence database (<ext-link ext-link-type="uri" xlink:href="http://hiv.lanl.gov" xlink:type="simple">http://hiv.lanl.gov</ext-link>). Each sequence was pre-screened using SCUEAL to ensure that only pure subtypes formed the base of this simulation. The number of fragments for each simulated sequence was drawn from a +1-shifted Poisson distribution with the mean of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e176" xlink:type="simple"/></inline-formula> breakpoints/alignment; this guaranteed at least one breakpoint per alignment. The length of each fragment as a proportion of the total alignment length of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e177" xlink:type="simple"/></inline-formula> was determined using the stick-breaking process with beta distribution parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e178" xlink:type="simple"/></inline-formula>. A <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e179" xlink:type="simple"/></inline-formula> value was drawn from the beta distribution and the longest remaining fragment was split in that proportion to introduce each consecutive breakpoint into a sequence; if the shorter of the two resulting fragments was not at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e180" xlink:type="simple"/></inline-formula> long, the proportion was rejected and the process was repeated with a new beta-distributed proportion. Simulated sequences were screened against an alignment of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e181" xlink:type="simple"/></inline-formula> pure subtype reference sequences culled from our <italic>pol</italic> reference set (no CRFs were included in the reference). Note that because reference sequences were not identical to those used to generate the mosaics, this scenario simulated both recombination and mutational divergence found in HIV-1.</p>
</sec><sec id="s2h">
<title>A Surveillance Study</title>
<p>A bread-and-butter application of HIV subtyping algorithms is to characterize the subtype distribution in a cohort of patients or a geographic region and make inferences about the history and dynamics of HIV infection. We selected one of such recently published studies <xref ref-type="bibr" rid="pcbi.1000581-Salemi1">[48]</xref> that subtyped <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e182" xlink:type="simple"/></inline-formula> partial pol sequences from Bulgaria using REGA and found a diverse composition of subtypes, including three unassigned sequences.</p>
</sec><sec id="s2i">
<title>Database sequences</title>
<p>We downloaded all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e183" xlink:type="simple"/></inline-formula> available reverse transcriptase sequences from the Stanford HIV drug resistance database, an ad hoc global sequence collection, that were (<ext-link ext-link-type="uri" xlink:href="http://hivdb.stanford.edu/" xlink:type="simple">http://hivdb.stanford.edu/</ext-link>) annotated with one of the nine pure subtypes (or sub-subtypes e.g. A1), CRF01 (AE), CRF02 (AG) and applied SCUEAL to estimate what proportion of sequences may be unclassified inter-subtype recombinants, and the frequency of within-subtype recombination. The algorithm that currently performs database sequences annotation uses a neighbor joining phylogeny of the query sequence aligned to 100 reference sequences (spanning all group M subtypes and CRF01-CRF19) to assign the query sequence the subtype of the enclosing or nearest clade (R. Shafer, personal communication; also see <xref ref-type="bibr" rid="pcbi.1000581-Bennett1">[49]</xref>).</p>
<p>A total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e184" xlink:type="simple"/></inline-formula> partial polymerase sequences from HIV infected individuals in the UK were available through the UK HIV Drug Resistance Database (<ext-link ext-link-type="uri" xlink:href="http://www.hivrdb.org" xlink:type="simple">www.hivrdb.org</ext-link>). This database is a central repository for HIV sequence data obtained in the course of routine clinical care and was established as a collaboration of 14 clinical centers and virology laboratories and 3 academic departments. The database acts as a resource for clinical, virological and epidemiological studies for the collaborating centres. The sequences released for analysis with SCUEAL had been fully anonymized and delinked and previously processed using REGA and Stanford <xref ref-type="bibr" rid="pcbi.1000581-Bennett1">[49]</xref> subtyping algorithms (Hughes GJ, Fearnhill E, Dunn D, et al. Molecular phylodynamics of the heterosexual HIV epidemic in the United Kingdom. PLoS Pathog. in process). We sought to compare the performance of SCUEAL to the other tools on a real-world task of automatic subtype classification of this complex sequence dataset assembled for population surveillance of a national HIV epidemic of significant subtype complexity.</p>
</sec><sec id="s2j">
<title>Implementation</title>
<p>The algorithms presented in this paper have been implemented as a collection of HyPhy <xref ref-type="bibr" rid="pcbi.1000581-KosakovskyPond4">[50]</xref> batch language scripts and can be dowloaded from <ext-link ext-link-type="uri" xlink:href="http://www.hyphy.org/pubs/SCUEAL/" xlink:type="simple">http://www.hyphy.org/pubs/SCUEAL/</ext-link>. A README file explaining code usage and providing examples is included with the download. Simulated, biological and reference alignments and SCUEAL results can be downloaded from the same URL. An easy to use implementation of SCUEAL to screen up to 500 (this limit will be increased over time) sequences using a computer cluster maintained by the authors is available as a part of the Datamonkey <ext-link ext-link-type="uri" xlink:href="http://www.datamonkey.org/" xlink:type="simple">http://www.datamonkey.org/</ext-link> web server. Run times of SCUEAL on HIV-1 pol sequences depend on the complexity of the inferred mosaic type and take anywhere from 1–2 minutes for a pure subtype to up to an hour for a complex mosaic subtype on a desktop computer. Multiple query sequences can be screened in parallel if an MPI distributed environment is available. The screen of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e185" xlink:type="simple"/></inline-formula> partial pol sequences from the UK drug resistance database took approximately 18 hours using 200 processors of an MPI cluster, translating to an average of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e186" xlink:type="simple"/></inline-formula> CPU/minutes per sequence.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Simulation results</title>
<sec id="s3a1">
<title>Parametric simulations</title>
<p>Parametric simulations tend to generate copious amounts of raw data (e.g. see <xref ref-type="supplementary-material" rid="pcbi.1000581.s001">Protocol S1</xref>) that are difficult to interpret directly, hence we generated a compact representation of simulation scenarios and results in <xref ref-type="table" rid="pcbi-1000581-t001">Table 1</xref> using a several descriptive metrics.</p>
<p>First and foremost one is interested how often is the correct mosaic (the order and identity of lineage assignments, e.g. 1-3-1-3-1 for the scenario in <xref ref-type="fig" rid="pcbi-1000581-g004">Figure 4</xref>) is recovered; this metric does not evaluate the accuracy of breakpoint placement. When an incorrect mosaic is reported, three types of classification errors are possible.</p>
<list list-type="bullet"><list-item>
<p>A <bold>subset</bold> of the correct mosaic is recovered, i.e. some of the breakpoints are missed. For instance 1-3-1 would be a subset of the 1-3-1-3-1 mosaic. The method behaves conservatively in this case.</p>
</list-item><list-item>
<p>A <bold>superset</bold> of the correct mosaic is recovered, i.e. in addition to all of the correct breakpoints spurious ones are inferred. For instance 1-3-1-3-1-1 would be a superset of the 1-3-1-3-1 mosaic. The method is overly liberal in this case.</p>
</list-item><list-item>
<p>When the recovered mosaic is neither the subset nor the superset of the correct one, a <bold>mismatch</bold> has occurred. For example, 1-4-1-3-1 would be mismatched with 1-3-1-3-1. The method is inconsistent in this situation.</p>
</list-item></list>
<p>When a classification error occurs, it can either be because the GA failed to find the optimal solution, or because there is insufficient signal (due to small fragment length, low divergence etc) to infer the correct mosaic using the BIC criterion. The error due to the GA is an undesirable outcome, and we categorize each of the misclassified replicates into those which had worse fitness than the correct model (GA error) and those which had better fitness that the correct models (insufficient signal).</p>
<p>Second, we tabulated how often each of the correct breakpoints was recovered, and collected descriptive statistics about where the inferred locations were placed. A breakpoint was inferred ‘recovered’ if SCUEAL inferred at least one breakpoint, and the nearest inferred breakpoint to the simulated position involved correct parental lineages. For instance, a simulated A to B breakpoint at nucleotide 1000 would be counted as recovered in the inferred mosaic <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e187" xlink:type="simple"/></inline-formula>, but not in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e188" xlink:type="simple"/></inline-formula>.</p>
<p>The method has a very low rate of false positives correctly classifying 100/100 cases in Scenario 1 (no recombination). SCUEAL shows excellent operating characteristics when sequence divergence between parental strains and/or non-recombinant fragment length is sufficiently high; these two parameters approximate information content in the sequence. In scenarios 2,3,5 (except ancient recombination), 7 and notably, 11 (designed to simulate a typical HIV-1 CRF situation), SCUEAL assigned <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e189" xlink:type="simple"/></inline-formula> or more of replicates to the correct mosaic type; each of the breakpoints was also mapped very accurately with the standard deviation on the order of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e190" xlink:type="simple"/></inline-formula>. A very short non-recombinant fragment in scenario 4 (100 bp) made it difficult to detect recombination reliably; increasing the distance between parental strains dramatically increased the power, however from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e191" xlink:type="simple"/></inline-formula> for close parents to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e192" xlink:type="simple"/></inline-formula> for distant parents.</p>
<p>Ancestral recombination involving interior branches in the tree (e.g. see <xref ref-type="supplementary-material" rid="pcbi.1000581.s001">Protocol S1</xref>) also complicated mosaic classification because of weaker phylogenetic signal. In all three scenarios with the ancient option (2,3 and 5), the proportion of correctly identified mosaics was lower than for extant parental lineage situation, but in most missed (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e193" xlink:type="simple"/></inline-formula>) cases the assigned mosaic had a better BIC score - suggesting lack of phylogenetic signal as the main source of error. Overall, the ability of SCUEAL to accurately describe over 50% of mosaics due to ancient recombination is encouraging as many HIV-1 CRFs appear to be the result of ancient recombination, i.e. they fail to unambiguously cluster with any of the reference “pure” subtypes.</p>
<p>The complex pattern in scenario 6, where 10 non-recombinant fragments of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e194" xlink:type="simple"/></inline-formula> each, made concurrent detection of all 9 breakpoints difficult (30% for close parents and 64% for divergent strains). However, this was mostly due to one or two missed breakpoints–the average accuracy of mapping each individual breakpoint was high (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e195" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e196" xlink:type="simple"/></inline-formula>), with no single breakpoint (e.g. in the middle of the alignment vs close to one of the ends) missed at an abnormally high frequency. Scenario 6/close, is the only scenario (many short fragments with relatively close parental strains) where the majority <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e197" xlink:type="simple"/></inline-formula> of classification errors were due to premature GA termination; this could be improved by adjusting GA parameters at the expense of longer run times.</p>
<p>SCUEAL could not detect recombination in sequences with very low (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e198" xlink:type="simple"/></inline-formula>) parental strain divergence (scenarios 8/close and 9/close), and had low (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e199" xlink:type="simple"/></inline-formula>) power in breakpoint detection for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e200" xlink:type="simple"/></inline-formula> divergent strains in scenarios 8/divergent, 9/divergent and 10, overwhelmingly due to lack of phylogenetic signal and not to premature GA convergence.</p>
<p>Each individual detected breakpoint was on average very close (standard deviations in the range of 5–20 bp) to a true breakpoint, confirming that SCUEAL produces a high-resolution breakpoint map.</p>
</sec><sec id="s3a2">
<title>HIV pol simulations</title>
<p>Using the classification defined in the previous section, SCUEAL performance on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e201" xlink:type="simple"/></inline-formula> simulated data sets can be summarized thus: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e202" xlink:type="simple"/></inline-formula> correct sequence mosaics (i.e. each breakpoint and correct lineage) were recovered, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e203" xlink:type="simple"/></inline-formula> recovered mosaics were supersets (extra breakpoints) of the correct type, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e204" xlink:type="simple"/></inline-formula> - subsets (missed breakpoints) of the correct type, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e205" xlink:type="simple"/></inline-formula> - mismatched. Overall, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e206" xlink:type="simple"/></inline-formula> of the replicates were correctly identified as recombinant strains. Of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e207" xlink:type="simple"/></inline-formula> simulated breakpoints, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e208" xlink:type="simple"/></inline-formula> were recovered correctly, with a median distance between the simulated and the inferred breakpoint of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e209" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e210" xlink:type="simple"/></inline-formula> for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e211" xlink:type="simple"/></inline-formula> range). Median level of model averaged support for the inferred mosaic was estimated at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e212" xlink:type="simple"/></inline-formula>.</p>
<p>However, these numbers alone do not present the complete picture of how the method performed - the power to detect recombination is significantly dependant upon the length of recombinant strains (e.g. a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e213" xlink:type="simple"/></inline-formula> fragment is easier to detect than a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e214" xlink:type="simple"/></inline-formula> one on average), and the relative level of divergence between parental strains (e.g. inter-subtype recombination is easier to detect than within-subtype). To capture these dependancies, we binned all breakpoints in simulated strains by the length of the shorter of the flanking fragments and the pairwise genetic distances between parental strains over that fragment. For example the breakpoint in a mosaic of type A–B with the 500 bp coming from subtype A and 200 bp coming from subtype B, would contribute to the bin with 200 bp length and the genetic distance between strain A and strain B over the last 200 bp of the sequences. We next plotted detection power, i.e. the proportion of times a correct-type breakpoint (e.g. A–B for the previous example) was inferred within 100 bp of the simulated breakpoint (see <xref ref-type="fig" rid="pcbi-1000581-g005">Fig. 5</xref>). The power of the method to detect a breakpoint grows with the length of the flanking recombinant fragments and the genetic distance of the two parental strains. For example, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e215" xlink:type="simple"/></inline-formula> of all breakpoints generated from sequences more than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e216" xlink:type="simple"/></inline-formula> divergent and involving fragments of at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e217" xlink:type="simple"/></inline-formula> on either side were correctly identified. The fraction increased to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e218" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e219" xlink:type="simple"/></inline-formula> or greater divergence and at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e220" xlink:type="simple"/></inline-formula>-long fragments–values encountered with commonly annotated inter-subtype recombinant mosaics in HIV.</p>
<fig id="pcbi-1000581-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.g005</object-id><label>Figure 5</label><caption>
<title>Power and accuracy in the sequence shuffling simulation.</title>
<p>Power of SCUEAL to detect breakpoints in the HIV-1 pol sequence shuffling scenario as a function of recombinant fragment length (x-axis) and divergence between parental strains (y-axis). Grid cells are colored according to the proportion of correctly detected breakpoints (different cells may summarize different numbers of simulations). White squares are plotted when there were no simulated breakpoints within a corresponding length-divergence range of values.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.g005" xlink:type="simple"/></fig></sec></sec><sec id="s3b">
<title>Surveillance study</title>
<p>The results of SCUEAL and REGA screening of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e221" xlink:type="simple"/></inline-formula> partial polymerase sequences isolated from patients in Bulgaria <xref ref-type="bibr" rid="pcbi.1000581-Salemi1">[48]</xref> were quite similar, yet revealingly different in some cases. The methods concurred on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e222" xlink:type="simple"/></inline-formula> sequences, reporting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e223" xlink:type="simple"/></inline-formula> subtype A sequences, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e224" xlink:type="simple"/></inline-formula>–subtype B, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e225" xlink:type="simple"/></inline-formula>–CRF01 (AE), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e226" xlink:type="simple"/></inline-formula> each of C and G, and one of subtype <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e227" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e228" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pcbi-1000581-g006">Figure 6</xref> depicts a query sequence on which the methods agreed well. Both the neighbor joining tree and the bootscan plot based on the automatic alignment produced by REGA indicate strong clustering with the B clade and lack of evidence for recombination, yielding an assignment confidence of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e229" xlink:type="simple"/></inline-formula>. Concordantly, SCUEAL reports a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e230" xlink:type="simple"/></inline-formula> model averaged support for clustering with a clade B sequence, although there is a bit of uncertainty which exact lineage the query should be grafted on.</p>
<fig id="pcbi-1000581-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.g006</object-id><label>Figure 6</label><caption>
<title>An example of a good agreement between SCUEAL and REGA in classifying a partial pol subtype B sequence.</title>
<p>The SCUEAL clustering plots present in this figure and <xref ref-type="fig" rid="pcbi-1000581-g007">Figures 7</xref>, <xref ref-type="fig" rid="pcbi-1000581-g008">8</xref> and <xref ref-type="fig" rid="pcbi-1000581-g009">9</xref> are conceptually analogous to bootscan plots, i.e. which reference sequence is the most likely sister lineage of the query sequence for a given site, but is based on model averaged support values instead of phylogenetic bootstrap. A partial reference tree with placed query is shown; color coding is consistent between the similarity plot and the tree. A phylogenetic tree with bootstrap support values and bootscan plot using the REGA alignment generated for the query sequence are shown.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.g006" xlink:type="simple"/></fig>
<p>There are several kinds of disagreement between REGA and SCUEAL classification results.</p>
<sec id="s3b1">
<title>Unassigned sequences</title>
<p>REGA did not assign a subtype to six sequences in the sample. This happens either when there is insufficient phylogenetic bootstrap support for clustering with a pure subtype or CRF reference, or when bootscan detects a recombinant form that is not well explained by an existing CRF. Because SCUEAL uses a much larger reference alignment than REGA (e.g. there are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e231" xlink:type="simple"/></inline-formula> sequences in the greater B clade, including a number of CRF fragments that cover parts of the pol gene, vs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e232" xlink:type="simple"/></inline-formula> in the default REGA) alignment, it was able to assign <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e233" xlink:type="simple"/></inline-formula> of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e234" xlink:type="simple"/></inline-formula> sequences to subtype <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e235" xlink:type="simple"/></inline-formula> with high (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e236" xlink:type="simple"/></inline-formula>) confidence. Interestingly, these sequences were grafted onto interior branches of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e237" xlink:type="simple"/></inline-formula> clade, highlighting the intrinsic power of SCUEAL of being able to make full use of the fixed reference topology. The remaining two sequences were classified as novel recombinant forms, in congruence with the bootscan profile. For example, in <xref ref-type="fig" rid="pcbi-1000581-g007">Figure 7</xref>, a novel A–J recombinant is reported by both methods, but REGA's conservative assignment scheme would still report this case as unassigned. SCUEAL proposes several A–J type recombinant forms, with A-A1-J-A2 being the best supported one; overall there is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e238" xlink:type="simple"/></inline-formula> model-averaged support for presence of recombination in this sequence. Due to a much larger set of subtype A reference sequences, our approach is capable of a more precise characterization of the mosaic, whose breakpoints are mapped very accurately (to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e239" xlink:type="simple"/></inline-formula> base pair). The sliding window nature of phylogenetic bootscanning (REGA uses a 400 bp window with a 50 bp stride by default) does not naturally permit precise breakpoint mapping. Splitting the sequence along the A–J boundary and building traditional neighbor joining trees using the REGA reference alignment, confirms the structure predicted by SCUEAL.</p>
<fig id="pcbi-1000581-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.g007</object-id><label>Figure 7</label><caption>
<title>An instance when a sequence unclassified by REGA is inferred to be a novel recombinant form by SCUEAL; the A–J mosaic structure is also confirmed by trees and bootscan plots based on the REGA reference alignment.</title>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.g007" xlink:type="simple"/></fig></sec><sec id="s3b2">
<title>Within-subtype recombination</title>
<p>Seven of the discordant results occurred when a sequence classified as pure subtype by REGA was identified as within-subtype recombinant by SCUEAL. An example of this is shown in <xref ref-type="fig" rid="pcbi-1000581-g008">Figure 8</xref>, where the putative parental strains are approximately <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e240" xlink:type="simple"/></inline-formula> divergent on the tree.</p>
<fig id="pcbi-1000581-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.g008</object-id><label>Figure 8</label><caption>
<title>An example of within-subtype (B) recombination detected by SCUEAL, but not by REGA. A partial reference tree with placed query is shown; color coding is consistent between the similarity plot and the tree.</title>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.g008" xlink:type="simple"/></fig></sec><sec id="s3b3">
<title>Missed recombinants</title>
<p>The remaining <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e241" xlink:type="simple"/></inline-formula> mismatches arose when a pure subtype sequence (according to REGA) was instead reported as an inter-subtype recombinants with very strong (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e242" xlink:type="simple"/></inline-formula>) model-averaged support for recombination. The obvious explanation for why REGA may be missing these recombinants is that the size of the sliding window used for bootscanning (400 bp) limits how short individual mosaic fragments can be. This limitation becomes relevant for single gene recombination analysis, when the total length of the sequence is on the order of 500–1000 bp. The A-B-A mosaic example in <xref ref-type="fig" rid="pcbi-1000581-g009">Figure 9</xref> was classified as subtype A by REGA. However, adjusting the sliding window parameters from to use window size of 200 bp instead of 400 bp and stride 25 bp instead of 50 bp revealed that subtype B sequences from the REGA reference alignment were genetically closer to the query than subtype A sequences over the segment predicted by SCUEAL to cluster with subtype B. Furthermore, a maximum likelihood tree (exhaustive search) on that segment supports the same clustering.</p>
<fig id="pcbi-1000581-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.g009</object-id><label>Figure 9</label><caption>
<title>An instance when a sequence assigned to subtype A by REGA is deduced to be an A-B-A mosaic by SCUEAL.</title>
<p>Similarity plots based on the reduced REGA alignments (only A and B subtype reference sequences) confirm that the same mosaic structure is supported using if a small enough window is selected for a sliding window analysis.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.g009" xlink:type="simple"/></fig></sec></sec><sec id="s3c">
<title>Stanford database sequences</title>
<p>SCUEAL analyses indicate that while a majority of sequences annotated as pure subtype in the Stanford drug resistance database are assigned to a correct subtype, a substantial proportion (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e243" xlink:type="simple"/></inline-formula> depending on subtype) are better explained as circulating or unique recombinant forms (CRF/URF) and a similar proportion appear to be within-subtype recombinants (<xref ref-type="table" rid="pcbi-1000581-t002">Table 2</xref>). Importantly, there are only a few cases when SCUEAL infers a pure subtype sequence which is annotated with a different pure subtype in the database. For instance, out of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e244" xlink:type="simple"/></inline-formula> subtype B sequences there were <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e245" xlink:type="simple"/></inline-formula> subtype D sequences, two–subtype J and two–subtype A, hence the vast majority of potentially misclassified subtypes in the database are due to recently characterized CRFs and URFs which are partially derived from the database subtype. When SCUEAL infers recombination, model averaged support for at least one breakpoint is very strong (median <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e246" xlink:type="simple"/></inline-formula>, mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e247" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e248" xlink:type="simple"/></inline-formula> for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e249" xlink:type="simple"/></inline-formula> range), but the inference of the exact mosaic type is less certain on average (median <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e250" xlink:type="simple"/></inline-formula>, mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e251" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e252" xlink:type="simple"/></inline-formula> for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e253" xlink:type="simple"/></inline-formula> range), which is not surprising given that many of the sequences are quite short.</p>
<table-wrap id="pcbi-1000581-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.t002</object-id><label>Table 2</label><caption>
<title>SCUEAL screening results on partial HIV-1 reverse transcriptase sequences from the Stanford Drug Resistance database.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000581-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Subtype</td>
<td align="left" colspan="1" rowspan="1">Sequences</td>
<td align="left" colspan="1" rowspan="1">Agree</td>
<td align="left" colspan="1" rowspan="1">within-subtype</td>
<td align="left" colspan="1" rowspan="1">Diff. pure subtype</td>
<td align="left" colspan="1" rowspan="1">Diff. recombinant</td>
<td align="left" colspan="1" rowspan="1">Top 3 CRFs and URFs</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">A</td>
<td align="left" colspan="1" rowspan="1">1740</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e254" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e255" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e256" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e257" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">CRF33/34 (31); A1,D (14); AE, B (7)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">B</td>
<td align="left" colspan="1" rowspan="1">16116</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e258" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e259" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e260" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e261" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">CRF28/29 (273); CRF42 (54); CRF20/23/24 (30)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">C</td>
<td align="left" colspan="1" rowspan="1">3133</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e262" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e263" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e264" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e265" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">B,C,CRF31 (56); B,C (36); C/CRF07 (8)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">D</td>
<td align="left" colspan="1" rowspan="1">624</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e266" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e267" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e268" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e269" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">A1,D (16); B, CRF19 (4); B, D (3)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">F</td>
<td align="left" colspan="1" rowspan="1">464</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e270" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e271" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e272" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e273" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">B,F1 (27); CRF29, F1 (5); B, CRF40, F1 (4)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">G</td>
<td align="left" colspan="1" rowspan="1">757</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e274" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e275" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e276" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e277" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">B, CRF14 (4); B, G(3); G,J (3)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">H</td>
<td align="left" colspan="1" rowspan="1">28</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e278" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e279" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e280" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e281" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">G,H (2); A, H (1); A, B, K (1)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">J</td>
<td align="left" colspan="1" rowspan="1">22</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e282" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e283" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e284" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e285" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">C,J (1)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">K</td>
<td align="left" colspan="1" rowspan="1">166</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e286" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e287" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e288" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e289" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">CRF32, G (22); CRF30, CRF32 (7); C, CRF32 (5)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">CRF01 (AE)</td>
<td align="left" colspan="1" rowspan="1">1552</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e290" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e291" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e292" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e293" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">CRF22 (5), AE,B (4); B, CRF33 (4)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">CRF02 (AG)</td>
<td align="left" colspan="1" rowspan="1">1352</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e294" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e295" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e296" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e297" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">A,G (285), A,CRF36,G (41), A,CRF02,G (34)</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt102"><label/><p><bold>Subtype</bold> lists the sequence subtype as annotated in the database. <bold>Sequences</bold> provides the number of sequences downloaded from the database. <bold>Agree</bold> gives the percentage of sequences for which SCUEAL returned the same subtype as that stored in the database. <bold>within-subtype</bold>–SCUEAL inferred within-subtype recombination within the same subtype as the one stored in the database; figures in parentheses show the proportion of within-subtype recombinants identified when DRAM positions were masked. <bold>Diff. pure subtype</bold>–the proportion of cases where SCUEAL inferred a pure subtype different from the annotated one. <bold>Diff. recombinant</bold>–the proportion of cases where SCUEAL inferred a recombinant mosaic with at least one fragment different from the annotated subtype; figures in parentheses show the proportion of within-subtype recombinants identified when DRAM positions were masked. <bold>Top 3 CRFs and URFs</bold>–three most frequent mosaics inferred by SCUEAL.</p></fn></table-wrap-foot></table-wrap>
<p>Agreement for subtypes H and K is unusually poor, however there are only a few sequences assigned to this subtype, and a small number of existing reference samples to base inference upon. In particular, many sequences annotated as subtype K appear to have been partly derived from CRF30 and CRF32 strains. Over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e298" xlink:type="simple"/></inline-formula> of sequences annotated as subtype F are classed as B,F (or partial CRFs) recombinants by SCUEAL, but this can be expected as there are at least seven known CRFs (17, 28, 29, 38–40, 42) that are comprised of B and F mosaics with one or more breakpoints in the pol gene. For CRF02-annotated samples, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e299" xlink:type="simple"/></inline-formula> of the sequences that were classified differently by SCUEAL as A,G recombinants appear to support breakpoints that are different from those included in the reference CRF02 strains. This could indicate that a larger sample of CRF02-like reference strains may be necessary to accurately capture the diversity of these viral strains.</p>
<p>HIV evolution in the era of Highly Active Antiretroviral Therapy (HAART), especially in the developed world, is significantly influenced by selective forces that favor viral strains with mutations that confer drug resistance in the presence of a corresponding drug. This is especially true of subtype B viruses, circulating in North America and Western Europe, where HAART has been exerting well-characterized selective pressure on the virus for over a decade <xref ref-type="bibr" rid="pcbi.1000581-Johnson1">[51]</xref>, leading to increasing prevalence of HIV strains that harbor drug resistant associated mutations (DRAM, e.g. <xref ref-type="bibr" rid="pcbi.1000581-Little1">[52]</xref>,<xref ref-type="bibr" rid="pcbi.1000581-Shet1">[53]</xref>). Convergent evolution to acquire DRAM can have a confounding effect on phylogenetic subtyping methods, by making regions rich in DRAM appear closely related in evolutionarily distant strains and potentially leading to a false signal of within- (or inter-) subtype recombination. To assess this effect, we identified subtype B RT sequences (as annotated in the database) that harbored at least one known DRAM <xref ref-type="bibr" rid="pcbi.1000581-Johnson1">[51]</xref> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e300" xlink:type="simple"/></inline-formula>) and reran SCUEAL on these sequences after replacing all DRAM with missing data (3 in-frame gaps for each DRAM codon, e.g. any codon at position 215 in reverse transcriptase that encodes an <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e301" xlink:type="simple"/></inline-formula> or a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e302" xlink:type="simple"/></inline-formula>). Between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e303" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e304" xlink:type="simple"/></inline-formula> positions (median <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e305" xlink:type="simple"/></inline-formula>) per sequence were masked by this procedure. DRAM masking substantially reduced the number of sequences that were classified as within-subtype recombinants, taking the number down from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e306" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e307" xlink:type="simple"/></inline-formula>. For other subtypes, where the frequency is of DRAMs is lower than in subtype B sequences, the effect of masking DRAMs on the proportion of inferred intra-subtype recombinants (and other recombinant forms) is much more muted (<xref ref-type="table" rid="pcbi-1000581-t002">Table 2</xref>). Consequently, convergent evolution to acquire drug resistant mutations appears to be a significant factor contributing to the within-subtype recombination signal, although the reduction in phylogenetic signal due to fewer informative sites in masked sequences is also a possible cause of this effect.</p>
</sec><sec id="s3d">
<title>Large scale subtype classification in a surveillance and epidemiological linkage study</title>
<p>The comparison between SCUEAL and REGA on this data set (see <xref ref-type="table" rid="pcbi-1000581-t003">Table 3</xref>), is similar to what was observed for the Stanford dataset. For well sampled subtypes (A,B,C,D,F,G,AE) the agreement between the methods was good to excellent (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e308" xlink:type="simple"/></inline-formula>), with a noticeable proportion (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e309" xlink:type="simple"/></inline-formula>) of within-subtype recombinants. Note that the proportion of within-subtype recombinants was not as significantly affected by masking out DRAMs as discussed in the previous section; for example the proportion was reduced from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e310" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e311" xlink:type="simple"/></inline-formula> for subtype B sequences, and actually increased for subtype <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e312" xlink:type="simple"/></inline-formula> sequences. This could be because the UK sequences are longer than (both protease and reverse transcriptase) than the Stanford sample (reverse transcriptase only). Also, because SCUEAL is a stochastic algorithm, some variation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e313" xlink:type="simple"/></inline-formula> in our simulation experiments, results not shown) between runs due to the indeterministic nature of the algorithm, especially between “borderline” sequences (those sequences that have a weak support for a the inferred mosaic), is to be expected. Small proportions of inter-subtype recombinants called by SCUEAL were not not identified by REGA. For CRF02 and CRF06, the agreement was quite poor, however the discord is easy to explain. For CRF02 SCUEAL identified many A,G recombinants but with breakpoints differing from those mapped for CRF02 (note that it is likely that G is the recombinant strain, but we refer to CRF02 as the recombinant to maintain compatibility with the current nomenclature); other CRF strains that include CRF02 - like fragments in pol (CRF30, CRF36) account for most of the other discrepancies. For sequences typed as CRF06 by REGA, the majority of SCUEAL classification involve CRFs derived from CRF06 (e.g. CRF30, CRF32).</p>
<table-wrap id="pcbi-1000581-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000581.t003</object-id><label>Table 3</label><caption>
<title>SCUEAL screening results on partial HIV-1 polymerase sequences from the UK.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000581-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.t003" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Subtype</td>
<td align="left" colspan="1" rowspan="1">Sequences</td>
<td align="left" colspan="1" rowspan="1">Agree</td>
<td align="left" colspan="1" rowspan="1">within-subtype</td>
<td align="left" colspan="1" rowspan="1">Diff. pure subtype</td>
<td align="left" colspan="1" rowspan="1">Diff. recombinant</td>
<td align="left" colspan="1" rowspan="1">Top 3 CRFs and URFs</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">A</td>
<td align="left" colspan="1" rowspan="1">2119</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e314" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e315" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e316" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e317" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">CRF22 (24); A1, D (12); A1, C (4)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">B</td>
<td align="left" colspan="1" rowspan="1">19871</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e318" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e319" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e320" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e321" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">B, D (120); B, CRF03 (40); B, F1 (38)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">C</td>
<td align="left" colspan="1" rowspan="1">7381</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e322" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e323" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e324" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e325" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">B, C (11); C, D (11); C, J (10)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">D</td>
<td align="left" colspan="1" rowspan="1">614</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e326" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e327" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e328" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e329" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">B, D (3); D, K (2); A, D (2)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">F</td>
<td align="left" colspan="1" rowspan="1">110</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e330" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e331" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e332" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e333" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">B,F (2); F, G (1); F, H (1)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">G</td>
<td align="left" colspan="1" rowspan="1">673</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e334" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e335" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e336" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e337" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">F1, G (25); CRF30, G (10); A, G (10)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">H</td>
<td align="left" colspan="1" rowspan="1">35</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e338" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e339" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e340" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e341" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">J</td>
<td align="left" colspan="1" rowspan="1">35</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e342" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e343" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e344" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e345" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">B, J (3); CRF09, J (3); G, J (2)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">CRF01 (AE)</td>
<td align="left" colspan="1" rowspan="1">419</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e346" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e347" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e348" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e349" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">AE, B (2)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">CRF02 (AG)</td>
<td align="left" colspan="1" rowspan="1">1014</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e350" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e351" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e352" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e353" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">A, G (278); A, CRF30, G (72); A, CRF30, CRF36 (56)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">CRF06</td>
<td align="left" colspan="1" rowspan="1">147</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e354" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e355" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e356" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e357" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">CRF32, K (34); CRF32, G (23); CRF30, CRF32 (14)</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt103"><label/><p><bold>Subtype</bold> lists the sequence subtype as annotated in the database. <bold>Sequences</bold> provides the number of sequences downloaded from the database. <bold>Agree</bold> gives the percentage of sequences for which SCUEAL returned the same subtype as the one inferred by REGA. <bold>within-subtype</bold>–SCUEAL inferred within-subtype recombination within the same subtype as the one inferred by REGA; figures in parentheses show the proportion of within-subtype recombinants identified when DRAM positions were masked. <bold>Diff. pure subtype</bold>–the proportion of cases where SCUEAL inferred a pure subtype different from the REGA assignment. <bold>Diff. recombinant</bold>–the proportion of cases where SCUEAL inferred a recombinant mosaic with at least one fragment different from the annotated subtype; figures in parentheses show the proportion of within-subtype recombinants identified when DRAM positions were masked. <bold>Top 3 CRFs and URFs</bold>–three most frequent mosaics inferred by SCUEAL.</p></fn></table-wrap-foot></table-wrap>
<p>Of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e358" xlink:type="simple"/></inline-formula> sequences, a non-trivial proportion <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e359" xlink:type="simple"/></inline-formula> were not classified by REGA, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e360" xlink:type="simple"/></inline-formula> of those also not classified by the HIVdb subtyping algorithm. According to SCUEAL <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e361" xlink:type="simple"/></inline-formula> were URFs, and the remainder–pure subtypes of CRFs. Among <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e362" xlink:type="simple"/></inline-formula> sequences, SCUEAL identified <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e363" xlink:type="simple"/></inline-formula> complex recombinant forms (more than 3 constituent sub- or subsubtypes) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e364" xlink:type="simple"/></inline-formula> URFs with at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e365" xlink:type="simple"/></inline-formula> sequences each, including:</p>
<list list-type="order"><list-item>
<p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e366" xlink:type="simple"/></inline-formula> G,A and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e367" xlink:type="simple"/></inline-formula> G,CRF02 recombinants. Given the degree of uncertainty about mapping the breakpoints in CRF02 (the nomenclature here is confusing, because recent evidence suggests that G was derived as a recombinant of A and CRF02 sequences) reference sequences, these sequences can be thought of as a A,G, CRF02 recombinants sequences. The finding also indicates that the diversity of this clade is quite significant, and reference data sets may need to be enriched for A, G and CRF02 sequences to enable more accurate subtype assignment. REGA assigned <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e368" xlink:type="simple"/></inline-formula> of these sequences to subtype CRF02, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e369" xlink:type="simple"/></inline-formula> to subtype A(A1), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e370" xlink:type="simple"/></inline-formula> to G, one to subtype <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e371" xlink:type="simple"/></inline-formula> and did not classify <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e372" xlink:type="simple"/></inline-formula> sequences.</p>
</list-item><list-item>
<p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e373" xlink:type="simple"/></inline-formula> A1,D recombinants. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e374" xlink:type="simple"/></inline-formula> of those were not definitively classified by REGA, with the remainder assigned to A1 (12), D (1) and CRF10_CD (1). There are several precedents for this type of mosaic structure, including CRF16, CRF19 and CRF35 which all have a mosaic AD structure in pol.</p>
</list-item><list-item>
<p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e375" xlink:type="simple"/></inline-formula> B,CRF39 recombinants. Because most of pol sequence in CRF39, which is found circulating in Brazil, is mapped to subtype B <xref ref-type="bibr" rid="pcbi.1000581-Guimaraes1">[54]</xref>, this form can be reported as a B intra-subtype recombinant. This finding also illustrates the capacity of SCUEAL to map within-subtype diversity with high resolution. Almost all (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e376" xlink:type="simple"/></inline-formula>) of those are identified as subtype B sequences by REGA, which is correct if within-subtype recombination is discounted.</p>
</list-item><list-item>
<p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e377" xlink:type="simple"/></inline-formula> B,D recombinants, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e378" xlink:type="simple"/></inline-formula> of which were classified as subtype B by REGA. Because B and D subtypes are closely related (compared to other between-subtypes comparisons), this mosaic type is difficult to detect.</p>
</list-item></list>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>We present a new phylogenetic method (SCUEAL) to automatically determine a subtype and map the recombinant structure in HIV-1 sequences. Our method uses a statistically robust maximum likelihood multi-model inference approach to examine tens of thousands of potential mosaic structures in a single run guided by an evolutionary algorithm, identify those well supported by the data and quantify the reliability of all estimated quantities. SCUEAL is designed to handle the inclusion of recombinant strains in reference alignments, operate on large reference alignments with minimal loss of speed and permit easy expansion of existing reference alignments as new subtypes or circulating recombinant forms.</p>
<p>Using an extensive collection of simulated sequence alignments, covering a wide range of evolutionary parameters and including biological HIV-1 sequences, we determined that the method was capable of accurate detection of the number and location of recombination breakpoints as well as appropriate parental lineages, given sufficient sequence divergence. For non-parametrically generated HIV-1 pol mosaics, the recovery rate of breakpoints was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e379" xlink:type="simple"/></inline-formula> for 5% or greater divergence between parental strains and 200 bp or longer sequence fragments. On average, individual breakpoints were inferred within 10 bp of the simulated locations. SCUEAL had a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e380" xlink:type="simple"/></inline-formula> rate of false positives on parametrically simulated data.</p>
<p>A comparison with a popular phylogeny based rapid subtyping tool REGA <xref ref-type="bibr" rid="pcbi.1000581-deOliveira1">[18]</xref> on an HIV-1 pol surveillance dataset <xref ref-type="bibr" rid="pcbi.1000581-Salemi1">[48]</xref> illustrated that SCUEAL was able to automatically detect recombinant sequences with short mosaic fragments, classify and map unknown mosaic types and resolve cases that confounded REGA. A large scale screen of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e381" xlink:type="simple"/></inline-formula> database sequences revealed that approximately <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e382" xlink:type="simple"/></inline-formula> of pure subtype reverse transcriptase sequences show evidence of within-subtype recombination and a further <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e383" xlink:type="simple"/></inline-formula> are likely novel or known circulating recombinant forms, highlighting the need for more precise determination of subtype information for public databases. Because up to 10% of HIV-1 infections occur with Unique Recombination Forms (URFs) when superinfection with divergent strains is relatively common (e.g. <xref ref-type="bibr" rid="pcbi.1000581-Harris1">[55]</xref>,<xref ref-type="bibr" rid="pcbi.1000581-McCutchan1">[56]</xref>), the ability of SCUEAL to automatically annotate such forms is of critical importance. Furthermore, many evolutionary analyses, such as dating and selection screens, can be biased by the inclusion of recombinant sequences without necessary corrections <xref ref-type="bibr" rid="pcbi.1000581-Posada4">[57]</xref>,<xref ref-type="bibr" rid="pcbi.1000581-Scheffler1">[58]</xref>. Studies that seek to identify clinical and evolutionary differences between different HIV subtypes (e.g. <xref ref-type="bibr" rid="pcbi.1000581-Baker1">[59]</xref>,<xref ref-type="bibr" rid="pcbi.1000581-Penn1">[60]</xref>) also rely on the accurate classification of subtypes for all input sequences. To our knowledge, none of the existing subtype classifiers are designed to detect within-subtype recombination, which is in all likelihood much more frequent than inter-subtype recombination because sufficiently divergent strains of the same subtype routinely co-circulate in host populations (e.g. <xref ref-type="bibr" rid="pcbi.1000581-Rousseau1">[61]</xref>) and within-host sequences often present phylogenetic evidence of extensive recombination <xref ref-type="bibr" rid="pcbi.1000581-Salemi2">[62]</xref>. We note that convergent evolution to acquire drug resistance associated mutations appears to have a strong confounding effect on detecting within-subtype recombination and should be accounted for if the focus of the analysis is to identify within-subtype recombination in regions of HIV that include many such mutations.</p>
<p>SCUEAL provides an automatically determined mosaic structure for any input sequence, including the cases when existing methods fail to derive such a structure. While this feature is a qualitative advance over existing approaches, it may also invite over-interpretation of computational results, and we emphasize that this should be avoided. Consider for example, the strain presented in <xref ref-type="fig" rid="pcbi-1000581-g007">Figure 7</xref>. SCUEAL results allow us to deduce that the strain is an inter-subtype recombinant with a high degree of confidence (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e384" xlink:type="simple"/></inline-formula>). The analysis also strongly implies that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e385" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000581.e386" xlink:type="simple"/></inline-formula> strains or their ancestors contributed segments of the pol gene to the query sequencer, but also reports several credible mosaic forms that could be assigned to the strain, counter-indicating a definitive (e.g. A-A1-J-A2) mosaic determination. We would like to stress that SCUEAL determination of a novel recombinant form should not lead the users to automatically declare the sequence as such, but rather as an invitation to perform further examination of the data, perhaps with a specialized reference alignment, enriched for the subtypes detected by SCUEAL. Continuing with the example, the combination of A and J subtypes in one sequence is not uncommon (e.g. CRF06, CRF11, CRF13, CRF27) and extensive mosaicism in the pol gene has also been reported previously <xref ref-type="bibr" rid="pcbi.1000581-Novitsky1">[63]</xref>. Moreover, the “J” clade in the SCUEAL reference alignment also contains J-like segments from several CRFs that circulate more widely that pure subtype J strains confined primarily to Central and West Africa <xref ref-type="bibr" rid="pcbi.1000581-Hemelaar1">[4]</xref>. Whether or not the segment assigned to clade J may instead belong to an unsampled clade of HIV-1 cannot ultimately be determined with the currently available estimate of HIV-1 diversity. Subtype classification is extensively used as a tool in molecular epidemiology and in surveillance studies of HIV because of their association with different populations. Multiple subtypes were detected in the UK in 1995 <xref ref-type="bibr" rid="pcbi.1000581-Arnold1">[64]</xref> and by 2007, non-B subtypes comprised the majority of new diagnoses in the UK <xref ref-type="bibr" rid="pcbi.1000581-HIV1">[65]</xref>,<xref ref-type="bibr" rid="pcbi.1000581-Hue1">[66]</xref>. In addition, subtype classification is important for clinical reasons in HIV because of biological differences that have been observed with respect to rate of progression to disease <xref ref-type="bibr" rid="pcbi.1000581-Kiwanuka1">[67]</xref>, and patterns of drug resistance mutations <xref ref-type="bibr" rid="pcbi.1000581-Geretti1">[68]</xref>,<xref ref-type="bibr" rid="pcbi.1000581-Geretti2">[69]</xref>. For that reason, sequences in the UK HIV Drug Resistance Database are routinely subtyped before analysis. The rapid increase in scale of the task (the current database release contains over 50,000 sequences) and the range of diversity of the subtypes and recombinants now present in the UK epidemic highlights an urgent need for an automated, informative, reliable and rapid method for classification on the sequence data collected that will scale to hundreds of thousands of sequences on commodity distributed computing platforms.</p>
<p>Empirical datasets in this study were limited to the partial polymerase gene of HIV, partly because this genetic region routinely sequenced for surveillance and diagnostic purposes, has few easily aligned indels–thus avoiding potential biases due to unreliable automatic multiple sequence alignment (e.g. <xref ref-type="bibr" rid="pcbi.1000581-Wong1">[46]</xref>), and contains many of the breakpoints mapped for known CRFs. However, SCUEAL can use any reference alignment, including full length HIV-1, Hepatitis C virus, Influenza A virus genomes and non-viral sequences, and we plan to implement this functionality in future versions of SCUEAL.</p>
<p>Finally, we would be remiss to overlook some of the limitations of our approach. SCUEAL is a fairly computationally demanding method, and consequently is considerably slower that some other screening tools. Parallel execution on a computer cluster can mitigate this issue and permit one to process thousands of sequences per hour. As any method that is based on a reference alignment, SCUEAL is susceptible to biased inference if the reference alignment is inaccurate or if reference sequences are themselves misclassified. We took a number of precautions to ensure that the reference alignment was accurate by focusing on an easily alignable genomic region, a conservative automatic alignment procedure for the query sequence and an incremental algorithm for adding and accurately labeling reference sequences. SCUEAL uses a nucleotide evolutionary model to fit phylogenetic likelihood models for the sake of computational efficiency and this could lead to difficult to quantify biases in mosaic structure mapping; more realistic models (e.g. codon models) can be “plugged-in” without any alteration to the methodological framework if desired.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000581.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000581.s001" xlink:type="simple"><label>Protocol S1</label><caption>
<p>Settings and results for each of the parametric simulation scenarios</p>
<p>(4.08 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank the editors and three anonymous reviewers and the associate editor (Dr Christophe Fraser) for their comments on a previous version of this manuscript.</p>
<p>The views expressed in the publication are those of the authors and not necessarily those of the Department of Health.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000581-Zeldovich1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zeldovich</surname><given-names>KB</given-names></name>
<name name-style="western"><surname>Chen</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Shakhnovich</surname><given-names>EI</given-names></name>
</person-group>             <year>2007</year>             <article-title>Protein stability imposes limits on organism complexity and speed of molecular evolution.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>16152</fpage>             <lpage>16157</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Gaschen1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gaschen</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Taylor</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Yusim</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Foley</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Gao</surname><given-names>F</given-names></name>
<etal/></person-group>             <year>2002</year>             <article-title>Diversity considerations in HIV-1 vaccine selection.</article-title>             <source>Science</source>             <volume>296</volume>             <fpage>2354</fpage>             <lpage>2360</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Robertson1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Robertson</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>Anderson</surname><given-names>JP</given-names></name>
<name name-style="western"><surname>Bradac</surname><given-names>JA</given-names></name>
<name name-style="western"><surname>Carr</surname><given-names>JK</given-names></name>
<name name-style="western"><surname>Foley</surname><given-names>B</given-names></name>
<etal/></person-group>             <year>2000</year>             <article-title>HIV-1 nomenclature proposal.</article-title>             <source>Science</source>             <volume>288</volume>             <fpage>55</fpage>             <lpage>56</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Hemelaar1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hemelaar</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Gouws</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Ghys</surname><given-names>PD</given-names></name>
<name name-style="western"><surname>Osmanov</surname><given-names>S</given-names></name>
</person-group>             <year>2006</year>             <article-title>Global and regional distribution of HIV-1 genetic subtypes and recombinants in 2004.</article-title>             <source>AIDS</source>             <volume>20</volume>             <fpage>W13</fpage>             <lpage>23</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Gifford1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gifford</surname><given-names>RJ</given-names></name>
<name name-style="western"><surname>de Oliveira</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Pybus</surname><given-names>OG</given-names></name>
<name name-style="western"><surname>Dunn</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Phylogenetic surveillance of viral genetic diversity and the evolving molecular epidemiology of human immunodeficiency virus type 1.</article-title>             <source>J Virol</source>             <volume>81</volume>             <fpage>13050</fpage>             <lpage>13056</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Papathanasopoulos1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Papathanasopoulos</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Hunt</surname><given-names>GM</given-names></name>
<name name-style="western"><surname>Tiemessen</surname><given-names>CT</given-names></name>
</person-group>             <year>2003</year>             <article-title>Evolution and diversity of HIV-1 in africa–a review.</article-title>             <source>Virus Genes</source>             <volume>26</volume>             <fpage>151</fpage>             <lpage>163</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Rhodes1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rhodes</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Wargo</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Hu</surname><given-names>WS</given-names></name>
</person-group>             <year>2003</year>             <article-title>High rates of human immunodeficiency virus type 1 recombination: near-random segregation of markers one kilobase apart in one round of viral replication.</article-title>             <source>J Virol</source>             <volume>77</volume>             <fpage>11193</fpage>             <lpage>11200</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Abecasis1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Abecasis</surname><given-names>AB</given-names></name>
<name name-style="western"><surname>Lemey</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Vidal</surname><given-names>N</given-names></name>
<name name-style="western"><surname>de Oliveira</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Peeters</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Recombination confounds the early evolutionary history of human immunodeficiency virus type 1: subtype G is a circulating recombinant form.</article-title>             <source>J Virol</source>             <volume>81</volume>             <fpage>8543</fpage>             <lpage>8551</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Posada1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Posada</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Crandall</surname><given-names>KA</given-names></name>
</person-group>             <year>2001</year>             <article-title>Evaluation of methods for detecting recombination from DNA sequences: Computer simulations.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>98</volume>             <fpage>13757</fpage>             <lpage>13762</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Posada2"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Posada</surname><given-names>D</given-names></name>
</person-group>             <year>2002</year>             <article-title>Evaluation of methods for detecting recombination from dna sequences: empirical data.</article-title>             <source>Mol Biol Evol</source>             <volume>19</volume>             <fpage>708</fpage>             <lpage>717</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Salminen1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Salminen</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Carr</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Burke</surname><given-names>D</given-names></name>
<name name-style="western"><surname>McCutchan</surname><given-names>F</given-names></name>
</person-group>             <year>1995</year>             <article-title>Identification of breakpoints in intergenotypic recombinants of HIV type 1 by bootscanning.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>11</volume>             <fpage>1423</fpage>             <lpage>1425</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Triques1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Triques</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Bourgeois</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Vidal</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Mpoudi-Ngole</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Mulanga-Kabeya</surname><given-names>C</given-names></name>
<etal/></person-group>             <year>2000</year>             <article-title>Near-full-length genome sequencing of divergent African HIV type 1 subtype F viruses leads to the identification of a new HIV type 1 subtype designated K.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>16</volume>             <fpage>139</fpage>             <lpage>151</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-GomezCarrillo1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gomez-Carrillo</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Quarleri</surname><given-names>JF</given-names></name>
<name name-style="western"><surname>Rubio</surname><given-names>AE</given-names></name>
<name name-style="western"><surname>Carobene</surname><given-names>MG</given-names></name>
<name name-style="western"><surname>Dilernia</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Drug resistance testing provides evidence of the globalization of HIV type 1: a new circulating recombinant form.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>20</volume>             <fpage>885</fpage>             <lpage>888</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Martin1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Martin</surname><given-names>DP</given-names></name>
<name name-style="western"><surname>Posada</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Crandall</surname><given-names>KA</given-names></name>
<name name-style="western"><surname>Williamson</surname><given-names>C</given-names></name>
</person-group>             <year>2005</year>             <article-title>A modified bootscan algorithm for automated identification of recombinant sequences and recombination breakpoints.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>21</volume>             <fpage>98</fpage>             <lpage>102</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Gao1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gao</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Robertson</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>Carruthers</surname><given-names>CD</given-names></name>
<name name-style="western"><surname>Li</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Bailes</surname><given-names>E</given-names></name>
<etal/></person-group>             <year>1998</year>             <article-title>An isolate of human immunodeficiency virus type 1 originally classified as subtype I represents a complex mosaic comprising three different group M subtypes (A, G, and I).</article-title>             <source>J Virol</source>             <volume>72</volume>             <fpage>10234</fpage>             <lpage>10241</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Paraskevis1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Paraskevis</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Magiorkinis</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Vandamme</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Kostrikis</surname><given-names>LG</given-names></name>
<name name-style="western"><surname>Hatzakis</surname><given-names>A</given-names></name>
</person-group>             <year>2001</year>             <article-title>Re-analysis of human immunodeficiency virus type 1 isolates from Cyprus and Greece, initially designated ‘subtype I’, reveals a unique complex A/G/H/K/? mosaic pattern.</article-title>             <source>J Gen Virol</source>             <volume>82</volume>             <fpage>575</fpage>             <lpage>580</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Casado1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Casado</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Thomson</surname><given-names>MM</given-names></name>
<name name-style="western"><surname>Sierra</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Najera</surname><given-names>R</given-names></name>
</person-group>             <year>2005</year>             <article-title>Identification of a novel HIV-1 circulating ADG intersubtype recombinant form (CRF19_cpx) in Cuba.</article-title>             <source>J Acquir Immune Defic Syndr</source>             <volume>40</volume>             <fpage>532</fpage>             <lpage>537</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-deOliveira1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>de Oliveira</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Deforche</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Cassol</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Salminen</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Paraskevis</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>An automated genotyping system for analysis of HIV-1 and other microbial sequences.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>3797</fpage>             <lpage>3800</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Wu1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wu</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Cai</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Wan</surname><given-names>XF</given-names></name>
<name name-style="western"><surname>Hoang</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Goebel</surname><given-names>R</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Nucleotide composition string selection in HIV-1 subtyping using whole genomes.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>1744</fpage>             <lpage>1752</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Rozanov1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rozanov</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Plikat</surname><given-names>U</given-names></name>
<name name-style="western"><surname>Chappey</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Kochergin</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Tatusova</surname><given-names>T</given-names></name>
</person-group>             <year>2004</year>             <article-title>A web-based genotyping resource for viral sequences.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>W654</fpage>             <lpage>9</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Myers1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Myers</surname><given-names>RE</given-names></name>
<name name-style="western"><surname>Gale</surname><given-names>CV</given-names></name>
<name name-style="western"><surname>Harrison</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Takeuchi</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Kellam</surname><given-names>P</given-names></name>
</person-group>             <year>2005</year>             <article-title>A statistical model for HIV-1 sequence classification using the subtype analyser (STAR).</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>3535</fpage>             <lpage>3540</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Schultz1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schultz</surname><given-names>AK</given-names></name>
<name name-style="western"><surname>Zhang</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Leitner</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Kuiken</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Korber</surname><given-names>B</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>A jumping profile Hidden Markov Model and applications to recombination sites in HIV and HCV genomes.</article-title>             <source>BMC Bioinformatics</source>             <volume>7</volume>             <fpage>265</fpage>          </element-citation></ref>
<ref id="pcbi.1000581-Loveday1"><label>23</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Loveday</surname><given-names>C</given-names></name>
<name name-style="western"><surname>MacRae</surname><given-names>E</given-names></name>
</person-group>             <year>2006</year>             <article-title>Limitations in using online tools to determine HIV-1 subtype in clinical patients: A comparison of 5 tools.</article-title>             <source>15th International HIV Drug Resistance Workshop</source>          </element-citation></ref>
<ref id="pcbi.1000581-Ntemgwa1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ntemgwa</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Gill</surname><given-names>MJ</given-names></name>
<name name-style="western"><surname>Brenner</surname><given-names>BG</given-names></name>
<name name-style="western"><surname>Moisi</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Wainberg</surname><given-names>MA</given-names></name>
</person-group>             <year>2008</year>             <article-title>Discrepancies in assignment of subtype/recombinant forms by genotyping programs for HIV type 1 drug resistance testing may falsely predict superinfection.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>24</volume>             <fpage>995</fpage>             <lpage>1002</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Holguin1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Holguin</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Lopez</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Soriano</surname><given-names>V</given-names></name>
</person-group>             <year>2008</year>             <article-title>Reliability of rapid subtyping tools compared to that of phylogenetic analysis for characterization of human immunodeficiency virus type 1 non-B subtypes and recombinant forms.</article-title>             <source>J Clin Microbiol</source>             <volume>46</volume>             <fpage>3896</fpage>             <lpage>3899</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Gifford2"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gifford</surname><given-names>R</given-names></name>
<name name-style="western"><surname>de Oliveira</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Myers</surname><given-names>RE</given-names></name>
<name name-style="western"><surname>Gale</surname><given-names>CV</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Assessment of automated genotyping protocols as tools for surveillance of HIV-1 genetic diversity.</article-title>             <source>AIDS</source>             <volume>20</volume>             <fpage>1521</fpage>             <lpage>1529</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Posada3"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Posada</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Crandall</surname><given-names>KA</given-names></name>
</person-group>             <year>2002</year>             <article-title>The effect of recombination on the accuracy of phylogeny estimation.</article-title>             <source>J Mol Evol</source>             <volume>54</volume>             <fpage>396</fpage>             <lpage>402</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Minin1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Minin</surname><given-names>VN</given-names></name>
<name name-style="western"><surname>Dorman</surname><given-names>KS</given-names></name>
<name name-style="western"><surname>Fang</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name>
</person-group>             <year>2005</year>             <article-title>Dual multiple change-point model leads to more accurate recombination detection.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>3034</fpage>             <lpage>3042</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-KosakovskyPond1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name>
<name name-style="western"><surname>Posada</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Gravenor</surname><given-names>MB</given-names></name>
<name name-style="western"><surname>Woelk</surname><given-names>CH</given-names></name>
<name name-style="western"><surname>Frost</surname><given-names>SD</given-names></name>
</person-group>             <year>2006</year>             <article-title>Automated phylogenetic detection of recombination using a genetic algorithm.</article-title>             <source>Mol Biol Evol</source>             <volume>23</volume>             <fpage>1891</fpage>             <lpage>1901</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-KosakovskyPond2"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name>
<name name-style="western"><surname>Frost</surname><given-names>SDW</given-names></name>
</person-group>             <year>2005</year>             <article-title>Datamonkey: rapid detection of selective pressure on individual sites of codon alignments.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>2531</fpage>             <lpage>2533</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Tavar1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tavaré</surname><given-names>S</given-names></name>
</person-group>             <year>1986</year>             <article-title>Some probabilistic and statistical problems in the analysis of DNA sequences.</article-title>             <source>Lectures on Mathematics in the Life Sciences</source>             <volume>17</volume>             <fpage>57</fpage>             <lpage>86</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-KosakovskyPond3"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kosakovsky Pond</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Frost</surname><given-names>S</given-names></name>
</person-group>             <year>2005</year>             <article-title>A simple hierarchical approach to modeling distributions of substitution rates.</article-title>             <source>Mol Biol Evol</source>             <volume>22</volume>             <fpage>223</fpage>             <lpage>234</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Guindon1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Guindon</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Gascuel</surname><given-names>O</given-names></name>
</person-group>             <year>2003</year>             <article-title>A simple, fast, and accurate algorithm to estimate large phylogenies by maximum likelihood.</article-title>             <source>Syst Biol</source>             <volume>52</volume>             <fpage>696</fpage>             <lpage>704</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Stamatakis1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stamatakis</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Ludwig</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Meier</surname><given-names>H</given-names></name>
</person-group>             <year>2005</year>             <article-title>RAxML-III: a fast program for maximum likelihood-based inference of large phylogenetic trees.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>456</fpage>             <lpage>463</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Schwarz1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schwarz</surname><given-names>G</given-names></name>
</person-group>             <year>1978</year>             <article-title>Estimating the dimension of a model.</article-title>             <source>Ann Stat</source>             <volume>6</volume>             <fpage>461</fpage>             <lpage>464</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Akaike1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Akaike</surname><given-names>H</given-names></name>
</person-group>             <year>1974</year>             <article-title>A new look at the statistical model identification.</article-title>             <source>IEEE Tran Automatic Control</source>             <volume>119</volume>             <fpage>716</fpage>             <lpage>723</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Sugiura1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sugiura</surname><given-names>N</given-names></name>
</person-group>             <year>1978</year>             <article-title>Further analysis of the data by Akaike's information criterion and the finite corrections.</article-title>             <source>Communications In Statistics-Theory And Methods</source>             <volume>A7</volume>             <fpage>13</fpage>             <lpage>26</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Yang1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yang</surname><given-names>ZH</given-names></name>
</person-group>             <year>2000</year>             <article-title>Maximum likelihood estimation on large phylogenies and analysis of adaptive evolution in human influenza virus A.</article-title>             <source>J Mol Evol</source>             <volume>51</volume>             <fpage>423</fpage>             <lpage>432</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Felsenstein1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name>
</person-group>             <year>1981</year>             <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach.</article-title>             <source>J Mol Evol</source>             <volume>17</volume>             <fpage>368</fpage>             <lpage>376</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Eshelman1"><label>40</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Eshelman</surname><given-names>L</given-names></name>
</person-group>             <year>1991</year>             <article-title>FOGA-1, Los Atlos, CA: Morgan Kaufmann, chapter The CHC adaptive search algorithm. How to have safe search when engaging in nontraditional genetic recombination.</article-title>             <volume>265-283</volume>          </element-citation></ref>
<ref id="pcbi.1000581-Goldberg1"><label>41</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Goldberg</surname><given-names>DE</given-names></name>
</person-group>             <year>1989</year>             <article-title>Genetic algorithms in search, optimization, and machine learning.</article-title>             <publisher-loc>Reading, Mass.</publisher-loc>             <publisher-name>Addison-Wesley Pub. Co</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000581-Burnham1"><label>42</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Burnham</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Anderson</surname><given-names>D</given-names></name>
</person-group>             <year>2003</year>             <article-title>Model Selection and Multimodel Inference.</article-title>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer, 2nd ed. edition</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000581-Pupko1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pupko</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Pe'er</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Shamir</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Graur</surname><given-names>D</given-names></name>
</person-group>             <year>2000</year>             <article-title>A fast algorithm for joint reconstruction of ancestral amino acid sequences.</article-title>             <source>Mol Biol Evol</source>             <volume>17</volume>             <fpage>890</fpage>             <lpage>896</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Needleman1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Needleman</surname><given-names>SB</given-names></name>
<name name-style="western"><surname>Wunsch</surname><given-names>CD</given-names></name>
</person-group>             <year>1970</year>             <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins.</article-title>             <source>J Mol Biol</source>             <volume>48</volume>             <fpage>443</fpage>             <lpage>453</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Nickle1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nickle</surname><given-names>DC</given-names></name>
<name name-style="western"><surname>Heath</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Jensen</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Gilbert</surname><given-names>PB</given-names></name>
<name name-style="western"><surname>Mullins</surname><given-names>JI</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>HIV-specific probabilistic models of protein evolution.</article-title>             <source>PLoS ONE</source>             <volume>2</volume>             <fpage>e503</fpage>          </element-citation></ref>
<ref id="pcbi.1000581-Wong1"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wong</surname><given-names>KM</given-names></name>
<name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name>
</person-group>             <year>2008</year>             <article-title>Alignment uncertainty and genomic analysis.</article-title>             <source>Science</source>             <volume>319</volume>             <fpage>473</fpage>             <lpage>476</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Tamura1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tamura</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Nei</surname><given-names>M</given-names></name>
</person-group>             <year>1993</year>             <article-title>Estimation of the number of nucleotide substitutions in the control region of mitochondrial-DNA in humans and chimpanzees.</article-title>             <source>Mol Biol Evol</source>             <volume>10</volume>             <fpage>512</fpage>             <lpage>526</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Salemi1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Salemi</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Goodenow</surname><given-names>MM</given-names></name>
<name name-style="western"><surname>Montieri</surname><given-names>S</given-names></name>
<name name-style="western"><surname>de Oliveira</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Santoro</surname><given-names>MM</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>The HIV type 1 epidemic in Bulgaria involves multiple subtypes and is sustained by continuous viral inflow from West and East European countries.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>24</volume>             <fpage>771</fpage>             <lpage>779</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Bennett1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bennett</surname><given-names>DE</given-names></name>
<name name-style="western"><surname>Camacho</surname><given-names>RJ</given-names></name>
<name name-style="western"><surname>Otelea</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Kuritzkes</surname><given-names>DR</given-names></name>
<name name-style="western"><surname>Fleury</surname><given-names>H</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Drug resistance mutations for surveillance of transmitted HIV-1 drug-resistance: 2009 update.</article-title>             <source>PLoS One</source>             <volume>4</volume>             <fpage>e4724</fpage>          </element-citation></ref>
<ref id="pcbi.1000581-KosakovskyPond4"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name>
<name name-style="western"><surname>Frost</surname><given-names>SDW</given-names></name>
<name name-style="western"><surname>Muse</surname><given-names>SV</given-names></name>
</person-group>             <year>2005</year>             <article-title>HyPhy: hypothesis testing using phylogenies.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>676</fpage>             <lpage>9</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Johnson1"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Johnson</surname><given-names>VA</given-names></name>
<name name-style="western"><surname>Brun-Vezinet</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Clotet</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Gunthard</surname><given-names>HF</given-names></name>
<name name-style="western"><surname>Kuritzkes</surname><given-names>DR</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Update of the drug resistance mutations in HIV-1.</article-title>             <source>Top HIV Med</source>             <volume>16</volume>             <fpage>138</fpage>             <lpage>145</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Little1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Little</surname><given-names>SJ</given-names></name>
<name name-style="western"><surname>Holte</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Routy</surname><given-names>JP</given-names></name>
<name name-style="western"><surname>Daar</surname><given-names>ES</given-names></name>
<name name-style="western"><surname>Markowitz</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2002</year>             <article-title>Antiretroviral-drug resistance among patients recently infected with HIV.</article-title>             <source>N Eng J Med</source>             <volume>347</volume>             <fpage>385</fpage>             <lpage>394</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Shet1"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shet</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Berry</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Mohri</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Mehandru</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Chung</surname><given-names>C</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Tracking the prevalence of transmitted antiretroviral drug-resistant HIV-1: a decade of experience.</article-title>             <source>J Acquir Immune Defic Syndr</source>             <volume>41</volume>             <fpage>439</fpage>             <lpage>446</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Guimaraes1"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Guimaraes</surname><given-names>ML</given-names></name>
<name name-style="western"><surname>Eyer-Silva</surname><given-names>WA</given-names></name>
<name name-style="western"><surname>Couto-Fernandez</surname><given-names>JC</given-names></name>
<name name-style="western"><surname>Morgado</surname><given-names>MG</given-names></name>
</person-group>             <year>2008</year>             <article-title>Identification of two new CRF_BF in Rio de Janeiro State, Brazil.</article-title>             <source>AIDS</source>             <volume>22</volume>             <fpage>433</fpage>             <lpage>435</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Harris1"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Harris</surname><given-names>ME</given-names></name>
<name name-style="western"><surname>Serwadda</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Sewankambo</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Kim</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Kigozi</surname><given-names>G</given-names></name>
<etal/></person-group>             <year>2002</year>             <article-title>Among 46 near full length HIV type 1 genome sequences from Rakai District, Uganda, subtype D and AD recombinants predominate.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>18</volume>             <fpage>1281</fpage>             <lpage>1290</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-McCutchan1"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>McCutchan</surname><given-names>FE</given-names></name>
<name name-style="western"><surname>Hoelscher</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Tovanabutra</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Piyasirisilp</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Sanders-Buell</surname><given-names>E</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>In-depth analysis of a heterosexually acquired human immunodeficiency virus type 1 superinfection: evolution, temporal fluctuation, and intercompartment dynamics from the seronegative window period through 30 months postinfection.</article-title>             <source>J Virol</source>             <volume>79</volume>             <fpage>11693</fpage>             <lpage>11704</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Posada4"><label>57</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Posada</surname><given-names>D</given-names></name>
</person-group>             <year>2001</year>             <article-title>Unveiling the molecular clock in the presence of recombination.</article-title>             <source>Mol Biol Evol</source>             <volume>18</volume>             <fpage>1976</fpage>             <lpage>1978</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Scheffler1"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Scheffler</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Martin</surname><given-names>DP</given-names></name>
<name name-style="western"><surname>Seoighe</surname><given-names>C</given-names></name>
</person-group>             <year>2006</year>             <article-title>Robust inference of positive selection from recombining coding sequences.</article-title>             <source>Bioinformatics</source>             <volume>22</volume>             <fpage>2493</fpage>             <lpage>2499</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Baker1"><label>59</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Baker</surname><given-names>CAR</given-names></name>
<name name-style="western"><surname>McEvers</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Byaruhanga</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Mulindwa</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Atwine</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>HIV subtypes induce distinct profiles of HIV-specific CD8(+) T cell responses.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>24</volume>             <fpage>283</fpage>             <lpage>287</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Penn1"><label>60</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Penn</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Stern</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Rubinstein</surname><given-names>ND</given-names></name>
<name name-style="western"><surname>Dutheil</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Bacharach</surname><given-names>E</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Evolutionary modeling of rate shifts reveals specificity determinants in HIV-1 subtypes.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>e1000214</fpage>          </element-citation></ref>
<ref id="pcbi.1000581-Rousseau1"><label>61</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rousseau</surname><given-names>CM</given-names></name>
<name name-style="western"><surname>Learn</surname><given-names>GH</given-names></name>
<name name-style="western"><surname>Bhattacharya</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Nickle</surname><given-names>DC</given-names></name>
<name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Extensive intrasubtype recombination in South African human immunodeficiency virus type 1 subtype C infections.</article-title>             <source>J Virol</source>             <volume>81</volume>             <fpage>4492</fpage>             <lpage>4500</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Salemi2"><label>62</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Salemi</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Gray</surname><given-names>RR</given-names></name>
<name name-style="western"><surname>Goodenow</surname><given-names>MM</given-names></name>
</person-group>             <year>2008</year>             <article-title>An exploratory algorithm to identify intra-host recombinant viral sequences.</article-title>             <source>Mol Phylogenet Evol</source>             <volume>49</volume>             <fpage>618</fpage>             <lpage>628</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Novitsky1"><label>63</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Novitsky</surname><given-names>VA</given-names></name>
<name name-style="western"><surname>Gaolekwe</surname><given-names>S</given-names></name>
<name name-style="western"><surname>McLane</surname><given-names>MF</given-names></name>
<name name-style="western"><surname>Ndung'u</surname><given-names>TP</given-names></name>
<name name-style="western"><surname>Foley</surname><given-names>BT</given-names></name>
<etal/></person-group>             <year>2000</year>             <article-title>HIV type 1 A/J recombinant with a pronounced pol gene mosaicism.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>16</volume>             <fpage>1015</fpage>             <lpage>1020</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Arnold1"><label>64</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Arnold</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Barlow</surname><given-names>KL</given-names></name>
<name name-style="western"><surname>Parry</surname><given-names>JV</given-names></name>
<name name-style="western"><surname>Clewley</surname><given-names>JP</given-names></name>
</person-group>             <year>1995</year>             <article-title>At least five HIV-1 sequence subtypes (A, B, C, D, A/E) occur in England.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>11</volume>             <fpage>427</fpage>             <lpage>429</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-HIV1"><label>65</label><element-citation publication-type="other" xlink:type="simple">             <collab xlink:type="simple">HIV and AIDS in the United Kingdom.</collab>             <article-title>Health Protection Report 2007.</article-title>             <comment><ext-link ext-link-type="uri" xlink:href="http://www.hpa.org.uk/hpr/archives/2007/hpr1707.pdf" xlink:type="simple">http://www.hpa.org.uk/hpr/archives/2007/hpr1707.pdf</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000581-Hue1"><label>66</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hue</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Pillay</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Clewley</surname><given-names>JP</given-names></name>
<name name-style="western"><surname>Pybus</surname><given-names>OG</given-names></name>
</person-group>             <year>2005</year>             <article-title>Genetic analysis reveals the complex structure of HIV-1 transmission within defined risk groups.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>102</volume>             <fpage>4425</fpage>             <lpage>4429</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Kiwanuka1"><label>67</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kiwanuka</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Laeyendecker</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Robb</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Kigozi</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Arroyo</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Effect of human immunodeficiency virus Type 1 (HIV-1) subtype on disease progression in persons from Rakai, Uganda, with incident HIV-1 infection.</article-title>             <source>J Infect Dis</source>             <volume>197</volume>             <fpage>707</fpage>             <lpage>713</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Geretti1"><label>68</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Geretti</surname><given-names>AM</given-names></name>
</person-group>             <year>2006</year>             <article-title>HIV-1 subtypes: epidemiology and significance for HIV management.</article-title>             <source>Curr Opin Infect Dis</source>             <volume>19</volume>             <fpage>1</fpage>             <lpage>7</lpage>          </element-citation></ref>
<ref id="pcbi.1000581-Geretti2"><label>69</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Geretti</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Harrison</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Green</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Sabin</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Hill</surname><given-names>T</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Effect of HIV-1 subtype on virologic and immunologic response to starting highly active antiretroviral therapy.</article-title>             <source>Clin Infect Dis</source>             <volume>48</volume>             <fpage>1296</fpage>             <lpage>1305</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>