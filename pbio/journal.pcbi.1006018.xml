<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00913</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006018</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Spectrum analysis techniques</subject><subj-group><subject>NMR spectroscopy</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolites</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Biomarkers</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Information technology</subject><subj-group><subject>Data processing</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolomics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Spectrum analysis techniques</subject><subj-group><subject>NMR spectroscopy</subject><subj-group><subject>One-dimensional NMR spectroscopy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Chromatographic techniques</subject><subj-group><subject>Liquid chromatography</subject><subj-group><subject>Liquid chromatography-mass spectrometry</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Analytical chemistry</subject><subj-group><subject>Mass spectrometry</subject><subj-group><subject>Liquid chromatography-mass spectrometry</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Spectrum analysis techniques</subject><subj-group><subject>Mass spectrometry</subject><subj-group><subject>Liquid chromatography-mass spectrometry</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>speaq 2.0: A complete workflow for high-throughput 1D NMR spectra processing and quantification</article-title>
<alt-title alt-title-type="running-head">speaq 2.0: Workflow for 1D NMR spectra processing and quantification</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3007-2569</contrib-id>
<name name-style="western">
<surname>Beirnaert</surname> <given-names>Charlie</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5903-633X</contrib-id>
<name name-style="western">
<surname>Meysman</surname> <given-names>Pieter</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7945-5750</contrib-id>
<name name-style="western">
<surname>Vu</surname> <given-names>Trung Nghia</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3946-7313</contrib-id>
<name name-style="western">
<surname>Hermans</surname> <given-names>Nina</given-names></name>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" deceased="yes" xlink:type="simple">
<name name-style="western">
<surname>Apers</surname> <given-names>Sandra</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Pieters</surname> <given-names>Luc</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Covaci</surname> <given-names>Adrian</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8217-2564</contrib-id>
<name name-style="western">
<surname>Laukens</surname> <given-names>Kris</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Adrem Data Lab, Department of Mathematics and Computer Science, University of Antwerp, Antwerp, Belgium</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Biomedical Informatics Network Antwerp (biomina), University of Antwerp, Antwerp, Belgium</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Medical Epidemiology and Biostatistics, Karolinska Institutet, Stockholm, Sweden</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Natural Products &amp; Food Research and Analysis (NatuRA), Department of Pharmaceutical Sciences, University of Antwerp, Wilrijk, Belgium</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Toxicological Center, Department of Pharmaceutical Sciences, University of Antwerp, Wilrijk, Belgium</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Schneidman</surname> <given-names>Dina</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Hebrew University of Jerusalem, ISRAEL</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">charlie.beirnaert@uantwerpen.be</email> (CB); <email xlink:type="simple">kris.laukens@uantwerpen.be</email> (KL)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>1</day>
<month>3</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>3</issue>
<elocation-id>e1006018</elocation-id>
<history>
<date date-type="received">
<day>6</day>
<month>6</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>4</day>
<month>2</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Beirnaert et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006018"/>
<abstract>
<p>Nuclear Magnetic Resonance (NMR) spectroscopy is, together with liquid chromatography-mass spectrometry (LC-MS), the most established platform to perform metabolomics. In contrast to LC-MS however, NMR data is predominantly being processed with commercial software. Meanwhile its data processing remains tedious and dependent on user interventions. As a follow-up to speaq, a previously released workflow for NMR spectral alignment and quantitation, we present speaq 2.0. This completely revised framework to automatically analyze 1D NMR spectra uses wavelets to efficiently summarize the raw spectra with minimal information loss or user interaction. The tool offers a fast and easy workflow that starts with the common approach of peak-picking, followed by grouping, thus avoiding the binning step. This yields a matrix consisting of features, samples and peak values that can be conveniently processed either by using included multivariate statistical functions or by using many other recently developed methods for NMR data analysis. speaq 2.0 facilitates robust and high-throughput metabolomics based on 1D NMR but is also compatible with other NMR frameworks or complementary LC-MS workflows. The methods are benchmarked using a simulated dataset and two publicly available datasets. speaq 2.0 is distributed through the existing speaq R package to provide a complete solution for NMR data processing. The package and the code for the presented case studies are freely available on CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=speaq" xlink:type="simple">https://cran.r-project.org/package=speaq</ext-link>) and GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/beirnaert/speaq" xlink:type="simple">https://github.com/beirnaert/speaq</ext-link>).</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100007660</institution-id>
<institution>Universiteit Antwerpen</institution>
</institution-wrap>
</funding-source>
<award-id>BOF GOA</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3007-2569</contrib-id>
<name name-style="western">
<surname>Beirnaert</surname> <given-names>Charlie</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This research is supported by a GOA (Geconcentreerde Onderzoeksactie) from the University of Antwerp. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="2"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-03-13</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The validation datasets are originally available through the University of Copenhagen (<ext-link ext-link-type="uri" xlink:href="http://www.models.life.ku.dk/" xlink:type="simple">http://www.models.life.ku.dk/</ext-link>). All datasets in R format can be found on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/beirnaert/speaq" xlink:type="simple">https://github.com/beirnaert/speaq</ext-link>) and (partially, due to package size preferences) on CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=speaq" xlink:type="simple">https://cran.r-project.org/package=speaq</ext-link>). All code is also available in both these repositories.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>1D NMR spectroscopy has been a popular platform since the early days of metabolomics. Although less sensitive than the complimentary and more common LC-MS technology, NMR has its merits. For one, it is an unparalleled technique in determining the structure of unknown metabolic compounds. Furthermore, because it is a non-destructive technique, samples can be reanalyzed later or can be used in a different spectroscopic analysis such as mass spectrometry. Also, an NMR spectroscopy experiment requires little sample preparation compared to LC-MS, thus limited unwanted extra variability is introduced. Finally, the results of an NMR analysis are less dependent on the operator and instrument used. All these factors make 1D NMR spectroscopy a technique with a relatively high reproducibility and rather minimal researcher bias [<xref ref-type="bibr" rid="pcbi.1006018.ref001">1</xref>]. There are however also drawbacks associated with the technique. First, the aforementioned low sensitivity is an important issue as the dynamic range in real biological samples surpasses the NMR detection range. This is particularly problematic when the goal is to identify an unknown metabolite with a low concentration.</p>
<p>To get the best of both worlds, combining large scale LC-MS analysis with NMR spectroscopy has been presented as an option to yield valuable novel insights in metabolic pathways and biomarkers [<xref ref-type="bibr" rid="pcbi.1006018.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1006018.ref004">4</xref>]. From a data processing perspective, this combination is not trivial. The data analysis of NMR is not as automated as LC-MS data analysis, which can rely on open-source solutions like XCMS [<xref ref-type="bibr" rid="pcbi.1006018.ref005">5</xref>]. Most NMR data analyses are still performed with commercial software [<xref ref-type="bibr" rid="pcbi.1006018.ref006">6</xref>]. While the reproducibility of the NMR experimental techniques is high, the data analysis still requires a substantial degree of user intervention. This results in the possible introduction of bias and lower research reproducibility, meaning that the data analysis can not be easily replicated by others. The absence of standardized and automated NMR metabolomics workflows is the main culprit despite recent progress. See <xref ref-type="table" rid="pcbi.1006018.t001">Table 1</xref> for an overview of freely available NMR software. Not all these NMR analysis tools are applicable to all research setups. Some serve only specific purposes like BATMAN [<xref ref-type="bibr" rid="pcbi.1006018.ref007">7</xref>], for example, which is aimed at obtaining concentration estimates for known metabolites from the raw spectra. However, a lot of untargeted experiments are in search for not only known metabolites, but also unknown ones. These experiments require tools that can process large amounts of data in a scalable way.</p>
<table-wrap id="pcbi.1006018.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.t001</object-id>
<label>Table 1</label>
<caption>
<title>An overview of open source NMR data processing solutions.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006018.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Platform</th>
<th align="left">Aim</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">BATMAN [<xref ref-type="bibr" rid="pcbi.1006018.ref007">7</xref>]</td>
<td align="left">R</td>
<td align="left">Estimating relative metabolite concentrations from a list of target metabolites and quantifying individual metabolites by modelling the resonances in the NMR spectra. As it requires a target list of metabolites it is less suited for fully untargeted approaches.</td>
</tr>
<tr>
<td align="left">Bayesil [<xref ref-type="bibr" rid="pcbi.1006018.ref008">8</xref>]</td>
<td align="left">web</td>
<td align="left">Automatic quantification and identification of metabolites from a reference list. This method starts from the raw NMR free-induction-decay signal and thus does not require conversion to the NMR spectra, however only certain formats are supported and the data have to be collected in a specific way.</td>
</tr>
<tr>
<td align="left">ChemoSpec [<xref ref-type="bibr" rid="pcbi.1006018.ref009">9</xref>]</td>
<td align="left">R</td>
<td align="left">A general package for processing of spectroscopic signal (NMR, infrared or Raman) aimed at metabolomics. Uses the binning approach for spectra summarisation and small shift correction. Also incorporates the CluPA algorithm for raw spectral alignment from speaq (v1.0—1.2.3)</td>
</tr>
<tr>
<td align="left">MetaboAnalyst [<xref ref-type="bibr" rid="pcbi.1006018.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1006018.ref012">12</xref>]</td>
<td align="left">web</td>
<td align="left">Arguably one of the most widely used platforms for metabolomics analysis. It has specific modules for biomarker analysis, pathway analysis, statistics, etc. For NMR data however it only accepts binned data or peak data which has been grouped over the samples (so effectively a matrix with samples and features). Therefore our method can be used to provide a starting point for an analysis with MetaboAnalyst.</td>
</tr>
<tr>
<td align="left">muma-R [<xref ref-type="bibr" rid="pcbi.1006018.ref013">13</xref>]</td>
<td align="left">R</td>
<td align="left">A package for data (pre-)processing and statistics aimed at MS and NMR metabolomics data. As it requires binned NMR data or NMR peak data it can also be used in combination with speaq 2.0 to provide a high quality peak list as a starting point.</td>
</tr>
<tr>
<td align="left">MVAPACK [<xref ref-type="bibr" rid="pcbi.1006018.ref014">14</xref>]</td>
<td align="left">GNU Octave</td>
<td align="left">A toolbox with a large number of capabilities for reproducible NMR data analysis starting from the raw NMR Free-induction-decay signal. Also relies on the binning method for spectra summarization.</td>
</tr>
<tr>
<td align="left">speaq (v1.0—1.2.3) [<xref ref-type="bibr" rid="pcbi.1006018.ref015">15</xref>]</td>
<td align="left">R</td>
<td align="left">The CluPA algorithm for raw spectral alignment was the main object of speaq v1.0—1.2.3. It can also be used to quantify spectral regions that differ between case and control classes.</td>
</tr>
<tr>
<td align="left">specmine [<xref ref-type="bibr" rid="pcbi.1006018.ref016">16</xref>]</td>
<td align="left">R</td>
<td align="left">A package for metabolomics data analysis. The available methods are a collection from other well known metabolomics packages and some general methods from multivariate statistics and machine learning.</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>A typical workflow for NMR spectral analysis consists of several pre-processing steps, such as baseline correction, raw spectral alignment, spectra summarization and grouping. This is then followed by statistical analysis. The spectra summarization step and the alignment/grouping step are the most time consuming. Spectra summarization is the transformation of all the experimental measurement points into a small number of features, which are more suited for automated analysis. Multiple spectra summarization techniques exist, each with their own advantages and drawbacks [<xref ref-type="bibr" rid="pcbi.1006018.ref017">17</xref>]. The specific method that is chosen can result in user-introduced bias and low reproducibility. This is the case for the most commonly used summarization approach: the so-called binning or bucketing method [<xref ref-type="bibr" rid="pcbi.1006018.ref018">18</xref>]. This method was introduced to compensate for small spectral shifts between samples. It allows to vastly reduce the number of measurements points to a limited number of variables (the bins) in one single, automated step [<xref ref-type="bibr" rid="pcbi.1006018.ref019">19</xref>]. There are however major drawbacks to this method that have a profound influence on the results [<xref ref-type="bibr" rid="pcbi.1006018.ref020">20</xref>]. In particular, it is not straightforward to define the boundaries of the bins in crowded spectra. Automating this process may lead to splitting up small but relevant peaks. Manually checking the bins on the other hand is extremely tedious and tweaking the boundaries can forfeit any attempt for reproducibility. Several methods have been proposed to tackle the bin boundary issue [<xref ref-type="bibr" rid="pcbi.1006018.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1006018.ref023">23</xref>], but this is not the only concern. Loss of information is intrinsically linked to the binning approach as entire bins are simply summed together.</p>
<p>At the end of an analysis based on the binning approach, when several bins are found to be interesting, it is still necessary to go back to the raw spectra to manually check the intervals. This is necessary to find the ppm values of the actual peaks of interest that can then be used to query a database, like HMDB [<xref ref-type="bibr" rid="pcbi.1006018.ref024">24</xref>]. This introduces yet another point where user intervention is required, which slows down the whole process and hampers the use of an automated workflow.</p>
<p>In this paper, we present the speaq 2.0 method. The underlying core paradigm is to efficiently summarize spectra with little user interaction, high speed and most importantly little loss of information whilst greatly reducing the dimensions of the data. The overall aim however, is not to construct yet another all-encompassing package for NMR analysis, but more importantly, to construct a method that can complement established tools for NMR data analysis like MetaboAnalyst [<xref ref-type="bibr" rid="pcbi.1006018.ref012">12</xref>], by improving performance, analysis quality and reproducibility. This is achieved by improving the quality of the peak lists which are the starting points for MetaboAnalyst [<xref ref-type="bibr" rid="pcbi.1006018.ref012">12</xref>] or muma-R [<xref ref-type="bibr" rid="pcbi.1006018.ref013">13</xref>]. By automating the important peak picking step in the NMR analysis workflow, less researcher bias is introduced hereby greatly improving reproducibility. The automation potential of the package makes it suitable for the fast analysis of NMR spectra in a way that is very comparable to how LC-MS spectra are analyzed. In the future, this method could be effective for high-throughput analyses in which LC-MS and NMR data are combined to achieve better results. Nonetheless, a complete standalone analysis pipeline is presented with the focus on user-friendliness. This is to allow also non-expert users to be able to work with open-source tools instead of the black-box proprietary software.</p>
<p>The basic proposition of speaq 2.0 is to use wavelets to summarize the peaks within the spectra. By working with the peak data instead of the raw spectra or binned spectra a great reduction in data size can be achieved without a large loss of information. The Mexican hat wavelet is used to mathematically represent the peaks with only a few values instead of the tens or hundreds of raw data points describing the peak in the original spectrum. Besides the data reduction, the additional advantage of using wavelets is that the need for baseline correction and smoothing is eliminated with no loss of sensitivity or increase in false positives [<xref ref-type="bibr" rid="pcbi.1006018.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1006018.ref026">26</xref>].</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Design and implementation</title>
<sec id="sec003">
<title>Workflow</title>
<p>The NMR data analysis workflow of speaq 2.0 is depicted in <xref ref-type="fig" rid="pcbi.1006018.g001">Fig 1</xref>. Spectra serve as input, then peak picking with wavelets is applied to transform the spectra to peak data. These peaks are then grouped into features with the grouping algorithm and peak filling is applied to fix missing values. The resulting matrix of features and samples is then used in statistical analysis. This approach is intrinsically different from the one available in the original speaq (v1.0—1.2.3), which was centered around the concept of aligning spectra with the CluPA algorithm. The BW-quantitation function of speaq v1.0—1.2.3 allows users to find regions that are different between two groups, such as case and control. However, speaq v1.0—1.2.3 does not support the case of multiple groups or ratio variables. Also, it requires a binning step to obtain a feature matrix to be used in pattern mining or statistical approaches such as PCA. The new speaq 2.0 methods allow multiple groups and circumvent the need for binning. Overall, speaq 2.0 offers a novel way of processing NMR data, with the option to use the classic spectral alignment techniques as an intermediary step. The entire package is designed to easily and quickly build a reproducible workflow to obtain the peaks that are of interest to the experiment. Although the approach is very different to the one available in speaq v1.0—1.2.3, the choice was made to integrate the functionality of both speaq v1.0—1.2.3 and speaq 2.0 in one single package. The main benefit is that the methods are fully compatible and it allows existing speaq users to easily extend their workflows as needed. The individual steps of the speaq 2.0 approach are described in more detail in the following section.</p>
<fig id="pcbi.1006018.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Possible workflows of speaq 2.0.</title>
<p>The newly presented methods are standalone (full black arrows) or can be used together with the CluPA alignment algorithm and BW quantification method that were made available in the first speaq implementation (v 1.0—1.2.3) [<xref ref-type="bibr" rid="pcbi.1006018.ref015">15</xref>] (dashed arrows). It is still possible to perform an analysis based on raw spectra alone, as per the classic speaq (v 1.0—1.2.3) analysis. With the new methods, raw data is converted to peaks, and every peak is summarized with ppm location and width, intensity and SNR. These peaks are subsequently grouped and optionally peak filled (missed peaks in samples are specifically searched for). The resulting data is converted to a feature matrix that contains intensities for each peak and sample combination. This matrix can then be used in statistical analysis with built-in or external methods.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>Pre-processing steps</title>
<p>The input to the workflow consists of spectra in the intensity (y-axis) vs ppm (x-axis) format. This means that the free induction decay (FID) signal coming from the NMR spectrometer has to be converted to spectra by using the Fourier transform. In addition, before peak picking, the spectra can be aligned with the included CluPA algorithm [<xref ref-type="bibr" rid="pcbi.1006018.ref015">15</xref>] (the core of speaq v1.0—1.2.3). Note that it is also possible to analyse spectra that have already been aligned with other methods like icoshift [<xref ref-type="bibr" rid="pcbi.1006018.ref027">27</xref>]. However, depending on the algorithm used, aligning raw spectra can result in the distortion of small peaks [<xref ref-type="bibr" rid="pcbi.1006018.ref028">28</xref>].</p>
<sec id="sec005">
<title>Peak detection: From spectra to features via wavelets</title>
<p>The Mexican hat wavelet is used to perform the peak detection. It is a suitable wavelet because it resembles a peak by being symmetrical and containing only 1 positive maximum [<xref ref-type="bibr" rid="pcbi.1006018.ref025">25</xref>]. This peak detection method was inspired by the CluPA alignment algorithm [<xref ref-type="bibr" rid="pcbi.1006018.ref015">15</xref>] where wavelets are used to find landmark peaks to aid in the alignment. The interaction with the wavelets relies on the MassSpecWavelet R package which performs the actual peak detection as per the method outlined by Du et al [<xref ref-type="bibr" rid="pcbi.1006018.ref025">25</xref>]. A spectral segment (an intensity vector) containing a peak is converted to wavelet space by changing the scale and position of the mother wavelet and obtaining the wavelet coefficient for each combination of scale and position. The wavelet coefficient can be seen as a metric for how well the wavelet matches the peak. The entire intensity vector is converted into a wavelet coefficient matrix. This wavelet coefficient matrix is where the actual peak detection takes place. A ridge (line of high values) will appear in the matrix where the position of the wavelet matches the position of a peak in the spectrum. The height of the ridge is not constant as it varies with the scale of the wavelet. At the point where the scale best matches the width of the peak in the spectrum the ridge will feature a local maximum. The problem of peak finding is thus shifted to finding ridges, and finding the maximum of each ridge. See Du et al. for more details [<xref ref-type="bibr" rid="pcbi.1006018.ref025">25</xref>]. The result is a peak detection that is both sensitive to low and high intensity peaks and insensitive to background noise (as noise will not produce a noticeable ridge).</p>
<p>Although the default parameters of the peak picking approach work for most NMR experiments, different parameters for the peak picking can be set according to user preferences. For example, the baseline intensity threshold (to focus on higher peaks only, default is 1000), the signal-to-noise ratio threshold and the scales to be used for the wavelets. Note that the default parameters are set up for untransformed spectra, when spectra are scaled to max intensity 100 or 1 different settings may be more appropriate. All data sets were analysed with the default speaq 2.0 values.</p>
<p>After the peak detection, the spectra (intensity vs ppm data) are converted to a dataset with peakIndex and peakValue values. Note that this peakValue vs peakIndex dataset has a substantially lower dimension than the original data. The peakIndex is directly linked to the ppm value. The peakValue is related to the wavelet coefficient that describes the peak. This wavelet coefficient is an approximation for the area under the peak curve and this used throughout the analysis. Since peak height is of interest for some NMR data analysis pipelines, the option to work with peak heights has been made available in the peak picking function.</p>
</sec>
<sec id="sec006">
<title>Peak grouping</title>
<p>The peaks resulting from the wavelet peak detection are not perfectly aligned since no two peaks are exactly the same and different spectra can be shifted relative to each other. These shifts can be caused by differences in sample environment (pH, solvent, etc.) or differences in experimental conditions (temperature, magnetic field homogeneity). However, the aim is to go towards a feature dataset whereby a feature is defined as a group of peaks with at most one peak per sample belonging to that feature. This means the peaks have to be grouped with a single index value describing the group center. To group the NMR peaks we can make optimal use of the results of the wavelet based peak detection step. Not only ppm values but also signal-to-noise ratio and sample values can provide information to aid in the grouping. The hierarchical clustering based algorithm developed for grouping does not require a reference sample as it divides the samples in groups based on the Gower coefficient [<xref ref-type="bibr" rid="pcbi.1006018.ref029">29</xref>]. The merit of the Gower distance is that variables of different units (here ppm and intensity) can be safely used together. It is calculated by normalizing each variable to a value between 0 and 1. The distance between two data points is then the sum of the distances for each variable. As such the Gower distance can be seen as a Manhatten distance on normalized data. The grouping algorithm’s pseudocode is displayed in <xref ref-type="fig" rid="pcbi.1006018.g002">Fig 2</xref>. A more detailed description can be found in <xref ref-type="supplementary-material" rid="pcbi.1006018.s001">S1 Appendix</xref>.</p>
<fig id="pcbi.1006018.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Grouping algorithm pseudocode.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.g002" xlink:type="simple"/>
</fig>
<p>Note that this method is designed to process data that is sufficiently well aligned. If this is not the case the method will most likely underperform because of the larger overlap between peaks. Nonetheless the method even works on data with non-trivial shifts between samples as is the case in the wine benchmark dataset [<xref ref-type="bibr" rid="pcbi.1006018.ref027">27</xref>]. Extremely shifted spectra can be aligned with existing methods such as CluPA [<xref ref-type="bibr" rid="pcbi.1006018.ref015">15</xref>], prior to peak detection.</p>
</sec>
<sec id="sec007">
<title>Peak filling</title>
<p>The purpose of peak filling is to detect peaks that may have been missed in the first round of peak detection. To illustrate this problem, we can think of a scenario in which, for example, the user sets a high intensity threshold for peak detection. The features matrix will then be composed of features that correspond to locations with high peaks. If certain samples have low peaks in this region the peak filling step can be used to find these peaks, because peak filling works without an intensity threshold. This reduces the amount of missing data in the feature matrix. In an other scenario, peaks can be deliberately deleted if the grouping algorithm detects two peaks from the same sample in the same group. If this peak actually belonged to a different group it can then be recovered with the peak filling step. For each feature, the peak filling algorithm will specifically search the raw data for peaks of missing samples. A small section of the missing sample spectra is used to perform the peak detection. This small section is of length 512 measurement points (small) or 1024 (large), as this greatly speeds up the computation of the Fourier Transform used by the MassSpecWavelet package [<xref ref-type="bibr" rid="pcbi.1006018.ref025">25</xref>]. A more refined wavelet search is performed in this region starting from the average group values for peak location and width. If a peak is found it has to be within a set distance from the group. The default is 10 measurement points, which is approximately between 0.001 ppm and 0.01 ppm, depending on the NMR instrument settings. This distance is small as otherwise distant peaks could be assigned to the group. If no peak is found then it is still regarded as a missing value and can be imputed later. The end result is more peaks, which in turn results in a more robust statistical analysis afterwards as less missing values have to be imputed.</p>
</sec>
</sec>
<sec id="sec008">
<title>Statistical analysis</title>
<p>Following peak filling, the data can now be represented in the form of a matrix with samples for rows, features (peak groups) for columns and peak values in each matrix cell. Each of these peak values corresponds to the size of the original peaks as quantified by the wavelets. A huge number of techniques for univariate and multivariate statistics (e.g. PCA, PLS-DA) and machine learning (e.g. SVM, random forest) can be applied to this data matrix. Most of these methods are made available through different R packages which can be found on CRAN, Bioconductor [<xref ref-type="bibr" rid="pcbi.1006018.ref030">30</xref>] or Github. The output provided by speaq is compatible with the majority of these methods, as most of these allow to submit a data matrix and a response vector (class labels) as input. A selection of methods useful for statistical analysis have been directly integrated into the speaq 2.0 framework: a tool to perform scalings, transformations and imputations and a differential analysis method.</p>
<sec id="sec009">
<title>Scaling and imputation</title>
<p>Before statistical analysis methods like PCA can be used, the missing values in the data have to be imputed. This step is often done in tandem with the desired scaling method since otherwise data can artificially be created. For example, imputing zeros followed by z-scaling is not the same as z-scaling followed by imputing zeros. The latter actually corresponds with imputing mean values. For all benchmark datasets zeros (the default) are used for imputing missing peak values in the data matrices as this indicates a non present peak. Although other methods are available, for example kNN imputation [<xref ref-type="bibr" rid="pcbi.1006018.ref031">31</xref>] and random forest based imputation [<xref ref-type="bibr" rid="pcbi.1006018.ref032">32</xref>].</p>
<p>After imputation, the optional normalization and scaling steps are executed. Several methods commonly used in metabolomics are available such as Probability Quotient Normalization (PQN) and Pareto scaling [<xref ref-type="bibr" rid="pcbi.1006018.ref033">33</xref>]. Pareto scaling is most suited for metabolomics since it reduces the effects large signals while keeping the data structure roughly intact. It is governed by the formula in <xref ref-type="disp-formula" rid="pcbi.1006018.e001">Eq (1)</xref> with <bold>y</bold><sub><italic>j</italic></sub> the <italic>j</italic><sup><italic>th</italic></sup> feature vector containing the peak values <italic>y</italic><sub><italic>i</italic>,<italic>j</italic></sub> of all samples 1 … <italic>i</italic> … <italic>N</italic> and <italic>σ</italic><sub><italic>j</italic></sub> the standard deviation of <bold>y</bold><sub><italic>j</italic></sub>.
<disp-formula id="pcbi.1006018.e001"><alternatives><graphic id="pcbi.1006018.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006018.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">y</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi mathvariant="bold">y</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msqrt><mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msqrt></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula></p>
</sec>
<sec id="sec010">
<title>Differential analysis</title>
<p>A differential analysis method based on linear models is available in speaq 2.0. This function provides a way of identifying significant features with (adjusted) p-values. Specifically, for each feature 1, …, <italic>j</italic>, …, <italic>K</italic> consisting of peak values <italic>y</italic><sub><italic>i</italic>,<italic>j</italic></sub> of samples 1 … <italic>i</italic> … <italic>N</italic> a linear model of the form
<disp-formula id="pcbi.1006018.e002"><alternatives><graphic id="pcbi.1006018.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006018.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">y</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mspace width="3.33333pt"/><mml:msub><mml:mi>β</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
is constructed with <bold>x</bold> the response vector (N elements, for example class membership, a bioassay result, etc.), <bold>y</bold><sub><italic>j</italic></sub> the <italic>j</italic><sup><italic>th</italic></sup> feature vector and <bold><italic>ε</italic></bold> the vector of errors <italic>ε</italic><sub><italic>i</italic></sub>. Now for each <italic>β</italic><sub><italic>j</italic></sub> we can test whether there is a significant relationship between feature <bold>y</bold><sub><italic>j</italic></sub> and <bold>x</bold> by testing the hypothesis that <italic>β</italic><sub><italic>j</italic></sub> = 0 (two-tailed t-test). The <italic>K</italic> p-values can be used to find peaks significantly associated with the response vector. Several multiple testing corrections are available within the speaq 2.0 framework. While the default is Benjamini-Hochberg, for the purposes of this study, the stringent Bonferroni correction was applied to all reported p-values. Note that in the case of only two classes, this method is equivalent to the t-test.</p>
</sec>
</sec>
<sec id="sec011">
<title>Metabolite identification</title>
<p>After statistical analysis the relevant peaks can be matched with the molecules responsible for these peaks. Several databases with NMR metabolomics data are available [<xref ref-type="bibr" rid="pcbi.1006018.ref017">17</xref>]. One of the more user friendly ones is the Human Metabolome Database (HMDB) [<xref ref-type="bibr" rid="pcbi.1006018.ref024">24</xref>], as it allows to search for compounds by providing the ppm values of the peaks of interest. To obtain the metabolites for the onion intake in mice data the latest version of HMDB (3.6 [<xref ref-type="bibr" rid="pcbi.1006018.ref034">34</xref>]) was used. It is however not optimal to submit all significant peaks in a single query to this database. The reason for this is that HMDB works by matching the queried peaks to the database and then sorting the matched molecules according to their Jaccard index. For two sets the Jaccard index is the number of common elements (the intersection), divided by all the elements (the union), or in this specific case the number of matched peaks divided by all peaks in the query. Thus, when submitting all peaks at once we risk not finding the correct metabolite as adding additional peaks from molecule B when trying to identify molecule A will dilute the results. To reduce this effect a correlation analysis can be performed to indicate which peaks belong together. The underlying assumption is that NMR spectra peaks originating from the same molecule exhibit similar behavior over all samples. Therefore the peaks that correlate strongly with each other are most likely to come from the same metabolite. The speaq 2.0 output format is compatible with the R functionality for correlation analysis. The correlation matrix is visualized with the corrplot R package [<xref ref-type="bibr" rid="pcbi.1006018.ref035">35</xref>] which clusters the peaks according to their correlation. The number of clusters are chosen by the user between one and the total number of peaks. The correlation within each cluster is affected by the chosen number of clusters. The user is responsible for choosing this number of clusters and evaluating the corresponding performance. After the correlation analysis step, the ppm values of peaks in a correlated cluster can be submitted directly to HMDB via a built in speaq 2.0 function (HMDBsearchR, note this will open a webpage). This produces a list of metabolites ordered by Jaccard index. It is up to the user to determine which Jaccard index is to be considered high enough.</p>
</sec>
<sec id="sec012">
<title>Benchmark data</title>
<p>To validate the presented approach three datasets are analyzed: one simulated dataset for which the ground truth is known and two publicly available datasets which have been analyzed in published studies.</p>
<list list-type="order">
<list-item>
<p>The wine dataset by Larsen et al. [<xref ref-type="bibr" rid="pcbi.1006018.ref036">36</xref>] consists of 1H NMR spectroscopy data of 40 table wines (red, white &amp; rosé). The focus of Larsen et al. was not to investigate differences between wines of different colour and origin, but merely to evaluate how pre-processing methods like alignment and interval selection can aid in chemometrics and quantitative NMR analysis [<xref ref-type="bibr" rid="pcbi.1006018.ref036">36</xref>]. Wine is a good example for evaluating alignment algorithms because of the often substantial differences in pH, which can cause large shifts in the NMR spectra. Because of this property, the wine dataset has been used to evaluate the performance of several alignment algorithms, like COW [<xref ref-type="bibr" rid="pcbi.1006018.ref036">36</xref>], icoshift [<xref ref-type="bibr" rid="pcbi.1006018.ref027">27</xref>] and CluPA [<xref ref-type="bibr" rid="pcbi.1006018.ref015">15</xref>].</p>
</list-item>
<list-item>
<p>The simulated dataset is constructed by combining the 1H NMR spectra of two metabolites, namely 3-Hydroxyphenylacetic acid (HMDB0000440) and 3,4-Dihydroxybenzeneacetic acid (HMDB0001336). The NMR spectra of both metabolites can be downloaded from the Human Metabolome Database [<xref ref-type="bibr" rid="pcbi.1006018.ref034">34</xref>]. The dataset consists of 20 simulated spectra that are combined in such a way as to include variation that is comparable to the most common between-sample variation found in NMR spectra. Most notably, there is variation in peak height, peak location, and peak composition. The variation in peak composition is caused by both metabolites having peaks at almost identical locations. This results in two sources of variation in peak location namely, the variation introduced by the random shift left or right and by the mixing factor that describes the weight of each metabolite in each spectrum. See <xref ref-type="supplementary-material" rid="pcbi.1006018.s002">S2 Appendix</xref> for more details about how this dataset was generated.</p>
</list-item>
<list-item>
<p>The onion intake in mice dataset originates from a nutri-metabolomics study by Winning et al. [<xref ref-type="bibr" rid="pcbi.1006018.ref037">37</xref>]. The objective of the study was to search for onion intake biomarkers. The underlying idea was that if their workflow can identify biomarkers for onion intake, it could also be used to locate biomarkers in other studies. 32 rats were divided into 4 categories each receiving a specific onion diet: control (0% onion), 3% onion residue, 7% onion extract and 10% onion by-product. Urine samples were collected during 24 hours and analyzed with proton NMR spectroscopy to characterize the metabolome of the different onion fed mice. More details can be found in [<xref ref-type="bibr" rid="pcbi.1006018.ref037">37</xref>].</p>
</list-item>
</list>
<p>Both the wine and onion datasets were made available by the University of Copenhagen at <ext-link ext-link-type="uri" xlink:href="http://www.models.life.ku.dk/" xlink:type="simple">http://www.models.life.ku.dk/</ext-link>.</p>
</sec>
</sec>
<sec id="sec013" sec-type="results">
<title>Results</title>
<sec id="sec014">
<title>Wine data</title>
<p>The first public validation dataset concerns the NMR spectra of table wines. This dataset has been often used to evaluate algorithms to align raw spectra. The new speaq 2.0 workflow which transforms spectra to peaks, which are then grouped together, can also be used to process this dataset.</p>
<sec id="sec015">
<title>The peak based approach for data reduction</title>
<p>By using the speaq 2.0 peak picking method, followed by grouping and peak filling, the size of the data is greatly reduced. This is done in multiple steps. First, peak detection is applied to the raw spectra to convert the large raw measurement data matrix of 40 samples by 8712 measurements to a smaller matrix of 6768 peaks by 6 columns consisting of values describing the peaks. The data reduction after this step does not seem overwhelmingly large. However, it is important to realize that this is only a reduction in redundant information which is accompanied with little loss of information thanks to the wavelets. Furthermore, most of the correlation between consecutive measurement points in the spectral data is removed. Next, the peaks are grouped, resulting in the same dataset as the peak data, but now each peak has been assigned to a group. Such a group consists of a collection of peaks with at most one peak per sample. This grouped peak data can now be represented as a matrix, with groups as columns, samples as rows, and peak intensities as the matrix elements. The true data reduction becomes apparent now as there are only 207 peak groups, which correspond to the features used in further analysis. The original matrix of 40 by 8712 is thus converted to a matrix of 40 by 207.</p>
</sec>
<sec id="sec016">
<title>From feature matrix to locating differences between spectra</title>
<p>We can locate those features that are associated with wine type. Before any analysis the data matrix is Pareto scaled and centered. The first step in a multivariate analysis is often principal component analysis (PCA). The results show that there is a clear difference between on one side red and on the other white and rosé wines (<xref ref-type="supplementary-material" rid="pcbi.1006018.s004">S1 Fig</xref>). However, a differential analysis method incorporated into speaq 2.0 can be sued to investigate the specific features that are different between the red and white wine classes. The results of the differential analysis is a series of p-values, one for every feature, which indicate how useful each feature is in building a linear model that can discriminate between the two wine classes. The p-values are displayed in <xref ref-type="fig" rid="pcbi.1006018.g003">Fig 3</xref> along with the raw spectra and grouped peak data for one of 33 significant features. When looking at the spectra that correspond to these features, the difference between red and white wines is obvious. However, manually searching the original spectra for these difference regions would be extremely tedious and time consuming. With speaq 2.0, this entire process takes about 3 minutes with 1 CPU and a mere 50 seconds with 4 CPUs (2.5 GHz machine).</p>
<fig id="pcbi.1006018.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Visualization of Bonferroni corrected p-values.</title>
<p>Numerous features have a corrected p-value below the significance threshold of 0.05 indicating that there is a significant difference between red and white wine. An example of a significant feature (indicated with the red diamond) is represented on the right with its raw spectra (top), the data after peak detection (middle) and the data after grouping (bottom).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec017">
<title>Comparing peak grouping to raw spectral alignment</title>
<p>The new speaq 2.0 approach differs from spectral alignment algorithms, such as CluPA and icoshift [<xref ref-type="bibr" rid="pcbi.1006018.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1006018.ref027">27</xref>], but the final results should correspond to each other: grouped peaks should correspond to aligned peaks in the spectrum. By comparing the results from each, we can study the cases where the peak based method performs better, equal or worse compared to the raw spectra based methods. The performance of both types of spectra processing methods (peaks vs raw spectra) is dependent on the content and specifics of the spectra. Most notably the number of peaks and the shifts between sample spectra (caused by pH differences etc.) largely dictate how well these methods will perform. Generally, if the peak shifts between samples are less than the distance between consecutive peak groups, all methods perform as expected. An example of this can be found in <xref ref-type="fig" rid="pcbi.1006018.g004">Fig 4</xref>. Beyond these ideal cases, several alignment or grouping mistakes can occur. The following illustrates a small portion of issues that can arise when processing 1D NMR spectra.</p>
<list list-type="order">
<list-item>
<p>Many peaks are in a small region causing overlap and there is no clear indication as to which peaks correspond to each other. A clear example of this situation is depicted in <xref ref-type="supplementary-material" rid="pcbi.1006018.s005">S2 Fig</xref>. The speaq 2.0 grouping method based on peaks performs similarly to the other methods and in some cases even provides superior grouping solutions (although there is no real way to say which of the smaller peaks belong together). The reason is that it sees all peaks and tries to group them locally. This is in contrast to the CluPA algorithm from the original speaq which only regards the landmark peaks and aligns the highest ones in this crowded region, but the spectra are clearly overshifted. The icoshift algorithm provides a better solution than CluPA in this case but the results remain suboptimal.</p>
</list-item>
<list-item>
<p>A single sample shows unique behavior compared to all other samples. An example of such a situation is depicted in <xref ref-type="supplementary-material" rid="pcbi.1006018.s006">S3 Fig</xref>. In this case no method performs as it should and every method introduces errors or artifacts. It is however important to note that such unique cases will usually not show up in the final statistical analysis since these analyses often focus on general group differences and are robust against outlier samples.</p>
</list-item>
<list-item>
<p>The shift between samples is larger than the difference between two adjacent peaks in a non crowded peak region. An example is shown in <xref ref-type="supplementary-material" rid="pcbi.1006018.s007">S4 Fig</xref>. Both the raw spectra approaches (CluPA and icoshift) align the spectra as expected. The speaq based approach initially groups peaks wrongly. However, this wrong alignment can be detected by using a built in function of the speaq package which calculates the silhouette values for each group (see <xref ref-type="supplementary-material" rid="pcbi.1006018.s003">S3 Appendix</xref> for definition and implementation). Groups that are flagged as having bad silhouette values are regrouped. After this step the results correspond to those of the correctly aligned spectra.</p>
</list-item>
</list>
<fig id="pcbi.1006018.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Raw spectral alignment methods and peak based grouping methods perform equally.</title>
<p>When the peak shifts between samples (caused by pH differences etc.) are less than the distance between adjacent peaks, all methods perform as expected. The raw spectra based methods (CluPA from the speaq v1.0—1.2.3 and icoshift) mitigate the differences in peak shifts and the peak based method groups the peaks accordingly.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.g004" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec018">
<title>Simulated dataset</title>
<p>To actually quantify the performance of the new speaq 2.0 approach, we require a dataset for which the ground truth is known. For this purpose a simulated dataset was constructed (see <xref ref-type="supplementary-material" rid="pcbi.1006018.s002">S2 Appendix</xref> for details) from the 1H NMR spectra of two different metabolites, with a mixing factor <italic>m</italic><sub><italic>i</italic></sub> chosen from a bimodal distribution to simulate two different groups. This effectively corresponds to a case vs control study. This simulated dataset is also processed with 2 common NMR spectral alignment methods, namely CluPA [<xref ref-type="bibr" rid="pcbi.1006018.ref015">15</xref>] and icoshift [<xref ref-type="bibr" rid="pcbi.1006018.ref027">27</xref>]. It is not straightforward to quantify the performance of speaq vs the alignment algorithms on the same level since the alignment algorithms do not result in a feature matrix. However, we can compare the new speaq 2.0 workflow to the default workflow of alignment followed by binning. The setup is displayed in <xref ref-type="fig" rid="pcbi.1006018.g005">Fig 5</xref>. By binning the aligned spectra we obtain a feature matrix. The spectra are binned by using the functionality in the ChemoSpec R-package [<xref ref-type="bibr" rid="pcbi.1006018.ref009">9</xref>]. The bin.ratio parameter is set to 200, which equates to binning with a binwidth of 0.018 ppm. The resulting feature matrix is then processed with the differential analysis functionality of speaq to identify the relevant variables that are significantly different between case and control. This results in a p-value for each bin and this output can be compared directly with the output of the peak based approach of speaq via ROC and Precision-Recall curves, see <xref ref-type="fig" rid="pcbi.1006018.g006">Fig 6</xref>. Several observations can be made from these results:</p>
<list list-type="order">
<list-item>
<p>The lowest performance is obtained when simply binning the raw shifted spectra. This is to be expected as it is more likely that peaks will be split over multiple bins because of the large shifts.</p>
</list-item>
<list-item>
<p>By aligning the spectra before the binning step the performance increases. Although the spectral alignment methods have occasional artifacts, many peaks in the spectra are in fact aligned correctly, thereby aiding in reducing the splitting of peaks over multiple bins. Nonetheless, this approach is still hampered by the binning step.</p>
</list-item>
<list-item>
<p>The peak based method of speaq 2.0 performs best on the simulated case vs control dataset. This is predominantly caused by the different way of obtaining features. With the binning approach, features consist not only of the peak signal but also of the adjacent signals, which are often background. This background effectively reduces the difference between two samples, as the background signal is often similar in scale. With the peak picking approach of speaq 2.0, only the peak is used to describe a feature. This results in greater differences between samples and this in turn makes it easier for the statistical approaches to spot the relevant differences.</p>
</list-item>
</list>
<fig id="pcbi.1006018.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Performance comparison workflow.</title>
<p>The default way of processing 1D NMR spectra is illustrated on the left. The case vs. control spectra are aligned and are then binned to produce features which can be used in statistical analysis. Note that the spectral alignment step can be skipped as the binning approach can correct for small shifts. This default processing approach is compared to our method shown on the right. The aim of both methods is to point the user to the peaks/intervals that discriminate between the two groups.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.g005" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006018.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Performance comparison with ROC and P-R curves on a simulated dataset.</title>
<p>Binning raw unaligned spectra results in the worst performance. The two alignment tools (CluPA and icoshift) show an increase in performance compared to no alignment but are still hampered by the binning step. The new speaq 2.0 workflow has the highest performance on the ROC and P-R curve.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec019">
<title>Onion intake in mice data</title>
<p>With this validation dataset, we will compare the results of the new speaq 2.0 workflow with those obtained by Winning et al. [<xref ref-type="bibr" rid="pcbi.1006018.ref037">37</xref>]. This dataset contains onion 4 groups of mice with increasing percentages of onion in their diet (0, 3, 7 and 10%).</p>
<sec id="sec020">
<title>Towards a small and usable data matrix</title>
<p>The original analysis by Winning et al. [<xref ref-type="bibr" rid="pcbi.1006018.ref037">37</xref>] used binning to process the spectra. Here we use the new speaq 2.0 workflow to convert the raw NMR spectra (<xref ref-type="supplementary-material" rid="pcbi.1006018.s008">S5 Fig</xref>) to peaks (<xref ref-type="supplementary-material" rid="pcbi.1006018.s009">S6 Fig</xref>). Next the peaks are grouped, peak filled and converted to a feature matrix. The dimensions of this feature matrix are 31 samples by 677 features. This is a substantial reduction from the original spectra matrix (31 samples by 29001 measurement points). This feature matrix is the input for the following statistical analysis.</p>
</sec>
<sec id="sec021">
<title>No group trend is found by PCA</title>
<p>Corresponding with the original analysis by Winning et al. a principal component analysis (PCA) is performed. The feature data matrix is Pareto scaled and centered. The results of the PCA analysis, as presented as a score plot in <xref ref-type="fig" rid="pcbi.1006018.g007">Fig 7</xref>, are analogous to those of [<xref ref-type="bibr" rid="pcbi.1006018.ref037">37</xref>]: there are no obvious and consistent group trends that follow increases in onion intake.</p>
<fig id="pcbi.1006018.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.g007</object-id>
<label>Fig 7</label>
<caption>
<title>PCA analysis of onion mice data.</title>
<p>The onion mice data matrix is Pareto scaled and centered. There are no clear trends that follow the onion intake percentage present in the PCA results, this matches the results of Winning et al. [<xref ref-type="bibr" rid="pcbi.1006018.ref037">37</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec022">
<title>Locating possible biomarkers with ease</title>
<p>From this point onwards the merit of the wavelet based analysis becomes more obvious. Winning et al. resort to interval partial least squares (iPLS) and interval extended canonical variate analysis (iECVA). After careful cross validation, these methods lead to intervals that have to be checked manually for interesting peaks. The new speaq 2.0 workflow allows a quicker and more straightforward analysis. The constructed feature matrix is processed with the differential analysis method. In this case there exists a numerical relationship between all the groups (i.e. the percentage of onion in the diet), which is directly supported by the new speaq 2.0 differential analysis based on linear models. Each feature receives a Bonferroni corrected p-value assigned indicating how well the feature corresponds to the increasing onion concentration. The distribution of uncorrected p-values is depicted in <xref ref-type="supplementary-material" rid="pcbi.1006018.s010">S7 Fig</xref>. The corrected p-values are shown in <xref ref-type="fig" rid="pcbi.1006018.g008">Fig 8</xref> along with an excerpt of one of the significant peaks. In total, 9 peaks were found to be significant. The 9 significant peaks can be used to search HMDB to find the possible biomarkers related to onion intake.</p>
<fig id="pcbi.1006018.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Differential analysis results of onion intake in mice data.</title>
<p>(Left) the Bonferroni corrected p-values for the features resulting from the differential analysis and (right) one of the features with a significant p-value (indicated with the blue diamond on the left image): (top) raw spectra, (middle) data after peak detection and (bottom) data after grouping.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.g008" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec023">
<title>Identifying the biomarkers</title>
<p>Merely submitting all peak ppm values to HMDB will not produce the correct outcome, as HMDB expects all peaks to correspond to a single metabolite. To avoid submitting peaks from multiple metabolites to an HMDB search, a correlation-based clustering step is performed on the highly significant peaks. The result from this clustering, based on peak intensity correlations, is displayed in <xref ref-type="fig" rid="pcbi.1006018.g009">Fig 9</xref>. The significant peaks are grouped into 5 clusters, where the minimal Pearson correlation between any two peaks in the same cluster is higher than 0.75. These peak clusters are used to search HMDB (tolerance ± 0.02), by submitting the ppm values of the peak groups within a cluster. When submitting the cluster of 4 peaks, the top hit is 3-hydroxyphenylacetic acid (HMDB00440) with a Jaccard index of 4/9. This molecule is also identified in the original paper as a biomarker for onion intake. However, in the original paper this is done only by looking at a small region around 6.8 ppm, as compared to the speaq 2.0 analysis which yields peaks in multiple ppm regions that can be used for identification. The peak with index 18662 can actually also be assigned to 3-hydroxyphenylacetic acid (raising the Jaccard index to 5/9 upon also submitting this peak to HMDB). When the cluster that only contains peak 19723, with corresponding ppm value of 3.1558, is submitted to HMDB the top hits are dimethyl sulfone and 9-methyluric acid, both with a Jaccard index of 1/1. These results match those from the original paper where dimethyl sulfone (HMDB04983) is identified as a biomarker for onion intake. Raw spectra of the main peaks for both biomarkers are shown in <xref ref-type="supplementary-material" rid="pcbi.1006018.s011">S8 Fig</xref>.</p>
<fig id="pcbi.1006018.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Correlation analysis of significant peaks.</title>
<p>The significant peaks, which are indicated by their peakIndex value, are clustered based on their Pearson correlation. The group of four peaks correspond to the 3-hydroxyphenylacetic acid biomarker, peak nr. 19723 corresponds to the dimethyl sulfone biomarker. Both biomarkers are also identified in the original analysis paper [<xref ref-type="bibr" rid="pcbi.1006018.ref037">37</xref>], but with only one peak for the first biomarker.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.g009" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec024">
<title>The other peaks explained</title>
<p>The other peaks found cannot be identified querying HMDB. The peak with index 19510 is somewhat absorbed in the background. The peak with index 23648 ends up in a cluster with non-significant peaks that are assigned to ethanol within HMDB, when the correlation procedure is run on the entire dataset. As HMDB does not assign the 23648 peak to ethanol, this may indicate that this is a derivative or a byproduct of ethanol. The peak with index 19752 is actually a peak in the tail of the large peak of one of the identified biomarkers, namely dimethyl sulfone. The fact that this peak is significant is caused by an artifact of the wavelet based peak detection since it considers the tail of the large dimethyl sulfone peak as the baseline for the small peak. So when the dimethyl sulfone peak is larger, the baseline for the small peak is also larger and therefore the peak diminishes. This is also the reason why this peak is anti-correlated with the dimethyl sulfone peak.</p>
</sec>
<sec id="sec025">
<title>Comparison with MetaboAnalyst</title>
<p>The MetaboAnalyst [<xref ref-type="bibr" rid="pcbi.1006018.ref012">12</xref>] platform is widely used for the analysis of metabolomics data. The processing of NMR data is also possible, provided the NMR data are supplied as a peak list or as binned data. Since Winning already used the binning approach, we will compare the results of MetaboAnalyst when peak data is supplied. This means the grouping step is performed in MetaboAnalyst thereby allowing the comparison to the speaq 2.0 grouping method. See <xref ref-type="fig" rid="pcbi.1006018.g010">Fig 10</xref> for a visual representation of which steps of the workflow are different. The grouping method performed in MetaboAnalyst uses a moving window to group peaks together. The window is 0.03 ppm wide and moves with steps of 0.015 ppm according to the documentation. If more than one peak per sample is detected in a single group the intensities of these peaks are summed together. After pre-processing with MetaboAnalyst the data matrix (245 features) is extracted and processed with the differential analysis function. So again each column in the MetaboAnalyst matrix gets a (Benjamini-Hochberg corrected) p-value assigned to indicate how well this feature corresponds to the increasing onion diet. The results are presented in <xref ref-type="table" rid="pcbi.1006018.t002">Table 2</xref>. For every highly significant feature in the MetaboAnalyst data, there is at least one highly significant feature from the speaq 2.0 analysis. The difference between both methods is the lower resolution of MetaboAnalyst, as it sums close peaks together. This approach effectively removes a source of information contained in the data as multiplets can aid in the identification of compounds.</p>
<fig id="pcbi.1006018.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Workflow for comparing the results of MetaboAnalyst with speaq 2.0.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.g010" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1006018.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006018.t002</object-id>
<label>Table 2</label>
<caption>
<title>Comparison between MetaboAnalyst and speaq 2.0 for the onion intake in mice dataset.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006018.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" colspan="3">MetaboAnalyst</th>
<th align="center" colspan="3">speaq 2.0</th>
</tr>
<tr>
<th align="left">group ppm</th>
<th align="left">p-value</th>
<th align="right"/>
<th align="left">group ppm</th>
<th align="left">p-value</th>
<th align="right"/>
</tr>
</thead>
<tbody>
<tr>
<td align="char" char="." style="background-color:#e6e6e6">3.479</td>
<td align="left" style="background-color:#e6e6e6">3.48 E-07</td>
<td align="right" style="background-color:#e6e6e6">**</td>
<td align="char" char="." style="background-color:#e6e6e6">3.480</td>
<td align="left" style="background-color:#e6e6e6">2.44 E-04</td>
<td align="right" style="background-color:#e6e6e6">**</td>
</tr>
<tr>
<td align="char" char=".">6.806</td>
<td align="left">6.78 E-07</td>
<td align="right">**</td>
<td align="char" char=".">6.805</td>
<td align="left">7.01 E-07</td>
<td align="right">**</td>
</tr>
<tr>
<td align="left"/>
<td align="left"/>
<td align="right"/>
<td align="char" char=".">6.821</td>
<td align="left">3.02 E-01</td>
<td align="right"/>
</tr>
<tr>
<td align="char" char="." style="background-color:#e6e6e6">6.782</td>
<td align="left" style="background-color:#e6e6e6">2.32 E-05</td>
<td align="right" style="background-color:#e6e6e6">**</td>
<td align="char" char="." style="background-color:#e6e6e6">6.789</td>
<td align="left" style="background-color:#e6e6e6">8.42 E-04</td>
<td align="right" style="background-color:#e6e6e6">**</td>
</tr>
<tr>
<td align="left" style="background-color:#e6e6e6"/>
<td align="left" style="background-color:#e6e6e6"/>
<td align="right" style="background-color:#e6e6e6"/>
<td align="char" char="." style="background-color:#e6e6e6">6.781</td>
<td align="left" style="background-color:#e6e6e6">6.45 E-02</td>
<td align="right" style="background-color:#e6e6e6"/>
</tr>
<tr>
<td align="left" style="background-color:#e6e6e6"/>
<td align="right" style="background-color:#e6e6e6"/>
<td align="left" style="background-color:#e6e6e6"/>
<td align="char" char="." style="background-color:#e6e6e6">6.769</td>
<td align="left" style="background-color:#e6e6e6">7.47 E-01</td>
<td align="right" style="background-color:#e6e6e6"/>
</tr>
<tr>
<td align="left" style="background-color:#e6e6e6"/>
<td align="right" style="background-color:#e6e6e6"/>
<td align="left" style="background-color:#e6e6e6"/>
<td align="char" char="." style="background-color:#e6e6e6">6.763</td>
<td align="left" style="background-color:#e6e6e6">8.59 E-01</td>
<td align="right" style="background-color:#e6e6e6"/>
</tr>
<tr>
<td align="char" char=".">3.156</td>
<td align="left">2.39 E-05</td>
<td align="right">**</td>
<td align="char" char=".">3.156</td>
<td align="left">2.78 E-06</td>
<td align="right">**</td>
</tr>
<tr>
<td align="left"/>
<td align="left"/>
<td align="right"/>
<td align="char" char=".">3.147</td>
<td align="left">8.42 E-04</td>
<td align="right">**</td>
</tr>
<tr>
<td align="left"/>
<td align="left"/>
<td align="right"/>
<td align="char" char=".">3.163</td>
<td align="left">9.15 E-01</td>
<td align="right"/>
</tr>
<tr>
<td align="char" char="." style="background-color:#e6e6e6">6.855</td>
<td align="left" style="background-color:#e6e6e6">1.42 E-04</td>
<td align="right" style="background-color:#e6e6e6">**</td>
<td align="char" char="." style="background-color:#e6e6e6">6.856</td>
<td align="left" style="background-color:#e6e6e6">8.13 E-04</td>
<td align="right" style="background-color:#e6e6e6">**</td>
</tr>
<tr>
<td align="left" style="background-color:#e6e6e6"/>
<td align="left" style="background-color:#e6e6e6"/>
<td align="right" style="background-color:#e6e6e6"/>
<td align="char" char="." style="background-color:#e6e6e6">6.832</td>
<td align="left" style="background-color:#e6e6e6">6.38 E-01</td>
<td align="right" style="background-color:#e6e6e6"/>
</tr>
<tr>
<td align="left" style="background-color:#e6e6e6"/>
<td align="left" style="background-color:#e6e6e6"/>
<td align="right" style="background-color:#e6e6e6"/>
<td align="char" char="." style="background-color:#e6e6e6">6.841</td>
<td align="left" style="background-color:#e6e6e6">9.54 E-01</td>
<td align="right" style="background-color:#e6e6e6"/>
</tr>
<tr>
<td align="char" char=".">2.774</td>
<td align="left">6.40 E-03</td>
<td align="right">**</td>
<td align="char" char=".">2.781</td>
<td align="left">5.67 E-03</td>
<td align="right">**</td>
</tr>
<tr>
<td align="left"/>
<td align="left"/>
<td align="right"/>
<td align="char" char=".">2.773</td>
<td align="left">5.08 E-01</td>
<td align="right"/>
</tr>
<tr>
<td align="char" char="." style="background-color:#e6e6e6">1.324</td>
<td align="left" style="background-color:#e6e6e6">1.07 E-02</td>
<td align="right" style="background-color:#e6e6e6">*</td>
<td align="char" char="." style="background-color:#e6e6e6">1.325</td>
<td align="left" style="background-color:#e6e6e6">9.04 E-03</td>
<td align="right" style="background-color:#e6e6e6">**</td>
</tr>
<tr>
<td align="left" style="background-color:#e6e6e6"/>
<td align="left" style="background-color:#e6e6e6"/>
<td align="right" style="background-color:#e6e6e6"/>
<td align="char" char="." style="background-color:#e6e6e6">1.341</td>
<td align="left" style="background-color:#e6e6e6">1.75 E-02</td>
<td align="right" style="background-color:#e6e6e6">*</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>This table shows the significant groups of MetaboAnalyst and the corresponding peaks found by speaq 2.0 within the same bins. For every highly significant feature in the MetaboAnalyst dataset there is at least one highly significant feature in the speaq 2.0 results. The difference is however quite clear. Whereas MetaboAnalyst constructs a feature by summing intensities of peaks within small intervals, the speaq 2.0 method uses all peaks. Note that the p-values in this table are Benjamini-Hochberg corrected (the default in speaq 2.0). [**<italic>p</italic> &lt; 0.01; * <italic>p</italic> &lt; 0.05].</p>
</fn>
</table-wrap-foot>
</table-wrap>
</sec>
</sec>
</sec>
<sec id="sec026">
<title>Concluding remarks</title>
<p>We present an easy way of converting 1D NMR spectra (or other 1D spectra) to peak data by using wavelets for peak detection. This wavelet based method performs better than binning or other spectra summarizing methods as the dimension of the dataset is greatly reduced with little to no loss of information, while requiring no user intervention. After the wavelet based step the peaks are grouped via a hierarchical clustering method. These groups of peaks are called features. The features can easily be analyzed with a myriad of statistical techniques or data mining approaches. Our method has been implemented in an entirely new version of the existing speaq R package which offered the CluPA algorithm for aligning spectra. This package now provides an entire solution for easy 1D NMR data analysis without the need for binning. Each step in the workflow is available as a single function. Thus, analysis pipelines can be constructed easily and with little additional user interaction, fostering improved research reproducibility and shareability.</p>
<p>Besides the possibility to perform a complete standalone analysis, our method can also be used in tandem with other commonly used tools that rely on summarized spectra. Specifically, it can be used to quickly and efficiently produce a high quality peak list. Such a peak list is the starting point of an analysis with for example the often used MetaboAnalyst [<xref ref-type="bibr" rid="pcbi.1006018.ref012">12</xref>].</p>
<p>The data processed in this article came in a matrix format with ppm values and intensities. Other proprietary software or open-source frameworks are thus needed if only the raw NMR Free Induction Decay signal (FID) is available and conversion to the frequency space is needed. Optional pre-processing steps on the raw FID signal like zero-filling, apodization, and phase-shifting have to be performed prior to employing speaq 2.0, if they are desired. These pre-processing steps are on the road-map for future developments.</p>
<p>We expect the introduced method to be especially useful for processing NMR spectra from large cross-platform experiments that combine NMR and LC-MS. Often software packages like XCMS [<xref ref-type="bibr" rid="pcbi.1006018.ref005">5</xref>] are used to process LC-MS data. These open source packages also employ the standard paradigm of peak-picking, grouping, etc. so the integration of data or results should be facilitated with this framework. The method in itself also has merit as is clearly demonstrated in the case of the onion intake in mice data. The analysis is fast, sensitive to both small and large peaks and user-independent. Also, when comparing the results we obtained to the work presented by Winning et al. [<xref ref-type="bibr" rid="pcbi.1006018.ref037">37</xref>], our analysis required less user interaction and yields more peaks in the end that can be used to identify the possible biomarkers, resulting in an improved confidence in the results.</p>
<p>The user-friendliness of speaq 2.0 should also allow people with little experience in R to use the package. Also, it can serve as an attractive option for researchers interested in switching from closed, proprietary software to open-source, especially if the goal is to speed up analysis, improve reproducibility and increase control over workflows and algorithms.</p>
</sec>
<sec id="sec027">
<title>Availability and future directions</title>
<p>speaq 2.0 is distributed through the existing speaq R package to provide a complete solution for NMR data processing. The package and the code for the presented case studies are freely available on CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=speaq" xlink:type="simple">https://cran.r-project.org/package=speaq</ext-link>) and GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/beirnaert/speaq" xlink:type="simple">https://github.com/beirnaert/speaq</ext-link>). Future directions will aim to provide compatibility with the open source nmrML (<ext-link ext-link-type="uri" xlink:href="http://www.nmrml.org" xlink:type="simple">http://www.nmrml.org</ext-link>) format and to improve on the identification part by combining our approach with Statistical Total Correlation Spectroscopy (STOCSY) [<xref ref-type="bibr" rid="pcbi.1006018.ref038">38</xref>].</p>
</sec>
<sec id="sec028">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006018.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Grouping algorithm details.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006018.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s002" xlink:type="simple">
<label>S2 Appendix</label>
<caption>
<title>Simulated data based comparison of speaq 2.0 vs alignment algorithms.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006018.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s003" xlink:type="simple">
<label>S3 Appendix</label>
<caption>
<title>Silhouette values and the SilhouetR function.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006018.s004" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s004" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Wine data PCA plot.</title>
<p>The PCA score plot shows that Principal Component 2 clearly indicates a difference between red, white and rosé wines.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006018.s005" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s005" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Difficulties arise in crowded spectra.</title>
<p>When many peaks are present in a small region, it is not clear which peaks correspond to each other. The speaq 2.0 method, based on finding peaks and subsequently grouping, performs similar or better compared to the other methods as it sees all peaks and tries to group closer ones together. The CluPA algorithm uses landmark peaks and therefore simply tries to align the largest ones together, which is not correct in this case. Lastly, the icoshift algorithm tries to align the spectra based on correlations but the result in this crowded region is also not satisfactory.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006018.s006" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s006" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>A sample with unique behavior causes issues.</title>
<p>In the region around 5.43 ppm there appear to be two small peaks in all samples. A single sample of red wine has two additional large peaks around the 5.40 ppm region. Every method performs poor in this case: both icoshift and CluPA (speaq v1—v1.2.3) align the two large peaks with the group of small peaks. The CluPA algorithm does this by shifting the entire region to the right, this results in the two small peaks of these spectra to be shifted to the right of the small peaks group around 5.43 ppm. The icoshift algorithm on the other hand introduces some strange artifacts and the two small peaks are gone all together. The speaq 2.0 algorithm deletes one of the large peaks in the grouping step, which it often does if multiple peaks from the same sample are present in one group. This problem is usually mitigated by the peak filling step but in this case it is not.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006018.s007" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s007" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Between-sample shifts that are larger than between-adjacent-peaks shifts can cause problems.</title>
<p>In this case both raw spectra methods perform as expected whereas the speaq 2.0 method does not. Initially peaks are wrongly grouped together. This problem is however detected by the optional <italic>SilhouetR</italic> function in speaq 2.0 which calculates the silhouette values for each group. After the appropriate correction the results are as expected.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006018.s008" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s008" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Raw spectra of the onion intake in mice data.</title>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006018.s009" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s009" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>speaq 2.0 workflow applied to the onion intake in mice data [<xref ref-type="bibr" rid="pcbi.1006018.ref037">37</xref>].</title>
<p>(A) Onion intake in mice peak data after grouping and filling. The gap in the raw data is clearly visible: this data was removed by the study authors because of insufficient water suppression. (B) Excerpt of peak data pre-grouping. (C) Excerpt of peak grouped data.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006018.s010" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s010" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Distribution of uncorrected p-values.</title>
<p>The possible biomarker signals are clearly present on the left as an increase in frequency over the otherwise uniform distribution.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006018.s011" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s011" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>NMR spectra of biomarkers identified by speaq 2.0.</title>
<p>Main peaks of both biomarkers from the onion intake in mice data [<xref ref-type="bibr" rid="pcbi.1006018.ref037">37</xref>]. (Top) dimethyl sulfone and (bottom) 3-hydroxyphenylacetic acid.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006018.s012" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006018.s012" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Spectral alignment algorithms can introduce artifacts.</title>
<p>The results of spectral alignment algorithms is not always optimal when dealing with severely shifted spectra. This is illustrated here for the simulated case vs control data (<italic>m</italic><sub><italic>i</italic></sub> is bimodal). The algorithms can introduce artifacts, i.e. misalign or overcorrected spectra, which affect the following processing steps (e.g. binning).</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Thanks go out to Aida Ligata (Mrzic) for the many fruitful discussion on figures and visualizations. Also we would like to thank all users of the speaq R package for their valuable feedback and support. We dedicate this paper to our colleague, Prof. Sandra Apers, who passed away much too early on February 5th, 2017.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006018.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gowda</surname> <given-names>GN</given-names></name>, <name name-style="western"><surname>Raftery</surname> <given-names>D</given-names></name>. <article-title>Can NMR solve some significant challenges in metabolomics?</article-title> <source>Journal of Magnetic Resonance</source>. <year>2015</year>;<volume>260</volume>:<fpage>144</fpage>–<lpage>160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jmr.2015.07.014" xlink:type="simple">10.1016/j.jmr.2015.07.014</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lanza</surname> <given-names>IR</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ward</surname> <given-names>LE</given-names></name>, <name name-style="western"><surname>Karakelides</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Raftery</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Nair</surname> <given-names>KS</given-names></name>. <article-title>Quantitative metabolomics by 1 H-NMR and LC-MS/MS confirms altered metabolic pathways in diabetes</article-title>. <source>PloS One</source>. <year>2010</year>;<volume>5</volume>(<issue>5</issue>):<fpage>e10538</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0010538" xlink:type="simple">10.1371/journal.pone.0010538</ext-link></comment> <object-id pub-id-type="pmid">20479934</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rhee</surname> <given-names>EP</given-names></name>, <name name-style="western"><surname>Gerszten</surname> <given-names>RE</given-names></name>. <article-title>Metabolomics and cardiovascular biomarker discovery</article-title>. <source>Clinical Chemistry</source>. <year>2012</year>;<volume>58</volume>(<issue>1</issue>):<fpage>139</fpage>–<lpage>147</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1373/clinchem.2011.169573" xlink:type="simple">10.1373/clinchem.2011.169573</ext-link></comment> <object-id pub-id-type="pmid">22110018</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Markley</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Brüschweiler</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Edison</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Eghbalnia</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Powers</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Raftery</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>The future of NMR-based metabolomics</article-title>. <source>Current Opinion in Biotechnology</source>. <year>2017</year>;<volume>43</volume>:<fpage>34</fpage>–<lpage>40</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.copbio.2016.08.001" xlink:type="simple">10.1016/j.copbio.2016.08.001</ext-link></comment> <object-id pub-id-type="pmid">27580257</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Want</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>O’Maille</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Abagyan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Siuzdak</surname> <given-names>G</given-names></name>. <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>. <source>Analytical Chemistry</source>. <year>2006</year>;<volume>78</volume>(<issue>3</issue>):<fpage>779</fpage>–<lpage>787</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ac051437y" xlink:type="simple">10.1021/ac051437y</ext-link></comment> <object-id pub-id-type="pmid">16448051</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weber</surname> <given-names>RJM</given-names></name>, <name name-style="western"><surname>Lawson</surname> <given-names>TN</given-names></name>, <name name-style="western"><surname>Salek</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Ebbels</surname> <given-names>TMD</given-names></name>, <name name-style="western"><surname>Glen</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Goodacre</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Computational tools and workflows in metabolomics: An international survey highlights the opportunity for harmonisation through Galaxy</article-title>. <source>Metabolomics</source>. <year>2017</year>;<volume>13</volume>:<fpage>12</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11306-016-1147-x" xlink:type="simple">10.1007/s11306-016-1147-x</ext-link></comment> <object-id pub-id-type="pmid">28090198</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hao</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Astle</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>De Iorio</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ebbels</surname> <given-names>TM</given-names></name>. <article-title>BATMAN–an R package for the automated quantification of metabolites from nuclear magnetic resonance spectra using a Bayesian model</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>15</issue>):<fpage>2088</fpage>–<lpage>2090</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bts308" xlink:type="simple">10.1093/bioinformatics/bts308</ext-link></comment> <object-id pub-id-type="pmid">22635605</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ravanbakhsh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Bjordahl</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>Mandal</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Grant</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Accurate, fully-automated NMR spectral profiling for metabolomics</article-title>. <source>PloS One</source>. <year>2015</year>;<volume>10</volume>(<issue>5</issue>):<fpage>e0124219</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0124219" xlink:type="simple">10.1371/journal.pone.0124219</ext-link></comment> <object-id pub-id-type="pmid">26017271</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref009">
<label>9</label>
<mixed-citation publication-type="other" xlink:type="simple">Hanson BA. ChemoSpec: Exploratory Chemometrics for Spectroscopy. 2016, R package version 4.4.x</mixed-citation>
</ref>
<ref id="pcbi.1006018.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Xia</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Psychogios</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wishart</surname> <given-names>DS</given-names></name>. <article-title>MetaboAnalyst: a web server for metabolomic data analysis and interpretation</article-title>. <source>Nucleic Acids Research</source>. <year>2009</year>;<volume>37</volume>(<issue>suppl 2</issue>):<fpage>W652</fpage>–<lpage>W660</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkp356" xlink:type="simple">10.1093/nar/gkp356</ext-link></comment> <object-id pub-id-type="pmid">19429898</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Xia</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mandal</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sinelnikov</surname> <given-names>IV</given-names></name>, <name name-style="western"><surname>Broadhurst</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wishart</surname> <given-names>DS</given-names></name>. <article-title>MetaboAnalyst 2.0—a comprehensive server for metabolomic data analysis</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>W1</issue>):<fpage>W127</fpage>–<lpage>W133</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gks374" xlink:type="simple">10.1093/nar/gks374</ext-link></comment> <object-id pub-id-type="pmid">22553367</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Xia</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sinelnikov</surname> <given-names>IV</given-names></name>, <name name-style="western"><surname>Han</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wishart</surname> <given-names>DS</given-names></name>. <article-title>MetaboAnalyst 3.0—making metabolomics more meaningful</article-title>. <source>Nucleic Acids Research</source>. <year>2015</year>;<volume>43</volume>(<issue>W1</issue>):<fpage>W251</fpage>–<lpage>W257</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkv380" xlink:type="simple">10.1093/nar/gkv380</ext-link></comment> <object-id pub-id-type="pmid">25897128</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gaude</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Chignola</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Spiliotopoulos</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Spitaleri</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ghitti</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>García-Manteiga</surname> <given-names>JM</given-names></name>, <etal>et al</etal>. <article-title>muma, An R package for metabolomics univariate and multivariate statistical analysis</article-title>. <source>Current Metabolomics</source>. <year>2013</year>;<volume>1</volume>(<issue>2</issue>):<fpage>180</fpage>–<lpage>189</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2174/2213235X11301020005" xlink:type="simple">10.2174/2213235X11301020005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Worley</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Powers</surname> <given-names>R</given-names></name>. <article-title>MVAPACK: a complete data handling package for NMR metabolomics</article-title>. <source>ACS Chemical Biology</source>. <year>2014</year>;<volume>9</volume>(<issue>5</issue>):<fpage>1138</fpage>–<lpage>1144</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/cb4008937" xlink:type="simple">10.1021/cb4008937</ext-link></comment> <object-id pub-id-type="pmid">24576144</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vu</surname> <given-names>TN</given-names></name>, <name name-style="western"><surname>Valkenborg</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Smets</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Verwaest</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Dommisse</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lemière</surname> <given-names>F</given-names></name>, <etal>et al</etal>. <article-title>An integrated workflow for robust alignment and simplified quantitative analysis of NMR spectrometry data</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>405</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-12-405" xlink:type="simple">10.1186/1471-2105-12-405</ext-link></comment> <object-id pub-id-type="pmid">22014236</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Costa</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Marachin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rocha</surname> <given-names>M</given-names></name>. <article-title>An R package for the integrated analysis of metabolomics and spectral data</article-title>. <source>Computer Methods and Programs in Biomedicine</source>. <year>2016</year>;<volume>129</volume>:<fpage>117</fpage>–<lpage>124</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cmpb.2016.01.008" xlink:type="simple">10.1016/j.cmpb.2016.01.008</ext-link></comment> <object-id pub-id-type="pmid">26853041</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ellinger</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Chylla</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Ulrich</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Markley</surname> <given-names>JL</given-names></name>. <article-title>Databases and software for NMR-based metabolomics</article-title>. <source>Current Metabolomics</source>. <year>2013</year>;<volume>1</volume>(<issue>1</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2174/2213235X11301010028" xlink:type="simple">10.2174/2213235X11301010028</ext-link></comment> <object-id pub-id-type="pmid">24260723</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smolinska</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Blanchet</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Buydens</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Wijmenga</surname> <given-names>SS</given-names></name>. <article-title>NMR and pattern recognition methods in metabolomics: from data acquisition to biomarker discovery: a review</article-title>. <source>Analytica Chimica Acta</source>. <year>2012</year>;<volume>750</volume>:<fpage>82</fpage>–<lpage>97</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.aca.2012.05.049" xlink:type="simple">10.1016/j.aca.2012.05.049</ext-link></comment> <object-id pub-id-type="pmid">23062430</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Craig</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cloarec</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Nicholson</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Lindon</surname> <given-names>JC</given-names></name>. <article-title>Scaling and normalization effects in NMR spectroscopic metabonomic data sets</article-title>. <source>Analytical Chemistry</source>. <year>2006</year>;<volume>78</volume>(<issue>7</issue>):<fpage>2262</fpage>–<lpage>2267</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ac0519312" xlink:type="simple">10.1021/ac0519312</ext-link></comment> <object-id pub-id-type="pmid">16579606</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vu</surname> <given-names>TN</given-names></name>, <name name-style="western"><surname>Laukens</surname> <given-names>K</given-names></name>. <article-title>Getting your peaks in line: a review of alignment methods for NMR spectral data</article-title>. <source>Metabolites</source>. <year>2013</year>;<volume>3</volume>(<issue>2</issue>):<fpage>259</fpage>–<lpage>276</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/metabo3020259" xlink:type="simple">10.3390/metabo3020259</ext-link></comment> <object-id pub-id-type="pmid">24957991</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sousa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Magalhães</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ferreira</surname> <given-names>MMC</given-names></name>. <article-title>Optimized bucketing for NMR spectra: Three case studies</article-title>. <source>Chemometrics and Intelligent Laboratory Systems</source>. <year>2013</year>;<volume>122</volume>:<fpage>93</fpage>–<lpage>102</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chemolab.2013.01.006" xlink:type="simple">10.1016/j.chemolab.2013.01.006</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Reo</surname> <given-names>NV</given-names></name>, <name name-style="western"><surname>DelRaso</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Doom</surname> <given-names>TE</given-names></name>, <name name-style="western"><surname>Raymer</surname> <given-names>ML</given-names></name>. <article-title>Gaussian binning: a new kernel-based method for processing NMR spectroscopic data for metabolomics</article-title>. <source>Metabolomics</source>. <year>2008</year>;<volume>4</volume>(<issue>3</issue>):<fpage>261</fpage>–<lpage>272</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11306-008-0117-3" xlink:type="simple">10.1007/s11306-008-0117-3</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Meyer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sinnaeve</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Van Gasse</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tsiporkova</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Rietzschel</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>De Buyzere</surname> <given-names>ML</given-names></name>, <etal>et al</etal>. <article-title>NMR-based characterization of metabolic alterations in hypertension using an adaptive, intelligent binning algorithm</article-title>. <source>Analytical Chemistry</source>. <year>2008</year>;<volume>80</volume>(<issue>10</issue>):<fpage>3783</fpage>–<lpage>3790</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ac7025964" xlink:type="simple">10.1021/ac7025964</ext-link></comment> <object-id pub-id-type="pmid">18419139</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wishart</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Tzur</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Knox</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Eisner</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>HMDB: the human metabolome database</article-title>. <source>Nucleic Acids Research</source>. <year>2007</year>;<volume>35</volume>(<issue>suppl 1</issue>):<fpage>D521</fpage>–<lpage>D526</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkl923" xlink:type="simple">10.1093/nar/gkl923</ext-link></comment> <object-id pub-id-type="pmid">17202168</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Du</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kibbe</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>SM</given-names></name>. <article-title>Improved peak detection in mass spectrum by incorporating continuous wavelet transform-based pattern matching</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>17</issue>):<fpage>2059</fpage>–<lpage>2065</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btl355" xlink:type="simple">10.1093/bioinformatics/btl355</ext-link></comment> <object-id pub-id-type="pmid">16820428</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>W</given-names></name>. <article-title>Comparison of public peak detection algorithms for MALDI mass spectrometry data analysis</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>;<volume>10</volume>(<issue>1</issue>):<fpage>4</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-10-4" xlink:type="simple">10.1186/1471-2105-10-4</ext-link></comment> <object-id pub-id-type="pmid">19126200</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Savorani</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Tomasi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Engelsen</surname> <given-names>SB</given-names></name>. <article-title>icoshift: A versatile tool for the rapid alignment of 1D NMR spectra</article-title>. <source>Journal of Magnetic Resonance</source>. <year>2010</year>;<volume>202</volume>(<issue>2</issue>):<fpage>190</fpage>–<lpage>202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jmr.2009.11.012" xlink:type="simple">10.1016/j.jmr.2009.11.012</ext-link></comment> <object-id pub-id-type="pmid">20004603</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>MacKinnon</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ge</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Khan</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Somashekar</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Tripathi</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Siddiqui</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Variable reference alignment: An improved peak alignment protocol for NMR spectral data with large intersample variation</article-title>. <source>Analytical Chemistry</source>. <year>2012</year>;<volume>84</volume>(<issue>12</issue>):<fpage>5372</fpage>–<lpage>5379</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ac301327k" xlink:type="simple">10.1021/ac301327k</ext-link></comment> <object-id pub-id-type="pmid">22616856</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gower</surname> <given-names>JC</given-names></name>. <article-title>A general coefficient of similarity and some of its properties</article-title>. <source>Biometrics</source>. <year>1971</year>;<volume>27</volume>(<issue>4</issue>):<fpage>857</fpage>–<lpage>871</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/2528823" xlink:type="simple">10.2307/2528823</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huber</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Carey</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Gentleman</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Anders</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Carlson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Carvalho</surname> <given-names>BS</given-names></name>, <etal>et al</etal>. <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nature Methods</source>. <year>2015</year>;<volume>12</volume>(<issue>2</issue>):<fpage>115</fpage>–<lpage>121</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3252" xlink:type="simple">10.1038/nmeth.3252</ext-link></comment> <object-id pub-id-type="pmid">25633503</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Troyanskaya</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Cantor</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sherlock</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Missing value estimation methods for DNA microarrays</article-title>. <source>Bioinformatics</source>. <year>2001</year>;<volume>17</volume>(<issue>6</issue>):<fpage>520</fpage>–<lpage>525</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/17.6.520" xlink:type="simple">10.1093/bioinformatics/17.6.520</ext-link></comment> <object-id pub-id-type="pmid">11395428</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stekhoven</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Bühlmann</surname> <given-names>P</given-names></name>. <article-title>MissForest—non-parametric missing value imputation for mixed-type data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>28</volume>(<issue>1</issue>):<fpage>112</fpage>–<lpage>118</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr597" xlink:type="simple">10.1093/bioinformatics/btr597</ext-link></comment> <object-id pub-id-type="pmid">22039212</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berg</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Hoefsloot</surname> <given-names>HC</given-names></name>, <name name-style="western"><surname>Westerhuis</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Smilde</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Werf</surname> <given-names>MJ</given-names></name>. <article-title>Centering, scaling, and transformations: improving the biological information content of metabolomics data</article-title>. <source>BMC Genomics</source>. <year>2006</year>;<volume>7</volume>(<issue>1</issue>):<fpage>142</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2164-7-142" xlink:type="simple">10.1186/1471-2164-7-142</ext-link></comment> <object-id pub-id-type="pmid">16762068</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wishart</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Jewison</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Knox</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>HMDB 3.0—the human metabolome database in 2013</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>; <fpage>D801</fpage>–<lpage>D807</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gks1065" xlink:type="simple">10.1093/nar/gks1065</ext-link></comment> <object-id pub-id-type="pmid">23161693</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wei</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Wei</surname> <given-names>MT</given-names></name>. <article-title>Package ‘corrplot’</article-title>. <source>Statistician</source>. <year>2016</year>;<volume>56</volume>:<fpage>316</fpage>–<lpage>324</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006018.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Larsen</surname> <given-names>FH</given-names></name>, <name name-style="western"><surname>van den Berg</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Engelsen</surname> <given-names>SB</given-names></name>. <article-title>An exploratory chemometric study of 1H NMR spectra of table wines</article-title>. <source>Journal of Chemometrics</source>. <year>2006</year>;<volume>20</volume>(<issue>5</issue>):<fpage>198</fpage>–<lpage>208</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/cem.991" xlink:type="simple">10.1002/cem.991</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Winning</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Roldán-Marín</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dragsted</surname> <given-names>LO</given-names></name>, <name name-style="western"><surname>Viereck</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Poulsen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sánchez-Moreno</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>An exploratory NMR nutri-metabonomic investigation reveals dimethyl sulfone as a dietary biomarker for onion intake</article-title>. <source>Analyst</source>. <year>2009</year>;<volume>134</volume>(<issue>11</issue>):<fpage>2344</fpage>–<lpage>2351</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1039/b918259d" xlink:type="simple">10.1039/b918259d</ext-link></comment> <object-id pub-id-type="pmid">19838425</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006018.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cloarec</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Dumas</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Craig</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Barton</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Trygg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hudson</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Statistical total correlation spectroscopy: an exploratory approach for latent biomarker identification from metabolic 1H NMR data sets</article-title>. <source>Analytical chemistry</source>. <year>2005</year>;<volume>77</volume>(<issue>5</issue>):<fpage>1282</fpage>–<lpage>1289</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ac048630x" xlink:type="simple">10.1021/ac048630x</ext-link></comment> <object-id pub-id-type="pmid">15732908</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>