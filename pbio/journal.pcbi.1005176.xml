<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01622</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005176</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence motif analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Chemical characterization</subject><subj-group><subject>Binding analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Gene regulatory networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene regulatory networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biophysics</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Biophysics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Computational techniques</subject><subj-group><subject>Split-decomposition method</subject><subj-group><subject>Multiple alignment calculation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>DNA-binding proteins</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Automated incorporation of pairwise dependency in transcription factor binding site prediction using dinucleotide weight tensors</article-title>
<alt-title alt-title-type="running-head">Transcription factor binding site prediction using dinucleotide weight tensors</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Omidi</surname> <given-names>Saeed</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zavolan</surname> <given-names>Mihaela</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Pachkov</surname> <given-names>Mikhail</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Breda</surname> <given-names>Jeremie</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Berger</surname> <given-names>Severin</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6338-1312</contrib-id>
<name name-style="western">
<surname>van Nimwegen</surname> <given-names>Erik</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Biozentrum, University of Basel, Basel, Switzerland</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Swiss Institute of Bioinformatics, Basel, Switzerland</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Przytycka</surname> <given-names>Teresa M.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>National Center for Biotechnology Information (NCBI), UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> EvN.</p>
</list-item>
<list-item>
<p><bold>Data curation:</bold> SB MP.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> SO JB EvN.</p>
</list-item>
<list-item>
<p><bold>Funding acquisition:</bold> EvN.</p>
</list-item>
<list-item>
<p><bold>Investigation:</bold> SO MZ EvN.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> SO MZ EvN.</p>
</list-item>
<list-item>
<p><bold>Project administration:</bold> EvN.</p>
</list-item>
<list-item>
<p><bold>Resources:</bold> EvN.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> SO MZ EvN.</p>
</list-item>
<list-item>
<p><bold>Supervision:</bold> EvN.</p>
</list-item>
<list-item>
<p><bold>Validation:</bold> SO JB EvN.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> SO.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> SO EvN.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">erik.vannimwegen@unibas.ch</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>7</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>28</day>
<month>7</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>7</issue>
<elocation-id>e1005176</elocation-id>
<history>
<date date-type="received">
<day>4</day>
<month>10</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>2</day>
<month>6</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Omidi et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005176"/>
<abstract>
<p>Gene regulatory networks are ultimately encoded by the sequence-specific binding of (TFs) to short DNA segments. Although it is customary to represent the binding specificity of a TF by a position-specific weight matrix (PSWM), which assumes each position within a site contributes independently to the overall binding affinity, evidence has been accumulating that there can be significant dependencies between positions. Unfortunately, methodological challenges have so far hindered the development of a practical and generally-accepted extension of the PSWM model. On the one hand, simple models that only consider dependencies between nearest-neighbor positions are easy to use in practice, but fail to account for the distal dependencies that are observed in the data. On the other hand, models that allow for arbitrary dependencies are prone to overfitting, requiring regularization schemes that are difficult to use in practice for non-experts. Here we present a new regulatory motif model, called dinucleotide weight tensor (DWT), that incorporates arbitrary pairwise dependencies between positions in binding sites, rigorously from first principles, and free from tunable parameters. We demonstrate the power of the method on a large set of ChIP-seq data-sets, showing that DWTs outperform both PSWMs and motif models that only incorporate nearest-neighbor dependencies. We also demonstrate that DWTs outperform two previously proposed methods. Finally, we show that DWTs inferred from ChIP-seq data also outperform PSWMs on HT-SELEX data for the same TF, suggesting that DWTs capture inherent biophysical properties of the interactions between the DNA binding domains of TFs and their binding sites. We make a suite of DWT tools available at <ext-link ext-link-type="uri" xlink:href="http://dwt.unibas.ch" xlink:type="simple">dwt.unibas.ch</ext-link>, that allow users to automatically perform ‘motif finding’, i.e. the inference of DWT motifs from a set of sequences, binding site prediction with DWTs, and visualization of DWT ‘dilogo’ motifs.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Gene regulatory networks are ultimately encoded in constellations of short binding sites in the DNA and RNA that are recognized by regulatory factors such as transcription factors (TFs). For several decades, computational analysis of regulatory networks has relied on a model of TF sequence-specificity, the position-specific weight-matrix (PSWM), that assumes different positions in a binding site contribute independently to the total binding energy of the TF. However, in recent years evidence has been accumulating that, at least for some TFs, this assumption does not hold. Here we present a new model for the sequence-specificity of TFs, the dinucleotide weight tensor (DWT), that takes arbitrary dependencies between positions in binding sites into account and show that it consistently outperforms PSWMs on high-throughput datasets on TF binding. Moreover, in contrast to previous approaches, DWTs are directly derived from first principles within a Bayesian framework, and contain no tunable parameters. This allows them to be easily applied in practice and we make a suite of tools available for computational analysis with DWTs.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001711</institution-id>
<institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution>
</institution-wrap>
</funding-source>
<award-id>Cellplasticity, SystemsX.ch</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6338-1312</contrib-id>
<name name-style="western">
<surname>van Nimwegen</surname>
<given-names>Erik</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by a grant to EvN (and others): Systems biology of cell plasticity in health and diseases (51RT-0_126031) Swiss National Science Foundation. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="0"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-08-09</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The authors confirm that all data underlying the findings are fully available without restriction. Analysis was based on publicly available ChIP-seq data from the ENCODE project (links to the specific raw files are available at <ext-link ext-link-type="uri" xlink:href="http://crunch.unibas.ch/ENCODE_REPORTS/" xlink:type="simple">http://crunch.unibas.ch/ENCODE_REPORTS/</ext-link>), and on publicly available HT-SELEX data from Jolma et al. (Cell, 2013) as detailed in Table 1 of S1 Text.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Gene regulatory networks are a crucial component of essentially all forms of life, allowing organisms to respond and adapt to their environment, and allowing multi-cellular organisms to express a single genotype into many different cellular phenotypes. Transcription factors (TFs) are central players in gene regulatory networks that bind to DNA in a sequence-specific manner. Although the molecular mechanisms through which TFs regulate expression of their target genes involve a complex interplay of interactions between TFs, co-factors, chromatin modifiers, and signaling molecules, gene regulatory networks are ultimately genetically encoded by constellations of transcription factor binding sites (TFBSs) to which the TFs bind in a sequence-specific manner.</p>
<p>Consequently, a key question in the analysis of gene regulatory networks is to find a proper mathematical representation of the sequence-specificities of TFs. That is, for each TF, we want to determine an energy function <italic>E</italic>(<italic>s</italic>) that calculates, for any given DNA segment <italic>s</italic>, the binding free energy of the TF binding to <italic>s</italic>. The segment <italic>s</italic> is generally of fixed length for a given TF, which typically ranges from 6 to 30 base pairs. Although there have been some attempts to use direct structural and biophysical modeling of the sequence-specificity of TFs, e.g. [<xref ref-type="bibr" rid="pcbi.1005176.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005176.ref003">3</xref>], such efforts have generally achieved only limited accuracy. Instead, by far the most common approach to representing the sequence-specificity of TFs is through a statistical mechanical analysis, which essentially assumes that the probability that a binding site for a particular TF has sequence <italic>s</italic> is given by a maximum entropy distribution with respect to its binding energy <italic>E</italic>(<italic>s</italic>), i.e. <italic>P</italic>(<italic>s</italic>) ∝ <italic>e</italic><sup>λ<italic>E</italic>(<italic>s</italic>)</sup> [<xref ref-type="bibr" rid="pcbi.1005176.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005176.ref005">5</xref>]. Using this assumption, the binding energies <italic>E</italic>(<italic>s</italic>) of sequence segments <italic>s</italic> can in principle be inferred from data on the relative frequencies <italic>P</italic>(<italic>s</italic>) with which different sequences <italic>s</italic> are bound by a given TF. However, the number of possible sequence segments <italic>s</italic> is 4<sup><italic>l</italic></sup>, which is already over a million for relatively short TFBSs of length <italic>l</italic> = 10 base pairs, i.e. much larger than the total number of genome-wide binding sites for a single TF. Thus, a crucial additional assumption, that has been made for several decades [<xref ref-type="bibr" rid="pcbi.1005176.ref006">6</xref>], is to assume that each base pair in the binding site contributes <italic>independently</italic> to the overall binding energy, i.e. <inline-formula id="pcbi.1005176.e001"><alternatives><graphic id="pcbi.1005176.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mi>E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>l</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>E</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>s</italic><sub><italic>i</italic></sub> is the base occurring at position <italic>i</italic> in sequence segment <italic>s</italic> and <inline-formula id="pcbi.1005176.e002"><alternatives><graphic id="pcbi.1005176.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msubsup><mml:mi>E</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the energy contribution of base <italic>α</italic> at position <italic>i</italic>. Under this independence assumption, the sequence-specificity of a TF can be parametrized by 3 × <italic>l</italic> parameters
<disp-formula id="pcbi.1005176.e003"><alternatives><graphic id="pcbi.1005176.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>λ</mml:mo> <mml:msubsup><mml:mi>E</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:msup> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>γ</mml:mi></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>λ</mml:mo> <mml:msubsup><mml:mi>E</mml:mi> <mml:mi>γ</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <inline-formula id="pcbi.1005176.e004"><alternatives><graphic id="pcbi.1005176.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mi>w</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the fraction of binding sites that have letter <italic>α</italic> at position <italic>i</italic>. This is the well-known position specific weight matrix (PSWM) representation which has been used in the vast majority of works on modeling TF binding and TFBS prediction. The main advantage of this approach is the relatively small number of parameters, allowing reasonable estimation of the weight matrix entries <inline-formula id="pcbi.1005176.e005"><alternatives><graphic id="pcbi.1005176.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msubsup><mml:mi>w</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> from as few as a dozen of example binding sites.</p>
<p>With the drastic reduction in costs of DNA sequencing over the last decade and the development of a number of experimental techniques for identifying TFBSs in high-throughput, such as ChIP-seq [<xref ref-type="bibr" rid="pcbi.1005176.ref007">7</xref>], protein binding arrays [<xref ref-type="bibr" rid="pcbi.1005176.ref008">8</xref>], and HT-SELEX [<xref ref-type="bibr" rid="pcbi.1005176.ref009">9</xref>], hundreds if not thousands of example TFBSs for a single TF can now be routinely obtained. Such large collections of TFBSs have enabled researchers to investigate to what extent the assumption of independence, i.e. that each position in the binding site contributes to the binding energy independent of the other positions, holds in practice. The results of these investigations indicate that, although the assumption of independence is often reasonably accurate, there are also many cases which clearly deviate from independence.</p>
<p>Studies going back over a decade, such as [<xref ref-type="bibr" rid="pcbi.1005176.ref010">10</xref>] and [<xref ref-type="bibr" rid="pcbi.1005176.ref011">11</xref>], had already provided evidence that PSWMs can be unsatisfactory in describing DNA binding specificities of particular TFs, and that the assumption of independence often breaks down. More recently, a large-scale study by Bulyk and colleagues assayed 104 distinct mouse TFs using protein binding microarray (PBM) technology and found that, for a large fraction of the TFs investigated, the binding energy landscapes were significantly more complex than assumed by PSWM models [<xref ref-type="bibr" rid="pcbi.1005176.ref012">12</xref>]. Notably, a number of assayed TFs exhibited strong support for pairwise dependencies (PDs) within their binding sites. As another example, Nutiu <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005176.ref013">13</xref>] studied the binding specificity of the yeast TF Gcn4p in detail and showed that it exhibits several strong PDs. Moreover, a model that incorporates these PDs was shown to outperform PSWM models in explaining the observed TFBSs. In summary, all these results suggest that accurate representation of TF sequence-specificities requires that dependencies between positions are taken into account, although it remains unclear how important such dependencies are for the accuracy of TFBS prediction.</p>
<sec id="sec002">
<title>Incorporating pairwise dependencies</title>
<p>Several works have modeled TF binding specificity by including dependence between binding positions. A major challenge is that, when an arbitrary number of dependencies between arbitrary pairs of positions is allowed, the number of possible models and parameters grows rapidly, so that it becomes difficult to reliably identify the best models, and to avoid overfitting. Previous works have taken different approaches for addressing this challenge.</p>
<p>In some approaches, model complexity is directly controlled by only allowing dependencies between adjacent positions, e.g. [<xref ref-type="bibr" rid="pcbi.1005176.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005176.ref015">15</xref>]. However, previous analyses indicated that substantial dependencies can occur between more distal pairs of positions, and our analyses below also indicate that significant dependencies between non-neighboring positions are common. Below we explicitly compare our general DWT model with a restricted model that only incorporates dependencies between adjacent positions.</p>
<p>In other approaches, PDs between arbitrary pairs of positions are in principle allowed, but instead of incorporating all possible pairwise dependencies, different <italic>ad hoc</italic> approaches are employed to restrict the number of PDs that are taken into account. For example, a Bayesian network model by Barash <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005176.ref016">16</xref>] starts by calculating likelihoods for all possible PDs, finds the spanning tree of PDs that has maximum likelihood (ML), and then models the TF binding specificity using only the PDs in this ML spanning tree. That is, of the <italic>l</italic>(<italic>l</italic> − 1)/2 possible PDs, only (<italic>l</italic> − 1) end up being used for modeling the TF binding specificity. As another example, the variable-order Bayesian network model of Grosse and Grau [<xref ref-type="bibr" rid="pcbi.1005176.ref017">17</xref>] starts from a full higher order Markov model (represented as a tree of possible sequence contexts) and then reduces the number of parameters by systematically collapsing different sequence contexts that do not show significantly different statistics in the data, i.e. pruning the tree.</p>
<p>Alternatively, some approaches start from a model without dependencies, and use a greedy algorithm that iteratively adds PDs which maximally improve the model. For example, Sharon <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005176.ref018">18</xref>] express the TF’s binding specificity as a weighted sum of features, where features are propositions that can either be true or false, e.g. a specific pair of nucleotides appears at a particular pair of positions. Features are iteratively added to the model until no additional feature can be found that further improves the model. However, this iterative procedure often leads to overfitting and Sharon <italic>et al.</italic> used a combination of regularization procedures to control model complexity.</p>
<p>A similar iterative approach is used in the work of Santolini <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005176.ref019">19</xref>] where the TF binding specificity is modeled by an inhomogeneous Potts model, which incorporates information from both single and pairs of positions. Individual pairs of positions are iteratively added to the model so as to maximize its likelihood. Here too the authors find that this procedure can easily lead to overfitting and they use the Bayesian information criterion as a regularization scheme to penalize model complexity. Below we will compare the performance of our approach with both the approaches of Sharon <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005176.ref018">18</xref>] and Santolini <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005176.ref019">19</xref>].</p>
<p>In spite of these efforts, no model that incorporates PDs has found widespread application in the community so far. Models that only use adjacent positions are attractive for their simplicity, but fail to capture the distal PDs that are clearly evident in the data. In contrast, models that consider arbitrary PDs make use of <italic>ad hoc</italic> approaches to restrict the number of PDs considered, and employ complex regularization schemes that require expert supervision, which make them harder to use in practice. The current challenge is thus to develop a model that, on the one hand, rigorously incorporates all possible PDs, and that is easy to use in practice, i.e. not requiring expert tuning of parameters or control of model complexity, on the other hand.</p>
<p>Here we present a new Bayesian network model, called dinucleotide weight tensor (DWT), which takes into account all possible PDs within a rigorous probabilistic framework that has no tunable parameters and automatically avoids over-fitting. In particular, in the DWT model all unknown parameters including the topology of the network of direct interactions and the joint probabilities for all dependent pairs of nucleotides within the network are analytically marginalized over, so that binding energies <italic>E</italic>(<italic>s</italic>) that take all PDs into account can be calculated from first principles, and without the need for the user to set any tunable parameters. This makes the DWT model highly robust and easily applicable in practice, i.e. even when there are no significant PDs. Indeed, in addition to presenting the algorithm below, we have also developed a suite of software tools that can be used to perform motif finding with DWTs, visualization of DWT motifs, and TFBS prediction with DWTs, which we make publically available with this publication.</p>
<p>We demonstrate the power of the DWT approach using a large collection of 121 ChIP-seq data-sets representing 92 different human TFs. We show that DWTs outperform PSWMs for a substantial fraction of the TFs, and never perform substantially worse, demonstrating that DWTs automatically avoid over-fitting, even though there are no explicit regularization schemes. Second, we show that DWTs outperform a restricted model that only incorporates dependencies between adjacent positions for the large majority of datasets, demonstrating that distal positions contribute to the accuracy of TFBS prediction. We also show that DWTs substantially outperform two previous approaches [<xref ref-type="bibr" rid="pcbi.1005176.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005176.ref019">19</xref>]. Finally, using HT-SELEX data for a set of TFs for which ChIP-seq data are also available, we show that the DWTs inferred from ChIP-seq data also generally outcompete PSWMs on HT-SELEX data. Since the HT-SELEX experiments are performed <italic>in vitro</italic> using only the DNA binding domains of the TFs, these results suggest that the DWT likely captures aspects of the biophysical interaction between the DNA binding domains of the TFs and their cognate binding sites.</p>
</sec>
</sec>
<sec id="sec003" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec004">
<title>The dinucleotide weight tensor model</title>
<p>We here present the dinucleotide weight tensor (DWT) model for describing TF sequence-specificities using arbitrary pairwise dependencies. The DWT model is based on a Bayesian network model that we have applied previously to model interactions between proteins [<xref ref-type="bibr" rid="pcbi.1005176.ref020">20</xref>] and to predict contacting residues within three-dimensional protein structures [<xref ref-type="bibr" rid="pcbi.1005176.ref021">21</xref>]. The model describes the probability distribution <italic>P</italic>(<italic>s</italic>) of binding site sequence segments <italic>s</italic> as a mixture of all possible factorizations of the joint distribution over <italic>s</italic> into pairwise conditional probabilities between pairs of positions in <italic>s</italic>.</p>
<p>Let <italic>S</italic> denote an ungapped alignment of sequences of a given length <italic>l</italic>, that are hypothesized to correspond to a collection of binding sites for a common TF. A central quantity in probabilistic motif finding is the probability <italic>P</italic>(<italic>S</italic>) that this collection of sequences derives from a common PSWM <italic>w</italic>. Under the assumption of independence that the PSWM model makes, the probability <italic>P</italic>(<italic>S</italic>) is given by a product of the probabilities <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>) for the individual alignment columns <italic>S</italic><sub><italic>i</italic></sub>, i.e. <inline-formula id="pcbi.1005176.e006"><alternatives><graphic id="pcbi.1005176.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>l</mml:mi></mml:msubsup> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Formally, the probability <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>) is given by an integral over all possible PSWM columns <inline-formula id="pcbi.1005176.e007"><alternatives><graphic id="pcbi.1005176.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msup><mml:mi>w</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mi>c</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mi>g</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, i.e. <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>) = ∫<italic>dw</italic><sup><italic>i</italic></sup> <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>|<italic>w</italic><sup><italic>i</italic></sup>)<italic>P</italic>(<italic>w</italic><sup><italic>i</italic></sup>), where <italic>P</italic>(<italic>w</italic><sup><italic>i</italic></sup>) is a prior probability density on the PSWM column and the integral is over the simplex <inline-formula id="pcbi.1005176.e008"><alternatives><graphic id="pcbi.1005176.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005176.e009"><alternatives><graphic id="pcbi.1005176.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>α</mml:mi></mml:msub> <mml:msubsup><mml:mi>w</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Using a Dirichlet prior of the form <inline-formula id="pcbi.1005176.e010"><alternatives><graphic id="pcbi.1005176.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:msub><mml:mo>∏</mml:mo> <mml:mi>α</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>λ</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, the integral can be performed analytically and yields
<disp-formula id="pcbi.1005176.e011"><alternatives><graphic id="pcbi.1005176.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:mn>4</mml:mn> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>4</mml:mn> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>α</mml:mi></mml:munder> <mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>n</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <inline-formula id="pcbi.1005176.e012"><alternatives><graphic id="pcbi.1005176.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the number of sequences in <italic>S</italic> that have letter <italic>α</italic> at position <italic>i</italic>, <italic>n</italic> is the total number of sequences in <italic>S</italic>, and Γ(<italic>x</italic>) is the gamma-function, see e.g. [<xref ref-type="bibr" rid="pcbi.1005176.ref005">5</xref>].</p>
<p>Here we generalize the PSWM model by assuming that arbitrary pairwise dependencies can occur between pairs of positions. In complete analogy with the calculations for the PSWM above, we can introduce a dinucleotide weight tensor <italic>w</italic> for the pairs of positions (<italic>i</italic>, <italic>j</italic>), with components <inline-formula id="pcbi.1005176.e013"><alternatives><graphic id="pcbi.1005176.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> denoting the probability that the combination of letters (<italic>α</italic>, <italic>β</italic>) occurs at the positions (<italic>i</italic>, <italic>j</italic>). Using a Dirichlet prior <inline-formula id="pcbi.1005176.e014"><alternatives><graphic id="pcbi.1005176.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:msub><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>α</mml:mi> <mml:mo>,</mml:mo> <mml:mi>β</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msup><mml:mo>λ</mml:mo> <mml:mo>′</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and integrating over all possible <italic>w</italic><sup><italic>ij</italic></sup> we then obtain the probability <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>, <italic>S</italic><sub><italic>j</italic></sub>) for a pair of columns (<italic>i</italic>, <italic>j</italic>) in complete analogy with the PSWM case
<disp-formula id="pcbi.1005176.e015"><alternatives><graphic id="pcbi.1005176.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:mn>16</mml:mn> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>16</mml:mn> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>n</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <inline-formula id="pcbi.1005176.e016"><alternatives><graphic id="pcbi.1005176.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msubsup><mml:mi>n</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the number of times the combination of letters (<italic>α</italic>, <italic>β</italic>) appears at the pair of positions (<italic>i</italic>, <italic>j</italic>). As we explained previously [<xref ref-type="bibr" rid="pcbi.1005176.ref020">20</xref>] consistency of the mono- and di-nucleotide priors requires that λ = 4λ′. As for the PSWM case [<xref ref-type="bibr" rid="pcbi.1005176.ref022">22</xref>], the results are generally insensitive to the precise setting of 0 &lt; λ ≤ 1 and we use the Jeffrey’s prior λ = 1/2 throughout.</p>
<p>The evidence for dependency in the frequencies of letters at positions (<italic>i</italic>, <italic>j</italic>) can be quantified by the likelihood ratio <italic>R</italic><sub><italic>ij</italic></sub>:
<disp-formula id="pcbi.1005176.e017"><alternatives><graphic id="pcbi.1005176.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
and as we will see below, the matrix <italic>R</italic> of these dependencies <italic>R</italic><sub><italic>ij</italic></sub> will play a crucial role in the calculations. As a side remark on the interpretation of the dependencies <italic>R</italic><sub><italic>ij</italic></sub>, in the limit of a large number of sequences <italic>n</italic>, the Gamma-functions are well approximated by the Stirling approximation Γ(<italic>x</italic> + 1) ≈ <italic>x</italic><sup><italic>x</italic></sup> exp(−<italic>x</italic>) and using this it is easy to show that <inline-formula id="pcbi.1005176.e018"><alternatives><graphic id="pcbi.1005176.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≈</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>I</italic><sub><italic>ij</italic></sub> is the mutual information of the letter frequencies in columns <italic>i</italic> and <italic>j</italic>.</p>
<p>In contrast to the PSWM model, we do not assume that the probability <italic>P</italic>(<italic>S</italic>) simply factorizes into independent probabilities <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>) for each column <italic>i</italic>. Instead, we will approximate the joint probability <italic>P</italic>(<italic>S</italic>) as a mixture of all possible factorizations into pairwise conditional probabilities of the form <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>|<italic>S</italic><sub><italic>j</italic></sub>)<italic>P</italic>(<italic>S</italic><sub><italic>j</italic></sub>|<italic>S</italic><sub><italic>k</italic></sub>)<italic>P</italic>(<italic>S</italic><sub><italic>k</italic></sub>|<italic>S</italic><sub><italic>m</italic></sub>)⋯. For any such factorization, there is a single ‘root’ position that is not dependent on any other position, and each other position <italic>i</italic> is dependent on one ‘parent’ position <italic>π</italic>(<italic>i</italic>). If we consider each position <italic>i</italic> a node of a graph, and draw an edge between each node and its parent node <italic>π</italic>(<italic>i</italic>), then each possible factorization <italic>π</italic> corresponds to a spanning tree of the set of <italic>l</italic> nodes. Noting that the conditional probability <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>|<italic>S</italic><sub><italic>j</italic></sub>) of column <italic>i</italic> given column <italic>j</italic> can be written as <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>|<italic>S</italic><sub><italic>j</italic></sub>) = <italic>R</italic><sub><italic>ij</italic></sub> <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>), we obtain for the probability <italic>P</italic>(<italic>S</italic>|<italic>π</italic>) of the alignment given a particular factorization <italic>π</italic>:
<disp-formula id="pcbi.1005176.e019"><alternatives><graphic id="pcbi.1005176.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>|</mml:mo> <mml:mi>π</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∈</mml:mo> <mml:mi>π</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>r</italic> is the root node and the product on the right-hand side is over all edges in the spanning tree <italic>π</italic>. Note that the first product on the right-hand side corresponds precisely to the probability <italic>P</italic>(<italic>S</italic>) under the PSWM model of <xref ref-type="disp-formula" rid="pcbi.1005176.e011">eq (2)</xref>. The product over the dependencies <italic>R</italic><sub><italic>ij</italic></sub> along the edges (<italic>i</italic>, <italic>j</italic>) of the spanning tree <italic>π</italic> thus precisely quantifies the effects of the pairwise dependencies.</p>
<p>Instead of assuming one particular factorization <italic>π</italic>, we consider all possible factorizations and explicitly marginalize over the unknown factorization. That is, we aim to calculate
<disp-formula id="pcbi.1005176.e020"><alternatives><graphic id="pcbi.1005176.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>π</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>π</mml:mi></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>|</mml:mo> <mml:mi>π</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>π</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>π</mml:mi></mml:munder> <mml:mo>[</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∈</mml:mo> <mml:mi>π</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where |<italic>π</italic>| = <italic>l</italic><sup><italic>l</italic>−2</sup> is the number of spanning trees of a complete graph with <italic>l</italic> nodes. To calculate <italic>P</italic>(<italic>S</italic>) we thus need to sum the product of the <italic>R</italic><sub><italic>ij</italic></sub> over all edges in the spanning tree <italic>π</italic> over all possible spanning trees, which may seem intractable given the large number of possible spanning trees. However, using a generalization of Kirchhoff’s matrix-tree theorem, this sum can be calculated efficiently as the determinant of an <italic>l</italic> − 1 by <italic>l</italic> − 1 matrix [<xref ref-type="bibr" rid="pcbi.1005176.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1005176.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1005176.ref023">23</xref>].</p>
<p>Specifically, the Laplacian <italic>L</italic>(<italic>R</italic>) of matrix <italic>R</italic> is obtained by replacing, for each row <italic>i</italic>, the diagonal element <italic>R</italic><sub><italic>ii</italic></sub> = 0 with minus the sum of the entries on the row, i.e. <italic>L</italic>(<italic>R</italic>)<sub><italic>ii</italic></sub> = −∑<sub><italic>j</italic>≠<italic>i</italic></sub> <italic>R</italic><sub><italic>ij</italic></sub>, and <italic>L</italic>(<italic>R</italic>)<sub><italic>ij</italic></sub> = <italic>R</italic><sub><italic>ij</italic></sub> when <italic>i</italic> ≠ <italic>j</italic>. If we define <italic>D</italic>(<italic>R</italic>) to be any minor of the Laplacian <italic>L</italic>(<italic>R</italic>) of matrix <italic>R</italic>, we finally obtain
<disp-formula id="pcbi.1005176.e021"><alternatives><graphic id="pcbi.1005176.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>π</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
The determinant <italic>D</italic>(<italic>R</italic>) can be calculated efficiently, i.e. in <italic>O</italic>(<italic>l</italic><sup>3</sup>) steps. One complication in practice is that, when there are many sequences in <italic>S</italic> and strong dependencies between some positions, the elements of <italic>R</italic> may vary over many orders of magnitude, causing the numerical calculation of the determinant to become unstable. In the supporting information we describe how we control numerical stability using a rescaling procedure.</p>
</sec>
<sec id="sec005">
<title>Binding site prediction with DWTs</title>
<p>We first briefly review binding site prediction using PSWMs. Assume a set of known TFBSs <italic>S</italic> for a particular TF is given. To predict new TFBSs for this TF one calculates the probabilities <italic>P</italic>(<italic>s</italic>|<italic>S</italic>) that, sampling another sequence from the same PSWM that the set <italic>S</italic> derives from, one would obtain sequence segment <italic>s</italic>. This probability is given by the ratio of the probability <italic>P</italic>(<italic>s</italic>, <italic>S</italic>) that all sequences derive from a common PSWM and the probability <italic>P</italic>(<italic>S</italic>) that the sequences in <italic>S</italic> derive from a common PSWM. Using <xref ref-type="disp-formula" rid="pcbi.1005176.e011">eq (2)</xref> we have
<disp-formula id="pcbi.1005176.e022"><alternatives><graphic id="pcbi.1005176.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>l</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>4</mml:mn> <mml:mo>λ</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where <inline-formula id="pcbi.1005176.e023"><alternatives><graphic id="pcbi.1005176.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the number of times letter <italic>α</italic> occurs at position <italic>i</italic> in the set <italic>S</italic>, and <italic>s</italic><sub><italic>i</italic></sub> is the letter at position <italic>i</italic> in sequence <italic>s</italic>. As the probabilities <italic>P</italic>(<italic>s</italic>|<italic>S</italic>) only depend on the base counts <inline-formula id="pcbi.1005176.e024"><alternatives><graphic id="pcbi.1005176.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, a PSWM is specified by specifying these counts (and the parameter λ of the prior), and the probability to sample any other sequence segment <italic>s</italic> from this PSWM is then given by <xref ref-type="disp-formula" rid="pcbi.1005176.e022">Eq (8)</xref>.</p>
<p>These calculations generalize in a straight-forward manner to our DWT model. The probability to sample sequence segment <italic>s</italic> from the same DWT model as the set <italic>S</italic> is given by
<disp-formula id="pcbi.1005176.e025"><alternatives><graphic id="pcbi.1005176.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>l</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>4</mml:mn> <mml:mo>λ</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <italic>R</italic>(<italic>s</italic>, <italic>S</italic>) is the dependency matrix <italic>R</italic> obtained from the full set of sequences (<italic>s</italic>, <italic>S</italic>) and <italic>R</italic>(<italic>S</italic>) is the dependency matrix obtained from the set of sequences <italic>S</italic>. <xref ref-type="disp-formula" rid="pcbi.1005176.e025">Eq (9)</xref> nicely illustrates that the probability <italic>P</italic>(<italic>s</italic>|<italic>S</italic>) is given by a product of two factors: The first is identical to the PSWM model’s probability, and the second, which incorporates the effects of the dependencies, is given by a ratio of two determinants. As we will see below, for TFs where there are no significant dependencies, the latter ratio automatically becomes 1 and the DWT model automatically reduces to the PSWM model.</p>
<p>Whereas the probabilities <italic>P</italic>(<italic>s</italic>|<italic>S</italic>) for the PSWM model depend only on the counts <inline-formula id="pcbi.1005176.e026"><alternatives><graphic id="pcbi.1005176.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, for the DWT model the probabilities <italic>P</italic>(<italic>s</italic>|<italic>S</italic>) depend on the pair counts <inline-formula id="pcbi.1005176.e027"><alternatives><graphic id="pcbi.1005176.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msubsup><mml:mi>n</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Thus, instead of specifying a set of binding sites <italic>S</italic>, we specify a DWT model <italic>M</italic> by the set of 16<italic>l</italic>(<italic>l</italic> − 1)/2 counts <inline-formula id="pcbi.1005176.e028"><alternatives><graphic id="pcbi.1005176.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>n</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and calculate the probabilities <italic>P</italic>(<italic>s</italic>|<italic>M</italic>) using <xref ref-type="disp-formula" rid="pcbi.1005176.e025">eq (9)</xref>.</p>
<p>Finally, as explained in the supporting information, we adapted the rescaling procedure explained above to ensure numerical stability of the ratio of determinants in <xref ref-type="disp-formula" rid="pcbi.1005176.e025">Eq (9)</xref> while at the same time guaranteeing that <italic>P</italic>(<italic>s</italic>|<italic>S</italic>) remains exactly normalized, i.e. ∑<sub><italic>s</italic></sub> <italic>P</italic>(<italic>s</italic>|<italic>S</italic>) = 1 when summing over all possible length-<italic>l</italic> sequences <italic>s</italic>.</p>
</sec>
<sec id="sec006">
<title>Motif finding with DWTs</title>
<p>To infer a motif <italic>M</italic> from a given set of input sequences, we need to define the likelihood function, i.e. the probability of observing our set of input sequences given the motif model <italic>M</italic>. Whether our input sequences derive from ChIP-seq, HT-SELEX, or a similar experimental procedure, what distinguishes the input sequences from other sequences is that they were bound by the TF in question. Thus, the likelihood should reflect the probability that the observed input sequences were bound to the TF, whereas typical ‘random’ sequences were not. We formalize this idea by imagining that we have a very large set of sequences, with nucleotide composition according to some background model, and that we are sampling sequences from this set in proportion to the probability that they are bound by the TF. The likelihood of our data set of input sequences <italic>S</italic> is then the probability to sample these input sequences from the large pool.</p>
<p>Specifically, we will assume TF binding is well approximated by a thermodynamic equilibrium model and define, for any length-<italic>l</italic> sequence segment <italic>s</italic> its effective ‘binding energy’ (in units of <italic>kT</italic>) as
<disp-formula id="pcbi.1005176.e029"><alternatives><graphic id="pcbi.1005176.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mo>[</mml:mo> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <italic>P</italic>(<italic>s</italic>|<italic>M</italic>) is calculated as described in the previous section and <italic>P</italic>(<italic>s</italic>|<italic>B</italic>) is the probability of the sequence segment <italic>s</italic> under a background model. In this study we use a simple single nucleotide background model, i.e. <inline-formula id="pcbi.1005176.e030"><alternatives><graphic id="pcbi.1005176.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>l</mml:mi></mml:msubsup> <mml:msub><mml:mi>b</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, with <italic>b</italic><sub><italic>α</italic></sub> the overall frequency of letter <italic>α</italic> in the input data. Under a simple thermodynamic model, the probability <italic>P</italic><sub><italic>b</italic></sub>(<italic>s</italic>|<italic>M</italic>, <italic>c</italic>, <italic>E</italic><sub>0</sub>) that an isolated sequence segment <italic>s</italic> is bound by the TF is given by
<disp-formula id="pcbi.1005176.e031"><alternatives><graphic id="pcbi.1005176.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
where <italic>c</italic> is the concentration of the TF and <italic>E</italic><sub>0</sub> is the energy with which the TF can be bound to <italic>s</italic> in a non-specific (i.e. sequence independent) manner. Note that the constant 1 in the denominator corresponds to the statistical weight of the unbound state. In this work we will assume that the concentration <italic>c</italic> of the TF is sufficiently small that binding is not saturated at any of the sequence segments. In this limit, the denominator can be ignored and the probability of binding is well approximated by <inline-formula id="pcbi.1005176.e032"><alternatives><graphic id="pcbi.1005176.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Moreover, for a longer sequence <italic>S</italic>, the binding probability <italic>P</italic><sub><italic>b</italic></sub>(<italic>S</italic>|<italic>M</italic>, <italic>c</italic>, <italic>E</italic><sub>0</sub>) is just the sum of the binding probabilities at each of the segments of <italic>S</italic>:
<disp-formula id="pcbi.1005176.e033"><alternatives><graphic id="pcbi.1005176.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:munder> <mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup> <mml:msub><mml:mi>L</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where we have defined the total binding energy <italic>E</italic>(<italic>S</italic>) of a longer sequence <italic>S</italic> as
<disp-formula id="pcbi.1005176.e034"><alternatives><graphic id="pcbi.1005176.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mo>[</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
and <italic>L</italic><sub><italic>S</italic></sub> is the number of sequence segments in <italic>S</italic>, which includes segments on both the positive and negative strand of the sequence <italic>S</italic>.</p>
<p>For a large set of sequence segments sampled from the background distribution <italic>P</italic>(<italic>s</italic>|<italic>B</italic>), the average binding probability is given by
<disp-formula id="pcbi.1005176.e035"><alternatives><graphic id="pcbi.1005176.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>s</mml:mi></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>P</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>s</mml:mi></mml:munder> <mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
Thus, the total amount of binding to a large set of <italic>B</italic> background segments is <inline-formula id="pcbi.1005176.e036"><alternatives><graphic id="pcbi.1005176.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:mi>B</mml:mi> <mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and, consequently, the probability to sample the sequence <italic>S</italic> from this large pool of sequences is given by
<disp-formula id="pcbi.1005176.e037"><alternatives><graphic id="pcbi.1005176.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mtext>samp</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>B</mml:mi> <mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
Note that the concentration <italic>c</italic> cancels from this expression, i.e. in the limit that binding is not saturated the relative amounts of binding to different sequences becomes independent of the precise concentration of the TF.</p>
<p>Finally, our desired log-likelihood <italic>L</italic>(<italic>M</italic>, <italic>E</italic><sub>0</sub>) is the log-probability to sample all the sequences <italic>S</italic> from our input dataset <italic>D</italic> from the large pool of background sequences:
<disp-formula id="pcbi.1005176.e038"><alternatives><graphic id="pcbi.1005176.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>S</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>D</mml:mi></mml:mrow></mml:munder> <mml:mo form="prefix">log</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mtext>samp</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mtext>constant</mml:mtext> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>S</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>D</mml:mi></mml:mrow></mml:munder> <mml:mo form="prefix">log</mml:mo> <mml:mo>[</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
The aim of the motif finding is to maximize this log-likelihood. To do this our algorithm starts from an initial PSWM model <italic>w</italic> and uses an expectation maximization (EM) algorithm analogous to those used for inferring PSWMs [<xref ref-type="bibr" rid="pcbi.1005176.ref024">24</xref>] to iteratively improve <italic>L</italic>(<italic>M</italic>, <italic>E</italic><sub>0</sub>).</p>
<p>We initialize the DWT from a PSWM that can either be specified by the user, e.g. when a known PSWM motif is already available for the TF in question, or it can be obtained by running a standard PSWM motif finder on the input sequences <italic>S</italic>. The sequences in the set <italic>S</italic> are generally longer than the length <italic>l</italic> of the motif but typically not longer than a few hundred base pairs, e.g. they could consist of the binding peaks obtained in a ChIP-seq experiment.</p>
<p>We then iterate the following steps. First we calculate the binding energies <italic>E</italic>(<italic>s</italic>) for each of the length-<italic>l</italic> segments in the input sequences <italic>S</italic>, and the total binding energies <italic>E</italic>(<italic>S</italic>) of each input sequence. Second, we optimize the non-specific binding energy <italic>E</italic><sub>0</sub> by finding the root of
<disp-formula id="pcbi.1005176.e039">
<alternatives>
<graphic id="pcbi.1005176.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e039" xlink:type="simple"/>
<mml:math display="block" id="M39">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>∂</mml:mi>
<mml:mi>L</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>M</mml:mi>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>E</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>∂</mml:mi>
<mml:msub>
<mml:mi>E</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>=</mml:mo>
<mml:msup>
<mml:mi>e</mml:mi>
<mml:msub>
<mml:mi>E</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:msup>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>S</mml:mi>
<mml:mo>∈</mml:mo>
<mml:mi>D</mml:mi>
</mml:mrow>
</mml:munder>
<mml:mo>[</mml:mo>
<mml:mfrac>
<mml:msub>
<mml:mi>L</mml:mi>
<mml:mi>S</mml:mi>
</mml:msub>
<mml:mrow>
<mml:msup>
<mml:mi>e</mml:mi>
<mml:mrow>
<mml:mi>E</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>S</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>L</mml:mi>
<mml:mi>S</mml:mi>
</mml:msub>
<mml:msup>
<mml:mi>e</mml:mi>
<mml:msub>
<mml:mi>E</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:msup>
</mml:mrow>
</mml:mfrac>
<mml:mo>-</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mi>e</mml:mi>
<mml:msub>
<mml:mi>E</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:msup>
</mml:mrow>
</mml:mfrac>
<mml:mo>]</mml:mo>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula></p>
<p>Third, we predict binding sites in the sequences <italic>S</italic> to calculate the pair counts <inline-formula id="pcbi.1005176.e040"><alternatives><graphic id="pcbi.1005176.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msubsup><mml:mi>n</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, i.e. the expected number of binding sites that have the pair of letters (<italic>α</italic>, <italic>β</italic>) at positions (<italic>i</italic>, <italic>j</italic>). In particular, the probability that the TF is bound in a sequence-specific manner to sequence <italic>S</italic> is
<disp-formula id="pcbi.1005176.e041"><alternatives><graphic id="pcbi.1005176.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
and the probability that it is bound at the specific segment <italic>s</italic> is
<disp-formula id="pcbi.1005176.e042"><alternatives><graphic id="pcbi.1005176.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
The updated pair counts <inline-formula id="pcbi.1005176.e043"><alternatives><graphic id="pcbi.1005176.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msubsup><mml:mi>n</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are then simply given by summing the binding probabilities <italic>P</italic><sub><italic>b</italic></sub>(<italic>s</italic>|<italic>M</italic>, <italic>E</italic><sub>0</sub>) over all sites in which letters (<italic>α</italic>, <italic>β</italic>) occur at the positions (<italic>i</italic>, <italic>j</italic>). These updated pair counts then define the DWT motif <italic>M</italic> for the next iteration, and this procedure is iterated until convergence.</p>
</sec>
<sec id="sec007">
<title>Dilogos graphically represent DWT models</title>
<p>To visualize DWT models, we propose a graphical representation which generalizes the well-known sequence logo and which we call a ‘dilogo’. As an example, <xref ref-type="fig" rid="pcbi.1005176.g001">Fig 1</xref> shows the dilogo for the TF NRF1, which we constructed from ENCODE ChIP-seq data (see below).</p>
<fig id="pcbi.1005176.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005176.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Dilogo for the motif of the TF NRF1.</title>
<p>The top row of the dilogo shows the familiar sequence logo representation of the marginal probabilities <inline-formula id="pcbi.1005176.e044"><alternatives><graphic id="pcbi.1005176.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msubsup><mml:mi>w</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> for each of the letters <italic>α</italic> at each position <italic>i</italic>. The posterior probabilities for dependency between each pair of positions are shown in the square lattice at the bottom of the dilogo, with darker red color indicating higher probability of dependence. Above this square lattice a graph with significant pairwise dependencies is shown: an arrow from node <italic>j</italic> to <italic>i</italic> indicates that the probability of a particular letter at <italic>i</italic> depends on the letter appearing at <italic>j</italic>. Finally, for each position <italic>i</italic> that depends on another position <italic>j</italic>, the probabilities <italic>P</italic>(<italic>s</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>j</italic></sub>) are shown in sequence logo format, with each row corresponding to the identity of the parent letter <italic>s</italic><sub><italic>j</italic></sub> and each column showing the probabilities <italic>P</italic>(<italic>s</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>j</italic></sub>) for the child letter <italic>s</italic><sub><italic>i</italic></sub>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005176.g001" xlink:type="simple"/>
</fig>
<p>The dilogo first of all shows the classical sequence logo representation of the marginal probabilities <inline-formula id="pcbi.1005176.e045"><alternatives><graphic id="pcbi.1005176.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msubsup><mml:mi>w</mml:mi> <mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> at the top. For example, in this example positions 3 − 5 are most likely to show the pattern CGC. Secondly, at the bottom the dilogo shows information about pairwise dependencies evident in the DWT. As explained in the supplementary materials and in previous work on protein contacts [<xref ref-type="bibr" rid="pcbi.1005176.ref025">25</xref>], we can calculate for each pair of positions (<italic>i</italic>, <italic>j</italic>) the posterior probability <italic>P</italic>(<italic>i</italic>, <italic>j</italic>) that the factorization of <italic>P</italic>(<italic>S</italic>) contains a direct dependence between positions <italic>i</italic> and <italic>j</italic>. The probabilities <italic>P</italic>(<italic>i</italic>, <italic>j</italic>) are shown in a square lattice, with the intensity of the color corresponding to the posterior probability. For example, for NRF1 there are high posterior probabilities of interaction between positions (2, 3), (2, 4), (2, 5), (6, 7), (6, 10), and (7, 8).</p>
<p>Because it is unwieldy to show the conditional probabilities <italic>P</italic>(<italic>s</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>j</italic></sub>) for all pairs of positions (<italic>i</italic>, <italic>j</italic>), we select a set of pairwise dependencies that are jointly consistent with a single factorization of the probability <italic>P</italic>(<italic>S</italic>) as follows. We list all pairwise dependencies <italic>P</italic>(<italic>i</italic>, <italic>j</italic>), sorted from highest to lowest probability, and go down the list, adding pairwise dependencies as long as the resulting graph does not contain any loops. The resulting graph of dependencies is shown above the square with posterior probabilities. In this example, position 12 depends on position 5, position 11 also depends on position 5, position 10 depends on position 3, and so on.</p>
<p>Finally, for those positions <italic>i</italic> that are dependent on another position <italic>j</italic>, the conditional probabilities <italic>P</italic>(<italic>s</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>j</italic></sub>) are shown in sequence logo format with one sequence logo (rows in the figure) for each possible state of the parent letter <italic>s</italic><sub><italic>j</italic></sub> (shown on the left of the figure). For example, in the NRF1 example, the letters at position 3 through 5 depend on the letter at position 2. If position 2 shows a G, positions 3 − 5 are very likely to show the pattern CGC. However, when position 2 shows a T, positions 3 − 5 are most likely to show the pattern CTC.</p>
<p>To enable easy application of DWT models in motif finding we have made a tool-box with software available for motif inference with DWTs, prediction of TFBSs using DWTs, and visualization of DWT models using dilogos. Source code and executables can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://dwt.unibas.ch" xlink:type="simple">dwt.unibas.ch</ext-link>.</p>
</sec>
<sec id="sec008">
<title>Calculating likelihoods of HT-SELEX datasets</title>
<p>Given a motif model that assigns energies <italic>E</italic>(<italic>s</italic>) to sequence segments <italic>s</italic>, we calculate the likelihood <italic>L</italic>(<italic>E</italic>) of a HT-SELEX dataset as follows. First, for each sequence <italic>S</italic> that occurs in the HT-SELEX data, we calculate a total energy <italic>E</italic>(<italic>S</italic>) = log[∑<sub><italic>s</italic>∈<italic>S</italic></sub> <italic>e</italic><sup><italic>E</italic>(<italic>s</italic>)</sup>]. One complication is that the HT-SELEX sequences are all very short, i.e. about 20 nucleotides, such that some motifs can be longer than the input HT-SELEX sequences. To deal with this we padded each HT-SELEX sequence with <italic>l</italic>/2 N nucleotides on both the left and right, where <italic>l</italic> is the motif length, and adapted our sequence scoring to calculate energies for sequence segments containing N nucleotides (see supporting information).</p>
<p>We assume that, in each round of the HT-SELEX experiment, the probability of sampling a sequence <italic>S</italic> is proportional to <italic>e</italic><sup><italic>E</italic>(<italic>S</italic>)</sup>. Let <italic>f</italic><sub><italic>t</italic></sub>(<italic>S</italic>) denote the frequency of sequence <italic>S</italic> in the pool of sequences at generation <italic>t</italic> of the HT-SELEX experiment, and let <italic>E</italic>(<italic>S</italic>) denote the total binding energy assigned by the model (either DWT or PSWM) to sequence <italic>S</italic>. Under this model, the probability that a single selected sequence is sequence <italic>S</italic> is given by
<disp-formula id="pcbi.1005176.e046"><alternatives><graphic id="pcbi.1005176.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>|</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:msub><mml:mi>f</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:msub><mml:mi>f</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
If we denote by <italic>n</italic><sub><italic>t</italic></sub>(<italic>s</italic>) the number of occurrences of sequence <italic>S</italic> at generation <italic>t</italic> in the experiment, then the log-likelihood <italic>L</italic>(<italic>E</italic>) of the entire HT-SELEX data-set, given an energy function <italic>E</italic>, is given by
<disp-formula id="pcbi.1005176.e047"><alternatives><graphic id="pcbi.1005176.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>E</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mo>(</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>S</mml:mi></mml:munder> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>|</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
where <italic>T</italic> is the total number of generations in the experiment. This log-likelihood can be compared with the log-likelihood for obtaining the same data by random sampling:
<disp-formula id="pcbi.1005176.e048">
<alternatives>
<graphic id="pcbi.1005176.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e048" xlink:type="simple"/>
<mml:math display="block" id="M48">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:msub>
<mml:mi>L</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
<mml:mo>-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:mo>(</mml:mo>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mi>S</mml:mi>
</mml:munder>
<mml:msub>
<mml:mi>n</mml:mi>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>S</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo form="prefix">log</mml:mo>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:msub>
<mml:mi>f</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>S</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mo>)</mml:mo>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(22)</label>
</disp-formula></p>
<p>However, when we applied this calculation we find, for almost all corresponding HT-SELEX/ChIP-seq combinations, that the likelihood <italic>L</italic><sub>0</sub> is <italic>larger</italic> than the likelihood <italic>L</italic>(<italic>E</italic>), i.e. even for many cases of TFs with well-known motifs. To investigate the origin of this we investigated to what extent the enrichment of sequences from one generation to the next correlates with their predicted energies. In particular, we stratified all sequences into energy bins and calculated the total frequencies <italic>f</italic><sub><italic>t</italic></sub>(<italic>E</italic>) of sequences with predicted energy <italic>E</italic> at each generation <italic>t</italic>. Note that if the probability of a sequence <italic>S</italic> to be selected is proportional to <italic>e</italic><sup><italic>E</italic>(<italic>S</italic>)</sup> then the observed log-enrichment log[<italic>f</italic><sub><italic>t</italic>+1</sub>(<italic>E</italic>)/<italic>f</italic><sub><italic>t</italic></sub>(<italic>E</italic>)] should be directly proportional to the energy <italic>E</italic>. However, we observed that, while the log-enrichment generally correlates well with <italic>E</italic>, the slope of the linear relationship is much less than 1, i.e. log[<italic>f</italic><sub><italic>t</italic>+1</sub>(<italic>E</italic>)/<italic>f</italic><sub><italic>t</italic></sub>(<italic>E</italic>)] = <italic>βE</italic> + constant, with <italic>β</italic> much smaller than 1. That is, it appears that in HT-SELEX the binding energies vary over a smaller range than predicted by the motif models.</p>
<p>To incorporate this observation, we introduce a ‘temperature’ parameter <italic>β</italic>, assume that the probability of selecting a sequence <italic>S</italic> is proportional to <italic>e</italic><sup><italic>βE</italic>(<italic>S</italic>)</sup>, and calculate a log-likelihood <italic>L</italic>(<italic>E</italic>, <italic>β</italic>) that depends on both the motif model energies <italic>E</italic> and the temperature parameter <italic>β</italic>. It is straightforward to show that the difference <italic>dL</italic>(<italic>E</italic>, <italic>β</italic>) between the log-likelihood <italic>L</italic>(<italic>E</italic>, <italic>β</italic>) and the random sampling log-likelihood <italic>L</italic><sub>0</sub> can be written as
<disp-formula id="pcbi.1005176.e049"><alternatives><graphic id="pcbi.1005176.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>d</mml:mi> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>β</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>β</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>(</mml:mo> <mml:mi>β</mml:mi> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:mi>E</mml:mi> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>β</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msup> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where <italic>N</italic>(<italic>t</italic>) = ∑<sub><italic>S</italic></sub> <italic>n</italic><sub><italic>S</italic></sub>(<italic>t</italic>) is the total number of sequences in generation <italic>t</italic>, 〈<italic>E</italic>〉<sub><italic>t</italic></sub> is the average energy of the sequences in generation <italic>t</italic> <disp-formula id="pcbi.1005176.e050"><alternatives><graphic id="pcbi.1005176.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e050" xlink:type="simple"/><mml:math display="block" id="M50"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:mi>E</mml:mi> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>S</mml:mi></mml:munder> <mml:msub><mml:mi>n</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
and 〈<italic>e</italic><sup><italic>βE</italic></sup>〉<sub><italic>t</italic></sub> is the average selection probability of sequences in generation <italic>t</italic></p>
<disp-formula id="pcbi.1005176.e051">
<alternatives>
<graphic id="pcbi.1005176.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e051" xlink:type="simple"/>
<mml:math display="block" id="M51">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mo>⟨</mml:mo>
<mml:msup>
<mml:mi>e</mml:mi>
<mml:mrow>
<mml:mi>β</mml:mi>
<mml:mi>E</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mo>⟩</mml:mo>
</mml:mrow>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mi>N</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mfrac>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mi>S</mml:mi>
</mml:munder>
<mml:msub>
<mml:mi>n</mml:mi>
<mml:mi>S</mml:mi>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msup>
<mml:mi>e</mml:mi>
<mml:mrow>
<mml:mi>β</mml:mi>
<mml:mi>E</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>S</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(25)</label>
</disp-formula>
<p>For each PSWM and DWT model, we optimize <italic>β</italic> so as to maximize <italic>dL</italic>(<italic>E</italic>, <italic>β</italic>) and calculate, as a final performance measure, the log-likelihood difference <italic>dL</italic> per sequence, i.e. <italic>dL</italic>/<italic>N</italic> with <inline-formula id="pcbi.1005176.e052"><alternatives><graphic id="pcbi.1005176.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005176.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mi>N</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
</sec>
<sec id="sec009" sec-type="results">
<title>Results</title>
<sec id="sec010">
<title>DWT models outperform PSWMs and models that only incorporate adjacent dependencies</title>
<p>To compare the performance DWT models with the performance of PSWMs and other motif models, we analyzed a collection of 121 ChIP-seq datasets for 92 different human TFs from the ENCODE consortium [<xref ref-type="bibr" rid="pcbi.1005176.ref026">26</xref>]. The general setup of our performance comparison is shown in <xref ref-type="fig" rid="pcbi.1005176.g002">Fig 2</xref>.</p>
<fig id="pcbi.1005176.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005176.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Comparison of DWT and PSWM performance on ChIP-seq data.</title>
<p><bold>a)</bold> For a given ChIP-seq data-set we use the CRUNCH ChIP-seq analysis pipe-line to identify the top 1000 binding peaks and randomly subdivide these into an training set and a test set of 500 peak sequences each. <bold>b)</bold> Standard PSWM motif finding is used to determine an initial PSWM motif [<xref ref-type="bibr" rid="pcbi.1005176.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005176.ref027">27</xref>]. <bold>c)</bold> Using expectation maximization, a PSWM and a DWT model are fitted on the training data. <bold>d)</bold> Distributions of the predicted binding energies <italic>E</italic>(<italic>S</italic>), under both the DWT and PSWM models, of the 500 peak sequences and a set of 2000 random ‘decoy sequences’ that have the same lengths and dinucleotide composition as the peak sequences. <bold>e)</bold> Precision recall curves demonstrating the ability of the DWT, PSWM, and initial PSWM models to distinguish peak sequences from decoys based on their predicted binding energies.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005176.g002" xlink:type="simple"/>
</fig>
<p>We processed each of the ChIP-seq datasets using CRUNCH, an integrated ChIP-seq analysis pipeline that we developed in-house and that includes automated PSWM motif analysis [<xref ref-type="bibr" rid="pcbi.1005176.ref028">28</xref>]. Full analysis reports on these ChIP-seq datasets as well as links to all the raw ChIP-seq data used are available at <ext-link ext-link-type="uri" xlink:href="http://crunch.unibas.ch/ENCODE_REPORTS/" xlink:type="simple">crunch.unibas.ch/ENCODE_REPORTS/</ext-link>. CRUNCH returns a list of binding peaks, which are typically 100 − 300 base pairs in length, ordered by their significance. For each data-set, we selected the top 1000 binding peaks. The peak sequences were randomly divided into two subsets of 500 sequences, one of which was used as a training set to fit both a PSWM and DWT motif, and one for testing the performance of the fitted motifs. As part of its motif analysis, CRUNCH extracts orthologous sequences from 6 other mammalian species for each peak sequence and multiply aligns these using T-Coffee [<xref ref-type="bibr" rid="pcbi.1005176.ref029">29</xref>]. The motif finder PhyloGibbs [<xref ref-type="bibr" rid="pcbi.1005176.ref022">22</xref>] is then run on these alignments to infer PSWM motifs. CRUNCH further refines these motifs on the multiple alignments of the training sequences using MotEvo [<xref ref-type="bibr" rid="pcbi.1005176.ref030">30</xref>]. For each dataset, we use the top motif returned by CRUNCH as an initial PSWM motif in our analysis and obtained its TFBS predictions on the peak sequences. As an example, <xref ref-type="fig" rid="pcbi.1005176.g002">Fig 2b</xref> shows the initial PSWM motif inferred for the TF CEBPB.</p>
<p>Using this PSWM as a starting motif we then iteratively fitted a PSWM and a DWT motif on the training sequences (<xref ref-type="fig" rid="pcbi.1005176.g002">Fig 2c</xref>). The DWT model was fitted using the EM procedure described in the section on motif finding with DWTs above. In order to compare DWTs and PSWMs on equal footing, a PSWM was also fitted on the same training set using the exact same EM procedure.</p>
<p>We then assess the ability of the fitted DWT and PSWM models to explain the ChIP-seq data. In particular, besides the 500 peak sequences of the test set, we created 2000 random decoy sequences that have the same overall dinucleotide frequencies and distribution of lengths as the binding peaks. For each of these 2500 sequences we calculate an overall binding energy <italic>E</italic>(<italic>S</italic>) according to <xref ref-type="disp-formula" rid="pcbi.1005176.e034">eq (13)</xref> using both the PSWM and DWT motifs inferred from the training set. <xref ref-type="fig" rid="pcbi.1005176.g002">Fig 2d</xref> shows the distributions of binding energies that are assigned to the true binding peaks (black) and the decoy sequences (grey) for the fitted PSWM motif, as well as the fitted DWT motif. Comparison of these distributions makes clear that the predicted binding energies of true binding peaks and decoys show a substantially larger separation in the DWT model. Interestingly, this increased separation results mainly from the binding energies of the decoy sequences being more tightly focused at low values. This behavior is observed for a large number of the TFs that we analyzed.</p>
<p>By systematically varying a cut-off on the binding energy <italic>E</italic>(<italic>S</italic>), we then determine a precision recall curve where, at each cut-off <italic>E</italic><sub><italic>c</italic></sub>, the precision is the fraction of all sequences with <italic>E</italic>(<italic>S</italic>) &gt; <italic>E</italic><sub><italic>c</italic></sub> that are true binding peaks, and the recall is the fraction of all true binding peaks that have <italic>E</italic>(<italic>S</italic>) &gt; <italic>E</italic><sub><italic>c</italic></sub>. <xref ref-type="fig" rid="pcbi.1005176.g002">Fig 2e</xref> shows the precision recall curves of the original input PSWM, the fitted PSWM, and the DWT model for the TF CEBPB. As a final measure of performance we use the area under the precision-recall curve, which equals the average precision, averaged over all recalls between zero and one.</p>
<p>
<xref ref-type="fig" rid="pcbi.1005176.g003">Fig 3a</xref> compares the performance, as measured by average precision, of the DWT and PSWM models on all ENCODE [<xref ref-type="bibr" rid="pcbi.1005176.ref026">26</xref>] ChIP-seq data-sets that we studied. Remarkably, with the exception of some minor score fluctuations, the DWT model performs at least as well as the PSWM model on all data-sets. This shows that, even though the DWT has no explicit regularization scheme or, in fact, any parameters that need to be set by the user, the model never suffers from over-fitting. Moreover, the DWT model clearly outperforms PSWMs for a substantial fraction of the datasets.</p>
<fig id="pcbi.1005176.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005176.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison of the performance of DWT, PSWM, and ADJ models on the ENCODE ChIP-seq data-sets.</title>
<p><bold>a</bold>: Difference in average precision of the DWT and PSWM models across the 121 ChIP-seq datasets. Datasets are sorted from left to right by the difference in average precision. The inset shows the PSWM average precision (horizontal axis) against the DWT precision (vertical axis), with each dot corresponding to one ChIP-seq dataset, as well as the line <italic>y</italic> = <italic>x</italic>. <bold>b</bold>: As in panel a, but now comparing the average precisions of the DWT model with the ADJ model in which only dependencies between adjacent positions are allowed.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005176.g003" xlink:type="simple"/>
</fig>
<p>We investigated whether TFs for which the DWT most significantly outperforms the PSWM tend to fall within particular structural families and did not find any clear association. Although it is true that DWTs without any clear pairwise dependencies do not outperform PSWMs, the reverse will not generally hold. That is, the fact that certain positions show clear dependencies does not guarantee that these dependencies will help distinguish binding sites from decoy sequences. Indeed, there are datasets for which DWTs show pairwise dependencies with very high posterior, but where the DWT does not significantly outperform the PSWM. For example, the TF MEF2A shows several pairs of positions with very strong dependency, but the MEF2A DWT does not significantly outperform the corresponding PSWM (see the table with results at <ext-link ext-link-type="uri" xlink:href="http://crunch.unibas.ch/DWT/table.html" xlink:type="simple">http://crunch.unibas.ch/DWT/table.html</ext-link>).</p>
<p>Previous investigations of dependencies between positions in TFBSs have suggested that dependencies between immediately adjacent positions are much more common and significant than dependencies between distal positions [<xref ref-type="bibr" rid="pcbi.1005176.ref031">31</xref>]. One may thus wonder to what extent the distal dependencies that the DWT infers contribute to the performance of the DWT, or whether a model that uses only dependencies between adjacent positions would perform equally well. As explained in the supporting information, it is straight-forward to adapt the DWT model to only allow dependencies between adjacent positions. We call this version of our motif model the adjacent model (ADJ). We trained and tested the ADJ model in the exact same way as the DWT and PSWM models on all ChIP-seq datasets and <xref ref-type="fig" rid="pcbi.1005176.g003">Fig 3b</xref> shows the performance comparison between the DWT and ADJ models. We find that the DWT outperforms the ADJ model for more than 80% of the datasets and substantially so for about 25% of the datasets.</p>
<p>Whereas the PSWM never substantially outperformed the DWT (the largest difference in average precision being 3%), there is one dataset for which the ADJ model outperformed the DWT by more than 16% in average precision. This is for ChIP-seq experiment performed in the HeLa cell-line with the chromodomain-like TF CHD2. Notably, the CHD2 TF was also assayed in the GM12878 cell-line, and for this dataset the DWT motif did outperform the ADJ motif. We investigated this case in more detail and found that the DWT had converged to a motif without any significant dependencies, whereas the ADJ had converged to a motif with identical consensus, but with several strong adjacent dependencies. As a test, we reran the DWT motif search on this dataset using the trained ADJ model as a starting motif. We found that the DWT search now converged to a motif that does outperform the ADJ model. That is, there are DWT models that outperform the ADJ for this dataset and the reason the DWT performed poorly was that the motif search happened to have gotten stuck in a poor local optimum.</p>
</sec>
<sec id="sec011">
<title>DWTs outperform previously proposed motif models that incorporate distal dependencies</title>
<p>Comparing the performance of DWTs with previously proposed approaches is challenging because readily usable software that can be applied to large-scale ChIP-seq results is often not available, and even when software is available it can be challenging to apply it in a manner that allows meaningful performance comparison. Our discussion of the results on the CHD2 dataset underlined that, in order to compare the performance of different motif models, it is essential that all other sources of variability are kept as constant as possible, i.e. not only should we use the exact same training and test data, also the way the motifs are inferred, the way scores of segments are combined to calculate scores of longer sequences, and so on, should be kept as similar as possible. While it was straightforward to accomplish this for comparing our own PSWM, ADJ, and DWT models in the previous section, this is much more challenging when using software from other groups. However, we performed a comparison analysis with two previous methods that allow distal dependencies, for which software was available.</p>
<p>The authors of the FMM method (Sharon <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005176.ref018">18</xref>]) and the PIM method (Santolini <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005176.ref019">19</xref>]) have not only made software for their motif models available, they also graciously assisted us in adapting their code to allow it to be run in a manner that is as close as possible to the way the DWT model is trained and tested, as detailed in the supporting information.</p>
<p>
<xref ref-type="fig" rid="pcbi.1005176.g004">Fig 4</xref> compares the average precision of the DWT models with those of the PIM and FMM models on the 121 ChIP-seq datasets. We find that, in these tests, the DWT model outperforms the PIM and FMM models on virtually all datasets, and substantially so for a large fraction of the datasets. We want to stress that this does not imply that high-performance PIM and FMM motif models cannot be constructed for these datasets. In our analysis the PIM and FMM motif finders were just run once with default settings and, with appropriate tuning of the parameters, their performance could presumably be substantially improved. However, one of the impediments to the general adoption of more complex motif models has been that running motif inference with these more complex models typically requires expert supervision. One of the main benefits of the DWT model is that it allows robust inference without the need of tuning any parameters.</p>
<fig id="pcbi.1005176.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005176.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Comparison of the performance of the DWT, PIM [<xref ref-type="bibr" rid="pcbi.1005176.ref019">19</xref>] and FMM [<xref ref-type="bibr" rid="pcbi.1005176.ref018">18</xref>] models on the ENCODE ChIP-seq data-sets.</title>
<p><bold>a</bold>: Difference in average precision of the DWT and PIM models across the 121 ChIP-seq datasets. Datasets are sorted from left to right by the difference in average precision. The inset shows the PIM average precision (horizontal axis) against the DWT precision (vertical axis), with each dot corresponding to one ChIP-seq dataset, as well as the line <italic>y</italic> = <italic>x</italic>. <bold>b</bold>: As in panel a, but now comparing the average precisions of the DWT model with the FMM model.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005176.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Pairwise dependencies are enriched at neighboring positions and virtually absent in randomized data</title>
<p>We investigated to what extent pairs of positions that show dependency are restricted to nearest-neighbor interactions. Combining results from all 121 ChIP-seq datasets we calculated the total number of adjacent and and non-adjacent pairs at each posterior probability of dependency. <xref ref-type="fig" rid="pcbi.1005176.g005">Fig 5</xref> shows the reverse cumulative distributions of the total number of adjacent and distal pairs in our data as a function of their posterior probability. While the absolute number of distal dependencies is consistently above the number of adjacent dependencies at each cut-off, it should be noted that the number of possible distal dependencies is almost 7 times as large as the number of possible adjacent dependencies. Thus, the fraction of adjacent positions that shows dependency is significantly higher than the fraction of distal positions that shows dependency. In summary, adjacent positions are more likely to be dependent than distal positions, although in absolute terms there are more distal dependencies.</p>
<fig id="pcbi.1005176.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005176.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Number of adjacent and distal dependencies as a function of the posterior probability of dependency.</title>
<p>The total number of of adjacent (solid red) and distal (solid blue) dependent pairs as a function of a cut-off on the posterior probability of the dependency of the pairs. The dashed lines show the number of adjacent (red) and distal (blue) pairs in randomized data in which DWTs were constructed from sequences sampled from PSWM models.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005176.g005" xlink:type="simple"/>
</fig>
<p>To confirm the statistical significance of the observed dependencies, we constructed a randomized dataset that should be devoid of dependencies as follows. For each dataset we took the inferred DWT and marginalized it to obtain the corresponding PSWM. When then sampled the same number of binding sites from this PSWM as went into the construction of the DWT, and constructed a new DWT from this set of synthetic binding sites. Finally, we calculated the posterior probabilities of dependency in the set of 121 DWTs so constructed. As shown in <xref ref-type="fig" rid="pcbi.1005176.g005">Fig 5</xref>, virtually no dependencies appear in this marginalized data, and the dependencies that do appear have low posterior probabilities.</p>
</sec>
<sec id="sec013">
<title>DWT models trained on ChIP-seq data outperform PSWMs on HT-SELEX data for the same TF</title>
<p>Systematic evolution of ligands by exponential enrichment (SELEX) is a well-established <italic>in vitro</italic> method for studying protein-DNA binding specificity [<xref ref-type="bibr" rid="pcbi.1005176.ref032">32</xref>]. Starting from a random pool of short DNA (or RNA) segments, the sequences are selected for binding to a DNA protein of interest. The sequences that bound the target are then amplified. This selection and amplification is repeated for multiple rounds to systematically enrich for sequences that strongly bind to the target protein. A high-throughput variant of this method (HT-SELEX), in which the sequences from each round are sequenced using next-generation sequencing was introduced by Jolma <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005176.ref033">33</xref>], and has been more recently applied to a large number of human TFs [<xref ref-type="bibr" rid="pcbi.1005176.ref034">34</xref>]. This HT-SELEX data provides a completely independent dataset for comparing the performance of DWT and PSWM models of TF binding affinities. Moreover, whereas ChIP-seq data arguably probe the <italic>in vivo</italic> binding of a TF in a specific cell type, HT-SELEX probes the binding properties of the DNA binding domain of the TF in an <italic>in vitro</italic> setting. It is thus interesting to investigate whether the DWT outcompetes PSWMs in this <italic>in vitro</italic> setting as well, and to what extent the binding specificities that were inferred from the ChIP-seq data also apply to the HT-SELEX data.</p>
<p>We collected, for each of the TFs assayed in [<xref ref-type="bibr" rid="pcbi.1005176.ref034">34</xref>], all of our 121 ChIP-seq datasets that were performed with the same (or very similar) TF. In total there were 45 combinations of HT-SELEX/ChIP-seq experiments that were done with the same TF (see Table 1 in <xref ref-type="supplementary-material" rid="pcbi.1005176.s001">S1 Text</xref>). For each combination we then calculated how well the DWT and PSWM models, as inferred from the ChIP-seq dataset, explain the observed HT-SELEX data.</p>
<p>To model the HT-SELEX data we assume that, at each round of the experiment, sequences are selected according to their binding energy to the TF as explained in the materials and methods. As a performance measure of a given motif model, we calculate the average excess of the log-likelihood per selected sequence in each HT-SELEX generation relative to a model which assumes random sampling of sequences. <xref ref-type="fig" rid="pcbi.1005176.g006">Fig 6</xref> shows the differences in log-likelihood per sequence between the DWT and PSWM models on the 45 combinations of HT-SELEX/ChIP-seq datasets.</p>
<fig id="pcbi.1005176.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005176.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Performance comparison of the DWT and PSWM models on the HT-SELEX data.</title>
<p>Difference in the log-likelihood per sequence between the DWT and PSWM models for each of the 45 corresponding HT-SELEX/ChIP-seq dataset combinations, ordered from left to right by the difference in log-likelihood per sequence. The inset shows the log-likelihood per sequence for the DWT (vertical axis) against the log-likelihood per sequence for the PSWM (horizontal axis), with each dot corresponding to one dataset combination.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005176.g006" xlink:type="simple"/>
</fig>
<p>For 35 of the 45 combinations, the DWT outperforms the PSWM model on the HT-SELEX data (<xref ref-type="fig" rid="pcbi.1005176.g006">Fig 6</xref>). Moreover, there is only one example where the PSWM clearly outperforms the DWT model (this example corresponds to the TF IRF4). Note that, although the log-likelihood differences per sequence are typically modest, given the very large number of observations in these HT-SELEX datasets, improvements as small as 0.001 are still highly statistically significant. In summary, for all but one of the TFs, the DWT model that was inferred from ChIP-seq data performs at least as well and often outperforms the PSWM model on HT-SELEX data for the same TF.</p>
</sec>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>Since its introduction in the early 1980s [<xref ref-type="bibr" rid="pcbi.1005176.ref035">35</xref>], the PSWM model has become the workhorse for binding site prediction in regulatory genomics. However, as data have accumulated, evidence has been mounting over the last decade that there can be significant dependencies between the nucleotides occurring at different positions of regulatory sites. Consequently, there is a need for extending regulatory motif models to take such dependencies into account. However, in order for such an extension to gain wide acceptance the motif model should be rigorous, flexible, be guaranteed to perform at least as well as PSWMs, and be easy to use. Approaches that have been presented so far have either made unrealistic restrictions on the models, e.g. by demanding that dependencies can only exist between neighboring positions, or they have involved complex <italic>ad hoc</italic> regularization schemes to avoid over-fitting, which make them cumbersome to use in practice.</p>
<p>Here we have presented a new motif model, the dinucleotide weight tensor, that is general in that it allows for dependencies between arbitrary positions in the motif, is rigorous in that it is derived from first principles within a Bayesian framework, and avoids over-fitting by explicitly marginalizing over all unknown parameters. In particular, because the model has no parameters that the user needs to tune, it can be easily and robustly applied in practice. Indeed, by inferring DWTs on a large set of ChIP-seq datasets, we have shown that DWTs never perform significantly worse than PSWMs and clearly outcompete them in a substantial fraction of the cases. By showing that, for most datasets, DWTs also outperform a model in which only dependencies between adjacent positions are allowed, we further showed that distal dependencies contribute significantly to the performance of the DWTs. We also showed that DWTs outperform two previously proposed methods that incorporate distal dependencies. Notably, while we were finishing this work, a very interesting new approach was proposed by Siebert and Söding [<xref ref-type="bibr" rid="pcbi.1005176.ref036">36</xref>]. Their motif model is a standard <italic>k</italic>-order Markov model in which each letter depends on the (<italic>k</italic> − 1) previous letters in the site, but a new way for controlling over-fitting is proposed, in which the marginals at lower orders are used a priors for the conditional probabilities at higher orders, and very robust performance of this method is proposed. Interestingly, it would be straightforward to combine this method of setting priors for conditional probabilities with the DWT’s method for summing over possible spanning trees, and this would be an interesting direction to explore for future work.</p>
<p>The fact that DWT models inferred from ChIP-seq data also outperform PSWMs on HT-SELEX data, suggests that the dependencies captured by the DWT reflect something in the biophysics of the interaction between the DNA binding domain of the TF and the DNA sequence of the site. Our observation that, while significant dependencies occur between distal positions, interactions between neighboring positions are the most common, is also consistent with this interpretation. Another interesting area for future research is to investigate the possible structural and biophysical basis for the observed direct dependencies. However, we should note that, in spite of investing considerable efforts ourselves in analyzing whether the occurrence of dependencies can be related to structural features of the TFs, or to the way that they interact with the DNA, we have so far not been able to uncover any consistent biophysical interpretation of the observed dependencies. It is conceivable that there is no simple biophysical interpretation to the direct dependencies. For example, inspection of some of the DWT models suggests that dependencies often cause combinations of deleterious mutations to reduce the binding energy less than predicted by the PSWM model and this might be a global effect that is spread across many dependencies, rather than reflecting particular structural features of the TF-DNA interaction.</p>
<p>Our analysis has also shown that, notwithstanding the fact that DWTs strongly outperform PSWMs for some TFs, for the majority of TFs the improvement that the DWT provides is rather modest. This highlights that, for many TFs, PSWMs are sufficiently accurate for TFBS prediction, and few significant dependencies exist. Consequently, robust practical application of more complex motif models requires strong safe-guards against over-fitting, i.e. because for many TFs there will simply not be many strong dependencies. This is arguably the biggest advantage of the DWT models presented here: DWTs have no parameters to tune, do not overfit, and automatically reduce to a PSWM model when no significant dependencies exist. We believe that these properties make DWTs especially attractive for adopting in practical settings and we hope that many researchers can be convinced to start using DWT models in their motif finding and TFBS prediction.</p>
</sec>
<sec id="sec015">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005176.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005176.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supporting mathematical derivations and a table of all HT-SELEX/ChIP-seq combinations that we analyzed.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>SO thanks Lukas Burger for help with the Bayesian model and its implementation, and Peter Pemberton-Ross and Stephanie Bishop for help with the writing of the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005176.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Paillard</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Lavery</surname> <given-names>R</given-names></name>. <article-title>Analyzing protein-DNA recognition mechanisms</article-title>. <source>Structure</source>. <year>2004</year>;<volume>12</volume>(<issue>1</issue>):<fpage>113</fpage>–<lpage>22</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.str.2003.11.022" xlink:type="simple">10.1016/j.str.2003.11.022</ext-link></comment> <object-id pub-id-type="pmid">14725771</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Endres</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Schulthess</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>Wingreen</surname> <given-names>NS</given-names></name>. <article-title>Toward an atomistic model for predicting transcription-factor binding sites</article-title>. <source>Proteins</source>. <year>2004</year>;<volume>57</volume>(<issue>2</issue>):<fpage>262</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.20199" xlink:type="simple">10.1002/prot.20199</ext-link></comment> <object-id pub-id-type="pmid">15340913</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morozov</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Havranek</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Siggia</surname> <given-names>ED</given-names></name>. <article-title>Protein-DNA binding specificity predictions with structural models</article-title>. <source>Nucleic Acids Res</source>. <year>2005</year>;<volume>33</volume>(<issue>18</issue>):<fpage>5781</fpage>–<lpage>5798</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gki875" xlink:type="simple">10.1093/nar/gki875</ext-link></comment> <object-id pub-id-type="pmid">16246914</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berg</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>von Hippel</surname> <given-names>PH</given-names></name>. <article-title>Selection of DNA binding sites by regulatory proteins: Statistical-mechanical theory and application to operators and promoters</article-title>. <source>J Mol Biol</source>. <year>1987</year>;<volume>193</volume>:<fpage>723</fpage>–<lpage>750</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0022-2836(87)90354-8" xlink:type="simple">10.1016/0022-2836(87)90354-8</ext-link></comment> <object-id pub-id-type="pmid">3612791</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Nimwegen</surname> <given-names>E</given-names></name>. <article-title>Finding regulatory elements and regulatory motifs: a general probabilistic framework</article-title>. <source>BMC Bioinformatics</source>. <year>2007</year>;<volume>8</volume> <issue>Suppl 6</issue>:<fpage>S4</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-8-S6-S4" xlink:type="simple">10.1186/1471-2105-8-S6-S4</ext-link></comment> <object-id pub-id-type="pmid">17903285</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Seeman</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Rosenberg</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Rich</surname> <given-names>A</given-names></name>. <article-title>Sequence-specific recognition of double helical nucleic acids by proteins</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>1976</year>;<volume>73</volume>(<issue>3</issue>):<fpage>804</fpage>–<lpage>808</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.73.3.804" xlink:type="simple">10.1073/pnas.73.3.804</ext-link></comment> <object-id pub-id-type="pmid">1062791</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Johnson</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Mortazavi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Wold</surname> <given-names>B</given-names></name>. <article-title>Genome-wide mapping of in vivo protein-DNA interactions</article-title>. <source>Science</source>. <year>2007</year>;<volume>316</volume>(<issue>5830</issue>):<fpage>1497</fpage>–<lpage>1502</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1141319" xlink:type="simple">10.1126/science.1141319</ext-link></comment> <object-id pub-id-type="pmid">17540862</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mukherjee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Jona</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>XS</given-names></name>, <name name-style="western"><surname>Muzzey</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Snyder</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Rapid analysis of the DNA-binding specificities of transcription factors with DNA microarrays</article-title>. <source>Nat Genet</source>. <year>2004</year>;<volume>36</volume>(<issue>12</issue>):<fpage>1331</fpage>–<lpage>1339</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng1473" xlink:type="simple">10.1038/ng1473</ext-link></comment> <object-id pub-id-type="pmid">15543148</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ogawa</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Biggin</surname> <given-names>MD</given-names></name>. <article-title>High-throughput SELEX determination of DNA sequences bound by transcription factors in vitro</article-title>. <source>Methods Mol Biol</source>. <year>2012</year>;<volume>786</volume>:<fpage>51</fpage>–<lpage>63</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-61779-292-2_3" xlink:type="simple">10.1007/978-1-61779-292-2_3</ext-link></comment> <object-id pub-id-type="pmid">21938619</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Man</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Stormo</surname> <given-names>GD</given-names></name>. <article-title>Non-independence of Mnt repressor-operator interaction determined by a new quantitative multiple fluorescence relative affinity (QuMFRA) assay</article-title>. <source>Nucleic Acids Res</source>. <year>2001</year>;<volume>29</volume>(<issue>12</issue>):<fpage>2471</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/29.12.2471" xlink:type="simple">10.1093/nar/29.12.2471</ext-link></comment> <object-id pub-id-type="pmid">11410653</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bulyk</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>PLF</given-names></name>, <name name-style="western"><surname>Church</surname> <given-names>GM</given-names></name>. <article-title>Nucleotides of transcription factor binding sites exert interdependent effects on the binding affinities of transcription factors</article-title>. <source>Nucleic acids res</source>. <year>2002</year>;<volume>30</volume>(<issue>5</issue>):<fpage>1255</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/30.5.1255" xlink:type="simple">10.1093/nar/30.5.1255</ext-link></comment> <object-id pub-id-type="pmid">11861919</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Badis</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Philippakis</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Talukder</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gehrke</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Jaeger</surname> <given-names>SA</given-names></name>, <etal>et al</etal>. <article-title>Diversity and complexity in DNA recognition by transcription factors</article-title>. <source>Science</source>. <year>2009</year>;<volume>324</volume>(<issue>5935</issue>):<fpage>1720</fpage>–<lpage>3</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1162327" xlink:type="simple">10.1126/science.1162327</ext-link></comment> <object-id pub-id-type="pmid">19443739</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nutiu</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Khrebtukova</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Silva</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Direct measurement of DNA affinity landscapes on a high-throughput sequencing instrument</article-title>. <source>Nat Biotechnol</source>. <year>2011</year>;<volume>29</volume>(<issue>7</issue>):<fpage>659</fpage>–<lpage>664</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.1882" xlink:type="simple">10.1038/nbt.1882</ext-link></comment> <object-id pub-id-type="pmid">21706015</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Siddharthan</surname> <given-names>R</given-names></name>. <article-title>Dinucleotide weight matrices for predicting transcription factor binding sites: generalizing the position weight matrix</article-title>. <source>PLoS One</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>):<fpage>e9722</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0009722" xlink:type="simple">10.1371/journal.pone.0009722</ext-link></comment> <object-id pub-id-type="pmid">20339533</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mathelier</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wasserman</surname> <given-names>WW</given-names></name>. <article-title>The next generation of transcription factor binding site prediction</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>9</issue>):<fpage>e1003214</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003214" xlink:type="simple">10.1371/journal.pcbi.1003214</ext-link></comment> <object-id pub-id-type="pmid">24039567</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref016">
<label>16</label>
<mixed-citation publication-type="other" xlink:type="simple">Barash Y, Elidan G, Friedman N, Kaplan T. Modeling dependencies in protein-DNA binding sites. Proceedings of the seventh annual international conference on Computational molecular biology—RECOMB’03. 2003; p. 28–37.</mixed-citation>
</ref>
<ref id="pcbi.1005176.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ben-Gal</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Shani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gohr</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Arviv</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Shmilovici</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Identification of transcription factor binding sites with variable-order Bayesian networks</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>11</issue>):<fpage>2657</fpage>–<lpage>2666</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti410" xlink:type="simple">10.1093/bioinformatics/bti410</ext-link></comment> <object-id pub-id-type="pmid">15797905</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sharon</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lubliner</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Segal</surname> <given-names>E</given-names></name>. <article-title>A feature-based approach to modeling protein-DNA interactions</article-title>. <source>PLoS Comput Biol</source>. <year>2008</year>;<volume>4</volume>(<issue>8</issue>):<fpage>e1000154</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000154" xlink:type="simple">10.1371/journal.pcbi.1000154</ext-link></comment> <object-id pub-id-type="pmid">18725950</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref019">
<label>19</label>
<mixed-citation publication-type="other" xlink:type="simple">Santolini M, Mora T, Hakim V. Beyond position weight matrices: nucleotide correlations in transcription factor binding sites and their description. arXiv:13024424v1. 2013;.</mixed-citation>
</ref>
<ref id="pcbi.1005176.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Burger</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>van Nimwegen</surname> <given-names>E</given-names></name>. <article-title>Accurate prediction of protein-protein interactions from sequence alignments using a Bayesian method</article-title>. <source>Molecular Systems Biology</source>. <year>2008</year>;<volume>4</volume>(<issue>165</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb4100203" xlink:type="simple">10.1038/msb4100203</ext-link></comment> <object-id pub-id-type="pmid">18277381</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Burger</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>van Nimwegen</surname> <given-names>E</given-names></name>. <article-title>Disentangling Direct from Indirect Co-Evolution of Residues in Protein Alignments</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>(<issue>1</issue>):<fpage>e1000633</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000633" xlink:type="simple">10.1371/journal.pcbi.1000633</ext-link></comment> <object-id pub-id-type="pmid">20052271</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Siddharthan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Siggia</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>van Nimwegen</surname> <given-names>E</given-names></name>. <article-title>PhyloGibbs: A Gibbs Sampling Motif Finder That Incorporates Phylogeny</article-title>. <source>PLoS Comput Biol</source>. <year>2005</year>;<volume>1</volume>(<issue>7</issue>):<fpage>e67</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0010067" xlink:type="simple">10.1371/journal.pcbi.0010067</ext-link></comment> <object-id pub-id-type="pmid">16477324</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meilá</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Jaakkola</surname> <given-names>T</given-names></name>. <article-title>Tractable Bayesian learning of tree belief networks</article-title>. <source>Statistics and Computing</source>. <year>2006</year>;<volume>16</volume>(<issue>1</issue>):<fpage>77</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11222-006-5535-3" xlink:type="simple">10.1007/s11222-006-5535-3</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bailey</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Elkan</surname> <given-names>C</given-names></name>. <article-title>Fitting a mixture model by expectation maximization to discover motifs in biopolymers</article-title>. <source>Proceedings of the Second International Conference on Intelligent Systems for Molecular Biology</source>. <year>1994</year>;<volume>2</volume>:<fpage>28</fpage>–<lpage>36</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005176.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Burger</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>van Nimwegen</surname> <given-names>E</given-names></name>. <article-title>Disentangling direct from indirect co-evolution of residues in protein alignments</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>(<issue>1</issue>):<fpage>e1000633</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000633" xlink:type="simple">10.1371/journal.pcbi.1000633</ext-link></comment> <object-id pub-id-type="pmid">20052271</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>ENCODE-Project-Consortium</collab>. <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>489</volume>(<issue>7414</issue>):<fpage>57</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11247" xlink:type="simple">10.1038/nature11247</ext-link></comment> <object-id pub-id-type="pmid">22955616</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Arnold</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Erb</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Pachkov</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Molina</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>van Nimwegen</surname> <given-names>E</given-names></name>. <article-title>MotEvo: integrated Bayesian probabilistic methods for inferring regulatory sites and motifs on multiple alignments of DNA sequences</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>4</issue>):<fpage>487</fpage>–<lpage>494</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr695" xlink:type="simple">10.1093/bioinformatics/btr695</ext-link></comment> <object-id pub-id-type="pmid">22334039</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref028">
<label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Berger S, Omidi S, Pachkov M, Arnold P, Kelley N, Salatino S, et al. Crunch: Completely Automated Analysis of ChIP-seq Data. bioRxiv. 2016; p. 042903.</mixed-citation>
</ref>
<ref id="pcbi.1005176.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Notredame</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Higgins</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Heringa</surname> <given-names>J</given-names></name>. <article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment</article-title>. <source>Journal of molecular biology</source>. <year>2000</year>;<volume>302</volume>:<fpage>205</fpage>–<lpage>217</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.2000.4042" xlink:type="simple">10.1006/jmbi.2000.4042</ext-link></comment> <object-id pub-id-type="pmid">10964570</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Arnold</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Erb</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Pachkov</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Molina</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>van Nimwegen</surname> <given-names>E</given-names></name>. <article-title>MotEvo: integrated Bayesian probabilistic methods for inferring regulatory sites and motifs on multiple alignments of DNA sequences</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>4</issue>):<fpage>487</fpage>–<lpage>494</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr695" xlink:type="simple">10.1093/bioinformatics/btr695</ext-link></comment> <object-id pub-id-type="pmid">22334039</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ruan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pandey</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Stormo</surname> <given-names>GD</given-names></name>. <article-title>Improved models for transcription factor binding site identification using nonindependent interactions</article-title>. <source>Genetics</source>. <year>2012</year>;<volume>191</volume>(<issue>3</issue>):<fpage>781</fpage>–<lpage>790</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.112.138685" xlink:type="simple">10.1534/genetics.112.138685</ext-link></comment> <object-id pub-id-type="pmid">22505627</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tuerk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>L</given-names></name>. <article-title>Systematic evolution of ligands by exponential enrichment: RNA ligands to bacteriophage T4 DNA polymerase</article-title>. <source>Science</source>. <year>1990</year>;<volume>249</volume>(<issue>4968</issue>):<fpage>505</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.2200121" xlink:type="simple">10.1126/science.2200121</ext-link></comment> <object-id pub-id-type="pmid">2200121</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jolma</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kivioja</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Toivonen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Wei</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Enge</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Multiplexed massively parallel SELEX for characterization of human transcription factor binding specificities</article-title>. <source>Genome Res</source>. <year>2010</year>;<volume>20</volume>(<issue>6</issue>):<fpage>861</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.100552.109" xlink:type="simple">10.1101/gr.100552.109</ext-link></comment> <object-id pub-id-type="pmid">20378718</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jolma</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Whitington</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Toivonen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nitta</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Rastas</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>DNA-binding specificities of human transcription factors</article-title>. <source>Cell</source>. <year>2013</year>;<volume>152</volume>(<issue>1-2</issue>):<fpage>327</fpage>–<lpage>39</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2012.12.009" xlink:type="simple">10.1016/j.cell.2012.12.009</ext-link></comment> <object-id pub-id-type="pmid">23332764</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stormo</surname> <given-names>GD</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ehrenfeucht</surname> <given-names>A</given-names></name>. <article-title>Use of the’Perceptron’algorithm to distinguish translational initiation sites in E. coli</article-title>. <source>Nucleic Acids Research</source>. <year>1982</year>;<volume>10</volume>(<issue>9</issue>):<fpage>2997</fpage>. <object-id pub-id-type="pmid">7048259</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005176.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Siebert</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Söding</surname> <given-names>J</given-names></name>. <article-title>Bayesian Markov models consistently outperform PWMs at predicting motifs in nucleotide sequences</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>13</issue>):<fpage>6055</fpage>–<lpage>6069</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkw521" xlink:type="simple">10.1093/nar/gkw521</ext-link></comment> <object-id pub-id-type="pmid">27288444</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>