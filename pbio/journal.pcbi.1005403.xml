<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005403</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00624</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence motif analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cell physiology</subject><subj-group><subject>Cell binding</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Chemical characterization</subject><subj-group><subject>Binding analysis</subject><subj-group><subject>Cell binding assay</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>DNA-binding proteins</subject><subj-group><subject>Nucleases</subject><subj-group><subject>Deoxyribonucleases</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Enzymology</subject><subj-group><subject>Enzymes</subject><subj-group><subject>Hydrolases</subject><subj-group><subject>Nucleases</subject><subj-group><subject>Deoxyribonucleases</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Enzymes</subject><subj-group><subject>Hydrolases</subject><subj-group><subject>Nucleases</subject><subj-group><subject>Deoxyribonucleases</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Signal filtering</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>DNA filter assay</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>DNA filter assay</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>DNA-binding proteins</subject><subj-group><subject>Transcription factors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject><subj-group><subject>Gene regulation</subject><subj-group><subject>Transcription factors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Regulatory proteins</subject><subj-group><subject>Transcription factors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Imputation for transcription factor binding predictions based on deep learning</article-title>
<alt-title alt-title-type="running-head">Imputation for transcription factor binding predictions</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Qin</surname>
<given-names>Qian</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4180-3323</contrib-id>
<name name-style="western">
<surname>Feng</surname>
<given-names>Jianxing</given-names>
</name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Department of Bioinformatics, School of Life Sciences and Technology, Tongji University, Shanghai, China</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ioshikhes</surname>
<given-names>Ilya</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Ottawa University, CANADA</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"><list-item><p><bold>Conceived and designed the experiments:</bold> JF.</p></list-item> <list-item><p><bold>Performed the experiments:</bold> JF QQ.</p></list-item> <list-item><p><bold>Analyzed the data:</bold> JF QQ.</p></list-item> <list-item><p><bold>Contributed reagents/materials/analysis tools:</bold> JF.</p></list-item> <list-item><p><bold>Wrote the paper:</bold> JF QQ.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">feng@tongji.edu.cn</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>24</day>
<month>2</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<month>2</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>2</issue>
<elocation-id>e1005403</elocation-id>
<history>
<date date-type="received">
<day>18</day>
<month>4</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>9</day>
<month>2</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Qin, Feng</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005403"/>
<abstract>
<p>Understanding the cell-specific binding patterns of transcription factors (TFs) is fundamental to studying gene regulatory networks in biological systems, for which ChIP-seq not only provides valuable data but is also considered as the gold standard. Despite tremendous efforts from the scientific community to conduct TF ChIP-seq experiments, the available data represent only a limited percentage of ChIP-seq experiments, considering all possible combinations of TFs and cell lines. In this study, we demonstrate a method for accurately predicting cell-specific TF binding for TF-cell line combinations based on only a small fraction (4%) of the combinations using available ChIP-seq data. The proposed model, termed TFImpute, is based on a deep neural network with a multi-task learning setting to borrow information across transcription factors and cell lines. Compared with existing methods, TFImpute achieves comparable accuracy on TF-cell line combinations with ChIP-seq data; moreover, TFImpute achieves better accuracy on TF-cell line combinations without ChIP-seq data. This approach can predict cell line specific enhancer activities in K562 and HepG2 cell lines, as measured by massively parallel reporter assays, and predicts the impact of SNPs on TF binding.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Transcription factors play a central role in regulating various cellular processes. They bind to DNA in a cell-specific way. To study where a TF would bind to DNA, ChIP-seq experiment has been developed and widely adopted by the science community to study genome-wide in vivo protein-DNA interactions. However, for each TF, only a limited number of cell types have been explored by ChIP-seq experiments. To study the binding of a TF to a DNA sequence in a cell line without corresponding ChIP-seq data, researchers would check whether there is a motif for the TF in the sequence. However, motif alone contains only sequence information and therefore cannot reflect the cell specificity of TF binding. In this work, we demonstrate how to model the TF binding problem using deep learning and achieve cell specific binding prediction for TF-cell line combinations without ChIP-seq data.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
<institution>National Natural Science Foundation of China</institution>
</institution-wrap>
</funding-source>
<award-id>31301096</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4180-3323</contrib-id>
<name name-style="western">
<surname>Feng</surname>
<given-names>Jianxing</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
<institution>National Natural Science Foundation of China</institution>
</institution-wrap>
</funding-source>
<award-id>31329003</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Qin</surname>
<given-names>Qian</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This project was supported by National Natural Science Foundation of China 31301096 and National Natural Science Foundation of China grant 31329003. <ext-link ext-link-type="uri" xlink:href="http://www.nsfc.gov.cn/" xlink:type="simple">http://www.nsfc.gov.cn/</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="5"/>
<page-count count="20"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-03-10</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>ChIP-seq data are from the ENCODE project accessible from <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeAwgTfbsUniform/" xlink:type="simple">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeAwgTfbsUniform/</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeUwDnase/" xlink:type="simple">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeUwDnase/</ext-link>. Enhancer data are from the study 'Systematic dissection of regulatory motifs in 2000 predicted human enhancers using a massively parallel reporter assay. Genome Res. 2013 May 1;23(5):800–11. '. GC matched negative instance dataset from ‘Ghandi M, Lee D, Mohammad-Noori M, et al., Enhanced Regulatory Sequence Prediction Using Gapped k-mer Features. PLoS Comput Biol 2014;10:e1003711. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003711" xlink:type="simple">10.1371/journal.pcbi.1003711</ext-link>’. DeepSEA dataset from ‘Zhou J, Troyanskaya OG, Predicting effects of noncoding variants with deep learning—based sequence model. Nat Methods 2015;12:931–4. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3547" xlink:type="simple">10.1038/nmeth.3547</ext-link>’. DNase-seq dataset from <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeUwDgf" xlink:type="simple">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeUwDgf</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeOpenChromDnase" xlink:type="simple">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeOpenChromDnase</ext-link>, and <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeUwDnase" xlink:type="simple">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeUwDnase</ext-link>. PIQ dataset from <ext-link ext-link-type="uri" xlink:href="http://piq.csail.mit.edu/data/misc/" xlink:type="simple">http://piq.csail.mit.edu/data/misc/</ext-link>. External Cistrome dataset from “Mei S, Qin Q, Wu Q, et al., Cistrome Data Browser: a data portal for ChIP-Seq and chromatin accessibility data in human and mouse. Nucleic Acids Res 2016;:gkw983. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkw983" xlink:type="simple">10.1093/nar/gkw983</ext-link>”.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> methods paper</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Transcription factors (TFs) play a central role in regulating gene expression. Although TF binding to chromatin is primarily dictated by the DNA sequence, the binding patterns can be cell-specific through cooperative interactions between many different TFs. Mutations in cis-regulatory elements can influence TF binding, with potentially deleterious effects [<xref ref-type="bibr" rid="pcbi.1005403.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005403.ref003">3</xref>]; therefore, it is important to assess the impact of cis-element mutations on cell-specific TF binding and gene expression. ChIP-seq has been the gold standard for evaluating cell-specific TF binding [<xref ref-type="bibr" rid="pcbi.1005403.ref004">4</xref>]. However, despite tremendous efforts from the scientific community to generate large-scale TF ChIP-seq data, such as those undertaken by the ENCODE consortium [<xref ref-type="bibr" rid="pcbi.1005403.ref005">5</xref>], most TFs have been profiled for only a limited number of cells and conditions. Therefore, computational modeling of TF ChIP-seq data to infer the underlying binding rules and to predict TF binding under un-profiled conditions could be a useful and economical approach.</p>
<p>The classical computational model employed to describe TF binding preferences is based on position weight matrices (PWMs) or motifs [<xref ref-type="bibr" rid="pcbi.1005403.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1005403.ref011">11</xref>]. In addition to binding motifs, other sequence features, such as low-affinity binding sites, flanking DNA, and certain repeat sequence symmetries flanking specific targets, also influence TF binding affinity [<xref ref-type="bibr" rid="pcbi.1005403.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1005403.ref014">14</xref>]. To better model TF-DNA binding specificity, many DNA-sequence-based models beyond PWM have been proposed [<xref ref-type="bibr" rid="pcbi.1005403.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref016">16</xref>]. In vivo TF binding is also affected by many other factors such as TF-TF interactions and sequence GC bias. Such information is naturally incorporated in TF ChIP-seq data yet are missing from TF motifs. Therefore, computational models built on ChIP-seq data [<xref ref-type="bibr" rid="pcbi.1005403.ref017">17</xref>–<xref ref-type="bibr" rid="pcbi.1005403.ref019">19</xref>] have the potential to capture this information to achieve higher accuracy than those built solely on DNA motifs for in vivo TF binding prediction [<xref ref-type="bibr" rid="pcbi.1005403.ref020">20</xref>]; however, such studies are limited by the available ChIP-seq data. Last, but not least, the epigenetic landscapes, such as those profiled by histone modification ChIP-seq and DNase-seq, are closely related to TF binding. Computational methods considering motif occurrences in open chromatin regions [<xref ref-type="bibr" rid="pcbi.1005403.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1005403.ref024">24</xref>] often achieve high accuracy. Such models and TF ChIP-seq data based models may compensate each other.</p>
<p>Deep learning has been actively studied in the machine learning community and has been successfully applied to diverse problems such as image processing, computer vision, speech recognition, and natural language processing over the past decade [<xref ref-type="bibr" rid="pcbi.1005403.ref025">25</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref026">26</xref>]. Recently, deep learning techniques were applied to regulatory genomics and showed exciting performance improvements compared to previous methods [<xref ref-type="bibr" rid="pcbi.1005403.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref027">27</xref>]. Intuitively, when models based on deep learning are trained on ChIP-seq datasets, they can automatically extract sequence features determining TF binding affinity. The extracted features contain not only traditional motifs but also sequence features from a wide window (1,000 bp) flanking the binding sites and TF-TF interactions. However, these models rely on training and cross validation with available ChIP-seq or DNase-seq data and thus are not suitable when such data for a specific cell condition are missing.</p>
<p>In this study, we developed a deep learning method, i.e., TFImpute, to predict cell-specific TF binding based on existing ChIP-seq data. TFImpute embeds cell lines and TFs into continuous vectors that serve as part of the model input. After being trained on available ChIP-seq data from 562 unique TF-cell line combinations (4% of all possible combinations) with 172 transcription factors and 91 cell lines [<xref ref-type="bibr" rid="pcbi.1005403.ref005">5</xref>], TFImpute predicted TF binding for the remaining 96% TF-cell combinations, for which ChIP-seq data were unavailable. Compared to the existing methods, TFImpute gives more accurate predictions for the binding of TFs on cell types without corresponding ChIP-seq data. Although the imputation of TF binding is considered more challenging than the imputation of epigenetic marks on cell lines without ChIP-seq data [<xref ref-type="bibr" rid="pcbi.1005403.ref028">28</xref>], our predictions based on TFImpute are highly consistent with results based on massively parallel reporter assays and with evidence in the literature for the selected SNPs.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Models</title>
<p>Given a DNA sequence, a TF and a cell line, TFImpute (<xref ref-type="fig" rid="pcbi.1005403.g001">Fig 1</xref>) predicts whether the TF would bind to the DNA sequence in this cell line. For DNA sequences, the 1-hot encoded signal [<xref ref-type="bibr" rid="pcbi.1005403.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref027">27</xref>] is first passed through a convolution layer [<xref ref-type="bibr" rid="pcbi.1005403.ref029">29</xref>], which consists of a set of filters. Each of the filters detects whether a specific sequence pattern, i.e. motif, appears in the DNA sequence.</p>
<fig id="pcbi.1005403.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005403.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The TFImpute model.</title>
<p>Each input is a TF-cell-sequence triple. In the convolution layer, each filter (motif) corresponds to a column. Each filter scans the input sequence and produces one value at each stop. For each filter, the max-pooling layer partitions the signal into three windows and takes the maximum value in each window to obtain three values. The same gate signal operates on the three values, and the gate signal is different for different filters. For each input, the reverse complement of the input sequence together with the TF and cell line is constructed and used as another input for the same network. Therefore, for each input, we obtained two values for forward and reverse strand of the sequence: P1 and P2. The maximum of P1 and P2 is taken as the final prediction. During training, the prediction was compared with the target, and the error was back-propagated to learn the parameters of the whole network.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.g001" xlink:type="simple"/>
</fig>
<p>For TFs and cell lines, a technique called embedding [<xref ref-type="bibr" rid="pcbi.1005403.ref030">30</xref>] is used to encode each TF or cell line as a continuous vector. For each input TF and cell line, their embedding is concatenated and used to calculate a set of gates. The gates are used to tune the signal processed by the convolution layer such that only signals detected by filters related to the current TF and cell line will pass through. For example, if the input DNA sequence contains a motif of the input TF but the TF is not expressed in the input cell line, the signal detected by the filter related to the motif can be tuned down by the gating mechanism.</p>
<p>In the model, embedding for TFs and cell lines, the sequence pattern filters and all other network connections are parameters. To learn these parameters, TFImpute first gives a prediction based on its current parameters and the input, and then compares the prediction with the true label. The difference between the prediction and the truth, i.e. the error, is back-propagated through the whole network, and all the model parameters are updated using AdaDelta [<xref ref-type="bibr" rid="pcbi.1005403.ref031">31</xref>], a variant of the stochastic gradient descent algorithm (See the <xref ref-type="sec" rid="sec013">Materials and methods</xref> section for details).</p>
</sec>
<sec id="sec003" sec-type="results">
<title>Results</title>
<sec id="sec004">
<title>Using random sequences as background</title>
<p>To validate the TFImpute model, we first compared it with DeepBind [<xref ref-type="bibr" rid="pcbi.1005403.ref019">19</xref>], one of the latest deep learning models for TF binding prediction with superior performance to that of several other benchmark methods not based on deep learning. The experimental setting follows [<xref ref-type="bibr" rid="pcbi.1005403.ref019">19</xref>] with a slight modification. Specifically, we used ChIP-seq peaks from the ENCODE project [<xref ref-type="bibr" rid="pcbi.1005403.ref005">5</xref>] as the training, validating, and testing data. For each peak region, we utilized 100 bp of DNA sequence around the peak center as the positive peaks and randomly shuffled nucleotides with the number of dinucleotides matching those for each positive peak as the negative peaks. For each ChIP-seq dataset, DeepBind builds a separate model using even-numbered peaks from the top 1,000 peaks as the test set and all other peaks as the training set. For TFImpute, we used the same test set but employed only odd-numbered peaks from the top 1,000 peaks as the training set. In other words, for TFImpute, each ChIP-seq dataset contributed only 500 positive peaks and 500 negative peaks for training. Instead of training a separate model for each ChIP-seq dataset, we trained TFImpute for a single model based on all the ChIP-seq data. The expectation was that the binding information of one TF in one cell line could be helpful for predicting the binding of the same TF or other TFs in other cell lines. For example, the binding sequences of STAT1 and STAT2 should be similar across different cell lines so the training data in one condition may compensate for the lack of training data in another condition. A performance comparison between TFImpute and DeepBind, as shown in <xref ref-type="fig" rid="pcbi.1005403.g002">Fig 2A and 2B</xref>, confirmed the effectiveness of the joint training setting. Although TFImpute uses less training data, it gives better results without the possible drawback of over-training, a serious problem for DeepBind, which requires complicated methods to perform regularization and hyperparameter selection. The underlying reason for the TFImpute to avoid over-training is that TFImpute fits a single model using all the training data but DeepBind fits a separate model for each TF ChIP-seq data set. On the same dataset, we also compared TFImpute with gkm-SVM [<xref ref-type="bibr" rid="pcbi.1005403.ref015">15</xref>], a state-of-the-art TF binding prediction algorithm not based on deep learning in <xref ref-type="fig" rid="pcbi.1005403.g002">Fig 2C</xref>. Both methods are comparable.</p>
<fig id="pcbi.1005403.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005403.g002</object-id>
<label>Fig 2</label>
<caption>
<title>AUC comparison of TFImpute with DeepBind and gkm-SVM using shuffled sequences as negative instances.</title>
<p>(A) Comparison with DeepBind. Each point in the figure corresponds to a TF-cell line combination. (B) AUC for TF-cell line combinations in which DeepBind gives the lowest AUC. (C) Comparison with gkm-SVM using randomly shuffled sequences as negative instances. Each point in the figure corresponds to a TF-cell line combination.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Using DNase I hypersensitive sites as background</title>
<p>DeepBind defines negative peaks as random sequences in which the number of dinucleotides is matched to the positive set [<xref ref-type="bibr" rid="pcbi.1005403.ref019">19</xref>]. Another definition of random sequences requires sequence length, GC and repeat fractions that match the positive set [<xref ref-type="bibr" rid="pcbi.1005403.ref015">15</xref>]. However, in vivo DNA sequences are not random in above senses and the binding sites of TFs are mostly concentrated on active genomic regions, specifically the DNase I hypersensitive sites. Therefore, a set of union DHS sites provide a more biologically meaningful background for TF binding prediction. In this work, our method first defines unified DNase I hypersensitive sites using 122 ENCODE DNase-seq datasets [<xref ref-type="bibr" rid="pcbi.1005403.ref005">5</xref>] as the background. Then, for each TF ChIP-seq dataset, the cell-specific negative peaks are defined as the unified DNase-seq peak regions that do not overlap with any of the TF peaks in the dataset. Then, the top 5,000 peaks are taken as positive peaks, with each one being matched by a randomly selected negative peak.</p>
<p>We denote the set of TF-cell line combinations as F. To evaluate the performance of TFImpute, we first define 4 subsets (Base, TestSet2, ValidSet2 and TestSet3) of F in <xref ref-type="table" rid="pcbi.1005403.t001">Table 1</xref>. The specific TF-cell line list for each subset is in <xref ref-type="supplementary-material" rid="pcbi.1005403.s001">S1 Table</xref>. Note that the TF-cell line combinations in TestSet3 do not appear in Base where the training set is coming from. In other words, we are training a model using TF binding information in one cell line but verify the model in another cell line. This is biologically meaningful if there are multiple TFs and cell lines involved. For example, if two TFs (TF1 and TF2) were involved and a model learned that TF1 and TF2 are similar due to their similar binding profiles across many cell lines from the training data, it can give a better binding prediction for TF1 in a cell line if the training data contains the binding information of TF2 in this cell line. Therefore, we can evaluate whether a model can utilize such information by training a model for TF1 and TF2 in many cell lines excluding some cell line X and then evaluating the model’s ability to predict TF1 binding in cell line X. The opposite extreme situation is that TF2 is very different from TF1. In this case, the best choice of the model is to ignore TF2 when predicting TF1 binding profile. Although the similarities between TFs or cell lines vary, we hope that the proper designed network structure of TFImpute can learn how to use TF2 in binding prediction of TF1. The designed TestSet3 in <xref ref-type="table" rid="pcbi.1005403.t001">Table 1</xref> is to verify whether TFImpute can gain such prediction ability.</p>
<table-wrap id="pcbi.1005403.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005403.t001</object-id>
<label>Table 1</label> <caption><title>Subsets of TF-cell line combinations using DNase I hypersensitive sites as background.</title></caption>
<alternatives>
<graphic id="pcbi.1005403.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Definition</th>
<th align="center">Set size</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>Base</italic> ⊂ <italic>F</italic></td>
<td align="center">473</td>
<td align="left">Would be further partitioned to get the training set.</td>
</tr>
<tr>
<td align="left"><italic>TestSet</italic>2 ⊂ <italic>Base</italic></td>
<td align="center">70</td>
<td align="left">Verify the model’s imputation power on replicates.</td>
</tr>
<tr>
<td align="left"><italic>ValidSet</italic>2 ⊂ <italic>F</italic> − <italic>Base</italic> − <italic>TestSet</italic>3</td>
<td align="center">20</td>
<td align="left">Monitor over-training for TF-cell line combinations not in the training set. All TF or cell lines in ValidSet2 are thoroughly represented in Base.</td>
</tr>
<tr>
<td align="left"><italic>TestSet</italic>3 ⊂ <italic>F</italic> − <italic>Base</italic> − <italic>ValidSet</italic>2</td>
<td align="center">69</td>
<td align="left">Verify the model’s imputation power on TF-cell line combinations not in the training set. All TF or cell lines in TestSet3 are thoroughly represented in Base but do not need to be in ValidSet2.</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Each TF-cell line combination corresponds to a set of instances for the input of TFImpute. Each instance is a &lt;1/0, TF, cell line, DNA sequence&gt; <ext-link ext-link-type="uri" xlink:href="https://www.baidu.com/link?url=9s12o2n8ZCanp9qCUHhnSBnpDvHVgMkKPPvPDlY-rNffbwTItVGRTtsmQSbGGKya73nyd9aVOdV4IalcSem5RLxOkvEcmr4RijPoeLBhNeq&amp;wd=&amp;eqid=d440a7e4000708d30000000457a525cc" xlink:type="simple">quadruple</ext-link>. 1/0 denotes whether the DNA sequence is a TF binding sequence. To simplify the annotation, we also use Base (or TestSet2, ValidSet2, TestSet3) to denote the union of instances corresponding to TF-cell line combinations in Base (or TestSet2, ValidSet2, TestSet3). Instances in Base are further partitioned into 3 disjoint subsets (TrainSet, TestSet1 and ValidSet1) in <xref ref-type="table" rid="pcbi.1005403.t002">Table 2</xref>.</p>
<table-wrap id="pcbi.1005403.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005403.t002</object-id>
<label>Table 2</label> <caption><title>Random partition of the instances in Base into 3 disjoint subsets.</title></caption>
<alternatives>
<graphic id="pcbi.1005403.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Name</th>
<th align="center">#Instances</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">TrainSet</td>
<td align="center">3,708,593</td>
<td align="left">The training set</td>
</tr>
<tr>
<td align="center">ValidSet1</td>
<td align="center">100,000</td>
<td align="left">Monitor over-training for TF-cell line combinations in the training set.</td>
</tr>
<tr>
<td align="center">TestSet1</td>
<td align="center">900,000</td>
<td align="left">Verify the model on TF-cell line combinations in the training set.</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>During calculation, we first maximize the set size of the union of ValideSet2 and TestSet3. Then randomly selected 20 of them as the ValidSet2. Finally, we maximize the set size of TestSet2. The specific TF-cell line list for each subset is in <xref ref-type="supplementary-material" rid="pcbi.1005403.s001">S1 Table</xref>. Because ChIP-seq experiments are not evenly distributed for TFs or cell lines, subsets defined above are biased towards TFs and cell lines that have many ChIP-seq experiments in the dataset. This is a possible mechanism of overfitting.</p>
</sec>
<sec id="sec006">
<title>Using GC matched negative instances</title>
<p>For a comprehensive comparison with gkm-SVM, we also applied TFImpute to the dataset in [<xref ref-type="bibr" rid="pcbi.1005403.ref015">15</xref>], where the GC matched sequences are used as negative instances. Similar to Tables <xref ref-type="table" rid="pcbi.1005403.t001">1</xref> and <xref ref-type="table" rid="pcbi.1005403.t002">2</xref>, we partitioned the dataset into 6 subsets: TrainSet, ValidSet1, TestSet1, ValidSet2, TestSet2, and TestSet3. The basic statistics for each subset is in Tables <xref ref-type="table" rid="pcbi.1005403.t003">3</xref> and <xref ref-type="table" rid="pcbi.1005403.t004">4</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005403.s002">S2 Table</xref></p>
<table-wrap id="pcbi.1005403.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005403.t003</object-id>
<label>Table 3</label> <caption><title>Subsets of TF-cell line combinations using GC matched negative instances.</title></caption>
<alternatives>
<graphic id="pcbi.1005403.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Definition</th>
<th align="center">Set size</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>Base</italic></td>
<td align="center">339</td>
</tr>
<tr>
<td align="left"><italic>TestSet</italic>2</td>
<td align="center">67</td>
</tr>
<tr>
<td align="left"><italic>ValidSet</italic>2</td>
<td align="center">20</td>
</tr>
<tr>
<td align="left"><italic>TestSet</italic>3</td>
<td align="center">41</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pcbi.1005403.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005403.t004</object-id>
<label>Table 4</label> <caption><title>Random partition of the instances in Base of <xref ref-type="table" rid="pcbi.1005403.t003">Table 3</xref> into 3 disjoint subsets.</title></caption>
<alternatives>
<graphic id="pcbi.1005403.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.t004" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Name</th>
<th align="center">#Instances</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">TrainSet</td>
<td align="center">2000000</td>
</tr>
<tr>
<td align="center">ValidSet1</td>
<td align="center">200000</td>
</tr>
<tr>
<td align="center">TestSet1</td>
<td align="center">696076</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec007">
<title>Comparisons with gkm-SVM and PIQ</title>
<p>To compare TFImpute with gkm-SVM [<xref ref-type="bibr" rid="pcbi.1005403.ref015">15</xref>] and PIQ [<xref ref-type="bibr" rid="pcbi.1005403.ref022">22</xref>], we apply the default parameters for both gkm-SVM and PIQ. gkm-SVM cannot accept inputs from multiple conditions; thus, we trained gkm-SVM separately on each TF-cell line combination on the union of the training and validation sets. PIQ does not need a training set but accepts a genome-wide DNase I hypersensitivity profile and a known motif to predict the binding of a TF. We apply PIQ on TestSet3 with matched cell line DNase I hypersensitivity profiles. The required motifs for running PIQ could be found in <xref ref-type="supplementary-material" rid="pcbi.1005403.s003">S3 Table</xref>. (See <xref ref-type="sec" rid="sec013">Material and methods</xref> for more details).</p>
<p>A comparison is shown in <xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3A</xref>. For TestSet1, TFImpute achieved an average AUC above 0.94 and performed slightly better than gkm-SVM. For TestSet2, the set to verify the accuracy of the methods on ChIP-seq replicates, both methods were comparable with no statistically significant difference. The most important result was observed for TestSet3, in which the tested TF-cell line combinations were not in the training set. To evaluate the performance of gkm-SVM on TestSet3, we randomly selected a trained gkm-SVM model based on TrainSet with matched TFs for each dataset in TestSet3. For TestSet3, TFImpute performed much better (average AUC 0.895) than gkm-SVM (average AUC 0.852). The p-values (0.048 for TestSet1 and 0.06 for TestSet3) between TFImpute and gkm-SVM AUC indicate that the differences are not very significant. The main reason for this finding is that the numbers of data points are small. When the predictions were grouped by TF-cell line combinations, we obtained more significant p-values (4.446e-05 for TestSet1 and 0.001 for TestSet3; <xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3B</xref>). To rule out the possibility that TFImpute outperforms gkm-SVM by chance, we randomly partition Base 5 extra times based on <xref ref-type="table" rid="pcbi.1005403.t002">Table 2</xref> and check the variability of TFImpute AUC (<xref ref-type="supplementary-material" rid="pcbi.1005403.s006">S1A Fig</xref>). The results show that the variation of TFImpute AUC is very small. On TestSet3, PIQ achieves the lowest AUC. A possible reason is that PIQ does not give predictions on regions without strong motif or regions lack of DNase I signal. Therefore, we removed such regions before calculating the AUC (PIQNoNA in <xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3A</xref>). We found that TFImpute still outperforms PIQ in this case.</p>
<fig id="pcbi.1005403.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005403.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison with gkm-SVM, PIQ, and DeepSEA.</title>
<p>(A) AUC comparison of TFImpute and gkm-SVM on TestSet1, TestSet2, and TestSet3. ‘Shuf cell line indicates that the cell line of the corresponding test set was shuffled and that the trained TFImpute model was then applied to the shuffled dataset. Similarly, ‘Shuf TF’ indicates that the TFs were shuffled. For some of the given regions, PIQ give NA predictions. NA means that there is no motif based on log probability threshold of 5, or the region is lack of DNase I signal. PIQNoNA in this figure denotes the result after removing all NAs and PIQ denotes the result after treating NAs as no binding. To calculate the AUC, the predictions were grouped by TFs. The middle bar in each box indicates the median. (B) AUC comparison based on predictions grouped by TF-cell line combinations. (C) The recall rates of different methods at FDR 0.05 (See <xref ref-type="sec" rid="sec013">Material and methods</xref> for more details). The predictions were grouped by TFs. (D) AUC comparison of TFImpute on TFs appearing in both TestSet2 and TestSet3. (E) Hierarchical clustering of a subset of the TFs based on the learned embedding by TFImpute. The full clustering is shown in <xref ref-type="supplementary-material" rid="pcbi.1005403.s008">S3 Fig</xref>. (F) Hierarchical clustering of a subset of cell lines based on the learned embedding by TFImpute. The full clustering is shown in <xref ref-type="supplementary-material" rid="pcbi.1005403.s009">S4 Fig</xref>. (G) The recall rate of TFImpute and DeepSEA at different FDR cutoffs on the datasets provided by DeepSEA.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.g003" xlink:type="simple"/>
</fig>
<p>Because a TF binds to only a small proportion of the chromatin accessible regions, methods that can impute TF binding with low FDR are more valuable. In <xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3C</xref>, we compared the recall rates of different methods at fixed FDR 0.05. On TestSet1 and TestSet3, TFImpute outperforms gkm-SVM and PIQ. The conclusion also holds at FDR 0.01 and FDR 0.1 (<xref ref-type="supplementary-material" rid="pcbi.1005403.s006">S1B Fig</xref>). Another important application of TF binding prediction is to scan possible binding sites genome-widely. We evaluated the performances of the three methods on non-overlapping bins of length 300bp on chr8. Then we applied the trained models of TFImpute, gkmSVM on TrainSet to TF and cell line combinations in TestSet3 on chr8, and extracted the maximum score of PIQ calls for each bin on chr8. Note that PIQ needs associated DNase-seq data for each cell line but TFImpute and gkmSVM are solely based on DNA sequence. The comparisons shown in <xref ref-type="supplementary-material" rid="pcbi.1005403.s006">S1C Fig</xref> demonstrate that all three methods give high false positive rates, which is consistent with the literature [<xref ref-type="bibr" rid="pcbi.1005403.ref021">21</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref032">32</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref033">33</xref>]. TFImpute and gkmSVM are comparable and relatively better than PIQ at large FDR cutoffs (95% and 99%). At FDR cutoff 50%, PIQ achieves higher recall rates. The low recall rate of TFImpute is partially due to the fact DNase region instead of the whole genome were used as the background during training. The following comparison with DeepSEA shows that the recall rate increases as wider regions were used as background.</p>
<p>To further confirm the super performance of TFImpute over gkm-SVM, we further applied both methods on the dataset used to validate gkm-SVM [<xref ref-type="bibr" rid="pcbi.1005403.ref015">15</xref>]. This dataset uses GC matched negative regions. The AUC and recall rate comparison demonstrate that TFImpute outperforms gkm-SVM consistently (<xref ref-type="supplementary-material" rid="pcbi.1005403.s007">S2 Fig</xref>).</p>
<p>We also compared the running time of TFImpute, gkm-SVM and PIQ in <xref ref-type="table" rid="pcbi.1005403.t005">Table 5</xref>. The total time costs of three methods are comparable. We didn’t test TFImpute on CPU because CNN neural networks are generally extremely slow on CPU. TFImpute doesn’t have running time for each dataset separately because all the training data are supplied to TFImpute jointly. The running time of gkm-SVM and PIQ is the average time of processing all the datasets.</p>
<table-wrap id="pcbi.1005403.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005403.t005</object-id>
<label>Table 5</label> <caption><title>Running time of different methods.</title></caption>
<alternatives>
<graphic id="pcbi.1005403.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.t005" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="center">Hardware</th>
<th align="center">Training Time</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">TFImpute</td>
<td align="center">GPU GTX970</td>
<td align="center">80h/all dataset</td>
</tr>
<tr>
<td align="center">gkm-SVM</td>
<td align="center">CPU AMD Phenom(tm) II X4 910e</td>
<td align="center">38min/dataset</td>
</tr>
<tr>
<td align="center">PIQ</td>
<td align="center">CPU AMD Phenom(tm) II X4 910e</td>
<td align="center">40min/dataset</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Finally, we compared the performance of TFImpute on TestSet2 and TestSet3. Because the TFs in TestSet3 were different from those in TestSet2, the differing performance of TFImpute on the two test sets may not be directly comparable with the overall AUC shown in <xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3A</xref>. Therefore, we focused on transcription factors that appeared in both TestSet2 and TestSet3. For most of these TFs, TFImpute performed equally well (<xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3D</xref>), indicating that the learned interactions of TFs and cell lines determined by TFImpute can be generalized to novel TF-cell line combinations. This benefit is highly valuable because most of the TF-cell line combinations don’t have corresponding ChIP-seq data.</p>
</sec>
<sec id="sec008">
<title>Comparisons with DeepSEA</title>
<p>Because the released DeepBind software package does not contain the training step, we could not train it on our dataset. Therefore, we compared TFImpute with DeepSEA on the datasets provided in [<xref ref-type="bibr" rid="pcbi.1005403.ref027">27</xref>]. This dataset defines the background as regions where at least one TF binds in at least one of the cell lines. Such a wide background gives us the opportunity to estimate the recall rate of a method on certain FDR cutoffs genome-widely.</p>
<p>To compare with DeepSEA genome-widely, we transformed the data from DeepSEA paper into the format required by TFImpute. We faced three obstacles. First, the input of TFImpute requires &lt;DNA sequence, TF, cell line &gt; triples. If we use all negative peaks in the data provided by DeepSEA to train TFImpute, the data would be too large to be trained. Second, given a &lt;DNA sequence, TF, cell line&gt; triple, the current TFImpute model predicts whether the TF would bind to the DNA sequence in the cell line. It is too inefficient to cases if we want to predict the binding of a set of TFs on a DNA sequence in a cell line. Third, the input DNA sequence of DeepSEA is 1000bp and the DeepSEA model used three layers of convolutions to handle the long DNA sequence. The TFImpute model was designed for relatively short sequences and therefore only one layer of convolution was used to save computation time.</p>
<p>We found no easy way to solve above three problems simultaneously. The main reason is that the TF and cell line information have to be input to the model in some way to keep the imputation ability. This imputation ability dramatically increases the required computation. Therefore, we conducted the following procedures to partially solve the above problems and compared TFImpute with DeepSEA genome-widely.</p>
<p>First, to train TFImpute we excluded histone modifications and DNase-seq data and sampled one negative peak for each positive peak to reduce the data size. For DeepSEA, we used full dataset and reproduced the prediction results in the DeepSEA paper. Second, to compare with DeepSEA genome-widely, we queried the Cistrome Data Browser database [<xref ref-type="bibr" rid="pcbi.1005403.ref034">34</xref>] for another 19 TF ChIP-seq datasets (<xref ref-type="supplementary-material" rid="pcbi.1005403.s004">S4 Table</xref>) not included in the training set (See <xref ref-type="sec" rid="sec013">Material and methods</xref> for more details). In the 19 datasets, the TF and cell line appears in the training set but the TF-cell line combinations are not contained in the training set. Then we partitioned chr8 into non-overlapping bins of length 1000bp and evaluated TFImpute and DeepSEA on chr8. For each ChIP-seq dataset, a bin is considered as having TF binding if there is a peak center in the bin. Because the TF-cell line combinations of the 19 datasets are not contained in the training set, DeepSEA cannot give predictions for the right cell line for each TF. Therefore, we selected the prediction of a random cell line in the training set for each TF to form the final prediction of DeepSEA. Third, we adjusted the network structure of TFImpute such that it can handle 1000bp DNA sequence without imposing extra computation needs and can predict the binding of a set of TFs on a DNA sequence in a cell line simultaneously (See <xref ref-type="sec" rid="sec013">Material and methods</xref> for more details).</p>
<p>We compared the recall rates of DeepSEA and TFImpute at different FDR cutoffs. Generally, the recall rates at low FDR are quite low for both methods. To get a reasonable recall rate (e.g. 20%), the FDR should be above 50%. The recall rates at 4 FDR cutoffs (60%, 70%, 80% and 90%) are shown in <xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3G</xref>. The TFImpute model outperforms DeepSEA for majority of the cases.</p>
</sec>
<sec id="sec009">
<title>Sequence features are the primary factors influencing TF binding</title>
<p>The TFImpute model provides the ability to estimate whether sequence features or cell lines have a more significant influence on TF binding. <xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3A and 3C</xref> show that if a TF does not match the DNA sequences and cell lines (by shuffling TFs in the test set), the prediction accuracy drops more statistically significantly than when cell lines are shuffled. This result indicates that sequence features are the dominant factor in determining TF binding compared to cell line. Because randomly selecting a trained model based on TrainSet with matched TFs for each dataset in TestSet3 is equivalent to ignoring cell- specificity, we observed that the performance of TFImpute with shuffled cell lines was comparable to that of gkm-SVM on TestSet3 (<xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3A</xref>).</p>
<p>Because each TF or cell line had learned embedding, we could compare the similarities between embedded vectors. We observed that many TFs with similar known motifs were grouped together, such as HNF4G/HNF4A and STAT1/STAT3 (<xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3E</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005403.s008">S3 Fig</xref>). The meaning of embedding for cell lines is subtler because it is not the primary factor influencing TF binding. Therefore, we did not observe clear patterns in clustering for cell lines (<xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3F</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005403.s009">S4 Fig</xref>).</p>
</sec>
<sec id="sec010">
<title>Enhancer activity is correlated with the binding prediction based on TFImpute</title>
<p>To systematically estimate the efficacy of TFImpute, we applied TFImpute on a massively parallel reporter assay that experimentally characterized the role of enhancer sequences by introducing target mutations in K562 and HepG2 cell lines [<xref ref-type="bibr" rid="pcbi.1005403.ref035">35</xref>]. For a specific cell line and each of the enhancer sequences, TFImpute gave TF binding predictions for all the TFs in the training set. To obtain a summarized enhancer activity prediction for each enhancer sequence, we performed principle component analysis (PCA) on the matrix of the predicted binding affinity for all TFs and enhancer sequences. The first principle component was taken as a signature of enhancer activity for each sequence. Then, we compared the signature value distribution of the top 100 enhancer sequences from that of the bottom 100 enhancer sequences after all the enhancer sequences were ranked by their experimentally measured activities. <xref ref-type="fig" rid="pcbi.1005403.g004">Fig 4</xref> shows that the difference is much more statistically significant if the cell lines are matched. The same relationship is also confirmed by the Spearman rank correlation analysis shown in <xref ref-type="supplementary-material" rid="pcbi.1005403.s010">S5 Fig</xref>. When the cell lines are matched, the p values for the Spearman rank correlation are much more statistically significant than other cases. In <xref ref-type="supplementary-material" rid="pcbi.1005403.s010">S5 Fig</xref>, it is interesting to note that the correlation coefficient is positive (0.5747) in K562 but negative (−0.4422) in HepG2. This is reasonable because we would expect that the set of TFs binding to the active enhancers of K562 is different from that of HepG2. It also means that the signature based on TF binding prediction should not be considered as a prediction of the enhancer activity.</p>
<fig id="pcbi.1005403.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005403.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The distributions of the calculated enhancer signature for the top and bottom 100 enhancers.</title>
<p>The p value is calculated using t-test. We would like to emphasize the lack of data of the enhancer reporter assay of GM12878, which is a good control.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec011">
<title>TFImpute accurately predicts the impact of SNPs on TF binding</title>
<p>Because TFImpute can accurately predict TF binding, we can use the trained TFImpute model to estimate TF binding differences in the minor and major alleles of individual SNPs for all possible TF-cell line combinations if the TF and the cell line appear in the training set. To validate the accuracy of TFImpute on mutated sequences, we filtered 10 SNPs from the literature that were reported to lead to differential binding for TFs and cell lines appearing in our training set. TFImpute gave predictions consistent with the literature for 7 of these SNPs (<xref ref-type="supplementary-material" rid="pcbi.1005403.s005">S5 Table</xref>). For example, in liver, the minor allele (T) of SNP rs12740374 created a binding site for C/EBP, and the major allele (G) disrupted the binding [<xref ref-type="bibr" rid="pcbi.1005403.ref024">24</xref>]. TFImpute accurately predicted that the C/EBP binding affinity would increase when the DNA sequence was changed from the major allele to the minor allele in HepG2, a liver hepatocellular carcinoma cell line (<xref ref-type="fig" rid="pcbi.1005403.g005">Fig 5</xref>). As another example, in SNP rs4784227 (C/T), a functional variant in breast cancer, the risk-associated allele (T) increases FoxA1 binding in breast cancer [<xref ref-type="bibr" rid="pcbi.1005403.ref036">36</xref>]. Although there is no ChIP-seq data for FoxA1 in MCF-7 in the training set, TFImpute predicted that the binding of FoxA1 would increase if the input sequence at the SNP location were changed from C to T in MCF-7 (<xref ref-type="supplementary-material" rid="pcbi.1005403.s011">S6 Fig</xref>). Moreover, for SNP rs4953223 (C/T), one of the DNase I—sensitivity quantitative trait loci (dsQTLs) in human lymphoblastoid cell lines (LCLs) [<xref ref-type="bibr" rid="pcbi.1005403.ref037">37</xref>], the T allele disrupts the binding of NF-kB and is strongly associated with low DNase I sensitivity [<xref ref-type="bibr" rid="pcbi.1005403.ref024">24</xref>]. TFImpute accurately predicted that the binding affinity of NF-kB would dramatically decrease in most of the cell lines, including all the GM cell lines (lymphoblastoid cell lines), if the DNA sequence at rs4953223 was changed from C to T (<xref ref-type="supplementary-material" rid="pcbi.1005403.s012">S7 Fig</xref>). Moreover, dozens of other TFs, such as EBF1 and STAT1, also showed clear binding affinity decreases in most of the GM cell lines.</p>
<fig id="pcbi.1005403.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005403.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Predicted binding affinity change between two alleles of SNP rs12740374 (T/G).</title>
<p>The color in each cell represents the predicted binding affinity of allele G minus that of allele T for the corresponding TF and cell line. The number in each cell of the heatmap is the number of ChIP-seq datasets in the training set for the corresponding TF and cell line. If TFImpute predicted strong binding in the minor allele but no binding in the major allele, the score was 1. If TFImpute predicted no binding difference between the two alleles, the score was 0.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.g005" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec012" sec-type="conclusions">
<title>Discussion</title>
<p>The most efficient resource for studying TF binding is ChIP-seq. However, a ChIP-seq experiment is limited by its cost, the availability of proper antibodies, and the complexity of the protocol. Therefore, only a small fraction of possible ChIP-seq experiments have been performed, considering all possible TF-cell line combinations. Because TF binding is a cell-specific behavior, it is not optimal to transfer a trained TF binding prediction model without condition-specific features, such as sequence-only models of TF binding, from one condition to another. TFImpute provides an economical method for alleviating this problem. Compared with existing methods, the properly formed multi-tasking learning framework along with the embedding and the gating mechanism make TFImpute obtain more accurate predictions for TF-cell line combinations without ChIP-seq data, given that the TF and the cell line appear in the training set. As more ChIP-seq data are used to train the model, TFImpute will be more powerful because the number of TF-cell line combinations increases quadratically with the number of TFs and cell lines.</p>
<p>To summarize enhancer activities, we utilized the first PCA component of the predicted TF binding score for all TFs and enhancer sequences. This method represents a rather simplified approach. It is expected that the use of more PCA components would provide a better fit to the enhancer activity, which was observed. However, even when all the components were used to fit the activity of all enhancers using linear regression, we did not obtain a perfect fitting (r-squared are 0.1361 and 0.2359 for K562 and HepG2 respectively), for at least two underlying reasons. First, the measured enhancer activity was noisy [<xref ref-type="bibr" rid="pcbi.1005403.ref035">35</xref>]. Second, the activity of the enhancers was not linearly dependent on the TF binding signal. To address the non-linearity, a more dedicated model might be needed.</p>
<p>The trained TFImpute model based on non-mutated sequences is well suited for predicting the binding of TFs on mutated sequences such as SNPs. Similar results have also been observed in previous studies, such as [<xref ref-type="bibr" rid="pcbi.1005403.ref024">24</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref027">27</xref>]. Such models are valuable for studying the gene regulatory network <italic>in silico</italic>, which is more rapid and economical than wet lab experiments. The unique imputation ability of TFImpute further extends the predictive power to some TF-cell line combinations without corresponding ChIP-seq data. Such an extension complements models based on sequence features and open chromatin profiling data, such as PIQ [<xref ref-type="bibr" rid="pcbi.1005403.ref022">22</xref>].</p>
<p>It is worth noting that the prediction reliabilities are different for different TF-cell line combinations without ChIP-seq data. <xref ref-type="fig" rid="pcbi.1005403.g005">Fig 5</xref> clearly demonstrates this phenomenon. For approximately one half of the cell lines, only CTCF ChIP-seq data are available; therefore, the binding predictions are very similar for these cell lines. These predictions cannot intuitively reflect the cell-specificity. Important future work should include the quantitative estimation of the prediction reliability.</p>
</sec>
<sec id="sec013" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec014">
<title>The deep learning neural network</title>
<p>A deep learning neural network transforms inputs through multiple layers of simple computation units. Each unit provides very limited computations such as performing a summation or calculating the sigmoid function. Normally, computation units are connected only to adjacent layers. Similar to [<xref ref-type="bibr" rid="pcbi.1005403.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref027">27</xref>], our TFImpute model is also based on a convolutional neural network (CNN) [<xref ref-type="bibr" rid="pcbi.1005403.ref029">29</xref>]. However, our approach differs in that we also use TFs and cell lines as part of the input with embedding. Embedding is a technique that allows discrete features to be represented with continuous vectors. This technique has wide applications in natural language processing to represent words or relations [<xref ref-type="bibr" rid="pcbi.1005403.ref030">30</xref>]. With the embedding of TFs and cell lines, we can train the model to predict whether a sequence will exhibit cell-specific TF binding, even for TF-cell line combinations without data for all TFs and cell lines in the training set.</p>
<p>The 1-hot encoding method [<xref ref-type="bibr" rid="pcbi.1005403.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref027">27</xref>] represents each DNA sequence of length N by an N*4 matrix. Each column of the matrix corresponds to A, C, G, or T, and each row corresponds to a sequence location. For the i<sup>th</sup> row of the matrix, we set the 1st (2nd, 3rd, or 4th) column to be 1 if the i<sup>th</sup> j<sup>th</sup> element of the sequence is A (C, G, or T), and all remaining elements of the matrix are set to 0.</p>
<p>A convolution layer first transforms the DNA sequence with multiple filters. Each filter can be conceptually considered as a motif. Specifically, the output of the convolution layer with input matrix <italic>X</italic> is another matrix <italic>Y</italic> of size <italic>(N-F+1) * K</italic>, where <italic>F</italic> is the length of the filter and <italic>K</italic> is the total number of filters. <italic>Y</italic> is defined as
<disp-formula id="pcbi.1005403.e001">
<alternatives>
<graphic id="pcbi.1005403.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005403.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>F</mml:mi></mml:munderover><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>W</italic><sup>(<italic>k</italic>)</sup> is a parameter matrix for the <italic>k</italic><sup><italic>th</italic></sup> filter and r is the filter position.</p>
<p>Next, a ReLU layer operates on the input matrix element by element. This layer filters out noise and keeps only significant signals by
<disp-formula id="pcbi.1005403.e002">
<alternatives>
<graphic id="pcbi.1005403.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005403.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:mtext>ReLU</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>x</mml:mi><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>b</italic> is a parameter to reflect the fact that different motifs may have different binding affinities.</p>
<p>Then, a max-pooling layer follows. This layer takes the maximum value of the signal on non-overlapping windows. Intuitively, this layer detects whether a motif occurs in a window while ignoring the exact location of the occurrence.</p>
<p>After the pooling layer, the network goes through a gating layer. The gates are determined by the input TF and cell line. The purpose of gating is to further tune the signal such that only signals from motifs related to the current input TF and cell line pass through.</p>
<p>The calculation of gates is based on the embedding for the input TF and cell line, each of which is associated with a 1-dimensional continuous vector with 50 float elements. Given the input, the model first goes through a lookup table to obtain the embedding for the input TF and cell line. Then, a concatenated embedding vector goes through a one-layer neural network with sigmoid activations. In this way, the neural network can model complex interactions between TFs and cell lines to determine whether a TF will bind to a specific sequence in a specific cell line. This gating strategy differs from the method used by [<xref ref-type="bibr" rid="pcbi.1005403.ref038">38</xref>], which simply supplies the cell line or TF using a 1-of-<italic>N</italic> coding as an input to the network. The complete formula for describing the model is as follows:
<disp-formula id="pcbi.1005403.e003">
<alternatives>
<graphic id="pcbi.1005403.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005403.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005403.e004">
<alternatives>
<graphic id="pcbi.1005403.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005403.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>*</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>L</mml:mi><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005403.e005">
<alternatives>
<graphic id="pcbi.1005403.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005403.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mtext>max</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005403.e006">
<alternatives>
<graphic id="pcbi.1005403.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005403.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>X</italic> is the input TF and cell line; E is the embedding matrix for all TFs and cell lines; embed(X, E) simply concatenates the embedding vectors for the TF and the cell line from X; and <italic>S</italic> is the input sequence. <italic>revcomp</italic> takes the reverse complement of the input sequence, and E,W<sub>1</sub>, W<sub>2</sub>, b<sub>1</sub>, b<sub>2</sub>, b and W = {W<sup>(k)</sup>, 1 ≤ k ≤ F} are model parameters. Because the embedding for either the TF or the cell line is a 50-dimension vector, the output of embed(X, E) is a 100-dimension vector. Once the model has been trained, the embeddings for TFs and cell lines in the training set will be learned. For TFs or cell lines not in the training set, the model cannot be applied.</p>
<p>TFImpute achieves cell line specificity in a very different way from that of DeepSEA [<xref ref-type="bibr" rid="pcbi.1005403.ref027">27</xref>]. In that study, all the predictions shared the whole network, except for the last two layers. Therefore, the ability to differentiate various TFs and cell lines was limited by the model ability of the last two layers. Moreover, DeepSEA can model only TF-cell line combinations that appear in the training data and cannot extrapolate to cases for further TF-cell line combinations.</p>
</sec>
<sec id="sec015">
<title>The revised neural network structure for comparison with DeepSEA</title>
<p>To compare with DeepSEA on long DNA sequence, we revised the network structure of TFImpute as follows. First, each cell line is associated with an embedding with length equal to the number of motifs (2000). Then a sigmoid function is applied on the embedding to get the gates. Second, F(S, X) is replaced by taking maximum over non-overlapping window with size 50 followed by GRU [<xref ref-type="bibr" rid="pcbi.1005403.ref039">39</xref>], a recurrent layer, with hidden size 1000. The hidden state of the GRU at the last time step is connected to the output. Third, the number of outputs is equal to the number of TFs in the training set. In other words, the revised model is a CNN-RNN structure with cell line embedding as gates. Such a model keeps the imputation ability, gives predictions for multiple TFs in a cell line simultaneously and handles long DNA sequences without imposing extra computation needs. During training, the learning rate decay was 0.01 for every 200,000 instances and the best model is selected based on valid set.</p>
</sec>
<sec id="sec016">
<title>Data source for generating datasets</title>
<p>Thanks the authors of [<xref ref-type="bibr" rid="pcbi.1005403.ref040">40</xref>], we get a copy of the processed union of DHS. Briefly speaking, this union DHS are constructed based on the 122 ENCODE [<xref ref-type="bibr" rid="pcbi.1005403.ref005">5</xref>] DNaseI-seq data. Each DNase peak was trimmed to 300 bp centered at its summit. Then, the peaks are merged to get the union DHS regions. The final DHS region contains 409303942 bps, approximately 13% of the genome. We downloaded 690 TF ChIP-seq datasets of the ENCODE project [<xref ref-type="bibr" rid="pcbi.1005403.ref005">5</xref>] from <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeAwgTfbsUniform/" xlink:type="simple">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeAwgTfbsUniform/</ext-link>. This dataset contained 562 unique TF-cell combinations, with 172 TFs and 91 cell lines. For datasets with GC matched negative instances [<xref ref-type="bibr" rid="pcbi.1005403.ref015">15</xref>], the data has been downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.beerlab.org/gkmsvm/downloads/sequences_gkmsvm.tar.gz" xlink:type="simple">http://www.beerlab.org/gkmsvm/downloads/sequences_gkmsvm.tar.gz</ext-link>.</p>
</sec>
<sec id="sec017">
<title>Model training for TFImpute</title>
<p>To train the model based on random sequences, the odd-numbered peaks in the top 1,000 peaks for each dataset were randomly partitioned into a training set (280,000 instances) and a validation set (31,102). The neural network was trained by scanning the training set over 50 epochs, and the performance on the validation set after each epoch was recorded. Finally, the best-performing model was applied to the test set.</p>
<p>To train the model based on DNase I hypersensitive sites, the performance of the model was evaluated on ValidSet1 and ValidSet2 for every 50,000 instances. Then, the best-performing models over 10 epochs were taken as the final models. The best model based on ValidSet1 was used on TestSet1 and TestSet2, and the best model based on ValidSet2 was used on TestSet3. When applying TFImpute to estimate the effect of SNPs on TF binding affinity and to estimate the enhancer activity, TrainSet, TestSet1, ValidSet1, TestSet2, and TestSet3 were merged and used for training, and ValidSet2 was used for validation to select the optimal early stop point. Then, the stop point and all the data including ValidSet2 were used to train the final model. The model was trained on a GPU (GTX970) for 80 hours to finish 10 epochs.</p>
</sec>
<sec id="sec018">
<title>Hyperparameters for TFImpute</title>
<p>For comparison with DeepBind, the input sequence length was 100. The motif length was set to 20, and the number of motifs was set to 600. The window size for the max-pooling layer was 100; thus, only one maximum value was calculated for each motif. The full connection layer size was set to 50. The learning rate decay was 0.03 for each epoch. For the model based on DNase I background, the input sequence length was 300. The motif length was set to 20, and the number of motifs was set to 2,000. The window size for the max-pooling layer was 100; thus, three maximum values were calculated for each motif. For each situation, all the weights were randomly initialized with a Gaussian distribution of mean 0 and standard deviation 0.01. The bias <italic>b</italic> for the rectification layer was initialized to -4. All other biases were initialized to 0. The learning rate decay was 0.03 for every 50,000 instances.</p>
</sec>
<sec id="sec019">
<title>Procedures of applying PIQ</title>
<p>We compared TFimpute with the latest version of PIQ (<ext-link ext-link-type="uri" xlink:href="http://bitbucket.org/thashim/piq-single/src" xlink:type="simple">http://bitbucket.org/thashim/piq-single/src</ext-link>). We consulted the author of PIQ for the parameters and usage of PIQ. The procedure is as follows. First, the DNase-seq data was obtained from <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeUwDgf" xlink:type="simple">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeUwDgf</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeOpenChromDnase" xlink:type="simple">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeOpenChromDnase</ext-link>, and <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeUwDnase" xlink:type="simple">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeUwDnase</ext-link>. Replicate DNase-seq data from the same ENCODE participant lab were merged. For the DNase-seq experiments in the same cell line performed by different labs, the one with the maximum number of mappable reads was selected. Second, we used the motif reference table from PIQ (<ext-link ext-link-type="uri" xlink:href="http://piq.csail.mit.edu/data/misc/integration.test.csv" xlink:type="simple">http://piq.csail.mit.edu/data/misc/integration.test.csv</ext-link>) to match the transcription factor name with PWM id in JASPAR database. For transcription factor names without PWM annotations, we combined the PIQ transcription factor calls from <ext-link ext-link-type="uri" xlink:href="http://piq.csail.mit.edu/data/141105-3618f89-hg19k562.calls/141105-3618f89-hg19k562.calls.tar.gz" xlink:type="simple">http://piq.csail.mit.edu/data/141105-3618f89-hg19k562.calls/141105-3618f89-hg19k562.calls.tar.gz</ext-link> and ENCODE ChIP-seq peaks to follow the routine suggested by the PIQ author to get the most predictive PWM of the ChIP-seq peaks as in <ext-link ext-link-type="uri" xlink:href="http://piq.csail.mit.edu/data/misc/compare.tar.gz" xlink:type="simple">http://piq.csail.mit.edu/data/misc/compare.tar.gz</ext-link>. Last, we used the default parameters to run PIQ for the 69 &lt;TF, PWM, DNase-seq, cell line &gt; combinations (<xref ref-type="supplementary-material" rid="pcbi.1005403.s003">S3 Table</xref>) whose TF-cell line combinations are in TestSet3 (<xref ref-type="supplementary-material" rid="pcbi.1005403.s001">S1 Table</xref>), and got the maximum purity score of the positive and negative strand for each region. For genome wide transcription factor binding prediction, we run the same procedure as above, but replaced the background input region with the 300bp windows on chr8 for the TF-cell combinations in TestSet3.</p>
</sec>
<sec id="sec020">
<title>External dataset from Cistrome Data Browser</title>
<p>We queried the Cistrome Data Browser database [<xref ref-type="bibr" rid="pcbi.1005403.ref034">34</xref>] for human ChIP-seq datasets satisfying the following two conditions: First, the TF and the cell line combinations are not in the TF ChIP-seq datasets from DeepSEA [<xref ref-type="bibr" rid="pcbi.1005403.ref027">27</xref>], but the TF or the cell line separately should be in the datasets. In this step, both the official name and its aliases for a TF are considered. Second, the number of peaks with good quality (Q-value &lt; = 0.01) is larger than 20,000. The resulted datasets were manually selected to make the TF and cell line name as unique as possible. Finally, 19 ChIP-seq datasets remain (<xref ref-type="supplementary-material" rid="pcbi.1005403.s004">S4 Table</xref>).</p>
</sec>
<sec id="sec021">
<title>The calculation of recall rate at certain FDR cutoff</title>
<p>We calculated the threshold for the predicted score based on the test data for a certain FDR cutoff. Then, the recall rate is calculated based on the threshold. We didn’t calculate the FDR using training data to make the metric definition consistent for all methods compared in this work including PIQ that does not need a separate training set.</p>
</sec>
<sec id="sec022">
<title>TFImpute package</title>
<p>The TFImpute method was implemented using Theano [<xref ref-type="bibr" rid="pcbi.1005403.ref041">41</xref>,<xref ref-type="bibr" rid="pcbi.1005403.ref042">42</xref>]. The software is available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/feeldead/tfimpute" xlink:type="simple">https://bitbucket.org/feeldead/tfimpute</ext-link>.</p>
</sec>
</sec>
<sec id="sec023">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005403.s001" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>The specific TF-cell line list for each subset of <xref ref-type="table" rid="pcbi.1005403.t001">Table 1</xref>.</title>
<p>(CSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005403.s002" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s002" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>The specific TF-cell line list for each subset of <xref ref-type="table" rid="pcbi.1005403.t003">Table 3</xref>.</title>
<p>(CSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005403.s003" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s003" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>The motif IDs for running PIQ on TestSet3.</title>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005403.s004" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s004" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Selected 19 TF ChIP-seq datasets from Cistrome Data Browser database [<xref ref-type="bibr" rid="pcbi.1005403.ref034">34</xref>].</title>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005403.s005" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s005" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>Predicted binding differences for the major and minor alleles of SNPs.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005403.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s006" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title/>
<p>(A) The AUC of TFImpute at different random partitions of Base based on <xref ref-type="table" rid="pcbi.1005403.t002">Table 2</xref>. Run0 corresponds to the result in <xref ref-type="fig" rid="pcbi.1005403.g003">Fig 3A</xref>. (B) The recall rates of TFImpute, gkm-SVM and PIQ at FDR 0.01 and 0.1 on union DHS regions. (C) The recall rates of the three methods at FDR 0.5, 0.9, 0.95, 0.99.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005403.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s007" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>AUC and recall rate comparison of TFImpute and gkm-SVM on datasets using GC matched negative instances.</title>
<p>The predictions were grouped by TFs.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005403.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s008" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Hierarchical clustering of TFs based on their learned embedding.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005403.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s009" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Hierarchical clustering of cell lines based on their learned embedding.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005403.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s010" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Spearman rank correlation between the enhancer sequence and the predicted value.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005403.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s011" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Predicted binding affinity change between two alleles of SNP rs4784227 (C/T).</title>
<p>The color in each cell represents the predicted binding affinity of allele T minus that of allele C for the corresponding TF and cell line.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005403.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005403.s012" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Predicted binding affinity change between two alleles of SNP rs4953223 (C/T).</title>
<p>The color in each cell represents the predicted binding affinity of allele T minus that of allele C for the corresponding TF and cell line.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Professor Xiaole Shirley Liu and Dr. Clifford A. Meyer for their highly valuable discussions and suggestions. We thank Shenglin Mei for the DNase I background data. We also thank the author of PIQ for detailed help about the usage of PIQ.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005403.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mathelier</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Wasserman</surname> <given-names>WW</given-names></name>. <article-title>Identification of altered cis-regulatory elements in human disease</article-title>. <source>Trends in Genetics</source>. <year>2015</year>;<volume>31</volume>: <fpage>67</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tig.2014.12.003" xlink:type="simple">10.1016/j.tig.2014.12.003</ext-link></comment> <object-id pub-id-type="pmid">25637093</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weinhold</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Jacobsen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schultz</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>W</given-names></name>. <article-title>Genome-wide analysis of noncoding regulatory mutations in cancer</article-title>. <source>Nat Genet</source>. <year>2014</year>;<volume>46</volume>: <fpage>1160</fpage>–<lpage>1165</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng.3101" xlink:type="simple">10.1038/ng.3101</ext-link></comment> <object-id pub-id-type="pmid">25261935</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedensohn</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sawarkar</surname> <given-names>R</given-names></name>. <article-title>Cis-regulatory variation: significance in biomedicine and evolution</article-title>. <source>Cell Tissue Res</source>. <year>2014</year>;<volume>356</volume>: <fpage>495</fpage>–<lpage>505</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00441-014-1855-3" xlink:type="simple">10.1007/s00441-014-1855-3</ext-link></comment> <object-id pub-id-type="pmid">24744265</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Johnson</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Mortazavi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Wold</surname> <given-names>B</given-names></name>. <article-title>Genome-wide mapping of in vivo protein-DNA interactions</article-title>. <source>Science</source>. <year>2007</year>;<volume>316</volume>: <fpage>1497</fpage>–<lpage>1502</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1141319" xlink:type="simple">10.1126/science.1141319</ext-link></comment> <object-id pub-id-type="pmid">17540862</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><collab>ENCODE Project Consortium</collab>. <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>489</volume>: <fpage>57</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11247" xlink:type="simple">10.1038/nature11247</ext-link></comment> <object-id pub-id-type="pmid">22955616</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Warner</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Philippakis</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Jaeger</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>FS</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bulyk</surname> <given-names>ML</given-names></name>. <article-title>Systematic identification of mammalian regulatory motifs’ target genes and functions</article-title>. <source>Nat Methods</source>. <year>2008</year>;<volume>5</volume>: <fpage>347</fpage>–<lpage>353</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1188" xlink:type="simple">10.1038/nmeth.1188</ext-link></comment> <object-id pub-id-type="pmid">18311145</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Badis</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>van Bakel</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Pena-Castillo</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Tillo</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tsui</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>A Library of Yeast Transcription Factor Motifs Reveals a Widespread Function for Rsc3 in Targeting Nucleosome Exclusion at Promoters</article-title>. <source>Molecular Cell</source>. <year>2008</year>;<volume>32</volume>: <fpage>878</fpage>–<lpage>887</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.molcel.2008.11.020" xlink:type="simple">10.1016/j.molcel.2008.11.020</ext-link></comment> <object-id pub-id-type="pmid">19111667</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stormo</surname> <given-names>GD</given-names></name>. <article-title>Modeling the specificity of protein-DNA interactions</article-title>. <source>Quant Biol</source>. <year>2013</year>;<volume>1</volume>: <fpage>115</fpage>–<lpage>130</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s40484-013-0012-4" xlink:type="simple">10.1007/s40484-013-0012-4</ext-link></comment> <object-id pub-id-type="pmid">25045190</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weirauch</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Cote</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Norel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Annala</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Riley</surname> <given-names>TR</given-names></name>, <etal>et al</etal>. <article-title>Evaluation of methods for modeling transcription factor sequence specificity</article-title>. <source>Nat Biotech</source>. <year>2013</year>;<volume>31</volume>: <fpage>126</fpage>–<lpage>134</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005403.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhuang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Iyer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>X-Y</given-names></name>, <name name-style="western"><surname>Greven</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>B-H</given-names></name>, <etal>et al</etal>. <article-title>Factorbook.org: a Wiki-based database for transcription factor-binding data generated by the ENCODE consortium</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>: <fpage>D171</fpage>–<lpage>176</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks1221" xlink:type="simple">10.1093/nar/gks1221</ext-link></comment> <object-id pub-id-type="pmid">23203885</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mathelier</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Parcy</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Worsley-Hunt</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Arenillas</surname> <given-names>DJ</given-names></name>, <etal>et al</etal>. <article-title>JASPAR 2014: an extensively expanded and updated open-access database of transcription factor binding profiles</article-title>. <source>Nucleic Acids Res</source>. <year>2014</year>;<volume>42</volume>: <fpage>D142</fpage>–<lpage>147</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt997" xlink:type="simple">10.1093/nar/gkt997</ext-link></comment> <object-id pub-id-type="pmid">24194598</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>von Hippel</surname> <given-names>PH</given-names></name>. <article-title>Increased subtlety of transcription factor binding increases complexity of genome regulation</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2014</year>;<volume>111</volume>: <fpage>17344</fpage>–<lpage>17345</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1418978111" xlink:type="simple">10.1073/pnas.1418978111</ext-link></comment> <object-id pub-id-type="pmid">25468983</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Siggers</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Gordân</surname> <given-names>R</given-names></name>. <article-title>Protein—DNA binding: complexities and multi-protein codes</article-title>. <source>Nucl Acids Res</source>. <year>2014</year>;<volume>42</volume>: <fpage>2099</fpage>–<lpage>2111</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt1112" xlink:type="simple">10.1093/nar/gkt1112</ext-link></comment> <object-id pub-id-type="pmid">24243859</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Afek</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schipper</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Horton</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gordân</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lukatsky</surname> <given-names>DB</given-names></name>. <article-title>Protein—DNA binding in the absence of specific base-pair recognition</article-title>. <source>PNAS</source>. <year>2014</year>;<volume>111</volume>: <fpage>17140</fpage>–<lpage>17145</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1410569111" xlink:type="simple">10.1073/pnas.1410569111</ext-link></comment> <object-id pub-id-type="pmid">25313048</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ghandi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mohammad-Noori</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Beer</surname> <given-names>MA</given-names></name>. <article-title>Enhanced regulatory sequence prediction using gapped k-mer features</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>: <fpage>e1003711</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003711" xlink:type="simple">10.1371/journal.pcbi.1003711</ext-link></comment> <object-id pub-id-type="pmid">25033408</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ghandi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mohammad-Noori</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ghareghani</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Garraway</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Beer</surname> <given-names>MA</given-names></name>. <article-title>gkmSVM: an R package for gapped-kmer SVM</article-title>. <source>Bioinformatics</source>. <year>2016</year>; <fpage>btw203</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005403.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Karchin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Beer</surname> <given-names>MA</given-names></name>. <article-title>Discriminative prediction of mammalian enhancers from DNA sequence</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>: <fpage>2167</fpage>–<lpage>2180</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.121905.111" xlink:type="simple">10.1101/gr.121905.111</ext-link></comment> <object-id pub-id-type="pmid">21875935</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zeng</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hashimoto</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>DD</given-names></name>, <name name-style="western"><surname>Gifford</surname> <given-names>DK</given-names></name>. <article-title>GERV: a statistical method for generative evaluation of regulatory variants for transcription factor binding</article-title>. <source>Bioinformatics</source>. <year>2015</year>; <fpage>btv565</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005403.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alipanahi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Delong</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weirauch</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Frey</surname> <given-names>BJ</given-names></name>. <article-title>Predicting the sequence specificities of DNA- and RNA-binding proteins by deep learning</article-title>. <source>Nat Biotech</source>. <year>2015</year>;<volume>33</volume>: <fpage>831</fpage>–<lpage>838</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005403.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xie</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Boyle</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Zhai</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kawli</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Snyder</surname> <given-names>M</given-names></name>. <article-title>Dynamic trans-Acting Factor Colocalization in Human Cells</article-title>. <source>Cell</source>. <year>2013</year>;<volume>155</volume>: <fpage>713</fpage>–<lpage>724</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2013.09.043" xlink:type="simple">10.1016/j.cell.2013.09.043</ext-link></comment> <object-id pub-id-type="pmid">24243024</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pique-Regi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Degner</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Pai</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Gaffney</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Gilad</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Pritchard</surname> <given-names>JK</given-names></name>. <article-title>Accurate inference of transcription factor binding from DNA sequence and chromatin accessibility data</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>: <fpage>447</fpage>–<lpage>455</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.112623.110" xlink:type="simple">10.1101/gr.112623.110</ext-link></comment> <object-id pub-id-type="pmid">21106904</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sherwood</surname> <given-names>RI</given-names></name>, <name name-style="western"><surname>Hashimoto</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>O’Donnell</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Barkal</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>van Hoff</surname> <given-names>JP</given-names></name>, <etal>et al</etal>. <article-title>Discovery of directional and nondirectional pioneer transcription factors by modeling DNase profile magnitude and shape</article-title>. <source>Nat Biotech</source>. <year>2014</year>;<volume>32</volume>: <fpage>171</fpage>–<lpage>178</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005403.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>He</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Meyer</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>M-W</given-names></name>, <name name-style="western"><surname>Zang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Refined DNase-seq protocol and data analysis reveals intrinsic bias in transcription factor footprint identification</article-title>. <source>Nat Meth</source>. <year>2014</year>;<volume>11</volume>: <fpage>73</fpage>–<lpage>78</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005403.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gorkin</surname> <given-names>DU</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Strober</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Asoni</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>McCallion</surname> <given-names>AS</given-names></name>, <etal>et al</etal>. <article-title>A method to predict the impact of regulatory variants from DNA sequence</article-title>. <source>Nat Genet</source>. <year>2015</year>;<volume>47</volume>: <fpage>955</fpage>–<lpage>961</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng.3331" xlink:type="simple">10.1038/ng.3331</ext-link></comment> <object-id pub-id-type="pmid">26075791</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>LeCun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Deep learning</article-title>. <source>Nature</source>. <year>2015</year>;<volume>521</volume>: <fpage>436</fpage>–<lpage>444</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature14539" xlink:type="simple">10.1038/nature14539</ext-link></comment> <object-id pub-id-type="pmid">26017442</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schmidhuber</surname> <given-names>J</given-names></name>. <article-title>Deep Learning in Neural Networks: An Overview</article-title>. <source>Neural Networks</source>. <year>2015</year>;<volume>61</volume>: <fpage>85</fpage>–<lpage>117</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neunet.2014.09.003" xlink:type="simple">10.1016/j.neunet.2014.09.003</ext-link></comment> <object-id pub-id-type="pmid">25462637</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref027"><label>27</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Zhou</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Troyanskaya</surname> <given-names>OG</given-names></name>. <chapter-title>Predicting effects of noncoding variants with deep learning-based sequence model</chapter-title>. <source>Nat Meth</source>. <year>2015</year>;<publisher-name>advance online publication</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1005403.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ernst</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kellis</surname> <given-names>M</given-names></name>. <article-title>Large-scale imputation of epigenomic datasets for systematic annotation of diverse human tissues</article-title>. <source>Nat Biotech</source>. <year>2015</year>;<volume>33</volume>: <fpage>364</fpage>–<lpage>376</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005403.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lecun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bottou</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Haffner</surname> <given-names>P</given-names></name>. <article-title>Gradient-based learning applied to document recognition</article-title>. <source>Proceedings of the IEEE</source>. <year>1998</year>;<volume>86</volume>: <fpage>2278</fpage>–<lpage>2324</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005403.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ducharme</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vincent</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Jauvin</surname> <given-names>C</given-names></name>. <article-title>A Neural Probabilistic Language Model</article-title>. <source>JOURNAL OF MACHINE LEARNING RESEARCH</source>. <year>2003</year>;<volume>3</volume>: <fpage>1137</fpage>–<lpage>1155</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005403.ref031"><label>31</label><mixed-citation publication-type="other" xlink:type="simple">Zeiler MD. ADADELTA: An Adaptive Learning Rate Method. arXiv:12125701 [cs]. 2012; <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1212.5701" xlink:type="simple">http://arxiv.org/abs/1212.5701</ext-link></mixed-citation></ref>
<ref id="pcbi.1005403.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ernst</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Plasterer</surname> <given-names>HL</given-names></name>, <name name-style="western"><surname>Simon</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Bar-Joseph</surname> <given-names>Z</given-names></name>. <article-title>Integrating multiple evidence sources to predict transcription factor binding in the human genome</article-title>. <source>Genome Res</source>. <year>2010</year>;<volume>20</volume>: <fpage>526</fpage>–<lpage>536</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.096305.109" xlink:type="simple">10.1101/gr.096305.109</ext-link></comment> <object-id pub-id-type="pmid">20219943</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Whitington</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Perkins</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Bailey</surname> <given-names>TL</given-names></name>. <article-title>High-throughput chromatin information enables accurate tissue-specific prediction of transcription factor binding sites</article-title>. <source>Nucleic Acids Res</source>. <year>2009</year>;<volume>37</volume>: <fpage>14</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkn866" xlink:type="simple">10.1093/nar/gkn866</ext-link></comment> <object-id pub-id-type="pmid">18988630</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mei</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Qin</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Zheng</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zang</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Cistrome Data Browser: a data portal for ChIP-Seq and chromatin accessibility data in human and mouse</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;</mixed-citation></ref>
<ref id="pcbi.1005403.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kheradpour</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ernst</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Melnikov</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rogov</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Systematic dissection of regulatory motifs in 2000 predicted human enhancers using a massively parallel reporter assay</article-title>. <source>Genome Res</source>. <year>2013</year>;<volume>23</volume>: <fpage>800</fpage>–<lpage>811</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.144899.112" xlink:type="simple">10.1101/gr.144899.112</ext-link></comment> <object-id pub-id-type="pmid">23512712</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cowper-Sal lari</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Bailey</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Cole</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Eeckhoute</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Breast cancer risk-associated SNPs modulate the affinity of chromatin for FOXA1 and alter gene expression</article-title>. <source>Nat Genet</source>. <year>2012</year>;<volume>44</volume>: <fpage>1191</fpage>–<lpage>1198</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng.2416" xlink:type="simple">10.1038/ng.2416</ext-link></comment> <object-id pub-id-type="pmid">23001124</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Degner</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Pai</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Pique-Regi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Veyrieras</surname> <given-names>J-B</given-names></name>, <name name-style="western"><surname>Gaffney</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Pickrell</surname> <given-names>JK</given-names></name>, <etal>et al</etal>. <article-title>DNase I sensitivity QTLs are a major determinant of human expression variation</article-title>. <source>Nature</source>. <year>2012</year>;<volume>482</volume>: <fpage>390</fpage>–<lpage>394</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10808" xlink:type="simple">10.1038/nature10808</ext-link></comment> <object-id pub-id-type="pmid">22307276</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leung</surname> <given-names>MKK</given-names></name>, <name name-style="western"><surname>Xiong</surname> <given-names>HY</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Frey</surname> <given-names>BJ</given-names></name>. <article-title>Deep learning of the tissue-regulated splicing code</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>: <fpage>i121</fpage>–<lpage>i129</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu277" xlink:type="simple">10.1093/bioinformatics/btu277</ext-link></comment> <object-id pub-id-type="pmid">24931975</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref039"><label>39</label><mixed-citation publication-type="other" xlink:type="simple">Cho K, van Merrienboer B, Bahdanau D, Bengio Y. On the Properties of Neural Machine Translation: Encoder-Decoder Approaches. arXiv:14091259 [cs, stat]. 2014; <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1409.1259" xlink:type="simple">http://arxiv.org/abs/1409.1259</ext-link></mixed-citation></ref>
<ref id="pcbi.1005403.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Qin</surname> <given-names>Q</given-names></name>, <etal>et al</etal>. <article-title>High-dimensional genomic data bias correction and data integration using MANCIE</article-title>. <source>Nat Commun</source>. <year>2016</year>;<volume>7</volume>: <fpage>11305</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms11305" xlink:type="simple">10.1038/ncomms11305</ext-link></comment> <object-id pub-id-type="pmid">27072482</object-id></mixed-citation></ref>
<ref id="pcbi.1005403.ref041"><label>41</label><mixed-citation publication-type="other" xlink:type="simple">Bergstra J, Breuleux O, Bastien F, Lamblin P, Pascanu R, Desjardins G, et al. Theano: a CPU and GPU Math Expression Compiler. Proceedings of the Python for Scientific Computing Conference (SciPy). Austin, TX; 2010.</mixed-citation></ref>
<ref id="pcbi.1005403.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bastien</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lamblin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pascanu</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bergstra</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Goodfellow</surname> <given-names>IJ</given-names></name>, <name name-style="western"><surname>Bergeron</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <source>Theano: new features and speed improvements</source>. <year>2012</year>.</mixed-citation></ref>
</ref-list>
</back>
</article>