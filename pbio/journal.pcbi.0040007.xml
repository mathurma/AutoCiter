<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0040007</article-id><article-id pub-id-type="publisher-id">07-PLCB-RA-0237R2</article-id><article-id pub-id-type="sici">plcb-04-01-08</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Evolutionary Biology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>evolution</subject><subject>transcriptional regulation</subject><subject>yeast</subject></subj-group></article-categories><title-group><article-title>Evolution and Selection in Yeast Promoters: Analyzing the Combined Effect of Diverse Transcription Factor Binding Sites</article-title><alt-title alt-title-type="running-head">Evolution and Selection in Yeast Promoters</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Raijman</surname><given-names>Daniela</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>
            <sup>1</sup>
          </sup>
          </xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Shamir</surname><given-names>Ron</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>
            <sup>1</sup>
          </sup>
          </xref><xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Tanay</surname><given-names>Amos</given-names></name><xref ref-type="aff" rid="aff2">
            <sup>
            <sup>2</sup>
          </sup>
          </xref><xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref></contrib></contrib-group><aff id="aff1">
        <label>1</label>
        <addr-line>
				 School of Computer Science, Tel Aviv University, Ramat Aviv, Israel
			</addr-line>
      </aff><aff id="aff2">
        <label>2</label>
        <addr-line>
				 Department of Computer Science and Applied Mathematics, The Weizmann Institute, Rehovot, Israel
			</addr-line>
      </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Vingron</surname><given-names>Martin</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Max Planck Institute for Molecular Genetics, Germany</aff><author-notes><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">rshamir@post.tau.ac.il</email> (RS); <email xlink:type="simple">amos.tanay@weizmann.ac.il</email> (AT)</corresp><fn fn-type="con" id="ack1"><p> DR, RS, and AT conceived and designed the experiments. DR performed the experiments. DR analyzed the data. DR, RS, and AT wrote the paper.</p></fn><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>1</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>11</day><month>1</month><year>2008</year></pub-date><volume>4</volume><issue>1</issue><elocation-id>e7</elocation-id><history><date date-type="received"><day>30</day><month>4</month><year>2007</year></date><date date-type="accepted"><day>28</day><month>11</month><year>2007</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder> Raijman et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>In comparative genomics one analyzes jointly evolutionarily related species in order to identify conserved and diverged sequences and to infer their function. While such studies enabled the detection of conserved sequences in large genomes, the evolutionary dynamics of regulatory regions as a whole remain poorly understood. Here we present a probabilistic model for the evolution of promoter regions in yeast, combining the effects of regulatory interactions of many different transcription factors. The model expresses explicitly the selection forces acting on transcription factor binding sites in the context of a dynamic evolutionary process. We develop algorithms to compute likelihood and to learn de novo collections of transcription factor binding motifs and their selection parameters from alignments. Using the new techniques, we examine the evolutionary dynamics in <italic>Saccharomyces</italic> species promoters. Analyses of an evolutionary model constructed using all known transcription factor binding motifs and of a model learned from the data automatically reveal relatively weak selection on most binding sites. Moreover, according to our estimates, strong binding sites are constraining only a fraction of the yeast promoter sequence that is under selection. Our study demonstrates how complex evolutionary dynamics in noncoding regions emerges from formalization of the evolutionary consequences of known regulatory mechanisms.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><sec id="st1"><title/><p>Cells use sophisticated regulation to transform static genomic information into flexible function. We are still far from understanding how such regulation evolves. Short DNA sequences that physically bind transcription factors in promoter areas near target genes play an important role in gene regulation and are directly subject to mutation and selection. In this work, we develop a methodology for studying the evolution of promoter sequences under the effect of multiple regulatory interactions. We present a model that describes the evolutionary process at each genomic locus, taking into account a random flux of mutations that occur in it and the effects of transcription factor binding sites gain or loss. Our model accounts for dependencies (or epistasis) between adjacent loci that contribute to the same regulatory interactions: mutation in one such locus immediately changes the effect of mutations in the other. Using our model, we characterize the evolution of promoters in yeast, showing that many regulatory interactions that were discovered experimentally or computationally are evolutionarily unstable. The dynamic nature of transcriptional interactions may be explained if the regulatory phenotype is achieved through multiple interactions at different levels of specificity, and if only relatively few of these interactions are essential for themselves.</p></sec></abstract><funding-group><funding-statement> RS was supported in part by the Israeli Science Foundation (grant 309/02), the Wolfson Foundation, and the Edmond and Beverly Sackler Chair in Bioinformatics. AT acknowledges a fellowship from the Center for Physics and Biology at The Rockefeller University where part of this work was done and an Alon fellowship.</funding-statement></funding-group><counts><page-count count="11"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Raijman D, Shamir R, Tanay A (2008) Evolution and selection in yeast promoters: Analyzing the combined effect of diverse transcription factor binding sites. PLoS Comput Biol 4(1): e7. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0040007" xlink:type="simple">10.1371/journal.pcbi.0040007</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Genomic regulatory regions harbor complex control schemes that collectively allow the genome to operate in a flexible and dynamic fashion. Such control schemes are encoded into the DNA sequence in a way that is not yet fully understood. Important elements of such regulatory code are short DNA sequences that are bound by transcription factors (TFs). TFs bind regulatory DNA specifically, by recognizing short motifs, and contribute to the assembly of complex switches that govern the transcription of a gene, given various environmental or internal signals. Much of the current understanding of the way in which DNA determines the regulatory program of a gene is based on identification of TF binding sites (TFBSs) and their association with TFs of known function.</p><p>Despite remarkable progress in functional genomics technologies, and in the ability to experimentally profile TF–DNA interactions on a genomic scale [<xref ref-type="bibr" rid="pcbi-0040007-b001">1</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b002">2</xref>], the understanding of function in regulatory regions remains a major challenge. At the same time, the complete sequencing of evolutionarily close genomes has made the detailed comparative study of regulatory regions possible. Consequently, comparative genomics has emerged as one of the central ways by which regulatory signals are computationally detected and studied. All comparative methods assume (explicitly or implicitly) an evolutionary model that distinguishes neutral sequences from functional ones. Most commonly [<xref ref-type="bibr" rid="pcbi-0040007-b003">3</xref>–<xref ref-type="bibr" rid="pcbi-0040007-b007">7</xref>], comparative studies focus on conservation, classifying sequences to be functional or nonfunctional by assuming that evolution in functional loci is slower. In yeast, many conserved loci were shown to correspond to TFBSs, allowing detection of novel sites that were not identifiable using single species methods.</p><p>As more species are sequenced, a desirable challenge is to extend the simple conservation-based studies by adding more structure to the function–evolution relationship in regulatory regions. In coding regions, our understanding of the genetic code makes sophisticated evolutionary predictions possible, e.g., by identifying cases of positive selection [<xref ref-type="bibr" rid="pcbi-0040007-b008">8</xref>], correlated residues [<xref ref-type="bibr" rid="pcbi-0040007-b009">9</xref>], and more. It is hoped that by acquiring better, more detailed understanding of the function encoded by regulatory loci, one can greatly extend the utility of comparative studies in a similar way.</p><p>In this study, building on simple assumptions of the mechanisms of transcriptional regulation, we formalize an evolutionary model combining a neutral mutational process with selection on multiple heterogeneous TFBSs. We develop techniques for computing the likelihood of such a model given pairwise alignments and for learning maximum-likelihood model parameters. Using the new techniques, we can express a substantial part of the current functional knowledge on gene regulation in evolutionary terms and evaluate observed patterns of divergence and conservation based on this model. Applying our method to promoter sequences of <italic>Saccharomyces</italic> yeast species, we validate our approach and exemplify its use. Specifically, we discuss how the selection on binding sites of different TFs vary in intensity, and how some families of similar TFBSs are in fact divided into subgroups that are separated by selection. We compute the fraction of promoter sequence that is under selection due to characterized TFBSs and show that strong TFBSs constitute only a small fraction of the promoter sequences in yeast. The gap between selection due to strong TFBSs and global estimates of the selection on yeast promoters can be used to estimate the relative roles of classical binding sites and of other effects (low affinity transcriptional interactions, and possibly other factors, e.g., chromatin organization) in driving functional transcriptional networks.</p></sec><sec id="s2"><title>Results</title><sec id="s2a"><title>Probabilistic Modeling of Promoter Evolution</title><p>We developed an integrated model for the evolution of promoters under the influence of heterogeneous TFBSs (<xref ref-type="sec" rid="s4">Methods</xref>). Briefly, the <italic>TF recognition code</italic> is a collection of distinct DNA motifs, where each motif (corresponding to a TF) is represented by a set of nucleotide k-mers. We assume that each set (termed <italic>target k-mer set</italic>) contains all k-mers recognized by the TF (see <xref ref-type="fig" rid="pcbi-0040007-g001">Figure 1</xref>A for an illustration), and any appearance of a k-mer from the target k-mer set is declared to be a binding site. All k-mers in the same target k-mer set are of the same length, but are otherwise unconstrained. In practice, target k-mer sets are usually variations over a consensus sequence. Our model represents a simplification of a much more complex biological reality, by assuming that binding at each locus is completely determined by the existence of a motif, and is either perfect or nonexisting (therefore ignoring differences in binding affinity between k-mers of the same target k-mer set). These simplifications allow us to develop a model for which computation is practical, but should be carefully evaluated and eventually relaxed in future revisions of the model.</p><fig id="pcbi-0040007-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0040007.g001</object-id><label>Figure 1</label><caption><title>An Integrated Model for Evolution under the Effect of Multiple TFs</title><p>(A) A TF recognition code. The TF recognition code model is defined by a set of target k-mer sets identified by specific TFs, and selection factors that quantify the intensity of selection on substitutions affecting them. In this example, the model consists of three target k-mer sets for three TFs. The background substitution probabilities are also part of the model.</p><p>(B) Selection on k-mers. Substitutions between k-mers that belong to a target k-mer set (large grey circles) and k-mers that do not belong to that target k-mer set are under negative selection. The probability for that substitution is derived by multiplying the background probability by the appropriate selection factor(s).</p><p>(C) Epistatic blocks. To compute the likelihood of a model given alignments, we first decompose the sequence into epistatic blocks that evolve almost independently of each other. Nontrivial epistatic blocks (marked by rectangles) include overlapping TFBSs or k-mers that are one substitution away from a target k-mer set (boundary k-mers). Ovals marked TFX represent a TFBS for TF X. Ovals marked (tfX) represent boundary k-mers for TF X. Loci that are not related to any TF form trivial epistatic blocks of size 1, and are not shown.</p><p>(D) Scheme for computing likelihood. We approach the complex task of computing likelihood in our model by decomposing the sequence to epistatic blocks and computing likelihood inside each of them.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040007.g001" xlink:type="simple"/></fig><p>To model the evolution of a promoter region, we assume that sequences are evolving neutrally, except for loci affected by selection on TFBSs. Each target k-mer set (and therefore each TF) is associated with a <italic>selection factor</italic> 0 ≤ σ ≤ 1, which represents the relative fixation probability of a mutation introducing or eliminating a binding site (note that the selection factor is not equivalent to the classical selection coefficient). Smaller σ values represent stronger selective pressure on loci bearing k-mers that belong to a given target set. Our model assumes that each appearance or loss of a TFBS is selected against. The replacement of a k-mer from a target set by another k-mer from the same target set is not selected against, since according to our model all k-mers in the same target set are equivalent. This simple functional model allows us, once equipped with a TF recognition code, to write down a Markov model representing the evolution of an entire promoter sequence.</p><p>The evolutionary forces outlined in our model affect the rate of mutation at a particular single base if it is in the context of a TFBS. The evolution of one base can therefore depend on several adjacent bases, and the model formalizes this type of <italic>epistasis</italic> using the simple assumptions of TFBSs described above. Although the epistasis considered by the model is simple and spatially limited (including only binding site k-mers), exact computation of the likelihood of a TF recognition code given a multiple or even pairwise alignment is very difficult and involves exponentiation of a 4<sup>l</sup> by 4<sup>l</sup> matrix, l being the sequence length. We developed algorithms for approximate calculation of the likelihood of a model, which provide us with a method for evaluating to what extent our model agrees with the patterns of divergence in the alignment. We score models by comparing their likelihood to that of a null model representing neutral substation rates on independent loci, deriving a log-likelihood ratio (LLR) score. Using these tools, we can search for maximum likelihood selection factors for a given recognition code, e.g., based on available experimental information. We can also learn a recognition code de novo directly from alignments and study the collective evolution of a group of TFBSs in an unbiased fashion (<xref ref-type="sec" rid="s4">Methods</xref>).</p><p>We note that our framework was not designed as an attempt to develop another TFBS motif finding algorithm, a problem that is already treated extensively in the literature [<xref ref-type="bibr" rid="pcbi-0040007-b010">10</xref>].</p><p>We focused on the evolutionary dynamics of <italic>Saccharomyces</italic> gene regulatory regions. The yeast system has the advantage of many well-documented TFBS motifs and clearly identifiable promoters, and was used before in many studies of transcriptional regulation and its evolution [<xref ref-type="bibr" rid="pcbi-0040007-b004">4</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b011">11</xref>]. We extracted pairwise alignments from multiple alignments of <italic>Saccharomyces sensu stricto</italic> species (<xref ref-type="sec" rid="s4">Methods</xref>). For example, the resulting alignments for <italic>S. cerevisiae–S. mikatae</italic> consisted of more than 900,000 aligned bases from the upstream regions of 3,503 genes, with 74.2% identity. Alignments of <italic>S. cerevisiae–S. bayanus</italic> and of <italic>S. cerevisiae–S. paradoxus</italic> were also used (<xref ref-type="supplementary-material" rid="pcbi-0040007-st001">Table S1</xref>).</p></sec><sec id="s2b"><title>Literature-Based TFBSs</title><p>We started by constructing an evolutionary model from known TF binding models. We used the compendium of TFBSs composed by MacIsaac et al. based on extensive ChIP-on-chip data and literature review [<xref ref-type="bibr" rid="pcbi-0040007-b012">12</xref>]. Out of 124 consensus sequences reported by the authors (in IUPAC format), we chose those 94 that translated to target k-mer sets containing at most 512 k-mers each, and had at least five matches in the aligned <italic>S. cerevisiae–S. mikatae</italic> promoters. We constructed a model starting from an empty one, and incrementally attempting to add each of the 94 target k-mer sets (in an arbitrary order). For each candidate target k-mer set in turn, we tentatively added it to the model and inferred an optimal selection factor for it. We then tested whether the expanded model with the added target k-mer set had a selection factor smaller than 1 and a higher model likelihood (note that a target k-mer set with a selection factor equal to 1 would result in a log-likelihood ratio of 0). If this was the case, the target k-mer set was accepted to the model. Otherwise it was rejected and not kept in the model. In total, we accepted 74 target k-mer sets (79%). Similar results were obtained for the other two yeast species.</p><p>We next studied possible factors that contribute to acceptance or rejection of literature target k-mer sets in our model. According to our model, every appearance of a motif is considered to be functional and under selection. In reality, not all appearances are necessarily functional, and some may be functionally different than others. We examined the correlation between the number of appearances of k-mers from a target k-mer set in the data and the model acceptance rate. While 87% of the target k-mer sets with 0–149 hits were accepted, only 77% of target k-mer sets with 150–499 hits were accepted, and only 47% of the target k-mer sets with more than 500 hits were accepted. These results suggest that the specificity of some of the literature target k-mer sets may be too low to allow acceptance by our rather stringent model.</p><p>To try to control for motif specificity in a systematic way, we next examined, for each TF, a model constructed using a limited dataset, containing only pairwise alignments of promoters that were found to be bound by that TF in ChIP-on-chip experiments (using a <italic>p</italic> &lt; 0.005 cutoff) [<xref ref-type="bibr" rid="pcbi-0040007-b002">2</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b013">13</xref>]. Since the set of ChIP-bound promoters is different for each TF, we could not construct a complete model in this case, but simply computed the LLR for each TF in a model containing a single k-mer target set. We call the resulting model the <italic>ChIP model</italic>. Out of 62 TFs with at least five hits in the ChIP bound promoters, 52 target k-mer sets had positive LLR at σ &lt; 1 (84%), of which six were not accepted in the original model (Spt2, Ndd1, Swi5, Bas1, Hap2 and Met31). All of the target k-mer sets that were accepted in the original model but not in the ChIP model (27 in total) had fewer than five hits in the ChIP data and therefore were not considered. In summary, although our model assumptions are simplistic, they are enough to roughly approximate the behavior of a large fraction of the known binding sites in the yeast genome. The cases of known TFBSs whose evolution is not well captured by the model are not resolved by restricting the analysis to experimentally verified TF targets, suggesting that the simple association between motifs and function does not hold for them.</p></sec><sec id="s2c"><title>Learning a Nonredundant TF Recognition Code De Novo</title><p>We next applied our model learning algorithm to construct a TF recognition code model de novo. By constructing a de novo model we were not hoping to discover new TFBS motifs, but rather to study the evolutionary dynamics of the yeast promoters given the selection on an unbiased set of putative TFBSs. The model was constructed automatically, considering gapless k-mers of width 6–12 as candidate target k-mer seeds (<xref ref-type="sec" rid="s4">Methods</xref>). The learning algorithm produced a model containing 62 target k-mer sets when executed on the <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content>–<named-content content-type="genus-species" xlink:type="simple">S. mikatae</named-content> alignments (see <xref ref-type="fig" rid="pcbi-0040007-g002">Figure 2</xref> and <xref ref-type="supplementary-material" rid="pcbi-0040007-st002">Table S2</xref>). The de novo target k-mer sets matched 45 distinct known motifs (<xref ref-type="sec" rid="s4">Methods</xref>). We note that most of the target k-mer sets that we learned are relatively specific, with no or limited redundancy, and that we preferred a larger model over a more stringent one, to allow global properties of the model to be explored.</p><fig id="pcbi-0040007-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0040007.g002</object-id><label>Figure 2</label><caption><title>De Novo Model</title><p>Shown are the LLR and selection factor values for the 20 target k-mer sets with the highest LLR values as discovered in the de novo model. The full model is presented in <xref ref-type="supplementary-material" rid="pcbi-0040007-st002">Table S2</xref>. For each target k-mer set, we present its motif logo, and, when the set matches a published binding site motif, its most likely TF. Target k-mer sets are sorted according to selection factor, indicating many of the known TFs as having relatively high factor and weak selection. Also shown is the LLR of each target k-mer set, which is affected by both the number of motif appearances and their divergence properties.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040007.g002" xlink:type="simple"/></fig><p>In our modeling framework, it can be assumed that each inferred target k-mer set represents a distinct function and that no two target k-mer sets that represent the same function coexist in the model. The reason for this is that substitutions between k-mers in two equivalent target k-mer sets of the same TF would be predicted by the model to be selected against (multiplying the probability of neutral substitution by the selection factors of each of the target k-mer sets), while, in fact, substitution between redundant target k-mer sets must behave neutrally. This discrepancy should result in lower likelihood for a model that includes two redundant target k-mer sets instead of just their union. Looking at the results, we indeed see only a few cases of seemingly redundant target k-mer sets, each of which can be biologically rationalized as described below.</p><p>In the first type of model redundancy, one target k-mer set contains substrings of another (e.g., GCGATGAGATG and CGATGAG in the PAC motif). This can be accounted for by the inaccuracy of the discrete binding assumption. If one target k-mer set represents strong (more specific) binding sites and the other represents weaker sites, then having two target k-mer sets with different selection factors improves likelihood. In this case, according to our model the selection on a locus with the more specific version is calculated as if it were part of binding sites for both target k-mer sets (implying a de facto stronger selection on it). In contrast, the selection on a locus with the less-specific version would be affected only by the selection factor of one target k-mer set. This is exemplified in <xref ref-type="fig" rid="pcbi-0040007-g003">Figure 3</xref>A.</p><fig id="pcbi-0040007-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0040007.g003</object-id><label>Figure 3</label><caption><title>Overlapping and Bimodal Target k-mer Sets</title><p>(A,B) We demonstrate the effect of similar motifs in two types of redundancies, using examples from the de novo model. In one type of redundancy (A), two motifs are overlapping (here GCGATGAGATG and CGATGAG). This organization corresponds to one effective motif with two levels of affinity. The strong affinity binding sites appears as a hit for both motifs, and therefore the selection on it is the combined selection of both motifs. The weak affinity binding sites appears as a hit for just one motif (CGATGAG). A different type of redundancy (B) associates two similar motifs that differ in one base (here TATTTATA and TATTTACA), suggesting selection is preserving the separation between two variants of the same motif. We quantify the intensity of separation by comparing the likelihoods of models with merged and separated target k-mer sets, or by directly assessing the rate of substitutions between motifs in the two target k-mer set variants (<xref ref-type="supplementary-material" rid="pcbi-0040007-se001">Text S1</xref>).</p><p>(C) Inferred bimodal motifs. Shown are cases of similar but separated target k-mer sets in the de novo model, indicating the number of observed and expected substitutions between them, a z-score for these numbers (see <xref ref-type="sec" rid="s4">Methods</xref>), and the LLR of the merged and separated models.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040007.g003" xlink:type="simple"/></fig><p>In the second type of model redundancy, two k-mers from distinct target k-mer sets differ in one position (e.g., TTACCCG and TTACCCT in the Reb1 motif, TATTTATA and TATTTACA in the Rlm1 motif). In this case, the likelihood of a model in which the two target k-mer sets are combined into one is lower than the likelihood of the redundant model. This suggests that the separation between the two target k-mer sets is selected for, possibly since BSs from each set are functioning differently (<xref ref-type="fig" rid="pcbi-0040007-g003">Figure 3</xref>B). Examples for such separation were argued for heuristically and demonstrated experimentally before [<xref ref-type="bibr" rid="pcbi-0040007-b011">11</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b014">14</xref>], but now we are equipped with the computational means to quantify such selection.</p><p>As shown in <xref ref-type="fig" rid="pcbi-0040007-g003">Figure 3</xref>C, substitutions between target k-mer sets that are seemingly redundant can be directly shown to occur at a lower rate than expected using Z-score statistics (<xref ref-type="sec" rid="s4">Methods</xref>), as well as using the LLR of the redundant and combined models. The cases we observed include the previously discussed Reb1 motifs [<xref ref-type="bibr" rid="pcbi-0040007-b011">11</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b015">15</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b016">16</xref>] and separation among variants of the still cryptic PAC motif. PAC targets are highly enriched in stress response genes [<xref ref-type="bibr" rid="pcbi-0040007-b017">17</xref>], but the mechanisms of PAC based regulation are not well characterized. We discovered two separated PAC-like families (GCGATGAG and GAGATGAG) that are significantly separated from each other. Interestingly, both variants of the PAC model tend to co-occur in the same promoters with the RRPE motifs (co-occurrence Z scores of 15.5 and 15.6), suggesting that they share a common mechanism rather than representing two distinct factors.</p></sec><sec id="s2d"><title>TFBS Selection Factors</title><p>An important characteristic of our model is the separation between background substitution rates and the selection factor on target k-mer sets (σ values). Since we analyzed separately pairwise alignments of three different species with <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content>, and since these species differ significantly in their divergence times from <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content>, we can compare the σ values of the same TFBS obtained in each pair of species. We can attribute differences in such σ values to changes in selective pressure or to other TF-specific effects (like divergence of the TF itself), rather than to different divergence times between species pairs or other background effects. According to the results (<xref ref-type="fig" rid="pcbi-0040007-g004">Figure 4</xref>) the σ values of the same TFBS are similar across the different species pairs (Spearman correlation values ranging around 0.9), even though some species pairs are four times as distant evolutionarily [<xref ref-type="bibr" rid="pcbi-0040007-b004">4</xref>–<xref ref-type="bibr" rid="pcbi-0040007-b007">7</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b018">18</xref>], suggesting that these values represent a quantity that is by and large independent of background divergence.</p><fig id="pcbi-0040007-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0040007.g004</object-id><label>Figure 4</label><caption><title>Selection Factors</title><p>Shown are inferred selection factors, compared for pairs of similar target k-mer sets on alignment of <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content> promoters with different yeast species. <italic>C</italic>, the correlation between the σ values in the two models. <italic>R</italic>, the root mean square difference value. The high correlation among the inferred σ values indicates that our model successfully decomposes the background mutation rate (which is different for each species) and the selection on each TFBS (which is quite stable as seen here).</p><p>(A,D,E) Comparison of σ values in the literature-based model for each pair of species.</p><p>(B) The literature-based model using ChIP-bound promoters only on <italic>cerevisiae-paradoxus</italic> alignments compared to the same model on <italic>cerevisiae-mikatae</italic> alignments.</p><p>(C) The de novo model on <italic>cerevisiae-paradoxus</italic> alignments compared to the same model on <italic>cerevisiae-mikatae</italic> alignments.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040007.g004" xlink:type="simple"/></fig><p>We observed significant variability in the inferred selection factor of known TF motifs in the literature-based target k-mer sets. Many of the well-known TFs with low degeneracy target k-mer sets (&lt;8 k-mers) had small σ values, suggesting specific binding and tight selection. Some examples are Reb1 (0.18), Rpn4 (0.16), Ume6 (0.03), and Leu3 (0.12). However, for other well-known motifs we derived much higher σ values. These include the CACGTG motifs (Cbf1, Pho4, Tye7, and Met28) (0.4–0.91), Mbp1 (0.46), Swi6 (0.54), and Msn2/4 (0.54). Interestingly, we inferred high σ values (&gt;0.35) for these TFs in the ChIP-restricted model, too (see <xref ref-type="supplementary-material" rid="pcbi-0040007-st003">Table S3</xref> for σ values computed for different ChIP thresholds). This suggests that the mild selection factors for these TFBSs are not primarily a side effect of false positives, since it is widely assumed that motifs in promoters that are also ChIP targets are very likely to be bound in vivo.</p><p>One possible explanation for the reduced selection on some of the target k-mer sets may be that k-mers from these sets tend to appear in multiple copies in each of the promoters they regulate. We therefore examined the percentage of promoters with multiple hits for specific target sets. All the motifs mentioned above as having tight selection (low σ) appear exactly once in all of the promoters, while motifs with less tight selection are occasionally repeated in promoter regions (Swi6 is repeated in 11% of its promoters, Pho4 and Tye7 in 7%, Msn2 and Mbp1 in 5%, and Msn4 in 5%). While the number of cases is too limited to reach a clear statistical conclusion on the relation between redundancy and selection, it can be hypothesized that for many TFs, redundancy may be high (including multiple hits and possibly also low specificity binding sites), and that such redundancy can alleviate some of the selective pressure on individual loci.</p><p>Another possible explanation to low selective pressure on the targets of some critical TFs may be that while some of the physical targets of these TFs are functionally essential and therefore under strong selection, other targets are evolutionarily transient and do not have a major functional role, although they bound specifically in vivo. This hypothesis should be further explored using experimental data on TF binding for additional yeast species.</p></sec><sec id="s2e"><title>Quantifying Selection on Boundary Motifs</title><p>The evolutionary model we described implies three evolutionary regimes on motifs: k-mers can a) be functional sites (part of a target k-mer set), b) be one substitution away from becoming a functional site (boundary k-mers), or c) be at a distance of two substitutions or more from any target k-mer set, and thus behave in a neutral manner (background k-mers) (<xref ref-type="fig" rid="pcbi-0040007-g005">Figure 5</xref>A). According to our basic assumptions, only substitutions between target k-mers and boundary k-mers are subject to selection. Consequently, we predict functional sites to be highly conserved, and boundary k-mers to be slightly conserved—not due to functionality but due to possible selection against binding site emergence. As discussed above, in cases where our modeling assumptions are too restrictive, we may be classifying as boundaries certain k-mers that are in fact weak binding sites. In these cases, we expect some selection to act on substitutions between such boundary k-mers and background k-mers.</p><fig id="pcbi-0040007-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0040007.g005</object-id><label>Figure 5</label><caption><title>Selection on Target k-mer Sets</title><p>(A) The selection on single nucleotide substitutions. Our model predicts substitutions between target k-mer set k-mers (inner circle) and boundary k-mers (ring) to be under negative selection, and substitutions between boundary k-mers and background k-mers (outside the ring) or between two background k-mers not to be under selection. The right hand box shows observed and expected counts for the substitutions in one example (CACGTG in the <italic>cerevisiae-mikatae</italic> alignment), as well as the ratio between the observed and expected counts.</p><p>(B) Ratio of observed and expected conservation. The plot shows the cumulative distribution of the ratios between the observed number of conserved motif appearances and the number expected given a neutral model. Shown are the distributions for three different sets of motifs: target k-mer set (red), boundary (green), and background (blue). A full concordance with the neutral model would have resulted in a perfect lognormal distribution. The background distribution is the closest to lognormal, but still shows bias toward increased conservation due to the clustering of mutations in yeast promoters (unpublished results). Target k-mers are conserved above what is expected. This is evident from looking at the observed–expected ratio distribution, and also when comparing it to the observed–expected ratio distribution for background k-mers (KS (Kolmogorov-Smirnov test) = 0.42 for difference from background k-mers, <italic>p</italic> &lt; 3.8e-43), and the same is true for boundary k-mers, but to a lesser degree (KS = 0.09 for difference from background k-mers, <italic>p</italic> &lt; 3.4e-36).</p><p>(C) Ratio of observed and expected substitutions. The plot shows the cumulative distribution of the ratios between the observed number of substitutions between motifs and the number expected by a neutral model. Shown are plots for substitutions between target k-mers and boundary k-mers (red), between boundary and background k-mers (green), and between background k-mers (blue). Substitutions between target k-mers and boundary k-mers appear less than expected. Again, this is evident when looking both at the ratio distribution (more than 60% of the data points have ratio &lt; 1) and at its difference from the distribution for substitutions between background k-mers (KS = 0.14, <italic>p</italic> &lt; 2.3e-13). Substitutions between boundary k-mers and background k-mers are also occurring less often than expected, but to a somewhat lesser extent (KS = 0.1, <italic>p</italic> &lt; 3.8e-169). As with the conservation data, the background distribution here is not lognormal, due to the non uniform distribution of mutations.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040007.g005" xlink:type="simple"/></fig><p>To try to characterize the global effects of selection on boundary k-mers, we compared the degree of conservation of target k-mer set, boundary, and neutral k-mers in the literature-based model. This was done by testing how often motifs from each of these groups appear conserved, compared to what is expected given a neutral model. As shown in <xref ref-type="fig" rid="pcbi-0040007-g005">Figure 5</xref>B, the observed conservation of target k-mers is far above what we expect from a neutral model. A weaker but still significant increase in conservation is observed for boundary k-mers, possibly due to weak selection on binding site appearance, or more likely because of mild selection on weak but functional sites. We next examined the substitutions between target k-mers and boundary k-mers, and between boundary and background k-mers, using again the number of observed substitutions compared to the number expected by a neutral model. As shown in <xref ref-type="fig" rid="pcbi-0040007-g005">Figure 5</xref>C, substitutions between target k-mers and boundary k-mers are occurring much less than expected given the neutral model. We observe a slightly weaker, yet similar pattern for substitutions from boundary to background k-mers. At least some of the boundary k-mers in our model may therefore be functional and under some weak selection, forming together with a target k-mer set a TFBS recognition model that is more complex than our simple assumptions.</p></sec><sec id="s2f"><title>Percentage of Sequence under TFBS Selection</title><p>Based on the literature model, 1.77% of the promoter sequence is covered by a TFBS. Using the de novo model, the fraction is 2.36%. These models may be extremely incomplete, but even using the entire repertoire of motifs in the MacIsaac study (without conservation or LLR constraints), the fraction is only 3.24%. It is therefore reasonable to conclude that only a small fraction of the promoter sequences is under tight selection against losing high-specificity binding sites.</p><p>Previous global studies on the selection on yeast promoters [<xref ref-type="bibr" rid="pcbi-0040007-b019">19</xref>] estimated that about 30% of the sequence in <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content> is under selection. The gap between these estimates and the scarcity of TFBSs can be explained in several ways. Weak selection may affect low-affinity or weakly functional [<xref ref-type="bibr" rid="pcbi-0040007-b020">20</xref>] boundary k-mers, and, in fact, when considering target set k-mers and boundary k-mers together, they cover 27.1% of the sequence in the literature-based model and 29.2% in the de novo model. Another possible factor contributing to the selection, which is not included in our model, are forces determining chromatin structure [<xref ref-type="bibr" rid="pcbi-0040007-b018">18</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b021">21</xref>].</p></sec></sec><sec id="s3"><title>Discussion</title><p>In this study we introduced a new probabilistic model for the evolution of promoter regions that takes into account the combined effects of multiple TFs. We developed an algorithm for calculating the likelihood of a model given pairwise alignments of promoters of orthologous genes from two species. Additionally, we developed algorithms for learning maximum likelihood model parameters. We applied our algorithms to <italic>Saccharomyces</italic> promoter regions, first inferring a model that summarized previously characterized TF specificities in yeast into one principled evolutionary model. We then applied our methods to learn a full model from scratch. We analyzed the patterns of selection on promoter regions as revealed by these models. Specifically, we used our models to study the intensity of selection on TFBSs and to estimate the amount of promoter region under selection due to high specificity TFBSs.</p><p>Given our results, it is evident that even on very short evolutionary time scales transcriptional regulation in yeast is highly dynamic. Indeed, the selection factors we computed for almost all TFBSs are higher (less tight) than what we might expect from functionally essential loci (averaging around 0.5). On average, the calculated selection seems to be weak, even if we restrict the analysis to functionally validated sites (ChIP targets). On the other hand, we observed a significant gap between the amount of selection we can account for using characterized TFBSs and the overall reported selection on yeast promoters. Taken together, it can be hypothesized that much of the functionality of transcriptional networks is encoded in ways other than strong TFBSs, and that due to high levels of redundancy, binding sites are under continuous remodeling [<xref ref-type="bibr" rid="pcbi-0040007-b022">22</xref>–<xref ref-type="bibr" rid="pcbi-0040007-b025">25</xref>]. Rather than being a deterministic and sparse network, transcriptional programs may be shaped as dense, noisy networks that are continuously changing during evolution.</p><p>Much of the past research on comparative methods for noncoding regions has focused on the evolutionary dynamics of TFBSs, as they have relatively well-defined features and a clear functional role. In addition to conservation-based methods for identifying TFBSs [<xref ref-type="bibr" rid="pcbi-0040007-b004">4</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b005">5</xref>], several studies introduced methods for detecting TFBS motifs using phylogeny-based probabilistic models that distinguish between the evolution of TFBSs and of the neutral background [<xref ref-type="bibr" rid="pcbi-0040007-b026">26</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b027">27</xref>]. Other studies associated the evolutionary rate with the physical strength of TF–DNA interactions [<xref ref-type="bibr" rid="pcbi-0040007-b011">11</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b015">15</xref>,<xref ref-type="bibr" rid="pcbi-0040007-b016">16</xref>]. These studies strongly motivated the development of a general model for the evolution of regulatory regions in the presence of TFBSs.</p><p>The more general approaches for context-aware molecular evolution were so far limited to modeling of neutral evolutionary processes [<xref ref-type="bibr" rid="pcbi-0040007-b028">28</xref>–<xref ref-type="bibr" rid="pcbi-0040007-b030">30</xref>], or tailored to rigidly structured protein coding regions [<xref ref-type="bibr" rid="pcbi-0040007-b031">31</xref>], RNA coding genes [<xref ref-type="bibr" rid="pcbi-0040007-b032">32</xref>], or CpG dinucleotides [<xref ref-type="bibr" rid="pcbi-0040007-b033">33</xref>]. The model we develop here is a step toward overcoming the major computational difficulties in handling the evolution of large regions with heterogeneous function (many binding sites, sparsely and non-uniformly arranged). To make the model more realistic, additional effects will have to be considered, including binding sites with variable affinities, chromatin structure, combinatorial regulation, and more. Computationally, the adaptation of our methods for computing likelihood and learning models to general phylogenies will require solution of a difficult ancestral inference problem [<xref ref-type="bibr" rid="pcbi-0040007-b034">34</xref>]. Analysis of more than two species will allow better understanding of the different dynamics associated with binding site gain and loss (which cannot be distinguished based on pairwise alignments). We hope that further work on these challenges will open the way to faithful modeling of regulatory evolution in higher eukaryotes.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4a"><title>Evolution under the effect of a TF recognition code.</title><p>Define a <italic>TF recognition code</italic> to be a collection of sets <italic>C<sub>1</sub>... C<sub>m</sub></italic> where each C<italic><sub>t</sub></italic> is a set of words of length <italic>k<sub>t</sub></italic>. <italic>C<sub>t</sub></italic> is called the <italic>target k-mer set</italic> of the <italic>t</italic>-th TF. Typically, <italic>C<sub>t</sub></italic> will consist of highly similar words. We define an indicator function <italic>β<sub>t</sub></italic>(<italic>s,i</italic>) whose value is 1 if the <italic>i</italic>-th position in sequence <italic>s</italic> falls inside a word from target k-mer set <italic>C<sub>t</sub></italic> (i.e., if the substring <italic>s</italic>[<italic>i−j,..,i−j</italic>+<italic>k<sub>t</sub></italic>-1<italic>)</italic>] ∈ <italic>C<sub>t</sub></italic> for some 0 ≤ <italic>j</italic> &lt; <italic>k<sub>t</sub></italic>), and 0 otherwise. Every occurrence of a word from <italic>C<sub>t</sub></italic> in the promoter sequence <italic>s</italic> is declared a binding site of the <italic>t</italic>-th TF. Our model therefore assumes that TFs recognize all loci-bearing words from their target k-mer sets, and no other loci. It also assumes that all words from the same target k-mer set behave identically, and that the target k-mer sets (and therefore the DNA binding domains of the TFs) remain constant during the evolutionary period considered. See <xref ref-type="fig" rid="pcbi-0040007-g001">Figure 1</xref>A for an illustration of a TF recognition code. A word of length <italic>k<sub>t</sub></italic> that does not belong to any target k-mer set is called a <italic>boundary k-mer</italic> for TF <italic>t</italic> if it is one substitution away from some k-mer in <italic>C<sub>t</sub></italic> (see <xref ref-type="fig" rid="pcbi-0040007-g001">Figure 1</xref>B).</p><p>Given two aligned sequences <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>, we define a model of the evolution of <italic>s</italic><sub>1</sub> into <italic>s</italic><sub>2</sub>, based on the TF recognition code model introduced above. We assume that each nucleotide in the sequence is evolving independently with a neutral substitution rate, with the exception that substitutions that change the regulatory role of a nucleotide—either eliminating or introducing a TFBS—are selected against. We model neutral evolution using a standard instantaneous nucleotide substitution rate matrix <italic>Q<sub>b</sub></italic>, defining <italic>Q<sub>b</sub></italic>(<italic>c</italic><sub>1</sub> → <italic>c</italic><sub>2</sub>) as the neutral rate of substitution from nucleotide <italic>c</italic><sub>1</sub> to <italic>c</italic><sub>2</sub>. The effect of selection on TFBSs of the <italic>t</italic>-th TF is formalized using a <italic>selection factor</italic> 0 &lt; σ<italic><sub>t</sub></italic> &lt; 1. We assume that a substitution with neutral rate <italic>p</italic> has a reduced rate σ<italic><sub>t</sub> p</italic> whenever it adds or removes a binding site for the TF <italic>t</italic>. The instantaneous rate of mutation at the <italic>i</italic>-th position of a sequence <italic>s</italic> is therefore defined by:
					<disp-formula id="pcbi-0040007-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040007.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:msub><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>&lsqb;</mml:mo><mml:mi>i</mml:mi><mml:mo>&rsqb;</mml:mo><mml:mo>&rarr;</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&lsqb;</mml:mo><mml:mi>i</mml:mi><mml:mo>&rsqb;</mml:mo><mml:mo>)</mml:mo><mml:mstyle displaystyle='true'><mml:msub><mml:mo>&prod;</mml:mo><mml:mi>t</mml:mi></mml:msub><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>&beta;</mml:mi><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mi>&beta;</mml:mi><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:msubsup></mml:mstyle></mml:math> --></disp-formula>where <italic>s′</italic> is equal to s in all positions but <italic>i</italic>.
				</p><p>To compute the probability of evolving from an entire sequence <italic>s</italic> to a sequence <italic>s′</italic>, we have to combine the effects of multiple TFBSs and of the neutral process, taking into account the epistasis between nucleotides at nearby positions that code for the same TFBS (<xref ref-type="fig" rid="pcbi-0040007-g001">Figure 1</xref>C). The interactions between loci make the common approach of decomposing the sequence into independently evolving loci impossible, since, for example, a mutation in one position that falls within a TFBS may abolish binding and completely alleviate the selective pressure on all other positions. To enable the computation in practice, we will rely on a parsimonious assumption that we outline below. We will show elsewhere how to derive this approximation from an unrestricted Markov model. We also note that our model is defined as symmetric and reversible, so the generalization to phylogenetic trees is direct.</p></sec><sec id="s4b"><title>The parsimonious Markov model.</title><p>Given two aligned sequences <italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, we define the set <italic>S</italic>(<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>) as the collection of sequences <italic>ŝ</italic> such that for all positions <italic>i</italic> either <italic>ŝ</italic>[<italic>i</italic>]= <italic>s</italic><sub>1</sub>[<italic>i</italic>] or <italic>ŝ</italic>[<italic>i</italic>]= <italic>s</italic><sub>2</sub>[<italic>i</italic>]. Our simplifying approximation is that in the evolutionary trajectory between <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>, only sequences in <italic>S</italic>(<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>) have occurred. Those sequences are called <italic>parsimonious with respect to s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub><italic>.</italic> Given a TF recognition code, we say that two positions <italic>i</italic>,<italic>j</italic> are <italic>epistatic</italic> if there exists a state <italic>s</italic>′ ∈ <italic>S</italic>(<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>) and a TF <italic>t</italic> such that <italic>s</italic>′[<italic>i</italic>] and <italic>s</italic>′[<italic>j</italic>] are part of the same appearance of a k-mer from <italic>C<sub>t</sub></italic>, or a boundary k-mer for TF <italic>t</italic>. An <italic>epistatic block</italic> is defined to be a maximum interval in the alignment in which every two adjacent positions are epistatic. The simplest epistatic block is a single neutral nucleotide, which does not interact with any TF in the extant sequences or in any parsimonious trajectory between them. The next basic case is that of an interval including exactly one TFBS (compare <xref ref-type="fig" rid="pcbi-0040007-g001">Figure 1</xref>C). In general, when there are several sites overlapping each other, the epistatic blocks define the smallest possible units for which we can compute the model likelihood independently. It can be shown that under the parsimonious assumption, the probability of <italic>s</italic><sub>1</sub> evolving into <italic>s</italic><sub>2</sub> equals the product of the probabilities of evolution in each of the epistatic blocks.</p><p>Working inside an epistatic block, we still have to compute the probability of evolving from <italic>s</italic><sub>1</sub> to <italic>s</italic><sub>2</sub> in time <italic>t</italic> using only sequences in <italic>S</italic>(<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>). This can be done by constructing a continuous time Markov model on all the parsimonious states of the block and an additional state designated OUT which absorbs all probability of transitions to nonparsimonious states. The total probability can then be computed using exponentiation of the model's rate matrix [<xref ref-type="bibr" rid="pcbi-0040007-b035">35</xref>]. In practice, we further approximate the matrix exponential using a time-quantized Markov model as follows: Define a time step <italic>dt</italic> as <italic>t</italic>/L where L is larger than the number of point mutations between <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>. The background mutation probabilities <italic>P<sub>b</sub></italic> for the time step <italic>dt</italic> are computed by exponentiation of the background rate matrix <italic>Q<sub>b</sub></italic>. We define model states <italic>u<sub>t,s</sub></italic> for times <italic>t</italic> = 0 … <italic>L</italic>−1 and sequences <italic>s</italic> ∈ <italic>S</italic>(<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>) and add the special state OUT. The transition probabilities <italic>Pr</italic>(<italic>u<sub>t,s</sub></italic> → <italic>u<sub>t</sub></italic><sub>+1,s′</sub>) are defined as
					<disp-formula id="pcbi-0040007-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040007.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>&rarr;</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>&equals;</mml:mo><mml:msub><mml:mo>&prod;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>&lsqb;</mml:mo><mml:mi>i</mml:mi><mml:mo>&rsqb;</mml:mo><mml:mo>&rarr;</mml:mo><mml:msup><mml:mi>s</mml:mi></mml:msup><mml:mo>&lsqb;</mml:mo><mml:mi>i</mml:mi><mml:mo>&rsqb;</mml:mo><mml:mo>)</mml:mo><mml:mo>&plus;</mml:mo><mml:msub><mml:mo>&sum;</mml:mo><mml:mi>s</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>&lsqb;</mml:mo><mml:mi>k</mml:mi><mml:mo>&rsqb;</mml:mo><mml:mi>!</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>s</mml:mi><mml:mo>&lsqb;</mml:mo><mml:mi>k</mml:mi><mml:mo>&rsqb;</mml:mo></mml:msub><mml:msub><mml:mo>&prod;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>&lsqb;</mml:mo><mml:mi>i</mml:mi><mml:mo>&rsqb;</mml:mo><mml:mo>&rarr;</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mspace width='-1pt'/><mml:mo>&lsqb;</mml:mo><mml:mi>i</mml:mi><mml:mo>&rsqb;</mml:mo><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mo>&prod;</mml:mo><mml:mi>t</mml:mi></mml:msub><mml:msubsup><mml:mo>&sigma;</mml:mo><mml:mo>t</mml:mo><mml:mo>|</mml:mo><mml:mi>&beta;</mml:mi><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mi>&beta;</mml:mi><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mtext>&prime;</mml:mtext><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:msubsup><mml:mo stretchy='true'>)</mml:mo><mml:mtext>if s and s</mml:mtext><mml:mo>&prime;</mml:mo><mml:mspace width="3pt"/><mml:mtext>that differ only at position k</mml:mtext><mml:mtext>:</mml:mtext></mml:math> --><!-- <mml:math display='block'><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>&rarr;</mml:mo><mml:mi>s</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>)</mml:mo><mml:mo>&equals;</mml:mo><mml:msub><mml:mo>&prod;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>&lsqb;</mml:mo><mml:mi>i</mml:mi><mml:mo>&rsqb;</mml:mo><mml:mo>&rarr;</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mspace width='-1pt'/><mml:mo>&lsqb;</mml:mo><mml:mi>i</mml:mi><mml:mo>&rsqb;</mml:mo><mml:mo>)</mml:mo><mml:msub><mml:mo>&prod;</mml:mo><mml:mi>t</mml:mi></mml:msub><mml:msubsup><mml:mo>&sigma;</mml:mo><mml:mo>t</mml:mo><mml:mo>|</mml:mo><mml:mi>&beta;</mml:mi><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mi>&beta;</mml:mi><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mtext>&prime;</mml:mtext><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:msubsup><mml:mspace width="3pt"/><mml:mtext>if</mml:mtext><mml:mspace width="3pt"/><mml:mi>s</mml:mi><mml:mspace width="3pt"/><mml:mtext>and</mml:mtext><mml:mspace width="3pt"/><mml:mi>s</mml:mi><mml:mspace width="-3pt"/><mml:mtext>&prime;</mml:mtext><mml:mspace width="2pt"/><mml:mtext>differ in more than one position</mml:mtext><mml:mspace width='-2.125pt'/><mml:mi>:</mml:mi><mml:mspace width="3pt"/><mml:mspace width="3pt"/><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>&rarr;</mml:mo><mml:mi>s</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn></mml:math> --></disp-formula>
				</p><p>We complete the transition probability from each state to 1 by adding an appropriate transition to the state OUT. Using this model, we can approximate the probability in one epistatic block by standard dynamic programming in the discrete Markov model.</p><p>In summary, to compute the likelihood of a model (target k-mer sets and selection factors) given a set of pairwise alignments, we work in phases (see <xref ref-type="fig" rid="pcbi-0040007-g001">Figure 1</xref>D). First we partition the alignment into epistatic blocks by searching for target k-mer set or boundary k-mers in the aligned sequences and their parsimonious combinations. We then compute the log-likelihood of each block using the discrete Markov model, and sum the contributions. Note that in a typical scenario, a substantial fraction of the sequence is neutral with respect to the model, which translates to epistatic blocks of length one. When computing the log-likelihood ratio of some model versus the null model, we can ignore all of these single-nucleotide blocks. Note that to compute log-likelihood ratios, we apply the time-quantized parsimonious approximation to both the null and the target models, thereby avoiding biases introduced by the approximation.</p></sec><sec id="s4c"><title>Model learning.</title><p>To learn a maximum likelihood model given a set of pairwise alignments, we devised a multiphase greedy algorithm. Formally, given a set of pairwise alignments and assuming a background neutral substitution model <italic>Q<sub>b</sub></italic> (which we compute directly from the alignments), we wish to find target k-mer sets <italic>C</italic><sub>1</sub> ... <italic>C<sub>m</sub></italic> and their selection factors σ<sub>1</sub> ... σ<italic><sub>m</sub></italic> such that the model likelihood is optimal. The algorithm optimizes the selection factors given fixed target k-mer sets, and repeatedly attempts to add additional target k-mer sets and to refine existing ones. The key point in the implementation of the algorithm is in careful weighting of candidate motifs for extending the recognition code, since considering all motifs at each step of the algorithm is infeasible. A detailed description of the algorithm is available in <xref ref-type="supplementary-material" rid="pcbi-0040007-se001">Text S1</xref> and <xref ref-type="supplementary-material" rid="pcbi-0040007-sg001">Figure S1</xref>. Additional details and data on simulation experiments is available in [<xref ref-type="bibr" rid="pcbi-0040007-b036">36</xref>].</p><p>Additional methods are in described in <xref ref-type="supplementary-material" rid="pcbi-0040007-se001">Text S1</xref>.</p></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi-0040007-sg001" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040007.sg001" xlink:type="simple"><label>Figure S1</label><caption><title>LLR Distribution of the 1st, 3<sup>rd</sup>, and 5th Ranked Motifs in Shuffled Data Experiments</title><p>(34 KB EPS)</p></caption></supplementary-material><supplementary-material id="pcbi-0040007-st001" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040007.st001" xlink:type="simple"><label>Table S1</label><caption><title>Alignment of Data Statistics</title><p>(25 KB DOC)</p></caption></supplementary-material><supplementary-material id="pcbi-0040007-st002" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040007.st002" xlink:type="simple"><label>Table S2</label><caption><title>The De Novo Model</title><p>(132 KB DOC)</p></caption></supplementary-material><supplementary-material id="pcbi-0040007-st003" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040007.st003" xlink:type="simple"><label>Table S3</label><caption><title>Effect of Binding Affinity Threshold on σ and LLR Values for Known Model</title><p>(136 KB DOC)</p></caption></supplementary-material><supplementary-material id="pcbi-0040007-se001" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040007.sd001" xlink:type="simple"><label>Text S1</label><caption><title>Supplementary Methods</title><p>(43 KB DOC)</p></caption></supplementary-material></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>LLR</term><def><p>log-likelihood ratio</p></def></def-item><def-item><term>TF</term><def><p>transcription</p></def></def-item><def-item><term>TFBS</term><def><p>transcription factor binding site</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0040007-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mukherjee</surname><given-names>S</given-names></name><name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name><name name-style="western"><surname>Jona</surname><given-names>G</given-names></name><name name-style="western"><surname>Wang</surname><given-names>XS</given-names></name><name name-style="western"><surname>Muzzey</surname><given-names>D</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>Rapid analysis of the DNA-binding specificities of transcription factors with DNA microarrays.</article-title>
					<source>Nat Genet</source>
					<volume>36</volume>
					<fpage>1331</fpage>
					<lpage>1339</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Harbison</surname><given-names>CT</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>DB</given-names></name><name name-style="western"><surname>Lee</surname><given-names>TI</given-names></name><name name-style="western"><surname>Rinaldi</surname><given-names>NJ</given-names></name><name name-style="western"><surname>Macisaac</surname><given-names>KD</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>Transcriptional regulatory code of a eukaryotic genome.</article-title>
					<source>Nature</source>
					<volume>431</volume>
					<fpage>99</fpage>
					<lpage>104</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Consortium</surname><given-names>MGS</given-names></name></person-group>
					<year>2002</year>
					<article-title>Initial sequencing and comparative analysis of the mouse genome.</article-title>
					<source>Nature</source>
					<volume>420</volume>
					<fpage>520</fpage>
					<lpage>562</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kellis</surname><given-names>M</given-names></name><name name-style="western"><surname>Patterson</surname><given-names>N</given-names></name><name name-style="western"><surname>Endrizzi</surname><given-names>M</given-names></name><name name-style="western"><surname>Birren</surname><given-names>B</given-names></name><name name-style="western"><surname>Lander</surname><given-names>E</given-names></name></person-group>
					<year>2003</year>
					<article-title>Sequencing and comparison of yeast species to identify genes and regulatory motifs.</article-title>
					<source>Nature</source>
					<volume>423</volume>
					<fpage>241</fpage>
					<lpage>254</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Xie</surname><given-names>X</given-names></name><name name-style="western"><surname>Lu</surname><given-names>J</given-names></name><name name-style="western"><surname>Kulbokas</surname><given-names>EJ</given-names></name><name name-style="western"><surname>Golub</surname><given-names>T</given-names></name><name name-style="western"><surname>Mootha</surname><given-names>V</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Systematic discovery of regulatory motifs in human promoters and 3′ UTRs by comparison of several mammals.</article-title>
					<source>Nature</source>
					<volume>434</volume>
					<fpage>338</fpage>
					<lpage>345</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Cliften</surname><given-names>P</given-names></name><name name-style="western"><surname>Sudarsanam</surname><given-names>P</given-names></name><name name-style="western"><surname>Desikan</surname><given-names>A</given-names></name><name name-style="western"><surname>Fulton</surname><given-names>L</given-names></name><name name-style="western"><surname>Fulton</surname><given-names>B</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Finding functional features in Saccharomyces genomes by phylogenetic footprinting.</article-title>
					<source>Science</source>
					<volume>301</volume>
					<fpage>71</fpage>
					<lpage>76</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Boffelli</surname><given-names>D</given-names></name><name name-style="western"><surname>McAuliffe</surname><given-names>J</given-names></name><name name-style="western"><surname>Ovcharenko</surname><given-names>D</given-names></name><name name-style="western"><surname>Lewis</surname><given-names>KD</given-names></name><name name-style="western"><surname>Ovcharenko</surname><given-names>I</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Phylogenetic shadowing of primate sequences to find functional regions of the human genome.</article-title>
					<source>Science</source>
					<volume>299</volume>
					<fpage>1391</fpage>
					<lpage>1394</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b008"><label>8</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Clark</surname><given-names>NL</given-names></name><name name-style="western"><surname>Swanson</surname><given-names>WJ</given-names></name></person-group>
					<year>2005</year>
					<article-title>Pervasive adaptive evolution in primate seminal proteins.</article-title>
					<source>PLOS Genetics</source>
					<volume>1</volume>
					<elocation-id>e35</elocation-id>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pgen.0010035" xlink:type="simple">10.1371/journal.pgen.0010035</ext-link></comment>
				</element-citation></ref><ref id="pcbi-0040007-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Choi</surname><given-names>SS</given-names></name><name name-style="western"><surname>Li</surname><given-names>W</given-names></name><name name-style="western"><surname>Lahn</surname><given-names>BT</given-names></name></person-group>
					<year>2005</year>
					<article-title>Robust signals of coevolution of interacting residues in mammalian proteomes identified by phylogeny-aided structural analysis.</article-title>
					<source>Nat Genet</source>
					<volume>37</volume>
					<fpage>1367</fpage>
					<lpage>1371</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tompa</surname><given-names>M</given-names></name><name name-style="western"><surname>Li</surname><given-names>N</given-names></name><name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name><name name-style="western"><surname>Church</surname><given-names>GM</given-names></name><name name-style="western"><surname>De Moor</surname><given-names>B</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Assessing computational tools for the discovery of transcription factor binding sites.</article-title>
					<source>Nat Biotechnol</source>
					<volume>23</volume>
					<fpage>137</fpage>
					<lpage>144</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b011"><label>11</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tanay</surname><given-names>A</given-names></name><name name-style="western"><surname>Gat-Viks</surname><given-names>I</given-names></name><name name-style="western"><surname>Shamir</surname><given-names>R</given-names></name></person-group>
					<year>2004</year>
					<article-title>A global view of the selection forces in the evolution of yeast cis-regulation.</article-title>
					<source>Genome Res</source>
					<volume>14</volume>
					<fpage>829</fpage>
					<lpage>834</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>MacIsaac</surname><given-names>KD</given-names></name><name name-style="western"><surname>Wang</surname><given-names>T</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>DB</given-names></name><name name-style="western"><surname>Gifford</surname><given-names>DK</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>An improved map of conserved regulatory sites for Saccharomyces cerevisiae.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>7</volume>
					<fpage>113</fpage>
				</element-citation></ref><ref id="pcbi-0040007-b013"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name><name name-style="western"><surname>McGuire</surname><given-names>AM</given-names></name><name name-style="western"><surname>Masuda</surname><given-names>N</given-names></name><name name-style="western"><surname>Church</surname><given-names>GM</given-names></name></person-group>
					<year>2004</year>
					<article-title>A motif co-occurrence approach for genome-wide prediction of transcription-factor-binding sites in Escherichia coli.</article-title>
					<source>Genome Res</source>
					<volume>14</volume>
					<fpage>201</fpage>
					<lpage>208</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>KL</given-names></name><name name-style="western"><surname>Warner</surname><given-names>JR</given-names></name></person-group>
					<year>1998</year>
					<article-title>Positive and negative autoregulation of REB1 transcription in \it Saccharomyces cerevisiae.</article-title>
					<source>Mol Cell Biol</source>
					<volume>18</volume>
					<fpage>4368</fpage>
					<lpage>4376</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lassig</surname><given-names>M</given-names></name><name name-style="western"><surname>Mustonen</surname><given-names>V</given-names></name></person-group>
					<year>2005</year>
					<article-title>Evolutionary population genetics of promoters: Predicting binding sites and functional phylogenies.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>102</volume>
					<fpage>15936</fpage>
					<lpage>15941</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b016"><label>16</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Moses</surname><given-names>AM</given-names></name><name name-style="western"><surname>Chiang</surname><given-names>DY</given-names></name><name name-style="western"><surname>Kellis</surname><given-names>M</given-names></name><name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>MB</given-names></name></person-group>
					<year>2003</year>
					<article-title>Position specific variation in the rate of evolution in transcription factor binding sites.</article-title>
					<source>BMC Evolutionary Biology</source>
					<volume>3</volume>
					<elocation-id>19</elocation-id>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1186/1471-2148-3-19" xlink:type="simple">10.1186/1471-2148-3-19</ext-link></comment>
				</element-citation></ref><ref id="pcbi-0040007-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gasch</surname><given-names>AP</given-names></name><name name-style="western"><surname>Spellman</surname><given-names>PT</given-names></name><name name-style="western"><surname>Kao</surname><given-names>CM</given-names></name><name name-style="western"><surname>Carmel-Harel</surname><given-names>O</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>MB</given-names></name><etal/></person-group>
					<year>2000</year>
					<article-title>Genomic expression programs in the response of yeast cells to environmental changes.</article-title>
					<source>Mol Biol Cell</source>
					<volume>11</volume>
					<fpage>4241</fpage>
					<lpage>4257</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Buck</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Lieb</surname><given-names>JD</given-names></name></person-group>
					<year>2006</year>
					<article-title>A chromatin-mediated mechanism for specification of conditional transcription factor targets.</article-title>
					<source>Nat Genet</source>
					<volume>38</volume>
					<fpage>1446</fpage>
					<lpage>1451</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Chin</surname><given-names>CS</given-names></name><name name-style="western"><surname>Chuang</surname><given-names>JH</given-names></name><name name-style="western"><surname>Li</surname><given-names>H</given-names></name></person-group>
					<year>2005</year>
					<article-title>Genome-wide regulatory complexity in yeast promoters: Separation of functionally conserved and neutral sequence.</article-title>
					<source>Genome Research</source>
					<volume>15</volume>
					<fpage>205</fpage>
					<lpage>213</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tanay</surname><given-names>A</given-names></name></person-group>
					<year>2006</year>
					<article-title>Extensive low-affinity transcriptional interactions in the yeast genome.</article-title>
					<source>Genome Res</source>
					<volume>16</volume>
					<fpage>962</fpage>
					<lpage>972</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Segal</surname><given-names>E</given-names></name><name name-style="western"><surname>Fondufe-Mittendorf</surname><given-names>Y</given-names></name><name name-style="western"><surname>Chen</surname><given-names>L</given-names></name><name name-style="western"><surname>Thastrom</surname><given-names>A</given-names></name><name name-style="western"><surname>Field</surname><given-names>Y</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>A genomic code for nucleosome positioning.</article-title>
					<source>Nature</source>
					<volume>442</volume>
					<fpage>772</fpage>
					<lpage>778</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Moses</surname><given-names>AM</given-names></name><name name-style="western"><surname>Pollard</surname><given-names>DA</given-names></name><name name-style="western"><surname>Nix</surname><given-names>DA</given-names></name><name name-style="western"><surname>Iyer</surname><given-names>VN</given-names></name><name name-style="western"><surname>Li</surname><given-names>XY</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>Large-scale turnover of functional transcription factor binding sites in Drosophila.</article-title>
					<source>PLoS Comput Biol</source>
					<volume>2</volume>
					<elocation-id>e130</elocation-id>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020130" xlink:type="simple">10.1371/journal.pcbi.0020130</ext-link></comment>
				</element-citation></ref><ref id="pcbi-0040007-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Doniger</surname><given-names>SW</given-names></name><name name-style="western"><surname>Fay</surname><given-names>JC</given-names></name></person-group>
					<year>2007</year>
					<article-title>Frequent gain and loss of functional transcription factor binding sites.</article-title>
					<source>PLoS Comput Biol</source>
					<volume>3</volume>
					<elocation-id>e99</elocation-id>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030099" xlink:type="simple">10.1371/journal.pcbi.0030099</ext-link></comment>
				</element-citation></ref><ref id="pcbi-0040007-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Odom</surname><given-names>DT</given-names></name><name name-style="western"><surname>Dowell</surname><given-names>RD</given-names></name><name name-style="western"><surname>Jacobsen</surname><given-names>ES</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>W</given-names></name><name name-style="western"><surname>Danford</surname><given-names>TW</given-names></name><etal/></person-group>
					<year>2007</year>
					<article-title>Tissue-specific transcriptional regulation has diverged significantly between human and mouse.</article-title>
					<source>Nat Genet</source>
					<volume>39</volume>
					<fpage>730</fpage>
					<lpage>732</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Borneman</surname><given-names>AR</given-names></name><name name-style="western"><surname>Gianoulis</surname><given-names>TA</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>ZD</given-names></name><name name-style="western"><surname>Yu</surname><given-names>H</given-names></name><name name-style="western"><surname>Rozowsky</surname><given-names>J</given-names></name><etal/></person-group>
					<year>2007</year>
					<article-title>Divergence of transcription factor binding sites across related yeast species.</article-title>
					<source>Science</source>
					<volume>317</volume>
					<fpage>815</fpage>
					<lpage>819</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b026"><label>26</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name><name name-style="western"><surname>Blanchette</surname><given-names>M</given-names></name><name name-style="western"><surname>Tompa</surname><given-names>M</given-names></name></person-group>
					<year>2004</year>
					<article-title>PhyME: a probabilistic algorithm for finding motifs in sets of orthologous sequences.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>5</volume>
					<elocation-id>170</elocation-id>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1186/1471-2105-5-170" xlink:type="simple">10.1186/1471-2105-5-170</ext-link>.</comment>
				</element-citation></ref><ref id="pcbi-0040007-b027"><label>27</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Siddharthan</surname><given-names>R</given-names></name><name name-style="western"><surname>Siggia</surname><given-names>ED</given-names></name><name name-style="western"><surname>Nimwegen</surname><given-names>Ev</given-names></name></person-group>
					<year>2005</year>
					<article-title>PhyloGibbs: A Gibbs sampling motif finder that incorporates phylogeny.</article-title>
					<source>PLOS Comput Biol</source>
					<volume>1</volume>
					<elocation-id>e67</elocation-id>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0010067" xlink:type="simple">10.1371/journal.pcbi.0010067</ext-link></comment>
				</element-citation></ref><ref id="pcbi-0040007-b028"><label>28</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Arndt</surname><given-names>PF</given-names></name><name name-style="western"><surname>Burge</surname><given-names>CB</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name></person-group>
					<year>2003</year>
					<article-title>DNA sequence evolution with neighbor-dependent mutation.</article-title>
					<source>J Comput Biol</source>
					<volume>10</volume>
					<fpage>313</fpage>
					<lpage>322</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Schadt</surname><given-names>E</given-names></name><name name-style="western"><surname>Lange</surname><given-names>K</given-names></name></person-group>
					<year>2002</year>
					<article-title>Codon and rate variation models in molecular phylogeny.</article-title>
					<source>Mol Biol Evol</source>
					<volume>19</volume>
					<fpage>1534</fpage>
					<lpage>1549</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b030"><label>30</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Siepel</surname><given-names>A</given-names></name><name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name></person-group>
					<year>2004</year>
					<article-title>Phylogenetic estimation of context-dependent substitution rates by maximum likelihood.</article-title>
					<source>Mol Biol Evol</source>
					<volume>21</volume>
					<fpage>468</fpage>
					<lpage>488</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pedersen</surname><given-names>AK</given-names></name><name name-style="western"><surname>Jensen</surname><given-names>JL</given-names></name></person-group>
					<year>2001</year>
					<article-title>A dependent-rates model and an MCMC-based methodology for the maximum-likelihood analysis of sequences with overlapping reading frames.</article-title>
					<source>Mol Biol Evol</source>
					<volume>18</volume>
					<fpage>763</fpage>
					<lpage>776</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b032"><label>32</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>J</given-names></name><name name-style="western"><surname>Thorne</surname><given-names>JL</given-names></name></person-group>
					<year>2006</year>
					<article-title>Dependence among sites in RNA evolution.</article-title>
					<source>Mol Biol Evol</source>
					<volume>23</volume>
					<fpage>1525</fpage>
					<lpage>1537</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b033"><label>33</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tanay</surname><given-names>A</given-names></name><name name-style="western"><surname>O'Donnell</surname><given-names>AH</given-names></name><name name-style="western"><surname>Damelin</surname><given-names>M</given-names></name><name name-style="western"><surname>Bestor</surname><given-names>TH</given-names></name></person-group>
					<year>2007</year>
					<article-title>Hyperconserved CpG domains underlie Polycomb-binding sites.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>104</volume>
					<fpage>5521</fpage>
					<lpage>5526</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jojic</surname><given-names>V</given-names></name><name name-style="western"><surname>Jojic</surname><given-names>N</given-names></name><name name-style="western"><surname>Meek</surname><given-names>C</given-names></name><name name-style="western"><surname>Geiger</surname><given-names>D</given-names></name><name name-style="western"><surname>Siepel</surname><given-names>A</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>Efficient approximations for learning phylogenetic HMM models from data.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<fpage>I161</fpage>
					<lpage>I168</lpage>
				</element-citation></ref><ref id="pcbi-0040007-b035"><label>35</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Karlin</surname><given-names>S</given-names></name><name name-style="western"><surname>Taylor</surname><given-names>HM</given-names></name></person-group>
					<year>1981</year>
					<source>A second course in stochastic processes</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Academic Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">542</size>
				</element-citation></ref><ref id="pcbi-0040007-b036"><label>36</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Raijaman</surname><given-names>D</given-names></name></person-group>
					<year>2007</year>
					<source>Evolution and selection in yeast promoters: Analyzing the combined effect of diverse transcription factor binding sites [MSc]</source>
					<publisher-loc>Tel Aviv</publisher-loc>
					<publisher-name>Tel Aviv University</publisher-name>
				</element-citation></ref></ref-list></back></article>