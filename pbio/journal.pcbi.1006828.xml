<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01408</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006828</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Differential equations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Algebra</subject><subj-group><subject>Linear algebra</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Motion</subject><subj-group><subject>Inertia</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Systems science</subject><subj-group><subject>Nonlinear dynamics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Systems science</subject><subj-group><subject>Nonlinear dynamics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Algebra</subject><subj-group><subject>Algebraic structures</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Algebra</subject><subj-group><subject>Linear algebra</subject><subj-group><subject>Eigenvalues</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Species interactions</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Scalable nonlinear programming framework for parameter estimation in dynamic biological system models</article-title>
<alt-title alt-title-type="running-head">Scalable NLP framework for parameter estimation in dynamic biological system models</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Shin</surname> <given-names>Sungho</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Venturelli</surname> <given-names>Ophelia S.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5744-7378</contrib-id>
<name name-style="western">
<surname>Zavala</surname> <given-names>Victor M.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Chemical and Biological Engineering, University of Wisconsin-Madison, Madison, Wisconsin, USA</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Biochemistry, University of Wisconsin-Madison, Madison, Wisconsin, USA</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Nie</surname> <given-names>Qing</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of California Irvine, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">victor.zavala@wisc.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>25</day>
<month>3</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>3</issue>
<elocation-id>e1006828</elocation-id>
<history>
<date date-type="received">
<day>5</day>
<month>9</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>30</day>
<month>1</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Shin et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006828"/>
<abstract>
<p>We present a nonlinear programming (NLP) framework for the scalable solution of parameter estimation problems that arise in dynamic modeling of biological systems. Such problems are computationally challenging because they often involve highly nonlinear and stiff differential equations as well as many experimental data sets and parameters. The proposed framework uses cutting-edge modeling and solution tools which are computationally efficient, robust, and easy-to-use. Specifically, our framework uses a time discretization approach that: i) avoids repetitive simulations of the dynamic model, ii) enables fully algebraic model implementations and computation of derivatives, and iii) enables the use of computationally efficient nonlinear interior point solvers that exploit sparse and structured linear algebra techniques. We demonstrate these capabilities by solving estimation problems for synthetic human gut microbiome community models. We show that an instance with 156 parameters, 144 differential equations, and 1,704 experimental data points can be solved in less than 3 minutes using our proposed framework (while an off-the-shelf simulation-based solution framework requires over 7 hours). We also create large instances to show that the proposed framework is scalable and can solve problems with up to 2,352 parameters, 2,304 differential equations, and 20,352 data points in less than 15 minutes. The proposed framework is flexible and easy-to-use, can be broadly applied to dynamic models of biological systems, and enables the implementation of sophisticated estimation techniques to quantify parameter uncertainty, to diagnose observability/uniqueness issues, to perform model selection, and to handle outliers.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Constructing and validating dynamic models of biological systems spanning biomolecular networks to ecological systems is a challenging problem. Here we present a scalable computational framework to rapidly infer parameters in complex dynamic models of biological systems from large-scale experimental data. The framework was applied to infer parameters of a synthetic microbial community model from large-scale time series data. We also demonstrate that this framework can be used to analyze parameter uncertainty, to diagnose whether the experimental data are sufficient to uniquely determine the parameters, to determine the model that best describes the data, and to infer parameters in the face of data outliers.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100008959</institution-id>
<institution>College of Engineering, University of Wisconsin-Madison</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5744-7378</contrib-id>
<name name-style="western">
<surname>Zavala</surname> <given-names>Victor M.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>SS and VMZ acknowledge financial support from the Office of the Vice Chancellor for Research and Graduate Education at the University of Wisconsin-Madison. OSV acknowledges support from the Army Research Office under Young Investigator Award W911NF-17-1-0296 and the National Institutes of Health under award NIGMS 1 R35 GM124774-01. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="13"/>
<table-count count="2"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-04-16</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The full Julia script is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/zavalab/JuliaBox/tree/master/MicrobialPLOS" xlink:type="simple">https://github.com/zavalab/JuliaBox/tree/master/MicrobialPLOS</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Dynamic modeling is essential for understanding the behavior of biological systems. Systems of interest in this domain include microbial communities and microbiome, gene regulatory networks, and metabolic pathways [<xref ref-type="bibr" rid="pcbi.1006828.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006828.ref003">3</xref>]. An important task that arises in modeling studies is validation against experimental data by using parameter estimation techniques. This task is computationally challenging because of the need to solve optimization problems constrained by differential equations. Challenges arise from the dimensionality, nonlinearity, and stiffness of the dynamic model, from the incomplete observation of the system states, from the need to estimate many parameters, and from the need to handle a large number of experimental data sets.</p>
<p>Extensive research on solution methods for estimation problems with differential equations has been reported in the computational biology literature (see [<xref ref-type="bibr" rid="pcbi.1006828.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref005">5</xref>] for comprehensive reviews). These methods target maximum likelihood estimation formulations (which are derived from Bayesian principles). In these formulations, one aims to find parameters that maximize the likelihood function. The most used strategy to handle such formulations is the so-called <italic>simulation-based</italic> approach. Here, the idea is to perform repetitive simulations of the dynamic model at different trial parameter values to identify a set of parameters that maximizes the likelihood. The trial parameter values are updated using derivative-based or derivative-free search schemes [<xref ref-type="bibr" rid="pcbi.1006828.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1006828.ref008">8</xref>]. While the simulation-based approach is intuitive, repetitive solutions of large dynamic models become computationally expensive and differential equation solvers can fail at trial parameter values that are non-physical or that trigger unstable responses. In addition, techniques to compute first and second order derivatives for derivative-based schemes (e.g., finite differences, forward and adjoint sensitivities) involve intrusive procedures and are often limited to first-order derivatives [<xref ref-type="bibr" rid="pcbi.1006828.ref007">7</xref>]. The need for derivatives can be bypassed by using derivative-free search schemes [<xref ref-type="bibr" rid="pcbi.1006828.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref010">10</xref>], which are widely popular in computational biology. Such methods include simulated annealing [<xref ref-type="bibr" rid="pcbi.1006828.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref012">12</xref>], genetic algorithms [<xref ref-type="bibr" rid="pcbi.1006828.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref014">14</xref>], particle swarms [<xref ref-type="bibr" rid="pcbi.1006828.ref015">15</xref>], approximate Bayesian computation [<xref ref-type="bibr" rid="pcbi.1006828.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref017">17</xref>], and various other methods [<xref ref-type="bibr" rid="pcbi.1006828.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref019">19</xref>]. Derivative-free schemes do not scale well in the number of parameters (a larger number of trial parameter values often need to be explored compared to derivative-based schemes). Moreover, second order derivative information is needed to determine if the parameter estimates are unique/observable given available experimental data [<xref ref-type="bibr" rid="pcbi.1006828.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref021">21</xref>]. The uniqueness/observability test of the parameter estimates is based on curvature information of the likelihood function at the solution.</p>
<p>Simulation-based estimation frameworks previously reported in the computational biology literature have focused on problems that usually contain less than 100 parameters [<xref ref-type="bibr" rid="pcbi.1006828.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref022">22</xref>]. To the best of our knowledge, the largest estimation problem solved using a simulation-based framework contains 3,780 data points and 1,801 parameters [<xref ref-type="bibr" rid="pcbi.1006828.ref007">7</xref>]. Such a problem was solved (to partial optimality) using a derivative-based search scheme that uses first-order derivative information (using an adjoint method) and required over 5 hours of computing time. The scalability limitations of simulation-based approaches present an important obstacle in considering models of higher fidelity, in exploiting high-throughput experimental data, in analyzing parameter uncertainties, and in implementing sophisticated techniques such as ensemble modeling.</p>
<p>In this work, we propose a nonlinear programming (NLP) framework for solving estimation problems with embedded dynamic models [<xref ref-type="bibr" rid="pcbi.1006828.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref024">24</xref>]. The framework is based on a <italic>direct transcription</italic> approach wherein the dynamic model is converted into a large set of algebraic equations by applying time-discretization techniques. The algebraic equations are then embedded directly as constraints in the optimization problem (a nonlinear program-NLP). The NLPs arising from time discretization are of high dimension (easily reaching hundreds of thousands to millions of variables and constraints) but are also <italic>sparse</italic> and <italic>structured</italic>. Moreover, by transforming the dynamic model into algebraic equations, it becomes possible to use automatic differentiation techniques available in modern algebraic modeling languages to compute first and second derivatives. Exploitation of sparsity and structure, together with the availability of derivative information, enable the solution of estimation problems with complex dynamic models and efficient handling of many parameters and experimental data sets.</p>
<p>Discretization-based estimation approaches have been widely studied in diverse fields such as chemical engineering [<xref ref-type="bibr" rid="pcbi.1006828.ref025">25</xref>–<xref ref-type="bibr" rid="pcbi.1006828.ref027">27</xref>] and aerospace engineering [<xref ref-type="bibr" rid="pcbi.1006828.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1006828.ref030">30</xref>] (see [<xref ref-type="bibr" rid="pcbi.1006828.ref031">31</xref>] for a comprehensive review) but less so in computational biology. A major factor that has hindered wider adoption is the lack of easy-to-use computational frameworks that facilitate access to <italic>non-expert users</italic>. In this work, we demonstrate that modern modeling and solution tools can be combined to create scalable, robust, easy-to-use, and flexible frameworks. We demonstrate the benefits by solving challenging estimation problems arising in microbial community models.</p>
<p>The proposed framework enables the implementation of higher level tasks such as observability analysis and uncertainty quantification. Uncertainty quantification (UQ) seeks to characterize parameter posterior distribution, which is necessary to obtain confidence levels/regions and parameter correlation information. Conventionally, UQ is performed by using second order derivative (Hessian) information of the likelihood function to construct an approximate parameter posterior covariance matrix [<xref ref-type="bibr" rid="pcbi.1006828.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref032">32</xref>] or by using a Markov-Chain-Monte-Carlo (MCMC) techniques [<xref ref-type="bibr" rid="pcbi.1006828.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1006828.ref036">36</xref>]. The Hessian-based approach is scalable but it requires intrusive computation (cannot be automatically computed by the solver) and does not capture well the effect of nonlinearities and physical constraints [<xref ref-type="bibr" rid="pcbi.1006828.ref032">32</xref>]. In MCMC, one samples parameters from the prior parameter density and compares the associated model outputs with experimental data to decide whether to accept that sample or not. By repeating these accept/reject steps one can construct an approximate parameter posterior. MCMC is rather easy to implement (it is not intrusive and does not require solving an optimization problem) but, being simulation-based, also suffers from potential failures of the differential equation solver at non-physical parameter samples, it does not scale well with the number of parameters, and it cannot handle constraints directly (e.g., nonnegative concentrations) [<xref ref-type="bibr" rid="pcbi.1006828.ref037">37</xref>]. In this work, we propose to overcome some of these challenges by using a randomized maximum a posteriori (rMAP) framework [<xref ref-type="bibr" rid="pcbi.1006828.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006828.ref039">39</xref>]. This method computes approximate (to second order) samples from the parameter posterior distribution by performing random perturbations on the experimental data and by re-solving the estimation problem. This allows exploration of the parameter space more efficiently compared to the MCMC scheme because each sample can be computed in parallel (MCMC is sequential). Moreover, the rMAP approach is non-intrusive, can capture nonlinear and physical constraints effects, and avoids potential failures of differential equation solvers. The proposed estimation framework is flexible and can easily accommodate advanced estimation formulations. To demonstrate this, we implement formulations that use different prior regularization schemes and <italic>k</italic>-max norms (the mean of a specified fraction of largest values) to mitigate large outliers [<xref ref-type="bibr" rid="pcbi.1006828.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref041">41</xref>].</p>
<p>The main contributions of this paper are summarized as follows. First, we provide an overview of parameter estimation and uncertainty quantification that leverages state-of-the-art optimization methods. Second, we demonstrate the computational capability of the nonlinear programming framework to handle large-scale parameter estimation problems for biological models. Lastly, we propose a novel problem formulation for parameter estimation using risk measures. <xref ref-type="fig" rid="pcbi.1006828.g001">Fig 1</xref> shows an outline of parameter estimation framework presented in this paper.</p>
<fig id="pcbi.1006828.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Illustration of the proposed estimation framework.</title>
<p>Mathematical models for biological systems are often expressed as systems of differential equations with parameters that need be estimated from experimental data. We formulate the estimation problem using a maximum a posteriori (MAP) formulation. This yields optimization problems constrained by differential equations that are transformed into fully algebraic nonlinear programs by using discretization schemes. The resulting NLPs can be easily implemented in algebraic modeling languages such as <monospace>JuMP</monospace> and <monospace>Plasmo.jl</monospace> that compute derivatives automatically and that are interfaced to powerful interior-point optimization solvers that exploit sparsity and structure to achieve high computational efficiency. The proposed framework is scalable, robust, easy-to-use, and flexible. These capabilities facilitate high-level tasks such as identification of parameter observability/uniqueness issues, model selection, and uncertainty quantification.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g001" xlink:type="simple"/>
</fig>
<p>The paper is organized as follows. The methods section provides a general form for the estimation problem under study and discusses how this can be cast as a sparse NLP by using time-discretization techniques. Furthermore, we introduce basic concepts behind NLP solvers that exploit sparsity and structures at the linear algebra level. In addition, we discuss rMAP and outlier mitigation schemes. In the results section, we demonstrate that the proposed framework can handle challenging estimation problems arising in microbial community models.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Estimation for dynamic models</title>
<p>We consider estimation problems of the following form:
<disp-formula id="pcbi.1006828.e001"><alternatives><graphic id="pcbi.1006828.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mtext>min</mml:mtext> <mml:mi>θ</mml:mi></mml:munder> <mml:mspace width="1em"/></mml:mrow></mml:mstyle><mml:mrow><mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>φ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
<disp-formula id="pcbi.1006828.e002"><alternatives><graphic id="pcbi.1006828.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>s</mml:mtext> <mml:mo>.</mml:mo> <mml:mtext>t</mml:mtext> <mml:mo>.</mml:mo> <mml:mspace width="1.em"/></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
<disp-formula id="pcbi.1006828.e003"><alternatives><graphic id="pcbi.1006828.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
<disp-formula id="pcbi.1006828.e004"><alternatives><graphic id="pcbi.1006828.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
<disp-formula id="pcbi.1006828.e005"><alternatives><graphic id="pcbi.1006828.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mspace width="1.em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.166667em"/><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
Here, <inline-formula id="pcbi.1006828.e006"><alternatives><graphic id="pcbi.1006828.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi mathvariant="script">K</mml:mi> <mml:mo>≔</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>…</mml:mo> <mml:mi>K</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the <italic>set of experiments</italic> and <inline-formula id="pcbi.1006828.e007"><alternatives><graphic id="pcbi.1006828.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>≔</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the set of measurement (sampling) times in experiment <inline-formula id="pcbi.1006828.e008"><alternatives><graphic id="pcbi.1006828.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Time is denoted as <italic>t</italic> ∈ [0, <italic>T</italic><sub><italic>k</italic></sub>], where <inline-formula id="pcbi.1006828.e009"><alternatives><graphic id="pcbi.1006828.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mi>T</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the duration for experiment <inline-formula id="pcbi.1006828.e010"><alternatives><graphic id="pcbi.1006828.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. The variable vector <inline-formula id="pcbi.1006828.e011"><alternatives><graphic id="pcbi.1006828.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>:</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi> <mml:mo>→</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the differential <italic>state</italic> time trajectories, <inline-formula id="pcbi.1006828.e012"><alternatives><graphic id="pcbi.1006828.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mi>θ</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the model <italic>parameters</italic>, <inline-formula id="pcbi.1006828.e013"><alternatives><graphic id="pcbi.1006828.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the model predicted <italic>outputs</italic> with corresponding <italic>experimental observations</italic> <inline-formula id="pcbi.1006828.e014"><alternatives><graphic id="pcbi.1006828.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> at time <inline-formula id="pcbi.1006828.e015"><alternatives><graphic id="pcbi.1006828.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and experiment <inline-formula id="pcbi.1006828.e016"><alternatives><graphic id="pcbi.1006828.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006828.e017"><alternatives><graphic id="pcbi.1006828.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are initial conditions for experiment <inline-formula id="pcbi.1006828.e018"><alternatives><graphic id="pcbi.1006828.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. For convenience in the notation, we define the output vectors <inline-formula id="pcbi.1006828.e019"><alternatives><graphic id="pcbi.1006828.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the experimental output vectors <inline-formula id="pcbi.1006828.e020"><alternatives><graphic id="pcbi.1006828.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for experiment <inline-formula id="pcbi.1006828.e021"><alternatives><graphic id="pcbi.1006828.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> as well as the total output vector <inline-formula id="pcbi.1006828.e022"><alternatives><graphic id="pcbi.1006828.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>K</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the total experimental output vector <italic>η</italic> = (<italic>η</italic><sub>1</sub>, ⋯, <italic>η</italic><sub><italic>K</italic></sub>). The vector function <italic>f</italic><sub><italic>k</italic></sub>(⋅) denotes the dynamic model mapping, <italic>φ</italic>(⋅) and <italic>φ</italic><sub><italic>k</italic></sub>(⋅) are objective function mappings, <italic>ϕ</italic><sub><italic>k</italic></sub>(⋅) is the state-to-output mapping, and <italic>h</italic><sub><italic>k</italic></sub>(⋅) is the constraint mapping. All the mappings are assumed to be at least twice continuously differentiable with respect to all the arguments. The estimation formulation (<xref ref-type="disp-formula" rid="pcbi.1006828.e001">1</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e005">5</xref>) captures all the features of our proposed framework. Our framework, however, can also accommodate more general features; for instance, the initial conditions (<xref ref-type="disp-formula" rid="pcbi.1006828.e003">3</xref>) can be also considered as unknown variables that need to be estimated and we can define non-additive objective functions that penalize large errors.</p>
<p>Problem (<xref ref-type="disp-formula" rid="pcbi.1006828.e001">1</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e005">5</xref>) can be derived from Bayesian principles. To see this and introduce some useful notation, we start from Bayes theorem:
<disp-formula id="pcbi.1006828.e023"><alternatives><graphic id="pcbi.1006828.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mspace width="0.166667em"/><mml:mo>|</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
Here, <italic>p</italic>(<italic>θ</italic> | <italic>η</italic>) is the parameter posterior density (i.e., the parameter density given knowledge on the outputs), <italic>p</italic>(<italic>η</italic> | <italic>θ</italic>) is the output posterior density (i.e., the outputs given knowledge on the parameters), <italic>p</italic>(<italic>θ</italic>) is the prior density (i.e., parameter density before knowledge of the output), and <italic>p</italic>(<italic>η</italic>) is the output marginal density. In a maximum a posteriori (MAP) formulation, the goal is to find the parameters that maximize <italic>p</italic>(<italic>θ</italic> | <italic>η</italic>). Because <italic>p</italic>(<italic>η</italic>) does not depend on <italic>θ</italic>, this can also be achieved by maximizing <italic>p</italic>(<italic>η</italic>|<italic>θ</italic>)<italic>p</italic>(<italic>θ</italic>). Maximizing <italic>p</italic>(<italic>η</italic>|<italic>θ</italic>)<italic>p</italic>(<italic>θ</italic>) is equivalent to maximizing the log-likelihood function <italic>L</italic>(<italic>θ</italic>) = log(<italic>p</italic>(<italic>θ</italic>)) + log <italic>p</italic>(<italic>η</italic>|<italic>θ</italic>). If the outputs from the experiments <inline-formula id="pcbi.1006828.e024"><alternatives><graphic id="pcbi.1006828.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> are independent (which is usually the case), we have that <inline-formula id="pcbi.1006828.e025"><alternatives><graphic id="pcbi.1006828.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:msub> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>|</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and thus:
<disp-formula id="pcbi.1006828.e026"><alternatives><graphic id="pcbi.1006828.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:munder> <mml:mo form="prefix">log</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
The observed outputs are random variables that are usually considered to be Gaussian and thus <inline-formula id="pcbi.1006828.e027"><alternatives><graphic id="pcbi.1006828.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mo>Σ</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where Σ<sub><italic>k</italic></sub> is the covariance matrix. The prior density <italic>p</italic>(<italic>θ</italic>) is also often assumed to be Gaussian and thus <inline-formula id="pcbi.1006828.e028"><alternatives><graphic id="pcbi.1006828.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:mi>θ</mml:mi> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:msub><mml:mo>Σ</mml:mo> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006828.e029"><alternatives><graphic id="pcbi.1006828.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the mean of the prior distribution and Σ<sub><italic>θ</italic></sub> is its covariance. With this, we obtain:
<disp-formula id="pcbi.1006828.e030"><alternatives><graphic id="pcbi.1006828.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>−</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>n</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo form="prefix">log</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo form="prefix">log</mml:mo> <mml:mtext>det</mml:mtext> <mml:msub><mml:mo>Σ</mml:mo> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msubsup><mml:mo>Σ</mml:mo> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
<disp-formula id="pcbi.1006828.e031"><alternatives><graphic id="pcbi.1006828.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>−</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>n</mml:mi> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo form="prefix">log</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo form="prefix">log</mml:mo> <mml:mtext>det</mml:mtext> <mml:msub><mml:mo>Σ</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msubsup><mml:mo>Σ</mml:mo> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
By comparing (<xref ref-type="disp-formula" rid="pcbi.1006828.e026">7</xref>) with (<xref ref-type="disp-formula" rid="pcbi.1006828.e001">1</xref>) we can see that minimizing <inline-formula id="pcbi.1006828.e032"><alternatives><graphic id="pcbi.1006828.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>φ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is equivalent to minimizing −<italic>L</italic>(<italic>θ</italic>). Here, the dynamic model together with the state-to-output mapping defines a <italic>parameter-to-output mapping</italic> of the form <inline-formula id="pcbi.1006828.e033"><alternatives><graphic id="pcbi.1006828.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>≔</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In a simulation-based estimation approach, the mapping <italic>m</italic><sub><italic>k</italic></sub>(<italic>θ</italic>) is computed by simulating the dynamic model (<xref ref-type="disp-formula" rid="pcbi.1006828.e002">2</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e003">3</xref>) at a trial value <italic>θ</italic> using a differential equation solver and by evaluating the outputs at the sampling times <inline-formula id="pcbi.1006828.e034"><alternatives><graphic id="pcbi.1006828.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> using (<xref ref-type="disp-formula" rid="pcbi.1006828.e004">4</xref>). In a discretization-based approach, the mapping <italic>m</italic><sub><italic>k</italic></sub>(<italic>θ</italic>) is not computed explicitly (but we use it here as a mathematical representation that is used to explain some relevant concepts). Constraints (<xref ref-type="disp-formula" rid="pcbi.1006828.e005">5</xref>) restrict the parameter space to be explored.</p>
<p>After dropping all constant terms in the likelihood function we obtain:
<disp-formula id="pcbi.1006828.e035"><alternatives><graphic id="pcbi.1006828.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>φ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msubsup><mml:mo>Σ</mml:mo> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
<disp-formula id="pcbi.1006828.e036"><alternatives><graphic id="pcbi.1006828.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>φ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msubsup><mml:mo>Σ</mml:mo> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
The function <italic>φ</italic>(<italic>θ</italic>) is usually known as the <italic>prior</italic> term and provides a <italic>regularization</italic> effect that stabilizes the solution of the estimation problem when the parameters cannot be uniquely infered from the available data [<xref ref-type="bibr" rid="pcbi.1006828.ref042">42</xref>–<xref ref-type="bibr" rid="pcbi.1006828.ref045">45</xref>]. This regularization term arises from the prior density <italic>p</italic>(<italic>θ</italic>) and provides a mechanism to encode knowledge on the parameters. Assuming that the prior density is Gaussian gives rise to a prior term that is defined by a weighted L2 norm. Recently, the machine learning community has also proposed the use of regularization terms that use L1 norms (e.g., <inline-formula id="pcbi.1006828.e037"><alternatives><graphic id="pcbi.1006828.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mrow><mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>‖</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>). The L1 norm induces sparsity in the parameters and corresponds to assuming that the prior density is Laplacian. One can also show that an L1 norm acts as an exact penalty function and implicitly induces constraints on the parameters. Similarly, one can also use the inequality constraints <italic>h</italic><sub><italic>k</italic></sub>(⋅) to directly embed physical knowledge in the MAP formulation (e.g., concentrations can only be positive).</p>
<p>From (<xref ref-type="disp-formula" rid="pcbi.1006828.e035">10</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1006828.e036">11</xref>) we see that <italic>φ</italic><sub><italic>k</italic></sub>(⋅) are squared error terms and thus the MAP problem minimizes the <italic>sum</italic> of the squared errors across all experiments <inline-formula id="pcbi.1006828.e038"><alternatives><graphic id="pcbi.1006828.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. This approach offers limited control on large errors that might result from data outliers. Here, we propose to use a <italic>k</italic>-max norm to mitigate these issues. Our proposal is based on the observation that a <italic>k</italic>-max norm is equivalent to a conditional-value-at-risk (CVaR) norm [<xref ref-type="bibr" rid="pcbi.1006828.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref046">46</xref>]. The CVaR<sub><italic>β</italic></sub> norm of a vector <bold>e</bold> = (<italic>e</italic><sub>1</sub>, ⋯, <italic>e</italic><sub><italic>K</italic></sub>) with components <inline-formula id="pcbi.1006828.e039"><alternatives><graphic id="pcbi.1006828.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:msub><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>φ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is defined as the average of the <italic>β</italic>-fraction of largest elements of the vector (where <italic>β</italic> ∈ [0, 1] is a parameter that defines the size of the fraction) [<xref ref-type="bibr" rid="pcbi.1006828.ref046">46</xref>]. One can show that, when <italic>β</italic> → 1, the CVaR norm is the largest fitting error and, when <italic>β</italic> → 0, the CVaR norm is the sum of fitting errors (as in the standard MAP formulation). A key computational property of the CVaR norm is that it can be formulated as a standard optimization problem. In particular, the MAP problem with a CVaR error norm can be expressed as:
<disp-formula id="pcbi.1006828.e040"><alternatives><graphic id="pcbi.1006828.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mtext>min</mml:mtext> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>γ</mml:mi></mml:mrow></mml:munder> <mml:mspace width="1.em"/></mml:mrow></mml:mstyle><mml:mrow><mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>K</mml:mi> <mml:mo>(</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mi>β</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mo>[</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:mi>γ</mml:mi><mml:msub><mml:mo>]</mml:mo> <mml:mo>+</mml:mo></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
<disp-formula id="pcbi.1006828.e041"><alternatives><graphic id="pcbi.1006828.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>s.t.</mml:mtext> <mml:mspace width="1.em"/></mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo> <mml:mo>−</mml:mo> <mml:mo>(</mml:mo> <mml:mn>5</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
where [⋅]<sup>+</sup> = max(0, ⋅) is the max function and <italic>γ</italic> is an auxiliary variable [<xref ref-type="bibr" rid="pcbi.1006828.ref041">41</xref>].</p>
</sec>
<sec id="sec004">
<title>Nonlinear programming formulation</title>
<p>To solve the MAP problem (<xref ref-type="disp-formula" rid="pcbi.1006828.e001">1</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e005">5</xref>) we approximate the differential equations by using a discretization scheme. This enables the use of computationally efficient NLP solvers and facilitates high-level UQ and observability monitoring tasks.</p>
<sec id="sec005">
<title>Time discretization</title>
<p>Discretization schemes such as Euler, Runge-Kutta, and orthogonal collocation are commonly used to transform differential equations into algebraic ones. Orthogonal collocation is often preferred because accurate approximations can be obtained with few discretization points [<xref ref-type="bibr" rid="pcbi.1006828.ref023">23</xref>]. To simplify the presentation we use an implicit Euler scheme, which can be shown to be a special type of an orthogonal collocation scheme (it is a one-point Radau collocation scheme). We discretize the time domain [0, <italic>T</italic><sub><italic>k</italic></sub>] into a set of intervals with fixed discrete-time points <inline-formula id="pcbi.1006828.e042"><alternatives><graphic id="pcbi.1006828.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for each experiment <inline-formula id="pcbi.1006828.e043"><alternatives><graphic id="pcbi.1006828.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> (where <italic>t</italic><sub>0</sub> = 0 and <inline-formula id="pcbi.1006828.e044"><alternatives><graphic id="pcbi.1006828.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>). The associated index set is represented by <inline-formula id="pcbi.1006828.e045"><alternatives><graphic id="pcbi.1006828.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>≔</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. By applying an implicit Euler scheme, the dynamic model (<xref ref-type="disp-formula" rid="pcbi.1006828.e002">2</xref>) is converted into a set of nonlinear algebraic equations of the form:
<disp-formula id="pcbi.1006828.e046"><alternatives><graphic id="pcbi.1006828.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>f</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
<disp-formula id="pcbi.1006828.e047"><alternatives><graphic id="pcbi.1006828.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
With this, we can approximate the MAP problem (<xref ref-type="disp-formula" rid="pcbi.1006828.e001">1</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e005">5</xref>) using the NLP:
<disp-formula id="pcbi.1006828.e048"><alternatives><graphic id="pcbi.1006828.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e048" xlink:type="simple"/><mml:math display="block" id="M48"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mtext>min</mml:mtext> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:munder> <mml:mspace width="1.em"/></mml:mrow></mml:mstyle><mml:mrow><mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>φ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
<disp-formula id="pcbi.1006828.e049"><alternatives><graphic id="pcbi.1006828.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>s</mml:mtext> <mml:mo>.</mml:mo> <mml:mtext>t</mml:mtext> <mml:mo>.</mml:mo> <mml:mspace width="1.em"/></mml:mrow><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>f</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
<disp-formula id="pcbi.1006828.e050"><alternatives><graphic id="pcbi.1006828.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e050" xlink:type="simple"/><mml:math display="block" id="M50"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
<disp-formula id="pcbi.1006828.e051"><alternatives><graphic id="pcbi.1006828.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
<disp-formula id="pcbi.1006828.e052"><alternatives><graphic id="pcbi.1006828.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mspace width="1.em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.166667em"/><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
Here, we use <inline-formula id="pcbi.1006828.e053"><alternatives><graphic id="pcbi.1006828.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> as short-hand notation to represent states at time <italic>t</italic><sub><italic>j</italic></sub> and experiment <italic>k</italic>. It is important that a sufficient number of time discretization points are used so that the differential equations are accurately approximated. If the number of time points is not sufficient, the solution of NLP can be sensitive to the choice of the number of points. To verify that the discretization is sufficient, we can use a test that assesses the sensitivity of the solution with respect to discretization. For example, one can increase the number of time points and see if the solutions are reasonably close.</p>
<p>For convenience, we express (<xref ref-type="disp-formula" rid="pcbi.1006828.e048">16</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e052">20</xref>) in the following abstract form:
<disp-formula id="pcbi.1006828.e054"><alternatives><graphic id="pcbi.1006828.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e054" xlink:type="simple"/><mml:math display="block" id="M54"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mtext>min</mml:mtext> <mml:mi>w</mml:mi></mml:munder></mml:mstyle><mml:mrow><mml:mspace width="0.277778em"/><mml:mo>Φ</mml:mo> <mml:mo>(</mml:mo> <mml:mi>w</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
<disp-formula id="pcbi.1006828.e055"><alternatives><graphic id="pcbi.1006828.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>s</mml:mtext> <mml:mo>.</mml:mo> <mml:mtext>t</mml:mtext> <mml:mo>.</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.277778em"/><mml:mo>Π</mml:mo> <mml:mo>(</mml:mo> <mml:mi>w</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
<disp-formula id="pcbi.1006828.e056"><alternatives><graphic id="pcbi.1006828.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mspace width="0.277778em"/><mml:mi>w</mml:mi> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where <inline-formula id="pcbi.1006828.e057"><alternatives><graphic id="pcbi.1006828.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:mi>w</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is a large-dimensional vector containing all the discrete-time states <inline-formula id="pcbi.1006828.e058"><alternatives><graphic id="pcbi.1006828.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, parameters <italic>θ</italic>, and additional auxiliary variables. The mapping <inline-formula id="pcbi.1006828.e059"><alternatives><graphic id="pcbi.1006828.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mrow><mml:mo>Φ</mml:mo> <mml:mo>:</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>n</mml:mi></mml:msup> <mml:mo>→</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the objective function and <inline-formula id="pcbi.1006828.e060"><alternatives><graphic id="pcbi.1006828.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:mo>Π</mml:mo> <mml:mo>:</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>n</mml:mi></mml:msup> <mml:mo>→</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are equality constraints that contain algebraic equations obtained fro discretization of the dynamic model and other auxiliary equations. General inequality constraints can be transformed into equality constraints and simple non-negativity bounds by using auxiliary slack variables (i.e., <inline-formula id="pcbi.1006828.e061"><alternatives><graphic id="pcbi.1006828.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> can be written as <inline-formula id="pcbi.1006828.e062"><alternatives><graphic id="pcbi.1006828.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with <italic>s</italic><sub><italic>k</italic></sub> ≥ 0).</p>
<p>A useful representation of the NLP results from noticing that the parameters <italic>θ</italic> are the only complicating (coupling) variables across experiments <inline-formula id="pcbi.1006828.e063"><alternatives><graphic id="pcbi.1006828.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Consequently, we can express the NLP in the <italic>structured</italic> from [<xref ref-type="bibr" rid="pcbi.1006828.ref047">47</xref>]:
<disp-formula id="pcbi.1006828.e064"><alternatives><graphic id="pcbi.1006828.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e064" xlink:type="simple"/><mml:math display="block" id="M64"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mtext>min</mml:mtext> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>…</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:munder></mml:mstyle><mml:mrow><mml:mspace width="0.277778em"/><mml:mo>Φ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mo>Φ</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
<disp-formula id="pcbi.1006828.e065"><alternatives><graphic id="pcbi.1006828.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e065" xlink:type="simple"/><mml:math display="block" id="M65"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>s</mml:mtext> <mml:mo>.</mml:mo> <mml:mtext>t</mml:mtext> <mml:mo>.</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.277778em"/><mml:msub><mml:mo>Π</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
<disp-formula id="pcbi.1006828.e066"><alternatives><graphic id="pcbi.1006828.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e066" xlink:type="simple"/><mml:math display="block" id="M66"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mspace width="0.277778em"/><mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
Here, the variable vector <italic>w</italic><sub><italic>k</italic></sub> contains all the discrete-time states and auxiliary variables of experiment <inline-formula id="pcbi.1006828.e067"><alternatives><graphic id="pcbi.1006828.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, Φ(⋅) is the prior term, Φ<sub><italic>k</italic></sub>(⋅) is the contribution of experiment <inline-formula id="pcbi.1006828.e068"><alternatives><graphic id="pcbi.1006828.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> to the likelihood function, and Π<sub><italic>k</italic></sub>(⋅) contains the discretized dynamic model equations and auxiliary equations for experiment <inline-formula id="pcbi.1006828.e069"><alternatives><graphic id="pcbi.1006828.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. As we discuss next, this representation can be used to derive parallel solution approaches.</p>
</sec>
<sec id="sec006">
<title>Interior-point solvers</title>
<p>The NLPs that result from time discretization exhibit a high degree of <italic>algebraic sparsity</italic> (only a few variables appear in each constraint) and are highly structured. Sparsity and structure permeates down to linear algebra operations performed inside the optimization solver. This is sharp contrast to the simulation-based approach, which induces dense linear algebra operations in the space of the parameters <italic>θ</italic>. Most modern large-scale NLP solvers such as <monospace>Ipopt</monospace> and <monospace>Knitro</monospace> seek to exploit sparsity and structure at the linear algebra level to achieve high computational efficiency [<xref ref-type="bibr" rid="pcbi.1006828.ref048">48</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref049">49</xref>]. Interior point solvers, in particular, provide a flexible framework to do this. These solvers replace the variable bounds by using a logarithmic barrier function. In the context of NLP (<xref ref-type="disp-formula" rid="pcbi.1006828.e054">21</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e056">23</xref>), this results in a logarithmic barrier subproblem of the form:
<disp-formula id="pcbi.1006828.e070"><alternatives><graphic id="pcbi.1006828.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e070" xlink:type="simple"/><mml:math display="block" id="M70"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mtext>min</mml:mtext> <mml:mi>w</mml:mi></mml:munder></mml:mstyle><mml:mrow><mml:mspace width="0.277778em"/><mml:mo>Φ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>w</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mi>μ</mml:mi> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mo form="prefix">log</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula>
<disp-formula id="pcbi.1006828.e071"><alternatives><graphic id="pcbi.1006828.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e071" xlink:type="simple"/><mml:math display="block" id="M71"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>s</mml:mtext> <mml:mo>.</mml:mo> <mml:mtext>t</mml:mtext> <mml:mo>.</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.277778em"/><mml:mo>Π</mml:mo> <mml:mo>(</mml:mo> <mml:mi>w</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula>
where <inline-formula id="pcbi.1006828.e072"><alternatives><graphic id="pcbi.1006828.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:mi>μ</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the so-called barrier parameter. The logarithmic term becomes large as <italic>w</italic><sup>(<italic>i</italic>)</sup> approaches the boundary of the feasible region. This ensures that variables remain in the <italic>interior</italic> of the feasible region (hence the origin of the term <italic>barrier</italic>). A key observation is that one can recover a solution of the original NLP (<xref ref-type="disp-formula" rid="pcbi.1006828.e054">21</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e056">23</xref>) by solving a sequence of barrier problems for decreasing values of <italic>μ</italic> [<xref ref-type="bibr" rid="pcbi.1006828.ref050">50</xref>]. An important property of interior-point methods is that the original NLP with bounds is converted into a sequence of NLPs with equality constraints. This removes the combinatorial complexity of identifying the set of bounds that are active or inactive at the solution (a bottleneck in active-set solvers).</p>
</sec>
<sec id="sec007">
<title>Sparse linear algebra</title>
<p>Interior-point methods enable efficient linear algebra implementations. To explain how this is done, we note that the optimality conditions of the barrier problem are given by the following set of nonlinear equations:
<disp-formula id="pcbi.1006828.e073"><alternatives><graphic id="pcbi.1006828.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e073" xlink:type="simple"/><mml:math display="block" id="M73"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>∇</mml:mo> <mml:mi>w</mml:mi></mml:msub> <mml:mo>Φ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>w</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:mi>w</mml:mi></mml:msub> <mml:mo>Π</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>w</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>λ</mml:mo> <mml:mo>−</mml:mo> <mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(29)</label></disp-formula>
<disp-formula id="pcbi.1006828.e074"><alternatives><graphic id="pcbi.1006828.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e074" xlink:type="simple"/><mml:math display="block" id="M74"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Π</mml:mo> <mml:mo>(</mml:mo> <mml:mi>w</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(30)</label></disp-formula>
<disp-formula id="pcbi.1006828.e075"><alternatives><graphic id="pcbi.1006828.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e075" xlink:type="simple"/><mml:math display="block" id="M75"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi> <mml:mspace width="0.166667em"/><mml:mi>W</mml:mi> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula>
where, <inline-formula id="pcbi.1006828.e076"><alternatives><graphic id="pcbi.1006828.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mrow><mml:mo>λ</mml:mo> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the Lagrange multipliers of the equality constraints, <italic>ν</italic> are the Lagrange multipliers of the bound constraints, <italic>V</italic> = diag(<italic>ν</italic>) and <italic>W</italic> = diag(<italic>w</italic>) are diagonal matrices, and <bold>1</bold> is a vector of all ones.</p>
<p>By applying Newton’s method to (<xref ref-type="disp-formula" rid="pcbi.1006828.e073">29</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e075">31</xref>), we obtain the following linear algebra system:
<disp-formula id="pcbi.1006828.e077"><alternatives><graphic id="pcbi.1006828.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e077" xlink:type="simple"/><mml:math display="block" id="M77"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>κ</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mi mathvariant="double-struck">I</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mo>∇</mml:mo> <mml:mi>w</mml:mi></mml:msub> <mml:mo>Π</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mo>∇</mml:mo> <mml:mi>w</mml:mi></mml:msub> <mml:mo>Π</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:msup><mml:mi>M</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>κ</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>ℓ</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mo>∇</mml:mo> <mml:mi>w</mml:mi></mml:msub> <mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>Π</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(32)</label></disp-formula>
Here, <italic>ℓ</italic> is the Newton iteration index, Δ<italic>w</italic><sup><italic>ℓ</italic></sup> is the search direction for the primal variables, Δλ<sup><italic>ℓ</italic></sup> is the search direction for the dual variables, and <inline-formula id="pcbi.1006828.e078"><alternatives><graphic id="pcbi.1006828.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:mrow><mml:mi>H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>w</mml:mi></mml:mrow></mml:msub> <mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mi>V</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the Hessian of the Lagrange function <inline-formula id="pcbi.1006828.e079"><alternatives><graphic id="pcbi.1006828.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:mrow><mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≔</mml:mo> <mml:mo>Φ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mi>μ</mml:mi> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>ℓ</mml:mo></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo>Π</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>w</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>ℓ</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The matrix <italic>M</italic><sup><italic>ℓ</italic></sup>(<italic>κ</italic><sub><italic>w</italic></sub>) is known as the <italic>augmented matrix</italic>. The Newton step computation in a simulation-based approach operates only in the space of the parameters <italic>θ</italic> (the states are implicitly eliminated by simulation). In the time discretization approach, the Newton search is in the space of both the discretized states and parameters (contained in the high-dimensional variable vector <italic>w</italic>). Interestingly, however, the augmented matrix found in typical applications is highly sparse (with less than 1% of its entries are non-zero) [<xref ref-type="bibr" rid="pcbi.1006828.ref024">24</xref>].</p>
<p>The constant <inline-formula id="pcbi.1006828.e080"><alternatives><graphic id="pcbi.1006828.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is a <italic>Hessian regularization parameter</italic> which plays a key role in the context of parameter estimation. In particular, one can prove that the augmented matrix <italic>M</italic><sup><italic>ℓ</italic></sup>(<italic>κ</italic><sub><italic>w</italic></sub>) is non-singular (and thus the linear algebra system has a unique solution) if and only if the reduced Hessian matrix <italic>Z</italic><sup><italic>T</italic></sup> <italic>H</italic>(<italic>w</italic><sup><italic>ℓ</italic></sup>, λ<sup><italic>ℓ</italic></sup>)<italic>Z</italic> is positive definite and the Jacobian matrix ∇<sub><italic>w</italic></sub> Π(<italic>w</italic><sup><italic>ℓ</italic></sup>) has full row rank. Here, the matrix <inline-formula id="pcbi.1006828.e081"><alternatives><graphic id="pcbi.1006828.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:mrow><mml:mi>Z</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>×</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is such that its columns span the null-space of the Jacobian (i.e., ∇<sub><italic>w</italic></sub> Π(<italic>w</italic><sup><italic>ℓ</italic></sup>)<italic>Z</italic> = 0). Moreover, the matrix <italic>Z</italic> is of the same dimension as the number of degrees of freedom (in our context this is precisely the number of parameters). When the reduced Hessian is positive definite (i.e., all its eigenvalues are positive) and the Jacobian has full row rank, one can prove that the Newton step of the primal variables Δ<italic>w</italic><sup><italic>ℓ</italic></sup> obtained from the solution of (<xref ref-type="disp-formula" rid="pcbi.1006828.e073">29</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e075">31</xref>) is a descent direction for the objective function (i.e., (Δ<italic>w</italic><sup><italic>ℓ</italic></sup>)<sup><italic>T</italic></sup>∇<sub><italic>w</italic></sub> Φ(<italic>w</italic><sup><italic>ℓ</italic></sup>) &lt; 0) when the constraints are close to being satisfied (i.e., Π(<italic>w</italic><sup><italic>ℓ</italic></sup>) ≈ 0). This is key because it indicates that the Newton step improves the objective function (in our context, the negative likelihood function). This property cannot be guaranteed when the reduced Hessian is not positive definite. When such a situation is encountered, one can increase the regularization parameter <italic>κ</italic><sub><italic>w</italic></sub> until the reduced Hessian is positive definite and a descent direction is obtained. This approach is closely connected to the Levenberg-Marquardt method used in simulation-based estimation approaches (in which one regularizes the Hessian of the negative likelihood function as <inline-formula id="pcbi.1006828.e082"><alternatives><graphic id="pcbi.1006828.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mrow><mml:mo>−</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:mrow><mml:mi>θ</mml:mi> <mml:mi>θ</mml:mi></mml:mrow></mml:msub> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>κ</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mi mathvariant="double-struck">I</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>) [<xref ref-type="bibr" rid="pcbi.1006828.ref051">51</xref>]. Another key observation is that, when the reduced Hessian is positive definite at the solution <italic>w</italic>*, the estimated parameters are <italic>unique</italic>. This provides an indication that the experimental data is sufficiently informative to identify the parameters uniquely (i.e., the parameters are observable). We note that using a prior term <italic>φ</italic>(<italic>θ</italic>) in the MAP formulation has the effect of adding the positive definite matrix <inline-formula id="pcbi.1006828.e083"><alternatives><graphic id="pcbi.1006828.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msubsup><mml:mo>Σ</mml:mo> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> to the reduced Hessian. This artificially regularizes the problem (as is done in the Levenberg-Marquardt scheme by adding the term <inline-formula id="pcbi.1006828.e084"><alternatives><graphic id="pcbi.1006828.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mi mathvariant="double-struck">I</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>). Consequently, when testing for observability/uniqueness, it is necessary to drop the prior term from the MAP formulation. Testing for observability also requires exact second order derivative information because the Hessian is needed. In the time-discretization approach, such information can be obtained directly from algebraic modeling languages. Simulation-based solution approaches often cannot check observability of the parameters (computing second derivatives using adjoint and sensitivity schemes is complicated).</p>
<p>Computing the eigenvalues of the reduced Hessian to check for positive definiteness is expensive. Interestingly, one can also determine if the reduced Hessian is positive definite by using inertia information of the augmented matrix <italic>M</italic><sup><italic>ℓ</italic></sup>(<italic>κ</italic><sub><italic>w</italic></sub>). The inertia of a matrix <italic>M</italic> is denoted as Inertia(<italic>M</italic>) = {<italic>n</italic><sub>+</sub>, <italic>n</italic><sub>−</sub>, <italic>n</italic><sub>0</sub>} where <italic>n</italic><sub>+</sub>, <italic>n</italic><sub>−</sub>, and <italic>n</italic><sub>0</sub> are the number of positive, negative, and zero eigenvalues of matrix M, respectively. One can prove that the reduced Hessian matrix is positive definite if Inertia(<italic>M</italic><sup><italic>ℓ</italic></sup>(<italic>κ</italic><sub><italic>w</italic></sub>)) = {<italic>n</italic>, <italic>m</italic>, 0}, where we recall that <italic>n</italic> is the dimension of the variable vector <italic>w</italic> and <italic>m</italic> is the number of constraints. Notably, one can obtain the inertia of <italic>M</italic><sup><italic>ℓ</italic></sup>(<italic>κ</italic><sub><italic>w</italic></sub>) without computing the eigenvalues of the matrix. This is done by using modern sparse symmetric factorization routines such as <monospace>MA57</monospace> or <monospace>Pardiso</monospace> [<xref ref-type="bibr" rid="pcbi.1006828.ref050">50</xref>]. Such routines factorize the matrix <italic>M</italic><sup><italic>ℓ</italic></sup>(<italic>κ</italic><sub><italic>w</italic></sub>) as <italic>LBL</italic><sup><italic>T</italic></sup> where <italic>L</italic> is a lower triangular matrix and <italic>B</italic> is a matrix with 1 × 1 and 2 × 2 blocks in the diagonal. One can show that the number of positive and negative eigenvalues of <italic>M</italic><sup><italic>ℓ</italic></sup>(<italic>κ</italic><sub><italic>w</italic></sub>) are the number of positive and negative eigenvalues of <italic>B</italic> (which are easy to determine).</p>
<p>Modern interior-point solvers are equipped with highly sophisticated safeguarding techniques that enable the solution of highly nonlinear problems. A powerful approach is called a filter line-search method, in which one seeks to find a step-size <italic>κ</italic> such that the trial Newton iteration <italic>w</italic><sup><italic>ℓ</italic>+1</sup> = <italic>w</italic><sup><italic>ℓ</italic></sup> + <italic>κ</italic>Δ<italic>w</italic><sup><italic>ℓ</italic></sup> either decreases the objective function or the constraint violation ||Π(<italic>w</italic><sup><italic>ℓ</italic></sup>)||. If the step is accepted, the current values for the objective and constraint violation (Φ(<italic>w</italic><sup><italic>ℓ</italic></sup>), Π(<italic>w</italic><sup><italic>ℓ</italic></sup>)) are stored in a filter (a history of previous successful iterations). At the next iterate, one requires that the Newton step is not in the filter and that it improves either the objective or the constraint violation. This rather simple strategy is extremely effective in practice.</p>
<p>We highlight the fact that the proposed discretization approach bypasses the need to repetitively simulate the dynamic model (the discretized dynamic model contained in Φ(<italic>w</italic>) is solved progressively by Newton’s method). This brings substantial computational savings. Moreover, since the discrete-time model is solved at the solution <italic>w</italic>* of the NLP (<xref ref-type="disp-formula" rid="pcbi.1006828.e054">21</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e056">23</xref>), we have that the discrete-time states <inline-formula id="pcbi.1006828.e085"><alternatives><graphic id="pcbi.1006828.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:msup><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula> approximate the state trajectories <inline-formula id="pcbi.1006828.e086"><alternatives><graphic id="pcbi.1006828.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mrow><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. In the absence of inequality constraints, one can also show that the reduced Hessian <italic>Z</italic><sup><italic>T</italic></sup> <italic>H</italic>(<italic>w</italic>*, λ*)<italic>Z</italic> approximates the Hessian of the negative log-likelihood function ∇<sub><italic>θθ</italic></sub> <italic>L</italic>(<italic>θ</italic>*) in a neighborhood of <italic>w</italic>* (which contains <italic>θ</italic>*). We thus have that the reduced Hessian approximates the inverse parameter covariance matrix <inline-formula id="pcbi.1006828.e087"><alternatives><graphic id="pcbi.1006828.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>θ</mml:mi></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. When inequality constraints are present, some of the parameters or state variables might hit their physical bounds and this deteriorates the approximation. When the parameters are not unique (the reduced Hessian has zero eigenvalues), the parameter covariance matrix is singular. We highlight that such information can be obtained as by-products of the solution from the nonlinear programming solver. Therefore, the observability of the parameter estimation problem can be analyzed without further computational efforts. We also highlight that parameter observability/identifiability can be checked prior to solving the estimation problem [<xref ref-type="bibr" rid="pcbi.1006828.ref052">52</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref053">53</xref>]. Unfortunately, such a priori methods require computing parameter-to-output sensitivity matrices, which requires specialized implementations and which might miss to capture impacts of nonlinearities (the sensitivity is computed only at a reference point). Moreover, such approaches do not capture the impact of constraints. Under the proposed NLP framework, observability is checked automatically by using the inertia of the reduced Hessian at the MAP point.</p>
</sec>
<sec id="sec008">
<title>Structured linear algebra</title>
<p>A key advantage of using interior-point solvers is that they enable <italic>modular linear algebra</italic> implementations. For instance, the multi-experiment structure of problem (<xref ref-type="disp-formula" rid="pcbi.1006828.e064">24</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e066">26</xref>) permeates down to the linear algebra system, to give a system of the form:
<disp-formula id="pcbi.1006828.e088"><graphic id="pcbi.1006828.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e088" xlink:type="simple"/><label>(33)</label></disp-formula>
where Δ<italic>θ</italic> is the Newton step for the parameters and Δ<italic>w</italic><sub><italic>k</italic></sub> = (Δ<italic>x</italic><sub><italic>k</italic></sub>, Δλ<sub><italic>k</italic></sub>) is the Newton step for variables in experiment <italic>k</italic>. The above system is said to have a block-bordered diagonal (BBD) structure. Here, we have that:
<disp-formula id="pcbi.1006828.e089"><alternatives><graphic id="pcbi.1006828.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e089" xlink:type="simple"/><mml:math display="block" id="M89"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msub><mml:mi>K</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>H</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:msubsup><mml:mi>J</mml:mi> <mml:mi>k</mml:mi> <mml:mi>T</mml:mi></mml:msubsup></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>J</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msubsup><mml:mi>B</mml:mi> <mml:mi>k</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mi>k</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mspace width="0.277778em"/><mml:msubsup><mml:mi>T</mml:mi> <mml:mi>k</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(34)</label></disp-formula>
where <inline-formula id="pcbi.1006828.e090"><alternatives><graphic id="pcbi.1006828.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mo>Π</mml:mo> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, <italic>T</italic><sub><italic>k</italic></sub> = ∇<sub><italic>θ</italic></sub> Π<sub><italic>k</italic></sub>, <inline-formula id="pcbi.1006828.e091"><alternatives><graphic id="pcbi.1006828.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mrow><mml:msub><mml:mi>H</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:mrow><mml:mi>θ</mml:mi> <mml:mi>θ</mml:mi></mml:mrow></mml:msub> <mml:mi mathvariant="script">L</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>κ</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mi mathvariant="double-struck">I</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006828.e092"><alternatives><graphic id="pcbi.1006828.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mrow><mml:msub><mml:mi>H</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mi mathvariant="script">L</mml:mi> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>W</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>V</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>κ</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mi mathvariant="double-struck">I</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006828.e093"><alternatives><graphic id="pcbi.1006828.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:mrow><mml:mi>θ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mi mathvariant="script">L</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006828.e094"><alternatives><graphic id="pcbi.1006828.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:mi>θ</mml:mi></mml:msub> <mml:mi mathvariant="script">L</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006828.e095"><alternatives><graphic id="pcbi.1006828.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mi mathvariant="script">L</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>The BBD matrix is a permutation of the augmented matrix <italic>M</italic><sup><italic>ℓ</italic></sup>(<italic>κ</italic><sub><italic>w</italic></sub>) (obtained by ordering variables by experiment). The BBD matrix can thus be expressed as <italic>P</italic><sup><italic>T</italic></sup><italic>M</italic><sup><italic>ℓ</italic></sup>(<italic>κ</italic><sub><italic>w</italic></sub>)<italic>P</italic> where <italic>P</italic> is a permutation matrix. The permutation does not affect the eigenvalues of the matrix. The BBD system (<xref ref-type="disp-formula" rid="pcbi.1006828.e088">33</xref>) can be solved in parallel by using a Schur complement decomposition approach [<xref ref-type="bibr" rid="pcbi.1006828.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref054">54</xref>] or specialized preconditioning strategies [<xref ref-type="bibr" rid="pcbi.1006828.ref055">55</xref>]. In this work, we focus on Schur complement-based approach. This requires the solution of the linear algebra systems:
<disp-formula id="pcbi.1006828.e096"><alternatives><graphic id="pcbi.1006828.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e096" xlink:type="simple"/><mml:math display="block" id="M96"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>B</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msubsup><mml:mi>K</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>B</mml:mi> <mml:mi>k</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mi>K</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>B</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(35)</label></disp-formula>
<disp-formula id="pcbi.1006828.e097"><alternatives><graphic id="pcbi.1006828.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e097" xlink:type="simple"/><mml:math display="block" id="M97"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msubsup><mml:mi>B</mml:mi> <mml:mi>k</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>Δ</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(36)</label></disp-formula>
Here, <inline-formula id="pcbi.1006828.e098"><alternatives><graphic id="pcbi.1006828.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>B</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msubsup><mml:mi>K</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>B</mml:mi> <mml:mi>k</mml:mi> <mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the <italic>Schur complement matrix</italic> which has the same dimension as the number of degrees of freedom (in our case the number of parameters). The key observation is that the experiment matrices <italic>K</italic><sub><italic>k</italic></sub> can be factorized by using an <italic>LBL</italic><sup><italic>T</italic></sup> factorization (by using <monospace>MA57</monospace> or <monospace>PARDISO</monospace>) <italic>in parallel</italic>. As a result, Schur decomposition can achieve high computational efficiency in estimation problems with many experimental data sets.</p>
<p>When using a Schur decomposition, one can estimate the inertia of the BBD matrix by using Haynsworth’s formula:
<disp-formula id="pcbi.1006828.e099"><alternatives><graphic id="pcbi.1006828.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e099" xlink:type="simple"/><mml:math display="block" id="M99"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Inertia</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>M</mml:mi> <mml:mo>ℓ</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>κ</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:munder> <mml:mtext>Inertia</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mtext>Inertia</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>B</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msubsup><mml:mi>K</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>B</mml:mi> <mml:mi>k</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(37)</label></disp-formula>
We recall that <italic>n</italic> = <italic>n</italic><sub><italic>θ</italic></sub> + ∑<sub><italic>k</italic></sub> <italic>n</italic><sub><italic>k</italic></sub> and <italic>m</italic> = ∑<sub><italic>k</italic></sub> <italic>m</italic><sub><italic>k</italic></sub>. Consequently, if we have that Inertia(<italic>K</italic><sub><italic>k</italic></sub>) = {<italic>n</italic><sub><italic>k</italic></sub>, <italic>m</italic><sub><italic>k</italic></sub>, 0} for all <inline-formula id="pcbi.1006828.e100"><alternatives><graphic id="pcbi.1006828.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> then Inertia(<italic>M</italic><sup><italic>ℓ</italic></sup>(<italic>κ</italic><sub><italic>w</italic></sub>)) = {<italic>n</italic>, <italic>m</italic>, 0} if and only if Inertia(<italic>S</italic>) = {<italic>n</italic><sub><italic>θ</italic></sub>, 0, 0} (i.e., the Schur complement is positive definite). One can obtain the inertia of the blocks <italic>K</italic><sub><italic>k</italic></sub> and <italic>S</italic> using <italic>LBL</italic><sup><italic>T</italic></sup> factorization. This allows us to test observability of the parameters.</p>
<p>We highlight that Schur decomposition and block cyclic reduction techniques can also be used to decompose the estimation problem along the time horizon. This enables the solution of problems with fine time resolutions and long horizons (see [<xref ref-type="bibr" rid="pcbi.1006828.ref056">56</xref>]). Unfortunately, scalable implementations of such techniques are currently not available (this is an interesting direction of future work). We also highlight that there exist generic parallel linear solvers (such as <monospace>MA97</monospace>) that seek to identify and exploit structures on-the-fly. Such approaches are in general not competitive with approaches that communicate structure directly to the solver (such as Schur decomposition).</p>
</sec>
</sec>
<sec id="sec009">
<title>Uncertainty quantification</title>
<p>The estimation problem under the MAP framework gives the values of the parameters <italic>θ</italic>* that maximize the parameter posterior density. However, a characterization of the entire posterior is necessary to assess parameter uncertainty. The posterior covariance may be approximated from the reduced Hessian at the solution of the problem <italic>w</italic>* and the covariance matrix can be used to determine ellipsoidal level sets of the posterior (confidence regions). This approach, however, might fail to capture nonlinear and constraint effects [<xref ref-type="bibr" rid="pcbi.1006828.ref024">24</xref>]. In this work, we circumvent these issues by using a randomized maximum a posteriori (rMAP) approach. Under this method, the posterior distribution is explored by using random perturbations on the experimental data (which can be easily parallelized). The rMAP framework can also deliver <italic>approximate samples</italic> from the parameter posterior distribution and implicitly captures nonlinear and constraint effects. To show this, we use the implicit mapping representation <inline-formula id="pcbi.1006828.e101"><alternatives><graphic id="pcbi.1006828.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Under this representation, the posterior density (<xref ref-type="disp-formula" rid="pcbi.1006828.e023">6</xref>) can be expressed as:
<disp-formula id="pcbi.1006828.e102"><alternatives><graphic id="pcbi.1006828.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e102" xlink:type="simple"/><mml:math display="block" id="M102"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msubsup><mml:mo>Σ</mml:mo> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msubsup><mml:mo>Σ</mml:mo> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(38)</label></disp-formula>
<disp-formula id="pcbi.1006828.e103"><alternatives><graphic id="pcbi.1006828.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e103" xlink:type="simple"/><mml:math display="block" id="M103"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(39)</label></disp-formula>
where <italic>m</italic>(<italic>θ</italic>) ≔ (<italic>θ</italic>, <italic>m</italic><sub>1</sub>(<italic>θ</italic>), ⋯, <italic>m</italic><sub><italic>K</italic></sub>(<italic>θ</italic>)), Σ ≔ diag(Σ<sub><italic>θ</italic></sub>, Σ<sub>1</sub>, Σ<sub>2</sub>, ⋯, Σ<sub><italic>K</italic></sub>), and <inline-formula id="pcbi.1006828.e104"><alternatives><graphic id="pcbi.1006828.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here, we redefine <inline-formula id="pcbi.1006828.e105"><alternatives><graphic id="pcbi.1006828.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:mrow><mml:mi>η</mml:mi> <mml:mo>←</mml:mo> <mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> to enable compact notation. Since <italic>θ</italic>* is a solution of the MAP problem, we have that:
<disp-formula id="pcbi.1006828.e106"><alternatives><graphic id="pcbi.1006828.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e106" xlink:type="simple"/><mml:math display="block" id="M106"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:munder><mml:mtext>argmin</mml:mtext> <mml:mi>θ</mml:mi></mml:munder> <mml:mspace width="4pt"/><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(40)</label></disp-formula>
If the mapping <italic>m</italic><sub><italic>k</italic></sub>(⋅) is continuously differentiable, we have that:
<disp-formula id="pcbi.1006828.e107"><alternatives><graphic id="pcbi.1006828.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e107" xlink:type="simple"/><mml:math display="block" id="M107"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi> <mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mi>O</mml:mi> <mml:mo>(</mml:mo> <mml:mo>‖</mml:mo> <mml:mi>θ</mml:mi></mml:mrow> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:msubsup><mml:mo>‖</mml:mo> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(41)</label></disp-formula>
To enable compact notation we define <italic>η</italic>* = <italic>m</italic>(<italic>θ</italic>*) and ∇<italic>m</italic>* = ∇<italic>m</italic>(<italic>θ</italic>*). We have that <italic>θ</italic>* satisfies the stationary condition of (<xref ref-type="disp-formula" rid="pcbi.1006828.e106">40</xref>):
<disp-formula id="pcbi.1006828.e108"><alternatives><graphic id="pcbi.1006828.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e108" xlink:type="simple"/><mml:math display="block" id="M108"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>η</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(42)</label></disp-formula>
We use (<xref ref-type="disp-formula" rid="pcbi.1006828.e107">41</xref>) to obtain a second-order Taylor approximation of the posterior as:
<disp-formula id="pcbi.1006828.e109"><alternatives><graphic id="pcbi.1006828.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e109" xlink:type="simple"/><mml:math display="block" id="M109"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≈</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>η</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:mi>η</mml:mi> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>η</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:mi>η</mml:mi> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>η</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>η</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>∝</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(43)</label></disp-formula>
This implies that the posterior is <italic>approximately</italic> represented as:
<disp-formula id="pcbi.1006828.e110"><alternatives><graphic id="pcbi.1006828.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e110" xlink:type="simple"/><mml:math display="block" id="M110"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>θ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi>η</mml:mi> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>,</mml:mo><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(44)</label></disp-formula>
We recall that the output error is Gaussian and we can thus write <italic>η</italic> = <italic>m</italic>(<italic>θ</italic>) + <italic>ϵ</italic> with <inline-formula id="pcbi.1006828.e111"><alternatives><graphic id="pcbi.1006828.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>Σ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We now consider the MAP problem with randomly perturbed data:
<disp-formula id="pcbi.1006828.e112"><alternatives><graphic id="pcbi.1006828.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e112" xlink:type="simple"/><mml:math display="block" id="M112"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:munder><mml:mtext>argmin</mml:mtext> <mml:mi>θ</mml:mi></mml:munder> <mml:mspace width="4pt"/><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(45)</label></disp-formula>
and note that
<disp-formula id="pcbi.1006828.e113"><alternatives><graphic id="pcbi.1006828.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e113" xlink:type="simple"/><mml:math display="block" id="M113"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>η</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:mi>η</mml:mi> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>η</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:mi>η</mml:mi> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mi>O</mml:mi> <mml:mo>(</mml:mo> <mml:mo>‖</mml:mo> <mml:mi>θ</mml:mi></mml:mrow> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:msubsup><mml:mo>‖</mml:mo> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>ϵ</mml:mi> <mml:mo>+</mml:mo> <mml:mrow><mml:mi>O</mml:mi> <mml:mo>(</mml:mo> <mml:mo>‖</mml:mo> <mml:mi>θ</mml:mi></mml:mrow> <mml:mo>−</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:msubsup><mml:mo>‖</mml:mo> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(46)</label></disp-formula>
where <italic>C</italic> is a constant. Consequently, for sufficiently small <italic>ϵ</italic>, we can linearize the mapping <italic>m</italic>(⋅) to obtain an approximate solution of (<xref ref-type="disp-formula" rid="pcbi.1006828.e112">45</xref>) of the form:
<disp-formula id="pcbi.1006828.e114"><alternatives><graphic id="pcbi.1006828.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e114" xlink:type="simple"/><mml:math display="block" id="M114"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>≈</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>+</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>ϵ</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(47)</label></disp-formula>
Here, we observe that the right-hand side of (<xref ref-type="disp-formula" rid="pcbi.1006828.e114">47</xref>) is Gaussian with mean <italic>θ</italic>* and covariance:
<disp-formula id="pcbi.1006828.e115"><alternatives><graphic id="pcbi.1006828.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e115" xlink:type="simple"/><mml:math display="block" id="M115"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>)</mml:mo> <mml:mo>Σ</mml:mo><mml:mo>(</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo>)</mml:mo> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(48)</label></disp-formula>
We thus have that:
<disp-formula id="pcbi.1006828.e116"><alternatives><graphic id="pcbi.1006828.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e116" xlink:type="simple"/><mml:math display="block" id="M116"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>,</mml:mo><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>∇</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(49)</label></disp-formula>
Consequently, solving (<xref ref-type="disp-formula" rid="pcbi.1006828.e112">45</xref>) provides an approximate sample from the posterior distribution <italic>p</italic>(<italic>θ</italic> ∣ <italic>η</italic>). The sampling procedure (<xref ref-type="disp-formula" rid="pcbi.1006828.e112">45</xref>) is accurate up to second order. To obtain an exact sampling from the posterior, one needs to implement a rigorous MCMC scheme. The MCMC scheme removes the bias that appears in the rMAP sample density, which results from the second order approximation [<xref ref-type="bibr" rid="pcbi.1006828.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref037">37</xref>]. This effect is illustrated with an examples in [<xref ref-type="bibr" rid="pcbi.1006828.ref037">37</xref>]. Several works in the literature, however, report that accurate posterior densities can be obtained using an rMAP scheme [<xref ref-type="bibr" rid="pcbi.1006828.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref057">57</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref058">58</xref>]. We also note that the rMAP scheme implicitly captures nonlinearities and physical constraints when computing samples from the posterior (MCMC does not capture constraints). In particular, solving the perturbed problem (<xref ref-type="disp-formula" rid="pcbi.1006828.e112">45</xref>) corresponds to solving the MAP problem (<xref ref-type="disp-formula" rid="pcbi.1006828.e001">1</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1006828.e005">5</xref>) with randomly perturbed data and the MAP problem enforces constraints and handles the full nonlinear model. The computational framework provided in this work focuses on the solution of the estimation problem and seeks to highlight that these capabilities enable the implementation of advanced UQ procedures. A detailed analysis and comparison of different UQ methods for biological dynamical models is an interesting topic of future work. Systematic comparisons in other settings are provided in [<xref ref-type="bibr" rid="pcbi.1006828.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref036">36</xref>].</p>
</sec>
<sec id="sec010">
<title>Algebraic modeling platforms</title>
<p>Having an algebraic representation of the estimation problem has many practical and computational advantages. In particular, one can implement the estimation problem in easy-to-use and open-source modeling languages such as <monospace>JuMP</monospace> [<xref ref-type="bibr" rid="pcbi.1006828.ref059">59</xref>], <monospace>Plasmo.jl</monospace> [<xref ref-type="bibr" rid="pcbi.1006828.ref060">60</xref>], and <monospace>Pyomo</monospace> [<xref ref-type="bibr" rid="pcbi.1006828.ref061">61</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref062">62</xref>]. These modeling languages are equipped with automatic differentiation techniques that compute exact first and second derivatives. Derivative information is communicated to optimization solvers without any user intervention. Modern algebraic modeling languages such as <monospace>Plasmo.jl</monospace> and <monospace>Pyomo</monospace> also allow users to convey structural information to the solvers. This is beneficial in the case of parameter estimation, where the structure can be exploited to enable parallelism and the use of high-performance computing clusters. In our framework, we use the modeling language <monospace>Plasmo.jl</monospace> to express multi-experiment estimation problems as graphs. Our implementation using <monospace>Plasmo.jl</monospace> is illustrated in <xref ref-type="fig" rid="pcbi.1006828.g002">Fig 2</xref>. The full <monospace>Julia</monospace> script is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/zavalab/JuliaBox/tree/master/MicrobialPLOS" xlink:type="simple">https://github.com/zavalab/JuliaBox/tree/master/MicrobialPLOS</ext-link>. We highlight that the same script can be used to solve the estimation problem using a general NLP solver such as <monospace>Ipopt</monospace> on a single-processor computer or with a structure-exploiting parallel NLP solver such as <monospace>PIPS-NLP</monospace> on multiple parallel computing processors (this might be a multi-core computing server or a large-scale computing cluster). This allows users with limited knowledge on scientific computing to gain access to advanced high-performance computing capabilities.</p>
<fig id="pcbi.1006828.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Snippet of parameter estimation implementation in <monospace>Plasmo.jl</monospace>.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g002" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec011" sec-type="results">
<title>Results</title>
<p>Human gut microbial communities and microbiomes are highly dynamic networks coupled by positive or negative interactions and numerous feedback loops that display complex behaviors [<xref ref-type="bibr" rid="pcbi.1006828.ref063">63</xref>–<xref ref-type="bibr" rid="pcbi.1006828.ref066">66</xref>]. The generalized Lotka-Volterra (gLV) model provides a useful approach to capture such behavior [<xref ref-type="bibr" rid="pcbi.1006828.ref067">67</xref>–<xref ref-type="bibr" rid="pcbi.1006828.ref071">71</xref>]. Specifically, gLV captures single species growth rates and intra-species and inter-species positive and negative interactions. We apply the proposed NLP framework to estimate the growth and interaction parameters of the gLV model from experimental data collected in [<xref ref-type="bibr" rid="pcbi.1006828.ref066">66</xref>]. The microbial species involved in the experiments are shown in <xref ref-type="table" rid="pcbi.1006828.t001">Table 1</xref>. Experiments were designed to study the synthetic ecology encompassing 12 prevalent human-associated intestinal species.</p>
<table-wrap id="pcbi.1006828.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.t001</object-id>
<label>Table 1</label>
<caption>
<title>List of microbial species used in case study.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006828.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" style="border-bottom:thick">Label</th>
<th align="center" style="border-bottom:thick">Full name</th>
<th align="center" style="border-bottom:thick">Abbreviation</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td align="center">Blautia hydrogenotrophica</td>
<td align="center">BH</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">Collinsella aerofaciens</td>
<td align="center">CA</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">Bacteroides uniformis</td>
<td align="center">BU</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">Prevotella copri</td>
<td align="center">PC</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">Bacteroides ovatus</td>
<td align="center">BO</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">Bacteroides vulgatus</td>
<td align="center">BV</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">Bacteroides thetaiotaomicron</td>
<td align="center">BT</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">Eggerthella lenta</td>
<td align="center">EL</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">Faecalibacterium prausnitzii</td>
<td align="center">FP</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">Clostridium hiranonis</td>
<td align="center">CH</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">Desulfovibrio piger</td>
<td align="center">DP</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">Eubacterium rectale</td>
<td align="center">ER</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The gLV model is given by:
<disp-formula id="pcbi.1006828.e117"><alternatives><graphic id="pcbi.1006828.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e117" xlink:type="simple"/><mml:math display="block" id="M117"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>)</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(Model 1)</label></disp-formula>
where <inline-formula id="pcbi.1006828.e118"><alternatives><graphic id="pcbi.1006828.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e118" xlink:type="simple"/><mml:math display="inline" id="M118"><mml:mrow><mml:mi mathvariant="script">S</mml:mi> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the set of microbial species, <inline-formula id="pcbi.1006828.e119"><alternatives><graphic id="pcbi.1006828.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>:</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi> <mml:mo>→</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the trajectory of the abundance of species <inline-formula id="pcbi.1006828.e120"><alternatives><graphic id="pcbi.1006828.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:mrow><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <italic>μ</italic><sub><italic>s</italic></sub> is the growth rate of species <italic>s</italic>, and <italic>α</italic><sub><italic>ss</italic>′</sub> is the interaction parameter that captures the effect of the abundance of species <italic>s</italic>′ on the growth rate of species <italic>s</italic>. Species <italic>s</italic> and species <italic>s</italic>′ are referred to as recipient species and donor species, resepectively. Since (<xref ref-type="disp-formula" rid="pcbi.1006828.e117">Model 1</xref>) only includes smooth mappings, one can apply the parameter estimation framework presented in the previous section.</p>
<p>The parameters (growth rates and interaction) cannot be calculated directly from first-principles and must be estimated from experimental data. The means of the prior densities of the parameters are assumed to be <inline-formula id="pcbi.1006828.e121"><alternatives><graphic id="pcbi.1006828.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>s</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and their standard deviations are assumed to be <inline-formula id="pcbi.1006828.e122"><alternatives><graphic id="pcbi.1006828.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mi>μ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mn>50</mml:mn></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>. Such values are empirically determined by selecting the standard deviation values that give biologically feasible parameter estimates (the range of biologically feasible parameter values are 0.09 &lt; <italic>μ</italic><sub><italic>s</italic></sub> &lt; 2.1, −10 &lt; <italic>α</italic><sub><italic>ij</italic></sub> &lt; 10, and −10 &lt; <italic>α</italic><sub><italic>ii</italic></sub> &lt; 0). The variances for the output measurements are assumed to be <italic>σ</italic><sub><italic>k</italic>,<italic>s</italic></sub>(<italic>t</italic>) = 0.05 max(0.1, <italic>η</italic><sub><italic>k</italic>,<italic>s</italic></sub>(<italic>t</italic>)). There are a total of 156 parameters including 12 monospecies growth rate and 144 interaction parameters (12 x 12). The set of experiments <inline-formula id="pcbi.1006828.e123"><alternatives><graphic id="pcbi.1006828.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e123" xlink:type="simple"/><mml:math display="inline" id="M123"><mml:mi mathvariant="script">K</mml:mi></mml:math></alternatives></inline-formula> includes 12 monospecies experiments and 66 pairwise community experiments (total of <italic>K</italic> = 78 experiments). The estimation problem contains a total of 144 differential equations (i.e. the model is a system of ordinary differential equations on <inline-formula id="pcbi.1006828.e124"><alternatives><graphic id="pcbi.1006828.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mn>144</mml:mn></mml:msup></mml:math></alternatives></inline-formula>). The computational characteristics of the estimation problem are summarized in <xref ref-type="table" rid="pcbi.1006828.t002">Table 2</xref> (labeled as P1).</p>
<table-wrap id="pcbi.1006828.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.t002</object-id>
<label>Table 2</label>
<caption>
<title>Characteristic of estimation problems used in scalability studies.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006828.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center">Original</th>
<th align="center">Original+Synthetic</th>
<th align="center" colspan="4">Synthetic</th>
</tr>
<tr>
<th align="left" style="border-bottom:thick">Label</th>
<th align="center" style="border-bottom:thick">P1</th>
<th align="center" style="border-bottom:thick">P2</th>
<th align="center" style="border-bottom:thick">S1</th>
<th align="center" style="border-bottom:thick">S2</th>
<th align="center" style="border-bottom:thick">S3</th>
<th align="center" style="border-bottom:thick">S4</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Number of Species</td>
<td align="center">12</td>
<td align="center">12</td>
<td align="center">12</td>
<td align="center">24</td>
<td align="center">36</td>
<td align="center">48</td>
</tr>
<tr>
<td align="left">Number of Diff. Equations</td>
<td align="center">144</td>
<td align="center">1,584</td>
<td align="center">144</td>
<td align="center">576</td>
<td align="center">1,296</td>
<td align="center">2,304</td>
</tr>
<tr>
<td align="left">Number of Parameters</td>
<td align="center">156</td>
<td align="center">156</td>
<td align="center">156</td>
<td align="center">600</td>
<td align="center">1,332</td>
<td align="center">2,352</td>
</tr>
<tr>
<td align="left">Number of Experiments</td>
<td align="center">78</td>
<td align="center">858</td>
<td align="center">78</td>
<td align="center">300</td>
<td align="center">666</td>
<td align="center">1,176</td>
</tr>
<tr>
<td align="left">Number of Data Points</td>
<td align="center">1,704</td>
<td align="center">18,744</td>
<td align="center">1,632</td>
<td align="center">5,568</td>
<td align="center">11,808</td>
<td align="center">20,352</td>
</tr>
<tr>
<td align="left">Number of NLP Variables</td>
<td align="center">91,644</td>
<td align="center">1,006,524</td>
<td align="center">83,004</td>
<td align="center">340,824</td>
<td align="center">773,460</td>
<td align="center">1,380,912</td>
</tr>
<tr>
<td align="left">Number of NLP Constraints</td>
<td align="center">91,488</td>
<td align="center">1,006,368</td>
<td align="center">82,848</td>
<td align="center">340,224</td>
<td align="center">772,128</td>
<td align="center">1,378,560</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>Problem P1 includes the original experimental data [<xref ref-type="bibr" rid="pcbi.1006828.ref066">66</xref>] for a 12-species microbial community (consisting of 12 mono-species and 66 pairwise community experiments). The sampling frequency and the experiment duration of the mono-species experiments are 30 minutes and 24 hours, respectively. The sampling frequency in the pairwise community experiments is 12 hours and the experiment duration range from 60 to 72 hours. In the pairwise experiments, the media are diluted by 1/20 once every 24 hours. The dynamic model is discretized using an implicit Euler scheme with 5 equally-spaced discretization points (monospecies experiments) and 120 equally-spaced discretization points (pairwise experiments). The data used in P2 includes the original data of P1 and 10 additional synthetic data sets obtained with random data perturbations. Data for problems S1-S4 is synthetic and is obtained by running a simulation of the community model with fixed parameters and by adding 5% noise to the outputs. The data sampling characteristics (e.g., frequency, duration, dilution patterns) are the same as those of P1. The parameter values used for simulations are randomly generated from <inline-formula id="pcbi.1006828.e125"><alternatives><graphic id="pcbi.1006828.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e125" xlink:type="simple"/><mml:math display="inline" id="M125"><mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>3</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006828.e126"><alternatives><graphic id="pcbi.1006828.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006828.e127"><alternatives><graphic id="pcbi.1006828.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e127" xlink:type="simple"/><mml:math display="inline" id="M127"><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>The dynamic model is discretized using an implicit Euler scheme with five equally-spaced discretization points (monospecies experiments) and 120 equally-spaced discretization points (pairwise experiments). The sufficiency of discretization is verified by checking the sensitivity of the solution with respect to the change of discretization. The following scheme is used:
<list list-type="order">
<list-item><p>Solve the problem to obtain the set of parameters <italic>θ</italic>*.</p></list-item>
<list-item><p>Increase the number of discretization points by a factor of two (i.e., reduce the time step by half), and resolve the problem to obtain the set of parameters <inline-formula id="pcbi.1006828.e128"><alternatives><graphic id="pcbi.1006828.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e128" xlink:type="simple"/><mml:math display="inline" id="M128"><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>.</p></list-item>
<list-item><p>Check if <italic>θ</italic>* and <inline-formula id="pcbi.1006828.e129"><alternatives><graphic id="pcbi.1006828.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e129" xlink:type="simple"/><mml:math display="inline" id="M129"><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> satisfy the following sensitivity criteria:
<disp-formula id="pcbi.1006828.e130"><alternatives><graphic id="pcbi.1006828.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e130" xlink:type="simple"/><mml:math display="block" id="M130"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>i</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mtext>abs</mml:mtext></mml:msub> <mml:mspace width="1.em"/><mml:mo>∨</mml:mo> <mml:mspace width="1.em"/><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mtext>rel</mml:mtext></mml:msub> <mml:mspace width="1.em"/><mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(50)</label></disp-formula>
</p></list-item>
</list></p>
<p>We use <italic>ϵ</italic><sub>abs</sub> = <italic>ϵ</italic><sub>abs</sub> = 0.01. We have verified that the above-mentioned discretization sheme yields solutions that satisfy (<xref ref-type="disp-formula" rid="pcbi.1006828.e130">50</xref>).</p>
<sec id="sec012">
<title>Observability and regularization</title>
<p>Parameter observability was checked by solving the MAP formulation for P1 (which uses the available experimental data) and by checking the inertia of the augmented system at the solution (reported by <monospace>Ipopt</monospace>). Here, we omitted the prior regularization term <italic>φ</italic>(⋅). We found that parameters obtained from P1 are <italic>not unique</italic> (not observable from the available data). Moreover, we found that the estimated parameter values without regularization have unrealistic (non-physical) values, see <xref ref-type="fig" rid="pcbi.1006828.g003">Fig 3(a)</xref>. This observation justifies the need to use prior information. We have used L1 and L2 priors with uniform standard deviations (other forms of prior can also be used as long as they can be reformulated as smooth functions). The results are presented in <xref ref-type="fig" rid="pcbi.1006828.g003">Fig 3(b) and 3(c)</xref>. Unique parameter estimates were found when L1 or L2 priors were used. We also found that the L1 prior induces sparser solutions (many parameters are zero). For the remainder of the results, we use the formulation with an L2 prior.</p>
<fig id="pcbi.1006828.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Parameter estimates with MAP formulations (P1, <xref ref-type="disp-formula" rid="pcbi.1006828.e117">Model 1</xref>).</title>
<p><bold>(a)</bold> Estimates using MAP formulation with no prior information. <bold>(b)</bold> Estimates using L1 prior. <bold>(c)</bold> Estimates using L2 prior. (a-c) The first row shows values for the growth rate parameters <italic>μ</italic><sub><italic>s</italic></sub> and the rest of the rows show values for the interaction parameters <italic>α</italic><sub><italic>ss</italic>′</sub>. The species name corresponding to <italic>s</italic> and <italic>s</italic>′ are presented on the <italic>x</italic> and <italic>y</italic> axes. Recipient and donor species are on the <italic>x</italic> and <italic>y</italic>-axis, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec013">
<title>Model fitting</title>
<p>Model validation was performed by assessing the goodness of fit to the experimental data (<xref ref-type="fig" rid="pcbi.1006828.g004">Fig 4</xref>). We can see that the model is capable of fitting most of the data points, but there are a number of experiments where the model prediction deviates significantly from the experimental data (such experiments are highlighted with red boxes). Furthermore, we can observe outliers at single data points (highlighted with red circles). Poor fitting can be caused by either bad local minima (the optimization solver finds a local optimal solution rather than the global optimal solution) or by a structural model error (the model structure is incapable of capturing the actual behavior of the system). To avoid bad local minima, we solved the MAP problem with multiple starting points. Such an approach increases the probability to find the global optimum, but obtaining a rigorous certificate of a global minimum is computationally challenging (rigorous global optimization techniques are currently not scalable to large problems). We found that the use of multiple starting points does not improve the model fit. Consequently, we attribute fitting errors to the model structure itself. In particular, the gLV model neglects various physical and biological phenomena such as lag phase or interaction coefficients that change as a function of time [<xref ref-type="bibr" rid="pcbi.1006828.ref066">66</xref>]. To investigate structural errors, we solved the MAP problem with a variant of the gLV model. In particular, we investigated the saturable gLV model [<xref ref-type="bibr" rid="pcbi.1006828.ref072">72</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref073">73</xref>] (<xref ref-type="disp-formula" rid="pcbi.1006828.e131">Model 2</xref>):
<disp-formula id="pcbi.1006828.e131"><alternatives><graphic id="pcbi.1006828.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e131" xlink:type="simple"/><mml:math display="block" id="M131"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(Model 2)</label></disp-formula>
where <italic>K</italic><sub><italic>ss</italic>′</sub> &gt; 0 are additional interaction parameters. The saturable model exhibits a much higher degree of nonlinearity than the gLV model and includes <italic>S</italic><sup>2</sup> more parameters (the number of degrees of freedom increases from <italic>S</italic><sup>2</sup> + <italic>S</italic> to 2<italic>S</italic><sup>2</sup> + <italic>S</italic>). As a result, the saturable gLV model provides more flexibility to improve model fitting. These results thus seek to illustrate that the proposed NLP framework can be used to handle challenging dynamic models. The model fitting obtained with the saturable gLV form is illustrated in <xref ref-type="fig" rid="pcbi.1006828.g005">Fig 5</xref>. As can be seen, significant improvements were made; in particular, the overall fitting error
<disp-formula id="pcbi.1006828.e132"><alternatives><graphic id="pcbi.1006828.e132g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e132" xlink:type="simple"/><mml:math display="block" id="M132"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac><mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>η</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msup><mml:mo>)</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(51)</label></disp-formula>
was reduced by 30%. Increasing the number of degrees of freedom can cause overfitting, however, and this can make the model less predictive. Consequently, there is a trade-off between fit and predictability.</p>
<fig id="pcbi.1006828.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Fitting of experimental data (P1, <xref ref-type="disp-formula" rid="pcbi.1006828.e117">Model 1</xref>).</title>
<p>Subplots show the measured and predicted species abundance in the microbial community. The subplots on the diagonal show fitting for mono-species experiments. Subplots on the <italic>i</italic>-th row and <italic>j</italic>-th column shows fitting for the corresponding pairwise culture (the abundance of species <italic>i</italic> in the presence of species <italic>j</italic>). Recipient and donor species are listed in rows and columns, respectively. For each subplot, the <italic>y</italic>-axis represents the absolute abundance in the community based on relative abundance multiplied by total biomass (OD600) and the <italic>x</italic>-axis represents the experiment time in hours. Data points are denoted by grey dots and dynamic model trajectories are denoted by solid lines. The data points highlighted with red circles are data points corresponding to the ten largest errors <inline-formula id="pcbi.1006828.e133"><alternatives><graphic id="pcbi.1006828.e133g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e133" xlink:type="simple"/><mml:math display="inline" id="M133"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mo>)</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>/</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The subplots highlighted with red boxes are subplots for the experiments with the ten largest total prediction errors <inline-formula id="pcbi.1006828.e134"><alternatives><graphic id="pcbi.1006828.e134g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e134" xlink:type="simple"/><mml:math display="inline" id="M134"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">T</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mo>)</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>/</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g004" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006828.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Improvement of model fitting with saturable gLV model (P1, <xref ref-type="disp-formula" rid="pcbi.1006828.e131">Model 2</xref>).</title>
<p>Model fitting for 4 experiments selected among the experiments with 10 largest total prediction errors. The gLV model fits (dotted line) are compared with those of the saturable model (solid line). <bold>(a)</bold> Model fits to monospecies experiment with CH. <bold>(b)</bold> Model fits to monospecies experiment with CA. <bold>(c)</bold> Model fits to pairwise community experiment with PC in the presence of EL. <bold>(d)</bold> Model fits for pairwise community experiment with CA in the presence of ER.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g005" xlink:type="simple"/>
</fig>
<p>To mitigate outliers, we solved the MAP problem with a CVaR norm and <italic>β</italic> = 0.9 (to penalize the 10% largest errors). The relevant results are summarized in <xref ref-type="fig" rid="pcbi.1006828.g006">Fig 6</xref>. It can be observed that the fitting errors for the outliers obtained with the standard MAP formulation are reduced. The effect of the CVaR formulation is also evident when analyzing the prediction error histogram (see <xref ref-type="fig" rid="pcbi.1006828.g007">Fig 7</xref>). In particular, we observe that the tail of high prediction errors becomes less pronounced under the CVaR formulation. In particular, the mean of the 10% largest errors decreases by 18% (from 167.81 to 137.04). On the other hand, it can also be observed that the mean error increases under CVaR and that the tail of small errors shrinks. This illustrates the fundamental trade-off that usually arises in robust statistics. The behavior induced with CVaR aids estimator performance because it prevents overfitting experimental data sets.</p>
<fig id="pcbi.1006828.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Improvement of model fitting by using CVaR (<italic>k</italic>-max) MAP formulation (P1, <xref ref-type="disp-formula" rid="pcbi.1006828.e117">Model 1</xref>).</title>
<p>Model fits for 4 experiments selected among the experiments with 10 largest prediction errors <inline-formula id="pcbi.1006828.e135"><alternatives><graphic id="pcbi.1006828.e135g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e135" xlink:type="simple"/><mml:math display="inline" id="M135"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mo>)</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>/</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The model fits from standard MAP formulation (dotted line) are compared with the model fits from CVaR formulation with <italic>β</italic> = 0.9 (solid line). <bold>(a)</bold> gLV model fits to pairwise community experiment of PC in the presence of EL. <bold>(b)</bold> gLV model fits to pairwise community experiment of CA in the presence of ER. <bold>(c)</bold> gLV model fits to pairwise community experiment with CH in the presence of PC. <bold>(d)</bold> gLV model fits to pairwise community experiment with CH in the presence of BO.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g006" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006828.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Histograms of fitting errors (P1, <xref ref-type="disp-formula" rid="pcbi.1006828.e117">Model 1</xref>).</title>
<p><bold>(a)</bold> Error histogram for the standard MAP formulation. <bold>(b)</bold> Tail region of (a). <bold>(c)</bold> Error histogram for CVaR formulation. <bold>(d)</bold> Tail region of (c). (a-d) The <italic>x</italic>-axis represents the value of prediction error evaluated at the solution and the <italic>y</italic>-axis represents the frequency. The red and blue line represent quantiles: the overall mean of prediction errors (red) and the mean of largest 10% errors (blue).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>Inference (posterior) analysis</title>
<p>We used rMAP to assess the uncertainty of the 156 parameters estimated from P1 using the available experimental data. To do so, we draw data perturbations as <italic>η</italic><sub><italic>k</italic>,<italic>s</italic></sub>(<italic>t</italic>) ← <italic>η</italic><sub><italic>k</italic>,<italic>s</italic></sub>(<italic>t</italic>) + <italic>ϵ</italic><sub><italic>k</italic>,<italic>s</italic></sub>(<italic>t</italic>) with <inline-formula id="pcbi.1006828.e136"><alternatives><graphic id="pcbi.1006828.e136g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e136" xlink:type="simple"/><mml:math display="inline" id="M136"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We solved 500 MAP problems to obtain parameter samples and use this to approximate the covariance matrix for the posterior. The standard deviations are shown in <xref ref-type="fig" rid="pcbi.1006828.g008">Fig 8(a)</xref> and the marginals for the posterior are shown in <xref ref-type="fig" rid="pcbi.1006828.g009">Fig 9</xref>. A large standard deviation indicates that the estimated parameter value is not reliable. We note that about half of the parameters can be estimated reliably while the other half exhibit significant uncertainty. This indicates that more experimental data should be obtained. From the sample covariance, we generated 95% ellipsoidal confidence regions for each pair of parameters. The correlation plots of <italic>μ</italic><sub><italic>s</italic></sub> against <italic>α</italic><sub><italic>ss</italic>′</sub> for <inline-formula id="pcbi.1006828.e137"><alternatives><graphic id="pcbi.1006828.e137g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006828.e137" xlink:type="simple"/><mml:math display="inline" id="M137"><mml:mrow><mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> are shown in <xref ref-type="fig" rid="pcbi.1006828.g010">Fig 10</xref> and the Pearson correlation coefficients are shown in <xref ref-type="fig" rid="pcbi.1006828.g008">Fig 8(b)</xref>. In an ideal case, the parameters should be uncorrelated because data should be sufficient to estimate each parameter reliably. Using our data set, however, we can observe strong correlations between the parameters <italic>μ</italic><sub><italic>s</italic></sub> and <italic>α</italic><sub><italic>ss</italic></sub> in <xref ref-type="fig" rid="pcbi.1006828.g010">Fig 10</xref>, and strong positive and negative correlations can also be found in <xref ref-type="fig" rid="pcbi.1006828.g008">Fig 8(b)</xref>.</p>
<fig id="pcbi.1006828.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Parameter uncertainty and correlations (P1, <xref ref-type="disp-formula" rid="pcbi.1006828.e117">Model 1</xref>).</title>
<p><bold>(a)</bold> Heat map presents the standard deviation for the parameter posterior density. The first row shows the standard deviations of the growth rate parameters <italic>μ</italic><sub><italic>s</italic></sub> and the rest of the rows show the standard deviations of the interaction coefficients <italic>α</italic><sub><italic>ss</italic>′</sub>. Recipient and donor species are on the <italic>x</italic> and <italic>y</italic>-axis, respectively. The data points highlighted with green circles are data points corresponding to the ten largest standard deviations. <bold>(b)</bold> The heat map represents the Pearson correlation coefficients of the poterior distributions. The <italic>x</italic>-axis and the <italic>y</italic>-axis represents the index of parameters where the parameter vector is constructed as <italic>θ</italic> = (<italic>μ</italic><sub>1</sub>, <italic>α</italic><sub>11</sub>⋯<italic>α</italic><sub>1<italic>S</italic></sub>, ⋯, <italic>μ</italic><sub><italic>S</italic></sub>, <italic>α</italic><sub><italic>S</italic>1</sub>, ⋯ <italic>α</italic><sub><italic>SS</italic></sub>). The block on the <italic>i</italic>-th row and <italic>j</italic>-th column is the Pearson correlation between the <italic>i</italic>-th and <italic>j</italic>-th component of parameter vector <italic>θ</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g008" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006828.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Posterior (marginal) densities for estimated parameters (P1, <xref ref-type="disp-formula" rid="pcbi.1006828.e117">Model 1</xref>).</title>
<p>Each subplot shows the histogram of the samples from the approximate parameter posterior. The <italic>x</italic>-axis represents the values of the estimated parameters and the <italic>y</italic>-axis represents the frequencies. The subplots on the first column show the distribution of the growth rates <italic>μ</italic><sub><italic>s</italic></sub> and the rest of the subplots show distributions of the interaction parameters <italic>α</italic><sub><italic>ss</italic>′</sub>. Recipient and donor species are listed in rows and columns, respectively. The <italic>x</italic>-axis is scaled to show <italic>μ</italic> ± 3<italic>σ</italic> where the <italic>μ</italic> is the mean and the <italic>σ</italic> is the standard deviation of the posterior distribution.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g009" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006828.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Correlations between parameter pairs (P1, <xref ref-type="disp-formula" rid="pcbi.1006828.e117">Model 1</xref>).</title>
<p>Each subplot shows the 95% confidence regions (solid ellipses) of the approximate parameter posterior distributions and the sample points (dots). The subplots on the <italic>s</italic>-th row and <italic>s</italic>′-th column show the correlation of <italic>μ</italic><sub><italic>s</italic></sub> and <italic>α</italic><sub><italic>ss</italic>′</sub>. Recipient and donor species are listed in rows and columns, respectively. Only a representative subset of parameter pairs is presented (there are a total 12,090 pairs).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g010" xlink:type="simple"/>
</fig>
<p>Furthermore, since the whole approximate distribution is obtained in the inference analysis based on rMAP framework, we can perform more sophisticated analysis on the characteristics of the distribution. In particular, one can investigate third and fourth moments (<xref ref-type="fig" rid="pcbi.1006828.g011">Fig 11</xref>) to examine the skewness and the kurtosis of the distribution. Such information can be used to investigate the deviation of the posterior distribution from the normal distribution. If the posteriors are stritly normally distributed, the third and fourth moments should be zero and 3<italic>σ</italic><sup>4</sup>, respectively. However, we can observe that many posterior distributions deviate from such expectations. Thus, we can see that some of the distributions are not close to the normal distribution.</p>
<fig id="pcbi.1006828.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Third and fourth momentum of posterior (P1, <xref ref-type="disp-formula" rid="pcbi.1006828.e117">Model 1</xref>).</title>
<p><bold>(a)</bold> Heat map presents the third momentum of the parameter posterior density (normalized by <italic>σ</italic><sup>3</sup>).<bold>(b)</bold> The heat map represents the fourth momentum of the poterior density (normalized by <italic>σ</italic><sup>4</sup>). (a-b) The first row shows the standard deviations of the growth rate parameters <italic>μ</italic><sub><italic>s</italic></sub> and the rest of the rows show the standard deviations of the interaction coefficients <italic>α</italic><sub><italic>ss</italic>′</sub>. Recipient and donor species are on the <italic>x</italic> and <italic>y</italic>-axis, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g011" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec015">
<title>Computational scalability</title>
<p>We assessed the computational scalability of the estimation framework by analyzing problems with different sizes and characteristics. Problem P1 was implemented in the algebraic modeling platform <monospace>JuMP</monospace> and solved with the NLP solver <monospace>Ipopt</monospace> configured with the sparse linear solver <monospace>MA57</monospace>. Problem P1 with gLV model and L2 prior was solved in 134 seconds and 78 NLP iterations on a standard computing server with an Intel(R) Xeon(R) CPU E5-2698 v3 processor running at 2.30GHz. Problem P1 with gLV model and L1 prior was solved in 219 seconds and 68 NLP iterations with the same hardware. A comparable problem requires over 7 hours to solve using a simulation-based approach implemented in <monospace>Matlab</monospace> and that uses finite differences to obtain first derivatives [<xref ref-type="bibr" rid="pcbi.1006828.ref066">66</xref>]. Despite the significant gains in computational performance obtained with <monospace>Ipopt</monospace>, its solution time scales nearly quadratically with the number of data sets. To overcome this scalability issue, we compared the performance of the serial solver <monospace>Ipopt</monospace> against that of the parallel solver <monospace>PIPS-NLP</monospace> (which uses a Schur complement decomposition to perform linear algebra operations). To test the scalability of <monospace>PIPS-NLP</monospace>, we generated a larger version of the estimation problem (labeled as P2). This problem is created by adding synthetic data sets. The NLP corresponding to P2 has over one million variables and constraints (but the number of parameters is the same as that of P1). This problem was implemented in <monospace>Plasmo.jl</monospace>. The benefit of using a parallel approach is clearly seen in <xref ref-type="fig" rid="pcbi.1006828.g012">Fig 12</xref>. Here, we highlight that <monospace>PIPS-NLP</monospace> solved P2 in less than 10 minutes and 94 NLP iterations using 16 cores while <monospace>Ipopt</monospace> requires around 30 minutes and 67 iterations. Furthermore, <monospace>IPOPT</monospace> found a different local solution and the solution from <monospace>PIPS-NLP</monospace> had a better objective value. <xref ref-type="fig" rid="pcbi.1006828.g012">Fig 12(b)</xref> also shows that <monospace>PIPS-NLP</monospace> achieves nearly perfect strong scaling (speedup increases linearly with the number of cores).</p>
<fig id="pcbi.1006828.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Performance comparison of general solver <monospace>Ipopt</monospace> and the structure-exploiting solver <monospace>PIPS-NLP</monospace> (P1-P2, <xref ref-type="disp-formula" rid="pcbi.1006828.e117">Model 1</xref>).</title>
<p><bold>(a)</bold> Solution time for P2 using <monospace>Ipopt</monospace> and <monospace>PIPS-NLP</monospace>. The <italic>y</italic>-axis shows the solution time and the <italic>x</italic>-axis shows the number of cores used. For <monospace>Ipopt</monospace> the single core solution time is given by the horizontal blue line. <bold>(b)</bold> The <italic>y</italic>-axis represents the speed-up (the single-core solution time divided by the multi-core solution time). The blue line is the single-core solution time of <monospace>PIPS-NLP</monospace> divided by the single-core solution time of <monospace>Ipopt</monospace>. The grey dashed line represents the strong scaling line.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g012" xlink:type="simple"/>
</fig>
<p>In rMAP-based uncertainty quantification, the main computational challenge was the repetitive solution of the optimization problems. However, such challenge can be overcome by using the existing solution information. The required number of iterations in NLP solver can be greatly reduced when a good starting point (initial guess of the solution) is available (often referred to as <italic>warm start</italic>). Since only small modifications are made to the original problem to formulate the rMAP problem, the NLP solution of rMAP problem is very similar to that of the original problem. Thus, by warm-starting the NLP with the original NLP solution, the computational efforts to solve rMAP problem can be significantly reduced. In particular, most rMAP sampling problem was solved in less than 10 NLP iterations while the original problem required 78 NLP iterations.</p>
<p>We also assessed computational capability in estimation problems with the larger number of species in the microbial community (which increases the number of differential equations and parameters). Here, we generated synthetic data using simulations for larger communities. The generated data are summarized in <xref ref-type="table" rid="pcbi.1006828.t002">Table 2</xref>. The number of the parameters and of data points scales nearly quadratically with respect to the size of the community. The computation times are shown in <xref ref-type="fig" rid="pcbi.1006828.g013">Fig 13</xref>. The results indicate that, by using <monospace>PIPS-NLP</monospace>, one can solve estimation problems with up to 48 species in <italic>less than 15 minutes and 40 NLP iterations</italic> (using 12 parallel computing cores). We highlight that, to the best of our knowledge, problem S4 is the largest estimation problem reported in computational biology literature. This problem contains 2,304 differential equations, 2,352 parameters, and 20,352 data points. The corresponding NLP contains 1.3 million variables and constraints.</p>
<fig id="pcbi.1006828.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006828.g013</object-id>
<label>Fig 13</label>
<caption>
<title>Computational scalability with larger communities (S1-S4, <xref ref-type="disp-formula" rid="pcbi.1006828.e117">Model 1</xref>).</title>
<p><bold>(a)</bold> Number of variables against community size (total number of species). <bold>(b)</bold> The computation times for problems S1-S4 (see <xref ref-type="table" rid="pcbi.1006828.t002">Table 2</xref>). The problems were solved with <monospace>PIPS-NLP</monospace> on 12 parallel cores (Intel(R) Xeon(R) CPU E5-2698 v3 processor running at 2.30GHz).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006828.g013" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec016" sec-type="conclusions">
<title>Discussion</title>
<p>The high computational efficiency achieved with the proposed framework can enable kinetic modeling of complex biological systems ranging from biomolecular networks to high-dimensional microbial communities [<xref ref-type="bibr" rid="pcbi.1006828.ref074">74</xref>]. Indeed, the proposed framework can be used to construct and analyze high-fidelity models of whole-cells or microbiomes [<xref ref-type="bibr" rid="pcbi.1006828.ref075">75</xref>, <xref ref-type="bibr" rid="pcbi.1006828.ref076">76</xref>]. In particular, these methods can be applied to develop predictive dynamic models of multi-gene synthetic circuits interacting with host-cell processes for accurately predicting cell growth and synthetic circuit activity [<xref ref-type="bibr" rid="pcbi.1006828.ref077">77</xref>] or kinetic models of metabolite transformations driving community dynamics. The proposed framework can also be used to handle more sophisticated models that arise in biological systems such as delay differential equations, differential and algebraic equations, and partial differential equations. Dynamic biological models with embedded metabolic flux formulations (giving rise to non-smooth behavior) can be handled with the proposed framework by using reformulations [<xref ref-type="bibr" rid="pcbi.1006828.ref078">78</xref>]. Estimation problems for stochastic differential equations (such as stochastic chemical kinetics models) cannot be handled with the proposed framework and remain a challenging class of problems [<xref ref-type="bibr" rid="pcbi.1006828.ref079">79</xref>].</p>
<p>The methods provided in this work will advance our capability of integrating mechanistic modeling frameworks with large-scale experimental data. Furthermore, uncertainty quantification and observability analysis can provide valuable information to guide and accelerate experimental data collection. These capabilities are also essential in diagnosing structural model errors. The proposed framework uses state-of-the-art and easy-to-use modeling and solution tools that can be broadly applied to diverse biological systems and accessible to a wide range of users. In the future, the proposed framework can be interfaced with systems biology markup languages such as SBML [<xref ref-type="bibr" rid="pcbi.1006828.ref080">80</xref>] and CellML [<xref ref-type="bibr" rid="pcbi.1006828.ref081">81</xref>] to allow broader applicability. Together, these advances can ultimately transform biology into a predictive and model-guided discipline.</p>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1006828.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Venturelli</surname> <given-names>OS</given-names></name>, <name name-style="western"><surname>Zuleta</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>El-Samad</surname> <given-names>H</given-names></name>. <article-title>Population diversification in a yeast metabolic program promotes anticipation of environmental shifts</article-title>. <source>PLoS biology</source>. <year>2015</year>;<volume>13</volume>(<issue>1</issue>):<fpage>e1002042</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pbio.1002042" xlink:type="simple">10.1371/journal.pbio.1002042</ext-link></comment> <object-id pub-id-type="pmid">25626086</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gore</surname> <given-names>J</given-names></name>. <article-title>Ecological systems biology: The dynamics of interacting populations</article-title>. <source>Current Opinion in Systems Biology</source>. <year>2017</year>;<volume>1</volume>:<fpage>114</fpage>–<lpage>121</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.coisb.2016.12.001" xlink:type="simple">10.1016/j.coisb.2016.12.001</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Venayak</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Anesiadis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Cluett</surname> <given-names>WR</given-names></name>, <name name-style="western"><surname>Mahadevan</surname> <given-names>R</given-names></name>. <article-title>Engineering metabolism through dynamic control</article-title>. <source>Current opinion in biotechnology</source>. <year>2015</year>;<volume>34</volume>:<fpage>142</fpage>–<lpage>152</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.copbio.2014.12.022" xlink:type="simple">10.1016/j.copbio.2014.12.022</ext-link></comment> <object-id pub-id-type="pmid">25616051</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ashyraliyev</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fomekong-Nanfack</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kaandorp</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Blom</surname> <given-names>JG</given-names></name>. <article-title>Systems biology: Parameter estimation for biochemical models</article-title>. <source>FEBS Journal</source>. <year>2009</year>;<volume>276</volume>(<issue>4</issue>):<fpage>886</fpage>–<lpage>902</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1742-4658.2008.06844.x" xlink:type="simple">10.1111/j.1742-4658.2008.06844.x</ext-link></comment> <object-id pub-id-type="pmid">19215296</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sun</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Garibaldi</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Hodgman</surname> <given-names>C</given-names></name>. <article-title>Parameter estimation using metaheuristics in systems biology: A comprehensive review</article-title>. <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source>. <year>2012</year>;<volume>9</volume>(<issue>1</issue>):<fpage>185</fpage>–<lpage>202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TCBB.2011.63" xlink:type="simple">10.1109/TCBB.2011.63</ext-link></comment> <object-id pub-id-type="pmid">21464505</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raue</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schilling</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bachmann</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Matteson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schelke</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kaschek</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Lessons learned from quantitative dynamical modeling in systems biology</article-title>. <source>PloS one</source>. <year>2013</year>;<volume>8</volume>(<issue>9</issue>):<fpage>e74335</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0074335" xlink:type="simple">10.1371/journal.pone.0074335</ext-link></comment> <object-id pub-id-type="pmid">24098642</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fröhlich</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kaltenbacher</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Theis</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Hasenauer</surname> <given-names>J</given-names></name>. <article-title>Scalable parameter estimation for genome-scale biochemical reaction networks</article-title>. <source>PLoS computational biology</source>. <year>2017</year>;<volume>13</volume>(<issue>1</issue>):<fpage>e1005331</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005331" xlink:type="simple">10.1371/journal.pcbi.1005331</ext-link></comment> <object-id pub-id-type="pmid">28114351</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leppavuori</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Domach</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <article-title>Parameter estimation in batch bioreactor simulation using metabolic models: Sequential solution with direct sensitivities</article-title>. <source>Industrial &amp; Engineering Chemistry Research</source>. <year>2011</year>;<volume>50</volume>(<issue>21</issue>):<fpage>12080</fpage>–<lpage>12091</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ie201020g" xlink:type="simple">10.1021/ie201020g</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mendes</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kell</surname> <given-names>D</given-names></name>. <article-title>Non-linear optimization of biochemical pathways: applications to metabolic engineering and parameter estimation</article-title>. <source>Bioinformatics (Oxford, England)</source>. <year>1998</year>;<volume>14</volume>(<issue>10</issue>):<fpage>869</fpage>–<lpage>883</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/14.10.869" xlink:type="simple">10.1093/bioinformatics/14.10.869</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moles</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Mendes</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Banga</surname> <given-names>JR</given-names></name>. <article-title>Parameter estimation in biochemical pathways: a comparison of global optimization methods</article-title>. <source>Genome research</source>. <year>2003</year>;<volume>13</volume>(<issue>11</issue>):<fpage>2467</fpage>–<lpage>2474</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.1262503" xlink:type="simple">10.1101/gr.1262503</ext-link></comment> <object-id pub-id-type="pmid">14559783</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kirkpatrick</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gelatt</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Vecchi</surname> <given-names>MP</given-names></name>, <etal>et al</etal>. <article-title>Optimization by simulated annealing</article-title>. <source>science</source>. <year>1983</year>;<volume>220</volume>(<issue>4598</issue>):<fpage>671</fpage>–<lpage>680</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.220.4598.671" xlink:type="simple">10.1126/science.220.4598.671</ext-link></comment> <object-id pub-id-type="pmid">17813860</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chen</surname> <given-names>WW</given-names></name>, <name name-style="western"><surname>Schoeberl</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Jasper</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Niepel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>UB</given-names></name>, <name name-style="western"><surname>Lauffenburger</surname> <given-names>DA</given-names></name>, <etal>et al</etal>. <article-title>Input–output behavior of ErbB signaling pathways as revealed by a mass action model trained against dynamic data</article-title>. <source>Molecular systems biology</source>. <year>2009</year>;<volume>5</volume>(<issue>1</issue>):<fpage>239</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/msb.2008.74" xlink:type="simple">10.1038/msb.2008.74</ext-link></comment> <object-id pub-id-type="pmid">19156131</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kikuchi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tominaga</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Arita</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Tomita</surname> <given-names>M</given-names></name>. <article-title>Dynamic modeling of genetic networks using genetic algorithm and S-system</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>5</issue>):<fpage>643</fpage>–<lpage>650</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btg027" xlink:type="simple">10.1093/bioinformatics/btg027</ext-link></comment> <object-id pub-id-type="pmid">12651723</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref014">
<label>14</label>
<mixed-citation publication-type="other" xlink:type="simple">Tominaga D, Koga N, Okamoto M. Efficient numerical optimization algorithm based on genetic algorithm for inverse problem. In: Proceedings of the 2nd Annual Conference on Genetic and Evolutionary Computation. Morgan Kaufmann Publishers Inc.; 2000. p. 251–258.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>XS</given-names></name>. <source>Nature-inspired metaheuristic algorithms</source>. <publisher-name>Luniver press</publisher-name>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Toni</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Welch</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Strelkowa</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ipsen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>MP</given-names></name>. <article-title>Approximate Bayesian computation scheme for parameter inference and model selection in dynamical systems</article-title>. <source>Journal of the Royal Society Interface</source>. <year>2009</year>;<volume>6</volume>(<issue>31</issue>):<fpage>187</fpage>–<lpage>202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2008.0172" xlink:type="simple">10.1098/rsif.2008.0172</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Toni</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>MP</given-names></name>. <article-title>Simulation-based model selection for dynamical systems in systems and population biology</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>26</volume>(<issue>1</issue>):<fpage>104</fpage>–<lpage>110</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btp619" xlink:type="simple">10.1093/bioinformatics/btp619</ext-link></comment> <object-id pub-id-type="pmid">19880371</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Balsa-Canto</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Peifer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Banga</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Timmer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fleck</surname> <given-names>C</given-names></name>. <article-title>Hybrid optimization method with general switching strategy for parameter estimation</article-title>. <source>BMC systems biology</source>. <year>2008</year>;<volume>2</volume>(<issue>1</issue>):<fpage>26</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-2-26" xlink:type="simple">10.1186/1752-0509-2-26</ext-link></comment> <object-id pub-id-type="pmid">18366722</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vaz</surname> <given-names>AIF</given-names></name>, <name name-style="western"><surname>Vicente</surname> <given-names>LN</given-names></name>. <article-title>A particle swarm pattern search method for bound constrained global optimization</article-title>. <source>Journal of Global Optimization</source>. <year>2007</year>;<volume>39</volume>(<issue>2</issue>):<fpage>197</fpage>–<lpage>219</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10898-007-9133-5" xlink:type="simple">10.1007/s10898-007-9133-5</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zavala</surname> <given-names>VM</given-names></name>, <name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <article-title>Optimization-based strategies for the operation of low-density polyethylene tubular reactors: Moving horizon estimation</article-title>. <source>Computers &amp; Chemical Engineering</source>. <year>2009</year>;<volume>33</volume>(<issue>1</issue>):<fpage>379</fpage>–<lpage>390</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.compchemeng.2008.10.008" xlink:type="simple">10.1016/j.compchemeng.2008.10.008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>López-Negrete</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <article-title>A moving horizon estimator for processes with multi-rate measurements: A nonlinear programming sensitivity approach</article-title>. <source>Journal of Process Control</source>. <year>2012</year>;<volume>22</volume>(<issue>4</issue>):<fpage>677</fpage>–<lpage>688</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jprocont.2012.01.013" xlink:type="simple">10.1016/j.jprocont.2012.01.013</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lillacci</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Khammash</surname> <given-names>M</given-names></name>. <article-title>Parameter estimation and model selection in computational biology</article-title>. <source>PLoS computational biology</source>. <year>2010</year>;<volume>6</volume>(<issue>3</issue>):<fpage>e1000696</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000696" xlink:type="simple">10.1371/journal.pcbi.1000696</ext-link></comment> <object-id pub-id-type="pmid">20221262</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref023">
<label>23</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <source>Nonlinear programming: concepts, algorithms, and applications to chemical processes</source>. <volume>vol. 10</volume>. <publisher-name>Siam</publisher-name>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref024">
<label>24</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Zavala</surname> <given-names>VM</given-names></name>. <source>Computational strategies for the optimal operation of large-scale chemical processes</source>. <publisher-name>Carnegie Mellon University</publisher-name>; <year>2008</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Albuquerque</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <article-title>Decomposition algorithms for on-line estimation with nonlinear DAE models</article-title>. <source>Computers &amp; chemical engineering</source>. <year>1997</year>;<volume>21</volume>(<issue>3</issue>):<fpage>283</fpage>–<lpage>299</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0098-1354(96)90029-0" xlink:type="simple">10.1016/S0098-1354(96)90029-0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leibman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Edgar</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lasdon</surname> <given-names>L</given-names></name>. <article-title>Efficient data reconciliation and estimation for dynamic processes using nonlinear programming techniques</article-title>. <source>Computers &amp; chemical engineering</source>. <year>1992</year>;<volume>16</volume>(<issue>10-11</issue>):<fpage>963</fpage>–<lpage>986</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0098-1354(92)80030-D" xlink:type="simple">10.1016/0098-1354(92)80030-D</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tjoa</surname> <given-names>IB</given-names></name>, <name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <article-title>Simultaneous solution and optimization strategies for parameter estimation of differential-algebraic equation systems</article-title>. <source>Industrial &amp; Engineering Chemistry Research</source>. <year>1991</year>;<volume>30</volume>(<issue>2</issue>):<fpage>376</fpage>–<lpage>385</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ie00050a015" xlink:type="simple">10.1021/ie00050a015</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Betts</surname> <given-names>JT</given-names></name>. <article-title>Optimal interplanetary orbit transfers by direct transcription</article-title>. <source>Journal of the Astronautical Sciences</source>. <year>1994</year>;<volume>42</volume>(<issue>3</issue>):<fpage>247</fpage>–<lpage>268</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Betts</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Cramer</surname> <given-names>EJ</given-names></name>. <article-title>Application of direct transcription to commercial aircraft trajectory optimization</article-title>. <source>Journal of Guidance, Control, and Dynamics</source>. <year>1995</year>;<volume>18</volume>(<issue>1</issue>):<fpage>151</fpage>–<lpage>159</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2514/3.56670" xlink:type="simple">10.2514/3.56670</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bottasso</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Croce</surname> <given-names>A</given-names></name>. <article-title>Optimal control of multibody systems using an energy preserving direct transcription method</article-title>. <source>Multibody System Dynamics</source>. <year>2004</year>;<volume>12</volume>(<issue>1</issue>):<fpage>17</fpage>–<lpage>45</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1023/B:MUBO.0000042931.61655.73" xlink:type="simple">10.1023/B:MUBO.0000042931.61655.73</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <article-title>An overview of simultaneous strategies for dynamic optimization</article-title>. <source>Chemical Engineering and Processing: Process Intensification</source>. <year>2007</year>;<volume>46</volume>(<issue>11</issue>):<fpage>1043</fpage>–<lpage>1053</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cep.2006.06.021" xlink:type="simple">10.1016/j.cep.2006.06.021</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pirnay</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>López-Negrete</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <article-title>Optimal sensitivity based on IPOPT</article-title>. <source>Mathematical Programming Computation</source>. <year>2012</year>;<volume>4</volume>(<issue>4</issue>):<fpage>307</fpage>–<lpage>331</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s12532-012-0043-2" xlink:type="simple">10.1007/s12532-012-0043-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chib</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Greenberg</surname> <given-names>E</given-names></name>. <article-title>Understanding the metropolis-hastings algorithm</article-title>. <source>The american statistician</source>. <year>1995</year>;<volume>49</volume>(<issue>4</issue>):<fpage>327</fpage>–<lpage>335</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/00031305.1995.10476177" xlink:type="simple">10.1080/00031305.1995.10476177</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref034">
<label>34</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gamerman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lopes</surname> <given-names>HF</given-names></name>. <source>Markov chain Monte Carlo: stochastic simulation for Bayesian inference</source>. <publisher-name>Chapman and Hall/CRC</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Petra</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stadler</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ghattas</surname> <given-names>O</given-names></name>. <article-title>A computational framework for infinite-dimensional Bayesian inverse problems, Part II: Stochastic Newton MCMC with application to ice sheet flow inverse problems</article-title>. <source>SIAM Journal on Scientific Computing</source>. <year>2014</year>;<volume>36</volume>(<issue>4</issue>):<fpage>A1525</fpage>–<lpage>A1555</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1137/130934805" xlink:type="simple">10.1137/130934805</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Bui-Thanh</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ghattas</surname> <given-names>O</given-names></name>. <article-title>A randomized maximum a posteriori method for posterior sampling of high dimensional nonlinear Bayesian inverse problems</article-title>. <source>SIAM Journal on Scientific Computing</source>. <year>2018</year>;<volume>40</volume>(<issue>1</issue>):<fpage>A142</fpage>–<lpage>A171</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1137/16M1060625" xlink:type="simple">10.1137/16M1060625</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bardsley</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Solonen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Haario</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Laine</surname> <given-names>M</given-names></name>. <article-title>Randomize-Then-Optimize: a Method for Sampling From Posterior Distributions in Nonlinear Inverse Problems</article-title>. <source>Siam Journal on Scientific Computing</source>. <year>2014</year>;<volume>36</volume>(<issue>4</issue>):<fpage>A1895</fpage>–<lpage>A1910</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1137/140964023" xlink:type="simple">10.1137/140964023</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref038">
<label>38</label>
<mixed-citation publication-type="other" xlink:type="simple">Oliver DS. Metropolized Randomized Maximum Likelihood for sampling from multimodal distributions. arXiv preprint arXiv:150708563. 2015.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref039">
<label>39</label>
<mixed-citation publication-type="other" xlink:type="simple">Oliver DS, He N, Reynolds AC. Conditioning permeability fields to pressure data. In: ECMOR V-5th European Conference on the Mathematics of Oil Recovery; 1996.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rockafellar</surname> <given-names>RT</given-names></name>, <name name-style="western"><surname>Uryasev</surname> <given-names>S</given-names></name>. <article-title>Optimization of conditional value-at-risk</article-title>. <source>Journal of risk</source>. <year>2000</year>;<volume>2</volume>:<fpage>21</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.21314/JOR.2000.038" xlink:type="simple">10.21314/JOR.2000.038</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rockafellar</surname> <given-names>RT</given-names></name>, <name name-style="western"><surname>Uryasev</surname> <given-names>S</given-names></name>. <article-title>Conditional value-at-risk for general loss distributions</article-title>. <source>Journal of banking &amp; finance</source>. <year>2002</year>;<volume>26</volume>(<issue>7</issue>):<fpage>1443</fpage>–<lpage>1471</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0378-4266(02)00271-6" xlink:type="simple">10.1016/S0378-4266(02)00271-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Boyd</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Vandenberghe</surname> <given-names>L</given-names></name>. <source>Convex optimization</source>. <publisher-name>Cambridge university press</publisher-name>; <year>2004</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref043">
<label>43</label>
<mixed-citation publication-type="other" xlink:type="simple">Tikhonov A. Numerical methods for the solution of ill-posed problems.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref044">
<label>44</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Golub</surname> <given-names>GH</given-names></name>, <name name-style="western"><surname>Van Loan</surname> <given-names>CF</given-names></name>. <source>Matrix computations</source>. <volume>vol. 3</volume>. <publisher-name>JHU Press</publisher-name>; <year>2012</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>. <article-title>Regression shrinkage and selection via the lasso</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1996</year>; p. <fpage>267</fpage>–<lpage>288</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.2517-6161.1996.tb02080.x" xlink:type="simple">10.1111/j.2517-6161.1996.tb02080.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pavlikov</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Uryasev</surname> <given-names>S</given-names></name>. <article-title>CVaR norm and applications in optimization</article-title>. <source>Optimization Letters</source>. <year>2014</year>;<volume>8</volume>(<issue>7</issue>):<fpage>1999</fpage>–<lpage>2020</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11590-013-0713-7" xlink:type="simple">10.1007/s11590-013-0713-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zavala</surname> <given-names>VM</given-names></name>, <name name-style="western"><surname>Laird</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <article-title>Interior-point decomposition approaches for parallel solution of large-scale nonlinear parameter estimation problems</article-title>. <source>Chemical Engineering Science</source>. <year>2008</year>;<volume>63</volume>(<issue>19</issue>):<fpage>4834</fpage>–<lpage>4845</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ces.2007.05.022" xlink:type="simple">10.1016/j.ces.2007.05.022</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wächter</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <article-title>On the implementation of an interior-point filter line-search algorithm for large-scale nonlinear programming</article-title>. <source>Mathematical Programming</source>. <year>2006</year>;<volume>106</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>57</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10107-004-0559-y" xlink:type="simple">10.1007/s10107-004-0559-y</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref049">
<label>49</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Byrd</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Nocedal</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Waltz</surname> <given-names>RA</given-names></name>. <chapter-title>KNITRO: An integrated package for nonlinear optimization</chapter-title>. In: <source>Large-scale nonlinear optimization</source>. <publisher-name>Springer</publisher-name>; <year>2006</year>. p. <fpage>35</fpage>–<lpage>59</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref050">
<label>50</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Zavala</surname> <given-names>VM</given-names></name>, <name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <chapter-title>Nonlinear programming strategies for state estimation and model predictive control</chapter-title>. In: <source>Nonlinear model predictive control</source>. <publisher-name>Springer</publisher-name>; <year>2009</year>. p. <fpage>419</fpage>–<lpage>432</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref051">
<label>51</label>
<mixed-citation publication-type="other" xlink:type="simple">Bard Y. Nonlinear parameter estimation. 1974.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lopez</surname> <given-names>C</given-names></name> <name name-style="western"><surname>D</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wozny</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Flores-Tlacuahuac</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Vasquez-Medrano</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zavala</surname> <given-names>VM</given-names></name>. <article-title>A Computational Framework for Identifiability and Ill-Conditioning Analysis of Lithium-Ion Battery Models</article-title>. <source>Industrial &amp; Engineering Chemistry Research</source>. <year>2016</year>;<volume>55</volume>(<issue>11</issue>):<fpage>3026</fpage>–<lpage>3042</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/acs.iecr.5b03910" xlink:type="simple">10.1021/acs.iecr.5b03910</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McLean</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>McAuley</surname> <given-names>KB</given-names></name>. <article-title>Mathematical modelling of chemical processes–obtaining the best model predictions and parameter estimates using identifiability and estimability procedures</article-title>. <source>The Canadian Journal of Chemical Engineering</source>. <year>2012</year>;<volume>90</volume>(<issue>2</issue>):<fpage>351</fpage>–<lpage>366</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/cjce.20660" xlink:type="simple">10.1002/cjce.20660</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref054">
<label>54</label>
<mixed-citation publication-type="other" xlink:type="simple">Kang J, Chiang N, Laird CD, Zavala VM. Nonlinear programming strategies on high-performance computers. In: Decision and Control (CDC), 2015 IEEE 54th Annual Conference on. IEEE; 2015. p. 4612–4620.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Laird</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Zavala</surname> <given-names>VM</given-names></name>. <article-title>Clustering-based preconditioning for stochastic programs</article-title>. <source>Computational optimization and applications</source>. <year>2016</year>;<volume>64</volume>(<issue>2</issue>):<fpage>379</fpage>–<lpage>406</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10589-015-9813-x" xlink:type="simple">10.1007/s10589-015-9813-x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wan</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Eason</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Nicholson</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <article-title>Parallel cyclic reduction decomposition for dynamic optimization problems</article-title>. <source>Computers &amp; Chemical Engineering</source>. <year>2019</year>;<volume>120</volume>:<fpage>54</fpage>–<lpage>69</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.compchemeng.2017.09.023" xlink:type="simple">10.1016/j.compchemeng.2017.09.023</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Emerick</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Reynolds</surname> <given-names>AC</given-names></name>. <article-title>Investigation of the sampling performance of ensemble-based methods with a simple reservoir model</article-title>. <source>Computational Geosciences</source>. <year>2013</year>;<volume>17</volume>(<issue>2</issue>):<fpage>325</fpage>–<lpage>350</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10596-012-9333-z" xlink:type="simple">10.1007/s10596-012-9333-z</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref058">
<label>58</label>
<mixed-citation publication-type="other" xlink:type="simple">Gao G, Zafari M, Reynolds AC, et al. Quantifying uncertainty for the PUNQ-S3 problem in a Bayesian setting with RML and EnKF. In: SPE reservoir simulation symposium. Society of Petroleum Engineers; 2005.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dunning</surname> <given-names>Iain</given-names></name>, <name name-style="western"><surname>Huchette</surname> <given-names>Joey</given-names></name>, <name name-style="western"><surname>Lubin</surname> <given-names>Miles</given-names></name>. <article-title>JuMP: A modeling language for mathematical optimization</article-title>. <source>SIAM Review</source>. <year>2017</year>;<volume>59</volume>(<issue>2</issue>):<fpage>295</fpage>–<lpage>320</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1137/15M1020575" xlink:type="simple">10.1137/15M1020575</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jalving</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Abhyankar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hereld</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zavala</surname> <given-names>VM</given-names></name>. <article-title>A graph-based computational framework for simulation and optimisation of coupled infrastructure networks</article-title>. <source>IET Generation, Transmission &amp; Distribution</source>. <year>2017</year>;<volume>11</volume>(<issue>12</issue>):<fpage>3163</fpage>–<lpage>3176</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref061">
<label>61</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hart</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>Laird</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Watson</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Woodruff</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Hackebeil</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Nicholson</surname> <given-names>BL</given-names></name>, <etal>et al</etal>. <source>Pyomo–optimization modeling in python</source>. <volume>vol. 67</volume>. <edition>2nd ed</edition>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2017</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hart</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>Watson</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Woodruff</surname> <given-names>DL</given-names></name>. <article-title>Pyomo: modeling and solving mathematical programs in Python</article-title>. <source>Mathematical Programming Computation</source>. <year>2011</year>;<volume>3</volume>(<issue>3</issue>):<fpage>219</fpage>–<lpage>260</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s12532-011-0026-8" xlink:type="simple">10.1007/s12532-011-0026-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huttenhower</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gevers</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Abubucker</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Badger</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Chinwalla</surname> <given-names>AT</given-names></name>, <etal>et al</etal>. <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>207</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11234" xlink:type="simple">10.1038/nature11234</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tropini</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Earle</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>KC</given-names></name>, <name name-style="western"><surname>Sonnenburg</surname> <given-names>JL</given-names></name>. <article-title>The Gut microbiome: connecting spatial organization to function</article-title>. <source>Cell host &amp; microbe</source>. <year>2017</year>;<volume>21</volume>(<issue>4</issue>):<fpage>433</fpage>–<lpage>442</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chom.2017.03.010" xlink:type="simple">10.1016/j.chom.2017.03.010</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Earle</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Billings</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sigal</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lichtman</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Hansson</surname> <given-names>GC</given-names></name>, <name name-style="western"><surname>Elias</surname> <given-names>JE</given-names></name>, <etal>et al</etal>. <article-title>Quantitative imaging of gut microbiota spatial organization</article-title>. <source>Cell host &amp; microbe</source>. <year>2015</year>;<volume>18</volume>(<issue>4</issue>):<fpage>478</fpage>–<lpage>488</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chom.2015.09.002" xlink:type="simple">10.1016/j.chom.2015.09.002</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Venturelli</surname> <given-names>OS</given-names></name>, <name name-style="western"><surname>Carr</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Fisher</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hsu</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Lau</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bowen</surname> <given-names>BP</given-names></name>, <etal>et al</etal>. <article-title>Deciphering microbial interactions in synthetic human gut microbiome communities</article-title>. <source>Molecular Systems Biology</source>. <year>2018</year>;<volume>14</volume>(<issue>6</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.15252/msb.20178157" xlink:type="simple">10.15252/msb.20178157</ext-link></comment> <object-id pub-id-type="pmid">29930200</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lotka</surname> <given-names>AJ</given-names></name>. <article-title>Elements of physical biology</article-title>. <source>Science Progress in the Twentieth Century (1919-1933)</source>. <year>1926</year>;<volume>21</volume>(<issue>82</issue>):<fpage>341</fpage>–<lpage>343</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Volterra</surname> <given-names>V</given-names></name>. <article-title>Variations and fluctuations of the number of individuals in animal species living together</article-title>. <source>ICES Journal of Marine Science</source>. <year>1928</year>;<volume>3</volume>(<issue>1</issue>):<fpage>3</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/icesjms/3.1.3" xlink:type="simple">10.1093/icesjms/3.1.3</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stein</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Bucci</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Toussaint</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Buffie</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Rätsch</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Pamer</surname> <given-names>EG</given-names></name>, <etal>et al</etal>. <article-title>Ecological modeling from time-series inference: insight into dynamics and stability of intestinal microbiota</article-title>. <source>PLoS computational biology</source>. <year>2013</year>;<volume>9</volume>(<issue>12</issue>):<fpage>e1003388</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003388" xlink:type="simple">10.1371/journal.pcbi.1003388</ext-link></comment> <object-id pub-id-type="pmid">24348232</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref070">
<label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mounier</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Monnet</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Vallaeys</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Arditi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sarthou</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Hélias</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Microbial interactions within a cheese microbial community</article-title>. <source>Applied and environmental microbiology</source>. <year>2008</year>;<volume>74</volume>(<issue>1</issue>):<fpage>172</fpage>–<lpage>181</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/AEM.01338-07" xlink:type="simple">10.1128/AEM.01338-07</ext-link></comment> <object-id pub-id-type="pmid">17981942</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Widder</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Allen</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Pfeiffer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Curtis</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Wiuf</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sloan</surname> <given-names>WT</given-names></name>, <etal>et al</etal>. <article-title>Challenges in microbial ecology: building predictive understanding of community function and dynamics</article-title>. <source>The ISME journal</source>. <year>2016</year>;<volume>10</volume>(<issue>11</issue>):<fpage>2557</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ismej.2016.45" xlink:type="simple">10.1038/ismej.2016.45</ext-link></comment> <object-id pub-id-type="pmid">27022995</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Momeni</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Shou</surname> <given-names>W</given-names></name>. <article-title>Lotka-Volterra pairwise modeling fails to capture diverse pairwise microbial interactions</article-title>. <source>Elife</source>. <year>2017</year>;<volume>6</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.25051" xlink:type="simple">10.7554/eLife.25051</ext-link></comment> <object-id pub-id-type="pmid">28350295</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref073">
<label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thébault</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Fontaine</surname> <given-names>C</given-names></name>. <article-title>Stability of ecological communities and the architecture of mutualistic and trophic networks</article-title>. <source>Science</source>. <year>2010</year>;<volume>329</volume>(<issue>5993</issue>):<fpage>853</fpage>–<lpage>856</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1188321" xlink:type="simple">10.1126/science.1188321</ext-link></comment> <object-id pub-id-type="pmid">20705861</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stanford</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Lubitz</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Smallbone</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Klipp</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Mendes</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Liebermeister</surname> <given-names>W</given-names></name>. <article-title>Systematic construction of kinetic models from genome-scale metabolic networks</article-title>. <source>PloS one</source>. <year>2013</year>;<volume>8</volume>(<issue>11</issue>):<fpage>e79195</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0079195" xlink:type="simple">10.1371/journal.pone.0079195</ext-link></comment> <object-id pub-id-type="pmid">24324546</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref075">
<label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Karr</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Sanghvi</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>DN</given-names></name>, <name name-style="western"><surname>Gutschow</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Jacobs</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Bolival</surname> <given-names>B</given-names> <suffix>Jr</suffix></name>, <etal>et al</etal>. <article-title>A whole-cell computational model predicts phenotype from genotype</article-title>. <source>Cell</source>. <year>2012</year>;<volume>150</volume>(<issue>2</issue>):<fpage>389</fpage>–<lpage>401</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2012.05.044" xlink:type="simple">10.1016/j.cell.2012.05.044</ext-link></comment> <object-id pub-id-type="pmid">22817898</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref076">
<label>76</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macklin</surname> <given-names>DN</given-names></name>, <name name-style="western"><surname>Ruggero</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Covert</surname> <given-names>MW</given-names></name>. <article-title>The future of whole-cell modeling</article-title>. <source>Current opinion in biotechnology</source>. <year>2014</year>;<volume>28</volume>:<fpage>111</fpage>–<lpage>115</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.copbio.2014.01.012" xlink:type="simple">10.1016/j.copbio.2014.01.012</ext-link></comment> <object-id pub-id-type="pmid">24556244</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref077">
<label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weiße</surname> <given-names>AY</given-names></name>, <name name-style="western"><surname>Oyarzún</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Danos</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Swain</surname> <given-names>PS</given-names></name>. <article-title>Mechanistic links between cellular trade-offs, gene expression, and growth</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2015</year>; p. 201416533.</mixed-citation>
</ref>
<ref id="pcbi.1006828.ref078">
<label>78</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raghunathan</surname> <given-names>AU</given-names></name>, <name name-style="western"><surname>Pérez-Correa</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Agosin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Biegler</surname> <given-names>LT</given-names></name>. <article-title>Parameter estimation in metabolic flux balance models for batch fermentation–Formulation &amp; Solution using Differential Variational Inequalities (DVIs)</article-title>. <source>Annals of Operations Research</source>. <year>2006</year>;<volume>148</volume>(<issue>1</issue>):<fpage>251</fpage>–<lpage>270</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10479-006-0086-8" xlink:type="simple">10.1007/s10479-006-0086-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref079">
<label>79</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Srivastava</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Rawlings</surname> <given-names>JB</given-names></name>. <article-title>Comparison of finite difference based methods to obtain sensitivities of stochastic chemical kinetic models</article-title>. <source>The Journal of chemical physics</source>. <year>2013</year>;<volume>138</volume>(<issue>7</issue>):<fpage>074110</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.4790650" xlink:type="simple">10.1063/1.4790650</ext-link></comment> <object-id pub-id-type="pmid">23445000</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref080">
<label>80</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hucka</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Finney</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sauro</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Bolouri</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Doyle</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Kitano</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>The systems biology markup language (SBML): a medium for representation and exchange of biochemical network models</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>4</issue>):<fpage>524</fpage>–<lpage>531</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btg015" xlink:type="simple">10.1093/bioinformatics/btg015</ext-link></comment> <object-id pub-id-type="pmid">12611808</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006828.ref081">
<label>81</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lloyd</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Halstead</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>PF</given-names></name>. <article-title>CellML: its future, present and past</article-title>. <source>Progress in biophysics and molecular biology</source>. <year>2004</year>;<volume>85</volume>(<issue>2-3</issue>):<fpage>433</fpage>–<lpage>450</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.pbiomolbio.2004.01.004" xlink:type="simple">10.1016/j.pbiomolbio.2004.01.004</ext-link></comment> <object-id pub-id-type="pmid">15142756</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>