<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01048</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006898</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Parasitic diseases</subject><subj-group><subject>Malaria</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Tropical diseases</subject><subj-group><subject>Malaria</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Parasitic diseases</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Protozoans</subject><subj-group><subject>Parasitic protozoans</subject><subj-group><subject>Malarial parasites</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Artificial gene amplification and extension</subject><subj-group><subject>Polymerase chain reaction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Artificial gene amplification and extension</subject><subj-group><subject>Polymerase chain reaction</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Parasitology</subject><subj-group><subject>Parasite groups</subject><subj-group><subject>Apicomplexa</subject><subj-group><subject>Plasmodium</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Population ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Population ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Disease ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Disease ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject><subj-group><subject>Disease ecology</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Bayes-optimal estimation of overlap between populations of fixed size</article-title>
<alt-title alt-title-type="running-head">Bayes-optimal estimation of overlap between populations of fixed size</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5273-5234</contrib-id>
<name name-style="western">
<surname>Larremore</surname> <given-names>Daniel B.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Computer Science, University of Colorado Boulder, Boulder, Colorado, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>BioFrontiers Institute, University of Colorado Boulder, Boulder, Colorado, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Pascual</surname> <given-names>Mercedes</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Chicago, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The author has declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">daniel.larremore@colorado.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>29</day>
<month>3</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>3</issue>
<elocation-id>e1006898</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>6</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>2</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Daniel B. Larremore</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006898"/>
<abstract>
<p>Measuring the overlap between two populations is, in principle, straightforward. Upon fully sampling both populations, the number of shared objects—species, taxonomical units, or gene variants, depending on the context—can be directly counted. In practice, however, only a fraction of each population’s objects are likely to be sampled due to stochastic data collection or sequencing techniques. Although methods exists for quantifying population overlap under subsampled conditions, their bias is well documented and the uncertainty of their estimates cannot be quantified. Here we derive and validate a method to rigorously estimate the population overlap from incomplete samples when the total number of objects, species, or genes in each population is known, a special case of the more general <italic>β</italic>-diversity problem that is particularly relevant in the ecology and genomic epidemiology of malaria. By solving a Bayesian inference problem, this method takes into account the rates of subsampling and produces unbiased and Bayes-optimal estimates of overlap. In addition, it provides a natural framework for computing the uncertainty of its estimates, and can be used prospectively in study planning by quantifying the tradeoff between sampling effort and uncertainty.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Understanding when two populations are composed of similar species is important for ecologists, epidemiologists, and population geneticists, and in principle it is easy: just sample the two populations, compare the sets of species identified in each, and count how many appear in both populations. In practice, however, this is difficult because sampling methods typically produce only a random subset of the total population, leaving current population overlap estimates biased. Knowing only the number of shared members between two of these partial population samples, this paper shows how we can nevertheless estimate the true overlap between the full populations, when those full populations’ sizes are known. Using Bayesian statistics, we can also compute credible intervals to produce error bars. We show that using this unbiased approach has a dramatic impact on the conclusions one might draw from previously published studies in the malaria literature, which used simple but biased methods. Because the method in this paper quantifies the tradeoff between sampling effort and uncertainty, we also show how to compute the number of samples required to ensure high-confidence results, which may be useful for planning future studies or budgeting lab reagents and time.</p>
</abstract>
<funding-group>
<funding-statement>The author received support from the Ruth and Sidney Weiss Fund. The funders had no role in study design, data analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="0"/>
<page-count count="17"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All data (processed from previous studies) and new code are available in an open github repository (<ext-link ext-link-type="uri" xlink:href="http://github.com/dblarremore/BayesianRepertoireOverlap/" xlink:type="simple">http://github.com/dblarremore/BayesianRepertoireOverlap/</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLoS Computational Biology</italic> Methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Quantifying the similarity between two populations, environments, or ecosystems, based on their constituent members or species, is a fundamental problem in ecology. Some methods quantify this pairwise similarity, often called <italic>β</italic>-diversity [<xref ref-type="bibr" rid="pcbi.1006898.ref001">1</xref>], based on only the presence or absence of species [<xref ref-type="bibr" rid="pcbi.1006898.ref002">2</xref>], while other methods take into account species abundance as well [<xref ref-type="bibr" rid="pcbi.1006898.ref003">3</xref>]. Still other methods, more common in microbial ecology, make use of genetic sequence data, measuring similarities through phylogenetic relationships [<xref ref-type="bibr" rid="pcbi.1006898.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1006898.ref006">6</xref>]. In practical applications of all three types of methods, the populations being compared are almost always undersampled, meaning that estimators which are principled in the context of perfect sampling show substantial bias in practice [<xref ref-type="bibr" rid="pcbi.1006898.ref007">7</xref>].</p>
<p>Consider, as an example of estimator bias, the oldest of pairwise similarity measures, which have roots in botany with Jaccard, Dice, and Sørenson. Their 1901 [<xref ref-type="bibr" rid="pcbi.1006898.ref008">8</xref>] and 1940s [<xref ref-type="bibr" rid="pcbi.1006898.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref010">10</xref>] publications introduced the eponymous Jaccard index and Sørenson-Dice coefficient. Both are simple ratios involving the number of distinct species observed in each population, <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>b</italic></sub>, and the number of species shared by both populations, <italic>n</italic><sub><italic>ab</italic></sub>, so that each measure quantifies overlap as a fraction,
<disp-formula id="pcbi.1006898.e001"><alternatives><graphic id="pcbi.1006898.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˚</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mspace width="4pt"/><mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mstyle> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
Intuitively, when the two populations are identical, both <inline-formula id="pcbi.1006898.e002"><alternatives><graphic id="pcbi.1006898.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006898.e003"><alternatives><graphic id="pcbi.1006898.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are one, and when two populations are entirely distinct, both are zero. However, imagine two populations of 10 species each in which 5 species are found in both populations. With perfect sampling, <inline-formula id="pcbi.1006898.e004"><alternatives><graphic id="pcbi.1006898.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˚</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006898.e005"><alternatives><graphic id="pcbi.1006898.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, but when only 9 of 10 species are drawn from each population, these indices, computed with empirically observed values, average <inline-formula id="pcbi.1006898.e006"><alternatives><graphic id="pcbi.1006898.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˚</mml:mo></mml:mover> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>29</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006898.e007"><alternatives><graphic id="pcbi.1006898.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>45</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, representing relative biases of −12% and −10% respectively. These biases, which are well documented [<xref ref-type="bibr" rid="pcbi.1006898.ref007">7</xref>], become worse as sampling rates fall.</p>
<p>Bias is not unique to the Jaccard and Sørenson-Dice coefficients, but instead affects all algebraic combinations of <italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub>, and <italic>n</italic><sub><italic>ab</italic></sub>, of which over 20 have been proposed [<xref ref-type="bibr" rid="pcbi.1006898.ref002">2</xref>]. This is due to the fact that observed values of <italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub>, and <italic>n</italic><sub><italic>ab</italic></sub> are realizations of random variables, and in particular, <italic>n</italic><sub><italic>ab</italic></sub> necessarily shows a nonlinear dependence on <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>b</italic></sub>. As a consequence, guides to navigating the multiple measures of <italic>β</italic> diversity—including both presence/absence and abundance measures—emphasize matching of estimators’ principles and the scientific questions they are meant to answer [<xref ref-type="bibr" rid="pcbi.1006898.ref011">11</xref>], but do not address underlying bias, variation, or uncertainty itself.</p>
<p>Progress toward unbiased estimators has been made, however. If estimators account for not just the presence or absence of species, but their abundance as well, they can be adjusted based on the effects of both observed and <italic>unobserved</italic> species. Chao et al. took a probabilistic view of such adjustments based on the underlying sampling process, resulting in modified Jaccard and Sørenson-Dice coefficients with substantially reduced bias [<xref ref-type="bibr" rid="pcbi.1006898.ref007">7</xref>]. Other successful approaches directly model the sampling process itself. For instance, Kery and Royle introduced a hierarchical Bayes approach to species-richness estimation by posing a spatial sampling process and using it to improve richness estimates [<xref ref-type="bibr" rid="pcbi.1006898.ref012">12</xref>]. Importantly, this Bayesian approach allowed them to quantify uncertainty in their estimates via credible intervals. Outside of ecology entirely, the estimation of overlap between sets arises in large-data scenarios, e.g. when comparing two individuals’ sets of interests or friends on Facebook using streaming algorithms in distributed settings [<xref ref-type="bibr" rid="pcbi.1006898.ref013">13</xref>]. These approaches show that better estimates are possible when the presence of uncertainty due to stochastic sampling is addressed directly, even when much about the underlying populations is unknown.</p>
<p>Here, we solve a special case of the more general pairwise similarity problem described above—one which is particularly relevant to the genomic epidemiology and disease ecology of <italic>Plasmodium falciparum</italic>, the most virulent of the human malaria parasites. Rather than comparing two ecosystems based on their shared species, we consider the problem of comparing two genomic repertoires based on their shared gene variants. Mathematically, the problems are similar but with one important difference: when estimating genomic repertoire overlap, the total number of variants per genome is known. This additional specification opens the door to unbiased and Bayes-optimal estimation of true repertoire overlap, given a single noisy measurement of <italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub>, and <italic>n</italic><sub><italic>ab</italic></sub>, while also quantifying the increased uncertainty inherent in decreased sampling.</p>
<sec id="sec002">
<title>The <italic>P</italic>. <italic>falciparum</italic> repertoire overlap problem</title>
<p>Of the diverse multigene families of <italic>P</italic>. <italic>falciparum</italic>, the <italic>var</italic> family is the most heavily studied because of its direct links to both malaria’s duration of infection and its virulence [<xref ref-type="bibr" rid="pcbi.1006898.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1006898.ref017">17</xref>]. Each parasite genome contains a repertoire of ∼ 60 hypervariable and mutually distinct <italic>var</italic> genes, but repertoires differ between parasites, evolving rapidly through recombination and reassortment. Recent studies of <italic>P</italic>. <italic>falciparum</italic> epidemiology and evolution have generated insights by comparing of the sets of genomic <italic>var</italic> repertoires between parasites [<xref ref-type="bibr" rid="pcbi.1006898.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1006898.ref023">23</xref>]. Indeed, since <italic>var</italic> repertoires are, themselves, under selection, theory suggests that if a human population has been exposed to particular <italic>var</italic> genes, then repertoires containing those <italic>var</italic> genes will have a lower fitness than repertoires that are entirely unrecognized by local hosts, shaping the <italic>var</italic> population structure [<xref ref-type="bibr" rid="pcbi.1006898.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref025">25</xref>]. Methods by which we estimate the extent to which <italic>var</italic> repertoires overlap are therefore important, particularly as studies of the population genetics and genetic epidemiology of malaria’s antigens become more sophisticated and data rich. However, as with estimates of <italic>β</italic>-diversity in ecology, traditional estimates of overlap between <italic>var</italic> repertoires also suffer bias due to subsampling.</p>
<p>Due to the massive diversity and recombinant structure of <italic>var</italic> genes, researchers are restricted to using degenerate PCR primers targeting a small “tag” sequence within a particular <italic>var</italic> domain called DBL<italic>α</italic> [<xref ref-type="bibr" rid="pcbi.1006898.ref026">26</xref>]. Due to their experimental accessibility, DBL<italic>α</italic> tags have been widely used to study the structure and function of <italic>var</italic> genes [<xref ref-type="bibr" rid="pcbi.1006898.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1006898.ref030">30</xref>]. Still, these PCR techniques generate a random sample of 60 or fewer unique tag sequences from each parasite. This means that experimental measurements of repertoire overlap are performed using stochastic subsamples whose <italic>empirical</italic> overlap may fluctuate from experiment to experiment (<xref ref-type="fig" rid="pcbi.1006898.g001">Fig 1</xref>), motivating the three questions answered by this paper: First, how can we estimate the true overlap between repertoires when we can only measure the overlap between samples from repertoires? Second, how can we quantify the uncertainty around our repertoire overlap estimates? Third, what are the implications of uncertainty for the design and budgeting of <italic>var</italic> repertoire studies?</p>
<fig id="pcbi.1006898.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006898.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Stochastic sampling leads to variation in observed overlap.</title>
<p>The members of two hypothetical populations are represented by blue and green circles, respectively. Each population has 16 members, and <italic>s</italic> = 5 are shared members of both populations. In two independent sampling experiments, shown in top and bottom rows, <italic>n</italic><sub><italic>a</italic></sub> = <italic>n</italic><sub><italic>b</italic></sub> = 8 members are sampled at random from each population (dark circles) while the other 8 members are not sampled (transparent circles). Observation of the first experiment finds an overlap of <italic>n</italic><sub><italic>ab</italic></sub> = 4, while observation of the second finds <italic>n</italic><sub><italic>ab</italic></sub> = 0.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006898.g001" xlink:type="simple"/>
</fig>
<p>In the malaria literature, repertoire overlap is most commonly computed using the Sørenson-Dice coefficient where it is often called <italic>pairwise type sharing</italic> [<xref ref-type="bibr" rid="pcbi.1006898.ref018">18</xref>]. When PCR methods have produced <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>b</italic></sub> tags from parasites <italic>a</italic> and <italic>b</italic>, respectively, and when a sequence-level comparison has found <italic>n</italic><sub><italic>ab</italic></sub> tags are shared by both repertoires then repertoire similarity is computed using the coefficient <inline-formula id="pcbi.1006898.e008"><alternatives><graphic id="pcbi.1006898.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1006898.e001">Eq (1)</xref>. When <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>b</italic></sub> are nearly 60, the performance of <inline-formula id="pcbi.1006898.e009"><alternatives><graphic id="pcbi.1006898.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is excellent. For instance, when two parasites are completely different, <italic>n</italic><sub><italic>ab</italic></sub> = 0, so <inline-formula id="pcbi.1006898.e010"><alternatives><graphic id="pcbi.1006898.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>; when two parasites are identical, and both repertoires have been fully sampled, <italic>n</italic><sub><italic>ab</italic></sub> = <italic>n</italic><sub><italic>a</italic></sub> = <italic>n</italic><sub><italic>b</italic></sub>, so <inline-formula id="pcbi.1006898.e011"><alternatives><graphic id="pcbi.1006898.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. However, when <italic>n</italic><sub><italic>a</italic></sub> or <italic>n</italic><sub><italic>b</italic></sub> is smaller (as is overwhelmingly the case in existing studies [<xref ref-type="bibr" rid="pcbi.1006898.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1006898.ref023">23</xref>]) <inline-formula id="pcbi.1006898.e012"><alternatives><graphic id="pcbi.1006898.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is conservative and systematically underestimates the true overlap between repertoires [<xref ref-type="bibr" rid="pcbi.1006898.ref007">7</xref>].</p>
</sec>
<sec id="sec003">
<title>Organization</title>
<p>In this manuscript, I introduce a method that estimates repertoire overlap using Bayesian inference. By modeling the stochastic process by which repertoires are sampled, I show that this method produces unbiased <italic>a posteriori</italic> estimates of true repertoire overlap. I then show how the Bayesian framework can be used to estimate uncertainty and produce error bars which represent credible intervals, a Bayesian analog of confidence intervals. These methods are then used to reevaluate past results which used the Sørenson-Dice coefficient <inline-formula id="pcbi.1006898.e013"><alternatives><graphic id="pcbi.1006898.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Finally, in the case of <italic>P</italic>. <italic>falciparum</italic>, since each successful PCR amplification randomly samples just one of 60 available tags, I extend the Bayesian approach to compute the tradeoff between increasing sampling and decreasing the uncertainty of overlap estimates. These calculations allow the cost of sampling to be weighed against scientific confidence, illustrating the use of this statistical framework for planning and budgeting experiments. Open-source code and a web tool are freely available (see Acknowledgements).</p>
</sec>
</sec>
<sec id="sec004" sec-type="materials|methods">
<title>Methods</title>
<p>Suppose that there are two <italic>P</italic>. <italic>falciparum</italic> parasites, each with a repertoire of 60 <italic>var</italic> types. Our goal is to estimate the true repertoire overlap <italic>s</italic> (were we to fully sample each parasite) from the knowledge that <italic>n</italic><sub><italic>a</italic></sub> samples from parasite <italic>a</italic> and <italic>n</italic><sub><italic>b</italic></sub> samples from parasite <italic>b</italic> share <italic>n</italic><sub><italic>ab</italic></sub> types. Due to the fact that the underlying sampling process is stochastic (<xref ref-type="fig" rid="pcbi.1006898.g001">Fig 1</xref>), our secondary goal is to quantify the uncertainty in the method’s estimates. Both goals can be met by writing down the process that creates the data in the first place. Therefore, in what follows, we will at first assume that the true overlap <italic>s</italic> is fixed, model the process of generating data via stochastic sampling, and use that model to compute a likelihood. We will then use Bayes’ Rule to compute the posterior probability for each value of <italic>s</italic>, given the evidence in the data and the likelihood computed in the first step.</p>
<p>Consider the following sampling process, written in the slightly more rigid and generic language of a probability textbook. Suppose that there are <italic>s</italic> special objects among a total of <italic>N</italic> objects. We draw <italic>n</italic> objects uniformly at random without replacement. The number of special objects chosen during this sampling procedure will be distributed according to a hypergeometric distribution, which we write as <inline-formula id="pcbi.1006898.e014"><alternatives><graphic id="pcbi.1006898.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mi mathvariant="script">H</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>First, with this definition in mind, consider drawing <italic>n</italic><sub><italic>a</italic></sub> <italic>var</italic> genes from parasite <italic>a</italic>’s 60 total. Of the 60 total, suppose that exactly <italic>s</italic> are considered special because they are also shared by parasite <italic>b</italic>. The number of shared sequences that are captured by sequencing parasite <italic>a</italic> will be a random variable <inline-formula id="pcbi.1006898.e015"><alternatives><graphic id="pcbi.1006898.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mn>60</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Depending on the luck of the draw, this number could be as small as zero, or as high as <italic>s</italic> or <italic>n</italic><sub><italic>a</italic></sub> (whichever is smaller).</p>
<p>Now consider drawing <italic>n</italic><sub><italic>b</italic></sub> <italic>var</italic> genes from parasite <italic>b</italic>’s 60 total, in which exactly <italic>s</italic><sub><italic>a</italic></sub> are special because they are shared by both parasites <italic>and</italic> were actually drawn during the sequencing of parasite <italic>a</italic>. This process is identical in construction to the process for sampling parasite <italic>a</italic>, but with <italic>s</italic><sub><italic>a</italic></sub> special sequences instead of <italic>s</italic>, and so the number of shared sequences that are captured after sequencing both parasites will be <inline-formula id="pcbi.1006898.e016"><alternatives><graphic id="pcbi.1006898.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:mi mathvariant="script">H</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mn>60</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Substituting the random variable <italic>S</italic><sub><italic>a</italic></sub> for a fixed value <italic>s</italic><sub><italic>a</italic></sub>, which we derived in the paragraph above, yields a hypergeometric inside a hypergeometric, which means that the probability of a particular number of shared sequences in the samples <italic>n</italic><sub><italic>ab</italic></sub> is given by these sequential (or nested) hypergeometric distributions,
<disp-formula id="pcbi.1006898.e017"><alternatives><graphic id="pcbi.1006898.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">H</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mn>60</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mn>60</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
Reassuringly, one can switch the order in which the imagined sampling took place, first sequencing parasite <italic>b</italic> and then sequencing parasite <italic>a</italic>, or sequencing them both at once, and show that these are mathematically equivalent.</p>
<p>In practice, we want to go the other direction, and estimate <italic>s</italic> from our empirical measurements of <italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub>, and <italic>n</italic><sub><italic>ab</italic></sub>. Since the distributions above allow us to compute the likelihood of empirical observations, given <italic>s</italic>, we use Bayes’ rule to formulate the posterior distribution for <italic>s</italic>,
<disp-formula id="pcbi.1006898.e018"><alternatives><graphic id="pcbi.1006898.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>P</italic>(<italic>s</italic>) is the prior distribution for overlap. In practice, we generally wish to remain agnostic about the level of overlap <italic>s</italic> and therefore we consider an uninformative prior <italic>P</italic>(<italic>s</italic>) ∼ unif[0, 60], i.e. <inline-formula id="pcbi.1006898.e019"><alternatives><graphic id="pcbi.1006898.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="false" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>61</mml:mn></mml:mfrac></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula>. Using the law of total probability to rewrite the denominator, and canceling the factors of <inline-formula id="pcbi.1006898.e020"><alternatives><graphic id="pcbi.1006898.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>61</mml:mn></mml:mfrac></mml:mstyle></mml:math></alternatives></inline-formula>, we get
<disp-formula id="pcbi.1006898.e021"><alternatives><graphic id="pcbi.1006898.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>60</mml:mn></mml:msubsup> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>Each term on the right hand side of <xref ref-type="disp-formula" rid="pcbi.1006898.e021">Eq (4)</xref> can now be computed directly from the nested hypergeometric distributions in <xref ref-type="disp-formula" rid="pcbi.1006898.e017">Eq (2)</xref> as follows. To generate a specific empirical overlap <italic>n</italic><sub><italic>ab</italic></sub>, two things must have happened in succession and independently of each other: first, <italic>s</italic><sub><italic>a</italic></sub> of the original <italic>s</italic> shared sequences must have been sampled; and second, <italic>n</italic><sub><italic>ab</italic></sub> of the intermediate <italic>s</italic><sub><italic>a</italic></sub> shared sequences must then have been sampled. We therefore multiply these two hypergeometric probabilities. However, because this sequential process may occur for any value of the intermediate variable <italic>s</italic><sub><italic>a</italic></sub>, we sum over all possible values of <italic>s</italic><sub><italic>a</italic></sub>,
<disp-formula id="pcbi.1006898.e022"><alternatives><graphic id="pcbi.1006898.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>60</mml:mn></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
Thus, computing the posterior probability that the true overlap was <italic>s</italic>, given the empirical overlap between samples, is given by substituting <xref ref-type="disp-formula" rid="pcbi.1006898.e022">Eq (5)</xref> into <xref ref-type="disp-formula" rid="pcbi.1006898.e021">Eq (4)</xref>, yielding
<disp-formula id="pcbi.1006898.e023"><alternatives><graphic id="pcbi.1006898.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>60</mml:mn></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>60</mml:mn></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>60</mml:mn></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mfrac> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
The term <italic>P</italic>(<italic>s</italic> ∣ <italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub>, <italic>n</italic><sub><italic>ab</italic></sub>) is a posterior distribution over <italic>s</italic>, meaning that it tells us the probability for each value of <italic>s</italic>, given the evidence provided by the actual data. While this equation appears notation-heavy, its inference requires only calls to the hypergeometric probability distribution. To illustrate this graphically, the posterior distribution is plotted for <italic>n</italic><sub><italic>a</italic></sub> = 47, <italic>n</italic><sub><italic>b</italic></sub> = 32, and <italic>n</italic><sub><italic>ab</italic></sub> = 20 in <xref ref-type="fig" rid="pcbi.1006898.g002">Fig 2</xref>.</p>
<fig id="pcbi.1006898.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006898.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Inference and uncertainty using the posterior.</title>
<p>The posterior distribution over <italic>s</italic> is plotted for the realistic scenario of <italic>n</italic><sub><italic>a</italic></sub> = 47, <italic>n</italic><sub><italic>b</italic></sub> = 32, and <italic>n</italic><sub><italic>ab</italic></sub> = 20 [line; <xref ref-type="disp-formula" rid="pcbi.1006898.e023">Eq (6)</xref>]. The posterior mean provides our estimate of the true overlap <inline-formula id="pcbi.1006898.e024"><alternatives><graphic id="pcbi.1006898.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> [open circle; <xref ref-type="disp-formula" rid="pcbi.1006898.e028">Eq (7)</xref>], and the interval accounting for at least 90% of the area under the posterior curve provides an equal-tailed 90% credible interval [shading; <xref ref-type="disp-formula" rid="pcbi.1006898.e035">Eq (8)</xref>]. The <inline-formula id="pcbi.1006898.e025"><alternatives><graphic id="pcbi.1006898.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> estimate is shown for comparison [black cross; <xref ref-type="disp-formula" rid="pcbi.1006898.e001">Eq (1)</xref>], and is typically less than or equal to <inline-formula id="pcbi.1006898.e026"><alternatives><graphic id="pcbi.1006898.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006898.g002" xlink:type="simple"/>
</fig>
<p>The posterior distribution can now be used (i) to estimate the true value of <italic>s</italic>, and (ii) to quantify the uncertainty of that estimate. First, our estimate for the true value of <italic>s</italic>, which we call <inline-formula id="pcbi.1006898.e027"><alternatives><graphic id="pcbi.1006898.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, is the expected value of the posterior,
<disp-formula id="pcbi.1006898.e028"><alternatives><graphic id="pcbi.1006898.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>60</mml:mn></mml:munderover> <mml:mi>s</mml:mi> <mml:mspace width="4pt"/><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
This value is typically (in 99.85% of all possible cases) larger than the estimate provided by <inline-formula id="pcbi.1006898.e029"><alternatives><graphic id="pcbi.1006898.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1006898.g002">Fig 2</xref>).</p>
<p>The framework here is easily extended to repertoire sizes other than 60, generalizing to applications beyond <italic>var</italic> genes. Suppose that populations <italic>a</italic> and <italic>b</italic> have total sizes of <italic>N</italic><sub><italic>a</italic></sub> and <italic>N</italic><sub><italic>b</italic></sub>, and without loss of generality, assume that <italic>N</italic><sub><italic>a</italic></sub> ≤ <italic>N</italic><sub><italic>b</italic></sub>. The values <italic>N</italic><sub><italic>a</italic></sub> and <italic>N</italic><sub><italic>b</italic></sub> need only be substituted into Eqs (<xref ref-type="disp-formula" rid="pcbi.1006898.e023">6</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1006898.e028">7</xref>), with <inline-formula id="pcbi.1006898.e030"><alternatives><graphic id="pcbi.1006898.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. This is done explicitly in Eqs. (1) and (2) in <xref ref-type="supplementary-material" rid="pcbi.1006898.s002">S1 Text</xref>, but not shown here for conciseness (see <xref ref-type="supplementary-material" rid="pcbi.1006898.s002">S1 Text</xref>).</p>
<p>The posterior distribution provides a convenient way to quantify the uncertainty associated with an estimate <inline-formula id="pcbi.1006898.e031"><alternatives><graphic id="pcbi.1006898.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Intuitively, if the posterior is sharply peaked around <inline-formula id="pcbi.1006898.e032"><alternatives><graphic id="pcbi.1006898.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, then our confidence in <inline-formula id="pcbi.1006898.e033"><alternatives><graphic id="pcbi.1006898.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is high; if the posterior is broadly distributed then our confidence in <inline-formula id="pcbi.1006898.e034"><alternatives><graphic id="pcbi.1006898.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is low. Making use of the Bayesian construction once more, we compute a credible interval by finding the range of <italic>s</italic> values that account for 90% of the posterior probability (<xref ref-type="fig" rid="pcbi.1006898.g002">Fig 2</xref>). Due to the fact that the posterior distribution is a discrete distribution over only 61 values, it is possible (indeed, highly probable) that no interval will contain exactly 90% of the probability. Nevertheless, we define a conservative equal-tailed 90% credible interval [<italic>s</italic><sub>min</sub>, <italic>s</italic><sub>max</sub>] as the smallest index <italic>s</italic><sub>min</sub> and the largest index <italic>s</italic><sub>max</sub> for which
<disp-formula id="pcbi.1006898.e035"><alternatives><graphic id="pcbi.1006898.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mtext>max</mml:mtext></mml:msub></mml:mrow> <mml:mn>60</mml:mn></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mtext>min</mml:mtext></mml:msub></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula></p>
</sec>
<sec id="sec005" sec-type="results">
<title>Results</title>
<sec id="sec006">
<title>Estimator performance</title>
<p>We first demonstrate that the <inline-formula id="pcbi.1006898.e036"><alternatives><graphic id="pcbi.1006898.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> computed in <xref ref-type="disp-formula" rid="pcbi.1006898.e028">Eq (7)</xref> produces accurate estimates by simulating the sampling process with known <italic>s</italic> and evaluating our ability to accurately recover it. Specifically, for each simulation, we consider two <italic>var</italic> repertoires <italic>a</italic> and <italic>b</italic>, of 60 genes each, and specify a priori that they share exactly <italic>s</italic> sequences. We then choose the number of samples taken from each, <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>b</italic></sub> respectively, and draw from each repertoire uniformly at random, without replacement. These draws are compared to compute the number of empirically shared sequences <italic>n</italic><sub><italic>ab</italic></sub>. <xref ref-type="disp-formula" rid="pcbi.1006898.e028">Eq (7)</xref> is used to compute the Bayesian repertoire overlap (BRO) estimate <inline-formula id="pcbi.1006898.e037"><alternatives><graphic id="pcbi.1006898.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, while <xref ref-type="disp-formula" rid="pcbi.1006898.e001">Eq (1)</xref> is used to compute <inline-formula id="pcbi.1006898.e038"><alternatives><graphic id="pcbi.1006898.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> using the same data. These estimates are then compared to the true value of <italic>s</italic> to evaluate accuracy. Varying the values of <italic>s</italic>, <italic>n</italic><sub><italic>a</italic></sub>, and <italic>n</italic><sub><italic>b</italic></sub> allows us to quantify the performance of BRO and <inline-formula id="pcbi.1006898.e039"><alternatives><graphic id="pcbi.1006898.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in a variety of realistic sampling scenarios.</p>
<p>
<xref ref-type="fig" rid="pcbi.1006898.g003">Fig 3</xref> shows the results of this simulation for sampling rates of 30, 40, and 50 genes, with two independent simulations at each value of <italic>s</italic>. Intuitively, both BRO and <inline-formula id="pcbi.1006898.e040"><alternatives><graphic id="pcbi.1006898.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are more accurate when <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>b</italic></sub> are larger. However, the two methods’ behaviors are fundamentally different. When <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>b</italic></sub> are below 60, BRO provides estimates that are distributed around the true overlap, with variance decreasing as sampling rates increase. In contrast, <inline-formula id="pcbi.1006898.e041"><alternatives><graphic id="pcbi.1006898.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> systematically underestimates the true overlap, while also showing decreasing variance as sampling rates increase [<xref ref-type="bibr" rid="pcbi.1006898.ref007">7</xref>]. For realistic sampling rates, BRO provides estimates centered at the true value, while <inline-formula id="pcbi.1006898.e042"><alternatives><graphic id="pcbi.1006898.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> provides estimates centered below the true value. These general patterns hold even when <italic>n</italic><sub><italic>a</italic></sub> ≠ <italic>n</italic><sub><italic>b</italic></sub> or when total repertoire sizes are unequal (<xref ref-type="supplementary-material" rid="pcbi.1006898.s001">S1 Fig</xref>).</p>
<fig id="pcbi.1006898.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006898.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Bayesian repertoire overlap consistently estimates true overlap.</title>
<p>Repertoires with true overlaps ranging from 0 to 60 were subsampled in simulations. As sampling rates increase from <italic>n</italic><sub><italic>a</italic></sub> = <italic>n</italic><sub><italic>b</italic></sub> = 30 (left) to 40 (middle) and to 50 (right), the estimates of BRO (colored circles) approach the true values (dotted lines) symmetrically. Estimates from <inline-formula id="pcbi.1006898.e043"><alternatives><graphic id="pcbi.1006898.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (crosses) approach the true values from below, systematically underestimating the true overlap. This bias is worse with lower sampling rates [<xref ref-type="bibr" rid="pcbi.1006898.ref007">7</xref>]. Similar results are found when <italic>n</italic><sub><italic>a</italic></sub> ≠ <italic>n</italic><sub><italic>b</italic></sub>, and when the total repertoire sizes are different from each other (<xref ref-type="supplementary-material" rid="pcbi.1006898.s001">S1 Fig</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006898.g003" xlink:type="simple"/>
</fig>
<p>Credible intervals, which visually show uncertainty in each estimate, can also be easily computed from the simulations described above. For each simulation, <xref ref-type="disp-formula" rid="pcbi.1006898.e035">Eq (8)</xref> uses the posterior distribution over <italic>s</italic> to produce error bars around the point estimate <inline-formula id="pcbi.1006898.e044"><alternatives><graphic id="pcbi.1006898.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, shown for sampling rates of 30, 40, and 50 in <xref ref-type="fig" rid="pcbi.1006898.g004">Fig 4</xref>. This illustrates the substantial reduction in uncertainty that comes with increased sampling rates. While all simulations shown here use <italic>n</italic><sub><italic>a</italic></sub> = <italic>n</italic><sub><italic>b</italic></sub>, this is by no means required (<xref ref-type="supplementary-material" rid="pcbi.1006898.s001">S1 Fig</xref>), and in real data scenarios, is rare.</p>
<fig id="pcbi.1006898.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006898.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Credible intervals quantify uncertainty in overlap estimates.</title>
<p>By using <xref ref-type="disp-formula" rid="pcbi.1006898.e035">Eq (8)</xref>, 90% credible intervals are show above as error bars around the point estimates <inline-formula id="pcbi.1006898.e045"><alternatives><graphic id="pcbi.1006898.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> for varying true overlap <italic>s</italic>. As sampling rate increases from <italic>n</italic><sub><italic>a</italic></sub> = <italic>n</italic><sub><italic>b</italic></sub> = 30 (left) to 40 (middle) and to 50 (right), credible intervals shrink, indicating a reduction in uncertainty. In expectation, 90% of intervals cover the true overlap (dotted line).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006898.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec007">
<title>Revisiting past results</title>
<p>We now show how the methods of this paper can be used in practical contexts by applying them to data from three published studies. In particular, this reanalysis highlights the impact of variation in sampling rates across studies, which creates variable bias in <inline-formula id="pcbi.1006898.e046"><alternatives><graphic id="pcbi.1006898.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> calculations and produces misleading results. However, we also show that while using BRO in place of <inline-formula id="pcbi.1006898.e047"><alternatives><graphic id="pcbi.1006898.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> sidesteps bias problems, the ability to quantify uncertainty with error bars highlights new problems. In short, the conclusions of previous studies may be worth reevaluating.</p>
<p>In 2007, Barry et al. introduced <inline-formula id="pcbi.1006898.e048"><alternatives><graphic id="pcbi.1006898.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, which they referred to as <italic>pairwise type sharing</italic>, in an analysis of <italic>var</italic> data from Amele, Papua New Guinea [<xref ref-type="bibr" rid="pcbi.1006898.ref018">18</xref>]. In 2010, Albrecht et al. included Barry’s data in a broader analysis of <italic>var</italic> data from Ariquemes, Brazil [<xref ref-type="bibr" rid="pcbi.1006898.ref019">19</xref>] which also included sequences from a study by Bull et al. from Kilifi, Kenya for comparison [<xref ref-type="bibr" rid="pcbi.1006898.ref027">27</xref>]. Each one of these studies, individually, sequenced parasite isolates to a particular target depth, yet the studies varied in their coverage of repertoires. Since the bias of <inline-formula id="pcbi.1006898.e049"><alternatives><graphic id="pcbi.1006898.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> depends on the number of samples (<xref ref-type="fig" rid="pcbi.1006898.g003">Fig 3</xref>; see also [<xref ref-type="bibr" rid="pcbi.1006898.ref007">7</xref>]), the variation of sampling rates across study populations means that different populations are biased downward by different amounts.</p>
<p>Albrecht et al. conveniently provide <italic>var</italic> type data from all three studies, from which we can rebuild their first figure which shows a <inline-formula id="pcbi.1006898.e050"><alternatives><graphic id="pcbi.1006898.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> comparison of five populations (<xref ref-type="fig" rid="pcbi.1006898.g005">Fig 5</xref>; left). Overlaps between pairs of parasites can then be recomputed using BRO (<xref ref-type="fig" rid="pcbi.1006898.g005">Fig 5</xref>; middle). The conclusions drawn from these two figures differ substantially.</p>
<fig id="pcbi.1006898.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006898.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Reevaluation of published results.</title>
<p>In 2010, Albrecht et al. compared <italic>var</italic> repertoires from 5 populations using pairwise type sharing (see Refs. [<xref ref-type="bibr" rid="pcbi.1006898.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref027">27</xref>] for original data details). (left) Reproduction of <inline-formula id="pcbi.1006898.e051"><alternatives><graphic id="pcbi.1006898.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> analysis of [<xref ref-type="bibr" rid="pcbi.1006898.ref019">19</xref>], rescaled from [0, 1]→[0, 60]. (middle) Reanalysis using Bayesian repertoire overlap [<xref ref-type="disp-formula" rid="pcbi.1006898.e028">Eq (7)</xref>]. For all boxplots, boxes span inner quartiles; center lines show medians; whiskers extend to 2.5 and 97.5 percentiles. (right) Histograms of Bayesian repertoire overlap distributions from Amele and Ariquemes clones (data identical to those in middle boxplots) colored by width of credible interval [<xref ref-type="disp-formula" rid="pcbi.1006898.e035">Eq (8)</xref>], a measure of uncertainty. Differences in uncertainties are driven primarily by sampling rates: Amele samples average <inline-formula id="pcbi.1006898.e052"><alternatives><graphic id="pcbi.1006898.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>15</mml:mn> <mml:mo>.</mml:mo> <mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> sequences per parasite while Ariquemes clones average <inline-formula id="pcbi.1006898.e053"><alternatives><graphic id="pcbi.1006898.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>26</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006898.g005" xlink:type="simple"/>
</fig>
<p>First, according to <inline-formula id="pcbi.1006898.e054"><alternatives><graphic id="pcbi.1006898.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, identical clones from Ariquemes share only around 30 sequences with themselves, illustrating the downward bias produced by subsampling—clones ought to share all of their genes with their genetically identical siblings. Indeed, the reanalysis using BRO finds over 75% of overlap estimates to be greater than 50 (and over 50% over 55), far closer to what is expected.</p>
<p>Second, the inter-clone overlap and inter-isolate overlap distributions in Ariquemes appear to be similar and overlapping through the lens of <inline-formula id="pcbi.1006898.e055"><alternatives><graphic id="pcbi.1006898.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. However, the recalculation using BRO shifts the clones’ distribution dramatically upward but leaves the isolates’ distribution more or less untouched. This is due to the dramatic difference in <italic>var</italic> coverage: the average number of sequences per clone is <inline-formula id="pcbi.1006898.e056"><alternatives><graphic id="pcbi.1006898.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>26</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> while for isolates it is <inline-formula id="pcbi.1006898.e057"><alternatives><graphic id="pcbi.1006898.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>45</mml:mn> <mml:mo>.</mml:mo> <mml:mn>8</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, meaning that relatively different amounts of bias are inherited from <inline-formula id="pcbi.1006898.e058"><alternatives><graphic id="pcbi.1006898.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (illustrated in simulations in <xref ref-type="fig" rid="pcbi.1006898.g003">Fig 3</xref>).</p>
<p>Finally, the distributions from Brazil (<inline-formula id="pcbi.1006898.e059"><alternatives><graphic id="pcbi.1006898.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>17</mml:mn> <mml:mo>.</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>) and Amele (<inline-formula id="pcbi.1006898.e060"><alternatives><graphic id="pcbi.1006898.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>15</mml:mn> <mml:mo>.</mml:mo> <mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>) also shift dramatically upward when the bias of <inline-formula id="pcbi.1006898.e061"><alternatives><graphic id="pcbi.1006898.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is removed (<xref ref-type="fig" rid="pcbi.1006898.g005">Fig 5</xref>; left, middle). However, this does not necessarily mean that they should be reinterpreted. For each pairwise comparison, <xref ref-type="disp-formula" rid="pcbi.1006898.e035">Eq (8)</xref> allows us to compute the width of the credible interval, <italic>s</italic><sub>max</sub> − <italic>s</italic><sub>min</sub> + 1, quantifying our uncertainty in each estimate. Due to low average coverage, the uncertainty of estimates in the Amele dataset tends to be extremely large (<xref ref-type="fig" rid="pcbi.1006898.g005">Fig 5</xref>; right), with the majority of estimates showing an uncertainty greater than 30 sequences (50% overlap). For comparison, estimates from Ariquemes clones (<inline-formula id="pcbi.1006898.e062"><alternatives><graphic id="pcbi.1006898.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>26</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>) are also shown, whose dramatically lower uncertainty enables more confident conclusions to be drawn.</p>
<p>There are two main methodological findings that result from using rigorous and unbiased methods. First, the boxplots of <xref ref-type="fig" rid="pcbi.1006898.g005">Fig 5</xref> clearly illustrate that sampling rates can have a dramatic impact on findings, reinforcing the simulation results of <xref ref-type="fig" rid="pcbi.1006898.g003">Fig 3</xref>. Second, uncertainty is an issue when <inline-formula id="pcbi.1006898.e063"><alternatives><graphic id="pcbi.1006898.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is too small, and datasets with low sampling rates may have such wide error bars that their estimates should not be trusted, as shown in the histograms of <xref ref-type="fig" rid="pcbi.1006898.g005">Fig 5</xref>, reinforcing the simulation results of <xref ref-type="fig" rid="pcbi.1006898.g004">Fig 4</xref>. Additional sequencing efforts come at a cost, however, and so in the next subsection we use the methods of this paper to quantify the tradeoff between increased sequencing efforts and decreased uncertainty.</p>
</sec>
<sec id="sec008">
<title>The cost of reduced uncertainty</title>
<p>In the previous section, the reanalysis of published results shows clearly that the number of samples per parasite has a dramatic impact on the uncertainty (and therefore the interpretability) of painstakingly collected parasite sequence data. Naturally, increasing the sampling rates, <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>b</italic></sub>, decreases the uncertainty in <inline-formula id="pcbi.1006898.e064"><alternatives><graphic id="pcbi.1006898.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, our estimate of <italic>s</italic> (<xref ref-type="fig" rid="pcbi.1006898.g004">Fig 4</xref>). However, additional samples cost time, effort, and money. Complicating matters, generating additional <italic>var</italic> sequences may or may not increase <italic>n</italic><sub><italic>a</italic></sub>, since the previously sequenced <italic>var</italic> tags may be redundantly sequenced. Thus, there is a stochastic tradeoff between increased laboratory effort and decreased uncertainty about repertoire overlap, which we now calculate.</p>
<p>To obtain <italic>var</italic> tags, the DNA is PCR amplified using degenerate primers that are designed to universally capture all <italic>var</italic> genes with DBL<italic>α</italic> domains. This product is then cloned into a vector that allows single products to integrate, and these vectors are then transformed into bacteria and plated such that each colony contains one vector and one insert (see e.g. [<xref ref-type="bibr" rid="pcbi.1006898.ref021">21</xref>] for detailed methods, but see also [<xref ref-type="bibr" rid="pcbi.1006898.ref025">25</xref>] which uses a different pipeline based on next-generation sequencing). Therefore, among a large number of colonies, there are likely to be multiple colonies with the same <italic>var</italic> gene while some genes may not be covered by any colony. How many colonies should be separated and sequenced in order to get an accurate estimate of the repertoire overlap between two parasites? Put more formally, if we repeatedly perform an experiment in which we sequence <italic>c</italic> colonies each from two parasites and estimate their overlap <inline-formula id="pcbi.1006898.e065"><alternatives><graphic id="pcbi.1006898.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, how much more accurate will <inline-formula id="pcbi.1006898.e066"><alternatives><graphic id="pcbi.1006898.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> become if we increase <italic>c</italic>?</p>
<p>To answer this question, we split it into two parts. First, if we sequence <italic>c</italic> colonies, how many unique <italic>var</italic> genes <italic>n</italic> are we likely to have sampled? Second, what implications will this have for our repertoire overlap estimates, discussed in the previous section?</p>
<p>The first question can be answered by considering a process in which there are <italic>k</italic> = 60 distinct sequences in total and we draw <italic>c</italic> of them, one at a time, independently and with replacement. For a fixed <italic>c</italic>, we can compute the probability mass function for the number of distinct sequences by a straightforward recursion: At any point during the process of drawing sequences, if <italic>n</italic> distinct sequences have already been drawn, then the probability of drawing an already-discovered sequence is <italic>n</italic>/<italic>k</italic>, making the probability of drawing a new sequence 1 − <italic>n</italic>/<italic>k</italic>. Each draw is independent of the previous draws, so the incremental accumulation of distinct sequences can be written as a Markov chain with transition matrix <italic>π</italic> whose non-zero entries are
<disp-formula id="pcbi.1006898.e067"><alternatives><graphic id="pcbi.1006898.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e067" xlink:type="simple"/><mml:math display="block" id="M67"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>π</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>→</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:mfrac> <mml:mspace width="1.em"/><mml:mtext>and</mml:mtext> <mml:mspace width="1.em"/><mml:msub><mml:mi>π</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>→</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:mfrac> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
Initially, zero sequences have been drawn (<italic>c</italic> = 0), making <italic>n</italic> = 0 with probability 1. For each additional sequence drawn, the probability distribution over the number of distinct sequences evolves according to the transition matrix <italic>π</italic>, so that after <italic>c</italic> draws the distribution over distinct sequences is given by the entries of the vector <bold>x</bold>,
<disp-formula id="pcbi.1006898.e068"><alternatives><graphic id="pcbi.1006898.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e068" xlink:type="simple"/><mml:math display="block" id="M68"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:msup><mml:mi>π</mml:mi> <mml:mi>c</mml:mi></mml:msup> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <bold>x</bold><sub>0</sub> is initial condition vector of zeros, except for the entry corresponding to the state <italic>n</italic> = 0, which equals one. This allows us to analytically compute the distribution of the number of unique <italic>var</italic> genes sampled by a PCR process with <italic>c</italic> colonies. In other words, we now have a map between laboratory efforts <italic>c</italic> and the distribution of actual unique <italic>var</italic> genes sampled, and we write this as <italic>P</italic>(<italic>n</italic> ∣ <italic>c</italic>). A variant of this problem was previously considered with the goal of computing the value of <italic>c</italic> that would cover at least 60% of each repertoire [<xref ref-type="bibr" rid="pcbi.1006898.ref031">31</xref>]. Although those calculations can be shown to produce incorrect estimates, <xref ref-type="disp-formula" rid="pcbi.1006898.e068">Eq (10)</xref> can be used to solve that problem variant as well. More widely, this general problem has been charmingly named <italic>the coupon collector’s problem</italic> by statisticians.</p>
<p>The second question focuses on the implications of <xref ref-type="disp-formula" rid="pcbi.1006898.e068">Eq (10)</xref>, and specifically requires that we quantify how an increase in sequencing efforts <italic>c</italic> affects the noisy distribution of estimates <inline-formula id="pcbi.1006898.e069"><alternatives><graphic id="pcbi.1006898.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Intuitively, for low <italic>c</italic>, both <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>b</italic></sub> will tend to be small, leading to broad distributions of <inline-formula id="pcbi.1006898.e070"><alternatives><graphic id="pcbi.1006898.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> around the correct value of <italic>s</italic>. Similarly, as <italic>c</italic> grows very large, we expect the distribution of <inline-formula id="pcbi.1006898.e071"><alternatives><graphic id="pcbi.1006898.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> to concentrate on exactly <italic>s</italic>. This distribution, <inline-formula id="pcbi.1006898.e072"><alternatives><graphic id="pcbi.1006898.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>∣</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, can be computed by integrating the distribution of estimates, conditioned on particular data, over the probability distribution of having produced those data, conditioned on <italic>c</italic> and <italic>s</italic>. Symbolically, the distribution of estimators <inline-formula id="pcbi.1006898.e073"><alternatives><graphic id="pcbi.1006898.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, given true overlap <italic>s</italic> and colonies <italic>c</italic> is given by
<disp-formula id="pcbi.1006898.e074"><alternatives><graphic id="pcbi.1006898.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e074" xlink:type="simple"/><mml:math display="block" id="M74"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>∣</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mo>{</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>∣</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>∣</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
<inline-formula id="pcbi.1006898.e075"><alternatives><graphic id="pcbi.1006898.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the probability of getting a particular estimate <inline-formula id="pcbi.1006898.e076"><alternatives><graphic id="pcbi.1006898.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, given information about coverage and overlap. In fact, this is a distribution concentrated at a single point, i.e., a Dirac <italic>δ</italic> function, since each triple (<italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub>, <italic>n</italic><sub><italic>ab</italic></sub>) maps to exactly one point estimate <inline-formula id="pcbi.1006898.e077"><alternatives><graphic id="pcbi.1006898.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. As a result, this term tells us the locations at which there will be probability mass, while the remaining terms in <xref ref-type="disp-formula" rid="pcbi.1006898.e074">Eq (11)</xref> tell us how much mass there will be at those locations. In other words, this distribution is a discrete probability distribution, and we have written down a fancy form of it above. By aggregating into bins, this distribution can be conveniently visualized as a histogram, which shows how the uncertainty of estimators depends on the true overlap <italic>s</italic> and the sequencing effort <italic>c</italic>. <xref ref-type="fig" rid="pcbi.1006898.g006">Fig 6</xref> shows the effect of increasing sequencing efforts from a half plate (<italic>c</italic> = 48) to a full 96-well plate (<italic>c</italic> = 96) and beyond. These calculations succinctly quantify intuition: additional laboratory efforts lead to higher accuracy guarantees.</p>
<fig id="pcbi.1006898.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006898.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Quantifying the decrease in uncertainty from increased sequencing.</title>
<p>Histograms show distributions of overlap estimates <inline-formula id="pcbi.1006898.e078"><alternatives><graphic id="pcbi.1006898.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, computed using <xref ref-type="disp-formula" rid="pcbi.1006898.e074">Eq (11)</xref>, for various values of <italic>s</italic> which are indicated by color-matched dotted lines. While all estimates are distributed around the true values of <italic>s</italic>, increasing the number of colonies <italic>c</italic> from 48 (top) to 96 (middle) and to 144 (bottom) substantially decreases the error of estimates. For example the bottom plot shows that successfully sequencing <italic>c</italic> = 144 colonies from each parasite is guaranteed to produce estimates <inline-formula id="pcbi.1006898.e079"><alternatives><graphic id="pcbi.1006898.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> that are off by at most 5 (8.3%) in either direction of the true <italic>s</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006898.g006" xlink:type="simple"/>
</fig>
<p>The calculations and distributions in this section show how the Bayesian framework in this manuscript can also be used to plan sequencing studies and estimate study costs. If a desired downstream analysis of repertoire overlap requires results that are accurate to within a particular number of shared sequences, BRO methods can easily specify the sequencing efforts needed.</p>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>This manuscript places the estimation of overlap between fixed-size repertoires or populations from incomplete samples on firm statistical ground. While myriad indices of <italic>β</italic>-diversity for presence-absence data exist [<xref ref-type="bibr" rid="pcbi.1006898.ref002">2</xref>], they implicitly treat species counts as complete, leading to bias. Notable exceptions which embrace imperfect sampling exist [<xref ref-type="bibr" rid="pcbi.1006898.ref007">7</xref>], but require species abundance data to compute. Here, we clearly define a stochastic process for fixed-size repertoires that generates sample presence/absence data, opening the door to rigorous Bayesian inference. In particular, <xref ref-type="disp-formula" rid="pcbi.1006898.e028">Eq (7)</xref> provides point estimates of true repertoire overlap, while <xref ref-type="disp-formula" rid="pcbi.1006898.e035">Eq (8)</xref> provides error bars and uncertainty estimates via credible intervals. If desired, improved estimates of <inline-formula id="pcbi.1006898.e080"><alternatives><graphic id="pcbi.1006898.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> can be plugged directly into any of the dozens of presence/absence measures of similarity reviewed in Ref. [<xref ref-type="bibr" rid="pcbi.1006898.ref002">2</xref>]. Figs <xref ref-type="fig" rid="pcbi.1006898.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1006898.g004">4</xref> show the consistency and accuracy of these calculations across simulated sampling regimes in which the correct answer is known.</p>
<p>Bayesian repertoire overlap (BRO) is also useful in real-data scenarios, when the correct answer is unknown. By revisiting previously published studies of the <italic>var</italic> genes of <italic>P</italic>. <italic>falciparum</italic> [<xref ref-type="bibr" rid="pcbi.1006898.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref027">27</xref>], we showed that switching from the Sørenson-Dice coefficient <inline-formula id="pcbi.1006898.e081"><alternatives><graphic id="pcbi.1006898.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (called pairwise type sharing in the malaria literature) to BRO leads to different conclusions (<xref ref-type="fig" rid="pcbi.1006898.g005">Fig 5</xref> left, middle) or high uncertainty (<xref ref-type="fig" rid="pcbi.1006898.g005">Fig 5</xref> right). In particular, these reanalyses point to a clear recommendation for the design of future malaria studies: the number of unique <italic>var</italic> sequences per isolate should be at least 30. Since each additional PCR product may not contribute an additional unique sequence, we again used the Bayesian framework to translate increased PCR efforts to decreased uncertainty (<xref ref-type="fig" rid="pcbi.1006898.g006">Fig 6</xref>). Accuracy requirements can now be weighed against laboratory costs during the planning of studies.</p>
<p>While BRO clearly outperforms <inline-formula id="pcbi.1006898.e082"><alternatives><graphic id="pcbi.1006898.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in practical contexts, it is also more cumbersome to compute. Indeed, <inline-formula id="pcbi.1006898.e083"><alternatives><graphic id="pcbi.1006898.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> can be calculated on the back of an envelope while <xref ref-type="disp-formula" rid="pcbi.1006898.e028">Eq (7)</xref> requires a computer, or at least a lot more envelopes. However, as it turns out, there are only around 77, 500 possible combinations of <italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub>, and <italic>n</italic><sub><italic>ab</italic></sub>, which means that a lookup table of every conceivable <inline-formula id="pcbi.1006898.e084"><alternatives><graphic id="pcbi.1006898.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> value can be computed on a laptop in minutes and attached to an email. Links to open-source code and a convenient web tool can be found in the Acknowledgements.</p>
<p>The models introduced in this paper are as correct as their assumptions, which we now revisit. During the construction of the Bayesian repertoire overlap, we assumed that our prior distribution <italic>P</italic>(<italic>s</italic>) was uniform, meaning that we treated each possible level of overlap as equally likely. This is easily defensible in practice, as any other choice would introduce unacceptable bias.</p>
<p>We also assumed, when computing the tradeoff between sequencing effort and uncertainty, that each sequence in each repertoire was just as likely to have been sampled, which may or may not be true, for two distinct reasons. First, due to the fact that sequences are obtained using degenerate primers, the effects of primer bias may cause some sequences to be amplified more often than others. Second, a single parasite genome might have multiple copies of the exact same <italic>var</italic> gene, or might have distinct <italic>var</italic> genes whose DBL<italic>α</italic> tags are nevertheless identical. This scenario is arguably more likely among South American genomes whose overall <italic>var</italic> diversity is lower. Experimentally, the probability that a sequence is observed will be scaled upward by its genomic multiplicity, but the scaling may be non-linear since PCR protocols include many rounds of amplification, magnifying the deviations from uniformity. Fully addressing either of these possibilities would require that we modify the probabilities in both the coupon collector’s problem and the repertoire subsampling processes, and then use Monte Carlo methods to numerically compute posterior distributions.</p>
<p>New sampling protocols for <italic>var</italic> genes, based on next-generation sequencing methods [<xref ref-type="bibr" rid="pcbi.1006898.ref025">25</xref>], may or may or may not meet the assumptions of the estimator presented here. To use the hypergeometric distribution, we require that, if an entire sampling protocol were to be technically replicated many times, that eventually each member of the repertoire would be observed with equal probability. In other words, while fluctuations in any particular set of observations are expected, with technical replication those fluctuations must eventually even out, approaching uniformity. Thus, the issues of primer bias and gene multiplicity violate the assumption of uniformity, but the magnification of random initial fluctuations, e.g., by the repeated amplification rounds of PCR, do not.</p>
<p>Could deviations from the modeling assumption of uniformity could be inferred from the data themselves? If so, this idea could in principle be applied to cloning-based methods and next-generation methods alike. This is an interesting direction for future work, and could draw from advances in abundance-based estimators for <italic>β</italic>-diversity [<xref ref-type="bibr" rid="pcbi.1006898.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref012">12</xref>], or could incorporate explicit knowledge of the effects of protocols and pipelines, in order to mathematically undo their effects.</p>
<p>More practically, the assumption that the <italic>var</italic> repertoire size is 60 makes the methods of this paper less useful in the context of complex infections with multiple parasite genomes [<xref ref-type="bibr" rid="pcbi.1006898.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref027">27</xref>]. In cases where the multiplicity of infection is known, overlap estimates could be computed using generalizations of the statistics in this paper, computing overlap between infections (instead of between parasites). This would be complicated by possible overlap of parasite repertoires within each infection, but repertoires tend to be quite different in areas of high transmission so the methods herein may be approximately correct. Nevertheless, development of more sophisticated methods would be especially useful in the context of <italic>var</italic>-based epidemiological studies.</p>
<p>This paper focuses on malaria’s <italic>var</italic> genes, and assumes a total repertoire size of 60, but mathematically relaxing this assumption (<xref ref-type="supplementary-material" rid="pcbi.1006898.s002">S1 Text</xref>) broadens the set of possible applications. First, within studies of malaria’s <italic>var</italic> genes, the total repertoire size fluctuates slightly from parasite to parasite. As larger whole-genome datasets become available, this information can be incorporated directly as a prior over the distribution of repertoire sizes, improving estimates further. This opens the door to the analysis of <italic>Plasmodium spp</italic>. multigene antigen families such as <italic>rif</italic> and <italic>stevor</italic> [<xref ref-type="bibr" rid="pcbi.1006898.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref033">33</xref>], or more general studies of <italic>β</italic>-diversity in multigene families in which population sizes are fixed or their size distributions have been sampled [<xref ref-type="bibr" rid="pcbi.1006898.ref034">34</xref>]. Second, outside of malaria, improved estimators may also be useful in comparing, for instance, the genomic archives of antigen-encoding <italic>vsg</italic> genes used by <italic>Trypanosoma brucei</italic> for immune evasion [<xref ref-type="bibr" rid="pcbi.1006898.ref035">35</xref>]. Finally, the mathematics of this paper need not be applied to genetics or even within ecology; large-data applications like Facebook and other online social networks compute the sizes of intersections of sets—how many interests or friends do two individuals have in common?—but use only subsamples of data to decrease computation time in distributed computing settings [<xref ref-type="bibr" rid="pcbi.1006898.ref013">13</xref>].</p>
<p>Finally, this work presents a Bayesian approach to inference of <italic>β</italic>-diversity under particular assumptions, which contrasts the vast majority of indices, coefficients, and metrics to date which remain non-probabilistic [<xref ref-type="bibr" rid="pcbi.1006898.ref002">2</xref>]. Changing the underlying assumptions of the Bayesian repertoire overlap method, or the statistics of the sampling process, would lead to additional estimators for other common cases. Across applications, unbiased estimation combined with the quantification of uncertainty will allow for more reliable results and better prospective study design.</p>
</sec>
<sec id="sec010">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006898.s001" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006898.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Bayesian repertoire overlap consistently estimates true overlap for varying population size and sampling rates.</title>
<p>Repertoires with true overlaps ranging from 0 to 60 were subsampled in simulations. While the main text shows results when <italic>n</italic><sub><italic>a</italic></sub> = <italic>n</italic><sub><italic>b</italic></sub> and when <italic>N</italic><sub><italic>a</italic></sub> = <italic>N</italic><sub><italic>b</italic></sub> = 60, these assumptions can also be relaxed. Increasing <italic>N</italic><sub><italic>b</italic></sub> from 60 (left column) to 120 (right column) does not affect the consistency of BRO estimates, nor does decreasing the number of samples from population <italic>a</italic> from <italic>n</italic><sub><italic>a</italic></sub> = 40 (top row) to <italic>n</italic><sub><italic>a</italic></sub> = 10 (bottom row). As in the main text, the underestimating bias of <inline-formula id="pcbi.1006898.e085"><alternatives><graphic id="pcbi.1006898.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>˚</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is worse with lower sampling rates [<xref ref-type="bibr" rid="pcbi.1006898.ref007">7</xref>].</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006898.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006898.s002" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>The main text describes the Bayesian repertoire overlap estimator <inline-formula id="pcbi.1006898.e086"><alternatives><graphic id="pcbi.1006898.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006898.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> when both populations are of size 60.</title>
<p>A general estimator is derived for populations of arbitrary and possibly unequal size.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The author would like to thank Amy K. Bei, Samuel F. Way, Caroline O. Buckee, and Allison C. Morgan for helpful conversations and suggestions. DBL also warmly thanks the authors of Refs. [<xref ref-type="bibr" rid="pcbi.1006898.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006898.ref027">27</xref>] whose commitment to open science and methods means that their data were freely available for re-analysis.</p>
<p>Open-source code is freely available in Python at <ext-link ext-link-type="uri" xlink:href="http://github.com/dblarremore/BayesianRepertoireOverlap" xlink:type="simple">github.com/dblarremore/BayesianRepertoireOverlap</ext-link>. A web tool version produces estimates, credible intervals, and figures like <xref ref-type="fig" rid="pcbi.1006898.g002">Fig 2</xref> and is available at <ext-link ext-link-type="uri" xlink:href="http://bro.colorado.edu" xlink:type="simple">bro.colorado.edu</ext-link>.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006898.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Whittaker</surname> <given-names>RH</given-names></name>. <article-title>Vegetation of the Siskiyou mountains, Oregon and California</article-title>. <source>Ecological Monographs</source>. <year>1960</year>;<volume>30</volume>(<issue>3</issue>):<fpage>279</fpage>–<lpage>338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/1943563" xlink:type="simple">10.2307/1943563</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Koleff</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gaston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Lennon</surname> <given-names>JJ</given-names></name>. <article-title>Measuring beta diversity for presence–absence data</article-title>. <source>Journal of Animal Ecology</source>. <year>2003</year>;<volume>72</volume>(<issue>3</issue>):<fpage>367</fpage>–<lpage>382</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1046/j.1365-2656.2003.00710.x" xlink:type="simple">10.1046/j.1365-2656.2003.00710.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barwell</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Isaac</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Kunin</surname> <given-names>WE</given-names></name>. <article-title>Measuring <italic>β</italic>-diversity with species abundance data</article-title>. <source>Journal of Animal Ecology</source>. <year>2015</year>;<volume>84</volume>(<issue>4</issue>):<fpage>1112</fpage>–<lpage>1122</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/1365-2656.12362" xlink:type="simple">10.1111/1365-2656.12362</ext-link></comment> <object-id pub-id-type="pmid">25732937</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rao</surname> <given-names>CR</given-names></name>. <article-title>Diversity and dissimilarity coefficients: a unified approach</article-title>. <source>Theoretical Population Biology</source>. <year>1982</year>;<volume>21</volume>(<issue>1</issue>):<fpage>24</fpage>–<lpage>43</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0040-5809(82)90004-1" xlink:type="simple">10.1016/0040-5809(82)90004-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lozupone</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>. <article-title>UniFrac: a new phylogenetic method for comparing microbial communities</article-title>. <source>Applied and Environmental Microbiology</source>. <year>2005</year>;<volume>71</volume>(<issue>12</issue>):<fpage>8228</fpage>–<lpage>8235</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/AEM.71.12.8228-8235.2005" xlink:type="simple">10.1128/AEM.71.12.8228-8235.2005</ext-link></comment> <object-id pub-id-type="pmid">16332807</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stirling</surname> <given-names>A</given-names></name>. <article-title>A general framework for analysing diversity in science, technology and society</article-title>. <source>Journal of the Royal Society Interface</source>. <year>2007</year>;<volume>4</volume>(<issue>15</issue>):<fpage>707</fpage>–<lpage>719</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2007.0213" xlink:type="simple">10.1098/rsif.2007.0213</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chao</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Chazdon</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Colwell</surname> <given-names>RK</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>TJ</given-names></name>. <article-title>A new statistical approach for assessing similarity of species composition with incidence and abundance data</article-title>. <source>Ecology Letters</source>. <year>2005</year>;<volume>8</volume>(<issue>2</issue>):<fpage>148</fpage>–<lpage>159</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1461-0248.2004.00707.x" xlink:type="simple">10.1111/j.1461-0248.2004.00707.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jaccard</surname> <given-names>P</given-names></name>. <article-title>Étude comparative de la distribution florale dans une portion des Alpes et des Jura</article-title>. <source>Bull Soc Vaudoise Sci Nat</source>. <year>1901</year>;<volume>37</volume>:<fpage>547</fpage>–<lpage>579</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006898.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dice</surname> <given-names>LR</given-names></name>. <article-title>Measures of the amount of ecologic association between species</article-title>. <source>Ecology</source>. <year>1945</year>;<volume>26</volume>(<issue>3</issue>):<fpage>297</fpage>–<lpage>302</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/1932409" xlink:type="simple">10.2307/1932409</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sørensen</surname> <given-names>T</given-names></name>. <article-title>A method of establishing groups of equal amplitude in plant sociology based on similarity of species and its application to analyses of the vegetation on Danish commons</article-title>. <source>Biol Skr</source>. <year>1948</year>;<volume>5</volume>:<fpage>1</fpage>–<lpage>34</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006898.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Crist</surname> <given-names>TO</given-names></name>, <name name-style="western"><surname>Chase</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Vellend</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Inouye</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Freestone</surname> <given-names>AL</given-names></name>, <etal>et al</etal>. <article-title>Navigating the multiple meanings of <italic>β</italic> diversity: a roadmap for the practicing ecologist</article-title>. <source>Ecology Letters</source>. <year>2011</year>;<volume>14</volume>(<issue>1</issue>):<fpage>19</fpage>–<lpage>28</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1461-0248.2010.01552.x" xlink:type="simple">10.1111/j.1461-0248.2010.01552.x</ext-link></comment> <object-id pub-id-type="pmid">21070562</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kéry</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Royle</surname> <given-names>JA</given-names></name>. <article-title>Hierarchical Bayes estimation of species richness and occupancy in spatially replicated surveys</article-title>. <source>Journal of Applied Ecology</source>. <year>2008</year>;<volume>45</volume>(<issue>2</issue>):<fpage>589</fpage>–<lpage>598</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1365-2664.2007.01441.x" xlink:type="simple">10.1111/j.1365-2664.2007.01441.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref013">
<label>13</label>
<mixed-citation publication-type="other" xlink:type="simple">Ting D. Towards optimal cardinality estimation of unions and intersections with sketches. In: Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining. ACM; 2016. p. 1195–1204.</mixed-citation>
</ref>
<ref id="pcbi.1006898.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Avril</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tripathi</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Brazier</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Andisi</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Janes</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Soma</surname> <given-names>VL</given-names></name>, <etal>et al</etal>. <article-title>A restricted subset of var genes mediates adherence of Plasmodium falciparum-infected erythrocytes to brain endothelial cells</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>26</issue>):<fpage>E1782</fpage>–<lpage>E1790</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1120534109" xlink:type="simple">10.1073/pnas.1120534109</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Claessens</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ghumra</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lindergard</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Buchan</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Andisi</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A subset of group A-like var genes encodes the malaria parasite ligands for binding to human brain endothelial cells</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>26</issue>):<fpage>E1772</fpage>–<lpage>E1781</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1120461109" xlink:type="simple">10.1073/pnas.1120461109</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ochola</surname> <given-names>LB</given-names></name>, <name name-style="western"><surname>Siddondo</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Ocholla</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Nkya</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kimani</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>TN</given-names></name>, <etal>et al</etal>. <article-title>Specific receptor usage in Plasmodium falciparum cytoadherence is associated with disease outcome</article-title>. <source>PLOS One</source>. <year>2011</year>;<volume>6</volume>(<issue>3</issue>):<fpage>e14741</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0014741" xlink:type="simple">10.1371/journal.pone.0014741</ext-link></comment> <object-id pub-id-type="pmid">21390226</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Warimwe</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Fegan</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Musyoki</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Newton</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Opiyo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Githinji</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Prognostic indicators of life-threatening malaria are associated with distinct parasite variant antigen profiles</article-title>. <source>Science Translational Medicine</source>. <year>2012</year>;<volume>4</volume>(<issue>129</issue>):<fpage>129ra45</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/scitranslmed.3003247" xlink:type="simple">10.1126/scitranslmed.3003247</ext-link></comment> <object-id pub-id-type="pmid">22496547</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barry</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Leliwa-Sytek</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tavul</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Imrie</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Migot-Nabias</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>SM</given-names></name>, <etal>et al</etal>. <article-title>Population genomics of the immune evasion (var) genes of Plasmodium falciparum</article-title>. <source>PLOS Pathogens</source>. <year>2007</year>;<volume>3</volume>(<issue>3</issue>):<fpage>e34</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.ppat.0030034" xlink:type="simple">10.1371/journal.ppat.0030034</ext-link></comment> <object-id pub-id-type="pmid">17367208</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Albrecht</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Castiñeiras</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Carvalho</surname> <given-names>BO</given-names></name>, <name name-style="western"><surname>Ladeia-Andrade</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>da Silva</surname> <given-names>NS</given-names></name>, <name name-style="western"><surname>Hoffmann</surname> <given-names>EH</given-names></name>, <etal>et al</etal>. <article-title>The South American Plasmodium falciparum var gene repertoire is limited, highly shared and possibly lacks several antigenic types</article-title>. <source>Gene</source>. <year>2010</year>;<volume>453</volume>(<issue>1</issue>):<fpage>37</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.gene.2010.01.001" xlink:type="simple">10.1016/j.gene.2010.01.001</ext-link></comment> <object-id pub-id-type="pmid">20079817</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chen</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Barry</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Leliwa-Sytek</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>SM</given-names></name>, <etal>et al</etal>. <article-title>A molecular epidemiological study of var gene diversity to characterize the reservoir of Plasmodium falciparum in humans in Africa</article-title>. <source>PLOS One</source>. <year>2011</year>;<volume>6</volume>(<issue>2</issue>):<fpage>e16629</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0016629" xlink:type="simple">10.1371/journal.pone.0016629</ext-link></comment> <object-id pub-id-type="pmid">21347415</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bei</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Diouf</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Miura</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Larremore</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Ribacke</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Tullo</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Immune characterization of Plasmodium falciparum parasites with a shared genetic signature in a region of decreasing transmission</article-title>. <source>Infection and Immunity</source>. <year>2015</year>;<volume>83</volume>(<issue>1</issue>):<fpage>276</fpage>–<lpage>285</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/IAI.01979-14" xlink:type="simple">10.1128/IAI.01979-14</ext-link></comment> <object-id pub-id-type="pmid">25368109</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tessema</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Monk</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Schultz</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Tavul</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Reeder</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Siba</surname> <given-names>PM</given-names></name>, <etal>et al</etal>. <article-title>Phylogeography of var gene repertoires reveals fine-scale geospatial clustering of Plasmodium falciparum populations in a highly endemic area</article-title>. <source>Molecular Ecology</source>. <year>2015</year>;<volume>24</volume>(<issue>2</issue>):<fpage>484</fpage>–<lpage>497</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/mec.13033" xlink:type="simple">10.1111/mec.13033</ext-link></comment> <object-id pub-id-type="pmid">25482097</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Day</surname> <given-names>KP</given-names></name>, <name name-style="western"><surname>Artzy-Randrup</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tiedje</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Rougeron</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Rask</surname> <given-names>TS</given-names></name>, <etal>et al</etal>. <article-title>Evidence of strain structure in Plasmodium falciparum var gene repertoires in children from Gabon, West Africa</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2017</year>; <fpage>E4103</fpage>–<lpage>E4111</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1613018114" xlink:type="simple">10.1073/pnas.1613018114</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buckee</surname> <given-names>CO</given-names></name>, <name name-style="western"><surname>Bull</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>S</given-names></name>. <article-title>Inferring malaria parasite population structure from serological networks</article-title>. <source>Proceedings of the Royal Society of London B: Biological Sciences</source>. <year>2009</year>;<volume>276</volume>(<issue>1656</issue>):<fpage>477</fpage>–<lpage>485</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2008.1122" xlink:type="simple">10.1098/rspb.2008.1122</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>He</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Pilosof</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tiedje</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Ruybal-Pesantez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Artzy-Randrup</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Baskerville</surname> <given-names>EB</given-names></name>, <etal>et al</etal>. <article-title>Networks of genetic similarity reveal non-neutral processes shape strain structure in Plasmodium falciparum</article-title>. <source>Nature Communications</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1817</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41467-018-04219-3" xlink:type="simple">10.1038/s41467-018-04219-3</ext-link></comment> <object-id pub-id-type="pmid">29739937</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Taylor</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Kyes</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Newbold</surname> <given-names>CI</given-names></name>. <article-title>Var gene diversity in Plasmodium falciparum is generated by frequent recombination events</article-title>. <source>Molecular and Biochemical Parasitology</source>. <year>2000</year>;<volume>110</volume>(<issue>2</issue>):<fpage>391</fpage>–<lpage>397</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0166-6851(00)00286-3" xlink:type="simple">10.1016/S0166-6851(00)00286-3</ext-link></comment> <object-id pub-id-type="pmid">11071291</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bull</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Berriman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kyes</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Quail</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Kortok</surname> <given-names>MM</given-names></name>, <etal>et al</etal>. <article-title>Plasmodium falciparum variant surface antigen expression patterns during malaria</article-title>. <source>PLOS Pathogens</source>. <year>2005</year>;<volume>1</volume>(<issue>3</issue>):<fpage>e26</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.ppat.0010026" xlink:type="simple">10.1371/journal.ppat.0010026</ext-link></comment> <object-id pub-id-type="pmid">16304608</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bull</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Kyes</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Buckee</surname> <given-names>CO</given-names></name>, <name name-style="western"><surname>Montgomery</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kortok</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Newbold</surname> <given-names>CI</given-names></name>, <etal>et al</etal>. <article-title>An approach to classifying sequence tags sampled from Plasmodium falciparum var genes</article-title>. <source>Molecular and Biochemical Parasitology</source>. <year>2007</year>;<volume>154</volume>(<issue>1</issue>):<fpage>98</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.molbiopara.2007.03.011" xlink:type="simple">10.1016/j.molbiopara.2007.03.011</ext-link></comment> <object-id pub-id-type="pmid">17467073</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Normark</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nilsson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ribacke</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Winter</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Moll</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wheelock</surname> <given-names>CE</given-names></name>, <etal>et al</etal>. <article-title>PfEMP1-DBL1<italic>α</italic> amino acid motifs in severe disease states of Plasmodium falciparum malaria</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2007</year>;<volume>104</volume>(<issue>40</issue>):<fpage>15835</fpage>–<lpage>15840</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0610485104" xlink:type="simple">10.1073/pnas.0610485104</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Warimwe</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Keane</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Fegan</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Musyoki</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Newton</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Pain</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Plasmodium falciparum var gene expression is modified by host immunity</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year>;<volume>106</volume>(<issue>51</issue>):<fpage>21801</fpage>–<lpage>21806</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0907590106" xlink:type="simple">10.1073/pnas.0907590106</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fowler</surname> <given-names>EV</given-names></name>, <name name-style="western"><surname>Peters</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Gatton</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>Q</given-names></name>. <article-title>Genetic diversity of the DBL<italic>α</italic> region in Plasmodium falciparum var genes among Asia-Pacific isolates</article-title>. <source>Molecular and Biochemical Parasitology</source>. <year>2002</year>;<volume>120</volume>(<issue>1</issue>):<fpage>117</fpage>–<lpage>126</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0166-6851(01)00443-1" xlink:type="simple">10.1016/S0166-6851(01)00443-1</ext-link></comment> <object-id pub-id-type="pmid">11849711</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cheng</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Cloonan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Fischer</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Waine</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Lanzer</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>stevor and rif are Plasmodium falciparum multicopy gene families which potentially encode variant antigens</article-title>. <source>Molecular and Biochemical Parasitology</source>. <year>1998</year>;<volume>97</volume>(<issue>1-2</issue>):<fpage>161</fpage>–<lpage>176</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0166-6851(98)00144-3" xlink:type="simple">10.1016/S0166-6851(98)00144-3</ext-link></comment> <object-id pub-id-type="pmid">9879895</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Niang</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yam</surname> <given-names>XY</given-names></name>, <name name-style="western"><surname>Preiser</surname> <given-names>PR</given-names></name>. <article-title>The Plasmodium falciparum STEVOR multigene family mediates antigenic variation of the infected erythrocyte</article-title>. <source>PLOS Pathogens</source>. <year>2009</year>;<volume>5</volume>(<issue>2</issue>):<fpage>e1000307</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.ppat.1000307" xlink:type="simple">10.1371/journal.ppat.1000307</ext-link></comment> <object-id pub-id-type="pmid">19229319</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Otto</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Gilabert</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Crellen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Böhme</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Arnathau</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sanders</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Genomes of all known members of a Plasmodium subgenus reveal paths to virulent human malaria</article-title>. <source>Nature Microbiology</source>. <year>2018</year>;<volume>3</volume>(<issue>6</issue>):<fpage>687</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41564-018-0162-2" xlink:type="simple">10.1038/s41564-018-0162-2</ext-link></comment> <object-id pub-id-type="pmid">29784978</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006898.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marcello</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Barry</surname> <given-names>JD</given-names></name>. <article-title>Analysis of the VSG gene silent archive in Trypanosoma brucei reveals that mosaic gene expression is prominent in antigenic variation and is favored by archive substructure</article-title>. <source>Genome Research</source>. <year>2007</year>;<volume>17</volume>(<issue>9</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.6421207" xlink:type="simple">10.1101/gr.6421207</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>