<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00506</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004465</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Network-Based Isoform Quantification with RNA-Seq Data for Cancer Transcriptome Analysis</article-title>
<alt-title alt-title-type="running-head">Network-Based Isoform Quantification with RNA-Seq Data</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zhang</surname> <given-names>Wei</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Chang</surname> <given-names>Jae-Woong</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Lin</surname> <given-names>Lilong</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Minn</surname> <given-names>Kay</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Wu</surname> <given-names>Baolin</given-names></name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Chien</surname> <given-names>Jeremy</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Yong</surname> <given-names>Jeongsik</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zheng</surname> <given-names>Hui</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Kuang</surname> <given-names>Rui</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Computer Science and Engineering, University of Minnesota Twin Cities, Minneapolis, Minnesota, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Biochemistry, Molecular Biology and Biophysics, University of Minnesota Twin Cities, Minneapolis, Minnesota, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Guangzhou Institutes of Biomedicine and Health, Chinese Academy of Sciences, Guangzhou, Peoples Republic of China</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Cancer Biology, University of Kansas Medical Center, Kansas City, Kansas, United States of America</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Division of Biostatistics, School of Public Health, University of Minnesota Twin Cities, Minneapolis, Minnesota, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Zhou</surname> <given-names>Xianghong Jasmine</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Southern California, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: WZ RK. Performed the experiments: WZ JWC LL KM. Analyzed the data: WZ BW RK. Contributed reagents/materials/analysis tools: JWC LL KM BW JC JY HZ. Wrote the paper: WZ JC JY HZ RK.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">kuang@cs.umn.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>12</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>23</day>
<month>12</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>12</issue>
<elocation-id>e1004465</elocation-id>
<history>
<date date-type="received">
<day>26</day>
<month>3</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>11</day>
<month>7</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Zhang et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004465"/>
<abstract>
<p>High-throughput mRNA sequencing (RNA-Seq) is widely used for transcript quantification of gene isoforms. Since RNA-Seq data alone is often not sufficient to accurately identify the read origins from the isoforms for quantification, we propose to explore protein domain-domain interactions as prior knowledge for integrative analysis with RNA-Seq data. We introduce a Network-based method for RNA-Seq-based Transcript Quantification (Net-RSTQ) to integrate protein domain-domain interaction network with short read alignments for transcript abundance estimation. Based on our observation that the abundances of the neighboring isoforms by domain-domain interactions in the network are positively correlated, Net-RSTQ models the expression of the neighboring transcripts as Dirichlet priors on the likelihood of the observed read alignments against the transcripts in one gene. The transcript abundances of all the genes are then jointly estimated with alternating optimization of multiple EM problems. In simulation Net-RSTQ effectively improved isoform transcript quantifications when isoform co-expressions correlate with their interactions. qRT-PCR results on 25 multi-isoform genes in a stem cell line, an ovarian cancer cell line, and a breast cancer cell line also showed that Net-RSTQ estimated more consistent isoform proportions with RNA-Seq data. In the experiments on the RNA-Seq data in The Cancer Genome Atlas (TCGA), the transcript abundances estimated by Net-RSTQ are more informative for patient sample classification of ovarian cancer, breast cancer and lung cancer. All experimental results collectively support that Net-RSTQ is a promising approach for isoform quantification. Net-RSTQ toolbox is available at <ext-link ext-link-type="uri" xlink:href="http://compbio.cs.umn.edu/Net-RSTQ/" xlink:type="simple">http://compbio.cs.umn.edu/Net-RSTQ/</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>New sequencing technologies for transcriptome-wide profiling of RNAs have greatly promoted the interest in isoform-based functional characterizations of a cellular system. Elucidation of gene expressions at the isoform resolution could lead to new molecular mechanisms such as gene-regulations and alternative splicings, and potentially better molecular signals for phenotype predictions. However, it could be overly optimistic to derive the proportion of the isoforms of a gene solely based on short read alignments. Inherently, systematical sampling biases from RNA library preparation and ambiguity of read origins in overlapping isoforms pose a problem in reliability. The work in this paper exams the possibility of using protein domain-domain interactions as prior knowledge in isoform transcript quantification. We first made the observation that protein domain-domain interactions positively correlate with isoform co-expressions in TCGA data and then designed a probabilistic EM approach to integrate domain-domain interactions with short read alignments for estimation of isoform proportions. Validated by qRT-PCR experiments on three cell lines, simulations and classifications of TCGA patient samples in several cancer types, Net-RSTQ is proven a useful tool for isoform-based analysis in functional genomes and systems biology.</p>
</abstract>
<funding-group>
<funding-statement>WZ, JC and RK were supported by NSF grant III 1117153. <ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov/" xlink:type="simple">http://www.nsf.gov/</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="5"/>
<page-count count="24"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The matlab source code is available at <ext-link ext-link-type="uri" xlink:href="http://compbio.cs.umn.edu/Net-RSTQ/" xlink:type="simple">http://compbio.cs.umn.edu/Net-RSTQ/</ext-link>. The list of TCGA patient samples and GEO cell line samples used in the experiments are also provided through the URL.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Application of next generation sequencing technologies to mRNA sequencing (RNA-Seq) is a widely used approach in transcriptome study [<xref ref-type="bibr" rid="pcbi.1004465.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004465.ref003">3</xref>]. Compared with microarray technologies, RNA-Seq provides information for expression analysis at transcript level and avoids the limitations of cross-hybridization and restricted range of the measured expression levels. Thus, RNA-Seq is particularly useful for quantification of isoform transcript expressions and identification of novel isoforms. Accurate RNA-Seq-based transcript quantification is a crucial step in other downstream transcriptome analyses such as isoform function prediction in the pioneer work in [<xref ref-type="bibr" rid="pcbi.1004465.ref004">4</xref>], and differential gene expression analysis [<xref ref-type="bibr" rid="pcbi.1004465.ref005">5</xref>] or transcript expression analysis [<xref ref-type="bibr" rid="pcbi.1004465.ref006">6</xref>]. Detecting biomarkers from transcript quantifications by RNA-Seq is also a frequent common practice in biomedical research. However, transcript quantification is challenging since a variety of systematical sampling biases have been observed in RNA-Seq data as a result of library preparation protocols [<xref ref-type="bibr" rid="pcbi.1004465.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1004465.ref010">10</xref>]. Moreover, in the aligned RNA-Seq short reads, most reads mapped to a gene are potentially originated by more than one transcript. The ambiguous mapping could result in hardly identifiable patterns of transcript variants [<xref ref-type="bibr" rid="pcbi.1004465.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1004465.ref011">11</xref>].</p>
<p>A useful prior knowledge that has been largely ignored in RNA-Seq transcriptome quantification is the relation among the isoform transcripts by the interactions between their protein products. The protein products of different isoforms coded by the same gene may contain different domains interacting with the protein products of the transcripts in other genes. Previous studies suggested that alternative splicing events tend to insert or delete complete protein domains/functional motifs [<xref ref-type="bibr" rid="pcbi.1004465.ref012">12</xref>] to mediate key linkages in protein interaction networks by removal of protein domain-domain interactions [<xref ref-type="bibr" rid="pcbi.1004465.ref013">13</xref>]. The work in [<xref ref-type="bibr" rid="pcbi.1004465.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004465.ref014">14</xref>] also suggested unique patterns in isoform co-expressions. Thus, the abundance of an isoform transcript in a gene can significantly impact the quantification of the transcripts in other genes when their protein products interact with each other to accomplish a common function as illustrated by a real subnetwork in <xref ref-type="fig" rid="pcbi.1004465.g001">Fig 1</xref>, which is constructed based on domain-domain interaction databases [<xref ref-type="bibr" rid="pcbi.1004465.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004465.ref016">16</xref>] and Pfam [<xref ref-type="bibr" rid="pcbi.1004465.ref017">17</xref>]. Motivated by our observation that the protein products of highly co-expressed transcripts are more likely to interact with each other by protein domain-domain binding in four TCGA RNA-Seq datasets (see the section <xref ref-type="sec" rid="sec015">Results</xref>), we constructed two human transcript interaction networks of different sizes based on protein domain-domain interactions to improve transcript quantification. Based on the constructed transcript network, we propose a network-based transcript quantification model called Net-RSTQ to explore domain-domain interaction information for estimating transcript abundance. In the Net-RSTQ model, Dirichlet prior representing prior information in the transcript interaction network is introduced into the likelihood function of observing the short read alignments. The new likelihood function of Net-RSTQ can be alternating-optimized over each gene with expectation maximization (EM). It is important to note that the Dirichlet prior from the neighboring isoforms play two possible roles. On one hand, for the isoforms in the same gene but with different interacting partners, the different prior information will help differentiate their expressions to reflect their different functional roles. On the other hand, for the isoforms in the same gene with the same interacting partners, the uniform prior assumes no difference in their functional roles and thus, promotes a smoother expression patterns across the isoforms. In both cases, the Dirichlet prior captures the functional variations/similarities across the isoforms in each gene as prior information for estimation of their abundance.</p>
<fig id="pcbi.1004465.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.g001</object-id>
<label>Fig 1</label>
<caption>
<title>An isoform transcript network based on protein domain-domain interactions.</title>
<p>(A) The subnetwork shows the domain-domain interactions among transcripts from four human genes, CD79B, CD79A, LCK and SYK. In the network, the nodes represent isoform transcripts, which are further grouped and annotated by their gene name; and the edges represent domain-domain interactions between two transcripts. Each edge is also annotated by the interacting domains in the two transcripts. (B) RefSeq transcript annotations of CD79A and CD79B are shown with Pfam domain marked in color. The Pfam domains were detected with Pfam-Scan software. Note that no interaction is included between transcripts NM_001039933 and NM_000626 of gene CD79B without assuming self-interactions for modeling simplicity. For better visualization, only the interactions coincide with PPI are shown in the figure.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.g001" xlink:type="simple"/>
</fig>
<p>The paper is organized as following. In the section <xref ref-type="sec" rid="sec002">Materials and Methods</xref>, we describe the procedure to construct protein domain-domain interaction networks, the mathematic description of the probabilistic model and the Net-RSTQ algorithm, qRT-PCR experiment design, and RNA-Seq data preparation. In the section <xref ref-type="sec" rid="sec015">Results</xref>, we first demonstrate the correlation between protein domain-domain interactions and isoform transcript co-expressions across samples in four cancer RNA-Seq datasets from The Cancer Genome Atlas (TCGA) to justify using domain-domain interactions as prior knowledge. We then compared the predicted isoform proportions with qRT-PCR experiments on 25 multi-isoform genes in three cell lines, H9 stem cell line, OVCAR8 ovarian cancer cell line and MCF7 breast cancer cell line. Net-RSTQ was also applied to four cancer RNA-Seq datasets to quantify isoform expressions to classify patient samples by the survival or relapse outcomes. In addition, simulations were also performed to measure the statistical robustness of Net-RSTQ over randomized networks.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and Methods</title>
<p>In this section, we first describe the construction of the transcript interaction network and review the base probabilistic model for transcript quantification with RNA-Seq data. We then introduce the network-based transcript quantification model (Net-RSTQ) by applying the protein domain-domain interaction information as prior knowledge. The notations used in the equations are summarized in <xref ref-type="table" rid="pcbi.1004465.t001">Table 1</xref>. At last, qRT-PCR experiment design and RNA-Seq data preparation are explained.</p>
<table-wrap id="pcbi.1004465.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.t001</object-id>
<label>Table 1</label>
<caption>
<title>Notations.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004465.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"><bold>Notation</bold></th>
<th align="left"><bold>Description</bold></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><italic>N</italic></td>
<td align="left">total # of genes</td>
</tr>
<tr>
<td align="center"><bold><italic>T</italic></bold></td>
<td align="left">set of transcripts; <italic>T</italic><sub><italic>ik</italic></sub> is the <italic>k</italic><sup><italic>th</italic></sup> transcript of the <italic>i</italic><sup><italic>th</italic></sup> gene; <bold><italic>T</italic></bold><sub><italic>i</italic></sub> denotes the transcripts of the <italic>i</italic><sup><italic>th</italic></sup> gene</td>
</tr>
<tr>
<td align="center"><italic>l</italic><sub><italic>ik</italic></sub></td>
<td align="left">length of transcript <italic>T</italic><sub><italic>ik</italic></sub></td>
</tr>
<tr>
<td align="center"><bold><italic>r</italic></bold></td>
<td align="left">set of reads; <italic>r</italic><sub><italic>ij</italic></sub> is the <italic>j</italic><sup><italic>th</italic></sup> read aligned to the <italic>i</italic><sup><italic>th</italic></sup> gene; <bold><italic>r</italic></bold><sub><italic>i</italic></sub> is the read set aligned to the <italic>i</italic><sup><italic>th</italic></sup> gene</td>
</tr>
<tr>
<td align="center"><italic>p</italic><sub><italic>ik</italic></sub></td>
<td align="left">the probability of a read generated by transcript <italic>T</italic><sub><italic>ik</italic></sub> in the <italic>i</italic><sup><italic>th</italic></sup> gene</td>
</tr>
<tr>
<td align="center"><bold><italic>P</italic></bold><sub><italic>i</italic></sub></td>
<td align="left">the probability of a read generated by transcript <italic>T</italic><sub><italic>i</italic></sub> in the <italic>i</italic><sup><italic>th</italic></sup> gene, specifically, [<italic>p</italic><sub><italic>i</italic>1</sub>, …, <italic>p</italic><sub><italic>i</italic>,|<bold><italic>T</italic></bold><sub><italic>i</italic></sub>|</sub>]</td>
</tr>
<tr>
<td align="center"><bold><italic>P</italic></bold></td>
<td align="left">concatenate of all <bold><italic>P</italic></bold><sub><italic>i</italic></sub>, specifically, [<bold><italic>P</italic></bold><sub>1</sub>,<bold><italic>P</italic></bold><sub>2</sub>, …,<bold><italic>P</italic></bold><sub><italic>N</italic></sub>]</td>
</tr>
<tr>
<td align="center"><italic>ρ</italic><sub><italic>ik</italic></sub></td>
<td align="left">relative abundance of the transcript <italic>T</italic><sub><italic>ik</italic></sub> in the <italic>i</italic><sup><italic>th</italic></sup> gene</td>
</tr>
<tr>
<td align="center"><bold><italic>π</italic></bold></td>
<td align="left">transcript expression; <italic>π</italic><sub><italic>ik</italic></sub> is the expression of the <italic>k</italic><sup><italic>th</italic></sup> transcript of the <italic>i</italic><sup><italic>th</italic></sup> gene</td>
</tr>
<tr>
<td align="center"><italic>ϕ</italic><sub><italic>ik</italic></sub></td>
<td align="left">average expressions (normalized) of transcript <italic>T</italic><sub><italic>ik</italic></sub>’s neighbors in the transcript network</td>
</tr>
<tr>
<td align="center"><bold><italic>α</italic></bold></td>
<td align="left">parameters of Dirichlet distribution; <italic>α</italic><sub><italic>ik</italic></sub> = λ<italic>ϕ</italic><sub><italic>ik</italic></sub> + 1 is the parameter of the Dirichlet distribution of <italic>p</italic><sub><italic>ik</italic></sub></td>
</tr>
<tr>
<td align="center"><italic>q</italic><sub><italic>ijk</italic></sub></td>
<td align="left">read sampling probability, <inline-formula id="pcbi.1004465.e001"><alternatives><graphic id="pcbi.1004465.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> if read <italic>r</italic><sub><italic>ij</italic></sub> is aligned to transcript <italic>T</italic><sub><italic>ik</italic></sub>, otherwise <italic>q</italic><sub><italic>ijk</italic></sub> = 0</td>
</tr>
<tr>
<td align="center"><bold><italic>S</italic></bold></td>
<td align="left">binary matrix for transcript interaction network</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<sec id="sec003">
<title>Transcript network construction</title>
<p>Two binary transcript networks were constructed by measuring the protein domain-domain interactions (DDI) between the domains in each pair of transcripts in four steps. First, the translated transcript sequences of all human genes were obtained from RefSeq [<xref ref-type="bibr" rid="pcbi.1004465.ref018">18</xref>]. Second, Pfam-Scan was used to search Pfam databases for the matched Pfam domains on each transcript with 1e-5 e-value cutoff [<xref ref-type="bibr" rid="pcbi.1004465.ref017">17</xref>]. Note that only high quality, manually curated Pfam-A entries in the database were used in the search. Third, domain-domain interactions were obtained from several domain-domain interaction databases, and if any domain-domain interaction exists between a pair of transcripts, the two transcripts are connected in the transcript network. Specifically, 6634 interactions between 4346 Pfam domain families from two 3D structure-based DDI datasets (iPfam [<xref ref-type="bibr" rid="pcbi.1004465.ref015">15</xref>] and 3did [<xref ref-type="bibr" rid="pcbi.1004465.ref016">16</xref>]) inferred from the protein structures in Protein Data Bank (PDB) [<xref ref-type="bibr" rid="pcbi.1004465.ref019">19</xref>] were used in the experiments. Besides these highly confident structure-based DDIs, transcript interactions constructed from 2989 predicted high-confidence DDIs and 2537 predicted medium-confidence DDIs in DOMINE [<xref ref-type="bibr" rid="pcbi.1004465.ref020">20</xref>] were also included if the transcript interaction agrees with protein-protein interactions (PPI) in HPRD [<xref ref-type="bibr" rid="pcbi.1004465.ref021">21</xref>].</p>
<p>In the experiments, we focused on the transcripts from two cancer gene lists from the literature for better reliability in annotations. The first smaller transcript network consists of 11736 interactions constructed from the 3D structure-based DDIs and 421 interactions constructed from the predicted DDIs among the 898 transcripts in 397 genes from the first gene list [<xref ref-type="bibr" rid="pcbi.1004465.ref022">22</xref>]. The second larger transcript network contains 711,516 interactions constructed from the 3D structure-based DDIs among 5599 transcripts in 2551 genes in a larger gene list [<xref ref-type="bibr" rid="pcbi.1004465.ref023">23</xref>]. Since inclusion of the predicted DDIs results in a much higher density in the large network, the large network does not include predicted DDIs to prevent too many potential false positive interactions. The characteristics of the two transcript networks are summarized in <xref ref-type="table" rid="pcbi.1004465.t002">Table 2</xref>. The density of the two networks are 3.02% and 4.54% respectively, which are in similar scale with the PPI network. Both networks show high clustering coefficients, suggesting modularity of subnetworks. Note that self-interactions (interactions between transcript(s) in the same gene) are not considered since Net-RSTQ only utilizes positive correlation between the expressions of neighboring transcripts in different genes. For simplicity, Net-RSTQ assumes that self-interactions will not change the transcript quantification of an individual gene in the model.</p>
<table-wrap id="pcbi.1004465.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.t002</object-id>
<label>Table 2</label>
<caption>
<title>Network characteristics.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004465.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="center"># of Gene</th>
<th align="center"># of Transcripts</th>
<th align="center"># of Interactions</th>
<th align="center">Density</th>
<th align="center">Diameter</th>
<th align="center">Avg. # of Neighbors</th>
<th align="center">Avg. Cluster Coefficients</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Small Network</td>
<td align="center">397</td>
<td align="center">898</td>
<td align="center">12157</td>
<td align="char" char=".">3.02%</td>
<td align="center">9</td>
<td align="char" char=".">27.08</td>
<td align="char" char=".">0.3578</td>
</tr>
<tr>
<td align="center">Large Network</td>
<td align="center">2551</td>
<td align="center">5599</td>
<td align="center">711516</td>
<td align="char" char=".">4.54%</td>
<td align="center">9</td>
<td align="char" char=".">254.16</td>
<td align="char" char=".">0.5255</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>In <xref ref-type="fig" rid="pcbi.1004465.g001">Fig 1(A)</xref> a subnetwork of the transcripts in gene CD79A and CD79B with their direct neighbors in the small transcript network is shown. The RefSeq transcript annotations of CD79A and CD79B are shown in <xref ref-type="fig" rid="pcbi.1004465.g001">Fig 1(B)</xref>. In CD79A transcript NM_001783 contains an extra domain pfam07686 while transcript NM_021601 only contains a shorter hit pfam02189. Note that pfam02189 also has the same hit in NM_001783 with an e-value larger than 1e-5. In CD79B transcripts NM_001039933 and NM_000626 contain a domain pfam07686, which is removed in alternative splicing of NM_021602. In the transcript subnetwork shown in <xref ref-type="fig" rid="pcbi.1004465.g001">Fig 1(A)</xref>, the transcripts in CD79A or CD79B have different interaction partners in the network. In the transcripts in CD79A, the expression of NM_021601 will correlate with the transcripts in LCK and SYK, and NM_001783 will correlate with two transcripts in CD79B. The isoform transcripts in LCK and SYK show no different DDIs suggesting there is no functional variation by protein bindings and more similar expression patterns are potentially expected as prior knowledge.</p>
</sec>
<sec id="sec004">
<title>Base model for transcript quantification</title>
<p>We first consider the method proposed in [<xref ref-type="bibr" rid="pcbi.1004465.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1004465.ref025">25</xref>] as the base model for quantification of the transcripts in a single gene. Let <bold><italic>T</italic></bold><sub><italic>i</italic></sub> denote the set of the transcripts in the <italic>i</italic>th gene and <italic>T</italic><sub><italic>ik</italic></sub> be the <italic>k</italic>th transcript in <bold><italic>T</italic></bold><sub><italic>i</italic></sub>. The probability of a read being generated by the transcripts in <bold><italic>T</italic></bold><sub><italic>i</italic></sub> is modeled by a categorical distribution specified by parameters <italic>p</italic><sub><italic>ik</italic></sub>, where <inline-formula id="pcbi.1004465.e002"><alternatives><graphic id="pcbi.1004465.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:msubsup> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and 0 ≤ <italic>p</italic><sub><italic>ik</italic></sub> ≤ 1. For the set of the reads <bold><italic>r</italic></bold><sub><italic>i</italic></sub> aligned to gene <italic>i</italic>, we consider the likelihood of that each of the |<bold><italic>r</italic></bold><sub><italic>i</italic></sub>| short reads is sampled from one of the transcripts to which the read aligns. Specifically, for each read <italic>r</italic><sub><italic>ij</italic></sub> aligned to transcript <italic>T</italic><sub><italic>ik</italic></sub>, the probability of obtaining <italic>r</italic><sub><italic>ij</italic></sub> by sampling from <italic>T</italic><sub><italic>ik</italic></sub>, namely <italic>Pr</italic>(<italic>r</italic><sub><italic>ij</italic></sub>|<italic>T</italic><sub><italic>ik</italic></sub>) is <inline-formula id="pcbi.1004465.e003"><alternatives><graphic id="pcbi.1004465.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>[<xref ref-type="bibr" rid="pcbi.1004465.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004465.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004465.ref027">27</xref>], where <italic>l</italic><sub><italic>r</italic></sub> is the length of the read. Assuming each read is independently sampled from one transcript, the uncommitted likelihood function [<xref ref-type="bibr" rid="pcbi.1004465.ref024">24</xref>] to estimate the parameters <bold><italic>P</italic></bold><sub><italic>i</italic></sub> from the observed read alignments against gene <italic>i</italic> is
<disp-formula id="pcbi.1004465.e004"><alternatives><graphic id="pcbi.1004465.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
This likelihood function is concave but it may contain plateau in the likelihood surface. Therefore, Expectation Maximization (EM) is then applied to obtain the optimal <bold><italic>P</italic></bold><sub><italic>i</italic></sub>. In the EM algorithm, the expectation of read assignments to transcripts were estimated in the E-step and the likelihood function with the expected assignments can be maximized in the M-step to estimate <bold><italic>P</italic></bold><sub><italic>i</italic></sub>. The relative abundance of the transcript <italic>T</italic><sub><italic>ik</italic></sub> in gene <italic>i</italic>, <italic>ρ</italic><sub><italic>ik</italic></sub>, can be derived from
<disp-formula id="pcbi.1004465.e005"><alternatives><graphic id="pcbi.1004465.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mfrac><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:msubsup> <mml:mfrac><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
and the transcript expressions in gene <italic>i</italic>, <italic>π</italic><sub><italic>ik</italic></sub>, can be calculated by
<disp-formula id="pcbi.1004465.e006"><alternatives><graphic id="pcbi.1004465.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>π</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
The base model is applied independently to each individual gene and no relation among the transcripts is considered.</p>
</sec>
<sec id="sec005">
<title>Network-based transcript quantification model</title>
<p>In the Net-RSTQ model, the transcript interaction network <bold><italic>S</italic></bold> based on protein domain-domain interactions is introduced to calculate a prior distribution for estimating <bold><italic>P</italic></bold> jointly across all the genes and all the transcripts. The model assumes that the prior distribution of <bold><italic>P</italic></bold><sub><italic>i</italic></sub> is a Dirichlet distribution specified by parameters <bold><italic>α</italic></bold><sub><italic>i</italic></sub> and each <italic>α</italic><sub><italic>ik</italic></sub> is proportional to the read count by average expression of the transcript <italic>T</italic><sub><italic>ik</italic></sub>’s neighbors in the transcript network <bold><italic>S</italic></bold>. The prior read count <italic>ϕ</italic><sub><italic>ik</italic></sub> is defined as follows,
<disp-formula id="pcbi.1004465.e007"><alternatives><graphic id="pcbi.1004465.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">π</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mfrac><mml:msub><mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>∑</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <bold><italic>S</italic></bold><sub>*,(<italic>i</italic>,<italic>k</italic>)</sub> is a binary vector represents the neighborhood of transcript <italic>T</italic><sub><italic>ik</italic></sub> in transcript network <bold><italic>S</italic></bold> and ∑(<bold><italic>S</italic></bold><sub>*,(<italic>i</italic>,<italic>k</italic>)</sub>) is the size of the neighborhood. The calculation of each <italic>ϕ</italic><sub><italic>ik</italic></sub> is illustrated in <xref ref-type="fig" rid="pcbi.1004465.g002">Fig 2</xref>. The Dirichlet parameter <bold><italic>α</italic></bold><sub><italic>i</italic></sub> is defined as a function of <italic>ϕ</italic><sub><italic>ik</italic></sub> as
<disp-formula id="pcbi.1004465.e008"><alternatives><graphic id="pcbi.1004465.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where λ &gt; 0 is a tuning parameter balancing the belief between the prior-read count and the aligned-read count.</p>
<fig id="pcbi.1004465.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Transcript interaction neighborhood.</title>
<p>In this toy example, transcript <italic>T</italic><sub><italic>ik</italic></sub> has four neighbor transcripts {<italic>T</italic><sub><italic>g</italic><sub>1</sub> <italic>a</italic></sub>, <italic>T</italic><sub><italic>g</italic><sub>2</sub> <italic>b</italic></sub>, <italic>T</italic><sub><italic>g</italic><sub>3</sub> <italic>c</italic></sub>, <italic>T</italic><sub><italic>g</italic><sub>4</sub> <italic>d</italic></sub>}, which are transcripts from <italic>g</italic><sub>1</sub>, <italic>g</italic><sub>2</sub>, <italic>g</italic><sub>3</sub> and <italic>g</italic><sub>4</sub>, respectively. The neighborhood expression <italic>ϕ</italic><sub><italic>ik</italic></sub> of <italic>T</italic><sub><italic>ik</italic></sub> is then calculated as the average of its neighbor transcripts’ expressions and further normalized by transcript length, represented as the vector product between <bold><italic>π</italic></bold> and <bold><italic>S</italic></bold><sub>*,(<italic>i</italic>,<italic>k</italic>)</sub> normalized by the number of neighbors ∑<bold><italic>S</italic></bold><sub>*,(<italic>i</italic>,<italic>k</italic>)</sub> and the transcript length <italic>l</italic><sub><italic>ik</italic></sub> in the figure.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.g002" xlink:type="simple"/>
</fig>
<p>To obtain the optimal <bold><italic>P</italic></bold> jointly for all genes, we introduce a pseudo-likelihood model to estimate <bold><italic>P</italic></bold> iteratively in each iteration. Assuming uniform <italic>Pr</italic>(<bold><italic>r</italic></bold><sub><italic>i</italic></sub>), the pseudo-likelihood function is defined as,
<disp-formula id="pcbi.1004465.e009"><alternatives><graphic id="pcbi.1004465.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>∝</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
Note that the pseudo-likelihood model relies on the independence assumption among the likelihood functions of each individual gene when the <bold><italic>α</italic></bold> parameters of the Dirichlet priors are pre-computed. Thus, the model simply takes the product of the likelihood function from each gene. Each prior distribution <italic>Pr</italic>(<bold><italic>P</italic></bold><sub><italic>i</italic></sub>|<bold><italic>α</italic></bold><sub><italic>i</italic></sub>) follows the Dirichlet distribution,
<disp-formula id="pcbi.1004465.e010"><alternatives><graphic id="pcbi.1004465.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msup><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mtext>where</mml:mtext> <mml:mspace width="2pt"/><mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>Γ</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mo>∏</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mi>Γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p>Integrating eqs (<xref ref-type="disp-formula" rid="pcbi.1004465.e004">1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004465.e010">7</xref>), the pseudo-likelihood function in <xref ref-type="disp-formula" rid="pcbi.1004465.e009">eq (6)</xref> can be rewritten with Dirichlet prior as
<disp-formula id="pcbi.1004465.e011"><alternatives><graphic id="pcbi.1004465.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mfenced close="]" open="[" separators=""><mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msup><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi mathvariant="italic">α</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mfenced> <mml:mspace width="1pt"/><mml:mfenced close="]" open="[" separators=""><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mfenced close="]" open="[" separators=""><mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msup><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mfenced> <mml:mspace width="1pt"/><mml:mfenced close="]" open="[" separators=""><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula></p>
<p>In the pseudo-likelihood function in <xref ref-type="disp-formula" rid="pcbi.1004465.e011">eq (8)</xref>, the only hyper-parameter λ balances the proportion between the Dirichlet priors and the observed read counts of each transcript. The larger the λ, the more belief put on the priors.</p>
</sec>
<sec id="sec006">
<title>The Net-RSTQ algorithm</title>
<p>The Net-RSTQ algorithm optimizes <xref ref-type="disp-formula" rid="pcbi.1004465.e011">eq (8)</xref> by dividing the optimization into sub-optimization problems of sequentially estimating each <bold><italic>P</italic></bold><sub><italic>i</italic></sub>. Specifically, we fix all <bold><italic>P</italic></bold><sub><italic>c</italic></sub>, <italic>c</italic> ≠ <italic>i</italic>, and thus <bold><italic>ϕ</italic></bold><sub><italic>i</italic></sub> when estimating <bold><italic>P</italic></bold><sub><italic>i</italic></sub> with EM in each iteration and repeat the process multiple rounds throughout all the genes. In each step, the neighborhood expression <bold><italic>ϕ</italic></bold> is recomputed with new <bold><italic>P</italic></bold><sub><italic>i</italic></sub> for computing the quantification of the next gene. For each sub-optimization problem, we estimate <bold><italic>P</italic></bold><sub><italic>i</italic></sub> with a fixed <bold><italic>ϕ</italic></bold>, the part of the likelihood function in <xref ref-type="disp-formula" rid="pcbi.1004465.e011">eq (8)</xref> involved with the current variables <bold><italic>P</italic></bold><sub><italic>i</italic></sub> is
<disp-formula id="pcbi.1004465.e012"><alternatives><graphic id="pcbi.1004465.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">ϕ</mml:mi> <mml:mi>g</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>g</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msup><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mfenced> <mml:mspace width="1pt"/><mml:mfenced close="]" open="[" separators=""><mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msup><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mfenced> <mml:mspace width="1pt"/><mml:mfenced close="]" open="[" separators=""><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <bold><italic>nb</italic></bold>(<italic>i</italic>) is the set of the genes containing transcripts that are neighbors of the transcripts in gene <italic>i</italic> in the transcript network. <xref ref-type="disp-formula" rid="pcbi.1004465.e012">Eq (9)</xref> consists of three terms separated by the braces. The second and the third terms are the Dirichlet prior and the likelihood of the observed counts in the data for gene <italic>i</italic>. The first term is the Dirichlet priors of the neighbor transcripts of each <italic>T</italic><sub><italic>ik</italic></sub>. These prior probabilities are involved since <bold><italic>ϕ</italic></bold><sub><italic>g</italic></sub> are functions of the current variable <bold><italic>P</italic></bold><sub><italic>i</italic></sub> (eqs (<xref ref-type="disp-formula" rid="pcbi.1004465.e006">3</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1004465.e008">5</xref>)). <xref ref-type="disp-formula" rid="pcbi.1004465.e012">Eq (9)</xref> cannot be easily solved with standard techniques. We adopt a heuristic approach to only take steps that will increase the whole pseudo-likelihood function in <xref ref-type="disp-formula" rid="pcbi.1004465.e011">eq (8)</xref>. The Net-RSTQ algorithm is outlined below</p>
<p specific-use="line"><bold>Algorithm 1</bold> Net-RSTQ</p>
<p specific-use="line">1: <bold>Initialization</bold>: random initialization or base EM (<xref ref-type="disp-formula" rid="pcbi.1004465.e004">eq (1)</xref>) estimation of <bold><italic>P</italic></bold><sup>(0)</sup></p>
<p specific-use="line">2: <bold>for</bold> round <italic>t</italic> = 1, … <bold>do</bold></p>
<p specific-use="line">3:  <bold><italic>P</italic></bold><sup>(<italic>t</italic>)</sup> = <bold><italic>P</italic></bold><sup>(<italic>t</italic> − 1)</sup></p>
<p specific-use="line">4:  <bold>for</bold> gene <italic>i</italic> = 1, …, <italic>N</italic> <bold>do</bold></p>
<p specific-use="line">5:   compute <bold><italic>ϕ</italic></bold><sub><italic>i</italic></sub> based on <bold><italic>P</italic></bold><sup>(<italic>t</italic>)</sup> with eqs (<xref ref-type="disp-formula" rid="pcbi.1004465.e006">3</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004465.e007">4</xref>)</p>
<p specific-use="line">6:   estimate <bold><italic>P</italic></bold><sub><italic>i</italic></sub> with EM algorithm (see next section)</p>
<p specific-use="line">7:   <bold>if</bold> <inline-formula id="pcbi.1004465.e013"><alternatives><graphic id="pcbi.1004465.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&gt;</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> <bold>then</bold></p>
<p specific-use="line">8:    <inline-formula id="pcbi.1004465.e014"><alternatives><graphic id="pcbi.1004465.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
<p specific-use="line">9:   <bold>end if</bold></p>
<p specific-use="line">10:  <bold>end for</bold></p>
<p specific-use="line">11:  <bold>if</bold> <italic>max</italic>(<italic>abs</italic>(<bold><italic>P</italic></bold><sup>(<italic>t</italic>)</sup> − <bold><italic>P</italic></bold><sup>(<italic>t</italic> − 1)</sup>))&lt;1e-6 <bold>then</bold></p>
<p specific-use="line">12:   <bold>break</bold></p>
<p specific-use="line">13:  <bold>end if</bold></p>
<p specific-use="line">14: <bold>end for</bold></p>
<p specific-use="line">15: <bold>return</bold> <bold><italic>P</italic></bold></p>
<p>In the algorithm, the outer for-loop between line 2–14 performs multiple passes of updating <bold><italic>P</italic></bold>. The inner for-loop between line 4–10 scans through each gene to update each <bold><italic>P</italic></bold><sub><italic>i</italic></sub>. Line 7 checks the the difference in the likelihood <inline-formula id="pcbi.1004465.e015"><alternatives><graphic id="pcbi.1004465.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> of gene <italic>i</italic> before and after the estimated <bold><italic>P</italic></bold><sub><italic>i</italic></sub> is applied. The newly estimated <bold><italic>P</italic></bold><sub><italic>i</italic></sub> is kept in line 8 only if the likelihood <inline-formula id="pcbi.1004465.e016"><alternatives><graphic id="pcbi.1004465.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1004465.e012">eq (9)</xref> is higher. The convergence of <bold><italic>P</italic></bold> is checked at line 11. In each sub-optimization problem, EM algorithm (described in the next section) is applied to estimate <bold><italic>P</italic></bold><sub><italic>i</italic></sub>. After convergence, the transcripts expression <bold><italic>π</italic></bold> can be learned by <xref ref-type="disp-formula" rid="pcbi.1004465.e006">eq (3)</xref> with the optimal <bold><italic>P</italic></bold>.</p>
</sec>
<sec id="sec007">
<title>Estimating <bold><italic>P</italic></bold><sub><italic>i</italic></sub> given <bold><italic>ϕ</italic></bold><sub><italic>i</italic></sub></title>
<p>In line 6 of Algorithm 1, we maximize the likelihood function of the sub-optimization problem in <xref ref-type="disp-formula" rid="pcbi.1004465.e012">eq (9)</xref> to learn <bold><italic>P</italic></bold><sub><italic>i</italic></sub> as
<disp-formula id="pcbi.1004465.e017"><alternatives><graphic id="pcbi.1004465.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msup><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mfenced> <mml:mspace width="1pt"/><mml:mfenced close="]" open="[" separators=""><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
Note that <xref ref-type="disp-formula" rid="pcbi.1004465.e017">eq (10)</xref> is the part of <xref ref-type="disp-formula" rid="pcbi.1004465.e012">eq (9)</xref> without the Dirichlet priors of the neighboring genes. In line 7 of Algorithm 1, the ignored Dirichlet priors are combined with the likelihood in <xref ref-type="disp-formula" rid="pcbi.1004465.e017">eq (10)</xref>, when <inline-formula id="pcbi.1004465.e018"><alternatives><graphic id="pcbi.1004465.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is computed, to evaluate the whole likelihood in <xref ref-type="disp-formula" rid="pcbi.1004465.e012">eq (9)</xref>. The likelihood function in <xref ref-type="disp-formula" rid="pcbi.1004465.e017">eq (10)</xref> is defined on a categorical variable with Dirichlet prior, which can be solved with EM algorithm. Following EM formulation in [<xref ref-type="bibr" rid="pcbi.1004465.ref026">26</xref>], the expectation <italic>a</italic><sub><italic>ijk</italic></sub>, a soft assignment of read <italic>j</italic> to transcript <italic>k</italic> in gene <italic>i</italic>, is first estimated in the expectation step and <bold><italic>P</italic></bold><sub><italic>i</italic></sub> is then learned in the maximization step. When <italic>ϕ</italic><sub><italic>i</italic></sub> is given, by taking log of <xref ref-type="disp-formula" rid="pcbi.1004465.e017">eq (10)</xref> we can write the EM steps to find <bold><italic>P</italic></bold><sub><italic>i</italic></sub> below.</p>
<sec id="sec008">
<title>E step</title>
<p>Letting <bold><italic>Match</italic></bold> signify a matching between reads and transcripts, and <italic>Match(j)</italic> be the transcript from which read <italic>j</italic> originates, we get:
<disp-formula id="pcbi.1004465.e019"><alternatives><graphic id="pcbi.1004465.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mo>[</mml:mo> <mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mi mathvariant="bold-italic">a</mml:mi> <mml:mi mathvariant="bold-italic">t</mml:mi> <mml:mi mathvariant="bold-italic">c</mml:mi> <mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>M</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi> <mml:mi>h</mml:mi> <mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>M</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi> <mml:mi>h</mml:mi> <mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
which leads to
<disp-formula id="pcbi.1004465.e020"><alternatives><graphic id="pcbi.1004465.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mi mathvariant="bold-italic">a</mml:mi> <mml:mi mathvariant="bold-italic">t</mml:mi> <mml:mi mathvariant="bold-italic">c</mml:mi> <mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow> <mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where <italic>it</italic> is the <italic>it</italic><sup><italic>th</italic></sup> iteration in EM and
<disp-formula id="pcbi.1004465.e021"><alternatives><graphic id="pcbi.1004465.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula></p>
</sec>
<sec id="sec009">
<title>M step</title>
<p>Given that <italic>q</italic><sub><italic>ijk</italic></sub> and <italic>ϕ</italic><sub><italic>i</italic></sub> are known, the above reduces to maximizing
<disp-formula id="pcbi.1004465.e022"><alternatives><graphic id="pcbi.1004465.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo form="prefix">arg</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:munder> <mml:mfenced close="]" open="[" separators=""><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mi>l</mml:mi> <mml:mi>o</mml:mi> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:munderover> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mi>l</mml:mi> <mml:mi>o</mml:mi> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
Using Lagrange multipliers and differentiating, <xref ref-type="disp-formula" rid="pcbi.1004465.e022">eq (14)</xref> is maximized when
<disp-formula id="pcbi.1004465.e023"><alternatives><graphic id="pcbi.1004465.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:msubsup> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:msubsup> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
After EM algorithm converges, we update <bold><italic>P</italic></bold> with the newly estimated <bold><italic>P</italic></bold><sub><italic>i</italic></sub> only if the update leads to increase of <xref ref-type="disp-formula" rid="pcbi.1004465.e012">eq (9)</xref>. It can be seen from <xref ref-type="disp-formula" rid="pcbi.1004465.e023">eq (15)</xref> that the role of λ is a parameter controlling the balance between the prior-read count and the aligned-read count. To see that, recall <italic>ϕ</italic><sub><italic>ik</italic></sub> is the prior-read count of transcript <italic>T</italic><sub><italic>ik</italic></sub> by the average expression of its neighbors (<xref ref-type="disp-formula" rid="pcbi.1004465.e007">eq (4)</xref>) and <inline-formula id="pcbi.1004465.e024"><alternatives><graphic id="pcbi.1004465.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004465.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:msubsup> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the expected aligned-read count of transcript <italic>T</italic><sub><italic>ik</italic></sub>. λ directly balances the contributions from the two terms. Therefore, a reasonable choice of λ should apply to RNA-Seq data with similar level of noise or bias in general.</p>
</sec>
</sec>
<sec id="sec010">
<title>qRT-PCR experiment design</title>
<p>Three qRT-PCR experiments are designed to measure the isoform proportions of 25 multi-isoform genes in three cell lines, H9 stem cell line, OVCAR8 ovarian cancer cell line and MCF7 breast cancer cell line. The cell lines were selected based on the available of both RNA-Seq data and cell culture in our labs. The qRT-PCR experiments focused on the gene with most different quantification results reported by Net-RSTQ and other compared methods. Due to the limitations in time and cost of running qRT-PCR experiments, only the 25 genes in the three cell lines were tested with all the results reported in the experiments. Quantitation of the real-time PCR results was done on the data from H9 human embryonic stem cells to obtain the absolute expressions for comparing more than two transcripts and comparative Ct method was done on the data from OVCAR8 ovarian cancer cells and MCF7 breast cancer cells to obtain the ratio between a pair of transcripts.</p>
<sec id="sec011">
<title>H9 Stem cell line</title>
<p>Total RNA was extracted from human embryonic stem (ES) H9 cells by using TRIzol (Invitrogen). To repeat the experiments of triplicate three times, 5<italic>μ</italic>g RNA was used to synthesize complementary DNA with ReverTra Ace (Toyobo) and oligo-dT (Takara) according to the manufacturer’s instructions. Transcript levels of genes were determined by using Premix Ex Taq (Takara) and analysed with a CFX-96 Real Time system (Bio-Rad). The templates for different transcripts were generated with PCR by using the template primers in <xref ref-type="supplementary-material" rid="pcbi.1004465.s008">S1 Table</xref>. After isolation and purification, the templates were used to generate the standard curves with qRT-PCR by using the qRT-PCR primers for different transcripts. The generated standard curves have coefficient of determination (R2) over 0.999. The qRT-PCR primers were then applied to determine the expression levels of different transcripts in H9 ES cells by calculating with the standard curves. The expressions were carried out in three independent replications and the standard deviations were provided after the average.</p>
</sec>
<sec id="sec012">
<title>Ovarian cancer cell line</title>
<p>1<italic>μ</italic>g of total RNAs were isolated from untreated OVCAR8 cells using Trizol (Invitrogen). RNA was reverse-transcribed using Superscript II reverse transcriptase (Invitrogen) according to manufacture protocol. Real-time PCR was performed on CFX384 Real-time system (Bio-Rad) with FastStart SYBR Green Master (Roche) with the primer sets in <xref ref-type="supplementary-material" rid="pcbi.1004465.s009">S2 Table</xref>. PCR conditions are 10 min at 95°C and 40 cycles of 95°C for 45 sec and 60°C for 45 sec. Quantitation of the real-time PCR results was done using comparative Ct method. Two replicates of qRT-PCR were performed using total RNAs isolated.</p>
</sec>
<sec id="sec013">
<title>Breast cancer cell line</title>
<p>0.5<italic>μ</italic>g of total RNAs purified from MCF7 cells was used for oligo d(T)<sub>20</sub>-primed reverse transcription (Superscript III; Life Technologies). SYBR Green was used to detect and quantitate PCR products in real-time reactions with the primer sets in <xref ref-type="supplementary-material" rid="pcbi.1004465.s010">S3 Table</xref>. PCR conditions for qRT-PCR analysis are 2 min 94°C and 40 cycles of 94°C for 30 sec, 60°C for 20 sec and 72°C for 30 sec. Quantitation of the real-time PCR results was done using comparative Ct method. GAPDH mRNA was used as a normalization control for quantitation. Three replicates of qRT-PCR were performed using total RNAs isolated.</p>
</sec>
</sec>
<sec id="sec014">
<title>RNA-Seq data preparation</title>
<p>Three cell line RNA-Seq datasets were used for evaluating the accuracy of transcript quantification by comparison with qRT-PCR results. The first dataset is the H9 embryonic stem cell line data from [<xref ref-type="bibr" rid="pcbi.1004465.ref028">28</xref>], downloaded from SRA. The second dataset is an in-house dataset from the ovarian cancer cell line OVCAR8 prepared at University of Kansas Medical Center. The third dataset is the MCF7 breast cancer cell line data from [<xref ref-type="bibr" rid="pcbi.1004465.ref029">29</xref>], downloaded from SRA. There are 23,397,325 single-end 34bp reads in the stem cell line dataset, 19,892,473 paired-end 100bp reads in the OVCAR8, and 21,855,632 paired-end 76bp reads in the MCF7 mapped to the human hg19 reference genome by TopHat2.0.9 [<xref ref-type="bibr" rid="pcbi.1004465.ref030">30</xref>] with up to 2 mismatches allowed. Exon coverages and read counts of exon-exon junctions were generated by SAMtools [<xref ref-type="bibr" rid="pcbi.1004465.ref031">31</xref>] to be utilized with Net-RSTQ and base EM (<xref ref-type="disp-formula" rid="pcbi.1004465.e004">eq (1)</xref>). Cufflinks [<xref ref-type="bibr" rid="pcbi.1004465.ref032">32</xref>] directly infers transcript expressions based on the alignment by TopHat with the min isoform fraction set to 0 for better sensitivity.</p>
<p>TCGA RNA-Seq datasets of Ovarian serous cystadenocarcinoma (OV), Breast invasive carcinoma (BRCA), Lung adenocarcinoma (LUAD) and Lung squamous cell carcinoma (LUSC) were analyzed for patient outcome prediction with transcript expressions estimated by Net-RSTQ, base EM (<xref ref-type="disp-formula" rid="pcbi.1004465.e004">eq (1)</xref>), RSEM [<xref ref-type="bibr" rid="pcbi.1004465.ref033">33</xref>] and Cufflinks [<xref ref-type="bibr" rid="pcbi.1004465.ref032">32</xref>]. Both the gene expression and transcript expression data reported by RSEM [<xref ref-type="bibr" rid="pcbi.1004465.ref033">33</xref>] in TCGA (level 3 data) were utilized as two baselines for cancer outcome prediction. The raw RNA-Seq fastq files (level 1 data) were downloaded from Cancer Genomics Hub (CGHub) and processed by TopHat for use with Net-RSTQ, base EM and Cufflinks. The patient samples in each dataset were classified into cases and controls based on the survival and relapse outcomes as shown in <xref ref-type="table" rid="pcbi.1004465.t003">Table 3</xref>. The command lines for preparing the data with RSEM and Cufflinks are available in the <xref ref-type="supplementary-material" rid="pcbi.1004465.s003">S3 Text</xref>.</p>
<table-wrap id="pcbi.1004465.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.t003</object-id>
<label>Table 3</label>
<caption>
<title>Summary of patient samples in TCGA datasets.</title>
<p>The samples are classified by cutoffs on survival and relapse time based on the available clinical information in each dataset.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004465.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"><bold>Cancer Type</bold></th>
<th align="left"><bold>Event</bold></th>
<th align="left"><bold># of Patients by years</bold></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Ovarian serous cystadenocarcinoma(OV)</td>
<td align="left">Survival</td>
<td align="left">76(&lt;3 ys) <bold>vs</bold> 62(&gt;4 ys)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Relapse</td>
<td align="left">79(&lt;1.5 ys) <bold>vs</bold> 68(&gt;2 ys)</td>
</tr>
<tr>
<td align="left">Breast invasive carcinoma(BRCA)</td>
<td align="left">Survival</td>
<td align="left">66(&lt;5 ys) <bold>vs</bold> 57(&gt;8 ys)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Relapse</td>
<td align="left">42(&lt;5 ys) <bold>vs</bold> 38(&gt;8 ys)</td>
</tr>
<tr>
<td align="left">Lung adenocarcinoma(LUAD)</td>
<td align="left">Survival</td>
<td align="left">47(&lt;2 ys) <bold>vs</bold> 56(&gt;3 ys)</td>
</tr>
<tr>
<td align="left">Lung squamous cell carcinoma(LUSC)</td>
<td align="left">Survival</td>
<td align="left">67(&lt;2 ys)<bold>vs</bold> 77 (&gt;3 ys)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="sec015" sec-type="results">
<title>Results</title>
<p>There are six major results in this section, 1) isoform co-expression analysis on TCGA data to show the correlation with protein domain-domain interactions; 2) overlapping the DDIs and KEGG pathways to understand the transcript networks; 3) simulations for model validation and statistical analysis; 4) qRT-PCR experiments to measure the performance of transcript quantification; 5) cancer outcome prediction on TCGA data to measure the quality of transcript quantification as molecular markers; and 6) running time of Net-RSTQ.</p>
<p>Net-RSTQ was compared with base EM (the base model in <xref ref-type="disp-formula" rid="pcbi.1004465.e004">eq (1)</xref>), Cufflinks [<xref ref-type="bibr" rid="pcbi.1004465.ref032">32</xref>] and RSEM (isoform expression or gene expression) [<xref ref-type="bibr" rid="pcbi.1004465.ref033">33</xref>]. The accuracy of transcript quantification was directly measured on the simulated data with ground-truth expressions and qRT-PCR data from the three cell lines. Cancer outcome prediction on four TCGA cancer datasets evaluates the potential of using isoform expressions as predictive biomarkers in clinical settings. Statistical assessment was also performed on randomized transcript networks to evaluate the significance of the results.</p>
<sec id="sec016">
<title>Isoform co-expressions correlate with protein domain-domain interactions</title>
<p>To investigate the correlation between protein domain-domain interactions and isofrom transcript co-expressions, we calculated the number of transcript pairs that are both nearby (being neighbors or having a distance up to 2) in the transcript network and highly co-expressed in the TCGA samples. The transcript co-expressions were calculated by Pearson’s correlation coefficients of each pair of transcripts across all the samples in each dataset with the isoform transcript quantification by Cufflinks. The transcript pairs were then sorted by the correlation coefficients from the largest to the smallest and grouped into bins of size 1000. The number of transcript pairs that are nearby in the transcript networks out of 1000 pairs are calculated within each bin and plotted in <xref ref-type="fig" rid="pcbi.1004465.g003">Fig 3(A) and 3(B)</xref> for the two cancer gene lists, respectively. In both <xref ref-type="fig" rid="pcbi.1004465.g003">Fig 3(A) and 3(B)</xref>, the left column shows the plots of the number of pairs that are neighbors in the transcript network, and the right column shows the plots of the number of transcript pairs with a distance up to 2 in the transcript network, among the 1000 pairs in each bin. In all the plots, similar trends are observed in all the four cancer datasets: there are more interacting isoform pairs in the bins with higher co-expressions. For example, among the 1000 transcript pairs with the highest correlation coefficients, there are 73 interactions in the transcript network in OV dataset and thus, 73 interactions (y-axis) for bin index 1 (x-axis) is plotted in the left column of <xref ref-type="fig" rid="pcbi.1004465.g003">Fig 3(A)</xref>. In all the plots, there is a clear pattern that the numbers of matched nearby transcripts in the transcript network among the 1000 pairs in the first few bins are higher than the expected average of 30 in the small network of density 3.02%, 114 in the small network of density 11.41% (with distance up to 2), 45 in the larger network of density 4.54%, and 203 in the larger network of density 20.33% (with distance up to 2). Moreover, the 2-step walk clearly promoted the number of overlaps with the pairs of higher co-expressions in the small network. For example, the significant overlap is extended from the first 25 bins to approximately the first 50 bins or more in the four datasets. The observation suggests that higher co-expressions exist not only in the direct neighbors in the transcript network but also the nearby nodes by a small distance. By exploring the network structure with prior information through neighbors by many steps in iterations, Net-RSTQ model is expected to propagate the expression values from each transcript to its nearby nodes in the network to capture the co-expressions. Note that considering the neighboring pairs with distance up to 2 in the larger network will result in a graph of density 20.33%, which is likely to contain too many false relations by the two-step walk. Thus, the plots of the larger network of distance-2 pairs are only included for the completeness of the analysis.</p>
<fig id="pcbi.1004465.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Correlation between transcript co-expression and protein domain-domain interaction in TCGA datasets.</title>
<p>The correlation coefficients between transcript expressions across all patient samples are first calculated in each dataset for each pair of transcripts by Cufflinks. The correlation coefficients are then sorted from largest to smallest and grouped into bins of size 1000 each. The x-axis is the index of the bins with lower index indicating larger correlation coefficients. The y-axis is the number of the pairs among the 1000 pairs of transcripts in each bin that coincide with protein domain-domain interaction between the transcript pair. The red line is the smooth plot by fitting local linear regression method with weighted linear least squares (LOWESS) to the curves. <italic>p</italic>-value is reported by chi-square test. (A) Co-expressions are calculated based on the small gene list. (B) Co-expressions are calculated based on the large gene list. In both (A) and (B), the left column shows the plots based on the connected transcript pairs in the transcript network and the right column shows the plots based on the transcript pairs with distance up to 2 in the network.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.g003" xlink:type="simple"/>
</fig>
<p>The canonical 2x2 chi-square test was also applied to compare the number of the domain-domain interactions in the first 10,000 transcript pairs (first 10 bins) with the number in the rest of the pairs. In all the four datasets in both <xref ref-type="fig" rid="pcbi.1004465.g003">Fig 3(A) and 3(B)</xref> with one exception in the LUSC dataset on the large network of distance-2 relation, there is a significant difference that the highly co-expressed transcripts are more likely to interact with each other in the transcript network, confirmed by the significant <italic>p</italic>-values. As explained previously, the exception is likely due to the large number of false-positive pairs in the dense network. The observation further support the hypothesis that protein domain-domain interactions correlate transcript co-expressions reported in previous studies [<xref ref-type="bibr" rid="pcbi.1004465.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004465.ref013">13</xref>].</p>
<p>To further understand the specificity of the domain-domain interactions in the highly co-expressed transcripts, we calculated the number of domain-domain pairs that construct the DDIs in the top 10,000 co-expressed transcript pairs. The statistics suggest high diversity of the type of DDIs. For example, there are 547 interacting transcript pairs among the 201 out of 898 transcripts in the top 10,000 co-expressed transcript pairs in OV dataset for small network. The 547 interacting transcript pairs represent 770 different domain-domain interactions (There might be more than one DDIs between a pair of transcripts). There are 739 interacting transcript pairs among the 538 out of 5599 transcripts in the top 10,000 co-expressed transcript pairs in OV dataset for large network. The 739 interacting transcript pairs represent 1277 different domain-domain interactions. The statistics suggest that the correlation between protein domain-domain interactions and transcript co-expressions is not a bias due to a few highly spurious DDIs. It is a general correlation in many different DDIs and co-expressed transcripts. Very similar statistics were observed in all the datasets and both networks.</p>
<p>To further demonstrate the co-expression relations in the transcript network, two examples are shown in <xref ref-type="supplementary-material" rid="pcbi.1004465.s004">S1 Fig</xref>. In <xref ref-type="supplementary-material" rid="pcbi.1004465.s004">S1(A) Fig</xref>, WHSC1L1 contains two isoforms connected with different interactions in the transcript network. Isoform NM_017778 interacts with 12 transcripts with average correlation coefficients 0.22 and the other isoform NM_023034 interacts with 13 more transcripts with average correlation coefficients 0.30 compared with the average correlation coefficient 0.188 against the other unconnected isoforms across the samples in the OV dataset. In <xref ref-type="supplementary-material" rid="pcbi.1004465.s004">S1(B) Fig</xref>, gene BRD4 contains two isoforms both of which are connected with the same 14 neighbors in the network. The average correlation coefficients between these two isoforms and the 14 neighboring isoforms are both above 0.26 compared with the average correlation coefficient less than 0.15 against the other unconnected isoforms across the samples on the BRCA dataset. In both examples, we observed high degree of agreement between co-expressions and DDIs.</p>
</sec>
<sec id="sec017">
<title>Protein domain-domain interactions enrich KEGG pathways</title>
<p>To further understand the transcript networks, we overlapped the DDIs between genes in the two networks with the 294 human KEGG pathways [<xref ref-type="bibr" rid="pcbi.1004465.ref034">34</xref>]. Among the 397 genes in the small network, 10.97%(17284) of the pairs are co-members in at least one KEGG pathway. The 10.97% KEGG co-member pairs covers 42.70%(2122) of the DDIs among the genes while the other 89.03%(140352) non-co-member pairs covers 57.30%(2748) of the DDIs. By these numbers, there is about 6-fold enrichment of DDIs in the KEGG co-member genes in the small network. Among the 2551 genes in the large network, the 5.15%(335372) KEGG co-member pairs covers 12.45%(40812) of the DDIs among genes while the other 94.85%(6172229) non-co-member pairs covers 87.55%(287090) of the DDIs. By these numbers, there is about 2.6-fold enrichment of DDIs in the KEGG co-member genes in the large network. We also list the KEGG pathways that are highly enriched with DDIs in the large network in <xref ref-type="supplementary-material" rid="pcbi.1004465.s011">S4 Table</xref>. Specifically, we consider the subnetwork of genes that are members of one KEGG pathway and calculated the density of DDIs in the subnetwork to compare to the overall density of 5.04% in the whole network. Interestingly, most of the enriched pathways are signaling pathways and disease pathways with very high DDI densities.</p>
</sec>
<sec id="sec018">
<title>Net-RSTQ captures network prior in simulations</title>
<p>In the simulations, we applied flux-simulator [<xref ref-type="bibr" rid="pcbi.1004465.ref035">35</xref>] to generate paired-end short reads simulating real RNA-Seq experiment <italic>in silico</italic> based on a ground truth transcript expression profile, using hg19 reference human genome and RefSeq annotations downloaded from UCSC Genome Browser. To generate the ground-truth expression profiles, the gene expressions were sampled from a poisson distribution and the proportions of the isoforms in each gene were derived based on a neighbor average expression in the small transcript network and an initial mixed power law expression profile with gaussian noise. A sequential updating was used to compute the proportion of each isoform by adding the neighbors’ average expressions to the initial expression. The update procedure can be found in the <xref ref-type="supplementary-material" rid="pcbi.1004465.s002">S2 Text</xref>. At last, flux-simulator was applied to simulate the short reads based on the ground truth transcript expression file. 15 million 76-bp paired reads were generated by Flux Simulator and mapped to the reference genome by TopHat [<xref ref-type="bibr" rid="pcbi.1004465.ref030">30</xref>] with up to two mismatches allowed. To account for the large dynamic range of abundances, the expressions were normalized by log2(expression+1).</p>
<p>The correlation coefficients between the transcript abundances estimated by Net-RSTQ under various λ, base EM (<xref ref-type="disp-formula" rid="pcbi.1004465.e004">eq (1)</xref>), Cufflinks and RSEM, and the ground truth transcript abundances are reported in <xref ref-type="fig" rid="pcbi.1004465.g004">Fig 4</xref>. Furthermore, Net-RSTQ was also tested with 100 randomized networks with permuted indexes of transcripts in the transcript network. To assess the impact of the network prior, two cases are shown. <xref ref-type="fig" rid="pcbi.1004465.g004">Fig 4(A)</xref> reports the correlation between the transcripts in which isoforms coded by the same gene are connected with different neighbors (109 out of 898 transcripts in 29 genes). <xref ref-type="fig" rid="pcbi.1004465.g004">Fig 4(B)</xref> reports the results from all the genes with more than one isoform (712 out of 898 transcripts in 211 genes). In both comparisons, the transcript expressions estimated by Net-RSTQ achieve higher correlation with the ground truth compared with base EM, Cufflinks and RSEM. Slightly higher improvement was observed in the first case than in the second case since the network prior plays more significant role in differentiating the isoform expressions by their different neighbors. When randomized networks are used, Net-RSTQ leads to similar or worse results due to the wrong prior information. Note that since the datasets were generated to partially conform to the network prior, the isoform expressions are relatively “smooth” among the neighboring isoforms. Net-RSTQ tends to generate smoother expressions than base EM, Cufflinks and RSEM. When applying Net-RSTQ with small λs and randomized network priors, slight improvement was also observed due to the smoothness assumption on the data.</p>
<fig id="pcbi.1004465.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Correlation between estimated transcript expressions and ground truth in simulation.</title>
<p>In (A) and (B) x-axis are labeled by the compared methods and different λ parameters of Net-RSTQ. The bar plots show the results of running Net-RSTQ with 100 randomized networks. In (C) and (D), x-axis are the percentage of edges that are removed from the networks. The plots show the results of running Net-RSTQ with the incomplete networks. (A) and (C) report the results of 109 transcripts of the isoforms in the same gene with different domain-domain interactions. (B) and (D) report the results of 712 isoforms in genes with multiple isoforms.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.g004" xlink:type="simple"/>
</fig>
<p>To evaluate the effect of missing edges in the transcript network due to the undetected protein domain-domain interactions, we randomly removed certain percentages of the edges in the transcript network and then run Net-RSTQ with λ = 0.1 on the incomplete networks. The results are shown in <xref ref-type="fig" rid="pcbi.1004465.g004">Fig 4(C) and 4(D)</xref> for the 109 transcripts with different neighbors and the 712 transcripts in the gene with more than one transcript, respectively. It is intriguing to observe that only when a large percentage of the edges are removed, the performance of Net-RSTQ is affected. Intuitively, the observation can be explained by the fact that the Dirichlet prior parameter is proportional to the average of the neighbors’ expressions. As long as some of the neighbors are still connected to the target transcript in the network, the prior information is still useful. The result suggests that Net-RSTQ is relatively robust to utilize transcript networks potentially constructed with a large percentage of undetected protein domain-domain interactions.</p>
</sec>
<sec id="sec019">
<title>Three qRT-PCR experiments confirmed overall improved transcript quantification</title>
<p>The isoform proportions estimated by Net-RSTQ, base EM, RSEM, and Cufflinks were compared to the qRT-PCR results on the three cell lines. Parameter λ = 0.1 was fixed in all the Net-RSTQ experiments. Among the genes that Net-RSTQ, base EM, RSEM, and Cufflinks report most different quantification results, qRT-PCR experiments were performed to test the genes with relatively higher coverage of RNA-Seq data, coding two to three isoforms, and the feasibility of designing isoform-specific primers in the qRT-PCR products (see <xref ref-type="supplementary-material" rid="pcbi.1004465.s008">S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004465.s009">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004465.s010">S3</xref> Tables). Twenty-five genes in total were tested in the three cell lines: seven in H9 stem cell line, five in OVCAR8 ovarian cancer cell line, and thirteen in MCF7 breast cancer cell line. The scatter plots of the relative abundance of the first transcript in each gene estimated by Net-RSTQ, base EM, Cufflinks and RSEM were compared to the qRT-PCR results in <xref ref-type="fig" rid="pcbi.1004465.g005">Fig 5(A) and 5(E)</xref>. In the scatter plot, the estimated relative abundance by Net-RSTQ were closer to qRT-PCR results measured by the accuracy of various thresholds and Root Mean Square Errors. Net-RSTQ achieved the lowest Root Mean Square Error of 0.291, which is more than 0.05 less than 0.3435, the second best achieved by RSEM. In the 20% confidence region, Net-RSTQ puts 59.3% of the pairs in the region compared with 37%, 29.6%, and 51.9% by base EM, Cufflink, and RSEM, respectively. RSEM performed well by putting 37.0% of the pairs within 10% confidence regions but performed poorly in about half of the pairs with more than 25% error.</p>
<fig id="pcbi.1004465.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Validation by comparison with qRT-PCR results.</title>
<p>(A) The scatter plots compare the reported relative proportion of each pair of the isoforms of each gene between the computational methods (Net-RSTQ, base EM, Cufflinks, and RSEM) and qRT-PCR experiments. The proportions of the two compared isoforms in a pair are normalized to adding to 1. The x-axis and y-axis are the relative proportion of one of the two isoform (the other is 1 minus the proportion) reported by qRT-PCR and the computational methods, respectively. The scatter points aligning closer to the diagonal line indicate better estimations by a computational method matching to the qRT-PCR results. The unshaded gradient around the diagonal line shows the regions with scatter differences less than 0.1, 0.15, 0.2 and 0.25, within which the estimations are more similar to the qRT-PCR results. (B)-(D) The scatter plots on each individual dataset. (E) The table shows the percentage of predictions by each method within the unshaded regions and the overall Root Mean Square Error of the predictions by each method compared to the qRT-PCR results.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.g005" xlink:type="simple"/>
</fig>
<p>The relative abundance of the seven genes in H9 stem cell line is shown in Figs <xref ref-type="fig" rid="pcbi.1004465.g005">5(B)</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004465.s005">S2(A)</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004465.s012">S5 Table</xref>. In all seven genes tested, the relative abundance estimated by Net-RSTQ is closer to the qRT-PCR results compare to that by base EM and Cufflinks. RSEM performed similarly well on four genes and worse on the other three genes, CBLC, TCF3 and NPM1. The same comparison on the five selected genes in OVCAR8 ovarian cancer cell line is shown in Figs <xref ref-type="fig" rid="pcbi.1004465.g005">5(C)</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004465.s005">S2(B)</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004465.s013">S6 Table</xref>. Cufflinks reports very low expressions in the first transcript in four genes, three of which do not agree with the highly expressed transcript in the qRT-PCR results. While base EM performed better for two genes (NSD1 and HNRNPA2B1), Net-RSTQ performed better on the other three genes (HRAS, TSC2, and WHSC1L1). Net-RSTQ correctly predicted the overall enrichment of isoforms of HNRNPA2B1 and NSD1 (NM_031243 &gt; NM_002137 in HNRNPA2B1 and NM_022455 &gt; NM_172349 in NSD1). It is possible that the expressions of NM_002137 transcript in gene HNRNPA2B1 and NM_172349 in gene NSD1 were slightly over-smoothed by network information in Net-RSTQ with the fixed λ parameter. RSEM performed slightly better on WHSC1L1 and NSD1 but much worse in the other three genes. The same comparison on the thirteen genes in MCF7 breast cancer cell line is shown in Figs <xref ref-type="fig" rid="pcbi.1004465.g005">5(D)</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004465.s005">S2(C)</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004465.s014">S7 Table</xref>. Cufflinks performed poorly on 8 genes with more than 25% error while RSEM, base EM and Net-RSTQ performed poorly on 5, 4 and 3 genes, respectively. Overall, Net-RSTQ performed better than base EM and Cufflinks and slightly better than RSEM. In summary, Net-RSTQ improved the overall isoform quantification significantly in the H9 stem cell data and predicted more consistent cases in OVCAR8 and MCF7 cancer cell lines data. Note that there could be more uncertainties in primer designs due to somatic DNA variations and cell differentiation and proliferation in cancer cell lines, potentially a larger variation in the qRT-PCR experiments on the cancer cell lines is expected than H9 stem cell line.</p>
</sec>
<sec id="sec020">
<title>Net-RSTQ improved overall cancer outcome predictions</title>
<p>To provide an additional evaluation of the quality of transcript quantification, we designed six cancer outcome prediction tasks by the assumption that better transcript quantification always leads to better isoform markers for cancer outcome prediction. Net-RSTQ was compared with base EM, RSEM [<xref ref-type="bibr" rid="pcbi.1004465.ref033">33</xref>], and Cufflinks [<xref ref-type="bibr" rid="pcbi.1004465.ref032">32</xref>] by classification with the quantification of isoform transcripts in two cancer gene lists (397 and 2551 genes) on four cancer datasets. Each dataset is divided into four folds with two folds for training, one fold for validation (parameter tuning), and one fold for test in a four-fold cross-validation. Support Vector Machine (SVM) with RBF kernel [<xref ref-type="bibr" rid="pcbi.1004465.ref036">36</xref>] were chosen as the classifier. We repeated the four-fold cross-validation 100 times by each method in each dataset.</p>
<p>The average area under the curve (AUC) of receiver operating characteristic of the 100 repeats are reported in <xref ref-type="table" rid="pcbi.1004465.t004">Table 4</xref> when the small gene list was used and <xref ref-type="table" rid="pcbi.1004465.t005">Table 5</xref> when the large gene list was used. The transcript expressions estimated by Net-RSTQ consistently achieved better average classification results than those by the base EM. To evaluate the statistical significance of the differences between the AUCs generated by Net-RSTQ and the base EM in the 100 repeats, we also report the <italic>p</italic>-values by a binomial test on the number of wins/loses in all the experiments between Net-RSTQ and the base EM in Tables <xref ref-type="table" rid="pcbi.1004465.t004">4</xref> and <xref ref-type="table" rid="pcbi.1004465.t005">5</xref>. When the small gene list was tested, three cases were significant with low <italic>p</italic>-values less than 0.001 and two cases were significant with <italic>p</italic>-values just below 0.02 while in the BRCA (survival) data, the <italic>p</italic>-value is only moderately significant even though the average by Net-RSTQ is higher. Overall, Net-RSTQ outperformed the base EM significantly. When the larger gene list was tested, the improvements are not as significant. The improvement was only significant in one dataset, BRCA (survival), and slightly significant in two datasets, OV (relapse) and LUSC (survival). In the other three datasets, the improvements are not significant. Net-RSTQ also outperformed Cufflinks and RSEM (transcript or gene) in five cases except the experiment on BRCA (relapse) dataset in <xref ref-type="table" rid="pcbi.1004465.t004">Table 4</xref>. In <xref ref-type="table" rid="pcbi.1004465.t005">Table 5</xref>, the improvements are less obvious. Moreover, the isoform expression features are not more informative than gene expression features. Overall, the classification performance with the small gene list in <xref ref-type="table" rid="pcbi.1004465.t004">Table 4</xref> is generally better than or similar to the large gene list in <xref ref-type="table" rid="pcbi.1004465.t005">Table 5</xref> possibly suggesting less relevance to survival and relapse in the large gene list.</p>
<table-wrap id="pcbi.1004465.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.t004</object-id>
<label>Table 4</label>
<caption>
<title>Classification performance of estimated transcript expressions and gene expression on the small cancer gene list.</title>
<p>The mean AUC scores of classifying patients by estimated transcript (gene) expression in four-fold cross-validation for each dataset are reported. The best AUCs across the five models using isoforms as features are bold.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004465.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"><bold>Dataset</bold></th>
<th align="center"><bold>OV(Survival)</bold></th>
<th align="center"><bold>OV(Relapse)</bold></th>
<th align="center"><bold>BRCA(Survival)</bold></th>
<th align="center"><bold>BRCA(Relapse)</bold></th>
<th align="center"><bold>LUAD(Survival)</bold></th>
<th align="center"><bold>LUSC(Survival)</bold></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>Net-RSTQ(Isoform)</bold></td>
<td align="char" char="."><bold>0.597</bold></td>
<td align="char" char="."><bold>0.607</bold></td>
<td align="char" char="."><bold>0.683</bold></td>
<td align="center">0.590</td>
<td align="center"><bold>0.635</bold></td>
<td align="char" char="."><bold>0.567</bold></td>
</tr>
<tr>
<td align="center"><bold>base EM(Isoform)</bold></td>
<td align="char" char=".">0.570</td>
<td align="char" char=".">0.589</td>
<td align="char" char=".">0.673</td>
<td align="center">0.542</td>
<td align="center">0.579</td>
<td align="char" char=".">0.550</td>
</tr>
<tr>
<td align="center"><bold>RSEM(Isoform)</bold></td>
<td align="char" char=".">0.587</td>
<td align="char" char=".">0.550</td>
<td align="char" char=".">0.651</td>
<td align="center"><bold>0.616</bold></td>
<td align="center">0.613</td>
<td align="char" char=".">0.536</td>
</tr>
<tr>
<td align="center"><bold>Cufflinks(Isoform)</bold></td>
<td align="char" char=".">0.563</td>
<td align="char" char=".">0.577</td>
<td align="char" char=".">0.676</td>
<td align="center">0.593</td>
<td align="center">0.555</td>
<td align="char" char=".">0.556</td>
</tr>
<tr>
<td align="center"><bold>RSEM(Gene)</bold></td>
<td align="char" char=".">0.591</td>
<td align="char" char=".">0.580</td>
<td align="char" char=".">0.651</td>
<td align="center">0.558</td>
<td align="center">0.615</td>
<td align="char" char=".">0.559</td>
</tr>
<tr>
<td align="center"><bold>p-value(Net-RSTQ vs base EM)</bold></td>
<td align="char" char=".">0.0011</td>
<td align="char" char=".">0.0198</td>
<td align="char" char=".">0.1356</td>
<td align="center">2.248e-5</td>
<td align="center">1.948e-8</td>
<td align="char" char=".">0.0167</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pcbi.1004465.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.t005</object-id>
<label>Table 5</label>
<caption>
<title>Classification performance of estimated transcript expressions and gene expression on the large cancer gene list.</title>
<p>The mean AUC scores of classifying patients by estimated transcript (gene) expression in four-fold cross-validation for each dataset are reported. The best AUCs across the five models are bold.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004465.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.t005" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"><bold>Dataset</bold></th>
<th align="center"><bold>OV(Survival)</bold></th>
<th align="center"><bold>OV(Relapse)</bold></th>
<th align="center"><bold>BRCA(Survival)</bold></th>
<th align="center"><bold>BRCA(Relapse)</bold></th>
<th align="center"><bold>LUAD(Survival)</bold></th>
<th align="center"><bold>LUSC(Survival)</bold></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>Net-RSTQ(Isoform)</bold></td>
<td align="char" char=".">0.599</td>
<td align="char" char="."><bold>0.585</bold></td>
<td align="char" char=".">0.679</td>
<td align="char" char=".">0.592</td>
<td align="char" char=".">0.604</td>
<td align="char" char="."><bold>0.566</bold></td>
</tr>
<tr>
<td align="center"><bold>base EM(Isoform)</bold></td>
<td align="char" char=".">0.590</td>
<td align="char" char=".">0.572</td>
<td align="char" char=".">0.651</td>
<td align="char" char=".">0.571</td>
<td align="char" char=".">0.597</td>
<td align="char" char=".">0.556</td>
</tr>
<tr>
<td align="center"><bold>RSEM(Isoform)</bold></td>
<td align="char" char=".">0.584</td>
<td align="char" char=".">0.569</td>
<td align="char" char=".">0.663</td>
<td align="char" char=".">0.594</td>
<td align="char" char=".">0.587</td>
<td align="char" char=".">0.543</td>
</tr>
<tr>
<td align="center"><bold>Cufflinks(Isoform)</bold></td>
<td align="char" char=".">0.562</td>
<td align="char" char=".">0.582</td>
<td align="char" char="."><bold>0.683</bold></td>
<td align="char" char=".">0.580</td>
<td align="char" char=".">0.583</td>
<td align="char" char=".">0.559</td>
</tr>
<tr>
<td align="center"><bold>RSEM(Gene)</bold></td>
<td align="char" char="."><bold>0.604</bold></td>
<td align="char" char=".">0.577</td>
<td align="char" char=".">0.675</td>
<td align="char" char="."><bold>0.598</bold></td>
<td align="char" char="."><bold>0.627</bold></td>
<td align="char" char=".">0.554</td>
</tr>
<tr>
<td align="center"><bold>p-value(Net-RSTQ vs base EM)</bold></td>
<td align="char" char=".">0.3798</td>
<td align="char" char=".">0.0967</td>
<td align="char" char=".">0.0018</td>
<td align="char" char=".">0.3822</td>
<td align="char" char=".">0.6178</td>
<td align="char" char=".">0.1356</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The parameter λ was tuned by the AUC on the validation set and the optimal λ was used to train the Net-RSTQ model to be tested on the test set. The process is repeated for each fold in 100 repeats. To show the effect of varying the λ on the classification performance in Net-RSTQ, we plotted the average AUC on the validation set across the 100 repeats on the BRCA (survival) dataset with small gene list in <xref ref-type="supplementary-material" rid="pcbi.1004465.s006">S3(A) Fig</xref>. The optimal λ was 0.1 in this experiment. The local gradient around the optimal λ suggesting that the transcript network is playing an important role in inferring better transcript quantification from the RNA-Seq data. In <xref ref-type="supplementary-material" rid="pcbi.1004465.s006">S3(B) Fig</xref>, the convergence of Net-RSTQ is also illustrated by each update through all the genes in each iteration. After less than 10 overall iterations across 397 genes, Net-RSTQ converged well to a local optimum. Similar convergence patterns were observed in all other TCGA samples.</p>
<p>To understand the role of the transcript network in the transcript expression estimation, we used 100 randomized networks to learn the transcript proportion in each experiment with λ fixed to be 0.1. In each randomization, the edges were shuffled among all the transcripts in the small gene list. For transcript expressions learned by each randomized network, we conducted the same four-fold cross validation to compute the average AUCs among 100 repeats. The boxplot of the AUCs learned with the 100 randomized networks is shown in <xref ref-type="fig" rid="pcbi.1004465.g006">Fig 6</xref>. Compared with the classification results from the true transcript network, the result with randomized networks is always worse. Another important observation is that, the median value of the AUCs across the 100 randomized networks is lower or close to the result by the base EM, which suggests that the randomized networks play no role in improving classification and even lead to worse result. Overall, the results provide a clear evidence that the transcript network is informative for the transcript expression estimation, and supplies more discriminative features for cancer outcome prediction.</p>
<fig id="pcbi.1004465.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Statistical analysis with randomized networks.</title>
<p>Comparison of the classification results by the randomized networks and the true network. The λ parameter was fixed to be 0.1 in all the experiments. The blue star and the red star represent the results with the real network and without network (base EM), respectively. The boxplot shows the results with the randomized networks.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec021">
<title>Running time</title>
<p>To measure the scalability of Net-RSTQ, we tested the Net-RSTQ algorithm on the data of the MCF7 breast cancer cell line with three different networks, the small network (898 transcripts), the large network (5599 transcripts) and an artificial huge network (10000 transcripts). <xref ref-type="fig" rid="pcbi.1004465.g007">Fig 7</xref> plots the CPU seconds of running Net-RSTQ on the three networks under different λs. On the small network, the running time is at most about 100 seconds while on the large network and the huge network, the running time is in the scale of 1-<italic>e</italic><sup>3</sup>∼1-<italic>e</italic><sup>4</sup> and 1-<italic>e</italic><sup>5</sup>∼1-<italic>e</italic><sup>6</sup>, respectively. When λ = 0.1, the CPU time for the small network is 32.4 seconds; for the large network is 2755 seconds; and for the artificial large network is 27806 seconds. The results suggest that Net-RSTQ might scale up to about 10000 transcripts, and thus the performance is sufficient for studies focusing on any pathway with up to several thousand genes in the pathway.</p>
<fig id="pcbi.1004465.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004465.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Running time.</title>
<p>The plots show the CPU time (Intel Xeon E5-1620 with 3.70GHZ) for running the Net-RSTQ algorithm one three networks, the small transcript network, the large transcript network, and an artificial huge network of 10000 transcripts.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.g007" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec022" sec-type="conclusions">
<title>Discussion</title>
<p>In the paper, we explored the possibility of improving short-read alignment based transcript quantification with relevant prior knowledge, protein domain-domain interactions. The observation of the correlation between isoform co-expressions and protein domain-domain interactions suggests that the approach is a well-grounded exploration. Different from previously methods [<xref ref-type="bibr" rid="pcbi.1004465.ref027">27</xref>], Net-RSTQ is a network-based approach that directly incorporates protein domain-domain interaction information for transcript proportion estimation. The experiments suggested a great potential of exploring protein domain-domain interactions to overcome the limitations of short-read alignments and improve transcript quantification for better sample classification.</p>
<p>The Dirichlet prior from the neighboring isoforms play two different roles: differentiating isoform expressions to reflect different functional roles or smoothing isoform expressions to reflect similar functional roles, depending on whether the isoforms of a gene share the same or different interacting partners. This principle in modeling is based on the hypothesis that isoforms playing different functional roles (e.g. containing different protein domains) are more likely to behavior differently than isoforms with the same or similar functional roles (e.g. containing the same protein domains). When the isoforms of a gene interact with different partners, their expressions correlates with their partners’ expressions. And, when the isoforms of a gene interact with the same partners, there is no benefit on differentiating their proportions to drive the functionality. A limitation is that when the functional difference among the isoforms are not captured by domain content, the smoothing role might under-estimate the difference in their proportions. Thus, our future goal is to bring in other type of functional information to distinguish their functional roles in cancer such as preferential adoption of post-transcriptional regulations.</p>
<p>Currently, Net-RSTQ does not directly model multi-hits reads in multiple loci. In the TCGA experiments, around 5–10% of the aligned reads in four datasets have multiple alignments reported by TopHat and only one of the best alignments is considered. To check the effect of the multiple-alignment reads in transcript quantification, we allow up to 20 best alignments by TopHat and normalized the read assignment <italic>q</italic><sub><italic>ijk</italic></sub> by the number of loci that the reads aligned to. The correlation coefficients between the estimated gene expressions before and after the normalization are above 0.98 in all the datasets. A potential rigorous solution is to add iteratively reassignment of the reads to the potential origins based on updated abundance of the involved isoforms. The modification will significantly decrease the computational efficiency and make it impractical on large RNA-Seq datasets.</p>
<p>There is also another alternative of integrating the network information directly as a regularization term on the joint likelihood function of all the genes. We also explored this model in the <xref ref-type="supplementary-material" rid="pcbi.1004465.s001">S1 Text</xref>. In the preliminary experiments, we observed very similar outputs between the alternative model and the Net-RSTQ model shown in <xref ref-type="supplementary-material" rid="pcbi.1004465.s015">S8 Table</xref>. However, since the alternative model directly works with one large optimization problem across all the genes, the convergence is much slower as shown in <xref ref-type="supplementary-material" rid="pcbi.1004465.s007">S4 Fig</xref> and the optimization package used in the experiments ran into numerical issues. Thus, we believe the Net-RSTQ model is more scalable and robust in comparison.</p>
<p>Currently, Net-RSTQ can scale on transcript network with up to around 5000 transcripts, which is sufficient for more focused analysis of several thousand genes. The running time of Net-RSTQ on such large transcript network is below 2 hours on each TCGA sample, compared with 5–8 hours needed for aligning the short reads. To further scale up Net-RSTQ, we will investigate other faster strategies of utilizing short read information, such as Sailfish [<xref ref-type="bibr" rid="pcbi.1004465.ref037">37</xref>] which directly estimates isoform expressions by counting k-mer occurrences in reads rather than reads from the alignments. This will be our future direction.</p>
</sec>
<sec id="sec023">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004465.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Alternative model by network-based regularization.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Steps of generating the simulation data.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s003" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Cufflinks and RSEM command line.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s004" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Examples of transcript sub-networks with co-expression information.</title>
<p>(A) Transcripts in WHSC1L1 with correlation coefficients calculated on the OV dataset. (B) Transcripts in BRD4 with correlation coefficients calculated on the BRCA dataset. Both examples are shown with the neighbors in the small transcript network.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s005" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Evaluation by qRT-PCR experiments.</title>
<p>The relative abundance of the transcripts in 7 tested genes in H9 stem cell line (A), 5 tested genes in OVCAR8 ovarian cancer cell line (B), and 13 tested genes in MCF7 breast cancer cell line (C) estimated by Net-RSTQ, base EM, Cufflinks and RSEM was compared with the qRT-PCR experiments. The total abundance is normalized to 1 over the measured transcripts in each gene.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s006" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Model selection and convergence.</title>
<p>The experiment done on BRCA (survival) dataset. (A) Effect of varying λ on the classification performance. The plot shows the average AUC learned from the 100 repeats on validation set for different λs with the optimal λ in blue. (B) Convergence analysis by the total log-likelihood. The plot shows the change of total log-likelihood in Net-RSTQ with each gene update. Each red cross indicates the end of each round <italic>t</italic> in line 2 of Algorithm 1.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s007" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>(A) Convergence and (B) Running time of the alternative regularized framework with 2000 iterations on MCF7 breast cancer cell line.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s008" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Primer sets of the transcripts in seven genes of H9 stem cell line.</title>
<p>* The numbers refer to the isoforms in the first column.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s009" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Primer sets of the transcripts in five genes of OVCAR8 cancer cell line.</title>
<p>* Gene contains more transcript(s) which can not be quantified by qRT-PCR.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s010" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Primer sets of the transcripts in thirteen genes of MCF7 cancer cell line.</title>
<p>* Gene contains more transcript(s) which can not be quantified by qRT-PCR.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s011" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Overlapped KEGG pathways with large transcript network.</title>
<p>We consider the subnetwork of genes that are members of one KEGG pathway and calculated the density of DDIs in the subnetwork.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s012" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>qRT-PCR results on H9 stem cell line.</title>
<p>* Standard deviation of Iso1 + Iso3 is 5.7% and Iso3 is 4.4%</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s013" xlink:type="simple">
<label>S6 Table</label>
<caption>
<title>qRT-PCR results on OVCAR8 cancer cell line.</title>
<p>* Gene contains more transcript which can not be quantified by qRT-PCR.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s014" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s014" xlink:type="simple">
<label>S7 Table</label>
<caption>
<title>qRT-PCR results on MCF7 cancer cell line.</title>
<p>* Gene contains more transcript(s) which can not be quantified by qRT-PCR.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004465.s015" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004465.s015" xlink:type="simple">
<label>S8 Table</label>
<caption>
<title>Correlation Coefficients between the results of Net-RSTQ and the alternative regularized framework with different λs.</title>
<p>The highest correlation coefficients for each λ in the alternative regularized framework is bold.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The results are based upon data generated by The Cancer Genome Atlas established by the NCI and NHGRI. Information about TCGA and the investigators and institutions who constitute the TCGA research network can be found at <ext-link ext-link-type="uri" xlink:href="http://cancergenome.nih.gov" xlink:type="simple">http://cancergenome.nih.gov</ext-link>. The dbGaP accession number to the specific version of the TCGA dataset is phs000178.v8.p7.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004465.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mortazavi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>McCue</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Schaeffer</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Wold</surname> <given-names>B</given-names></name>. <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>. <source>Nat Meth</source>. <year>2008</year>;<volume>5</volume>(<issue>7</issue>):<fpage>621</fpage>–<lpage>628</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1226" xlink:type="simple">10.1038/nmeth.1226</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Sandberg</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Khrebtukova</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Alternative isoform regulation in human tissue transcriptomes</article-title>. <source>Nature</source>. <year>2008</year>;<volume>456</volume>(<issue>7221</issue>):<fpage>470</fpage>–<lpage>476</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature07509" xlink:type="simple">10.1038/nature07509</ext-link></comment> <object-id pub-id-type="pmid">18978772</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bickel</surname> <given-names>PJ</given-names></name>. <article-title>Sparse linear modeling of next-generation mRNA sequencing (RNA-Seq) data for isoform discovery and abundance estimation</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2011</year>;<volume>108</volume>(<issue>50</issue>):<fpage>19867</fpage>–<lpage>19872</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1113972108" xlink:type="simple">10.1073/pnas.1113972108</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>High-resolution functional annotation of human transcriptome: predicting isoform functions by a novel multiple instance-based label propagation method</article-title>. <source>Nucleic Acids Research</source>. <year>2014</year>;<volume>42</volume>(<issue>6</issue>):<fpage>e39</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt1362" xlink:type="simple">10.1093/nar/gkt1362</ext-link></comment> <object-id pub-id-type="pmid">24369432</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Girke</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>T</given-names></name>. <article-title>Differential Gene Expression Analysis Using Coexpression and RNA-Seq Data</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>17</issue>):<fpage>2153</fpage>–<lpage>2161</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt363" xlink:type="simple">10.1093/bioinformatics/btt363</ext-link></comment> <object-id pub-id-type="pmid">23793751</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hendrickson</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Sauvageau</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goff</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Rinn</surname> <given-names>JL</given-names></name>, <etal>et al</etal>. <article-title>Differential analysis of gene regulation at transcript resolution with RNA-Seq</article-title>. <source>Nature Biotechnology</source>. <year>2012</year>;(<issue>1</issue>):<fpage>46</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2450" xlink:type="simple">10.1038/nbt.2450</ext-link></comment> <object-id pub-id-type="pmid">23222703</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roberts</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Donaghey</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rinn</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pachter</surname> <given-names>L</given-names></name>. <article-title>Improving RNA-Seq expression estimates by correcting for fragment bias</article-title>. <source>Genome Biology</source>. <year>2011</year>;<volume>12</volume>(<issue>3</issue>):<fpage>R22</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2011-12-3-r22" xlink:type="simple">10.1186/gb-2011-12-3-r22</ext-link></comment> <object-id pub-id-type="pmid">21410973</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Ruotti</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Stewart</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Dewey</surname> <given-names>CN</given-names></name>. <article-title>RNA-Seq gene expression estimation with read mapping uncertainty</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>4</issue>):<fpage>493</fpage>–<lpage>500</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp692" xlink:type="simple">10.1093/bioinformatics/btp692</ext-link></comment> <object-id pub-id-type="pmid">20022975</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Turro</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>SY</given-names></name>, <name name-style="western"><surname>Goncalves</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Coin</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Haplotype and isoform specific expression estimation using multi-mapping RNA-seq reads</article-title>. <source>Genome Biology</source>. <year>2011</year>;<volume>12</volume>(<issue>2</issue>):<fpage>R13</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2011-12-2-r13" xlink:type="simple">10.1186/gb-2011-12-2-r13</ext-link></comment> <object-id pub-id-type="pmid">21310039</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>MacLeod</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Chiang</surname> <given-names>DY</given-names></name>, <etal>et al</etal>. <article-title>A Robust Method for Transcript Quantification with RNA-Seq Data</article-title>. <source>Journal of Computational Biology</source>. <year>2013</year>;<volume>20</volume>(<issue>3</issue>):<fpage>167</fpage>–<lpage>187</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2012.0230" xlink:type="simple">10.1089/cmb.2012.0230</ext-link></comment> <object-id pub-id-type="pmid">23461570</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jiang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Wong</surname> <given-names>WH</given-names></name>. <article-title>Statistical inferences for isoform expression in RNA-Seq</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>8</issue>):<fpage>1026</fpage>–<lpage>1032</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp113" xlink:type="simple">10.1093/bioinformatics/btp113</ext-link></comment> <object-id pub-id-type="pmid">19244387</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kriventseva</surname> <given-names>EV</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Apweiler</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vingron</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bork</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Increase of functional diversity by alternative splicing</article-title>. <source>Trends in Genetics</source>. <year>2003</year>;<volume>19</volume>(<issue>3</issue>):<fpage>124</fpage>–<lpage>128</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0168-9525(03)00023-4" xlink:type="simple">10.1016/S0168-9525(03)00023-4</ext-link></comment> <object-id pub-id-type="pmid">12615003</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Resch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Modrek</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gorlick</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Riley</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Assessing the Impact of Alternative Splicing on Domain Interactions in the Human Proteome</article-title>. <source>Journal of Proteome Research</source>. <year>2004</year>;<volume>3</volume>(<issue>1</issue>):<fpage>76</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/pr034064v" xlink:type="simple">10.1021/pr034064v</ext-link></comment> <object-id pub-id-type="pmid">14998166</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tseng</surname> <given-names>YT</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>IIIDB: a database for isoform-isoform interactions and isoform network modules</article-title>. <source>BMC Genomics</source>. <year>2015</year>;<volume>16</volume>(<issue>Suppl 2</issue>):<fpage>S10</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-16-S2-S10" xlink:type="simple">10.1186/1471-2164-16-S2-S10</ext-link></comment> <object-id pub-id-type="pmid">25707505</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Finn</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Marshall</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bateman</surname> <given-names>A</given-names></name>. <article-title>iPfam: visualization of protein–protein interactions in PDB at domain and amino acid resolutions</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>3</issue>):<fpage>410</fpage>–<lpage>412</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti011" xlink:type="simple">10.1093/bioinformatics/bti011</ext-link></comment> <object-id pub-id-type="pmid">15353450</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stein</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ceol</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Aloy</surname> <given-names>P</given-names></name>. <article-title>3did: identification and classification of domain-based interactions of known three-dimensional structure</article-title>. <source>Nucleic Acids Research</source>. <year>2011</year>;<volume>39</volume>(<issue>Database-Issue</issue>):<fpage>718</fpage>–<lpage>723</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkq962" xlink:type="simple">10.1093/nar/gkq962</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Punta</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Coggill</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Eberhardt</surname> <given-names>RY</given-names></name>, <name name-style="western"><surname>Mistry</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tate</surname> <given-names>JG</given-names></name>, <etal>et al</etal>. <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>Database-Issue</issue>):<fpage>290</fpage>–<lpage>301</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dblp.uni-trier.de/db/journals/nar/nar40.html#PuntaCEMTBPFCCHHSEBF12" xlink:type="simple">http://dblp.uni-trier.de/db/journals/nar/nar40.html#PuntaCEMTBPFCCHHSEBF12</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1065" xlink:type="simple">10.1093/nar/gkr1065</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pruitt</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Tatusova</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Maglott</surname> <given-names>DR</given-names></name>. <article-title>NCBI Reference Sequences (RefSeq): current status, new features and genome annotation policy</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>Database-Issue</issue>):<fpage>130</fpage>–<lpage>135</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dblp.uni-trier.de/db/journals/nar/nar40.html#PruittTBM12" xlink:type="simple">http://dblp.uni-trier.de/db/journals/nar/nar40.html#PruittTBM12</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1079" xlink:type="simple">10.1093/nar/gkr1079</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berman</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Westbrook</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Gilliland</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bhat</surname> <given-names>TN</given-names></name>, <etal>et al</etal>. <article-title>The Protein Data Bank</article-title>. <source>Nucleic Acids Research</source>. <year>2000</year>;<volume>28</volume>(<issue>1</issue>):<fpage>235</fpage>–<lpage>242</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dblp.uni-trier.de/db/journals/nar/nar28.html#BermanWFGBWSB00" xlink:type="simple">http://dblp.uni-trier.de/db/journals/nar/nar28.html#BermanWFGBWSB00</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/28.1.235" xlink:type="simple">10.1093/nar/28.1.235</ext-link></comment> <object-id pub-id-type="pmid">10592235</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yellaboina</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tasneem</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zaykin</surname> <given-names>DV</given-names></name>, <name name-style="western"><surname>Raghavachari</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Jothi</surname> <given-names>R</given-names></name>. <article-title>DOMINE: a comprehensive collection of known and predicted domain-domain interactions</article-title>. <source>Nucleic Acids Research</source>. <year>2011</year>;<volume>39</volume>(<issue>Database-Issue</issue>):<fpage>730</fpage>–<lpage>735</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dblp.uni-trier.de/db/journals/nar/nar39.html#YellaboinaTZRJ11" xlink:type="simple">http://dblp.uni-trier.de/db/journals/nar/nar39.html#YellaboinaTZRJ11</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkq1229" xlink:type="simple">10.1093/nar/gkq1229</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Prasad</surname> <given-names>TSK</given-names></name>, <name name-style="western"><surname>Goel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kandasamy</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Keerthikumar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kumar</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Human Protein Reference Database–2009 update</article-title>. <source>Nucleic Acids Research</source>. <year>2009</year>;<volume>37</volume>(<issue>Database-Issue</issue>):<fpage>767</fpage>–<lpage>772</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dblp.uni-trier.de/db/journals/nar/nar37.html#PrasadGKKKMTRSVBMBSSRRKKAKMRKRMRRCP09" xlink:type="simple">http://dblp.uni-trier.de/db/journals/nar/nar37.html#PrasadGKKKMTRSVBMBSSRRKKAKMRKRMRRCP09</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkn892" xlink:type="simple">10.1093/nar/gkn892</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Futreal</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Coin</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Marshall</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Down</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hubbard</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>A census of human cancer genes</article-title>. <source>Nature Reviews Cancer</source>. <year>2004</year> <month>Mar</month>;<volume>4</volume>(<issue>3</issue>):<fpage>177</fpage>–<lpage>183</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrc1299" xlink:type="simple">10.1038/nrc1299</ext-link></comment> <object-id pub-id-type="pmid">14993899</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Higgins</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Claremont</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Major</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lash</surname> <given-names>AE</given-names></name>. <article-title>CancerGenes: a gene selection resource for cancer genome projects</article-title>. <source>Nucleic Acids Research</source>. <year>2007</year>;<volume>35</volume>(<issue>suppl 1</issue>):<fpage>D721</fpage>–<lpage>D726</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/content/35/suppl_1/D721.abstract" xlink:type="simple">http://nar.oxfordjournals.org/content/35/suppl_1/D721.abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkl811" xlink:type="simple">10.1093/nar/gkl811</ext-link></comment> <object-id pub-id-type="pmid">17088289</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Xing</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>YN</given-names></name>, <name name-style="western"><surname>Roy</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>An expectation-maximization algorithm for probabilistic reconstructions of full-length isoforms from splice graphs</article-title>. <source>Nucleic acids research</source>. <year>2006</year>;<volume>34</volume>(<issue>10</issue>):<fpage>3150</fpage>–<lpage>3160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkl396" xlink:type="simple">10.1093/nar/gkl396</ext-link></comment> <object-id pub-id-type="pmid">16757580</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Ruotti</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Stewart</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Dewey</surname> <given-names>CN</given-names></name>. <article-title>RNA-Seq gene expression estimation with read mapping uncertainty</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>4</issue>):<fpage>493</fpage>–<lpage>500</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/26/4/493.abstract" xlink:type="simple">http://bioinformatics.oxfordjournals.org/content/26/4/493.abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp692" xlink:type="simple">10.1093/bioinformatics/btp692</ext-link></comment> <object-id pub-id-type="pmid">20022975</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rozov</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Halperin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Shamir</surname> <given-names>R</given-names></name>. <article-title>MGMR: leveraging RNA-Seq population data to optimize expression estimation</article-title>. <source>BMC Bioinformatics</source>. <year>2012</year>;<volume>13</volume>(<issue>S-6</issue>):<fpage>S2</fpage>. <object-id pub-id-type="pmid">22537041</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pachter</surname> <given-names>L</given-names></name>. <article-title>Models for transcript quantification from RNA-Seq</article-title>. <source>ArXiv</source>. <year>2011</year>;p. <fpage>1104</fpage>.<lpage>3889</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004465.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tanaka</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>KY</given-names></name>, <name name-style="western"><surname>Zhong</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pan</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Weissman</surname> <given-names>SM</given-names></name>, <etal>et al</etal>. <article-title>Transcriptional regulation in pluripotent stem cells by methyl CpG-binding protein 2 (MeCP2)</article-title>. <source>Human Molecular Genetics</source>. <year>2014</year>;<volume>23</volume>(<issue>4</issue>):<fpage>1045</fpage>–<lpage>1055</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/hmg/ddt500" xlink:type="simple">10.1093/hmg/ddt500</ext-link></comment> <object-id pub-id-type="pmid">24129406</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Daemen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Griffith</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Heiser</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Enache</surname> <given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Modeling precision treatment of breast cancer</article-title>. <source>Genome Biology</source>. <year>2013</year>;<volume>14</volume>(<issue>10</issue>):<fpage>R110</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2013-14-10-r110" xlink:type="simple">10.1186/gb-2013-14-10-r110</ext-link></comment> <object-id pub-id-type="pmid">24176112</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kim</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pertea</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pimentel</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kelley</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>S</given-names></name>. <article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title>. <source>Genome Biology</source>. <year>2013</year>;<volume>14</volume>(<issue>4</issue>):<fpage>R36</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2013-14-4-r36" xlink:type="simple">10.1186/gb-2013-14-4-r36</ext-link></comment> <object-id pub-id-type="pmid">23618408</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Handsaker</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wysoker</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fennell</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ruan</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>16</issue>):<fpage>2078</fpage>–<lpage>2079</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp352" xlink:type="simple">10.1093/bioinformatics/btp352</ext-link></comment> <object-id pub-id-type="pmid">19505943</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Pertea</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mortazavi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kwan</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat Biotech</source>. <year>2010</year>;<volume>28</volume>(<issue>5</issue>):<fpage>511</fpage>–<lpage>515</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.1621" xlink:type="simple">10.1038/nbt.1621</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dewey</surname> <given-names>CN</given-names></name>. <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>:<fpage>323</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dblp.uni-trier.de/db/journals/bmcbi/bmcbi12.html#LiD11" xlink:type="simple">http://dblp.uni-trier.de/db/journals/bmcbi/bmcbi12.html#LiD11</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-323" xlink:type="simple">10.1186/1471-2105-12-323</ext-link></comment> <object-id pub-id-type="pmid">21816040</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>. <article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>. <source>Nucleic Acids Research</source>. <year>2000</year>;<volume>28</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>30</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/content/28/1/27.abstract" xlink:type="simple">http://nar.oxfordjournals.org/content/28/1/27.abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/28.1.27" xlink:type="simple">10.1093/nar/28.1.27</ext-link></comment> <object-id pub-id-type="pmid">10592173</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Griebel</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Zacher</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Ribeca</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Raineri</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lacroix</surname> <given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Modelling and simulating generic RNA-Seq experiments with the flux simulator</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>20</issue>):<fpage>10073</fpage>–<lpage>10083</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks666" xlink:type="simple">10.1093/nar/gks666</ext-link></comment> <object-id pub-id-type="pmid">22962361</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004465.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vapnik</surname> <given-names>VN</given-names></name>. <article-title>Statistical Learning Theory</article-title>. <source>Wiley-Interscience</source>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004465.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Patro</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Mount</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Kingsford</surname> <given-names>C</given-names></name>. <article-title>Sailfish enables alignment-free isoform quantification from RNA-seq reads using lightweight algorithms</article-title>. <source>Nat Biotech</source>. <year>2014</year> <month>May</month>;<volume>32</volume>(<issue>5</issue>):<fpage>462</fpage>–<lpage>464</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2862" xlink:type="simple">10.1038/nbt.2862</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>