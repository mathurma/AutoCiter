<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01656</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006057</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Electromagnetic radiation</subject><subj-group><subject>Light</subject><subj-group><subject>Visible light</subject><subj-group><subject>Luminance</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Ocular system</subject><subj-group><subject>Ocular anatomy</subject><subj-group><subject>Retina</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Ocular system</subject><subj-group><subject>Ocular anatomy</subject><subj-group><subject>Retina</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Electronics</subject><subj-group><subject>Signal decoders</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Afferent neurons</subject><subj-group><subject>Retinal ganglion cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject><subj-group><subject>Afferent neurons</subject><subj-group><subject>Retinal ganglion cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Ganglion cells</subject><subj-group><subject>Retinal ganglion cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject><subj-group><subject>Ganglion cells</subject><subj-group><subject>Retinal ganglion cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Ganglion cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject><subj-group><subject>Ganglion cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Nonlinear decoding of a complex movie from the mammalian retina</article-title>
<alt-title alt-title-type="running-head">Nonlinear decoding of a complex movie from the mammalian retina</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8790-1914</contrib-id>
<name name-style="western">
<surname>Botella-Soler</surname> <given-names>Vicente</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Deny</surname> <given-names>Stéphane</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Martius</surname> <given-names>Georg</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0090-6190</contrib-id>
<name name-style="western">
<surname>Marre</surname> <given-names>Olivier</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6699-1455</contrib-id>
<name name-style="western">
<surname>Tkačik</surname> <given-names>Gašper</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Institute of Science and Technology Austria, Klosterneuburg, Austria</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Sorbonne Université, INSERM, CNRS, Institut de la Vision, 17 rue Moreau, F-75012 Paris, France</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Max Planck Institute for Intelligent Systems, Tübingen, Germany</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Faisal</surname> <given-names>Aldo A</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Imperial College London, UNITED KINGDOM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">vbsoler@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>5</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>10</day>
<month>5</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>5</issue>
<elocation-id>e1006057</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>10</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>27</day>
<month>2</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Botella-Soler et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006057"/>
<abstract>
<p>Retina is a paradigmatic system for studying sensory encoding: the transformation of light into spiking activity of ganglion cells. The inverse problem, where stimulus is reconstructed from spikes, has received less attention, especially for complex stimuli that should be reconstructed “pixel-by-pixel”. We recorded around a hundred neurons from a dense patch in a rat retina and decoded movies of multiple small randomly-moving discs. We constructed nonlinear (kernelized and neural network) decoders that improved significantly over linear results. An important contribution to this was the ability of nonlinear decoders to reliably separate between neural responses driven by locally fluctuating light signals, and responses at locally constant light driven by spontaneous-like activity. This improvement crucially depended on the precise, non-Poisson temporal structure of individual spike trains, which originated in the spike-history dependence of neural responses. We propose a general principle by which downstream circuitry could discriminate between spontaneous and stimulus-driven activity based solely on higher-order statistical structure in the incoming spike trains.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Neurons in the retina transform patterns of incoming light into sequences of neural spikes. We recorded from ∼100 neurons in the rat retina while it was stimulated with a complex movie. Using machine learning regression methods, we fit decoders to reconstruct the movie shown from the retinal output. We demonstrated that retinal code can only be read out with a low error if decoders make use of correlations between successive spikes emitted by individual neurons. These correlations can be used to ignore spontaneous spiking that would, otherwise, cause even the best linear decoders to “hallucinate” nonexistent stimuli. This work represents the first high resolution single-trial full movie reconstruction and suggests a new paradigm for separating spontaneous from stimulus-driven neural activity.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by ANR TRAJECTORY, the French State program Investissements d’Avenir managed by the Agence Nationale de la Recherche [LIFESENSES: ANR-10-LABX-65], a EC grant from the Human Brain Project (FP7-720270)), and NIH grant U01NS090501 to OM, the Austrian Research Foundation FWF P25651 to VBS and GT. VBS is partially supported by contract MEC, Spain (Grant No. AYA2013-48623-C2-2, No. AYA2016-81065-C2-2 and FEDER Funds). SD was supported by a PhD fellowship from the region Ile-de-France. GM received funding from the People Programme (Marie Curie Actions) in FP7/2007-2013 under REA grant agreement No.291734. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="0"/>
<page-count count="27"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data is available from the public data repository of IST Austria: <ext-link ext-link-type="uri" xlink:href="https://datarep.app.ist.ac.at/98/" xlink:type="simple">https://datarep.app.ist.ac.at/98/</ext-link> DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.15479/AT:ISTA:98" xlink:type="simple">10.15479/AT:ISTA:98</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Decoding plays a central role in our efforts to understand the neural code [<xref ref-type="bibr" rid="pcbi.1006057.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006057.ref004">4</xref>]. While statistical analyses of neural responses can be used to directly estimate [<xref ref-type="bibr" rid="pcbi.1006057.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref006">6</xref>] or bound [<xref ref-type="bibr" rid="pcbi.1006057.ref007">7</xref>] the information content of spike trains, such analyses remain agnostic about what the encoded bits might mean or how they could be read out [<xref ref-type="bibr" rid="pcbi.1006057.ref008">8</xref>]. In contrast, decoding provides an explicit computational procedure for recovering the stimulus from recorded single-trial neural responses, allowing us to ask not only “how much”, but also “what” the neural system encodes [<xref ref-type="bibr" rid="pcbi.1006057.ref009">9</xref>]. This is particularly relevant when a rich stimulus is represented by a large neural population—a regime which is increasingly accessible due to recent experimental progress, and the regime that we explore here.</p>
<p>Decoding from large populations presents a significant technical challenge due to its intrinsic high dimensionality. Past work has predominantly addressed this problem using two approaches. In the first approach, one only presents stimuli that have simple, low-dimensional representations, in order to turn decoding into a tractable fitting (e.g., angular velocity of a moving pattern [<xref ref-type="bibr" rid="pcbi.1006057.ref010">10</xref>], luminance flicker [<xref ref-type="bibr" rid="pcbi.1006057.ref011">11</xref>], 1D bar position [<xref ref-type="bibr" rid="pcbi.1006057.ref012">12</xref>], etc.) or classification problem (e.g., shape identity [<xref ref-type="bibr" rid="pcbi.1006057.ref013">13</xref>], a small set of orientations or velocities [<xref ref-type="bibr" rid="pcbi.1006057.ref014">14</xref>], etc.). It is unclear, however, how results for simple stimuli can be generalized to naturalistic stimuli even in principle, as the latter have no low-dimensional representation and, furthermore, the retinal responses are nonlinear. In the second approach, one first builds a probabilistic encoding model, followed subsequently by model-based inference of the most likely stimulus given the observed neural responses [<xref ref-type="bibr" rid="pcbi.1006057.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1006057.ref021">21</xref>]. Theoretically, this procedure is possible for any stimulus, but in practice model inference is feasible only if it incorporates strong dimensionality reduction assumptions (e.g., that neurons respond to a linear projection of the stimulus). Here we demonstrate a third alternative, where a complex and dynamical stimulus is reconstructed from the output of the mammalian retina directly, by means of large-scale nonlinear regression. Retina is an ideal experimental system for such a study, because it permits stable recordings from large, diverse, local populations of neurons under controlled stimulation, where even simultaneous neural spiking events can be sorted reliably [<xref ref-type="bibr" rid="pcbi.1006057.ref022">22</xref>].</p>
<p>We start by performing linear decoding from the entire recorded retinal ganglion cell population, to separately reconstruct the temporal light intensity trace at each spatial location in the stimulus movie. When using sparse regularization, we extract and subsequently analyze “decoding fields,” the decoding counterpart of the cells’ receptive fields. We next examine nonlinear decoding using kernel ridge regression (KRR [<xref ref-type="bibr" rid="pcbi.1006057.ref023">23</xref>]) and deep learning [<xref ref-type="bibr" rid="pcbi.1006057.ref024">24</xref>], which provide a substantial increase in performance over linear decoding, and isolate spike train statistics that the nonlinear decoders are making use of. We conclude by examining how these statistics arise in generative models of spike trains and suggest that they might be essential for separating stimulus-driven from spontaneous activity.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec003">
<title>Data</title>
<p>Retinal tissue was obtained from adult (8 weeks old) male Long-Evans rat (Rattus norvegicus) and continuously perfused with Ames Solution (Sigma-Aldrich) and maintained at 32 °C. Ganglion cell spikes were recorded extracellularly from a multi-electrode array with 252 electrodes spaced 60 <italic>μ</italic>m apart (custom fabrication by Innovative Micro Technologies, Santa Barbara, CA). Experiments were performed in accordance with institutional animal care standards. The microelectrode covered a total retinal area of ∼ 1 mm<sup>2</sup>. For the rat this corresponds to 16-17 degrees of visual angle [<xref ref-type="bibr" rid="pcbi.1006057.ref025">25</xref>]. The spike sorting was performed with an in-house method based on [<xref ref-type="bibr" rid="pcbi.1006057.ref022">22</xref>].</p>
</sec>
<sec id="sec004">
<title>Visual stimulus</title>
<p>The stimulus movie consisted of randomly moving dark discs (<italic>r</italic> = 100 <italic>μ</italic>m) against a bright background (100% contrast, 2 ⋅ 10<sup>12</sup> photons/cm<sup>2</sup>/s). The discs followed mutually avoiding trajectories generated through an Ornstein-Uhlenbeck process of the form:
<disp-formula id="pcbi.1006057.e001"><alternatives><graphic id="pcbi.1006057.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>τ</mml:mi></mml:mfrac> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>σ</mml:mi> <mml:mi>d</mml:mi> <mml:mi>W</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <bold>v</bold><sub><italic>i</italic></sub> is the velocity of the disc <italic>i</italic>, Δ<italic>t</italic> = 0.01 is the integration timestep, <italic>τ</italic> = 0.8 is the damping time constant, <italic>σ</italic> = 0.5 is the random force magnitude, <italic>dW</italic> is a zero-mean, unit-variance Gaussian random variable, and <bold>f</bold><sub><italic>i</italic></sub> is the hard-core central repulsive force between the discs and between each disc and the frame bounding box, with a decay of ∝ <italic>r</italic><sup>−6</sup>, where <italic>r</italic> is the distance between the disc centers or between the disc and closest point of the bounding box. The resulting distribution of disc speeds peaked at <italic>v</italic> ≈ 0.6 <italic>μ</italic>m/ms and had a width of about <italic>σ</italic><sub><italic>v</italic></sub> ≈ 0.4 <italic>μ</italic>m/ms. The discs covered the recorded area uniformly to a very good approximation, with occupancy deviations at different encoding sites of ∼ 3%.</p>
<p>The movie was divided in segments of 1, 2, 4 and 10 discs, each 675 s long. Segments with increasing number of discs were presented sequentially and in total 3 segments of each type were shown, amounting to a total experiment time of 135 min. Each segment was regularly interspersed with 18 short (7.5 s) clips of repeated stimulus: in sum, 54 repeated clips were shown for each stimulus with different number of discs. The stimulus was convolved with a bank of 400 spatial symmetric gaussian filters (<italic>σ</italic> = 66.67 <italic>μ</italic>m) placed in a regular square 20x20 grid with <italic>d</italic> = 53<italic>μm</italic> spacing to produce local luminance traces. The filter normalization ensures the resulting traces are bounded in (0,1). The width of the filters was selected in preliminary tests to optimize decoding performance; specifically, in preliminary tests we found that filter widths in range <italic>σ</italic> ∼ 50 − 100<italic>μm</italic> minimized the mean-squared-error of L1-regularized linear decoders trained for a subset of decoding sites. The movie stimulus was shown at a refresh rate of 80 Hz. The response spike trains were binned accordingly in bins of 12.5 ms, and time aligned to the stimulus. The spatio-temporal receptive fields of the retinal ganglion cells were obtained through reverse correlation to a flickering checkerboard stimulus. The checkerboard was constructed from squares of 130 <italic>μ</italic>m that were randomly selected to be black or white at a rate of 40 Hz. Retinal spontaneous activity was recorded in full darkness (blackout condition) for 2.5 min.</p>
</sec>
<sec id="sec005">
<title>Linear decoder</title>
<p>Let <inline-formula id="pcbi.1006057.e002"><alternatives><graphic id="pcbi.1006057.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> be a one-dimensional stimulus trace of length <italic>N</italic> time bins. In the linear decoding framework we assume that an estimate of the stimulus <inline-formula id="pcbi.1006057.e003"><alternatives><graphic id="pcbi.1006057.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mover accent="true"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> can be obtained from the neural response Σ as <inline-formula id="pcbi.1006057.e004"><alternatives><graphic id="pcbi.1006057.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mover accent="true"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mo>Σ</mml:mo> <mml:mo>·</mml:mo> <mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006057.e005"><alternatives><graphic id="pcbi.1006057.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a linear filter. In this formulation, the response of the retina is represented by the matrix <inline-formula id="pcbi.1006057.e006"><alternatives><graphic id="pcbi.1006057.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mo>Σ</mml:mo> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>×</mml:mo> <mml:mo>(</mml:mo> <mml:mi>C</mml:mi> <mml:mo>×</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>C</italic> is the number of cells and Δ<italic>T</italic> the size in bins of the time window we associate with a single point in <inline-formula id="pcbi.1006057.e007"><alternatives><graphic id="pcbi.1006057.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (for all analyses Δ<italic>T</italic> = 61 corresponding to a window stretching from -375 ms to 375 ms around the time bin of interest, i.e., the decoding is performed using “acausal” filters). The extra dimension is a column of ones to account for the bias term in the decoding. Thus, the decoding filter <inline-formula id="pcbi.1006057.e008"><alternatives><graphic id="pcbi.1006057.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is structured as <inline-formula id="pcbi.1006057.e009"><alternatives><graphic id="pcbi.1006057.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mn>3</mml:mn></mml:msub> <mml:mo>…</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>C</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> where <inline-formula id="pcbi.1006057.e010"><alternatives><graphic id="pcbi.1006057.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msub><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the filter corresponding to cell <italic>i</italic> and <italic>L</italic><sub>0</sub> is the bias term. We learned the filters <inline-formula id="pcbi.1006057.e011"><alternatives><graphic id="pcbi.1006057.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by minimizing the square error function with L1-regularization
<disp-formula id="pcbi.1006057.e012"><alternatives><graphic id="pcbi.1006057.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="normal">χ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>^</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>⊤</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>^</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mrow><mml:mo>‖</mml:mo> <mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>‖</mml:mo></mml:mrow> <mml:mn>1</mml:mn></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
To solve the minimization problem computationally we made use of the Lasso algorithm with the routines by Kim et al. [<xref ref-type="bibr" rid="pcbi.1006057.ref026">26</xref>]. Data was divided into training and testing sets (4.9⋅10<sup>4</sup> training points, 2.3⋅10<sup>4</sup> testing points). The filters were obtained from the training set and all measures of performance refer to the testing set. Regularization parameter λ was chosen through 2-fold cross-validation on the training set. The regularization term ensures the sparsity of the filters. Due to this sparsity some cells have negligible filter norms and therefore do not contribute to the decoding. This allows us to establish a hierarchy of cells by sorting them according to their filter norm <inline-formula id="pcbi.1006057.e013"><alternatives><graphic id="pcbi.1006057.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. “Single-best cell” for every site refers to the cell with the largest norm. “Contributing cells” are the subset of cells with largest norm that jointly account for at least half of the total filter norm <inline-formula id="pcbi.1006057.e014"><alternatives><graphic id="pcbi.1006057.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mrow><mml:mo>‖</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>‖</mml:mo></mml:mrow> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>All the results in the paper use acausal filters. If the decoding filters are restricted to be causal, the decoding performance can be significantly decreased; for test sites where we explored this effect, the cross correlation between true and linearly decoded luminance trace could decrease from ≈ 0.8 to ≈ 0.6. Given that our stimulus is a stochastic process and retinal processing necessarily entails some processing delay, this is not surprising.</p>
</sec>
<sec id="sec006">
<title>Kernelized nonlinear decoder</title>
<p>If instead of L1-regularization we enforce L2-regularization, the linear decoding filters can be obtained analytically through the normal equation
<disp-formula id="pcbi.1006057.e015"><alternatives><graphic id="pcbi.1006057.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msup><mml:mo>Σ</mml:mo> <mml:mi>⊤</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mo>Σ</mml:mo> <mml:msup><mml:mo>Σ</mml:mo> <mml:mi>⊤</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Thus, an estimate of the stimulus for some new data <inline-formula id="pcbi.1006057.e016"><alternatives><graphic id="pcbi.1006057.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mover accent="true"><mml:mo>Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is given by
<disp-formula id="pcbi.1006057.e017"><alternatives><graphic id="pcbi.1006057.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mo>Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>·</mml:mo> <mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mo>Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:msup><mml:mo>Σ</mml:mo> <mml:mi>⊤</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mo>Σ</mml:mo> <mml:msup><mml:mo>Σ</mml:mo> <mml:mi>⊤</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Since this expression only depends on products of spike trains, we can make use of the kernel trick and substitute the usual scalar product by some appropriate nonlinear function <italic>k</italic> of the spike trains. In this way, we can express our nonlinear decoding problem as
<disp-formula id="pcbi.1006057.e018"><alternatives><graphic id="pcbi.1006057.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mover accent="true"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>^</mml:mo></mml:mover></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>κ</mml:mi> <mml:mi>⊤</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula> <disp-formula id="pcbi.1006057.e019"><alternatives><graphic id="pcbi.1006057.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula> <disp-formula id="pcbi.1006057.e020"><alternatives><graphic id="pcbi.1006057.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <inline-formula id="pcbi.1006057.e021"><alternatives><graphic id="pcbi.1006057.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>⊤</mml:mi></mml:msubsup> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>×</mml:mo> <mml:mo>(</mml:mo> <mml:mi>C</mml:mi> <mml:mo>×</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the <italic>i</italic>th row of matrix Σ. This is known as Kernel Ridge Regression [<xref ref-type="bibr" rid="pcbi.1006057.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref028">28</xref>]. For our analyses we have used the Gaussian kernel
<disp-formula id="pcbi.1006057.e022"><alternatives><graphic id="pcbi.1006057.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mspace width="4pt"/><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msubsup><mml:mrow><mml:mo>‖</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>‖</mml:mo></mml:mrow> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
Before computing the kernel, it is customary to turn the spike trains into smooth traces for the sake of performance [<xref ref-type="bibr" rid="pcbi.1006057.ref029">29</xref>]. We convolved our spike trains with a Gaussian filter of 3 time bins width. The data was divided into training and testing sets (9.8⋅10<sup>3</sup> training points, 2.3⋅10<sup>4</sup> testing points). The parameters <italic>s</italic> and λ were obtained through joint 3-fold cross-validation on the training set. Since decoding at different sites is independent, <italic>s</italic> and λ were chosen separately at each site (likewise, L1 regularization strength for the linear decoder was also selected independently for each site). The performance of the nonlinear decoder depends on the set of cells considered. Contrary to the linear case where L1-regularization can effectively silence cells by setting their filters to zero, this nonlinear framework cannot ignore cells in a similar way. Therefore, including in the analysis non-informative cells can decrease the generalization performance of the decoder. To determine the best subset of cells for decoding we took advantage of the hierarchy of cells established by the linear L1-regularized decoding. We trained nonlinear decoders with progressively more cells (best cell, best two cells, etc.) and selected the subset of minimum decoding error on the training set (<xref ref-type="supplementary-material" rid="pcbi.1006057.s007">S7 Fig</xref>). Effectively, we jointly cross-validated the three parameters <italic>s</italic>, λ, and the subset size.</p>
</sec>
<sec id="sec007">
<title>Deep neural network</title>
<p>We trained a deep neural network on the decoding task. The architecture of the network is as follows: there are 5460 inputs (activity of 91 cells and 60 time bins) and two or three fully connected hidden layers followed by a fully connected linear output layer of 400 cells (corresponding to the 20x20 grid), see <xref ref-type="supplementary-material" rid="pcbi.1006057.s020">S20 Fig</xref>. The hidden layers have each 150 units with tanh activation function.</p>
<p>The loss is L2 loss on the regression error and L1 and L2 regularization on the weights (Elastic Net type), more specifically:
<disp-formula id="pcbi.1006057.e023"><alternatives><graphic id="pcbi.1006057.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="normal">χ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>θ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mrow><mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi>W</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>+</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi>W</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:msub><mml:mo>|</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
where <inline-formula id="pcbi.1006057.e024"><alternatives><graphic id="pcbi.1006057.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>θ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the network output for input <italic>x</italic><sub><italic>i</italic></sub> and <italic>W</italic><sup>(<italic>k</italic>)</sup> is the weight matrix to layer <italic>k</italic> + 1, <inline-formula id="pcbi.1006057.e025"><alternatives><graphic id="pcbi.1006057.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mi>θ</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mo>{</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. The regularization improves generalization by making the network weights smaller and creating a sparse connection graph (increases robustness to training set variations). The available data of 126360 input-output pairs was split into 79560, 23400, and 23400 points for training, validation and testing respectively (same test set as for other methods). We trained for 2500 epochs (each epoch trains on all training points once). To avoid that early during training many weights become zero because of the regularization we set λ = 0 for the first 100 epochs. We performed model selection by a grid search through the following hyperparameters: regularization constant: λ ∈ {5 ⋅ 10<sup>−7</sup>, 7.5 ⋅ 10<sup>−7</sup>, 1 ⋅ 10<sup>−6</sup>, 2.5 ⋅ 10<sup>−6</sup>, 5 ⋅ 10<sup>−6</sup>}, number of hidden layers <italic>K</italic> ∈ {2, 3}, and optimization method ∈ { stochastic gradient decent (sgd) with learning rate 0.01 and momentum of 0.9, Adam optimizer [<xref ref-type="bibr" rid="pcbi.1006057.ref030">30</xref>] with learning rate 0.005 and <italic>ϵ</italic> = 0.0001}. The hyperparameter setting with the smallest validation error where selected, resulting in: <italic>K</italic> = 3, λ = 2.5 ⋅ 10<sup>−6</sup>, and sgd.</p>
<p>Interestingly, only around 42 units per hidden layer have non-zero connections after training. Although, if started with only 50 units we observed worse performance. The mean of the square test error (over locations) is 0.01387 with standard deviation 0.00304.</p>
</sec>
<sec id="sec008">
<title>Classifiers</title>
<p>For classification purposes we assign each time bin to one of two classes: “fluctuating” or “constant”. “Fluctuating” corresponds to discs moving over the site of interest and decreasing the light intensity in that site, while “constant” refers to the constant illumination of the site when no discs are present. To label the time bins we use a simple cut-off criterion plus two further correcting steps to account for retinal adaptation effects. First we label as “fluctuating” every bin with stimulus intensity less than 0.99. Then we apply these corrections: <italic>i)</italic> Every identified “constant” segment shorter than 30 bins (375 ms) is relabelled as “fluctuating,” and <italic>ii)</italic> The first 30 bins following a “fluctuating” segment are also labelled “fluctuating.” In this way the stimulus at each site is divided in segments of fluctuating and constant intensity. We train both linear and nonlinear Support Vector Machine (SVM) classifiers to determine, from the spike train response, whether a given time bin is labelled as “constant” or “fluctuating”. Similarly to the decoding framework, to classify a given bin we consider a time window of Δ<italic>T</italic> = 61 bins around it in the response. For the nonlinear SVM we use the same gaussian kernel as in nonlinear decoding and the parameter values obtained when training the decoder. Note that this is not the optimal nonlinear classifier but allows us to evaluate the classifying power of the decoding kernel.</p>
</sec>
<sec id="sec009">
<title>Measures of performance</title>
<p>Given a stimulus intensity trace <inline-formula id="pcbi.1006057.e026"><alternatives><graphic id="pcbi.1006057.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and the corresponding decoding prediction <inline-formula id="pcbi.1006057.e027"><alternatives><graphic id="pcbi.1006057.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mover accent="true"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> we define the decoding error as the Mean Squared Error <inline-formula id="pcbi.1006057.e028"><alternatives><graphic id="pcbi.1006057.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:mtext>MSE</mml:mtext> <mml:mo>=</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>^</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>⊤</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>^</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> We also make use of the related Fraction of Variance Explained defined as FVE = 1 − (MSE/Var(<italic>y</italic>)).</p>
<p>To measure decoding performance from the fully decoded movie we build Receiver Operating Curves (ROC). We threshold the decoded intensity trace at each site. If intensity is below threshold, the presence of a disc in the site is predicted. By comparing the prediction as a function of the threshold to the original stimulus frames (where the center of the site can only be white when no disc is present, or black when the disc is present), we can evaluate the performance of the decoder as a balance between the True Positive (TP) and False Positive (FP) rates
<disp-formula id="pcbi.1006057.e029"><alternatives><graphic id="pcbi.1006057.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>TPR</mml:mtext> <mml:mo>=</mml:mo> <mml:mfrac><mml:mtext>TP</mml:mtext> <mml:mrow><mml:mtext>TP</mml:mtext> <mml:mo>+</mml:mo> <mml:mtext>FN</mml:mtext></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mtext>FPR</mml:mtext> <mml:mo>=</mml:mo> <mml:mfrac><mml:mtext>FP</mml:mtext> <mml:mrow><mml:mtext>FP</mml:mtext> <mml:mo>+</mml:mo> <mml:mtext>TN</mml:mtext></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>To assess the performance of the SVM classifiers we use the <italic>F</italic><sub>1</sub>-score measure defined as
<disp-formula id="pcbi.1006057.e030"><alternatives><graphic id="pcbi.1006057.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>+</mml:mo> <mml:mi>R</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>P</italic> is the Precision and <italic>R</italic> the Recall given by
<disp-formula id="pcbi.1006057.e031"><alternatives><graphic id="pcbi.1006057.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mtext>TP</mml:mtext> <mml:mrow><mml:mtext>TP</mml:mtext> <mml:mo>+</mml:mo> <mml:mtext>FP</mml:mtext></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>R</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mtext>TP</mml:mtext> <mml:mrow><mml:mtext>TP</mml:mtext> <mml:mo>+</mml:mo> <mml:mtext>FN</mml:mtext></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
For the binary classification task, “fluctuating” is defined as the positive class.</p>
<p>Unless otherwise stated, all of the statistical significance tests were performed with the Wilcoxon signed rank test.</p>
</sec>
<sec id="sec010">
<title>ON/OFF ratio bias estimation</title>
<p>For each site <italic>s</italic> we determine the set of available cells whose receptive field centers were less than 300 <italic>μm</italic> distant from the center of the site. We call <italic>C</italic><sub><italic>s</italic></sub> the total number of available cells at site <italic>s</italic>. In general, <italic>C</italic><sub><italic>s</italic></sub> is the sum of ON and OFF subtype cells, <inline-formula id="pcbi.1006057.e032"><alternatives><graphic id="pcbi.1006057.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>C</mml:mi> <mml:mi>s</mml:mi> <mml:mtext>on</mml:mtext></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>C</mml:mi> <mml:mi>s</mml:mi> <mml:mtext>off</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. If, from the available cells at site <italic>s</italic>, we pick a random subset of size <italic>N</italic> = <italic>N</italic><sup>on</sup> + <italic>N</italic><sup>off</sup>, the probability of choosing <italic>N</italic><sup>off</sup> cells is given by the hypergeometric distribution (random draw without replacement)
<disp-formula id="pcbi.1006057.e033"><alternatives><graphic id="pcbi.1006057.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mtext>off</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mtext>off</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mtext>off</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mtext>off</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mtext>off</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
The average probability over all sites considered is
<disp-formula id="pcbi.1006057.e034"><alternatives><graphic id="pcbi.1006057.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mtext>off</mml:mtext></mml:msup> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>S</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mtext>off</mml:mtext></mml:msup> <mml:mo>|</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Separately, for each site <italic>s</italic> we have established a hierarchy of cells from their decoding filter norms. Following the hierarchy we create decoding sets of different size <italic>N</italic> (the best cell, the best two cells, etc) and we count the number of OFF type cells <italic>N</italic><sup>off</sup> in them. We summarize this information in the histogram <italic>M</italic>(<italic>N</italic><sup>off</sup>, <italic>N</italic>) that counts the number of sites where the decoding set of size <italic>N</italic> contains <italic>N</italic><sup>off</sup> OFF cells. With this histogram we obtain an empirical probability
<disp-formula id="pcbi.1006057.e035"><alternatives><graphic id="pcbi.1006057.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mtext>emp</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mtext>off</mml:mtext></mml:msup> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>M</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mtext>off</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
that we can compare with <italic>p</italic>(<italic>N</italic><sup>off</sup>|<italic>N</italic>). In particular, the bias reported in <xref ref-type="supplementary-material" rid="pcbi.1006057.s005">S5 Fig</xref> is given by
<disp-formula id="pcbi.1006057.e036"><alternatives><graphic id="pcbi.1006057.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>100</mml:mn> <mml:mo>·</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mtext>emp</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mtext>off</mml:mtext></mml:msup> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mtext>off</mml:mtext></mml:msup> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mtext>off</mml:mtext></mml:msup> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Only sites with <italic>N</italic><sup>off</sup>, <italic>N</italic><sup>on</sup> ≥ 2 were considered for the comparison (n = 115).</p>
</sec>
<sec id="sec011">
<title>Encoding model</title>
<p>We build an encoding model for a single cell, based on the standard GLM type model proposed by Pillow et al [<xref ref-type="bibr" rid="pcbi.1006057.ref015">15</xref>]. The cell spikes stochastically through a Poisson process with a time-dependent firing rate λ(<italic>t</italic>) given by <inline-formula id="pcbi.1006057.e037"><alternatives><graphic id="pcbi.1006057.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where <inline-formula id="pcbi.1006057.e038"><alternatives><graphic id="pcbi.1006057.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mover accent="true"><mml:mi>k</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a spatio temporal filter acting on stimulus <inline-formula id="pcbi.1006057.e039"><alternatives><graphic id="pcbi.1006057.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mover accent="true"><mml:mi>Y</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006057.e040"><alternatives><graphic id="pcbi.1006057.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a temporal filter of the past spike history of the cell represented by <inline-formula id="pcbi.1006057.e041"><alternatives><graphic id="pcbi.1006057.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. The function <italic>f</italic>(<italic>x</italic>) is a rectifying nonlinearity of the log-exp form <italic>f</italic>(<italic>x</italic>) = <italic>a</italic> log(<italic>b</italic> exp(<italic>x</italic> + <italic>c</italic>)). The stimulus filter <inline-formula id="pcbi.1006057.e042"><alternatives><graphic id="pcbi.1006057.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mover accent="true"><mml:mi>k</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> factorizes into separate spatial and temporal filters. The spatial component is given by a balanced difference of gaussians, with widths <italic>σ</italic><sub><italic>c</italic></sub> = 35<italic>μm</italic> for the positive and <italic>σ</italic><sub><italic>s</italic></sub> = 100<italic>μm</italic> for the negative part, providing a symmetrical center-surround type filter. The temporal part of the filter is given by a single negative lobe of a sin-like function. The filter for the past spike history takes the form
<disp-formula id="pcbi.1006057.e043"><alternatives><graphic id="pcbi.1006057.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>h</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>A</mml:mi><mml:mspace width="4pt"/><mml:mtext>sin</mml:mtext><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>π</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow><mml:mspace width="4pt"/><mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>π</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
This filter inhibits firing after a spike but, depending on the values of the parameters, it can have a positive lobe after the inhibitory part that tends to increase the firing rate. We consider a span of 250 ms (20 bins) for both the past history filter and the temporal part of the stimulus filter. All elements of the filter are fixed except for the rectifying nonlinearity that is changed according to the value of <italic>α</italic>. Initially, the parameters of the nonlinearity <italic>f</italic><sub><italic>α</italic> = 1</sub>(<italic>x</italic>) are adjusted to provide an average firing rate similar to that observed in real data. The <italic>α</italic> = 1 model is taken as the ground-truth and every time <italic>α</italic> changes, the nonlinearity <italic>f</italic><sub><italic>α</italic></sub>(<italic>x</italic>) is fitted anew by maximizing the likelihood on <italic>α</italic> = 1 rasters, in order to reproduce the firing rate trace (PSTH) as closely as possible to the PSTH generated by <italic>α</italic> = 1. The model neuron is stimulated with real data and the intensity trace at the central site of its receptive field is the stimulus considered for decoding. The model has been implemented using the Nonlinear Input Model toolbox [<xref ref-type="bibr" rid="pcbi.1006057.ref031">31</xref>].</p>
</sec>
</sec>
<sec id="sec012" sec-type="results">
<title>Results</title>
<sec id="sec013">
<title>Decoding setup</title>
<p>We recorded the spiking activity of <italic>C</italic> = 91 ganglion cells from a 1 mm<sup>2</sup> patch of the rat retina, while presenting a complex and dynamical stimulus that consisted of 1, 2, 4 or 10 black discs on a bright background (<xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1A</xref> and <xref ref-type="sec" rid="sec002">Methods</xref>). The discs followed self-avoiding random motion, generated as described in the Methods section, which (for decoder training) was non-repeated; all decoding results are reported on withheld (test) segments of the stimulus that were not used during training. The stimulus also contained a segment of repeated trajectories that was randomly interspersed into the non-repeated part and used only to assess the role of noise correlations. Our goal was to reconstruct the light intensity as a function of time at a grid of 20 × 20 spatial positions (“sites”) uniformly tiling the stimulus frame. Specifically, at each site, we convolved the original movie with a small Gaussian filter (see <xref ref-type="sec" rid="sec002">Methods</xref>), which defined the “luminance trace” at that site, to be decoded. Stimulus features (here, disc size) were smaller than the receptive field center of a typical recorded RGC, making the decoding task non-trivial.</p>
<fig id="pcbi.1006057.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006057.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Linear decoding of a complex movie.</title>
<p><bold>A</bold>: An example stimulus frame. At each site (red dots = partially shown 20×20 grid) the stimulus was convolved with a spatial gaussian filter (red circle = 1<italic>σ</italic>). Typical RGC receptive field center size shown in gray. <bold>B</bold>: Responses of 91 RGCs with 750 <italic>ms</italic> decoding window overlaid in blue. <bold>C</bold>: Three example luminance traces (red) and the linear decoders’ predictions (blue). <bold>D</bold>: Decoded frame (same as in <bold>A</bold>) reconstructed from 20×20 separately decoded traces. Disc contours of the original frame shown for reference in green. <bold>E</bold>: RF centers of the 91 cells (black dots = centers of fitted ellipses). RF centers overlapping a chosen site (red dot) are highlighted in blue. <bold>F</bold>: Performance of the linear decoders across space, as Fraction of Variance Explained (FVE). Black dots as in <bold>E</bold>; black contour is the boundary <italic>FVE</italic> = 0.4. <bold>G</bold>: Performance of the linear decoders (FVE) across sites as a function of cell coverage (grayscale = conditional histograms, red dots = means, error bars = ± SD). <bold>H</bold>: Average decoding error across sites (MSE ± SD) of 10-disc-trained decoders, tested on withheld stimuli with different numbers of discs. <bold>I</bold>: Cells (black dots = RF center positions) contributing to the decoding at two example sites (red circles); decoding filters shown below. For each site, contributing cells (highlighted in red and joined to the site) account for at least half of the total L1 norm. <bold>J</bold>: Decoding field of a single cell (here, evaluated over a denser 50×50 grid and normalized to unit maximal variance); the cell’s RF center shown in black.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>Sparse linear decoding of a complex movie</title>
<p>To estimate the luminance trace at any given time, we trained a separate sparse linear decoder for each site on a 750 ms sliding window of the complete spiking raster, shown in <xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1B</xref>, and represented as spike counts in Δ<italic>t</italic> = 12.5 ms time bins (see <xref ref-type="sec" rid="sec002">Methods</xref>). The decoder minimized the square error between the true and estimated luminance trace at each site, using sparse (L1) penalty on decoding weights, as specified by <xref ref-type="disp-formula" rid="pcbi.1006057.e012">Eq (2)</xref>. While each decoder in principle had access to all neural responses, the sparse penalty ensured that the majority of the weights corresponding to redundant or non-informative neural responses for each site were zeroed out, yielding interpretable results which we describe in detail below. When trained on the 10-disc stimulus, this procedure predicted well the luminance traces across individual sites on withheld sections of the stimulus (<xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1C</xref>), allowing us to reconstruct the complete movie (<xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1D</xref>).</p>
<p>We expected the performance of our decoder to depend strongly on local coverage, i.e., on the number of recorded cells whose receptive field centers overlap a given site. Coverage amounted to about six cells on average and exhibited substantial spatial heterogeneity, as shown in <xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1E</xref>. The quality of our movie reconstruction, measured locally by “fraction of variance explained” (FVE, see <xref ref-type="sec" rid="sec002">Methods</xref>), showed similar spatial variation (<xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1F</xref>) which correlated strongly with coverage (<xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1G</xref>), and saturated at ≥ 6 cells. In what follows, we restrict our analyses to sites with good coverage that pass a threshold of FVE ≥ 0.4. Despite the high dimensionality of this regression problem (decoders have ∼5 ⋅ 10<sup>3</sup> parameters per site), sparse regularization ensured uniformly good performance even when tested on out-of-sample stimuli with varying number of discs (<xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1H</xref>).</p>
<p>To analyze how rich stimuli are represented by a population of ganglion cells with densely overlapping receptive fields, we examined the resulting decoding weights in detail. We found that stimulus readout was surprisingly local. As illustrated for two example sites in <xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1I</xref>, only a few cells whose receptive field centers were in close proximity to the respective sites were assigned non-negligible decoding weights. This was true in general: on average 5.4 ± 2.8 cells, whose RF centers were all located within 200 <italic>μm</italic> of the decoded site, contributed to the luminance trace reconstruction; cells beyond this spatial scale contained no decodable information (<xref ref-type="supplementary-material" rid="pcbi.1006057.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006057.s002">S2</xref> Figs).</p>
<p>Our framework also allowed us to construct a “decoding field” for every cell (<xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1J</xref>). A decoding field represents an impulse response of the decoder, i.e., an additive contribution to the stimulus reconstruction for every spike emitted by a particular cell. While one can reasonably expect that the receptive and decoding fields overlap in location and spatial extent, there is no theoretical guarantee that this must happen, given that neural encoding is strongly nonlinear. We nevertheless confirm this expectation and observe a very good correspondence between the spatial locations and sizes of the decoding and receptive fields for all cells (<xref ref-type="supplementary-material" rid="pcbi.1006057.s003">S3 Fig</xref>), with decoding fields also exhibiting a clear center-surround-like structure. We find that decoding filters shapes for all cells are highly stereotyped (<xref ref-type="supplementary-material" rid="pcbi.1006057.s004">S4 Fig</xref>). We further find that the readout of retinal responses is local, in the sense that only cells with receptive field centers close to the decoding site contribute to the decoding (<xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1I</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006057.s006">S6 Fig</xref>). Lastly, the readout is structured, in the sense that the cells that contribute to decoding at each site have a preferred ON vs OFF composition that favors recruiting OFF cells (<xref ref-type="supplementary-material" rid="pcbi.1006057.s005">S5 Fig</xref>), most likely because the visual feature that moves in our stimulus is a dark disc on a bright background.</p>
<p>Taken together, our results suggest that retinal responses to complex stimuli can be read out in a highly stereotyped, structured, and local manner.</p>
</sec>
<sec id="sec015">
<title>Nonlinear decoding outperforms linear decoding</title>
<p>Could nonlinear decoding improve on these results? We considered two nonlinear regression methods that can tractably be applied to our data: kernel ridge regression (KRR) and regression using deep neural networks.</p>
<p>Kernel ridge regression is a well-known extension of linear regression into the nonlinear domain by means of the kernel trick. We used Gaussian kernels whose width was determined using cross-validatation (see <xref ref-type="sec" rid="sec002">Methods</xref>) [<xref ref-type="bibr" rid="pcbi.1006057.ref029">29</xref>], as specified in Eqs <xref ref-type="disp-formula" rid="pcbi.1006057.e018">(3)</xref>–<xref ref-type="disp-formula" rid="pcbi.1006057.e022">(6)</xref>. Importantly, the success of this nonlinear decoder crucially depended on the proper selection of local groups of cells relevant for each site, as identified by linear decoding: its sparse (L1) regularization acted as “feature selection” for the nonlinear problem (<xref ref-type="sec" rid="sec002">Methods</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006057.s007">S7 Fig</xref>). Nonlinear decoder could then make use of higher-order statistical dependencies within and between the selected spike trains to achieve high performance.</p>
<p>We compared these results to regression using neural networks. An architecture that achieved good performance consisted of an input layer (that received spiking rasters of the same dimension as the linear regression problem), followed by three fully-connected hidden layers with 150 sigmoidal neurons each, followed by a 20 × 20 output layer whose units correspond to the decoding sites of our movie; this architecture is schematized in <xref ref-type="supplementary-material" rid="pcbi.1006057.s020">S20 Fig</xref>. The network was trained by minimizing the squared reconstruction error, <xref ref-type="disp-formula" rid="pcbi.1006057.e023">Eq (7)</xref>, using standard deep learning tools (see <xref ref-type="sec" rid="sec002">Methods</xref>).</p>
<p>
<xref ref-type="fig" rid="pcbi.1006057.g002">Fig 2A</xref> shows a luminance trace at one of the example sites, together with its linear and nonlinear reconstruction. Nonlinear decoders track better the detailed structure of luminance troughs, which occur when discs cross the site, as well as exhibiting smaller fluctuations when no discs are crossing the site and the true luminance trace is therefore constant. This is reflected in a substantial overall increase in fraction of variance explained (FVE) across different sites, shown in <xref ref-type="fig" rid="pcbi.1006057.g002">Fig 2B</xref>. A kernelized nonlinear decoder using only two best cells per site outperforms, on average, the best sparse linear decoder constructed from the entire population; nonlinear performance saturates quickly with the number of cells and peaks when decoding from local ∼8-cell groups. The neural network decoder, which we train on the complete neural population, reaches a comparable performance to the best kernelized decoder.</p>
<fig id="pcbi.1006057.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006057.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Nonlinear decoding outperforms linear decoding.</title>
<p><bold>A</bold>: Luminance trace (red) with linear (blue) and nonlinear KRR (green) and neural network (grey) predictions. <bold>B</bold>: Average decoder performance (± SD across sites), achievable using increasing numbers of cells with highest L1 filter norm. For nonlinear decoding, “All” is the optimal subset that maximizes performance (<xref ref-type="supplementary-material" rid="pcbi.1006057.s007">S7 Fig</xref>). Since the neural network (grey point with an error bar) simultaneously decodes the movie at all sites, it only makes sense to train it using “All” cells. <bold>C</bold>: Average ROC across all testing movie frames. <bold>D</bold>: Fractional improvement (average ± SEM across sites) of nonlinear KRR versus linear decoders for test stimuli with different numbers of discs. All decoders were trained only on the 10-disc stimulus. <bold>E</bold>: Decoding error (MSE; average ± SEM across sites) in fluctuating and constant epochs is significantly larger for linear decoders (p&lt;0.001) relative to nonlinear KRR and the neural network.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.g002" xlink:type="simple"/>
</fig>
<p>An alternative way to compare decoding performance is to threshold the sequence of decoded movie frames (see <xref ref-type="supplementary-material" rid="pcbi.1006057.s008">S8 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006057.s022">S1 Video</xref>), thereby assigning each site to a decoded dark disc (“below threshold”) or to the bright background (“above threshold”). Decoded movie frames can then be compared to ground truth (i.e., the original movie frames which can only be either black or white at every location) at each threshold using the receiver operator characteristic (ROC curve), shown for all decoders in <xref ref-type="fig" rid="pcbi.1006057.g002">Fig 2C</xref>. In this metric, the performance of the kernelized and neural network decoders are nearly indistinguishable, and consistently outperform linear decoders. Excess nonlinear performance of between 15 and 20% of FVE was maintained even when decoders were trained on 10-disc stimulus and tested on stimuli with smaller number of discs (<xref ref-type="fig" rid="pcbi.1006057.g002">Fig 2D</xref>). Excess nonlinear performance was also observed when decoding from a cell mosaic of a single functional type (<xref ref-type="supplementary-material" rid="pcbi.1006057.s009">S9 Fig</xref>) and on a repeat experiment (<xref ref-type="supplementary-material" rid="pcbi.1006057.s010">S10 Fig</xref>).</p>
<p>We note the surprising consistency between the kernelized decoding and neural network results. Despite the fundamental differences in the nature and application of these two regression methods—neural networks are universal approximators, use different regularization from the kernelized decoders, and have been trained on all cells simultaneously to decode at all sites simultaneously, in contrast to the kernelized decoders—their numerical measures of performance appear quantitatively consistent. While it is impossible to exclude the possibility that yet another type of decoder could yield much higher performance, it is also possible that both nonlinear decoders we tried managed to extract all available information about local luminance traces from the recorded spike trains.</p>
<p>Another particularly striking feature of our results was the difficulty of the linear decoder to match the true (constant) luminance trace when no disc was crossing the corresponding site. Rat retinal ganglion cells are continuously active even when there are no coincident on-center luminance changes, with the activity likely resulting from stimulus changes in the surround, from long-lasting sustained responses to previous stimuli, from effective network coupling to cells that do experience varying input, or from true spontaneous excitation that would take place even in complete absence of stimuli [<xref ref-type="bibr" rid="pcbi.1006057.ref032">32</xref>–<xref ref-type="bibr" rid="pcbi.1006057.ref035">35</xref>]. Either way, activity of cells at constant local luminance presents a confound that is difficult for a generic linear mechanism to eliminate, which results in decoder fluctuations, or “hallucinations,” of sizeable variance. To quantify this effect, we partitioned the luminance traces at every site into constant and fluctuating epochs by means of a simple threshold (see <xref ref-type="sec" rid="sec002">Methods</xref>), and examined decoding errors separately during both epochs. The decrease in decoding error by using nonlinear decoders was similar in absolute terms in both epochs, but represented a much larger fractional decrease during constant epochs, suggesting that nonlinear decoders might specifically be better at suppressing their responses to spontaneous-like neural activity (<xref ref-type="fig" rid="pcbi.1006057.g002">Fig 2E</xref>).</p>
<p>We reasoned that this improvement comes, in part, from the ability of both nonlinear methods to recognize whether there are any on-site luminance fluctuations or not, from the spike trains alone. To test this idea, we trained linear and nonlinear kernelized classifiers, operating on identical inputs and with the same kernel parameters as the decoders, to best separate constant from fluctuating activity. Consistent with our expectations, nonlinear classifiers outperformed linear at every site, irrespectively of whether their input were the rasters of all local cells that contribute to the decoding, as shown in <xref ref-type="supplementary-material" rid="pcbi.1006057.s011">S11A Fig</xref>, or the raster of a single best cell at every site, as shown in <xref ref-type="supplementary-material" rid="pcbi.1006057.s011">S11B Fig</xref>.</p>
</sec>
<sec id="sec016">
<title>Nonlinear decoders make use of spike-history dependencies in individual spike trains</title>
<p>Next, we attempted to identify the statistics of spike trains that are necessary to explain the excess performance of nonlinear decoders. Our starting point was the following observation: the simplest nonlinear decoders that used a single best cell for each site, when interrogated with a test-set epoch of pure spontaneous activity (i.e., neural responses to a completely blank screen), yielded luminance traces with significantly smaller variance than their linear counterparts (<xref ref-type="supplementary-material" rid="pcbi.1006057.s012">S12 Fig</xref>). Since the only structure in spike trains during spontaneous activity is, by definition, due to “noise correlations”—pairwise or higher-order dependencies between spikes within an individual spike train or across different spike trains—we hypothesized that certain noise correlations could be used by nonlinear decoders also during stimulus presentation to boost their decoding performance.</p>
<p>To test this hypothesis, we made use of many identical repeats of a particular stimulus fragment embedded in our disc movie (these repeats were used neither for training nor testing). Using the same decoders as above, we decoded the original response rasters corresponding to the repeated fragment, as well as rasters in which we shuffled the spikes to remove spike-history dependencies, or to remove cell-cell noise correlations, as shown in <xref ref-type="fig" rid="pcbi.1006057.g003">Fig 3A</xref>, to assess how decoding is impacted by the removal of certain types of correlation in the spike trains. Note that these manipulations left the firing rates of all cells intact, and thus preserved all correlations in the spike trains that are due to the neurons responding to a spatio-temporally correlated stimulus. Crucially, for our analysis we did not retrain our decoders on the shuffled spike trains, because we wanted to ask whether the <italic>same</italic> decoders that we trained to read the real (unshuffled) neural code can also read the modified neural code lacking various components of the noise correlations. If the decoder performance were unaffected by such removal, then noise correlations are not crucial for our decoder; in contrast, a drop in decoder performance would suggest that noise correlations may be necessary. Alternatively, if we were to retrain our decoders on the shuffled spike trains, we would be answering a different question: Is there <italic>any</italic> decoder that can read the shuffled neural code? While interesting, (i) it is unclear what statements about the actual neural code such an analysis would provide (since these decoders would be trained on synthetic, shuffled codes that only exist in our computer); (ii) technically, the number of distinct training samples would be drastically too small to train such decoders, since the experiments impose a hard trade-off between the number of repeats and the duration of the repeated fragment, on which the decoder would have to be trained. For these scientific and methodological reasons, we performed the following analysis using decoders trained on actual (unshuffled) responses to unrepeated stimuli.</p>
<fig id="pcbi.1006057.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006057.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Spike-history dependencies affect decoding performance.</title>
<p><bold>A</bold>: Shuffles of responses to repeated stimulus presentations remove different types of correlations, but preserve average locking to the stimulus (PSTH), and thus stimulus-induced correlations. <bold>B</bold>: A repeated stimulus fragment (red trace), nonlinear kernelized decoder predictions using real responses (green), and using responses without different types of correlations (gray); shown is the prediction mean ± SD over repeats. <bold>C</bold>: Increase in decoding error (MSE) when spike-history dependencies or noise correlations are removed (average ± SEM across sites); percentages report fractional differences relative to the original performance. <bold>D</bold>: Spike count distributions for a single example cell. Removing spike-history dependencies broadens the distributions, in particular in constant epochs. Dashed line = expectation for a fully randomized spike train with a matched firing rate. <bold>E</bold>: Variance-to-mean ratio <italic>F</italic> of spike count distributions for spike trains with and without spike-history dependencies. Each point is a cell that contributes most to decoding at a particular site (when the same cell contributes to multiple sites, average ± SD across sites is shown).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.g003" xlink:type="simple"/>
</fig>
<p>
<xref ref-type="fig" rid="pcbi.1006057.g003">Fig 3B</xref> shows a stimulus reconstruction at an example site by the nonlinear kernelized decoder, for original rasters as well as rasters with removed spike-history dependencies or cell-cell noise correlations. Removing cell-cell noise correlations leads to a small increase in the variance of the reconstructions across stimulus repeats, with only marginal differences in the mean reconstructed trace, compared to decoding from intact rasters. Surprisingly, removing spike-history dependencies leads to much worse reconstructions, whose mean is strongly biased and variance increased; as a result, the dynamic range of the decoded trace is substantially lower compared to decoding from intact rasters. These observations are summarized across sites in <xref ref-type="fig" rid="pcbi.1006057.g003">Fig 3C</xref>, which shows the increase in decoding error when spike-history dependencies or cell-cell noise correlations are removed. Removal of cell-cell noise correlations leads to small increases in error, roughly of the same magnitude for both linear and nonlinear decoders; in contrast, while removal of spike-history dependencies leads to increases in error for both decoders, the effect is two-to-three-fold larger for the two nonlinear methods. We emphasize that kernelized decoders and neural network are two fundamentally different regression methods, yet the removal of spike-history dependences strongly decreases the performance of both, suggesting that our observations are likely not a consequence of choosing a particular decoder type. Qualitatively similar conclusions hold for the classifiers trained to separate constant from fluctuating input epochs (<xref ref-type="supplementary-material" rid="pcbi.1006057.s013">S13 Fig</xref>), as well as for decoders and classifiers trained on the single best cell per site (<xref ref-type="supplementary-material" rid="pcbi.1006057.s014">S14 Fig</xref>).</p>
<p>Having established that spike-history dependencies are crucial to the performance of the nonlinear decoders, we looked at the detailed statistical structure of individual spike trains. For each neuron that best decoded the luminance trace at a specified site, we focused on 250 ms (20 time bins) response sequences and constructed a distribution over the number of occupied time bins (“spike counts”), separately for epochs where the luminance trace was fluctuating or where it was constant. As shown in <xref ref-type="fig" rid="pcbi.1006057.g003">Fig 3D</xref>, these distributions differed significantly: the count distribution was much tighter in constant epochs, while the mean firing rate between the epochs did not change much. During fluctuating-input epochs, observing more spikes in a 250 ms window was more likely than at constant input, but—perhaps surprisingly—patterns with very low numbers of spikes (e.g., zero or one) were also more likely during fluctuating-input epochs. The count distribution at fluctuating light was very similar to binomial (and, at this temporal resolution, Poisson), while it was tighter at constant light. These changes could be summarized by a simple statistic, the variance-to-mean ratio <italic>F</italic> = (variance in spike count)/(mean spike count). Note that unlike the standard Fano factor, our <italic>F</italic> is not computed across the repetitions of the same stimulus and thus measures the total variability in the response, which includes variance due to the changing stimulus. When we removed spike-history dependencies, the variance-to-mean ratio <italic>F</italic> increased for both distributions and they became harder to distinguish from each other. <xref ref-type="fig" rid="pcbi.1006057.g003">Fig 3E</xref> shows that this behavior was consistent across all sites, highlighting the very high regularity of neural spiking that resulted in sub-Poisson variance (<italic>F</italic> substantially below 1) during epochs of constant luminance.</p>
<p>How could spike-history dependencies help in stimulus decoding? A possible scenario would involve the situation where decoders should “sum” multiple spikes from the same neuron in the recent past super-linearly, to optimally reconstruct the stimulus. In this case, without spike-history dependencies that are responsible for precise firing with sub-Poisson variance, the Poisson spiking in the absence of spike-history effects would cause large (compared to linear decoder) spurious variance in the decoder output. Adding spike-history dependencies would, in contrast, tighten the number of emitted spikes, giving the nonlinear decoder a reliable option to sum spike effects super-linearly without being swamped by spiking noise. We emphasize that this is only the simplest scenario we could think of as an example where spike-history dependencies could be beneficial; there are likely many others.</p>
<p>Taken together, our results show that: <italic>(i),</italic> spike-history dependencies within individual spike trains are crucial for nonlinear decoder performance; <italic>(ii),</italic> these dependencies shape the distribution of spike counts on timescales relevant for decoding; <italic>(iii),</italic> during constant local luminance, spiking activity is very regular (and statistically similar to true spontaneous activity, see <xref ref-type="supplementary-material" rid="pcbi.1006057.s015">S15 Fig</xref>); <italic>(iv),</italic> a simple statistic, which summarizes the effects of spike-history dependencies in different epochs and their changes when the spike trains are shuffled, is the spike variance-to-mean ratio <italic>F</italic>. This does not imply that nonlinear decoders actually compute some version of a local estimate for <italic>F</italic>: they could be sensitive to other statistics, e.g., the interspike interval distribution, which also differs substantially between the epochs, see <xref ref-type="supplementary-material" rid="pcbi.1006057.s016">S16 Fig</xref>. Because nonlinear decoders we use have no well-defined set of sufficient statistics, it is impossible to claim which precise statistic of the spike train they are sensitive to, beyond stating that they clearly are sensitive to the removal of spike-history dependencies. Note further that we can only establish clearly that nonlinear decoders that we trained are sensitive to the removal of spike-history dependencies; we, however, cannot exclude the option that there exist nonlinear decoders of the same class that reach similar performance as ours but are at the same time robust to the removal of spike-history dependencies. Nevertheless, subsequent analyses on synthetic data that we provide below, as well as the robustness of our observations with respect to the nonlinear method (kernelized decoder and the neural network) suggest that crucial decoding information really is present in the spike-history dependencies, and that the underlying reason for nonlinear decoder performance is its ability to recognize high regularity of spiking during epochs of constant local luminance.</p>
</sec>
<sec id="sec017">
<title>A simple neural encoding model can recapitulate spike train statistics crucial for nonlinear decoding</title>
<p>Can the observed spike-history dependencies, which enable successful nonlinear decoding, be generated by simple and generic neural encoding models? To address this question, we made use of generalized linear models (GLMs) [<xref ref-type="bibr" rid="pcbi.1006057.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref037">37</xref>], probabilistic functional models of spiking neurons that extend the paradigmatic linear-nonlinear (LN) framework by incorporating the recurrent feedback from neuron’s past spiking, as schematized in <xref ref-type="fig" rid="pcbi.1006057.g004">Fig 4A</xref>. Previously, GLMs have been successfully applied to responses of the mammalian retina [<xref ref-type="bibr" rid="pcbi.1006057.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref020">20</xref>] and in the cortex [<xref ref-type="bibr" rid="pcbi.1006057.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref039">39</xref>], and also reproduced well the firing rates of cells recorded in our experiment on the repeated stimulus fragment (<xref ref-type="supplementary-material" rid="pcbi.1006057.s017">S17 Fig</xref>).</p>
<fig id="pcbi.1006057.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006057.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Spike-history dependencies of intermediate strength facilitate nonlinear decoding in simple models of neural processing.</title>
<p><bold>A</bold>: Schematic of a single-cell Generalized Linear Model (see <xref ref-type="sec" rid="sec002">Methods</xref>). The neuron’s sensitivity to the stimulus is determined by a radially symmetric difference-of-Gaussians spatial filter that has a monophasic timecourse (<inline-formula id="pcbi.1006057.e044"><alternatives><graphic id="pcbi.1006057.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mover accent="true"><mml:mi>k</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>), and combines additively with the neuron’s sensitivity to its own past spiking, given by filter <inline-formula id="pcbi.1006057.e045"><alternatives><graphic id="pcbi.1006057.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (with strong refractoriness followed by weak facilitation). Importantly, <inline-formula id="pcbi.1006057.e046"><alternatives><graphic id="pcbi.1006057.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> shapes spike-history dependencies in the resulting spike trains. A nonlinear function <italic>f</italic>(⋅) (here, threshold-linear) of the combined sensitivities gives the neuron’s instantaneous firing rate that can be used to generate individual spike train instances. Shapes, as well as the temporal and spatial scales of the filters, were realistic for our data. <bold>B</bold>: Example rasters (50 repeats) generated with the encoding model for a given intensity trace and different magnitudes (<italic>α</italic>) of spiking history filter <inline-formula id="pcbi.1006057.e047"><alternatives><graphic id="pcbi.1006057.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006057.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. The rasters are matched in PSTH (bottom) but differ in temporal noise correlations. <bold>C</bold>: Average spike count variance-to-mean ratio, <italic>F</italic>, (± SD) of the model as a function of <italic>α</italic> in fluctuating and constant epochs. <bold>D</bold>: Decoding error as a function of <italic>α</italic>. Decoders are trained for each separate <italic>α</italic> and tested on withheld stimuli; shade = SD over 10 spike train realizations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.g004" xlink:type="simple"/>
</fig>
<p>To link encoding models and decodability in a way that would generalize beyond the specifics of our dataset, we created the simplest stereotyped model cell, shown in <xref ref-type="fig" rid="pcbi.1006057.g004">Fig 4A</xref>. Crucially, we parametrized the magnitude of the self-coupling filter with <italic>α</italic>: <italic>α</italic> = 0 thus corresponded to a pure LN model, while increasing values of <italic>α</italic> made neural spike trains non-Poisson, progressively enforcing dependence on past spiking and consequently increasing the magnitude of the resulting temporal correlations.</p>
<p>With this model in hand, we generated a “baseline” raster of repeated responses to a randomly moving disc stimulus at an initial value of <italic>α</italic> = 1, which corresponds to the strength of spike-history dependence inferred from our data, as shown in <xref ref-type="fig" rid="pcbi.1006057.g004">Fig 4B</xref>. The average firing rate was chosen to be the typical rate of our recorded ganglion cells. We then systematically changed the value of <italic>α</italic> and, for each value, refitted the nonlinearity by maximizing the likelihood to the baseline raster at <italic>α</italic> = 1 (see <xref ref-type="sec" rid="sec002">Methods</xref>). This procedure generated synthetic rasters that, to an excellent approximation, were matched in their peri-stimulus time histograms (PSTH) and stimulus preference, yet differed in the strength of spike-history dependencies.</p>
<p>Following our previous analyses, we partitioned the luminance trace into constant and fluctuating epochs, and looked at the spiking statistics in 250 ms (20 time bin) windows. Spike count variance-to-mean ratio <italic>F</italic> in constant epochs decreased as a function of <italic>α</italic> and dropped substantially below 1; in contrast, when on-center luminance was fluctuating, <italic>F</italic> behaved non-monotonically (<xref ref-type="fig" rid="pcbi.1006057.g004">Fig 4C</xref>). In line with expectations and behavior observed in our data, <italic>F</italic> at constant luminance was always below <italic>F</italic> at fluctuating luminance. Having ensured that the statistics of synthetic rasters qualitatively agreed with the data for the range of <italic>α</italic> we examined, we asked about the performance of linear and nonlinear decoders, trained and tested at different values of <italic>α</italic>. <xref ref-type="fig" rid="pcbi.1006057.g004">Fig 4D</xref> plots the decoding error as a function of <italic>α</italic>; see <xref ref-type="supplementary-material" rid="pcbi.1006057.s019">S19 Fig</xref> for the separation into error in fluctuating vs constant epochs as a function of <italic>α</italic>. Overall, the error levels are in range of those observed for real data (cf. <xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1H</xref>), with nonlinear decoders outperforming linear by ∼10 − 30%. Interestingly, the minimal error for both decoders is achieved at an intermediate value of <italic>α</italic>* ≈ 0.4, which also corresponds to the point where nonlinear decoders maximally outperform their linear counterparts. At <italic>α</italic> = 0, where the encoding models are effectively LN neurons, the decoders differ only marginally in performance (analogous results hold for the classifiers separating fluctuating from constant epochs, see <xref ref-type="supplementary-material" rid="pcbi.1006057.s018">S18 Fig</xref>).</p>
<p>How close are real retinal ganglion cells to the value of <italic>α</italic> that permits best nonlinear reconstruction? This question cannot be answered precisely with the toy models we use. Within the class of generalized linear models (GLMs) considered here, we can reliably show that nonlinear decoding performance significantly outperforms linear decoding performance for a broad range of <italic>α</italic> values that includes both <italic>α</italic>* ≈ 0.4 as well as <italic>α</italic> = 1 (which, by our definition, corresponds to the best fit of GLM model to our data), and this effect is robustly true for all the cells that we examined. It is, however, likely that GLM models are too simplistic for the cells we are considering (realistic models for rat ganglion cells may require two nonlinear stages of stimulus processing, i.e., LNLN models [<xref ref-type="bibr" rid="pcbi.1006057.ref040">40</xref>]), if we wanted to make a quantitative statement about how close real cells are to the value of <italic>α</italic> that permits optimal nonlinear reconstruction. In these simulations we also haven’t modeled cell-to-cell noise correlations; further, it is likely that GLM does not capture all spike-history dependencies; and we decoded only the central pixel of the model’s receptive field. These differences between the simulations and the real experiment are likely responsible for the fact that the difference between nonlinear decoding performance from GLM-generated spike trains and same spike trains with shuffle-removed spike-history dependencies are much smaller than what we see in real data. Nevertheless, while the quantitative match between real neural data and GLM simulations is beyond the scope of this paper, we have shown qualitatively that in a generic class of encoding models that have been widely applied to both peripheral as well as central neural processing, there exists a non-trivial strength of spike-history dependence that facilitates nonlinear stimulus reconstruction. Intuitively, the existence of optimal <italic>α</italic>* &gt; 0 can be explained as a trade-off between ensuring regularity of spiking during constant epochs, which the nonlinear decoder can make use of, while not impeding stimulus encoding during fluctuating epochs; during these epochs, stimulus-driven term should dominate over sensitivity to past spiking, otherwise excessive dependence on spiking history (e.g., <italic>α</italic> ≥ 1 in <xref ref-type="fig" rid="pcbi.1006057.g004">Fig 4B</xref>) could perturb reliable locking to the stimulus.</p>
</sec>
</sec>
<sec id="sec018" sec-type="conclusions">
<title>Discussion</title>
<p>Insights from decoding provide crucial constraints for theoretical models of neural codes. A large body of work dissects nonlinearities in stimulus processing, from nonlinear summation in the receptive field or during adaptation, to essential spike generation nonlinearities. Consequently, one would expect nonlinear decoding to outperform linear, but reports to that effect are scarce [<xref ref-type="bibr" rid="pcbi.1006057.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref041">41</xref>]. In theory the results of a nonlinear encoding process can be linearly decodable [<xref ref-type="bibr" rid="pcbi.1006057.ref042">42</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref043">43</xref>], yet whether this is true of real neurons under rich stimulation is still unclear. What has been demonstrated to date is that certain low-level representations of simple stimuli—but not the full frame-by-frame movie—can be linearly decoded [<xref ref-type="bibr" rid="pcbi.1006057.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref044">44</xref>]. Another fundamental question concerns the stability of decoding transformations, which has recently received renewed attention in the context of efficient coding [<xref ref-type="bibr" rid="pcbi.1006057.ref045">45</xref>–<xref ref-type="bibr" rid="pcbi.1006057.ref047">47</xref>]. Finally, a number of studies, both theoretical [<xref ref-type="bibr" rid="pcbi.1006057.ref048">48</xref>] and data-driven [<xref ref-type="bibr" rid="pcbi.1006057.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref049">49</xref>–<xref ref-type="bibr" rid="pcbi.1006057.ref051">51</xref>], focused on correlations in neural activity, especially those due to spike-history dependence and network circuitry (“noise correlations”); here, decoding provides a way to quantitatively ask about the functional contribution of such correlations to stimulus reconstruction. Approaching these issues empirically requires us to first construct high-quality decoders for complete stimulus movies—conceptually, doing the inverse of the state-of-the-art encoding models [<xref ref-type="bibr" rid="pcbi.1006057.ref015">15</xref>]—which remains an open challenge.</p>
<p>Some of the above questions have been approached before using frame-by-frame decoding, with stimuli of varying complexity. Theoretical methods for such decoding—as well as several approximations to render these methods tractable—have been presented, mainly in the context of probabilistic-model-based decoding [<xref ref-type="bibr" rid="pcbi.1006057.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1006057.ref019">19</xref>], although they have generally not been applied to real recordings with rich stimuli. Linear decoding of natural scenes has been undertaken in the cat LGN with linear decoders (but without sparse regularization) [<xref ref-type="bibr" rid="pcbi.1006057.ref052">52</xref>], and using Bayesian methods with strong natural movie priors from fMRI recordings of the visual cortex [<xref ref-type="bibr" rid="pcbi.1006057.ref053">53</xref>]. Generalized linear models (GLMs) have been used to model the neural responses (e.g., [<xref ref-type="bibr" rid="pcbi.1006057.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref021">21</xref>]), although full stimulus reconstruction was undertaken only in [<xref ref-type="bibr" rid="pcbi.1006057.ref015">15</xref>] for a binary checkerboard stimulus, whereas other works used the inferred probabilistic models to perform the easier tasks of stimulus classification or decoding from synthetically generated spike trains. This is, in part, because optimal (Bayesian) decoding of stimuli with complex prior statistical structure (such as ours or natural movies) is technically challenging. Furthermore, for many neural systems, including but not limited to the retina under natural or complex dynamical stimulation, we do not have adequate encoding models; consequently, optimal Bayesian inversion of poor encoding models does not represent a clearly interpretable benchmark for other decoding methods. We thus decided for an alternative, statistical approach of constructing nonlinear decoders directly and benchmarking them against an accepted common standard, the linear decoder.</p>
<p>To this end, we used large-scale linear and nonlinear (kernelized, neural network) regressions to directly decode a complex stimulus movie from the output of many simultaneously recorded retinal ganglion cells. Importantly, we did not use any prior knowledge of recorded cells’ properties (e.g., their types or receptive fields), or any prior knowledge of the stimulus structure, to carry out the decoding; as a result, our decoding filters could, at least in principle, be used to decode any stimulus. A combination of sparse prior over decoding filter coefficients and a high-dimensional stimulus revealed a surprisingly local and stereotyped manner in which the retinal code could be read out. This is in stark contrast to previous work using simple stimuli where the readout was distributed and the resulting decoding filters had no general interpretation [<xref ref-type="bibr" rid="pcbi.1006057.ref012">12</xref>]. While our filters and consequently the “decoding fields” were recovered under a particular stimulus class and thus nominally depend on stimulus statistics, it is interesting to speculate whether the retina could adaptively change its encoding properties so as to keep the decoding representations constant, as has recently been suggested [<xref ref-type="bibr" rid="pcbi.1006057.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1006057.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref054">54</xref>]. Similarity between decoding and receptive fields and generalization to stimuli with different number of discs provide limited circumstantial support for this idea, but a definite answer can only emerge from dedicated experiments that specifically test the stability of decoders under rich stimuli with different statistical structure.</p>
<p>The performance of linear decoders was further improved by using nonlinear decoding. The improvement was significant, systematic, and reproducible: we observed it at nearly all sites, irrespectively of how many relevant cells we decoded from, when decoding from all recorded cells jointly or a mosaic of a single type, and also in a repeat experiment. Furthermore, a very different nonlinear regression method—a multi-layer neural network trained with standard deep learning tools—recapitulated quantitatively the results of kernelized decoding. The performance improvement of nonlinear methods is nontrivial, because the increased expressive power of nonlinear methods comes at a cost of potentially overfitting models to data; this was evident also in our failed first attempt to apply kernelized decoding to the whole recorded population, instead of only to the relevant cells selected by sparse linear decoder at every site. The performance improvement depended crucially on the spike-history dependence in individual spike trains but only slightly on cell-cell noise correlations. Previous work also explored the role of cell-cell noise correlations for decoding: while no impact of cell-cell noise correlations on decoding performance was found in mouse retinas exposed to white noise and natural scene stimulation [<xref ref-type="bibr" rid="pcbi.1006057.ref021">21</xref>], Pillow and colleagues report that the inclusion of cell-cell noise correlations in model-based decoding increased the stimulus information by about ∼20% [<xref ref-type="bibr" rid="pcbi.1006057.ref015">15</xref>]. We also observe a significant, 10 − 20% decrease in decoding performance if cell-cell noise correlations are removed from the test-set spike trains, with decoders trained on intact rasters. Our largest effect, however, comes from spike-history dependencies. Short-term history dependence in ganglion cells is mostly due to refractoriness, and including spike-history dependences of up to 40 ms after the spike did not substantially change the decoding performance from primate parasol cells [<xref ref-type="bibr" rid="pcbi.1006057.ref015">15</xref>]. In contrast, our spike-history dependencies extend over much longer times and modulate spiking structure over 100 ms or more, in temporal windows relevant for decoding; removing these dependencies drastically decreased the performance of nonlinear decoders. Consistent and robust results using two entirely different nonlinear regression methods, backed by simulations using GLM-model neurons, provide compelling evidence that spike-history dependencies indeed enable low-error stimulus reconstruction.</p>
<p>What are the methodological advances presented in our work? While sparse and nonlinear regression methods used here are standard methods in statistics, they have typically not been applied to spiking neural data for complex stimulus reconstruction. Nevertheless, we show here that they should provide a tractable way of studying how rich signals are represented in other parts of the brain without making explicit assumptions about the encoding process, thereby providing a complementary, decoder-centric alternative to Bayes inversion of probabilistic encoding models. Second, even though the inner workings of nonlinear methods are notoriously difficult to interpret intuitively, our analysis suggests that controlled manipulations of spike train statistics can provide valuable insights into which spike train features matter for decoding and which do not. Finally, we suggest the “pixel-by-pixel” decoding approach as an alternative way to shed light on the functional contributions of different cell types to stimulus representation. While beyond the scope of this paper, one could decode stimuli from individual mosaics of the same type, or from their combinations, and compare the decoding performance (and resulting errors) to that of a complete population.</p>
<p>What are the general implications of our results? The high-dimensional nature of our stimulus forced us to decode the movie “pixel-by-pixel,” rather than trying to decode its compact representation. This, in turn, focused our attention on the intermittent nature of signals to be decoded: at any given site, the luminance trace switched between epochs where nothing changed locally, and periods where the trace was fluctuating in time. Such intermittency is common to many natural stimuli across different sensory modalities [<xref ref-type="bibr" rid="pcbi.1006057.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1006057.ref056">56</xref>], and therefore must shape the way in which sensory information is encoded [<xref ref-type="bibr" rid="pcbi.1006057.ref057">57</xref>–<xref ref-type="bibr" rid="pcbi.1006057.ref059">59</xref>]. From the decoding perspective, it can, however, also pose a serious challenge: since neurons might be similarly active irrespective of whether the stimulus fluctuates locally or not, a downstream processing layer would have to suppress “hallucinations” in response to upstream network-driven or spontaneous activity (cf. [<xref ref-type="bibr" rid="pcbi.1006057.ref060">60</xref>]). This issue could be especially acute in the sensory periphery. The retina is an information bottleneck that conveys the information to the central brain in an essentially feed-forward fashion. Spontaneous activity [<xref ref-type="bibr" rid="pcbi.1006057.ref032">32</xref>–<xref ref-type="bibr" rid="pcbi.1006057.ref035">35</xref>] thus appears problematic, since there is no clear “extra” signal that could tell the downstream processing whether the input received from the retina is spontaneous or stimulus-driven; we thus looked for an intrinsic signature in the spike trains themselves. In contrast, cortex, with its recurrent / feedback architecture clearly supports the notion of cortical states that could provide additional information on how activity from higher sensory areas should be interpreted (e.g., is it a reverberation or current, stimulus-driven activity). Indeed, spontaneous and persistent spiking is widespread in the cortex [<xref ref-type="bibr" rid="pcbi.1006057.ref061">61</xref>–<xref ref-type="bibr" rid="pcbi.1006057.ref064">64</xref>] and has even been documented to statistically mimic the structure of stimulus-evoked activity [<xref ref-type="bibr" rid="pcbi.1006057.ref065">65</xref>].</p>
<p>Here we proposed a simple mechanism to discriminate spontaneous from stimulus-driven activity using history dependence of neural spiking: because neuronal encoding is nonlinear, the effect of spike-history dependence on neural firing substantially differs between epochs in which the neuron also experiences a strong stimulus drive and epochs in which it does not. In such situations, nonlinear methods can discriminate between a true stimulus fluctuation and spontaneous-like firing from statistical structure intrinsic to individual spike trains, even when the mean firing rate doesn’t change appreciably between different epochs. This mechanism is not specific to the retina, and may well apply in other systems that display both stimulus-evoked and spontaneous activity.</p>
</sec>
<sec id="sec019">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006057.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Decodable information is represented locally.</title>
<p><bold>Top.</bold> Average (± SD) number of contributing cells (red) and all cells (black), as a function of distance of the cell’s receptive field center to the site where the luminance trace is being decoded. <bold>Bottom.</bold> Average (± SD) single cell decoding performance as a function of distance to the site. Cells’ responses contain no decodable information for sites that are &gt; 200 <italic>μm</italic> distant from their receptive field centers. Both analyses are done for the 10-disc stimulus.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Cells are continuously active, but their responses only contain decodable information about local luminance fluctuations.</title>
<p>The following analyses are carried out with a 1-disc stimulus. <bold>A:</bold> Average (± SD) single cell decoding performance as a function of distance of the cell’s receptive field center to the site where the luminance trace is being decoded. <bold>B:</bold> Firing rates of ON (N = 14) and OFF (N = 34) cells as a function of the distance to the single moving disc. Both types of cells exhibit basal firing rates &gt; 10 Hz when the disc is far away from their receptive fields. OFF cells increase their firing rate when the dark disc is less than 200 <italic>μm</italic> away. ON cells decrease their firing in response to the dark disc and their firing rate peaks at the 200 <italic>μm</italic> mark, probably corresponding with the stimulation of their surround by the dark disc. <bold>C</bold>: Same as in <bold>B</bold> but now the basal firing rate (measured at 1000 <italic>μm</italic>) has been subtracted for each cell to emphasize the stereotyped dynamics of the cells’ activity. This analysis suggests that while cells are continuously active (even when the disc is far away and not stimulated by other discs, as in the case of <xref ref-type="supplementary-material" rid="pcbi.1006057.s001">S1 Fig</xref>), that activity does not contain decodable information about the luminance fluctuations farther than 200 <italic>μm</italic> from the receptive field center. In contrast, with simpler stimuli that stimulate retina more broadly (e.g., diffusively moving 1D bar), retinal ganglion cells encoded for the bar position in a distributed manner such that the stimulus could be decoded from multiple subsets of cells and even from cells whose receptive field centers were very distant from the bar position [<xref ref-type="bibr" rid="pcbi.1006057.ref012">12</xref>].</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Examples of decoding fields for 6 different cells.</title>
<p>Each pixel corresponds to a site (of a 50 × 50 grid) and the color code represents the decoding filter of the cell at that particular site and time. The filters have been normalized such that the site of maximum variation has variance equal to 1. The white noise receptive field center of each cell is shown for reference (black ellipse).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Decoding filters of best contributing cells have a stereotyped shape.</title>
<p>Decoding filters of the 1st and 2nd best contributing cells across sites, normalized to unit variance. The shape of the filters is very similar and differs primarily by a multiplicative scaling factor. We could assume a universal temporal profile for all cells at all sites, and perform the decoding by fitting a single multiplicative scale parameter (with a sign, to account for ON/OFF differences) per cell per site, with less than 6% drop in FVE on the 10-disc stimulus, compared to the model in the main text that makes no assumption about stereotyped filter shapes.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Decoding preferentially recruits OFF cells.</title>
<p>Bias in the ON/OFF cells ratio plotted separately for the single-, two- and three-best-cell decoding subsets for each site. By looking in detail at the contribution of ON vs OFF cells to stimulus reconstruction at every site we find a clear bias for OFF cells relative to the prediction based on random draws from the local ON/OFF composition (see <xref ref-type="sec" rid="sec002">Methods</xref>). This OFF bias matched our expectation for optimally tracking dark discs displayed in our experiments.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Redundancy of decodable information about local luminance traces.</title>
<p>Average fractional decrease in linear decoding performance across sites when progressively removing cells (± SD). At each site cells are removed in order of importance, according to their decoding filter norm. We compare the performance when decoding with all available cells (FVE(all)) and when decoding without the first <italic>N</italic> contributing cells (FVE). This is one way to estimate the redundancy in the population response. Removing 4-5 cells halves decoding performance, suggesting that the necessary information for linear decoding is contained in a small number of cells. This is in contrast with previous work [<xref ref-type="bibr" rid="pcbi.1006057.ref012">12</xref>], where we found that the information about the position of a moving bar was encoded in a highly redundant manner. In that work we were able to construct 5 disjoint subsets of cells (from 2 to 10 cells in size) from which the position of the bar could be decoded with low error. Together with <xref ref-type="supplementary-material" rid="pcbi.1006057.s002">S2 Fig</xref> this suggests that complex stimuli used here lead to much more local and less redundant responses that carry stimulus information (compared to e.g., diffusive bar motion), even though the retina is broadly active in both cases.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Choice of best subset of cells for kernelized nonlinear decoding.</title>
<p>Decoding error of the nonlinear decoder is plotted as a function of the number of cells considered for six different sites. Cells are ordered by the decreasing L1 norm of their linear filters (i.e., cell 1 is the best contributing cell, etc). The optimal subset (circle) is chosen through cross validation to minimize the error on the training set. The error of the nonlinear decoder on the test set is shown for comparison.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Examples of decoded movie frames with linear and kernelized nonlinear decoding.</title>
<p>Black contour marks the region of good cell coverage where linear decoding performs at <italic>FVE</italic> &gt; 0.4; green circles in decoded frames correspond to true positions of the discs.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Decoding from single cell type mosaics.</title>
<p><bold>A</bold>: OFF-cell mosaic (N = 33). In the left-most panel temporal receptive field and spatial receptive field centers are shown. Center panel shows the performance of the linear decoders in space (measured as FVE). The contour lines mark the boundary FVE = 0.3, and we only consider sites within this boundary to compute the average decoder performance (± SD across sites), achievable using increasing numbers of cells with highest L1 filter norm (right-most panel). For nonlinear decoding, “All” is the optimal subset that maximizes performance. <bold>B</bold>: ON-cell mosaic (N = 22). Details equivalent to <bold>A</bold>. In both cases, nonlinear decoding substantially improves on linear.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Decoding performance for a repeat experiment with a retina of a different rat.</title>
<p>Average decoder performance (± SD across sites), achievable using increasing number of cells with highest L1 filter norm. For kernelized nonlinear decoding, “All” is the optimal subset that maximizes performance. In the repeat experiment we isolated 64 retinal ganglion cells and identified 125 sites where linear decoding performed at FVE&gt;0.4.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s011" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Kernelized nonlinear classifiers outperform linear classifiers on multiple cells and single cell responses.</title>
<p><bold>A:</bold> Performance (F-score) of linear and nonlinear classifiers for different sites (black dots). Inset: average (± SEM) over sites is significantly different (p&lt;0.001). <bold>B:</bold> Performance (F-score) of linear and nonlinear classifiers for each site when trained and tested from a single cell response (the best cell for each site). Average performance is shown in the inset (± SEM) and the differences between linear and nonlinear are significant (p&lt;0.001).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s012" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>Kernelized nonlinear decoders predict more constant signal under blackout stimulation.</title>
<p><bold>A</bold>: Variance of the single cell decoded traces from spontaneous activity (average across sites ± SEM). The decoders are trained on 10-discs stimulus and tested on the responses recorded during blackout condition (full darkness). Nonlinear decoders produce traces with significantly lower variance (p&lt;0.001). <bold>B</bold>: Example of mean-subtracted blackout decoded traces from a single cell spike train (bottom) with linear and nonlinear decoders.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s013" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s013" xlink:type="simple">
<label>S13 Fig</label>
<caption>
<title>Kernelized nonlinear classifiers rely on spike-history dependencies.</title>
<p>Decrease in classifier performance (F-score) when spike-history dependencies or noise correlations are removed (average ± SEM across sites); percentages report fractional differences relative to the original performance.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s014" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s014" xlink:type="simple">
<label>S14 Fig</label>
<caption>
<title>Kernelized nonlinear decoders (classifiers) rely on spike-history dependences when decoding (classifying) single cell responses.</title>
<p>Changes in single cell decoders and classifiers performance when spike-history dependencies are removed. We show differences in average decoding error (MSE) for the decoder and differences in performance (F-score) for the classifier (± SEM). The percentages shown stand for average fractional difference with respect to the original performance (before removing correlations). The differences are statistically significant in both cases (p&lt;0.001).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s015" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s015" xlink:type="simple">
<label>S15 Fig</label>
<caption>
<title>Spike count variance-to-mean ratio <italic>F</italic> is similar for responses at locally constant luminance and spontaneous activity, and differs for locally fluctuating luminance.</title>
<p>Variance-to-mean ratio <italic>F</italic>, under different stimulus conditions, of the spike count distributions P(K) of the best cell for each site (average over sites ± SD). “Spontaneous” is the activity under blackout condition (no stimulus). Values of <italic>F</italic> of “spontaneous” and “constant” activities are not significantly different, pointing at similarities between these two responses. On the contrary, both of them are clearly different from the activity under fluctuating stimulation (p&lt;0.001).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s016" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s016" xlink:type="simple">
<label>S16 Fig</label>
<caption>
<title>Interspike interval distributions differ at locally fluctuating luminance and locally constant luminance or spontaneous activity.</title>
<p>Logarithmic differences between the Inter-Spike-Interval (ISI) distributions under fluctuating [<italic>p</italic><sub><italic>f</italic></sub>(<italic>ISI</italic>)] and constant [<italic>p</italic><sub><italic>c</italic></sub>(<italic>ISI</italic>)] stimulus and between fluctuating and spontaneous activity [<italic>p</italic><sub><italic>s</italic></sub>(<italic>ISI</italic>)]. The distributions are computed for the single best cell at each site. The average across sites (± SD) is shown. Similarly to the spike count distributions <italic>P</italic>(<italic>K</italic>), the <italic>ISI</italic> distributions show activity under constant stimulation to be more regular and dominated by <italic>ISI</italic> between 75 ms and 175 ms. <italic>ISI</italic> outside this range are more common during fluctuating stimulation.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s017" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s017" xlink:type="simple">
<label>S17 Fig</label>
<caption>
<title>GLM models account well for the firing rates of cells recorded in the 10-disc experiment.</title>
<p>Three examples of GLM fits of real cells in our data set. On the left we show the fitted filters, nonlinearity, and spike history term that compose the model. On the right we show real and model generated repeated stimulus raster responses, and compare the real and predicted PSTH.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s018" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s018" xlink:type="simple">
<label>S18 Fig</label>
<caption>
<title>Classifier performance for constant vs fluctuating local luminance peaks at an intermediate value of spike-history dependencies.</title>
<p>Average classifier performance (F-score) as a function of <italic>α</italic> (see <xref ref-type="fig" rid="pcbi.1006057.g004">Fig 4</xref> in the main text). The error bars correspond to standard deviation over 10 different realizations of the spike trains generated from the model for each value of <italic>α</italic>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s019" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s019" xlink:type="simple">
<label>S19 Fig</label>
<caption>
<title>Decoding error in constant and fluctuating segments is optimal for intermediate value of spike-history dependencies.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s020" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s020" xlink:type="simple">
<label>S20 Fig</label>
<caption>
<title>Deep neural network architecture and its protoype outputs.</title>
<p><bold>A</bold>: The used artifical neural network is a fully connected feed forward network with three hidden layers, each 150 units and hyperbolic tangent activation function. The networks learns to map the response, given by the windowed spike train (Input), to the stimulus (Output). <bold>B</bold>: For each unit in the last hidden layer we mark its corresponding output activation visualiuzed by contour lines. The white background indicates the selected cells as in <xref ref-type="fig" rid="pcbi.1006057.g001">Fig 1F</xref>. Note that due to sparsity regularization (prefering networks with smaller number of weights) only 41 cells have non-zero connections to the output in the presented instance.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s021" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s021" xlink:type="simple">
<label>S21 Fig</label>
<caption>
<title>Neural network decoding fields.</title>
<p>Examples of decoding fields for the same 6 cells of <xref ref-type="supplementary-material" rid="pcbi.1006057.s003">S3 Fig</xref>. The white noise receptive field center of each cell is shown for reference (blue ellipse). It is obtained by activating the network with a single spike of the cell at the specified time. The output is normalized as in <xref ref-type="supplementary-material" rid="pcbi.1006057.s003">S3 Fig</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006057.s022" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006057.s022" xlink:type="simple">
<label>S1 Video</label>
<caption>
<title>Segment of real and nonlinearly decoded movie.</title>
<p>The black contour marks the region of good cell coverage where linear decoding performs at <italic>FVE</italic> &gt; 0.4. Green contours of the discs in the real stimulus have been superimposed on the decoded movie as a visual aid for comparison purposes.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Matthew Chalk, Cristina Savin, and Jonathan D Victor for helpful comments on the manuscript. We also thank Christoph Lampert for useful discussions on kernel methods.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006057.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rieke</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Warland</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>de Ruyter van Steveninck</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>. <source>Spikes: Exploring the Neural Code</source>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>1997</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006057.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Oram</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Foldiak</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Perrett</surname> <given-names>DI</given-names></name>, <name name-style="western"><surname>Sengpiel</surname> <given-names>F</given-names></name>. <article-title>The ‘ideal homunculus’: decoding neural population signals</article-title>. <source><italic>Trends Neurosci</italic></source>. <year>1998</year>; <volume>21</volume>: <fpage>259</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0166-2236(97)01216-2" xlink:type="simple">10.1016/S0166-2236(97)01216-2</ext-link></comment> <object-id pub-id-type="pmid">9641539</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Georgopoulos</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Schwartz</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Kettner</surname> <given-names>RE</given-names></name>. <article-title>Neuronal population coding of movement direction</article-title>. <source><italic>Science</italic></source>. <year>1986</year>; <volume>233</volume>: <fpage>1416</fpage>–<lpage>1419</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.3749885" xlink:type="simple">10.1126/science.3749885</ext-link></comment> <object-id pub-id-type="pmid">3749885</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kay</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Naselaris</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Prenger</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>. <article-title>Identifying natural images from human brain activity</article-title>. <source><italic>Nature</italic></source>. <year>2008</year>; <volume>452</volume>: <fpage>352</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature06713" xlink:type="simple">10.1038/nature06713</ext-link></comment> <object-id pub-id-type="pmid">18322462</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Strong</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Koberle</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>de Ruyter van Steveninck</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>. <article-title>Entropy and information in neural spike trains</article-title>. <source><italic>Phys Rev Lett</italic></source>. <year>1998</year>; <volume>80</volume>: <fpage>197</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.80.197" xlink:type="simple">10.1103/PhysRevLett.80.197</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Archer</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>. <article-title>Bayesian entropy estimation for binary spike train data using parametric prior knowledge</article-title>. <source><italic>Advances Neural Info Proc Syst</italic></source>. <year>2013</year>; <volume>26</volume>: <fpage>1700</fpage>–<lpage>1708</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006057.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tkačik</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Marre</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Amodei</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Schneidman</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Berry</surname> <given-names>MJ</given-names> <suffix>2nd</suffix></name>. <article-title>Searching for collective behavior in a large network of sensory neurons</article-title>. <source><italic>PLOS Comput Biol</italic></source>. <year>2014</year>; <volume>10</volume>: <fpage>e1003408</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003408" xlink:type="simple">10.1371/journal.pcbi.1003408</ext-link></comment> <object-id pub-id-type="pmid">24391485</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Borst</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Theunissen</surname> <given-names>FE</given-names></name>. <article-title>Information theory and neural coding</article-title>. <source><italic>Nat Neurosci</italic></source>. <year>1999</year> <volume>2</volume>: <fpage>947</fpage>–<lpage>57</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/14731" xlink:type="simple">10.1038/14731</ext-link></comment> <object-id pub-id-type="pmid">10526332</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref009">
<label>9</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Quiroga</surname> <given-names>RQ</given-names></name>, <name name-style="western"><surname>Panzeri</surname> <given-names>S</given-names></name>. <chapter-title>Decoding and information theory in neuroscience</chapter-title>, pg. <fpage>139</fpage>–<lpage>163</lpage>. In <source>Principles of Neural Coding</source>, <name name-style="western"><surname>Quiroga</surname></name> and <name name-style="western"><surname>Panezeri</surname></name>, eds. <publisher-loc>Boca Raton, USA</publisher-loc>: <publisher-name>CRC Press</publisher-name>; <year>2013</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006057.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Rieke</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>de Ruyter van Steveninck</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Warland</surname> <given-names>D</given-names></name>. <article-title>Reading a neural code</article-title>. <source><italic>Science</italic></source>. <year>1991</year>; <volume>252</volume>: <fpage>1854</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.2063199" xlink:type="simple">10.1126/science.2063199</ext-link></comment> <object-id pub-id-type="pmid">2063199</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Warland</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Reinagel</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Meister</surname> <given-names>M</given-names></name>. <article-title>Decoding visual information from a population of retinal ganglion cells</article-title>. <source><italic>J Neurophysiol</italic></source>. <year>1997</year>; <volume>78</volume>: <fpage>2336</fpage>–<lpage>2350</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.1997.78.5.2336" xlink:type="simple">10.1152/jn.1997.78.5.2336</ext-link></comment> <object-id pub-id-type="pmid">9356386</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marre</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Botella-Soler</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Simmons</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Mora</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tkačik</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Berry</surname> <given-names>MJ</given-names> <suffix>2nd</suffix></name>. <article-title>High accuracy decoding of a dynamical motion from a large retinal population</article-title>. <source><italic>PLOS Comput Biol</italic></source>. <year>2015</year>; <volume>11</volume>: <fpage>e1004304</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004304" xlink:type="simple">10.1371/journal.pcbi.1004304</ext-link></comment> <object-id pub-id-type="pmid">26132103</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schwartz</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Macke</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Amodei</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Berry</surname> <given-names>MJ</given-names> <suffix>2nd</suffix></name>. <article-title>Low error discrimination using a correlated population code</article-title>. <source><italic>J Neurophysiol</italic></source>. <year>2012</year>; <volume>108</volume>: <fpage>1069</fpage>–<lpage>88</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00564.2011" xlink:type="simple">10.1152/jn.00564.2011</ext-link></comment> <object-id pub-id-type="pmid">22539825</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frechette</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Sher</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grivich</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Petrusca</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Litke</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Chichilnisky</surname> <given-names>EJ</given-names></name>. <article-title>Fidelity of the ensemble code for visual motion in primate retina</article-title>. <source><italic>J Neurophysiol</italic></source>. <year>2005</year>; <volume>94</volume>: <fpage>119</fpage>–<lpage>135</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.01175.2004" xlink:type="simple">10.1152/jn.01175.2004</ext-link></comment> <object-id pub-id-type="pmid">15625091</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Shlens</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sher</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Litke</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Chichilnisky</surname> <given-names>EJ</given-names></name> <etal>et al</etal>. <article-title>Spatio-temporal correlations and visual signaling in a complete neural population</article-title>. <source><italic>Nature</italic></source>. <year>2008</year>; <volume>454</volume>: <fpage>995</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature07140" xlink:type="simple">10.1038/nature07140</ext-link></comment> <object-id pub-id-type="pmid">18650810</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Ahmadian</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>. <article-title>Model-based decoding, information estimation, and change-point detection techniques for multineuron spike trains</article-title>. <source><italic>Neural Comput</italic></source>. <year>2011</year>; <volume>23</volume>: <fpage>1</fpage>–<lpage>45</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/NECO_a_00058" xlink:type="simple">10.1162/NECO_a_00058</ext-link></comment> <object-id pub-id-type="pmid">20964538</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lazar</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>Y</given-names></name>. <article-title>Massively parallel neural encoding and decoding of visual stimuli</article-title>. <source><italic>Neural Networks</italic></source>. <year>2012</year> <volume>32</volume>: <fpage>303</fpage>–<lpage>312</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neunet.2012.02.007" xlink:type="simple">10.1016/j.neunet.2012.02.007</ext-link></comment> <object-id pub-id-type="pmid">22397951</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerwinn</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Macke</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Bethge</surname> <given-names>M</given-names></name>. <article-title>Reconstructing stimuli from spike times of leaky integrate and fire neurons</article-title>. <source><italic>Front Neurosci</italic></source>. <year>2011</year> <volume>5</volume>: <fpage>1</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fnins.2011.00001" xlink:type="simple">10.3389/fnins.2011.00001</ext-link></comment> <object-id pub-id-type="pmid">21390287</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ahmadian</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>. <article-title>Efficient Markov chain Monte Carlo methods for decoding neural spike trains</article-title>. <source><italic>Neural Comp</italic></source>. <year>2011</year>; <volume>23</volume>: <fpage>46</fpage>–<lpage>96</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/NECO_a_00059" xlink:type="simple">10.1162/NECO_a_00059</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meytlis</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nichols</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Nirenberg</surname> <given-names>S</given-names></name>. <article-title>Determining the role of correlated firing in large populations of neurons using white noise and natural scene stimuli</article-title>. <source><italic>Vision Res</italic></source>. <year>2012</year>; <volume>70</volume>: <fpage>44</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.visres.2012.07.007" xlink:type="simple">10.1016/j.visres.2012.07.007</ext-link></comment> <object-id pub-id-type="pmid">22885035</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nichols</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Nirenberg</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Victor</surname> <given-names>JD</given-names></name>. <article-title>Interacting linear and nonlinear characteristics produce population coding asymmetries between ON and OFF cells in the retina</article-title>. <source><italic>J Neurosci</italic></source>. <year>2013</year>; <volume>33</volume>: <fpage>14958</fpage>–<lpage>14973</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1004-13.2013" xlink:type="simple">10.1523/JNEUROSCI.1004-13.2013</ext-link></comment> <object-id pub-id-type="pmid">24027295</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marre</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Amodei</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Deshmukh</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sadeghi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Soo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Holy</surname> <given-names>TE</given-names></name> <etal>et al</etal>. <article-title>Mapping a complete neural population in the retina</article-title>. <source><italic>J Neurosci</italic></source>. <year>2012</year>; <volume>32</volume>: <fpage>14859</fpage>–<lpage>14873</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.0723-12.2012" xlink:type="simple">10.1523/JNEUROSCI.0723-12.2012</ext-link></comment> <object-id pub-id-type="pmid">23100409</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Paiva</surname> <given-names>ARC</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Principe</surname> <given-names>JC</given-names></name>. <article-title>A reproducing kernel Hilbert space framework for spike train signal processing</article-title>. <source><italic>Neural Comput</italic></source>. <year>2009</year>; <volume>21</volume>: <fpage>424</fpage>–<lpage>449</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/neco.2008.09-07-614" xlink:type="simple">10.1162/neco.2008.09-07-614</ext-link></comment> <object-id pub-id-type="pmid">19431265</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>LeCun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Deep learning</article-title>. <source><italic>Nature</italic></source>. <year>2015</year>; <volume>521</volume>: <fpage>436</fpage>–<lpage>444</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14539" xlink:type="simple">10.1038/nature14539</ext-link></comment> <object-id pub-id-type="pmid">26017442</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hughes</surname> <given-names>A</given-names></name>. <article-title>A schematic eye for the rat</article-title>. <source><italic>Vision Res</italic></source>. <year>1979</year>; <volume>19</volume>(<issue>5</issue>):<fpage>569</fpage>–<lpage>88</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0042-6989(79)90143-3" xlink:type="simple">10.1016/0042-6989(79)90143-3</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kim</surname> <given-names>S-J</given-names></name>, <name name-style="western"><surname>Koh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lustig</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Boyd</surname> <given-names>S</given-names></name>, and <name name-style="western"><surname>Gorinevsky</surname> <given-names>D</given-names></name>. <article-title>An Interior-Point Method for Large-Scale l1-Regularized Least Squares</article-title>. <source><italic>IEEE J Sel Topics in Sign Proc</italic></source>. <year>2007</year>;<volume>1</volume>(<issue>4</issue>):<fpage>606</fpage>–<lpage>617</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/JSTSP.2007.910971" xlink:type="simple">10.1109/JSTSP.2007.910971</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lampert</surname> <given-names>CH</given-names></name>. <article-title>Kernel Methods in Computer Vision</article-title>. <source>Foundations and trends in computer graphics and vision</source> <volume>4</volume>(<issue>3</issue>); <year>2009</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006057.ref028">
<label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Bishop</surname> <given-names>CM</given-names></name>. <source>Pattern Recognition and Machine Learning</source>. <publisher-name>Springer</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006057.ref029">
<label>29</label>
<mixed-citation publication-type="other" xlink:type="simple">Memming Park I, Seth S, Paiva ARC, Li L, Principe JC. Kernel methods on spike train space for neuroscience: A tutorial. IEEE Signal Processing Magazine. 2013; 30(4).</mixed-citation>
</ref>
<ref id="pcbi.1006057.ref030">
<label>30</label>
<mixed-citation publication-type="other" xlink:type="simple">Kingma DP, Ba J, Adam: A Method for Stochastic Optimization, <italic>in Proceedings of ICLR</italic>, 2015.</mixed-citation>
</ref>
<ref id="pcbi.1006057.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McFarland</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Cui</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Butts</surname> <given-names>DA</given-names></name>. <article-title>Inferring nonlinear neuronal computation based on physiologically plausible inputs</article-title>. <source><italic>PLOS Comput Biol</italic></source>. <year>2013</year> <volume>9</volume>: <fpage>e1003142</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003143" xlink:type="simple">10.1371/journal.pcbi.1003143</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kuffler</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Fitzhugh</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Barlow</surname> <given-names>HB</given-names></name>. <article-title>Maintained activity in the cat’s retina in light and darkness</article-title>. <source><italic>J Gen Physiol</italic></source>. <year>1957</year>; <volume>40</volume>: <fpage>683</fpage>–<lpage>702</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1085/jgp.40.5.683" xlink:type="simple">10.1085/jgp.40.5.683</ext-link></comment> <object-id pub-id-type="pmid">13428983</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Troy</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>BB</given-names></name>. <article-title>Steady discharges of macaque retinal ganglion cells</article-title>. <source><italic>Vis Neurosci</italic></source>. <year>1994</year>; <volume>11</volume>: <fpage>111</fpage>–<lpage>118</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S0952523800011159" xlink:type="simple">10.1017/S0952523800011159</ext-link></comment> <object-id pub-id-type="pmid">8011574</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shlens</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Field</surname> <given-names>GD</given-names></name>, <name name-style="western"><surname>Gauthier</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Grivich</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Petrusca</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sher</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Litke</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Chichilnisky</surname> <given-names>EJ</given-names></name>. <article-title>The structure of multi-neuron firing patterns in primate retina</article-title>. <source><italic>J Neurosci</italic></source>. <year>2006</year>; <volume>26</volume>: <fpage>8254</fpage>–<lpage>8266</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1282-06.2006" xlink:type="simple">10.1523/JNEUROSCI.1282-06.2006</ext-link></comment> <object-id pub-id-type="pmid">16899720</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Freeman</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Heine</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>Passaglia</surname> <given-names>CL</given-names></name>. <article-title>The maintained discharge of rat retinal ganglion cells</article-title>. <source><italic>Vis Neurosci</italic></source>. <year>2008</year>; <volume>25</volume>: <fpage>535</fpage>–<lpage>548</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S095252380808067X" xlink:type="simple">10.1017/S095252380808067X</ext-link></comment> <object-id pub-id-type="pmid">18634718</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Fellows</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>A point process framework for relating neural spiking activity to spiking history, neural ensemble, and extrinsic covariate effects</article-title>. <source><italic>J Neurophysiol</italic></source>. <year>2005</year>; <volume>14</volume>: <fpage>1074</fpage>–<lpage>1089</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00697.2004" xlink:type="simple">10.1152/jn.00697.2004</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref037">
<label>37</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>. <chapter-title>Likelihood-based approaches to modeling the neural code</chapter-title>. In <source><italic>Bayesian Brain: Probabilistic Approaches to Neural Coding</italic></source>, <name name-style="western"><surname>Doya</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shiii</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rao</surname> <given-names>R</given-names></name> eds, pg. <fpage>53</fpage>–<lpage>70</lpage>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>2007</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006057.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Hochberg</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>. <article-title>Collective dynamics in human and monkey sensorimotor cortex: predicting single neuron spikes</article-title>. <source><italic>Nature Neurosci</italic></source>. <year>2010</year>; <volume>13</volume>: <fpage>105</fpage>–<lpage>113</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2455" xlink:type="simple">10.1038/nn.2455</ext-link></comment> <object-id pub-id-type="pmid">19966837</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lawhern</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Hatsopoulos</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>. <article-title>Population decoding of motor cortical activity using a generalized linear model with hidden states</article-title>. <source><italic>J Neurosci Methods</italic></source>. <year>2010</year>; <volume>189</volume>: <fpage>267</fpage>–<lpage>280</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jneumeth.2010.03.024" xlink:type="simple">10.1016/j.jneumeth.2010.03.024</ext-link></comment> <object-id pub-id-type="pmid">20359500</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deny</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ferrari</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Mace</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Yger</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Caplette</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Picaud</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tkačik</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Marre</surname> <given-names>O</given-names></name>. <article-title>Multiplexed computations in retinal ganglion cells of a single type</article-title>. <source><italic>Nature Comms</italic></source>. <year>2017</year>; <volume>8</volume>: <fpage>1964</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41467-017-02159-y" xlink:type="simple">10.1038/s41467-017-02159-y</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fernandes</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Pinto</surname> <given-names>BDL</given-names></name>, <name name-style="western"><surname>Almeida</surname> <given-names>LOB</given-names></name>, <name name-style="western"><surname>Slaets</surname> <given-names>JFW</given-names></name>, <name name-style="western"><surname>Koberle</surname> <given-names>R</given-names></name>. <article-title>Recording from two neurons: second-order stimulus reconstruction from spike trains and population coding</article-title>. <source><italic>Neural Comput</italic></source>. <year>2010</year>; <volume>22</volume>: <fpage>2537</fpage>–<lpage>2557</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/NECO_a_00016" xlink:type="simple">10.1162/NECO_a_00016</ext-link></comment> <object-id pub-id-type="pmid">20608867</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Zee</surname> <given-names>A</given-names></name>. <article-title>Coding and computation with neural spike trains</article-title>. <source><italic>J Stat Phys</italic></source>. <year>1990</year>; <volume>59</volume>: <fpage>103</fpage>–<lpage>115</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF01015565" xlink:type="simple">10.1007/BF01015565</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rad</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>. <article-title>Information rates and optimal decoding in large neural populations</article-title>. <source><italic>Adv Neural Proc Syst</italic></source>. <year>2011</year>; <volume>24</volume>: <fpage>846</fpage>–<lpage>854</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006057.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leonardo</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Meister</surname> <given-names>M</given-names></name>. <article-title>Nonlinear dynamics support a linear population code in a retinal target tracking circuit</article-title>. <source><italic>J Neurosci</italic></source>. <year>2013</year>; <volume>33</volume>: <fpage>16971</fpage>–<lpage>16982</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2257-13.2013" xlink:type="simple">10.1523/JNEUROSCI.2257-13.2013</ext-link></comment> <object-id pub-id-type="pmid">24155302</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boerlin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Deneve</surname> <given-names>S</given-names></name>. <article-title>Spike-based population coding and working memory</article-title>. <source><italic>PLOS Comput Biol</italic></source>. <year>2011</year> <volume>7</volume>: <fpage>e1001080</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1001080" xlink:type="simple">10.1371/journal.pcbi.1001080</ext-link></comment> <object-id pub-id-type="pmid">21379319</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boerlin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Machens</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Deneve</surname> <given-names>S</given-names></name>. <article-title>Predictive coding of dynamical variables in balanced spiking networks</article-title>. <source><italic>PLOS Comput Biol</italic></source>. <year>2013</year>; <volume>9</volume>: <fpage>e1003258</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003258" xlink:type="simple">10.1371/journal.pcbi.1003258</ext-link></comment> <object-id pub-id-type="pmid">24244113</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deneve</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chalk</surname> <given-names>M</given-names></name>. <article-title>Efficiency turns the table on neural encoding, decoding and noise</article-title>. <source><italic>Curr Opin Neurobiol</italic></source>. <year>2016</year>; <volume>37</volume>: <fpage>141</fpage>–<lpage>148</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2016.03.002" xlink:type="simple">10.1016/j.conb.2016.03.002</ext-link></comment> <object-id pub-id-type="pmid">27065340</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>. <article-title>Neural correlations, population coding and computation</article-title>. <source><italic>Nat Rev Neurosci</italic></source>. <year>2006</year>; <volume>7</volume>: <fpage>358</fpage>–<lpage>366</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn1888" xlink:type="simple">10.1038/nrn1888</ext-link></comment> <object-id pub-id-type="pmid">16760916</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schneidman</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Berry</surname> <given-names>MJ</given-names> <suffix>2nd</suffix></name>, <name name-style="western"><surname>Segev</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>. <article-title>Weak pairwise correlations imply strongly correlated network states in a neural population</article-title>. <source><italic>Nature</italic></source>. <year>2006</year>; <volume>440</volume>: <fpage>1007</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature04701" xlink:type="simple">10.1038/nature04701</ext-link></comment> <object-id pub-id-type="pmid">16625187</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ecker</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Keliris</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Bethge</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Logothetis</surname> <given-names>NK</given-names></name>, <name name-style="western"><surname>Tolias</surname> <given-names>AS</given-names></name>. <article-title>Decorrelated neuronal firing in cortical microcircuits</article-title>. <source><italic>Science</italic></source>. <year>2010</year>; <volume>327</volume>: <fpage>584</fpage>–<lpage>587</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1179867" xlink:type="simple">10.1126/science.1179867</ext-link></comment> <object-id pub-id-type="pmid">20110506</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Granot-Atedgi</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Tkačik</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Segev</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Schneidman</surname> <given-names>E</given-names></name>. <article-title>Stimulus-dependent maximum entropy models of neural population codes</article-title>. <source><italic>PLOS Comput Biol</italic></source>. <year>2013</year>; <volume>9</volume>: <fpage>e1002922</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002922" xlink:type="simple">10.1371/journal.pcbi.1002922</ext-link></comment> <object-id pub-id-type="pmid">23516339</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stanley</surname> <given-names>GB</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>FF</given-names></name>, <name name-style="western"><surname>Dan</surname> <given-names>Y</given-names></name>. <article-title>Reconstruction of natural scenes from ensemble responses in the lateral geniculate nucleus</article-title>. <source><italic>J Neurosci</italic></source>. <year>1999</year>; <volume>19</volume>: <fpage>8036</fpage>–<lpage>8042</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.19-18-08036.1999" xlink:type="simple">10.1523/JNEUROSCI.19-18-08036.1999</ext-link></comment> <object-id pub-id-type="pmid">10479703</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nishimoto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Vu</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Naselaris</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Benjamini</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>. <article-title>Reconstructing visual experiences from brain activity evoked by natural movies</article-title>. <source><italic>Curr Biol</italic></source>. <year>2011</year>; <volume>21</volume>: <fpage>1641</fpage>–<lpage>1646</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cub.2011.08.031" xlink:type="simple">10.1016/j.cub.2011.08.031</ext-link></comment> <object-id pub-id-type="pmid">21945275</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>DiCarlo</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Zoccolan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rust</surname> <given-names>NC</given-names></name>. <article-title>How does the brain solve visual object recognition?</article-title> <source><italic>Neuron</italic></source>. <year>2012</year>; <volume>73</volume>: <fpage>415</fpage>–<lpage>434</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2012.01.010" xlink:type="simple">10.1016/j.neuron.2012.01.010</ext-link></comment> <object-id pub-id-type="pmid">22325196</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref055">
<label>55</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hyvärinen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hurri</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hoyer</surname> <given-names>PO</given-names></name>. <source>Natural Image Statistics—A probabilistic approach to early computational vision</source>. <publisher-loc>Longon</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2009</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006057.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nelken</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Rotman</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yosef</surname> <given-names>OB</given-names></name>. <article-title>Response of auditory-cortex neurons to structural features of natural sounds</article-title>. <source><italic>Nature</italic></source>. <year>1999</year>; <volume>397</volume>: <fpage>154</fpage>–<lpage>156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/16456" xlink:type="simple">10.1038/16456</ext-link></comment> <object-id pub-id-type="pmid">9923676</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vinje</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>. <article-title>Sparse coding and decorrelation in primary visual cortex during natural vision</article-title>. <source><italic>Science</italic></source>. <year>2000</year>; <volume>287</volume>: <fpage>1273</fpage>–<lpage>1276</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.287.5456.1273" xlink:type="simple">10.1126/science.287.5456.1273</ext-link></comment> <object-id pub-id-type="pmid">10678835</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Froudarakis</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ecker</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Cotton</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Sinz</surname> <given-names>FH</given-names></name>, <name name-style="western"><surname>Yatsenko</surname> <given-names>D</given-names></name> <etal>et al</etal>. <article-title>Population code in mouse V1 facilitates readout of natural scene through increased sparseness</article-title>. <source><italic>Nat Neurosci</italic></source>. <year>2014</year>; <volume>17</volume>: <fpage>851</fpage>–<lpage>860</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3707" xlink:type="simple">10.1038/nn.3707</ext-link></comment> <object-id pub-id-type="pmid">24747577</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baudot</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Levy</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Marre</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Monier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pananceau</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Frégnac</surname> <given-names>Y</given-names></name>. <article-title>Animation of natural scene by virtual eye-movements evokes high precision and low noise in V1 neurons</article-title>. <source><italic>Front Neural Circuits</italic></source>. <year>2013</year>; <volume>7</volume>: <fpage>206</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncir.2013.00206" xlink:type="simple">10.3389/fncir.2013.00206</ext-link></comment> <object-id pub-id-type="pmid">24409121</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kaufman</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Churchland</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Ryu</surname> <given-names>SI</given-names></name>, <name name-style="western"><surname>Shenoy</surname> <given-names>KV</given-names></name>. <article-title>Cortical activity in the null space: permitting preparation without movement</article-title>. <source><italic>Nature Neurosci</italic></source>. <year>2014</year>; <volume>17</volume>: <fpage>440</fpage>–<lpage>448</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3643" xlink:type="simple">10.1038/nn.3643</ext-link></comment> <object-id pub-id-type="pmid">24487233</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Destexhe</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Contreras</surname> <given-names>D</given-names></name>. <article-title>Neuronal computations with stochastic network states</article-title>. <source><italic>Science</italic></source>. <year>2006</year>; <volume>314</volume>: <fpage>85</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1127241" xlink:type="simple">10.1126/science.1127241</ext-link></comment> <object-id pub-id-type="pmid">17023650</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Major</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Tank</surname> <given-names>DW</given-names></name>. <article-title>Persistent neural activity: prevalence and mechanisms</article-title>. <source><italic>Curr Opin Neurobiol</italic></source>. <year>2004</year>; <volume>14</volume>: <fpage>675</fpage>–<lpage>684</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2004.10.017" xlink:type="simple">10.1016/j.conb.2004.10.017</ext-link></comment> <object-id pub-id-type="pmid">15582368</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ringach</surname> <given-names>DL</given-names></name>. <article-title>Spontaneous and driven cortical activity: implications for computation</article-title>. <source><italic>Curr Opin Neurobiol</italic></source>. <year>2009</year>; <volume>19</volume>: <fpage>439</fpage>–<lpage>444</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2009.07.005" xlink:type="simple">10.1016/j.conb.2009.07.005</ext-link></comment> <object-id pub-id-type="pmid">19647992</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tsodyks</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kenet</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Grinvald</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Arieli</surname> <given-names>A</given-names></name>. <article-title>Linking spontaneous activity of single cortical neurons and the underlying functional architecture</article-title>. <source><italic>Science</italic></source>. <year>1999</year>; <volume>286</volume>: <fpage>1943</fpage>–<lpage>1946</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.286.5446.1943" xlink:type="simple">10.1126/science.286.5446.1943</ext-link></comment> <object-id pub-id-type="pmid">10583955</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006057.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berkes</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Orban</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Lengyel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fiser</surname> <given-names>J</given-names></name>. <source><italic>Science</italic></source>. <year>2011</year> <volume>331</volume>: <fpage>83</fpage>–<lpage>87</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1195870" xlink:type="simple">10.1126/science.1195870</ext-link></comment> <object-id pub-id-type="pmid">21212356</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>