<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00039</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005071</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>DNA</subject><subj-group><subject>DNA recombination</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>DNA</subject><subj-group><subject>DNA recombination</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>DNA</subject><subj-group><subject>DNA recombination</subject><subj-group><subject>Homologous recombination</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>DNA</subject><subj-group><subject>DNA recombination</subject><subj-group><subject>Homologous recombination</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Algebra</subject><subj-group><subject>Algebraic topology</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Topology</subject><subj-group><subject>Algebraic topology</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data visualization</subject><subj-group><subject>Infographics</subject><subj-group><subject>Graphs</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome evolution</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome evolution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Molecular evolution</subject><subj-group><subject>Genome evolution</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Inference of Ancestral Recombination Graphs through Topological Data Analysis</article-title>
<alt-title alt-title-type="running-head">Inference of ARGs through Topological Data Analysis</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Cámara</surname> <given-names>Pablo G.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Levine</surname> <given-names>Arnold J.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Rabadán</surname> <given-names>Raúl</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Systems Biology and Department of Biomedical Informatics, Columbia University College of Physicians and Surgeons, New York, New York, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>The Simons Center for Systems Biology, Institute for Advanced Study, Princeton, New Jersey, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Kosakovsky Pond</surname> <given-names>Sergei L.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Temple University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p><list list-type="simple">
<list-item><p><bold>Conceived and designed the experiments:</bold> PGC RR.</p></list-item>
<list-item><p><bold>Analyzed the data:</bold> PGC.</p></list-item>
<list-item><p><bold>Wrote the paper:</bold> PGC AJL RR.</p></list-item>
<list-item><p><bold>Developed and implemented the algorithm:</bold> PGC.</p></list-item></list></p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">pg2495@cumc.columbia.edu</email> (PGC); <email xlink:type="simple">rr2579@cumc.columbia.edu</email> (RR)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>17</day>
<month>8</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>8</issue>
<elocation-id>e1005071</elocation-id>
<history>
<date date-type="received">
<day>10</day>
<month>1</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>20</day>
<month>7</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>G. Cámara et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005071"/>
<abstract>
<p>The recent explosion of genomic data has underscored the need for interpretable and comprehensive analyses that can capture complex phylogenetic relationships within and across species. Recombination, reassortment and horizontal gene transfer constitute examples of pervasive biological phenomena that cannot be captured by tree-like representations. Starting from hundreds of genomes, we are interested in the reconstruction of potential evolutionary histories leading to the observed data. Ancestral recombination graphs represent potential histories that explicitly accommodate recombination and mutation events across orthologous genomes. However, they are computationally costly to reconstruct, usually being infeasible for more than few tens of genomes. Recently, Topological Data Analysis (TDA) methods have been proposed as robust and scalable methods that can capture the genetic scale and frequency of recombination. We build upon previous TDA developments for detecting and quantifying recombination, and present a novel framework that can be applied to hundreds of genomes and can be interpreted in terms of minimal histories of mutation and recombination events, quantifying the scales and identifying the genomic locations of recombinations. We implement this framework in a software package, called TARGet, and apply it to several examples, including small migration between different populations, human recombination, and horizontal evolution in finches inhabiting the Galápagos Islands.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Evolution occurs through different mechanisms, including point mutations, gene duplication, horizontal gene transfer, and recombinations. Some of these mechanisms cannot be captured by tree graphs. We present a framework, based on the mathematical tools of computational topology, that can explicitly accommodate both recombination and mutation events across the evolutionary history of a sample of genomic sequences. This approach generates a new type of summary graph and algebraic structures that provide quantitative information on the evolutionary scale and frequency of recombination events. The accompanying software, TARGet, is applied to several examples, including migration between sexually-reproducing populations, human recombination, and recombination in Darwin’s finches.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000054</institution-id>
<institution>National Cancer Institute</institution>
</institution-wrap>
</funding-source>
<award-id>U54 CA193313</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Rabadán</surname> <given-names>Raúl</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>NIGMS R01-GM117591</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Rabadán</surname> <given-names>Raúl</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>The work of the authors is supported by National Institutes of Health (NIH) grants U54 CA193313 and NIGMS R01-GM117591 (<ext-link ext-link-type="uri" xlink:href="http://www.cancer.gov/" xlink:type="simple">http://www.cancer.gov/</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.nigms.nih.gov/Pages/default.aspx" xlink:type="simple">https://www.nigms.nih.gov/Pages/default.aspx</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="11"/>
<table-count count="0"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Since the publication of the first draft of the human genome [<xref ref-type="bibr" rid="pcbi.1005071.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref002">2</xref>], there has been an explosion in genomic data. The genomes of thousands of different human individuals have been sequenced [<xref ref-type="bibr" rid="pcbi.1005071.ref003">3</xref>], several hundreds of eukaryotic genomes have been characterized, and new viral, bacterial and archaeal species are being sequenced on an almost daily basis [<xref ref-type="bibr" rid="pcbi.1005071.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref005">5</xref>]. Darwin provided a historical dimension to the taxonomical enterprise, proposing that closely related species in the hierarchical taxonomy share ancestors. Since then, tree-like structures have been proposed to represent the evolutionary/historical relationship between organisms. In the last few years, however, the richer and more comprehensive genomic characterization of many organisms have underscored the need of representations that are not strictly tree-like. Phenomena such as horizontal gene transfer in bacteria [<xref ref-type="bibr" rid="pcbi.1005071.ref006">6</xref>], the ability of viruses to borrow and lend genes across species, and hybridization in metazoa (in plants, in particular [<xref ref-type="bibr" rid="pcbi.1005071.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref008">8</xref>]) are exposing some of the limitations imposed by tree-like phylogenetic structures. The definition of species itself becomes cumbersome in bacteria and viruses [<xref ref-type="bibr" rid="pcbi.1005071.ref009">9</xref>]. Within many species, including humans, genetic recombination is so pervasive that tree-like representations are useless. It is then natural to wonder what other frameworks could be used to capture phylogenetic relationships without losing the interpretability and simplicity of trees [<xref ref-type="bibr" rid="pcbi.1005071.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1005071.ref012">12</xref>]. Of particular interest are representations that reduce to trees when evolution is tree-like; that capture genetic relations between ancestors, and identify genomic regions originating from different ancestral lineages; and, more generally, that allow for an interpretation of the observed data in terms of a chronological sequence of events.</p>
<p>Several such frameworks have been proposed in the last two decades. The study of phylogenetic networks has been an area particularly active [<xref ref-type="bibr" rid="pcbi.1005071.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1005071.ref015">15</xref>]. Phylogenetic networks provide representations that extend trees to graphs (networks), generating loops when the data does not fit into a tree. Some of those methods can easily be applied to more than one hundred genomes [<xref ref-type="bibr" rid="pcbi.1005071.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1005071.ref021">21</xref>] providing the opportunity for large-scale representations. However, the biological interpretation of these representations is limited, as loops represent inconsistencies with trees, but it is unclear how these inconsistencies arose historically, what genomic regions were involved, or how frequently an exchange happened. Other types of representations, sometimes named <italic>explicit networks</italic> [<xref ref-type="bibr" rid="pcbi.1005071.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref022">22</xref>], do aim to provide a historical account in terms of a chronology of events. Ancestral recombination graphs (ARGs) provide potential explanations of the observed data in terms of a progression of recombination and mutation events. As in trees, mutations are represented as events along the branches. Recombinations, however, appear as the fusion of two parental branches into one offspring branch. ARGs provide simple histories that can be used in association mapping [<xref ref-type="bibr" rid="pcbi.1005071.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1005071.ref025">25</xref>], SNP genotyping [<xref ref-type="bibr" rid="pcbi.1005071.ref026">26</xref>] or inference of the frequency and scale of recombination [<xref ref-type="bibr" rid="pcbi.1005071.ref027">27</xref>]. However, these applications are hindered by the computational infeasibility of constructing ARGs that explain hundreds of sequences. The construction of minimal ARGs, containing the minimum number of recombination events required to explain the sample in absence of convergent evolution and back-mutation, is an NP-hard problem [<xref ref-type="bibr" rid="pcbi.1005071.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1005071.ref030">30</xref>]. Several approximations have been developed in the last few years, including galled trees [<xref ref-type="bibr" rid="pcbi.1005071.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref032">32</xref>], branch and bound [<xref ref-type="bibr" rid="pcbi.1005071.ref033">33</xref>], heuristic [<xref ref-type="bibr" rid="pcbi.1005071.ref023">23</xref>] and sequentially Markov coalescent approaches [<xref ref-type="bibr" rid="pcbi.1005071.ref034">34</xref>].</p>
<p>Recently, a new framework to study genomic relationships has been proposed [<xref ref-type="bibr" rid="pcbi.1005071.ref035">35</xref>–<xref ref-type="bibr" rid="pcbi.1005071.ref037">37</xref>], based on topological data analysis [<xref ref-type="bibr" rid="pcbi.1005071.ref038">38</xref>–<xref ref-type="bibr" rid="pcbi.1005071.ref040">40</xref>]. Topology is the area of mathematics that aims to characterize properties of spaces up to continuous deformations, for instance the number of disconnected components, loops and holes of a space. TDA extends the concepts and tools of topology to finite metric spaces, that is, finite sets of points and distances between them. Taking the premise that a set of points has been sampled from an unknown underlying space, TDA attempts to infer the topological features of the space (<xref ref-type="fig" rid="pcbi.1005071.g001">Fig 1A</xref>). Stability results [<xref ref-type="bibr" rid="pcbi.1005071.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref042">42</xref>] guarantee that small fluctuations in the data only create small changes in the inferred topological features, providing robust characterizations of the data.</p>
<fig id="pcbi.1005071.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005071.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Topological data analysis.</title>
<p>(A) Topological data analysis aims to infer the topological features (e.g. loops, voids, etc.) of an unknown space from a finite set of sampled points. (B) Persistent homology, a tool of TDA, builds simplicial complexes (generalizations of networks that include higher dimensional elements like triangles and tetraheadra), by taking balls of radius <italic>ϵ</italic> centred on the sampled points. Points are connected in the simplicial complex if the corresponding balls intersect. This construction is known as Vitoris-Rips complex. Persistent homology tracks how the topological features of Vietoris-Rips complexes change with <italic>ϵ</italic>. (C) Barcodes are suitable representations of persistent homology. Each interval in the barcode represents the range of <italic>ϵ</italic> across which a particular topological feature (for instance, a loop) is present in the inferred topology. In this figure, the barcode of the first persistent homology, that tracks the presence of loops, is shown. The two intervals in the barcode correspond to the two loops present in the original space.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.g001" xlink:type="simple"/>
</fig>
<p>In a TDA framework, genomes are characterized by points in a high dimensional space where pairwise distances are genetic distances between sequences. Assuming that each genomic site mutates at most once across the evolutionary history of the sample, the genetic distance between two genomes can only increase with the acquisition of novel mutations. The only way of “closing” a loop (a close path) in this space is therefore by means of a recombination event [<xref ref-type="bibr" rid="pcbi.1005071.ref035">35</xref>]. Hence, an approach to studying recombination in the sample of genetic sequences is to study the loops that those sequences generate when represented in the above way.</p>
<p>A valuable attribute of TDA methods is that they are informative about the scale or size of the inferred topological features. Given a finite set of data points, there is an infinite number of spaces that are compatible with the points. TDA structures this spectrum of possibilities by introducing a notion of scale (<xref ref-type="fig" rid="pcbi.1005071.g001">Fig 1B</xref>): at a given scale <italic>ϵ</italic>, two points are connected in the underlying space if their distance is smaller than <italic>ϵ</italic>. Topological features compatible with the data can be then summarized in terms of sets of intervals, named <italic>barcodes</italic> [<xref ref-type="bibr" rid="pcbi.1005071.ref043">43</xref>] (<xref ref-type="fig" rid="pcbi.1005071.g001">Fig 1C</xref>). Each interval in a barcode represents the range of scales across which a particular topological feature (e.g. a loop) is present in the inferred topological space. In the genomic context introduced above, barcodes of loops summarize the frequency and scale (mutational distance between recombining sequences) of recombination events, and provide a basic structure on which statistics of genomic exchange can be built [<xref ref-type="bibr" rid="pcbi.1005071.ref037">37</xref>].</p>
<p>TDA methods are particularly well suited for large datasets. In the context of molecular phylogenetics and evolution, they have been applied to the study of viral recombination and reassortment [<xref ref-type="bibr" rid="pcbi.1005071.ref035">35</xref>], bacterial species [<xref ref-type="bibr" rid="pcbi.1005071.ref036">36</xref>] and point estimators in population genetics [<xref ref-type="bibr" rid="pcbi.1005071.ref037">37</xref>]. However, these implementations of TDA have limitations, as they are not tailored for the biological problem they try to address. Specifically, traditional TDA methods only use information about genetic distances between sequences, and so they discard the full structure of segregating characters, missing numerous recombination events that are required to explain the data. Relatedly, it is unclear which specific evolutionary histories explaining the data TDA informs about, and what is the precise relation between barcodes and these histories.</p>
<p>Here we address these two important aspects, improving on the scalable capabilities of TDA to extract robust information on the possible evolutionary histories of a sample of genetic sequences. In particular, we show that by systematically sampling subsets of segregating sites and performing TDA, we are able to identify most of the necessary recombination events identified by bound methods [<xref ref-type="bibr" rid="pcbi.1005071.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref044">44</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref045">45</xref>], providing a significant improvement of past methods [<xref ref-type="bibr" rid="pcbi.1005071.ref035">35</xref>–<xref ref-type="bibr" rid="pcbi.1005071.ref037">37</xref>] in terms of interpretation and sensitivity. Moreover, we introduce a novel type of graph (<italic>topological ARG</italic> or <italic>tARG</italic>), closely related to minimal ARGs, that captures ensembles of minimal recombination histories; and we show that TDA informs about the topological features and genetic scales of these graphs. Like minimal ARGs [<xref ref-type="bibr" rid="pcbi.1005071.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref023">23</xref>], tARGs can be considered as explicit, parsimonious, interpretable phylogenetic representations. The main advantage of tARGs and barcodes versus minimal ARGs is, however, the possibility of obtaining such phylogenetic information in polynomial time, which allows us to deal with hundreds of sequences. We have implemented this method in a software, called <monospace>TARGet</monospace>, and have illustrated it with several examples, including small migration between diverging populations, human recombination, and horizontal evolution of finches inhabiting the Galápagos archipelago. The software, instructions and example files used in the manuscript can be obtained from <ext-link ext-link-type="uri" xlink:href="https://github.com/RabadanLab/TARGet" xlink:type="simple">https://github.com/RabadanLab/TARGet</ext-link>.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Topological ARGs</title>
<p>An ARG is an explicit phylogenetic network representing a possible evolutionary history of a sample of genetic sequences, where only mutation and recombination events are present and convergent evolution is not considered and so never occurs [<xref ref-type="bibr" rid="pcbi.1005071.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref047">47</xref>]. ARGs are very useful constructs in population genetics and phylogenetics. However, the problem of building a minimal ARG from a set of genetic sequences is known to be NP-hard [<xref ref-type="bibr" rid="pcbi.1005071.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1005071.ref030">30</xref>]. The use of ARGs has therefore been traditionally limited to small samples, consisting of a handful of sequences.</p>
<p>In this section, we introduce a particular class of minimal ARGs and a set of related graphs. Then, using computational algebraic topology, in the next section we show that it is possible to extract, in polynomial time, phylogenetic information from this class of minimal ARGs, without having to explicitly construct them. Thus, by restricting to this specific class of graphs, we are able to extend the realm of ARGs to large samples of sequences.</p>
<p>To be specific, we consider a sample <inline-formula id="pcbi.1005071.e001"><alternatives><graphic id="pcbi.1005071.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> consisting of <italic>n</italic> distinct genetic sequences with <italic>m</italic> binary segregating characters. The latter can be single nucleotide polymorphisms (SNPs), indels, gene duplications or any other genetic trait that takes one of two possible states, 0 or 1, in each sequence. An ARG is then formally defined as a directed acyclic graph <inline-formula id="pcbi.1005071.e002"><alternatives><graphic id="pcbi.1005071.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> with <italic>n</italic> leaf nodes and a unique root node, where every node other than the root has in-degree one (tree node) or two (recombination node), every segregating character labels a unique edge in <inline-formula id="pcbi.1005071.e003"><alternatives><graphic id="pcbi.1005071.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> (infinite sites assumption), and every sequence in <inline-formula id="pcbi.1005071.e004"><alternatives><graphic id="pcbi.1005071.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> labels a unique leaf in <inline-formula id="pcbi.1005071.e005"><alternatives><graphic id="pcbi.1005071.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula>. Moreover, each node in <inline-formula id="pcbi.1005071.e006"><alternatives><graphic id="pcbi.1005071.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> is labelled by a <italic>m</italic>-length binary sequence, such that the sequence labelling a tree node differs from the sequence of the parent node only at the character labelling the edge that connects the two nodes; and the sequence labelling a recombination node is a combination of the sequences labelling the two parent nodes. Single-crossover recombinant sequences are formed by taking the first <italic>k</italic> sites from the sequence of one of the parent nodes (<italic>prefix</italic>) and appending the last <italic>m</italic> − <italic>k</italic> sites from the sequence of the other parent node (<italic>suffix</italic>), for <italic>k</italic> ∈ [1, <italic>m</italic> − 1].</p>
<p>There is an infinite number of ARGs that can explain a given sample <inline-formula id="pcbi.1005071.e007"><alternatives><graphic id="pcbi.1005071.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1005071.ref022">22</xref>]. A stochastic model, such as the coalescent model with recombination [<xref ref-type="bibr" rid="pcbi.1005071.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref048">48</xref>], would assign probabilities to each possible ARG. Here, however, we adopt a parsimony approach and consider ARGs that are minimal (in a sense defined below), without assuming an underlying probabilistic model. Such a model-independent approach has proven useful in summarizing genetic sequences into evolutionary histories where all events are required.</p>
<p>Specifically, we consider ARGs that contain exactly the minimum number <italic>R</italic><sub>min</sub> of single-crossover recombinations required to explain the sample, and that minimize the function
<disp-formula id="pcbi.1005071.e008"><alternatives><graphic id="pcbi.1005071.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:mi>D</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:msub><mml:mi>R</mml:mi> <mml:mtext>min</mml:mtext></mml:msub></mml:munderover> <mml:msub><mml:mi>d</mml:mi> <mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where the sum runs over all recombination events in <inline-formula id="pcbi.1005071.e009"><alternatives><graphic id="pcbi.1005071.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula>, and <italic>d</italic><sub><italic>r</italic></sub> is the Hamming distance between the two parental sequences involved in the <italic>r</italic>-th recombination. This is a more restricted definition of minimal ARG than the one that usually appears in population genetics literature [<xref ref-type="bibr" rid="pcbi.1005071.ref022">22</xref>], where the condition on <inline-formula id="pcbi.1005071.e010"><alternatives><graphic id="pcbi.1005071.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is generally not required. We use the term <italic>ultra-minimal ARG</italic> to refer to this restricted type of minimal ARG. Ultra-minimal ARGs are thus minimal ARGs where recombination events involve parental sequences that are as genetically close as possible. They introduce a higher level of parsimony than minimal ARGs, being informative not only about the minimum number of recombination events, but also about the minimum genetic distance between the recombining sequences that took part in those events. By construction, an ultra-minimal ARG explaining any given sample always exists. Examples are shown in Figs <xref ref-type="fig" rid="pcbi.1005071.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1005071.g003">3</xref>.</p>
<fig id="pcbi.1005071.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005071.g002</object-id>
<label>Fig 2</label>
<caption>
<title>ARGs and condensed graphs.</title>
<p>Two examples of ultra-minimal ARGs and the condensed graphs that result from collapsing their unlabelled edges. The root node is marked red whereas sampled nodes are marked green. Mutations in the <italic>r</italic>-th character are indicated by <italic>m</italic><sub><italic>r</italic></sub>. Edges pointing to a recombination node are labelled with the letter P or S, depending on whether they contribute to the prefix or suffix of the recombinant sequence. Recombinant nodes are marked with the position of the recombination breakpoint. All nodes are labelled by their sequence of characters. Condensed graphs of ARGs can be embedded into <italic>m</italic>-dimensional hypercubes and their diagonals.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.g002" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005071.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005071.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Ultra-minimal ARGs.</title>
<p>Two examples of ARGs containing the minimum number of recombination events, <italic>R</italic><sub>min</sub> = 3, required to explain a sample of <italic>n</italic> = 7 sequences with <italic>m</italic> = 3 segregating sites. Both ARGs are minimal ARGs. However, only the minimal ARG at the bottom is an ultra-minimal ARG.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.g003" xlink:type="simple"/>
</fig>
<p>A minimal ARG can be condensed by collapsing all unlabelled edges, so that the resulting graph can be embedded into an <italic>m</italic>-dimensional hypercube and its diagonals (that is, the line segments joining non-consecutive vertices) (<xref ref-type="fig" rid="pcbi.1005071.g002">Fig 2</xref>). The number of edges and vertices of such a condensed representation is <italic>m</italic> + 2<italic>R</italic><sub>min</sub> and <italic>m</italic> + <italic>R</italic><sub>min</sub> + 1, respectively, whereas the number of independent loops is <italic>R</italic><sub>min</sub>, where a loop is said to be independent if it cannot be embedded in the union of other loops. In this representation, the distance between two nodes is defined as the number of edges in the shortest path connecting the nodes, and is equal to the Hamming distance between the corresponding sequences.</p>
<p>Given a sample <inline-formula id="pcbi.1005071.e011"><alternatives><graphic id="pcbi.1005071.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> of genetic sequences, we would like to obtain information about the ultra-minimal ARGs that explain <inline-formula id="pcbi.1005071.e012"><alternatives><graphic id="pcbi.1005071.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula>, without explicitly constructing them. To that end, we consider the undirected graph <inline-formula id="pcbi.1005071.e013"><alternatives><graphic id="pcbi.1005071.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mi mathvariant="script">G</mml:mi> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, with vertices <italic>V</italic> and edges <italic>E</italic> = <italic>E</italic><sub>1</sub> ∪ … ∪ <italic>E</italic><sub><italic>l</italic></sub>, that results from the union of all condensed ultra-minimal ARGs <inline-formula id="pcbi.1005071.e014"><alternatives><graphic id="pcbi.1005071.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> explaining <inline-formula id="pcbi.1005071.e015"><alternatives><graphic id="pcbi.1005071.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> and having the same set of vertices <italic>V</italic> (<xref ref-type="fig" rid="pcbi.1005071.g004">Fig 4</xref>). We call this construction <italic>topological ARG</italic> (tARG). A tARG therefore summarizes the collection of most parsimonious histories associated to a sample of genetic sequences. However, unlike minimal ARGs, tARGs are completely determined by their vertices. By considering tARGs instead of minimal ARGs, we are able to reduce an NP-hard problem into a much simpler (but still very informative) topological problem, as we describe in next section.</p>
<fig id="pcbi.1005071.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005071.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Topological ARGs.</title>
<p>Examples of condensed ultra-minimal ARGs (left) and their corresponding tARGs (right). In a tARG the edges are completely determined by the vertices. The topology of the resulting tARG can differ from that of the original condensed ultra-minimal ARGs.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>Persistent homology and recombination inference</title>
<p>Topological data analysis has emerged during the last decade as a branch of applied topology that attempts to infer topological features of spaces (such as the number of loops and holes) from sets of sampled points [<xref ref-type="bibr" rid="pcbi.1005071.ref038">38</xref>]. The topological features of a space are preserved under continuous deformations of the space and can be arranged in mathematical structures called <italic>homology groups</italic> [<xref ref-type="bibr" rid="pcbi.1005071.ref049">49</xref>]. We refer the reader to refs. [<xref ref-type="bibr" rid="pcbi.1005071.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref050">50</xref>] for formal definitions and basic introductions to algebraic topology. In brief, the <italic>n</italic><sup>th</sup> homology group of a space is an algebraic structure that encompasses all (<italic>n</italic> + 1)-dimensional holes of the space. Of special interest to us is the first homology group, whose elements correspond to loops.</p>
<p>Homology groups can be computed by replacing the original space with a simpler one, known as <italic>simplicial complex</italic>, which has the same topological features as the original space but consists of a finite set of elements (<xref ref-type="fig" rid="pcbi.1005071.g001">Fig 1B</xref>). A simplicial complex is a generalization of a network that, in addition to nodes and vertices, includes higher dimensional elements like triangles and tetrahedra. Simplicial complexes are powerful because they allow the implementation of algebraic operations to extract the topological features of the space.</p>
<p>When only a finite set of points of the space is given, there is still a well-defined notion of homology groups, known as <italic>persistent homology</italic> [<xref ref-type="bibr" rid="pcbi.1005071.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref040">40</xref>], which capture the topological features of the underlying space. At each value of a scale parameter <italic>ϵ</italic>, a simplicial complex (known as Vietoris-Rips complex) can be constructed by considering the intersections of balls of radius <italic>ϵ</italic> centred at the sampled points (<xref ref-type="fig" rid="pcbi.1005071.g001">Fig 1B</xref>). Points are joined if their corresponding balls intersect. This process produces a sequence of simplicial complexes parametrized by <italic>ϵ</italic>, from which persistent homology can be computed using available algorithms [<xref ref-type="bibr" rid="pcbi.1005071.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref040">40</xref>]. Remarkably, the computation time of persistent homology is polynomial in the number of points [<xref ref-type="bibr" rid="pcbi.1005071.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref040">40</xref>].</p>
<p>Persistent homology can be represented using barcodes [<xref ref-type="bibr" rid="pcbi.1005071.ref043">43</xref>]. These are graphical representations where each element of persistent homology is represented by a segment spanning the interval [<italic>ϵ</italic><sub><italic>b</italic></sub>, <italic>ϵ</italic><sub><italic>d</italic></sub>], where <italic>ϵ</italic><sub><italic>b</italic></sub> and <italic>ϵ</italic><sub><italic>d</italic></sub> are the values of the parameter <italic>ϵ</italic> at which the corresponding feature is respectively formed and destroyed in the sequence of simplicial complexes (<xref ref-type="fig" rid="pcbi.1005071.g001">Fig 1C</xref>). Thus, each segment in a barcode represents a topological feature inferred from the data, and the position and length of the segment are informative of the size of the topological feature. The values <italic>ϵ</italic><sub><italic>b</italic></sub> and <italic>ϵ</italic><sub><italic>d</italic></sub> are referred as <italic>birth</italic> and <italic>death time</italic> of the topological feature, respectively.</p>
<p>In the current context, we exploit the use of persistent homology to infer topological features of an unknown tARG, given a set of sampled nodes (<xref ref-type="fig" rid="pcbi.1005071.g005">Fig 5</xref>). The use of persistent homology to detect the presence of recombination in genetic samples was proposed in [<xref ref-type="bibr" rid="pcbi.1005071.ref035">35</xref>]. However, the relation between persistent homology and explicit evolutionary histories incorporating recombination events was not studied. Our aim is inferring information about the loops of the tARG, as they correspond to recombination events present in the collection of most parsimonious histories explaining the sample. To that end, we consider the Hamming distance matrix of the sample and compute persistent homology using the algorithm developed in ref. [<xref ref-type="bibr" rid="pcbi.1005071.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref040">40</xref>]. Since computing the distance matrix and persistent homology requires respectively <inline-formula id="pcbi.1005071.e016"><alternatives><graphic id="pcbi.1005071.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005071.e017"><alternatives><graphic id="pcbi.1005071.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> operations [<xref ref-type="bibr" rid="pcbi.1005071.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref040">40</xref>], the running time grows at most cubically with the number of genetic sequences. An advantage of using persistent homology instead of just counting loops in a nearest neighbour graph is that we also obtain valuable information about the genetic distances between recombining sequences.</p>
<fig id="pcbi.1005071.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005071.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Persistent homology of a sample of genetic sequences.</title>
<p>Barcode and Vietoris-Rips complexes at several values of the parameter <italic>ϵ</italic>, for the sample of sequences <inline-formula id="pcbi.1005071.e018"><alternatives><graphic id="pcbi.1005071.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mi mathvariant="script">S</mml:mi> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mn>000</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>010</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>101</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>111</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Only the first homology group (<italic>H</italic><sub>1</sub>) is shown. At small <italic>ϵ</italic> the four sampled points are disconnected. Increasing <italic>ϵ</italic> leads to a loop, that appears as a single element of <italic>H</italic><sub>1</sub>. Further increasing <italic>ϵ</italic> fills in the loop, leading to a single connected surface. An ultra-minimal ARG explaining <inline-formula id="pcbi.1005071.e019"><alternatives><graphic id="pcbi.1005071.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula>, and the corresponding tARG are shown in <xref ref-type="fig" rid="pcbi.1005071.g002">Fig 2</xref> (bottom). The barcode only captures one of the <italic>R</italic><sub>min</sub> = 2 recombination events.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.g005" xlink:type="simple"/>
</fig>
<p>The barcode that results from this computation contains information about the number and size of the loops in the tARG underlying the sample (<xref ref-type="fig" rid="pcbi.1005071.g005">Fig 5</xref>). Each segment in the barcode represents a loop in the tARG, and therefore a recombination event in an ultra-minimal ARG explaining the sample. The position of each segment provides information about the genetic scales involved in the corresponding recombination event. Specifically, 2<italic>ϵ</italic><sub><italic>d</italic></sub> sets an upper bound to the mutational distance between the two recombining sequences, since all pairwise distances between nodes in the loop are smaller than 2<italic>ϵ</italic><sub><italic>d</italic></sub>. The number of segments in the barcode (namely, the dimension of the first persistent homology group) or <italic>persistent first Betti number</italic>, <italic>b</italic><sub>1</sub>, is hence a lower bound of the number of recombination events in the tARG, <inline-formula id="pcbi.1005071.e020"><alternatives><graphic id="pcbi.1005071.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msub><mml:mover><mml:mi>R</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>min</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>. Note that, since a tARG is the union of multiple minimal histories, <inline-formula id="pcbi.1005071.e021"><alternatives><graphic id="pcbi.1005071.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mover><mml:mi>R</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>min</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> can be larger than <italic>R</italic><sub>min</sub>. In particular, <inline-formula id="pcbi.1005071.e022"><alternatives><graphic id="pcbi.1005071.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>min</mml:mtext></mml:msub> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mtext>min</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> when there are three characters for which all eight possible allele combinations appear in the sample. In general, this can only happen at very large recombination rates.</p>
</sec>
<sec id="sec005">
<title>The barcode ensemble of a sample</title>
<p>The sensitivity of persistent homology to detect recombination decreases as the number <italic>m</italic> of segregating characters increases. Indeed, in that case the dimensionality of the ambient space is larger and the sample becomes sparser. For this reason, <italic>b</italic><sub>1</sub> is in general a loose lower bound of <inline-formula id="pcbi.1005071.e023"><alternatives><graphic id="pcbi.1005071.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msub><mml:mover><mml:mi>R</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>min</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>. To address a similar problem, Myers and Griffiths introduced the idea of combining the local bounds that result from partitioning the sequence, building a more stringent global bound [<xref ref-type="bibr" rid="pcbi.1005071.ref045">45</xref>]. In this way, information about the ordering of characters is incorporated and the location of recombination breakpoints is constrained in the sequence. This general idea was applied in [<xref ref-type="bibr" rid="pcbi.1005071.ref045">45</xref>] to the haplotype bound, <italic>n</italic> − <italic>m</italic> − 1 ≤ <italic>R</italic><sub>min</sub>, to built a stronger lower bound of <italic>R</italic><sub>min</sub>, denoted <italic>R</italic><sub>MG</sub>.</p>
<p>A similar idea can be applied in the context of barcodes to build a <italic>barcode ensemble</italic>, given by the disjoint union of the persistent first-homology barcodes of a set of optimally chosen, non-overlapping intervals within the sequence alignment (<xref ref-type="fig" rid="pcbi.1005071.g006">Fig 6A</xref>). Given a partition of a genetic sequence, the barcode associated to each interval captures information about recombination events with breakpoint in that interval. Due to the curse of dimensionality mentioned in the previous paragraph, the union of the barcodes associated to two contiguous genomic intervals often captures more recombination events than the barcode associated to the union of the two genomic intervals. Therefore, by systematically exploring all possible partitions of the genetic sequence, it is possible to find a partition that maximizes the total number of bars in the barcodes. The solution is often not unique, as different partitions may lead to the same total number of bars. One may reduce this degeneration by considering additional criteria, such as also maximizing the total length of the bars (so that they are more informative about genetic distances). The formal details of the barcode ensemble construction are presented in the Methods section.</p>
<fig id="pcbi.1005071.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005071.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Barcode ensemble of a sample.</title>
<p>(A) Schematic representation of the barcode ensemble of a genomic sample. Persistent homology is computed for each genomic interval of a partition of the sequence. Barcodes associated to different genomic intervals capture different recombination events. The union of all barcodes is the barcode ensemble. The total number of intervals in the barcode ensemble is denoted as <inline-formula id="pcbi.1005071.e024"><alternatives><graphic id="pcbi.1005071.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>. The partition is chosen such that <inline-formula id="pcbi.1005071.e025"><alternatives><graphic id="pcbi.1005071.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> is maximized. (B) Comparison between lower bounds <inline-formula id="pcbi.1005071.e026"><alternatives><graphic id="pcbi.1005071.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>≤</mml:mo> <mml:msub><mml:mover><mml:mi>R</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>min</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <italic>R</italic><sub>MG</sub> ≤ <italic>R</italic><sub>min</sub> in coalescent simulations. Values of <inline-formula id="pcbi.1005071.e027"><alternatives><graphic id="pcbi.1005071.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and <italic>R</italic><sub>MG</sub> for simulated samples of 40 sequences with 12 segregating sites, sampled from a population under the coalescent model with recombination. 4,000 samples were simulated in total. The colored band represents the interdecile range, whereas the central line represents the mean. The values of <inline-formula id="pcbi.1005071.e028"><alternatives><graphic id="pcbi.1005071.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and <italic>R</italic><sub>MG</sub> are strongly correlated (Pearson’s <italic>r</italic> = 0.98, <italic>p</italic> &lt; 10<sup>−100</sup>). At very high recombination rates, <inline-formula id="pcbi.1005071.e029"><alternatives><graphic id="pcbi.1005071.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> tends to be larger than <italic>R</italic><sub>MG</sub>, as cases where <inline-formula id="pcbi.1005071.e030"><alternatives><graphic id="pcbi.1005071.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>min</mml:mtext></mml:msub> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mtext>min</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> occur more frequently.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.g006" xlink:type="simple"/>
</fig>
<p>The barcode ensemble incorporates information about the full structure of characters in the sample, largely increasing the sensitivity of persistent homology to recombination and providing information on the location of the recombination breakpoints in the sequence. The number of bars in the barcode ensemble, <inline-formula id="pcbi.1005071.e031"><alternatives><graphic id="pcbi.1005071.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>, is an improved lower bound of <inline-formula id="pcbi.1005071.e032"><alternatives><graphic id="pcbi.1005071.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msub><mml:mover><mml:mi>R</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>min</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>, in the same way as <italic>R</italic><sub>MG</sub> is an improved lower bound of <italic>R</italic><sub>min</sub>:
<disp-formula id="pcbi.1005071.e033"><alternatives><graphic id="pcbi.1005071.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>tARG</mml:mtext></mml:mrow></mml:mtd> <mml:mtd><mml:mo>→</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub> <mml:mspace width="1pt"/> <mml:mo>≥</mml:mo> <mml:mtext> </mml:mtext> <mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mtext> </mml:mtext> <mml:mo>≥</mml:mo> <mml:mtext> </mml:mtext> <mml:msub><mml:mi>b</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>↑</mml:mo></mml:mtd> <mml:mtd><mml:mrow/></mml:mtd> <mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mtext>ultra</mml:mtext> <mml:mo stretchy="false">)</mml:mo> <mml:mtext> minimal ARG</mml:mtext></mml:mrow></mml:mtd> <mml:mtd><mml:mo>→</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:mo>≥</mml:mo> <mml:mtext> </mml:mtext> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mtext>MG</mml:mtext></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:mo>≥</mml:mo> <mml:mtext> </mml:mtext> <mml:mi>n</mml:mi> <mml:mtext> </mml:mtext> <mml:mo>−</mml:mo> <mml:mtext> </mml:mtext> <mml:mi>m</mml:mi> <mml:mtext> </mml:mtext> <mml:mo>−</mml:mo> <mml:mtext> </mml:mtext> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>In biological data, <inline-formula id="pcbi.1005071.e034"><alternatives><graphic id="pcbi.1005071.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and <italic>R</italic><sub>MG</sub> are in general very close to each other (<xref ref-type="fig" rid="pcbi.1005071.g006">Fig 6B</xref>), as tARGs with <inline-formula id="pcbi.1005071.e035"><alternatives><graphic id="pcbi.1005071.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>min</mml:mtext></mml:msub> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mtext>min</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> occur very rarely. However, unlike <italic>R</italic><sub>MG</sub>, barcode ensembles provide additional phylogenetic information, such as bounds on the mutational distances between recombining sequences (note that birth and death times in barcode ensembles refer to local genetic distances, namely mutational distances across the genomic interval associated to the particular bar). These features put barcode ensembles at the very interesting interface between the fast, but phylogenetically limited, existing lower bounds to <italic>R</italic><sub>min</sub>; and the slow, but phylogenetically rich methods for reconstructing minimal ARGs. We have implemented the computation of barcode ensembles in publicly available software, called <monospace>TARGet</monospace>.</p>
</sec>
<sec id="sec006">
<title>Examples</title>
<p>We consider five examples that illustrate how the formal developments presented in previous sections can be used to extract useful phylogenetic information from samples of genetic sequences. The first example is a simple toy model where an explicit minimal ARG can be easily constructed. It displays how the information contained in the barcode ensemble of the sample directly maps to features of ultra-minimal ARGs. The second example, based on simulated data of two sexually reproducing populations exchanging genetic material at low rate, shows the applicability of persistent homology to large datatsets, consisting of several hundreds of sequences. It also demonstrates the use of phylogenetic information contained in the barcode ensemble to distinguish among various biological settings with similar recombination rates. The third and fourth examples consist respectively of 250 and 100 kilobase regions in the HLA and MS32 loci of ∼ 100 humans, where several meiotic recombination hotspots localize. The fifth example consists of a 9 megabase scaffold in the genome of 112 Darwin’s finches [<xref ref-type="bibr" rid="pcbi.1005071.ref051">51</xref>]. These last three examples serve to illustrate the applicability of barcode ensembles to real datasets.</p>
<sec id="sec007">
<title>A simple example</title>
<p>We illustrate the use and interpretation of barcode ensembles with a simple example, consisting of a sample of 4 genetic sequences with 7 binary characters: 1111001, 1111111, 0000110 and 0000000. Minimal ARGs explaining this sample require two single-crossover recombination events. An ultra-minimal ARG is presented in <xref ref-type="fig" rid="pcbi.1005071.g007">Fig 7A</xref>. The most ancestral recombination event involves genetically distant parental gametes, leading to a large loop in the ARG. To the contrary, the most recent recombination event involves genetically close parental gametes, leading to a second small loop in the ARG. These features are captured by the barcode ensemble of the 4 sequences (<xref ref-type="fig" rid="pcbi.1005071.g007">Fig 7B</xref>), which consists of two bars, corresponding to the two recombination events. The position of the bars represent the genetic scales associated to the recombination events, with the 2<italic>ϵ</italic><sub><italic>d</italic></sub> = 5 (3) bar corresponding respectively to the large (small) recombination loop. These death times are good upper bounds for the mutational distance between recombinant sequences in the two genomic intervals associated to each bar (characters 1 to 5, and 6 to 7, respectively). The position of the crossover breakpoints associated to these recombination events is also correctly reproduced. Hence, taking as input the 4 sequences, the barcode ensemble extracts phylogenetic information from ultra-minimal ARGs that explain the sample, without requiring complete reconstruction of the ARGs.</p>
<fig id="pcbi.1005071.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005071.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Ultra-minimal ARG, first-homology barcode ensemble and reconstructed tARG of a sample of 4 sequences.</title>
<p>The four sampled sequences are represented by green leaf nodes in the ultra-minimal ARG depicted in (A). The ARG involves two single-crossover recombination events. Both recombination events and their genetic scales (mutational distance between recombining sequences) are correctly captured by the barcode ensemble of the samples, shown in (B). Intervals containing the location of recombination breakpoints are indicated over each bar. Persistent homology generators can be used to reconstruct the topology of the tARG, as depicted in (C). Without adding any extra sequences to the sample, the two bars are associated to the same four generators, allowing only to reconstruct the large envelope of the two loops in the tARG. Adding sequences E and F to the sample (represented by blue leaf nodes in (A)) disentangles the generators of the two loops, fully reconstructing the topology of the tARG.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.g007" xlink:type="simple"/>
</fig>
<p>We note here the importance of using the barcode ensemble instead of the ordinary barcode, used in previous phylogenetic applications of persistent homology [<xref ref-type="bibr" rid="pcbi.1005071.ref035">35</xref>]. In this simple example <italic>b</italic><sub>1</sub> = 1, and only one of the two recombination events would have been detected if the ordinary first-homology barcode had been used. The barcode ensemble largely increases the sensitivity to detect recombination events.</p>
<p>We can attempt to reconstruct the tARG of the sample by using persistent homology generators (<xref ref-type="fig" rid="pcbi.1005071.g007">Fig 7C</xref>). Whereas there are theorems ensuring the stability of barcodes against small perturbations [<xref ref-type="bibr" rid="pcbi.1005071.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref042">42</xref>], the generators of persistent homology identified by TDA strongly depend on the sample, and multiple choices of basis are possible. Hence, the use of generators to reconstruct the tARG is usually limited to small datasets. In this simple example, both bars in the barcode ensemble are generated by the four sampled sequences. Therefore, the reconstructed loop enclosing each recombination event is the same in both cases and corresponds to the large enveloping loop in the ultra-minimal ARG (<xref ref-type="fig" rid="pcbi.1005071.g007">Fig 7A</xref>). Adding the internal nodes 1111000 and 1111110 to the sample permits disentangling the generators of the two loops (<xref ref-type="fig" rid="pcbi.1005071.g007">Fig 7C</xref>), fully reconstructing the topology of the underlying tARG.</p>
</sec>
<sec id="sec008">
<title>Genetic exchange between two divergent populations</title>
<p>We now consider a more involved example consisting of two sexually-reproducing populations, simulated under the coalescent model with recombination. The two populations diverged 24<italic>N</italic> generations before present. Their effective population sizes are taken to be constant and given by <italic>N</italic> and <italic>N</italic>/5. We consider two different cases, depicted in <xref ref-type="fig" rid="pcbi.1005071.g008">Fig 8</xref>. In the first case (<xref ref-type="fig" rid="pcbi.1005071.g008">Fig 8A</xref>), the two populations are completely isolated from each other. In the second case (<xref ref-type="fig" rid="pcbi.1005071.g008">Fig 8B</xref>), to the contrary, there is a small migration rate between the two populations. The recombination rate is the same in both cases. Alternatively, in a phylogenetic context, this setting describes the incomplete lineage sorting of two species, with or without the presence of gene flow.</p>
<fig id="pcbi.1005071.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005071.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Barcode ensemble of two divergent sexually-reproducing populations.</title>
<p>The case in (A) assumes the two populations are completely isolated. All recombination events present in the barcode ensemble involve genetically close parental gametes. The case in (B) considers a small migration rate between the two populations. Some of the recombination events present in the barcode ensemble involve genetically distant parental strains, leading to larger death times <italic>ϵ</italic><sub><italic>d</italic></sub> in the barcode ensemble. The total number of detected recombination events is similar in both cases and uniform across the entire genome. Intervals with the location of the recombination breakpoints are indicated for each recombination event, where positions refer to segregating sites.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.g008" xlink:type="simple"/>
</fig>
<p>We randomly sampled 250 sequences from the large population and 50 sequences from the small population. The full sample consisted of 300 sequences with 300 segregating sites. We present in <xref ref-type="fig" rid="pcbi.1005071.g008">Fig 8</xref> the barcode ensemble for simulated samples without and with migration. The computation took approximately 33 minutes (wall-clock time) in a modern 8-cores desktop computer. Whereas the number of detected recombination events in the tARG, counted by the number bars, is similar in both cases, their genetic scales are very different. Specifically, in the presence of migration the size of some of the loops in the tARG is large, corresponding to migration events followed by a recombination event (<xref ref-type="fig" rid="pcbi.1005071.g008">Fig 8B</xref>). This is indicated by the presence of bars with large death time <italic>ϵ</italic><sub><italic>d</italic></sub> in the barcode ensemble of the case with migration, corresponding to recombination events with large mutational distances between recombining sequences.</p>
<p>Hence, in this example the barcode ensemble provides rich phylogenetic information that could be hardly obtained by other methods. Methods that attempt to construct a minimal (or nearly-minimal) ARG are computationally inefficient for such large sample sizes [<xref ref-type="bibr" rid="pcbi.1005071.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref052">52</xref>]. Fast bound methods [<xref ref-type="bibr" rid="pcbi.1005071.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref044">44</xref>, <xref ref-type="bibr" rid="pcbi.1005071.ref045">45</xref>], on the other hand, do not provide enough phylogenetic information to distinguish between the cases with and without migration, as the total recombination rate is the same in both situations. Sequentially Markov coalescent approaches [<xref ref-type="bibr" rid="pcbi.1005071.ref034">34</xref>] produce an ARG that is far from being minimal but is a good approximation to the maximum likelihood. However, these methods require an underlying coalescent model, with mutation, recombination and population structure parameters given as priors. Finally, algorithms for constructing phylogenetic split networks [<xref ref-type="bibr" rid="pcbi.1005071.ref021">21</xref>] are fast and provide very different outputs in each of the above two cases. However, the interpretation of the output in terms of recombination and migration events is obscure.</p>
</sec>
<sec id="sec009">
<title>Human leukocyte antigen (HLA) locus</title>
<p>The previous examples serve to illustrate the relation between features of the barcode ensemble of a genetic sample and those of the ultra-minimal ARGs explaining the sample. However, both examples are based on simulated data. We now consider a more realistic example, consisting of 180 phased genotypes from a ∼250 kilobase region of the HLA locus of 90 individuals belonging to the Luhya in Webuye, Kenya (LWK) population, sequenced as part of the International HapMap Project [<xref ref-type="bibr" rid="pcbi.1005071.ref053">53</xref>]. In total, the region contains 471 SNPs. Recombination hotspots in this part of the HLA locus have been studied in detail in the past through sperm typing [<xref ref-type="bibr" rid="pcbi.1005071.ref054">54</xref>] and other high-resolution methods [<xref ref-type="bibr" rid="pcbi.1005071.ref055">55</xref>]. This example therefore serves to illustrate the capacity of the barcode ensemble to localize recombination events in realistic situations. With this aim, we also considered 194 phased genotypes from a smaller region (40 kilobase) within the same HLA locus of 97 individuals from the same population, sequenced by the 1,000 Genomes Project Consortium [<xref ref-type="bibr" rid="pcbi.1005071.ref056">56</xref>]. This additional dataset contained a higher density of SNPs (482 SNPs in total), allowing for a higher resolution in the localization of recombination events.</p>
<p>We used <monospace>TARGet</monospace> to compute the first-homology barcode ensembles of the two datasets and analysed the distribution of bars across the HLA locus (<xref ref-type="fig" rid="pcbi.1005071.g009">Fig 9A and 9B</xref>). The computation took 19 and 14 minutes (wall-clock time) in a modern 8-cores desktop computer, respectively for the HapMap and 1,000 Genomes datasets. Comparison with the African-American recombination map [<xref ref-type="bibr" rid="pcbi.1005071.ref055">55</xref>], based on more than 2 million crossovers in 30,000 unrelated African-Americans, shows a large degree of consistency between the recombination rates and the genomic position of recombination events detected by the barcode ensembles (<xref ref-type="fig" rid="pcbi.1005071.g009">Fig 9A</xref>). The distribution of mutational distances associated to recombination events is qualitatively consistent with coalescent arguments (<xref ref-type="fig" rid="pcbi.1005071.g009">Fig 9C</xref>). In particular, bars with large death time <italic>ϵ</italic><sub><italic>d</italic></sub>, corresponding to recombination events with a large mutational distance between recombining sequences, are mostly associated to regions of low recombination rate, consistently with the longer coalescence time for these regions [<xref ref-type="bibr" rid="pcbi.1005071.ref057">57</xref>].</p>
<fig id="pcbi.1005071.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005071.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Barcode ensemble across the HLA and MS32 mini-satellite loci of the LWK population.</title>
<p>(A) Recombination rates (top) across a 250 kilobase region of the HLA locus according to the African-American recombination map, based on 30,000 individuals [<xref ref-type="bibr" rid="pcbi.1005071.ref055">55</xref>]. The vertical axis is in logarithmic scale. The distribution of recombination events (bottom) detected by the barcode ensemble of a sample of 90 individuals from the LWK population sequenced by the International HapMap Consortium [<xref ref-type="bibr" rid="pcbi.1005071.ref053">53</xref>] is consistent with the observed recombination rates. Note that in neutral models of evolution the number of recombination events in minimal ARGs is roughly expected to grow logarithmically with the recombination rate of the population [<xref ref-type="bibr" rid="pcbi.1005071.ref057">57</xref>]. (B) Distribution of recombination events detected by the barcode ensemble of a sample of 97 individuals from the LWK population, sequenced by the 1,000 Genomes Project Consortium [<xref ref-type="bibr" rid="pcbi.1005071.ref056">56</xref>]. The higher density of SNPs in this dataset allows for a higher resolution in the localization of recombination events as well as a higher sensitivity. (C) Density of recombination events per nucleotide against their average death time 2<italic>ϵ</italic><sub><italic>d</italic></sub>, for recombination events captured by the barcode ensemble in (A). Each point represents a genomic position for which the barcode ensemble detects recombination. The horizontal axis represents the average death time of the bars in the barcode ensemble that are associated to that genomic position. Events with large <italic>ϵ</italic><sub><italic>d</italic></sub>, corresponding to recombination events with a large mutational distance between recombining sequences, are mostly associated to regions with low number of recombinations, as expected from neutral models of evolution [<xref ref-type="bibr" rid="pcbi.1005071.ref057">57</xref>]. (D) Recombination rates (top) across a 100 kilobase region near the MS32 mini-satellite locus according to the African-American recombination map [<xref ref-type="bibr" rid="pcbi.1005071.ref055">55</xref>]. The vertical axis is in logarithmic scale. The distribution of recombination events (bottom) detected by the barcode ensemble of a sample of 97 individuals from the LWK populations sequenced by the 1,000 Genomes Project Consortium [<xref ref-type="bibr" rid="pcbi.1005071.ref056">56</xref>] is consistent with the observed recombination rates.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.g009" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Human MS32 mini-satellite locus</title>
<p>Similarly, we also considered 194 phased genotypes from a ∼100 kilobase region (416 segregating sites) near the MS32 mini-satellite locus of 97 individuals from the LWK population, sequenced by the 1,000 Genomes Project Consortium [<xref ref-type="bibr" rid="pcbi.1005071.ref056">56</xref>]. We used <monospace>TARGet</monospace> to compute the barcode ensemble and studied the distribution of bars across this genomic region (<xref ref-type="fig" rid="pcbi.1005071.g009">Fig 9D</xref>). The computation took 10 minutes (wall-clock time) in a modern 8-cores desktop computer. As in the previous example, the genomic position of the recombination events detected by the barcode ensemble (<xref ref-type="fig" rid="pcbi.1005071.g009">Fig 9D</xref>) was consistent with the recombination rate across this region, as determined by the African-American recombination map [<xref ref-type="bibr" rid="pcbi.1005071.ref055">55</xref>].</p>
</sec>
<sec id="sec011">
<title>Darwin’s finches</title>
<p>Our last example consists of the genetic sequences of 112 Darwin’s finches, belonging to 15 different species inhabiting the Galápagos archipielago and Cocos Island [<xref ref-type="bibr" rid="pcbi.1005071.ref051">51</xref>]. We aligned and genotyped a 9 megabase scaffold of their genome and, after filtering for high-quality variants, we focussed on a set of 140 SNPs that were homozygous across the 112 samples, thus avoiding potential phasing artefacts. By considering this set, we mostly restrict to very ancestral recombination/gene flow events, close to the origin of radiation from a common ancestor 1.5 million years ago [<xref ref-type="bibr" rid="pcbi.1005071.ref058">58</xref>]. We used <monospace>TARGet</monospace> to obtain the first-homology barcode ensemble of the sample, as well as the partially reconstructed tARG. The computation took 9 minutes (wall-clock time) in a modern 8-cores desktop computer.</p>
<p>The first-homology barcode ensemble (<xref ref-type="fig" rid="pcbi.1005071.g010">Fig 10A</xref>) contains 13 recombination events, mostly involving samples from multiple species and usually including samples from the genus <italic>Certhidea</italic> (<xref ref-type="fig" rid="pcbi.1005071.g010">Fig 10B</xref>), the most ancestral lineage among the genera present in the sample [<xref ref-type="bibr" rid="pcbi.1005071.ref051">51</xref>]. These results add support to the evidence for genetic introgression found in [<xref ref-type="bibr" rid="pcbi.1005071.ref051">51</xref>]. Our analysis also reveals that the crossover breakpoints of these events localize at four different genomic regions within the 9 megabase scaffold that we have considered in this example (<xref ref-type="fig" rid="pcbi.1005071.g010">Fig 10C</xref>).</p>
<fig id="pcbi.1005071.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005071.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Barcode ensemble and partially reconstructed tARG of a sample of 112 Darwin’s finches.</title>
<p>The barcode ensemble is shown in (A), based on 140 homozygous SNPs present in a 9 megabase scaffold. In total, 13 recombination/gene flow events are captured in the barcode ensemble, with different genetic scales. Bars are colored according to the position of the corresponding recombination breakpoint in the genome, as depicted in (C). We also indicate the number of recombination events detected at each genomic interval, as well as some of the orthologous genes present at regions where recombination events are detected. The reconstructed tARG is presented in (B). Loops in the reconstructed tARG are outlined using the same code of colors. We have also included leaf nodes that do not participate in any recombination event, using a nearest neighbour algorithm based on genetic distance. Edge lengths are arbitrary.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.g010" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec012">
<title>Parameter estimation</title>
<p>The examples above illustrate the use and interpretation of barcode ensembles in molecular phylogenetics. As we have discussed, an important feature of topological approaches to phylogenetics is that they inform about most parsimonious evolutionary histories. Being model-independent approaches, they describe minimal sets of events required to explain a sample of sequences, without assuming any probabilistic model of evolution. In some situations, however, we are interested in estimating the parameters of a specific evolutionary model from the observed data (e.g. the recombination rate in a coalescent model with recombination). To that end, barcode ensembles can be taken as summary statistics from which to build parameter estimators. For instance, in <xref ref-type="fig" rid="pcbi.1005071.g011">Fig 11A</xref> we show the dependence of <inline-formula id="pcbi.1005071.e036"><alternatives><graphic id="pcbi.1005071.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msub><mml:mover><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> on the recombination rate for a set of 1,000 coalescent model simulations. The expected <inline-formula id="pcbi.1005071.e037"><alternatives><graphic id="pcbi.1005071.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msub><mml:mover><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> of the barcode ensemble is informative of the recombination rate, growing monotonically with the later. Compared to sequentially Markov coalescent (SMC) approaches for ARG inference [<xref ref-type="bibr" rid="pcbi.1005071.ref034">34</xref>], <inline-formula id="pcbi.1005071.e038"><alternatives><graphic id="pcbi.1005071.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msub><mml:mover><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> is strongly correlated with the number of recombinations in SMC ARGs derived from the same set of sequences (Pearson’s <italic>r</italic> = 0.93, <italic>p</italic> &lt; 10<sup>−100</sup>, <xref ref-type="supplementary-material" rid="pcbi.1005071.s001">S1 Fig</xref>). Although the coefficient of variation is ∼ 35% larger for <inline-formula id="pcbi.1005071.e039"><alternatives><graphic id="pcbi.1005071.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msub><mml:mover><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> (<xref ref-type="supplementary-material" rid="pcbi.1005071.s001">S1 Fig</xref>), its computing time is substantially lower (&gt; 9 times faster after parallelizing in a modern 8-cores desktop computer, <xref ref-type="supplementary-material" rid="pcbi.1005071.s001">S1 Fig</xref>), being a robust approach to coalescent-model recombination rate estimation in large datasets. Furthermore, unlike the number of recombinations in SMC ARGs, <inline-formula id="pcbi.1005071.e040"><alternatives><graphic id="pcbi.1005071.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msub><mml:mover><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> is unbiassed at small recombination rates, vanishing when the recombination rate is zero (<xref ref-type="fig" rid="pcbi.1005071.g011">Fig 11A</xref>).</p>
<fig id="pcbi.1005071.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005071.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Parameter estimation in models of evolution.</title>
<p>(A) Dependence of <inline-formula id="pcbi.1005071.e041"><alternatives><graphic id="pcbi.1005071.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msub><mml:mover><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> on the recombination rate parameter for a set of 1,000 simulations of a basic coalescent model. Each simulation consists of 200 sequences, 30 kilobase long. The expected <inline-formula id="pcbi.1005071.e042"><alternatives><graphic id="pcbi.1005071.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msub><mml:mover><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> of the barcode ensemble grows monotonically with the recombination rate, providing a good measure of the later. The smoothed average is shown in red. (B) Dependence of the average death time, 〈<italic>ϵ</italic><sub><italic>d</italic></sub>〉, on the migration rate of two divergent populations with fixed recombination and variable migration rates, based on 900 simulations. Each simulation consists of 150 sampled sequences, 10 kilobase long. The same structure as in <xref ref-type="fig" rid="pcbi.1005071.g008">Fig 8</xref> was considered for the two populations. The expected value of 〈<italic>ϵ</italic><sub><italic>d</italic></sub>〉 decreases monotonically with the migration rate, being informative of the later.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.g011" xlink:type="simple"/>
</fig>
<p>Although recombination rate estimation is a very direct example, the barcode ensemble of a sample of genetic sequences contains other rich phylogenetic information apart from <inline-formula id="pcbi.1005071.e043"><alternatives><graphic id="pcbi.1005071.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msub><mml:mover><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>, which can be used for more complex parameter estimation in structured models of evolution. Consider, for instance, the case of two divergent populations with migration and recombination discussed above. In this model, the average genetic distance between recombining sequences is expected to decrease with the migration rate, as the average time to the most recent common ancestor between foreign and local gametes in a population is shorter. In <xref ref-type="fig" rid="pcbi.1005071.g011">Fig 11B</xref> we show the dependence of the average death time (〈<italic>ϵ</italic><sub><italic>d</italic></sub>〉) on the migration rate parameter, for the barcode ensembles of a set of 900 coalescent model simulations with fixed recombination and variable migration rates. As expected, 〈<italic>ϵ</italic><sub><italic>d</italic></sub>〉 is informative of the migration rate, decreasing monotonically with the later. It is therefore a good measure for estimating migration rates. Consistently, 〈<italic>ϵ</italic><sub><italic>d</italic></sub>〉 correlates with time to the most recent common ancestor of recombining sequences in SMC ARGs obtained from the same data (Pearson’s <italic>r</italic> = 0.55, <italic>p</italic> &lt; 10<sup>−72</sup>, <xref ref-type="supplementary-material" rid="pcbi.1005071.s001">S1 Fig</xref>). Although the coefficient of variation of 〈<italic>ϵ</italic><sub><italic>d</italic></sub>〉 is ∼ 60% larger (<xref ref-type="supplementary-material" rid="pcbi.1005071.s001">S1 Fig</xref>), extracting this type of information from SMC ARGs requires the implementation of a greedy algorithm, substantially increasing the running time (∼ 8 times slower in a single core of modern desktop computer, <xref ref-type="supplementary-material" rid="pcbi.1005071.s001">S1 Fig</xref>) and therefore limiting its applicability to large datasets.</p>
<p>These two simple examples illustrate the utility of barcode ensembles for building parameter estimators in specific models of evolution. Importantly, being model-independent, they are robust and flexible tools which can be applied in an infinitely large number of possible evolutionary models.</p>
</sec>
</sec>
<sec id="sec013" sec-type="conclusions">
<title>Discussion</title>
<p>As the famous title of the essay by Dobzhansky “Nothing in Biology Makes Sense Except in the Light of Evolution” underscores, evolutionary processes are central orchestrating themes in biology. Mutations, recombinations and other evolutionary processes get imprinted into genomes through selection, reflecting the accumulated history giving rise to an organism. Phylogenetics try to reconstruct the evolutionary history through the comparison of genomes of related organisms. In addition to reporting relationships and elucidating particular histories, one would like to understand and quantify how different evolutionary processes have occurred. The identification and quantification of evolutionary processes can be challenging due to the lack of a well-established universal framework to capture evolutionary relationships beyond trees. In addition, robust statistical inference needs to exploit the large number of genomes that are now becoming available, aggravating the computational burden and obscuring interpretations. Ideally, we would like to have a biologically interpretable framework able to quantify different evolutionary processes by analyzing large numbers of genomes.</p>
<p>In this paper we have proposed a few steps in this direction. We have extended the notion of barcodes in persistent homology to identify the genetic scale and number of recombination events. We have shown that, by correctly studying persistent homology in subsets of segregating sites, it is possible to characterize the genomic regions where recombination takes place and identify the gametes involved in particular recombination events. The persistent homology barcodes derived from each of these sets can be structured as a “barcode ensemble” where each bar captures a recombination event. Barcode ensembles can be interpreted as counting and quantifying the scale of recombination events in a variation of Ancestral Recombination Graphs (ARGs). Topological ARGs represent a summary of potential recombination histories that can explain the data. The method proposed, <monospace>TARGet</monospace>, is scalable to hundreds of genomes. As an alternative to some phylogenetic networks, barcode ensembles provide robust quantification of events, the distribution of genetic scales, computational scalability and interpretative graphs.</p>
<p>Barcode ensembles are versatile in that they do not assume any specific model of evolution, providing explicit, interpretable summaries of the minimal set of recombination events required to explain a sample of genetic sequences. Here we have illustrated their use in several practical cases. However, the range of possible applications is unlimited. In some cases, it may be convenient to perform minor modifications to the approach described here. For instance, although in our exposition we have only made use of Hamming distance and binary sequences, the main concepts we have presented extend straightforwardly to other genetic distances. The use of these metrics can be particularly useful in cases with rapidly diverging samples or substantial mutational biases. In other cases, information about the ancestral and derived alleles for each character in the sample may be available. Although tARGs have no natural directionality, the inclusion of the ancestral sequence in the original sample may lead in those cases to more stringent bounds on <inline-formula id="pcbi.1005071.e044"><alternatives><graphic id="pcbi.1005071.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msub><mml:mover><mml:mi>R</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>min</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>, similarly to what occurs with other approaches to recombination inference [<xref ref-type="bibr" rid="pcbi.1005071.ref022">22</xref>]. Finally, more efficient integer linear programming algorithms, like the one of [<xref ref-type="bibr" rid="pcbi.1005071.ref033">33</xref>], could in principle be also generalized to the computation of barcode ensembles.</p>
</sec>
<sec id="sec014" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec015">
<title>First-homology barcode ensemble</title>
<p>We extended the construction of ref. [<xref ref-type="bibr" rid="pcbi.1005071.ref045">45</xref>] to persistent homology barcodes. From a geometric perspective, this corresponds to projecting the original space on sets of mutually orthogonal hyperplanes in the ambient hypercube, and computing persistent homology in each of those projections. For that aim, we need to establish an ordering relation on barcodes. Being sets of intervals, it is natural to take the maximum of two barcodes to be given by the one with largest <italic>L</italic><sup>0</sup>-norm, namely largest <italic>b</italic><sub>1</sub>. If both barcodes have the same <italic>L</italic><sup>0</sup>-norm, we may successively compare other norms (e.g. other <italic>L</italic><sup><italic>p</italic></sup>-norms), until the tie is broken or, otherwise, one of the two barcodes is arbitrarily chosen. The algorithm of [<xref ref-type="bibr" rid="pcbi.1005071.ref045">45</xref>] is then generalized to persistent homology barcodes as follows:</p>
<list list-type="order">
<list-item>
<p>Let <inline-formula id="pcbi.1005071.e045"><alternatives><graphic id="pcbi.1005071.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msub><mml:mi mathvariant="script">B</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> be the first-homology barcode of the sequences that result from the <italic>i</italic>-th to <italic>k</italic>-th characters in <inline-formula id="pcbi.1005071.e046"><alternatives><graphic id="pcbi.1005071.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula>. Set <inline-formula id="pcbi.1005071.e047"><alternatives><graphic id="pcbi.1005071.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <italic>k</italic> = 2.</p>
</list-item>
<list-item>
<p>For <italic>j</italic> = 1, …, <italic>k</italic> − 1, set <inline-formula id="pcbi.1005071.e048"><alternatives><graphic id="pcbi.1005071.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mtext>max</mml:mtext> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi mathvariant="script">R</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>∪</mml:mo> <mml:msub><mml:mi mathvariant="script">B</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mspace width="4pt"/><mml:mo>:</mml:mo> <mml:mspace width="4pt"/><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
</list-item>
<list-item>
<p>If <italic>k</italic> &lt; <italic>m</italic>, increment <italic>k</italic> by 1 and go to step 2.</p>
</list-item>
</list>
<p>The barcode ensemble of <inline-formula id="pcbi.1005071.e049"><alternatives><graphic id="pcbi.1005071.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> is the union barcode <inline-formula id="pcbi.1005071.e050"><alternatives><graphic id="pcbi.1005071.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:msub><mml:mi mathvariant="script">R</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> that results from this algorithm.</p>
<p>We implemented the algorithm in a publicly available multi-threaded software, <monospace>TARGet</monospace>, which is distributed under the GNU General Public License (GPL v3). The application is fully written in Python 2.7, and relies on Dionysus C++ library for persistent homology computations (<ext-link ext-link-type="uri" xlink:href="http://www.mrzv.org/software/dionysus" xlink:type="simple">http://www.mrzv.org/software/dionysus</ext-link>). Since considering all possible sequence partitions is unnecessary and computationally infeasible in most cases, we follow the strategy of ref. [<xref ref-type="bibr" rid="pcbi.1005071.ref045">45</xref>] and allow the user to limit the number of partitions by the maximum number of segregating characters within each subset of <inline-formula id="pcbi.1005071.e051"><alternatives><graphic id="pcbi.1005071.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> (specified by the command line option <monospace>-s</monospace>), and by the maximum distance between segregating characters in the subset (specified by the command line option <monospace>-w</monospace>). In addition, we also allow the user to exclude from <inline-formula id="pcbi.1005071.e052"><alternatives><graphic id="pcbi.1005071.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> segregating characters that are compatible (namely, that satisfy the Hudson-Kaplan four-gamete test [<xref ref-type="bibr" rid="pcbi.1005071.ref044">44</xref>]) with all the other characters in <inline-formula id="pcbi.1005071.e053"><alternatives><graphic id="pcbi.1005071.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> (specified by the command line option <monospace>-e</monospace>). For each genomic interval, a filtration of Vietoris-Rips complexes is constructed using Hamming distance and the persistent first-homology group is computed over <bold>Z</bold><sub>2</sub>.</p>
</sec>
<sec id="sec016">
<title>Population genetics simulations</title>
<p>We performed 4,000 simulations of a sample of 40 sequences with 12 segregating sites, using the software <monospace>ARGweaver</monospace> [<xref ref-type="bibr" rid="pcbi.1005071.ref034">34</xref>]. The population was simulated using a coalescent infinite sites model with recombination. The population-scaled recombination rate, <italic>ρ</italic>, was randomly generated in each simulation, taking values from a uniform distribution between 0 and 110. For each simulated sample, Myers and Griffiths lower bound <italic>R</italic><sub>MG</sub> ≤ <italic>R</italic><sub>min</sub> was computed using the software <monospace>RecMin</monospace> [<xref ref-type="bibr" rid="pcbi.1005071.ref045">45</xref>], with parameters <monospace>-s 12 -w 12</monospace>. Lower bounds <inline-formula id="pcbi.1005071.e054"><alternatives><graphic id="pcbi.1005071.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>≤</mml:mo> <mml:msub><mml:mover><mml:mi>R</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>min</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> were computed using our application <monospace>TARGet</monospace>, with parameters <monospace>-s 12 -w 12</monospace>.</p>
<p>To study the dependence of <inline-formula id="pcbi.1005071.e055"><alternatives><graphic id="pcbi.1005071.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msub><mml:mover><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> on the recombination rate parameter in coalescent models, we performed 1,000 simulations of a sample of 200 sequences. The population-scaled recombination rate, <italic>ρ</italic>, was randomly generated in each simulation, taking values between 0 and 216. For each simulated sample, <monospace>TARGet</monospace> was run with parameters <monospace>-s 11 -w 11</monospace>, and <monospace>ARGweaver</monospace>’s tool <monospace>arg-sample</monospace> was run with parameters <monospace>-m 7e-9 -n 400 --sample-step 10</monospace>, discarding the first 200 iterations.</p>
<p>Samples of genetic exchange between two divergent populations were simulated using the software <monospace>ms</monospace> [<xref ref-type="bibr" rid="pcbi.1005071.ref059">59</xref>], using the commands</p>
<p>
<monospace>ms 300 1 -s 300 -r 40 10000 -I 2 250 50 -ej 6.0 1 2 -n 2 0.2 -m 1 2 0.5</monospace>
</p>
<p>and,</p>
<p>
<monospace>ms 300 1 -s 300 -r 40 10000 -I 2 250 50 -ej 6.0 1 2 -n 2 0.2</monospace>
</p>
<p>respectively for the cases with and without migration. The barcode ensemble of each sample was computed using <monospace>TARGet</monospace> with parameters <monospace>-s 12 -w 14 -e</monospace>.</p>
<p>To study the dependence of 〈<italic>ϵ</italic><sub><italic>d</italic></sub>〉 on the migration rate in this scenario, we performed 900 simulations using the software <monospace>ms</monospace> [<xref ref-type="bibr" rid="pcbi.1005071.ref059">59</xref>] and <monospace>seq-gen</monospace> [<xref ref-type="bibr" rid="pcbi.1005071.ref060">60</xref>], with the commands</p>
<p>
<monospace>ms 150 1 -T -r 60 10000 -I 2 125 25 -ej 6.0 1 2 -n 2 0.2 -m 1 2 X</monospace>
</p>
<p>and</p>
<p>
<monospace>seq-gen -mHKY -l 10000 -s 0.004 -p 50000</monospace>
</p>
<p>where the migration rate <monospace>X</monospace> in the first command takes random values from a uniform distribution between 0 and 2. For each simulated sample, <monospace>TARGet</monospace> was run with parameters <monospace>-w 8 -s 8</monospace>, and <monospace>arg-sample</monospace> was run with parameters <monospace>-m 1e-7 -n 400 -r 1.5e-7</monospace>. We extracted from SMC ARGs the time to the most recent common ancestor of recombining sequences using a greedy algorithm that searches for the shortest non-zero path connecting the two sequences.</p>
</sec>
<sec id="sec017">
<title>HLA and MS32 loci</title>
<p>We downloaded phased genotype data from HapMap phase III [<xref ref-type="bibr" rid="pcbi.1005071.ref053">53</xref>], corresponding to all SNPs of LWK population between rs6457661 and rs3129301 in chromosome 6. We also downloaded phased genotype data from 1,000 Genomes Project [<xref ref-type="bibr" rid="pcbi.1005071.ref003">3</xref>], corresponding to all SNPs of LWK population between positions 32,887,978 and 32,927,978 of chromosome 6, and half of the SNPs of LWK population between positions 234,190,031 and 234,291,193 of chromosome 1. All coordinates refer to human assembly hg18. The barcode ensemble of each dataset was computed using <monospace>TARGet</monospace> with parameters <monospace>-s 12 -w 12</monospace>.</p>
</sec>
<sec id="sec018">
<title>Darwin’s finches genotyping</title>
<p>Raw paired-end reads from 112 Darwin finches [<xref ref-type="bibr" rid="pcbi.1005071.ref051">51</xref>] were obtained from SRA archive (accession number PRJNA263122) and aligned against the consensus sequence of <italic>Geospiza Fortis</italic>, version GeoFor_1.0/geoFor1, scaffold JH739904. We followed essentially the same procedure than that of ref. [<xref ref-type="bibr" rid="pcbi.1005071.ref051">51</xref>] for the alignment, SNP calling, genotyping and filtering. In short, the alignment was performed with Burrows-Wheeler aligner (BWA) [<xref ref-type="bibr" rid="pcbi.1005071.ref061">61</xref>], version <monospace>0.7.5</monospace>, using BWA-MEM algorithm and default parameters. PCR duplicates were marked using Picard tools (<ext-link ext-link-type="uri" xlink:href="http://picard.sourceforge.net/" xlink:type="simple">http://picard.sourceforge.net/</ext-link>). Indel realignment, SNP discovery and simultaneous genotyping across the 112 samples was performed using Genome Analysis Toolkit (GATK) [<xref ref-type="bibr" rid="pcbi.1005071.ref062">62</xref>], following GATK best practice recommendations [<xref ref-type="bibr" rid="pcbi.1005071.ref063">63</xref>]. SNP calls were filtered by keeping variants with SNP quality &gt; 100, total depth of coverage &gt; 117 and &lt; 1750, ratio between SNP quality and depth of coverage &gt; 2, Fisher strand bias &lt; 60, mapping quality &gt; 50, mapping quality rank &gt; -4 and read position rank sum &gt; -2. In total, 13,980 variant positions passed these filters. To avoid phasing errors, we only considered SNPs that were homozygous across the 120 samples. The resulting genotypes were processed with <monospace>TARGet</monospace> for barcode ensemble computation, using the options <monospace>-s 14 -w 14</monospace>.</p>
</sec>
</sec>
<sec id="sec019">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005071.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005071.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Comparison to SMC approaches to ARG inference.</title>
<p>(A) The number of recombination events in SMC ARGs [<xref ref-type="bibr" rid="pcbi.1005071.ref034">34</xref>], <italic>R</italic><sub>argweaver</sub>, plotted against the number of bars in the barcode ensemble, <inline-formula id="pcbi.1005071.e056"><alternatives><graphic id="pcbi.1005071.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msub><mml:mover><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>. Both quantities are strongly correlated (Pearson’s <italic>r</italic> = 0.93, <italic>p</italic> &lt; 10<sup>−100</sup>). Plot based on 1,000 coalescent model simulations of a sample of 200 sequences. (B) Coefficient of variation of <italic>R</italic><sub>argweaver</sub> (blue) and <inline-formula id="pcbi.1005071.e057"><alternatives><graphic id="pcbi.1005071.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005071.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msub><mml:mover><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> (red) as a function of the recombination rate. (C) Distribution of wall-clock running times for the simulations in (A). (D) Average time to the most recent common ancestor of recombining sequences in SMC ARGs, 〈<italic>T</italic><sub>argweaver</sub>〉, plotted against the average death time of bars in the barcode ensemble, 〈<italic>ϵ</italic><sub><italic>d</italic></sub>〉, for two divergent populations with recombination and migration. Both quantities are largely correlated (Pearson’s <italic>r</italic> = 0.55, <italic>p</italic> &lt; 10<sup>−72</sup>). Plot based on 900 simulations of a sample of 150 sequences. (E) Coefficient of variation of 〈<italic>T</italic><sub>argweaver</sub>〉 (blue) and 〈<italic>ϵ</italic><sub><italic>d</italic></sub>〉 (red) as a function of the migration rate. (F) Distribution of wall-clock running times for the simulations in (D). <monospace>ARGweaver</monospace> running times also include the time required to extract 〈<italic>T</italic><sub>argweaver</sub>〉 from SMC ARGs.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank C. Solis-Lemus, C. Ane, D. S. Rosenbloom, K. Emmett, M. Lesnick, S. Zairis and V. Aleksandrov for useful discussions and comments.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005071.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lander</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Linton</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Birren</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Nusbaum</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zody</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Baldwin</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Initial sequencing and analysis of the human genome</article-title>. <source>Nature</source>. <year>2001</year>;<volume>409</volume>(<issue>6822</issue>):<fpage>860</fpage>–<lpage>921</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35057062" xlink:type="simple">10.1038/35057062</ext-link></comment> <object-id pub-id-type="pmid">11237011</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Venter</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>PW</given-names></name>, <name name-style="western"><surname>Mural</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Sutton</surname> <given-names>GG</given-names></name>, <etal>et al</etal>. <article-title>The sequence of the human genome</article-title>. <source>science</source>. <year>2001</year>;<volume>291</volume>(<issue>5507</issue>):<fpage>1304</fpage>–<lpage>1351</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1058040" xlink:type="simple">10.1126/science.1058040</ext-link></comment> <object-id pub-id-type="pmid">11181995</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>1000 Genomes Project Consortium</collab>
<etal>et al</etal>. <article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source>. <year>2012</year>;<volume>491</volume>(<issue>7422</issue>):<fpage>56</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11632" xlink:type="simple">10.1038/nature11632</ext-link></comment> <object-id pub-id-type="pmid">23128226</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edwards</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Rohwer</surname> <given-names>F</given-names></name>. <article-title>Viral metagenomics</article-title>. <source>Nature Reviews Microbiology</source>. <year>2005</year>;<volume>3</volume>(<issue>6</issue>):<fpage>504</fpage>–<lpage>510</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrmicro1163" xlink:type="simple">10.1038/nrmicro1163</ext-link></comment> <object-id pub-id-type="pmid">15886693</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Albertsen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hugenholtz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Skarshewski</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Tyson</surname> <given-names>GW</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>PH</given-names></name>. <article-title>Genome sequences of rare, uncultured bacteria obtained by differential coverage binning of multiple metagenomes</article-title>. <source>Nature biotechnology</source>. <year>2013</year>;<volume>31</volume>(<issue>6</issue>):<fpage>533</fpage>–<lpage>538</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2579" xlink:type="simple">10.1038/nbt.2579</ext-link></comment> <object-id pub-id-type="pmid">23707974</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ochman</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Groisman</surname> <given-names>EA</given-names></name>. <article-title>Lateral gene transfer and the nature of bacterial innovation</article-title>. <source>Nature</source>. <year>2000</year>;<volume>405</volume>(<issue>6784</issue>):<fpage>299</fpage>–<lpage>304</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35012500" xlink:type="simple">10.1038/35012500</ext-link></comment> <object-id pub-id-type="pmid">10830951</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Burke</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Arnold</surname> <given-names>ML</given-names></name>. <article-title>Genetics and the fitness of hybrids</article-title>. <source>Annual review of genetics</source>. <year>2001</year>;<volume>35</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.genet.35.102401.085719" xlink:type="simple">10.1146/annurev.genet.35.102401.085719</ext-link></comment> <object-id pub-id-type="pmid">11700276</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Adams</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Wendel</surname> <given-names>JF</given-names></name>. <article-title>Polyploidy and genome evolution in plants</article-title>. <source>Current opinion in plant biology</source>. <year>2005</year>;<volume>8</volume>(<issue>2</issue>):<fpage>135</fpage>–<lpage>141</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.pbi.2005.01.001" xlink:type="simple">10.1016/j.pbi.2005.01.001</ext-link></comment> <object-id pub-id-type="pmid">15752992</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doolittle</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>Papke</surname> <given-names>RT</given-names></name>. <article-title>Genomics and the bacterial species problem</article-title>. <source>Genome biology</source>. <year>2006</year>;<volume>7</volume>(<issue>9</issue>):<fpage>116</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2006-7-9-116" xlink:type="simple">10.1186/gb-2006-7-9-116</ext-link></comment> <object-id pub-id-type="pmid">17020593</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doolittle</surname> <given-names>WF</given-names></name>. <article-title>Phylogenetic classification and the universal tree</article-title>. <source>Science</source>. <year>1999</year>;<volume>284</volume>(<issue>5423</issue>):<fpage>2124</fpage>–<lpage>2128</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.284.5423.2124" xlink:type="simple">10.1126/science.284.5423.2124</ext-link></comment> <object-id pub-id-type="pmid">10381871</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Woese</surname> <given-names>CR</given-names></name>. <article-title>A new biology for a new century</article-title>. <source>Microbiology and Molecular Biology Reviews</source>. <year>2004</year>;<volume>68</volume>(<issue>2</issue>):<fpage>173</fpage>–<lpage>186</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/MMBR.68.2.173-186.2004" xlink:type="simple">10.1128/MMBR.68.2.173-186.2004</ext-link></comment> <object-id pub-id-type="pmid">15187180</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Malley</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Koonin</surname> <given-names>EV</given-names></name>. <article-title>How stands the Tree of Life a century and a half after The Origin</article-title>. <source>Biol Direct</source>. <year>2011</year>;<volume>6</volume>:<fpage>32</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1745-6150-6-32" xlink:type="simple">10.1186/1745-6150-6-32</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref013">
<label>13</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Rupp</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name>. <source>Phylogenetic networks: concepts, algorithms and applications</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005071.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name>. <article-title>A survey of combinatorial methods for phylogenetic networks</article-title>. <source>Genome biology and evolution</source>. <year>2011</year>;<volume>3</volume>:<fpage>23</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/gbe/evq077" xlink:type="simple">10.1093/gbe/evq077</ext-link></comment> <object-id pub-id-type="pmid">21081312</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Morrison</surname> <given-names>DA</given-names></name>. <source>Introduction to phylogenetic networks</source>. <publisher-name>RJR Productions</publisher-name>. <year>2011</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1005071.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bandelt</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Dress</surname> <given-names>AW</given-names></name>. <article-title>Split decomposition: a new and useful approach to phylogenetic analysis of distance data</article-title>. <source>Molecular phylogenetics and evolution</source>. <year>1992</year>;<volume>1</volume>(<issue>3</issue>):<fpage>242</fpage>–<lpage>252</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/1055-7903(92)90021-8" xlink:type="simple">10.1016/1055-7903(92)90021-8</ext-link></comment> <object-id pub-id-type="pmid">1342941</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bandelt</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Forster</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sykes</surname> <given-names>BC</given-names></name>, <name name-style="western"><surname>Richards</surname> <given-names>MB</given-names></name>. <article-title>Mitochondrial portraits of human populations using median networks</article-title>. <source>Genetics</source>. <year>1995</year>;<volume>141</volume>(<issue>2</issue>):<fpage>743</fpage>–<lpage>753</lpage>. <object-id pub-id-type="pmid">8647407</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>. <article-title>SplitsTree: analyzing and visualizing evolutionary data</article-title>. <source>Bioinformatics</source>. <year>1998</year>;<volume>14</volume>(<issue>1</issue>):<fpage>68</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/14.1.68" xlink:type="simple">10.1093/bioinformatics/14.1.68</ext-link></comment> <object-id pub-id-type="pmid">9520503</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bandelt</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Forster</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Röhl</surname> <given-names>A</given-names></name>. <article-title>Median-joining networks for inferring intraspecific phylogenies</article-title>. <source>Molecular biology and evolution</source>. <year>1999</year>;<volume>16</volume>(<issue>1</issue>):<fpage>37</fpage>–<lpage>48</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/oxfordjournals.molbev.a026036" xlink:type="simple">10.1093/oxfordjournals.molbev.a026036</ext-link></comment> <object-id pub-id-type="pmid">10331250</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bandelt</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Macaulay</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Richards</surname> <given-names>M</given-names></name>. <article-title>Median networks: speedy construction and greedy reduction, one simulation, and two case studies from human mtDNA</article-title>. <source>Molecular phylogenetics and evolution</source>. <year>2000</year>;<volume>16</volume>(<issue>1</issue>):<fpage>8</fpage>–<lpage>28</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/mpev.2000.0792" xlink:type="simple">10.1006/mpev.2000.0792</ext-link></comment> <object-id pub-id-type="pmid">10877936</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Bryant</surname> <given-names>D</given-names></name>. <article-title>Application of phylogenetic networks in evolutionary studies</article-title>. <source>Molecular biology and evolution</source>. <year>2006</year>;<volume>23</volume>(<issue>2</issue>):<fpage>254</fpage>–<lpage>267</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msj030" xlink:type="simple">10.1093/molbev/msj030</ext-link></comment> <object-id pub-id-type="pmid">16221896</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref022">
<label>22</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gusfield</surname> <given-names>D</given-names></name>. <source>ReCombinatorics: The Algorithmics of Ancestral Recombination Graphs and Explicit Phylogenetic Networks</source>. <publisher-name>MIT Press</publisher-name>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005071.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Minichiello</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>. <article-title>Mapping trait loci by use of inferred ancestral recombination graphs</article-title>. <source>The American Journal of Human Genetics</source>. <year>2006</year>;<volume>79</volume>(<issue>5</issue>):<fpage>910</fpage>–<lpage>922</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/508901" xlink:type="simple">10.1086/508901</ext-link></comment> <object-id pub-id-type="pmid">17033967</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sutter</surname> <given-names>NB</given-names></name>, <name name-style="western"><surname>Bustamante</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Chase</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Gray</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>A single IGF1 allele is a major determinant of small size in dogs</article-title>. <source>Science</source>. <year>2007</year>;<volume>316</volume>(<issue>5821</issue>):<fpage>112</fpage>–<lpage>115</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1137045" xlink:type="simple">10.1126/science.1137045</ext-link></comment> <object-id pub-id-type="pmid">17412960</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wu</surname> <given-names>Y</given-names></name>. <article-title>Association mapping of complex diseases with ancestral recombination graphs: models and efficient algorithms</article-title>. <source>Journal of Computational Biology</source>. <year>2008</year>;<volume>15</volume>(<issue>7</issue>):<fpage>667</fpage>–<lpage>684</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2007.0116" xlink:type="simple">10.1089/cmb.2007.0116</ext-link></comment> <object-id pub-id-type="pmid">18651799</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Le</surname> <given-names>SQ</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>. <article-title>SNP detection and genotyping from low-coverage sequencing data on multiple diploid samples</article-title>. <source>Genome research</source>. <year>2011</year>;<volume>21</volume>(<issue>6</issue>):<fpage>952</fpage>–<lpage>960</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.113084.110" xlink:type="simple">10.1101/gr.113084.110</ext-link></comment> <object-id pub-id-type="pmid">20980557</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wall</surname> <given-names>JD</given-names></name>. <article-title>A comparison of estimators of the population recombination rate</article-title>. <source>Molecular Biology and Evolution</source>. <year>2000</year>;<volume>17</volume>(<issue>1</issue>):<fpage>156</fpage>–<lpage>163</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/oxfordjournals.molbev.a026228" xlink:type="simple">10.1093/oxfordjournals.molbev.a026228</ext-link></comment> <object-id pub-id-type="pmid">10666715</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>L</given-names></name>. <article-title>Perfect phylogenetic networks with recombination</article-title>. <source>Journal of Computational Biology</source>. <year>2001</year>;<volume>8</volume>(<issue>1</issue>):<fpage>69</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/106652701300099119" xlink:type="simple">10.1089/106652701300099119</ext-link></comment> <object-id pub-id-type="pmid">11339907</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bordewich</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Semple</surname> <given-names>C</given-names></name>. <article-title>On the computational complexity of the rooted subtree prune and regraft distance</article-title>. <source>Annals of combinatorics</source>. <year>2005</year>;<volume>8</volume>(<issue>4</issue>):<fpage>409</fpage>–<lpage>423</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00026-004-0229-z" xlink:type="simple">10.1007/s00026-004-0229-z</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bordewich</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Semple</surname> <given-names>C</given-names></name>. <article-title>Computing the minimum number of hybridization events for a consistent evolutionary history</article-title>. <source>Discrete Applied Mathematics</source>. <year>2007</year>;<volume>155</volume>(<issue>8</issue>):<fpage>914</fpage>–<lpage>928</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.dam.2006.08.008" xlink:type="simple">10.1016/j.dam.2006.08.008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gusfield</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Eddhu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Langley</surname> <given-names>C</given-names></name>. <article-title>Optimal, efficient reconstruction of phylogenetic networks with constrained recombination</article-title>. <source>Journal of bioinformatics and computational biology</source>. <year>2004</year>;<volume>2</volume>(<issue>01</issue>):<fpage>173</fpage>–<lpage>213</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1142/S0219720004000521" xlink:type="simple">10.1142/S0219720004000521</ext-link></comment> <object-id pub-id-type="pmid">15272438</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gusfield</surname> <given-names>D</given-names></name>. <article-title>Optimal, efficient reconstruction of root-unknown phylogenetic networks with constrained and structured recombination</article-title>. <source>Journal of Computer and System Sciences</source>. <year>2005</year>;<volume>70</volume>(<issue>3</issue>):<fpage>381</fpage>–<lpage>398</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jcss.2004.12.009" xlink:type="simple">10.1016/j.jcss.2004.12.009</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Song</surname> <given-names>YS</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Gusfield</surname> <given-names>D</given-names></name>. <article-title>Efficient computation of close lower and upper bounds on the minimum number of recombinations in biological sequence evolution</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>suppl 1</issue>):<fpage>i413</fpage>–<lpage>i422</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti1033" xlink:type="simple">10.1093/bioinformatics/bti1033</ext-link></comment> <object-id pub-id-type="pmid">15961486</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rasmussen</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Hubisz</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Gronau</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Siepel</surname> <given-names>A</given-names></name>. <article-title>Genome-wide inference of ancestral recombination graphs</article-title>. <source>PLoS genetics</source>. <year>2014</year>;<volume>10</volume>(<issue>5</issue>):<fpage>e1004342</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1004342" xlink:type="simple">10.1371/journal.pgen.1004342</ext-link></comment> <object-id pub-id-type="pmid">24831947</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chan</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Carlsson</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Rabadan</surname> <given-names>R</given-names></name>. <article-title>Topology of viral evolution</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>46</issue>):<fpage>18566</fpage>–<lpage>18571</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1313480110" xlink:type="simple">10.1073/pnas.1313480110</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref036">
<label>36</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Emmett</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Rabadan</surname> <given-names>R</given-names></name>. <chapter-title>Characterizing Scales of Genetic Recombination and Antibiotic Resistance in Pathogenic Bacteria Using Topological Data Analysis</chapter-title>. In: <source>Brain Informatics and Health</source>. <publisher-name>Springer</publisher-name>; <year>2014</year>. p. <fpage>540</fpage>–<lpage>551</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005071.ref037">
<label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Emmett K, Rosenbloom D, Camara P, Rabadan R. Parametric inference using persistence diagrams: A case study in population genetics. arXiv preprint arXiv:14064582. 2014;.</mixed-citation>
</ref>
<ref id="pcbi.1005071.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Carlsson</surname> <given-names>G</given-names></name>. <article-title>Topology and data</article-title>. <source>Bulletin of the American Mathematical Society</source>. <year>2009</year>;<volume>46</volume>(<issue>2</issue>):<fpage>255</fpage>–<lpage>308</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1090/S0273-0979-09-01249-X" xlink:type="simple">10.1090/S0273-0979-09-01249-X</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edelsbrunner</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Letscher</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zomorodian</surname> <given-names>A</given-names></name>. <article-title>Topological persistence and simplification</article-title>. <source>Discrete and Computational Geometry</source>. <year>2002</year>;<volume>28</volume>(<issue>4</issue>):<fpage>511</fpage>–<lpage>533</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00454-002-2885-2" xlink:type="simple">10.1007/s00454-002-2885-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zomorodian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Carlsson</surname> <given-names>G</given-names></name>. <article-title>Computing persistent homology</article-title>. <source>Discrete &amp; Computational Geometry</source>. <year>2005</year>;<volume>33</volume>(<issue>2</issue>):<fpage>249</fpage>–<lpage>274</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00454-004-1146-y" xlink:type="simple">10.1007/s00454-004-1146-y</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cohen-Steiner</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Edelsbrunner</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Harer</surname> <given-names>J</given-names></name>. <article-title>Stability of persistence diagrams</article-title>. <source>Discrete &amp; Computational Geometry</source>. <year>2007</year>;<volume>37</volume>(<issue>1</issue>):<fpage>103</fpage>–<lpage>120</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00454-006-1276-5" xlink:type="simple">10.1007/s00454-006-1276-5</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Chazal</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Cohen-Steiner</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Guibas</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Mémoli</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Oudot</surname> <given-names>SY</given-names></name>. <chapter-title>Gromov-Hausdorff Stable Signatures for Shapes using Persistence</chapter-title>. In: <source>Computer Graphics Forum</source>. <volume>vol. 28</volume>. <publisher-name>Wiley Online Library</publisher-name>; <year>2009</year>. p. <fpage>1393</fpage>–<lpage>1403</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005071.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ghrist</surname> <given-names>R</given-names></name>. <article-title>Barcodes: the persistent topology of data</article-title>. <source>Bulletin of the American Mathematical Society</source>. <year>2008</year>;<volume>45</volume>(<issue>1</issue>):<fpage>61</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1090/S0273-0979-07-01191-3" xlink:type="simple">10.1090/S0273-0979-07-01191-3</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hudson</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Kaplan</surname> <given-names>NL</given-names></name>. <article-title>Statistical properties of the number of recombination events in the history of a sample of DNA sequences</article-title>. <source>Genetics</source>. <year>1985</year>;<volume>111</volume>(<issue>1</issue>):<fpage>147</fpage>–<lpage>164</lpage>. <object-id pub-id-type="pmid">4029609</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Myers</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Griffiths</surname> <given-names>RC</given-names></name>. <article-title>Bounds on the minimum number of recombination events in a sample history</article-title>. <source>Genetics</source>. <year>2003</year>;<volume>163</volume>(<issue>1</issue>):<fpage>375</fpage>–<lpage>394</lpage>. <object-id pub-id-type="pmid">12586723</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Griffiths</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Marjoram</surname> <given-names>P</given-names></name>. <article-title>Ancestral inference from samples of DNA sequences with recombination</article-title>. <source>Journal of Computational Biology</source>. <year>1996</year>;<volume>3</volume>(<issue>4</issue>):<fpage>479</fpage>–<lpage>502</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.1996.3.479" xlink:type="simple">10.1089/cmb.1996.3.479</ext-link></comment> <object-id pub-id-type="pmid">9018600</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Griffiths</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Marjoram</surname> <given-names>P</given-names></name>. <article-title>An ancestral recombination graph</article-title>. <source>Institute for Mathematics and its Applications</source>. <year>1997</year>;<volume>87</volume>:<fpage>257</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005071.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hudson</surname> <given-names>RR</given-names></name>. <article-title>Properties of a neutral allele model with intragenic recombination</article-title>. <source>Theoretical population biology</source>. <year>1983</year>;<volume>23</volume>(<issue>2</issue>):<fpage>183</fpage>–<lpage>201</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0040-5809(83)90013-8" xlink:type="simple">10.1016/0040-5809(83)90013-8</ext-link></comment> <object-id pub-id-type="pmid">6612631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref049">
<label>49</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hatcher</surname> <given-names>A</given-names></name>. <source>Algebraic Topology</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005071.ref050">
<label>50</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ghrist</surname> <given-names>R</given-names></name>. <source>Elementary Applied Topology</source>. <publisher-name>Self-published, printed by CreateSpace</publisher-name>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005071.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lamichhaney</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Berglund</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Almén</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Maqbool</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Grabherr</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Martinez-Barrio</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Evolution of Darwin/’s finches and their beaks revealed by genome sequencing</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>(<issue>7539</issue>):<fpage>371</fpage>–<lpage>375</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature14181" xlink:type="simple">10.1038/nature14181</ext-link></comment> <object-id pub-id-type="pmid">25686609</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref052">
<label>52</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Song</surname> <given-names>YS</given-names></name>, <name name-style="western"><surname>Hein</surname> <given-names>J</given-names></name>. <chapter-title>Parsimonious reconstruction of sequence evolution and haplotype blocks</chapter-title>. In: <source>Algorithms in Bioinformatics</source>. <publisher-name>Springer</publisher-name>; <year>2003</year>. p. <fpage>287</fpage>–<lpage>302</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005071.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>International HapMap 3 Consortium</collab>
<etal>et al</etal>. <article-title>Integrating common and rare genetic variation in diverse human populations</article-title>. <source>Nature</source>. <year>2010</year>;<volume>467</volume>(<issue>7311</issue>):<fpage>52</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09298" xlink:type="simple">10.1038/nature09298</ext-link></comment> <object-id pub-id-type="pmid">20811451</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jeffreys</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Kauppi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Neumann</surname> <given-names>R</given-names></name>. <article-title>Intensely punctate meiotic recombination in the class II region of the major histocompatibility complex</article-title>. <source>Nature genetics</source>. <year>2001</year>;<volume>29</volume>(<issue>2</issue>):<fpage>217</fpage>–<lpage>222</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng1001-217" xlink:type="simple">10.1038/ng1001-217</ext-link></comment> <object-id pub-id-type="pmid">11586303</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hinch</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Tandon</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Patterson</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Rohland</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Palmer</surname> <given-names>CD</given-names></name>, <etal>et al</etal>. <article-title>The landscape of recombination in African Americans</article-title>. <source>Nature</source>. <year>2011</year>;<volume>476</volume>(<issue>7359</issue>):<fpage>170</fpage>–<lpage>175</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10336" xlink:type="simple">10.1038/nature10336</ext-link></comment> <object-id pub-id-type="pmid">21775986</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>1000 Genomes Project Consortium</collab>
<etal>et al</etal>. <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>(<issue>7571</issue>):<fpage>68</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature15393" xlink:type="simple">10.1038/nature15393</ext-link></comment> <object-id pub-id-type="pmid">26432245</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref057">
<label>57</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hein</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schierup</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wiuf</surname> <given-names>C</given-names></name>. <source>Gene genealogies, variation and evolution: a primer in coalescent theory</source>. <publisher-name>Oxford university press</publisher-name>; <year>2004</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005071.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Petren</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Grant</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Grant</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>L</given-names></name>. <article-title>Comparative landscape genetics and the adaptive radiation of Darwin’s finches: the role of peripheral isolation</article-title>. <source>Molecular Ecology</source>. <year>2005</year>;<volume>14</volume>(<issue>10</issue>):<fpage>2943</fpage>–<lpage>2957</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1365-294X.2005.02632.x" xlink:type="simple">10.1111/j.1365-294X.2005.02632.x</ext-link></comment> <object-id pub-id-type="pmid">16101765</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hudson</surname> <given-names>RR</given-names></name>. <article-title>Generating samples under a Wright–Fisher neutral model of genetic variation</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>2</issue>):<fpage>337</fpage>–<lpage>338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/18.2.337" xlink:type="simple">10.1093/bioinformatics/18.2.337</ext-link></comment> <object-id pub-id-type="pmid">11847089</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grass</surname> <given-names>NC</given-names></name>. <article-title>Seq-Gen: an application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic trees</article-title>. <source>Computer applications in the biosciences: CABIOS</source>. <year>1997</year>;<volume>13</volume>(<issue>3</issue>):<fpage>235</fpage>–<lpage>238</lpage>. <object-id pub-id-type="pmid">9183526</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>. <article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>14</issue>):<fpage>1754</fpage>–<lpage>1760</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp324" xlink:type="simple">10.1093/bioinformatics/btp324</ext-link></comment> <object-id pub-id-type="pmid">19451168</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McKenna</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hanna</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Banks</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sivachenko</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cibulskis</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kernytsky</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome research</source>. <year>2010</year>;<volume>20</volume>(<issue>9</issue>):<fpage>1297</fpage>–<lpage>1303</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.107524.110" xlink:type="simple">10.1101/gr.107524.110</ext-link></comment> <object-id pub-id-type="pmid">20644199</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005071.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>DePristo</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Banks</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Poplin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Garimella</surname> <given-names>KV</given-names></name>, <name name-style="western"><surname>Maguire</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Hartl</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nature genetics</source>. <year>2011</year>;<volume>43</volume>(<issue>5</issue>):<fpage>491</fpage>–<lpage>498</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng.806" xlink:type="simple">10.1038/ng.806</ext-link></comment> <object-id pub-id-type="pmid">21478889</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>