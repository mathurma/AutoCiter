<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004596</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00337</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Differences in Visual-Spatial Input May Underlie Different Compression Properties of Firing Fields for Grid Cell Modules in Medial Entorhinal Cortex</article-title>
<alt-title alt-title-type="running-head">Visual-Spatial Input to Entorhinal Cortex</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Raudies</surname>
<given-names>Florian</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
<xref rid="currentaff001" ref-type="fn"><sup>¤</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hasselmo</surname>
<given-names>Michael E.</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Center for Systems Neuroscience and Department of Psychological and Brain Sciences, Boston University, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Center for Computational Neuroscience and Neural Technology, Boston University, Boston, Massachusetts, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Bush</surname>
<given-names>Daniel</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University College London, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: FR MEH. Performed the experiments: FR. Analyzed the data: FR MEH. Contributed reagents/materials/analysis tools: FR. Wrote the paper: FR MEH.</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label><p>Current Address: Hewlett-Packard Labs, Palo Alto, California, United States of America</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">florian.raudies@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>19</day>
<month>11</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>11</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>11</issue>
<elocation-id>e1004596</elocation-id>
<history>
<date date-type="received">
<day>28</day>
<month>2</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>10</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Raudies, Hasselmo</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004596" xlink:type="simple"/>
<abstract>
<p>Firing fields of grid cells in medial entorhinal cortex show compression or expansion after manipulations of the location of environmental barriers. This compression or expansion could be selective for individual grid cell modules with particular properties of spatial scaling. We present a model for differences in the response of modules to barrier location that arise from different mechanisms for the influence of visual features on the computation of location that drives grid cell firing patterns. These differences could arise from differences in the position of visual features within the visual field. When location was computed from the movement of visual features on the ground plane (optic flow) in the ventral visual field, this resulted in grid cell spatial firing that was not sensitive to barrier location in modules modeled with small spacing between grid cell firing fields. In contrast, when location was computed from static visual features on walls of barriers, i.e. in the more dorsal visual field, this resulted in grid cell spatial firing that compressed or expanded based on the barrier locations in modules modeled with large spacing between grid cell firing fields. This indicates that different grid cell modules might have differential properties for computing location based on visual cues, or the spatial radius of sensitivity to visual cues might differ between modules.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>How do we navigate from one location to another and how do we represent space to accomplish this task? Researchers have collected data from the entorhinal cortex in rodents to answer these questions, finding grid cells that fire whenever a rodent traverses through an array of locations falling on the vertices of tightly packed equilateral triangles. Grid cells with large spacing (large side lengths of the triangles between firing fields) are distorted when the environment is manipulated, e.g. by pushing walls or inserting walls in a box. In contrast, grid cells of small spacing remain largely unaffected by such manipulations. We present a computational model to explain this behavior of grid cells. In our model information about the motion of features on the ground, which are unaffected by wall manipulations, drive grid cells with small spacing between firing fields, while static features like landmarks, which are affected by wall manipulations, drive grid cells with large spacing between firing fields. These differences could correspond to different positions within the visual field of the animal. This model puts forth a testable hypothesis about the type of features that drive grid cells of different spacing.</p>
</abstract>
<funding-group>
<funding-statement>This work was funded by: Office of Naval Research ONR MURI N00014-10-1-0936; National Science Foundation CELEST SMA-0835976; National Institutes of Mental Health Silvio O. Conte Center grant NIMH P50 094263; National Institutes of Health R01 grants MH60013 and MH61492. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="1"/>
<page-count count="27"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The generation of action potentials by grid cells in the rat medial entorhinal cortex depends upon the location of the rat as it forages in an open field environment [<xref rid="pcbi.1004596.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1004596.ref003" ref-type="bibr">3</xref>]. Grid cells fire when a rat visits a regular array of locations falling on the vertices of tightly packed equilateral triangles. This regular pattern of firing has been proposed to partly arise from the path integration of self-motion cues along the rats trajectory [<xref rid="pcbi.1004596.ref004" ref-type="bibr">4</xref>–<xref rid="pcbi.1004596.ref006" ref-type="bibr">6</xref>]. However, experiments have also demonstrated a clear dependence of grid cell firing on the location of sensory cues in the environment. For example, grid cell firing fields rotate with the location of a white cue card on the cylindrical wall of an environment [<xref rid="pcbi.1004596.ref002" ref-type="bibr">2</xref>], as previously shown for place cells [<xref rid="pcbi.1004596.ref007" ref-type="bibr">7</xref>].</p>
<p>The dependence of grid cell firing on sensory cues was clearly demonstrated by a further manipulation in which the barriers of an open field environment were systematically shifted between trials [<xref rid="pcbi.1004596.ref008" ref-type="bibr">8</xref>]. For example, when an environment was altered from a square with sides of 100 cm to a rectangle with sides of 70 cm and 100 cm, the grid cell firing fields showed compression of their spacing primarily in the dimension of the compression of the barriers [<xref rid="pcbi.1004596.ref008" ref-type="bibr">8</xref>]. This did not require regular physical contact with the walls of the environment (e.g. with the whiskers), suggesting sensitivity to the visual cues of the barriers.</p>
<p>Later research demonstrated that this compression of the spacing of grid cell firing fields could be selective for individual populations of grid cells within medial entorhinal cortex [<xref rid="pcbi.1004596.ref009" ref-type="bibr">9</xref>]. This study demonstrated that separate populations, or modules, of grid cells in medial entorhinal cortex shared orientation and spacing, and demonstrated up to five modules with different spacing [<xref rid="pcbi.1004596.ref009" ref-type="bibr">9</xref>]. The same study also demonstrated that compression of the barriers of the environment could selectively affect modules with larger spacing between grid cell firing fields (usually recorded from more ventral regions of the medial entorhinal cortex) while having no effect on modules with narrower spacing between firing fields (usually recorded from more dorsal regions of the medial entorhinal cortex).</p>
<p>The selective effect on individual modules suggests differences in the mechanism of influence of visual features on grid cell modules, and also indicates that these mechanisms of spatial location do not involve only path integration based on vestibular and proprioceptive input. The influence of distant visual features on barriers indicates that the sensory input processed by visual cortices on the dorsal surface of the rat brain [<xref rid="pcbi.1004596.ref010" ref-type="bibr">10</xref>–<xref rid="pcbi.1004596.ref014" ref-type="bibr">14</xref>] can influence the spatial computations in the medial entorhinal cortex. Data indicates that rodent visual cortices might have separate systems sensitive to differences in speed of movement and spatial frequency of stimuli [<xref rid="pcbi.1004596.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1004596.ref013" ref-type="bibr">13</xref>] that may resemble the dorsal and ventral streams observed in primate cortices [<xref rid="pcbi.1004596.ref015" ref-type="bibr">15</xref>]. There is also evidence that different rodent visual regions are restricted to specific portions of visual space [<xref rid="pcbi.1004596.ref014" ref-type="bibr">14</xref>] and may project selectively to specific entorhinal regions [<xref rid="pcbi.1004596.ref012" ref-type="bibr">12</xref>].</p>
<p>In a nutshell, our computational model employs two feature systems: A moving feature system and a static feature system. These are both abstract analytical models of the processing of visual stimuli that provide input to network models of grid cells. The moving feature system uses optic flow, which describes the movement of features on the rat’s retina, which is caused by the relative motion between the rat and the environment. This optic flow is then used to estimate the self-motion of the rat. A temporal integration of this velocity signal can generate grid cell firing, e.g. using the velocity controlled oscillator model [<xref rid="pcbi.1004596.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1004596.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1004596.ref017" ref-type="bibr">17</xref>]. The static feature system uses sensed, visual angles of landmarks and the memorized location for these landmarks to triangulate the current location of self. The triangulation method computes the intersection point of all observed visual angles (slope) together with their memorized location (offset) using a least-squares optimization based on the deviation of intersecting points and the solution. If the environment has changed since the last time of memorization of landmark locations, a conflict appears between the sensed and memorized signal. In our model, we resolve this conflict by introducing a compression of the distance metric. For this reason the environment and the model grid cells in the static feature system appear compressed.</p>
<p>This work presents a conceptual and computational model for the observed differences in compression between grid cells recorded from dorsal versus ventral medial entorhinal cortex. Our conceptual model assumes that these two regions receive input from different functional systems (<xref rid="pcbi.1004596.g001" ref-type="fig">Fig 1</xref>). In our model the moving feature system, motivated by the dorsal stream, receives information about optic flow on the ground plane (primarily in the ventral visual field), which remains unchanged by the compression in the environment. Thus, firing of model grid cells in this moving feature system remains unchanged by the compression of the environment. In contrast, the static feature system, motivated by the ventral stream, receives input from landmarks, which change with the compression of the environment (and appear more in the dorsal visual field). Thus, the compression of the environment influences model grid cells in the static feature system.</p>
<fig id="pcbi.1004596.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004596.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Shows the model components.</title>
<p>(A) The visual cortex and other cortical areas provide an image stream with optic flow and visual features. (B) Processing in cortical areas provides input to the hippocampus and allows for a mapping between the sensed image stream and the representation of spatial location. (C) In our model entorhinal cortex has two modules generated by functionally different mechanisms, estimating location through optic flow for the moving feature system or through triangulation for the static feature system. In this diagram, we also included the anatomical projection from visual cortex to entorhinal cortex, which is currently not used in our model. Therefore, we show this projection as dashed line.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.g001" position="float" xlink:type="simple"/>
</fig>
<p>We perform a computational study, which has two aims. The first aim is to test the behavior of this model with its moving feature system and static feature system when compressing the environment through simulations. The second aim is to compare the noise sensitivity of the moving feature system and the static feature system. We organized these simulations into two sections in the results.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>In the first simulation, we altered the configuration of a box by shifting two barriers, which altered the box from a square to a rectangular layout (Figs <xref rid="pcbi.1004596.g002" ref-type="fig">2</xref> and <xref rid="pcbi.1004596.g003" ref-type="fig">3</xref>). In the second simulation, we tested the accuracy of the location estimation methods with noisy perturbations in the angle of landmarks and the angular velocities of optic flow components (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4</xref>).</p>
<fig id="pcbi.1004596.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004596.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Shows compression influences the static feature system, while the moving feature system remains unaffected.</title>
<p>The box in configuration A (part A of Fig 2) is square and for configuration B (part B of Fig 2) the box is rectangular. (C) Estimated location for the moving feature system in configuration A. (D) Estimated location for the moving feature system in configuration B showing that estimates of location correctly change with compression. (E) Estimated location for the static feature system in configuration A. (F) Estimated location for the static feature system in configuration B. This shows that this static feature system inaccurately estimates location as if the box were to appear as uncompressed.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.g002" position="float" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004596.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004596.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Shows the compression in configuration B compared to configuration A.</title>
<p>(A) Simulated grid cell firing pattern from a simulated dorsal entorhinal cell for (A) configuration A (grid score 1.88) and (B) for configuration B (grid score 1.91). (C) Correlation values for different magnitudes of compression of B relative to A shows a peak correlation at a compression of ≈ 3.1%. (D) The simulated grid cell firing pattern from the ventral entorhinal cell for (D) configuration A (grid score 1.66) and (E) configuration B (grid score 1.25) based on inaccurately estimated locations in <xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2F</xref>. (F) Correlation value for different magnitudes of compression of configuration B relative to configuration A shows that the grid cell firing in configuration B needs to be increased by a compression factor of ≈ 95.5% (about 50 cm) to obtain maximum correlation with the grid cell firing pattern from configuration A.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.g003" position="float" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004596.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004596.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Illustrates the influence of bias-free and biased Gaussian noise on the location estimates and grid cell firing.</title>
<p>(A-D) shows the temporal integration without a transform from polar to Cartesian coordinates (<xref rid="pcbi.1004596.e039" ref-type="disp-formula">Eq 9</xref>). Here the of estimated radial distance and angle based on the integrated linear velocity and rotational velocity follows a Brownian motion model for the bias-free noise and biased noise. (A) Squared distance error for the linear velocity for bias-free noise and (B) squared angular error for the rotational velocity for bias-free noise. (C) Squared distance error and (D) and squared angular error for biased noise. The legend in (A) applies to all panels (A-D). In (D) the blue (model) and black line (data) overlap. (E-F) Euclidean error computed from integration of position in Cartesian coordinates (<xref rid="pcbi.1004596.e039" ref-type="disp-formula">Eq 9</xref>). The Euclidean error between the estimated and ground-truth location for bias-free noise is small in both the moving feature system (E) and in the static feature system (F). (G-H) For biased noise the error increases rapidly due to the error accumulation in the moving feature system (G), but the error stays almost constant for biased-free noise in the static feature system because no error accumulation happens (H). For panels (E-H) the statistics includes 100 trials, where the black line shows the mean and the shaded gray area +-1 STD. Panels (I-L) are analogous to panels (E-H) but provide data for a single trial. (M-P) The corresponding firing patterns of that single trial from the velocity controlled oscillator model are shown for: (M) bias-free noise and the moving feature system; (N) bias-free noise and the static feature system; (O) biased noise and the moving feature system; and (P) biased noise and the static feature system.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.g004" position="float" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Grid cell firing of the static feature system compresses while grid cell firing of the moving feature system remains unchanged for a compressed box configuration</title>
<p>In this simulation, we modeled the experiment on the compression of a box [<xref rid="pcbi.1004596.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1004596.ref009" ref-type="bibr">9</xref>]. The same box appears in two configurations. In configuration A the box is 150 cm × 150 cm (<xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2A</xref>) and in configuration B the box is 150 cm × 100 cm (<xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2B</xref>). This shift means that the visual features on the two shifted barriers have changed their absolute location in 3D space, here in the y-dimension of the horizontal plane. In addition, some features visible in configuration A become invisible in configuration B (dotted surfaces shown in <xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2B</xref>). These invisible features are hidden by the shifted barriers in configuration B.</p>
<p>The shift of barriers has a differential effect on the different modules, dependent on the nature of the input to the different modules (<xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2C–2F</xref>). The location estimate from the moving feature system before the change (<xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2C</xref>) remains accurate after the alteration (<xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2D</xref>), effectively tracking the limited range of movement in the compressed box. In contrast, the location estimates for the static feature system before the change (<xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2E</xref>) are distorted after the box is compressed (<xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2F</xref>), incorrectly estimating that the movements in the environment cover the same region, despite the compression. In our example the compression of the box is 33%. To visualize the grid cell response to compression and to compare this compression effect in location estimates with published experimental data on the compression effect in grid cell firing, we used the velocity controlled oscillator model [<xref rid="pcbi.1004596.ref006" ref-type="bibr">6</xref>] with our location estimates to simulate the behavior of grid cells. This visualization and analysis of compression effects does not depend on the type of grid cell model used. The results are the same when using an attractor model of grid cells [<xref rid="pcbi.1004596.ref018" ref-type="bibr">18</xref>] instead (<xref rid="pcbi.1004596.s001" ref-type="supplementary-material">S1 Fig</xref>).</p>
<p>We matched the compression of grid cell firing patterns from configuration B (Figs <xref rid="pcbi.1004596.g003" ref-type="fig">3B</xref> and <xref rid="pcbi.1004596.g002" ref-type="fig">2D</xref>) with grid cell firing patterns of configuration A (Figs <xref rid="pcbi.1004596.g003" ref-type="fig">3A</xref> and <xref rid="pcbi.1004596.g002" ref-type="fig">2C</xref>). The match of firing fields was measured by the r<sup>2</sup> score. This comparison focuses on the correlation of firing fields, not the correlation of the boundaries of the environment. Across different possible compression percentages, we found a maximum match (maximum r<sup>2</sup> score) at ≈ 3.1% using inputs from the moving feature system (<xref rid="pcbi.1004596.g003" ref-type="fig">Fig 3C</xref>). This means that there was almost no compression necessary to match the grid cell firing pattern in configuration B with the grid cell firing pattern in configuration A. The change in the x-dimension to match the two firing patterns is close to 0% for the moving feature system.</p>
<p>In the case of the static feature system, location estimates in configuration B are based on the memorized appearance of features in the box that are matched to the altered visual appearance of these features through compression factors. Essentially, the model estimates locations within the box in configuration B (<xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2F</xref>) as if the walls were still in configuration A (<xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2E</xref>). We used these location estimates within the velocity controlled oscillator model to simulate grid cell firing. The resulting grid cell firing pattern based on the actual location of the rat shows a clear compression of relative spacing of firing fields with the alteration between configuration A and configuration B (compare <xref rid="pcbi.1004596.g003" ref-type="fig">Fig 3E with 3D</xref>). When comparing across different percentages of compression, a maximum match in correlation between the grid cell firing patterns from configuration A (<xref rid="pcbi.1004596.g003" ref-type="fig">Fig 3D</xref>) and configuration B (<xref rid="pcbi.1004596.g003" ref-type="fig">Fig 3E</xref>) appears for the compression of ≈ 95.5% (<xref rid="pcbi.1004596.g003" ref-type="fig">Fig 3F</xref>). That is, the grid cell firing pattern from configuration B had to be expanded in the y-dimension by ≈ 95.5% (of the 50 cm barrier shift) to best match the grid cell firing pattern from configuration A. This indicates a substantial compression of the relative spacing of grid cell firing fields for the static features system with the change in barrier location. To match the Stensola et al. procedures [<xref rid="pcbi.1004596.ref009" ref-type="bibr">9</xref>], the percentage value for 100% compression indicates that the expansion of the environment is equal to the full amount (100% or 50 cm) to make the match of the configuration B to configuration A.</p>
<p>In sum, the firing recorded from these simulated grid cells using the theorized mechanism of optic flow on the ground plane in dorsal entorhinal cortex (moving feature system) remain unchanged by alterations of barriers in the box. In contrast, the firing recorded from simulated grid cells using the theorized mechanism of triangulation from visual features proposed for ventral entorhinal cortex (static feature system) shows a compression proportional to the shift of barriers. This corresponds to the measured data from grid cells in environments with barrier shifts [<xref rid="pcbi.1004596.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1004596.ref009" ref-type="bibr">9</xref>].</p>
<p>In our model this difference in compression of different cells is explained by using two functionally different mechanisms to model the location estimate for the dorsal entorhinal cells versus the ventral entorhinal cells. For the dorsal entorhinal cells location is estimated from optic flow on the ground plane (moving feature system), which remains unchanged when barriers are altered. This might indicate sensitivity to features in the ventral visual field (dorsal retina). For the ventral entorhinal cells location is estimated from landmark locations (static feature system) and those estimates change according to the shift of the walls that shift landmark location. This might indicate sensitivity to features in the more dorsal visual field (ventral retina). Our model is completely uniform in response to different walls, so we get the same results for compression in the x-dimension instead of the y-dimension. Shifting one or two walls is equivalent in our model as long as the reference (0, 0)-location is adjusted accordingly.</p>
</sec>
<sec id="sec004">
<title>Noise for velocity based position estimates accumulate error while noise does not accumulate error for triangulation-based position estimates</title>
<p>The moving feature system estimates position by integrating velocities over time and, thus, this moving feature system also temporally integrates any error in such velocity estimates. However, the static feature system estimates the position at each time point and, thus, does not integrate any error over time. To test, visualize, and understand the noise sensitivity of our model further, we used the same random trajectory as for the box with dimensions of 150 cm × 150 cm (configuration A). We superimposed independent, additive Gaussian noise onto the angular directions of landmarks and the angular velocities of sensed feature locations on the ground (see <xref rid="sec006" ref-type="sec">Methods</xref>). To compare the noise in the two different domains, we computed the Signal-to-Noise Ratio (SNR) value, which we matched between noise in angles and noise in angular velocities. We performed simulations with Gaussian noise with two parameterizations. For the first parameterization, noise in the moving feature system had a mean value of <italic>μ</italic><sub><italic>v</italic></sub> = 0 deg/sec and a standard deviation (STDs) of <italic>σ</italic><sub><italic>v</italic></sub> = 1.75 deg/sec and noise in the static feature system had a mean value of <italic>μ</italic><sub><italic>l</italic></sub> = 0 deg and an STD of <italic>σ</italic><sub><italic>l</italic></sub> = 1 deg. This resulted in the matched SNR values of 79.9 dB for the moving feature system and 80.1 dB for the static feature system. Because the mean value was zero, we call this the bias-free noise parameterization. In the second parameterization, noise in the moving feature system had a mean value of <italic>μ</italic><sub><italic>v</italic></sub> = 1 deg/sec and an STD of <italic>σ</italic><sub><italic>v</italic></sub> = 1.75 deg/sec and noise in the static feature system had the mean value of <italic>μ</italic><sub><italic>l</italic></sub> = 0.8 deg and an STD of <italic>σ</italic><sub><italic>l</italic></sub> = 1 deg. The matched SNR values are 75.7 dB and 75.6 dB for the moving feature system and static feature system, respectively. Because the mean value was nonzero, we call this the biased noise parameterization.</p>
<p>For the moving feature system, we estimate the linear velocity <italic>v</italic><sub><italic>z</italic></sub> and the rotational velocity <italic>ω</italic><sub><italic>y</italic></sub> (see <xref rid="sec006" ref-type="sec">Methods</xref>). In our model, these velocities transformed into Cartesian coordinates (using <xref rid="pcbi.1004596.e039" ref-type="disp-formula">Eq 9</xref>) before integration of position. However, if we instead directly temporally integrate these velocities, noise in these two properties is characterized through a Brownian motion model, as illustrated in <xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4A–4D</xref>. To derive the overall estimated radial distance <italic>l</italic> and the overall estimated angle <italic>φ</italic>, we multiply these angles by the temporal interval for a time step Δt: <inline-formula id="pcbi.1004596.e001"><alternatives><graphic id="pcbi.1004596.e001g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e001" xlink:type="simple"/><mml:math display="inline" id="M1" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004596.e002"><alternatives><graphic id="pcbi.1004596.e002g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e002" xlink:type="simple"/><mml:math display="inline" id="M2" overflow="scroll"><mml:mrow><mml:mi>φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>t</italic><sub><italic>n</italic></sub> is the n-th time step and <italic>i</italic> indexes time steps. The ground-truth values are denoted by <italic>l</italic> for radial distance and <italic>φ</italic> for angle and the estimated values are denoted by <inline-formula id="pcbi.1004596.e003"><alternatives><graphic id="pcbi.1004596.e003g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e003" xlink:type="simple"/><mml:math display="inline" id="M3" overflow="scroll"><mml:mover accent="true"><mml:mi>l</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004596.e004"><alternatives><graphic id="pcbi.1004596.e004g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e004" xlink:type="simple"/><mml:math display="inline" id="M4" overflow="scroll"><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. We associate random variables <italic>L</italic><sub><italic>n</italic></sub> and <italic>Φ</italic><sub><italic>n</italic></sub> with the differences <inline-formula id="pcbi.1004596.e005"><alternatives><graphic id="pcbi.1004596.e005g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e005" xlink:type="simple"/><mml:math display="inline" id="M5" overflow="scroll"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>l</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004596.e006"><alternatives><graphic id="pcbi.1004596.e006g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e006" xlink:type="simple"/><mml:math display="inline" id="M6" overflow="scroll"><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> for the time point <italic>t</italic><sub><italic>n</italic></sub>. The variables <italic>L</italic><sub><italic>n</italic></sub> and <italic>Φ</italic><sub><italic>n</italic></sub> form a Brownian motion model, if these differences <inline-formula id="pcbi.1004596.e007"><alternatives><graphic id="pcbi.1004596.e007g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e007" xlink:type="simple"/><mml:math display="inline" id="M7" overflow="scroll"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>l</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004596.e008"><alternatives><graphic id="pcbi.1004596.e008g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e008" xlink:type="simple"/><mml:math display="inline" id="M8" overflow="scroll"><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are normally distributed. In our case, these distances are normally distributed and we associate the following normal distributions with <inline-formula id="pcbi.1004596.e009"><alternatives><graphic id="pcbi.1004596.e009g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e009" xlink:type="simple"/><mml:math display="inline" id="M9" overflow="scroll"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>l</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and with <inline-formula id="pcbi.1004596.e010"><alternatives><graphic id="pcbi.1004596.e010g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e010" xlink:type="simple"/><mml:math display="inline" id="M10" overflow="scroll"><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>φ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>φ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Then, we get <inline-formula id="pcbi.1004596.e011"><alternatives><graphic id="pcbi.1004596.e011g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e011" xlink:type="simple"/><mml:math display="inline" id="M11" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where Var is the statistical variance for these random variables <italic>L</italic><sub><italic>n</italic></sub> and <italic>L</italic><sub><italic>m</italic></sub>. The same applies for the random variables <italic>Φ</italic><sub><italic>n</italic></sub> and <italic>Φ</italic><sub><italic>m</italic></sub>. For our simulation, we used 100 trials to compare the Brownian motion model to the empirical measurements of the quantities of error in estimated distance and error in estimated angle. We measured <italic>μ</italic><sub><italic>l</italic>,<italic>noBias</italic></sub> = −4.07 × 10<sup>−5</sup> <italic>cm</italic> and <italic>σ</italic><sub><italic>l</italic>,<italic>noBias</italic></sub> = 4.49 × 10<sup>−2</sup> <italic>cm</italic>, for the estimate of distance based on linear velocity estimates and bias-free noise. The Brownian motion model fits well with the empirical measurements of radial distance error (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4A</xref>). For the estimate of angle based on rotational velocity and bias-free noise, we measured <italic>μ</italic><sub><italic>φ</italic>,<italic>noBias</italic></sub> = −2.06 × 10<sup>−5</sup> deg and <italic>σ</italic><sub><italic>φ</italic>,<italic>noBias</italic></sub> = 3.59 × 10<sup>−2</sup> deg. The Brownian motion model and empirical measurements of angle error match (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4B</xref>). For the biased noise, we get similar estimates for the radial distance error based on integration of linear velocity. These are <italic>μ</italic><sub><italic>l</italic>,<italic>Bias</italic></sub> = −8.09 × 10<sup>−6</sup> <italic>cm</italic> and <italic>σ</italic><sub><italic>l</italic>,<italic>Bias</italic></sub> = 4.52 × 10<sup>−2</sup> <italic>cm</italic>. The Brownian motion model and estimates match (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4C</xref>). For the biased noise, we measure a bias in the estimates of angle based on rotational velocity as well, we get <italic>μ</italic><sub><italic>φ</italic>,<italic>Bias</italic></sub> = 4.99 × 10<sup>−2</sup> deg and <italic>σ</italic><sub><italic>φ</italic>,<italic>Bias</italic></sub> = 3.60 × 10<sup>−2</sup> deg. In this case, the squared error has the shape of a parabola, which originates from the 2<sup>nd</sup> term in <inline-formula id="pcbi.1004596.e012"><alternatives><graphic id="pcbi.1004596.e012g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e012" xlink:type="simple"/><mml:math display="inline" id="M12" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>φ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>φ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4D</xref>).</p>
<p>In summary, the specific examples shown in <xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4A–4D</xref> demonstrate that in the case of directly integrating linear velocity and rotational velocity, the accumulated error follows a Brownian motion model. However, in the model of position estimation used elsewhere in this paper (other than <xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4A–4D</xref>), the linear and rotational velocities in polar coordinates are transformed into Cartesian coordinates to compute a position estimate (see first line of <xref rid="pcbi.1004596.e039" ref-type="disp-formula">Eq 9</xref>). While noise in the radial distance estimates from linear velocity and angle estimates from rotational velocity adhere to a Brownian motion model, the integrated position estimate in Cartesian coordinates does not because of the coordinate transform from polar coordinates into Cartesian coordinates. Thus, the Euclidean distance error between the temporally integrated estimates based on velocities and ground-truth location does not increase proportional to √t (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4E and 4I</xref>). Instead, the error reaches a plateau of 100 cm Euclidean distance after 10 seconds. The static feature system, similarly reaches errors of up to 100 cm within the first 10 secs (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4F and 4J</xref>). For the biased noise parameterization the moving feature system accumulates errors up to ≈ 200 cm, which is close to the maximum possible error of √2 × 150 cm or 212.13 cm (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4G and 4K</xref>). The error for the static feature system in the biased noise parameterization is very similar to that of the bias-free noise parameterization (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4H and 4L</xref>).</p>
<p>Next, we wanted to study the influence of these errors on the grid cell firing patterns. For this simulation, we used the velocity controlled oscillator model supplied with temporally integrated, estimated velocities or directly with location estimates. We simulated grid cells for 2,500 seconds or 41.7 minutes. Results of grid cell responses using the attractor model [<xref rid="pcbi.1004596.ref018" ref-type="bibr">18</xref>] are qualitatively the same (<xref rid="pcbi.1004596.s002" ref-type="supplementary-material">S2 Fig</xref>). In the attractor models, we provided input consisting of the temporal difference of the sequential locations as a velocity signal input. Notice that in general the broad category of attractor models can work with either position or velocity input, but the particular model [<xref rid="pcbi.1004596.ref018" ref-type="bibr">18</xref>] that we used requires velocities as input. For the bias-free noise the grid patterns are intact for both the moving feature system (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4M</xref>) and for the static feature system (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4N</xref>). For the biased noise, the grid pattern for the moving feature system disappears (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4O</xref>), and the firing pattern would not be considered that of a grid cell. The grid pattern for the static feature system remains intact (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4P</xref>). Thus, the grid cells driven by the static feature system can tolerate more biased noise measured through the SNR than grid cells driven by the moving feature system. We ran simulations to determine the limits of noise tolerance, where we ceased to observe recognizable grid cell spatial firing fields. For the bias-free noise the limits of noise tolerance are <italic>σ</italic><sub><italic>v</italic></sub> ≈ 5 deg/sec for the moving feature system and <italic>σ</italic><sub><italic>l</italic></sub> ≈ 22 deg for the static feature system. For biased noise these limits are <italic>μ</italic><sub><italic>v</italic></sub> ≈ 0.01 deg/sec and <italic>σ</italic><sub><italic>l</italic></sub> ≈ 1.75 deg/sec for the moving feature system and <italic>μ</italic><sub><italic>l</italic></sub> ≈ 15 deg and <italic>σ</italic><sub><italic>l</italic></sub> ≈ 18 deg for the static feature system. These noise limits illustrate the major difference between the moving and static feature system: The moving feature system integrates error over time while the static feature system does not integrate error. The integration of error is especially detrimental to the grid cell firing using estimates of the moving feature system in the case of biased noise (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4O</xref>).</p>
</sec>
</sec>
<sec id="sec005" sec-type="conclusions">
<title>Discussion</title>
<p>Here, we demonstrate how different grid cell modules in entorhinal cortex might be influenced by different mechanisms for the estimation of a rat’s location in an environment based on visual features. The first mechanism uses optic flow (moving feature system) to estimate and integrate self-motion velocities to determine the rat’s allocentric location in an environment. The second mechanism uses visual landmarks (static feature system) to triangulate the rat’s allocentric location in an environment. We use these location estimates as input to a model of grid cell firing to generate firing fields within the environment. In our model, we associate the processing of location based on moving visual features (optic flow) with input to grid cells in dorsal, medial entorhinal cortex—possibly due to stronger input from the dorsal retinotopic areas that code the ventral visual field that contains the ground plane. We associate the processing of location based on static visual features (landmarks) with input to grid cells in more ventral, medial entorhinal cortex (possibly due to stronger input from ventral retinotopic areas that code the dorsal visual field processing wall features). This model with its two mechanisms simulates the absence of compression of the grid cell firing fields recorded in cells of dorsal modules with narrow spacing between the firing fields because the optic flow information does not depend on the compression of barriers. The model also simulates the compression of the grid cell firing fields recorded in more ventral modules with wider spacing between the firing fields because static visual features (landmarks) on the compressed barriers change the sensed location of the rat in the environment. Thus, our model provides an explanation for differences in compression properties of grid cells recorded from different modules in medial entorhinal cortex [<xref rid="pcbi.1004596.ref009" ref-type="bibr">9</xref>].</p>
<p>In our model, we presented the dorsal and ventral module as the two boundary points of a spectrum of possible modules. In the data [<xref rid="pcbi.1004596.ref009" ref-type="bibr">9</xref>] there are intermediate modules that are influenced by wall compression to different extents. Our model could generalize to such intermediate modules using a linear superposition between the location estimates of the moving feature system and the static feature system.</p>
<p>We also studied how noise in visual angle would alter the location coding by the moving feature system and the static feature system. For the moving feature system, we superimposed noise onto the observed velocities in azimuth and elevation angle (<xref rid="pcbi.1004596.e079" ref-type="disp-formula">Eq 19</xref>). This noise leads to a normally distributed error in the estimated linear velocity and rotational velocity. And as this error is integrated in the estimates of radial distance and angle from the linear and rotational velocity, the error in these two dimensions is characterized through a Brownian motion model. Thus, the square distance of the error in estimates is proportional to the time of integration (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4A–4D</xref>). However, when these properties of linear and rotational velocity are transformed from polar coordinates into Cartesian coordinates to define a position estimate (<xref rid="pcbi.1004596.e039" ref-type="disp-formula">Eq 9</xref>), then the build-up over time of position error in Cartesian coordinates is not any more characterized by a Brownian motion model (<xref rid="pcbi.1004596.g004" ref-type="fig">Fig 4E–4H</xref>). For the static feature system, we superimposed noise onto the observed visual angles in azimuth and elevation (<xref rid="pcbi.1004596.e080" ref-type="disp-formula">Eq 20</xref>). Our triangulation method directly estimates the position from these azimuth and elevation angles and no temporal integration occurs for the estimated position. Thus, error does not carry over from one time step to the next and this system is not characterized by a Brownian motion model.</p>
<p>The difference in compression between the moving feature system and the static feature system in these simulations depends entirely on the mechanism computing location using visual features. The chosen grid cell models do not contribute to the presence or to the absence of compression. We added simulations of grid cell models using the location estimates from our model to further visualize the compression on grid cell models and to allow for a direct comparison to compression effects recorded from grid cells.</p>
<p>The simulation results for grid cell models (<xref rid="pcbi.1004596.g003" ref-type="fig">Fig 3</xref>) do not depend on the specific grid cell firing model used. To demonstrate this, we replicated the results from <xref rid="pcbi.1004596.g003" ref-type="fig">Fig 3</xref> by using the attractor model of grid cells [<xref rid="pcbi.1004596.ref018" ref-type="bibr">18</xref>] instead of the velocity controlled oscillator [<xref rid="pcbi.1004596.ref006" ref-type="bibr">6</xref>] (<xref rid="pcbi.1004596.s001" ref-type="supplementary-material">S1 Fig</xref>). Thus, this paper is neutral with regard to the use of grid cell models based on oscillatory interference [<xref rid="pcbi.1004596.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1004596.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1004596.ref017" ref-type="bibr">17</xref>] versus models based on attractor dynamics [<xref rid="pcbi.1004596.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1004596.ref019" ref-type="bibr">19</xref>] or models using both properties [<xref rid="pcbi.1004596.ref020" ref-type="bibr">20</xref>].</p>
<p>Here, we do not focus on a specific neurobiological mechanism for the influence of location or velocity estimates on grid cell firing. In attractor models, the influence of location or velocity is attributed to the influence of conjunctive grid-by-head-direction cells [<xref rid="pcbi.1004596.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1004596.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1004596.ref019" ref-type="bibr">19</xref>]. In velocity controlled oscillator models, the influence of location or velocity is attributed to the influence on oscillator frequency, which alters phase over time. Reset of oscillatory phase based on putative place cell input has been used to model experimental data on compression of grid cell firing fields [<xref rid="pcbi.1004596.ref008" ref-type="bibr">8</xref>] in a hybrid model of attractor dynamics and oscillatory interference [<xref rid="pcbi.1004596.ref020" ref-type="bibr">20</xref>], but that hybrid model did not directly model the role of visual features or the differential effect on different modules.</p>
<p>Formally, publications of the velocity controlled oscillator model [<xref rid="pcbi.1004596.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1004596.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1004596.ref017" ref-type="bibr">17</xref>] include the integration term for the velocity projected onto a basis system of three vectors in a plane, e.g. at 120 degrees angular difference. We separated out this temporal integration (Eqs <xref rid="pcbi.1004596.e073" ref-type="disp-formula">16</xref> and <xref rid="pcbi.1004596.e039" ref-type="disp-formula">9</xref>). For the dorsal grid cells in our model the optic flow signal could either be used as a velocity input or temporally integrated to provide a location input. Our triangulation method provides a location signal (<xref rid="pcbi.1004596.e060" ref-type="disp-formula">Eq 14</xref>) and we assume that the role of grid cells is to form a distributed, error-correcting, representation using this location signal.</p>
<p>Constraints in the environment may favor different methods for the estimation of location on different spatial scales, meaning different spatial distances to features in the box. For instance, during visual navigation, visual features that are close to the animal produce reliable optic flow, because these close features produce large retinal flow vectors, which are less sensitive to noise. It follows that the estimation of translational self-motion is most reliable with sample points near to the animal. In an open field environment, used in studies of grid cells during rat foraging [<xref rid="pcbi.1004596.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1004596.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1004596.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1004596.ref009" ref-type="bibr">9</xref>], such near sample points are located on the ground plane close to the foraging rat. Our model follows this idea and uses optic flow of moving visual features from the ground plane for the estimation of self-motion. In contrast, the estimation of location through triangulation is more reliable for distant, static visual features (landmarks) as the perturbation of distant static features in their location has only a small effect on the visual angle at which these appear. In our simulations, our static feature system uses landmarks on barriers for triangulation, and these landmarks appear mostly as distant from the rat.</p>
<p>This description raises the interesting possibility that the difference in coding within dorsal versus ventral medial entorhinal cortex corresponds to coding of different components of the visual field. The visual cortical areas on the dorsal surface of the rodent brain show retinotopic mapping [<xref rid="pcbi.1004596.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1004596.ref014" ref-type="bibr">14</xref>], and it is possible that a similar retinotopic mapping may map the dorsal portions of the retina to the dorsal portions of the medial entorhinal cortex. Due to the inversion of visual images in the eye, the dorsal retina would respond more to the ventral visual field or ground plane near the animal. Thus, the dorsal portions of medial entorhinal cortex may respond to feature locations on the ground near the animal, which are less likely to be affected by barrier location. Similarly, in this framework, the ventral portions of the retina might be mapped to more ventral portions of the medial entorhinal cortex. The ventral retina would respond to more dorsal portions of the visual field that would include elevated features on barriers. Thus, the ventral portions of medial entorhinal cortex might respond to feature locations on the distant barriers, and therefore be more sensitive to the location of such barriers. These effects of retinotopic input to medial entorhinal cortex could underlie the differential coding of a moving feature system for dorsal regions and static feature system for ventral regions. If this is the case, it could also be interpreted that static visual features are used for location estimation in all portions of the visual field. The difference in compression seen for grid cells in different modules might arise because visual features on the ground are not altered by the movement of the barriers. This could be tested by adding visual features on the ground (markings) and experimentally compressing the location of these visual features on the ground to determine if this could cause compression in the dorsal grid cells appearing as narrower spacing between their firing fields.</p>
<p>Consistent with the above proposal, recent data from rodents shows that responses of different visual regions are restricted to specific portions of the visual field [<xref rid="pcbi.1004596.ref014" ref-type="bibr">14</xref>]. Area RL in the rodent responds to the ventral visual field (ground plane), whereas area LM responds to the dorsal visual field (where distal barriers would appear). In addition, anatomical data shows selectivity in the connections from these visual regions to the dorsal entorhinal cortex [<xref rid="pcbi.1004596.ref012" ref-type="bibr">12</xref>]. In that paper, one figure showing the spread of anterograde tracers from areas AL/RL indicates projections to dorsal MEC, while another figure shows that area LM does not project to dorsal MEC [<xref rid="pcbi.1004596.ref012" ref-type="bibr">12</xref>].</p>
<p>During the course of the development of these simulations, a number of different mechanisms were tested before it was found that the best match to experimental data [<xref rid="pcbi.1004596.ref009" ref-type="bibr">9</xref>] was obtained with the specific mechanism using a compression factor for the location computation using opposite walls. Alternate mechanisms, like triangulation without regularization or triangulation using individual pairs of static visual features from the same barrier did not match the compression effects seen in the data. Though smaller scales of compression could be obtained, these alternate mechanisms could not achieve the 90% compression necessary to match the data [<xref rid="pcbi.1004596.ref009" ref-type="bibr">9</xref>]. To get large scale compression, it was necessary to use the framework of a compression factor dependent upon individual static features mapped on opposite barriers. This representation of features on barriers could be partly due to the maintenance of a boundary cell response even when an animal turns away from the barrier—so it could look at one barrier and then maintain that boundary cell response when viewing a different barrier. This capacity to maintain a working memory of static visual features could depend upon intrinsic mechanisms for persistent spiking observed in neurons of medial entorhinal cortex [<xref rid="pcbi.1004596.ref021" ref-type="bibr">21</xref>, <xref rid="pcbi.1004596.ref022" ref-type="bibr">22</xref>, <xref rid="pcbi.1004596.ref023" ref-type="bibr">23</xref>].</p>
<p>The rodent visual system also has regions that respond differentially to the nature of visual input, with some regions responding more strongly to high temporal frequency (moving stimuli) with low spatial frequency (e.g. area AM), and others responding more to low temporal frequency (more static stimuli) with higher spatial frequency (e.g. area PM), and along this continuum other areas show differences in response to temporal and spatial frequency (e.g. AL, RL, LM) [<xref rid="pcbi.1004596.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1004596.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1004596.ref013" ref-type="bibr">13</xref>, <xref rid="pcbi.1004596.ref024" ref-type="bibr">24</xref>, <xref rid="pcbi.1004596.ref025" ref-type="bibr">25</xref>]. These responses might indicate differential processing in different rodent visual systems in a manner similar to the distinction between the “where” and “what” pathways described extensively for the dorsal and ventral streams of the primate cortex [<xref rid="pcbi.1004596.ref015" ref-type="bibr">15</xref>]. Note that the primate extrastriate visual cortex contains regions that explicitly respond to the self-motion indicated by optic flow. Thus, visual areas in rodent might have some features analogous to the primate regions [<xref rid="pcbi.1004596.ref026" ref-type="bibr">26</xref>–<xref rid="pcbi.1004596.ref028" ref-type="bibr">28</xref>]. In particular, neurons in primates were shown to be responsive to the pattern flow caused by two components [<xref rid="pcbi.1004596.ref029" ref-type="bibr">29</xref>], and a small number of neurons in area AL and RL of rodents show similar motion selectivity [<xref rid="pcbi.1004596.ref030" ref-type="bibr">30</xref>]. Our simulations suggest that this distinction might correspond to differential mechanisms of processing in the dorsal medial entorhinal cortex versus the ventral medial entorhinal cortex. Our model links the processing of optic flow to the dorsal medial entorhinal cortex and the processing of landmarks to the ventral medial entorhinal cortex. Notice that the distinction between the dorsal and ventral streams in the primate cortex involves many more functional regions and has not been applied to entorhinal cortex.</p>
<p>Previous discussions of “where” vs. “what” pathways in the entorhinal cortex have focused on the notion that the “where” pathway would involve input from postrhinal cortex to medial entorhinal cortex and the “what” pathway would involve input from perirhinal cortex to lateral entorhinal cortex [<xref rid="pcbi.1004596.ref031" ref-type="bibr">31</xref>, <xref rid="pcbi.1004596.ref032" ref-type="bibr">32</xref>]. Consistent with this, experimental data, selectivity for objects appears in lateral entorhinal cortex [<xref rid="pcbi.1004596.ref033" ref-type="bibr">33</xref>]. Previous studies showed stronger visual input to medial entorhinal cortex compared to lateral entorhinal cortex in the rat [<xref rid="pcbi.1004596.ref034" ref-type="bibr">34</xref>], but surprisingly recent analysis of network anatomical interactions in mice suggest equal ventral stream “what” input to lateral and medial entorhinal cortex with stronger “where” input to lateral entorhinal cortex [<xref rid="pcbi.1004596.ref025" ref-type="bibr">25</xref>].</p>
<p>The distinction between lateral, representing the “what”, and medial entorhinal cortex, representing the “where”, is a hypothesis that has not yet been fully tested. However, we would like to note that the evaluation of differences between lateral and medial entorhinal cortex is a separate issue from our proposal of differences between coding in dorsal versus ventral portions of medial entorhinal cortex. Lateral entorhinal cortex is not addressed in our simulations. Our simulations instead focus on the potential interest in analyzing differences in the inputs to the dorsal and ventral portions of medial entorhinal cortex itself, as these may differ. These inputs may differ in the amount of input from different visual regions coding moving versus static visual features [<xref rid="pcbi.1004596.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1004596.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1004596.ref024" ref-type="bibr">24</xref>, <xref rid="pcbi.1004596.ref030" ref-type="bibr">30</xref>]. As an additional possibility, anatomical data consistently shows that the visual regions in the rodent show selective retinotopic mapping within each visual region [<xref rid="pcbi.1004596.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1004596.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1004596.ref014" ref-type="bibr">14</xref>]. Our simulations may indicate that this differential mapping of different portions of the visual field may extend to influence the nature of processing in different portions of the medial entorhinal cortex.</p>
</sec>
<sec id="sec006" sec-type="materials|methods">
<title>Methods</title>
<p>Our model has two functionally different streams, which consist of a moving feature system and a static feature system (see <xref rid="pcbi.1004596.g001" ref-type="fig">Fig 1</xref>). As input to these systems, we simulated the visual input that would be viewed by a rat on a synthesized, random trajectory. This visual input used a simplified ray-tracer and a spherical camera model. In the moving feature system, visual motion is processed in the form of optic flow. This optic flow information is used to estimate the linear and rotational velocity of the rat. An integration of these velocity estimates results in a location estimate. In the static feature system of our model, visual landmarks are processed. We used these landmarks to estimate the location of self through triangulation. The estimated location information from both streams is forwarded to a model for grid cell firing in the entorhinal cortex. For this example, we used the oscillatory interference model for simplicity, but similar effects could be obtained with most other types of grid cell models such as an attractor model of grid cells (<xref rid="pcbi.1004596.s001" ref-type="supplementary-material">S1 Fig</xref>). We summarized all model parameters in <xref rid="pcbi.1004596.t001" ref-type="table">Table 1</xref>. A Matlab implementation of the model including the capability to simulate the visual input is provided through <xref rid="pcbi.1004596.s003" ref-type="supplementary-material">S1 File</xref>.</p>
<table-wrap id="pcbi.1004596.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004596.t001</object-id>
<label>Table 1</label> <caption><title>Default parameter values for the synthesized trajectories, spherical camera model, and module model.</title> <p>Some simulations have changed parameter values and we denoted this explicitly.</p></caption>
<alternatives>
<graphic id="pcbi.1004596.t001g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.t001" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">Description of parameter</th>
<th align="left" rowspan="1" colspan="1">Identifier and value</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="2" align="center" rowspan="1">Synthesized trajectories inside a cube</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Number of samples</td>
<td align="left" rowspan="1" colspan="1"><italic>n</italic><sub><italic>Sample</italic></sub> = 50,000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Sampling frequency</td>
<td align="left" rowspan="1" colspan="1"><italic>f</italic><sub><italic>Sample</italic></sub> = 20 Hz</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Duration of the simulated time</td>
<td align="left" rowspan="1" colspan="1"><italic>T</italic> = 41.67 min</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Peak location <italic>β</italic><sub><italic>v</italic></sub> of the Rayleigh distribution</td>
<td align="left" rowspan="1" colspan="1"><italic>β</italic><sub><italic>v</italic></sub> ≈ 13 cm/sec</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mean of the normal distribution</td>
<td align="left" rowspan="1" colspan="1"><italic>μ</italic><sub><italic>ω</italic></sub> ≈ 0 deg/sec</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Standard deviation of the normal distribution</td>
<td align="left" rowspan="1" colspan="1"><italic>σ</italic><sub><italic>ω</italic></sub> ≈ 340 deg/sec</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Width and length of the square environment</td>
<td align="left" rowspan="1" colspan="1"><italic>w</italic><sub><italic>Cube</italic></sub> = <italic>l</italic><sub><italic>Cube</italic></sub> = 150 cm</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Height of walls</td>
<td align="left" rowspan="1" colspan="1"><italic>h</italic><sub><italic>Cube</italic></sub> = 50 cm</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Eye-height above ground</td>
<td align="left" rowspan="1" colspan="1"><italic>d</italic> = 2.5 cm</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Number of visual features on ground, walls, and ceiling</td>
<td align="left" rowspan="1" colspan="1"><italic>n</italic><sub><italic>Features</italic></sub> = 54</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Number of samples on the ground</td>
<td align="left" rowspan="1" colspan="1"><italic>n</italic><sub><italic>Ground</italic></sub> = 9</td>
</tr>
<tr>
<td colspan="2" align="center" rowspan="1">Spherical camera model</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Horizontal field of view</td>
<td align="left" rowspan="1" colspan="1"><italic>h</italic><sub><italic>FoV</italic></sub> = 360 deg</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Vertical field of view</td>
<td align="left" rowspan="1" colspan="1"><italic>v</italic><sub><italic>FoV</italic></sub> = 120 deg</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Focal length</td>
<td align="left" rowspan="1" colspan="1"><italic>f</italic><sub><italic>Sphere</italic></sub> = 1 cm</td>
</tr>
<tr>
<td colspan="2" align="center" rowspan="1">Module model</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Initial head direction</td>
<td align="left" rowspan="1" colspan="1"><italic>φ</italic><sub><italic>0</italic></sub> = 0 deg</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Initial location</td>
<td align="left" rowspan="1" colspan="1">(<italic>x</italic><sub><italic>0</italic></sub>,<italic> y</italic><sub><italic>0</italic></sub>) = (0 cm, 0 cm)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Regularization parameter</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> = 10<sup>−4</sup></td>
</tr>
<tr>
<td colspan="2" align="center" rowspan="1">Velocity controlled oscillator model</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Oscillation of theta rhythm</td>
<td align="left" rowspan="1" colspan="1"><italic>f</italic> = 7.38 Hz</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Parameter for grid spacing–moving feature system</td>
<td align="left" rowspan="1" colspan="1"><italic>β</italic><sub><italic>1</italic></sub> = 0.004</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Parameter for grid spacing–static feature system</td>
<td align="left" rowspan="1" colspan="1"><italic>β</italic><sub><italic>2</italic></sub> = 0.003</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Threshold for spikes</td>
<td align="left" rowspan="1" colspan="1"><italic>ϴ</italic> = 1.8</td>
</tr>
<tr>
<td colspan="2" align="center" rowspan="1">Attractor model</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Horizontal cells</td>
<td align="left" rowspan="1" colspan="1"><italic>n</italic><sub><italic>x</italic></sub> = 9</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Vertical cells</td>
<td align="left" rowspan="1" colspan="1"><italic>n</italic><sub><italic>y</italic></sub> = 10</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Synaptic peak strength</td>
<td align="left" rowspan="1" colspan="1"><italic>I</italic> = 0.3</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Inhibition for weights</td>
<td align="left" rowspan="1" colspan="1"><italic>T</italic> = 0.05</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Input gain (grid spacing)–moving feature system</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic><sub><italic>1</italic></sub> = 1.4×10<sup>−3</sup></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Input gain (grid spacing)–static feature system</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic><sub><italic>2</italic></sub> = 0.9×10<sup>−3</sup></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Gaussian standard deviation</td>
<td align="left" rowspan="1" colspan="1"><italic>σ</italic> = 0.24 meters</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Grid orientation</td>
<td align="left" rowspan="1" colspan="1"><italic>γ</italic> = 0°</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Threshold for firing</td>
<td align="left" rowspan="1" colspan="1"><italic>η</italic> = 0.1</td>
</tr>
<tr>
<td colspan="2" align="center" rowspan="1">Simulations</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Standard deviation of velocity noise</td>
<td align="left" rowspan="1" colspan="1"><italic>σ</italic><sub><italic>v</italic></sub> in units of deg/sec</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Standard deviation of location noise</td>
<td align="left" rowspan="1" colspan="1"><italic>σ</italic><sub><italic>l</italic></sub> in units of deg/sec</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mean of velocity noise</td>
<td align="left" rowspan="1" colspan="1"><italic>μ</italic><sub><italic>v</italic></sub> in units of deg/sec</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mean of location noise</td>
<td align="left" rowspan="1" colspan="1"><italic>μ</italic><sub><italic>l</italic></sub> in units of deg/sec</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<sec id="sec007">
<title>Synthesized rat trajectories inside a box</title>
<p>We simulated the rat movement within a box that has two configurations. In configuration A the box has the dimensions 150 cm × 150 cm and in configuration B the box has been altered by moving barriers to have the dimensions 150 cm × 100 cm. Barriers are 50 cm high. On the ground, ceiling, and the four barriers or side-walls, we randomly distributed 9 features per surface. In total, there are <italic>n</italic><sub><italic>Features</italic></sub> = 9 × 6 = 54 features. Due to the limited field of view of the rat of 120 deg vertically, not all these features are visible at all times. To guarantee that features from both barrier pairs are available to the rat, we assumed that the angles of these features are available as input for 360 deg, horizontally. This can be achieved, e.g., through updating of short term memory for feature angle based on subsequent turns of the head. For example, a feature viewed at 90 degrees could be maintained in short term memory and updated by a subsequent 90 degree head turn, so that the animal still has knowledge about the features at 180 degrees.</p>
<p>We synthesized rat trajectories based on the movement statistics of recorded rat trajectories [<xref rid="pcbi.1004596.ref035" ref-type="bibr">35</xref>, <xref rid="pcbi.1004596.ref036" ref-type="bibr">36</xref>, <xref rid="pcbi.1004596.ref037" ref-type="bibr">37</xref>]. We modeled the movement statistics by fitting forward linear speeds (along the optical axis) through a Rayleigh distribution, which gave the peak location <italic>β</italic><sub><italic>v</italic></sub> = 13.25 cm/sec. In addition, we fitted rotational yaw-speeds by a normal distribution, which gave the mean <italic>μ</italic><sub><italic>ω</italic></sub> = 0°/sec and standard deviation (STD) <italic>σ</italic><sub><italic>ω</italic></sub> = 337.93°/sec [<xref rid="pcbi.1004596.ref038" ref-type="bibr">38</xref>; their <xref rid="pcbi.1004596.g002" ref-type="fig">Fig 2</xref>]. We used these distributions to draw samples for linear and rotational speeds, respectively, for all 50,000 sample points. When no collision with a barrier occurs, translational and rotational speeds were selected from generated data. A collision occurs if the simulated rat is within 15 cm distance of the closest barrier and the angular difference between the direction of travel and the normal direction of the “facing” planar barrier is smaller than 90 deg. Then, we use the following two-step maneuver for collision avoidance. First, we reduced the speed by half of the difference between the current speed and the minimal speed, which is 5 cm/sec. Second, we rotated away from the barrier that poses a collision threat. The rotation angle is the angle between the direction of travel and the normal direction of the planar barrier that poses a collision threat. To avoid periodic turning in corners, we added a randomized rotation value to the rotation angle. For the synthesized trajectory of the box in configuration A we measured <italic>β</italic><sub><italic>v</italic></sub><sup><italic>m</italic></sup> = 13.17 cm/sec and <italic>σ</italic><sub><italic>ω</italic></sub><sup><italic>m</italic></sup> = 342.49 deg/sec and in configuration B we measured <italic>β</italic><sub><italic>v</italic></sub><sup><italic>m</italic></sup> = 13.14 cm/sec and <italic>σ</italic><sub><italic>ω</italic></sub><sup><italic>m</italic></sup> = 357.07 deg/sec. All fitted values are close to the values of recorded rat trajectories, which are <italic>β</italic><sub><italic>v</italic></sub> = 13.25 cm/sec and <italic>σ</italic><sub><italic>ω</italic></sub> = 337.93°/sec.</p>
</sec>
<sec id="sec008">
<title>Estimation of self-motion from image velocities</title>
<p>In these simulations, there were two methods of estimating location, proposed to represent differences in neural properties of the different modules in entorhinal cortex. These two methods consist of either estimating location from image feature velocities (optic flow) in our moving feature system or from triangulation of image features in our static feature system. The exact biological mechanism of these differences between modules are not explicitly modeled, but they could arise from the nature of the regions providing input to different modules, or possibly from other factors such as the location of features in the visual field or the spatial distance of the input features.</p>
<p>In this section, we describe the first method (the moving feature system), which estimated location based on self-motion from image velocities, that is, from the movement of visual features. All features on the surfaces of the box are described by their 3D point locations. The 3D point locations <inline-formula id="pcbi.1004596.e013"><alternatives><graphic id="pcbi.1004596.e013g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e013" xlink:type="simple"/><mml:math display="inline" id="M13" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are described by the azimuth <italic>θ</italic><sub><italic>j</italic></sub> and elevation <italic>ϕ</italic><sub><italic>j</italic></sub> coordinates using
<disp-formula id="pcbi.1004596.e014">
<alternatives>
<graphic id="pcbi.1004596.e014g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e014" xlink:type="simple"/>
<mml:math display="block" id="M14" overflow="scroll">
<mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>arctan</mml:mtext><mml:mspace width="0.15em"/><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>arctan</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1.5em"/><mml:mtext>for</mml:mtext><mml:mspace width="1.6em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>…</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula></p>
<p>These angles <italic>θ</italic><sub><italic>j</italic></sub> and <italic>ϕ</italic><sub><italic>j</italic></sub> are invariant to the distance of the sample point. Each of these visible features introduces an image velocity defined by the angular velocity for the azimuth angle <inline-formula id="pcbi.1004596.e015"><alternatives><graphic id="pcbi.1004596.e015g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e015" xlink:type="simple"/><mml:math display="inline" id="M15" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and the angular velocity for the elevation angle <inline-formula id="pcbi.1004596.e016"><alternatives><graphic id="pcbi.1004596.e016g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e016" xlink:type="simple"/><mml:math display="inline" id="M16" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, assuming that the rat moves with the linear velocity <inline-formula id="pcbi.1004596.e017"><alternatives><graphic id="pcbi.1004596.e017g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e017" xlink:type="simple"/><mml:math display="inline" id="M17" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and rotational velocity <inline-formula id="pcbi.1004596.e018"><alternatives><graphic id="pcbi.1004596.e018g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e018" xlink:type="simple"/><mml:math display="inline" id="M18" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>ω</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. To derive the model for the image velocity, we assumed a spherical camera model. This spherical camera model with the radius <italic>f</italic><sub><italic>Sphere</italic></sub>, projects 3D point locations <inline-formula id="pcbi.1004596.e019"><alternatives><graphic id="pcbi.1004596.e019g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e019" xlink:type="simple"/><mml:math display="inline" id="M19" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> onto the spherical surface locations <inline-formula id="pcbi.1004596.e020"><alternatives><graphic id="pcbi.1004596.e020g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e020" xlink:type="simple"/><mml:math display="inline" id="M20" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> using the model equation:
<disp-formula id="pcbi.1004596.e021">
<alternatives>
<graphic id="pcbi.1004596.e021g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e021" xlink:type="simple"/>
<mml:math display="block" id="M21" overflow="scroll">
<mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>p</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.5em"/><mml:mtext>with</mml:mtext><mml:mspace width="0.5em"/><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p>Assuming instantaneous motion for the self-motion, the movement of the sampled point locations <inline-formula id="pcbi.1004596.e022"><alternatives><graphic id="pcbi.1004596.e022g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e022" xlink:type="simple"/><mml:math display="inline" id="M22" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is modeled by <inline-formula id="pcbi.1004596.e023"><alternatives><graphic id="pcbi.1004596.e023g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e023" xlink:type="simple"/><mml:math display="inline" id="M23" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mi>ω</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> [<xref rid="pcbi.1004596.ref039" ref-type="bibr">39</xref>]. In addition, we use the spherical coordinates
<disp-formula id="pcbi.1004596.e024">
<alternatives>
<graphic id="pcbi.1004596.e024g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e024" xlink:type="simple"/>
<mml:math display="block" id="M24" overflow="scroll">
<mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>p</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.1em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.1em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.1em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.1em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.1em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
with the z-axis pointing along the direction of travel. Note, that this z-axis is typical in computer vision research, but it contrasts with the usual direction of the z-axis in describing rat behavioral data during grid cell firing, in which the z-axis is the direction orthogonal to the ground-plane.</p>
<p>Calculating the temporal differential for <xref rid="pcbi.1004596.e021" ref-type="disp-formula">Eq 2</xref> allows us to plug in the instantaneous motion model <inline-formula id="pcbi.1004596.e025"><alternatives><graphic id="pcbi.1004596.e025g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e025" xlink:type="simple"/><mml:math display="inline" id="M25" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Then, we use <xref rid="pcbi.1004596.e024" ref-type="disp-formula">Eq 3</xref> and calculate the temporal differentials to link the result to the angular velocities. The two resulting equations are relate to each other through the common expression <inline-formula id="pcbi.1004596.e026"><alternatives><graphic id="pcbi.1004596.e026g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e026" xlink:type="simple"/><mml:math display="inline" id="M26" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Solving for the angular velocities, we get the model equation [<xref rid="pcbi.1004596.ref038" ref-type="bibr">38</xref>]
<disp-formula id="pcbi.1004596.e027">
<alternatives>
<graphic id="pcbi.1004596.e027g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e027" xlink:type="simple"/>
<mml:math display="block" id="M27" overflow="scroll">
<mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula></p>
<p>As simplifications, we assume that the rat looks straight forward, tangent to the running direction, thus, <italic>v</italic><sub><italic>x</italic></sub> = 0 cm/sec and <italic>v</italic><sub><italic>y</italic></sub> = 0 cm/sec, and we assume that the rat undergoes neither pitch nor roll rotations, thus, <italic>ω</italic><sub><italic>x</italic></sub> = 0 deg/sec and <italic>ω</italic><sub><italic>y</italic></sub> = 0 deg/sec.</p>
<p>In addition to these properties, we assume that all computation of image velocities in the moving feature system originate from features on the ground plane, which we propose may be the primary input for certain modules in entorhinal cortex. These features can be described through the plane equation (<italic>n</italic><sub><italic>x</italic></sub>, <italic>n</italic><sub><italic>y</italic></sub>, <italic>n</italic><sub><italic>z</italic></sub>)(<italic>X</italic><sub><italic>i</italic></sub>, <italic>Y</italic><sub><italic>i</italic></sub>, <italic>Z</italic><sub><italic>i</italic></sub>)<sup><italic>T</italic></sup> − <italic>d</italic> = 0 with the normal vector (<italic>n</italic><sub><italic>x</italic></sub>, <italic>n</italic><sub><italic>y</italic></sub>, <italic>n</italic><sub><italic>z</italic></sub>) the point location (<italic>X</italic><sub><italic>i</italic></sub>, <italic>Y</italic><sub><italic>i</italic></sub>, <italic>Z</italic><sub><italic>i</italic></sub>) and the distance <italic>d</italic> from the origin measured along the normal direction. We use the uppercase <italic>T</italic> in the super-script as transpose operator. Using <xref rid="pcbi.1004596.e021" ref-type="disp-formula">Eq 2</xref> and <xref rid="pcbi.1004596.e024" ref-type="disp-formula">Eq 3</xref> we find the following expression for the distance
<disp-formula id="pcbi.1004596.e028">
<alternatives>
<graphic id="pcbi.1004596.e028g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e028" xlink:type="simple"/>
<mml:math display="block" id="M28" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula></p>
<p>Plugging in the simplifications, we got the model for spherical image velocities given curvilinear motion above a ground plane as
<disp-formula id="pcbi.1004596.e029">
<alternatives>
<graphic id="pcbi.1004596.e029g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e029" xlink:type="simple"/>
<mml:math display="block" id="M29" overflow="scroll">
<mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mspace width="0.15em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula></p>
<p>We assume that the sensed image velocity or optic flow is defined by the variables <inline-formula id="pcbi.1004596.e030"><alternatives><graphic id="pcbi.1004596.e030g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e030" xlink:type="simple"/><mml:math display="inline" id="M30" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> for the azimuth angle and <inline-formula id="pcbi.1004596.e031"><alternatives><graphic id="pcbi.1004596.e031g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e031" xlink:type="simple"/><mml:math display="inline" id="M31" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> for the elevation angle and is given. In addition, the height <italic>d</italic> of the rat’s eyes off the ground is also given. Then, we want to estimate the unknown linear velocity <italic>v</italic><sub><italic>z</italic></sub> and rotational velocity <italic>ω</italic><sub><italic>y</italic></sub>. We use a least squares approach to define the optimization problem
<disp-formula id="pcbi.1004596.e032">
<alternatives>
<graphic id="pcbi.1004596.e032g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e032" xlink:type="simple"/>
<mml:math display="block" id="M32" overflow="scroll">
<mml:mrow><mml:msub><mml:mrow><mml:mtext>arg min</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msub><mml:munder><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mspace width="0.15em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mo>=</mml:mo><mml:mo>:</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
with the functional <italic>F</italic>. We calculate the extremal value for this functional <italic>F</italic>, which are given by the solution to the linear equation system
<disp-formula id="pcbi.1004596.e033">
<alternatives>
<graphic id="pcbi.1004596.e033g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e033" xlink:type="simple"/>
<mml:math display="block" id="M33" overflow="scroll">
<mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ω</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2em"/><mml:mtext>with</mml:mtext></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
<disp-formula id="pcbi.1004596.e034">
<alternatives>
<graphic id="pcbi.1004596.e034g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e034" xlink:type="simple"/>
<mml:math display="block" id="M34" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>d</mml:mi></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mtext>tan</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:msup><mml:mrow><mml:mtext>sin</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mtext>sin</mml:mtext></mml:mrow><mml:mn>4</mml:mn></mml:msup><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:msup><mml:mrow><mml:mtext>cos</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mspace width="0.15em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e035">
<alternatives>
<graphic id="pcbi.1004596.e035g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e035" xlink:type="simple"/>
<mml:math display="block" id="M35" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mtext>tan</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle><mml:mspace width="2em"/><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e036">
<alternatives>
<graphic id="pcbi.1004596.e036g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e036" xlink:type="simple"/>
<mml:math display="block" id="M36" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>tan</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:msup><mml:mrow><mml:mtext>sin</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.15em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mspace width="0.15em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>n</italic><sub><italic>Ground</italic></sub> refers to the number of all visible features on the ground and the index <italic>i</italic> ranges over all these features. The inverse of matrix A is defined for non-degenerated cases, e.g. <italic>ϕ</italic><sub><italic>i</italic></sub> = 0. We use the solution of <xref rid="pcbi.1004596.e033" ref-type="disp-formula">Eq 8</xref> to estimate the linear velocity and rotational yaw-velocity.</p>
<p>For a location estimate, we temporally integrated estimates of the linear and rotational velocity. For a time discrete sampling, we defined the estimated linear velocities by <inline-formula id="pcbi.1004596.e037"><alternatives><graphic id="pcbi.1004596.e037g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e037" xlink:type="simple"/><mml:math display="inline" id="M37" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and the estimated rotational velocities by <inline-formula id="pcbi.1004596.e038"><alternatives><graphic id="pcbi.1004596.e038g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e038" xlink:type="simple"/><mml:math display="inline" id="M38" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ω</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> where <italic>j</italic> indexes the sampled time in steps of ∆t = 0.05 sec or <italic>f</italic><sub><italic>Sample</italic></sub> = 20 Hz. We calculated the estimated location in the ground-plane through the x-coordinate and y-coordinates by
<disp-formula id="pcbi.1004596.e039">
<alternatives>
<graphic id="pcbi.1004596.e039g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e039" xlink:type="simple"/>
<mml:math display="block" id="M39" overflow="scroll">
<mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.15em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>φ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle><mml:mspace width="0.5em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.5em"/><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>φ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle><mml:mspace width="0.5em"/><mml:mtext>for</mml:mtext></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
<disp-formula id="pcbi.1004596.e040">
<alternatives>
<graphic id="pcbi.1004596.e040g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e040" xlink:type="simple"/>
<mml:math display="block" id="M40" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>ω</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>φ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The values <italic>x</italic><sub><italic>0</italic></sub>, <italic>y</italic><sub><italic>0</italic></sub>, and <italic>φ</italic><sub><italic>0</italic></sub> denote the initial location of the rat and its initial head direction, respectively.</p>
</sec>
<sec id="sec009">
<title>Estimation of location through regularized triangulation</title>
<p>The second method of location estimation (the static feature system) uses a regularized triangulation based on visual features. This method can model the proportional compression of the estimated location in the ground plane according to the shift of features on the side walls. For regularization, we used the constraint of a fixed, known width <italic>W</italic> and fixed, known length <italic>L</italic> of the box. We used trigonometric constraints to express this length and width of the box using all pair-wise sample points from opponent walls (<xref rid="pcbi.1004596.g005" ref-type="fig">Fig 5</xref>). The unknown intersection point is defined by (<italic>x</italic><sub><italic>s</italic></sub>, <italic>y</italic><sub><italic>s</italic></sub>) and the memorized locations are defined by (<italic>x</italic><sub><italic>k</italic></sub>, <italic>y</italic><sub><italic>k</italic></sub>), (<italic>x</italic><sub><italic>l</italic></sub>, <italic>y</italic><sub><italic>l</italic></sub>), (<italic>x</italic><sub><italic>μ</italic></sub>, <italic>y</italic><sub><italic>μ</italic></sub>), or (<italic>x</italic><sub><italic>ν</italic></sub>, <italic>y</italic><sub><italic>ν</italic></sub>) for the northern, southern, western, or eastern wall, respectively. We used four indices to refer to the sampled features on the four walls. We indexed sampled features on the northern wall by <italic>k</italic>, features on the southern wall by <italic>l</italic>, features on the western wall by <italic>μ</italic>, and features on the eastern wall by <italic>ν</italic>. We used the sub-script <italic>k˄l</italic> to index all features from the northern and southern wall and we used the sub-script <italic>μ˄ν</italic> to index all features from the western and eastern wall. In contrast, we indexed all pairs of sampled features from the northern and southern wall by the sub-script <italic>k</italic>,<italic>l</italic> and for all pairs of sampled features on the western and eastern wall by the sub-script <italic>μ</italic>,<italic>ν</italic>.</p>
<fig id="pcbi.1004596.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004596.g005</object-id>
<label>Fig 5</label> 
<caption>
<title>Shows the geometric constraints of the model for the static feature system.</title>
<p>(A) Constraint for features sampled on northern or southern wall. (B) Constraint for features sampled on western or eastern wall.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.g005" position="float" xlink:type="simple"/>
</fig>
<p>To match the observed, azimuth angles for the sample points defined in <xref rid="pcbi.1004596.e014" ref-type="disp-formula">Eq 1</xref> with the defined angles <italic>θ</italic><sub><italic>k</italic></sub>, <italic>θ</italic><sub><italic>l</italic></sub>, <italic>θ</italic><sub><italic>µ</italic></sub>, and <italic>θ</italic><sub><italic>ν</italic></sub> (compare with <xref rid="pcbi.1004596.g005" ref-type="fig">Fig 5</xref>) we have to use the following transformations <italic>θ</italic><sub><italic>k</italic></sub> = <italic>θ</italic><sub><italic>i</italic></sub> ∧ <italic>i</italic> ∈ <italic>S</italic><sub><italic>N</italic></sub>, <italic>θ</italic><sub><italic>l</italic></sub> = −<italic>θ</italic><sub><italic>i</italic></sub> ∧ <italic>i</italic> ∈ <italic>S</italic><sub><italic>S</italic></sub>, <italic>θμ</italic> = <italic>θ</italic><sub><italic>i</italic></sub> – <italic>π</italic>/2 ∧ <italic>i</italic> ∈ <italic>S</italic><sub><italic>W</italic></sub>, and <italic>θ</italic><sub><italic>ν</italic></sub> = −<italic>θ</italic><sub><italic>i</italic></sub> – <italic>π</italic>/2 ∧ <italic>i</italic> ∈ <italic>S</italic><sub><italic>E</italic></sub>. The identifiers <italic>S</italic><sub><italic>N</italic></sub>, <italic>S</italic><sub><italic>S</italic></sub>, <italic>S</italic><sub><italic>W</italic></sub>, and <italic>S</italic><sub><italic>E</italic></sub> denote sets of indices for sampled points on the northern, southern, western, and eastern wall, respectively.</p>
<p>We introduce the two compression variables <italic>η</italic> and <italic>ξ</italic> for the compression in the x-dimension and the y-dimension, respectively (<xref rid="pcbi.1004596.g005" ref-type="fig">Fig 5</xref>). Taking an arbitrary point pair from the northern and southern wall, we get the following constraint
<disp-formula id="pcbi.1004596.e041">
<alternatives>
<graphic id="pcbi.1004596.e041g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e041" xlink:type="simple"/>
<mml:math display="block" id="M41" overflow="scroll">
<mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.15em"/><mml:mtext>tan</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.15em"/><mml:mtext>tan</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ξ</mml:mi><mml:mspace width="0.1em"/><mml:mi>L</mml:mi><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula></p>
<p>This constraint <xref rid="pcbi.1004596.e041" ref-type="disp-formula">Eq 10</xref> uses the two triangles that are defined through the corner locations (<italic>x</italic><sub><italic>s</italic></sub>, <italic>y</italic><sub><italic>s</italic></sub>) and the two feature locations (<italic>x</italic><sub><italic>k</italic></sub>, <italic>y</italic><sub><italic>k</italic></sub>) and (<italic>x</italic><sub><italic>l</italic></sub>, <italic>y</italic><sub><italic>l</italic></sub>) and their observed angles <italic>θ</italic><sub><italic>k</italic></sub> and <italic>θ</italic><sub><italic>k</italic></sub>. The constraint for the western and eastern wall is analogously defined. Based on the observed angles, the length of the box may appear as shorter than the triangulation of the memorized locations suggest. This deflection between observed angles and memorized locations is modeled through the compression factor 0 &lt; <italic>ξ</italic> ≤ 1. In all cases, we assume that the observed feature locations that are described by the angle <italic>θ</italic> have been re-referenced to an allocentric system using the initial head direction <italic>φ</italic><sub><italic>0</italic></sub>.</p>
<p>The next constraint is the triangulation constraint. For this constraint, we denote the unknown length toward a sampled feature location by <italic>λ</italic>. When taking the compression variables into account, we get the following equations for each sampled feature:
<disp-formula id="pcbi.1004596.e042">
<alternatives>
<graphic id="pcbi.1004596.e042g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e042" xlink:type="simple"/>
<mml:math display="block" id="M42" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.7em"/><mml:mtext>or</mml:mtext><mml:mspace width="0.7em"/><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mspace width="0.1em"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.5em"/><mml:mtext>and</mml:mtext></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e043">
<alternatives>
<graphic id="pcbi.1004596.e043g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e043" xlink:type="simple"/>
<mml:math display="block" id="M43" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.7em"/><mml:mtext>or</mml:mtext><mml:mspace width="0.7em"/><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula></p>
<p>Only two of these four equations apply for each sample point. If the sample point is on the western or eastern wall, then the first equation of each line applies; otherwise, the second equation of each line applies.</p>
<p>We combined all four constraints to define the functional
<disp-formula id="pcbi.1004596.e044">
<alternatives>
<graphic id="pcbi.1004596.e044g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e044" xlink:type="simple"/>
<mml:math display="block" id="M44" overflow="scroll">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.15em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mspace width="0.2em"/><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>tan</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>tan</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ξ</mml:mi><mml:mspace width="0.2em"/><mml:mi>L</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mspace width="0.2em"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.15em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>η</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.15em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>tan</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>υ</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>tan</mml:mtext><mml:mspace width="0.15em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>υ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mspace width="0.2em"/><mml:mi>W</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula></p>
<p>As a regularization parameter we chose <italic>α</italic> to weigh the influence between the triangulation constraint by (1-<italic>α</italic>) and we weigh the influence of the constraint based on the dimensions of the box by <italic>α</italic>. The number of samples on the walls is given by <italic>n</italic><sub><italic>N</italic></sub>, <italic>n</italic><sub><italic>S</italic></sub>, <italic>n</italic><sub><italic>W</italic></sub>, and <italic>n</italic><sub><italic>E</italic></sub> for the northern, southern, western, and eastern wall respectively. In <xref rid="pcbi.1004596.e044" ref-type="disp-formula">Eq 12</xref>, the first and third term come from the triangulation constraint and the second and fourth term come from the regularization constraint on a fixed width and length of the box. In total, we have 4 + <italic>n</italic><sub><italic>Wall</italic></sub> unknowns, whereas <italic>n</italic><sub><italic>Wall</italic></sub> denotes all visible features on walls. We calculated the extreme value for the functional <italic>E</italic> by computing the partial derivatives of <italic>E</italic> for all unknowns. This results in 4 + 2<italic>n</italic><sub><italic>Wall</italic></sub> equations. The solution is calculated by using the following linear equation system
<disp-formula id="pcbi.1004596.e045">
<alternatives>
<graphic id="pcbi.1004596.e045g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e045" xlink:type="simple"/>
<mml:math display="block" id="M45" overflow="scroll">
<mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>14</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>24</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>31</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>32</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>33</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>34</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>41</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>42</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>43</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>44</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.7em"/><mml:mtext>with</mml:mtext></mml:mrow>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula>
<disp-formula id="pcbi.1004596.e046">
<alternatives>
<graphic id="pcbi.1004596.e046g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e046" xlink:type="simple"/>
<mml:math display="block" id="M46" overflow="scroll">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mtext>cos</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mtext>cos</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1.5em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mspace width="0.15em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e047">
<alternatives>
<graphic id="pcbi.1004596.e047g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e047" xlink:type="simple"/>
<mml:math display="block" id="M47" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mtext>cos</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mspace width="0.15em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e048">
<alternatives>
<graphic id="pcbi.1004596.e048g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e048" xlink:type="simple"/>
<mml:math display="block" id="M48" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:msup><mml:mrow><mml:mtext>cos</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mspace width="0.15em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e049">
<alternatives>
<graphic id="pcbi.1004596.e049g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e049" xlink:type="simple"/>
<mml:math display="block" id="M49" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>14</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mspace width="0.15em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e050">
<alternatives>
<graphic id="pcbi.1004596.e050g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e050" xlink:type="simple"/>
<mml:math display="block" id="M50" overflow="scroll">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mtext>sin</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mtext>sin</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1.5em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mspace width="0.25em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e051">
<alternatives>
<graphic id="pcbi.1004596.e051g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e051" xlink:type="simple"/>
<mml:math display="block" id="M51" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mi>W</mml:mi><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mspace width="0.2em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e052">
<alternatives>
<graphic id="pcbi.1004596.e052g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e052" xlink:type="simple"/>
<mml:math display="block" id="M52" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>24</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:msup><mml:mrow><mml:mtext>sin</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mspace width="0.2em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e053">
<alternatives>
<graphic id="pcbi.1004596.e053g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e053" xlink:type="simple"/>
<mml:math display="block" id="M53" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>33</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mspace width="0.2em"/><mml:msup><mml:mi>W</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mspace width="0.2em"/><mml:msup><mml:mrow><mml:mtext>cos</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mo>,</mml:mo><mml:mspace width="1.5em"/></mml:mrow></mml:mstyle><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>34</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e054">
<alternatives>
<graphic id="pcbi.1004596.e054g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e054" xlink:type="simple"/>
<mml:math display="block" id="M54" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>44</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mspace width="0.2em"/><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mspace width="0.2em"/><mml:msup><mml:mrow><mml:mtext>sin</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mspace width="0.2em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e055">
<alternatives>
<graphic id="pcbi.1004596.e055g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e055" xlink:type="simple"/>
<mml:math display="block" id="M55" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>31</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>41</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>14</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>32</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>42</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>24</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>34</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>43</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e056">
<alternatives>
<graphic id="pcbi.1004596.e056g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e056" xlink:type="simple"/>
<mml:math display="block" id="M56" overflow="scroll">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.2em"/><mml:mtext>cos</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.6em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1.1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mspace width="0.2em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e057">
<alternatives>
<graphic id="pcbi.1004596.e057g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e057" xlink:type="simple"/>
<mml:math display="block" id="M57" overflow="scroll">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:msup><mml:mrow><mml:mtext>sin</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1.1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>ν</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>ν</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>ν</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mspace width="0.2em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e058">
<alternatives>
<graphic id="pcbi.1004596.e058g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e058" xlink:type="simple"/>
<mml:math display="block" id="M58" overflow="scroll">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∧</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1.1em"/><mml:mo>+</mml:mo><mml:mi>W</mml:mi><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>υ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>ν</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>ν</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mspace width="0.2em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004596.e059">
<alternatives>
<graphic id="pcbi.1004596.e059g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e059" xlink:type="simple"/>
<mml:math display="block" id="M59" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∧</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mtext>tan</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>θ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mspace width="0.1em"/><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The matrix <italic>C</italic> is symmetric and, therefore, its inverse exists, except in degenerated cases. To get the estimate of the location, we rescale the x-coordinate and y-coordinate using their respective compression factors. Thus, we get the final estimate for the location of self as:
<disp-formula id="pcbi.1004596.e060">
<alternatives>
<graphic id="pcbi.1004596.e060g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e060" xlink:type="simple"/>
<mml:math display="block" id="M60" overflow="scroll">
<mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.1em"/><mml:mo>/</mml:mo><mml:mspace width="0.1em"/><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.1em"/><mml:mo>/</mml:mo><mml:mspace width="0.1em"/><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula></p>
</sec>
<sec id="sec010">
<title>Oscillatory interference model for grid cell firing</title>
<p>To represent the pattern of grid cell firing based on location estimates from either the moving feature system or the static feature system, we used a simple model of grid cell firing. Note that the result of our simulations does not depend upon the use of a specific grid cell model. In fact, we also demonstrate similar results using the pattern of grid cell firing generated with an attractor model of grid cells (<xref rid="pcbi.1004596.s001" ref-type="supplementary-material">S1 Fig</xref> and <xref rid="pcbi.1004596.s002" ref-type="supplementary-material">S2 Fig</xref>). The oscillatory interference model was primarily chosen for simplicity of implementation. We used the oscillatory interference model initially proposed by Burgess [<xref rid="pcbi.1004596.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1004596.ref016" ref-type="bibr">16</xref>] and subsequently used by others [<xref rid="pcbi.1004596.ref017" ref-type="bibr">17</xref>, <xref rid="pcbi.1004596.ref040" ref-type="bibr">40</xref>]. For this formulation of the oscillatory interference model, we take the 2D location signal <inline-formula id="pcbi.1004596.e061"><alternatives><graphic id="pcbi.1004596.e061g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e061" xlink:type="simple"/><mml:math display="inline" id="M61" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>⇀</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> from either <xref rid="pcbi.1004596.e039" ref-type="disp-formula">Eq 9</xref> or <xref rid="pcbi.1004596.e060" ref-type="disp-formula">Eq 14</xref> to model the firing of grid cells in the dorsal or ventral part of the entorhinal cortex, respectively. The oscillatory interference model uses oscillations based on different heading directions in the environment. In the implementation used here, we used a location input instead of a velocity input. This location signal is projected onto a “basis system” of three vectors <inline-formula id="pcbi.1004596.e062"><alternatives><graphic id="pcbi.1004596.e062g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e062" xlink:type="simple"/><mml:math display="inline" id="M62" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, which are arranged at 120 deg angular difference. We have <inline-formula id="pcbi.1004596.e063"><alternatives><graphic id="pcbi.1004596.e063g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e063" xlink:type="simple"/><mml:math display="inline" id="M63" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>cos</mml:mtext><mml:mspace width="0.1em"/><mml:mn>0</mml:mn><mml:mo>°</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.1em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.1em"/><mml:mn>0</mml:mn><mml:mo>°</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1004596.e064"><alternatives><graphic id="pcbi.1004596.e064g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e064" xlink:type="simple"/><mml:math display="inline" id="M64" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>cos</mml:mtext><mml:mspace width="0.1em"/><mml:mn>120</mml:mn><mml:mo>°</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.1em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.1em"/><mml:mn>120</mml:mn><mml:mo>°</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1004596.e065"><alternatives><graphic id="pcbi.1004596.e065g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e065" xlink:type="simple"/><mml:math display="inline" id="M65" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>cos</mml:mtext><mml:mspace width="0.1em"/><mml:mn>240</mml:mn><mml:mo>°</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.1em"/><mml:mtext>sin</mml:mtext><mml:mspace width="0.1em"/><mml:mn>240</mml:mn><mml:mo>°</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The result of this projection is modulated by the angular frequency <italic>ω</italic> and the parameter <italic>β</italic><sub><italic>l</italic></sub>, which determines the grid spacing. The resulting signal is added to a time dependent modulation <italic>ωt</italic> to generate the phase of three different oscillations corresponding to the different directions above. This is the argument for three oscillations, which are combined with another baseline oscillation that simply has <italic>ωt</italic> as argument. These four oscillations form an interference pattern in the 2D plane and for this reason the model is called the oscillatory interference model. The model equation is [<xref rid="pcbi.1004596.ref016" ref-type="bibr">16</xref>]:
<disp-formula id="pcbi.1004596.e066">
<alternatives>
<graphic id="pcbi.1004596.e066g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e066" xlink:type="simple"/>
<mml:math display="block" id="M66" overflow="scroll">
<mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mrow><mml:mtext>cos</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ω</mml:mi><mml:mspace width="0.1em"/><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>cos</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ω</mml:mi><mml:mspace width="0.1em"/><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>ω</mml:mi><mml:mspace width="0.1em"/><mml:msub><mml:mi>β</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mspace width="0.1em"/><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>⇀</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula></p>
<p>The biological interpretation of this model <xref rid="pcbi.1004596.e066" ref-type="disp-formula">Eq 15</xref> can take on different forms. For example, there may be a network oscillation with phase <italic>ωt</italic> and separate, individual local oscillations with phases <inline-formula id="pcbi.1004596.e067"><alternatives><graphic id="pcbi.1004596.e067g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e067" xlink:type="simple"/><mml:math display="inline" id="M67" overflow="scroll"><mml:mrow><mml:mi>ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mspace width="0.1em"/><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>⇀</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which are the oscillations modulated by the location signal <inline-formula id="pcbi.1004596.e068"><alternatives><graphic id="pcbi.1004596.e068g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e068" xlink:type="simple"/><mml:math display="inline" id="M68" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>⇀</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> for each basis vector and by the parameter <italic>β</italic><sub><italic>l</italic></sub>. The oscillation <italic>ω</italic> could be provided by the theta rhythm oscillations regulated by the medial septum [<xref rid="pcbi.1004596.ref036" ref-type="bibr">36</xref>]. In the model interpretation the three oscillations indexed by <italic>k</italic> interfere at an individual grid cell. Each oscillation is associated with a direction in the 2D plane. These oscillations lead to a band of firing with an inter-band distance of 1/(<italic>β f</italic>), because the constructive interference between a purely somatic oscillation <italic>f</italic> = <italic>ω</italic>/(2<italic>π</italic>) and dendritic oscillation <italic>f</italic> + <italic>f β</italic> results in an oscillation with the overall envelope of frequency <italic>f</italic> + <italic>f β–f</italic> = <italic>f β</italic>. The multiplicative or additive combination of all three bands reaches values above the threshold <italic>Θ</italic> in vertices of a hexagonal grid given the 120 deg difference between basis vectors. The grid spacing is <inline-formula id="pcbi.1004596.e069"><alternatives><graphic id="pcbi.1004596.e069g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e069" xlink:type="simple"/><mml:math display="inline" id="M69" overflow="scroll"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msub><mml:mi>β</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and differs for the dorsal or ventral part of the entorhinal cortex. We model this by choosing two values for the parameter <italic>β</italic><sub><italic>l</italic></sub> (see <xref rid="pcbi.1004596.t001" ref-type="table">Table 1</xref>).</p>
</sec>
<sec id="sec011">
<title>Attractor model for grid cell firing</title>
<p>The attractor model simulates the regular hexagonal firing pattern of grid cells using a previously described model [<xref rid="pcbi.1004596.ref018" ref-type="bibr">18</xref>]. In this previously published model, a population of <italic>n</italic> = <italic>n</italic><sub><italic>x</italic></sub> × <italic>n</italic><sub><italic>y</italic></sub> cells are arranged as a 2D array with connections at the boundaries using a twisted torus topology. The twisted property of the topology is necessary to produce the hexagonal distribution of grid cell firing in contrast to a square array that would occur without the twisting. We report firing for the cell with the linear index <italic>n</italic><sub><italic>x</italic></sub>×<italic>n</italic><sub><italic>y</italic></sub><italic>—n</italic><sub><italic>y</italic></sub>/2. For our model simulations we set <italic>n</italic><sub><italic>x</italic></sub> = 10 and <italic>n</italic><sub><italic>y</italic></sub> = 9. Locations of cells on the torus are <inline-formula id="pcbi.1004596.e070"><alternatives><graphic id="pcbi.1004596.e070g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e070" xlink:type="simple"/><mml:math display="inline" id="M70" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> with coordinates <italic>x</italic><sub><italic>i</italic></sub> = (<italic>i</italic> − 0.5)/<italic>n</italic><sub><italic>x</italic></sub> and <inline-formula id="pcbi.1004596.e071"><alternatives><graphic id="pcbi.1004596.e071g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e071" xlink:type="simple"/><mml:math display="inline" id="M71" overflow="scroll"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> for the indices <italic>i</italic> = 1…<italic>n</italic><sub><italic>x</italic></sub> and <italic>j</italic> = 1…<italic>n</italic><sub><italic>y</italic></sub>. Note that <italic>k</italic> is the linear index of <italic>i</italic> and <italic>j</italic>, e.g. <italic>k</italic> = <italic>j</italic>+<italic>i</italic>×<italic>n</italic><sub><italic>y</italic></sub>. The activity of all cells is represented in the vector <inline-formula id="pcbi.1004596.e072"><alternatives><graphic id="pcbi.1004596.e072g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e072" xlink:type="simple"/><mml:math display="inline" id="M72" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Here this vector has 90 components. Synaptic weights between cells are defined through the matrix <italic>W</italic> with the entries
<disp-formula id="pcbi.1004596.e073">
<alternatives>
<graphic id="pcbi.1004596.e073g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e073" xlink:type="simple"/>
<mml:math display="block" id="M73" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mspace width="0.2em"/><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi>R</mml:mi><mml:mi>γ</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:mspace width="0.5em"/><mml:mtext>with</mml:mtext><mml:mspace width="0.5em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>…</mml:mi><mml:mtext>n</mml:mtext><mml:mspace width="0.5em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.5em"/><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>…</mml:mi><mml:mtext>n</mml:mtext><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula></p>
<p>The weights are defined using the 2D velocity signal <inline-formula id="pcbi.1004596.e074"><alternatives><graphic id="pcbi.1004596.e074g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e074" xlink:type="simple"/><mml:math display="inline" id="M74" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. In the case of the static feature system, we calculate the temporal difference of the location signal to define this velocity. The norm ‖⋅‖<sub><italic>tri</italic></sub> in <xref rid="pcbi.1004596.e073" ref-type="disp-formula">Eq 16</xref> implements a distance measure on the twisted torus topology. The parameter <italic>I</italic> = 0.3 models the peak synaptic strength. The parameter <italic>T</italic> = 0.05 introduces inhibition for weights at the tail end of the distribution. The parameter <italic>α</italic> controls the input gain of the velocity and the grid spacing is approximately 1.02 − 0.48 log<sub>2</sub>(<italic>α</italic>). For a simulated dorsal grid cell we set the gain <italic>α</italic><sub><italic>1</italic></sub> = 1.4×10<sup>−3</sup> and for a ventral grid cell we set the gain <italic>α</italic><sub><italic>1</italic></sub> = 0.9×10<sup>−3</sup>. The matrix <italic>R</italic><sub><italic>γ</italic></sub> rotates the grid orientation, here, we set <italic>γ</italic> = 0°. The standard deviation <italic>σ</italic> determines the size of the firing fields, here <italic>σ</italic> = 0.24 meters. The activities <inline-formula id="pcbi.1004596.e075"><alternatives><graphic id="pcbi.1004596.e075g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e075" xlink:type="simple"/><mml:math display="inline" id="M75" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are updated through:
<disp-formula id="pcbi.1004596.e076">
<alternatives>
<graphic id="pcbi.1004596.e076g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e076" xlink:type="simple"/>
<mml:math display="block" id="M76" overflow="scroll">
<mml:mrow><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.5em"/><mml:mtext>and</mml:mtext></mml:mrow>
</mml:math>
</alternatives>
<label>(17a)</label>
</disp-formula>
<disp-formula id="pcbi.1004596.e077">
<alternatives>
<graphic id="pcbi.1004596.e077g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e077" xlink:type="simple"/>
<mml:math display="block" id="M77" overflow="scroll">
<mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.15em"/><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>τ</mml:mi><mml:mspace width="0.2em"/><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(17b)</label>
</disp-formula></p>
<p><xref rid="pcbi.1004596.e076" ref-type="disp-formula">Eq 17a</xref> models the interaction between cells using the synaptic weight matrix <italic>W</italic>(t). The second <xref rid="pcbi.1004596.e077" ref-type="disp-formula">Eq 17b</xref> computes an exponentially weighted average. The factor 1-<italic>τ</italic> weighs the history of activation against the current activation, which has the weight <italic>τ</italic>, here <italic>τ</italic> = 0.8. In addition, <xref rid="pcbi.1004596.e077" ref-type="disp-formula">Eq 17b</xref> normalizes the activations against the sum of all activities. All activations are positive due to the applied half-wave rectification [⋅]<sup>+</sup>. Each activity <inline-formula id="pcbi.1004596.e078"><alternatives><graphic id="pcbi.1004596.e078g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e078" xlink:type="simple"/><mml:math display="inline" id="M78" overflow="scroll"><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is initialized randomly using a uniform distribution that ranges between 0 and (√<italic>N</italic>)<sup>-1</sup>. A model cell spikes if its activity is above the threshold level of <italic>η</italic> = 0.1. Formally, we express this as:
<disp-formula id="pcbi.1004596.e079">
<alternatives>
<graphic id="pcbi.1004596.e079g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e079" xlink:type="simple"/>
<mml:math display="block" id="M79" overflow="scroll">
<mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.5em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>…</mml:mi><mml:mi>n</mml:mi><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(18)</label>
</disp-formula></p>
<p>As shown in the results section, the properties of selective compression of grid cell firing field spacing due to shifts of barriers are the same for this attractor model as they were for the oscillatory interference model.</p>
</sec>
<sec id="sec012">
<title>Noise models</title>
<p>We use two methods to introduce noise in our simulations and to study the robustness of our proposed methods for the estimation of location. The first method superimposes independent and identically distributed Gaussian noise onto angular velocities of feature locations
<disp-formula id="pcbi.1004596.e080">
<alternatives>
<graphic id="pcbi.1004596.e080g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e080" xlink:type="simple"/>
<mml:math display="block" id="M80" overflow="scroll">
<mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mover accent="true"><mml:mi>ϑ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(19)</label>
</disp-formula>
with <inline-formula id="pcbi.1004596.e081"><alternatives><graphic id="pcbi.1004596.e081g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e081" xlink:type="simple"/><mml:math display="inline" id="M81" overflow="scroll"><mml:mover accent="true"><mml:mi>ϑ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004596.e082"><alternatives><graphic id="pcbi.1004596.e082g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e082" xlink:type="simple"/><mml:math display="inline" id="M82" overflow="scroll"><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> ϵ <italic>N</italic>(<italic>μ</italic><sub><italic>v</italic></sub>, <italic>σ</italic><sub><italic>v</italic></sub>), where <italic>N</italic>(<italic>μ</italic><sub><italic>v</italic></sub>, <italic>σ</italic><sub><italic>v</italic></sub>) denotes the normal distribution with mean <italic>μ</italic><sub><italic>v</italic></sub> and standard deviation <italic>σ</italic><sub><italic>v</italic></sub>. Notice that <inline-formula id="pcbi.1004596.e083"><alternatives><graphic id="pcbi.1004596.e083g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e083" xlink:type="simple"/><mml:math display="inline" id="M83" overflow="scroll"><mml:mover accent="true"><mml:mi>ϑ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004596.e084"><alternatives><graphic id="pcbi.1004596.e084g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e084" xlink:type="simple"/><mml:math display="inline" id="M84" overflow="scroll"><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are drawn for each time step. The sequence of drawn variables <inline-formula id="pcbi.1004596.e085"><alternatives><graphic id="pcbi.1004596.e085g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e085" xlink:type="simple"/><mml:math display="inline" id="M85" overflow="scroll"><mml:mover accent="true"><mml:mi>ϑ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004596.e086"><alternatives><graphic id="pcbi.1004596.e086g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e086" xlink:type="simple"/><mml:math display="inline" id="M86" overflow="scroll"><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is temporally uncorrelated, assuming a random number generator of infinite sequence. In practice the sequence is finite but larger than the number of samples that we drew.</p>
<p>The second method superimposes noise onto the observed angular direction of landmarks
<disp-formula id="pcbi.1004596.e087">
<alternatives>
<graphic id="pcbi.1004596.e087g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e087" xlink:type="simple"/>
<mml:math display="block" id="M87" overflow="scroll">
<mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>θ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>ϕ</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>ϑ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>ξ</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(20)</label>
</disp-formula>
with <italic>ϑ</italic> and <italic>ξ</italic> ϵ <italic>N</italic>(<italic>μ</italic><sub><italic>l</italic></sub>, <italic>σ</italic><sub><italic>l</italic></sub>), where <italic>N</italic>(<italic>μ</italic><sub><italic>l</italic></sub>, <italic>σ</italic><sub><italic>l</italic></sub>) denotes the normal distribution with mean <italic>μ</italic><sub><italic>l</italic></sub> and standard deviation <italic>σ</italic><sub><italic>l</italic></sub>. As before, the sequence of drawn <italic>ϑ</italic> and <italic>ξ</italic> is uncorrelated.</p>
<p>Obviously, the parameters of normal distribution used in these two methods cannot be directly related to each other, one set of random variables <inline-formula id="pcbi.1004596.e088"><alternatives><graphic id="pcbi.1004596.e088g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e088" xlink:type="simple"/><mml:math display="inline" id="M88" overflow="scroll"><mml:mover accent="true"><mml:mi>ϑ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004596.e089"><alternatives><graphic id="pcbi.1004596.e089g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e089" xlink:type="simple"/><mml:math display="inline" id="M89" overflow="scroll"><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is applied in the domain of image velocities and another set of random variables <italic>ϑ</italic> and <italic>ξ</italic> is applied in the angular domain. As measure of comparison we chose the domain-independent signal to noise ratio in decibels:
<disp-formula id="pcbi.1004596.e090">
<alternatives>
<graphic id="pcbi.1004596.e090g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e090" xlink:type="simple"/>
<mml:math display="block" id="M90" overflow="scroll">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mspace width="0.15em"/><mml:msub><mml:mrow><mml:mtext>log</mml:mtext></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(21)</label>
</disp-formula>
with <italic>k</italic> samples of the noise-free signal <italic>s</italic> and the measured signal <italic>m</italic>, which includes the noise. For the angular velocities our estimate is only based on the azimuthal angular velocity and, thus, <inline-formula id="pcbi.1004596.e091"><alternatives><graphic id="pcbi.1004596.e091g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e091" xlink:type="simple"/><mml:math display="inline" id="M91" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004596.e092"><alternatives><graphic id="pcbi.1004596.e092g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004596.e092" xlink:type="simple"/><mml:math display="inline" id="M92" overflow="scroll"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. For the angles of landmarks our estimate uses both azimuth and elevation and, we define the noise-free signal by <italic>s</italic><sub><italic>i</italic></sub> = <italic>θ</italic><sub><italic>i</italic></sub> for the first <italic>k</italic> samples and <italic>s</italic><sub><italic>i</italic></sub> = <italic>ϕ</italic><sub><italic>i</italic></sub> for another <italic>k</italic> samples. Analogously, we define the measured signal by <italic>m</italic><sub><italic>i</italic></sub> = <italic>θ</italic><sub><italic>i</italic>,<italic>n</italic></sub> for the first <italic>k</italic> samples and <italic>m</italic><sub><italic>i</italic></sub> = <italic>ϕ</italic><sub><italic>i</italic>,<italic>n</italic></sub> for another k samples. Thus, the sums in <xref rid="pcbi.1004596.e090" ref-type="disp-formula">Eq 21</xref> range over 2<italic>k</italic>, respectively. This noise characterization allows for comparison of the strength of noise in the two domains of angular velocities and angles.</p>
</sec>
</sec>
<sec id="sec013">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004596.s001" xlink:href="info:doi/10.1371/journal.pcbi.1004596.s001" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Shows the simulation results for the compression of a box using the attractor model.</title>
<p>(Guanella et al., 2007). (A) Grid cell firing pattern (grid score 1.70) from a simulated dorsal entorhinal cell for configuration A and (B) for configuration B (grid score 1.63). (C) Correlation value r<sup>2</sup> for compression of B relative to A shows peak value at ≈ -6.8% change. (D) Firing pattern (grid score 1.27) from the simulated ventral entorhinal neuron for configuration A and (E) configuration B (grid score -1.41). (F) Correlation value r<sup>2</sup> for compression of B relative to A shows that B needs to be increased by ≈ 98.8% to obtain maximum correlation with A. These results are qualitatively the same as for the velocity controlled oscillator model (<xref rid="pcbi.1004596.g003" ref-type="fig">Fig 3</xref>). For the simulation of the attractor model, we used the parameters for grid scale <italic>α</italic><sub><italic>1</italic></sub> = 1.4e-3 (dorsal grid cell), <italic>α</italic><sub><italic>2</italic></sub> = 0.9e-4 (ventral grid cell), for grid orientation <italic>β</italic> = 0 degrees, for number of cells <italic>N</italic><sub><italic>x</italic></sub> = 9 and <italic>N</italic><sub><italic>y</italic></sub> = 10, for the stabilization strength <italic>τ</italic> = 0.8, the intensity <italic>I</italic> = 0.8, the standard deviation of the Gaussian <italic>σ</italic> = 0.24 meters, the shift parameter <italic>T</italic> = 0.05, and the threshold for spiking of 0.1 (see also <xref rid="pcbi.1004596.t001" ref-type="table">Table 1</xref>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004596.s002" xlink:href="info:doi/10.1371/journal.pcbi.1004596.s002" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Compares the grid cell firing patterns for the velocity controlled oscillator model and the attractor model for noise in the observed visual angles of landmarks or in the image velocities of the optic flow using Gaussian noise with and without zero-mean.</title>
<p>The firing patterns from the velocity controlled oscillator model are shown in (A) for bias-free noise and the static feature system (grid score 1.84) in (B) for bias-free noise and the moving feature system (grid score 1.67), in (C) for biased noise and the static feature system (grid score -1.29), and in (D) for biased noise and the static feature system (grid score 1.66). Similarly, the firing patterns from the attractor model are shown in (E) for bias-free noise and the static feature system (grid score 1.50) in (F) for bias-free noise and the moving feature system (grid score 1.61), in (G) for biased noise and the static feature system (grid score -0.75), and in (H) for biased noise and the static feature system (grid score 1.56). The simulation for the two grid models are qualitatively the same, comparing the first with the second row.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004596.s003" xlink:href="info:doi/10.1371/journal.pcbi.1004596.s003" mimetype="application/zip" position="float" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Contains Matlab code to replicate the simulation results of this article.</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004596.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Molden</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Witter</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>. <article-title>Spatial representation in the entorhinal cortex</article-title>. <source>Science</source> <year>2004</year>; <volume>305</volume>(<issue>5688</issue>): <fpage>1258</fpage>–<lpage>1264</lpage>. <object-id pub-id-type="pmid">15333832</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hafting</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Molden</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>IM</given-names></name>. <article-title>Microstructure of a spatial map in the entorhinal cortex</article-title>. <source>Nature</source> <year>2005</year>; <volume>436</volume>: <fpage>801</fpage>–<lpage>806</lpage>. <object-id pub-id-type="pmid">15965463</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>. <article-title>A metric for space</article-title>. <source>Hippocampus</source> <year>2008</year>; <volume>18</volume>(<issue>12</issue>): <fpage>1142</fpage>–<lpage>1156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/hipo.20483" xlink:type="simple">10.1002/hipo.20483</ext-link></comment> <object-id pub-id-type="pmid">19021254</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fuhs</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Touretzky</surname> <given-names>DS</given-names></name> <article-title>A spin glass model of path integration in rat medial entorhinal cortex</article-title>. <source>J Neurosci</source> <year>2006</year>; <volume>26</volume>(<issue>16</issue>): <fpage>4266</fpage>–<lpage>4276</lpage>. <object-id pub-id-type="pmid">16624947</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Battaglia</surname> <given-names>FP</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>. <article-title>Path integration and the neural basis of the 'cognitive map'</article-title>. <source>Nat Rev Neurosci</source> <year>2006</year>; <volume>7</volume>(<issue>8</issue>): <fpage>663</fpage>–<lpage>678</lpage>. <object-id pub-id-type="pmid">16858394</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Barry</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>. <article-title>An oscillatory interference model of grid cell firing</article-title>. <source>Hippocampus</source> <year>2007</year>; <volume>17</volume>: <fpage>801</fpage>–<lpage>812</lpage>. <object-id pub-id-type="pmid">17598147</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Muller</surname> <given-names>RU</given-names></name>, <name name-style="western"><surname>Kubie</surname> <given-names>JL</given-names></name>. <article-title>The effects of changes in the environment on the spatial firing of hippocampal complex-spike cells</article-title>. <source>J Neurosci</source> <year>1987</year>; <volume>7</volume>(<issue>7</issue>): <fpage>1951</fpage>–<lpage>1968</lpage>. <object-id pub-id-type="pmid">3612226</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barry</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hayman</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Jeffery</surname> <given-names>KJ</given-names></name>. <article-title>Experience-dependent rescaling of entorhinal grids</article-title>. <source>Nature Neuroscience</source> <year>2007</year>; <volume>10</volume>: <fpage>682</fpage>–<lpage>684</lpage>. <object-id pub-id-type="pmid">17486102</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stensola</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Stensola</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Solstad</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Froland</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>The entorhinal grid map is discretized</article-title>. <source>Nature</source> <year>2012</year>; <volume>492</volume>: <fpage>72</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11649" xlink:type="simple">10.1038/nature11649</ext-link></comment> <object-id pub-id-type="pmid">23222610</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Burkhalter</surname> <given-names>A</given-names></name>. <article-title>Area map of mouse visual cortex</article-title>. <source>Journal of Comparative Neurology</source> <year>2007</year>; <volume>502</volume>: <fpage>339</fpage>–<lpage>357</lpage>. <object-id pub-id-type="pmid">17366604</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andermann</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Kerlin</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Roumis</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Glickfeld</surname> <given-names>LL</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>. <article-title>Functional specialization of mouse higher visual cortical areas</article-title>. <source>Neuron</source> <year>2011</year>; <volume>72</volume>: <fpage>1025</fpage>–<lpage>1039</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2011.11.013" xlink:type="simple">10.1016/j.neuron.2011.11.013</ext-link></comment> <object-id pub-id-type="pmid">22196337</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Burkhalter</surname> <given-names>A</given-names></name>. <article-title>Gateways of ventral and dorsal streams in mouse visual cortex</article-title>. <source>Journal of Neuroscience</source> <year>2011</year>; <volume>31</volume>: <fpage>1905</fpage>–<lpage>1918</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3488-10.2011" xlink:type="simple">10.1523/JNEUROSCI.3488-10.2011</ext-link></comment> <object-id pub-id-type="pmid">21289200</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Glickfeld</surname> <given-names>LL</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Andermann</surname> <given-names>ML</given-names></name>. <article-title>A mouse model of higher visual cortical function</article-title>. <source>Current Opinion in Neurobiology</source> <year>2014</year>; <volume>24</volume>: <fpage>28</fpage>–<lpage>33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.conb.2013.08.009" xlink:type="simple">10.1016/j.conb.2013.08.009</ext-link></comment> <object-id pub-id-type="pmid">24492075</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Garrett</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Nauhaus</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Marshel</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Callaway</surname> <given-names>EM</given-names></name>. <article-title>Topography and areal organization of mouse visual cortex</article-title>. <source>J. Neurosci</source>. <year>2014</year>; <volume>34</volume>(<issue>37</issue>): <fpage>12587</fpage>–<lpage>12600</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1124-14.2014" xlink:type="simple">10.1523/JNEUROSCI.1124-14.2014</ext-link></comment> <object-id pub-id-type="pmid">25209296</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mishkin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ungerleider</surname> <given-names>LG</given-names></name>, <name name-style="western"><surname>Macko</surname> <given-names>KA</given-names></name>. <article-title>Object vision and spatial vision: two cortical pathways</article-title>. <source>Trends in Neuroscience</source> <year>1983</year>; <volume>6</volume>: <fpage>415</fpage>–<lpage>417</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004596.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>. <article-title>Grid cells and theta as oscillatory interference: theory and predictions</article-title>. <source>Hippocampus</source> <year>2008</year>; <volume>18</volume>: <fpage>1157</fpage>–<lpage>1174</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/hipo.20518" xlink:type="simple">10.1002/hipo.20518</ext-link></comment> <object-id pub-id-type="pmid">19021256</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hasselmo</surname> <given-names>ME</given-names></name>. <article-title>Grid cell mechanisms and function: contributions of entorhinal persistent spiking and phase resetting</article-title>. <source>Hippocampus</source> <year>2008</year>; <volume>18</volume>: <fpage>1213</fpage>–<lpage>1229</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/hipo.20512" xlink:type="simple">10.1002/hipo.20512</ext-link></comment> <object-id pub-id-type="pmid">19021258</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Guanella</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kniper</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Verschure</surname> <given-names>P</given-names></name>. <article-title>A model of grid cells based on a twisted torus topology</article-title>. <source>International Journal of Neural Systems</source> <year>2007</year>; <volume>17</volume>: <fpage>231</fpage>–<lpage>240</lpage>. <object-id pub-id-type="pmid">17696288</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Burak</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Fiete</surname> <given-names>IR</given-names></name>). <article-title>Accurate path integration in continuous attractor network models of grid cells</article-title>. <source>PLoS Comput Biol</source> <year>2009</year>; <volume>5</volume>(<issue>2</issue>): <fpage>e1000291</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000291" xlink:type="simple">10.1371/journal.pcbi.1000291</ext-link></comment> <object-id pub-id-type="pmid">19229307</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bush</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>. <article-title>A hybrid oscillatory interference/continuous attractor network model of grid cell firing</article-title>. <source>Journal of Neuroscience</source> <year>2014</year>; <volume>34</volume>: <fpage>5065</fpage>–<lpage>5079</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4017-13.2014" xlink:type="simple">10.1523/JNEUROSCI.4017-13.2014</ext-link></comment> <object-id pub-id-type="pmid">24695724</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klink</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Alonso</surname> <given-names>A</given-names></name>. <article-title>Muscarinic modulation of the oscillatory and repetitive firing properties of entorhinal cortex layer II neurons</article-title>. <source>Journal of Neurophysiology</source> <year>1997</year>; <volume>77</volume>: <fpage>1813</fpage>–<lpage>1828</lpage>. <object-id pub-id-type="pmid">9114238</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Egorov</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Hamam</surname> <given-names>BN</given-names></name>, <name name-style="western"><surname>Fransen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hasselmo</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Alonso</surname> <given-names>AA</given-names></name>. <article-title>Graded persistent activity in entorhinal cortex neurons</article-title>. <source>Nature</source> <year>2002</year>; <volume>420</volume>: <fpage>173</fpage>–<lpage>178</lpage>. <object-id pub-id-type="pmid">12432392</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fransen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Tahvildari</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Egorov</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Hasselmo</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Alonso</surname> <given-names>AA</given-names></name>. <article-title>Mechanism of graded persistent cellular activity of entorhinal cortex layer v neurons</article-title>. <source>Neuron</source> <year>2006</year>; <volume>49</volume>: <fpage>735</fpage>–<lpage>746</lpage>. <object-id pub-id-type="pmid">16504948</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marshel</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Garrett</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Nauhaus</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Callaway</surname> <given-names>EM</given-names></name>. <article-title>Functional specialization of seven mouse visual cortical areas</article-title>. <source>Neuron</source> <year>2011</year>; <volume>72</volume>: <fpage>1040</fpage>–<lpage>1054</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2011.12.004" xlink:type="simple">10.1016/j.neuron.2011.12.004</ext-link></comment> <object-id pub-id-type="pmid">22196338</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Sporns</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Burkhalter</surname> <given-names>A</given-names></name>. <article-title>Network analysis of corticocortical connections reveals ventral and dorsal processing streams in mouse visual cortex</article-title>. <source>Journal of Neuroscience</source> <year>2012</year>; <volume>32</volume>: <fpage>4386</fpage>–<lpage>4399</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.6063-11.2012" xlink:type="simple">10.1523/JNEUROSCI.6063-11.2012</ext-link></comment> <object-id pub-id-type="pmid">22457489</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rodman</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Albright</surname> <given-names>TD</given-names></name>. <article-title>Coding of visual stimulus velocity in area MT of the macaque</article-title>. <source>Vision Research</source> <year>1987</year>; <volume>27</volume>: <fpage>2035</fpage>–<lpage>2048</lpage>. <object-id pub-id-type="pmid">3447355</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Graziano</surname> <given-names>MSA</given-names></name>, <name name-style="western"><surname>Andersen</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Snowden</surname> <given-names>RJ</given-names></name>. <article-title>Tuning of MST neurons to spiral motions</article-title>. <source>Journal of Neuroscience</source> <year>1994</year>; <volume>14</volume>: <fpage>54</fpage>–<lpage>67</lpage>. <object-id pub-id-type="pmid">8283251</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Duffy</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Wurtz</surname> <given-names>RH</given-names></name>. <article-title>Response of monkey MST neurons to optic flow stimuli with shifted centers of motion</article-title>. <source>Journal of Neuroscience</source> <year>1995</year>; <volume>15</volume>: <fpage>5192</fpage>–<lpage>5208</lpage>. <object-id pub-id-type="pmid">7623145</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Majaj</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Movshon</surname> <given-names>JA</given-names></name>. <article-title>Dynamics of motion signaling by neurons in macaque area MT</article-title>. <source>Nat. Neurosci</source>. <year>2005</year>; <volume>8</volume>: <fpage>220</fpage>–<lpage>228</lpage>. <object-id pub-id-type="pmid">15657600</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Juavinett</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Callaway</surname> <given-names>EM</given-names></name>. <article-title>Pattern and component motion responses in mouse visual cortical areas</article-title>. <source>Current Biology</source> <year>2015</year>; <volume>25</volume>: <fpage>1759</fpage>–<lpage>1764</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cub.2015.05.028" xlink:type="simple">10.1016/j.cub.2015.05.028</ext-link></comment> <object-id pub-id-type="pmid">26073133</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hargreaves</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Rao</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Knierim</surname> <given-names>JJ</given-names></name>. <article-title>Major dissociation between medial and lateral entorhinal input to dorsal hippocampus</article-title>. <source>Science</source> <year>2005</year>; <volume>308</volume>: <fpage>1792</fpage>–<lpage>1794</lpage>. <object-id pub-id-type="pmid">15961670</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eichenbaum</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lipton</surname> <given-names>PA</given-names></name>. <article-title>Towards a functional organization of the medial temporal lobe memory system: role of the parahippocampal and medial entorhinal cortical areas</article-title>. <source>Hippocampus</source> <year>2008</year>; <volume>18</volume>: <fpage>1314</fpage>–<lpage>1324</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/hipo.20500" xlink:type="simple">10.1002/hipo.20500</ext-link></comment> <object-id pub-id-type="pmid">19021265</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Deshmukh</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Knierim</surname> <given-names>JJ</given-names></name>. <article-title>Representation of non-spatial and spatial information in the lateral entorhinal cortex</article-title>. <source>Frontiers in Behavioral Neuroscience</source> <year>2011</year>; <volume>5</volume>: <fpage>69</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnbeh.2011.00069" xlink:type="simple">10.3389/fnbeh.2011.00069</ext-link></comment> <object-id pub-id-type="pmid">22065409</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kerr</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Agster</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Furtak</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Burwell</surname> <given-names>RD</given-names></name>. <article-title>Functional neuroanatomy of the parahippocampal region: the lateral and medial entorhinal areas</article-title>. <source>Hippocampus</source> <year>2007</year>; <volume>17</volume>: <fpage>697</fpage>–<lpage>708</lpage>. <object-id pub-id-type="pmid">17607757</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sargolini</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hafting</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Witter</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Conjunctive representation of position, direction, and velocity in entorhinal cortex</article-title>. <source>Science</source> <year>2006</year>; <volume>312</volume>(<issue>5774</issue>): <fpage>758</fpage>–<lpage>762</lpage>. <object-id pub-id-type="pmid">16675704</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brandon</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Bogaard</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Libby</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Connerney</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hasselmo</surname> <given-names>ME</given-names></name>. <article-title>Reduction of theta rhythm dissociates grid cell spatial periodicity from directional tuning</article-title>. <source>Science</source> <year>2011</year>; <volume>332</volume>: <fpage>595</fpage>–<lpage>599</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1201652" xlink:type="simple">10.1126/science.1201652</ext-link></comment> <object-id pub-id-type="pmid">21527714</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raudies</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Chapman</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Brandon</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hasselmo</surname> <given-names>M</given-names></name>. <article-title>Head direction is coded more strongly than movement direction in a population of entorhinal neurons</article-title>. <source>Brain Research</source> <year>2015</year>; <volume>1621</volume>: <fpage>355</fpage>–<lpage>367</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.brainres.2014.10.053" xlink:type="simple">10.1016/j.brainres.2014.10.053</ext-link></comment> <object-id pub-id-type="pmid">25451111</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raudies</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Hasselmo</surname> <given-names>ME</given-names></name>. <article-title>Modeling boundary vector cell firing given optic flow as a cue</article-title>. <source>PLoS Computational Biology</source> <year>2012</year>; <volume>8</volume>(<issue>6</issue>): Available: <fpage>e1002553</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002553" xlink:type="simple">10.1371/journal.pcbi.1002553</ext-link></comment> <object-id pub-id-type="pmid">22761557</object-id></mixed-citation></ref>
<ref id="pcbi.1004596.ref039"><label>39</label><mixed-citation publication-type="other" xlink:type="simple">Goldstein H, Poole C, Safko J (2001) Classical mechanics. Addison Wesley, 3rd edition.</mixed-citation></ref>
<ref id="pcbi.1004596.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blair</surname> <given-names>HT</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>K</given-names></name>. <article-title>Conversion of a phase to a rate-coded position signal by a three-stage model of theta cells, grid cells, and place cells</article-title>. <source>Hippocampus</source> <year>2008</year>; <volume>18</volume>: <fpage>1239</fpage>–<lpage>1255</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/hipo.20509" xlink:type="simple">10.1002/hipo.20509</ext-link></comment> <object-id pub-id-type="pmid">19021259</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>