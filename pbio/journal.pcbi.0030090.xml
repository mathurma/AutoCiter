<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0030090</article-id><article-id pub-id-type="publisher-id">06-PLCB-RA-0376R4</article-id><article-id pub-id-type="sici">plcb-03-05-08</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Genetics and Genomics</subject><subject>Mathematics</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Saccharomyces</subject></subj-group></article-categories><title-group><article-title>Binding Site Graphs: A New Graph Theoretical Framework for Prediction of Transcription Factor Binding Sites</article-title><alt-title alt-title-type="running-head">Binding Site Graphs</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Reddy</surname><given-names>Timothy E</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>DeLisi</surname><given-names>Charles</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Shakhnovich</surname><given-names>Boris E</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1">
				<label>1</label><addr-line> Program in Bioinformatics and Systems Biology, Boston University, Boston, Massachusetts, United States of America
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Department of Biomedical Engineering, Boston University, Boston, Massachusetts, United States of America
			</addr-line></aff><aff id="aff3">
				<label>3</label><addr-line> Department of Molecular and Cellular Biology, Harvard University, Cambridge, Massachusetts, United States of America
			</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Stormo</surname><given-names>Gary</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Washington University of St. Louis, United States of America</aff><author-notes><fn fn-type="con" id="ack1"><p>TER, CD, and BES conceived and designed the experiments, performed the experiments, analyzed the data, and wrote the paper.</p></fn><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">borya@acs.bu.edu</email></corresp><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>5</month><year>2007</year></pub-date><pub-date pub-type="epub"><day>11</day><month>5</month><year>2007</year></pub-date><pub-date pub-type="epreprint"><day>10</day><month>4</month><year>2007</year></pub-date><volume>3</volume><issue>5</issue><elocation-id>e90</elocation-id><history><date date-type="received"><day>6</day><month>9</month><year>2006</year></date><date date-type="accepted"><day>9</day><month>4</month><year>2007</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2007</copyright-year><copyright-holder>Reddy et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Computational prediction of nucleotide binding specificity for transcription factors remains a fundamental and largely unsolved problem. Determination of binding positions is a prerequisite for research in gene regulation, a major mechanism controlling phenotypic diversity. Furthermore, an accurate determination of binding specificities from high-throughput data sources is necessary to realize the full potential of systems biology. Unfortunately, recently performed independent evaluation showed that more than half the predictions from most widely used algorithms are false. We introduce a graph-theoretical framework to describe local sequence similarity as the pair-wise distances between nucleotides in promoter sequences, and hypothesize that densely connected subgraphs are indicative of transcription factor binding sites. Using a well-established sampling algorithm coupled with simple clustering and scoring schemes, we identify sets of closely related nucleotides and test those for known TF binding activity. Using an independent benchmark, we find our algorithm predicts yeast binding motifs considerably better than currently available techniques and without manual curation. Importantly, we reduce the number of false positive predictions in yeast to less than 30%. We also develop a framework to evaluate the statistical significance of our motif predictions. We show that our approach is robust to the choice of input promoters, and thus can be used in the context of predicting binding positions from noisy experimental data. We apply our method to identify binding sites using data from genome scale ChIP–chip experiments. Results from these experiments are publicly available at <ext-link ext-link-type="uri" xlink:href="http://cagt10.bu.edu/BSG" xlink:type="simple">http://cagt10.bu.edu/BSG</ext-link>. The graphical framework developed here may be useful when combining predictions from numerous computational and experimental measures. Finally, we discuss how our algorithm can be used to improve the sensitivity of computational predictions of transcription factor binding specificities.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><sec id="st1"><title/><p>A historically difficult problem in computational biology is the identification of transcription factor binding sites (TFBS) in the promoters of co-regulated genes. With increasing emphasis on research in transcriptional regulation, this problem is also uniquely relevant to emerging results from recent experiments in high-throughput and systems biology. Despite extensive research in the area, recent evaluations of previously published techniques show much room for improvement. In this paper, we introduce a fundamentally new approach to the identification of TFBS. First, we start by representing nucleotides in promoters as an undirected, weighted graph. Given this representation of a binding site graph (BSG), we employ relatively simple graph clustering techniques to identify functional TFBS. We show that BSG predictions significantly outperform all previously evaluated methods in nearly every performance measure using a standardized assessment benchmark. We also find that this approach is more robust than traditional Gibbs sampling to selection of input promoters, and thus more likely to perform well under noisy experimental conditions. Finally, BSGs are very good at predicting specificity determining nucleotides. Using BSG predictions, we were able to confirm recent experimental results on binding specificity of E-box TFs CBF1 and PHO4 and predict novel specificity determining nucleotides for TYE7.</p></sec></abstract><funding-group><funding-statement>The authors received no specific funding for this study.</funding-statement></funding-group><counts><page-count count="11"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Reddy TE, DeLisi C, Shakhnovich BE (2007) Binding site graphs: A new graph theoretical framework for prediction of transcription factor binding sites. PLoS Comput Biol 3(5): e90. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030090" xlink:type="simple">10.1371/journal.pcbi.0030090</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Transcription factors (TFs) bind short stretches (usually 6–18 bp) of DNA near the gene's transcription start site. This event is thought to facilitate regulation of expression of the downstream gene through TF interaction with the RNA polymerase and other factors in the pre-initiation complex [<xref ref-type="bibr" rid="pcbi-0030090-b001">1</xref>]. Computational identification of transcription factor binding sites (TFBS) remains one of the most challenging and important problems at the interface of computational and experimental research. In general, research in a diverse array of fields from biophysics to systems biology often depends on the ability to accurately identify TF binding propensities and positions. For example, several models of promoter architecture require knowledge of binding locations to identify transcriptional logic gates [<xref ref-type="bibr" rid="pcbi-0030090-b002">2</xref>] defined, in part by the relative binding positions of TFs [<xref ref-type="bibr" rid="pcbi-0030090-b003">3</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b004">4</xref>].</p><p>The main in vivo approaches to TF binding site determination are variants of ChIP–chip assays, and DNA footprinting. The former, which is essentially a high-throughput version of the latter, can identify approximate location of binding, usually accurate enough to within the length of a promoter [<xref ref-type="bibr" rid="pcbi-0030090-b005">5</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b006">6</xref>]. Footprinting can provide exact binding positions, but it is not easily generalized to high-throughput studies [<xref ref-type="bibr" rid="pcbi-0030090-b007">7</xref>]. Thus, to identify binding positions at the genomic scale, researchers often combine high-throughput ChIP–chip experiments with computational algorithms to predict TF binding sites and nucleotide affinities. Developing TF:DNA binding models from first principles, however, is complicated by limited understanding of mechanisms governing transcription factor binding and subsequent transduction of the polymerase assembly. Instead, several empirically derived models have been proposed to identify biologically relevant stretches of promoter regions [<xref ref-type="bibr" rid="pcbi-0030090-b008">8</xref>–<xref ref-type="bibr" rid="pcbi-0030090-b012">12</xref>]. Most computational algorithms depend on experimental assays to identify sets of co-regulated genes and work by recognizing over-represented, short stretches of DNA.</p><p>A recent evaluation of some of these algorithms shows that computational treatment of TFBSs is a largely unsolved problem, with the majority of tested algorithms predicting less than 50% of binding sites correctly [<xref ref-type="bibr" rid="pcbi-0030090-b013">13</xref>]. Several well-known pitfalls intrinsic to both the biological and computational sides of this problem plague algorithmic identification of binding positions. First, the possible space of solutions is very large, while heuristic approaches often identify local optima [<xref ref-type="bibr" rid="pcbi-0030090-b014">14</xref>]. Even if the algorithms could reliably identify global optima, empirically derived scoring functions do not reliably select biologically significant binding sites. Furthermore, the number of bound sites is close to that which could occur by random chance given the length of most eukaryotic promoters [<xref ref-type="bibr" rid="pcbi-0030090-b015">15</xref>], making identification by statistical over-representation challenging. The variability in DNA sequence that retains TF function and allows regulation of the expression of the downstream gene is unknown. While distance relative to the transcription start site was recently shown to be important [<xref ref-type="bibr" rid="pcbi-0030090-b016">16</xref>], this observation is not specific enough to apply in an algorithmic sense to TFBS identification. Finally, while the range of widths that TFs bind is largely accepted to be between 6 and 18 bp, an unbiased estimation for the width of the sequence specific to individual TFs has proven especially difficult [<xref ref-type="bibr" rid="pcbi-0030090-b017">17</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b018">18</xref>].</p><p>Recent innovations in computational TF motif prediction have attempted to incorporate orthogonal information to improve predictions. Position-specific mutation models [<xref ref-type="bibr" rid="pcbi-0030090-b019">19</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b020">20</xref>], co-occurrence of binding sites for multiple TFs [<xref ref-type="bibr" rid="pcbi-0030090-b021">21</xref>], and phylogenetic conservation [<xref ref-type="bibr" rid="pcbi-0030090-b020">20</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b022">22</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b023">23</xref>], among other approaches [<xref ref-type="bibr" rid="pcbi-0030090-b011">11</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b024">24</xref>], have been proposed as additional measures. While all these measures can be shown to improve either accuracy or coverage of computational predictions, most introduce biases that may narrow their applicability. For example, requiring strict phylogenetic conservation automatically excludes identification of evolutionary changes of transcriptional regulation [<xref ref-type="bibr" rid="pcbi-0030090-b016">16</xref>], and those that rely on co-occurrence of different sites do not help with identifying binding of a single TF of interest. Several researchers have also outlined a strategy utilizing the consensus from a variety of programs to improve accuracy [<xref ref-type="bibr" rid="pcbi-0030090-b005">5</xref>]. However, the improvement in accuracy of predictions from adopting this approach has not been rigorously quantified and consequently not well understood.</p><p>Here, we build on existing computational approaches to improve prediction of TF binding positions without adding additional biases that may narrow the scope of application. We recently showed [<xref ref-type="bibr" rid="pcbi-0030090-b025">25</xref>] that extensive repetition of Gibbs sampling on the same set of upstream promoters, termed ensemble Gibbs sampling (see <xref ref-type="sec" rid="s4">Methods</xref>), yields a power-law distribution of hits per nucleotide in each promoter: few nucleotides are selected very frequently, while the majority of nucleotides (also representing the majority of the Gibbs sampling results) are identified infrequently and do not correspond to biologically relevant results. Simple positional clustering to select the most frequently recurring nucleotides improves accuracy of TFBS identification [<xref ref-type="bibr" rid="pcbi-0030090-b025">25</xref>]. Here we show positional clustering can be substantially improved by considering joint occurrences of nucleotides in the same motif. These joint probabilities can be represented as a binding site graph (BSG).</p><p>Using a well-established benchmark, we compare the predictive power of BSGs to 13 other TFBS prediction algorithms [<xref ref-type="bibr" rid="pcbi-0030090-b013">13</xref>]. On yeast datasets, BSGs significantly outperform all previously evaluated algorithms in nearly every measure. In particular, the high percentage of correct predictions (PPV, positive predictive value) indicates that the approach is useful for directing downstream experimental research. Performance on non-yeast benchmarks, however, is dramatically worse, signifying that more research is required to reliably predict fly and mammalian regulatory motifs. We also find that BSG predictions are robust to the choice and length of input promoters, and thus more likely to succeed with limited or noisy experimental data. Encouraged by performance on yeast benchmarks, we use BSGs to predict the condition-specific nucleotide specificity for most known TFs in the <named-content content-type="genus-species" xlink:type="simple">Saccharomyces cerevisiae</named-content> genome. Predictions for previously characterized TFs closely agree with previous experimental and computational studies. In addition, we predict 53 novel binding specificities, 16 at high statistical significance.</p></sec><sec id="s2"><title>Results</title><p>A BSG is a graphical model representing the pair-wise nucleotide co-occurrences in the same motif. Vertices in a BSG represent nucleotides in the input promoters, and edges are weighted by an estimated probability of nucleotide co-occurrence in the same TF binding motif. Edges can be estimated using a variety of techniques: here, we use ensemble Gibbs sampling [<xref ref-type="bibr" rid="pcbi-0030090-b025">25</xref>] to construct a BSG (<xref ref-type="fig" rid="pcbi-0030090-g001">Figure 1</xref>). Doing so, we weight the edges by the fraction of the Gibbs sampling predictions in which two nucleotides co-occur (<xref ref-type="fig" rid="pcbi-0030090-g001">Figure 1</xref>C). Once a BSG is constructed, it remains to identify the subgraph of densely connected nucleotides corresponding to TF binding sites [<xref ref-type="bibr" rid="pcbi-0030090-b026">26</xref>]. Various graph properties and clustering techniques may be useful to identify such clusters. We focus on the frequency with which pairs of nucleotides in the cluster co-occur (represented in edge weights), and the extent to which the cluster is interconnected (measured by the clustering coefficient, or cliquishness, of the cluster). However, sets of nucleotides that are always identified together in Gibbs sampling, but do so in very few Gibbs sampling results, are more likely the result of noise in Gibbs sampling results than of correct predictions [<xref ref-type="bibr" rid="pcbi-0030090-b025">25</xref>]. Therefore, we employ a generalization of the clustering coefficient to weighted graphs that evaluates both the number and the weight of edges in a cluster of nucleotides [<xref ref-type="bibr" rid="pcbi-0030090-b027">27</xref>]: thus, such a low-weight clique of nucleotides will receive a very small weighted clustering coefficient (<xref ref-type="fig" rid="pcbi-0030090-g002">Figure 2</xref>). To evaluate the quality of a prediction, we develop a binding site graph score (BSGscore) that takes into account both the weighted clustering coefficient and the size of the subgraph. Comparing to a background distribution of sets of randomly selected promoters, we go on to evaluate the statistical significance of a BSGscore.</p><fig id="pcbi-0030090-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030090.g001</object-id><label>Figure 1</label><caption><title>BSG Construction</title><p>(A) Vertices of the BSG represent nucleotides in input promoters. Here, the input nucleotides are represented as points along the perimeter of a circle. Each disconnected bar along the perimeter of the circle represents a single promoter, with the transcription start site indicated.</p><p>(B) Edges (arcs across the circle) are added to each pair of aligned nucleotides in a motif resulting from a single Gibbs sampling prediction.</p><p>(C) Edges are compiled across ensemble Gibbs sampling results. Recurring edges are weighted by the number of times they recur, as indicated by different colored arcs in the BSG. Once all edges are collected from ensemble Gibbs sampling results, edge weights are normalized by the most frequently recurring edge.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.g001" xlink:type="simple"/></fig><fig id="pcbi-0030090-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030090.g002</object-id><label>Figure 2</label><caption><title>An Illustration of the Weighted Clustering Coefficient: Behavior of the Weighted Clustering Coefficient of Vertex <italic>n</italic> Is Shown across Four Increasingly Sparse Graphs</title><p>(A) In the most dense case, each pair of vertices adjacent to <italic>n</italic> is also adjacent, and all edge weights are maximal. Thus, <italic>n</italic> participates in a maximally weighted clique, and the weighted clustering coefficient is 1.</p><p>(B) As edges are removed from the clique, the neighborhood of <italic>n</italic> becomes less well-connected, and the clustering coefficient decreases.</p><p>(C) Unlike the original definition of clustering coefficient, the weighted clustering coefficient responds to the decreased intensity of the cluster resulting from intermediately weighted edges.</p><p>(D) Finally, when no edges exist between neighbors of <italic>n,</italic> the clustering coefficient goes to 0.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.g002" xlink:type="simple"/></fig><sec id="s2a"><title>BSG Construction and Prediction of TFBS</title><p>Given an input set of promoters, we construct a BSG from ensemble Gibbs sampling, as shown in <xref ref-type="fig" rid="pcbi-0030090-g001">Figure 1</xref>. Briefly, for each dataset, we run the sampler until stability 512 times for each motif width 6–18 bp, producing a total of 6,656 predictions per dataset. We consider the sampler to reach stability when results do not change over 1,250 updates. For each prediction, we add an edge between all pairs of nucleotide positions in the same column of the returned multiple sequence alignment (<xref ref-type="fig" rid="pcbi-0030090-g001">Figure 1</xref>B). Edges recurring in multiple Gibbs sampling results are represented by a single edge with weight <italic>w</italic> equal to the number of times the edge occurs normalized by the total number of Gibbs sampling predictions. Thus, <italic>w</italic> ∈ (0,P], where the maximum edge weight, P ≤ 1, is the number of times the most frequently recurring edge is observed divided by the total number of edges in the graph.</p><p>Once the BSG is built, it still remains to predict positions corresponding to functional TFBS. First, analogous to the frequency with which Gibbs sampling identifies a given nucleotide [<xref ref-type="bibr" rid="pcbi-0030090-b025">25</xref>], edge weights are power law distributed (unpublished data), and nucleotides connected with high edge weights are predictive of TFBS (<xref ref-type="supplementary-material" rid="pcbi-0030090-sg001">Figure S1</xref>). Second, we hypothesize that transitively connected nucleotides are closely related in sequence space. For example, if Gibbs sampling identified sites 1 and 2 in one run and sites 2 and 3 in another, those sites will have related, but not identical, sequences. We are interested in differentiating the case where the Gibbs sampler identifies random sets of k-mers from the case where the sampler repeatedly predicts the same set of sites. We hypothesize that the latter case corresponds to functional TFBS. This information is represented in BSG by dense clusters of nucleotides connected by high edge weights.</p><p>The clustering coefficient of a nucleotide <italic>k</italic> in a BSG measures connectivity within the local neighborhood of <italic>k</italic> [<xref ref-type="bibr" rid="pcbi-0030090-b028">28</xref>]. As the neighborhood of <italic>k</italic> approaches a clique, where all neighbors are connected, the clustering coefficient approaches 1. As the neighborhood of <italic>k</italic> becomes sparse, where no neighbors of <italic>k</italic> co-occur in Gibbs sampling predictions, the clustering coefficient approaches 0. The standard definition of the clustering coefficient is limited to unweighted graphs. However, because edge weights are predictive of functional TFBS, we use a modified version of the clustering coefficient that rewards higher edge weights [<xref ref-type="bibr" rid="pcbi-0030090-b027">27</xref>] (<xref ref-type="fig" rid="pcbi-0030090-g002">Figure 2</xref>).</p><p>To predict TFBS from a BSG, we can use the weighted clustering coefficient to find sets of nucleotides that are densely connected with high-weight edges. We will use a threshold 0 &lt; <italic>ρ</italic> ≤ P to filter out all edges with inconsequential edge weight (<xref ref-type="fig" rid="pcbi-0030090-g003">Figure 3</xref>). Since dense clusters are more likely to occur at random in graphs with fewer vertices, simply maximizing on the weighted clustering coefficient is biased toward graphs with the fewest nodes (<xref ref-type="supplementary-material" rid="pcbi-0030090-sg003">Figure S3</xref>). To account for this, we include a (1 − <italic>ρ/</italic> P) term in our BSGscore to reward larger but perhaps less densely connected subgraphs. Thus, for a BSG <italic>G</italic> and frequency threshold <italic>ρ,</italic> we define the BSGscore:
					<disp-formula id="pcbi-0030090-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030090.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>B</mml:mi><mml:mi>S</mml:mi><mml:mi>G</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>&rho;</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:mrow><mml:mi>&rho;</mml:mi><mml:mo>/</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&times;</mml:mo><mml:msub><mml:mover accent='true'><mml:mi>C</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>&rho;</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>where <inline-formula id="pcbi-0030090-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030090.ex001" xlink:type="simple"/></inline-formula>
					 is mean weighted clustering coefficient over all nucleotides in graph <italic>G</italic> at threshold <italic>ρ</italic>. We want to select the edge weight threshold 
					ρˆ that maximizes the BSGscore. To turn the resulting graph into predicted binding positions in the promoters, we extract all nucleotides in the BSG connected by an edge with <italic>w</italic> &gt; 
					ρˆ (<xref ref-type="fig" rid="pcbi-0030090-g003">Figure 3</xref>B). Nucleotides adjacent in the original input promoters are grouped together into seed sequences (see <xref ref-type="sec" rid="s4">Methods</xref>, <xref ref-type="fig" rid="pcbi-0030090-g003">Figure 3</xref>C). Often, we find the seed sequences contain only the most conserved core of the TFBS. To capture important nucleotides at the edges, we extend the seed sequences to include neighboring nucleotides that are also frequently identified by Gibbs sampling, but perhaps do not pass the stringent cutoff of the core positions (see <xref ref-type="sec" rid="s4">Methods</xref>). The extended sequences are then aligned to create a position weight matrix (PWM) representing the binding motif.
				</p><fig id="pcbi-0030090-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030090.g003</object-id><label>Figure 3</label><caption><title>Predicting TFBS within the BSG Framework</title><p>(A) First, a BSG is constructed from ensemble Gibbs Sampling. Here, the perimeter of the circle represents promoters, and lines between nucleotides in the promoters correspond to edges in the BSG. Edges are heat-mapped according to edge weight.</p><p>(B) The filtered BSG, obtained by selecting an edge-weight threshold ρ to maximize the BSGscore, followed by all edges with weight less than ρ from the graph.</p><p>(C) Final TFBS predictions are made from the filtered BSG by collecting nucleotides contiguous in the original promoters into prediction sequences, which are returned in fasta format. The promoter region depicted contains two predicted TFBS.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.g003" xlink:type="simple"/></fig><p>It should be noted that, at this point in the process, the remaining sequences are generally of similar length, and well-conserved. Hence, the primary motivation for using a sampling procedure here is not to define the end points of the alignment. Instead, we use sampling to solve the problem that we do not know the strand orientation of each binding site. The space of all possible permutations of strand orientations is exponential, and it is unfeasible to explore exhaustively for even a moderate number of predictions. Thus, we use sampling to heuristically predict the relative strand orientation of the predictions. Indeed, other procedures such as expectation maximization would also be appropriate here, and Gibbs sampling was chosen as a matter of convenience.</p><p>To evaluate the statistical significance of a BSG prediction, it is important to understand the behavior of BSGscores under the null hypothesis that no motifs are present in the input set. We estimated the null distribution of BSGscores in yeast by calculating the maximal BSGscore from 429 sets of 7–30 randomly chosen (without replacement) yeast promoters. The resulting scores follow a generalized extreme value distribution (<xref ref-type="fig" rid="pcbi-0030090-g004">Figure 4</xref>; <italic>p</italic> = 0.997, KS test). We found no significant correlation between the size of the random input set and the BSGscore. Using this distribution, we can evaluate the <italic>p</italic>-value of a BSGscore from a dataset enriched in a TF binding motif (see <xref ref-type="sec" rid="s4">Methods</xref>). However, dramatic differences in promoter architecture between species may mean that an empirically derived background distribution is needed on a per-species basis. Additionally, we leave for future study a statistical evaluation of input sets with multiple motifs.</p><fig id="pcbi-0030090-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030090.g004</object-id><label>Figure 4</label><caption><title>Frequency (<italic>y</italic>-Axis) of BSGscores (<italic>x</italic>-Axis) for Set of 7–30 Randomly Selected Yeast Promoters (Blue Bars) Compared with the Probability Distribution of the Estimated Generalized Extreme Value Distribution (Orange Line)</title><p>Empirical and estimated cumulative probability distribution (black triangles and orange line, respectively) are shown in the inset. The empirical and estimated distributions are the same with <italic>p</italic> = 0.997 according to a KS test.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.g004" xlink:type="simple"/></fig></sec><sec id="s2b"><title>Whole Genome TFBS Predictions from ChIP–chip in <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content></title><p>We used BSGs to predict binding sites for the majority of TFs in the <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content> genome using the latest data from ChIP–chip experiments [<xref ref-type="bibr" rid="pcbi-0030090-b005">5</xref>] in a number of experimental conditions. In total, BSGs predict significant binding motifs for 118 TF–condition pairs, representing 93 different TFs. These results compare favorably with the compendium of 124 TF motif predictions presented in MacIsaac et al. [<xref ref-type="bibr" rid="pcbi-0030090-b029">29</xref>]: of the 77 TFs with predictions in each set, 59 (77%) are similar (see <xref ref-type="sec" rid="s4">Methods</xref>). In addition, we predict a different motif for 25 of our significant TF–condition motifs, representing 22 TFs (<xref ref-type="supplementary-material" rid="pcbi-0030090-sg005">Figure S5</xref>). It should be noted that the number of similar and different motifs combine to be more than the total number of TFs with predictions in both sets. This discrepancy is explained by four TFs (MOT3, SFP1, MSN2, and MSN4) for which we predict condition-dependent motifs. These results are summarized in <xref ref-type="table" rid="pcbi-0030090-t001">Table 1</xref>.</p><table-wrap content-type="1col" id="pcbi-0030090-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030090.t001</object-id><label>Table 1</label><caption><p>Summary of Genome-Wide Predictions of TF Specificities</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="char" charoff="0" char="("/></colgroup><thead><tr><td align="left" valign="top"><hr/>Predictions</td><td valign="middle"><hr/>Number (Transcription Factors)</td></tr></thead><tbody><tr><td valign="middle">Binding site graph predictions</td><td valign="middle">118 (93)</td></tr><tr><td valign="middle">Number of previously predicted TFs &lsqb;<xref ref-type="bibr" rid="pcbi-0030090-b029">29</xref>&rsqb;</td><td valign="middle">124</td></tr><tr><td valign="middle">Predictions in common</td><td valign="middle">101 (77)</td></tr><tr><td valign="middle">Similar predictions</td><td valign="middle">76 (59)</td></tr><tr><td valign="middle">Differing predictions</td><td valign="middle">25 (22)</td></tr><tr><td valign="middle">Novel predictions</td><td valign="middle">18 (18)</td></tr><tr><td valign="middle">TFs not predicted by BSGs with high confidence</td><td valign="middle">(47)</td></tr><tr><td valign="middle">Total TFs with a predicted motif</td><td valign="middle">(142)</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt101"><p>All numbers represent TF&ndash;condition pairs, unless otherwise noted. BSGs were used to predict binding motifs for most TFs in the yeast genomes across a number of experimental conditions. Comparisons were made to motifs published previously by MacIsaac et al. &lsqb;<xref ref-type="bibr" rid="pcbi-0030090-b029">29</xref>&rsqb;, as described in Methods. Overall, BSGs compare favorably with the previously published motifs, while providing alternative and novel motif predictions for a number of TFs.</p></fn></table-wrap-foot> --></table-wrap><p>Several possible reasons for differences in motif predictions include co-regulation of the same set of genes by different TFs, identification of statistically significant, but biologically inert, motifs, as well as false positive predictions. At the same time, the comparison numbers depend on arbitrary motif similarity thresholds (see <xref ref-type="sec" rid="s4">Methods</xref>). Since allowed degeneracy may be TF-specific, using a single cutoff may not be the optimal approach. However, the agreement provides a rough estimate of the consistency between BSG and previously reported experimental and computational results. Finally, BSGs predict motifs for 18 TFs with previously unknown affinities (<xref ref-type="supplementary-material" rid="pcbi-0030090-sg006">Figure S6</xref>) and fail to make a significant prediction for 47 TFs. Combining BSG predictions with those in MacIsaac et al. [<xref ref-type="bibr" rid="pcbi-0030090-b029">29</xref>] gives a total of 142 TFs with significant motif predictions. However, experimental validation may be needed to confirm novel and revised predictions.</p><p>To better understand the reasons behind improved performance of BSGs over traditional Gibbs sampling, we manually examine select significant (<italic>p</italic> &lt; 0.1) BSG predictions that do not agree with the best scoring Gibbs sampling prediction (<xref ref-type="fig" rid="pcbi-0030090-g005">Figure 5</xref>). For Gibbs sampling predictions, we chose the motif width that gave the largest MAP score [<xref ref-type="bibr" rid="pcbi-0030090-b017">17</xref>]. Here, we only consider predictions that agree with those previously published. We observed two distinct mechanisms by which BSGs improve on Gibbs sampling. In some cases, such as the HSF1 and LEU3 predictions, the best-scoring result obtained from Gibbs sampling represents only a fraction of the final motif. These represent cases where, through integration of several motif widths, the BSGscore correctly identifies the motif width better than the Gibbs sampling MAP score [<xref ref-type="bibr" rid="pcbi-0030090-b017">17</xref>]. Indeed, when we disregard the MAP score and manually choose a motif width according to previous predictions [<xref ref-type="bibr" rid="pcbi-0030090-b029">29</xref>], Gibbs sampling identifies the correct motif for HSF1 and LEU3. In other cases, such as SIP4, we find manually choosing the correct motif width does not result in prediction of the correct motif by traditional Gibbs sampling. Similarly, the Gibbs sampling width for the prediction of the RDS1 binding motif matches the width of the previously reported prediction, yet the binding motif does not match. Thus, we conclude that the BSGscore contains additional information about correct binding sites not necessarily present in the MAP score used by Gibbs sampling. In particular, the BSGscore considers both the positional information for each motif and the uniqueness of the nucleotides with respect to the rest of the similarly scoring predictions from the same set of upstream regions. By carefully studying the dynamics of BSG building, it may be possible to incorporate these characteristics into an improved Gibbs sampling procedure and score.</p><fig id="pcbi-0030090-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030090.g005</object-id><label>Figure 5</label><caption><title>Differences between BSG Predictions and Gibbs Sampling</title><p>The motif predicted by BSGs is compared with the best-scoring motif from an equivalent amount of Gibbs sampling. In some cases, such as HSF1 and LEU3, BSGs perform better through better estimation of the width of the motif. In such cases, manually choosing the correct motif width based on a priori knowledge allows Gibbs sampling to predict the correct motif. In other cases, however, such as SIP4 and RDS1, choosing the best Gibbs sampling width does not produce the correct prediction. For RDS1, N/A indicates that the motif width reported previously [<xref ref-type="bibr" rid="pcbi-0030090-b029">29</xref>] matches the width of the best Gibbs sampling motif, and thus manually selecting the motif width does not alter the Gibbs sampling prediction.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.g005" xlink:type="simple"/></fig><p>In cases where multiple TFs act together to coordinately regulate a set of genes, numerous motifs may be enriched in a set of promoters. Preliminary evidence suggests these motifs arise as independent connected components in the filtered BSG. For example, BSGs predict two connected components for STE12 in YPD: the first component corresponds to the known STE12 binding motif; the second component is the binding motif for TEC1. STE12 and TEC1 are known to act cooperatively to regulate haploid invasive and diploid pseudohyphal growth. Thus, clustering results into disjoint connected components allowed identification of two different TFs in the same input set. This procedure can be used as a predictor of sets of collaborating TFs in <italic>cis</italic>-regulatory modules. That, in turn, can be used to elucidate major regulatory switches and sets of genes functional in common pathways [<xref ref-type="bibr" rid="pcbi-0030090-b030">30</xref>–<xref ref-type="bibr" rid="pcbi-0030090-b032">32</xref>].</p></sec><sec id="s2c"><title>Comparison to Other Algorithms</title><p>We benchmarked performance of BSGs against numerous other motif detection algorithms. We used the same datasets described in Tompa et al. and evaluated BSG predictions according to the statistical framework detailed therein [<xref ref-type="bibr" rid="pcbi-0030090-b013">13</xref>]. On yeast-specific benchmark sets, high-confidence (<italic>p</italic> &lt; 0.1) BSG predictions significantly outperform all tested methods according to nearly every statistical measure (<xref ref-type="fig" rid="pcbi-0030090-g006">Figure 6</xref>). In terms of nucleotide correlation coefficient (nCC), an overall measure of correctness, BSG predictions with <italic>p</italic> &lt; 0.1 improve upon the second-best predictions by 19%. The only exception where BSG predictions do not outperform existing techniques is site-level sensitivity (sSn) [<xref ref-type="bibr" rid="pcbi-0030090-b011">11</xref>], where Weeder outperforms by 13%. Weeder's sensitivity, however, comes at the expense of many false positive results, as shown by BSGs' significant improvement in sPPV over Weeder (72% versus 55%, a 31% improvement). Moreover, BSG seems to be the only method that predicts many more true positives than false positives, corresponding to a site and nucleotide <italic>PPV</italic> ≫ 0.50. Unlike other methods evaluated, BSG performance does not require any manual curation or custom post processing.</p><fig id="pcbi-0030090-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030090.g006</object-id><label>Figure 6</label><caption><title>Benchmarked Evaluation of BSG Binding Site Predictions for Yeast Datasets from Tompa et al. [<xref ref-type="bibr" rid="pcbi-0030090-b013">13</xref>]</title><p>Performance of BSG predictions are compared with the three best-performing algorithms according to a previously published evaluation. Performance measures (<italic>x</italic>-axis) are nSn (nucleotide sensitivity), nPPV (nucleotide positive predictive value), nPC (nucleotide performance coefficient), nCC (nucleotide correlation coefficient), sSn (site sensitivity), sPPV (site positive predictive value), and sASP (average site performance). For formulas used to calculate these measures, see <xref ref-type="sec" rid="s4">Materials and Methods</xref>. BSGs significantly outperform all previous evaluated algorithms in nearly every measure. Most notable are improvements in nucleotide and site positive predictive value, where predictions from BSGs achieve values of 0.71 and 0.77, respectively.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.g006" xlink:type="simple"/></fig><p>Benchmarking with the mouse and human datasets, we found that the BSG performed among the best six algorithms in every category except nucleotide specificity, for which BSGs performed poorly; while performance was good, we did not observe the broad improvements obtained in yeast (<xref ref-type="supplementary-material" rid="pcbi-0030090-sg004">Figure S4</xref>). We believe the performance drop in non-yeast sets indicates the need to develop species-specific binding site detection strategies. For example, in the human and mouse tests, the TF binding sites have a positional bias toward the transcription start site; the fly examples, however, tend to contain closely spaced clusters of binding sites. Better understanding of these differences in promoter architecture and usage between species will be critical in developing species-specific BSGscores.</p></sec><sec id="s2d"><title>Robustness to Noise in Input Sequences</title><p>Another mechanism to assess the efficacy of a TFBS algorithm is to evaluate the effect of added decoy promoters on the stability and accuracy of TFBS predictions [<xref ref-type="bibr" rid="pcbi-0030090-b033">33</xref>]. Decoy promoters are intergenic nucleotide sequences that contain no instances of the TFBS of interest, and may arise through false positives in prediction of the input set. The effect of decoy promoters is reduction in the concentration of TF binding sequences in the input set. For example, 20 instances of a 10-bp binding site in 20 upstream regions, each 1,000 bp long, results in about 1/100 signal:noise. If we add 20 more upstream regions without instances of the same TFBS, signal:noise would be closer to 1/200. Decreasing the signal-to-noise ratio confounds identification of binding sites.</p><p>Robustness to decoy sequences is necessary to make binding site predictions from noisy datasets such as high-throughput microarray experiments. Addition of decoy promoters also effectively simulates longer upstream regions encountered in higher eukaryotes. To evaluate BSG robustness to increasing noise, we first predict TFBS in a core set of promoters that ChIP–chip experiments predict are coregulated by a common TF. We then predict binding sites in versions of the core set augmented by increasing numbers of randomly selected intergenic sequences from the <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content> genome. We then plot PPV with respect to the relative amount of added noise.</p><p>We evaluated robustness of BSG predictions to addition of decoy promoters for four input sets (HAP4, STE12, YDR026C, and YAP1). We then compare our results with those that could be expected given an equal amount of independent Gibbs sampling runs without BSG identification of TFBS. We find, for all TFs evaluated, the PPV of using BSG predictions is uniformly superior to Gibbs sampling alone, even for some predictions with <italic>p</italic> &gt; 0.1. Moreover, the difference between the PPV of BSG and Gibbs sampling alone increases with addition of decoy sequences (<xref ref-type="fig" rid="pcbi-0030090-g007">Figure 7</xref>). We also use the same framework to compare BSGs with positional clustering of frequently recurring Gibbs sampling results [<xref ref-type="bibr" rid="pcbi-0030090-b025">25</xref>]. As shown in <xref ref-type="fig" rid="pcbi-0030090-g007">Figure 7</xref>, while positional clustering is useful in improving binding predictions using ensemble Gibbs sampling, BSGs allow further improvement. These results indicate BSGs perform better with noisy input sets that could result from long eukaryotic upstream regions or inaccurate predictions of co-regulation.</p><fig id="pcbi-0030090-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030090.g007</object-id><label>Figure 7</label><caption><title>Comparison of Robustness to Noisy Decoy Promoters between BSG Predictions, Positional Clustering [<xref ref-type="bibr" rid="pcbi-0030090-b025">25</xref>], and an Equivalent Amount of Gibbs Sampling Runs (6,656 Gibbs Sampling Predictions)</title><p>For each of the signal sets, varying numbers of random <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content> promoters were added to the original ChIP–chip derived set (<italic>x</italic>-axis). TFBS predictions were made using BSGs (circles), positional clustering (triangles), and the best predictions from an equivalent number of iterations of Gibbs sampling alone (squares). For each set of predictions, the PPV (<italic>y</italic>-axis) was calculated by comparing the prediction with published motifs as described in <xref ref-type="sec" rid="s4">Methods</xref>. For BSG predictions, filled, half-filled, and open circles represent <italic>p</italic> &lt; 0.01, <italic>p</italic> &lt; 0.1, and <italic>p</italic> &gt; 0.1, respectively. BSGs attain dramatically higher PPV than Gibbs sampling alone, especially in the noisiest input sets. In some cases, the PPV does not decrease monotonically with the addition of noise. This effect is the result of spurious instances of the binding site occurring in the decoy promoters. Although STE12 predictions are not significant, the well-known motif is almost always discovered. In all STE12 predictions, multiple components were identified in the BSG, highlighting the need to generalize the <italic>p</italic>-value to graphs with multiple motifs.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.g007" xlink:type="simple"/></fig></sec><sec id="s2e"><title>Specificity Determining Positions for E-Box TFs</title><p>We found that BSG predictions for the PHO4, CBF1, and TYE7 TFs are particularly interesting. Despite regulating biologically different processes, all three are Helix–loop–helix proteins that bind the hexameric E-box motif CACGTG. In the case of PHO4 and CBF1, a high-throughput microfluidics platform able to precisely measure low-affinity TF:DNA interactions [<xref ref-type="bibr" rid="pcbi-0030090-b034">34</xref>] revealed differences in the specificity for E-box flanking nucleotides for PHO4 and CBF1. Previous computational studies [<xref ref-type="bibr" rid="pcbi-0030090-b005">5</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b029">29</xref>], however, have struggled to identify significant differences in binding affinities. In agreement with the experimentally derived specificities, the BSG is the first high-throughput computational approach able to correctly resolve the differences in specificity of flanking nucleotides for both PHO4 and CBF1 (gCACGTGG and gTCACGTG, respectively, <xref ref-type="supplementary-material" rid="pcbi-0030090-st001">Table S1</xref>). Additionally, BSGs predict an extended TYE7 binding 10mer (cATCACGTGa, <xref ref-type="supplementary-material" rid="pcbi-0030090-st001">Table S1</xref>) that differs from both the PHO4 and CBF1 binding motifs in the flanking nucleotides. We searched all yeast promoters for exact matches to the expanded binding motifs. As expected, promoters containing the PHO4 motif were significantly enriched in phosphate transport processes. Exact matches to the revised CBF1 and TYE7 motifs were both significantly enriched in amino acid metabolism; CBF1 motifs, however, were limited to metabolism of nitrogen R-groups, whereas TYE7 motifs were limited to metabolism of cysteine. We take this as preliminary evidence that the newly discovered flanking nucleotides may play a major role in allowing each E-box binding TF to regulate a subset of functionally specific proteins.</p></sec></sec><sec id="s3"><title>Discussion</title><p>Here, we present a novel approach for determining the positions and binding affinities to TFs using putatively bound upstream promoter sequences. BSGs are a departure from traditional sequence alignment techniques such as Gibbs sampling primarily because BSGs capture global properties of promoter input sets that seem to be unique only to sets that share TFBS. This results in several important advantages in predicting TFBS using BSGs. First, according to most independent validation criteria, BSGs are more accurate than existing techniques. Additionally, we find BSGs are more robust to noisy decoy sequences than Gibbs sampling with and without positional clustering. Importantly, positional clustering provides an intermediate level of improvement over Gibbs sampling alone. This result suggests the improved performance of BSG is due to a combination of ensemble sampling and analysis of graph-theoretical properties of BSGs [<xref ref-type="bibr" rid="pcbi-0030090-b025">25</xref>]. Robustness to decoy sequences may allow BSGs to better predict binding sites from co-expression data, which is more prone to false positive predictions than ChIP–chip, and does not necessarily result in gene sets co-regulated by a single TF. Second, BSG construction and cluster extraction algorithms provide an unbiased estimation of motif width that is better than those based on currently available scoring functions. This can be seen from examples with HSF1 and LEU3 (<xref ref-type="fig" rid="pcbi-0030090-g005">Figure 5</xref>). Finally, comparing BSGscores to a background distribution from graphs constructed for random sets of promoters enables calculations of statistical significance and identification of promoter sets lacking significant motif enrichment or alternatively those that have a high level of noise.</p><p>In agreement with earlier observations in synthetic data [<xref ref-type="bibr" rid="pcbi-0030090-b035">35</xref>], our results suggest that unlike random promoter sequence sets, input promoter sets enriched in binding by a common TF have densely connected clusters in sequence space. While we chose to use a simple formulation of the weighted clustering coefficient to identify these clusters, other graph clustering approaches can be used to improve binding specificity predictions from BSGs. In their previous work, Pevzner and coworkers suggested using graphical models to predict TFBS [<xref ref-type="bibr" rid="pcbi-0030090-b035">35</xref>]. In that work, the authors dissected a simple formulation limited to exactly one binding site per promoter, a fixed-motif width, and a maximum number of mutations per binding site. The authors proposed using graphs that form cliques to identify TFBS. While useful formulations from a theoretical perspective, constraints presented in that paper are limiting from a practical point of view. Our BSG approach does not make any of the above assumptions on motif structure or occurrence. Thus, we were able to apply BSGs to real datasets and successfully identify binding positions with superior accuracy.</p><p>The graph-construction technique described here uses ensemble Gibbs sampling across a range of motif widths. We observed that sampling at widths close to the biologically relevant motif width will contribute higher-edge weights to the final graph than sampling far from the biological motif width, which mostly contributes nucleotides at the edges. Combining predictions for each motif width, we can predict the width of the biological motif. According to case studies of LEU3 and HSF1, this strategy results in more accurate identification of motif widths as compared with existing scores. Alternatively, we could evaluate a graph for each possible motif width, and select predictions from the best-scoring graph. Constructing a graph for each motif width, however, would require the ensemble sampling procedure to be repeated many times (once for each width of interest). Doing so is computationally infeasible with available technology; we leave a comprehensive analysis of this strategy for a future study.</p><p>Ultimately, using ensemble Gibbs sampling to build BSGs is limited by the sensitivity of Gibbs sampling; thus, constructing BSGs using sampling from more sensitive, faster, or a combination of algorithms [<xref ref-type="bibr" rid="pcbi-0030090-b025">25</xref>] may improve performance. BSGs can also aid in integrating ensemble sampling with diverse biological data such as distance from transcription start site; histone localization; free radical cleavage; DNA bending; and phylogenetic conservation into a coherent, unified framework for identifying TFBS [<xref ref-type="bibr" rid="pcbi-0030090-b036">36</xref>].</p><p>Finally, we used BSGs to predict nucleotide specificity for the majority of TFs in the <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content> genome using input sets generated from the recently performed whole-genome ChIP–chip experiments. We found some interesting patterns that may be used to control the quality of the data or further our understanding of the interactions between coordinately acting TFs. For example, numerous sets of TFs, based both on our predictions and those of other independent studies, have very similar nucleotide specificity (for example: STE12 and DIG1; PHO4, CBF1, and TYE7). In the case of STE12 and DIG1, protein domain analysis indicates the lack of a known DNA binding domain in one of the proteins (DIG1), and experimental evidence shows that STE12 and DIG1 physically interact [<xref ref-type="bibr" rid="pcbi-0030090-b037">37</xref>]. As such, it is likely that DIG1 does not directly bind DNA, but instead co-precipitates with STE12 through formaldehyde crosslinking of protein–protein interactions in ChIP–chip experiments [<xref ref-type="bibr" rid="pcbi-0030090-b038">38</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b039">39</xref>]. Motif similarity may also stem from cooperative or competitive binding between the factors. Importantly, the increased accuracy of BSG predictions allowed us to predict specificity-determining nucleotides for the E-box TFs PHO4, CBF1, and TYE7 [<xref ref-type="bibr" rid="pcbi-0030090-b034">34</xref>]. Two out of the three extended predictions were independently confirmed by recently published experimental results. The third is awaiting further validation.</p></sec><sec id="s4"><title>Materials and Methods</title><sec id="s4a"><title>Ensemble Gibbs sampling.</title><p>We use a threshold Gibbs sampling strategy similar to BioProspector [<xref ref-type="bibr" rid="pcbi-0030090-b017">17</xref>]. Briefly, the threshold sampling strategy uses a high threshold to allow inclusion of multiple sequences per promoter, and a low threshold to allow reporting of no sequences in a promoter. The high threshold is set proportional to the product of the average promoter length and the window width, while the low threshold is initialized to 0, and increased linearly to an upper bound. For a complete description of threshold sampling, see Liu et al. [<xref ref-type="bibr" rid="pcbi-0030090-b017">17</xref>]. Additionally, we include a third-order background model from genomic promoters, and a modified motif score (<inline-formula id="pcbi-0030090-ex002"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030090.ex002" xlink:type="simple"/></inline-formula>
					 instead of <italic>p<sub>i,j</sub></italic>), which we found better emphasized conservation within motif predictions:
					<disp-formula id="pcbi-0030090-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030090.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>N</mml:mi><mml:mo>&times;</mml:mo><mml:mi>exp</mml:mi> <mml:mrow><mml:mo stretchy="true">&lcub;</mml:mo><mml:mrow><mml:mstyle displaystyle='false'><mml:msub><mml:mrow><mml:mo>&sum;</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mstyle displaystyle='true'><mml:msub><mml:mrow><mml:mo>&sum;</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mi>log</mml:mi> <mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">&rcub;</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>where <italic>N</italic> is the number of aligned segments in the motif, <italic>p<sub>i,j</sub></italic> is the probability of nucleotide <italic>j</italic> at position <italic>i</italic> in the motif, and <italic>q<sub>j</sub></italic> is the probability of nucleotide <italic>j</italic> in the third-order background [<xref ref-type="bibr" rid="pcbi-0030090-b017">17</xref>]. We sample until stability (predictions do not change over 1,250 updates) 60 iterations and select the single best-scoring motif observed as a single prediction. We found running the sampler for more stable updates did not significantly alter results.
				</p><p>To evaluate the ensemble Gibbs sampling predictions for a set of input promoters, we mask low-complexity sequences, and proceed to collect 512 Gibbs sampling predictions at each motif width from 6–18 bp. In total, 6,656 binding site predictions are collected from 60 × 6656 = 399,360 Gibbs sampling iterations. The number of predictions used was selected to ensure stability in graph construction, and we found performance deteriorated significantly when constructing graphs from fewer sampling predictions. High-performance computing was utilized to perform the ensemble sampling, requiring between 30 min and 5 h of running time on 1024 × 700 Mhz PowerPC 440 processors. While BSG construction currently requires access to high-performance computing, advancements in the algorithm, Gibbs sampling, and computer technology may all help to make the approach more accessible.</p></sec><sec id="s4b"><title>Binding site graph.</title><p>A BSG is a weighted, undirected graph <italic>G</italic>: = (<italic>V</italic>,<italic>E</italic>) where each vertex <italic>v</italic> ∈ <italic>V</italic> corresponds to a nucleotide in the input set of promoters, and each edge <italic>e</italic> ∈ <italic>E</italic> indicates the alignment of a pair of nucleotides in a binding site for the same TF. Each edge <italic>e</italic> has weight <italic>w<sub>e</sub></italic> that measures the similarity between nucleotides as estimated using Gibbs sampling.</p><p>We also introduce a threshold BSG, constructed by removing all edges with weight less than threshold <italic>ρ</italic> ∈ [0,1] from graph <italic>G</italic>. Formally, <italic>G<sub>ρ</sub></italic>: = (<italic>V<sub>ρ</sub></italic>,<italic>E<sub>ρ</sub></italic>) where <italic>E<sub>ρ</sub></italic> ⊆ <italic>E</italic> and <italic>e</italic> ∈ <italic>E<sub>ρ</sub></italic> ↔ <italic>w<sub>e</sub></italic> ≥ <italic>ρ</italic>; and <italic>V<sub>ρ</sub></italic> ⊆ <italic>V</italic> and <italic>v</italic> ∈ <italic>V<sub>ρ</sub></italic> ↔ {<italic>v</italic> has at least one edge in <italic>E<sub>ρ</sub></italic>}.</p></sec><sec id="s4c"><title>Binding site graph construction.</title><p>For a set of input promoters, we initialize the BSG with one vertex for each nucleotide in the input set, and with no edges (<xref ref-type="fig" rid="pcbi-0030090-g001">Figure 1</xref>A). We evaluate the ensemble behavior of Gibbs sampling over the input. For each pair of aligned nucleotides in each sampling result, we add a unit weight edge between the corresponding vertices in the BSG (<xref ref-type="fig" rid="pcbi-0030090-g001">Figure 1</xref>B). Therefore, if a binding site prediction aligns <italic>N</italic> segments, each <italic>w</italic> nucleotides long, we add <italic>w</italic> · <italic>n</italic>(<italic>n</italic> − 1) / 2 edges to the BSG. If an edge already exists, we instead increase the edge weight by 1. Thus, we weigh each edge by the number of times ensemble Gibbs sampling predictions align the corresponding nucleotides (<xref ref-type="fig" rid="pcbi-0030090-g001">Figure 1</xref>C). After collecting edges from all predictions, we normalize edge weights to [0,1] through division by the maximal possible edge weight (i.e., the number of Gibbs sampling results collected).</p></sec><sec id="s4d"><title>Weighted clustering coefficient.</title><p>For a vertex <italic>k</italic>, let <italic>v</italic> be the number of vertices adjacent to <italic>k</italic>, and let <italic>t</italic> be the number of triangles containing <italic>k</italic>. The clustering coefficient [<xref ref-type="bibr" rid="pcbi-0030090-b028">28</xref>], is defined as:
					<disp-formula id="pcbi-0030090-e003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030090.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>&equals;</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:mi>t</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math> --></disp-formula>
				</p><p>Intuitively, the clustering coefficient is the probability that any two vertices adjacent to <italic>k</italic> have an edge between them. In the dense extreme, when <italic>k</italic> resides in a clique, all vertices adjacent to <italic>k</italic> have an edge between them and the clustering coefficient is 1. In the sparse extreme, when <italic>k</italic> resides in a tree, no edge exists between any two neighbors of <italic>k</italic> and the clustering coefficient is 0. The clustering coefficient is undefined when <italic>k</italic> has less than two adjacent vertices; in such cases, we let <italic>C</italic>(<italic>k</italic>) = 0.</p><p>Numerous generalizations of the clustering coefficient to weighted graphs have been proposed [<xref ref-type="bibr" rid="pcbi-0030090-b040">40</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b041">41</xref>]. We use a definition that weights each triangle by its intensity [<xref ref-type="bibr" rid="pcbi-0030090-b027">27</xref>]:
					<disp-formula id="pcbi-0030090-e004"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030090.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>&equals;</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mstyle displaystyle='false'><mml:msub><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle scriptlevel='+1'><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mstyle></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math> --></disp-formula>where <italic>w<sub>ij</sub></italic> is the weight of the edge connecting vertices <italic>i</italic> and <italic>j</italic>. The weighted clustering coefficient of a graph <italic>G</italic> is the average weighted clustering coefficient over the vertices in <italic>G</italic> [<xref ref-type="bibr" rid="pcbi-0030090-b028">28</xref>]:
					<disp-formula id="pcbi-0030090-e005"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030090.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mover accent='true'><mml:mi>C</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle displaystyle='false'><mml:msub><mml:mrow><mml:mo>&sum;</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>&isin;</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math> --></disp-formula>
				</p></sec><sec id="s4e"><title>Binding site graph TFBS prediction.</title><p>We predict binding sites from a BSG <italic>G</italic> using a two-step process. First, we select a threshold 
					ρˆ that maximizes the BSGscore,
					<disp-formula id="pcbi-0030090-e006"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030090.e006" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mover accent='true'><mml:mi>&rho;</mml:mi><mml:mo>&circ;</mml:mo></mml:mover><mml:mo>&equals;</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mtext>max</mml:mtext> </mml:mrow><mml:mrow><mml:mi>&rho;</mml:mi><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo>&lsqb;</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>&rsqb;</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>&lcub;</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mi>S</mml:mi><mml:mi>G</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>&rho;</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>&rcub;</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>where <inline-formula id="pcbi-0030090-ex003"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030090.ex003" xlink:type="simple"/></inline-formula>
					, P is the maximal edge weighted observed in <italic>G</italic>, and <inline-formula id="pcbi-0030090-ex004"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030090.ex004" xlink:type="simple"/></inline-formula>
					 is the mean weighted clustering coefficient of the BSG filtered at <italic>ρ</italic> (see above). A final BSG <inline-formula id="pcbi-0030090-ex005"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030090.ex005" xlink:type="simple"/></inline-formula>
					 is then created by discarding all edges with weight &lt; 
					ρˆ, and the remaining nucleotides (<italic>V</italic>
					ρˆ) are collected. To convert the collected nucleotides into binding sites, nucleotides adjacent in the original input promoters are joined together into contiguous segments. The segments then serve as seeds for TF binding site predictions. We dust-filter single nucleotide segments from the seeds, and expand the remaining seeds according to a seed extension threshold <italic>τ</italic>. To do so, we evaluate the strength of each nucleotide <italic>n</italic> in the unfiltered BSG,
					<disp-formula id="pcbi-0030090-e007"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030090.e007" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math> --></disp-formula>where <italic>w<sub>n</sub></italic><sub>,<italic>i</italic></sub> is the edge weight between nucleotides <italic>n</italic> and <italic>i</italic>, and <italic>a<sub>n</sub></italic><sub>,<italic>i</italic></sub> is a delta function equal to 1 when an edge exists between <italic>n</italic> and <italic>i</italic>, and equal to 0 otherwise [<xref ref-type="bibr" rid="pcbi-0030090-b041">41</xref>]. The strength of each nucleotide is normalized to <italic>s<sub>i</sub></italic> ∈ [0,1].
				</p><p>Nucleotides adjacent in the original input promoters are grouped together into seed sequences. Initial seeds are then extended to include adjacent 5′ and 3′ nucleotides with s &gt; <italic>τ</italic>. At the most sensitive extreme (<italic>τ</italic> = 0), initial seeds are maximally extended by including all neighboring nucleotides identified by Gibbs sampling. At the most specific extreme (<italic>τ</italic> = 1) the initial seeds are returned, without extension, as predictions. Between these extremes, a tradeoff between sensitivity and PPV is made (<xref ref-type="supplementary-material" rid="pcbi-0030090-sg002">Figure S2</xref>). For the purposes of this study, we used a seed extension threshold of <italic>τ</italic> = 0.7, but other values may be more appropriate for different research needs. Lastly, the extended seeds are dust-filtered to remove predictions 6 bp or shorter.</p></sec><sec id="s4f"><title>Performance evaluation.</title><p>We evaluate BSG performance using the datasets and statistical measures described in Tompa et al. [<xref ref-type="bibr" rid="pcbi-0030090-b013">13</xref>]. Briefly, Tompa et al. create a number of synthetic and real input promoter sets with known binding sites. While the study evaluates input sets from four species (<named-content content-type="genus-species" xlink:type="simple">Homo sapiens</named-content>, <named-content content-type="genus-species" xlink:type="simple">Mus musculus</named-content>, <named-content content-type="genus-species" xlink:type="simple">Drosophila melanogaster</named-content>, and <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content>), performance of each tool on non-yeast datasets was dramatically worse and for poorly understood reasons. Thus we limit our evaluation to the better understood <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content> input sets. We predict binding sites for each input set, and evaluate results according to a number of statistical measures. We compare performance in each measure with the published evaluations of 13 existing methods.</p><p>We calculate statistical measures as follows. At the nucleotide level, true and false positives and negatives (nTP,nTN,nFP,nFN) are counted through comparison with nucleotides in the known binding sites in each input set. At the site level, true positives, false positives, and false negatives (sTP, sFP, sFN) are counted. A true positive (sTP) is defined as a predicted site that overlaps a known site for at least 25% of the known site.</p><p>Based on these counts, we calculate the following nucleotide (<italic>x</italic> = <italic>n</italic>) and/or site (<italic>x</italic> = <italic>s</italic>) level measures:</p><p>Sensitivity: <italic>xSN</italic>: = <italic>xTP</italic>/{<italic>xTP</italic> + <italic>xFN</italic>}</p><p>Positive Predictive Value: <italic>xPPV</italic>: = <italic>xTP</italic>/{<italic>xTP</italic> + <italic>xFP</italic>}</p><p>Specificity: <italic>nSP</italic>: = <italic>nTN</italic>/{<italic>nTN</italic> + <italic>nFP</italic>}</p><p>Correlation coefficient [<xref ref-type="bibr" rid="pcbi-0030090-b042">42</xref>]:
					<disp-formula id="pcbi-0030090-e008"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030090.e008" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>n</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>&sdot;</mml:mo><mml:mi>n</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>n</mml:mi><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo>&sdot;</mml:mo><mml:mi>n</mml:mi><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>&plus;</mml:mo><mml:mi>n</mml:mi><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>&plus;</mml:mo><mml:mi>n</mml:mi><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>&plus;</mml:mo><mml:mi>n</mml:mi><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>&plus;</mml:mo><mml:mi>n</mml:mi><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math> --></disp-formula>
				</p><p>Performance coefficient [<xref ref-type="bibr" rid="pcbi-0030090-b035">35</xref>]: <italic>nPC</italic>: = <italic>nTP</italic>/{<italic>nTP</italic> + <italic>nFN</italic> + <italic>nFP</italic>}</p><p>Average Site Performance: <italic>sASP</italic>: = {<italic>sSn</italic> + <italic>sPPV</italic>}/2</p><p>For a more detailed discussion of statistical measures used, see [<xref ref-type="bibr" rid="pcbi-0030090-b013">13</xref>].</p></sec><sec id="s4g"><title>Motif–motif alignment.</title><p>We use a PWM to represent TF binding motif predictions [<xref ref-type="bibr" rid="pcbi-0030090-b043">43</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b044">44</xref>]. To align PWMs, we use a dynamic programming implementation of a modified ungapped local sequence alignment [<xref ref-type="bibr" rid="pcbi-0030090-b045">45</xref>] similar to that of Pietrokovski [<xref ref-type="bibr" rid="pcbi-0030090-b046">46</xref>]. Similarity between positions in two motifs was measured using Pearson's correlation coefficient:
					<disp-formula id="pcbi-0030090-e009"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030090.e009" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:mi>cov</mml:mi> <mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>&sigma;</mml:mi><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>&sigma;</mml:mi><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>Where <italic>X<sub>i</sub></italic> is the distribution of nucleotides at position <italic>i</italic> in motif <italic>X</italic>; σ<sub><italic>X</italic><sub><italic>i</italic></sub></sub> is the variance at position <italic>i</italic> in motif <italic>X</italic>; and cov(<italic>X<sub>i</sub></italic>,<italic>Y<sub>j</sub></italic>) is the covariance of nucleotides at position <italic>i</italic> in motif <italic>X</italic> with nucleotides at position <italic>j</italic> in motif <italic>Y</italic>. Alignment scores range from 0, representing no positions aligned, to the length of the shorter of the two motifs, representing a perfect match between the two PWMs.
				</p><p>A BSG PWM was considered to match to a previously published PWM if the ratio of the above alignment score (i.e., the optimal local Pearson's correlation coefficient) to the information content of the previously published PWM [<xref ref-type="bibr" rid="pcbi-0030090-b047">47</xref>] is greater than 0.375. It is important to note that the correlation coefficient is at most <italic>w</italic>, with width of the alignment, whereas the mutual information is at most 2<italic>w</italic>.</p></sec><sec id="s4h"><title>Robustness to noisy sequences.</title><p>We use ChIP–chip assays [<xref ref-type="bibr" rid="pcbi-0030090-b038">38</xref>] to identify sets of S<italic>. cerevisiae</italic> promoters bound with high confidence (<italic>p</italic> &lt; 0.001) by the TFs STE12, HAP4, and YDR026C in YPD growth media; and YAP1 in low hydrogen-peroxide conditions [<xref ref-type="bibr" rid="pcbi-0030090-b005">5</xref>]. For each set, we collect promoter sequences (up to 1 kb upstream) to serve as a seed input for binding site predictions.</p><p>We construct noisy input sets by supplementing each seed set with increasing numbers of randomly chosen <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content> promoters. We predict TF binding sites in the seed and noisy sets using both BSGs and Gibbs sampling. We label results as true or false positive (TP,FP) according to motif–motif alignment scores between the predicted and the known TF binding motif [<xref ref-type="bibr" rid="pcbi-0030090-b025">25</xref>], and calculate the PPV:
					<disp-formula id="pcbi-0030090-e010"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030090.e010" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mo>:</mml:mo><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo>&lcub;</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>&rcub;</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>&lcub;</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>&plus;</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>&rcub;</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>i.e., the percentage of predictions similar to the known binding motif.
				</p></sec><sec id="s4i"><title>Genomic <named-content content-type="genus-species" xlink:type="simple">S. cerevisiae</named-content> TF binding motif prediction.</title><p>We use ChIP–chip data [<xref ref-type="bibr" rid="pcbi-0030090-b005">5</xref>,<xref ref-type="bibr" rid="pcbi-0030090-b006">6</xref>] to create input sets for all TFs under every condition studied, as described previously. We use BSGs to predict TF binding motifs for each set containing more than four bound probes. The results of the genomic study are available online at <ext-link ext-link-type="uri" xlink:href="http://cagt10.bu.edu/BSG" xlink:type="simple">http://cagt10.bu.edu/BSG</ext-link>.</p></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi-0030090-sg001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.sg001" xlink:type="simple"><label>Figure S1</label><caption><title>ROC Curve of Binding Site Predictions Made by Selecting Nucleotides Connected by Highly Weighted Edges</title><p>BSGs were constructed for all yeast input sets from Tompa et al. For each data point, an edge weight threshold was selected, and all edges with lower weight were removed from the BSGs. Isolated nucleotides were discarded, and the remaining nucleotides used as TFBS predictions. Sensitivity and specificity were evaluated as described in Tompa et al. (see <xref ref-type="sec" rid="s4">Methods</xref>), and averaged over all BSGs. Increasing the edge weight threshold results in nearly uniform increase in PPV (inset), and a corresponding improvement in specificity at the expense of decreased sensitivity.</p><p>(267 KB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030090-sg002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.sg002" xlink:type="simple"><label>Figure S2</label><caption><title>Effect of Seed Extension Threshold on Nucleotide Sensitivity and on Nucleotide Positive Predictive Value</title><p>BSGs at varying seed extension thresholds (<italic>x</italic>-axis) were used to predict TFBS in a series of real and synthetic datasets constructed by Tompa et al. [<xref ref-type="bibr" rid="pcbi-0030090-b013">13</xref>]. Increasing the seed extension threshold exchanges nucleotide sensitivity (open triangles) for nucleotide PPV (closed triangles). Variations in the threshold had little or no effect on site sensitivity or site PPV (unpublished data).</p><p>(218 KB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030090-sg003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.sg003" xlink:type="simple"><label>Figure S3</label><caption><title>Behavior of the Mean Weighted Clustering Coefficient in BSGs for Signal Sets (Colored Lines with Symbols) and Control Sets (Black Lines)</title><p>At each edge weight threshold (<italic>x</italic>-axis), edges with subthreshold weight are removed from the graph, and isolated nucleotides discarded. The weighted clustering coefficient is averaged over the remaining nucleotides (<italic>y</italic>-axis). Two trends are evident. First, signal sets uniformly attain a higher maximal weighed clustering coefficient (inset). Second, there is generally a positive correlation between mean clustering coefficient and edge weight thresholds in signal sets.</p><p>(106 KB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030090-sg004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.sg004" xlink:type="simple"><label>Figure S4</label><caption><title>Receiver Operating Characteristic of BSG Performance in Yeast, Mouse, and Human Benchmarks</title><p>Points were collected at each level of statistical significance. While BSGs are predictive for each organism, performance on Yeast promoter sets is superior to that on mammalian systems.</p><p>(115 KB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030090-sg005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.sg005" xlink:type="simple"><label>Figure S5</label><caption><title>BSG Prediction of 11 Significant (<italic>p</italic> &lt; 0.1) Motifs That Differ from Previously Published Predictions [<xref ref-type="bibr" rid="pcbi-0030090-b029">29</xref>]</title><p>Differences in prediction may be due to erroneous prediction, coordinated regulation by multiple (possibly physically interacting) TFs, or condition-dependent TF specificities.</p><p>(645 KB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030090-sg006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.sg006" xlink:type="simple"><label>Figure S6</label><caption><title>Novel TF Binding Specificities Predicted Using the BSG Framework Detailed Herein</title><p>In total, BSGs predicted 53 TF specificities for which no previous predictions exits. Displayed are 17 such predictions with <italic>p</italic> &lt; 0.1.</p><p>(645 KB TIF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030090-st001" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030090.st001" xlink:type="simple"><label>Table S1</label><caption><title>Resolving the Nucleotide Specificity of E-Box Binding TFs</title><p>The yeast TFs PHO4, CBF1, and TYE7 are all known to bind E-box motifs but regulate distinct functions. For each factor, the BSG predicts distinct nucleotides flanking the core E-box hexamer CACGTG that may be useful to confer E-box motif specificity to these TFs.</p><p>(27 KB DOC)</p></caption></supplementary-material></sec></body><back><ack><p>This research was partially supported by US National Institutes of Health grants A08 POGM66401A and J50 01–130021 awarded to CD.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>BSG</term><def><p>binding site graph</p></def></def-item><def-item><term>BSGscore</term><def><p>binding site graph score</p></def></def-item><def-item><term>PPV</term><def><p>positive predictive value</p></def></def-item><def-item><term>PWM</term><def><p>position weight matrix; transcription factor</p></def></def-item><def-item><term>TFBS</term><def><p>transcription factor binding sites</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0030090-b001"><label>1</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Cooper</surname><given-names>GM</given-names></name><name name-style="western"><surname>Hausman</surname><given-names>RE</given-names></name></person-group>
					<year>2004</year>
					<source>The cell: A molecular approach</source>
					<publisher-loc>Washington (D.C.)</publisher-loc>
					<publisher-name>ASM Press</publisher-name>
					<publisher-loc>Sunderland (Massachusetts)</publisher-loc>
					<publisher-name>Sinauer Associates</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">713</size>
				</element-citation></ref><ref id="pcbi-0030090-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Buchler</surname><given-names>NE</given-names></name><name name-style="western"><surname>Gerland</surname><given-names>U</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name></person-group>
					<year>2003</year>
					<article-title>On schemes of combinatorial transcription logic.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>100</volume>
					<fpage>5136</fpage>
					<lpage>5141</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kulkarni</surname><given-names>MM</given-names></name><name name-style="western"><surname>Arnosti</surname><given-names>DN</given-names></name></person-group>
					<year>2005</year>
					<article-title><italic>cis</italic>-Regulatory logic of short-range transcriptional repression in <named-content content-type="genus-species" xlink:type="simple">Drosophila melanogaster</named-content>.</article-title>
					<source>Mol Cell Biol</source>
					<volume>25</volume>
					<fpage>3411</fpage>
					<lpage>3420</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Chiang</surname><given-names>DY</given-names></name><name name-style="western"><surname>Nix</surname><given-names>DA</given-names></name><name name-style="western"><surname>Shultzaberger</surname><given-names>RK</given-names></name><name name-style="western"><surname>Gasch</surname><given-names>AP</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>MB</given-names></name></person-group>
					<year>2006</year>
					<article-title>Flexible promoter architecture requirements for coactivator recruitment.</article-title>
					<source>BMC Mol Biol</source>
					<volume>7</volume>
					<fpage>16</fpage>
				</element-citation></ref><ref id="pcbi-0030090-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Harbison</surname><given-names>CT</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>DB</given-names></name><name name-style="western"><surname>Lee</surname><given-names>TI</given-names></name><name name-style="western"><surname>Rinaldi</surname><given-names>NJ</given-names></name><name name-style="western"><surname>MacIsaac</surname><given-names>KD</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>Transcriptional regulatory code of a eukaryotic genome.</article-title>
					<source>Nature</source>
					<volume>431</volume>
					<fpage>99</fpage>
					<lpage>104</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>TI</given-names></name><name name-style="western"><surname>Rinaldi</surname><given-names>NJ</given-names></name><name name-style="western"><surname>Robert</surname><given-names>F</given-names></name><name name-style="western"><surname>Odom</surname><given-names>DT</given-names></name><name name-style="western"><surname>Bar-Joseph</surname><given-names>Z</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>Transcriptional regulatory networks in <named-content content-type="genus-species" xlink:type="simple">Saccharomyces cerevisiae</named-content>.</article-title>
					<source>Science</source>
					<volume>298</volume>
					<fpage>799</fpage>
					<lpage>804</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kang</surname><given-names>SH</given-names></name><name name-style="western"><surname>Vieira</surname><given-names>K</given-names></name><name name-style="western"><surname>Bungert</surname><given-names>J</given-names></name></person-group>
					<year>2002</year>
					<article-title>Combining chromatin immunoprecipitation and DNA footprinting: A novel method to analyze protein–DNA interactions in vivo.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>30</volume>
					<elocation-id>e44</elocation-id>
				</element-citation></ref><ref id="pcbi-0030090-b008"><label>8</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name><name name-style="western"><surname>Elkan</surname><given-names>C</given-names></name></person-group>
					<year>1994</year>
					<source>Fitting a mixture model by expectation maximization to discover motifs in biopolymers</source>
					<publisher-loc>Menlo Park (California)</publisher-loc>
					<publisher-name>AAAI Press</publisher-name>
					<fpage>28</fpage>
					<lpage>36</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Boguski</surname><given-names>MS</given-names></name><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name><name name-style="western"><surname>Neuwald</surname><given-names>AF</given-names></name><etal/></person-group>
					<year>1993</year>
					<article-title>Detecting subtle sequence signals: A Gibbs sampling strategy for multiple alignment.</article-title>
					<source>Science</source>
					<volume>262</volume>
					<fpage>208</fpage>
					<lpage>214</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bussemaker</surname><given-names>HJ</given-names></name><name name-style="western"><surname>Li</surname><given-names>H</given-names></name><name name-style="western"><surname>Siggia</surname><given-names>ED</given-names></name></person-group>
					<year>2000</year>
					<article-title>From the cover: Building a dictionary for genomes: Identification of presumptive regulatory sites by statistical analysis.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>97</volume>
					<fpage>10096</fpage>
					<lpage>10100</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b011"><label>11</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pavesi</surname><given-names>G</given-names></name><name name-style="western"><surname>Mereghetti</surname><given-names>P</given-names></name><name name-style="western"><surname>Mauri</surname><given-names>G</given-names></name><name name-style="western"><surname>Pesole</surname><given-names>G</given-names></name></person-group>
					<year>2004</year>
					<article-title>Weeder Web: Discovery of transcription factor binding sites in a set of sequences from co-regulated genes.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>W199</fpage>
					<lpage>W203</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hughes</surname><given-names>JD</given-names></name><name name-style="western"><surname>Estep</surname><given-names>PW</given-names></name><name name-style="western"><surname>Tavazoie</surname><given-names>S</given-names></name><name name-style="western"><surname>Church</surname><given-names>GM</given-names></name></person-group>
					<year>2000</year>
					<article-title>Computational identification of <italic>cis</italic>-regulatory elements associated with groups of functionally related genes in <named-content content-type="genus-species" xlink:type="simple">Saccharomyces cerevisiae</named-content>.</article-title>
					<source>J Mol Biol</source>
					<volume>296</volume>
					<fpage>1205</fpage>
					<lpage>1214</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b013"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tompa</surname><given-names>M</given-names></name><name name-style="western"><surname>Li</surname><given-names>N</given-names></name><name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name><name name-style="western"><surname>Church</surname><given-names>GM</given-names></name><name name-style="western"><surname>De Moor</surname><given-names>B</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Assessing computational tools for the discovery of transcription factor binding sites.</article-title>
					<source>Nat Biotechnol</source>
					<volume>23</volume>
					<fpage>137</fpage>
					<lpage>144</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Keich</surname><given-names>U</given-names></name><name name-style="western"><surname>Pevzner</surname><given-names>PA</given-names></name></person-group>
					<year>2002</year>
					<article-title>Finding motifs in the twilight zone.</article-title>
					<source>Bioinformatics</source>
					<volume>18</volume>
					<fpage>1374</fpage>
					<lpage>1381</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Keich</surname><given-names>U</given-names></name><name name-style="western"><surname>Pevzner</surname><given-names>PA</given-names></name></person-group>
					<year>2002</year>
					<article-title>Subtle motifs: Defining the limits of motif finding algorithms.</article-title>
					<source>Bioinformatics</source>
					<volume>18</volume>
					<fpage>1382</fpage>
					<lpage>1390</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ihmels</surname><given-names>J</given-names></name><name name-style="western"><surname>Bergmann</surname><given-names>S</given-names></name><name name-style="western"><surname>Gerami-Nejad</surname><given-names>M</given-names></name><name name-style="western"><surname>Yanai</surname><given-names>I</given-names></name><name name-style="western"><surname>McClellan</surname><given-names>M</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Rewiring of the yeast transcriptional network through the evolution of motif usage.</article-title>
					<source>Science</source>
					<volume>309</volume>
					<fpage>938</fpage>
					<lpage>940</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b017"><label>17</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>X</given-names></name><name name-style="western"><surname>Brutlag</surname><given-names>DL</given-names></name><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name></person-group>
					<year>2001</year>
					<article-title>BioProspector: Discovering conserved DNA motifs in upstream regulatory regions of co-expressed genes.</article-title>
					<source>Pac Symp Biocomput</source>
					<fpage>127</fpage>
					<lpage>138</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Frith</surname><given-names>MC</given-names></name><name name-style="western"><surname>Hansen</surname><given-names>U</given-names></name><name name-style="western"><surname>Spouge</surname><given-names>JL</given-names></name><name name-style="western"><surname>Weng</surname><given-names>Z</given-names></name></person-group>
					<year>2004</year>
					<article-title>Finding functional sequence elements by multiple local alignment.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>189</fpage>
					<lpage>200</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Moses</surname><given-names>AM</given-names></name><name name-style="western"><surname>Chiang</surname><given-names>DY</given-names></name><name name-style="western"><surname>Kellis</surname><given-names>M</given-names></name><name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>MB</given-names></name></person-group>
					<year>2003</year>
					<article-title>Position specific variation in the rate of evolution in transcription factor binding sites.</article-title>
					<source>BMC Evol Biol</source>
					<volume>3</volume>
					<fpage>19</fpage>
				</element-citation></ref><ref id="pcbi-0030090-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Moses</surname><given-names>AM</given-names></name><name name-style="western"><surname>Chiang</surname><given-names>DY</given-names></name><name name-style="western"><surname>Pollard</surname><given-names>DA</given-names></name><name name-style="western"><surname>Iyer</surname><given-names>VN</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>MB</given-names></name></person-group>
					<year>2004</year>
					<article-title>MONKEY: Identifying conserved transcription-factor binding sites in multiple alignments using a binding site-specific evolutionary model.</article-title>
					<source>Genome Biol</source>
					<volume>5</volume>
					<fpage>R98</fpage>
				</element-citation></ref><ref id="pcbi-0030090-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Frith</surname><given-names>MC</given-names></name><name name-style="western"><surname>Li</surname><given-names>MC</given-names></name><name name-style="western"><surname>Weng</surname><given-names>Z</given-names></name></person-group>
					<year>2003</year>
					<article-title>Cluster-Buster: Finding dense clusters of motifs in DNA sequences.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>3666</fpage>
					<lpage>3668</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Cliften</surname><given-names>P</given-names></name><name name-style="western"><surname>Sudarsanam</surname><given-names>P</given-names></name><name name-style="western"><surname>Desikan</surname><given-names>A</given-names></name><name name-style="western"><surname>Fulton</surname><given-names>L</given-names></name><name name-style="western"><surname>Fulton</surname><given-names>B</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Finding functional features in <italic>Saccharomyces</italic> genomes by phylogenetic footprinting.</article-title>
					<source>Science</source>
					<volume>301</volume>
					<fpage>71</fpage>
					<lpage>76</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Siddharthan</surname><given-names>R</given-names></name><name name-style="western"><surname>Siggia</surname><given-names>ED</given-names></name><name name-style="western"><surname>van Nimwegen</surname><given-names>E</given-names></name></person-group>
					<year>2005</year>
					<article-title>PhyloGibbs: A Gibbs sampling motif finder that incorporates phylogeny.</article-title>
					<source>PLoS Comput Biol</source>
					<volume>1</volume>
					<elocation-id>e67.</elocation-id>
				</element-citation></ref><ref id="pcbi-0030090-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Thijs</surname><given-names>G</given-names></name><name name-style="western"><surname>Marchal</surname><given-names>K</given-names></name><name name-style="western"><surname>Lescot</surname><given-names>M</given-names></name><name name-style="western"><surname>Rombauts</surname><given-names>S</given-names></name><name name-style="western"><surname>De Moor</surname><given-names>B</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>A Gibbs sampling method to detect overrepresented motifs in the upstream regions of coexpressed genes.</article-title>
					<source>J Comput Biol</source>
					<volume>9</volume>
					<fpage>447</fpage>
					<lpage>464</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Reddy</surname><given-names>TE</given-names></name><name name-style="western"><surname>Shakhnovich</surname><given-names>BE</given-names></name><name name-style="western"><surname>Roberts</surname><given-names>DS</given-names></name><name name-style="western"><surname>Russek</surname><given-names>SJ</given-names></name><name name-style="western"><surname>Delisi</surname><given-names>C</given-names></name></person-group>
					<year>2007</year>
					<article-title>Positional clustering improves computational binding site detection and identifies novel <italic>cis</italic>-regulatory sites in mammalian GABAA receptor subunit genes.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>35</volume>
					<elocation-id>e20</elocation-id>
				</element-citation></ref><ref id="pcbi-0030090-b026"><label>26</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Fratkin</surname><given-names>E</given-names></name><name name-style="western"><surname>Naughton</surname><given-names>BT</given-names></name><name name-style="western"><surname>Brutlag</surname><given-names>DL</given-names></name><name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name></person-group>
					<year>2006</year>
					<article-title>MotifCut: Regulatory motifs finding with maximum density subgraphs.</article-title>
					<source>Bioinformatics</source>
					<volume>22</volume>
					<fpage>e150</fpage>
					<lpage>157</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Onnela</surname><given-names>J-P</given-names></name><name name-style="western"><surname>Saramaki</surname><given-names>J</given-names></name><name name-style="western"><surname>Kertesz</surname><given-names>J</given-names></name><name name-style="western"><surname>Kaski</surname><given-names>K</given-names></name></person-group>
					<year>2005</year>
					<article-title>Intensity and coherence of motifs in weighted complex networks.</article-title>
					<source>Phys Rev E (Stat Nonlinear Soft Matt Phys)</source>
					<volume>71</volume>
					<fpage>065103</fpage>
				</element-citation></ref><ref id="pcbi-0030090-b028"><label>28</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Watts</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Strogatz</surname><given-names>SH</given-names></name></person-group>
					<year>1998</year>
					<article-title>Collective dynamics of “small-world” networks.</article-title>
					<source>Nature</source>
					<volume>393</volume>
					<fpage>440</fpage>
					<lpage>442</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>MacIsaac</surname><given-names>KD</given-names></name><name name-style="western"><surname>Wang</surname><given-names>T</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>BD</given-names></name><name name-style="western"><surname>Gifford</surname><given-names>DK</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>An improved map of conserved regulatory sites for <named-content content-type="genus-species" xlink:type="simple">Saccharomyces cerevisiae</named-content>.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>7</volume>
					<fpage>113</fpage>
				</element-citation></ref><ref id="pcbi-0030090-b030"><label>30</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kato</surname><given-names>M</given-names></name><name name-style="western"><surname>Hata</surname><given-names>N</given-names></name><name name-style="western"><surname>Banerjee</surname><given-names>N</given-names></name><name name-style="western"><surname>Futcher</surname><given-names>B</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>MQ</given-names></name></person-group>
					<year>2004</year>
					<article-title>Identifying combinatorial regulation of transcription factors and binding motifs.</article-title>
					<source>Genome Biol</source>
					<volume>5</volume>
					<fpage>R56</fpage>
				</element-citation></ref><ref id="pcbi-0030090-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ihmels</surname><given-names>J</given-names></name><name name-style="western"><surname>Bergmann</surname><given-names>S</given-names></name><name name-style="western"><surname>Barkai</surname><given-names>N</given-names></name></person-group>
					<year>2004</year>
					<article-title>Defining transcription modules using large-scale gene expression data.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<fpage>1993</fpage>
					<lpage>2003</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b032"><label>32</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bar-Joseph</surname><given-names>Z</given-names></name><name name-style="western"><surname>Gerber</surname><given-names>GK</given-names></name><name name-style="western"><surname>Lee</surname><given-names>TI</given-names></name><name name-style="western"><surname>Rinaldi</surname><given-names>NJ</given-names></name><name name-style="western"><surname>Yoo</surname><given-names>JY</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Computational discovery of gene modules and regulatory networks.</article-title>
					<source>Nat Biotechnol</source>
					<volume>21</volume>
					<fpage>1337</fpage>
					<lpage>1342</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b033"><label>33</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Friberg</surname><given-names>M</given-names></name><name name-style="western"><surname>von Rohr</surname><given-names>P</given-names></name><name name-style="western"><surname>Gonnet</surname><given-names>G</given-names></name></person-group>
					<year>2005</year>
					<article-title>Scoring functions for transcription factor binding site prediction.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>6</volume>
					<fpage>84</fpage>
				</element-citation></ref><ref id="pcbi-0030090-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Maerkl</surname><given-names>SJ</given-names></name><name name-style="western"><surname>Quake</surname><given-names>SR</given-names></name></person-group>
					<year>2007</year>
					<article-title>A systems approach to measuring the binding energy landscapes of transcription factors.</article-title>
					<source>Science</source>
					<volume>315</volume>
					<fpage>233</fpage>
					<lpage>237</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b035"><label>35</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pevzner</surname><given-names>PA</given-names></name><name name-style="western"><surname>Sze</surname><given-names>SH</given-names></name></person-group>
					<year>2000</year>
					<article-title>Combinatorial approaches to finding subtle signals in DNA sequences.</article-title>
					<source>Proc Int Conf Intell Syst Mol Biol</source>
					<volume>8</volume>
					<fpage>269</fpage>
					<lpage>278</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b036"><label>36</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zaslavsky</surname><given-names>E</given-names></name><name name-style="western"><surname>Singh</surname><given-names>M</given-names></name></person-group>
					<year>2006</year>
					<article-title>A combinatorial optimization approach for diverse motif finding applications.</article-title>
					<source>Algorithms Mol Biol</source>
					<volume>1</volume>
					<fpage>13</fpage>
				</element-citation></ref><ref id="pcbi-0030090-b037"><label>37</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Olson</surname><given-names>KA</given-names></name><name name-style="western"><surname>Nelson</surname><given-names>C</given-names></name><name name-style="western"><surname>Tai</surname><given-names>G</given-names></name><name name-style="western"><surname>Hung</surname><given-names>W</given-names></name><name name-style="western"><surname>Yong</surname><given-names>C</given-names></name><etal/></person-group>
					<year>2000</year>
					<article-title>Two regulators of Ste12p inhibit pheromone-responsive transcription by separate mechanisms.</article-title>
					<source>Mol Cell Biol</source>
					<volume>20</volume>
					<fpage>4199</fpage>
					<lpage>4209</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b038"><label>38</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Buck</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Lieb</surname><given-names>JD</given-names></name></person-group>
					<year>2004</year>
					<article-title>ChIP–chip: Considerations for the design, analysis, and application of genome-wide chromatin immunoprecipitation experiments.</article-title>
					<source>Genomics</source>
					<volume>83</volume>
					<fpage>349</fpage>
					<lpage>360</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b039"><label>39</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Takahashi</surname><given-names>K</given-names></name><name name-style="western"><surname>Saitoh</surname><given-names>S</given-names></name><name name-style="western"><surname>Yanagida</surname><given-names>M</given-names></name></person-group>
					<year>2000</year>
					<article-title>Application of the chromatin immunoprecipitation method to identify in vivo protein–DNA associations in fission yeast.</article-title>
					<source>Sci STKE</source>
					<volume>2000</volume>
					<fpage>PL1</fpage>
				</element-citation></ref><ref id="pcbi-0030090-b040"><label>40</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kalna</surname><given-names>G</given-names></name><name name-style="western"><surname>Higham</surname><given-names>DJ</given-names></name></person-group>
					<year>2006</year>
					<article-title>Clustering coefficients for weighted networks.</article-title>
					<publisher-loc>Glasgow</publisher-loc>
					<source>University of Strathclyde Mathematics Research Report Number 3</source>
				</element-citation></ref><ref id="pcbi-0030090-b041"><label>41</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Barrat</surname><given-names>A</given-names></name><name name-style="western"><surname>Barthelemy</surname><given-names>M</given-names></name><name name-style="western"><surname>Pastor-Satorras</surname><given-names>R</given-names></name><name name-style="western"><surname>Vespignani</surname><given-names>A</given-names></name></person-group>
					<year>2004</year>
					<article-title>The architecture of complex weighted networks.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>101</volume>
					<fpage>3747</fpage>
					<lpage>3752</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b042"><label>42</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Burset</surname><given-names>M</given-names></name><name name-style="western"><surname>Guigo</surname><given-names>R</given-names></name></person-group>
					<year>1996</year>
					<article-title>Evaluation of gene structure prediction programs.</article-title>
					<source>Genomics</source>
					<volume>34</volume>
					<fpage>353</fpage>
					<lpage>367</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b043"><label>43</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>
					<year>1990</year>
					<article-title>Consensus patterns in DNA.</article-title>
					<source>Methods Enzymol</source>
					<volume>183</volume>
					<fpage>211</fpage>
					<lpage>221</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b044"><label>44</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>
					<year>2000</year>
					<article-title>DNA binding sites: Representation and discovery.</article-title>
					<source>Bioinformatics</source>
					<volume>16</volume>
					<fpage>16</fpage>
					<lpage>23</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b045"><label>45</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>TF</given-names></name><name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name></person-group>
					<year>1981</year>
					<article-title>Identification of common molecular subsequences.</article-title>
					<source>J Mol Biol</source>
					<volume>147</volume>
					<fpage>195</fpage>
					<lpage>197</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b046"><label>46</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pietrokovski</surname><given-names>S</given-names></name></person-group>
					<year>1996</year>
					<article-title>Searching databases of conserved sequence regions by aligning protein multiple-alignments [published erratum appears in Nucleic Acids Res 24: 4372].</article-title>
					<source>Nucleic Acids Res</source>
					<volume>24</volume>
					<fpage>3836</fpage>
					<lpage>3845</lpage>
				</element-citation></ref><ref id="pcbi-0030090-b047"><label>47</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name><name name-style="western"><surname>Fields</surname><given-names>DS</given-names></name></person-group>
					<year>1998</year>
					<article-title>Specificity, free energy and information content in protein–DNA interactions.</article-title>
					<source>Trends Biochem Sci</source>
					<volume>23</volume>
					<fpage>109</fpage>
					<lpage>113</lpage>
				</element-citation></ref></ref-list></back></article>