<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004322</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-02099</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Changes in Postural Syntax Characterize Sensory Modulation and Natural Variation of <italic>C</italic>. <italic>elegans</italic> Locomotion</article-title>
<alt-title alt-title-type="running-head">Syntax in <italic>C</italic>. <italic>elegans</italic> Locomotion</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Schwarz</surname>
<given-names>Roland F.</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Branicky</surname>
<given-names>Robyn</given-names>
</name>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Grundy</surname>
<given-names>Laura J.</given-names>
</name>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Schafer</surname>
<given-names>William R.</given-names>
</name>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Brown</surname>
<given-names>André E. X.</given-names>
</name>
<xref rid="aff003" ref-type="aff"><sup>3</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>European Bioinformatics Institute, Hinxton, United Kingdom</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>MRC Laboratory of Molecular Biology, Cambridge, United Kingdom</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>MRC Clinical Sciences Centre, Imperial College London, London, United Kingdom</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ayers</surname>
<given-names>Joseph</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Northeastern University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: RB WRS AEXB. Performed the experiments: RB LJG. Analyzed the data: RFS AEXB. Wrote the paper: RFS RB WRS AEXB.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">andre.brown@imperial.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>21</day>
<month>8</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>8</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>8</issue>
<elocation-id>e1004322</elocation-id>
<history>
<date date-type="received">
<day>20</day>
<month>11</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>5</day>
<month>5</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Schwarz et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004322" xlink:type="simple"/>
<abstract>
<p>Locomotion is driven by shape changes coordinated by the nervous system through time; thus, enumerating an animal's complete repertoire of shape transitions would provide a basis for a comprehensive understanding of locomotor behaviour. Here we introduce a discrete representation of behaviour in the nematode <italic>C</italic>. <italic>elegans</italic>. At each point in time, the worm’s posture is approximated by its closest matching template from a set of 90 postures and locomotion is represented as sequences of postures. The frequency distribution of postural sequences is heavy-tailed with a core of frequent behaviours and a much larger set of rarely used behaviours. Responses to optogenetic and environmental stimuli can be quantified as changes in postural syntax: worms show different preferences for different sequences of postures drawn from the same set of templates. A discrete representation of behaviour will enable the use of methods developed for other kinds of discrete data in bioinformatics and language processing to be harnessed for the study of behaviour.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Technology for recording neural activity is advancing rapidly and whole-brain imaging with single neuron resolution has already been demonstrated for smaller animals. To interpret such complex neural recordings, we need comprehensive characterizations of behaviour, which is the principal output of the brain. Animal tracking can increasingly be performed automatically but an outstanding challenge is finding ways to represent these behavioural data. We have focused on the movement of the nematode worm <italic>C</italic>. <italic>elegans</italic> to develop a quantitative representation of behaviour as a series of distinct postures. Each posture is analogous to a word in a language and so we can directly count the number of phrases that makes up the <italic>C</italic>. <italic>elegans</italic> behavioural repertoire. <italic>C</italic>. <italic>elegans</italic> has a very small nervous system but we find that its behavioural repertoire is still complex. As with human languages, there is a large number of possible phrases, but most are rarely used. When comparing different populations of worms or worms in different environments, we find that the difference between their behaviour is due to a subset of their entire repertoire. In the language analogy, these would correspond to idiomatic phrases that distinguish groups of speakers. A quantitative understanding of the nature of behavioural variation will inform research on the function and evolution of neural circuits.</p>
</abstract>
<funding-group>
<funding-statement>This work was funded by the Medical Research Council through grants MC-A022-5PB91 to WRS and MC-A658-5TY30 to AEXB, by the National Institutes of Health through grant RO1 DA018341 to WRS, and supported in part by the National Science Foundation under Grant No. PHYS-1066293 and the hospitality of the Aspen Center for Physics. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="0"/>
<page-count count="16"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>Data are available from the Worm Behavior Database: <ext-link ext-link-type="uri" xlink:href="http://wormbehavior.mrc-lmb.cam.ac.uk/" xlink:type="simple">http://wormbehavior.mrc-lmb.cam.ac.uk/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec002" sec-type="intro">
<title>Introduction</title>
<p>Animal behaviour can be difficult to study because it involves complex movements that vary continuously in time. This is especially true for limbed animals such as insects and mammals, because they have many degrees of freedom and can adopt an even larger number of different postures. Detailed characterization without explicit posture quantification is possible [<xref rid="pcbi.1004322.ref001" ref-type="bibr">1</xref>], but researchers commonly use alternative methods for controlling behavioural complexity. In ethology, complexity is often controlled through careful observation to identify a set of behavioural categories that can then be scored to assess differences between individuals, between species, and over time [<xref rid="pcbi.1004322.ref002" ref-type="bibr">2</xref>]. This has the advantage that observations can be carried out in an animal’s natural habitat where it is able to behave freely. However, the choice of categories may introduce unwanted bias and inter-observer variability can reduce reproducibility [<xref rid="pcbi.1004322.ref003" ref-type="bibr">3</xref>]. In laboratory-based studies it is possible to impose constraints on the animal, ranging from physically restraining some parts of the body to training an animal to perform a predefined task such as pressing a lever or solving a maze. Constraints reduce measurement dimensionality and can aid interpretation but may also mask variation which may be important for understanding the genetic or neural control of behaviour [<xref rid="pcbi.1004322.ref004" ref-type="bibr">4</xref>].</p>
<p>Here we adopt an increasingly common [<xref rid="pcbi.1004322.ref005" ref-type="bibr">5</xref>,<xref rid="pcbi.1004322.ref006" ref-type="bibr">6</xref>] intermediate approach in which we record animals in a laboratory environment, but with minimal constraints. <italic>Caenorhabditis elegans</italic> is a useful animal for addressing questions of behavioural representation because it has a simple morphology and its movement can be confined to the two-dimensional surface of an agar plate. It has also been characterized exhaustively in several relevant respects: in addition to a complete genome sequence [<xref rid="pcbi.1004322.ref007" ref-type="bibr">7</xref>], we know the developmental lineage of all of its cells from the single-celled embryo to the adult [<xref rid="pcbi.1004322.ref008" ref-type="bibr">8</xref>], and it has the most complete connectome—the wiring diagram of its neurons—of any animal [<xref rid="pcbi.1004322.ref009" ref-type="bibr">9</xref>]. These reference data are powerful in part because of their completeness, making it possible to characterize differences due to genetic, evolutionary, or environmental perturbations systematically. An analogous systematic characterization of <italic>C</italic>. <italic>elegans</italic> locomotion could also be a useful tool for studying behaviour.</p>
<p>To move on the surface of an agar plate, <italic>C</italic>. <italic>elegans</italic> propagates bends along its body. It is not clear whether the locomotor wave is generated by a central pattern generator [<xref rid="pcbi.1004322.ref010" ref-type="bibr">10</xref>], but there is evidence that once generated, waves are driven by proprioceptive coupling between body segments [<xref rid="pcbi.1004322.ref011" ref-type="bibr">11</xref>]. During navigation, <italic>C</italic>. <italic>elegans</italic> switches between bouts of forward and backwards locomotion [<xref rid="pcbi.1004322.ref012" ref-type="bibr">12</xref>] and uses both abrupt and gradual turns during directed behaviours [<xref rid="pcbi.1004322.ref013" ref-type="bibr">13</xref>,<xref rid="pcbi.1004322.ref014" ref-type="bibr">14</xref>] and when searching in a relatively featureless environment [<xref rid="pcbi.1004322.ref015" ref-type="bibr">15</xref>,<xref rid="pcbi.1004322.ref016" ref-type="bibr">16</xref>]. While performing these manoeuvres, <italic>C</italic>. <italic>elegans</italic> adopts postures in a low dimensional shape space [<xref rid="pcbi.1004322.ref017" ref-type="bibr">17</xref>]. However, knowing the dimensionality of the space still leaves open the question of which regions of shape space worms visit and which trajectories they tend to follow. The method we describe here is meant to address this question directly.</p>
<p>We previously described a method of constructing a dictionary of behavioural motifs [<xref rid="pcbi.1004322.ref018" ref-type="bibr">18</xref>], which are short patterns of repeated motion, and showed that such a dictionary could be useful for identifying and comparing mutant phenotypes in <italic>C</italic>. <italic>elegans</italic>. However, because motifs can overlap there will be significant redundancy in the representation before completeness is achieved. To solve this problem, we have developed an alternative method of characterising locomotion in terms of a sequence of discrete postures, which serve as building blocks for more complex motifs. We found that 90 distinct postures are sufficient to account for 82% of postural variance. A discrete representation enables efficient enumeration of postural sequences and makes it possible to address questions about behavioural plasticity in response to stimulation and natural variation in spontaneous locomotion. We found that freely moving worms have a core set of frequently used sequences and a much larger set of rarely used sequences. When worms adapt their behaviour in response to environmental conditions such as a lack of food or the presence of an attractive chemical, we find that they adjust the syntax of their locomotion (i.e. their preference for different postural sequences), but that their shapes are still accounted for using the same set of template postures. Similarly, between populations of <italic>C</italic>. <italic>elegans</italic> isolated from different parts of the world, we find that they have a similar rank-frequency distribution of behaviours, but with significant variations in sequence preference.</p>
</sec>
<sec id="sec003" sec-type="results">
<title>Results</title>
<sec id="sec004">
<title>Ninety template postures capture wild type worm shapes on food</title>
<p>We tracked single worms using a Dino-Lite USB microscope mounted on a motorized stage, as previously described [<xref rid="pcbi.1004322.ref019" ref-type="bibr">19</xref>]. Worms were segmented from the background using the Otsu threshold and the skeleton was calculated by tracing the midline along the worm body connecting the head and the tail. We then measured the tangent angle at 49 points equally spaced along the worm and subtracted the average angle to achieve a position and orientation independent measure posture [<xref rid="pcbi.1004322.ref017" ref-type="bibr">17</xref>]. These angles change as the worm bends its body during crawling. Although a worm’s posture varies continuously through time, at any given moment the current posture can be approximated by the closest matching template from a pre-defined set of postures. This is analogous to constructing a histogram, in which discrete bins are used to represent data drawn from a continuous distribution.</p>
<p>The first step was to select a set of template postures that was as small as possible while still having enough elements to capture most of the observed variability. Instead of using uniformly spaced bins to define the templates we used <italic>k</italic>-means clustering, which attempts to minimize the distance between <italic>k</italic> templates (the cluster centres) and the data (the set of input postures measured from wild-type worms crawling on an agar plate seeded with bacterial food). As a distance metric, we used the squared difference between the tangent angle vectors of two worm skeletons. As the number of template postures is increased (<italic>k</italic> in <italic>k</italic>-means), the R<sup>2</sup> between the original postures and their nearest neighbours improves (<bold><xref rid="pcbi.1004322.g001" ref-type="fig">Fig 1A</xref></bold>). After 90 postures, the rate of improvement plateaus at a small value (<xref rid="pcbi.1004322.g001" ref-type="fig">Fig 1A</xref>, inset). We therefore used 90 postures for subsequent analyses. The most common postures in this set of templates are sinuous and correspond to different phases of locomotion at different curvatures (<bold><xref rid="pcbi.1004322.g001" ref-type="fig">Fig 1B</xref></bold>). The rare postures include more highly curved shapes that worms adopt during turns as well as straighter shapes that are occasionally observed during dwelling. The full set of 90 postures ordered by frequency is plotted in <bold><xref rid="pcbi.1004322.s001" ref-type="supplementary-material">S1 Fig</xref></bold>. Using this set of template postures, locomotion can be represented compactly. At any point in time, a worm’s posture is matched to its nearest-neighbour in the set of template postures and so a bout of locomotion can be simply recorded as a series of labels indicating which of the representative postures is closest (<bold><xref rid="pcbi.1004322.g001" ref-type="fig">Fig 1C</xref></bold>).</p>
<fig id="pcbi.1004322.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004322.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Discrete representation of worm locomotion by clustering.</title>
<p><bold>(A)</bold> As the number of template postures increases, the R<sup>2</sup> of the fit between original body angles and nearest neighbour matches increases (points show mean ± standard deviation for 50 worms, 15 000 frames each). The inset shows the rate of increase in R<sup>2</sup> for increasing <italic>k</italic>. The red dashed line is the average increase in R<sup>2</sup> per posture for <italic>k</italic> = 100–500 (2.4 x 10<sup>−4</sup> per posture). <bold>(B)</bold> Probability of observing each of the 90 template postures. Selected postures are shown as skeletons with the head indicated by the blue dot. The grey label indicates their rank by frequency with 1 being the most common posture. (<bold>C)</bold> Locomotion is represented by a series of discrete template postures. In each frame, the original skeleton (black) is represented by its nearest neighbour (coloured overlay) in the set of 90 template postures. The duration spent in each posture is also recorded and shown as the alternating coloured bands. Each segment of repeated postures is collapsed to a single label and it is this sequence of states that represents locomotion (i.e. {3, 3, 89, 5, 5, 5, 5, 87, 87, 87, …} becomes {3, 89, 5, 87}).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004322.g001" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Posture sequences are complex but countable</title>
<p>Repeated patterns of behaviour can now be found simply by finding repeating sequences of postures, including subsequences sampled from longer segments. It is also possible to match similar behaviours performed at different speeds by removing repeated elements from a sequence. For example, if a worm is moving slowly, its nearest-neighbour template posture might not change over several frames leading to a sequence with repeats such as {3, 3, 89, 5, 5, 5, 5, 87, 87, 87, …} (see durations bar in <xref rid="pcbi.1004322.g001" ref-type="fig">Fig 1C</xref>). We reduce this sequence to {3, 89, 5, 87} so that it will be recognized regardless of how slowly the transitions are made. We used this simple kind of non-uniform time warping for all of the sequence results presented in this paper.</p>
<p>In a discrete representation, the behavioural repertoire can be enumerated directly by counting the variety of sequences that are observed. We do this by counting the number of observed <italic>n</italic>-grams. An <italic>n</italic>-gram is any sequence of <italic>n</italic> states, including overlaps. In the sequence {3, 89, 5, 87} the bigrams are {3, 89}, {89, 5}, and {5, 87}, the trigrams are {3, 89, 5} and {89, 5, 87}, and the sequence is itself a single 4-gram. For longer sequences, there are more possible <italic>n</italic>-grams but because of repeats, the number of <italic>unique n</italic>-grams will be less than the total number observed. There is therefore a sublinear growth in the number of unique <italic>n</italic>-grams as more sequences are observed and the degree of this difference is a measure of the structure in the sequence. <bold><xref rid="pcbi.1004322.g002" ref-type="fig">Fig 2A</xref></bold> shows how the number of unique <italic>n</italic>-grams, for <italic>n</italic> = 2–5, grows with total sequence length for the laboratory strain N2. Individual blue lines show data from 100 worms, each recorded for 15 minutes, randomly selected from the total data set of 1262 individuals. Orange lines show accumulation curves for sequences that have been shuffled to destroy temporal order but maintain the relative frequency of postures.</p>
<fig id="pcbi.1004322.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004322.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Worm locomotion sequences are complex but can be fit by a trigram model.</title>
<p><bold>(A)</bold> <italic>n</italic>-gram accumulation curves for bigrams (sequences of two postures) to 5-grams (sequences of 5 postures). Over time, as more postures are observed (Total Postures), the number of unique <italic>n</italic>-grams that is observed (analogous to vocabulary size) grows sub-linearly. The grey dashed line has slope 1. Each blue line is calculated from data from 100 randomly chosen worms from the entire data set of 1262 individuals. Orange lines are averages calculated from the same data but with the sequences randomly shuffled. Black lines are averages calculated for data generated from a trigram model of the posture sequences. <bold>(B)</bold> Zipf plot of <italic>n</italic>-grams. The frequency distribution of <italic>n</italic>-grams ranked from most to least frequent. Each blue line is calculated from 400 randomly chosen worms. Black lines are averages calculated for data generated from a trigram model of the posture sequences. The red dashed line indicates the rank that divides the top 1% most frequent trigrams from the remaining 99%.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004322.g002" position="float" xlink:type="simple"/>
</fig>
<p>The accumulation curves grow less than linearly, reflecting the fact that worm locomotion is repetitive. It is notable though, that even after over 100 000 postures have been observed, new unique trigrams are still being observed at a rate of approximately 1 in 25 (or about 1 previously unobserved trigram every 12 seconds after a total observation time of 14 hours). This combination of repetitiveness with a large total repertoire can be seen more clearly in a Zipf plot of <italic>n</italic>-gram frequencies (<bold><xref rid="pcbi.1004322.g002" ref-type="fig">Fig 2B</xref></bold>), which shows the frequency of sequences plotted against their rank on a log-log plot. The distribution is heavy-tailed in the sense that there are more high-frequency behaviours than would be expected for an exponential distribution with the same mean (<bold><xref rid="pcbi.1004322.s002" ref-type="supplementary-material">S2 Fig</xref></bold>). This corresponds to a highly skewed usage of the behavioural repertoire with the top 1% of trigrams being used 32.2 ± 0.6% of the time during crawling on food (mean ± standard deviation for the blue curves in <xref rid="pcbi.1004322.g002" ref-type="fig">Fig 2B</xref>).</p>
<p>We used the OpenGRM NGram library [<xref rid="pcbi.1004322.ref020" ref-type="bibr">20</xref>] to model posture sequences as Markov chains, in which the probability of the next posture in the sequence is a function only of the previous <italic>n</italic>– 1 states. In the simplest case of a bigram model, the probability of the next state in the sequence depends only on the current state, but for worm locomotion, a bigram model does not capture the distribution of longer <italic>n</italic>-grams (<bold><xref rid="pcbi.1004322.s003" ref-type="supplementary-material">S3 Fig</xref></bold>). In contrast, when we fit a trigram model using observed sequences and used it to generate new sequences, the simulated sequences had a similar distribution not only of trigrams, but also 4- and 5-grams (<xref rid="pcbi.1004322.g002" ref-type="fig">Fig 2A and 2B</xref>, black lines). Increasing <italic>n</italic> to 4 or 5 improves the fit quality, but only modestly (<xref rid="pcbi.1004322.s002" ref-type="supplementary-material">S2 Fig</xref>). We therefore chose to focus on trigrams for most of the subsequent analysis.</p>
</sec>
<sec id="sec006">
<title>Optogenetic activation changes posture <italic>n</italic>-gram frequencies</title>
<p>To determine how worms adapt their behavioural repertoire in response to stimulation, we first used optogenetics to induce behavioural transitions at predictable times in freely crawling worms. We chose two strains for these experiments that produce robust behavioural responses to optogenetic stimulation. ZX46 worms were a useful starting point because they express channelrhodopsin under the control of the <italic>unc-17</italic> promoter in the worm’s cholinergic neurons, and thus activation by blue light results in the simultaneous contraction of body wall muscles and an obvious change in locomotion. Previous experiments on this strain showed that activation leads to a deep dorsal bend [<xref rid="pcbi.1004322.ref021" ref-type="bibr">21</xref>]. Although dorsal bends are rare under normal circumstances, they are represented in the set of 90 N2 on-food postures and the fit quality during activation actually increases somewhat (<bold><xref rid="pcbi.1004322.g003" ref-type="fig">Fig 3A</xref></bold>). This is because curved postures have a high total variance leading to an R<sup>2</sup>, the fraction of explained variance, near 1. Plots of relative posture probability over time (<bold><xref rid="pcbi.1004322.g003" ref-type="fig">Fig 3B</xref></bold>) show some postures that are over-represented during the stimulus and a large number of under-represented postures. A rank sum test comparing posture probabilities during and outside of stimulation periods shows that dorsal bends are over-represented (<bold><xref rid="pcbi.1004322.g003" ref-type="fig">Fig 3C</xref></bold>) during stimulation, as previously reported for this strain [<xref rid="pcbi.1004322.ref021" ref-type="bibr">21</xref>]. The same effect is also seen in the bigram probabilities, although there was insufficient power to detect over-represented trigrams. The under-represented postures are sinuous postures common during normal locomotion. This is due to a decrease in forward locomotion during photoactivation of the cholinergic neurons as revealed by the under-represented bigrams and trigrams.</p>
<fig id="pcbi.1004322.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004322.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Optogenetic activation of subsets of neurons drives behavioural transitions.</title>
<p>The left half of the figure (A-C) shows data from ZX46 worms expressing channelrhodopsin in the cholinergic motor neurons and the right half (D-F) from AQ2026 worms expressing channelrhodopsin in ASH, a neuron that detects aversive stimuli, as well as PVQ and ASI. <bold>(A, D)</bold> R<sup>2</sup> between original body angles and nearest-neighbour template over time. The blue line is the mean and the gray shading indicates the standard deviation (<italic>n</italic> = 23 in A; <italic>n</italic> = 34 in D). Yellow box indicates light stimulation period. <bold>(B, E)</bold> The relative probability of observing each posture over time. Colour indicates whether a posture is over-represented (red) or underrepresented (blue) at each time. Postures with similar temporal profiles are clustered independently in B and E for visualization. <bold>(C, F)</bold> The top 2 <italic>n</italic>-grams that are most significantly overrepresented (red) or underrepresented (blue) during the indicated time periods for <italic>n</italic> = 1–3 for each strain. Grey numbers show the row number for each posture in the corresponding heatmap. Dots indicate worm head, dorsal and ventral sides are as indicated by the arrows. The gray dashed lines approximately connect body bends from one posture to the next and can be used to distinguish forward from reverse locomotion. Lines with a negative slope indicate body bends propagating backwards and therefore forward locomotion. Lines with a positive slope show reversals.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004322.g003" position="float" xlink:type="simple"/>
</fig>
<p>Photoactivation of AQ2026 worms, which express channelrhodopsin under the control of the <italic>sra-6</italic> promoter, reliably induces an escape response through the activation of the ASH sensory neurons [<xref rid="pcbi.1004322.ref022" ref-type="bibr">22</xref>,<xref rid="pcbi.1004322.ref023" ref-type="bibr">23</xref>]. The behaviour is readily observed, but is more naturalistic than the deep dorsal bends seen in ZX46 worms since it occurs through activation of a sensory neuron that normally detects aversive stimuli and elicits an escape response. Again, the discrete representation fits the induced postures well (<bold><xref rid="pcbi.1004322.g003" ref-type="fig">Fig 3D</xref></bold>). The plot of posture probability over time shows both over- and under-represented postures during and after stimulation (<bold><xref rid="pcbi.1004322.g003" ref-type="fig">Fig 3E</xref></bold>). Escape responses in <italic>C</italic>. <italic>elegans</italic> typically consist of a reversal followed by a turn, which we can detect by splitting the analysis into three parts: outside stimulus, during stimulus, and 0–5 seconds after stimulus. During stimulation the bigrams and trigrams representing reversals are significantly more likely while forward locomotion is less likely (<bold><xref rid="pcbi.1004322.g003" ref-type="fig">Fig 3F</xref></bold>) and in the 5 seconds after stimulus, ventral turns and reversals are more likely while forward locomotion is still supressed.</p>
</sec>
<sec id="sec007">
<title>Worms change their postural syntax in different environments</title>
<p>We next recorded worm locomotion in different environments to see how they adapt their behavioural repertoire in response to variation in sensory stimulation. To add to the data for worms on bacterial food, we also recorded N2 worms crawling on an agar surface with no food, and with no food but in the presence of the chemoattractant benzaldehyde [<xref rid="pcbi.1004322.ref024" ref-type="bibr">24</xref>]. N2 animals rarely leave a patch of food [<xref rid="pcbi.1004322.ref025" ref-type="bibr">25</xref>] and spend some time dwelling leading to a confined path (<bold><xref rid="pcbi.1004322.g004" ref-type="fig">Fig 4A</xref></bold>). In the absence of food, worms show a clear switch in behaviour, spend more time roaming and initiate a local search behaviour consisting of reversals and turns. After longer periods of starvation, they show increasingly directed locomotion [<xref rid="pcbi.1004322.ref015" ref-type="bibr">15</xref>,<xref rid="pcbi.1004322.ref016" ref-type="bibr">16</xref>]. During chemotaxis off food, their change in behaviour compared to worms off food with no chemo attractant is more subtle; they still spend most of their time moving, but their paths are less random as they will, on average, move up the gradient of attractant [<xref rid="pcbi.1004322.ref013" ref-type="bibr">13</xref>,<xref rid="pcbi.1004322.ref014" ref-type="bibr">14</xref>].</p>
<fig id="pcbi.1004322.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004322.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Worm behaviour is compositional across different conditions.</title>
<p><bold>(A)</bold> Worm tracks in different conditions: on food (<italic>n</italic> = 34), off food (<italic>n</italic> = 23), and off food with an attractant (benzaldehyde) (<italic>n</italic> = 25). Tracks for different worms start at the red dot and are aligned with their long-axis arranged vertically. Worms on food explore the region of the food but rarely leave, while off food they explore a larger area. In the presence of an attractant, worms explore a large area, but in a more directed way. <bold>(B)</bold> A plot shows the distribution of R<sup>2</sup> values for worms in the different conditions. The fit quality is no worse for worms off food or performing chemotaxis even though the postures are derived only for worms on food. For comparison, the distribution of fits is also shown for an uncoordinated mutant <italic>unc-79(e1068)</italic> that is poorly fit using the wild type on food postures. Numbers in the legend are mean ± standard deviation of the R<sup>2</sup> distributions. <bold>(C)</bold> Comparisons between the frequencies of four selected trigrams in the three conditions. The rank of each sequence in the repertoire of worms in each condition is shown in red. * indicates <italic>p</italic> &lt; 4.1 x 10<sup>−4</sup>, chosen to control the false discovery rate at 5% across multiple comparisons.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004322.g004" position="float" xlink:type="simple"/>
</fig>
<p>We used the same set of 90 templates derived for N2 animals on food to fit the shapes of worms off food and during chemotaxis. The fit quality is no worse in either of the off food conditions, indicating that there is not an increase in outlying postures that are not captured by the template set (<bold><xref rid="pcbi.1004322.g004" ref-type="fig">Fig 4B</xref></bold>). In fact, the poorly fit tail of the distribution is reduced off food compared to on food. The better fit may be due too noisier skeletonization of worms imaged on food and partly because worms off food are less likely to adopt some postures characteristic of pauses that are among the worst fitting postures (<bold><xref rid="pcbi.1004322.s004" ref-type="supplementary-material">S4 Fig</xref></bold>). As a positive control, we also measured the distribution of fit qualities for a visibly uncoordinated mutant <italic>unc-79(e1068)</italic> and found a clear increase in outlying postures not captured by the wild type on food template postures.</p>
<p>We also tested for differences in <italic>n</italic>-gram frequencies that worms performed in the different conditions by pooling their sequences and getting the complete set of unique <italic>n</italic>-grams observed across the three conditions, for <italic>n</italic> = 1–3. We counted the number of occurrences of each <italic>n</italic>-gram in each condition and used a rank sum test to find sequences that were used more or less frequently in one of the conditions. We excluded <italic>n</italic>-grams that were observed less than 5 times in total in the two conditions being compared. Note that we did not exclude behaviours that were rare in only one of the conditions. For example, an <italic>n</italic>-gram with a count of 10 in one condition and 0 in another would still be included in the comparison. We corrected for multiple comparisons using an adjusted <italic>p</italic>-value threshold calculated to control the false discovery rate at 5% [<xref rid="pcbi.1004322.ref026" ref-type="bibr">26</xref>]. Using this procedure, we found that for the on food vs. off food comparison 377 trigrams were significantly more common in one condition, whereas for the subtler off food vs. chemotaxis comparison we found 11. These differences in trigram frequencies are not entirely explained by differences in posture preference, since in shuffled sequences that preserve posture frequency differences, only 2 trigrams were found to be significantly different between the on and off food conditions and none were significantly different between the off food and chemotaxis conditions. Four examples of distinguishing trigrams are shown in <bold><xref rid="pcbi.1004322.g004" ref-type="fig">Fig 4C</xref></bold>. The first one is a bout of forward locomotion that is common in all conditions, but progressively less common in worms performing chemotaxis, crawling off food, and crawling on food. This is consistent with expectations for the persistence of locomotion in these conditions. The second trigram starts with the same posture as the first, but it appears in a different context. Instead of appearing during forward locomotion, the posture appears during a pause with a head swing. This change in context makes trigram 2 much less common in the off food conditions even though trigrams 1 and 2 share a posture in common. This implies that behavioural adaptation is at least partly characterized by shifts in postural syntax. Trigram 3 shows that behaviours that are rare in all conditions can still show significant differences in frequency and trigram 4 shows an example of a reversal which is more common on food than in either of the off food conditions, consistent with worms showing more persistent forward locomotion when searching off food.</p>
</sec>
<sec id="sec008">
<title>Natural variation in behaviour is captured by a subset of posture <italic>n</italic>-grams</title>
<p>In addition to environmental variation, we also quantified the behavioural variation that arises over short evolutionary times between different populations of the same species. We tracked 17 strains of <italic>C</italic>. <italic>elegans</italic> isolated from different regions of the world and quantified their behaviour using the discrete representation. We found that the template postures derived from N2 worms on food could also fit the wild isolate data and that the heavy-tailed frequency distribution of trigrams is observed in all strains (<bold><xref rid="pcbi.1004322.g005" ref-type="fig">Fig 5A</xref></bold>). The distribution is skewed with the top 1% of trigrams being used 38 ± 4% of the time during crawling (mean ± standard deviation, <italic>n</italic> = 17 strains).</p>
<fig id="pcbi.1004322.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004322.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Form of trigram frequency distribution is conserved across wild isolates despite differences in preference for particular sequences.</title>
<p><bold>(A)</bold> Zipf plots for 17 wild isolates of <italic>C</italic>. <italic>elegans</italic> all show a heavy tailed distribution similar to N2 worms. The red dashed line shows the rank dividing the top 1% of trigrams in the repertoire from the remaining 99%. The inset shows the distribution of R<sup>2</sup> values for fits between 90 N2-derived templates and the original postures for the 17 wild isolates as well as for N2 itself for comparison. The overall mean of the distributions is 0.86 with standard deviation 0.08. <bold>(B)</bold> Histogram of hit counts (not hit density) versus frequency on a log scale. Hits are trigrams with significantly different frequencies in at least one pairwise rank sum test comparing strains. Note that the bin widths increase to be constant on a log-scale. Blue line is the original data and the red line is for trigrams derived from the same data after random shuffling of the sequences. <bold>(C)</bold> Box plots of trigram frequencies for 4 trigrams showing hits in several strains. The trigram number indicates its column in the heatmap in D. The <italic>p</italic>-value threshold was set at 1.1 x 10<sup>−4</sup> to control the false discovery rate at 5% across comparisons. (D) A heatmap showing the relative frequency of all of the trigrams with significantly different frequencies in at least one strain comparison. Strains and trigrams have been hierarchically clustered. Sample trigrams are plotted above the heatmap with their columns indicated by the gray numbers.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004322.g005" position="float" xlink:type="simple"/>
</fig>
<p>We performed rank sum tests between all strain pairs to find trigrams with significant frequency differences using a <italic>p</italic>-value threshold adjusted to control the false discovery rate at 5% across all comparisons. There are trigrams with significant differences across the frequency spectrum; in fact most behaviours with a significant frequency difference are rare in at least one of the strains where the behaviours were found as a hit (<bold><xref rid="pcbi.1004322.g005" ref-type="fig">Fig 5B</xref></bold>). Not all of the hits counted in the histogram in <xref rid="pcbi.1004322.g005" ref-type="fig">Fig 5B</xref> correspond to unique trigrams because some trigrams had significantly different frequencies in more than one strain (<bold><xref rid="pcbi.1004322.g005" ref-type="fig">Fig 5C</xref></bold>). The number of <italic>unique</italic> trigrams that are different in at least one strain is 1258, which is approximately 5% of the 2.3 x 10<sup>4</sup> distinct trigrams observed in the full wild isolate data set. The relative frequencies for these 1258 trigrams are shown in a heatmap in <bold><xref rid="pcbi.1004322.g005" ref-type="fig">Fig 5D</xref></bold>. Trigrams 25 and 26 show dorsal turns. 27 and 28 are also bent more dorsally than ventrally, but 27 represents forward locomotion while 28 represents a reversal. 469–471 are all bouts of forward locomotion, 691–693 are pauses with relatively straight postures. 1227 is a ventral turn and 1234 and 1235 are reversals.</p>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>We have developed a simple representation of behaviour as a series of discrete postures to systematically enumerate the behavioural repertoire of <italic>C</italic>. <italic>elegans</italic> during locomotion. The concept of a complete description of behaviour was motivated in part by similar efforts devoted to other aspects of worm biology, most notably the genome, cell lineage, and connectome. However, the repertoire of behavioural sequences cannot be said to be complete in a similar way. Although we have a complete record of the observed sequences, accumulation curves suggest that more recordings would continue to reveal novel sequences, even when considering behaviours with durations of about a second in an animal with a simple morphology in a relatively uniform environment. A notable feature of the observed repertoire is the simultaneous presence of repetition (the heavily-used top 1%) and variety (the large set of relatively rarely used sequences). This feature may result from two demands on an animal’s behavioural repertoire: locomotion should be efficient in a given environment but must also be flexible to deal with unexpected conditions or to respond to new sensory information. The repertoires of 17 wild isolates of <italic>C</italic>. <italic>elegans</italic> have a similar rank-frequency distribution and we hypothesize that such heavy-tailed distributions will generalize beyond nematodes and will in fact be a widespread characteristic of animal behavioural repertoires.</p>
<p>Some of the rarely observed sequences in the repertoire are surely due to measurement noise, but since the frequency of some rare behaviours is modulated in response to sensory stimuli (for example behaviour 3 in <xref rid="pcbi.1004322.g004" ref-type="fig">Fig 4C</xref>), measurement noise is not the only factor. It should also be emphasized that although the repertoire is large in this representation, that does not preclude the existence of an alternative representation that will reveal an underlying simplicity. Indeed, seemingly simple nonlinear systems are well known to be able to produce complex dynamics [<xref rid="pcbi.1004322.ref027" ref-type="bibr">27</xref>] and the search for such models in the context of animal behaviour remains an exciting challenge [<xref rid="pcbi.1004322.ref028" ref-type="bibr">28</xref>–<xref rid="pcbi.1004322.ref030" ref-type="bibr">30</xref>]. The observation that only 5% of the trigram repertoire is modulated by natural variation between wild isolates (<xref rid="pcbi.1004322.g005" ref-type="fig">Fig 5D</xref>) may be a reflection of a small number of behavioural modules that can be adjusted genetically within the constraints of natural selection [<xref rid="pcbi.1004322.ref031" ref-type="bibr">31</xref>,<xref rid="pcbi.1004322.ref032" ref-type="bibr">32</xref>].</p>
<p>New imaging technology has made it possible to record neural activity from the majority of <italic>C</italic>. <italic>elegans</italic> neurons simultaneously in restrained animals [<xref rid="pcbi.1004322.ref033" ref-type="bibr">33</xref>] and during locomotion [<xref rid="pcbi.1004322.ref034" ref-type="bibr">34</xref>]. The usefulness of this data will depend to some extent on how the corresponding behavioural data is represented and quantified. This is also the case for optogenetically induced behavioural changes as reported here and many times previously in <italic>C</italic>. <italic>elegans</italic> (e.g. [<xref rid="pcbi.1004322.ref035" ref-type="bibr">35</xref>–<xref rid="pcbi.1004322.ref039" ref-type="bibr">39</xref>]). Recent work in <italic>Drosophila</italic> larvae suggests that an unsupervised detection of locomotion patterns can be informative [<xref rid="pcbi.1004322.ref040" ref-type="bibr">40</xref>]. The discrete approach that we report here is also unsupervised in the sense that repeated patterns of behaviour are detected based on locomotion patterns observed within strains without initially using information about different classes (environmental conditions or strains). A conceptually similar approach has proven to be useful for quantifying drug-induced behaviour in mice [<xref rid="pcbi.1004322.ref041" ref-type="bibr">41</xref>]. It is likely that no behavioural representation will be optimal for all studies, but that different representations will provide complementary insight. The advantages of trigram counting are that it is relatively unbiased, can reliably connect behaviours performed at different speeds, provides a complete record of all of the observed behaviours (up to the resolution of the template postures), and that it can be summarized intuitively as frequencies of short behaviours that can be directly visualized. For some applications the variance that is missed by the discrete templates may be critical. One option would be to increase the number of templates, but it may also be that a different representation would be called for. Another limitation of the discrete representation as presented here is that we have not used the information contained in the duration that worms spend in each posture. The time that worms spend performing each behavioural sequence is relatively straightforward to incorporate and would increase the power of the representation to resolve differences in dynamics between strains.</p>
<p>In the wild, animals must adapt to a variety of environments that can change unpredictably. One strategy for dealing with this complexity is to use a finite set of behavioural primitives that can be composed in different sequences to generate adaptive responses [<xref rid="pcbi.1004322.ref042" ref-type="bibr">42</xref>]. This is precisely the kind of variation that we observed for worms changing their behaviour in response to new environments (<xref rid="pcbi.1004322.g004" ref-type="fig">Fig 4</xref>). Using the same set of postures, they change their behaviour at the level of postural syntax. Compositionality in behaviour also suggests a mechanism for generating complex behaviours by combining primitive actions. Hierarchical composition has long been recognized as a principle of animal behaviour [<xref rid="pcbi.1004322.ref043" ref-type="bibr">43</xref>,<xref rid="pcbi.1004322.ref044" ref-type="bibr">44</xref>] and has also been proposed as an efficient representation for learning in robotics [<xref rid="pcbi.1004322.ref042" ref-type="bibr">42</xref>]. The possible connection between motor learning and compositionality raises the interesting question of how the repertoire observed in adults is acquired and modified during development.</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec011">
<title>Worm tracking</title>
<p>Locomotion data was recorded for single worms as previously described [<xref rid="pcbi.1004322.ref019" ref-type="bibr">19</xref>]. For on food tracking, single worms from each strain were picked to the centre of a 25 mm agar plate with a spot of <italic>E</italic>. <italic>coli</italic> OP50 at the centre, allowed to habituate to the new plate for 30 minutes, and then recorded for 15 minutes. The worm side (whether it was on its left or right side) was manually annotated using a stereomicroscope before transferring plates to the tracking microscope. In addition to the previously recorded N2 and DR96 <italic>unc-76(e911)</italic> data, we used the following wild isolate strains: CB4852, CB4853, CB4856, ED3017, ED3021, ED3049, ED3054, JU258, JU298, JU345, JU393, JU394, JU402, JU438, JU440, LSJ1, and MY16. For experiments off food, worms were briefly transferred to plates without food and then picked to the centre of a 55 mm agar plate and recorded immediately. Recording was stopped once worms reached the edge of the plate. To maximize the time of recording, worms in the chemotaxis assays were picked to a location near the edge of a 55 mm agar plate opposite the location of the attractant spot. 1 μl of the attractant, benzaldehyde (diluted 1:100 in EtOH), was added to the plate 10 mm from the edge.</p>
</sec>
<sec id="sec012">
<title>Optogenetics</title>
<p>The strains used for optogenetics were ZX46 <italic>zxIs6 [punc-17</italic>::<italic>ChR2(H134R)</italic>::<italic>yfp]</italic> V [<xref rid="pcbi.1004322.ref021" ref-type="bibr">21</xref>] and AQ2026 <italic>ljIs105 [sra-6</italic>::<italic>ChR2</italic>::<italic>yfp</italic>, <italic>unc-122</italic>::<italic>gfp]</italic>[<xref rid="pcbi.1004322.ref022" ref-type="bibr">22</xref>]. Worms were transferred to retinal plates at the L4 stage, left at 20°C, and assayed either 24 hours later as adults (AQ2026) or in the next generation (ZX46). Retinal plates were made by seeding NGM plates with OP50 mixed with all-trans retinal (100mM in ethanol) in a ratio of 1000:4. For channel rhodopsin activation, worms were illuminated for 5 seconds with 1 mW/mm<sup>2</sup> blue light (440–460 nm) using LEDs (Luxeon III LXHL-PR09 from Lumileds, CA) controlled by a Mindstorms LEGO Intelligent NXT Brick. Each worm was stimulated three times, with an interstimulus interval of 30 seconds.</p>
</sec>
<sec id="sec013">
<title>Posture discretization</title>
<p>The skeleton of worms in each frame was found after segmentation by tracing the midline between the two points of highest curvature (the head and tail) of the largest connected component in the image (the worm body) and down sampling to 49 equally spaced points [<xref rid="pcbi.1004322.ref019" ref-type="bibr">19</xref>]. The skeletons were then converted to a position and orientation independent representation by measuring the angle between each of the 49 skeleton points and subtracting the mean angle [<xref rid="pcbi.1004322.ref017" ref-type="bibr">17</xref>]. Missing skeleton angles were linearly interpolated. Missing data resulted from camera dropped frames, stage motion, or failure to skeletonize because of poor segmentation or coiled worms. On average 13 ± 9% (mean ± standard deviation) of frames cannot be segmented with each of the three causes contributing approximately equally to missing data. 5000 skeletons were randomly selected from each of 20 randomly selected N2 worms recorded crawling on food. Worms were flipped so that all worms appear to be on their right side when viewed on the page. This means that dorsal and ventral turns are consistent across individuals during analysis. This set of skeletons was then clustered using <italic>k</italic>-means clustering to identify a set of representative template postures. <italic>k</italic> was varied from 5 to 500 to determine the value for <italic>k</italic> after which increasing <italic>k</italic> only marginally improves the quality of the fit. <italic>k</italic> was chosen as 90 for all subsequent analysis.</p>
<p>For each worm video, we down sampled the data from 30 frames per second to 6 frames per second and then found the best matching template in each frame of the down sampled data. The best match was determined in each frame by finding the template posture with the minimum squared difference to the skeleton in that frame. Locomotion was then represented as a series of state labels between 1 and 90. Repeated states were collapsed to a single state (e.g. {1, 1, 2, 2, 2, 5} would become {1, 2, 5}).</p>
</sec>
<sec id="sec014">
<title>Posture probability analysis</title>
<p>For the optogenetics data, the frequency of each posture over time is averaged over three trials per worm and further averaged over the individuals in each experiment (<italic>n</italic> = 26 for ZX46 and <italic>n</italic> = 34 for AQ2026). Each row was smoothed with a moving average filter with a width of 1.3 seconds. The smoothed frequencies of each posture over time were then normalized by subtracting the mean and dividing by the standard deviation of each row to show relative up- and down-regulation over time. To aid visualization, the rows were then clustered vertically so that rows with similar temporal profiles were near each other. The clustering was agglomerative hierarchical clustering using Euclidean distance and average linkage. The clustering was performed independently for the data in <xref rid="pcbi.1004322.g003" ref-type="fig">Fig 3B and 3E</xref> so the rows in each plot do not correspond to the same postures.</p>
</sec>
<sec id="sec015">
<title><italic>n</italic>-gram model</title>
<p>The <italic>n</italic>-gram language model analyses were implemented in C and Python using the OpenFST [<xref rid="pcbi.1004322.ref045" ref-type="bibr">45</xref>] and OpenGRM <italic>n</italic>-gram [<xref rid="pcbi.1004322.ref020" ref-type="bibr">20</xref>] libraries. Postural sequences from N2 worms on food were compiled into finite-state archives (FAR) and standard <italic>n</italic>-gram count models were built for <italic>n</italic> = 1–5 and normalized into probabilistic models without additional smoothing (see e.g. [<xref rid="pcbi.1004322.ref046" ref-type="bibr">46</xref>]). For the simulation studies and for each <italic>n</italic>, 1000 random sequences were generated from the normalized finite-state models. Beginning at the start state an outgoing arc is chosen at random proportionally to the log-probability associated with the arc, the postural state is emitted and the process continues until an end state transition is reached.</p>
</sec>
<sec id="sec016">
<title><italic>n</italic>-gram statistics</title>
<p>The total set of unique <italic>n</italic>-grams was determined for each strain or condition (for the on food, off food, and chemotaxis set, the total set contained 14 209 trigrams and for the 17 wild isolates it contained 22 638 trigrams). Counts of unique <italic>n</italic>-grams in each individual were then used to compare strains or conditions to each other. For each comparison, any <italic>n</italic>-gram that was observed a total of 5 times or less in both groups being compared was ignored. For the remaining <italic>n</italic>-grams, counts were compared using a rank sum test and <italic>p</italic>-value thresholds were chosen using the Benjamini-Yekutieli procedure to control the false discovery rate at 5% [<xref rid="pcbi.1004322.ref026" ref-type="bibr">26</xref>].</p>
</sec>
</sec>
<sec id="sec017">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004322.s001" xlink:href="info:doi/10.1371/journal.pcbi.1004322.s001" mimetype="application/eps" position="float" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>The complete set of 90 posture templates derived for N2 animals crawling on food using <italic>k</italic>-means clustering.</title>
<p>The postures are ordered from most frequent (top left) counting down each column in turn to the least frequent (bottom right).</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004322.s002" xlink:href="info:doi/10.1371/journal.pcbi.1004322.s002" mimetype="application/eps" position="float" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Frequency distribution of <italic>n</italic>-grams compared to exponential distributions and Weibull distributions with parameters set by maximum likelihood estimation.</title>
<p>Blue curves are each calculated for 400 worms resampled with replacement from the total N2 data set. Each of the 10 curves is fit separately to an exponential (red curves) and a Weibull (black curves) distribution. A-B show results for <italic>n</italic> = 2–5.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004322.s003" xlink:href="info:doi/10.1371/journal.pcbi.1004322.s003" mimetype="application/eps" position="float" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Accumulation curves (left column) and Zipf rank-frequency plots (right column).</title>
<p>Blue lines show data from different randomly selected sets of N2 worms crawling on food (100 worms selected for each curve). Black lines show the corresponding results for data generated from <italic>n</italic>-gram models with different values of <italic>n</italic> shown in A-C.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004322.s004" xlink:href="info:doi/10.1371/journal.pcbi.1004322.s004" mimetype="application/eps" position="float" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>(A) R<sup>2</sup> plotted for each posture individually (mean ± standard deviation) for data collected on food, off food, and during chemotaxis.</title>
<p>The mean fit quality is consistently slightly lower on food than in the two off food conditions, consistent with slightly noisier segmentation when worms are on a patch of food. Furthermore, the two postures with the lowest R<sup>2</sup> values (34 and 71) are used less frequently in the off food conditions than when worms are on food (B).</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Mario de Bono and Kate Weber for providing us with the wild isolates used in this study and Alexander Gottschalk for providing ZX46 worms.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004322.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berman</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Choi</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Shaevitz</surname> <given-names>JW</given-names></name>. <article-title>Mapping the stereotyped behaviour of freely moving fruit flies</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2014</year>;<volume>11</volume>: <fpage>20140672</fpage>–<lpage>20140672</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2014.0672" xlink:type="simple">10.1098/rsif.2014.0672</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004322.ref002"><label>2</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Lehner</surname> <given-names>PN</given-names></name>. <chapter-title>Handbook of ethological methods</chapter-title>. <edition>2nd ed.</edition> <publisher-loc>Cambridge ; New York</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>1996</year>.</mixed-citation></ref>
<ref id="pcbi.1004322.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Burghardt</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Bartmess-LeVasseur</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Browning</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Morrison</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Stec</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Zachau</surname> <given-names>CE</given-names></name>, <etal>et al</etal>. <article-title>Perspectives—Minimizing Observer Bias in Behavioral Studies: A Review and Recommendations: Minimizing Observer Bias in Behavioral Research</article-title>. <source>Ethology</source>. <year>2012</year>;<volume>118</volume>: <fpage>511</fpage>–<lpage>517</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1439-0310.2012.02040.x" xlink:type="simple">10.1111/j.1439-0310.2012.02040.x</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004322.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gomez-Marin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Paton</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Kampff</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Costa</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Mainen</surname> <given-names>ZF</given-names></name>. <article-title>Big behavioral data: psychology, ethology and the foundations of neuroscience</article-title>. <source>Nature Neuroscience</source>. <year>2014</year>;<volume>17</volume>: <fpage>1455</fpage>–<lpage>1462</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3812" xlink:type="simple">10.1038/nn.3812</ext-link></comment> <object-id pub-id-type="pmid">25349912</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anderson</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Perona</surname> <given-names>P</given-names></name>. <article-title>Toward a Science of Computational Ethology</article-title>. <source>Neuron</source>. <year>2014</year>;<volume>84</volume>: <fpage>18</fpage>–<lpage>31</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2014.09.005" xlink:type="simple">10.1016/j.neuron.2014.09.005</ext-link></comment> <object-id pub-id-type="pmid">25277452</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dell</surname> <given-names>AI</given-names></name>, <name name-style="western"><surname>Bender</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Branson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Couzin</surname> <given-names>ID</given-names></name>, <name name-style="western"><surname>de Polavieja</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Noldus</surname> <given-names>LPJJ</given-names></name>, <etal>et al</etal>. <article-title>Automated image-based tracking and its application in ecology</article-title>. <source>Trends in Ecology &amp; Evolution</source>. <year>2014</year>;<volume>29</volume>: <fpage>417</fpage>–<lpage>428</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tree.2014.05.004" xlink:type="simple">10.1016/j.tree.2014.05.004</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004322.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><collab xlink:type="simple">The C. elegans Sequencing Consortium</collab>. <article-title>Genome Sequence of the Nematode C. elegans: A Platform for Investigating Biology</article-title>. <source>Science</source>. <year>1998</year>;<volume>282</volume>: <fpage>2012</fpage>–<lpage>2018</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.282.5396.2012" xlink:type="simple">10.1126/science.282.5396.2012</ext-link></comment> <object-id pub-id-type="pmid">9851916</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sulston</surname> <given-names>J</given-names></name>. <article-title>Post-embryonic cell lineages of the nematode, Caenorhabditis elegans</article-title>. <source>Developmental Biology</source>. <year>1977</year>;<volume>56</volume>: <fpage>110</fpage>–<lpage>156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0012-1606(77)90158-0" xlink:type="simple">10.1016/0012-1606(77)90158-0</ext-link></comment> <object-id pub-id-type="pmid">838129</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Southgate</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Brenner</surname> <given-names>S</given-names></name>. <article-title>The Structure of the Nervous System of the Nematode Caenorhabditis elegans</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>. <year>1986</year>;<volume>314</volume>: <fpage>1</fpage>–<lpage>340</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.1986.0056" xlink:type="simple">10.1098/rstb.1986.0056</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004322.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gjorgjieva</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Biron</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Haspel</surname> <given-names>G</given-names></name>. <article-title>Neurobiology of Caenorhabditis elegans Locomotion: Where Do We Stand?</article-title> <source>BioScience</source>. <year>2014</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biosci/biu058" xlink:type="simple">10.1093/biosci/biu058</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004322.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wen</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Po</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Hulme</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Kwok</surname> <given-names>SW</given-names></name>, <etal>et al</etal>. <article-title>Proprioceptive Coupling within Motor Neurons Drives C. elegans Forward Locomotion</article-title>. <source>Neuron</source>. <year>2012</year>;<volume>76</volume>: <fpage>750</fpage>–<lpage>761</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2012.08.039" xlink:type="simple">10.1016/j.neuron.2012.08.039</ext-link></comment> <object-id pub-id-type="pmid">23177960</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Faumont</surname> <given-names>S</given-names></name>. <article-title>The Awake Behaving Worm: Simultaneous Imaging of Neuronal Activity and Behavior in Intact Animals at Millimeter Scale</article-title>. <source>Journal of Neurophysiology</source>. <year>2006</year>;<volume>95</volume>: <fpage>1976</fpage>–<lpage>1981</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.01050.2005" xlink:type="simple">10.1152/jn.01050.2005</ext-link></comment> <object-id pub-id-type="pmid">16319197</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pierce-Shimomura</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Morse</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Lockery</surname> <given-names>SR</given-names></name>. <article-title>The fundamental role of pirouettes in Caenorhabditis elegans chemotaxis</article-title>. <source>J Neurosci</source>. <year>1999</year>;<volume>19</volume>: <fpage>9557</fpage>–<lpage>9569</lpage>. <object-id pub-id-type="pmid">10531458</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Iino</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yoshida</surname> <given-names>K</given-names></name>. <article-title>Parallel Use of Two Behavioral Mechanisms for Chemotaxis in Caenorhabditis elegans</article-title>. <source>Journal of Neuroscience</source>. <year>2009</year>;<volume>29</volume>: <fpage>5370</fpage>–<lpage>5380</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3633-08.2009" xlink:type="simple">10.1523/JNEUROSCI.3633-08.2009</ext-link></comment> <object-id pub-id-type="pmid">19403805</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gray</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Hill</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Bargmann</surname> <given-names>CI</given-names></name>. <article-title>A circuit for navigation in Caenorhabditis elegans</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2005</year>;<volume>102</volume>: <fpage>3184</fpage>–<lpage>3191</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0409009101" xlink:type="simple">10.1073/pnas.0409009101</ext-link></comment> <object-id pub-id-type="pmid">15689400</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salvador</surname> <given-names>LCM</given-names></name>, <name name-style="western"><surname>Bartumeus</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Levin</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Ryu</surname> <given-names>WS</given-names></name>. <article-title>Mechanistic analysis of the search behaviour of Caenorhabditis elegans</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2014</year>;<volume>11</volume>: <fpage>20131092</fpage>–<lpage>20131092</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2013.1092" xlink:type="simple">10.1098/rsif.2013.1092</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004322.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stephens</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Johnson-Kerner</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Ryu</surname> <given-names>WS</given-names></name>. <article-title>Dimensionality and Dynamics in the Behavior of C. elegans</article-title>. <source>PLoS Computational Biology</source>. <year>2008</year>;<volume>4</volume>: <fpage>e1000028</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000028" xlink:type="simple">10.1371/journal.pcbi.1000028</ext-link></comment> <object-id pub-id-type="pmid">18389066</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname> <given-names>AEX</given-names></name>, <name name-style="western"><surname>Yemini</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Grundy</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Jucikas</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>WR</given-names></name>. <article-title>A dictionary of behavioral motifs reveals clusters of genes affecting Caenorhabditis elegans locomotion</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2013</year>;<volume>110</volume>: <fpage>791</fpage>–<lpage>796</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1211447110" xlink:type="simple">10.1073/pnas.1211447110</ext-link></comment> <object-id pub-id-type="pmid">23267063</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yemini</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Jucikas</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Grundy</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>AEX</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>WR</given-names></name>. <article-title>A database of Caenorhabditis elegans behavioral phenotypes</article-title>. <source>Nature Methods</source>. <year>2013</year>;<volume>10</volume>: <fpage>877</fpage>–<lpage>879</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2560" xlink:type="simple">10.1038/nmeth.2560</ext-link></comment> <object-id pub-id-type="pmid">23852451</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref020"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">Roark B, Sproat R, Allauzen C, Riley M, Sorensen J, Tai T. The OpenGrm open-source finitestate grammar software libraries. In Proceedings of the Association for Computational Linguistics (System Demonstrations). 2012. pp. 61–66.</mixed-citation></ref>
<ref id="pcbi.1004322.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liewald</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Brauner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Stephens</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Bouhours</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schultheis</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhen</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Optogenetic analysis of synaptic function</article-title>. <source>Nature Methods</source>. <year>2008</year>;<volume>5</volume>: <fpage>895</fpage>–<lpage>902</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1252" xlink:type="simple">10.1038/nmeth.1252</ext-link></comment> <object-id pub-id-type="pmid">18794862</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ezcurra</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tanizawa</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Swoboda</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>WR</given-names></name>. <article-title>Food sensitizes <italic>C</italic>. <italic>elegans</italic> avoidance behaviours through acute dopamine signalling: Food sensitizes <italic>C</italic>. <italic>elegans</italic> avoidance behaviours</article-title>. <source>The EMBO Journal</source>. <year>2011</year>;<volume>30</volume>: <fpage>1110</fpage>–<lpage>1122</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/emboj.2011.22" xlink:type="simple">10.1038/emboj.2011.22</ext-link></comment> <object-id pub-id-type="pmid">21304491</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Guo</surname> <given-names>ZV</given-names></name>, <name name-style="western"><surname>Hart</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Ramanathan</surname> <given-names>S</given-names></name>. <article-title>Optical interrogation of neural circuits in Caenorhabditis elegans</article-title>. <source>Nature Methods</source>. <year>2009</year>;<volume>6</volume>: <fpage>891</fpage>–<lpage>896</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1397" xlink:type="simple">10.1038/nmeth.1397</ext-link></comment> <object-id pub-id-type="pmid">19898486</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bargmann</surname> <given-names>C</given-names></name>. <article-title>Chemosensation in C. elegans</article-title>. <source>WormBook</source>. <year>2006</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1895/wormbook.1.123.1" xlink:type="simple">10.1895/wormbook.1.123.1</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004322.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Avery</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>You</surname> <given-names>Y-J</given-names></name>. <article-title>C. elegans feeding</article-title>. <source>WormBook</source>. <year>2012</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1895/wormbook.1.150.1" xlink:type="simple">10.1895/wormbook.1.150.1</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004322.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benjamini</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yekutieli</surname> <given-names>D</given-names></name>. <article-title>The Control of the False Discovery Rate in Multiple Testing under Dependency</article-title>. <source>The Annals of Statistics</source>. <year>2001</year>;<volume>29</volume>: <fpage>1165</fpage>–<lpage>1188</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/2674075" xlink:type="simple">10.2307/2674075</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004322.ref027"><label>27</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Strogatz</surname> <given-names>SH</given-names></name>. <chapter-title>Nonlinear dynamics and chaos with applications to physics, biology, chemistry, and engineering</chapter-title>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>Westview Press</publisher-name>; <year>2000</year>.</mixed-citation></ref>
<ref id="pcbi.1004322.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cole</surname> <given-names>B</given-names></name>. <article-title>Fractal time in animal behaviour: the movement activity of Drosophila</article-title>. <source>Animal Behaviour</source>. <year>1995</year>;<volume>50</volume>: <fpage>1317</fpage>–<lpage>1324</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0003-3472(95)80047-6" xlink:type="simple">10.1016/0003-3472(95)80047-6</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004322.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>J-S</given-names></name>, <name name-style="western"><surname>Huston</surname> <given-names>JP</given-names></name>. <article-title>Non-linear dynamics of operant behavior: a new approach via the extended return map</article-title>. <source>Rev Neurosci</source>. <year>2002</year>;<volume>13</volume>: <fpage>31</fpage>–<lpage>57</lpage>. <object-id pub-id-type="pmid">12013025</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maye</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hsieh</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sugihara</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Brembs</surname> <given-names>B</given-names></name>. <article-title>Order in Spontaneous Behavior</article-title>. <source>PLoS ONE</source>. <year>2007</year>;<volume>2</volume>: <fpage>e443</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0000443" xlink:type="simple">10.1371/journal.pone.0000443</ext-link></comment> <object-id pub-id-type="pmid">17505542</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Avery</surname> <given-names>L</given-names></name>. <article-title>Caenorhabditis elegans behavioral genetics: where are the knobs?</article-title> <source>BMC Biology</source>. <year>2010</year>;<volume>8</volume>: <fpage>69</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1741-7007-8-69" xlink:type="simple">10.1186/1741-7007-8-69</ext-link></comment> <object-id pub-id-type="pmid">20504291</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weber</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Hoekstra</surname> <given-names>HE</given-names></name>. <article-title>Discrete genetic modules are responsible for complex burrow evolution in Peromyscus mice</article-title>. <source>Nature</source>. <year>2013</year>;<volume>493</volume>: <fpage>402</fpage>–<lpage>405</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11816" xlink:type="simple">10.1038/nature11816</ext-link></comment> <object-id pub-id-type="pmid">23325221</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schrödel</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Prevedel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Aumayr</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zimmer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vaziri</surname> <given-names>A</given-names></name>. <article-title>Brain-wide 3D imaging of neuronal activity in Caenorhabditis elegans with sculpted light</article-title>. <source>Nature Methods</source>. <year>2013</year>;<volume>10</volume>: <fpage>1013</fpage>–<lpage>1020</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2637" xlink:type="simple">10.1038/nmeth.2637</ext-link></comment> <object-id pub-id-type="pmid">24013820</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref034"><label>34</label><mixed-citation publication-type="other" xlink:type="simple">Nguyen J, Shipley F, Linder A, Plummer G, Shaevitz J, Leifer A. Whole-brain calcium imaging with cellular resolution in freely behaving C. elegans. Preprint. Available: arXiv:150103463. Accessed 6 April 2015.</mixed-citation></ref>
<ref id="pcbi.1004322.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nagel</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Brauner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Liewald</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Adeishvili</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bamberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gottschalk</surname> <given-names>A</given-names></name>. <article-title>Light Activation of Channelrhodopsin-2 in Excitable Cells of Caenorhabditis elegans Triggers Rapid Behavioral Responses</article-title>. <source>Current Biology</source>. <year>2005</year>;<volume>15</volume>: <fpage>2279</fpage>–<lpage>2284</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cub.2005.11.032" xlink:type="simple">10.1016/j.cub.2005.11.032</ext-link></comment> <object-id pub-id-type="pmid">16360690</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stirman</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Crane</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Husson</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Wabnig</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schultheis</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gottschalk</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Real-time multimodal optical control of neurons and muscles in freely behaving Caenorhabditis elegans</article-title>. <source>Nature Methods</source>. <year>2011</year>;<volume>8</volume>: <fpage>153</fpage>–<lpage>158</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1555" xlink:type="simple">10.1038/nmeth.1555</ext-link></comment> <object-id pub-id-type="pmid">21240278</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leifer</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Fang-Yen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gershow</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Alkema</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Samuel</surname> <given-names>ADT</given-names></name>. <article-title>Optogenetic manipulation of neural activity in freely moving Caenorhabditis elegans</article-title>. <source>Nature Methods</source>. <year>2011</year>;<volume>8</volume>: <fpage>147</fpage>–<lpage>152</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1554" xlink:type="simple">10.1038/nmeth.1554</ext-link></comment> <object-id pub-id-type="pmid">21240279</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref038"><label>38</label><mixed-citation publication-type="other" xlink:type="simple">Shipley FB, Clark CM, Alkema MJ, Leifer AM. Simultaneous optogenetic manipulation and calcium imaging in freely moving C. elegans. 2013;000943. Preprint. Available: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/000943" xlink:type="simple">http://biorxiv.org/lookup/doi/10.1101/000943</ext-link>. Accessed 6 April 2015.</mixed-citation></ref>
<ref id="pcbi.1004322.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kocabas</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>C-H</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>ZV</given-names></name>, <name name-style="western"><surname>Ramanathan</surname> <given-names>S</given-names></name>. <article-title>Controlling interneuron activity in Caenorhabditis elegans to evoke chemotactic behaviour</article-title>. <source>Nature</source>. <year>2012</year>;<volume>490</volume>: <fpage>273</fpage>–<lpage>277</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11431" xlink:type="simple">10.1038/nature11431</ext-link></comment> <object-id pub-id-type="pmid">23000898</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vogelstein</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ohyama</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kerr</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Truman</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Priebe</surname> <given-names>CE</given-names></name>, <etal>et al</etal>. <article-title>Discovery of brainwide neural-behavioral maps via multiscale unsupervised structure learning</article-title>. <source>Science</source>. <year>2014</year>;<volume>344</volume>: <fpage>386</fpage>–<lpage>392</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1250298" xlink:type="simple">10.1126/science.1250298</ext-link></comment> <object-id pub-id-type="pmid">24674869</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kafkafi</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Mayo</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Elmer</surname> <given-names>GI</given-names></name>. <article-title>Mining mouse behavior for patterns predicting psychiatric drug classification</article-title>. <source>Psychopharmacology</source>. <year>2014</year>;<volume>231</volume>: <fpage>231</fpage>–<lpage>242</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00213-013-3230-6" xlink:type="simple">10.1007/s00213-013-3230-6</ext-link></comment> <object-id pub-id-type="pmid">23958942</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Flash</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hochner</surname> <given-names>B</given-names></name>. <article-title>Motor primitives in vertebrates and invertebrates</article-title>. <source>Current Opinion in Neurobiology</source>. <year>2005</year>;<volume>15</volume>: <fpage>660</fpage>–<lpage>666</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.conb.2005.10.011" xlink:type="simple">10.1016/j.conb.2005.10.011</ext-link></comment> <object-id pub-id-type="pmid">16275056</object-id></mixed-citation></ref>
<ref id="pcbi.1004322.ref043"><label>43</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Dawkins</surname> <given-names>R</given-names></name>. <chapter-title>Hierarchical organisation: a candidate principle for ethology</chapter-title>. <source>Growing Points in Ethology</source>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>1976</year>. pp. <fpage>7</fpage>–<lpage>54</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004322.ref044"><label>44</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Lashley</surname> <given-names>KS</given-names></name>. <chapter-title>The problem of serial order in behavior</chapter-title>. In: <name name-style="western"><surname>Jeffress</surname> <given-names>LA</given-names></name>, editor. <source>Cerebral Mechanisms in Behavior</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>John Wiley Press</publisher-name>; <year>1951</year>.</mixed-citation></ref>
<ref id="pcbi.1004322.ref045"><label>45</label><mixed-citation publication-type="other" xlink:type="simple">Allauzen C, Riley M, Schalkwyk J, Skut W, Mohri M. OpenFst: a general and efficient weighted finite-state transducer library. Proceedings of the 12th international conference on Implementation and application of automata. Prague, Czech Republic: Springer-Verlag; 2007. pp. 11–23.</mixed-citation></ref>
<ref id="pcbi.1004322.ref046"><label>46</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Manning</surname> <given-names>CD</given-names></name>. <chapter-title>Foundations of statistical natural language processing</chapter-title>. <publisher-loc>Cambridge, Mass</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>1999</year>.</mixed-citation></ref>
</ref-list>
</back>
</article>