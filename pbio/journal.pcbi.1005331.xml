<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00717</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005331</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Biological databases</subject><subj-group><subject>Genomic databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genomic databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genomic databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Differential equations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome complexity</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome complexity</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Scalable Parameter Estimation for Genome-Scale Biochemical Reaction Networks</article-title>
<alt-title alt-title-type="running-head">Scalable Parameter Estimation for Genome-Scale Biochemical Reaction Networks</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5360-4292</contrib-id>
<name name-style="western">
<surname>Fröhlich</surname> <given-names>Fabian</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kaltenbacher</surname> <given-names>Barbara</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2419-1943</contrib-id>
<name name-style="western">
<surname>Theis</surname> <given-names>Fabian J.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Hasenauer</surname> <given-names>Jan</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Helmholtz Zentrum München - German Research Center for Environmental Health, Institute of Computational Biology, Neuherberg, Germany</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Technische Universität München, Center for Mathematics, Chair of Mathematical Modeling of Biological Systems, Garching, Germany</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>University of Klagenfurt, Institute of Mathematics, Klagenfurt, Austria</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Stelling</surname> <given-names>Jorg</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>ETH Zurich, SWITZERLAND</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceived and designed the experiments:</bold> FF JH.</p>
</list-item>
<list-item>
<p><bold>Performed the experiments:</bold> FF.</p>
</list-item>
<list-item>
<p><bold>Analyzed the data:</bold> FF JH BK.</p>
</list-item>
<list-item>
<p><bold>Wrote the paper:</bold> FF BK FJT JH.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">jan.hasenauer@helmholtz-muenchen.de</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>1</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>23</day>
<month>1</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>1</issue>
<elocation-id>e1005331</elocation-id>
<history>
<date date-type="received">
<day>4</day>
<month>5</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>20</day>
<month>12</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Fröhlich et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005331"/>
<abstract>
<p>Mechanistic mathematical modeling of biochemical reaction networks using ordinary differential equation (ODE) models has improved our understanding of small- and medium-scale biological processes. While the same should in principle hold for large- and genome-scale processes, the computational methods for the analysis of ODE models which describe hundreds or thousands of biochemical species and reactions are missing so far. While individual simulations are feasible, the inference of the model parameters from experimental data is computationally too intensive. In this manuscript, we evaluate adjoint sensitivity analysis for parameter estimation in large scale biochemical reaction networks. We present the approach for time-discrete measurement and compare it to state-of-the-art methods used in systems and computational biology. Our comparison reveals a significantly improved computational efficiency and a superior scalability of adjoint sensitivity analysis. The computational complexity is effectively independent of the number of parameters, enabling the analysis of large- and genome-scale models. Our study of a comprehensive kinetic model of ErbB signaling shows that parameter estimation using adjoint sensitivity analysis requires a fraction of the computation time of established methods. The proposed method will facilitate mechanistic modeling of genome-scale cellular processes, as required in the age of omics.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>In this manuscript, we introduce a scalable method for parameter estimation for genome-scale biochemical reaction networks. Mechanistic models for genome-scale biochemical reaction networks describe the behavior of thousands of chemical species using thousands of parameters. Standard methods for parameter estimation are usually computationally intractable at these scales. Adjoint sensitivity based approaches have been suggested to have superior scalability but any rigorous evaluation is lacking. We implement a toolbox for adjoint sensitivity analysis for biochemical reaction network which also supports the import of SBML models. We show by means of a set of benchmark models that adjoint sensitivity based approaches unequivocally outperform standard approaches for large-scale models and that the achieved speedup increases with respect to both the number of parameters and the number of chemical species in the model. This demonstrates the applicability of adjoint sensitivity based approaches to parameter estimation for genome-scale mechanistic model. The MATLAB toolbox implementing the developed methods is available from <ext-link ext-link-type="uri" xlink:href="http://ICB-DCM.github.io/AMICI/" xlink:type="simple">http://ICB-DCM.github.io/AMICI/</ext-link>.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5360-4292</contrib-id>
<name name-style="western">
<surname>Fröhlich</surname> <given-names>Fabian</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002347</institution-id>
<institution>Bundesministerium für Bildung und Forschung</institution>
</institution-wrap>
</funding-source>
<award-id>01ZX1310B</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2419-1943</contrib-id>
<name name-style="western">
<surname>Theis</surname> <given-names>Fabian J</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002347</institution-id>
<institution>Bundesministerium für Bildung und Forschung</institution>
</institution-wrap>
</funding-source>
<award-id>01ZX1310B</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Hasenauer</surname> <given-names>Jan</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by the German Research Foundation (DFG; <ext-link ext-link-type="uri" xlink:href="http://www.dfg.de" xlink:type="simple">http://www.dfg.de</ext-link>) through the Graduate School of Quantitative Biosciences Munich (QBM; FF), the German Federal Ministry of Education and Research (BMBF; <ext-link ext-link-type="uri" xlink:href="http://www.bmbf.de" xlink:type="simple">www.bmbf.de</ext-link>) within the SYS-Stomach project (Grant No. 01ZX1310B; JH and FJT) and the Postdoctoral Fellowship Program (<ext-link ext-link-type="uri" xlink:href="https://www.helmholtz-muenchen.de/en/fellows/index.html" xlink:type="simple">https://www.helmholtz-muenchen.de/en/fellows/index.html</ext-link>) of the Helmholtz Zentrum München (JH). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="1"/>
<page-count count="18"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>In the life sciences, the abundance of experimental data is rapidly increasing due to the advent of novel measurement devices. Genome and transcriptome sequencing, proteomics and metabolomics provide large datasets [<xref ref-type="bibr" rid="pcbi.1005331.ref001">1</xref>] at a steadily decreasing cost. While these genome-scale datasets allow for a variety of novel insights [<xref ref-type="bibr" rid="pcbi.1005331.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref003">3</xref>], a mechanistic understanding on the genome scale is limited by the scalability of currently available computational methods.</p>
<p>For small- and medium-scale biochemical reaction networks mechanistic modeling contributed greatly to the comprehension of biological systems [<xref ref-type="bibr" rid="pcbi.1005331.ref004">4</xref>]. Ordinary differential equation (ODE) models are nowadays widely used and a variety of software tools are available for model development, simulation and statistical inference [<xref ref-type="bibr" rid="pcbi.1005331.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005331.ref007">7</xref>]. Despite great advances during the last decade, mechanistic modeling of biological systems using ODEs is still limited to processes with a few dozens biochemical species and a few hundred parameters. For larger models rigorous parameter inference is intractable. Hence, new algorithms are required for massive and complex genomic datasets and the corresponding genome-scale models.</p>
<p>Mechanistic modeling of a genome-scale biochemical reaction network requires the formulation of a mathematical model and the inference of its parameters, e.g. reaction rates, from experimental data. The construction of genome-scale models is mostly based on prior knowledge collected in databases such as KEGG [<xref ref-type="bibr" rid="pcbi.1005331.ref008">8</xref>], REACTOME [<xref ref-type="bibr" rid="pcbi.1005331.ref009">9</xref>] and STRING [<xref ref-type="bibr" rid="pcbi.1005331.ref010">10</xref>]. Based on these databases a series of semi-automatic methods have been developed for the assembly of the reaction graph [<xref ref-type="bibr" rid="pcbi.1005331.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1005331.ref013">13</xref>] and the derivation of rate laws [<xref ref-type="bibr" rid="pcbi.1005331.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref015">15</xref>]. As model construction is challenging and as the information available in databases is limited, in general, a collection of candidate models can be constructed to compensate flaws in individual models [<xref ref-type="bibr" rid="pcbi.1005331.ref016">16</xref>]. For all these model candidates the parameters have to be estimated from experimental data, a challenging and usually ill-posed problem [<xref ref-type="bibr" rid="pcbi.1005331.ref017">17</xref>].</p>
<p>To determine maximum likelihood (ML) and maximum a posteriori (MAP) estimates for model parameters, high-dimensional nonlinear and non-convex optimization problems have to be solved. The non-convexity of the optimization problem poses challenges, such as local minima, which have to be addressed by the selection of optimization methods. Commonly used global optimization methods are multi-start local optimization [<xref ref-type="bibr" rid="pcbi.1005331.ref018">18</xref>], evolutionary and genetic algorithms [<xref ref-type="bibr" rid="pcbi.1005331.ref019">19</xref>], particle swarm optimizers [<xref ref-type="bibr" rid="pcbi.1005331.ref020">20</xref>], simulated annealing [<xref ref-type="bibr" rid="pcbi.1005331.ref021">21</xref>] and hybrid optimizers [<xref ref-type="bibr" rid="pcbi.1005331.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref023">23</xref>] (see [<xref ref-type="bibr" rid="pcbi.1005331.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref024">24</xref>–<xref ref-type="bibr" rid="pcbi.1005331.ref026">26</xref>] for a comprehensive survey). For ODE models with a few hundred parameters and state variables multi-start local optimization methods [<xref ref-type="bibr" rid="pcbi.1005331.ref018">18</xref>] and related hybrid methods [<xref ref-type="bibr" rid="pcbi.1005331.ref027">27</xref>] have proven to be successful. These optimization methods use the gradient of the objective function to establish fast local convergence. While the convergence of gradient based optimizers can be significantly improved by providing exact gradients (see e.g. [<xref ref-type="bibr" rid="pcbi.1005331.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref029">29</xref>]), the gradient calculation is often the computationally most demanding step.</p>
<p>The gradient of the objective function is usually approximated by finite differences. As this method is neither numerically robust nor computationally efficient, several parameter estimation toolboxes employ forward sensitivity analysis. This decreases the numerical error and computation time [<xref ref-type="bibr" rid="pcbi.1005331.ref018">18</xref>]. However, the dimension of the forward sensitivity equations increases linearly with both the number of state variables and parameters, rendering its application for genome-scale models problematic. In other research fields such as mathematics and engineering, adjoint sensitivity analysis is used for parameter estimation in ordinary and partial differential equation models. Adjoint sensitivity analysis is known to be superior to the forward sensitivity analysis when the number of parameters is large [<xref ref-type="bibr" rid="pcbi.1005331.ref030">30</xref>]. Adjoint sensitivity analysis has been used for inference of biochemical reaction networks [<xref ref-type="bibr" rid="pcbi.1005331.ref031">31</xref>–<xref ref-type="bibr" rid="pcbi.1005331.ref033">33</xref>]. However, the methods were never picked up by the systems and computational biology community, supposedly due to the theoretical complexity of adjoint methods, a missing evaluation on a set of benchmark models, and an absence of an easy-to-use toolbox.</p>
<p>In this manuscript, we provide an intuitive description of adjoint sensitivity analysis for parameter estimation in genome-scale biochemical reaction networks. We describe the end value problem for the adjoint state in the case of discrete-time measurement and provide an user-friendly implementation to compute it numerically. The method is evaluated on seven medium- to large-scale models. By using adjoint sensitivity analysis, the computation time for calculating the objective function gradient becomes effectively independent of the number of parameters with respect to which the gradient is evaluated. Furthermore, for large-scale models adjoint sensitivity analysis can be multiple orders of magnitude faster than other gradient calculation methods used in systems biology. The reduction of the time for gradient evaluation is reflected in the computation time of the optimization. This renders parameter estimation for large-scale models feasible on standard computers, as we illustrate for a comprehensive kinetic model of ErbB signaling.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<p>In this section we introduce the model class and the corresponding estimation problem. Subsequently, gradient calculation using finite differences, forward sensitivity analysis and adjoint sensitivity analysis is described and the theoretical complexity as well as some aspects of the numerical implementation are discussed.</p>
<sec id="sec003">
<title>Mathematical model and experimental data</title>
<p>We consider ODE models for biochemical reaction networks,
<disp-formula id="pcbi.1005331.e001"><alternatives><graphic id="pcbi.1005331.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
in which <inline-formula id="pcbi.1005331.e002"><alternatives><graphic id="pcbi.1005331.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the concentration vector at time <italic>t</italic> and <inline-formula id="pcbi.1005331.e003"><alternatives><graphic id="pcbi.1005331.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi>θ</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> denotes the parameter vector. Parameters are usually kinetic constants, such as binding affinities as well as synthesis, degradation and dimerization rates. The vector field <inline-formula id="pcbi.1005331.e004"><alternatives><graphic id="pcbi.1005331.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mi>f</mml:mi> <mml:mspace width="1pt"/><mml:mo>:</mml:mo> <mml:mspace width="1pt"/><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:msup> <mml:mo>×</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:msup> <mml:mo>↦</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> describes the temporal evolution of the concentration of the biochemical species. The mapping <inline-formula id="pcbi.1005331.e005"><alternatives><graphic id="pcbi.1005331.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:mo>:</mml:mo> <mml:mspace width="1pt"/> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:msup> <mml:mo>↦</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> provides the parameter dependent initial condition at time <italic>t</italic><sub>0</sub>.</p>
<p>As available experimental techniques usually do not provide measurements of the concentration of all biochemical species, we consider the output map <inline-formula id="pcbi.1005331.e006"><alternatives><graphic id="pcbi.1005331.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi>h</mml:mi> <mml:mspace width="1pt"/><mml:mo>:</mml:mo> <mml:mspace width="1pt"/> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:msup> <mml:mo>×</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:msup> <mml:mo>↦</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. This map models the measurement process, i.e. the dependence of the output (or observables) <inline-formula id="pcbi.1005331.e007"><alternatives><graphic id="pcbi.1005331.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mi>y</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> at time point <italic>t</italic> on the state variables and the parameters,
<disp-formula id="pcbi.1005331.e008"><alternatives><graphic id="pcbi.1005331.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:mi>y</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>h</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
The <italic>i</italic>-th observable <italic>y</italic><sub><italic>i</italic></sub> can be the concentration of a particular biochemical species (e.g. <italic>y</italic><sub><italic>i</italic></sub> = <italic>x</italic><sub><italic>l</italic></sub>) as well as a function of several concentrations and parameters (e.g. <italic>y</italic><sub><italic>i</italic></sub> = <italic>θ</italic><sub><italic>m</italic></sub>(<italic>x</italic><sub><italic>l</italic><sub>1</sub></sub> + <italic>x</italic><sub><italic>l</italic><sub>2</sub></sub>)).</p>
<p>We consider discrete-time, noise corrupted measurements
<disp-formula id="pcbi.1005331.e009"><alternatives><graphic id="pcbi.1005331.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
yielding the experimental data <inline-formula id="pcbi.1005331.e010"><alternatives><graphic id="pcbi.1005331.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi mathvariant="script">D</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:msubsup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. The number of time points at which measurements have been collected is denoted by <italic>N</italic>.</p>
<p><bold>Remark:</bold> For simplicity of notation we assume throughout the manuscript that the noise variances, <inline-formula id="pcbi.1005331.e011"><alternatives><graphic id="pcbi.1005331.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>, are known and that there are no missing values. However, the methods we will present in the following as well as the respective implementations also work when this is not the case. For details we refer to the <xref ref-type="supplementary-material" rid="pcbi.1005331.s001">S1 Supporting Information</xref>.</p>
</sec>
<sec id="sec004">
<title>Maximum likelihood (ML) estimation</title>
<p>We estimate the unknown parameter <italic>θ</italic> from the experimental data <inline-formula id="pcbi.1005331.e012"><alternatives><graphic id="pcbi.1005331.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mi mathvariant="script">D</mml:mi></mml:math></alternatives></inline-formula> using ML estimation. Parameters are estimated by minimizing the negative log-likelihood, an objective function indicating the difference between experiment and simulation. In the case of independent, normally distributed measurement noise with known variances the objective function is given by
<disp-formula id="pcbi.1005331.e013"><alternatives><graphic id="pcbi.1005331.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mrow><mml:mi>J</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mspace width="1pt"/><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where <italic>y</italic><sub><italic>i</italic></sub>(<italic>t</italic><sub><italic>j</italic></sub>, <italic>θ</italic>) is the value of the output computed from Eqs (<xref ref-type="disp-formula" rid="pcbi.1005331.e001">1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005331.e008">2</xref>) for parameter value <italic>θ</italic>. The minimization,
<disp-formula id="pcbi.1005331.e014"><alternatives><graphic id="pcbi.1005331.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mrow><mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo form="prefix">arg</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>Θ</mml:mo></mml:mrow></mml:munder> <mml:mi>J</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
of this weighted least squares <italic>J</italic> yields the ML estimate of the parameters.</p>
<p>The optimization problem <xref ref-type="disp-formula" rid="pcbi.1005331.e014">Eq (5)</xref> is in general nonlinear and non-convex. Thus, the objective function can possess multiple local minima and global optimization strategies need to be used. For ODE models multi-start local optimization has been shown to perform well [<xref ref-type="bibr" rid="pcbi.1005331.ref018">18</xref>]. In multi-start local optimization, independent local optimization runs are initialized at randomly sampled initial points in parameter space. The individual local optimizations are run until the stopping criteria are met and the results are collected. The collected results are visualized by sorting them according to the final objective function value. This visualization reveals local optima and the size of their basin of attraction. For details we refer to the survey by Raue <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005331.ref018">18</xref>]. In this study, initial points are generated using latin hypercube sampling and local optimization is performed using the interior point and the trust-region-reflective algorithm implemented in the MATLAB function <monospace>fmincon.m</monospace>. Gradients are computed using finite differences, forward sensitivity analysis or adjoint sensitivity analysis.</p>
</sec>
<sec id="sec005">
<title>Finite differences</title>
<p>A näive approximation to the gradient of the objective function with respect to <italic>θ</italic><sub><italic>k</italic></sub> is obtained by finite differences,
<disp-formula id="pcbi.1005331.e015"><alternatives><graphic id="pcbi.1005331.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>J</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>≈</mml:mo> <mml:mfrac><mml:mrow><mml:mi>J</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:mi>a</mml:mi> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>J</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>-</mml:mo> <mml:mi>b</mml:mi> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
with <italic>a</italic>, <italic>b</italic> ≥ 0 and the <italic>k</italic>th unit vector <italic>e</italic><sub><italic>k</italic></sub>. In practice forward differences (<italic>a</italic> = <italic>ϵ</italic>, <italic>b</italic> = 0), backward differences (<italic>a</italic> = 0, <italic>b</italic> = <italic>ϵ</italic>) and central differences (<italic>a</italic> = <italic>ϵ</italic>, <italic>b</italic> = <italic>ϵ</italic>) are widely used. For the computation of forward finite differences, this yields a procedure with three steps:</p>
<list list-type="simple">
<list-item>
<p><bold>Step 1</bold> The state trajectory <italic>x</italic>(<italic>t</italic>, <italic>θ</italic>) and output trajectory <italic>y</italic>(<italic>t</italic>, <italic>θ</italic>) are computed.</p>
</list-item>
<list-item>
<p><bold>Step 2</bold> The state trajectories <italic>x</italic>(<italic>t</italic>, <italic>θ</italic><sup>(<italic>k</italic>)</sup>) and the output trajectories <italic>y</italic>(<italic>t</italic>, <italic>θ</italic><sup>(<italic>k</italic>)</sup>) are computed for the perturbed parameters <italic>θ</italic><sup>(<italic>k</italic>)</sup> = <italic>θ</italic> + <italic>ϵe</italic><sub><italic>k</italic></sub> for <italic>k</italic> = 1, …, <italic>n</italic><sub><italic>θ</italic></sub>.</p>
</list-item>
<list-item>
<p><bold>Step 3</bold> The objective function gradient elements <inline-formula id="pcbi.1005331.e016"><alternatives><graphic id="pcbi.1005331.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>J</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, are computed from the output trajectory <italic>y</italic>(<italic>t</italic>, <italic>θ</italic>) and the perturbed output trajectory <italic>y</italic>(<italic>t</italic>, <italic>θ</italic><sup>(<italic>k</italic>)</sup>) for <italic>k</italic> = 1, …, <italic>n</italic><sub><italic>θ</italic></sub>.</p>
</list-item>
</list>
<p>In theory, forward and backward differences provide approximations of order <italic>ϵ</italic> while central differences provide more accurate approximations of order <italic>ϵ</italic><sup>2</sup>, provided that <italic>J</italic> is sufficiently smooth. In practice the optimal choice of <italic>a</italic> and <italic>b</italic> depends on the accuracy of the numerical integration [<xref ref-type="bibr" rid="pcbi.1005331.ref018">18</xref>]. If the integration accuracy is high, an accurate approximation of the gradient can be achieved using <italic>a</italic>, <italic>b</italic> ≪ 1. For lower integration accuracies, larger values of <italic>a</italic> and <italic>b</italic> usually yield better approximations. A good choice of <italic>a</italic> and <italic>b</italic> is typically not clear <italic>a priori</italic> (cf. [<xref ref-type="bibr" rid="pcbi.1005331.ref034">34</xref>] and the references therein).</p>
<p>The computational complexity of evaluating gradients using finite differences is affine linear in the number of parameters. Forward and backward differences require in total <italic>n</italic><sub><italic>θ</italic></sub> + 1 function evaluations. Central differences require in total 2<italic>n</italic><sub><italic>θ</italic></sub> function evaluations. As already a single simulation of a large-scale model is time-consuming, the gradient calculation using finite differences can be limiting.</p>
</sec>
<sec id="sec006">
<title>Forward sensitivity analysis</title>
<p>State-of-the-art systems biology toolboxes, such as the MATLAB toolbox Data2Dynamics [<xref ref-type="bibr" rid="pcbi.1005331.ref007">7</xref>], use forward sensitivity analysis for gradient evaluation. The gradient of the objective function is
<disp-formula id="pcbi.1005331.e017"><alternatives><graphic id="pcbi.1005331.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>J</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mspace width="1pt"/><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mfenced> <mml:mspace width="1pt"/><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>y</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
with <inline-formula id="pcbi.1005331.e018"><alternatives><graphic id="pcbi.1005331.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>y</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:mo>:</mml:mo><mml:mspace width="1pt"/> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>↦</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> denoting the sensitivity of output <italic>y</italic><sub><italic>i</italic></sub> at time point <italic>t</italic> with respect to parameter <italic>θ</italic><sub><italic>k</italic></sub>. Governing equations for the sensitivities are obtained by differentiating Eqs (<xref ref-type="disp-formula" rid="pcbi.1005331.e001">1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005331.e008">2</xref>) with respect to <italic>θ</italic><sub><italic>k</italic></sub> and reordering the derivatives. This yields
<disp-formula id="pcbi.1005331.e019"><alternatives><graphic id="pcbi.1005331.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>f</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>f</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>y</mml:mi></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
with <inline-formula id="pcbi.1005331.e020"><alternatives><graphic id="pcbi.1005331.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:mo>:</mml:mo> <mml:mspace width="1pt"/> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>↦</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> denoting the sensitivity of the state <italic>x</italic> with respect to <italic>θ</italic><sub><italic>k</italic></sub>. Note that here and in the following, the dependencies of <italic>f</italic>, <italic>h</italic>, <italic>x</italic><sub>0</sub> and their (partial) derivatives on <italic>t</italic>, <italic>x</italic> and <italic>θ</italic> are not stated explicitly but have the to be assumed. For a more detailed presentation we refer to the <xref ref-type="supplementary-material" rid="pcbi.1005331.s001">S1 Supporting Information</xref> <italic>Section 1</italic>.</p>
<p>Forward sensitivity analysis consists of three steps:</p>
<list list-type="simple">
<list-item>
<p><bold>Step 1</bold> The state trajectory <italic>x</italic>(<italic>t</italic>, <italic>θ</italic>) and output trajectory <italic>y</italic>(<italic>t</italic>, <italic>θ</italic>) are computed.</p>
</list-item>
<list-item>
<p><bold>Step 2</bold> The state sensitivities <inline-formula id="pcbi.1005331.e021"><alternatives><graphic id="pcbi.1005331.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the output sensitivities <inline-formula id="pcbi.1005331.e022"><alternatives><graphic id="pcbi.1005331.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>k</mml:mi> <mml:mi>y</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> are computed using the state trajectory <italic>x</italic>(<italic>t</italic>, <italic>θ</italic>) for <italic>k</italic> = 1, …, <italic>n</italic><sub><italic>θ</italic></sub>.</p>
</list-item>
<list-item>
<p><bold>Step 3</bold> The objective function gradient elements <inline-formula id="pcbi.1005331.e023"><alternatives><graphic id="pcbi.1005331.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>J</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, are computed from the output sensitivities <inline-formula id="pcbi.1005331.e024"><alternatives><graphic id="pcbi.1005331.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>k</mml:mi> <mml:mi>y</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the output trajectory <italic>y</italic>(<italic>t</italic>, <italic>θ</italic>) for <italic>k</italic> = 1, …, <italic>n</italic><sub><italic>θ</italic></sub>.</p>
</list-item>
</list>
<p specific-use="continuation">Step 1 and 2 are often combined, which enables simultaneous error control and the reuse of the Jacobian [<xref ref-type="bibr" rid="pcbi.1005331.ref030">30</xref>]. The simultaneous error control allows for the calculation of accurate and reliable gradients. The reuse of the Jacobian improves the computational efficiency.</p>
<p>The number of state and output sensitivities increases linearly with the number of parameters. While this is unproblematic for small- and medium-sized models, solving forward sensitivity equations for systems with several thousand state variable bears technical challenges. Code compilation can take multiple hours and require more memory than what is available on standard machines. Furthermore, while forward sensitivity analysis is usually faster than finite differences, in practice the complexity still increases roughly linearly with the number of parameters.</p>
</sec>
<sec id="sec007">
<title>Adjoint sensitivity analysis</title>
<p>In the numerics community, adjoint sensitivity analysis is frequently used to compute the gradients of a functional with respect to the parameters if the function depends on the solution of a differential equation [<xref ref-type="bibr" rid="pcbi.1005331.ref035">35</xref>]. In contrast to forward sensitivity analysis, adjoint sensitivity analysis does not rely on the state sensitivities <inline-formula id="pcbi.1005331.e025"><alternatives><graphic id="pcbi.1005331.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> but on the adjoint state <italic>p</italic>(<italic>t</italic>).</p>
<p>The calculation of the objective function gradient using adjoint sensitivity analysis consists of three steps:</p>
<list list-type="simple">
<list-item>
<p><bold>Step 1</bold> The state trajectory <italic>x</italic>(<italic>t</italic>, <italic>θ</italic>) and output trajectory <italic>y</italic>(<italic>t</italic>, <italic>θ</italic>) are computed.</p>
</list-item>
<list-item>
<p><bold>Step 2</bold> The trajectory of the adjoint state <italic>p</italic>(<italic>t</italic>) is computed.</p>
</list-item>
<list-item>
<p><bold>Step 3</bold> The objective function gradient elements <inline-formula id="pcbi.1005331.e026"><alternatives><graphic id="pcbi.1005331.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>J</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, <italic>k</italic> = 1, …, <italic>n</italic><sub><italic>θ</italic></sub>, are computed from the state trajectory <italic>x</italic>(<italic>t</italic>, <italic>θ</italic>), the adjoint state trajectory <italic>p</italic>(<italic>t</italic>) and the output trajectory <italic>y</italic>(<italic>t</italic>, <italic>θ</italic>).</p>
</list-item>
</list>
<p specific-use="continuation">Step 1 and 2, which are usually the computationally intensive steps, are independent of the parameter dimension. The complexity of Step 3 increases linearly with the number of parameters, yet the computation time required for this step is typically negligible.</p>
<p>The calculation of state and output trajectories (Step 1) is standard and does not require special methods. The non-trivial element in adjoint sensitivity analysis is the calculation of the adjoint state <inline-formula id="pcbi.1005331.e027"><alternatives><graphic id="pcbi.1005331.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> (Step 2). For discrete-time measurements—the usual case in systems and computational biology—the adjoint state is piece-wise continuous in time and defined by a sequence of backward differential equations. For <italic>t</italic> &gt; <italic>t</italic><sub><italic>N</italic></sub>, the adjoint state is zero, <italic>p</italic>(<italic>t</italic>) = 0. Starting from this end value the trajectory of the adjoint state is calculated backwards in time, from the last measurement <italic>t</italic> = <italic>t</italic><sub><italic>N</italic></sub> to the initial time <italic>t</italic> = <italic>t</italic><sub>0</sub>. At the time points at which measurements have been collected, <italic>t</italic><sub><italic>N</italic></sub>, …, <italic>t</italic><sub>1</sub>, the adjoint state is reinitialised as
<disp-formula id="pcbi.1005331.e028"><alternatives><graphic id="pcbi.1005331.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>→</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>j</mml:mi> <mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:munderover> <mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced> <mml:mi>T</mml:mi></mml:msup> <mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
which usually results in a discontinuity of <italic>p</italic>(<italic>t</italic>) at <italic>t</italic><sub><italic>j</italic></sub>. Starting from the end value <italic>p</italic>(<italic>t</italic><sub><italic>j</italic></sub>) as defined in <xref ref-type="disp-formula" rid="pcbi.1005331.e028">Eq (9)</xref> the adjoint state evolves backwards in time until the next measurement point <italic>t</italic><sub><italic>j</italic>−1</sub> or the initial time <italic>t</italic><sub>0</sub> is reached. This evolution is governed by the time-dependent linear ODE
<disp-formula id="pcbi.1005331.e029"><alternatives><graphic id="pcbi.1005331.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>f</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced> <mml:mi>T</mml:mi></mml:msup> <mml:mspace width="1pt"/><mml:mi>p</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
The repeated evaluation of Eqs (<xref ref-type="disp-formula" rid="pcbi.1005331.e028">9</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005331.e029">10</xref>) until <italic>t</italic> = <italic>t</italic><sub>0</sub> yields the trajectory of the adjoint state. Given this trajectory, the gradient of the objective function with respect to the individual parameters is
<disp-formula id="pcbi.1005331.e030"><alternatives><graphic id="pcbi.1005331.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005331.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>J</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:msub><mml:mi>t</mml:mi> <mml:mi>N</mml:mi></mml:msub></mml:msubsup> <mml:msup><mml:mi>p</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>f</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>-</mml:mo> <mml:mi>p</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
Accordingly, the availability of the adjoint state simplifies the calculation of the objective function to <italic>n</italic><sub><italic>θ</italic></sub> one-dimensional integration problems over short time intervals whose union is the total time interval [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>N</italic></sub>].</p>
<p><bold>Algorithm 1:</bold> Gradient evaluation using adjoint sensitivity analysis</p>
<p specific-use="line"><italic>% State and output</italic></p>
<p specific-use="line"><italic>Step 1</italic> Compute state and output trajectories using Eqs (<xref ref-type="disp-formula" rid="pcbi.1005331.e001">1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005331.e008">2</xref>).</p>
<p specific-use="line"><italic>% Adjoint state</italic></p>
<p specific-use="line"><italic>Step 2.1</italic> Set end value for adjoint state, ∀<italic>t</italic> &gt; <italic>t</italic><sub><italic>N</italic></sub>: <italic>p</italic>(<italic>t</italic>) = 0.</p>
<p specific-use="line"><bold>for</bold> <italic>j</italic> = <italic>N to 1</italic> <bold>do</bold></p>
<p specific-use="line"> <italic>Step 2.2</italic> Compute end value for adjoint state according to the <italic>j</italic>th measurement using <xref ref-type="disp-formula" rid="pcbi.1005331.e028">Eq (9)</xref>.</p>
<p specific-use="line"> <italic>Step 2.3</italic> Compute trajectory of adjoint state on time interval <italic>t</italic> = (<italic>t</italic><sub><italic>j</italic>−1</sub>, <italic>t</italic><sub><italic>j</italic></sub>] by solving <xref ref-type="disp-formula" rid="pcbi.1005331.e029">Eq (10)</xref>.</p>
<p specific-use="line"><bold>end</bold></p>
<p specific-use="line"><italic>% Objective function gradient</italic></p>
<p specific-use="line"><bold>for</bold> <italic>k</italic> = 1 <italic>to</italic> <italic>n</italic><sub><italic>θ</italic></sub> <bold>do</bold></p>
<p specific-use="line"> <italic>Step 3</italic> Evaluation of the sensitivity ∂<italic>J</italic>/∂<italic>θ</italic><sub><italic>k</italic></sub> using <xref ref-type="disp-formula" rid="pcbi.1005331.e030">Eq (11)</xref>.</p>
<p specific-use="line"><bold>end</bold></p>
<p>Pseudo-code for the calculation of the adjoint state and the objective function gradient is provided in Algorithm 1. We note that in order to use standard ODE solvers the end value problem <xref ref-type="disp-formula" rid="pcbi.1005331.e029">Eq (10)</xref> can be transformed in an initial value problem by applying the time transformation <italic>τ</italic> = <italic>t</italic><sub><italic>N</italic></sub> − <italic>t</italic>. The derivation of the adjoint sensitivities for discrete-time measurements is provided in the <xref ref-type="supplementary-material" rid="pcbi.1005331.s001">S1 Supporting Information</xref> <italic>Section 1</italic>.</p>
<p>The key difference of the adjoint compared to the forward sensitivity analysis is that the derivatives of the state and the output trajectory with respect to the parameters are not explicitly calculated. Instead, the sensitivity of the objective function is directly computed. This results in practice in a computation time of the gradient which is almost independent of the number of parameters. A visual summary of the different sensitivity analysis methods is provided in <xref ref-type="fig" rid="pcbi.1005331.g001">Fig 1</xref>. Besides the procedures also the computational complexity is indicated.</p>
<fig id="pcbi.1005331.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005331.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Illustration of gradient calculation using finite differences, forward sensitivity analysis and adjoint sensitivity equations for a model of mRNA transfection.</title>
<p>(a) Sketch and mathematical formulation of the mathematical model of mRNA transfection presented by [<xref ref-type="bibr" rid="pcbi.1005331.ref036">36</xref>]. The intracellular release of mRNA at time point <italic>t</italic><sub><italic>r</italic></sub> is modeled using the Dirac delta distribution <italic>δ</italic>. (b) Illustration of finite differences, forward sensitivity analysis and adjoint sensitivity analysis for the model of mRNA transfection: (top) Step 1: simulation of model; (middle) Step 2: intermediate step for gradient calculation; and (bottom) Step 3: calculation of gradient from intermediate results. For all methods, Step 1 and 2 involve numerical simulation (the direction indicated by the arrow) and are computationally demanding, while Step 3 is computationally negligible.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005331.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Implementation</title>
<p>The implementation of adjoint sensitivity analysis is non-trivial and error-prone. To render this method available to the systems and computational biology community, we implemented the Advanced Matlab Interface for CVODES and IDAS (AMICI). This toolbox allows for a simple symbolic definition of ODE models (<xref ref-type="disp-formula" rid="pcbi.1005331.e001">1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005331.e008">2</xref>) as well as the automatic generation of native C code for efficient numerical simulation. The compiled binaries can be executed from MATLAB for the numerical evaluation of the model and the objective function gradient. Internally, the SUNDIALS solvers suite is employed [<xref ref-type="bibr" rid="pcbi.1005331.ref030">30</xref>], which offers a broad spectrum of state-of-the-art numerical integration of differential equations. In addition to the standard functionality of SUNDIALS, our implementation allows for parameter and state dependent discontinuities. The toolbox and a detailed documentation can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://ICB-DCM.github.io/AMICI/" xlink:type="simple">http://ICB-DCM.github.io/AMICI/</ext-link>.</p>
</sec>
</sec>
<sec id="sec009" sec-type="results">
<title>Results</title>
<p>In the following, we will illustrate the properties of adjoint sensitivity analysis for biochemical reaction networks. For this purpose, we study several models provided in the BioPreDyn benchmark suite [<xref ref-type="bibr" rid="pcbi.1005331.ref027">27</xref>] and from the curated branch of the Biomodels Database [<xref ref-type="bibr" rid="pcbi.1005331.ref037">37</xref>]. We compare adjoint sensitivity analysis with forward sensitivity analysis and finite differences regarding accuracy, computational efficiency and scalability for a set of medium- to large-scale models.</p>
<sec id="sec010">
<title>Investigated models</title>
<p>For the comparison of different gradient calculation methods, we consider a set of standard models from the Biomodels Database [<xref ref-type="bibr" rid="pcbi.1005331.ref037">37</xref>] and the BioPreDyn benchmark suite [<xref ref-type="bibr" rid="pcbi.1005331.ref027">27</xref>]. From the biomodels database we considered models for the regulation of insulin signaling by oxidative stress (BM1) [<xref ref-type="bibr" rid="pcbi.1005331.ref038">38</xref>], the sea urchin endomesoderm network (BM2) [<xref ref-type="bibr" rid="pcbi.1005331.ref039">39</xref>], and the ErbB sigaling pathway (BM3) [<xref ref-type="bibr" rid="pcbi.1005331.ref040">40</xref>]. From BioPreDyn benchmark suite we considered models for central carbon metabolism in <italic>E. coli</italic> (B2) [<xref ref-type="bibr" rid="pcbi.1005331.ref041">41</xref>], enzymatic and transcriptional regulation of carbon metabolism in <italic>E. coli</italic> (B3) [<xref ref-type="bibr" rid="pcbi.1005331.ref042">42</xref>], metabolism of CHO cells (B4) [<xref ref-type="bibr" rid="pcbi.1005331.ref043">43</xref>], and signaling downstream of EGF and TNF (B5) [<xref ref-type="bibr" rid="pcbi.1005331.ref044">44</xref>]. Genome-wide kinetic metabolic models of <italic>S. cerevisiae</italic> and <italic>E.coli</italic> (B1) [<xref ref-type="bibr" rid="pcbi.1005331.ref045">45</xref>] contained in the BioPreDyn benchmark suite and the Biomodels Database [<xref ref-type="bibr" rid="pcbi.1005331.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref045">45</xref>] were disregarded due to previously reported numerical problems [<xref ref-type="bibr" rid="pcbi.1005331.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref045">45</xref>]. The considered models possess 18-500 state variable and 86-1801 parameters. A comprehensive summary regarding the investigated models is provided in <xref ref-type="table" rid="pcbi.1005331.t001">Table 1</xref>.</p>
<table-wrap id="pcbi.1005331.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005331.t001</object-id>
<label>Table 1</label>
<caption>
<title>List of investigated models and their properties.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005331.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005331.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">ID</th>
<th align="center">Parameters</th>
<th align="center">State Variables</th>
<th align="center">Model Type</th>
<th align="center">Time Points</th>
<th align="center">Data Points</th>
<th align="center">Ref</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">B2</td>
<td align="center">116</td>
<td align="center">18</td>
<td align="center">Metabolic</td>
<td align="center">51</td>
<td align="center">110</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1005331.ref041">41</xref>]</td>
</tr>
<tr>
<td align="center">B3</td>
<td align="center">178</td>
<td align="center">47</td>
<td align="center">Metabolic/Gene Reg.</td>
<td align="center">161</td>
<td align="center">7567</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1005331.ref042">42</xref>]</td>
</tr>
<tr>
<td align="center">B4</td>
<td align="center">117</td>
<td align="center">34</td>
<td align="center">Metabolic</td>
<td align="center">12</td>
<td align="center">156</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1005331.ref043">43</xref>]</td>
</tr>
<tr>
<td align="center">B5</td>
<td align="center">86</td>
<td align="center">26</td>
<td align="center">Signaling</td>
<td align="center">16</td>
<td align="center">960</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1005331.ref044">44</xref>]</td>
</tr>
<tr>
<td align="center">BM1</td>
<td align="center">383</td>
<td align="center">104</td>
<td align="center">Signaling</td>
<td align="center">10</td>
<td align="center">120</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1005331.ref038">38</xref>]</td>
</tr>
<tr>
<td align="center">BM2</td>
<td align="center">1801</td>
<td align="center">431</td>
<td align="center">Gene Reg.</td>
<td align="center">21</td>
<td align="center">3780</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1005331.ref039">39</xref>]</td>
</tr>
<tr>
<td align="center">BM3</td>
<td align="center">219</td>
<td align="center">500</td>
<td align="center">Signaling</td>
<td align="center">21</td>
<td align="center">105</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1005331.ref040">40</xref>]</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>To obtain realistic simulation times for adjoint sensitivities realistic experimental data is necessary (see <xref ref-type="supplementary-material" rid="pcbi.1005331.s001">S1 Supporting Information</xref> Section 3). For the BioPreDyn models we used the data provided in the suite, for the ErbB signaling pathway we used the experimental data provided in the original publication and for the remaining models we generated synthetic data using the nominal parameter provided in the SBML definition.</p>
<p>In the following, we will compare the performance of forward and adjoint sensitivities for these models. As the model of ErbB signaling has the largest number of state variables and is of high practical interest in the context of cancer research, we will analyze the scalability of finite differences and forward and adjoint sensitivity analysis for this model in greater detail. Moreover, we will compare the computational efficiency of forward and adjoint sensitivity analysis for parameter estimation for the model of ErbB signaling.</p>
</sec>
<sec id="sec011">
<title>Scalability of gradient evaluation using adjoint sensitivity analysis</title>
<p>The evaluation of the objective function gradient is the computationally demanding step in deterministic local optimization. For this reason, we compared the computation time for finite differences, forward sensitivity analysis and adjoint sensitivity analysis and studied the scalability of these approaches at the nominal parameter <italic>θ</italic><sub>0</sub> which was provided in the SBML definitions of the investigated models.</p>
<p>For the comprehensive model of ErbB signaling we found that the computation times for finite differences and forward sensitivity analysis behave similarly (<xref ref-type="fig" rid="pcbi.1005331.g002">Fig 2a</xref>). As predicted by the theory, for both methods the computation time increased linearly with the number of parameters. Still, forward sensitivities are computationally more efficient than finite differences, as reported in previous studies [<xref ref-type="bibr" rid="pcbi.1005331.ref018">18</xref>].</p>
<fig id="pcbi.1005331.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005331.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Comparison of gradient computation times for finite differences and forward and adjoint sensitivity analysis.</title>
<p>(a) Scaling of computation time with respect to the number of parameters for the model of ErbB signaling (BM3). Computation time for finite differences and forward sensitivity equations increases roughly linearly. Computation time for adjoint sensitivity analysis is almost independent of the number of parameters but possesses a higher initial cost. Adjoint sensitivity analysis is 48 times faster than forward sensitivity analysis when considering all parameters. (b,c) Speedup when using adjoint sensitivity analysis over forward sensitivity analysis for gradient computation evaluated for all investigated models compared against <italic>n</italic><sub><italic>θ</italic></sub> and <italic>n</italic><sub><italic>x</italic></sub> ⋅ <italic>n</italic><sub><italic>θ</italic></sub>. Regression curves (dashed lines) have been fitted to the results of all models excluding B3, which seems to be an outlier. All computations were performed on a MacBook Pro with an 2.9 GHz Intel Core i7 processor.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005331.g002" xlink:type="simple"/>
</fig>
<p>Adjoint sensitivity analysis requires the solution to the adjoint problem, independent of the number of parameters. For the considered model, solving the adjoint problem a single time takes roughly 2-3-times longer than solving the forward problem. Accordingly, adjoint sensitivity analysis with respect to a small number of parameter is disadvantageous. However, adjoint sensitivity analysis scales better than forward sensitivity analysis and finite differences. Indeed, the computation time for adjoint sensitivity analysis is almost independent of the number of parameters. While computing the sensitivity with respect to a single parameter takes on average 10.09 seconds, computing the sensitivity with respect to all 219 parameters takes merely 14.32 seconds. We observe an average increase of 1.9 ⋅ 10<sup>−2</sup> seconds per additional parameter for adjoint sensitivity analysis which is significantly lower than the expected 3.24 seconds for forward sensitivity analysis and 4.72 seconds for finite differences. If the sensitivities with respect to more than 4 parameters are required, adjoint sensitivity analysis outperforms both forward sensitivity analysis and finite differences. For 219 parameters, adjoint sensitivity analysis is 48-times faster than forward sensitivities and 72-times faster than finite differences.</p>
<p>To ensure that the observed speedup is not unique to the model of ErbB signaling (BM3) we also evaluated the speedup of adjoint sensitivity analysis over forward sensitivity analysis on models B2-5 and BM1-2. The results are presented in <xref ref-type="fig" rid="pcbi.1005331.g002">Fig 2b and 2c</xref>. We find that for all models, but model B3, gradient calculation using adjoint sensitivity is computationally more efficient than gradient calculation using forward sensitivities (speedup &gt; 1). For model B3 the backwards integration required a much higher number of integration steps (4 ⋅ 10<sup>6</sup>) than the forward integration (6 ⋅ 10<sup>3</sup>), which results to a poor performance of the adjoint method. One reason for this poor performance could be that, in contrast to other models, the right hand side of the differential equation of model B3 consists almost exclusively of non-linear, non-mass-action terms.</p>
<p>Excluding model B3 we find an polynomial increase in the speedup with respect to the number of parameters <italic>n</italic><sub><italic>θ</italic></sub> (<xref ref-type="fig" rid="pcbi.1005331.g002">Fig 2b</xref>), as predicted by theory. Moreover, we find that the product <italic>n</italic><sub><italic>θ</italic></sub> ⋅ <italic>n</italic><sub><italic>x</italic></sub>, which corresponds to the size of the system of forward sensitivity equations, is an even better predictor (<italic>R</italic><sup>2</sup> = 0.99) than <italic>n</italic><sub><italic>θ</italic></sub> alone (<italic>R</italic><sup>2</sup> = 0.83). This suggest that adjoint sensitivity analysis is not only beneficial for systems with a large number of parameters, but can also be beneficial for systems with a large number of state variables. As we are not aware of any similar observations in the mathematics or engineering community, this could be due to the structure of biological reaction networks.</p>
<p>Our results suggest that adjoint sensitivity analysis is an excellent candidate for parameter estimation in large-scale models as it provides good scaling with respect to both, the number of parameters and the number of state variables.</p>
</sec>
<sec id="sec012">
<title>Accuracy and robustness of gradients computing adjoint sensitivity analysis</title>
<p>Efficient local optimization requires accurate and robust gradient evaluation [<xref ref-type="bibr" rid="pcbi.1005331.ref018">18</xref>]. To assess the accuracy of the gradient computed using adjoint sensitivity analysis, we compared this gradient to the gradients computed via finite differences and forward sensitivity analysis. <xref ref-type="fig" rid="pcbi.1005331.g003">Fig 3</xref> visualizes the results for the model of ErbB signaling (BM3) at the nominal parameter <italic>θ</italic><sub>0</sub> which was provided in the SBML definition. The results are similar for other starting points.</p>
<fig id="pcbi.1005331.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005331.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison of the gradients computed using adjoint sensitivity equations with gradients computed using finite differences and forward sensitivity equations with default accuracies (absolute error &lt; 10<sup>−16</sup>, relative error &lt; 10<sup>−8</sup>).</title>
<p>Each point represents the absolute value of one gradient element. Points on the diagonal indicate a good agreement. (a) Forward finite differences with <italic>ϵ</italic> = 10<sup>−3</sup> vs. adjoint sensitivities. (b) Forward sensitivities vs. adjoint sensitivities. (c) Adjoint sensitivities with high accuracies (absolute error &lt; 10<sup>−32</sup>, relative error &lt; 10<sup>−16</sup>) and default accuracies (absolute error &lt; 10<sup>−16</sup>, relative error &lt; 10<sup>−8</sup>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005331.g003" xlink:type="simple"/>
</fig>
<p>The comparison of the gradients obtained using finite differences and adjoint sensitivity analysis revealed small discrepancies (<xref ref-type="fig" rid="pcbi.1005331.g003">Fig 3a</xref>). The median relative difference (as defined in <xref ref-type="supplementary-material" rid="pcbi.1005331.s001">S1 Supporting Information</xref> Section 2) between finite differences and adjoint sensitivity analysis is 1.5 ⋅ 10<sup>−3</sup>. For parameters <italic>θ</italic><sub><italic>k</italic></sub> to which the objective function <italic>J</italic> was relatively insensitive, ∂<italic>J</italic>/∂<italic>θ</italic><sub><italic>k</italic></sub> &lt; 10<sup>−2</sup>, there are much higher discrepancies, up to a relative error of 2.9 ⋅ 10<sup>3</sup>.</p>
<p>Forward and adjoint sensitivity analysis yielded almost identical gradient elements over several orders of magnitude (<xref ref-type="fig" rid="pcbi.1005331.g003">Fig 3b</xref>). This was expected as both forward and adjoint sensitivity analysis exploit error-controlled numerical integration for the sensitivities. To assess numerical robustness of adjoint sensitivity analysis, we also compared the results obtained for high and low integration accuracies (<xref ref-type="fig" rid="pcbi.1005331.g003">Fig 3c</xref>). For both comparisons we found the similar median relative and maximum relative error, namely 2.6 ⋅ 10<sup>−6</sup> and 9.3 ⋅ 10<sup>−4</sup>. This underlines the robustness of the sensitivitity based methods and ensures that differences observed in <xref ref-type="fig" rid="pcbi.1005331.g003">Fig 3a</xref> indeed originate from the inaccuracy of finite differences.</p>
<p>Our results demonstrate that adjoint sensitivity analysis provides objective function gradients which are as accurate and robust as those obtained using forward sensitivity analysis.</p>
</sec>
<sec id="sec013">
<title>Optimization of large-scale models using adjoint sensitivity analysis</title>
<p>As adjoint sensitivity analysis provides accurate gradients for a significantly reduced computational cost, this can boost the performance of a variety of optimization methods. Yet, in contrast to forward sensitivity analysis, adjoint sensitivities do not yield sensitivities of observables and it is thus not possible to approximate the Hessian of the objective function via the Fisher Information Matrix [<xref ref-type="bibr" rid="pcbi.1005331.ref046">46</xref>]. This prohibits the use of possibly more efficient Newton-type algorithms which exploit second order information. Therefore, adjoint sensitivities are limited to quasi-Newton type optimization algorithms, e.g. the Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm [<xref ref-type="bibr" rid="pcbi.1005331.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref048">48</xref>], for which the Hessian is iteratively approximated from the gradient during optimization. In principle, the exact calculation of the Hessian and Hessian-Vector products is possible via second order forward and adjoint sensitivity analysis [<xref ref-type="bibr" rid="pcbi.1005331.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref050">50</xref>], which possess similar scaling properties as the first order methods. However, both forward and adjoint approaches come at an additional cost and are thus not considered in this study.</p>
<p>To assess whether the use of adjoint sensitivities for optimization is still viable, we compared the performance of the interior point algorithm using adjoint sensitivity analysis with the BFGS approximation of the Hessian to the performance of the trust-region reflective algorithm using forward sensitivity analysis with Fisher Information Matrix as approximation of the Hessian. For both algorithms we used the MATLAB implementation in <monospace>fmincon.m</monospace>. The employed setup of the trust-region algorithm is equivalent to the use of <monospace>lsqnonlin.m</monospace> which is the default optimization algorithm in the MATLAB toolbox Data2Dynamics [<xref ref-type="bibr" rid="pcbi.1005331.ref007">7</xref>], which was employed to win several DREAM challenges. For the considered model the computation time of forward sensitivities is comparable in Data2Dynamics and AMICI. Therefore, we expect that Data2Dynamics would perform similar to the trust-region reflective algorithm coupled to forward sensitivity analysis.</p>
<p>We evaluated the performance for the model of ErbB signaling based on 100 multi-starts which were initialized at the same initial points for both optimization methods. For 41 out of 100 initial points the gradient could not be evaluated due numerical problems. These optimization runs are omitted in all further analysis. To limit the expected computation to a bearable amount we allowed a maximum of 10 iterations for the forward sensitivity approach and 500 iterations for the adjoint sensitivity approach. As the previously observed speedup in gradient computation was roughly 48 fold, we expected this setup should yield similar computation times for both approaches.</p>
<p>We found that for the considered number of iterations, both approaches perform similar in terms of objective function value compared across iterations (<xref ref-type="fig" rid="pcbi.1005331.g004">Fig 4a and 4b</xref>). However, the computational cost of one iteration was much cheaper for the optimizer using adjoint sensitivity analysis. Accordingly, given a fixed computation time the interior-point method using adjoint sensitivities outperforms the trust-region method employing forward sensitivities and the FIM (<xref ref-type="fig" rid="pcbi.1005331.g004">Fig 4c and 4d</xref>). In the allowed computation time, the interior point algorithm using adjoint sensitivities could reduce the objective function by up to two orders of magnitude (<xref ref-type="fig" rid="pcbi.1005331.g004">Fig 4c</xref>). This was possible although many model parameters seem to be non-identifiable (see <xref ref-type="supplementary-material" rid="pcbi.1005331.s001">S1 Supporting Information</xref> Section 4), which can cause problems.</p>
<fig id="pcbi.1005331.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005331.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Comparison of optimization speed using forward and adjoint sensitivities for the model of ErbB signaling.</title>
<p>For local optimization using forward sensitivity analysis (trust-region method) and local optimization using adjoint sensitivity analysis (interior-point method) we quantified the computation time across 100 local optimization runs with different initial conditions. For 41 out of 100 initial points the gradient could not be evaluated due to numerical problems. These optimization runs are omitted in all further analysis. (a,c) Comparison of objective function value with respect to iteration number and computation time. The hulls and medians computed for both methods are depicted as shaded areas and solid lines. (b,d) Pairwise comparison of objective function value after 10 iterations and 5 hours for both methods. Each dot corresponds to one initial point for the optimization. The coloring indicates which method performed better. (e) Pairwise comparison of the time required to reach the final objective function value achieved in the forward approach. For the adjoint approach the equivalent time is the minimal time to reach the same objective function value. Each dot corresponds to one initial point for the optimization. (f) Histogram of speedup by using adjoint sensitivity analysis over forward sensitivity analysis for individual initial points, computed from (e). All computations were performed on a linux cluster. Runs with same initial conditions were carried out on the same computation node.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005331.g004" xlink:type="simple"/>
</fig>
<p>To quantify the speedup of the optimization using adjoint sensitivity analysis over the optimization using forward sensitivity analysis, we performed a pairwise comparison of the minimal time required by the adjoint sensitivity approach to reach the final objective function value of the forward sensitivity approach for the individual points (<xref ref-type="fig" rid="pcbi.1005331.g004">Fig 4e</xref>). The median speedup achieved across all multi-starts was 54 (<xref ref-type="fig" rid="pcbi.1005331.g004">Fig 4f</xref>), which was similar to the 48 fold speedup achieved in the gradient computation. The availability of the Fisher Information Matrix for forward sensitivities did not compensate for the significantly reduced computation time achieved using adjoint sensitivity analysis. This could be due to the fact that adjoint sensitivity based approach, being able to carry out many iterations in a short time-frame, can build a reasonable approximation of the Hessian approximation relatively fast.</p>
<p>In summary, this application demonstrates the applicability of adjoint sensitivity analysis for parameter estimation in large-scale biochemical reaction networks. Possessing similar accuracy as forward sensitivities, the scalability is improved which results in an increased optimizer efficiency. For the model of ErbB signaling, optimization using adjoint sensitivity analysis outperformed optimization using forward sensitivity analysis.</p>
</sec>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>Mechanistic mathematical modeling at the genome scale is an important step towards a holistic understanding of biological processes. To enable modeling at this scale, scalable computational methods are required which are applicable to networks with thousands of compounds. In this manuscript, we present a gradient computation method which meets this requirement and which renders parameter estimation for large-scale models significantly more efficient. Adjoint sensitivity analysis, which is extensively used in other research fields, is a powerful tool for estimating parameters of large-scale ODE models of biochemical reaction networks.</p>
<p>Our study of several benchmark models with up to 500 state variables and up to 1801 parameters demonstrated that adjoint sensitivity analysis provides accurate gradients in a computation time which is much lower than for established methods and effectively independent of the number of parameters. To achieve this, the adjoint state is computed using a piece-wise continuous backward differential equation. This backward differential equation has the same dimension as the original model, yet the computation time required to solve it usually is slightly larger. As a result, finite differences and forward sensitivity analysis might be more efficient if the sensitivities with respect to a few parameters are required. The same holds for alternatives like complex-step derivative approximation techniques [<xref ref-type="bibr" rid="pcbi.1005331.ref051">51</xref>] and forward-mode automatic differentiation [<xref ref-type="bibr" rid="pcbi.1005331.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref052">52</xref>]. For systems with many parameters, adjoint sensitivity analysis is advantageous. A scalable alternative might be reverse-mode automatic differentiation [<xref ref-type="bibr" rid="pcbi.1005331.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref053">53</xref>], which remains to be evaluated for the considered class of problems.</p>
<p>For the model of ErbB signaling we could show that adjoint sensitivity based optimization outperforms forward sensitivity based optimization, which is the standard in most systems biology toolboxes. With the availability of the MATLAB toolbox AMICI the adjoint sensitivity based approach becomes accessible for other researchers. AMICI allows for the fully automated generation of executables for adjoint or forward sensitivity analysis from symbolic model definitions. This way, the toolbox is easy-to-use and can easily be integrated with existing toolboxes. Also other MATLAB toolboxes for computational modeling, e.g. AMIGO [<xref ref-type="bibr" rid="pcbi.1005331.ref006">6</xref>], Data2Dynamics [<xref ref-type="bibr" rid="pcbi.1005331.ref007">7</xref>], MEIGO [<xref ref-type="bibr" rid="pcbi.1005331.ref054">54</xref>] and SBtoolbox2 [<xref ref-type="bibr" rid="pcbi.1005331.ref055">55</xref>] could be extended to exploit adjoint sensitivity analysis. In addition to adjoint sensitivity analysis, these MATLAB toolboxes could exploit forward sensitivity analysis available via AMICI, as AMICI yields computation times comparable to those of tailored numerical methods such as odeSD [<xref ref-type="bibr" rid="pcbi.1005331.ref056">56</xref>] (<xref ref-type="supplementary-material" rid="pcbi.1005331.s001">S1 Supporting Information</xref> <italic>Section 5</italic>) or Data2Dynamics [<xref ref-type="bibr" rid="pcbi.1005331.ref007">7</xref>]. Moreover AMICI comes with detailed documentation and is already now used by several research labs.</p>
<p>Our study of the model of ErbB signaling suggests that for the available data, a large number of parameters remains non-identifiable. While novel technologies provide rich dataset, we expect that non-identifiability will remain a problem. In particular if merely relative measurements are available, as the case for many measurement techniques, additional unknown scaling factors need to be introduced. These scaling factors are, in combination with initial conditions and total abundances, often the source of practical and structural non-identifiabilites [<xref ref-type="bibr" rid="pcbi.1005331.ref018">18</xref>]. Fortunately, for a broad range of biological questions, these information are not necessary and also state-of-the-art methods optimization seem to work reasonably well in the presence of non-identifiabilities. For the considered model of EreB signaling, we were able to achieve a significant decrease in the objective function value, despite the non-identifiability of parameters. This demonstrates that gradient based optimization is still feasible for large-scale problems. Yet, we believe that convergence of the optimizer could be improved by regularizing the objective function by integrating prior knowledge, possibly in a Bayesian framework [<xref ref-type="bibr" rid="pcbi.1005331.ref057">57</xref>], from databases such as SABIO-RK [<xref ref-type="bibr" rid="pcbi.1005331.ref058">58</xref>] or BRENDA [<xref ref-type="bibr" rid="pcbi.1005331.ref059">59</xref>].</p>
<p>Beyond the use in optimization, gradients computed using adjoint sensitivity analysis will also facilitate the development of more efficient uncertainty analysis methods. Riemann manifold Langevin and Hamiltonian Monte Carlo methods [<xref ref-type="bibr" rid="pcbi.1005331.ref060">60</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref061">61</xref>] exploit the first and second order local structure of the posterior distribution and profit from more efficient gradient evaluation. The same holds for novel emulator-based sampling procedures [<xref ref-type="bibr" rid="pcbi.1005331.ref062">62</xref>] and approaches for posterior approximation [<xref ref-type="bibr" rid="pcbi.1005331.ref063">63</xref>]. By exploiting the proposed approach, rigorous Bayesian parameter estimation for models with hundreds of parameters could become a standard tool instead of an exception [<xref ref-type="bibr" rid="pcbi.1005331.ref064">64</xref>, <xref ref-type="bibr" rid="pcbi.1005331.ref065">65</xref>].</p>
<p>In conclusion, adjoint sensitivity analysis will facilitate the development of large- and genome-scale mechanistic models for cellular processes as well as other (multi-scale) biological processes [<xref ref-type="bibr" rid="pcbi.1005331.ref066">66</xref>]. This will complement available statistical analysis methods for omics data [<xref ref-type="bibr" rid="pcbi.1005331.ref067">67</xref>] by providing mechanistic insights and render a holistic understanding feasible.</p>
</sec>
<sec id="sec015">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005331.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005331.s001" xlink:type="simple">
<label>S1 Supporting Information</label>
<caption>
<title>Supplementary notes regarding sensitivity analysis and additional numerical examples.</title>
<p>This document provides a detailed derivation of forward and adjoint sensitivity analysis and one additional numerical example for the comparision to the MATLAB toolbox odeSD.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005331.s002" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005331.s002" xlink:type="simple">
<label>S1 Code</label>
<caption>
<title>MATLAB code.</title>
<p>This zip-file contains the MATLAB code for the simulation and application examples presented in the paper. We provide implementations of all models, parameter estimation to allow everybody to reproduce the results.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005331.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Soon</surname> <given-names>WW</given-names></name>, <name name-style="western"><surname>Hariharan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Snyder</surname> <given-names>MP</given-names></name>. <article-title>High-throughput sequencing for biology and medicine</article-title>. <source>Mol Syst Biol</source>; <year>2013</year>;<volume>9</volume>(<issue>640</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2012.61" xlink:type="simple">10.1038/msb.2012.61</ext-link></comment> <object-id pub-id-type="pmid">23340846</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chen</surname> <given-names>R</given-names></name> <etal>et al</etal>. <article-title>Personal omics profiling reveals dynamic molecular and medical phenotypes</article-title>. <source>Cell</source>; <year>2012</year>;<volume>148</volume>(<issue>6</issue>):<fpage>1293</fpage>–<lpage>1307</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2012.02.009" xlink:type="simple">10.1016/j.cell.2012.02.009</ext-link></comment> <object-id pub-id-type="pmid">22424236</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ciriello</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Aksoy</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Senbabaoglu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Schultz</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>. <article-title>Emerging landscape of oncogenic signatures across human cancers</article-title>. <source>Nat Gen</source>; <year>2013</year>;<volume>45</volume>(<issue>10</issue>):<fpage>1127</fpage>–<lpage>1133</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng.2762" xlink:type="simple">10.1038/ng.2762</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kitano</surname> <given-names>H</given-names></name>. <article-title>Computational Systems Biology</article-title>. <source>Nature</source>; <year>2002</year>;<volume>420</volume>(<issue>6912</issue>):<fpage>206</fpage>–<lpage>210</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature01254" xlink:type="simple">10.1038/nature01254</ext-link></comment> <object-id pub-id-type="pmid">12432404</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hoops</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sahle</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gauges</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pahle</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Simus</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>COPASI—a COmplex PAthway SImulator</article-title>. <source>Bioinf</source>; <year>2006</year>;<volume>22</volume>:<fpage>3067</fpage>–<lpage>3074</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl485" xlink:type="simple">10.1093/bioinformatics/btl485</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Balsa-Canto</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Banga</surname> <given-names>JR</given-names></name>. <article-title>AMIGO, a toolbox for advanced model identification in systems biology using global optimization</article-title>. <source>Bioinf</source>; <year>2011</year>;<volume>27</volume>(<issue>16</issue>):<fpage>2311</fpage>–<lpage>2313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr370" xlink:type="simple">10.1093/bioinformatics/btr370</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raue</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Steiert</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Schelker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kreutz</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Maiwald</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hass</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Data2Dynamics: a modeling environment tailored to parameter estimation in dynamical systems</article-title>. <source>Bioinf</source>; <year>2015</year>;<volume>31</volume>(<issue>21</issue>):<fpage>3558</fpage>–<lpage>3560</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv405" xlink:type="simple">10.1093/bioinformatics/btv405</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>. <article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>. <source>Nucleic Acids Res</source>; <year>2000</year>;<volume>28</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/28.1.27" xlink:type="simple">10.1093/nar/28.1.27</ext-link></comment> <object-id pub-id-type="pmid">10592173</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Croft</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>O’Kelly</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Haw</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gillespie</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Matthews</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Reactome: a database of reactions, pathways and biological processes</article-title>. <source>Nucleic Acids Res</source>; <year>2011</year>;<volume>39</volume>(<issue>Database issue</issue>):<fpage>D691</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkq1018" xlink:type="simple">10.1093/nar/gkq1018</ext-link></comment> <object-id pub-id-type="pmid">21067998</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Franceschini</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Szklarczyk</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Frankild</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kuhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Simonovic</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Roth</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>STRING v9.1: protein-protein interaction networks, with increased coverage and integration</article-title>. <source>Nucleic Acids Res</source>; <year>2013</year>;<volume>41</volume>(<issue>Database issue</issue>):<fpage>D808</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks1094" xlink:type="simple">10.1093/nar/gks1094</ext-link></comment> <object-id pub-id-type="pmid">23203871</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Büchel</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Rodriguez</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Swainston</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wrzodek</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Czauderna</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Path2Models: large-scale generation of computational models from biochemical pathway maps</article-title>. <source>BMC Syst Biol</source>; <year>2013</year>;<volume>7</volume>(<issue>116</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thiele</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Swainston</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Fleming</surname> <given-names>RMT</given-names></name>, <name name-style="western"><surname>Hoppe</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sahoo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Aurich</surname> <given-names>MK</given-names></name>, <etal>et al</etal>. <article-title>A community-driven global reconstruction of human metabolism</article-title>. <source>Nat Biotechnol</source>; <year>2013</year>;<volume>31</volume>(<issue>5</issue>):<fpage>419</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2488" xlink:type="simple">10.1038/nbt.2488</ext-link></comment> <object-id pub-id-type="pmid">23455439</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ganter</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kaltenbach</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Stelling</surname> <given-names>J</given-names></name>. <article-title>Predicting network functions with nested patterns</article-title>. <source>Nat Commun</source>; <year>2014</year>;<volume>5</volume>:<fpage>3006</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms4006" xlink:type="simple">10.1038/ncomms4006</ext-link></comment> <object-id pub-id-type="pmid">24398547</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dräger</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zielinski</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rall</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Eichner</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Palsson</surname> <given-names>BO</given-names></name>, <etal>et al</etal>. <article-title>SBMLsqueezer 2: context-sensitive creation of kinetic equations in biochemical networks</article-title>. <source>BMC Syst Biol</source>; <year>2015</year>;<volume>9</volume>:<fpage>68</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s12918-015-0212-9" xlink:type="simple">10.1186/s12918-015-0212-9</ext-link></comment> <object-id pub-id-type="pmid">26452770</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stanford</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Lubitz</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Smallbone</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Klipp</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Mendes</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Liebermeister</surname> <given-names>W</given-names></name>. <article-title>Systematic construction of kinetic models from genome-scale metabolic networks</article-title>. <source>PLoS ONE</source>; <year>2013</year>;<volume>8</volume>(<issue>11</issue>):<fpage>e79195</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0079195" xlink:type="simple">10.1371/journal.pone.0079195</ext-link></comment> <object-id pub-id-type="pmid">24324546</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Villaverde</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Bongard</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mauch</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Müller</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Balsa-Canto</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Schmid</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>A consensus approach for estimating the predictive accuracy of dynamic models in biology</article-title>. <source>Computer Methods and Programs in Biomedicine</source>; <year>2015</year>;<volume>119</volume>(<issue>1</issue>):<fpage>17</fpage>–<lpage>28</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cmpb.2015.02.001" xlink:type="simple">10.1016/j.cmpb.2015.02.001</ext-link></comment> <object-id pub-id-type="pmid">25716416</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref017">
<label>17</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hadamard</surname> <given-names>J</given-names></name>. <source>Sur les problémes aux dérivées partielles et leur signification physique</source>. In: <publisher-name>Princeton University Bulletin</publisher-name>; <year>1902</year>. p. <fpage>49</fpage>–<lpage>52</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raue</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schilling</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bachmann</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Matteson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schelke</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kaschek</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Lessons learned from quantitative dynamical modeling in systems biology</article-title>. <source>PLoS ONE</source>; <year>2013</year>;<volume>8</volume>(<issue>9</issue>):<fpage>e74335</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0074335" xlink:type="simple">10.1371/journal.pone.0074335</ext-link></comment> <object-id pub-id-type="pmid">24098642</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref019">
<label>19</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Bäck</surname> <given-names>T</given-names></name>. <source>Evolutionary algorithms in theory and practice: evolution strategies, evolutionary programming, genetic algorithms</source>. <publisher-loc>New York and Oxford</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>; <year>1996</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref020">
<label>20</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>XS</given-names></name>. <source>Nature-inspired metaheuristic algorithms</source>. <edition>2nd ed</edition>. <publisher-loc>Bristol, UK</publisher-loc>: <publisher-name>Luniver Press</publisher-name>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kirkpatrick</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gelatt</surname> <given-names>CD</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>M P Vecchi</surname> <given-names>MP</given-names></name>. <article-title>Optimization by simulated annealing</article-title>. <source>Science</source>; <year>1983</year>;<volume>220</volume>(<issue>4598</issue>):<fpage>671</fpage>–<lpage>680</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.220.4598.671" xlink:type="simple">10.1126/science.220.4598.671</ext-link></comment> <object-id pub-id-type="pmid">17813860</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Balsa-Canto</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Peifer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Banga</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Timmer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fleck</surname> <given-names>C</given-names></name>. <article-title>Hybrid optimization method with general switching strategy for parameter estimation</article-title>. <source>BMC Syst Biol</source>; <year>2008</year>;<volume>2</volume>(<issue>26</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1752-0509-2-26" xlink:type="simple">10.1186/1752-0509-2-26</ext-link></comment> <object-id pub-id-type="pmid">18366722</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vaz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Vicente</surname> <given-names>L</given-names></name>. <article-title>A particle swarm pattern search method for bound constrained global optimization</article-title>. <source>J Global Optim</source>; <year>2007</year>;<volume>39</volume>(<issue>2</issue>):<fpage>197</fpage>–<lpage>219</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10898-007-9133-5" xlink:type="simple">10.1007/s10898-007-9133-5</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moles</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Mendes</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Banga</surname> <given-names>JR</given-names></name>. <article-title>Parameter estimation in biochemical pathways: A comparison of global optimization methods</article-title>. <source>Genome Res</source>; <year>2003</year>;<volume>13</volume>:<fpage>2467</fpage>–<lpage>2474</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.1262503" xlink:type="simple">10.1101/gr.1262503</ext-link></comment> <object-id pub-id-type="pmid">14559783</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Banga</surname> <given-names>JR</given-names></name>. <article-title>Optimization in computational systems biology</article-title>. <source>BMC Syst Biol</source>; <year>2008</year>;<volume>2</volume>(<issue>47</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref026">
<label>26</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Weise</surname> <given-names>T</given-names></name>. <chapter-title>Global Optimization Algorithms: Theory and Application</chapter-title>. <source>Nature Inspired Computation and Applications Laboratory (NICAL)</source>, <publisher-name>University of Science and Technology</publisher-name>, <publisher-loc>China</publisher-loc>; <year>2009</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Villaverde</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Henriques</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Smallbone</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Bongard</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schmid</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cicin-Sain</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>BioPreDyn-bench: a suite of benchmark problems for dynamic modelling in systems biology</article-title>. <source>BMC Syst Biol</source>; <year>2015</year>;<volume>9</volume>(<issue>8</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s12918-015-0144-4" xlink:type="simple">10.1186/s12918-015-0144-4</ext-link></comment> <object-id pub-id-type="pmid">25880925</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref028">
<label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Griewank</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Walther</surname> <given-names>A</given-names></name>. <source>Evaluating Derivatives</source>. <edition>2nd ed</edition>. <publisher-name>Society for Industrial and Applied Mathematics</publisher-name>; <year>2008</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref029">
<label>29</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Nocedal</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>S</given-names></name>. <source>Numerical optimization</source>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hindmarsh</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>PN</given-names></name>, <name name-style="western"><surname>Grant</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Serban</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Shumaker</surname> <given-names>DE</given-names></name>, <etal>et al</etal>. <article-title>SUNDIALS: Suite of Nonlinear and Differential/Algebraic Equation Solvers</article-title>. <source>ACM T Math Software</source>; <year>2005</year>;<volume>31</volume>(<issue>3</issue>):<fpage>363</fpage>–<lpage>396</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1145/1089014.1089020" xlink:type="simple">10.1145/1089014.1089020</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref031">
<label>31</label>
<mixed-citation publication-type="other" xlink:type="simple">Lu J, Muller S, Machné R, Flamm C. SBML ODE Solver library: Extensions for inverse analysis. In: Proceedings of the Fifth International Workshop on Computational Systems Biology, WCSB; 2008.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fujarewicz</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kimmel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Swierniak</surname> <given-names>A</given-names></name>. <article-title>On fitting of mathematical models of cell signaling pathways using adjoint systems</article-title>. <source>MBE</source>; <year>2005</year>;<volume>2</volume>(<issue>3</issue>):<fpage>527</fpage>–<lpage>534</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3934/mbe.2005.2.527" xlink:type="simple">10.3934/mbe.2005.2.527</ext-link></comment> <object-id pub-id-type="pmid">20369938</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>August</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Koeppl</surname> <given-names>H</given-names></name>. <article-title>Inverse problems from biomedicine: Inference of putative disease mechanisms and robust therapeutic strategies</article-title>. <source>J Math Biol</source>; <year>2012</year>;<volume>67</volume>(<issue>1</issue>):<fpage>143</fpage>–<lpage>168</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00285-012-0523-z" xlink:type="simple">10.1007/s00285-012-0523-z</ext-link></comment> <object-id pub-id-type="pmid">22526835</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hanke</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Scherzer</surname> <given-names>O</given-names></name>. <article-title>Inverse problems light: Numerical differentiation</article-title>. <source>The American Mathematical Monthly</source>; <year>2001</year>;<volume>108</volume>(<issue>6</issue>):<fpage>512</fpage>–<lpage>521</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/2695705" xlink:type="simple">10.2307/2695705</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Plessix</surname> <given-names>RE</given-names></name>. <article-title>A review of the adjoint-state method for computing the gradient of a functional with geophysical applications</article-title>. <source>Geophys J Int</source>; <year>2006</year>;<volume>167</volume>(<issue>2</issue>):<fpage>495</fpage>–<lpage>503</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1365-246X.2006.02978.x" xlink:type="simple">10.1111/j.1365-246X.2006.02978.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leonhardt</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Schwake</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Stögbauer</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Rappl</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kuhr</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Ligon</surname> <given-names>TS</given-names></name>, <etal>et al</etal>. <article-title>Single-cell mRNA transfection studies: Delivery, kinetics and statistics by numbers</article-title>. <source>Nanomedicine: Nanotechnology, Biology, and Medicine</source>; <year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>679</fpage>–<lpage>688</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Donizelli</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rodriguez</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Dharuri</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Endler</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Chelliah</surname> <given-names>V</given-names></name>, <etal>et al</etal>. <article-title>BioModels Database: An enhanced, curated and annotated resource for published quantitative kinetic models</article-title>. <source>BMC Syst Biol</source>; <year>2010</year>;<volume>4</volume>:<fpage>92</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1752-0509-4-92" xlink:type="simple">10.1186/1752-0509-4-92</ext-link></comment> <object-id pub-id-type="pmid">20587024</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Shanley</surname> <given-names>DP</given-names></name>. <article-title>Computational modelling of the regulation of Insulin signalling by oxidative stress</article-title>. <source>BMC Syst Biol</source>; <year>2013</year>;<volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1752-0509-7-41" xlink:type="simple">10.1186/1752-0509-7-41</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kühn</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wierling</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kühn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Klipp</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Panopoulou</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Lehrach</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Monte carlo analysis of an ode model of the sea urchin endomesoderm network</article-title>. <source>BMC Syst Biol</source>; <year>2009</year>;<volume>3</volume>(<issue>1</issue>):<fpage>1</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chen</surname> <given-names>WW</given-names></name>, <name name-style="western"><surname>Schoeberl</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Jasper</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Niepel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>UB</given-names></name>, <name name-style="western"><surname>Lauffenburger</surname> <given-names>DA</given-names></name>, <etal>et al</etal>. <article-title>Input–output behavior of ErbB signaling pathways as revealed by a mass action model trained against dynamic data</article-title>. <source>Mol Syst Biol</source>; <year>2009</year>;<volume>5</volume>(<issue>239</issue>).</mixed-citation></ref>
<ref id="pcbi.1005331.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chassagnole</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Noisommit-Rizzi</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Schmid</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Mauch</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Reuss</surname> <given-names>M</given-names></name>. <article-title>Dynamic modeling of the central carbon metabolism of Escherichia coli</article-title>. <source>Biotechnol Bioeng</source>; <year>2002</year>;<volume>79</volume>(<issue>1</issue>):<fpage>53</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/bit.10288" xlink:type="simple">10.1002/bit.10288</ext-link></comment> <object-id pub-id-type="pmid">17590932</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kotte</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Zaugg</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Heinemann</surname> <given-names>M</given-names></name>. <article-title>Bacterial adaptation through distributed sensing of metabolic fluxes</article-title>. <source>Mol Syst Biol</source>; <year>2010</year>;<volume>6</volume>(<issue>1</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2010.10" xlink:type="simple">10.1038/msb.2010.10</ext-link></comment> <object-id pub-id-type="pmid">20212527</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref043">
<label>43</label>
<mixed-citation publication-type="other" xlink:type="simple">Villaverde AF, Bongard S, Mauch K, Müller D, Balsa-Canto E, Schmid J, et al. High-Confidence Predictions in Systems Biology Dynamic Models. In: 8th International Conference on Practical Applications of Computational Biology &amp; Bioinformatics (PACBB 2014). Cham: Springer International Publishing; 2014. p. 161–171.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>MacNamara</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Terfve</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Henriques</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bernabé</surname> <given-names>BP</given-names></name>, <name name-style="western"><surname>Saez-Rodriguez</surname> <given-names>J</given-names></name>. <article-title>State–time spectrum of signal transduction logic models</article-title>. <source>Phys Biol</source>; <year>2012</year>;<volume>9</volume>(<issue>4</issue>):<fpage>045003</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1478-3975/9/4/045003" xlink:type="simple">10.1088/1478-3975/9/4/045003</ext-link></comment> <object-id pub-id-type="pmid">22871648</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smallbone</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Mendes</surname> <given-names>P</given-names></name>. <article-title>Large-scale metabolic models: From reconstruction to differential equations</article-title>. <source>Ind Biotechnol</source>; <year>2013</year>;<volume>9</volume>(<issue>4</issue>):<fpage>179</fpage>–<lpage>184</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/ind.2013.0003" xlink:type="simple">10.1089/ind.2013.0003</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Longford</surname> <given-names>NT</given-names></name>. <article-title>A fast scoring algorithm for maximum likelihood estimation in unbalanced mixed models with nested random effects</article-title>. <source>Biometrika</source>; <year>1987</year>;<volume>74</volume>(<issue>4</issue>):<fpage>817</fpage>–<lpage>827</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/74.4.817" xlink:type="simple">10.1093/biomet/74.4.817</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fletcher</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Powell</surname> <given-names>MJ</given-names></name>. <article-title>A rapidly convergent descent method for minimization</article-title>. <source>Comp J</source>; <year>1963</year>;<volume>6</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>168</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/comjnl/6.2.163" xlink:type="simple">10.1093/comjnl/6.2.163</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Goldfarb</surname> <given-names>D</given-names></name>. <article-title>A Family of Variable-Metric Methods Derived by Variational Means</article-title>. <source>Math Comp</source>; <year>1970</year>;<volume>24</volume>(<issue>109</issue>):<fpage>23</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1090/S0025-5718-1970-0258249-6" xlink:type="simple">10.1090/S0025-5718-1970-0258249-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Guay</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>McLean</surname> <given-names>DD</given-names></name>. <article-title>Optimization and sensitivity analysis for multiresponse parameter estimation in systems of ordinary differential equations</article-title>. <source>Comp and Chem Eng</source>; <year>1995</year>;<volume>19</volume>(<issue>12</issue>):<fpage>1271</fpage>–<lpage>1285</lpage>. An International Journal of Computer Application in Chemical Engineering. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0098-1354(94)00120-0" xlink:type="simple">10.1016/0098-1354(94)00120-0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Özyurt</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Barton</surname> <given-names>PI</given-names></name>. <article-title>Cheap Second Order Directional Derivatives of Stiff ODE Embedded Functionals</article-title>. <source>SIAM Journal on Scientific Computing</source>; <year>2005</year>;<volume>26</volume>(<issue>5</issue>):<fpage>1725</fpage>–<lpage>1743</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/030601582" xlink:type="simple">10.1137/030601582</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Martins</surname> <given-names>JRRA</given-names></name>, <name name-style="western"><surname>Sturdza</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Alonso</surname> <given-names>JJ</given-names></name>. <article-title>The complex-step derivative approximation</article-title>. <source>ACM Trans Math Softw</source>; <year>2003</year>;<volume>29</volume>:<fpage>245</fpage>–<lpage>262</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1145/838250.838251" xlink:type="simple">10.1145/838250.838251</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chang</surname> <given-names>YF</given-names></name>, <name name-style="western"><surname>Corliss</surname> <given-names>GF</given-names></name>. <article-title>ATOMFT: Solving ODEs and DAEs using Taylor series</article-title>. <source>Comp Math App</source>; <year>1994</year>;<volume>28</volume>(<issue>10–12</issue>):<fpage>209</fpage>–<lpage>233</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0898-1221(94)00193-6" xlink:type="simple">10.1016/0898-1221(94)00193-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Linnainmaa</surname> <given-names>S</given-names></name>. <article-title>Taylor expansion of the accumulated rounding error</article-title>. <source>BIT</source>; <year>1976</year>;<volume>16</volume>(<issue>2</issue>):<fpage>146</fpage>–<lpage>160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF01931367" xlink:type="simple">10.1007/BF01931367</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Egea</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Henriques</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Cokelaer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Villaverde</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>MacNamara</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Danciu</surname> <given-names>DP</given-names></name>, <etal>et al</etal>. <article-title>MEIGO: an open-source software suite based on metaheuristics for global optimization in systems biology and bioinformatics</article-title>. <source>BMC Bioinf</source>; <year>2014</year>;<volume>15</volume>(<issue>136</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schmidt</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Jirstrand</surname> <given-names>M</given-names></name>. <article-title>Systems biology toolbox for MATLAB: a computational platform for research in systems biology</article-title>. <source>Bioinf</source>; <year>2006</year>;<volume>22</volume>(<issue>4</issue>):<fpage>514</fpage>–<lpage>515</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti799" xlink:type="simple">10.1093/bioinformatics/bti799</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gonnet</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dimopoulos</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Widmer</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Stelling</surname> <given-names>J</given-names></name>. <article-title>A specialized ODE integrator for the efficient computation of parameter sensitivities</article-title>. <source>BMC Syst Biol</source>; <year>2012</year>;<volume>6</volume>(<issue>46</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1752-0509-6-46" xlink:type="simple">10.1186/1752-0509-6-46</ext-link></comment> <object-id pub-id-type="pmid">22607742</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gábor</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Banga</surname> <given-names>JR</given-names></name>. <article-title>Robust and efficient parameter estimation in dynamic models of biological systems</article-title>. <source>BMC Syst Biol</source>; <year>2015</year>;<volume>9</volume>:<fpage>74</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s12918-015-0219-2" xlink:type="simple">10.1186/s12918-015-0219-2</ext-link></comment> <object-id pub-id-type="pmid">26515482</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wittig</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Kania</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Golebiewski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rey</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Jong</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>SABIO-RK—database for biochemical reaction kinetics</article-title>. <source>Nucl Acids Res</source>; <year>2012</year>;<volume>40</volume>(<issue>D1</issue>):<fpage>D790</fpage>–<lpage>D796</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1046" xlink:type="simple">10.1093/nar/gkr1046</ext-link></comment> <object-id pub-id-type="pmid">22102587</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chang</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Scheer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Grote</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schomburg</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Schomburg</surname> <given-names>D</given-names></name>. <article-title>BRENDA, AMENDA and FRENDA the enzyme information system: new content and tools in 2009</article-title>. <source>Nucleic Acids Res</source>; <year>2009</year>;<volume>37</volume>(<issue>Database issue</issue>):<fpage>D588</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkn820" xlink:type="simple">10.1093/nar/gkn820</ext-link></comment> <object-id pub-id-type="pmid">18984617</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref060">
<label>60</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Neal</surname> <given-names>RM</given-names></name>. <chapter-title>MCMC using Hamiltonian dynamics</chapter-title>. In: <name name-style="western"><surname>Brooks</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Meng</surname> <given-names>XL</given-names></name>, editors. <source>Handbook of Markov Chain Monte Carlo</source>. <publisher-loc>London, United Kingdom</publisher-loc>: <publisher-name>Chapman &amp; Hall / CRC Press</publisher-name>; <year>2011</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Girolami</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Calderhead</surname> <given-names>B</given-names></name>. <article-title>Riemann manifold Langevin and Hamiltonian Monte Carlo methods</article-title>. <source>J R Statist Soc B</source>; <year>2011</year>;<volume>73</volume>(<issue>2</issue>):<fpage>123</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-9868.2010.00765.x" xlink:type="simple">10.1111/j.1467-9868.2010.00765.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref062">
<label>62</label>
<mixed-citation publication-type="other" xlink:type="simple">Lan S, Bui-Thanh T, Christie M, Girolami M. Emulation of higher-order tensors in manifold Monte Carlo methods for Bayesian inverse problems. <monospace>arXiv</monospace>; 2015. <monospace>arXiv:1507.06244v2</monospace> [stat.CO].</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref063">
<label>63</label>
<mixed-citation publication-type="other" xlink:type="simple">Fröhlich F, Hross S, Theis FJ, Hasenauer J. Radial basis function approximation of Bayesian parameter posterior densities for uncertainty analysis. In: Mendes P, Dada JO, Smallbone KO, editors. Proceedings of the 12th International Conference on Computational Methods in Systems Biology (CMSB 2014), Manchester, UK. Lecture Notes in Bioinformatics. Springer International Publishing Switzerland; 2014. p. 73–85.</mixed-citation>
</ref>
<ref id="pcbi.1005331.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Xu</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Vyshemirsky</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Gormand</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>von Kriegsheim</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Girolami</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Baillie</surname> <given-names>GS</given-names></name>, <etal>et al</etal>. <article-title>Inferring signaling pathway topologies from multiple perturbation measurements of specific biochemical species</article-title>. <source>Sci Signal</source>; <year>2010</year>;<volume>3</volume>(<issue>113</issue>):<fpage>ra20</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/scisignal.2000517" xlink:type="simple">10.1126/scisignal.2000517</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hug</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Raue</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hasenauer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bachmann</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Klingmüller</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Timmer</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>High-dimensional Bayesian parameter estimation: Case study for a model of JAK2/STAT5 signaling</article-title>. <source>Math Biosci</source>; <year>2013</year>;<volume>246</volume>(<issue>2</issue>):<fpage>293</fpage>–<lpage>304</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.mbs.2013.04.002" xlink:type="simple">10.1016/j.mbs.2013.04.002</ext-link></comment> <object-id pub-id-type="pmid">23602931</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hasenauer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jagiella</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hross</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Theis</surname> <given-names>FJ</given-names></name>. <article-title>Data-driven modelling of biological multi-scale processes</article-title>. <source>Journal of Coupled Systems and Multiscale Dynamics</source>; <year>2015</year>;<volume>3</volume>(<issue>2</issue>):<fpage>101</fpage>–<lpage>121</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1166/jcsmd.2015.1069" xlink:type="simple">10.1166/jcsmd.2015.1069</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005331.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berger</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Peng</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>M</given-names></name>. <article-title>Computational solutions for omics data</article-title>. <source>Nat Rev Genet</source>; <year>2013</year>;<volume>14</volume>(<issue>5</issue>):<fpage>333</fpage>–<lpage>346</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg3433" xlink:type="simple">10.1038/nrg3433</ext-link></comment> <object-id pub-id-type="pmid">23594911</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>