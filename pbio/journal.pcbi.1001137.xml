<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
    <front>
        <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
                <publisher-name>Public Library of Science</publisher-name>
                <publisher-loc>San Francisco, USA</publisher-loc>
            </publisher></journal-meta>
        <article-meta><article-id pub-id-type="publisher-id">10-PLCB-RA-2867R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1001137</article-id><article-categories>
                <subj-group subj-group-type="heading">
                    <subject>Research Article</subject>
                </subj-group>
                <subj-group subj-group-type="Discipline">
                    <subject>Computational Biology/Evolutionary Modeling</subject>
                    <subject>Computational Biology/Metabolic Networks</subject>
                    <subject>Computational Biology/Systems Biology</subject>
                    <subject>Computational Biology/Transcriptional Regulation</subject>
                    <subject>Evolutionary Biology/Bioinformatics</subject>
                    <subject>Evolutionary Biology/Evolutionary and Comparative Genetics</subject>
                    <subject>Evolutionary Biology/Microbial Evolution and Genomics</subject>
                    <subject>Genetics and Genomics/Comparative Genomics</subject>
                    <subject>Genetics and Genomics/Gene Function</subject>
                    <subject>Genetics and Genomics/Microbial Evolution and Genomics</subject>
                    <subject>Microbiology/Microbial Evolution and Genomics</subject>
                    <subject>Physics/Interdisciplinary Physics</subject>
                </subj-group>
            </article-categories><title-group><article-title>A Toolbox Model of Evolution of Metabolic Pathways on Networks of
                    Arbitrary Topology</article-title><alt-title alt-title-type="running-head">Toolbox Model on Networks of Arbitrary
                    Topology</alt-title></title-group><contrib-group>
                <contrib contrib-type="author" xlink:type="simple">
                    <name name-style="western">
                        <surname>Pang</surname>
                        <given-names>Tin Yau</given-names>
                    </name>
                    <xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
                    <xref ref-type="aff" rid="aff2"><sup>2</sup></xref>
                </contrib>
                <contrib contrib-type="author" xlink:type="simple">
                    <name name-style="western">
                        <surname>Maslov</surname>
                        <given-names>Sergei</given-names>
                    </name>
                    <xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
                    <xref ref-type="corresp" rid="cor1"><sup>*</sup></xref>
                </contrib>
            </contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Condensed Matter Physics and
                    Materials Science, Brookhaven National Laboratory, Upton, New York, United
                    States of America</addr-line>
            </aff><aff id="aff2"><label>2</label><addr-line>Department of Physics and Astronomy, Stony
                    Brook University, Stony Brook, New York, United States of America</addr-line>
            </aff><contrib-group>
                <contrib contrib-type="editor" xlink:type="simple">
                    <name name-style="western">
                        <surname>Shakhnovich</surname>
                        <given-names>Eugene I.</given-names>
                    </name>
                    <role>Editor</role>
                    <xref ref-type="aff" rid="edit1"/>
                </contrib>
            </contrib-group><aff id="edit1">Harvard University, United States of America</aff><author-notes>
                <corresp id="cor1">* E-mail: <email xlink:type="simple">maslov@bnl.gov</email></corresp>
                <fn fn-type="con">
                    <p>Conceived and designed the experiments: SM. Performed the experiments: TYP.
                        Analyzed the data: TYP SM. Wrote the paper: TYP SM. Derived mathematical
                        solutions: SM.</p>
                </fn>
            <fn fn-type="conflict">
                <p>The authors have declared that no competing interests exist.</p>
            </fn></author-notes><pub-date pub-type="collection">
                <month>5</month>
                <year>2011</year>
            </pub-date><pub-date pub-type="epub">
                <day>19</day>
                <month>5</month>
                <year>2011</year>
            </pub-date><volume>7</volume><issue>5</issue><elocation-id>e1001137</elocation-id><history>
                <date date-type="received">
                    <day>20</day>
                    <month>9</month>
                    <year>2010</year>
                </date>
                <date date-type="accepted">
                    <day>14</day>
                    <month>4</month>
                    <year>2011</year>
                </date>
            </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Pang, Maslov</copyright-holder><license><license-p>This is an open-access article distributed under the
                terms of the Creative Commons Attribution License, which permits unrestricted use,
                distribution, and reproduction in any medium, provided the original author and
                source are credited.</license-p></license></permissions><abstract>
                <p>In prokaryotic genomes the number of transcriptional regulators is known to be
                    proportional to the square of the total number of protein-coding genes. A
                    toolbox model of evolution was recently proposed to explain this empirical
                    scaling for metabolic enzymes and their regulators. According to its rules, the
                    metabolic network of an organism evolves by horizontal transfer of pathways from
                    other species. These pathways are part of a larger “universal”
                    network formed by the union of all species-specific networks. It remained to be
                    understood, however, how the topological properties of this universal network
                    influence the scaling law of functional content of genomes in the toolbox model.
                    Here we answer this question by first analyzing the scaling properties of the
                    toolbox model on arbitrary tree-like universal networks. We prove that critical
                    branching topology, in which the average number of upstream neighbors of a node
                    is equal to one, is both necessary and sufficient for quadratic scaling. We
                    further generalize the rules of the model to incorporate reactions with multiple
                    substrates/products as well as branched and cyclic metabolic pathways. To
                    achieve its metabolic tasks, the new model employs evolutionary optimized
                    pathways with minimal number of reactions. Numerical simulations of this
                    realistic model on the universal network of all reactions in the KEGG database
                    produced approximately quadratic scaling between the number of regulated
                    pathways and the size of the metabolic network. To quantify the geometrical
                    structure of individual pathways, we investigated the relationship between their
                    number of reactions, byproducts, intermediate, and feedback metabolites. Our
                    results validate and explain the ubiquitous appearance of the quadratic scaling
                    for a broad spectrum of topologies of underlying universal metabolic networks.
                    They also demonstrate why, in spite of “small-world” topology,
                    real-life metabolic networks are characterized by a broad distribution of
                    pathway lengths and sizes of metabolic regulons in regulatory networks.</p>
            </abstract><abstract abstract-type="summary">
                <title>Author Summary</title>
                <p>It has been previously reported that in prokaryotic genomes the number of
                    transcriptional regulators is proportional to the square of the total number of
                    genes. We recently offered a general explanation of this empirical powerlaw
                    scaling in terms of the “toolbox” model in which metabolic and
                    regulatory networks co-evolve together. This evolution is driven by horizontal
                    gene transfer of co-regulated metabolic pathways from other species. These
                    pathways are part of a larger “universal” network formed by the
                    union of all species-specific networks. In the present work we address the
                    question of how topological properties of this universal network influence the
                    powerlaw scaling of regulators in the toolbox model. We also generalize its
                    rules to include reactions with multiple substrates and products, branched and
                    cyclic metabolic pathways, and to account for optimality of metabolic pathways.
                    The main conclusion of our analytical and numerical modeling efforts is that the
                    quadratic scaling is the robust feature of the toolbox model in a broad range of
                    universal network topologies. They also demonstrate why, in spite of
                    “small-world” topology, real-life metabolic networks are
                    characterized by a broad distribution of pathway lengths and sizes of regulons
                    in regulatory networks.</p>
            </abstract><funding-group><funding-statement>Work at Brookhaven National Laboratory was carried out under Contract No.
                    DE-AC02-98CH10886, Division of Material Science, US Department of Energy. Part
                    of this study was supported by the program “Computational Biology and
                    Bioinformatic Methods to Enable a Systems Biology Knowledgebase” (
                    DE-FOA-0000143) of the Office of Biological and Environmental Research, US
                    Department of Energy. The funders had no role in study design, data collection
                    and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
                <page-count count="11"/>
            </counts></article-meta>
    </front>
    <body>
        <sec id="s1">
            <title>Introduction</title>
            <p>In prokaryotic genomes the number of transcriptional regulators is known to
                quadratically scale with the total number of protein-coding genes <xref ref-type="bibr" rid="pcbi.1001137-vanNimwegen1">[1]</xref>. The
                toolbox model of co-evolution of metabolic and regulatory networks was recently
                proposed <xref ref-type="bibr" rid="pcbi.1001137-Maslov1">[2]</xref> to
                explain this scaling in parts of the genome responsible for metabolic functions. In
                this model prokaryotes acquire new metabolic capabilities by horizontal transfer of
                entire metabolic pathways from other organisms. One can conveniently think of these
                new pathways as coming from some “universal network” formed by the union
                of metabolic repertoires of all potential donor organisms. The essence of the
                toolbox argument <xref ref-type="bibr" rid="pcbi.1001137-Maslov1">[2]</xref> can be summarized as follows: as the non-regulatory part
                of the genome of an organism (its “toolbox”) grows, it typically needs
                to acquire fewer and fewer extra new genes (“tools”) in a pathway
                offering it some new metabolic capability (e.g. the ability to utilize a new
                nutrient or synthesize a new metabolic product). As a consequence, the number of
                pathways and by extension the number of their transcriptional regulators grows
                faster than linearly with the number of non-regulatory genes in the genome. While
                this qualitative explanation is rather general and therefore does not depend on
                specific details such as topology of the universal network, the exact value of the
                exponent α connecting the number of transcription factors (equal to
                        <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e001" xlink:type="simple"/></inline-formula>- the number of pathways or leaves of the network) to the
                number of metabolites in the metabolic network of an organism
                        <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e002" xlink:type="simple"/></inline-formula>, as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e003" xlink:type="simple"/></inline-formula>, is in general
                model-dependent. In <xref ref-type="bibr" rid="pcbi.1001137-Maslov1">[2]</xref> we mathematically derived the quadratic scaling
                        (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e004" xlink:type="simple"/></inline-formula>) for the toolbox model with linear pathways on a fully
                connected graph in which any pair of metabolites can in principle be converted to
                each other in just one step via a single metabolic reaction. While this situation is
                obviously unrealistic from biological standpoint, before present study it remained
                the only mathematically treatable variant of the toolbox model. The universality of
                the exponent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e005" xlink:type="simple"/></inline-formula> was then corroborated <xref ref-type="bibr" rid="pcbi.1001137-Maslov1">[2]</xref> by numerical simulations of the
                toolbox model with linearized pathways on the universal network formed by the union
                of all metabolic reactions in the KEGG database. While the agreement between the
                values of the exponent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e006" xlink:type="simple"/></inline-formula> in these two cases
                hinted at underlying general principles at work, the detailed understanding of these
                principles remained elusive.</p>
            <p>The question we address in this study is how the topology of the universal network
                determines this scaling exponent. To answer this question we first consider and
                solve a more realistic (yet still mathematically treatable) case in which the
                universal metabolic network is a directed tree of arbitrary topology. While being
                closer to reality than previously solved <xref ref-type="bibr" rid="pcbi.1001137-Maslov1">[2]</xref> case of fully connected network,
                the toolbox model on a tree-like universal network still retains a number of
                simplifications such as strictly linear pathways and one substrate → one
                product reactions.</p>
            <p>To make our approach even more realistic we propose and numerically study a
                completely new version of the toolbox model incorporating metabolic reactions with
                multiple substrates and products as well as branched and cyclic metabolic pathways.
                Furthermore, unlike random linear pathways on a universal network <xref ref-type="bibr" rid="pcbi.1001137-Maslov1">[2]</xref> that can be long
                and therefore suboptimal from an evolutionary standpoint, the new model uses
                evolutionarily optimized pathways with the smallest number of reactions from the
                KEGG database sufficient to achieve a given metabolic task.</p>
        </sec>
        <sec id="s2">
            <title>Results</title>
            <sec id="s2a">
                <title>The toolbox model on a tree-like universal network: General mathematical
                    description</title>
                <p>We will first consider the case where the universal metabolic network is a
                    directed tree. For simplicity in this section we will consider the case of
                    catabolic pathways, while identical arguments (albeit with opposite direction of
                    all reactions) apply to anabolic pathways. The root of the tree corresponds to
                    the central metabolic core of the organism responsible for biomass production.
                    Peripheral catabolic pathways (branches of the tree) convert external nutrients
                    (leaves) to this core, while the internal nodes of the tree represent
                    intermediate metabolites. Each of metabolites is characterized by its distance
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e007" xlink:type="simple"/></inline-formula> from the root of the network. The universal network has
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e008" xlink:type="simple"/></inline-formula> metabolites at distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e009" xlink:type="simple"/></inline-formula> from the root that
                    included <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e010" xlink:type="simple"/></inline-formula> leaves (nutrients used in the first step of catabolic
                    pathways) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e011" xlink:type="simple"/></inline-formula> branching points corresponding to intermediate
                    metabolites generated by more than one metabolic reaction at the next level (see
                        <xref ref-type="fig" rid="pcbi-1001137-g001">Figure 1</xref>). An
                    organism-specific network (filled circles and thick edges in <xref ref-type="fig" rid="pcbi-1001137-g001">Figure 1</xref>) at distance
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e012" xlink:type="simple"/></inline-formula> from the root contains <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e013" xlink:type="simple"/></inline-formula> metabolites
                    composed of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e014" xlink:type="simple"/></inline-formula> leaves, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e015" xlink:type="simple"/></inline-formula> branching points,
                    and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e016" xlink:type="simple"/></inline-formula> metabolites inside linear branches (“one reaction
                    in-one reaction out”) . For simplicity we assume that in the universal
                    network (and thus also in any of its organism-specific subnetworks) no more than
                    two reaction edges can combine at any node (metabolite), while the most general
                    case of an arbitrary distribution of branching numbers can be treated in a very
                    similar fashion.</p>
                <fig id="pcbi-1001137-g001" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pcbi.1001137.g001</object-id>
                    <label>Figure 1</label>
                    <caption>
                        <title>An example of organism-specific metabolic network and the
                            corresponding universal network.</title>
                        <p>The organism-specific metabolic network (filled circles and thick edges)
                            is always a subset of the universal network (the entire tree). Nodes are
                            divided into layers based on their distance
                                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e017" xlink:type="simple"/></inline-formula> from the
                            root of the tree. Variables <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e018" xlink:type="simple"/></inline-formula>,
                                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e019" xlink:type="simple"/></inline-formula>,
                                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e020" xlink:type="simple"/></inline-formula> for the
                            universal network and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e021" xlink:type="simple"/></inline-formula>,
                                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e022" xlink:type="simple"/></inline-formula>,
                                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e023" xlink:type="simple"/></inline-formula> for
                            species-specific network are illustrated using the layer
                                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e024" xlink:type="simple"/></inline-formula> as an
                            example.</p>
                    </caption>
                    <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.g001" xlink:type="simple"/>
                </fig>
                <p>The toolbox model specifies rules by which organism acquires new pathways in the
                    course of its evolution. It consists of the following steps: 1) randomly pick a
                    new nutrient metabolite (a leaf node of the universal network that currently
                    does not belong to the metabolic network of the organism) 2) use the universal
                    network to identify the unique linear pathway which connects the new nutrient to
                    the root of the tree (the metabolic core) and finally 3) add the reactions and
                    intermediate metabolites in the new pathway to the metabolic network of the
                    organism (filled circles and thick edges in <xref ref-type="fig" rid="pcbi-1001137-g001">Figure 1</xref>). One needs to only add those
                    enzymes that are not yet present in the “genome” of the organism.
                    Graphically it means that the new branch of the universal network is extended
                    until it first intersects the existing metabolic network of the organism.</p>
                <p>Consider an organism capable of utilizing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e025" xlink:type="simple"/></inline-formula> nutrients
                    represented by leaves in the universal network, where
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e026" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e027" xlink:type="simple"/></inline-formula>. Since we assume
                    that each nutrient utilization pathway is controlled by a dedicated
                    transcriptional regulator sensing its presence or absence in the environment
                    (e.g. LacR for lactose), the corresponding regulatory network would also have
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e028" xlink:type="simple"/></inline-formula> transcription factors (in the model we ignore
                    transcription factors controlling non-metabolic functions). The non-regulatory
                    part of the genome consists of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e029" xlink:type="simple"/></inline-formula> enzymes catalyzing
                    metabolic reactions (strictly speaking <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e030" xlink:type="simple"/></inline-formula> is the number of
                    metabolites/nodes so that the number of enzymes/edges is
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e031" xlink:type="simple"/></inline-formula>). Quadratic scaling plots <xref ref-type="bibr" rid="pcbi.1001137-vanNimwegen1">[1]</xref> shows the number of
                    transcriptional regulators <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e032" xlink:type="simple"/></inline-formula> vs. the total
                    number of genes in the genome (both regulatory and non-regulatory)
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e033" xlink:type="simple"/></inline-formula>. However, since in all organism-specific networks
                            <italic>N<sub>M</sub></italic> ≫ <italic>N<sub>L</sub></italic>, the
                    quadratic scaling between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e034" xlink:type="simple"/></inline-formula> and
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e035" xlink:type="simple"/></inline-formula> is equivalent to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e036" xlink:type="simple"/></inline-formula>.</p>
                <p>We further assume that due to random selection <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e037" xlink:type="simple"/></inline-formula> nutrients are
                    expected to be uniformly distributed among all <italic>d</italic> levels.
                    Therefore, the expected number of leaves at a given level is given by
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e038" xlink:type="simple"/></inline-formula> where the fraction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e039" xlink:type="simple"/></inline-formula> is the same at all
                    levels. On the other hand the fraction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e040" xlink:type="simple"/></inline-formula> varies from level
                    to level. It usually tends to increase as one gets closer towards the root of
                    the tree reaching 1 for <italic>d = 0</italic> (the root
                    node itself). To derive the equation for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e041" xlink:type="simple"/></inline-formula>, one first notices
                    that each of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e042" xlink:type="simple"/></inline-formula> metabolites at level <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e043" xlink:type="simple"/></inline-formula> is converted to
                    another intermediate metabolite at level <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e044" xlink:type="simple"/></inline-formula>. Due to merging of
                    pathways at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e045" xlink:type="simple"/></inline-formula> branching points the number of unique intermediate
                    metabolites at the level <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e046" xlink:type="simple"/></inline-formula> is actually
                    smaller: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e047" xlink:type="simple"/></inline-formula>. To calculate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e048" xlink:type="simple"/></inline-formula> one uses the fact
                    that each of the two nodes downstream of a branching point in the universal
                    network is present in the organism-specific network with probability
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e049" xlink:type="simple"/></inline-formula>. The probability that they are both present is
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e050" xlink:type="simple"/></inline-formula> and thus the number of branching points at level
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e051" xlink:type="simple"/></inline-formula> of the organism-specific metabolic network is
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e052" xlink:type="simple"/></inline-formula>. The intermediate metabolites together with new
                    nutrients <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e053" xlink:type="simple"/></inline-formula> entering at the level <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e054" xlink:type="simple"/></inline-formula> add up to the
                    total number of metabolites at level <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e055" xlink:type="simple"/></inline-formula>:
                            <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e056" xlink:type="simple"/><label>(1)</label></disp-formula></p>
                <p>This equation allows one to iteratively calculate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e057" xlink:type="simple"/></inline-formula> for all
                        <italic>d</italic> starting from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e058" xlink:type="simple"/></inline-formula>. We will use this
                    equation to derive the relationship between the number of leaves and the total
                    number of nodes first for a critical branching tree and then for a supercritical
                    one.</p>
            </sec>
            <sec id="s2b">
                <title>The toolbox model on a critical tree</title>
                <p>The Galton-Watson branching process <xref ref-type="bibr" rid="pcbi.1001137-Athreya1">[3]</xref> is a simple stochastic
                    process generating random trees, and we will consider its version where a node
                    can have two, one, or zero neighbors (parents) at the previous level with
                    probabilities <italic>p</italic><sub>2</sub>, <italic>p</italic><sub>1</sub> and
                        <italic>p</italic><sub>0</sub> correspondingly. If the average number of
                    parents <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e059" xlink:type="simple"/></inline-formula> equals one, then the process is referred to as critical,
                    and if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e060" xlink:type="simple"/></inline-formula> is greater than one then the process is supercritical.
                    More generally critical and supercritical branching trees can be generated by a
                    variety of random processes such as e.g. directed percolation <xref ref-type="bibr" rid="pcbi.1001137-Broadbent1">[4]</xref>. While
                    for simplicity we used the Galton-Watson branching process in our derivation
                    below, it can be readily extended to this more general case.</p>
                <p>The principal geometric difference between supercritical and critical trees is
                    that in the former case the number of nodes in a layer
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e061" xlink:type="simple"/></inline-formula> exponentially grows with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e062" xlink:type="simple"/></inline-formula>
                    <xref ref-type="bibr" rid="pcbi.1001137-Athreya1">[3]</xref>, while in
                    a critical tree it grows at most algebraically (for the Galton-Watson critical
                    process <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e063" xlink:type="simple"/></inline-formula>
                    <xref ref-type="bibr" rid="pcbi.1001137-Athreya1">[3]</xref>). The
                    other difference is that while the critical branching process always stops on
                    its own at a certain finite height <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e064" xlink:type="simple"/></inline-formula>, a supercritical
                    process will go on forever so that to generate a tree one has to manually
                    terminate it at a predefined layer <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e065" xlink:type="simple"/></inline-formula>. The most
                    significant feature of a critical tree is that it has much longer branches than
                    a supercritical one of the same size. Indeed, the diameter (the maximal height)
                    of a random critical tree with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e066" xlink:type="simple"/></inline-formula> nodes is
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e067" xlink:type="simple"/></inline-formula> while in a supercritical tree it is much shorter:
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e068" xlink:type="simple"/></inline-formula>. Thus supercritical trees (unlike their critical
                    counterparts) have the small world property.</p>
                <p>A random critical network where each node has at most has two parents in the
                    previous layer is defined by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e069" xlink:type="simple"/></inline-formula>. Indeed, in this
                    case <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e070" xlink:type="simple"/></inline-formula>. In such network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e071" xlink:type="simple"/></inline-formula> and hence the Eq.
                    (1) can be rewritten as <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e072" xlink:type="simple"/><label>(2)</label></disp-formula></p>
                <p>A critical branching process that has not terminated by level <italic>d</italic>
                    satisfies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e073" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e074" xlink:type="simple"/></inline-formula>. More generally if
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e075" xlink:type="simple"/></inline-formula> algebraically increases with
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e076" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e077" xlink:type="simple"/></inline-formula> asymptotically
                    approaches 1 as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e078" xlink:type="simple"/><label>(3)</label></disp-formula></p>
                <p>Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e079" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e080" xlink:type="simple"/></inline-formula>, thus for
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e081" xlink:type="simple"/></inline-formula>
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e082" xlink:type="simple"/></inline-formula> remains approximately constant and according to Eq. (2)
                    this constant ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e083" xlink:type="simple"/></inline-formula> is defined by
                            <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e084" xlink:type="simple"/><label>(4)</label></disp-formula></p>
                <p>This quadratic relation is exact in a critical branching tree where each node can
                    branch out into at most two nodes at the next layer, and it is still correct to
                    a leading order in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e085" xlink:type="simple"/></inline-formula> for a critical
                    branching tree with arbitrary branching ratios (see “Quadratic relation
                    between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e086" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e087" xlink:type="simple"/></inline-formula> for general
                    critical branching processes” of <xref ref-type="supplementary-material" rid="pcbi.1001137.s001">Text S1</xref>). Furthermore, one can show (see
                    “Calculation of the average <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e088" xlink:type="simple"/></inline-formula> in the toolbox
                    model on a critical tree” of <xref ref-type="supplementary-material" rid="pcbi.1001137.s001">Text S1</xref>) that in large critical networks the
                    overall fraction of metabolites present in organism-specific metabolic network
                    is very close to this stationary limit of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e089" xlink:type="simple"/></inline-formula>:
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e090" xlink:type="simple"/></inline-formula>.</p>
                <p>As was explained in the previous section the ratio
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e091" xlink:type="simple"/></inline-formula> between the total number <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e092" xlink:type="simple"/></inline-formula> of
                    metabolic-related genes in the genome of an organism and its theoretical maximal
                    value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e093" xlink:type="simple"/></inline-formula> for a genome containing the entire universal network is
                    also given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e094" xlink:type="simple"/></inline-formula>. Furthermore, in our model the number of leaves is equal
                    to the number of nutrient-utilizing pathways or, alternatively, their
                    transcriptional regulators <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e095" xlink:type="simple"/></inline-formula> . Thus like in a
                    much simpler model of Ref. <xref ref-type="bibr" rid="pcbi.1001137-Maslov1">[2]</xref> the toolbox model on any critical tree-like universal
                    network gives rise to quadratic scaling of the number of transcription factors
                    with the total number of genes: <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e096" xlink:type="simple"/><label>(5)</label></disp-formula></p>
                <p>The geometrical properties of the universal network such as its total number of
                    nodes/edges <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e097" xlink:type="simple"/></inline-formula> and number of leaves/branches
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e098" xlink:type="simple"/></inline-formula> determine the prefactor of this scaling law. Simulation
                    of the toolbox model on the critical tree (<xref ref-type="fig" rid="pcbi-1001137-g002">Figure 2</xref>) verified our mathematical
                    predictions with the best fit to binned datapoints in <xref ref-type="fig" rid="pcbi-1001137-g002">Figure 2</xref> giving the exponent
                    α = 1.9±0.1.</p>
                <fig id="pcbi-1001137-g002" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pcbi.1001137.g002</object-id>
                    <label>Figure 2</label>
                    <caption>
                        <title><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e099" xlink:type="simple"/></inline-formula> vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e100" xlink:type="simple"/></inline-formula>.</title>
                        <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e101" xlink:type="simple"/></inline-formula> is the number of leaves in an organism-specific
                            metabolic network and equal to the number of transcriptional regulators
                            of corresponding nutrient-utilizing pathways, while
                                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e102" xlink:type="simple"/></inline-formula> is the
                            total number of nodes/metabolites in this netowrk. The data are
                            generated by the toolbox model on critical universal network with sizes
                            around 2000. Solid line <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e103" xlink:type="simple"/></inline-formula>, where the
                            exponent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e104" xlink:type="simple"/></inline-formula> and the
                            prefactor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e105" xlink:type="simple"/></inline-formula>, are the
                            best fits to the binned data.</p>
                    </caption>
                    <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.g002" xlink:type="simple"/>
                </fig>
            </sec>
            <sec id="s2c">
                <title>The toolbox model on a supercritical tree</title>
                <p>For a supercritical branching process <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e106" xlink:type="simple"/></inline-formula> and according to
                    Eq. (1) (See SI for the derivation) the steady state value
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e107" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e108" xlink:type="simple"/></inline-formula> satisfies
                            <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e109" xlink:type="simple"/><label>(6)</label></disp-formula></p>
                <p>Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e110" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e111" xlink:type="simple"/></inline-formula>. Notice that for
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e112" xlink:type="simple"/></inline-formula> one has two solutions for
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e113" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e114" xlink:type="simple"/></inline-formula> and
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e115" xlink:type="simple"/></inline-formula>. This indicates transition in which for
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e116" xlink:type="simple"/></inline-formula> exactly at zero one has <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e117" xlink:type="simple"/></inline-formula>, while for an
                    arbitrary small yet positive <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e118" xlink:type="simple"/></inline-formula> the value of
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e119" xlink:type="simple"/></inline-formula> asymptotically converges to
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e120" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e121" xlink:type="simple"/></inline-formula>. This transition
                    resembles the first order phase transition, e.g., liquid-gas transition, where
                    right at the transition point very small variation of the external parameter
                    such as temperature (analogous to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e122" xlink:type="simple"/></inline-formula> in this model)
                    results in a large jump of the order parameter such as density (analogous to our
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e123" xlink:type="simple"/></inline-formula>). (See <xref ref-type="bibr" rid="pcbi.1001137-Huang1">[5]</xref> for details), The number of layers over which this
                    conversion is taking place is itself a function of
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e124" xlink:type="simple"/></inline-formula> and for small <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e125" xlink:type="simple"/></inline-formula> it is large. For
                    exponentially growing supercritical networks and for small
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e126" xlink:type="simple"/></inline-formula>, the network average value of
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e127" xlink:type="simple"/></inline-formula> defined as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e128" xlink:type="simple"/></inline-formula> satisfies
                            <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e129" xlink:type="simple"/><label>(7)</label></disp-formula></p>
                <p>Note that this equation connecting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e130" xlink:type="simple"/></inline-formula> and
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e131" xlink:type="simple"/></inline-formula> (see SI for detailed derivation) is markedly different
                    from Eq. (6) for steady state value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e132" xlink:type="simple"/></inline-formula> in middle
                    layers.</p>
                <p>In conclusion, while the toolbox model on a critical universal network is
                    characterized by a quadratic scaling between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e133" xlink:type="simple"/></inline-formula> and
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e134" xlink:type="simple"/></inline-formula> (see Eq. (4)), the same model on a supercritical,
                    exponentially expanding universal network gives rise to a linear scaling of
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e135" xlink:type="simple"/></inline-formula> vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e136" xlink:type="simple"/></inline-formula> albeit with
                    logarithmic corrections (see Eq. (7)). This difference in exponent equally
                    applies to the scaling of the number of regulators
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e137" xlink:type="simple"/></inline-formula> vs. the total number of genes
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e138" xlink:type="simple"/></inline-formula> in the toolbox model on critical and supercritical
                    universal network.</p>
            </sec>
            <sec id="s2d">
                <title>Simulation of the toolbox model on the KEGG network with linearized
                    pathways</title>
                <p>To test our mathematical results for a more realistic version of the universal
                    tree we linearized pathways and reactions in the network formed by the union of
                    all reactions in the KEGG database <xref ref-type="bibr" rid="pcbi.1001137-Kanehisa1">[6]</xref>. To this end we generated
                    a random spanning tree on the KEGG network by the following algorithm: the
                    metabolite pyruvate was selected as the root of the tree. We then randomly
                    picked a metabolite located upstream of it and generated a linear pathway (tree
                    branch) as a self-avoiding random walk on the KEGG network extended until it
                    either merges with another pathway or reaches the root of the tree. This step
                    was repeated until all upstream metabolites were covered. The resulting spanning
                    tree was then used as the universal network on which we simulated the toolbox
                    model by gradually increasing the number of pathways
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e139" xlink:type="simple"/></inline-formula> and recording the total number of metabolites
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e140" xlink:type="simple"/></inline-formula> in organism-specific metabolic networks. Our numerical
                    simulations generated approximately quadratic scaling
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e141" xlink:type="simple"/></inline-formula> (see Ref. <xref ref-type="bibr" rid="pcbi.1001137-Maslov1">[2]</xref>).</p>
                <p>To better understand the origins of this scaling we investigated the topology of
                    the underlying universal tree. The criticality of a tree is defined by the
                    asymptotic value of the ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e142" xlink:type="simple"/></inline-formula> for large
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e143" xlink:type="simple"/></inline-formula>: for supercritical trees it reaches a limit
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e144" xlink:type="simple"/></inline-formula>, while for critical ones it converges to 1 as described
                    in Eq. (3). <xref ref-type="fig" rid="pcbi-1001137-g003">Figure 3</xref> showing
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e145" xlink:type="simple"/></inline-formula> vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e146" xlink:type="simple"/></inline-formula> in the linearized
                    KEGG network convincingly demonstrates its criticality. Thus the quadratic
                    scaling between the number of transcriptional regulators and the number of
                    metabolites in the toolbox model simulated on the linearized KEGG network is
                    explained by the mathematical formalism described in previous sections.</p>
                <fig id="pcbi-1001137-g003" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pcbi.1001137.g003</object-id>
                    <label>Figure 3</label>
                    <caption>
                        <title><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e147" xlink:type="simple"/></inline-formula> vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e148" xlink:type="simple"/></inline-formula> for
                            KEGG-based universal network with linearized pathways.</title>
                        <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e149" xlink:type="simple"/></inline-formula> (the ratio of the number of metabolites at two
                            consecutive layers) plotted as a function of
                                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e150" xlink:type="simple"/></inline-formula> (the layer
                            number) for KEGG-based universal network with linearized pathways. Solid
                            line: measurement, dotted line: its expected profile,
                                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e151" xlink:type="simple"/></inline-formula>, in a
                            critical branching tree. The error bars reflect standard deviation in
                            different spanning trees used to linearize the KEGG network.</p>
                    </caption>
                    <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.g003" xlink:type="simple"/>
                </fig>
                <p>In addition to using a random spanning tree to linearize the KEGG network we also
                    tried a version using minimal paths. In this version the universal network is
                    generated by randomly picking a metabolite and connecting it to the root of the
                    tree (pyruvate) by the shortest path. At a first glance such “minimal
                    path” selection appears to be reasonable from evolutionary standpoint.
                    Indeed, evolution would favor simpler and shorter pathways in order to minimize
                    the expenditure of resources to achieve a given metabolic goal <xref ref-type="bibr" rid="pcbi.1001137-MelndezHevia1">[7]</xref> .
                    However, the minimal paths version of linearization of the KEGG resulted in a
                    supercritical universal network with logarithmically short branches
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e152" xlink:type="simple"/></inline-formula>. As predicted for supercritical trees (Eq. (7)) the
                    toolbox model in this case had an approximately linear scaling of the number of
                    transcriptional regulators (leaves of branches on the network) with the total
                    number of metabolites: the measured best fit exponent was only
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e153" xlink:type="simple"/></inline-formula>.</p>
                <p>How do we reconcile the evolutionary pressure apparently selecting for minimal
                    pathways with dramatically wrong scaling properties of this model? We believe
                    that most of the ultra-short “small world” pathways generated by
                    minimal paths on the KEGG network are unrealistic from biochemical standpoint.
                    Indeed, highly connected co-factors often position metabolites with very
                    different chemical formulas in close proximity to each other. For example, the
                    KEGG reaction R00134: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e154" xlink:type="simple"/></inline-formula> would appear as a
                    miraculous “one-step” conversion of carbon dioxide into formate,
                    while the reaction R03546: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e155" xlink:type="simple"/></inline-formula> would artificially
                    link carbon dioxide and cyanate. The combination of these two reactions gives
                    rise to equally impossible two-step path: formate → CO<sub>2</sub> →
                    cyanate. As a consequence of such artificial shortcuts branches of the universal
                    network linearized by minimal paths are much shorter than they are in reality.
                    .This problem is at least partially alleviated by 1) removing unusually
                    high-degree nodes corresponding to common co-factors such as H<sub>2</sub>O,
                    ATP, NAD in the metabolic network so that some unrealistic paths are eliminated,
                    and also 2) using random spanning tree instead of the shortest paths. In Ref.
                        <xref ref-type="bibr" rid="pcbi.1001137-Maslov1">[2]</xref> we
                    followed both of these recipes to successfully reproduce the quadratic scaling
                    in real-life data. Still no linearization procedure could completely avoid
                    biochemically meaningless shortcuts. In the next section we introduce and study
                    a new considerably more realistic version of the toolbox model operating on
                    branched and interconnected universal networks. Pathways in this version of the
                    toolbox model satisfy the evolutionary requirements for minimal size. Proper
                    treatment of metabolic reactions with multiple substrates prevents biochemically
                    meaningless shortcuts and as a consequence restores the quadratic scaling.</p>
            </sec>
            <sec id="s2e">
                <title>The toolbox model on KEGG network with branched pathways and multi-substrate
                    reactions</title>
                <p>Real metabolic reactions routinely include multiple inputs (substrates) and
                    multiple outputs (products) (see <xref ref-type="table" rid="pcbi-1001137-t001">Table 1</xref> and <xref ref-type="table" rid="pcbi-1001137-t002">Table
                        2</xref> for statistics in the KEGG database). Furthermore, metabolic
                    networks often have two or more alternative pathways generating the same set of
                    end-products from the same set of nutrients. Both these factors result in
                    metabolic networks that are branched and interconnected. Here we propose and
                    simulate a more realistic version of the toolbox model. The most prominent
                    feature of the new model of pathways is the “AND” function acting on
                    inputs of multi-substrate reactions. It reflects the constraint that a reaction
                    cannot be carried out unless all its substrates are present.</p>
                <table-wrap id="pcbi-1001137-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001137.t001</object-id><label>Table 1</label><caption>
                        <title>The distribution of irreversible reactions classified by their
                            numbers of substrates and products.</title>
                    </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1001137-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.t001" xlink:type="simple"/><table>
                        <colgroup span="1">
                            <col align="left" span="1"/>
                            <col align="center" span="1"/>
                            <col align="center" span="1"/>
                            <col align="center" span="1"/>
                            <col align="center" span="1"/>
                            <col align="center" span="1"/>
                            <col align="center" span="1"/>
                        </colgroup>
                        <thead>
                            <tr>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="6" rowspan="1">The number of products of an
                                    irreversible reaction</td>
                            </tr>
                            <tr>
                                <td align="left" colspan="1" rowspan="1">The number of substrates of an irreversible
                                    reaction</td>
                                <td align="left" colspan="1" rowspan="1">1</td>
                                <td align="left" colspan="1" rowspan="1">2</td>
                                <td align="left" colspan="1" rowspan="1">3</td>
                                <td align="left" colspan="1" rowspan="1">4</td>
                                <td align="left" colspan="2" rowspan="1">5</td>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td align="left" colspan="1" rowspan="1">1</td>
                                <td align="left" colspan="1" rowspan="1">157</td>
                                <td align="left" colspan="1" rowspan="1">141</td>
                                <td align="left" colspan="1" rowspan="1">4</td>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="2" rowspan="1"/>
                            </tr>
                            <tr>
                                <td align="left" colspan="1" rowspan="1">2</td>
                                <td align="left" colspan="1" rowspan="1">82</td>
                                <td align="left" colspan="1" rowspan="1">491</td>
                                <td align="left" colspan="1" rowspan="1">95</td>
                                <td align="left" colspan="1" rowspan="1">7</td>
                                <td align="left" colspan="2" rowspan="1"/>
                            </tr>
                            <tr>
                                <td align="left" colspan="1" rowspan="1">3</td>
                                <td align="left" colspan="1" rowspan="1">1</td>
                                <td align="left" colspan="1" rowspan="1">123</td>
                                <td align="left" colspan="1" rowspan="1">170</td>
                                <td align="left" colspan="1" rowspan="1">31</td>
                                <td align="left" colspan="2" rowspan="1">1</td>
                            </tr>
                            <tr>
                                <td align="left" colspan="1" rowspan="1">4</td>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="1" rowspan="1">10</td>
                                <td align="left" colspan="1" rowspan="1">73</td>
                                <td align="left" colspan="1" rowspan="1">15</td>
                                <td align="left" colspan="2" rowspan="1"/>
                            </tr>
                            <tr>
                                <td align="left" colspan="1" rowspan="1">5</td>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="1" rowspan="1">1</td>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="2" rowspan="1"/>
                            </tr>
                        </tbody>
                    </table></alternatives></table-wrap>
                <table-wrap id="pcbi-1001137-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001137.t002</object-id><label>Table 2</label><caption>
                        <title>The distribution of reversible reactions classified by their numbers
                            substrates/products.</title>
                    </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1001137-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.t002" xlink:type="simple"/><table>
                        <colgroup span="1">
                            <col align="left" span="1"/>
                            <col align="center" span="1"/>
                            <col align="center" span="1"/>
                            <col align="center" span="1"/>
                            <col align="center" span="1"/>
                            <col align="center" span="1"/>
                        </colgroup>
                        <thead>
                            <tr>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="5" rowspan="1">The number of substrates/products at
                                    one end of a reversible reaction</td>
                            </tr>
                            <tr>
                                <td align="left" colspan="1" rowspan="1">The number of substrates/products at the opposite
                                    end of a reversible reaction</td>
                                <td align="left" colspan="1" rowspan="1">1</td>
                                <td align="left" colspan="1" rowspan="1">2</td>
                                <td align="left" colspan="1" rowspan="1">3</td>
                                <td align="left" colspan="1" rowspan="1">4</td>
                                <td align="left" colspan="1" rowspan="1">5</td>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td align="left" colspan="1" rowspan="1">1</td>
                                <td align="left" colspan="1" rowspan="1">143</td>
                                <td align="left" colspan="1" rowspan="1">231</td>
                                <td align="left" colspan="1" rowspan="1">6</td>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="1" rowspan="1"/>
                            </tr>
                            <tr>
                                <td align="left" colspan="1" rowspan="1">2</td>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="1" rowspan="1">553</td>
                                <td align="left" colspan="1" rowspan="1">284</td>
                                <td align="left" colspan="1" rowspan="1">15</td>
                                <td align="left" colspan="1" rowspan="1"/>
                            </tr>
                            <tr>
                                <td align="left" colspan="1" rowspan="1">3</td>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="1" rowspan="1">106</td>
                                <td align="left" colspan="1" rowspan="1">69</td>
                                <td align="left" colspan="1" rowspan="1">1</td>
                            </tr>
                            <tr>
                                <td align="left" colspan="1" rowspan="1">4</td>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="1" rowspan="1"/>
                                <td align="left" colspan="1" rowspan="1">6</td>
                                <td align="left" colspan="1" rowspan="1">3</td>
                            </tr>
                        </tbody>
                    </table></alternatives></table-wrap>
                <p>The new version of the toolbox model simulates addition of anabolic pathways
                    aimed at production of new metabolites from those the model organism can
                    currently synthesize (its current metabolic core). The new pathways are
                        <italic>optimal</italic> in the sense that they contain the smallest number
                    of reactions necessary to synthesize the desired end-product. As for previous
                    versions of the toolbox model, one can modify the rules of this model to apply
                    to catabolic pathways but for simplicity we will limit the following discussion
                    to anabolic pathways. The rules of the new model are:</p>
                <list list-type="order">
                    <list-item>
                        <p>At the beginning of the simulation, the model organism starts with a
                            “seed” metabolic network consisting of 40 metabolites
                            classified by the KEGG as parts of central carbohydrate metabolism, plus
                            a number of “currency” metabolites such as water, ATP and
                            NAD (see the section “Seed metabolites of the scope
                            expansion” of <xref ref-type="supplementary-material" rid="pcbi.1001137.s001">Text S1</xref> for additional details). It
                            is assumed that our organism is able to generate all of these
                            metabolites by some unspecified catabolic pathways.</p>
                    </list-item>
                    <list-item>
                        <p>At each step a new metabolite that cannot yet be synthesized by the
                            organism is randomly selected from the “scope” <xref ref-type="bibr" rid="pcbi.1001137-Handorf1">[8]</xref> of
                            our seed metabolites. This scope consists of all metabolites that in
                            principle could be synthesized from the seed metabolites using all
                            reactions listed in the KEGG database (see Ref. <xref ref-type="bibr" rid="pcbi.1001137-Handorf1">[8]</xref> for details).</p>
                    </list-item>
                    <list-item>
                        <p>To search for the minimal pathway that converts core metabolites to this
                            target we first perform the “scope expansion” <xref ref-type="bibr" rid="pcbi.1001137-Handorf1">[8]</xref> of
                            the core until it first reaches the target. In the course of this
                            expansion reactions and metabolites are added step by step (or layer by
                            layer). Each layer consists of all KEGG reactions that have all their
                            substrates among the metabolites in the current metabolic core of the
                            organism (light blue area in <xref ref-type="fig" rid="pcbi-1001137-g004">Figure 4</xref>) and those generated by
                            reactions in all the previous layers. (See <xref ref-type="fig" rid="pcbi-1001137-g004">Figure 4</xref> for an illustration).</p>
                    </list-item>
                    <list-item>
                        <p>Next we trace back added reactions starting from the target and
                            progressively moving to lower levels. One starts by finding the reaction
                            responsible for fabrication of the target metabolite and adding it to
                            the new pathway (if several such reactions exist in the last layer we
                            randomly choose one of them). In case of multi-layer expansion process
                            some substrates of this reaction are not among the core metabolites
                            (otherwise this reaction would be in the first layer). One then goes
                            down one layer and adds the reactions fabricating these missing
                            substrates. This is repeated all the way down to the first level of the
                            original expansion. The resulting pathway includes the minimal (or
                            nearly minimal) set of reactions needed to generate the target
                            metabolite from the current metabolic core of the organism. Starting
                            from the next step of the model the target and all intermediate
                            metabolites become part of the metabolic core. Genes for enzymes
                            catalyzing these new reactions are assumed to be horizontally
                            transferred to the genome of the organism. The newly added metabolic
                            pathway is assumed to have a dedicated transcriptional regulator so that
                            the number of transcription factors in our model is always equal to the
                            number of pathways or their target metabolites.</p>
                    </list-item>
                    <list-item>
                        <p>Steps 1–5 are repeated until metabolic network of the organism
                            reaches its maximal size. At this stage it includes the entire scope
                                <xref ref-type="bibr" rid="pcbi.1001137-Handorf1">[8]</xref> of the starting set of metabolites in step
                            1.</p>
                    </list-item>
                </list>
                <fig id="pcbi-1001137-g004" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pcbi.1001137.g004</object-id>
                    <label>Figure 4</label>
                    <caption>
                        <title>Diagram of a new pathway added to the metabolic network of the
                            organism.</title>
                        <p>The diagram explains different types of metabolites and reactions.
                            Reactions (squares) in the added pathway use base substrates (yellow
                            circles with horizontal shading) from the metabolic core of the organism
                            (light blue area) to produce the target metabolite (the red circle).
                            Added pathway generates intermediate products (green circles) as well as
                            byproducts that are not further converted to the target (blue circles).
                            Products of some reactions feed back into the metabolic core (yellow
                            circles with vertical shading). Reactions are labeled with expansion
                            steps at which they were added to the pathway.</p>
                    </caption>
                    <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.g004" xlink:type="simple"/>
                </fig>
                <p>Numerical simulation of this model shows that the number of transcriptional
                    regulators scales with the number of metabolites with power
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e156" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1001137-g005">Figure
                        5</xref>). This is consistent with quadratic scaling we observed and
                    mathematically derived for a simpler model with linearized pathways composed of
                    single-substrate reactions.</p>
                <fig id="pcbi-1001137-g005" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pcbi.1001137.g005</object-id>
                    <label>Figure 5</label>
                    <caption>
                        <title><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e157" xlink:type="simple"/></inline-formula> vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e158" xlink:type="simple"/></inline-formula> of toolbox
                            model with branched pathways and multi-substrate reactions.</title>
                        <p>The scaling between the number of regulated pathways (leaves),
                                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e159" xlink:type="simple"/></inline-formula> and the
                            number of metabolites, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e160" xlink:type="simple"/></inline-formula>, in
                            metabolic networks generated by the toolbox model with branched pathways
                            and multi-substrate reactions. Solid line with slope
                            2.0+/−0.1 is the best fit to the data. Error bars reflect the
                            standard deviation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e161" xlink:type="simple"/></inline-formula> at a given
                            value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e162" xlink:type="simple"/></inline-formula> in 9
                            realizations of the model (see he section “Error analysis of the
                            toolbox model” of <xref ref-type="supplementary-material" rid="pcbi.1001137.s001">Text S1</xref> for our estimation methods
                            and error analysis).</p>
                    </caption>
                    <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.g005" xlink:type="simple"/>
                </fig>
                <p>The mathematical formalism derived in the previous sections is limited to
                    tree-like universal networks and thus does not directly apply to the new model.
                    Nevertheless, one generally expects the quadratic scaling to be limited only to
                    critical, “large world” networks in which organisms with small
                    genomes initially tend to acquire sufficiently long pathways. As noted before,
                    from purely topological standpoint the KEGG network has a “small
                    world” property making long pathways unlikely. It is important to check if
                    the realistic treatment of multi-substrate reactions did in fact restore the
                    “large world” property and criticality to the KEGG universal network
                    by increasing the minimal number of steps required for connecting target
                    metabolites to the metabolic core. To quantify the criticality of the expansion
                    process as before we use the ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e163" xlink:type="simple"/></inline-formula> where
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e164" xlink:type="simple"/></inline-formula> denotes the number of metabolites reached at step
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e165" xlink:type="simple"/></inline-formula> of the scope expansion starting from the initial seed
                    subset of metabolites. As in the case of critical branching trees this ratio
                    asymptomatically converges to 1 thus confirming the criticality of the scope
                    expansion process. The mere existence of ∼40 steps in this process (the
                    x-axis in <xref ref-type="fig" rid="pcbi-1001137-g006">Figure 6</xref>) can
                    serve as evidence in favor of “large world” character of the KEGG
                    universal network characterized by the existence of long pathways.</p>
                <fig id="pcbi-1001137-g006" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pcbi.1001137.g006</object-id>
                    <label>Figure 6</label>
                    <caption>
                        <title><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e166" xlink:type="simple"/></inline-formula> vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e167" xlink:type="simple"/></inline-formula> for the
                            universal network consisting of all KEGG reactions.</title>
                        <p>The ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e168" xlink:type="simple"/></inline-formula> of the
                            number of metabolites at two consecutive layers of the scope expansion
                            process plotted versus the layer number <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e169" xlink:type="simple"/></inline-formula>. Scope
                            expansion was performed for the universal network consisting of all KEGG
                            reactions. The dashed line is the mathematical expectation of the same
                            curve in a critical branching process.</p>
                    </caption>
                    <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.g006" xlink:type="simple"/>
                </fig>
            </sec>
            <sec id="s2f">
                <title>Geometrical properties of branched pathways in the model</title>
                <p>Unlike linearized pathways in the original version of the toolbox model <xref ref-type="bibr" rid="pcbi.1001137-Maslov1">[2]</xref>, branched
                    pathways in the more realistic model from previous section are interesting
                    objects in their own right. We identified several geometrical properties of
                    these pathways (see <xref ref-type="fig" rid="pcbi-1001137-g004">Figure 4</xref>
                    for illustration) quantifying their position relative to the core network to
                    which they were added: 1) <italic>n</italic><sub>border rxn</sub>–the
                    number of added reactions that are connected (as a substrate or a product) with
                    at least one metabolite in the core, 2)
                    <italic>n</italic><sub>base</sub>–the number of metabolites in the core
                    that serve as substrates to reactions in the added pathway, 3)
                        <italic>n</italic><sub>feedback</sub>–the number of core metabolites
                    that are products of reactions in the new pathway, 4)
                        <italic>n</italic><sub>byproduct</sub>–the number of final metabolic
                    products of the added pathway that are neither core metabolites nor the target,
                    5) length-the number of steps (layers of the scope expansion process) it takes
                    to transform core metabolites into the target product. 4 illustrates the
                    definition of these parameters while <xref ref-type="fig" rid="pcbi-1001137-g007">Figure 7</xref> and <xref ref-type="fig" rid="pcbi-1001137-g008">Figure 8</xref> plot these parameters as a function
                    of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e170" xlink:type="simple"/></inline-formula> (the number of metabolites in the added pathway) or
                            <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e171" xlink:type="simple"/></inline-formula> (the number of reactions in the added pathway).</p>
                <fig id="pcbi-1001137-g007" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pcbi.1001137.g007</object-id>
                    <label>Figure 7</label>
                    <caption>
                        <title>n<sub>byproduct</sub> vs.<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e172" xlink:type="simple"/></inline-formula>.</title>
                        <p>Faster-than-linear scaling of the number of byproducts,
                                n<sub>byproduct</sub>, and the total number of metabolites,
                                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e173" xlink:type="simple"/></inline-formula>, in
                            individual branched pathways illustrated in <xref ref-type="fig" rid="pcbi-1001137-g004">Figure 4</xref>. Data for individual
                            pathways were logarithmically binned along the x-axis. Hence y-axis can
                            be and are below 1 due to pathways with 0 byproducts. The solid line
                            with exponent 1.7+/−0.1 is the best fit to the
                            logarithmically-binned data shown in this plot. Readers can refer to the
                            section “Analysis of number of by-product of the pathways of the
                            toolbox model on the metabolic network with branched pathways and
                            multi-substrates reactions” of <xref ref-type="supplementary-material" rid="pcbi.1001137.s001">Text
                                S1</xref> for our estimation methods and error analysis.</p>
                    </caption>
                    <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.g007" xlink:type="simple"/>
                </fig>
                <fig id="pcbi-1001137-g008" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pcbi.1001137.g008</object-id>
                    <label>Figure 8</label>
                    <caption>
                        <title>Various linear relationships on the individual pathways.</title>
                        <p>Approximately linear relationship between a) pathway's length and
                            its number of reactions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e174" xlink:type="simple"/></inline-formula>, ) b) the
                            number of border reactions, n<sub>border rxn,</sub> and the total number
                            of reactions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e175" xlink:type="simple"/></inline-formula>, c) the
                            number of base metabolites, n<sub>base,</sub> and the total number of
                            metabolites, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e176" xlink:type="simple"/></inline-formula>, d) the
                            number of metabolites receiving feedback, n<sub>feedback,</sub> and the
                            total number of metabolites, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e177" xlink:type="simple"/></inline-formula>. These
                            different geometrical properties of individual pathways are illustrated
                            in <xref ref-type="fig" rid="pcbi-1001137-g004">Figure 4</xref>. Sizes
                            of circles are proportional to the logarithm of the number of discrete
                            (x, y) pairs contributing to this point.</p>
                    </caption>
                    <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.g008" xlink:type="simple"/>
                </fig>
                <p>Approximately linear relationship between <italic>n</italic><sub>border rxn</sub>
                    vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e178" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1001137-g008">Figure
                        8a</xref>) suggests that added pathways tend to be located at or near the
                    surface of the core metabolic network of the organism. Most of reactions in
                    these pathways use metabolites from this core network either as substrates
                        (<italic>n</italic><sub>base</sub>) or as products
                        (<italic>n</italic><sub>feedback</sub>). Further analysis indicates that
                    “currency metabolites” (common co-factors that serve as substrates
                    or products of many reactions) constitute a significant fraction
                    (∼25%) of all core metabolites involved in border reactions (see the
                    section “Analysis of the currency metabolites in the toolbox model”
                    of <xref ref-type="supplementary-material" rid="pcbi.1001137.s001">Text
                        S1</xref> for details). On the other hand, the fact that the number of steps
                    in a pathway (its length) constitutes a good fraction of its overall number of
                    reactions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e179" xlink:type="simple"/></inline-formula> implies that, in spite of these numerous
                    “shortcut” connections to the core, added pathways remain very thin
                    and essentially linear. That is to say, these pathways tend to work as a single
                    “conveyor belt” sequentially converting intermediate products into
                    each other instead of having two or more parallel “processing lines”
                    and assembling final products of these lines only at final stages of the
                    pathway. This finding provides an intuitive reason why models with branched and
                    linearized pathways have similar scaling properties. One can argue that this is
                    because pathways in both models are essentially linear. Yet, in spite of their
                    linearity and optimality (each has the smallest number of reactions to generate
                    the target from the core) added pathways in the new version of the model are
                    very different from shortest paths on the universal network. As illustrated in
                        <xref ref-type="fig" rid="pcbi-1001137-g009">Figure 9</xref> the average
                    pathway length is several times longer than the geometrically shortest path
                    between the target and the core.</p>
                <fig id="pcbi-1001137-g009" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pcbi.1001137.g009</object-id>
                    <label>Figure 9</label>
                    <caption>
                        <title>Comparison of lengths of the pathways and shortest distances of the
                            targets from the core.</title>
                        <p>The lengths of the pathways are represented by circles and solid line,
                            while the shortest distances of the targets from the core are
                            represented by crosses and dotted line.</p>
                    </caption>
                    <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.g009" xlink:type="simple"/>
                </fig>
                <p>As can be seen from <xref ref-type="fig" rid="pcbi-1001137-g007">Figure 7</xref>,
                    most of added pathways (around 97%) do not generate any byproducts. They
                    only produce the intended target and <italic>n</italic><sub>feedback</sub>
                    metabolites in the core network of the organism to which they were added. The
                    relative scarcity of byproducts suggests that pathways in our model satisfy the
                    evolutionary constrains imposed on real-life organisms. Indeed, as previously
                    proposed in Ref <xref ref-type="bibr" rid="pcbi.1001137-MelndezHevia2">[9]</xref> it makes sense to assume that evolution favors
                    pathways that achieve a given metabolic goal using the smallest number of
                    enzymes and at the same time striving to generate the maximal possible yield.
                    Unnecessary byproducts not only reduce the yield of the desired metabolic
                    target, they also might become toxic in high concentrations and thus would
                    require extra transporter proteins to pump them out.</p>
            </sec>
        </sec>
        <sec id="s3">
            <title>Discussion</title>
            <p>The small world property of complex biomolecular networks has been extensively
                discussed in the literature during the last decade (see <xref ref-type="bibr" rid="pcbi.1001137-Wagner1">[10]</xref>–<xref ref-type="bibr" rid="pcbi.1001137-Jeong1">[12]</xref> for earliest reports in
                metabolic and protein interaction networks correspondingly). It was often assumed
                that the small world effect positively contributes to the robustness of the network
                by providing multiple redundant pathways for target production in metabolic networks
                or for propagation of signals along regulatory and protein interaction networks. In
                addition to its positive aspects the small world property in biomolecular networks
                also has a potentially negative side by facilitating system-wide propagation of
                undesirable cross-talk <xref ref-type="bibr" rid="pcbi.1001137-Maslov2">[13]</xref>. In the course of evolution different strategies appeared
                allowing organism to limit and attenuate these unwelcome side effects of global
                connectivity.</p>
            <p>The extent of small world topology in metabolic networks has been recently disputed
                in <xref ref-type="bibr" rid="pcbi.1001137-Arita1">[14]</xref>. There it
                was argued that many shortcuts in simple graph representations of metabolic networks
                are meaningless from biochemical standpoint. By taking into account additional
                structural information about metabolites Arita <xref ref-type="bibr" rid="pcbi.1001137-Arita1">[14]</xref> dramatically increased the
                diameter of the metabolic network in <italic>E. coli</italic>. In our simulations of
                the toolbox model we also encountered limitations of the simple graph representation
                giving rise to small world topology of metabolic networks. Small world by definition
                implies very short pathways (or equivalently supercritical network branching with
                exponentially growing lists of neighbors at distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e180" xlink:type="simple"/></inline-formula>), which in its turn
                prevents the appearance of quadratic scaling in the linear toolbox model.</p>
            <p>How to reconcile this apparent contradiction? The answer known from pioneering
                studies of R. Heinrich and collaborators (see e.g. <xref ref-type="bibr" rid="pcbi.1001137-Handorf1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1001137-Handorf2">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1001137-Ebenhh1">[16]</xref> ) is to altogether abandon the
                simple graph representation in favor of realistic treatment of multi-substrate
                reactions. A metabolic reaction with two or more substrates will not proceed at any
                rate until all these metabolites are present in the cell. This implicit
                “AND” function operating on inputs of multi-substrate metabolic
                reactions makes reaching a given metabolic target much harder task and ultimately
                leads to dramatically longer pathways (<xref ref-type="fig" rid="pcbi-1001137-g009">Figure 9</xref> quantifies this effect). These longer pathways in turn
                reinstate the quadratic scaling in the version of the toolbox model that was
                introduced in the previous section. This leads to the novel conclusion of our study
                that, when multi-substrate reactions are properly taken into account, the small
                world (supercritical) topology of the metabolic universe disappears in favor of the
                “large world” topology characteristic of critical branching networks.
                The increase in the effective diameter of the network due to this effect is
                dramatic. One goes from 3–4 steps diameter typical of a small world network of
                    <xref ref-type="bibr" rid="pcbi.1001137-Jeong1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1001137-Wagner2">[11]</xref> to ∼8 steps
                of <xref ref-type="bibr" rid="pcbi.1001137-Arita1">[14]</xref> and finally
                to 30–40 layers in the scope expansion process shown in <xref ref-type="fig" rid="pcbi-1001137-g006">Figure 6</xref> (see also <xref ref-type="fig" rid="pcbi-1001137-g006">Figure 6</xref> of <xref ref-type="bibr" rid="pcbi.1001137-Handorf1">[8]</xref>).</p>
            <p>These arguments lead us to adapt the “scope expansion” algorithm by
                Heinrich et al <xref ref-type="bibr" rid="pcbi.1001137-Handorf1">[8]</xref> to pathway acquisition in the toolbox model. Not only did
                it restore the “large world” properties such as quadratic scaling to the
                model, it also made the added pathways plausible from evolutionary standpoint.
                Unlike linear random walk pathways on KEGG network used in <xref ref-type="bibr" rid="pcbi.1001137-Maslov1">[2]</xref>, pathways in the new version of
                the toolbox model have the smallest number of KEGG reactions to achieve their
                metabolic task (production of the target metabolite from the set of metabolites
                already present in organism's network). As can be seen in <xref ref-type="fig" rid="pcbi-1001137-g007">Figure 7</xref> a large fraction of these pathways also
                does not generate any byproducts. Accumulation of such byproducts inside a cell is
                potentially dangerous and would require specialized proteins to excrete them to the
                environment. The lack of byproducts also means that the useful yield of an added
                pathway is at or near its theoretical maximum. This is consistent with the fact that
                real biological pathways are optimized in the course of evolution to increase their
                yield while simultaneously reducing the number of reaction steps <xref ref-type="bibr" rid="pcbi.1001137-MelndezHevia1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1001137-Noor1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1001137-Riehl1">[18]</xref>.</p>
            <p>Optimality of metabolic pathways in central carbon metabolism was recently discussed
                in Ref. <xref ref-type="bibr" rid="pcbi.1001137-Noor1">[17]</xref>. There
                it was shown that some (but not all) of these pathways coincide with the shortest
                walks in the space of possible metabolic transformations. This study also estimated
                a typical metabolic substrate can in principle be converted into any of the 20
                different products in just one step. This quickly adds up to a very large number of
                biochemically feasible paths connecting metabolites to each other. However, this
                exponential growth does not necessarily result in a small world universal metabolic
                network. Indeed, evolutionary optimization leaves just a tiny fraction of these
                biochemically feasible reactions to be realized in any organism. The universal
                metabolic network formed by the union of all organism-specific metabolic networks is
                thus dramatically sparser than the set of all reactions allowed by the basic rules
                of biochemistry. Thus, as demonstrated in Ref. <xref ref-type="bibr" rid="pcbi.1001137-Handorf1">[8]</xref> and the present study, the
                number of metabolites one could generate in N steps starting from a small core
                network and using KEGG-listed metabolic reactions instead of expanding as
                        <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e181" xlink:type="simple"/></inline-formula> grows with N much more slowly (algebraically). The overall
                picture consistent with both our observations and those of Ref. <xref ref-type="bibr" rid="pcbi.1001137-Noor1">[17]</xref> is that
                exponentially large, supercritical tree of all possible biochemical transformations
                is first pruned to an evolutionary optimized critical universal network out of which
                individual organisms select a subset of reactions necessary to accomplish their
                metabolic goals: that is to utilize nutrients in their environment and generate
                metabolic targets necessary for their operation.</p>
            <p>Simplified “toy” models based on artificial chemistry reactions have a
                long history of being used to reveal fundamental organizational principles of
                metabolic networks:</p>
            <list list-type="bullet">
                <list-item>
                    <p>The recent model of Riehl et al <xref ref-type="bibr" rid="pcbi.1001137-Riehl1">[18]</xref> uses the simplest
                        possible metabolites distinguished from each other only by the number of
                        atoms of one element (e.g. carbon). All reactions in this case are of
                        ligation/cleavage type (e.g. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e182" xlink:type="simple"/></inline-formula>) constrained
                        only by mass conservation. In spite of utmost simplicity of this artificial
                        chemistry, the optimal pathways in this model display a surprisingly rich
                        set of properties and bear some similarity to real-life metabolic
                        pathways.</p>
                </list-item>
                <list-item>
                    <p>The study of Pfeiffer et el <xref ref-type="bibr" rid="pcbi.1001137-Pfeiffer1">[19]</xref> emphasizes the role
                        of different chemical groups forming metabolites. They consider another
                        artificial chemistry where metabolites are defined by binary strings
                        indicating presence or absence of each of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e183" xlink:type="simple"/></inline-formula> different
                        chemical groups, and reactions transferring one such chemical group from one
                        substrate which has it to another substrate which initially does not.
                        Plausible evolutionary rules of their model give rise to complex scale-free
                        metabolic networks emerging from the simple initial condition of
                                <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001137.e184" xlink:type="simple"/></inline-formula> completely non-specific transferase enzymes.</p>
                </list-item>
                <list-item>
                    <p>Finally the artificial chemistry studied by Hintze et al <xref ref-type="bibr" rid="pcbi.1001137-Hintze1">[20]</xref> has
                        molecules composed of three different types of atoms with different
                        valences. Metabolites are linear molecules in which every atom is connected
                        to others by as many bonds as specified by its valence. This model with
                        rather complicated rules of evolution is then used to shed light on topics
                        such as robustness and modularity of metabolic networks.</p>
                </list-item>
            </list>
            <p>In our study we used the real-life (even if incomplete and sometimes noisy) metabolic
                universe of all reactions in the KEGG database. The only simplifying approximations
                remaining in the new most realistic version of the toolbox model is random selection
                of metabolic targets in the course of evolution and easy availability of any subset
                of KEGG reactions for horizontal transfer. Both these approximations can be relaxed
                in later versions of the model. Another promising direction is to extend the toolbox
                model to artificial chemistry universal networks of Refs. <xref ref-type="bibr" rid="pcbi.1001137-Riehl1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1001137-Pfeiffer1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1001137-Hintze1">[20]</xref>. While taking away from the
                realism of the model such extensions might help to broaden our intuition about what
                topological properties of the universal network determine the scaling properties of
                its species-specific subnetworks.</p>
        </sec>
        <sec id="s4" sec-type="materials|methods">
            <title>Materials and Methods</title>
            <p>The universal network used in our study consists of the union of all reactions listed
                in the KEGG database. The directionality of reactions and connected pairs of
                metabolites were inferred from the map version of the reaction formula: <ext-link ext-link-type="uri" xlink:href="ftp://ftp.genome.jp/pub/kegg/ligand/reaction/reaction?mapformula.lst" xlink:type="simple">ftp.genome.jp/pub/kegg/ligand/reaction/reaction?mapformula.lst</ext-link>. The
                universal network with linearized pathways used to construct <xref ref-type="fig" rid="pcbi-1001137-g002">Figure 2</xref> and <xref ref-type="fig" rid="pcbi-1001137-g003">Figure 3</xref> consists of 1813 metabolites upstream of
                pyruvate and 2745 reaction edges out of which 1782 are irreversible and 963 are
                reversible. The metabolic network with branched and cyclic pathways used to
                construct <xref ref-type="fig" rid="pcbi-1001137-g005">Figure 5</xref>–<xref ref-type="fig" rid="pcbi-1001137-g006"/><xref ref-type="fig" rid="pcbi-1001137-g007"/><xref ref-type="fig" rid="pcbi-1001137-g008"/><xref ref-type="fig" rid="pcbi-1001137-g009">9</xref> consists of 1861metabolites
                located downstream from the central metabolism and reachable from it by the scope
                expansion algorithm of Ref. <xref ref-type="bibr" rid="pcbi.1001137-Handorf1">[8]</xref>. It has 2819 reactions out of which 1402 are irreversible
                and the remaining 1417 are reversible. <xref ref-type="table" rid="pcbi-1001137-t001">Table 1</xref> and <xref ref-type="table" rid="pcbi-1001137-t002">Table 2</xref> shows the statistics for the number of
                substrates and products of these reactions. The list of core metabolites is obtained
                from KEGG Pathways Modules in the category “central carbohydrate
                metabolism” and extended with “currency” metabolites including
                water, ATP and NAD. Simulations were done in Matlab and Octave.</p>
        </sec>
        <sec id="s5">
            <title>Supporting Information</title>
            <supplementary-material id="pcbi.1001137.s001" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001137.s001" xlink:type="simple">
                <label>Text S1</label>
                <caption>
                    <p>Supplementary information.</p>
                    <p>(0.37 MB DOC)</p>
                </caption>
            </supplementary-material>
        </sec>
    </body>
    <back>
        <ack>
            <p>Additional support of this work was provided by the DOE Systems Biology Knowledgebase
                project “Tools and Models for Integrating Multiple Cellular
                Networks”.</p>
        </ack>
        <ref-list>
            <title>References</title>
            <ref id="pcbi.1001137-vanNimwegen1">
                <label>1</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>van Nimwegen</surname>
                            <given-names>E</given-names>
                        </name>
                    </person-group>
                    <year>2003</year>
                    <article-title>Scaling laws in the functional content of
                        genomes.</article-title>
                    <source>Trends Genet</source>
                    <volume>19</volume>
                    <fpage>479</fpage>
                    <lpage>484</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Maslov1">
                <label>2</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Maslov</surname>
                            <given-names>S</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Krishna</surname>
                            <given-names>S</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Pang</surname>
                            <given-names>TY</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Sneppen</surname>
                            <given-names>K</given-names>
                        </name>
                    </person-group>
                    <year>2009</year>
                    <article-title>Toolbox model of evolution of prokaryotic metabolic networks and
                        their regulation.</article-title>
                    <source>Proc Natl Acad Sci U S A</source>
                    <volume>106</volume>
                    <fpage>9743</fpage>
                    <lpage>9748</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Athreya1">
                <label>3</label>
                <element-citation publication-type="other" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Athreya</surname>
                            <given-names>KB</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Ney</surname>
                            <given-names>PE</given-names>
                        </name>
                    </person-group>
                    <year>2004</year>
                    <article-title>Branching Processes.</article-title>
                    <publisher-loc>New York</publisher-loc>
                    <publisher-name>Dover Publications</publisher-name>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Broadbent1">
                <label>4</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Broadbent</surname>
                            <given-names>SR</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Hammersley</surname>
                            <given-names>JM</given-names>
                        </name>
                    </person-group>
                    <year>1957</year>
                    <article-title>Percolation Processes. Math. Proc. Camb. Phil.</article-title>
                    <source>Soc</source>
                    <volume>53</volume>
                    <fpage>629</fpage>
                    <lpage>641</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Huang1">
                <label>5</label>
                <element-citation publication-type="other" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Huang</surname>
                            <given-names>K</given-names>
                        </name>
                    </person-group>
                    <year>1987</year>
                    <article-title>17.5 THE VAN DER WAALS EQUATION OF STATE.</article-title>
                    <source>Statistical mechanics</source>
                    <publisher-loc>New York</publisher-loc>
                    <publisher-name>Wiley</publisher-name>
                    <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">426</size>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Kanehisa1">
                <label>6</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Kanehisa</surname>
                            <given-names>M</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Goto</surname>
                            <given-names>S</given-names>
                        </name>
                    </person-group>
                    <year>2000</year>
                    <article-title>KEGG: kyoto encyclopedia of genes and genomes.</article-title>
                    <source>Nucleic Acids Res</source>
                    <volume>28</volume>
                    <fpage>27</fpage>
                    <lpage>30</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-MelndezHevia1">
                <label>7</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Meléndez-Hevia</surname>
                            <given-names>E</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Torres</surname>
                            <given-names>NV</given-names>
                        </name>
                    </person-group>
                    <year>1988</year>
                    <article-title>Economy of design in metabolic pathways: further remarks on the
                        game of the pentose phosphate cycle. J. Theor.</article-title>
                    <source>Biol</source>
                    <volume>132</volume>
                    <fpage>97</fpage>
                    <lpage>111</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Handorf1">
                <label>8</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Handorf</surname>
                            <given-names>T</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Ebenhöh</surname>
                            <given-names>O</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Heinrich</surname>
                            <given-names>R</given-names>
                        </name>
                    </person-group>
                    <year>2005</year>
                    <article-title>Expanding metabolic networks: scopes of compounds, robustness,
                        and evolution. J. Mol.</article-title>
                    <source>Evol</source>
                    <volume>61</volume>
                    <fpage>498</fpage>
                    <lpage>512</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-MelndezHevia2">
                <label>9</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Meléndez-Hevia</surname>
                            <given-names>E</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Torres</surname>
                            <given-names>NV</given-names>
                        </name>
                    </person-group>
                    <year>1988</year>
                    <article-title>Economy of design in metabolic pathways: further remarks on the
                        game of the pentose phosphate cycle. J. Theor.</article-title>
                    <source>Biol</source>
                    <volume>132</volume>
                    <fpage>97</fpage>
                    <lpage>111</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Wagner1">
                <label>10</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Wagner</surname>
                            <given-names>A</given-names>
                        </name>
                    </person-group>
                    <year>2001</year>
                    <article-title>The Yeast Protein Interaction Network Evolves Rapidly and
                        Contains Few Redundant Duplicate Genes.</article-title>
                    <source>Mol Biol Evol</source>
                    <volume>18</volume>
                    <fpage>1283</fpage>
                    <lpage>1292</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Wagner2">
                <label>11</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Wagner</surname>
                            <given-names>A</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Fell</surname>
                            <given-names>DA</given-names>
                        </name>
                    </person-group>
                    <year>2001</year>
                    <article-title>The small world inside large metabolic networks. Proc.
                        Biol.</article-title>
                    <source>Sci</source>
                    <volume>268</volume>
                    <fpage>1803</fpage>
                    <lpage>1810</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Jeong1">
                <label>12</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Jeong</surname>
                            <given-names>H</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Tombor</surname>
                            <given-names>B</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Albert</surname>
                            <given-names>R</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Oltvai</surname>
                            <given-names>ZN</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Barabasi</surname>
                            <given-names>A</given-names>
                        </name>
                    </person-group>
                    <year>2000</year>
                    <article-title>The large-scale organization of metabolic
                        networks.</article-title>
                    <source>Nature</source>
                    <volume>407</volume>
                    <fpage>651</fpage>
                    <lpage>654</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Maslov2">
                <label>13</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Maslov</surname>
                            <given-names>S</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Ispolatov</surname>
                            <given-names>I</given-names>
                        </name>
                    </person-group>
                    <year>2007</year>
                    <article-title>Propagation of large concentration changes in reversible
                        protein-binding networks.</article-title>
                    <source>Proc Natl Acad Sci U S A</source>
                    <volume>104</volume>
                    <fpage>13655</fpage>
                    <lpage>13660</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Arita1">
                <label>14</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Arita</surname>
                            <given-names>M</given-names>
                        </name>
                    </person-group>
                    <year>2004</year>
                    <article-title>The metabolic world of Escherichia coli is not
                        small.</article-title>
                    <source>Proc Natl Acad Sci U S A</source>
                    <volume>101</volume>
                    <fpage>1543</fpage>
                    <lpage>1547</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Handorf2">
                <label>15</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Handorf</surname>
                            <given-names>T</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Christian</surname>
                            <given-names>N</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Ebenhöh</surname>
                            <given-names>O</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Kahn</surname>
                            <given-names>D</given-names>
                        </name>
                    </person-group>
                    <year>2008</year>
                    <article-title>An environmental perspective on metabolism. J.
                        Theor.</article-title>
                    <source>Biol</source>
                    <volume>252</volume>
                    <fpage>530</fpage>
                    <lpage>537</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Ebenhh1">
                <label>16</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Ebenhöh</surname>
                            <given-names>O</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Handorf</surname>
                            <given-names>T</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Heinrich</surname>
                            <given-names>R</given-names>
                        </name>
                    </person-group>
                    <year>2005</year>
                    <article-title>A cross species comparison of metabolic network
                        functions.</article-title>
                    <source>Genome Inform</source>
                    <volume>16</volume>
                    <fpage>203</fpage>
                    <lpage>213</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Noor1">
                <label>17</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Noor</surname>
                            <given-names>E</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Eden</surname>
                            <given-names>E</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Milo</surname>
                            <given-names>R</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Alon</surname>
                            <given-names>U</given-names>
                        </name>
                    </person-group>
                    <year>2010</year>
                    <article-title>Central Carbon Metabolism as a Minimal Biochemical Walk between
                        Precursors for Biomass and Energy. Mol.</article-title>
                    <source>Cell</source>
                    <volume>39</volume>
                    <fpage>809</fpage>
                    <lpage>820</lpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Riehl1">
                <label>18</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Riehl</surname>
                            <given-names>WJ</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Krapivsky</surname>
                            <given-names>PL</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Redner</surname>
                            <given-names>S</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Segrè</surname>
                            <given-names>D</given-names>
                        </name>
                    </person-group>
                    <year>2010</year>
                    <article-title>Signatures of Arithmetic Simplicity in Metabolic Network
                        Architecture.</article-title>
                    <source>PLoS Comput Biol</source>
                    <volume>6</volume>
                    <fpage>e1000725</fpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Pfeiffer1">
                <label>19</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Pfeiffer</surname>
                            <given-names>T</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Soyer</surname>
                            <given-names>OS</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Bonhoeffer</surname>
                            <given-names>S</given-names>
                        </name>
                    </person-group>
                    <year>2005</year>
                    <article-title>The evolution of connectivity in metabolic
                        networks.</article-title>
                    <source>PLoS Biol</source>
                    <volume>3</volume>
                    <fpage>e228</fpage>
                </element-citation>
            </ref>
            <ref id="pcbi.1001137-Hintze1">
                <label>20</label>
                <element-citation publication-type="journal" xlink:type="simple">
                    <person-group person-group-type="author">
                        <name name-style="western">
                            <surname>Hintze</surname>
                            <given-names>A</given-names>
                        </name>
                        <name name-style="western">
                            <surname>Adami</surname>
                            <given-names>C</given-names>
                        </name>
                    </person-group>
                    <year>2008</year>
                    <article-title>Evolution of Complex Modular Biological Networks.</article-title>
                    <source>PLoS Comput Biol</source>
                    <volume>4</volume>
                    <fpage>e23</fpage>
                </element-citation>
            </ref>
        </ref-list>
        
    </back>
</article>