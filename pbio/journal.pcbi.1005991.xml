<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01568</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005991</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cell processes</subject><subj-group><subject>Cell death</subject><subj-group><subject>Apoptosis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Necrosis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Necrosis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cell processes</subject><subj-group><subject>Cell cycle and cell division</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cell motility</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>PhysiCell: An open source physics-based cell simulator for 3-D multicellular systems</article-title>
<alt-title alt-title-type="running-head">PhysiCell: Physics-based multicellular simulator</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ghaffarizadeh</surname> <given-names>Ahmadreza</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7440-2905</contrib-id>
<name name-style="western">
<surname>Heiland</surname> <given-names>Randy</given-names></name>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8003-6860</contrib-id>
<name name-style="western">
<surname>Friedman</surname> <given-names>Samuel H.</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Mumenthaler</surname> <given-names>Shannon M.</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9925-0151</contrib-id>
<name name-style="western">
<surname>Macklin</surname> <given-names>Paul</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Lawrence J. Ellison Institute for Transformative Medicine, University of Southern California, Los Angeles, California, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Intelligent Systems Engineering, Indiana University, Bloomington, Indiana, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Opto-Knowledge Systems, Inc., Torrance, California, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Poisot</surname> <given-names>Timothée</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Universite de Montreal, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>Samuel H. Friedman was employed at Opto-Knowledge Systems, Inc. (OKSI) during the review and revision of the manuscript. This work was not funded, evaluated, approved, or owned in any manner by OKSI, and there are no competing interests in OKSI. Furthermore, OKSI has no patents, commercial products, products in development, or marketed products related to this work. The other authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">macklinp@iu.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>2</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>23</day>
<month>2</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>2</issue>
<elocation-id>e1005991</elocation-id>
<history>
<date date-type="received">
<day>27</day>
<month>9</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>19</day>
<month>1</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Ghaffarizadeh et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005991"/>
<abstract>
<p>Many multicellular systems problems can only be understood by studying how cells move, grow, divide, interact, and die. Tissue-scale dynamics emerge from systems of many interacting cells as they respond to and influence their microenvironment. The ideal “virtual laboratory” for such multicellular systems simulates both the biochemical microenvironment (the “stage”) and many mechanically and biochemically interacting cells (the “players” upon the stage). PhysiCell—physics-based multicellular simulator—is an open source agent-based simulator that provides both the stage and the players for studying many interacting cells in dynamic tissue microenvironments. It builds upon a multi-substrate biotransport solver to link cell phenotype to multiple diffusing substrates and signaling factors. It includes biologically-driven sub-models for cell cycling, apoptosis, necrosis, solid and fluid volume changes, mechanics, and motility “out of the box.” The C++ code has minimal dependencies, making it simple to maintain and deploy across platforms. PhysiCell has been parallelized with OpenMP, and its performance scales linearly with the number of cells. Simulations up to 10<sup>5</sup>-10<sup>6</sup> cells are feasible on quad-core desktop workstations; larger simulations are attainable on single HPC compute nodes. We demonstrate PhysiCell by simulating the impact of necrotic core biomechanics, 3-D geometry, and stochasticity on the dynamics of hanging drop tumor spheroids and ductal carcinoma in situ (DCIS) of the breast. We demonstrate stochastic motility, chemical and contact-based interaction of multiple cell types, and the extensibility of PhysiCell with examples in synthetic multicellular systems (a “cellular cargo delivery” system, with application to anti-cancer treatments), cancer heterogeneity, and cancer immunology. PhysiCell is a powerful multicellular systems simulator that will be continually improved with new capabilities and performance improvements. It also represents a significant independent code base for replicating results from other simulation platforms. The PhysiCell source code, examples, documentation, and support are available under the BSD license at <ext-link ext-link-type="uri" xlink:href="http://PhysiCell.MathCancer.org" xlink:type="simple">http://PhysiCell.MathCancer.org</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://PhysiCell.sf.net" xlink:type="simple">http://PhysiCell.sf.net</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>This paper introduces PhysiCell: an open source, agent-based modeling framework for 3-D multicellular simulations. It includes a standard library of sub-models for cell fluid and solid volume changes, cycle progression, apoptosis, necrosis, mechanics, and motility. PhysiCell is directly coupled to a biotransport solver to simulate many diffusing substrates and cell-secreted signals. Each cell can dynamically update its phenotype based on its microenvironmental conditions. Users can customize or replace the included sub-models. PhysiCell runs on a variety of platforms (Linux, OSX, and Windows) with few software dependencies. Its computational cost scales linearly in the number of cells. It is feasible to simulate 500,000 cells on quad-core desktop workstations, and millions of cells on single HPC compute nodes. We demonstrate PhysiCell by simulating the impact of necrotic core biomechanics, 3-D geometry, and stochasticity on hanging drop tumor spheroids (HDS) and ductal carcinoma in situ (DCIS) of the breast. We demonstrate contact- and chemokine-based interactions among multiple cell types with examples in synthetic multicellular bioengineering, cancer heterogeneity, and cancer immunology. We developed PhysiCell to help the scientific community tackle multicellular systems biology problems involving many interacting cells in multi-substrate microenvironments. PhysiCell is also an independent, cross-platform codebase for replicating results from other simulators.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100001006</institution-id>
<institution>Breast Cancer Research Foundation</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9925-0151</contrib-id>
<name name-style="western">
<surname>Macklin</surname> <given-names>Paul</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000054</institution-id>
<institution>National Cancer Institute</institution>
</institution-wrap>
</funding-source>
<award-id>5U54CA143907</award-id>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000054</institution-id>
<institution>National Cancer Institute</institution>
</institution-wrap>
</funding-source>
<award-id>1R01CA180149</award-id>
</award-group>
<award-group id="award004">
<funding-source>
<institution>USC James H. Zumberge Research and Innovation Fund</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9925-0151</contrib-id>
<name name-style="western">
<surname>Macklin</surname> <given-names>Paul</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution>Jayne Koskinas Ted Giovanis Foundation for Health and Policy</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9925-0151</contrib-id>
<name name-style="western">
<surname>Macklin</surname> <given-names>Paul</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award006">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>1720625</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9925-0151</contrib-id>
<name name-style="western">
<surname>Macklin</surname> <given-names>Paul</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was funded by: USC Center for Applied Molecular Medicine: institutional support, no grant number, (<ext-link ext-link-type="uri" xlink:href="http://keck.usc.edu/applied-molecular-medicine-center/" xlink:type="simple">http://keck.usc.edu/applied-molecular-medicine-center/</ext-link>), USC James H. Zumberge Research and Innovation Fund (2012 Large Interdisciplinary Award): no grant number (URL: <ext-link ext-link-type="uri" xlink:href="http://research.usc.edu/for-investigators/funding/usc/zumberge/" xlink:type="simple">http://research.usc.edu/for-investigators/funding/usc/zumberge/</ext-link>), Breast Cancer Research Foundation: no grant number (URL: <ext-link ext-link-type="uri" xlink:href="http://bcrfcure.org" xlink:type="simple">http://bcrfcure.org</ext-link>), Jayne Koskinas Ted Giovanis Foundation for Health and Policy: no grant number, (URL: <ext-link ext-link-type="uri" xlink:href="http://jktgfoundation.org/" xlink:type="simple">http://jktgfoundation.org/</ext-link>), National Cancer Institute: grants 5U54CA143907, 1R01CA180149 (URL: <ext-link ext-link-type="uri" xlink:href="https://www.nih.gov/" xlink:type="simple">https://www.nih.gov/</ext-link>), National Science Foundation: grant 1720625 (URL: <ext-link ext-link-type="uri" xlink:href="https://nsf.gov" xlink:type="simple">https://nsf.gov</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="0"/>
<page-count count="31"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-03-07</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The code and data will be publicly available at <ext-link ext-link-type="uri" xlink:href="http://PhysiCell.SourceForge.net" xlink:type="simple">http://PhysiCell.SourceForge.net</ext-link>. High-resolution versions of the video files are available from both YouTube and figshare, at the links below: S1 Video (<ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=WMhYW9D4SqM" xlink:type="simple">https://www.youtube.com/watch?v=WMhYW9D4SqM</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5716600" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5716600</ext-link>), S2 Video (<ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=xrOqqJ_Exd4" xlink:type="simple">https://www.youtube.com/watch?v=xrOqqJ_Exd4</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5716597" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5716597</ext-link>), S3 Video (<ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=ntVKOr9poro" xlink:type="simple">https://www.youtube.com/watch?v=ntVKOr9poro</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5716480" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5716480</ext-link>), S4 Video (<ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=-lRot-dfwJk" xlink:type="simple">https://www.youtube.com/watch?v=-lRot-dfwJk</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.6084/m9.figshare.5721088.v1" xlink:type="simple">http://dx.doi.org/10.6084/m9.figshare.5721088.v1</ext-link>), S5 Video (<ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=NdjvXI_x8uE" xlink:type="simple">https://www.youtube.com/watch?v=NdjvXI_x8uE</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5721136" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5721136</ext-link>), S6 Video (<ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=wuDZ40jW__M" xlink:type="simple">https://www.youtube.com/watch?v=wuDZ40jW__M</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5721145" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5721145</ext-link>), S7 Video (<ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=bPDw6l4zkF0" xlink:type="simple">https://www.youtube.com/watch?v=bPDw6l4zkF0</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5721151" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5721151</ext-link>), S8 Video (<ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=nJ2urSm4ilU" xlink:type="simple">https://www.youtube.com/watch?v=nJ2urSm4ilU</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5717887" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5717887</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a PLoS Computational Biology Software paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Many significant multicellular systems problems—such as tissue engineering, evolution in bacterial colonies, and tumor metastasis—can only be understood by studying how individual cells grow, divide, die, move, and interact [<xref ref-type="bibr" rid="pcbi.1005991.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005991.ref005">5</xref>]. Tissue-scale dynamics emerge as cells are influenced by biochemical and biophysical signals in the microenvironment, even as the cells continually remodel the microenvironment. Thus, the ideal “virtual laboratory” for multicellular systems biology must simultaneously simulate (1) tissue microenvironments with multiple diffusing chemical signals (e.g., oxygen, drugs, and signaling factors), and (2) the dynamics of many mechanically and biochemically interacting cells [<xref ref-type="bibr" rid="pcbi.1005991.ref005">5</xref>]. We recently published and open sourced the first part of such a platform: BioFVM, a biotransport solver that can efficiently simulate secretion, diffusion, uptake, and decay of multiple substrates in large 3-D microenvironments, even on desktop workstations [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>]. We now introduce and release as open source PhysiCell: a mechanistic off-lattice agent-based model that extends BioFVM to simulate the tissue-scale behaviors that emerge from basic biological and biophysical cell processes.</p>
<sec id="sec002">
<title>Prior work</title>
<p>Several major computational frameworks are available for studying 3-D multicellular systems. CompuCell3D [<xref ref-type="bibr" rid="pcbi.1005991.ref007">7</xref>] and Morpheus [<xref ref-type="bibr" rid="pcbi.1005991.ref008">8</xref>] use Cellular Potts methods to simulate cells and their morphologies. They are very user-friendly packages with graphical model editors, integrated ODE and PDE solvers, and support for molecular-scale sub-models, but they currently cannot scale to large numbers (10<sup>5</sup> or more) of cells. TiSim (part of the CellSys package [<xref ref-type="bibr" rid="pcbi.1005991.ref009">9</xref>]) can simulate many more cells by using a cell-centered, off-lattice approach. However, it is currently closed source, and its executables are restricted to a limited set of simulation types. Chaste [<xref ref-type="bibr" rid="pcbi.1005991.ref010">10</xref>] is a powerful, well-developed framework for multicellular modeling with integrated PDE and ODE solvers, and both cell- and vertex-based simulations of 10<sup>5</sup> or more cells. However, its complex codebase has many dependencies that can impede participation by new developers; it is only cross-platform compatible by virtual machines. Biocellion [<xref ref-type="bibr" rid="pcbi.1005991.ref011">11</xref>] can simulate billions of cells on cluster computers, but it is closed source, and its restrictive user license has hindered adoption. Timothy was recently developed to simulate large-scale colonies of 10<sup>9</sup> cells on high-performance supercomputers [<xref ref-type="bibr" rid="pcbi.1005991.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref013">13</xref>]. Most of these platforms offer a general-purpose pre-compiled “client” that can load models and settings from an XML file; this helps overcome difficulties stemming from complex dependencies. See <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref> for a detailed software comparison.</p>
<p>These platforms typically require users to write their own code for all cell activities, by scripting basic built-in functions. (e.g., build a cell cycle model from API functions to overwrite cell volume and duplicate agents when appropriate.) As configured “out of the box,” none have built-in models for cell cycling, apoptosis, and necrosis, even though these fundamental behaviors are needed in many multicellular simulations. Only CompuCell3D and Morpheus have built-in volume regulation features. Most of these packages include PDE solvers that can simulate 3-D biotransport of one or more diffusible factors in the microenvironment, but generally they are applied sequentially to one PDE at a time, meaning that solving 10 PDEs requires 10 times more computational work than solving a single PDE. This approach is not expected to efficiently scale to 3-D simulations with many diffusible factors—a key requirement in reconciling secretomics with single-cell and multicellular systems biology, particularly as we work to understand cell-cell communication involving many cell-secreted factors.</p>
</sec>
<sec id="sec003">
<title>Scientific design goals and use cases</title>
<p>We aim to create a framework for building multicellular simulations that investigate the relationship between (diffusional) substrate limitations, multicellular biochemical communication, and essential phenotypic processes: cell cycling/division, death, volume changes, motility, adhesion, and volume exclusion/“repulsion” [<xref ref-type="bibr" rid="pcbi.1005991.ref001">1</xref>]. Building upon our experiences in agent-based modeling [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1005991.ref016">16</xref>], we seek a system with a minimal set of mechanics to avoid cell lattice effects [<xref ref-type="bibr" rid="pcbi.1005991.ref002">2</xref>]; hence we use an off-lattice model with basic cell adhesion and “repulsion” implemented as simple potential functions [<xref ref-type="bibr" rid="pcbi.1005991.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>]. Following our work in [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1005991.ref016">16</xref>], we include basic models of gradual cell volume changes, rather than static cell volumes. This avoids non-physical “jumps” in cell velocity following cell division events: the sudden localized doubling of cell density causes cells to overlap, leading to large, temporary, and non-physical “repulsive” forces that can manifest as non-physical “tears” in simulated tissues.</p>
<p>While PhysiCell was originally developed for problems in cancer [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>], its diffusional and phenotypic processes are not specific to cancer. Users can introduce new environmental substrates (e.g., extracellular matrix (ECM) as a substrate with zero diffusion coefficient), new cell types (e.g., fibroblasts with high motility, low proliferation, and secretion and degradation of ECM), or new systems of cells (e.g., a network of vascular agents that release oxygen as in [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>], and that can divide and move along gradients of angiogenic growth factors). Modelers can also use PhysiCell’s core functions to create new libraries that simulate physiological systems, similar to how Microvessel Chaste [<xref ref-type="bibr" rid="pcbi.1005991.ref017">17</xref>] built upon the core functions of Chaste [<xref ref-type="bibr" rid="pcbi.1005991.ref010">10</xref>] to simulate new classes of problems in vascular remodeling. In <bold>Additional PhysiCell examples</bold>, we use PhysiCell’s basic building blocks to simulate synthetic multicellular systems, heterogeneous tumors, and the innate immune system as it interacts with tumor cells. As we continue to apply PhysiCell to our own work in tissue engineering, angiogenesis, microbial dynamics, and cancer, we plan to release new optional modules that introduce new capabilities and simplify modeling of <italic>in vivo</italic> tissues and other systems. See <xref ref-type="sec" rid="sec035">Availability and future directions</xref>.</p>
<p>Thus, PhysiCell is designed to be a general-purpose toolkit for exploring multicellular systems, and the multicellular behaviors that emerge from a user-implemented set of cell phenotypic rules (i.e., a set of hypotheses). Other potential uses include simulation-generated synthetic datasets that investigate the meaning and shortcomings of experimental measurements [<xref ref-type="bibr" rid="pcbi.1005991.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref019">19</xref>]. PhysiCell’s design has allowed straightforward deployment on supercomputers for high-throughput simulation studies. We recently explored over 250 instances of a 3-D cancer-immune model (see <bold>Additional PhysiCell examples</bold>) to study the impact of immune cell motility and cancer-immune adhesion dynamics on a cancer immune response, thus reducing 1.5 years’ worth of simulations to 2 days on a Cray supercomputer [<xref ref-type="bibr" rid="pcbi.1005991.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref021">21</xref>]. We anticipate that users can similarly use PhysiCell to efficiently explore large spaces of parameter values and hypotheses (model rules) with biophysically realistic, 3-D models. In Fall 2017, we started using PhysiCell in undergraduate and graduate education, as a self-contained tool for computational tissue engineering and cancer systems engineering. Lastly, PhysiCell also serves as an independent codebase to cross-validate model predictions in Chaste, Biocellion, TiSim, Timothy, and other platforms.</p>
</sec>
<sec id="sec004">
<title>Computational design goals</title>
<p>PhysiCell aims to balance computational speed, built-in standard functionality, flexibility, and codebase simplicity. It includes a built-in library of standardized cell cycle and cell death models co-developed with biologists and modelers here and in the MultiCellDS standardization process [<xref ref-type="bibr" rid="pcbi.1005991.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref023">23</xref>], force-based cell-cell interaction mechanics, motility, and volume regulation. Users can replace any of these built-in models with their own, and they can dynamically assign custom functions to any agent at any time. Through BioFVM, PhysiCell can couple cell phenotype to many diffusible substrates. It is the only simulation package to explicitly model the cell’s fluid content—a key aspect in problems such as cryobiology [<xref ref-type="bibr" rid="pcbi.1005991.ref024">24</xref>]. It can simulate systems of 10<sup>5</sup>-10<sup>6</sup> cells on desktop workstations, and 10<sup>6</sup> or more cells on single HPC compute nodes. All this functionality and performance is achieved with only two external dependencies, and a fully cross-platform C++ codebase that we have compiled and tested on Linux, OSX, and Windows. We also distribute PhysiCell as a virtual appliance—with a full Linux desktop, 64-bit <monospace>g++</monospace> compiler, and visualization tools—that can run in widespread virtual machine software like VirtualBox.</p>
</sec>
</sec>
<sec id="sec005" sec-type="materials|methods">
<title>Design and implementation</title>
<p>PhysiCell is designed to study the dynamics and interactions of thousands or millions of cells in 3-D microenvironments, with microenvironment-dependent phenotypes. It uses a lattice-free, physics-based approach to reduce grid-based artifacts. It provides optimized, biologically realistic functions for key cell behaviors, including: cell cycling (multiple models for <italic>in vitro</italic> and <italic>in vivo</italic>-focused simulations), cell death (apoptosis and necrosis), volume regulation (fluid and solid biomass; nuclear and cytoplasmic sub-volumes), motility, and cell-cell mechanical interactions. Each cell agent is built with a hierarchical <monospace>Phenotype</monospace> data structure; key phenotypic processes are triggered and controlled by modifying the phenotype data. This allows users to focus on modeling microenvironment-dependent triggers of standard cell processes, rather than coding these basic processes. However, to maintain flexibility, PhysiCell is written in a modular manner so that users can extend, rewrite, or replace its functions. Users can also create custom rules, and assign them to individual agents. It is fully coupled to a fast multi-substrate diffusion code (BioFVM) that solves for vectors of diffusing substrates, so that users can tie cell phenotype to many diffusing signals.</p>
<p>We note that for many problems in cancer biology and tissue engineering that drove development of PhysiCell, diffusive biotransport occurs at relatively fast time scales (on the order of 0.1 min or faster) compared to cell mechanics (∼ 1 min) and cell processes (∼ 10 to 100 min or slower). PhysiCell takes advantage of this by using three separate time step sizes (Δ<italic>t</italic><sub>diff</sub>, Δ<italic>t</italic><sub>mech</sub>, and Δ<italic>t</italic><sub>cells</sub>). In particular, the cell phenotypes and arrangement (operating on slow time scales) can be treated as quasi-static when advancing the solution to the biotransport PDEs, so BioFVM can be called without modification with the cell arrangements fixed. See <bold>Time steps</bold> for further discussion. We provide default time step sizes that should suffice for typical applications in cancer biology and tissue engineering. Problems with inherently different time scales (e.g., advection-dominated problems, or with fast-moving bacteria) will need to adjust the time steps accordingly to avoid spurious oscillations that would be expected if cell-based sources and sinks are moving relatively quickly.</p>
<p>PhysiCell was built by extending the <monospace>Basic_Agent</monospace> class in BioFVM [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>] (a static, non-moving object that can secrete and uptake substrates) into a fully dynamic <monospace>Cell</monospace> class with changing cell volume, cycle progression, death processes, motility, and mechanics. This allows the cells to directly and efficiently interface with the multi-substrate microenvironment. PhysiCell is written in cross-platform compatible C++ and is self-contained (with minimal dependencies). It can be compiled in any C++11 compiler with OpenMP support. This simplifies installation and improves the reproducibility of the experiments. We have tested PhysiCell on Windows through MinGW-w64, and on OSX and Linux via <monospace>g++</monospace>. (OSX users should note that Xcode does not include a compliant OpenMP-compatible <monospace>g++</monospace>; they should follow our tutorials for installing a compliant <monospace>g++</monospace> via Homebrew or MacPorts. See <ext-link ext-link-type="uri" xlink:href="http://MathCancer.org/blog/physicell-tutorials/" xlink:type="simple">http://MathCancer.org/blog/physicell-tutorials/</ext-link>.) PhysiCell’s only external dependencies are pugixml [<xref ref-type="bibr" rid="pcbi.1005991.ref025">25</xref>] (for XML parsing) and BioFVM [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>] for 3-D multi-substrate diffusion. For the user’s convenience, compatible versions of pugixml and BioFVM are included in every download.</p>
<p>The code has been parallelized in OpenMP to make use of multi-core desktop workstations and single HPC compute nodes. In testing, its performance (the computational time to simulate a fixed amount of time on a fixed domain) scales linearly in the number of cells present in the simulation. Simulations of up to 10<sup>6</sup> cells are feasible on desktop workstations, and simulations beyond 10<sup>6</sup> cells are possible on typical HPC compute nodes.</p>
<sec id="sec006">
<title>Overall program flow</title>
<p>After initializing the microenvironment (through BioFVM [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>]) and cells, and initializing the current simulation time <italic>t</italic> = 0, PhysiCell tracks (internally) <italic>t</italic><sub>mech</sub> (the next time at which cell mechanics functions are run), <italic>t</italic><sub>cells</sub> (the next time at which cell processes are run), and <italic>t</italic><sub>save</sub> (the next simulation data output time), with output frequency Δ<italic>t</italic><sub>save</sub>. Initially, we set:
<disp-formula id="pcbi.1005991.e001"><alternatives><graphic id="pcbi.1005991.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="8pt"/><mml:msub><mml:mi>t</mml:mi> <mml:mtext>cells</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>cells</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="8pt"/><mml:msub><mml:mi>t</mml:mi> <mml:mtext>save</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
PhysiCell repeats the main program loop until reaching the maximum simulation time:</p>
<list list-type="order">
<list-item>
<p>Save the simulation state if <italic>t</italic> ≥ <italic>t</italic><sub>save</sub>. Set <italic>t</italic><sub>save</sub> = <italic>t</italic><sub>save</sub> + Δ<italic>t</italic><sub>save</sub>.</p>
</list-item>
<list-item>
<p>Run BioFVM to update the biochemical microenvironment for cell-based secretions and uptake, and reaction-diffusion, for the current fixed cell positions. See <bold>Biochemical microenvironment</bold>.</p>
</list-item>
<list-item>
<p>For the fixed cell positions and chemical substrate fields, if <italic>t</italic> ≥ <italic>t</italic><sub>cells</sub>, run the cell processes for each cell:</p>
<list list-type="alpha-lower">
<list-item>
<p>Update cell parameters using the cell’s <monospace>update_phenotype</monospace> functions. See <bold>Cell characteristics and state</bold>.</p>
</list-item>
<list-item>
<p>Advance the cell cycle (or death) model. See <bold>Cell cycling</bold> and <bold>Cell death</bold>.</p>
</list-item>
<list-item>
<p>Advance the cell’s volume (and sub-volumes) using the <monospace>volume_update_function</monospace>. See <bold>Cell volume</bold>.</p>
</list-item>
</list>
<p>Then set <italic>t</italic><sub>cells</sub> = <italic>t</italic><sub>cells</sub> + Δ<italic>t</italic><sub>cells</sub>.</p>
</list-item>
<list-item>
<p>If <italic>t</italic> ≥ <italic>t</italic><sub>mech</sub>, then:</p>
<list list-type="alpha-lower">
<list-item>
<p>For each cell, calculate the force-based cell velocities via <monospace>update_velocity</monospace>, add the contribution of motility (which runs <monospace>update_migration_bias</monospace> as needed), and run the custom function <monospace>custom_cell_rule</monospace>. See <bold>Cell motility</bold> and <bold>Cell mechanics and motion</bold>.</p>
</list-item>
<list-item>
<p>For each cell, update the position using the Adams-Bashforth method. See <bold>Cell mechanics and motion</bold>.</p>
</list-item>
</list>
<p>Set <italic>t</italic><sub>mech</sub> = <italic>t</italic><sub>mech</sub> + Δ<italic>t</italic><sub>mech</sub>.</p>
</list-item>
<list-item>
<p>Update the current simulation time by <italic>t</italic> = <italic>t</italic> + Δ<italic>t</italic><sub>diff</sub>. Return to Step 1.</p>
</list-item>
</list>
<p specific-use="continuation">Steps 3a-c can be combined in a parallelized OpenMP loop; we flag cells for division and removal and process these queues serially after the parallel loop to avoid data corruption. Step 4a can be parallelized across the cells by OpenMP (because cell velocities are location-dependent, and the cell positions are fixed throughout 4a), and then Step 4b can be parallelized across the cells with these computed velocities.</p>
</sec>
<sec id="sec007">
<title>Biochemical microenvironment</title>
<p>We use BioFVM to simulate the chemical microenvironment with a vector of reaction-diffusion PDEs with both bulk source/sinks and cell-centered sources and sinks [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>]. To briefly summarize that prior work, we model the biochemical microenvironment (with computational domain Ω and boundary ∂Ω, discretized as a Cartesian mesh for computational efficiency) as a vector of reaction-diffusion PDEs for a vector of chemical substrates <bold><italic>ρ</italic></bold> of the form
<disp-formula id="pcbi.1005991.e002"><alternatives><graphic id="pcbi.1005991.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi mathvariant="bold-italic">ρ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mover><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">D</mml:mi> <mml:msup><mml:mo>∇</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mi mathvariant="bold-italic">ρ</mml:mi></mml:mrow> <mml:mo>︷</mml:mo></mml:mover> <mml:mtext>diffusion</mml:mtext></mml:mover> <mml:mo>-</mml:mo> <mml:mover><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">λ</mml:mi> <mml:mi mathvariant="bold-italic">ρ</mml:mi></mml:mrow> <mml:mo>︷</mml:mo></mml:mover> <mml:mtext>decay</mml:mtext></mml:mover> <mml:mo>+</mml:mo> <mml:mover><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">ρ</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold-italic">ρ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>︷</mml:mo></mml:mover> <mml:mrow><mml:mtext>bulk</mml:mtext><mml:mspace width="1pt"/><mml:mtext>source</mml:mtext></mml:mrow></mml:mover> <mml:mo>-</mml:mo> <mml:mover><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">U</mml:mi> <mml:mi mathvariant="bold-italic">ρ</mml:mi></mml:mrow> <mml:mo>︷</mml:mo></mml:mover> <mml:mrow><mml:mtext>bulk</mml:mtext><mml:mspace width="1pt"/><mml:mtext>uptake</mml:mtext></mml:mrow></mml:mover></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo> <mml:mover><mml:mover accent="true"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mtext>cells</mml:mtext> <mml:mspace width="1pt"/><mml:mi>k</mml:mi></mml:mrow></mml:munder> <mml:mi>δ</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>[</mml:mo> <mml:msub><mml:mi mathvariant="bold">S</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">ρ</mml:mi></mml:mrow> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold-italic">ρ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">U</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mi mathvariant="bold-italic">ρ</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>︷</mml:mo></mml:mover> <mml:mrow><mml:mtext>sources</mml:mtext> <mml:mspace width="1pt"/><mml:mtext>and</mml:mtext> <mml:mspace width="1pt"/><mml:mtext>uptake</mml:mtext> <mml:mspace width="1pt"/><mml:mtext>by</mml:mtext> <mml:mspace width="1pt"/><mml:mtext>cells</mml:mtext></mml:mrow></mml:mover> <mml:mspace width="1pt"/><mml:mtext>in</mml:mtext> <mml:mo>Ω</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
with zero flux conditions on ∂Ω. Here, <italic>δ</italic>(<bold>x</bold>) is the Dirac delta function, <bold>x</bold><sub><italic>k</italic></sub> is the <italic>k</italic><sup><italic>th</italic></sup> cell’s position, <italic>W</italic><sub><italic>k</italic></sub> is its volume, <bold>S</bold><sub><italic>k</italic></sub> is its vector of source rates, <bold>U</bold><sub><italic>k</italic></sub> is its vector of uptake rates, and <bold><italic>ρ</italic></bold>* is the vector of saturation densities (the densities at which the cells stop secreting). Likewise, <bold>D</bold> and <bold>λ</bold> are the vectors of diffusion coefficients and decay rates, <bold>S</bold> is the bulk supply rate, and <bold>U</bold> is the bulk uptake function. All vector-vector products <bold>ab</bold> are element-wise (Hadamard product).</p>
<p>Numerically, we solve for the solution at time <italic>t</italic> + Δ<italic>t</italic><sub>diff</sub> by a first-order operator splitting: we first solve the bulk source/sink terms across the domain (and overwrite the stored solution), then solve the cell-centered source/sink terms (and overwrite the solution), and then the reaction-diffusion terms (again, overwriting the stored solutions). As we detailed and verified in [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>], because we used (numerically stable) first-order backward differences in all our time discretizations, the overall method is first-order accurate in time and numerically stable.</p>
<p>After this operator splitting, the bulk source/sink terms are a decoupled set of systems of ODEs (one vector of ODEs in each computational voxel), which we solve by the backwards Euler method for first-order accuracy and numerical stability. This is trivially parallelized by OpenMP by dividing the voxels across the processor cores. Similarly, we solve the cell-based source/sink equations (one system of ODEs per cell) by backwards-Euler, overwriting the solution in the voxel containing the cell’s center. As we showed in [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>], this is first-order accurate and numerically stable, and it performs best when the computational voxels are comparable to the cells’ sizes or larger. In all our work, we satisfy this requirement by using 20 <italic>μ</italic>m voxels. As with the bulk source/sinks, we trivially parallelize by dividing the cell source/sinks (one system of ODEs per cell) across the processor cores with OpenMP.</p>
<p>To solve the vector of diffusion-decay PDEs, we use the locally one-dimensional method: a specialized operator splitting that turns the 3-D PDEs into a sequence of one-dimensional PDEs. In each <italic>x</italic>-strip, <italic>y</italic>-strip, or <italic>z</italic>-strip, we discretize the PDEs with second-order centered differences (spatial derivatives) and first-order backwards differences (time derivatives) to obtain a tridiagonal linear system in each strip, which we solve exactly with a tailored Thomas solver. The Thomas solver itself cannot be trivially parallelized, but because we have many simultaneous <italic>x</italic>-, <italic>y</italic>-, and <italic>z</italic>-strips, we can distribute many instances of the Thomas solver across processor cores by OpenMP. This technique, along with other optimizations (tailored overloaded vector operators, a vectorized Thomas solver, pre-computing and caching the forward sweeps of the Thomas solvers, and other similar optimizations) was tested to scale linearly in the number of substrates (number of PDEs), the number of computational voxels, and the number of discrete cell sources/sinks. The method was numerically stable even for large Δ<italic>t</italic>, first-order accurate in time, and second-order accurate in space. Simulating 10 PDEs on 1,000,000 voxels takes approximately 2.6 times more computational time than simulating a single PDE. We found that for typical magnitudes of <bold>D</bold>, <bold>S</bold>, <bold>U</bold>, and <bold>λ</bold>, using Δ<italic>t</italic><sub>diff</sub> = 0.01 min and Δ<italic>x</italic> = 20 <italic>μ</italic>m gave solutions with 5% relative accuracy or better. For more algorithmic detail and extensive convergence testing on a variety of problems, see [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>] and its supplementary material.</p>
</sec>
<sec id="sec008">
<title>Agent-based cell model</title>
<p>PhysiCell implements key cell-scale processes—cell cycling and death, volume changes, mechanics, and motility—and lets users link the parameters of these processes to microenvironmental conditions. PhysiCell then scales these basic cell-scale hypotheses to simulate thousands or millions of cells, from which tissue-scale behavior emerges. Here, we summarize the key functions. For each sub-model, see <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref> for the full equations, further biological motivation, and reference parameter values.</p>
<sec id="sec009">
<title>Cell characteristics and state</title>
<p>Cell agents have a variety of phenotypic properties, including position (<bold>x</bold><sub><italic>i</italic></sub>), volume (and sub-volumes), cell cycle or death status, and mechanics (adhesive, deformation, and motility) parameters. Each cell has a hierarchically-structured, independent <monospace>Phenotype</monospace> object that organizes information on cell cycling, death, volume, geometry, mechanics, motility, and secretion. Each cell also has an independent <monospace>Cell_Functions</monospace> object that collects functions to update cell volume, motility, velocity (mechanics), and other properties. See the User Guide (<xref ref-type="supplementary-material" rid="pcbi.1005991.s002">S2 Text</xref>, included in every PhysiCell download Version 1.2.0 or later) for a list of all the cell agents’ attributes and functions to access/update them. Below, we describe standardized, built-in models to update these properties. The models can be replaced by user-defined functions; the supplied models serve as biophysically reasonable default functions that capture the key aspects of these processes.</p>
</sec>
<sec id="sec010">
<title>Cell volume</title>
<p>Each cell tracks <italic>V</italic> (total volume), <italic>V</italic><sub>F</sub> (total fluid volume), <italic>V</italic><sub>S</sub> (total solid volume), <italic>V</italic><sub>NS</sub> (nuclear solid volume), <italic>V</italic><sub>CS</sub> (cytoplasmic solid volume), <italic>V</italic><sub>N</sub> (total nuclear volume), and <italic>V</italic><sub>C</sub> (total cytoplasmic volume). Key parameters include nuclear solid, cytoplasmic solid, and fluid rate change parameters (<italic>r</italic><sub>N</sub>, <italic>r</italic><sub>C</sub>, and <italic>r</italic><sub>F</sub>), the cell’s “target” fluid fraction <italic>f</italic><sub>F</sub>, target solid volume <inline-formula id="pcbi.1005991.e003"><alternatives><graphic id="pcbi.1005991.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msubsup><mml:mi>V</mml:mi> <mml:mtext>NS</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, and target cytoplasmic to nuclear volume ratio <italic>f</italic><sub>CN</sub>. For each cell, these volumes are modeled with a system of ODEs:
<disp-formula id="pcbi.1005991.e004"><alternatives><graphic id="pcbi.1005991.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>V</mml:mi> <mml:mi mathvariant="normal">F</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi mathvariant="normal">F</mml:mi></mml:msub> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi mathvariant="normal">F</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi mathvariant="normal">F</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula> <disp-formula id="pcbi.1005991.e005"><alternatives><graphic id="pcbi.1005991.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>V</mml:mi> <mml:mtext>NS</mml:mtext></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi mathvariant="normal">N</mml:mi></mml:msub> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mtext>NS</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mtext>NS</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula> <disp-formula id="pcbi.1005991.e006"><alternatives><graphic id="pcbi.1005991.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>V</mml:mi> <mml:mtext>CS</mml:mtext></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi mathvariant="normal">C</mml:mi></mml:msub> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mtext>CS</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mtext>CS</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where we use the constitutive laws
<disp-formula id="pcbi.1005991.e007"><alternatives><graphic id="pcbi.1005991.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mtext>CS</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mtext>CN</mml:mtext></mml:msub> <mml:msubsup><mml:mi>V</mml:mi> <mml:mtext>NS</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula> <disp-formula id="pcbi.1005991.e008"><alternatives><graphic id="pcbi.1005991.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mi mathvariant="normal">F</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mi mathvariant="normal">F</mml:mi></mml:msub> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
These parameters are updated as the cell progresses through its current cycle or death process. (See <bold>Cell cycling</bold> and <bold>Cell death</bold>.) For example, we halve <inline-formula id="pcbi.1005991.e009"><alternatives><graphic id="pcbi.1005991.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mi>V</mml:mi> <mml:mtext>NS</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> after a cell division and double it upon re-entry to the cell cycle. We set <inline-formula id="pcbi.1005991.e010"><alternatives><graphic id="pcbi.1005991.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mtext>NS</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mtext>CN</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> at the onset of apoptosis, and we set <italic>r</italic><sub>F</sub>, <italic>r</italic><sub>C</sub>, and <italic>r</italic><sub>N</sub> based on key apoptosis time scales. See <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref> for the full equations, sample solution plots, further biological motivation, convergence testing, and reference parameter values. These ODEs are numerically solved using first-order forward Euler discretizations.</p>
</sec>
<sec id="sec011">
<title>Cell motility</title>
<p>Each cell can set its own persistence time (<italic>T</italic><sub>per</sub>), migration speed (<italic>s</italic><sub>mot</sub>), migration bias direction (<bold>d</bold><sub>bias</sub>, a unit vector), and a migration bias <italic>b</italic> that ranges from 0 (Brownian motion) to 1 (deterministic motion along <bold>d</bold><sub>bias</sub>). When updating the cell’s velocity, its migration velocity <bold>v</bold><sub>mot</sub> is added to the currently velocity (as calculated by mechanics; see <bold>Cell mechanics and motion</bold>). The cell changes its migration velocity stochastically between <italic>t</italic> and <italic>t</italic> + Δ<italic>t</italic><sub>mech</sub> with probability
<disp-formula id="pcbi.1005991.e011"><alternatives><graphic id="pcbi.1005991.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Prob</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>change</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mtext>mot</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub></mml:mrow> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>per</mml:mtext></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
The user-defined function <monospace>update_migration_bias</monospace> (see the User Guide <xref ref-type="supplementary-material" rid="pcbi.1005991.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1</xref> Text) sets <bold>v</bold><sub>bias</sub>, <italic>b</italic>, and <italic>s</italic><sub>mot</sub>. The migration velocity <bold>v</bold><sub>mot</sub> is then updated according to
<disp-formula id="pcbi.1005991.e012"><alternatives><graphic id="pcbi.1005991.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mtext>mot</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mtext>mot</mml:mtext></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">ξ</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>d</mml:mi></mml:mstyle><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">ξ</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>d</mml:mi></mml:mstyle><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow></mml:msub></mml:mrow> <mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
where <bold><italic>ξ</italic></bold> is a random unit vector. See the user manual (<xref ref-type="supplementary-material" rid="pcbi.1005991.s002">S2 Text</xref>) and <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref> for more details, as well as examples for biased migration along chemical gradients.</p>
</sec>
<sec id="sec012">
<title>Cell mechanics and motion</title>
<p>We model cell mechanics and motion as in our prior work [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>]: we update each cell’s position <bold>x</bold><sub><italic>i</italic></sub> by calculating its current velocity <bold>v</bold><sub><italic>i</italic></sub> based upon the balance of forces acting upon it. The main forces include cell motility, drag-like forces, and cell-cell and cell-matrix interaction forces: adhesion and “repulsion” (resistance to deformation and/or volume exclusion [<xref ref-type="bibr" rid="pcbi.1005991.ref026">26</xref>]). As in prior cell-centered models [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref028">28</xref>], we apply an inertialess assumption (<inline-formula id="pcbi.1005991.e013"><alternatives><graphic id="pcbi.1005991.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mover accent="true"><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>≈</mml:mo> <mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>) to explicitly solve for each cell’s velocity. As before [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>], we model adhesion and repulsion with interaction potentials that depend upon each cell’s size, maximum adhesion distance, adhesion and repulsion parameters, and distance to other cells. The cell’s velocity <bold>v</bold><sub><italic>i</italic></sub> is given by
<disp-formula id="pcbi.1005991.e014"><alternatives><graphic id="pcbi.1005991.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="1pt"/></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mspace width="1pt"/><mml:mo>=</mml:mo> <mml:mspace width="1pt"/></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1pt"/><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mover><mml:mover accent="true"><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mtext>cca</mml:mtext> <mml:mi>i</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>c</mml:mi> <mml:mtext>cca</mml:mtext> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:msqrt> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>︷</mml:mo></mml:mover> <mml:mrow><mml:mtext>cell</mml:mtext><mml:mo>-</mml:mo><mml:mtext>cell</mml:mtext><mml:mspace width="1pt"/><mml:mtext>adhesion</mml:mtext></mml:mrow></mml:mover><mml:mo>-</mml:mo> <mml:mover><mml:mover accent="true"><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mtext>ccr</mml:mtext> <mml:mi>i</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>c</mml:mi> <mml:mtext>ccr</mml:mtext> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:msqrt> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>︷</mml:mo></mml:mover> <mml:mrow><mml:mtext>cell</mml:mtext><mml:mo>-</mml:mo> <mml:mtext>cell</mml:mtext><mml:mspace width="1pt"/><mml:mtext>repulsion</mml:mtext></mml:mrow></mml:mover> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:mover><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mtext>cba</mml:mtext> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>d</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="bold">n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>︷</mml:mo></mml:mover> <mml:mrow><mml:mtext>cell</mml:mtext> <mml:mo>-</mml:mo> <mml:mtext>BM</mml:mtext><mml:mspace width="1pt"/><mml:mtext>adhesion</mml:mtext></mml:mrow></mml:mover> <mml:mo>-</mml:mo> <mml:mover><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mtext>cbr</mml:mtext> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>d</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="bold">n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>︷</mml:mo></mml:mover> <mml:mrow><mml:mtext>cell</mml:mtext> <mml:mo>-</mml:mo> <mml:mtext>BM</mml:mtext><mml:mspace width="1pt"/><mml:mtext>repulsion</mml:mtext></mml:mrow></mml:mover> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>mot</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where as in [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>], <italic>ϕ</italic><sub><italic>n</italic>,<italic>R</italic></sub>(<bold>x</bold>) is an adhesion interaction potential function which is zero for ‖<bold>x</bold>‖ &gt; <italic>R</italic>, and approaches zero with smoothness given by <italic>n</italic>. Similarly, <italic>ψ</italic><sub><italic>n</italic>,<italic>R</italic></sub>(<bold>x</bold>) is a repulsion interaction potential function that is zero for ‖<bold>x</bold>‖ &gt; <italic>R</italic>. Thus, cell-cell mechanical interactions occur over finite distances. Here, <inline-formula id="pcbi.1005991.e015"><alternatives><graphic id="pcbi.1005991.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msubsup><mml:mi>c</mml:mi> <mml:mtext>cca</mml:mtext> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005991.e016"><alternatives><graphic id="pcbi.1005991.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>c</mml:mi> <mml:mi>r</mml:mi></mml:mrow> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are the <italic>i</italic><sup><italic>th</italic></sup> cell’s cell-cell adhesion and repulsion parameters, <italic>R</italic><sub><italic>i</italic></sub> is its radius, and <italic>R</italic><sub><italic>i</italic>,<italic>A</italic></sub> is its maximum adhesion distance (typically a fixed multiple of <italic>R</italic><sub><italic>i</italic></sub>). Note that if cell <italic>i</italic> and <italic>j</italic> have identical cell-cell adhesion and repulsion parameters <italic>c</italic><sub>cca</sub> and <italic>c</italic><sub>ccr</sub>, then the cell-cell interaction coefficients simplify to the form we published in [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>]; otherwise, this is a phenomenologic form that allows either cell’s coefficient to affect the cell-cell interaction strength, with equal and opposite effect on both cells. We plan future improvements to move beyond the current phenomenologic forms to more mechanistic models.</p>
<p>Also, <italic>d</italic>(<bold>x</bold>) is the distance to the nearest basement membrane (if any), <bold>n</bold>(<bold>x</bold>) is a unit vector normal to the basement membrane, and so −<italic>d</italic>(<bold>x</bold><sub><italic>i</italic></sub>)<bold>n</bold>(<bold>x</bold><sub><italic>i</italic></sub>) points from the cell’s position <bold>x</bold><sub><italic>i</italic></sub> to the nearest point on the basement membrane, located at <bold>x</bold><sub><italic>i</italic></sub> − <italic>d</italic>(<bold>x</bold><sub><italic>i</italic></sub>)<bold>n</bold>(<bold>x</bold><sub><italic>i</italic></sub>). (See [<xref ref-type="bibr" rid="pcbi.1005991.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1005991.ref031">31</xref>] for more information on level set (distance function) representations of surfaces, there applied to tumor growth models.) <inline-formula id="pcbi.1005991.e017"><alternatives><graphic id="pcbi.1005991.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the (finite) list of cells that could potentially interact with cell <italic>i</italic>. (See <bold>Key code optimizations</bold>.) Further references and the full forms of the potential functions are given in <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref>.</p>
<p>The cell’s position is updated using the second-order Adam’s Bashforth discretization:
<disp-formula id="pcbi.1005991.e018"><alternatives><graphic id="pcbi.1005991.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub> <mml:mo>(</mml:mo> <mml:mn>3</mml:mn> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula></p>
</sec>
<sec id="sec013">
<title>Cell cycling</title>
<p>PhysiCell includes a cell cycle modeling framework, where each cell cycle model is a collection of phases {<italic>X</italic><sub><italic>i</italic></sub>}, transition rates {<italic>r</italic><sub><italic>ij</italic></sub>} between the phases, and a cell division phase transition. As of Version 1.2.0, users can also set phase entry and exit functions (associated with the phases <italic>X</italic><sub><italic>i</italic></sub>) that are executed at entry into or exit from the phase; these can be used to model processes such as mutation of cell parameters. The framework also allows users to set arrest functions (associated with the transition rates <italic>r</italic><sub><italic>ij</italic></sub>) that block the transition. This is useful for modeling effects like volume restrictions. See the User Guide (<xref ref-type="supplementary-material" rid="pcbi.1005991.s002">S2 Text</xref>) for full details. As in [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>], we use the phase transition rates to calculate the phase change probabilities in any time interval [<italic>t</italic>, <italic>t</italic> + Δ<italic>t</italic>]: the probability of transitioning from phase <italic>X</italic><sub><italic>i</italic></sub> to phase <italic>X</italic><sub><italic>j</italic></sub> in this time interval is given by
<disp-formula id="pcbi.1005991.e019"><alternatives><graphic id="pcbi.1005991.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Prob</mml:mtext> <mml:mo>(</mml:mo> <mml:mtext>transition</mml:mtext><mml:mspace width="1pt"/><mml:mtext>from</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mi>X</mml:mi> <mml:mi>i</mml:mi></mml:msub><mml:mspace width="1pt"/><mml:mtext>to</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mi>X</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mtext>not</mml:mtext><mml:mspace width="1pt"/><mml:mtext>arrested</mml:mtext></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>≈</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula></p>
<p>Users can set individual transitions <italic>r</italic><sub><italic>ij</italic></sub> to have deterministic duration, with duration 1/<italic>r</italic><sub><italic>ij</italic></sub>. See the User Guide (<xref ref-type="supplementary-material" rid="pcbi.1005991.s002">S2 Text</xref>) for full details.</p>
<p>Each cell agent tracks its current cell cycle phase <inline-formula id="pcbi.1005991.e020"><alternatives><graphic id="pcbi.1005991.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and its total time spent in that phase (<italic>t</italic><sub><italic>k</italic></sub>). Users can change the transition rates at any time, in part based upon microenvironmental conditions (e.g., based upon oxygenation or cell contact).</p>
<p>As a concrete example, consider the “Ki67 Advanced” model from our prior work calibrating oxygen-dependent growth to Ki67 data in ductal carcinoma in situ (DCIS) [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref032">32</xref>]. The phases are <italic>K</italic><sub>1</sub> (Ki67+ cycling cells, prior to cell division), <italic>K</italic><sub>2</sub> (Ki67+ cycling cells, after cell division), and <italic>Q</italic> (Ki67- quiescent cells). <italic>K</italic><sub>1</sub> and <italic>K</italic><sub>2</sub> have stochastic durations (with means <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub>). We model the transition rate from <italic>Q</italic> to <italic>K</italic><sub>1</sub> as
<disp-formula id="pcbi.1005991.e021"><alternatives><graphic id="pcbi.1005991.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>Q</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mover><mml:mi>T</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="normal">Q</mml:mi></mml:msub></mml:mfrac> <mml:mtext>max</mml:mtext> <mml:mo>{</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mtext>pO</mml:mtext> <mml:mn>2</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mtext>pO</mml:mtext> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mtext>hypoxia</mml:mtext></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mover><mml:msub><mml:mtext>pO</mml:mtext> <mml:mn>2</mml:mn></mml:msub> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:msub><mml:mtext>pO</mml:mtext> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mtext>hypoxia</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>}</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
where cells spend a mean time of <inline-formula id="pcbi.1005991.e022"><alternatives><graphic id="pcbi.1005991.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msub><mml:mover><mml:mi>T</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="normal">Q</mml:mi></mml:msub></mml:math></alternatives></inline-formula> in the <italic>Q</italic> phase when <inline-formula id="pcbi.1005991.e023"><alternatives><graphic id="pcbi.1005991.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:msub><mml:mtext>pO</mml:mtext> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mover><mml:msub><mml:mtext>pO</mml:mtext> <mml:mn>2</mml:mn></mml:msub> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. Cells double <inline-formula id="pcbi.1005991.e024"><alternatives><graphic id="pcbi.1005991.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msubsup><mml:mi>V</mml:mi> <mml:mtext>NS</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> when transitioning from <italic>Q</italic> to <italic>K</italic><sub>1</sub> (to double their nuclear content), and they halve <inline-formula id="pcbi.1005991.e025"><alternatives><graphic id="pcbi.1005991.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msubsup><mml:mi>V</mml:mi> <mml:mtext>NS</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> (and all the sub-volumes) when dividing into two daughter cells at the <italic>K</italic><sub>1</sub> → <italic>K</italic><sub>2</sub> transition. The full set of supported cell cycle models—along with reference parameter values—is given in <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref>.</p>
</sec>
<sec id="sec014">
<title>Cell death</title>
<p>PhysiCell currently includes models for two types of cell death: apoptosis (programmed cell death) and necrosis (unprogrammed cell death) [<xref ref-type="bibr" rid="pcbi.1005991.ref033">33</xref>]. At any time, each agent (with index <italic>i</italic>) has two death rates (<italic>r</italic><sub>A,<italic>i</italic></sub> for apoptosis, and <italic>r</italic><sub>N,<italic>i</italic></sub> for necrosis), which can be continually updated. For any death rate <italic>r</italic><sub><italic>i</italic></sub> and any time interval [<italic>t</italic>, <italic>t</italic> + Δ<italic>t</italic>], the cell has a probability of entering the corresponding death state <italic>D</italic><sub><italic>i</italic></sub>:
<disp-formula id="pcbi.1005991.e026"><alternatives><graphic id="pcbi.1005991.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Prob</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>≈</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
<underline>Apoptosis</underline>: Upon entering the apoptotic state, we set <italic>f</italic><sub>CN</sub> = 0 (to simulate shrinking and blebbing of the cytoplasm), <inline-formula id="pcbi.1005991.e027"><alternatives><graphic id="pcbi.1005991.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mtext>NS</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (to simulate degradation of the nucleus), and <italic>f</italic><sub>F</sub> = 0 (to simulate the active elimination of water from the cell). The rates <italic>r</italic><sub>N</sub>, <italic>r</italic><sub>F</sub>, and <italic>r</italic><sub>C</sub> are set to match time scales of cell volume loss in apoptotic cells. The cell is removed once its volume drops below a user-set threshold, or after mean duration of <italic>T</italic><sub>A</sub>.</p>
<p><underline>Necrosis</underline>: When a cell becomes necrotic, we set <inline-formula id="pcbi.1005991.e028"><alternatives><graphic id="pcbi.1005991.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mtext>CN</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mtext>NS</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> to model cytoplasmic and nuclear degradation. Early necrotic cells undergo oncosis (cell death-related swelling); we model this by setting <italic>f</italic><sub>F</sub> = 1. (Note that some regard oncosis as the actual death process, and necrosis as post-mortem cell degradation [<xref ref-type="bibr" rid="pcbi.1005991.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref035">35</xref>].) Once the cell volume passes a critical threshold, it lyses, and we set <italic>f</italic><sub>F</sub> = 0. The rate parameters <italic>r</italic><sub>F</sub>, <italic>r</italic><sub>N</sub>, and <italic>r</italic><sub>C</sub> are set to match expected time scales throughout necrosis [<xref ref-type="bibr" rid="pcbi.1005991.ref033">33</xref>]. PhysiCell includes codes to trigger necrosis deterministically or stochastically:</p>
<p><underline>Deterministic Necrosis</underline>: This implements a common model of necrosis (see the review [<xref ref-type="bibr" rid="pcbi.1005991.ref002">2</xref>]), where cells instantly become necrotic whenever oxygenation pO<sub>2</sub> drops below a threshold value pO<sub>2,threshold</sub>, as in our earlier work [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>]. This is equivalent to the letting <italic>r</italic><sub>N</sub> → ∞.</p>
<p><underline>Stochastic Necrosis</underline>: This model updates our prior work [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>], based upon <italic>in vitro</italic> observations that cells can survive low oxygen conditions for hours or days. Here,
<disp-formula id="pcbi.1005991.e029"><alternatives><graphic id="pcbi.1005991.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:msub><mml:mi>r</mml:mi><mml:mtext>N</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>p</mml:mtext><mml:msub><mml:mtext>O</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="1pt"/><mml:mtext>pO</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext>threshold</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>&lt;</mml:mo><mml:mspace width="1pt"/><mml:mtext>pO</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mtext>N</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mtext>pO</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext>threshold</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext>pO</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>pO</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext>threshold</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext>pO</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext>crit</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="1pt"/><mml:mtext>pO</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext>crit</mml:mtext></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mtext>pO</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mtext>pO</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext>threshold</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mtext>N</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mtext>max</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="1pt"/><mml:mtext>pO</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mtext>pO</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext>crit</mml:mtext></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula>
That is, necrotic death begins when pO<sub>2</sub> &lt; pO<sub>2,threshold</sub>, and the death rate ramps linearly until saturating at a maximum rate <italic>r</italic><sub>N,max</sub> for pO<sub>2</sub> &lt; pO<sub>2,crit</sub>. Equivalently, cells survive on average 1/<italic>r</italic><sub>N,max</sub> time in very low oxygen conditions [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>].</p>
</sec>
</sec>
<sec id="sec015">
<title>Numerical implementation</title>
<sec id="sec016">
<title>Time steps</title>
<p>PhysiCell has three time steps to model (fast) diffusive biotransport processes (Δ<italic>t</italic><sub>diff</sub>; default 0.01 min), cell movement (Δ<italic>t</italic><sub>mech</sub>; default 0.1 min), and (relatively slow) cell processes (Δ<italic>t</italic><sub>cells</sub>; default 6 min). We use these time steps to set how frequently biotransport processes, cell movement processes, and cell phenotype processes are updated. See <xref ref-type="fig" rid="pcbi.1005991.g001">Fig 1</xref>.</p>
<fig id="pcbi.1005991.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005991.g001</object-id>
<label>Fig 1</label>
<caption>
<title>PhysiCell and multiple time scales.</title>
<p>PhysiCell uses BioFVM to update the microenvironment at the short green tick marks, corresponding to Δ<italic>t</italic><sub>diff</sub>. It updates cell mechanics (including cell position) less frequently at the medium black tick marks (Δ<italic>t</italic><sub>mech</sub>), and it runs the cell volume and cycle/death models least frequently at the long red tick marks (Δ<italic>t</italic><sub>cell</sub>). Note that the time steps shown are for illustrative purpose; the default step sizes are given in <bold>Time steps</bold>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.g001" xlink:type="simple"/>
</fig>
<p>The default Δ<italic>t</italic><sub>diff</sub> was chosen for diffusion, decay, and uptake/secretion parameter values typical for the cancer and tissue engineering problems that drove PhysiCell’s development. In prior testing, relative errors did not exceed 5% for this value [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>]. In mechanical relaxation tests for overlapping cells and compressed tumor spheroids, we found that Δ<italic>t</italic><sub>mech</sub> = 0.1 min gave solutions that converged at first-to-second order accuracy, had relative errors 5% or less, and avoided spurious oscillations and other artifacts for cell velocities under ∼ 1 <italic>μ</italic>m/min (typical for cancer biology problems); see <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref>. The cell cycle, death, and volume change models were numerically stable and first-order accurate with relative errors of 5% or less for Δ<italic>t</italic><sub>cells</sub> = 6 min. See <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref>. Users should reduce Δ<italic>t</italic><sub>cells</sub> for problems with faster phenotypic processes. Users anticipating faster cell movement (e.g., motile bacteria) should reduce Δ<italic>t</italic><sub>mech</sub>. We recommend setting <inline-formula id="pcbi.1005991.e030"><alternatives><graphic id="pcbi.1005991.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>diff</mml:mtext></mml:msub> <mml:mo>≤</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>10</mml:mn></mml:mfrac> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Mathematically, this time scale separation allows us to hold cell positions fixed (quasi-static) when updating the PDE solutions, and then hold the chemical fields fixed when updating cell positions and phenotypes. We have used similar techniques in nonlinear continuum models of tumor growth (slow time scale) in heterogeneous biochemical microenvironments (fast time scale) [<xref ref-type="bibr" rid="pcbi.1005991.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1005991.ref031">31</xref>].</p>
</sec>
<sec id="sec017">
<title>Estimated computational cost scaling</title>
<p>We now assess the computational effort needed for each iteration in the main program loop. (See <bold>Overall program flow</bold>.) Step 1 (save simulation data), Step 3 (run cell processes), and Step 4b (update positions) clearly entail a constant amount of work for each cell. Thus, summing these steps over all cells <italic>n</italic>(<italic>t</italic>) requires <inline-formula id="pcbi.1005991.e031"><alternatives><graphic id="pcbi.1005991.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> work. By prior analysis, BioFVM (Step 2) also scales linearly in <italic>n</italic>(<italic>t</italic>) [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>].</p>
<p>Step 4a (update velocities) is the most computationally expensive step. In straightforward implementations, each cell tests for mechanical interaction with <italic>n</italic> − 1 other cells, giving an <inline-formula id="pcbi.1005991.e032"><alternatives><graphic id="pcbi.1005991.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> total computational cost at each time step. However, the interaction data structure (see <bold>Key code optimizations</bold>) restricts interaction testing to a smaller set <inline-formula id="pcbi.1005991.e033"><alternatives><graphic id="pcbi.1005991.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>In <bold>Expanded computational cost estimates</bold>, we show that each <inline-formula id="pcbi.1005991.e034"><alternatives><graphic id="pcbi.1005991.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> has at most <italic>N</italic><sub>max</sub> cells. Thus, Step 4b has a fixed maximum cost for each cell, and the cost of the loop scales linearly in <italic>n</italic>.</p>
</sec>
<sec id="sec018">
<title>Key code optimizations</title>
<p>To prevent computational costs from scaling quadratically in the number of cells, we designed a cell-cell interaction data structure (IDS) that efficiently estimates a set <inline-formula id="pcbi.1005991.e035"><alternatives><graphic id="pcbi.1005991.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> of possible neighbor cells for each cell agent. See <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref> for further detail.</p>
<p>PhysiCell uses OpenMP to parallelize most loops over the list of cells. This includes sampling the microenvironment, updating cell phenotype parameters, advancing the cell cycle or death model, advancing the volume model, running any custom function, and calculating the cell velocity. We do not parallelize loops that change the IDS: cell division, cell removal, and updating the cell position.</p>
<p>As discussed above, we defined three separate computational step sizes (Δ<italic>t</italic><sub>diff</sub> &lt; Δ<italic>t</italic><sub>mech</sub> &lt; Δ<italic>t</italic><sub>cells</sub>) to take advantage of the multiple time scales of the multicellular system. As indicated in the overall program flow above, we update each process according to its own time step, rather than at each simulation step. <xref ref-type="fig" rid="pcbi.1005991.g001">Fig 1</xref> further illustrates how the multiple times steps reduce the computational cost. See <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref> for further detail and the default step sizes for cancer biology and tissue engineering.</p>
</sec>
<sec id="sec019">
<title>Expanded computational cost estimates</title>
<p>Most of the simulation steps have computational cost that scales linearly in the number of cells. (See <bold>Estimated computational cost scaling</bold>.) The step that requires additional analysis (and relies upon PhysiCell’s IDS) is the step where cell-cell mechanical interactions are used to set the cell velocities. Bounding this computational costs requires that we find a fixed upper bound on the number of cell-cell interactions, so that the computational cost is <inline-formula id="pcbi.1005991.e036"><alternatives><graphic id="pcbi.1005991.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for single cells, and <inline-formula id="pcbi.1005991.e037"><alternatives><graphic id="pcbi.1005991.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for all the cells.</p>
<p>We estimate an upper bound on the of cells in any voxel <italic>B</italic><sub><italic>i</italic></sub> by
<disp-formula id="pcbi.1005991.e038"><alternatives><graphic id="pcbi.1005991.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mtext>max</mml:mtext></mml:msub> <mml:mo>≤</mml:mo> <mml:mfrac><mml:msub><mml:mi>V</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub> <mml:mrow><mml:mtext>min</mml:mtext> <mml:mo>{</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>:</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>B</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
where <italic>V</italic><sub>mech</sub> is the fixed volume of the voxels in the interaction testing data structure. For cycling cells with “mature” volume <italic>V</italic>, we have <inline-formula id="pcbi.1005991.e039"><alternatives><graphic id="pcbi.1005991.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>≥</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>V</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. By default, dead cells are removed when <inline-formula id="pcbi.1005991.e040"><alternatives><graphic id="pcbi.1005991.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>≤</mml:mo> <mml:mn>20</mml:mn> <mml:mspace width="1pt"/><mml:mi>μ</mml:mi> <mml:msup><mml:mi mathvariant="normal">m</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>≈</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>100</mml:mn></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mi>V</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Since a typical <inline-formula id="pcbi.1005991.e041"><alternatives><graphic id="pcbi.1005991.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is constructed from up to 27 such voxels, we have
<disp-formula id="pcbi.1005991.e042"><alternatives><graphic id="pcbi.1005991.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mtext>max</mml:mtext></mml:msub> <mml:mo>≤</mml:mo> <mml:mn>27</mml:mn> <mml:mfrac><mml:msub><mml:mi>V</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>V</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mn>54</mml:mn> <mml:mfrac><mml:msub><mml:mi>V</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub> <mml:mi>V</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
for simulations dominated by live cells, and
<disp-formula id="pcbi.1005991.e043"><alternatives><graphic id="pcbi.1005991.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mtext>max</mml:mtext></mml:msub> <mml:mo>≤</mml:mo> <mml:mn>27</mml:mn> <mml:mfrac><mml:msub><mml:mi>V</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>100</mml:mn></mml:mfrac> <mml:mi>V</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mn>2700</mml:mn> <mml:mfrac><mml:msub><mml:mi>V</mml:mi> <mml:mtext>mech</mml:mtext></mml:msub> <mml:mi>V</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
for simulations dominated by dead cells. Thus, the computational cost for a single cell’s mechanical interactions is bounded by a fixed constant, and the total cost over all cell-cell mechanical interactions scales linearly in <italic>n</italic>. The slope of the cost-versus-<italic>n</italic> curve may be shallower for early, non-necrotic simulations, and it can be up to a factor of 100 steeper for necrosis-dominated simulations. In some cases, simulations may temporarily show a nonlinear relationship with <italic>n</italic> when transitioning from non-necrotic to necrotic.</p>
</sec>
</sec>
<sec id="sec020">
<title>Convergence and validation testing</title>
<p>We performed convergence testing on all the major components of PhysiCell. BioFVM was previously tested as first-order accurate in Δ<italic>t</italic>, second-order accurate in Δ<italic>x</italic>, and sufficiently accurate at Δ<italic>x</italic> = 20 <italic>μ</italic>m and Δ<italic>t</italic><sub>diff</sub> = 0.01 to 0.05 min for tumor growth problems [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>]. We performed two tests for cell-cell mechanics and motion: First, we placed two cells in partial overlap, simulated their relaxation to equilibrium, and measured the cell spacing at several times. Second, we created a compressed cluster of 50,000 cells, simulated its mechanical relaxation to equilibrium, and measured its diameter at several times. Both tests converged to first-order accuracy in Δ<italic>t</italic> at all measured times, showing that PhysiCell converged in both short-time mechanical dynamics and in long-time behavior. Δ<italic>t</italic><sub>mech</sub> ∼ 0.1 min gives sufficient accuracy for typical cancer problems.</p>
<p>We simulated the volume model for a single proliferating, apoptotic, and necrotic cell, and measured the sub-volumes at multiple times. It converged with first-order accuracy in Δ<italic>t</italic> at all tested times, and Δ<italic>t</italic><sub>cell</sub> = 6 min gave sufficient accuracy. We tested the stochastic transition codes by simulating the Ki67-advanced cell cycle model and the apoptosis death model (with stochastic duration), and measuring the sub-population counts and population fractions over time for several values of Δ<italic>t</italic><sub>cell</sub>. For each Δ<italic>t</italic>, we performed 100 simulations and compared the mean solution behavior against known coarse-grained ODE model behavior. Δ<italic>t</italic><sub>cell</sub> = 6 min and 60 min both gave an excellent match between the PhysiCell behavior and theory for all the compared curves. See <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref> for full testing results.</p>
</sec>
<sec id="sec021">
<title>Performance testing (summary)</title>
<p>By our testing, recent quad-core desktop workstations (with hyperthreading, for 8 total execution threads) can simulate 10-30 days in systems of up to 10<sup>5</sup> to 10<sup>6</sup> cells in 3 days or less (wall time). Single HPC compute nodes (typically two 6-8 core processors, with hyperthreading and 24-32 execution threads) can simulate larger systems up to ∼ 2 million cells in about 2 days. Future releases of PhysiCell will address current performance bottlenecks; see <xref ref-type="sec" rid="sec035">Availability and future directions</xref>. The <xref ref-type="sec" rid="sec022">Results</xref> will give a demonstration of <inline-formula id="pcbi.1005991.e044"><alternatives><graphic id="pcbi.1005991.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> computational cost scaling.</p>
</sec>
</sec>
<sec id="sec022" sec-type="results">
<title>Results</title>
<p>We demonstrated PhysiCell’s potential to simulate large multicellular systems—and its ability to test the emergent tissue-scale effects of cell-scale hypotheses—on several examples arising from cancer biology and synthetic multicellular systems bioengineering. For the first two examples, we compared the impact of the deterministic and stochastic necrosis models. (See <bold>Cell death</bold> above.) We used the Ki67-advanced cell cycle model with deterministic <italic>K</italic><sub>1</sub>, <italic>K</italic><sub>2</sub>, and <italic>A</italic> phase durations for the first two examples. (See <bold>Cell cycling</bold>.) We used a simpler “live cells” cycle model [<xref ref-type="bibr" rid="pcbi.1005991.ref022">22</xref>] in the remaining examples, where live cells proliferate with a variable birthrate, apoptose, or necrose. We provide detailed parameter values in <xref ref-type="supplementary-material" rid="pcbi.1005991.s001">S1 Text</xref> for the HDS and DCIS examples, and the full source code and postprocessing routines for both examples in every PhysiCell download. Full source code and simple build instructions are provided for the remaining examples. Reference simulation outputs for the first two examples are available at <ext-link ext-link-type="uri" xlink:href="http://PhysiCell.MathCancer.org" xlink:type="simple">http://PhysiCell.MathCancer.org</ext-link>.</p>
<sec id="sec023">
<title>Test platforms</title>
<p>The <bold>Hanging drop tumor spheroids</bold> and <bold>Ductal carcinoma in situ (DCIS)</bold> examples were tested on (1) a desktop workstation (quad-core Intel i7-4790, 3.60 GHz, 8 execution threads, 16 GB memory) with mingw-w64 (<monospace>g++</monospace> ver. 4.9.1) on 64-bit Windows 7, and (2) a single HPC compute node (dual 6-core Intel Xeon X5690, 3.47 GHz, 24 execution threads, 48 GB memory) with <monospace>g++</monospace> (ver. 4.8.4) on Ubuntu 14.04. The tests were performed using PhysiCell 1.0.0, although release 1.2.0 has updated the tests for compatibility. The CPU architecture was newer on the desktop (2014 Haswell) than on the HPC node (2011 Westmere). The newer <bold>“Biorobots”</bold>, <bold>Anti-cancer biorobots</bold>, <bold>Cancer heterogeneity and immune response</bold>, and <bold>Adding an immune response</bold> examples were tested on a quad-core Intel i7-4770K, 4.06 GHz, 8 execution threads, 32 GB memory, using PhysiCell Version 1.2.1 with <monospace>g++</monospace> 7.1.0 on 64-bit Windows 10 (via MinGW-w64).</p>
</sec>
<sec id="sec024">
<title>Hanging drop tumor spheroids</title>
<p>Hanging drop spheroids (HDS)—a 3-D cell culture model where a small cluster or aggregate of tumor cells is suspended in a drop of growth medium by surface tension—are increasingly used to approximate 3-D <italic>in vivo</italic> growth conditions [<xref ref-type="bibr" rid="pcbi.1005991.ref036">36</xref>]. Unlike traditional 2-D monolayer experiments, HDSs allow scientists to investigate the impact of substrate gradients on tumor growth, particularly oxygen gradients. Their relatively simple geometry makes them ideal for testing computational models.</p>
<p>We simulated HDS growth by placing an initial cluster of ∼ 2300 cells in an 8 mm<sup>3</sup> fluid domain, with Dirichlet conditions pO<sub>2</sub> = 38 mmHg (5% oxygen: physioxic conditions [<xref ref-type="bibr" rid="pcbi.1005991.ref037">37</xref>]) on the computational boundary. The simulation results are shown in <xref ref-type="fig" rid="pcbi.1005991.g002">Fig 2</xref> for deterministic necrosis (left column) and stochastic necrosis (right column), at 4, 8, and 16 days. In <xref ref-type="fig" rid="pcbi.1005991.g003">Fig 3</xref>, we show the tumor diameter (left panel) and number of agents (right panel) versus time. Both simulations reached ∼ 10<sup>6</sup> cells by 18 days. See the simulation videos <xref ref-type="supplementary-material" rid="pcbi.1005991.s004">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005991.s005">S2</xref> Videos.</p>
<fig id="pcbi.1005991.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005991.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Hanging drop spheroid (HDS) simulations with deterministic necrosis (left) and stochastic necrosis (right), plotted at 4, 8, and 16 days.</title>
<p>Videos are available at <xref ref-type="supplementary-material" rid="pcbi.1005991.s004">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005991.s005">S2</xref> Videos. <italic><bold>Legend:</bold></italic> Ki67+ cells are green before mitosis (<italic>K</italic><sub>1</sub>) and magenta afterwards (<italic>K</italic><sub>2</sub>). Pale blue cells are Ki67- (<italic>Q</italic>), dead cells are red (apoptotic) and brown (necrotic), and nuclei are dark blue. <italic><bold>Bottom:</bold></italic> Hanging drop spheroid experiment (HCC827 non-small cell lung carcinoma) showing a similar necrotic core microstructure. PhysiCell is the first simulation to predict this structure arising from cell-scale mechanical interactions. Image courtesy Mumenthaler lab, Lawrence J. Ellison Center for Transformative Medicine, University of Southern California.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.g002" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005991.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005991.g003</object-id>
<label>Fig 3</label>
<caption>
<title>HDS growth.</title>
<p><italic><bold>Left:</bold></italic> The deterministic and stochastic necrosis models both give approximately linear growth (left), but the HDS with deterministic necrosis model grows faster (∼ 5% difference in diameter at day 18). <italic><bold>Right:</bold></italic> The HDS with stochastic necrosis has fewer cells than the deterministic model (∼ 26% difference in cell count at day 18), due to its delay in necrosis. The difference in cell count is larger than the difference in tumor diameter because most of the difference lies in the number of necrotic cells, and necrotic cells are smaller than viable cells.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.g003" xlink:type="simple"/>
</fig>
<sec id="sec025">
<title>Deterministic versus stochastic necrosis</title>
<p>Both models yielded similar dynamics. Hypoxic gradients emerged quickly, limiting (pO<sub>2</sub>-dependent) cell division to the outermost portions of the tumors. This, in turn, lead the tumor diameters to grow linearly (at similar rates); see <xref ref-type="fig" rid="pcbi.1005991.g003">Fig 3</xref>. This matches our theoretical expectations for a spheroid of radius <italic>R</italic>(<italic>t</italic>) whose growth is restricted to an outer layer of fixed thickness <italic>T</italic>:
<disp-formula id="pcbi.1005991.e045"><alternatives><graphic id="pcbi.1005991.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mo>·</mml:mo> <mml:mover><mml:mover accent="true"><mml:mrow><mml:mn>4</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>R</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mi>T</mml:mi></mml:mrow> <mml:mo>︷</mml:mo></mml:mover> <mml:mrow><mml:mtext>growing</mml:mtext><mml:mspace width="1pt"/><mml:mtext>region</mml:mtext></mml:mrow></mml:mover></mml:mrow></mml:mtd> <mml:mtd><mml:mo>⇒</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>(</mml:mo> <mml:mfrac><mml:mn>4</mml:mn> <mml:mn>3</mml:mn></mml:mfrac> <mml:mi>π</mml:mi> <mml:msup><mml:mi>R</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mo>·</mml:mo> <mml:mn>4</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>R</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula> <disp-formula id="pcbi.1005991.e046"><alternatives><graphic id="pcbi.1005991.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mo>⇒</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mi>T</mml:mi> <mml:mo>=</mml:mo> <mml:mtext>constant</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula></p>
<p>In both models, the innermost portion of the necrotic core developed a network of fluid voids or cracks. This phenomenon emerges from competing biophysical effects of the multicellular system and its cell-scale mechanical details: necrotic cells lose volume, even as they continue to adhere, leading to the formation of cracks. To our knowledge, this is the only model that has predicted this necrotic tumor microarchitecture, which would be very difficult to simulate by continuum methods except with very high-resolution meshes comparable to the ∼ 1 to 10 <italic>μ</italic>m feature size. These cracked necrotic core structures have been observed with <italic>in vitro</italic> hanging drop spheroids (e.g., [<xref ref-type="bibr" rid="pcbi.1005991.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref039">39</xref>]). See <xref ref-type="fig" rid="pcbi.1005991.g002">Fig 2</xref>.</p>
<p>There were notable differences between the models. The deterministic model had a sharp perinecrotic boundary between the viable and necrotic tissues, whereas the stochastic model demonstrated a perinecrotic transition zone with substantial mixing of viable and necrotic cells. Because cells do not immediately necrose in the stochastic model, it retained a center of quiescent viable cells longer than the deterministic model. The growth curves for the deterministic and stochastic models appear to diverge after approximately 8 days, when the deterministic necrotic core is better defined with more cracks than the stochastic core. This may be due to differences in hypoxic gradients (the tumor with more void spaces will have shallower oxygen gradients, and hence more cell cycle entry), but further simulations would be required to rule out stochastic effects. Interestingly, the stochastic model’s growth curve appears to run parallel to the deterministic curve for later times, once its necrotic core becomes better defined.</p>
</sec>
<sec id="sec026">
<title>Performance scaling</title>
<p>Throughout the simulations, the computational cost (the wall time required to simulate one hour) scaled approximately linearly with the number of agents present in the simulation, on both the desktop workstation and the HPC node; see <xref ref-type="fig" rid="pcbi.1005991.g004">Fig 4</xref>. (See also <bold>Estimated computational cost scaling</bold>.) Increasing the number of execution threads improved performance, even when running on slower processor cores. See the right panel in <xref ref-type="fig" rid="pcbi.1005991.g004">Fig 4</xref>, where moving from the newer 8-threaded machine to the older 24-threaded machine improved performance by a factor of 2 to 2.5.</p>
<fig id="pcbi.1005991.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005991.g004</object-id>
<label>Fig 4</label>
<caption>
<title>HDS computational cost scaling.</title>
<p><italic><bold>Left:</bold></italic> Wall-time vs. cell count for the stochastic (red) and deterministic (blue) necrosis necrosis models on a single HPC compute node. Both models show approximately linear cost scaling with the number of cell agents. <italic><bold>Right:</bold></italic> Wall time vs. cell count for stochastic necrosis model on the desktop workstation (orange) and the single HPC node (green).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.g004" xlink:type="simple"/>
</fig>
<p>The simulations reached ∼ 10<sup>6</sup> cells on our HPC tests after 67 hours (deterministic, 17 simulated days) to 76 hours (stochastic, 18.2 simulated days) of wall time, including saving full simulation output data once per simulated hour. See <xref ref-type="fig" rid="pcbi.1005991.g003">Fig 3</xref>. The desktop workstation simulated past 573,000 cells (about 14.6 days of simulated time) in approximately 80 hours of wall time. The desktop tests did not run out of memory, and the simulations can be completed to the full 18 days and 10<sup>6</sup> cells if needed.</p>
</sec>
</sec>
<sec id="sec027">
<title>Ductal carcinoma in situ (DCIS)</title>
<p>DCIS is a pre-malignant breast condition where epithelial cells (“tumor cells”) divide abnormally to fill the breast duct lumen. Oxygen can only reach the tumor cells by diffusion from outside the duct, leading to the emergence of hypoxia and an inner necrotic core. See [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref032">32</xref>] for further biological and clinical discussion. As in [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>], we approximate a partly-filled breast duct as a 3-D “test tube” with a level set function representation. Cells adhere to cells and the duct wall; cells and the duct wall push against cells to resist deformation. Oxygen diffuses from the duct wall and is consumed by tumor cells. The rate of cycle entry increases linearly with pO<sub>2</sub> (see <bold>Cell cycling</bold>).</p>
<p>In <xref ref-type="fig" rid="pcbi.1005991.g005">Fig 5</xref>, we show DCIS simulations in a 1 mm segment of breast duct (317.5 <italic>μ</italic>m diameter), using deterministic necrosis (left side) and stochastic necrosis (right side), plotted at 10 and 30 days. See also <xref ref-type="supplementary-material" rid="pcbi.1005991.s006">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005991.s007">S4</xref> Videos. As in prior work [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>], the simulations predict cell-scale details observed in DCIS pathology, such as the appearance of pairs of Ki67+ daughter cells, the spatially isolated apoptotic cells (which arises from the model assumption that apoptosis is a stochastic, low-frequency event that is independent of oxygenation), and the higher occurrence of Ki67+ cells near the duct wall (where we modeled the probability of cell cycle entry as proportional to oxygenation).</p>
<fig id="pcbi.1005991.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005991.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Ductal carcinoma in situ (DCIS) simulations with deterministic necrosis (left) and stochastic necrosis (right), plotted at 10 and 30 days (multiple views).</title>
<p>Videos are available at <xref ref-type="supplementary-material" rid="pcbi.1005991.s006">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005991.s007">S4</xref> Videos. The legend is the same as <xref ref-type="fig" rid="pcbi.1005991.g002">Fig 2</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.g005" xlink:type="simple"/>
</fig>
<sec id="sec028">
<title>Comparison of necrosis models; comparison with the spheroid example</title>
<p>As in the HDS example, the deterministic model had a sharp, smooth perinecrotic boundary, whereas the stochastic model demonstrated a perinecrotic boundary region with mixed viable and necrotic cells. In the stochastic model, proliferation halted in the duct center, but necrosis appeared later. The perinecrotic mixing effect was most pronounced at the leading edge of the tumor, where tissue was transitioning from non-hypoxic/non-necrotic to necrotic. Areas with longer-term hypoxia had smoother necrotic boundaries. This effect did not emerge in the HDS example due to its symmetry.</p>
<p>Interestingly, the mechanical “cracks” seen in the tumor spheroids do not appear here, because the breast duct compresses the necrotic core to collapse any fluid-filled voids. This shows the importance of the 3-D geometry and the biophysical impact of the basement membrane, as well as the need to account for such effects when approximating <italic>in vivo</italic> conditions with bioengineered model systems.</p>
<p>Both models gave approximately the same growth rate of ∼ 1 cm/year (<xref ref-type="fig" rid="pcbi.1005991.g006">Fig 6</xref>, left). We cannot select one model over the other based solely upon continuum-scale, coarse-grained outputs. However, we could further assess the models by comparing their distinct differences in multicellular-scale patterning to DCIS pathology. This further highlights the need and potential for multicellular modeling in evaluating cell-scale hypotheses.</p>
<fig id="pcbi.1005991.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005991.g006</object-id>
<label>Fig 6</label>
<caption>
<title>DCIS growth.</title>
<p>The deterministic and stochastic necrosis models both result in linear DCIS growth at approximately 1 cm/year (left), even while their cell counts differ by 21% by the end of the simulations (right).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec029">
<title>Comparison with prior 2-D modeling results</title>
<p>In 3D, neither necrosis model reproduced the mechanical “tears” between the proliferative rim and the necrotic core predicted by earlier 2-D simulations [<xref ref-type="bibr" rid="pcbi.1005991.ref014">14</xref>]; this is because more viable tissue is fluxing into smaller necrotic areas in the 3-D geometry compared to the 2-D geometry.</p>
</sec>
</sec>
<sec id="sec030">
<title>Additional PhysiCell examples</title>
<p>In the following examples, we demonstrate PhysiCell in applications involving interactions via contact and chemical factors between multiple cell types, in 2-D and 3-D simulations. Most of the examples include cell motility, “custom” phenotype rules, additional “custom” mechanics, and custom data.</p>
<p>Please visit <ext-link ext-link-type="uri" xlink:href="http://www.mathcancer.org/blog/physicell-sample-projects/" xlink:type="simple">http://www.mathcancer.org/blog/physicell-sample-projects/</ext-link> for instructions on building, running, and visualizing the following sample projects. The sample projects are structured to mirror the intended design of user projects: a project-tailored <monospace>Makefile</monospace> and <monospace>main.cpp</monospace> in the main directory, and most custom code in the project-tailored functions in the <monospace>custom_modules</monospace> directory.</p>
<p>The instructions can also be found in the User Guide (<xref ref-type="supplementary-material" rid="pcbi.1005991.s002">S2 Text</xref>, found in the documentation folder of every PhysiCell download) and the Quickstart guide (<xref ref-type="supplementary-material" rid="pcbi.1005991.s003">S3 Text</xref>, found in the root directory of every PhysiCell download).</p>
<sec id="sec031">
<title>“Biorobots”</title>
<p>First, we tested PhysiCell for its potential in aiding in the design of synthetic multicellular systems. We investigated rulesets to create a cellular cargo delivery system, including the following main components:</p>
<list list-type="order">
<list-item>
<p>“Director” cells secrete a diffusible chemoattractant <italic>c</italic><sub>1</sub> and are otherwise static. They use the typical cell-cell repulsion mechanics.</p>
</list-item>
<list-item>
<p>“Cargo” cells have a surface receptor 0 ≤ <italic>R</italic> ≤ 1. When <italic>R</italic> = 1, they secrete a diffusible chemoattractant <italic>c</italic><sub>2</sub>. When <italic>R</italic> = 0, they stop secreting the factor. They use the typical cell-cell repulsion mechanics.</p>
</list-item>
<list-item>
<p>“Worker” cells can either be adhered or not adhered to cargo cells.</p>
<list list-type="alpha-lower">
<list-item>
<p>When they are unadhered, they perform biased random migration towards gradients of ∇<italic>c</italic><sub>2</sub>. Whenever they touch a cell, they test for presence of receptor <italic>R</italic>. If <italic>R</italic> is expressed (i.e., the worker has found cargo), the worker forms an elastic adhesion with the cell and sets <italic>R</italic> = 0 on the cargo cell.</p>
</list-item>
<list-item>
<p>When they are adhered, they perform biased random migration towards ∇<italic>c</italic><sub>1</sub>. When <italic>c</italic><sub>1</sub> exceeds a threshold, they break their adhesive bond.</p>
</list-item>
</list>
</list-item>
</list>
<p>As a simple model of this targeted cell adhesion, we used a <monospace>custom_cell_rule</monospace> to implement:
<disp-formula id="pcbi.1005991.e047"><alternatives><graphic id="pcbi.1005991.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>Hook</mml:mtext></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula> <disp-formula id="pcbi.1005991.e048"><alternatives><graphic id="pcbi.1005991.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e048" xlink:type="simple"/><mml:math display="block" id="M48"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>Hook</mml:mtext></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
for adhered cells <italic>j</italic> and <italic>i</italic>. We then add these to the cell’s velocities. PhysiCell evaluates the custom rule when evaluating cell mechanics (velocity update).</p>
<p>Simulation outputs are shown in <xref ref-type="fig" rid="pcbi.1005991.g007">Fig 7</xref>; see also <xref ref-type="supplementary-material" rid="pcbi.1005991.s008">S5 Video</xref>. As we can see, the cargo and worker cells successfully interact to modulate their behaviors. Notably, the worker cells are seen making multiple transits from the supply of cellular cargo to the directors, showing the robustness of both the rules and their implementation in PhysiCell.</p>
<fig id="pcbi.1005991.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005991.g007</object-id>
<label>Fig 7</label>
<caption>
<title>“Biorobots” example.</title>
<p>Director cells (green) release a chemoattractant <italic>c</italic><sub>1</sub> to guide worker cells (red). Cargo cells (blue) release a separate chemoattractant <italic>c</italic><sub>2</sub>. Unadhered worker cells chemotax towards ∇<italic>c</italic><sub>2</sub>, test for contact with cargo cells, form adhesive bonds, and then pull them towards the directors by following ∇<italic>c</italic><sub>1</sub>. If <italic>c</italic><sub>1</sub> exceeds a threshold, the worker cells release the cargo and return to seek more cargo cells, repeating the cycle. Bar: 200 <italic>μ</italic>m. A video is available at <xref ref-type="supplementary-material" rid="pcbi.1005991.s008">S5 Video</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.g007" xlink:type="simple"/>
</fig>
<p>This and the following examples also demonstrate the intended arrangement of projects: users do not modify the contents of <monospace>./core/</monospace>, but instead place their codes in <monospace>./custom_modules/</monospace>, include these in a main project <monospace>main.cpp</monospace>, and modify the <monospace>Makefile</monospace> to compile and link the components. This design is intended to allow users to update the PhysiCell and BioFVM core components without overwriting their own customizations.</p>
</sec>
<sec id="sec032">
<title>Anti-cancer biorobots</title>
<p>We adapted the “biorobots” to test their potential as an anti-cancer treatment. Many proposed cancer therapies attempt to target cancer cells by finding unique surface or other molecules to target, so that drugs can be conjugated to custom antibodies or encapsulated in custom nanoparticles. These still generally rely upon passive delivery of the therapeutics, even though cancers are often poorly perfused. See e.g. [<xref ref-type="bibr" rid="pcbi.1005991.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref041">41</xref>]. We tested the “biorobots” as a potential solution, with the following modifications:</p>
<list list-type="order">
<list-item>
<p>There are no “director” cells. Instead, cancer cells consume oxygen (as in prior examples), which creates an oxygen gradient that can be leveraged for worker cell “homing.”</p>
</list-item>
<list-item>
<p>Adhered “cargo” cells detach themselves from “worker” cells when pO<sub>2</sub> &lt; pO<sub>2,drop</sub> and secrete a therapeutic compound [drug] that diffuses with the typical form given in <bold>Biochemical microenvironment</bold>.</p>
</list-item>
<list-item>
<p>Adhered worker cells perform biased random migration along −∇pO<sub>2</sub>.</p>
</list-item>
<list-item>
<p>In any time interval [<italic>t</italic>, <italic>t</italic> + Δ<italic>t</italic><sub>cells</sub>], cancer cells accumulate drug-induced damage according to:
<disp-formula id="pcbi.1005991.e049"><alternatives><graphic id="pcbi.1005991.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>[</mml:mo> <mml:mtext>damage</mml:mtext> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mtext>damage</mml:mtext></mml:msub> <mml:mo>[</mml:mo> <mml:mtext>drug</mml:mtext> <mml:mo>]</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mtext>repair</mml:mtext></mml:msub> <mml:mo>[</mml:mo> <mml:mtext>damage</mml:mtext> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where <italic>r</italic><sub>damage</sub> and <italic>r</italic><sub>repair</sub> are the damage and repair rates. Each tumor cell agent tracks its own level of damage. In the same time interval the probability of a cell apoptosing due to the drug is
<disp-formula id="pcbi.1005991.e050"><alternatives><graphic id="pcbi.1005991.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e050" xlink:type="simple"/><mml:math display="block" id="M50"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Prob</mml:mtext> <mml:mo>(</mml:mo> <mml:mtext>apoptosis</mml:mtext> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mtext>death</mml:mtext></mml:msub> <mml:mo>[</mml:mo> <mml:mtext>damage</mml:mtext> <mml:mo>]</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>cells</mml:mtext></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
where <italic>r</italic><sub>death</sub> is the death rate when [damage] = 1.</p>
</list-item>
<list-item>
<p>Unadhered worker cells disabled motility if <italic>c</italic><sub>1</sub> falls below a threshold value.</p>
</list-item>
</list>
<p>We simulated 1 week of tumor growth, “injected” a mixture of 10% worker cells and 90% cargo cells near the tumor, and set the parameter pO<sub>2,drop</sub> to 10 mmHg. In the simulation (<xref ref-type="fig" rid="pcbi.1005991.g008">Fig 8</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005991.s009">S6 Video</xref>), overall the cargo cells were delivered into the tumor (and they can be seen pushing tumor cells out of the way), and tumor cells were indeed killed. However, once enough cancer cells were killed, hypoxia was reduced so that worker cells clustered near the oxygen minimum, but no longer released their “cargo” (because pO<sub>2</sub> &gt; pO<sub>2,drop</sub> throughout the domain). Setting pO<sub>2,drop</sub> = 15 mmHg reduced but did not eliminate this behavior. See <xref ref-type="fig" rid="pcbi.1005991.g008">Fig 8</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005991.s009">S6 Video</xref>. Thus, an “anti-cancer biorobot” system as explored here could potentially be beneficial (in particular, homing towards and penetrating tumors without need for cancer-specific targets), but the “cargo release” rules need to be carefully engineered. Such a system could potentially activate and deactivate to keep a tumor cell population in control, and to reduce hypoxia (which is known to drive cancer cell adaptation to more aggressive phenotypes [<xref ref-type="bibr" rid="pcbi.1005991.ref042">42</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref043">43</xref>]).</p>
<fig id="pcbi.1005991.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005991.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Anti-cancer “biorobots” example.</title>
<p>By modifying the worker cells in the previous example (<xref ref-type="fig" rid="pcbi.1005991.g007">Fig 7</xref>) to move up hypoxic gradients (along −∇pO<sub>2</sub>) and drop their cargo in hypoxic zones, we can deliver cargo to a growing tumor. In this example, the cargo cells secrete a therapeutic that induces apoptosis in nearby tumor cells, leading to partial tumor regression. Bar: 200 <italic>μ</italic>m. A video is available at <xref ref-type="supplementary-material" rid="pcbi.1005991.s009">S6 Video</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.g008" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec033">
<title>Cancer heterogeneity and immune response</title>
<p>Next, we applied PhysiCell to another area of interest in the cancer community: heterogeneity. We seeded an initial tumor, and assigned each cell a random expression of a mutant “oncoprotein” 0 ≤ <italic>p</italic> ≤ 2. We started the simulation with a normal distribution of <italic>p</italic>, with mean 1 and standard deviation of approximately 0.3. We used the same oxygen-dependent stochastic cell cycle entry and necrosis as in prior examples. We modified the model to set the rate of cycle entry to scale proportionally to <italic>p</italic>, so that increased <italic>p</italic> increases the rate of cell division. The initial, intermediate, and final morphologies of the tumor are plotted in <xref ref-type="fig" rid="pcbi.1005991.g009">Fig 9</xref>, along with the changing histograms of <italic>p</italic>. In the plot, cell color ranges from blue (<italic>p</italic> = 0) to yellow (<italic>p</italic> = 2). We can see clear selection for the yellower cells with greater expression of <italic>p</italic>. Moreover, see that while the initial tumor began with a uniform “salt and pepper” distribution of blue and yellow cells and a symmetric morphology, symmetry was broken by the end as regions with higher initial <italic>p</italic> and greater access to oxygen form dominant focal growths of “yellow” clones. This demonstrates further stochasticity in the simulation that would be difficult to predict with continuum approaches. See <xref ref-type="supplementary-material" rid="pcbi.1005991.s010">S7 Video</xref> to better examine these dynamics.</p>
<fig id="pcbi.1005991.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005991.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Cancer heterogeneity example.</title>
<p>Each cell has an independent expression of a mutant “oncoprotein” <italic>p</italic> (dimensionless, bounded in [0, 2]), which scales the oxygen-based rate of cell cycle entry. Blue cells have least <italic>p</italic>, and yellow cells have most. Initially, the population has normally distributed <italic>p</italic> with mean 1, standard deviation 0.3, and a “salt and pepper” mixed spatial arrangement. The proliferative advantage for cells with higher <italic>p</italic> leads to selection and enrichment of the most yellow cells. Stochastic effects lead to emergence of fast-growing foci and a loss of tumor symmetry. Bar: 200 <italic>μ</italic>m. A video is available at <xref ref-type="supplementary-material" rid="pcbi.1005991.s010">S7 Video</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.g009" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec034">
<title>Adding an immune response</title>
<p>We extended the heterogeneity example to 3D, and integrated a simple model of an immune attack on the heterogeneous tumor:</p>
<list list-type="order">
<list-item>
<p>All cancer cells consume oxygen as before. They also secrete an immunostimulatory factor <italic>c</italic> (e.g., a chemokine such as basic fibroblast growth factor (bFGF) [<xref ref-type="bibr" rid="pcbi.1005991.ref044">44</xref>]), which diffuses according to the standard PDE we introduced earlier.</p>
</list-item>
<list-item>
<p>As a simple model of immunogenicity, the mutant oncoprotein is assumed to increase immunogenicity proportionally to <italic>p</italic>, similarly to mutant tumor-associated epitopes being presented on MHCs (major histocompatibility complexes) [<xref ref-type="bibr" rid="pcbi.1005991.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref046">46</xref>].</p>
</list-item>
<list-item>
<p>Unadhered immune cells perform biased random migration (in our simulations <italic>b</italic> = 0.5) towards ∇<italic>c</italic> and test for contact with cells. If they detect contact, they form an adhesion using the same model as in the <bold>“Biorobots”</bold> example and switch off motility. In any time interval [<italic>t</italic>, <italic>t</italic> + Δ<italic>t</italic>], we give the cell a probability of forming an adhesion regulated by
<disp-formula id="pcbi.1005991.e051"><alternatives><graphic id="pcbi.1005991.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Prob</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>forming</mml:mtext><mml:mspace width="1pt"/><mml:mtext>a</mml:mtext><mml:mspace width="1pt"/><mml:mtext>new</mml:mtext><mml:mspace width="1pt"/><mml:mtext>adhesion</mml:mtext><mml:mspace width="1pt"/><mml:mtext>to</mml:mtext><mml:mspace width="1pt"/><mml:mtext>the</mml:mtext><mml:mspace width="1pt"/><mml:mtext>tested</mml:mtext><mml:mspace width="1pt"/><mml:mtext>cell</mml:mtext> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mtext>adhesion</mml:mtext></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
where <italic>r</italic><sub>adhesion</sub> is the immune cell’s rate of forming new cell adhesions.</p>
</list-item>
<list-item>
<p>While adhered, immune cells attempt to induce apoptosis in the adhered cell with probability
<disp-formula id="pcbi.1005991.e052"><alternatives><graphic id="pcbi.1005991.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Prob</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>inducing</mml:mtext><mml:mspace width="1pt"/><mml:mtext>apoptosis</mml:mtext> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mtext>kill</mml:mtext></mml:msub> <mml:mi>p</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
where <italic>p</italic> is used as our surrogate marker for immunogenicity (see above), and <italic>r</italic><sub>kill</sub> is the rate at which adhered immune cells kill tumor cells with <italic>p</italic> = 1. If they induce apoptosis, they detach and resume their search for new cells.</p>
</list-item>
<list-item>
<p>Adhered immune cells have a probability of detachment given by
<disp-formula id="pcbi.1005991.e053"><alternatives><graphic id="pcbi.1005991.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Prob</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>detaching</mml:mtext><mml:mspace width="1pt"/><mml:mtext>from</mml:mtext><mml:mspace width="1pt"/><mml:mtext>an</mml:mtext><mml:mspace width="1pt"/><mml:mtext>adhered</mml:mtext><mml:mspace width="1pt"/><mml:mtext>tumor</mml:mtext><mml:mspace width="1pt"/><mml:mtext>cell</mml:mtext> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mtext>detach</mml:mtext></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula></p>
</list-item>
</list>
<p>In <xref ref-type="fig" rid="pcbi.1005991.g010">Fig 10</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005991.s011">S8 Video</xref>, we first simulate two weeks of tumor growth without an immune reaction. As in the prior example, we see the initially symmetric tumor develop asymmetric focal growths of “yellow” cells, again showing the selection for cells with the most oncoprotein. At two weeks, we introduce 7500 immune cells (red) that invade the tumor. Apoptotic tumor cells are labeled in cyan. The immune cells continue to migrate towards the center of the tumor up gradients of <italic>c</italic>, and within a few days, the tumor cell population is drastically reduced, with more “blue” cells (less immunogenic) remaining than “yellow cells” (most immunogenic). However, because immune cell migration was strongly biased along ∇<italic>c</italic>, they pass by some tumor cells at the outer periphery. These surviving cells repopulate the tumor. This highlights the importance of stochasticity in immune cell migration; if homing is too strong, immune cells cannot mix with tumor cells, leading them to cluster in dense regions which can only interact with tumor cells on their edges. Less biased migration would increase mixing of cancer and immune cells and increase the efficacy of the immune attack.</p>
<fig id="pcbi.1005991.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005991.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Cancer immunology example.</title>
<p>In this 3-D example, each tumor cell secretes an immunostimulatory factor, and its immunogenicity is modeled as proportional to its mutant oncoprotein expression. (See the previous example in <xref ref-type="fig" rid="pcbi.1005991.g009">Fig 9</xref>.) After 14 days, red immune cells perform a biased random walk towards the immunostimulatory factor, test for contact with cells, form adhesions, and attempt to induce apoptosis for cells with greater immunogenicity. The immune cells successfully attack the tumor initially, leading to partial regression; apoptotic cells are cyan. But strong homing towards gradients of the immunostimulatory factor causes immune cells to “pass” some cells at the outer edge, leading to tumor regrowth. Eventually, immune cells leave the necrotic regions and press their attack on the tumor. This highlights the importance of stochasticity in immune cell movement in mixing with the tumor cells for a more successful immune response. A video is available at <xref ref-type="supplementary-material" rid="pcbi.1005991.s011">S8 Video</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.g010" xlink:type="simple"/>
</fig>
<p>In [<xref ref-type="bibr" rid="pcbi.1005991.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref021">21</xref>], we used high-throughput computing to further expand this investigation to explore the impact of stochastic migration and tumor-immune cell adhesion dynamics on the treatment efficacy.</p>
</sec>
</sec>
</sec>
<sec id="sec035">
<title>Availability and future directions</title>
<sec id="sec036">
<title>Getting started as a new PhysiCell user/developer</title>
<sec id="sec037">
<title>Necessary tools</title>
<p>Users need a working <monospace>g++</monospace> development environment with support for OpenMP and Makefiles (or a reasonably compatible 64-bit C++11 compliant compiler). (Future releases will likely include compile options using <monospace>cmake</monospace>.) We provide tutorials to set up a <monospace>g++</monospace> environment in Windows and OSX at:</p>
<p><bold>OSX via Homebrew</bold>:</p>
<p><ext-link ext-link-type="uri" xlink:href="http://www.mathcancer.org/blog/setting-up-gcc-openmp-on-osx-homebrew-edition/" xlink:type="simple">http://www.mathcancer.org/blog/setting-up-gcc-openmp-on-osx-homebrew-edition/</ext-link>
</p>
<p><bold>OSX via MacPorts</bold>:</p>
<p><ext-link ext-link-type="uri" xlink:href="http://www.mathcancer.org/blog/setting-up-gcc-openmp-on-osx-macports-edition/" xlink:type="simple">http://www.mathcancer.org/blog/setting-up-gcc-openmp-on-osx-macports-edition/</ext-link>
</p>
<p><bold>Windows via mingw-w64</bold>:</p>
<p><ext-link ext-link-type="uri" xlink:href="http://www.mathcancer.org/blog/setting-up-a-64-bit-gcc-environment-on-windows/" xlink:type="simple">http://www.mathcancer.org/blog/setting-up-a-64-bit-gcc-environment-on-windows/</ext-link>
</p>
<p>Mac OSX users should use the tutorials above; the version of <monospace>g++</monospace> included with <monospace>XCode</monospace> does not support OpenMP. Moreover, OSX users need to set a <monospace>PHYSICELL_CPP</monospace> environment variable as noted in the Homebrew and MacPorts tutorials.</p>
<p>Alternatively, users can code within a virtual machine using the PhysiCell virtual appliance. See the tutorial at <ext-link ext-link-type="uri" xlink:href="http://www.mathcancer.org/blog/getting-started-with-a-physicell-virtual-appliance/" xlink:type="simple">http://www.mathcancer.org/blog/getting-started-with-a-physicell-virtual-appliance/</ext-link>.</p>
</sec>
<sec id="sec038">
<title>Downloading PhysiCell</title>
<p>Users can download a PhysiCell release at:</p>
<p><bold>SourceForge</bold>:</p>
<p><ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/physicell/" xlink:type="simple">https://sourceforge.net/projects/physicell/</ext-link>
</p>
<p>The green “download” button will download the most recent source file (as a zip file). You can get the most recent virtual appliance by browsing to: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/physicell/files/PhysiCell/" xlink:type="simple">https://sourceforge.net/projects/physicell/files/PhysiCell/</ext-link>.</p>
<p>Then browsing a recent release directory (e.g., <monospace>PhysiCell 1.2.2</monospace>), and downloading the ova file.</p>
<p><bold>GitHub</bold>:</p>
<p><ext-link ext-link-type="uri" xlink:href="https://github.com/MathCancer/PhysiCell/releases/latest" xlink:type="simple">https://github.com/MathCancer/PhysiCell/releases/latest</ext-link>
</p>
<p>Download either <monospace>PhysiCell_V.x.y.z.zip</monospace> (source) or <monospace>PhysiCell.x.y.z.ova</monospace> (virtual appliance).</p>
<p>PhysiCell is licensed under the (3-clause) BSD license, which is compatible with commercial products and can be included in GPL-licensed projects.</p>
</sec>
<sec id="sec039">
<title>Learning to use PhysiCell</title>
<p>PhysiCell’s main project website can be found at <ext-link ext-link-type="uri" xlink:href="http://PhysiCell.MathCancer.org" xlink:type="simple">http://PhysiCell.MathCancer.org</ext-link>.</p>
<p>Each PhysiCell download comes with a Quickstart guide (<monospace>Quickstart.pdf</monospace>) in the main directory (see <xref ref-type="supplementary-material" rid="pcbi.1005991.s003">S3 Text</xref>). We recommend running through this guide to populate, compile, run, and visualize your first projects. (The four examples in <bold>Additional PhysiCell examples</bold> are included as sample projects, with compile instructions in the Quickstart; see <xref ref-type="supplementary-material" rid="pcbi.1005991.s003">S3 Text</xref>.)</p>
<p>A full User Guide (see <xref ref-type="supplementary-material" rid="pcbi.1005991.s002">S2 Text</xref>) is included in the <monospace>documentation</monospace> directory of every PhysiCell download. See <monospace>documentation/User_Guide.pdf</monospace>. The User Guide includes full details on how to access and modify each cell’s <monospace>Phenotype</monospace>, how to write custom functions and data elements, and how to interact with the BioFVM microenvironment [<xref ref-type="bibr" rid="pcbi.1005991.ref006">6</xref>].</p>
<p>Users creating their own simulation projects should start with the 2-D and 3-D template projects. User-created code should be placed in the <monospace>custom_modules</monospace> directory; users should not modify functions in <monospace>core</monospace> (core PhysiCell functionality) or <monospace>modules</monospace> (PhysiCell-provided, non-core functions). See the Quickstart (<xref ref-type="supplementary-material" rid="pcbi.1005991.s003">S3 Text</xref>) and User Guide (<xref ref-type="supplementary-material" rid="pcbi.1005991.s002">S2 Text</xref>) for further details.</p>
<p>We post tutorials at our PhysiCell blog, available at <ext-link ext-link-type="uri" xlink:href="http://mathcancer.org/blog/physicell-tutorials" xlink:type="simple">http://mathcancer.org/blog/physicell-tutorials</ext-link>.</p>
<p>Check there for tips and tricks to building simulators, and visualizing results. We also frequently post updates on PhysiCell on Twitter, under the hashtag <monospace>#PhysiCell</monospace>.</p>
</sec>
</sec>
<sec id="sec040">
<title>Getting started as a new PhysiCell contributor</title>
<p>We welcome new functionality and bug fix contributions from the community. No special tools or libraries are required for PhysiCell development aside from a C++11/OpenMP compliant compiler, <monospace>make</monospace>, and a copy of the PhysiCell source. Developers should fork the current development version of the PhysiCell repository (available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/MathCancer/PhysiCell" xlink:type="simple">https://github.com/MathCancer/PhysiCell</ext-link>), develop their contributions (either in the <monospace>modules</monospace> directory as new functions, named as <monospace>PhysiCell_[name].cpp</monospace>, or as fixes to existing files), and then submit a pull request. Users should also email the PhysiCell mailing list when submitting code contributions.</p>
<p>Project coding conventions can be found at <ext-link ext-link-type="uri" xlink:href="http://www.mathcancer.org/blog/mathcancer-c-style-and-practices-guide/" xlink:type="simple">http://www.mathcancer.org/blog/mathcancer-c-style-and-practices-guide/</ext-link>.</p>
</sec>
<sec id="sec041">
<title>Getting help</title>
<p>Users encountering problems in compiling PhysiCell projects should first consult the FAQ page at: <ext-link ext-link-type="uri" xlink:href="http://www.mathcancer.org/blog/common-problems-and-solutions/" xlink:type="simple">http://www.mathcancer.org/blog/common-problems-and-solutions/</ext-link>.</p>
<p>Users (and developers) can join the PhysiCell mailing list to ask the community questions or discuss ideas, at <ext-link ext-link-type="uri" xlink:href="https://groups.google.com/forum/#!forum/physicell-users" xlink:type="simple">https://groups.google.com/forum/#!forum/physicell-users</ext-link>. Users can submit bug reports at the GitHub issue tracker: <ext-link ext-link-type="uri" xlink:href="https://github.com/MathCancer/PhysiCell/issues" xlink:type="simple">https://github.com/MathCancer/PhysiCell/issues</ext-link>.</p>
</sec>
<sec id="sec042">
<title>Limitations and potential solutions</title>
<sec id="sec043">
<title>Scientific limitations</title>
<p>BioFVM does not implement advective transport as of Version 1.1.7, and so PhysiCell cannot readily be applied to advection-dominated problems without user-supplied advection solvers. We also have not yet written a model of extracellular matrix; users could add this effect by introducing custom data that (1) “anchors” each cell to a position in space beyond cell-cell mechanical operations, and (2) slowly evolve these “anchor points” to model ECM rearrangement. We are currently exploring this approach to model liver parenchyma, and we will post sample codes as the work progresses. Alternatively, users could introduce an independent finite element mesh for the ECM, evolve it under (e.g., viscoelastic) laws, and attach cells to the nearest lattice site. As a simpler approach, users could include a non-diffusing ECM substrate (in BioFVM), which could be used to reduce the cells’ velocities (as extra drag). Vary the cell-cell mechanics parameters in <monospace>phenotype.mechanics</monospace> with the ECM density for this approach.</p>
<p>PhysiCell’s cell-centered approach may not be ideal for application to some morphogenesis problems; see the recent work by Osborne and co-workers that compared several discrete modeling frameworks in morphogenesis test problems [<xref ref-type="bibr" rid="pcbi.1005991.ref047">47</xref>]. PhysiCell does not model cell morphology, and so it cannot directly model cell elongation processes needed in some morphogenesis problems. However, users could potentially model elongated cells as two or more agents, and introduce manual adhesive links similar to our “biorobots” examples. PhysiCell has not implemented cell fusion (another mechanism of morphogenesis), but users could manually implement this by (1) testing for cell-cell contact, (2) moving one cell to the center of volume of the two cells, (3) updating that cell’s volume to include both original cells’ volumes, and (4) deleting the second cell. PhysiCell has not yet written functions to deal with polarized cell-cell adhesion, or to update its orientation. Thus, PhysiCell may need further development and user contributions to model the full spectrum of morphogenetic mechanisms.</p>
<p>We note that PhysiCell can manually implement molecular-scale biology as ODEs (e.g., as in the drug damage example) via custom functions and data, but this is currently difficult to scale to large systems of ODEs with many parameters. Moreover, while we have provided examples of user-defined cell cycle models and other custom functions in the User Guide, sample codes, and tutorials, we do not provide templates for such functions beyond the documentation. We are currently testing methods to support SBML specification of ODE models in the cell agents (e.g., via libRoadrunner [<xref ref-type="bibr" rid="pcbi.1005991.ref048">48</xref>]), but until SBML is supported, we do not provide templates to integrate ODE models into PhysiCell functions to alter cell phenotype.</p>
<p>PhysiCell does not currently provide direct methods to model contact-based cell-cell interactions; these can be manually implemented as we did in the immune and biorobots examples. We also do not yet provide alternative mechanics models (e.g., viscoelastic) out-of-the-box, but users can design their own cell velocity functions as needed to replace the default mechanics. We have not yet implemented direct calculations of cell pressures and strains, so this could hinder some applications in mechanobiology. Users could implement this by creating a custom velocity update function that calculates pressures and strains from the potential functions. A preliminary version—calculated from the “resistance” potential functions similarly to [<xref ref-type="bibr" rid="pcbi.1005991.ref049">49</xref>]—is included as <monospace>state.basic_pressure</monospace>. See the User Guide (<xref ref-type="supplementary-material" rid="pcbi.1005991.s002">S2 Text</xref>) for more details.</p>
</sec>
<sec id="sec044">
<title>Software limitations</title>
<p>PhysiCell is intended to function as a modular engine and to interact with standardized data (e.g., MultiCellDS [<xref ref-type="bibr" rid="pcbi.1005991.ref022">22</xref>]), but it has not yet fully implemented MultiCellDS import and export. Graphical simulation design tools, data visualization tools, and analysis tools are needed to widen its accessibility beyond seasoned C++ programmers and reduce its learning curve. In the future, PhysiCell should switch from Makefiles to CMake to facilitate simpler cross-platform compiling.</p>
</sec>
</sec>
<sec id="sec045">
<title>Future improvements</title>
<sec id="sec046">
<title>Numerical improvements</title>
<p>The biggest performance bottleneck is cell-cell interaction testing: cell volume can vary by a factor of 100, and hence the cell diameter (and interaction distance) can vary by a factor of 50. The number of cells in the list of interacting neighbors <inline-formula id="pcbi.1005991.e054"><alternatives><graphic id="pcbi.1005991.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> scales inversely with the minimum cell volume; see <bold>Expanded computational cost estimates</bold>. Future versions of PhysiCell will introduce a nested mesh interaction testing structure to more accurately estimate <inline-formula id="pcbi.1005991.e055"><alternatives><graphic id="pcbi.1005991.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005991.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in regions with small cells. Although PhysiCell’s design objectives are not focused on larger simulations with 10<sup>8</sup>-10<sup>9</sup> cells, extension to supercomputers by wrapping the code in MPI with appropriate data mirroring could be useful. Likewise, the algorithms used in BioFVM could be implemented on a graphics card via OpenCL or OpenACC. We will explore these approaches in the future.</p>
</sec>
<sec id="sec047">
<title>Scientific improvements</title>
<p>We will develop SBML (systems biology markup language) importers for molecular-scale biology, most likely by the C code generation features in COPASI [<xref ref-type="bibr" rid="pcbi.1005991.ref050">50</xref>] or libRoadrunner [<xref ref-type="bibr" rid="pcbi.1005991.ref048">48</xref>]. This will make it straightforward to integrate systems of ODEs to individual cells. We will add new cycle models for flow cytometry-driven problems (G1, S, and G2/M phases). We plan to add more advanced cell mechanics models (e.g., as in [<xref ref-type="bibr" rid="pcbi.1005991.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref051">51</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref052">52</xref>]), and to extend PhysiCell’s included standard functions to include extracellular matrix mechanics. We also plan to introduce built-in functions for polarized cell adhesion and updating the cells’ orientations. As our PhysiCell-based projects progress, we will “upstream” our new functions to PhysiCell as new optional modules. We are currently testing and refining the elastic-based cell adhesions in <bold>Additional PhysiCell examples</bold> for inclusion as standard models, and we are also developing vascularization libraries as part of our work to simulate metastatic breast cancers injected in mammary fat pads.</p>
</sec>
<sec id="sec048">
<title>User-focused improvements</title>
<p>In the coming months, we will continue publishing blog posts and code samples at <ext-link ext-link-type="uri" xlink:href="http://MathCancer.org/blog/physicell-tutorials/" xlink:type="simple">http://MathCancer.org/blog/physicell-tutorials/</ext-link>. We will create pre-compiled clients that can initiate simulations based upon a digital snapshot (initial arrangement of cells) and digital cell lines (self-contained, model-independent sets of cell phenotype data), using the emerging MultiCellDS standard [<xref ref-type="bibr" rid="pcbi.1005991.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005991.ref023">23</xref>]. We will develop support to read parameters from XML configuration files, and we plan to offer PhysiCell as a compiled, linkable library. Moreover, we plan to develop user-friendly, web-based applications of PhysiCell to simulate the multicellular response to diffusing engineered nanoparticles [<xref ref-type="bibr" rid="pcbi.1005991.ref053">53</xref>].</p>
</sec>
</sec>
</sec>
<sec id="sec049">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005991.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supplemental information.</title>
<p>Extensive supplemental information including: full mathematical model details, supporting literature, and reference parameter values for breast epithelial cells; expanded numerical implementation details; convergence and validation testing results; full parameter values for the main tests; and an expanded feature comparison of PhysiCell and other 3-D multicellular simulation platforms.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005991.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>User Guide.</title>
<p>User Guide for PhysiCell 1.2.2. Includes full API documentation and examples.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005991.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.s003" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Quickstart guide to PhysiCell.</title>
<p>A fast guide to building, running, and visualizing your first PhysiCell simulations. We recommend that new users start with this guide.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005991.s004" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.s004" xlink:type="simple">
<label>S1 Video</label>
<caption>
<title>Deterministic 3-D hanging drop spheroid simulation.</title>
<p>3-D simulation of 18 days of hanging drop tumor spheroid growth from 2300 cells to 1.2 million cells, using the deterministic necrosis model. HD (1080p) videos available at: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=WMhYW9D4SqM" xlink:type="simple">https://www.youtube.com/watch?v=WMhYW9D4SqM</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5716600" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5716600</ext-link>.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005991.s005" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.s005" xlink:type="simple">
<label>S2 Video</label>
<caption>
<title>Stochastic 3-D hanging drop spheroid simulation.</title>
<p>3-D simulation of 18 days of hanging drop tumor spheroid growth from 2300 cells to 1 million cells, using the stochastic necrosis model. HD (1080p) videos available at: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=xrOqqJ_Exd4" xlink:type="simple">https://www.youtube.com/watch?v=xrOqqJ_Exd4</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5716597" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5716597</ext-link>.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005991.s006" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.s006" xlink:type="simple">
<label>S3 Video</label>
<caption>
<title>Deterministic 3-D ductal carcinoma in situ (DCIS) simulation.</title>
<p>3-D simulation video of 30 days of DCIS growth in a 1 mm length of breast duct, using the deterministic necrosis model. HD (1080p) videos available at: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=ntVKOr9poro" xlink:type="simple">https://www.youtube.com/watch?v=ntVKOr9poro</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5716480" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5716480</ext-link>.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005991.s007" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.s007" xlink:type="simple">
<label>S4 Video</label>
<caption>
<title>Stochastic 3-D ductal carcinoma in situ (DCIS) simulation.</title>
<p>3-D simulation video of 30 days of DCIS growth in a 1 mm length of breast duct, using the stochastic necrosis model. HD (1080p) videos available at: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=-lRot-dfwJk" xlink:type="simple">https://www.youtube.com/watch?v=-lRot-dfwJk</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.6084/m9.figshare.5721088.v1" xlink:type="simple">http://dx.doi.org/10.6084/m9.figshare.5721088.v1</ext-link>.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005991.s008" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.s008" xlink:type="simple">
<label>S5 Video</label>
<caption>
<title>2-D biorobots simulation.</title>
<p>2-D simulation of the “biorobots” example, showing a synthetic multicellular cargo delivery system. HD (1080p) videos available at: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=NdjvXI_x8uE" xlink:type="simple">https://www.youtube.com/watch?v=NdjvXI_x8uE</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5721136" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5721136</ext-link>.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005991.s009" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.s009" xlink:type="simple">
<label>S6 Video</label>
<caption>
<title>2-D biorobots, applied to cancer therapeutics delivery.</title>
<p>2-D simulations of the “biorobots” adapted for use as a cancer treatment, where cargo cells detach and secrete a therapeutic once reaching hypoxic tissues. HD (1080p) videos available at: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=wuDZ40jW__M" xlink:type="simple">https://www.youtube.com/watch?v=wuDZ40jW__M</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5721145" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5721145</ext-link>.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005991.s010" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.s010" xlink:type="simple">
<label>S7 Video</label>
<caption>
<title>2-D simulation of a heterogeneous tumor.</title>
<p>2-D simulation of a tumor whose heterogeneous oncoprotein expression drives proliferation and selection. 4K-resolution (2160p) videos available at: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=bPDw6l4zkF0" xlink:type="simple">https://www.youtube.com/watch?v=bPDw6l4zkF0</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5721151" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5721151</ext-link>.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005991.s011" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005991.s011" xlink:type="simple">
<label>S8 Video</label>
<caption>
<title>3-D simulation of a tumor immune response.</title>
<p>3-D simulation of immune cells attacking a tumor with heterogeneous proliferation and immunogenicity. 4K-resolution (2160p) videos available at: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=nJ2urSm4ilU" xlink:type="simple">https://www.youtube.com/watch?v=nJ2urSm4ilU</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5717887" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5717887</ext-link>.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Margy Villa for her assistance in early testing, and Edwin Juarez and Rishi Rawat for useful discussions. We greatly appreciate the deep discussions with the MultiCellDS review panel in developing standardized cell cycle and death models. We thank Jakob Kather and Jan Poleszczuk for discussions on cancer immunology. We thank Nathan Choi for his 3-D hanging drop spheroid work in <xref ref-type="fig" rid="pcbi.1005991.g002">Fig 2</xref>.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005991.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>. <chapter-title>Biological background</chapter-title>. In: <name name-style="western"><surname>Cristini</surname> <given-names>V.</given-names></name> and <name name-style="western"><surname>Lowengrub</surname> <given-names>J.S.</given-names></name>, <source>Multiscale Modeling of Cancer: An Integrated Experimental and Mathematical Modeling Approach</source>. <publisher-loc>Cambridge, UK</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>2010</year>. p. <fpage>8</fpage>–<lpage>23</lpage>. (invited author: P. Macklin). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1017/CBO9780511781452.003" xlink:type="simple">http://dx.doi.org/10.1017/CBO9780511781452.003</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lowengrub</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Frieboes</surname> <given-names>HB</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Chuang</surname> <given-names>YL</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Nonlinear modeling of cancer: Bridging the gap between cells and tumors</article-title>. <source>Nonlinearity</source>. <year>2010</year>;<volume>23</volume>(<issue>1</issue>):<fpage>R1</fpage>–<lpage>R91</lpage>. (invited author: J. Lowengrub). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0951-7715/23/1/R01" xlink:type="simple">http://dx.doi.org/10.1088/0951-7715/23/1/R01</ext-link>. <object-id pub-id-type="pmid">20808719</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deisboeck</surname> <given-names>TS</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cristini</surname> <given-names>V</given-names></name>. <article-title>Multiscale Cancer Modeling</article-title>. <source>Annu Rev Biomed Eng</source>. <year>2011</year>;<volume>13</volume>:<fpage>127</fpage>–<lpage>155</lpage>. (invited author: T.S. Deisboeck). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/ANNUREV-BIOENG-071910-124729" xlink:type="simple">http://dx.doi.org/10.1146/ANNUREV-BIOENG-071910-124729</ext-link>. <object-id pub-id-type="pmid">21529163</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hatzikirou</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Chauviere</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bauer</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Leier</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Integrative physical oncology</article-title>. <source>WIREs Syst Biol Med</source>. <year>2012</year>;<volume>4</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>14</lpage>. (invited author: V. Cristini). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/wsbm.158" xlink:type="simple">http://dx.doi.org/10.1002/wsbm.158</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref005">
<label>5</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Frieboes</surname> <given-names>HB</given-names></name>, <name name-style="western"><surname>Sparks</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Ghaffarizadeh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Juarez</surname> <given-names>EF</given-names></name>, <etal>et al</etal>. In: <name name-style="western"><surname>Rejniak</surname> <given-names>KA</given-names></name>, editor. <source>Progress Towards Computational 3-D Multicellular Systems Biology</source>. <volume>vol. 936</volume>. <publisher-loc>Bern, Switzerland</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2016</year>. p. <fpage>225</fpage>–<lpage>246</lpage>. (invited author: P. Macklin). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-3-319-42023-3_12" xlink:type="simple">http://dx.doi.org/10.1007/978-3-319-42023-3_12</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ghaffarizadeh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>. <article-title>BioFVM: an efficient, parallelized diffusive transport solver for 3-D biological simulations</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>8</issue>):<fpage>1256</fpage>–<lpage>1258</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv730" xlink:type="simple">http://dx.doi.org/10.1093/bioinformatics/btv730</ext-link>. <object-id pub-id-type="pmid">26656933</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref007">
<label>7</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Swat</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Belmonte</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Shirinifard</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hmeljak</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Glazier</surname> <given-names>JA</given-names></name>. <chapter-title>Chapter 13—Multi-Scale Modeling of Tissues Using CompuCell3D</chapter-title>. In: <name name-style="western"><surname>Asthagiri</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Arkin</surname> <given-names>AP</given-names></name>, editors. <source>Computational Methods in Cell Biology. vol. 110 of Methods in Cell Biology</source>. <publisher-name>Academic Press</publisher-name>; <year>2012</year>. p. <fpage>325</fpage>–<lpage>366</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/B978-0-12-388403-9.00013-8" xlink:type="simple">http://dx.doi.org/10.1016/B978-0-12-388403-9.00013-8</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Starruß</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>de Back</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Brusch</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Deutsch</surname> <given-names>A</given-names></name>. <article-title>Morpheus: a user-friendly modeling environment for multiscale and multicellular systems biology</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>9</issue>):<fpage>1331</fpage>–<lpage>1332</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt772" xlink:type="simple">http://dx.doi.org/10.1093/bioinformatics/btt772</ext-link>. <object-id pub-id-type="pmid">24443380</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hoehme</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Drasdo</surname> <given-names>D</given-names></name>. <article-title>A cell-based simulation software for multi-cellular systems</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>20</issue>):<fpage>2641</fpage>–<lpage>2642</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq437" xlink:type="simple">http://dx.doi.org/10.1093/bioinformatics/btq437</ext-link>. <object-id pub-id-type="pmid">20709692</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mirams</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Arthurs</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Bernabeu</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Bordas</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Cooper</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Corrias</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Chaste: An Open Source C++ Library for Computational Physiology and Biology</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year> <day>03</day>;<volume>9</volume>(<issue>3</issue>):<fpage>1</fpage>–<lpage>8</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002970" xlink:type="simple">http://dx.doi.org/10.1371/journal.pcbi.1002970</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kahan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>McDermott</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Flann</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Shmulevich</surname> <given-names>I</given-names></name>. <article-title>Biocellion: accelerating computer simulation of multicellular biological system models</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>21</issue>):<fpage>3101</fpage>–<lpage>3108</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu498" xlink:type="simple">http://dx.doi.org/10.1093/bioinformatics/btu498</ext-link>. <object-id pub-id-type="pmid">25064572</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cytowski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Szymanska</surname> <given-names>Z</given-names></name>. <article-title>Large-Scale Parallel Simulations of 3D Cell Colony Dynamics</article-title>. <source>Computing in Science Engineering</source>. <year>2014</year> <month>Sept</month>;<volume>16</volume>(<issue>5</issue>):<fpage>86</fpage>–<lpage>95</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/MCSE.2014.2" xlink:type="simple">http://dx.doi.org/10.1109/MCSE.2014.2</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cytowski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Szymanska</surname> <given-names>Z</given-names></name>. <article-title>Large-Scale Parallel Simulations of 3D Cell Colony Dynamics: The Cellular Environment</article-title>. <source>Computing in Science Engineering</source>. <year>2015</year> <month>Sept</month>;<volume>17</volume>(<issue>5</issue>):<fpage>44</fpage>–<lpage>48</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/MCSE.2015.66" xlink:type="simple">http://dx.doi.org/10.1109/MCSE.2015.66</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Edgerton</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Cristini</surname> <given-names>V</given-names></name>. <article-title>Patient-calibrated agent-based modelling of ductal carcinoma in situ (DCIS): From microscopic measurements to macroscopic predictions of clinical progression</article-title>. <source>J Theor Biol</source>. <year>2012</year>;<volume>301</volume>:<fpage>122</fpage>–<lpage>40</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2012.02.002" xlink:type="simple">http://dx.doi.org/10.1016/j.jtbi.2012.02.002</ext-link>. <object-id pub-id-type="pmid">22342935</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hyun</surname> <given-names>AZ</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>. <article-title>Improved patient-specific calibration for agent-based cancer modeling</article-title>. <source>J Theor Biol</source>. <year>2013</year>;<volume>317</volume>:<fpage>422</fpage>–<lpage>4</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2012.10.017" xlink:type="simple">http://dx.doi.org/10.1016/j.jtbi.2012.10.017</ext-link>. <object-id pub-id-type="pmid">23084996</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mumenthaler</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>D’Antonio</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Preziosi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>. <article-title>The need for integrative computational oncology: An illustrated example through MMP-mediated tissue degradation</article-title>. <source>Front Oncol</source>. <year>2013</year>;<volume>3</volume>:<fpage>194</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fonc.2013.00194" xlink:type="simple">http://dx.doi.org/10.3389/fonc.2013.00194</ext-link>. <object-id pub-id-type="pmid">23898463</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grogan</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Connor</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Markelc</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Muschel</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Maini</surname> <given-names>PK</given-names></name>, <name name-style="western"><surname>Byrne</surname> <given-names>HM</given-names></name>, <etal>et al</etal>. <article-title>Microvessel Chaste: An Open Library for Spatial Modeling of Vascularized Tissues</article-title>. <source>Biophys J</source>. <year>2017</year>;<volume>112</volume>(<issue>9</issue>):<fpage>1767</fpage>–<lpage>72</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2017.03.036" xlink:type="simple">http://dx.doi.org/10.1016/j.bpj.2017.03.036</ext-link>. <object-id pub-id-type="pmid">28494948</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schumacher</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Maini</surname> <given-names>PK</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>RE</given-names></name>. <article-title>Semblance of Heterogeneity in Collective Cell Migration</article-title>. <source>Cell Sys</source>. <year>2017</year>;<volume>5</volume>(<issue>2</issue>):<fpage>119</fpage>–<lpage>27</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.1016/j.cels.2017.06.006" xlink:type="simple">https://dx.doi.org/10.1016/j.cels.2017.06.006</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>. <article-title>When Seeing Isn’t Believing: How Math Can Guide Our Interpretation of Measurements and Experiments</article-title>. <source>Cell Sys</source>. <year>2017</year>;<volume>5</volume>(<issue>2</issue>):<fpage>92</fpage>–<lpage>4</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cels.2017.08.005" xlink:type="simple">http://dx.doi.org/10.1016/j.cels.2017.08.005</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref020">
<label>20</label>
<mixed-citation publication-type="other" xlink:type="simple">Ozik J, Collier N, Wozniak J, Macal C, Cockrell C, Friedman S, et al. High-throughput cancer hypothesis testing with an integrated PhysiCell-EMEWS workflow. bioRxiv, accepted SuperComputing SC17 Computational Approaches for Cancer Workshop. 2017;p. 196709. Available from: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.1101/196709" xlink:type="simple">https://dx.doi.org/10.1101/196709</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref021">
<label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">Ozik J, Collier N, Wozniak J, Macal C, Cockrell C, Friedman S, et al. High-throughput cancer hypothesis testing with an integrated PhysiCell-EMEWS workflow [Presented at SuperComputing SC17, Computational Approaches for Cancer Workshop]. FigShare. 2017;p. 5687197.v1. Available from: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.6084/m9.figshare.5687197.v1" xlink:type="simple">https://dx.doi.org/10.6084/m9.figshare.5687197.v1</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref022">
<label>22</label>
<mixed-citation publication-type="other" xlink:type="simple">Friedman SH, Anderson ARA, Bortz DM, Fletcher AG, Frieboes HB, Ghaffarizadeh A, et al. MultiCellDS: a community-developed standard for curating microenvironment-dependent multicellular data. bioRxiv. 2016;Available from: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.1101/090456" xlink:type="simple">https://dx.doi.org/10.1101/090456</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref023">
<label>23</label>
<mixed-citation publication-type="other" xlink:type="simple">Macklin P, et al.. MultiCellDS Project Website; 2014-2016. Available from: <ext-link ext-link-type="uri" xlink:href="http://MultiCellDS.org" xlink:type="simple">http://MultiCellDS.org</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Benson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>. <article-title>43. Cell-based modeling of mechanical and chemical stress in tissues during cryoprotocols</article-title>. <source>Cryobiology</source>. <year>2015</year>;<volume>71</volume>(<issue>1</issue>):<fpage>176</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cryobiol.2015.05.049" xlink:type="simple">http://dx.doi.org/10.1016/j.cryobiol.2015.05.049</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref025">
<label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Kapoulkine A. pugixml: Light-weight, simple and fast XML parser for C++ with XPath support; 2015. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/zeux/pugixml" xlink:type="simple">https://github.com/zeux/pugixml</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Simpson</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Towne</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>McElwain</surname> <given-names>DLS</given-names></name>, <name name-style="western"><surname>Upton</surname> <given-names>Z</given-names></name>. <article-title>Migration of breast cancer cells: Understanding the roles of volume exclusion and cell-to-cell adhesion</article-title>. <source>Phys Rev E</source>. <year>2010</year> <month>Oct</month>;<volume>82</volume>:<fpage>041901</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.1103/PhysRevE.82.041901" xlink:type="simple">https://dx.doi.org/10.1103/PhysRevE.82.041901</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Drasdo</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kree</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>McCaskill</surname> <given-names>JS</given-names></name>. <article-title>Monte Carlo approach to tissue-cell populations</article-title>. <source>Phys Rev E</source>. <year>1995</year> <month>Dec</month>;<volume>52</volume>:<fpage>6635</fpage>–<lpage>6657</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.52.6635" xlink:type="simple">http://dx.doi.org/10.1103/PhysRevE.52.6635</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Galle</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Loeffler</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Drasdo</surname> <given-names>D</given-names></name>. <article-title>Modeling the Effect of Deregulated Proliferation and Apoptosis on the Growth Dynamics of Epithelial Cell Populations In Vitro</article-title>. <source>Biophys J</source>. <year>2005</year>;<volume>88</volume>(<issue>1</issue>):<fpage>62</fpage>–<lpage>75</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1529/biophysj.104.041459" xlink:type="simple">http://dx.doi.org/10.1529/biophysj.104.041459</ext-link>. <object-id pub-id-type="pmid">15475585</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lowengrub</surname> <given-names>JS</given-names></name>. <article-title>Evolving interfaces via gradients of geometry-dependent interior Poisson problems: application to tumor growth</article-title>. <source>J Comput Phys</source>. <year>2005</year>;<volume>203</volume>(<issue>1</issue>):<fpage>191</fpage>–<lpage>220</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jcp.2004.08.010" xlink:type="simple">http://dx.doi.org/10.1016/j.jcp.2004.08.010</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lowengrub</surname> <given-names>JS</given-names></name>. <article-title>Nonlinear simulation of the effect of microenvironment on tumor growth</article-title>. <source>J Theor Biol</source>. <year>2007</year>;<volume>245</volume>(<issue>4</issue>):<fpage>677</fpage>–<lpage>704</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2006.12.004" xlink:type="simple">http://dx.doi.org/10.1016/j.jtbi.2006.12.004</ext-link>. <object-id pub-id-type="pmid">17239903</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lowengrub</surname> <given-names>JS</given-names></name>. <article-title>A New Ghost Cell/Level Set Method for Moving Boundary Problems: Application to Tumor Growth</article-title>. <source>J Sci Comput</source>. <year>2008</year>;<volume>35</volume>(<issue>2-3</issue>):<fpage>266</fpage>–<lpage>299</lpage>. (invited author: J.S. Lowengrub). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10915-008-9190-z" xlink:type="simple">http://dx.doi.org/10.1007/s10915-008-9190-z</ext-link>. <object-id pub-id-type="pmid">21331304</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edgerton</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Chuang</surname> <given-names>YL</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Bearer</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Cristini</surname> <given-names>V</given-names></name>. <article-title>A novel, patient-specific mathematical pathology approach for assessment of surgical volume: Application to ductal carcinoma in situ of the breast</article-title>. <source>Anal Cell Pathol</source>. <year>2011</year>;<volume>34</volume>(<issue>5</issue>):<fpage>247</fpage>–<lpage>63</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3233/ACP-2011-0019" xlink:type="simple">http://dx.doi.org/10.3233/ACP-2011-0019</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref033">
<label>33</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mumenthaler</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lowengrub</surname> <given-names>J</given-names></name>. <chapter-title>Modeling multiscale necrotic and calcified tissue biomechanics in cancer patients: application to ductal carcinoma in situ (DCIS)</chapter-title>. In: <name name-style="western"><surname>Gefen</surname> <given-names>A</given-names></name>, editor. <source>Multiscale Computer Modeling in Biomechanics and Biomedical Engineering</source>. <publisher-loc>Berlin, Germany</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2013</year>. p. <fpage>349</fpage>–<lpage>80</lpage>. (invited author: P. Macklin). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/8415_2012_150" xlink:type="simple">http://dx.doi.org/10.1007/8415_2012_150</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Majno</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Joris</surname> <given-names>I</given-names></name>. <article-title>Apoptosis, oncosis, and necrosis. An overview of cell death</article-title>. <source>The American journal of pathology</source>. <year>1995</year>;<volume>146</volume>(<issue>1</issue>):<fpage>3</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1870771/" xlink:type="simple">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1870771/</ext-link>. <object-id pub-id-type="pmid">7856735</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trump</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Berezesky</surname> <given-names>IK</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Phelps</surname> <given-names>PC</given-names></name>. <article-title>The Pathways of Cell Death: Oncosis, Apoptosis, and Necrosis</article-title>. <source>Toxicologic Pathology</source>. <year>1997</year>;<volume>25</volume>(<issue>1</issue>):<fpage>82</fpage>–<lpage>88</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.1177/019262339702500116" xlink:type="simple">https://dx.doi.org/10.1177/019262339702500116</ext-link>. <object-id pub-id-type="pmid">9061857</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Garvey</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Spiller</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lindsay</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Chiang</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Choi</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Agus</surname> <given-names>DB</given-names></name>, <etal>et al</etal>. <article-title>A high-content image-based method for quantitatively studying context-dependent cell population dynamics</article-title>. <source>Sci Rep</source>. <year>2016</year>;<volume>6</volume>:<fpage>29752</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/srep29752" xlink:type="simple">http://dx.doi.org/10.1038/srep29752</ext-link>. <object-id pub-id-type="pmid">27452732</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McKeown</surname> <given-names>SR</given-names></name>. <article-title>Defining normoxia, physoxia and hypoxia in tumours—implications for treatment response</article-title>. <source>The British Journal of Radiology</source>. <year>2014</year>;<volume>87</volume>(<issue>1035</issue>):<fpage>20130676</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1259/bjr.20130676" xlink:type="simple">http://dx.doi.org/10.1259/bjr.20130676</ext-link>. <object-id pub-id-type="pmid">24588669</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ghosh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Joshi</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Ivanov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Feder-Mengus</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Spagnoli</surname> <given-names>GC</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Use of multicellular tumor spheroids to dissect endothelial cell–tumor cell interactions: A role for T-cadherin in tumor angiogenesis</article-title>. <source>FEBS Letters</source>. <year>2007</year>;<volume>581</volume>(<issue>23</issue>):<fpage>4523</fpage>–<lpage>4528</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.febslet.2007.08.038" xlink:type="simple">http://dx.doi.org/10.1016/j.febslet.2007.08.038</ext-link>. <object-id pub-id-type="pmid">17765896</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ma</surname> <given-names>Hl</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Han</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tomshine</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Multicellular Tumor Spheroids as an in Vivo–Like Tumor Model for Three-Dimensional Imaging of Chemotherapeutic and Nano Material Cellular Penetration</article-title>. <source>Molecular Imaging</source>. <year>2012</year>;<volume>11</volume>(<issue>6</issue>). Available from: <ext-link ext-link-type="uri" xlink:href="http://journals.sagepub.com/doi/abs/10.2310/7290.2012.00012" xlink:type="simple">http://journals.sagepub.com/doi/abs/10.2310/7290.2012.00012</ext-link>. <object-id pub-id-type="pmid">23084249</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kwon</surname> <given-names>IK</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Han</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>K</given-names></name>. <article-title>Analysis on the current status of targeted drug delivery to tumors</article-title>. <source>Journal of Controlled Release</source>. <year>2012</year>;<volume>164</volume>(<issue>2</issue>):<fpage>108</fpage>–<lpage>114</lpage>. Drug Delivery and Cancer: Today’s Challenges, Tomorrow’s Directions. Available from: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.1016/j.jconrel.2012.07.010" xlink:type="simple">https://dx.doi.org/10.1016/j.jconrel.2012.07.010</ext-link>. <object-id pub-id-type="pmid">22800574</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cukierman</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Khan</surname> <given-names>DR</given-names></name>. <article-title>The benefits and challenges associated with the use of drug delivery systems in cancer therapy</article-title>. <source>Biochemical Pharmacology</source>. <year>2010</year>;<volume>80</volume>(<issue>5</issue>):<fpage>762</fpage>–<lpage>770</lpage>. Targeted Cancer Therapy. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bcp.2010.04.020" xlink:type="simple">http://dx.doi.org/10.1016/j.bcp.2010.04.020</ext-link>. <object-id pub-id-type="pmid">20417189</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eales</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Hollinshead</surname> <given-names>KER</given-names></name>, <name name-style="western"><surname>Tennant</surname> <given-names>DA</given-names></name>. <article-title>Hypoxia and metabolic adaptation of cancer cells</article-title>. <source>Oncogenesis</source>. <year>2016</year>;<volume>5</volume>:<fpage>e190</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.1038/oncsis.2015.50" xlink:type="simple">https://dx.doi.org/10.1038/oncsis.2015.50</ext-link>. <object-id pub-id-type="pmid">26807645</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>WR</given-names></name>, <name name-style="western"><surname>Hay</surname> <given-names>MP</given-names></name>. <article-title>Targeting hypoxia in cancer therapy</article-title>. <source>Nat Rev Canc</source>. <year>2011</year>;<volume>11</volume>(<issue>6</issue>):<fpage>393</fpage>–<lpage>410</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrc3064" xlink:type="simple">http://dx.doi.org/10.1038/nrc3064</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ichim</surname> <given-names>CV</given-names></name>. <article-title>Revisiting immunosurveillance and immunostimulation: Implications for cancer immunotherapy</article-title>. <source>Journal of Translational Medicine</source>. <year>2005</year> <month>Feb</month>;<volume>3</volume>(<issue>1</issue>):<fpage>8</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1479-5876-3-8" xlink:type="simple">https://doi.org/10.1186/1479-5876-3-8</ext-link>. <object-id pub-id-type="pmid">15698481</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Khanna</surname> <given-names>R</given-names></name>. <article-title>Tumour surveillance: Missing peptides and MHC molecules</article-title>. <source>Immunol Cell Biol</source>. <year>1998</year>;<volume>76</volume>(<issue>1</issue>):<fpage>20</fpage>–<lpage>6</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1046/j.1440-1711.1998.00717.x" xlink:type="simple">http://dx.doi.org/10.1046/j.1440-1711.1998.00717.x</ext-link>. <object-id pub-id-type="pmid">9553772</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Comber</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Philip</surname> <given-names>R</given-names></name>. <article-title>MHC class I antigen presentation and implications for developing a new generation of therapeutic vaccines</article-title>. <source>Therapeutic Advances in Vaccines</source>. <year>2014</year>;<volume>2</volume>(<issue>3</issue>):<fpage>77</fpage>–<lpage>89</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1177/2051013614525375" xlink:type="simple">http://dx.doi.org/10.1177/2051013614525375</ext-link>. <object-id pub-id-type="pmid">24790732</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Osborne</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Flecther</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Pitt-Francis</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Maini</surname> <given-names>PK</given-names></name>, <name name-style="western"><surname>Gavaghan</surname> <given-names>DJ</given-names></name>. <article-title>Comparing individual-based approaches to modelling the self-organization of multicellular tissues</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>2</issue>):<fpage>e1005387</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1005387" xlink:type="simple">http://dx.doi.org/10.1371/journal.pcbi.1005387</ext-link>. <object-id pub-id-type="pmid">28192427</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Somogyi</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Bouteiller</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Glazier</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>König</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Medley</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Swat</surname> <given-names>MH</given-names></name>, <etal>et al</etal>. <article-title>libRoadRunner: a high performance SBML simulation and analysis library</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>20</issue>):<fpage>3315</fpage>–<lpage>21</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv363" xlink:type="simple">http://dx.doi.org/10.1093/bioinformatics/btv363</ext-link>. <object-id pub-id-type="pmid">26085503</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Byrne</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Drasdo</surname> <given-names>D</given-names></name>. <article-title>Individual-based and continuum models of growing cell populations: a comparison</article-title>. <source>J Math Biol</source>. <year>2009</year>;<volume>58</volume>(<issue>4–5</issue>):<fpage>657</fpage>–<lpage>87</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00285-008-0212-0" xlink:type="simple">http://dx.doi.org/10.1007/s00285-008-0212-0</ext-link>. <object-id pub-id-type="pmid">18841363</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hoops</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sahle</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gauges</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pahle</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Simus</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>COPASI—a COmplex PAthway SImulator</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>24</issue>):<fpage>3067</fpage>–<lpage>3074</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl485" xlink:type="simple">http://dx.doi.org/10.1093/bioinformatics/btl485</ext-link>. <object-id pub-id-type="pmid">17032683</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chu</surname> <given-names>YS</given-names></name>, <name name-style="western"><surname>Dufour</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Thiery</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Perez</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Pincet</surname> <given-names>F</given-names></name>. <article-title>Johnson-Kendall-Roberts Theory Applied to Living Cells</article-title>. <source>Phys Rev Lett</source>. <year>2005</year> <month>Jan</month>;<volume>94</volume>:<fpage>028102</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.94.028102" xlink:type="simple">https://doi.org/10.1103/PhysRevLett.94.028102</ext-link>. <object-id pub-id-type="pmid">15698233</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005991.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buske</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Galle</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Barker</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Aust</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Clevers</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Loeffler</surname> <given-names>M</given-names></name>. <article-title>A Comprehensive Model of the Spatio-Temporal Stem Cell and Tissue Organisation in the Intestinal Crypt</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year> <day>01</day>;<volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>13</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1001045" xlink:type="simple">http://dx.doi.org/10.1371/journal.pcbi.1001045</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005991.ref053">
<label>53</label>
<mixed-citation publication-type="other" xlink:type="simple">National Science Foundation. Award Abstract 1720625: Network for Computational Nanotechnology-Engineered nanoBIO Node (PI: Fox; Co-PIs: Glazier, Douglas, Jadhao and Macklin); 2017–22. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1720625" xlink:type="simple">https://www.nsf.gov/awardsearch/showAward?AWD_ID=1720625</ext-link>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>