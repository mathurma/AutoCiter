<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01479</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006578</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Physical chemistry</subject><subj-group><subject>Chemical bonding</subject><subj-group><subject>Hydrogen bonding</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject><subj-group><subject>Free energy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure prediction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure prediction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Condensed matter physics</subject><subj-group><subject>Solid state physics</subject><subj-group><subject>Crystallography</subject><subj-group><subject>Crystal structure</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure comparison</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure comparison</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Trajectory-based training enables protein simulations with accurate folding and Boltzmann ensembles in cpu-hours</article-title>
<alt-title alt-title-type="running-head">Trajectory-based training enables rapid simulations with accurate folding and ensembles</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6169-6580</contrib-id>
<name name-style="western">
<surname>Jumper</surname> <given-names>John M.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3687-7114</contrib-id>
<name name-style="western">
<surname>Faruk</surname> <given-names>Nabil F.</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Freed</surname> <given-names>Karl F.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2871-7244</contrib-id>
<name name-style="western">
<surname>Sosnick</surname> <given-names>Tobin R.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Biochemistry and Molecular Biology, University of Chicago, Chicago, Illinois, USA</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Chemistry, and The James Franck Institute, University of Chicago, Chicago, Illinois, USA</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Graduate Program in Biophysical Sciences, University of Chicago, Chicago, Illinois, USA</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Institute for Biophysical Dynamics, University of Chicago, Chicago, Illinois, USA</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Dunbrack</surname>
<given-names>Roland L.</given-names>
<suffix>Jr.</suffix>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Fox Chase Cancer Center, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label>
<p>Current address: DeepMind, 5 New Street Square, London EC4A 3TW, UK</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">trsosnic@uchicago.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>12</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>27</day>
<month>12</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>12</issue>
<elocation-id>e1006578</elocation-id>
<history>
<date date-type="received">
<day>1</day>
<month>9</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>8</day>
<month>10</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Jumper et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006578"/>
<related-article ext-link-type="uri" id="related001" related-article-type="companion" xlink:href="info:doi/10.1371/journal.pcbi.1006342" xlink:type="simple">
<article-title>Accurate calculation of side chain packing and free energy with applications to protein molecular dynamics</article-title>
</related-article>
<abstract>
<p>An ongoing challenge in protein chemistry is to identify the underlying interaction energies that capture protein dynamics. The traditional trade-off in biomolecular simulation between accuracy and computational efficiency is predicated on the assumption that detailed force fields are typically well-parameterized, obtaining a significant fraction of possible accuracy. We re-examine this trade-off in the more realistic regime in which parameterization is a greater source of error than the level of detail in the force field. To address parameterization of coarse-grained force fields, we use the contrastive divergence technique from machine learning to train from simulations of 450 proteins. In our procedure, the computational efficiency of the model enables high accuracy through the precise tuning of the Boltzmann ensemble. This method is applied to our recently developed <italic>Upside</italic> model, where the free energy for side chains is rapidly calculated at every time-step, allowing for a smooth energy landscape without steric rattling of the side chains. After this contrastive divergence training, the model is able to <italic>de novo</italic> fold proteins up to 100 residues on a single core in days. This improved <italic>Upside</italic> model provides a starting point both for investigation of folding dynamics and as an inexpensive Bayesian prior for protein physics that can be integrated with additional experimental or bioinformatic data.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>All-atom biomolecular simulations are useful but often take months to simulate biologically relevant reactions. Coarse-grain folding simulations reduce the computational requirements; however, they typically have reduced accuracy and knowledge of the native state is required. Here, we show that a properly formulated coarse-grain model trained using modern machine learning methods can rival all-atom models for <italic>de novo</italic> protein folding and dynamics simulations. The <italic>Upside</italic> model’s success argues that simpler models that can be globally parameterized can rival more detailed but slower models whose parameterization is more challenging—more complexity does not necessarily equate to higher accuracy. <italic>Upside</italic>’s ready generation of Boltzmann ensembles allows for a wide range of computational studies of protein folding, dynamics and binding. Additionally, in studies that incorporate experimental or bioinformatics data, including sparse contact predictions, <italic>Upside</italic> provides an inexpensive Bayesian prior distribution over protein structures that may be updated using experimental information.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>National Science Foundation (US)</institution>
</funding-source>
<award-id>CHE-1363012</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Freed</surname> <given-names>Karl F.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000009</institution-id>
<institution>Foundation for the National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>GM055694</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2871-7244</contrib-id>
<name name-style="western">
<surname>Sosnick</surname> <given-names>Tobin R.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000009</institution-id>
<institution>Foundation for the National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>T32GM008720</award-id>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000076</institution-id>
<institution>Directorate for Biological Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>MCB-151722</award-id>
</award-group>
<award-group id="award005">
<funding-source>
<institution>Canadian Network for Research and Innovation in Machining Technology, Natural Sciences and Engineering Research Council of Canada (CA)</institution>
</funding-source>
<award-id>PGSD3-475231-2015</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3687-7114</contrib-id>
<name name-style="western">
<surname>Faruk</surname> <given-names>Nabil F.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This research is supported by the National Institute of Health General Medical Sciences grants GM55694 (TRS, KFF), and T32GM008720 (J Piccirilli); the National Science Foundation grants CHE-1363012 (KFF) and MCB-1517221 (B Roux); and the Natural Sciences and Engineering Research Council of Canada fellowship PGSD3-475231-2015 (NFF). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="18"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files. Trajectories can be obtained from Dryad (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.h9f8sb7" xlink:type="simple">https://doi.org/10.5061/dryad.h9f8sb7</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Since Anfinsen’s original demonstration that a protein’s sequence determines its structure, multiple computational strategies have been developed to predict a protein’s structure from its sequence. An additional facet of this challenge is to replicate the energy landscape that defines both the folding process and other dynamical properties. In the absence of other information, coarse-grained models with one or a few beads per residue are too simplistic for <italic>de novo</italic> structure prediction. C<sub><italic>β</italic></sub> level models having authentic protein backbones with <italic>ϕ</italic>/<italic>ψ</italic> dihedral angles, but lacking side chain rotamers, have achieved some success [<xref ref-type="bibr" rid="pcbi.1006578.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006578.ref003">3</xref>]. Within the last decade, all-atom, explicit solvent methods have become successful for the folding of some small proteins, although the ability to replicate the properties outside the native basin requires substantial improvement [<xref ref-type="bibr" rid="pcbi.1006578.ref004">4</xref>]. For the folding process, it is unclear which representation provides the optimal combination of detail and computational expense to replicate protein folding and dynamics. Integral to the choice of representation is which interactions to include, such as hydrogen bonding, van der Waals interactions and hydrophobic burial.</p>
<p>Another factor is the parameterization of the energy function with the training algorithm needing to balance the influences of all interactions. Protein thermodynamics reflects a delicate balance between the free energy of the folded and unfolded states. If one interaction is slightly too large, the entire landscape can be severely distorted. For example, if backbone hydrogen bonding energies are too large compared to backbone-solvent interactions (which includes hydrogen bonds between the backbone and water), an excess of hydrogen bonding ensues and pathways become dominated by unrealistically stable native- and non-native secondary structures. In an extreme situation, the lowest energy structure may have long helices involving nearly all residues.</p>
<p>The balancing of these various energies has been a major effort, and the balance is continually being adjusted as new force field biases are identified [<xref ref-type="bibr" rid="pcbi.1006578.ref005">5</xref>]. However, the adjustment of some parameters to correct one deficiency can inadvertently degrade performance of other quantities. In order to achieve the correct balance, all terms in the model should be trained together, rather than adjusted with an <italic>ad hoc</italic> procedure to correct each identified deficit.</p>
<p>To achieve this balance with a detailed interaction model, we use our recently developed, extremely rapid <italic>Upside</italic> implicit solvent molecular dynamics program [<xref ref-type="bibr" rid="pcbi.1006578.ref006">6</xref>]. Each residue In <italic>Upside</italic> is represented with a polypeptide backbone and a side chain interaction site or bead which can adopt up to 6 positions representing up to six different side chain <italic>χ</italic><sub>1</sub>/<italic>χ</italic><sub>2</sub> states. The key advance of the model is the smoothing of the energy surface by approximate analytic integration of free energies for the side chains’ discrete states. When trained to predict side chain conformations from the Protein Data Bank (PDB), the method can fold a few small proteins with moderate accuracy in a cpu core-day. The majority of speedup of the procedure is a result of a unique side chain algorithm which directly calculates the side chain probability distribution and the free energy. This free energy calculation, performed at every time step, avoids the steric rattling of the side chains which can occur in the condensed phase in all-atom simulations, and so allows the backbone to move on a smoother energy landscape.</p>
<p>Here, we demonstrate that we can achieve <italic>de novo</italic> folding for a diverse collection of proteins by combining our fast-equilibrating <italic>Upside</italic> model with a contrastive divergence procedure that optimizes the stability of the native well. We demonstrate that gradient descent on energy terms using only data from sampled trajectories is sufficient to parameterize a protein model with tens of thousands of parameters. The resulting parameters are sufficiently balanced and accurate to achieve reversible folding for many proteins in our validation set. In addition, the resulting model is an excellent starting point for large scale protein simulations using more detailed models as well as the integration of large quantities of external information (such as predictions of residue contacts).</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Coarse-grained model</title>
<p>In our recently-developed <italic>Upside</italic> model, only the N, C<sub><italic>α</italic></sub>, and C atoms for each residue undergo dynamics. This simple representation of the protein allows for molecular dynamics on a smooth landscape but also makes it challenging to include the entirety of the protein physics. To address this challenge, we build additional layers of derived coordinates during the energy computation, much like virtual sites in a traditional force field. These layers include amide hydrogens, carbonyl oxygens, hydrogen bonding and residue burial scores, and the possible locations of protein side chains. All of the derivative information required is backpropagated through these layers of representation during the computation of forces for molecular dynamics. The side chain positions are the most challenging to represent because we must solve a side chain packing problem in order to determine the distribution of side chain positions for a given backbone geometry. To pack the side chains probabilistically and obtain a side chain free energy, we use a rapid self-consistent iteration as described in our recent work [<xref ref-type="bibr" rid="pcbi.1006578.ref006">6</xref>] (<xref ref-type="fig" rid="pcbi.1006578.g001">Fig 1</xref>). The major computational steps are:
<list list-type="simple">
<list-item><label>Step 1</label> <p>The loop begins (upper left corner) with each residue in the protein being represented with 3 backbone atoms, the N, C<sub><italic>α</italic></sub> and C. Based on the position of these atoms, the carbonyl oxygen, O, and amide proton, H, are deterministically placed.</p></list-item>
<list-item><label>Step 2</label> <p>Each side chain, represented by a single oriented bead, is assigned an initial probability for being in 1–6 states, depending on the residue type and the average frequency observed in the PDB. The state of the bead is defined by its position and an orientation, (x,y,z,v), where v is a unit vector, relative to the peptide plane.</p></list-item>
<list-item><label>Step 3</label> <p>The pair-wise state probabilities of all side chains are simultaneously and rapidly calculated using belief propagation to produce the lowest system free energy.</p></list-item>
<list-item><label>Step 4</label> <p>Forces on the 3 backbone atoms, as well as on the O, H and side chain beads are calculated from the derivative of the free energy.</p></list-item>
<list-item><label>Step 5</label> <p>Forces on the O, H and bead are “pulled back” and added to the forces on the 3 backbone atoms by reversing the placement process.</p></list-item>
<list-item><label>Step 6</label> <p>Langevin dynamics (implicit solvent with friction) are run on the 3 backbone atoms using the forces calculated in Steps 4 and 5.</p></list-item>
</list></p>
<fig id="pcbi.1006578.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006578.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Computational inner loop for <italic>Upside</italic>.</title>
<p>The positions of the protein side chains are added during each energy or force computation, then an approximate Boltzmann distribution is estimated for the side chains, and the free energy of the side chains is computed using the approximate Boltzmann ensemble. The resulting energy derivatives are pulled back to the backbone coordinates to update the backbone momenta.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006578.g001" xlink:type="simple"/>
</fig>
<p>The majority of parameters in <italic>Upside</italic> define the pairwise interactions between side chains, where each side chain is represented by a single directional bead. Concretely, each interaction pair is described by bead positions <italic>y</italic><sub>1</sub> and <italic>y</italic><sub>2</sub> and their orientations <italic>n</italic><sub>1</sub> and <italic>n</italic><sub>2</sub>. From the distance <italic>r</italic><sub>12</sub> = |<italic>y</italic><sub>1</sub> − <italic>y</italic><sub>2</sub>| and displacement unit vector <italic>n</italic><sub>12</sub> = (<italic>y</italic><sub>1</sub> − <italic>y</italic><sub>2</sub>)/<italic>r</italic><sub>12</sub> are calculated. All of the pairwise interactions have the functional form
<disp-formula id="pcbi.1006578.e001"><alternatives><graphic id="pcbi.1006578.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006578.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mi>V</mml:mi> <mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mi>κ</mml:mi> <mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mtext>radial</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mn>12</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mspace width="1em"/><mml:mrow><mml:msub><mml:mtext>ang</mml:mtext> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>−</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>12</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="2pt"/><mml:msub><mml:mtext>ang</mml:mtext> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>12</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>V</mml:mi> <mml:mtext>angular</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mn>12</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>V</italic><sub>radial</sub>, ang<sub>1</sub>, ang<sub>2</sub>, and <italic>V</italic><sub>angular</sub> are smooth curves represented by cubic splines for increased flexibility, rather than fixed functional forms such as a van der Waals 6-12 potential. The potential for each of the <inline-formula id="pcbi.1006578.e002"><alternatives><graphic id="pcbi.1006578.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006578.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:mn>20</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mn>20</mml:mn> <mml:mo>=</mml:mo> <mml:mn>210</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> types of amino acid pairs are described with 62 spline coefficients per pair, giving 13020 parameters. There are also five interaction sites on the backbone, roughly representing the H, O, N, C<sub><italic>α</italic></sub>, and C atoms, with 54 parameters per interaction due to a smaller cutoff distance (10 versus 8 Å). The total number of side chain-backbone interaction parameters is 5400.</p>
<p>We add an additional term to capture desolvation effects by computing the approximate number of side chains <italic>N</italic><sub><italic>i</italic></sub> within a hemisphere above the C<sub><italic>β</italic></sub> (see <xref ref-type="supplementary-material" rid="pcbi.1006578.s001">S1 Text</xref> in Supporting Information). High values of <italic>N</italic><sub><italic>i</italic></sub> correspond to buried residues. The total energy is
<disp-formula id="pcbi.1006578.e003"><alternatives><graphic id="pcbi.1006578.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006578.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mtext>env</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msubsup><mml:mi>v</mml:mi> <mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mtext>env</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
which is the sum of the values from individual <inline-formula id="pcbi.1006578.e004"><alternatives><graphic id="pcbi.1006578.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006578.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mi>v</mml:mi> <mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mtext>env</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> potential curves for each residue <italic>i</italic>. Although more sophisticated solvation potentials exist, our implementation is very fast and easily optimized by the contrastive divergence procedure, while remaining flexible enough to represent many of the solvation effects omitted by the pairwise side chain potential.</p>
<p>The backbone dihedral angle Ramachandran potential is <inline-formula id="pcbi.1006578.e005"><alternatives><graphic id="pcbi.1006578.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006578.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>Rama</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006578.e006"><alternatives><graphic id="pcbi.1006578.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006578.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msubsup><mml:mi>V</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>Rama</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> depends on the chemical identity of the <italic>i</italic> − 1, <italic>i</italic>, and <italic>i</italic> + 1 residues. The Ramachandran potentials are based on the turn, coil, or bridge (TCB) Ramachandran probability models in the NDRD backbone library [<xref ref-type="bibr" rid="pcbi.1006578.ref007">7</xref>]. We introduce a single parameter controlling extra stabilization of angles consistent with <italic>β</italic>-sheet geometries to allow training to counteract an observed tendency for our model to overstabilize helices. The backbone non-bonded interactions are governed by a distance- and angle-dependent hydrogen bonding potential whose magnitude (but not geometry) is chosen by contrastive divergence. The backbone N, C<sub><italic>α</italic></sub>, C<sub><italic>β</italic></sub>, and C feel a steric repulsive interaction when their internuclear distance is approximately 3.0 Å.</p>
<p>Source code for <italic>Upside</italic> can be obtained from <ext-link ext-link-type="uri" xlink:href="https://github.com/sosnicklab/upside-md" xlink:type="simple">https://github.com/sosnicklab/upside-md</ext-link>, and the results of this paper can be reproduced using the version tagged <monospace>trajectory_training_paper</monospace>.</p>
</sec>
<sec id="sec004">
<title>Contrastive divergence</title>
<p>Our implementation of contrastive divergence considers two ensembles, one closely restrained to the native (crystal) structure and another that is free to diffuse away during simulations (<xref ref-type="fig" rid="pcbi.1006578.g002">Fig 2</xref>). In a perfect model, an unrestrained ensemble would remain close to the native structure. For an inexact model, differences arise, such as an excess of backbone-backbone hydrogen bonding in the free ensemble. Reducing the hydrogen bond energy would shift the free ensemble closer to the native ensemble. The parameter modification must be small, however, because shifting the hydrogen bond energy may adversely affect other features of the ensemble, e.g., by reducing the burial of hydrophobic residues. Accordingly, after simulations are run on the first set or “minibatch” of 12 proteins in our 456 protein training set, we modify all the parameters with small updates to shift the simulation ensemble to better match the native-restrained ensemble. Simulations are repeated on the next of the 38 subsets of 12 proteins, and the paramters are updated again. The algorithm is converged when no parameter can be altered to shift the free ensemble closer to the native-restrained ensemble.</p>
<fig id="pcbi.1006578.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006578.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Contrastive divergence training.</title>
<p>(A) Schematic of the training procedure depicting how the native state is stabilized relative to other states upon parameter updates. (B)-(E) In all plots, the blue curves indicate larger initial step-size training and the green plots indicate smaller step-size (fine-tuning). (B) The upper left plot shows the decline in minibatch-averaged RMSD over the course of the optimization. The remaining plots show (C) the convergence of the hydrogen bonding and side chain-side chain interaction parameters over the optimization for (D) Met-Met and (E) Val-Val potential. The larger step-size optimization of the side chain parameters exhibits large oscillations that inhibit convergence.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006578.g002" xlink:type="simple"/>
</fig>
<p>The free ensemble is generated using 5000 time units of dynamics (approximately 10 wall-clock minutes), with the first half being discarded as equilibration. Unless the native state is particularly unstable, this time is insufficient for exploration of the conformational landscape much beyond the native basin (RMSD within 6 Å) and so produces only a locally-equilibrated ensemble.</p>
<p>The native ensemble is traditionally defined as a single conformation. This <italic>δ</italic>-function distribution is problematic for proteins because they are dynamical molecules. Additionally, the solution ensemble may differ from the crystal structure for multiple reasons, including crystallographic packing. To reduce the impact of these issues, we replace the exact ensemble structures with the ensemble restrained to be near the crystal structure, within approximately 1 Å C<sub><italic>α</italic></sub>-RMSD. This procedure is analogous to the restrained equilibration of crystal structures required to prepare systems for all-atom molecular dynamics. To account for changing parameters, we apply the restrained relaxation at every optimizer step.</p>
<p>After generation of the free and native-restrained ensembles, we change the energy parameters <italic>α</italic><sub><italic>i</italic></sub>, where <italic>i</italic> is the optimizer step, in proportion to the amount that the change can differentiate the two ensembles. This procedure is a form of gradient descent to reduce the “distance” between the free and native-restrained ensembles,
<disp-formula id="pcbi.1006578.e007"><alternatives><graphic id="pcbi.1006578.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006578.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>ϵ</mml:mi> <mml:mi>M</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:mo>(</mml:mo> <mml:mo>⟨</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>V</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msub><mml:mo>⟩</mml:mo> <mml:mtext>restrained</mml:mtext></mml:msub> <mml:mo>−</mml:mo> <mml:mo>⟨</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>V</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msub><mml:mo>⟩</mml:mo> <mml:mtext>free</mml:mtext></mml:msub> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>ϵ</italic> the step size, <italic>M</italic> is the number of proteins, and <italic>a</italic> indexes the simulated proteins. The quantity <inline-formula id="pcbi.1006578.e008"><alternatives><graphic id="pcbi.1006578.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006578.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mo>〈</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>V</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msub><mml:mo>〉</mml:mo> <mml:mtext>restrained</mml:mtext></mml:msub> <mml:mo>−</mml:mo> <mml:mo>〈</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>V</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msub><mml:mo>〉</mml:mo> <mml:mtext>free</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> represents a pseudo-derivative of the free energy of restraining the simulation to be near the crystal structure (see SI for details). In the limit that the simulation duration is infinite, this difference is the exact derivative of the free energy. In practice, this difference chooses a suitable direction to improve the parameters.</p>
<p>The simulations use temperature replica exchange with eight replicas to enhance barrier crossing [<xref ref-type="bibr" rid="pcbi.1006578.ref008">8</xref>], while the temperature intervals of the replicas scale with <inline-formula id="pcbi.1006578.e009"><alternatives><graphic id="pcbi.1006578.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006578.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:msub><mml:mi>N</mml:mi> <mml:mtext>res</mml:mtext></mml:msub></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> to encourage efficient replica exchange for proteins of various sizes. The progress of the replica exchange is monitored by the average RMSD-to-crystal structure over the simulation for each “minibatch”, the 12 protein subset used for a single gradient-descent step.</p>
</sec>
</sec>
<sec id="sec005" sec-type="results">
<title>Results</title>
<sec id="sec006">
<title>Training</title>
<p>The parameters are initially set to those used to optimize side chain (<italic>χ</italic><sub>1</sub>) accuracy [<xref ref-type="bibr" rid="pcbi.1006578.ref006">6</xref>]. The contrastive divergence training rapidly improves the model’s average RMSD over a minibatch from 6 Å to 3 Å. This decline is accompanied by rapid change in the parameters. To reduce parameter fluctuations and fine-tune the results, we reduce the optimizer step size by a factor of four after two full passes through the 38 minibatches.</p>
<p>Although the slope has greatly decreased of RMSD change with respect to the number of steps over the iterations, there are indications that the parameters have not yet converged. Earlier tests, however, showed that continuing the contrastive divergence until convergence does not necessarily produce better results, as has been previously observed [<xref ref-type="bibr" rid="pcbi.1006578.ref009">9</xref>]. When large barriers surround the native states, minimal relaxation of the conformation occurs, which in turn provides little new information, and further fine-tuning may even <italic>reduce</italic> the accuracy of the model. Potentially the decreased exploration in the native well in the later stages overtrains the model to distinguish between native and near-native structure at the expense distinguishing against a more diverse ensemble. Early termination of optimization has been observed to favor simpler models [<xref ref-type="bibr" rid="pcbi.1006578.ref010">10</xref>].</p>
<p>The hydrogen bond strength unexpectedly appears to converge to a significantly smaller value during the late, fine-tuning stage than during the early phase with larger optimizer steps. We speculate that the extra noise in the side chain interactions during the larger optimizer steps may in aggregate cause stronger side chain interactions for the protein. This effect would necessitate a large hydrogen bond energy to balance the increase in side chain interactions. The final pair-wise energy functions between the side chain beads and either the backbone carbonyl oxygen or the amide proton, and the bead-bead interactions are shown in <xref ref-type="fig" rid="pcbi.1006578.g003">Fig 3</xref>.</p>
<fig id="pcbi.1006578.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006578.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Representative pair interaction potentials from the contrastive divergence training.</title>
<p>(A) Side chain bead-to-carbonyl oxygen and bead-to-amide proton (blue/red) and (B) side chain bead-to-bead (blue/green). Thin lines indicate <italic>V</italic><sub>radial</sub>(<italic>r</italic>) while thick lines indicate <italic>V</italic><sub>radial</sub>(<italic>r</italic>) + <italic>V</italic><sub>angular</sub>(<italic>r</italic>) with a plot range of (−6kT, 6kT). The heat maps show the angular product ang<sub>1</sub>(<italic>θ</italic><sub>1</sub>) ang<sub>2</sub>(<italic>θ</italic><sub>2</sub>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006578.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec007">
<title>Accuracy of structure prediction</title>
<p>Contrastive divergence training has been shown to be effective for many machine learning problems [<xref ref-type="bibr" rid="pcbi.1006578.ref011">11</xref>], even without having simulations that converge to the Boltzmann ensemble. To test the accuracy of contrastive divergence on our protein model, we attempt <italic>de novo</italic> folding of a benchmark set of small, fast-folding proteins similar to those used in references [<xref ref-type="bibr" rid="pcbi.1006578.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1006578.ref014">14</xref>] as well as various CASP11 targets investigated by other physics-based approaches (Figs <xref ref-type="fig" rid="pcbi.1006578.g004">4</xref> and <xref ref-type="fig" rid="pcbi.1006578.g005">5</xref>) [<xref ref-type="bibr" rid="pcbi.1006578.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1006578.ref016">16</xref>]. Before training, we remove homologous proteins from the training set to help ensure that this would be a true <italic>de novo</italic> prediction.</p>
<fig id="pcbi.1006578.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006578.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Predicted structures and C<sub><italic>α</italic></sub>-RMSD distributions.</title>
<p>After equilibration phase for the lowest temperature of replica exchange simulations (see <xref ref-type="supplementary-material" rid="pcbi.1006578.s001">S1 Text</xref>). The simulations start from either the native (blue) or a random unfolded state (red). For the refolding simulations, the lowest C<sub><italic>α</italic></sub>-RMSD to native structures is provided along with the value for the centroid of largest cluster (in parentheses). RMSD calculations exclude three residues at the amino- and carboxy-termini to account for possible disorder at the ends. Each replica is run for about three days with one CPU-core.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006578.g004" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006578.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006578.g005</object-id>
<label>Fig 5</label>
<caption>
<title><italic>Upside</italic>, UNRES and MELD’s performance on seven CASP11 Targets.</title>
<p>(A) Hubbard plots for the centroid of <italic>Upside</italic>’s top five clusters are compared to the UNRES’s and MELD’s five submitted structures. The length and the relevant residue range used in CASP11 analysis for each protein is shown along with the structure. (B) <italic>Upside</italic>’s secondary structure predictions for the centroid of the top cluster (C<sub><italic>α</italic></sub>-RMSD and secondary structure accuracy provided at top). The sequences provided by CASP11 organizers can be longer than the sequences used for evaluation due to disorder (e.g., for T0769-D1, simulations are conducted on 112 residues, but only the 97 folded residues are evaluated). The RMSD values provided are based on the CASP11-defined folded regions, and hence may differ slightly than those provided in <xref ref-type="fig" rid="pcbi.1006578.g004">Fig 4</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006578.g005" xlink:type="simple"/>
</fig>
<p>Two temperature replica exchange simulations are run for each of the 23 proteins (14 replicas each). The first set is initialized from the native configuration to assess the stability of the experimental structure for the potential obtained from contrastive divergence training. The second set is initialized from an unfolded state (random Ramachandran <italic>ϕ</italic> and <italic>ψ</italic> angles) to test <italic>Upside</italic>’s capability to find the native structure which is reflection of both the accuracy of the energy function and the method’s ability to search conformational space. Each range of temperatures is chosen to be large enough to cover the unfolding transition for each given protein. We judge the accuracy and equilibration from the histograms of the C<sub><italic>α</italic></sub>-RMSD from the native structure after discarding the initial third of the simulation as equilibration (<xref ref-type="fig" rid="pcbi.1006578.g004">Fig 4</xref>).</p>
<p>The majority of the proteins show a small number of well-defined basins that represent the dominant conformations with the current potential. While the simulations often produce several conformations quickly, equilibration of their populations takes longer, on the order of CPU-days for some proteins, though still extremely short in comparison to typical molecular dynamics simulations.</p>
<p>For all 20 proteins below 100 residues, the lowest C<sub><italic>α</italic></sub>-RMSD structure obtained starting from an unfolded state is within 5 Å of the native state (54% within 3 Å). In some cases, the lowest C<sub><italic>α</italic></sub>-RMSD structure is in the largest cluster, while for other proteins, the best structure is in a minor cluster even when it is within 3 Å (e.g., gpW, NTL9). The designed 3-helix bundle, <italic>α</italic>3d [<xref ref-type="bibr" rid="pcbi.1006578.ref017">17</xref>], has a mirror image as a second heavily populated cluster.</p>
<p>When the native-initialized and unfolded-initialized structures have similar C<sub><italic>α</italic></sub>-RMSD distributions, the simulations are likely converged. Half of the proteins are approximately converged by this criterion (e.g., BBA, protein B, homeo domain, <italic>α</italic>3d and WW), but others are not, (e.g., protein L and ubiquitin). Convergence is achieved for a variety of proteins with the native or near-native structure being the dominant conformation (e.g., BBA, homeo domain, protein B). These proteins represent the ideal scenario in terms of both accuracy and convergence. But, convergence can be achieved even when the native conformation is not the dominant conformation (e.g., BBL, λ-repressor, NuG2). This result indicates that for these proteins, our energy function is inadequate in regards to identifying the native structure even though there is adequate sampling. For cspA, a relatively small protein having a complex all <italic>β</italic> fold, additional simulations run at constant temperature can find a stable structure having significantly lower C<sub><italic>α</italic></sub>-RMSD (3.6 rather than 6.1 Å); this finding points to the search process being the limiting factor rather than <italic>Upside</italic>’s energy function.</p>
<p>The <italic>Upside</italic> simulations tend to achieve the correct secondary structure with a small number of distinct tertiary arrangements. This diversity in tertiary structures occurs as mirrored three helix bundles for <italic>α</italic>3d and protein B, as well as the subtle re-arrangements of NuG2. For the three largest CASP11 targets we investigated (115–178 residues), the secondary structure performance is noticeable poorer, implying a strong coupling between secondary and tertiary structure formation for these larger systems (<xref ref-type="fig" rid="pcbi.1006578.g005">Fig 5</xref>).</p>
</sec>
<sec id="sec008">
<title>Comparison with other physics-based approaches</title>
<p>Simmerling and coworkers folded 17 sub93 residue proteins using GPUs to obtain a microsecond of simulation time per day with their pairwise Generalize Born (GB) model trained to reproduce Poisson–Boltzmann solvation along with their ff99SB force field [<xref ref-type="bibr" rid="pcbi.1006578.ref014">14</xref>]. Impressively, their replex protocol folded 16 of the 17 proteins to within 3 Å C<sub><italic>α</italic></sub>-RMSD although the top cluster was greater than 10Å for five of the six largest proteins. Over-all, the performance is very similar to <italic>Upside</italic>’s in that 1-3 Å C<sub><italic>α</italic></sub>-RMSD structures are achievable on most proteins but the structures are not always in the largest cluster.</p>
<p>For seven CASP11 targets between 65-178 residues, we compared <italic>Upside</italic> with two physics-based approaches that participated in CASP11 (<xref ref-type="fig" rid="pcbi.1006578.g005">Fig 5</xref>): the Cornell-Gdansk group’s coarse-grained united residue model “UNRES” [<xref ref-type="bibr" rid="pcbi.1006578.ref016">16</xref>] and MacCallum, Perez and Dill’s highly accelerated molecular simulation method “MELD” (Modeling Employing Limited Data), a Bayesian approach that utilizes physically-based heuristics combined with atomistic implicit solvent simulations [<xref ref-type="bibr" rid="pcbi.1006578.ref015">15</xref>]. It should be noted that both methods employ PsiPred, a secondary structure predictor employing evolutionary information [<xref ref-type="bibr" rid="pcbi.1006578.ref018">18</xref>]. In contrast, <italic>Upside</italic>’s secondary structures emerge during folding solely are a result of our energy function.</p>
<p>For T0765-D1, a 76 residue <italic>α</italic>/<italic>β</italic> protein, <italic>Upside</italic>’s major cluster contains the native fold (<xref ref-type="fig" rid="pcbi.1006578.g005">Fig 5</xref>). The performance is reflected in a low flat trace for the cluster centroid in the Hubbard plot of the Global Distance Test (GDT) versus sequence percentage. This performance is superior to all five of UNRES’s submissions (there were no MELD submissions). For T0769-D1, a 112 residue <italic>α</italic>/<italic>β</italic> protein, both <italic>Upside</italic> and MELD perform very well, with UNRES’s best submission being only slightly worse. For T0771-D1 and T0803-D1, 178 and 134 residue <italic>α</italic>/<italic>β</italic> proteins, respectively, neither <italic>Upside</italic> nor UNRES’s performance is very good (no MELD submissions). For T0773-D1, a 77 residue <italic>α</italic>/<italic>β</italic> protein, MELD performs extremely well while one of <italic>Upside</italic> structure also has the native fold. UNRES performance is much poorer. For T0816-D1, a 68 residue helical bundle, MELD performs astonishingly well while <italic>Upside</italic>’s and UNRES’s performances also are commendable. For T0855-D1, a 115 residue <italic>α</italic>/<italic>β</italic> protein, both MELD and UNRES perform similarly and better than <italic>Upside</italic>, but none succeed in finding the native fold. Generally, the three approaches are capable of folding proteins of up to 94 residues, but are challenged with larger proteins.</p>
</sec>
<sec id="sec009">
<title>Characterization of folding behavior</title>
<p>In constant temperature simulations, we observe reversible folding to the native state for a number of proteins in our test set in core-days (Figs <xref ref-type="fig" rid="pcbi.1006578.g006">6</xref> and <xref ref-type="fig" rid="pcbi.1006578.g007">7</xref>). The time scales of folding indicated by these trajectories imply that the time scales we employed in the contrastive divergence simulations are far less (often a factor of 100 or more) than required to equilibrate these proteins, implying that contrastive divergence is optimizing only over fluctuations in or near the native well.</p>
<fig id="pcbi.1006578.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006578.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Constant temperature simulations.</title>
<p>Trajectories are selected by the highest temperatures that still produce a significant population for the native state. Note that pivot Monte Carlo moves are attempted periodically which has little effect on folded dynamics but greatly decreases correlation time in the unfolded state.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006578.g006" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006578.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006578.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Constant temperature trajectory of ubiquitin.</title>
<p>Simulation conducted at T = 1.00, initialized from the native structure, with representative structures along the trajectory highlighted. The 2nd and 4th structures are chosen for having a high <italic>R</italic><sub>g</sub> while the last structure is chosen based on minimum RMSD (2.3 Å.) after achieving full unfolding. Red and blue colors in lower right panel refer to helical and sheet secondary structures.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006578.g007" xlink:type="simple"/>
</fig>
<p>Note that conditional on low hydrogen bonding, the radius of gyration (<italic>R</italic><sub>g</sub>) at high temperature and at the peak of the heat capacity are quite similar. This suggests the increase in <italic>R</italic><sub>g</sub> for the unfolded state as temperature increases is driven by a reduction in backbone-backbone hydrogen bonds rather than side chain effects.</p>
<p>Based on these results, two observations should be reconciled. The first observation is the presence of a sharp phase transition with a single peak for the heat capacity. The shape of the phase transition, but not its amplitude, is consistent with a cooperative folding transition. The second observation is the unrealistically large level of residual hydrogen bonding in the denatured state at temperature of the maximum in the heat capacity. Although the hydrogen bonding is less than that in the native state, the residual hydrogen bonding indicates that the transition is not fully cooperative. These observations may be explained by the essential feature of the contrastive divergence process, that it must balance the competing energy terms of the model so that no one energy dominates. More extensive training, for example using a more diverse ensembles that contain conformations outside the native well, may remove the excess hydrogen bonding.</p>
<p>The <italic>Upside</italic> model exhibits concerted melting behavior over a small range of temperatures (<xref ref-type="fig" rid="pcbi.1006578.g008">Fig 8</xref>). While the temperature of the model in <italic>Upside</italic> is not exactly comparable to a physical temperature, it is reasonable to assume <italic>T</italic> = 1 corresponds roughly to a temperature of 300-310 K. The ubiquitin transition occurs over a temperature range of approximately 0.07 temperature units, or approximately a 20 K range, similar to that observed experimentally [<xref ref-type="bibr" rid="pcbi.1006578.ref020">20</xref>].</p>
<fig id="pcbi.1006578.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006578.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Thermodynamic behavior.</title>
<p>The heat capacity is computed using the fluctuation relation <italic>C</italic><sub>p</sub> = (var <italic>E</italic>)/<italic>T</italic><sup>2</sup>. The self-avoiding random walk <italic>R</italic><sub>g</sub> is computing using <italic>R</italic><sub>g</sub> = (1.9Å)(<italic>N</italic><sub>res</sub>)<sup>0.6</sup> for chemically-denatured proteins [<xref ref-type="bibr" rid="pcbi.1006578.ref019">19</xref>]. In the upper two panels (A) and (B), the <italic>C</italic><sub>p</sub> and <italic>R</italic><sub>g</sub> values are obtained from simulations started from either the native (blue line) or a random unfolded state (red line). In the lower two panels (C) and (D), the brown points are from high temperature simulations, while the green points (unfolded state) and blue points (folded state) are from simulations at the peak of the heat capacity. The simulation units are converted to physical units by assuming that the physical energy unit is 0.6 kcal/mol and that <italic>T</italic> = 1 corresponds to 300 K.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006578.g008" xlink:type="simple"/>
</fig>
<p>Furthermore, our temperature-denatured states have high <italic>R</italic><sub>g</sub> near the midpoint of the transition, consistent with experimental results and inconsistent with many all-atom molecular dynamics folding simulations [<xref ref-type="bibr" rid="pcbi.1006578.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006578.ref021">21</xref>]. At the peak of the heat capacity, the <italic>R</italic><sub>g</sub> is ∼15% smaller than the predicted from experimental data while the <italic>R</italic><sub>g</sub> at high temperature is ∼10% larger than the experimental value. Both <italic>R</italic><sub>g</sub> values are significantly larger than those in most atomistic molecular dynamics simulations [<xref ref-type="bibr" rid="pcbi.1006578.ref004">4</xref>].</p>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>A major challenge in protein chemistry is to extract from a set of proteins the underlying interaction energies that capture the physiochemistry governing their folded structures adn dynamics. We addressed this challenge by showing that a strong connection exists between properties of the native basin and the rest of the protein’s conformational landscape, and this connection is strong enough to train a potential for <italic>de novo</italic> folding simulations. Furthermore, the resulting potential is inexpensive enough to equilibrate simulations of small proteins in CPU core-days on a commodity computer.</p>
<p>Specifically, we have developed a procedure involving extremely short simulations in the native energy well, coupled with optimization using contrastive divergence, to parameterize a sophisticated coarse-grain model. Underlying the model is a re-evaluation of the common assumption that increased detail is the path to greater accuracy. This requirement for detail is mitigated with trajectory-based training because less expensive models allow more extensive exploration leading to higher accuracy. We have also shown that very large numbers of parameters (even ∼20000 in our case) are no obstacle to producing accurate proteins models using trajectory-based training. While over-fitting is always a concern, the severity is greatly reduced because contrastive divergence is training <italic>against</italic> the vast possibilities of alternative protein conformations explored by conformational sampling. Additionally, contrastive divergence automatically obtains balanced parameters such that no particular interaction overwhelms the others. We contend that this balance between parameters is more important than the accuracy of any particular term.</p>
<p>Decoupling representations of protein physics is a key aspect of the <italic>Upside</italic> model. In particular, Upside decouples the representation of the protein used for dynamics, an N–C<sub><italic>α</italic></sub>–C backbone model, from the representation used for computing energies and forces, a complex representation that includes oriented side chain interactions. This combination allows us to build up the sophisticated coordinates needed to represent solvent exposure of side chains, geometry of hydrophobic packing, and side chain-backbone hydrogen bonding without the cost of running dynamical simulation on a complex model with slow equilibrium. The largest improvement comes from applying belief propagation to the side chain degrees of freedom so that we represent detailed side chain physics at the <italic>χ</italic><sub>1</sub>/<italic>χ</italic><sub>2</sub>-level without incurring the roughening of the energy landscape and slowing of the dynamics normally associated with detailed sterics of side chain interactions. It is an open question to determine how much molecular detail must be retained for accurate protein energetics, but <italic>Upside</italic> provides a flexible framework to explore these issues without compromising the simple backbone representation of dynamics.</p>
<sec id="sec011">
<title>Related work</title>
<p>Contrastive divergence optimization has been applied to Gō-like protein potentials sampled with crankshaft Monte Carlo moves [<xref ref-type="bibr" rid="pcbi.1006578.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006578.ref023">23</xref>]. These works optimized only tens of parameters, and the resulting model is used to fold protein G and 16-residue peptides.</p>
<p>Other studies have trained protein energy functions using libraries of decoys [<xref ref-type="bibr" rid="pcbi.1006578.ref024">24</xref>]. Such efforts are challenging because atomic energy functions have rugged energy landscapes where even small structural differences can produce large energy differences. This ruggedness implies that scoring decoys by energy without first relaxing them is problematic for the sharply-defined force fields necessary to describe protein physics, a problem that contrastive divergence avoids.</p>
<p>A distinction between contrastive divergence and traditional training methods, such as Z-score optimization [<xref ref-type="bibr" rid="pcbi.1006578.ref025">25</xref>], relates to the goal and the source of the decoys. In contrastive divergence, the critical task is to produce a high population of low RMSD structures with the model. Z-scoring training attempts to make the energy of the native state much lower than the average energy of an pre-constructed decoy library. This is problematic because the decoys may not have structures that exhibit the pathologies of a poorly-trained model. Additionally, we believe optimization should concentrate on the lowest energies that have significant Boltzmann probability, not the average energy which is dominated by highly-unlikely structures. Furthermore, it is difficult to evaluate the reliable energies of decoys without relaxing the decoys. Methods based on simulation ensembles (such as maximum likelihood and contrastive divergence) are well-defined and do not need pre-constructed decoy libraries.</p>
<p>Podtelezhnikov et al. [<xref ref-type="bibr" rid="pcbi.1006578.ref026">26</xref>] apply contrastive divergence to few-parameter protein models to optimize the parameters of hydrogen bond geometry. Their work is similar to this paper but narrower in scope.</p>
<p>The maximum likelihood method requires the computation of the derivative of the free energy, which involves a summation over an equilibrium ensemble. Such a requirement necessitates a very long simulation to update parameters. Still, this approach can be viable when used with very small proteins on which the simulations converge quickly. A variant of maximum likelihood is given in Ref. [<xref ref-type="bibr" rid="pcbi.1006578.ref027">27</xref>], where decoys are generated and a maximum likelihood model is fit to adjust the parameters to distinguish between near-native and far-from-native conformations. The potential is trained on a single protein, tryptophan cage, and then the resulting potential is applied to a number of <italic>α</italic>-helical proteins with some success.</p>
</sec>
<sec id="sec012">
<title>Time and temperature scale</title>
<p>The precise time scale and temperature scale of the <italic>Upside</italic> models is intentionally left arbitrary because the coarse-graining process may leave us without a linear relationship to physical time and temperature. The speed-up of <italic>Upside</italic> simulation due to the smoothing of side chain interactions is likely to have a disproportionate effect on time scales for condensed structures as compared to extended structures. Regardless, the equilibrium population distribution that determines the free energy is expected to be approximately correct, as well as the order of dynamical folding events. The precise relationship of <italic>Upside</italic> time scales to physical time scales is left to future work.</p>
</sec>
<sec id="sec013">
<title>Conclusion</title>
<p>By employing the computationally fast yet detailed <italic>Upside</italic> model, we can use multiple trajectories to train tens of thousands of parameters simultaneously to simulate protein folding and dynamics. The training successfully produces low-energy, native or near-native structures with sharp folding transitions for most of our validation proteins. The strategy’s success argues that simpler (in atomic representation) models that can be globally parameterized can rival more detailed but slower models whose parameterization is more challenging. We achieve success for some proteins in terms of accurately folding to low energy native state and achieve thermodynamic equilibration, but still fail on others. We hypothesize that the short-time contrastive divergence we are using does not provide a sufficient library of large changes in the tertiary structure to enable the potential to properly distinguish the various conformations. This issue will be addressed in future studies. Coupling large computational resources with Markov state models [<xref ref-type="bibr" rid="pcbi.1006578.ref028">28</xref>] should improve training of the <italic>Upside</italic> model by exploring a larger and more diverse conformational landscape on each contrastive divergence step.</p>
<p>The ready generation of Boltzmann ensembles allows for a wide range of computational studies of protein folding, dynamics, and binding. For example, computational screening of large numbers of proteins for foldability should be tractable as is the study of hydrogen exchange and folding kinetics. Additionally, in studies that incorporate experimental or bioinformatics data, including contact predictions, <italic>Upside</italic> provides an inexpensive Bayesian prior distribution over protein structures that may be updated using experimental information. This provides accurate predictions that make essential use of the totality of protein physics as encoded in the <italic>Upside</italic> model, while being inexpensive enough to allow validation and iteration on large numbers of proteins.</p>
</sec>
</sec>
<sec id="sec014">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006578.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006578.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Derivation, model, and optimization details.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Sheng Wang for helpful discussions during this research. We thank Carolyn Jumper for proofreading and editorial assistance.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006578.ref001"><label>1</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adhikari</surname> <given-names>AN</given-names></name>, <name name-style="western"><surname>Freed</surname> <given-names>KF</given-names></name>, <name name-style="western"><surname>Sosnick</surname> <given-names>TR</given-names></name>. <article-title>Simplified protein models: Predicting folding pathways and structure using amino acid sequences</article-title>. <source>Physical review letters</source>. <year>2013</year>;<volume>111</volume>(<issue>2</issue>):<fpage>028103</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.111.028103" xlink:type="simple">10.1103/PhysRevLett.111.028103</ext-link></comment> <object-id pub-id-type="pmid">23889448</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref002"><label>2</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simons</surname> <given-names>KT</given-names></name>, <name name-style="western"><surname>Bonneau</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ruczinski</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>D</given-names></name>. <article-title>Ab initio protein structure prediction of CASP III targets using ROSETTA</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>1999</year>;<volume>37</volume>(<issue>S3</issue>):<fpage>171</fpage>–<lpage>176</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/(SICI)1097-0134(1999)37:3+%3C171::AID-PROT21%3E3.0.CO;2-Z" xlink:type="simple">10.1002/(SICI)1097-0134(1999)37:3+%3C171::AID-PROT21%3E3.0.CO;2-Z</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006578.ref003"><label>3</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moult</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fidelis</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kryshtafovych</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schwede</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tramontano</surname> <given-names>A</given-names></name>. <article-title>Critical assessment of methods of protein structure prediction: Progress and new directions in round XI</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2016</year>;<volume>84</volume>(<issue>S1</issue>):<fpage>4</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.25064" xlink:type="simple">10.1002/prot.25064</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006578.ref004"><label>4</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Skinner</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Gichana</surname> <given-names>EK</given-names></name>, <name name-style="western"><surname>Baxa</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Hinshaw</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Freed</surname> <given-names>KF</given-names></name>, <etal>et al</etal>. <article-title>Benchmarking all-atom simulations using hydrogen exchange</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>45</issue>):<fpage>15975</fpage>–<lpage>15980</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1404213111" xlink:type="simple">10.1073/pnas.1404213111</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006578.ref005"><label>5</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Best</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Hummer</surname> <given-names>G</given-names></name>. <article-title>Optimized molecular dynamics force fields applied to the helix- coil transition of polypeptides</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2009</year>;<volume>113</volume>(<issue>26</issue>):<fpage>9004</fpage>–<lpage>9015</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/jp901540t" xlink:type="simple">10.1021/jp901540t</ext-link></comment> <object-id pub-id-type="pmid">19514729</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref006"><label>6</label> <mixed-citation publication-type="other" xlink:type="simple">Jumper JM, Freed KF, Sosnick TR. Maximum-likelihood, self-consistent side chain free energies with applications to protein molecular dynamics. arXiv preprint arXiv:161007277. 2016;.</mixed-citation></ref>
<ref id="pcbi.1006578.ref007"><label>7</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ting</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Shapovalov</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mitra</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Dunbrack</surname> <given-names>RL</given-names> <suffix>Jr</suffix></name>. <article-title>Neighbor-dependent Ramachandran probability distributions of amino acids developed from a hierarchical Dirichlet process model</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>(<issue>4</issue>):<fpage>e1000763</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000763" xlink:type="simple">10.1371/journal.pcbi.1000763</ext-link></comment> <object-id pub-id-type="pmid">20442867</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref008"><label>8</label> <mixed-citation publication-type="other" xlink:type="simple">Salakhutdinov RR. Learning in Markov random fields using tempered transitions. In: Advances in neural information processing systems; 2009. p. 1598–1606.</mixed-citation></ref>
<ref id="pcbi.1006578.ref009"><label>9</label> <mixed-citation publication-type="other" xlink:type="simple">Desjardins G, Courville A, Bengio Y, Vincent P, Delalleau O. Parallel tempering for training of restricted Boltzmann machines. In: Proceedings of the Thirteenth International Conference on Artificial Intelligence and Statistics. MIT Press Cambridge, MA; 2010. p. 145–152.</mixed-citation></ref>
<ref id="pcbi.1006578.ref010"><label>10</label> <mixed-citation publication-type="other" xlink:type="simple">Duvenaud D, Maclaurin D, Adams RP. Early Stopping as Nonparametric Variational Inference. In: Proceedings of the 19th International Conference on Artificial Intelligence and Statistics; 2016. p. 1070–1077.</mixed-citation></ref>
<ref id="pcbi.1006578.ref011"><label>11</label> <mixed-citation publication-type="other" xlink:type="simple">Carreira-Perpinan MA, Hinton G. On Contrastive Divergence Learning. In: AISTATS. vol. 10. Citeseer; 2005. p. 33–40.</mixed-citation></ref>
<ref id="pcbi.1006578.ref012"><label>12</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lindorff-Larsen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Piana</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dror</surname> <given-names>RO</given-names></name>, <name name-style="western"><surname>Shaw</surname> <given-names>DE</given-names></name>. <article-title>How fast-folding proteins fold</article-title>. <source>Science</source>. <year>2011</year>;<volume>334</volume>(<issue>6055</issue>):<fpage>517</fpage>–<lpage>520</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1208351" xlink:type="simple">10.1126/science.1208351</ext-link></comment> <object-id pub-id-type="pmid">22034434</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref013"><label>13</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adhikari</surname> <given-names>AN</given-names></name>, <name name-style="western"><surname>Freed</surname> <given-names>KF</given-names></name>, <name name-style="western"><surname>Sosnick</surname> <given-names>TR</given-names></name>. <article-title>De novo prediction of protein folding pathways and structure using the principle of sequential stabilization</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>43</issue>):<fpage>17442</fpage>–<lpage>17447</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1209000109" xlink:type="simple">10.1073/pnas.1209000109</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006578.ref014"><label>14</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nguyen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Maier</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Perrone</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Simmerling</surname> <given-names>C</given-names></name>. <article-title>Folding simulations for proteins with diverse topologies are accessible in days with a physics-based force field and implicit solvent</article-title>. <source>Journal of the American Chemical Society</source>. <year>2014</year>;<volume>136</volume>(<issue>40</issue>):<fpage>13959</fpage>–<lpage>13962</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ja5032776" xlink:type="simple">10.1021/ja5032776</ext-link></comment> <object-id pub-id-type="pmid">25255057</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref015"><label>15</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Perez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Morrone</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Brini</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>MacCallum</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Dill</surname> <given-names>KA</given-names></name>. <article-title>Blind protein structure prediction using accelerated free-energy simulations</article-title>. <source>Science advances</source>. <year>2016</year>;<volume>2</volume>(<issue>11</issue>):<fpage>e1601274</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/sciadv.1601274" xlink:type="simple">10.1126/sciadv.1601274</ext-link></comment> <object-id pub-id-type="pmid">27847872</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref016"><label>16</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Krupa</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mozolewska</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Wiśniewska</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yin</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Sieradzan</surname> <given-names>AK</given-names></name>, <etal>et al</etal>. <article-title>Performance of protein-structure predictions with the physics-based UNRES force field in CASP11</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>21</issue>):<fpage>3270</fpage>–<lpage>3278</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btw404" xlink:type="simple">10.1093/bioinformatics/btw404</ext-link></comment> <object-id pub-id-type="pmid">27378298</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref017"><label>17</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walsh</surname> <given-names>ST</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bryson</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Roder</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>DeGrado</surname> <given-names>WF</given-names></name>. <article-title>Solution structure and dynamics of a de novo designed three-helix bundle protein</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1999</year>;<volume>96</volume>(<issue>10</issue>):<fpage>5486</fpage>–<lpage>5491</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.96.10.5486" xlink:type="simple">10.1073/pnas.96.10.5486</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006578.ref018"><label>18</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McGuffin</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Bryson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>DT</given-names></name>. <article-title>The PSIPRED protein structure prediction server</article-title>. <source>Bioinformatics</source>. <year>2000</year>;<volume>16</volume>(<issue>4</issue>):<fpage>404</fpage>–<lpage>405</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/16.4.404" xlink:type="simple">10.1093/bioinformatics/16.4.404</ext-link></comment> <object-id pub-id-type="pmid">10869041</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref019"><label>19</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kohn</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Millett</surname> <given-names>IS</given-names></name>, <name name-style="western"><surname>Jacob</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zagrovic</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dillon</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Cingel</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Random-coil behavior and the dimensions of chemically unfolded proteins</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2004</year>;<volume>101</volume>(<issue>34</issue>):<fpage>12491</fpage>–<lpage>12496</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0403643101" xlink:type="simple">10.1073/pnas.0403643101</ext-link></comment> <object-id pub-id-type="pmid">15314214</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref020"><label>20</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jacob</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Krantz</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dothager</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Thiyagarajan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sosnick</surname> <given-names>TR</given-names></name>. <article-title>Early collapse is not an obligate step in protein folding</article-title>. <source>Journal of molecular biology</source>. <year>2004</year>;<volume>338</volume>(<issue>2</issue>):<fpage>369</fpage>–<lpage>382</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jmb.2004.02.065" xlink:type="simple">10.1016/j.jmb.2004.02.065</ext-link></comment> <object-id pub-id-type="pmid">15066438</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref021"><label>21</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jensen</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Blackledge</surname> <given-names>M</given-names></name>. <article-title>Testing the validity of ensemble descriptions of intrinsically disordered proteins</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>16</issue>):<fpage>E1557</fpage>–<lpage>E1558</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1323876111" xlink:type="simple">10.1073/pnas.1323876111</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006578.ref022"><label>22</label> <mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Podtelezhnikov</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Wild</surname> <given-names>DL</given-names></name>. <chapter-title>Inferring Knowledge Based Potentials Using Contrastive Divergence</chapter-title>. In: <source>Bayesian Methods in Structural Bioinformatics</source>. <publisher-name>Springer</publisher-name>; <year>2012</year>. p. <fpage>135</fpage>–<lpage>155</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006578.ref023"><label>23</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Várnai</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Burkoff</surname> <given-names>NS</given-names></name>, <name name-style="western"><surname>Wild</surname> <given-names>DL</given-names></name>. <article-title>Efficient parameter estimation of generalizable coarse-grained protein force fields using contrastive divergence: a maximum likelihood approach</article-title>. <source>Journal of chemical theory and computation</source>. <year>2013</year>;<volume>9</volume>(<issue>12</issue>):<fpage>5718</fpage>–<lpage>5733</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ct400628h" xlink:type="simple">10.1021/ct400628h</ext-link></comment> <object-id pub-id-type="pmid">24683370</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref024"><label>24</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tsai</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bonneau</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Morozov</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Kuhlman</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Rohl</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>D</given-names></name>. <article-title>An improved protein decoy set for testing energy functions for protein structure prediction</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2003</year>;<volume>53</volume>(<issue>1</issue>):<fpage>76</fpage>–<lpage>87</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.10454" xlink:type="simple">10.1002/prot.10454</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006578.ref025"><label>25</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liwo</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pincus</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Wawak</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Rackovsky</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ołdziej</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Scheraga</surname> <given-names>HA</given-names></name>. <article-title>A united-residue force field for off-lattice protein-structure simulations. II. Parameterization of short-range interactions and determination of weights of energy terms by Z-score optimization</article-title>. <source>Journal of computational chemistry</source>. <year>1997</year>;<volume>18</volume>(<issue>7</issue>):<fpage>874</fpage>–<lpage>887</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/(SICI)1096-987X(199705)18:7%3C849::AID-JCC1%3E3.0.CO;2-R" xlink:type="simple">10.1002/(SICI)1096-987X(199705)18:7%3C849::AID-JCC1%3E3.0.CO;2-R</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006578.ref026"><label>26</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Podtelezhnikov</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Ghahramani</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Wild</surname> <given-names>DL</given-names></name>. <article-title>Learning about protein hydrogen bonding by minimizing contrastive divergence</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2007</year>;<volume>66</volume>(<issue>3</issue>):<fpage>588</fpage>–<lpage>599</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.21247" xlink:type="simple">10.1002/prot.21247</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006578.ref027"><label>27</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zaborowski</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Jagieła</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Czaplewski</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hałabis</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lewandowska</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zmudzińska</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>A Maximum-Likelihood Approach to Force-Field Calibration</article-title>. <source>Journal of chemical information and modeling</source>. <year>2015</year>;<volume>55</volume>(<issue>9</issue>):<fpage>2050</fpage>–<lpage>2070</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/acs.jcim.5b00395" xlink:type="simple">10.1021/acs.jcim.5b00395</ext-link></comment> <object-id pub-id-type="pmid">26263302</object-id></mixed-citation></ref>
<ref id="pcbi.1006578.ref028"><label>28</label> <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bowman</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Beauchamp</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Boxer</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Pande</surname> <given-names>VS</given-names></name>. <article-title>Progress and challenges in the automated construction of Markov state models for full protein systems</article-title>. <source>The Journal of chemical physics</source>. <year>2009</year>;<volume>131</volume>(<issue>12</issue>):<fpage>124101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.3216567" xlink:type="simple">10.1063/1.3216567</ext-link></comment> <object-id pub-id-type="pmid">19791846</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>