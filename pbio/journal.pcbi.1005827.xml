<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005827</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00126</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>RNA structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>RNA</subject><subj-group><subject>RNA structure</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>RNA structure</subject><subj-group><subject>RNA structure prediction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>RNA</subject><subj-group><subject>RNA structure</subject><subj-group><subject>RNA structure prediction</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Condensed matter physics</subject><subj-group><subject>Solid state physics</subject><subj-group><subject>Crystallography</subject><subj-group><subject>Crystal structure</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence motif analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure prediction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure prediction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject><subj-group><subject>Free energy</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Base pair probability estimates improve the prediction accuracy of RNA non-canonical base pairs</article-title>
<alt-title alt-title-type="running-head">RNA non-canonical pair probability estimation</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9730-6038</contrib-id>
<name name-style="western">
<surname>Sloma</surname>
<given-names>Michael F.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2907-6557</contrib-id>
<name name-style="western">
<surname>Mathews</surname>
<given-names>David H.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Biochemistry &amp; Biophysics and Center for RNA Biology, University of Rochester Medical Center, Rochester, NY, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Biostatistics &amp; Computational Biology, University of Rochester Medical Center, Rochester, NY, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Chen</surname>
<given-names>Shi-Jie</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Missouri, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">David_Mathews@urmc.rochester.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>6</day>
<month>11</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<month>11</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>11</issue>
<elocation-id>e1005827</elocation-id>
<history>
<date date-type="received">
<day>20</day>
<month>1</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>17</day>
<month>10</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Sloma, Mathews</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005827"/>
<abstract>
<p>Prediction of RNA tertiary structure from sequence is an important problem, but generating accurate structure models for even short sequences remains difficult. Predictions of RNA tertiary structure tend to be least accurate in loop regions, where non-canonical pairs are important for determining the details of structure. Non-canonical pairs can be predicted using a knowledge-based model of structure that scores nucleotide cyclic motifs, or NCMs. In this work, a partition function algorithm is introduced that allows the estimation of base pairing probabilities for both canonical and non-canonical interactions. Pairs that are predicted to be probable are more likely to be found in the true structure than pairs of lower probability. Pair probability estimates can be further improved by predicting the structure conserved across multiple homologous sequences using the TurboFold algorithm. These pairing probabilities, used in concert with prior knowledge of the canonical secondary structure, allow accurate inference of non-canonical pairs, an important step towards accurate prediction of the full tertiary structure. Software to predict non-canonical base pairs and pairing probabilities is now provided as part of the RNAstructure software package.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Three dimensional RNA structure prediction methods are not yet able to accurately model the base pairs that are not in standard A-form helices, called non-canonical pairs. Non-canonical base pairs are crucial in determining the conformations of structures, but available algorithms to identify them have limited accuracy. We developed a new method, CycleFold, that can identify non-canonical base pairs using statistical methods that have proven successful in predicting A-form helices. Additionally, CycleFold incorporates evolutionary conservation to further improve accuracy. CycleFold provides a dramatic improvement in accuracy over previously available methods, and its output could be used to refine three dimensional structure predictions from any modeling software.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
<institution>National Institute of General Medical Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>R01 GM076485</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2907-6557</contrib-id>
<name name-style="western">
<surname>Mathews</surname>
<given-names>David H.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by National Institutes of Health, <ext-link ext-link-type="uri" xlink:href="https://www.nih.gov/" xlink:type="simple">https://www.nih.gov/</ext-link>, R01GM076485. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="0"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-11-16</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Software is available under the GNU GPL at <ext-link ext-link-type="uri" xlink:href="http://rna.urmc.rochester.edu" xlink:type="simple">http://rna.urmc.rochester.edu</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<sec id="sec002">
<title>RNA tertiary structure prediction</title>
<p>RNA plays a central role in all of life, acting as both a carrier of genetic information and as an active participant in numerous cellular processes, including pre-mRNA splicing and gene regulation via modulation of transcription and translation [<xref ref-type="bibr" rid="pcbi.1005827.ref001">1</xref>]. Determining the structure of an RNA is crucial to understand its function, and provides opportunities to design drugs that target the molecule, but the structure of the vast majority of RNA molecules is entirely unknown. As of 2016, the Protein Databank contained coordinates for 1233 RNA structures and 5914 protein-nucleic acid complexes [<xref ref-type="bibr" rid="pcbi.1005827.ref002">2</xref>], covering less than 2000 structural classes [<xref ref-type="bibr" rid="pcbi.1005827.ref003">3</xref>]. At the same time, the ENCODE project identified over 9000 long non-coding RNAs in the human genome alone [<xref ref-type="bibr" rid="pcbi.1005827.ref004">4</xref>]. Experimental methods to determine RNA tertiary structures at atomic resolution, such as NMR, X-ray crystallography, and cryo-electron microscopy, remain expensive, difficult, and time-consuming, so computational structure prediction methods, which have proven effective in predicting unknown protein structures [<xref ref-type="bibr" rid="pcbi.1005827.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1005827.ref006">6</xref>], are desirable to help investigators understand RNAs of unknown structure.</p>
<p>Given sufficient human expertise, manual structure modeling can produce high-quality predictions of structure. For example, the structure of the Group I self-splicing intron was modeled and subsequently many of the atomic interactions were confirmed by crystal structures [<xref ref-type="bibr" rid="pcbi.1005827.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1005827.ref010">10</xref>]. More recently, a wide range of computational methods were developed to automatically predict RNA structure. These methods include fragment assembly [<xref ref-type="bibr" rid="pcbi.1005827.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1005827.ref014">14</xref>], all-atom modeling with constraints from sequence comparison and experimental information using molecular mechanics [<xref ref-type="bibr" rid="pcbi.1005827.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1005827.ref016">16</xref>], coarse-grained molecular simulation [<xref ref-type="bibr" rid="pcbi.1005827.ref017">17</xref>–<xref ref-type="bibr" rid="pcbi.1005827.ref022">22</xref>], coarse-grained helix-as-a-stick models [<xref ref-type="bibr" rid="pcbi.1005827.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1005827.ref025">25</xref>], and homology modeling using a known structure [<xref ref-type="bibr" rid="pcbi.1005827.ref026">26</xref>]. All of these methods can use sparse information from experimental methods or low-resolution computational structure prediction, such as prediction of secondary structure, to reduce the search space of the tertiary structure problem and improve accuracy.</p>
<p>In general, automated structure prediction methods can identify the global fold of an RNA, but modeling of loop regions is frequently inaccurate [<xref ref-type="bibr" rid="pcbi.1005827.ref027">27</xref>]. These poorly-predicted regions are often highly ordered, containing specific arrangements of non-canonical base pairs [<xref ref-type="bibr" rid="pcbi.1005827.ref027">27</xref>,<xref ref-type="bibr" rid="pcbi.1005827.ref028">28</xref>]. In this work, a method was developed for accurate inference of non-canonical base pairs in loops, which could provide additional restraints for modeling the tertiary structure. Non-canonical pair predictions could also aid in the identification of RNA modules, which are self-contained RNA motifs with known structure [<xref ref-type="bibr" rid="pcbi.1005827.ref029">29</xref>].</p>
</sec>
<sec id="sec003">
<title>Prediction of non-canonical base pairs</title>
<p>The canonical RNA secondary structure (the set of A-U, G-C, and G-U wobble pairs in an RNA structure) can be predicted using a free energy change model developed from optical melting experiments on short RNA sequences [<xref ref-type="bibr" rid="pcbi.1005827.ref030">30</xref>] combined with a dynamic programming algorithm that efficiently searches the space of possible structures to identify the best structure according to the model [<xref ref-type="bibr" rid="pcbi.1005827.ref031">31</xref>]. This method implicitly considers the free energy change of some non-canonical pairs, such as mismatched nucleotides at the end of helices, but it does not explicitly make predictions of non-canonical pairs.</p>
<p>Non-canonical base pairs can be explicitly predicted using an alternative model of RNA structure that scores Nucleotide Cyclic Motifs, or NCMs [<xref ref-type="bibr" rid="pcbi.1005827.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1005827.ref032">32</xref>], instead of thermodynamic nearest neighbor parameters. An NCM is a cycle in a graph that represents the structure of an RNA, where the vertices represent nucleotides and the edges represent either covalent backbone interactions or base-pairing. In these graphs, both canonical and non-canonical base pairs are treated as edges, and a nucleotide is restricted to pair with at most one other nucleotide. The score of an NCM is determined using a training set of tertiary structures from the Protein Data Bank [<xref ref-type="bibr" rid="pcbi.1005827.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1005827.ref012">12</xref>]. The score relates to the frequency with which a particular sequence is observed in an NCM of a particular size and by the frequency with which types of NCMs appear next to one another, and the scores are cast as free energy changes. Prediction using this model is implemented in the MC-Fold program [<xref ref-type="bibr" rid="pcbi.1005827.ref012">12</xref>]. Two subsequent implementations of this calculation, MC-Fold-DP [<xref ref-type="bibr" rid="pcbi.1005827.ref033">33</xref>] and MC-Flashfold [<xref ref-type="bibr" rid="pcbi.1005827.ref034">34</xref>], use a dynamic programming algorithm, making structure calculations feasible for long sequences (&gt;150 nucleotides). Although NCM-based methods offer the advantage of predicting an extended secondary structure that includes non-canonical base pairs, they have the significant drawback in that they are that are less accurate at predicting the canonical secondary structure than prior thermodynamics-based methods, especially for sequences longer than about 50 nucleotides [<xref ref-type="bibr" rid="pcbi.1005827.ref033">33</xref>]. Therefore, methods to increase the accuracy of predicted structures, or to determine what parts of a predicted structure are more likely to be correct, are desirable.</p>
</sec>
<sec id="sec004">
<title>Partition functions</title>
<p>Both MC-Fold and MC-Fold-DP search for the best structure for a sequence given the scoring model, or for a set of suboptimal structures within a certain scoring increment of the best structure. An alternative approach to structure prediction has proven highly useful in the prediction of canonical secondary structure: predicting base pairing probabilities using an RNA partition function [<xref ref-type="bibr" rid="pcbi.1005827.ref035">35</xref>]. Instead of producing the best structure, or a set of likely structures, the partition function is used to calculate the probability of base pairing between each pair of nucleotides in the sequences. Additionally, the probability that a given nucleotide is base paired can be calculated from this information. Here it is shown, with benchmarks of structure prediction accuracy with sequences with known structure, that pairs (canonical and non-canonical) predicted to have high probability are more likely to be present in the true structure [<xref ref-type="bibr" rid="pcbi.1005827.ref036">36</xref>]. This method allows assessment of confidence in a predicted secondary structure [<xref ref-type="bibr" rid="pcbi.1005827.ref036">36</xref>], estimates of accessibility of a region of secondary structure [<xref ref-type="bibr" rid="pcbi.1005827.ref037">37</xref>–<xref ref-type="bibr" rid="pcbi.1005827.ref039">39</xref>], prediction of pseudoknots [<xref ref-type="bibr" rid="pcbi.1005827.ref040">40</xref>,<xref ref-type="bibr" rid="pcbi.1005827.ref041">41</xref>], and identification of single-nucleotide polymorphisms that are expected to affect structure [<xref ref-type="bibr" rid="pcbi.1005827.ref042">42</xref>–<xref ref-type="bibr" rid="pcbi.1005827.ref045">45</xref>].</p>
</sec>
<sec id="sec005">
<title>Conserved structure prediction</title>
<p>Computational methods to identify conserved base pairs have also proven useful in prediction of canonical pairs in RNA because structure is conserved to greater extent than sequence [<xref ref-type="bibr" rid="pcbi.1005827.ref046">46</xref>]. Pairs that are predicted to be conserved in multiple homologs are more likely to be correctly predicted. One method for predicting conserved structures is the TurboFold algorithm [<xref ref-type="bibr" rid="pcbi.1005827.ref047">47</xref>], which takes unaligned homologous sequences, with unknown structure, as input and uses a probabilistic Hidden Markov Model alignment and the structure partition function to estimate the pairing probability for conserved pairs.</p>
</sec>
<sec id="sec006">
<title>Summary</title>
<p>This work demonstrates that methods that improve the prediction accuracy of canonical secondary structure also improve the prediction accuracy of non-canonical pairs, i.e. the extended secondary structure, using the NCM model. In this work, an RNA partition function algorithm was implemented for the NCM model of structure, and benchmarks were performed that show pairs predicted to be highly probable are more likely to be accurate predictions. Additionally, the TurboFold algorithm [<xref ref-type="bibr" rid="pcbi.1005827.ref047">47</xref>] was implemented for use with the NCM-based pair probability predictions to identify non-canonical pairs conserved in a set of homologous sequences, further improving the accuracy of extended secondary structure prediction.</p>
</sec>
</sec>
<sec id="sec007" sec-type="results">
<title>Results</title>
<sec id="sec008">
<title>A partition function for the NCM structure model</title>
<p>A partition function for the NCM-based model was implemented in a new software tool, CycleFold. This program takes an RNA sequence as input and produces either a minimum free energy structure (MFE; analogously to MC-Fold and MC-Fold-DP) or a matrix of pairing probabilities between each nucleotide in the sequence, considering the possibility of non-canonical base pairing (<xref ref-type="fig" rid="pcbi.1005827.g001">Fig 1</xref>). The maximum expected accuracy (MEA) method [<xref ref-type="bibr" rid="pcbi.1005827.ref048">48</xref>,<xref ref-type="bibr" rid="pcbi.1005827.ref049">49</xref>] or the ProbKnot method [<xref ref-type="bibr" rid="pcbi.1005827.ref040">40</xref>] can be used to generate structures from tables of pair probabilities. MEA structures are assembled from pairs of higher probability than those in MFE structures, and can be more accurate than MFE structures. ProbKnot assembles structures that can contain pseudoknotted base pairs and are composed of base pairs of nucleotides with mutually maximal pairing probabilities. These are pairs of nucleotides where, for each nucleotide, the probability of pairing to its partner is higher than the probability of pairing to any other nucleotide.</p>
<fig id="pcbi.1005827.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005827.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Prediction of extended secondary structure with CycleFold.</title>
<p>(A) A predicted structure for a Sarcin-Ricin loop sequence form <italic>Rattus norvegicus</italic> [<xref ref-type="bibr" rid="pcbi.1005827.ref050">50</xref>] using CycleFold with the MFE algorithm. Correctly predicted canonical pairs are drawn with heavy black lines, correctly predicted non-canonical pairs are light black lines, and the incorrectly predicted non-canonical pair is shown with a gray dashed line. The G-A pair at the base of the tetraloop is not present in the reference structure because the 3’ A is not stacked on the subsequent G, but is instead in contact with a protein, Restrictocin. (B) The probability dot plot calculated using Cyclefold with the partition function algorithm. The upper right triangle shows pairs with estimated probabilities &gt; 0.01, color-coded by pairing probability. The lower left triangle shows the pairs that are present in the reference structure. Each dot represents a single base pair, and nucleotide index (starting with 1 at the 5’ end) is shown along the x and y axes.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.g001" xlink:type="simple"/>
</fig>
<p>The formulation of the partition function algorithm is similar to the minimum free energy algorithm for the NCM model [<xref ref-type="bibr" rid="pcbi.1005827.ref033">33</xref>], with the restriction that care must be taken to count each structure exactly once. The algorithm is implemented using dynamic programming, and it has the same time and memory complexity as the partition function for canonical base pairs (O(N<sup>3</sup>) and O(N<sup>2</sup>), respectively, where N is the sequence length), with larger constant factors because of the greater variety of possible pairs that must be considered. A detailed description of the algorithm is provided in Materials and Methods, below. Because the dynamic programming search is equivalent for both the partition function and the calculation of the minimum energy structure, the source code for CycleFold implements only one generic set of dynamic programming recursions that are used by both algorithms.</p>
</sec>
<sec id="sec009">
<title>Benchmarks of structure prediction</title>
<p>To test the accuracy of CycleFold compared to previously available methods, a test set of structures from the RNA STRAND database [<xref ref-type="bibr" rid="pcbi.1005827.ref051">51</xref>] was assembled. Structures were chosen that were derived from coordinates in the Protein Data Bank [<xref ref-type="bibr" rid="pcbi.1005827.ref002">2</xref>], and that were not used as part of the MC-Fold training data [<xref ref-type="bibr" rid="pcbi.1005827.ref012">12</xref>]. In all, 154 structures met these criteria (<xref ref-type="supplementary-material" rid="pcbi.1005827.s002">S1 Table</xref>). Structures for each sequence were predicted with CycleFold, MC-Fold MC-Fold-DP, and the Fold program from the RNAstructure software package, which predicts canonical base pairs only using the conventional nearest neighbor rules [<xref ref-type="bibr" rid="pcbi.1005827.ref030">30</xref>], and the predictions were compared to the reference structure (<xref ref-type="supplementary-material" rid="pcbi.1005827.s003">S2 Table</xref>). Performance was measured using sensitivity, which is the fraction of known base pairs that were correctly predicted, and positive predictive value (PPV), which is the fraction of predicted pairs that were correct.</p>
</sec>
<sec id="sec010">
<title>MFE prediction accuracy for canonical base pairs</title>
<p>The first benchmarks examined the prediction of canonical base pairs, defined as the set of A-U, G-C, and G-U pairs with at least three nucleotides between them. As expected, the three programs that use the NCM model have similar performance, although there are small differences in performance because of details of the implementation of each program (<xref ref-type="fig" rid="pcbi.1005827.g002">Fig 2A</xref>). Some of these differences are statistically significant with the type I error rate of 0.05. CycleFold and MC-Fold have significantly higher sensitivity compared to MC-Fold-DP, although the difference in performance is small. CycleFold and MC-Fold, but not MC-Fold-DP, have a small but statistically significant decrease in PPV compared to prediction with Fold (p &lt; 0.05; <xref ref-type="supplementary-material" rid="pcbi.1005827.s004">S3 Table</xref>)</p>
<fig id="pcbi.1005827.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005827.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Benchmark of single-sequence prediction of canonical base pairs.</title>
<p>(A) Prediction accuracy of the lowest free energy structure, evaluated on canonical pairs. (B) Prediction with CycleFold, using structures composed of highly probable canonical pairs. Sensitivity and PPV are reported for structures with probability greater than a threshold labeled on the plot). This demonstrates that the threshold stringency provides a tradeoff in terms of sensitivity and PPV.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec011">
<title>Improvement of canonical pair predictions using the NCM partition function</title>
<p>Using the NCM partition function implemented in CycleFold, structures were assembled of canonical pairs that had probabilities higher than a threshold [<xref ref-type="bibr" rid="pcbi.1005827.ref036">36</xref>]. Structures composed of highly probable pairs had higher positive predictive value than structures predicted with the MFE method. For example, structures composed only of pairs with estimated pairing probability of 0.95 or higher had an average PPV of 95.4%, while still retaining an average sensitivity of 40.1% (<xref ref-type="fig" rid="pcbi.1005827.g002">Fig 2B</xref>; <xref ref-type="supplementary-material" rid="pcbi.1005827.s003">S2 Table</xref>), and all probability thresholds higher than 0.5 resulted in a significantly increased PPV over CycleFold-MFE (p&lt;0.05; <xref ref-type="supplementary-material" rid="pcbi.1005827.s005">S4 Table</xref>).</p>
</sec>
<sec id="sec012">
<title>Accuracy of non-canonical pair prediction</title>
<p>Next, prediction accuracy for non-canonical pairs (pairs other than the canonical A-U, G-C, or G-U pairs, or that did not have at least three nucleotides in between) was measured. Prediction of non-canonical pairs (<xref ref-type="fig" rid="pcbi.1005827.g003">Fig 3A</xref>) had poorer accuracy than for canonical pairs. CycleFold scored 47.0% for PPV, meaning that less than half of the predicted non-canonical pairs were correct, and 64.0% for sensitivity. CycleFold performed similarly to MC-Fold and MC-Fold-DP (<xref ref-type="fig" rid="pcbi.1005827.g003">Fig 3A</xref>). As with the canonical base pairs, CycleFold and MC-Fold have significantly higher sensitivity compared to MC-Fold-DP (p&lt;0.05).</p>
<fig id="pcbi.1005827.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005827.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Benchmark of single-sequence prediction of non-canonical base pairs.</title>
<p>(A) Prediction accuracy of the lowest free energy structure, evaluated on non-canonical pairs. This includes a calculation where CycleFold is constrained to include the known canonical base pairs to illustrate the performance of the NCM approach when canonical base pairs are known. (B) Prediction with CycleFold, using structures composed of highly probable non-canonical pairs. Sensitivity and PPV are reported for structures with probability greater than a specified threshold (labeled on the plot). This demonstrates that the threshold stringency provides a tradeoff in terms of sensitivity and PPV.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.g003" xlink:type="simple"/>
</fig>
<p>Non-canonical pairs are less frequent in the database of sequences with known structure than canonical base pairs. Therefore, using the NCM approach, they contribute less stability to the folding of a sequence to a structure that contains them than do the canonical pairs. The pair probabilities for non-canonical pairs, however, can still be high, i.e. close to 1, because pair probabilities reflect the competition of base pairs with alternative pairs with the same nucleotide. Sets of adjacent pairs can be difficult to compete with alternative structures, especially if some of the pairs are canonical pairs.</p>
<p>Assembling structures composed only of pairs above a specific pairing probability threshold identified non-canonical pairs with improved positive predictive value (<xref ref-type="fig" rid="pcbi.1005827.g003">Fig 3B</xref>). For example, structures composed of pairs with probability greater than 0.9 had PPV of 66.7%, albeit with a sensitivity of only 8.7%. This improvement in PPV is not statistically significant for a benchmark of this size (p &gt; 0.05; <xref ref-type="supplementary-material" rid="pcbi.1005827.s007">S6 Table</xref>).</p>
</sec>
<sec id="sec013">
<title>Improvement of structure prediction using canonical structure constraints</title>
<p>Historically, the location of the canonical base pairs has been known with high accuracy before the tertiary structure was solved, so the canonical secondary structure can be used to help infer tertiary structure, including non-canonical base pairs [<xref ref-type="bibr" rid="pcbi.1005827.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1005827.ref052">52</xref>]. CycleFold (as well as MC-Fold and MC-Fold-DP) is able to accept a set of input pairs, and predict structures that are required to contain those pairs. This reduces the search space of the problem, and therefore is expected to improve the accuracy of prediction. Using CycleFold, the structures in the test dataset were predicted using constraints that force the canonical base pairs to occur. This improved the prediction of non-canonical pairs with the MFE method to a PPV of 59.2% and a sensitivity of 76.8%, sufficiently accurate to develop hypotheses about structure (<xref ref-type="fig" rid="pcbi.1005827.g003">Fig 3A</xref>; <xref ref-type="supplementary-material" rid="pcbi.1005827.s003">S2 Table</xref>). This represents a significant improvement in PPV as compared to unconstrained MFE prediction using CycleFold (p &lt; 0.05; <xref ref-type="supplementary-material" rid="pcbi.1005827.s006">S5 Table</xref>).</p>
<p>The CycleFold partition function calculation can also be constrained to require specified base pairs. Assembling structures with highly probable pairs using constraints in the partition function calculation improved the accuracy even further, with a PPV of 88.9% and a sensitivity of 29.7% for pairs with probability of 0.95 or greater. Pairing probability thresholds of 0.5 to 0.7 provide a significant improvement in PPV over MFE prediction. At higher thresholds, too few pairs are predicted, and there is insufficient statistical power to for a significant result (<xref ref-type="fig" rid="pcbi.1005827.g003">Fig 3B</xref>; <xref ref-type="supplementary-material" rid="pcbi.1005827.s008">S7 Table</xref>).</p>
</sec>
<sec id="sec014">
<title>Identification of conserved non-canonical pairs using the TurboFold algorithm</title>
<p>Another way to improve the prediction of RNA structure is to predict the conserved structure using multiple homologous sequences. The NCM partition function was used to implement the TurboFold algorithm [<xref ref-type="bibr" rid="pcbi.1005827.ref047">47</xref>] as an additional mode in CycleFold. This algorithm uses pair probabilities for multiple sequences, in addition to a predicted, probabilistic alignment between each pair of sequences, to iteratively improve the estimated base pair probabilities for each sequence (see <xref ref-type="sec" rid="sec016">Materials and Methods</xref>). Three recent RNA crystal structures were assembled to test whether TurboFold improved the quality of predicted structures: a nuclease-resistant sequence from a Murray Valley Encephalitis virus 3’ UTR [<xref ref-type="bibr" rid="pcbi.1005827.ref053">53</xref>], a <italic>Deinococcus radiodurans</italic> signal recognition particle hairpin domain [<xref ref-type="bibr" rid="pcbi.1005827.ref054">54</xref>], and the structure of the Twister ribozyme from <italic>Oryza sativa</italic> [<xref ref-type="bibr" rid="pcbi.1005827.ref055">55</xref>]. The native structures as shown in the crystal structures are provided as Supplementary <xref ref-type="supplementary-material" rid="pcbi.1005827.s001">S1 Fig</xref>. Structures were chosen that were not present in the training data for the NCM model parameters, did not have large inserted folding domains that were removed from the crystallization construct, and were not riboswitches. Nine homologous sequences were chosen at random for each structure from a set of known homologs, for a total of 10 input sequences, and consensus pair probabilities were predicted using CycleFold’s TurboFold mode. The consensus pair probabilities were compared to the pair probabilities calculated only from the crystallized sequence using the NCM partition function for canonical pairs (<xref ref-type="fig" rid="pcbi.1005827.g004">Fig 4A–4C</xref>) and non-canonical pairs (<xref ref-type="fig" rid="pcbi.1005827.g005">Fig 5A–5C</xref>). In comparison, the plmc program, which identifies nucleotides that are associated using evolutionary couplings [<xref ref-type="bibr" rid="pcbi.1005827.ref016">16</xref>], was benchmarked, using the full set of aligned homologs as input.</p>
<fig id="pcbi.1005827.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005827.g004</object-id>
<label>Fig 4</label>
<caption>
<title/>
<p>Prediction of canonical base pairs by predicting a conserved structure using multiple homologous sequences for (A) an MVE virus nuclease resistant RNA [<xref ref-type="bibr" rid="pcbi.1005827.ref053">53</xref>], (B) a <italic>D</italic>. <italic>radiodurans</italic> SRP hairpin domain [<xref ref-type="bibr" rid="pcbi.1005827.ref054">54</xref>], and (C) a <italic>O</italic>. <italic>sativa</italic> Twister ribozyme [<xref ref-type="bibr" rid="pcbi.1005827.ref055">55</xref>]. Prediction accuracy is shown for structures composed of highly probable pairs using information from a single sequence (blue) or a TurboFold calculation with 10 sequences (red). Also shown is prediction accuracy using evolutionary couplings from the plmc program [<xref ref-type="bibr" rid="pcbi.1005827.ref016">16</xref>] (green).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.g004" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005827.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005827.g005</object-id>
<label>Fig 5</label>
<caption>
<title/>
<p>Prediction of non-canonical base pairs by predicting the conserved structure with multiple homologous sequences for (A) an MVE virus nuclease resistant RNA, (B) a <italic>D</italic>. <italic>radiodurans</italic> SRP hairpin domain, and (C) a <italic>O</italic>. <italic>sativa</italic> Twister ribozyme. Prediction accuracy is shown for structures composed of highly probable pairs using information from a single sequence (blue) or a TurboFold calculation on 10 sequences (red). In panels A and B, no blue line is present because the single sequence prediction did not correctly predict any pairs. Also shown is prediction using evolutionary couplings from the plmc program [<xref ref-type="bibr" rid="pcbi.1005827.ref016">16</xref>] (green).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.g005" xlink:type="simple"/>
</fig>
<p>In these benchmarks for predicting conserved pairs, base triples are considered two separate pairs, where one pair can be a canonical pair. The plmc program is able to predict triple interactions as a set of two pairs [<xref ref-type="bibr" rid="pcbi.1005827.ref016">16</xref>], although CycleFold is not able to predict base triples. Therefore, the plmc can achieve higher sensitivity on the benchmark.</p>
<p>For canonical pairs, in two cases, the nuclease-resistant RNA and the SRP RNA, the structure was predicted poorly using the single sequence, with under 10% sensitivity and PPV for the single-sequence predictions. In these cases, TurboFold was able to dramatically improve the prediction accuracy, with sensitivity over 60% and PPV over 90%. In the remaining case, the Twister ribozyme, the structure was reasonably accurate using both the single sequence and the TurboFold method. TurboFold offered a slight increase in PPV, with a slight decrease in sensitivity. In comparison of CycleFold to plmc, it was not possible to conclude that either program had better sensitivity, but CycleFold offered a significantly better PPV (p&lt;0.05; <xref ref-type="supplementary-material" rid="pcbi.1005827.s009">S8 Table</xref>).</p>
<p>The prediction of non-canonical pairs had lower accuracy, but followed the same trend (<xref ref-type="fig" rid="pcbi.1005827.g005">Fig 5</xref>). The prediction using a single sequence did not correctly predict any non-canonical pairs for the nuclease-resistant RNA or the SRP RNA. Prediction with TurboFold increased the accuracy to a PPV of over 50% for each. In the case of the Twister ribozyme, TurboFold did not increase the accuracy over the single sequence prediction. As with the canonical base pairs, CycleFold had lower sensitivity but higher PPV than plmc. Due to the small number of sequences that could be used in this benchmark, however, there is insufficient statistical power to conclude that these differences are statistically significant using a type I error rate of 0.05 (<xref ref-type="supplementary-material" rid="pcbi.1005827.s009">S8 Table</xref>).</p>
</sec>
</sec>
<sec id="sec015" sec-type="conclusions">
<title>Discussion</title>
<p>This work shows that conserved non-canonical base pairs can be identified in a set of unaligned homologous sequences. It is not surprising that this is the case; it has been long appreciated that RNA structure is more conserved than sequence. Furthermore, tertiary structure models had been developed in the past, most notably for the self-splicing group I intron, by manual identification of conserved interactions [<xref ref-type="bibr" rid="pcbi.1005827.ref007">7</xref>]. This work is notable as an automated method that builds on prior work on secondary structure prediction.</p>
<p>Prior work had emphasized the relative inaccuracy of the prediction of the NCM model when used with a dynamic programming algorithm to search the folding space [<xref ref-type="bibr" rid="pcbi.1005827.ref033">33</xref>]. Here, it is shown that the additional information from a partition function calculation can be used to identify the predicted pairs more likely to be correct. Additionally, constraining the structure prediction with knowledge of the canonical base pairs, along with a partition function calculation to find the most likely pairs, results in highly accurate predictions of non-canonical pairs. Finally, conserved non-canonical pairs can be predicted using the TurboFold algorithm.</p>
<p>An important limitation of the algorithm used in CycleFold is that it ignores the possibility of pseudoknotted pairs, that is, configurations of base pairs that are non-nested. However, it would be possible to predict pseudoknotted pairs using methods like ProbKnot, which has been provided as an optional mode for CycleFold. Additionally, prior work showed that the TurboFold method can be used to identify conserved pseudoknotted interactions [<xref ref-type="bibr" rid="pcbi.1005827.ref056">56</xref>]. Dynamic programming algorithms exist that are able to explicitly predict pseudoknots, albeit at higher computational cost [<xref ref-type="bibr" rid="pcbi.1005827.ref041">41</xref>,<xref ref-type="bibr" rid="pcbi.1005827.ref057">57</xref>], and a dynamic programming method performed slightly better in benchmarks of pseudoknot prediction [<xref ref-type="bibr" rid="pcbi.1005827.ref040">40</xref>]. Therefore, it may be desirable to implement these algorithms in the NCM context.</p>
<p>The CycleFold-TurboFold method presented here is not the only available method to identify conserved non-canonical contacts. Evolutionary information was used recently to infer non-canonical and long-distance contacts using evolutionary coupling with the plmc program, and these contacts were then used to generate structure models [<xref ref-type="bibr" rid="pcbi.1005827.ref016">16</xref>]. These two methods complement each other; the new method described here provides an important new capability because it does not require a fixed input alignment, and can therefore address the difficulty of aligning RNA sequences. This property is useful for prediction of structures from new families where the exact alignment may be unclear. However, the evolutionary couplings method has the important advantage that it can gracefully consider both pseudoknotted and non-pseudoknotted interactions, which is more difficult using dynamic programming methods. In the small benchmark shown here, it was shown that CycleFold might offer improved accuracy over the evolutionary coupling method; however, in practice, these methods could be used together when performing real structure modeling.</p>
<p>The method described here could be incorporated into tertiary structure modeling efforts in two obvious ways. In the first, non-canonical pairs predicted with CycleFold could be used as an explicit constraint on the search space considered by the modeling program, in much the same way as the canonical secondary structure is currently used. Alternatively, predicted non-canonical pairs could be used in order to help identify RNA folding modules, which typically have a set of known canonical and non-canonical interactions. Additionally, the partition function paradigm would also allow an exact calculation of the probability that a module occurs [<xref ref-type="bibr" rid="pcbi.1005827.ref058">58</xref>]. Use of identified RNA modules could be used to help understand the function of the RNA, to identify small molecules to target the RNA, or to provide a set of constraints for structure modeling.</p>
<p>In general, predicting only probable pairs or predicting conserved pairs with TurboFold increases the PPV, at a cost of sensitivity. For structure modeling that directly uses these constraints, this is a desirable compromise. Modeling software might yet identify a correct pair if that pair is missing from the input of restraints, but the presence of an incorrect pair would generate an incorrect pair in the tertiary structure, and also likely compromise the accuracy of the model. Accurate predictions of extended secondary structure as provided by this method could prove useful as additional modeling constraints for any tertiary structure modeling program.</p>
<p>The CycleFold program is free software available under the GNU Public License, and it is now part of the RNAstructure software package. Source code, compiled executables, and documentation are available at <ext-link ext-link-type="uri" xlink:href="https://rna.urmc.rochester.edu/" xlink:type="simple">https://rna.urmc.rochester.edu</ext-link>.</p>
</sec>
<sec id="sec016" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec017">
<title>Benchmarks of structure prediction performance</title>
<p>A pair in the predicted structure or in the target structure was considered “canonical” if it was between the nucleotides A-U, G-C, or G-U, and the pairing nucleotides were separated by at least 3 nt in the sequence, which is necessary for the backbone to form the canonical pairing geometry. All other pairs were considered “non-canonical.” Predictions were scored by the sensitivity, which is the fraction of pairs in the accepted structure that were predicted, and the positive predictive value, or PPV, which is the fraction of predicted pairs that were correct. Base pairs were considered to be correct if they are predicted within one nucleotide for one index. That is, if the accepted structure contains a pair at index (i,j), a predicted pair at (i,j), (i+1,j), (i-1,j), (i,j+1), and (i,j-1) is scored as a correct prediction [<xref ref-type="bibr" rid="pcbi.1005827.ref059">59</xref>]. This is permitted because these alternative pairs are thermodynamically accessible according to solution NMR experiments, which show sampling of alternative base pairing of this kind [<xref ref-type="bibr" rid="pcbi.1005827.ref060">60</xref>,<xref ref-type="bibr" rid="pcbi.1005827.ref061">61</xref>], and optical melting experiments of bulges, which are consistent with multiple pairing states [<xref ref-type="bibr" rid="pcbi.1005827.ref062">62</xref>]. Crystal structures, to which the predictions are compared, generally capture only one pairing state, and therefore requiring exact matches the crystal structure would not be a good assessment of performance.</p>
<p>The complete set of benchmark accuracies for each method on each sequence is provided as a comma-delimited Supplementary Data file (CycleFold_benchmark_accuracy_supplementary-dataset.csv).</p>
</sec>
<sec id="sec018">
<title>Benchmark of TurboFold and plmc performance</title>
<p>PDB structures 4OJI, 4PQV, and 2XXA were used for the benchmark of TurboFold. Base pairs were extracted with 3DNA-DSSR version 1.1.2 [<xref ref-type="bibr" rid="pcbi.1005827.ref063">63</xref>]. Homologous sequences for the Twister ribozyme and the Dengue sequence were provided in the publications describing their structures. SRP sequences were acquired from the Signal Recognition Particle Database [<xref ref-type="bibr" rid="pcbi.1005827.ref064">64</xref>]. From each set of sequences, 9 were chosen randomly to be used by TurboFold. CycleFold was run with default settings. For prediction using plmc, all available aligned sequences were used as input, and the software was run with the recommended settings for RNA.</p>
</sec>
<sec id="sec019">
<title>Statistical significance of benchmark results</title>
<p>PPV and sensitivity were compared using a paired, two-tailed t-test (ttest_rel function from the SciPy library [<xref ref-type="bibr" rid="pcbi.1005827.ref065">65</xref>]). For the comparison of PPV, sequences were excluded from the test if either method predicted no pairs. For all t-tests, the type I error rate, α, was set to 0.05. For the comparison between CycleFold and plmc, which both predict pairs associated with a measure of confidence in the predicted pair, the best values of PPV and sensitivity were compared for each sequence.</p>
</sec>
<sec id="sec020">
<title>Nucleotide Cyclic Motifs</title>
<p>The NCM model considers an RNA as a graph where the vertices are nucleotides and the edges are either covalent attachments through the backbone or base-pairing interactions, which may be canonical or non-canonical [<xref ref-type="bibr" rid="pcbi.1005827.ref012">12</xref>]. A Nucleotide Cyclic Motif, or NCM, is a cycle in the graph that contains either one or two edges that correspond to base pairs. As in MC-Fold, a nucleotide may be involved in zero or one base pair; the model does not take into account the possibility of base triples. NCMs with one pair correspond to hairpin loops in RNA structure, while NCMs with two pairs correspond to base pair stacks, bulge loops, or internal loops (<xref ref-type="fig" rid="pcbi.1005827.g006">Fig 6</xref>). Cycles with more than two pairs, which correspond to multibranch loops, are not scored in this model, although the original MC-Fold has an ad-hoc formulation for coaxial stacks, where base pairs from two helices in a multibranch loop can form energetically stable stacking interactions. This was not implemented in CycleFold (or MCFold-DP [<xref ref-type="bibr" rid="pcbi.1005827.ref033">33</xref>]).</p>
<fig id="pcbi.1005827.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005827.g006</object-id>
<label>Fig 6</label>
<caption>
<title>An example of a pseudo-energy calculation using the NCM model.</title>
<p>ΔG<sub>junction</sub> is evaluated for each pair of NCMs that share an edge, i.e. the ones that have an overlapping base pair. This term depends on the identities of the two NCMs (that is, the length of the 5’ and 3’ cycles for a double-stranded NCM, or the total length for a single-stranded NCM), and the nucleotides in the common base pair. This term is evaluated for the junction of NCM a with NCM b, NCM b with NCM c, and NCM c with NCM d.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec021">
<title>The NCM scoring model</title>
<p>In the NCM model, the pseudo-free energy of a particular structure is given by
<disp-formula id="pcbi.1005827.e001">
<alternatives>
<graphic id="pcbi.1005827.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mi>j</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>ncms</italic> is the set of all the NCMs in the structure, and <italic>junctions</italic> is the set of all junctions of NCMs in the structure such that two NCMs share a base pair. ΔG<sub>formation</sub> for an NCM is a function of the identity and the sequence of the NCM, and ΔG<sub>junction</sub> is a function of the identities of the two NCMs and the sequence of the base pair they share. The NCM model parameters were learned from a set of structures derived from the Protein Data Bank and converted into the pseudo-energies that are tabulated in the NCM data tables [<xref ref-type="bibr" rid="pcbi.1005827.ref012">12</xref>].</p>
</sec>
<sec id="sec022">
<title>Example calculation</title>
<p><xref ref-type="fig" rid="pcbi.1005827.g006">Fig 6</xref> shows an example of a pseudo-energy calculation using NCMs. This structure contains four NCMs, labelled a-d. NCMs are identified by the number of strands involved in the NCM and by their length; for example a single-stranded NCM of length 4 (representing a hairpin loop with 2 unpaired nucleotides) is referred to as a “1–4” NCM, while a double stranded NCM with 3 nucleotides on the 5’ side and 4 nucleotides on the 3’ side (representing a 1×2 asymmetric internal loop with 1 unpaired nucleotide on the 5’ strand and two unpaired nucleotides on the 3’ strand) is referred to as a “2-3-4” NCM. The ΔG<sub>formation</sub> for an NCM depends on its dimensions and its sequence.</p>
<p>Therefore, in total,
<disp-formula id="pcbi.1005827.e002">
<alternatives>
<graphic id="pcbi.1005827.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mspace width="0.25em"/><mml:mi>a</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mspace width="0.25em"/><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mspace width="0.25em"/><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mspace width="0.25em"/><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mspace width="0.25em"/><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mspace width="0.25em"/><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mspace width="0.25em"/><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005827.e003">
<alternatives>
<graphic id="pcbi.1005827.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mo>=</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>U</mml:mi><mml:mi>G</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mi>A</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>3</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mi>C</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>3</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>3</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">-</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005827.e004">
<alternatives>
<graphic id="pcbi.1005827.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>0.978</mml:mn><mml:mo>−</mml:mo><mml:mn>1.5130</mml:mn><mml:mo>−</mml:mo><mml:mn>2.064</mml:mn><mml:mo>−</mml:mo><mml:mn>1.519</mml:mn><mml:mo>−</mml:mo><mml:mn>0.3396</mml:mn><mml:mo>−</mml:mo><mml:mn>0.3148</mml:mn><mml:mo>−</mml:mo><mml:mn>0.2134</mml:mn><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>6.9418</mml:mn>
</mml:math>
</alternatives>
</disp-formula></p>
<p>This pseudo-free energy score is provided in units of kcal/mol. However, they do not reflect physical properties of the sequence, rather the log of the frequency with which these NCMs are observed in the training set. The parameters used in CycleFold are taken from MC-Fold-DP [<xref ref-type="bibr" rid="pcbi.1005827.ref033">33</xref>], which derived its parameters from tables from MC-Fold [<xref ref-type="bibr" rid="pcbi.1005827.ref012">12</xref>].</p>
<sec id="sec023">
<title>The partition function</title>
<p>The partition function, <italic>Q</italic>, is the sum of the equilibrium constants of all structures and it describes the thermodynamic ensemble. It is given by
<disp-formula id="pcbi.1005827.e005">
<alternatives>
<graphic id="pcbi.1005827.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>∆</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>n</italic> is the number of possible structures of the system, ΔG<sub>s</sub> is the Gibbs free energy change of folding to structure <italic>s</italic>, <italic>R</italic> is the universal gas constant, and <italic>T</italic> is the absolute temperature (310.15 K in this work). At equilibrium, the probability of structure, <italic>s’</italic>, is given by
<disp-formula id="pcbi.1005827.e006">
<alternatives>
<graphic id="pcbi.1005827.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>∆</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Therefore, the partition function quantifies the entire thermodynamic ensemble in a way that the probability of any state of the system can be calculated using the Gibbs free energy change of that state.</p>
<p>The probability <italic>P</italic><sub><italic>i</italic>,<italic>j</italic></sub> of a pair between nucleotides <italic>i</italic> and <italic>j</italic> is given by
<disp-formula id="pcbi.1005827.e007">
<alternatives>
<graphic id="pcbi.1005827.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>″</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>∆</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>b</italic><sub><italic>ij</italic></sub> is the set of structures in which <italic>i</italic> and <italic>j</italic> are paired. In other words, the probability that <italic>i</italic> and <italic>j</italic> are paired is the sum of the probabilities of each structure that contains a pair between <italic>i</italic> and <italic>j</italic>. This probability can be calculated efficiently without enumerating all the structures in <italic>k</italic> by using intermediate results from the calculation of the full partition function, as described below.</p>
</sec>
</sec>
<sec id="sec024">
<title>Calculation of the partition function using the NCM model</title>
<p>The partition function using the NCM model can be calculated efficiently using a dynamic programming algorithm (<xref ref-type="fig" rid="pcbi.1005827.g007">Fig 7</xref>). The algorithm scales <italic>O</italic>(N<sup>3</sup>), where N is the length of the sequence, and this is the same scaling as MC-Fold-DP and the free energy minimization mode of CycleFold. Time benchmarks of the partition function (and the TurboFold extension), compared to the partition function across canonical pairs is provided in <xref ref-type="supplementary-material" rid="pcbi.1005827.s010">S9 Table</xref>. This algorithm stores intermediate results in seven tables. The first, <italic>V</italic>, is a table of size N×N×γ, where γ is the number of distinct NCM types. <italic>V(i</italic>,<italic>j</italic>,<italic>θ)</italic> stores the partition function for the fragment from <italic>i</italic> to <italic>j</italic> closed by an NCM of type <italic>θ</italic>. Four N×N tables, <italic>W</italic>, <italic>WL</italic>, <italic>WMB</italic>, <italic>and WMBL</italic>, store components of multibranched structures [<xref ref-type="bibr" rid="pcbi.1005827.ref036">36</xref>]. <italic>W</italic> and <italic>WL</italic> store the partition function for the fragment from i to j where i and j are not required to be paired to one another, and the fragment contains one helix. <italic>WL</italic> has the additional restriction that the nucleotide at j is required to be one of the closing base pairs of the helix. <italic>WMB</italic> and <italic>WMBL</italic> store the partition function for the fragment from <italic>i</italic> to <italic>j</italic> containing two or more helices, and <italic>WMBL</italic> has the additional restriction that <italic>j</italic> is one of the closing nucleotides of the 5’-most helix. The final two arrays, <italic>W5</italic> and <italic>W3</italic>, are tables of size N that store the partition function for the fragment from 1 to i and i to N, respectively. At the end of the calculation, W5(N) = W3(1) = Q. In <italic>V(i</italic>,<italic>j</italic>,<italic>θ)</italic>, <italic>W(i</italic>,<italic>j)</italic>, <italic>WL(i</italic>,<italic>j)</italic>, <italic>WMB(i</italic>,<italic>j)</italic>, and <italic>WMBL(i</italic>,<italic>j)</italic>, entries where i&lt;j refer to interior fragments, while entries where i&gt;j refer to exterior fragments, containing the ends of the sequence. Prior to the calculation, all array values are initialized to 0 except for W5(1) and W3(N), which are initialized to 1 to represent the equilibrium constant of the completely unfolded state (which is the reference state with folding free energy of zero).</p>
<fig id="pcbi.1005827.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005827.g007</object-id>
<label>Fig 7</label>
<caption>
<title>A recursion diagram [<xref ref-type="bibr" rid="pcbi.1005827.ref041">41</xref>] illustrating the NCM partition function algorithm.</title>
<p>Filled regions indicate terms that are being added to the partition function, and empty regions indicate results that were previously calculated. Solid lines indicate nucleotides that must be paired, while dotted lines indicate nucleotides that may or may not be paired.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.g007" xlink:type="simple"/>
</fig>
<p>The <italic>V</italic> table entry is the sum of the following terms:
<disp-formula id="pcbi.1005827.e008">
<alternatives>
<graphic id="pcbi.1005827.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula></p>
<p>If this is an exterior fragment, an additional term V<sub>exterior</sub> replaces <italic>V</italic><sub><italic>hairpin</italic></sub>. These components are calculated as follows.
<disp-formula id="pcbi.1005827.e009">
<alternatives>
<graphic id="pcbi.1005827.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>−</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup>
</mml:math>
</alternatives>
</disp-formula>
where ΔG<sub>hairpin</sub> depends on the sequence of the fragment and is tabulated as part of the NCM parameters.
<disp-formula id="pcbi.1005827.e010">
<alternatives>
<graphic id="pcbi.1005827.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">φ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>−</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>−</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where ϕ is the set of NCMs that form valid structures when they abut on NCM <italic>θ</italic> at position <italic>i</italic>,<italic>j</italic>, and <italic>di</italic><sub>θ</sub> and <italic>dj</italic><sub>θ</sub> are the length of θ on the 5’ and 3’ sides, respectively.</p>
<disp-formula id="pcbi.1005827.e011">
<alternatives>
<graphic id="pcbi.1005827.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e011" xlink:type="simple"/>
<mml:math display="block" id="M11">
<mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>−</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:mi>W</mml:mi><mml:mi>M</mml:mi><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<p>If <italic>i</italic>,<italic>j</italic> forms an exterior fragment, V<sub>exterior</sub> is calculated:
<disp-formula id="pcbi.1005827.e012">
<alternatives>
<graphic id="pcbi.1005827.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>−</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:mi>W</mml:mi><mml:mn>5</mml:mn><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mi>W</mml:mi><mml:mn>3</mml:mn><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The tables to save components of a multibranch loop are calculated as follows:
<disp-formula id="pcbi.1005827.e013">
<alternatives>
<graphic id="pcbi.1005827.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e013" xlink:type="simple"/>
<mml:math display="block" id="M13">
<mml:mi>W</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">φ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>φ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005827.e014">
<alternatives>
<graphic id="pcbi.1005827.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e014" xlink:type="simple"/>
<mml:math display="block" id="M14">
<mml:mi>W</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>W</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005827.e015">
<alternatives>
<graphic id="pcbi.1005827.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e015" xlink:type="simple"/>
<mml:math display="block" id="M15">
<mml:mi>W</mml:mi><mml:mi>M</mml:mi><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mi>M</mml:mi><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">φ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">φ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mo>[</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mi>M</mml:mi><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>W</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005827.e016">
<alternatives>
<graphic id="pcbi.1005827.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e016" xlink:type="simple"/>
<mml:math display="block" id="M16">
<mml:mi>W</mml:mi><mml:mi>M</mml:mi><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mi>M</mml:mi><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>W</mml:mi><mml:mi>M</mml:mi><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Finally, the 1-dimensional tables <italic>W5</italic> and <italic>W3</italic> are calculated as follows:
<disp-formula id="pcbi.1005827.e017">
<alternatives>
<graphic id="pcbi.1005827.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e017" xlink:type="simple"/>
<mml:math display="block" id="M17">
<mml:mi>W</mml:mi><mml:mn>5</mml:mn><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mn>5</mml:mn><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">φ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>W</mml:mi><mml:mn>5</mml:mn><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">φ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005827.e018">
<alternatives>
<graphic id="pcbi.1005827.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e018" xlink:type="simple"/>
<mml:math display="block" id="M18">
<mml:mi>W</mml:mi><mml:mn>3</mml:mn><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mn>3</mml:mn><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">φ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">φ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mi>W</mml:mi><mml:mn>3</mml:mn><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Some structural configurations, such as large bulge loops, cannot be captured by the NCM model because there is no appropriately-sized NCM. In order to allow the consideration of these structures, an additional contribution to the partition function from these “long loops” may be used.
<disp-formula id="pcbi.1005827.e019">
<alternatives>
<graphic id="pcbi.1005827.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e019" xlink:type="simple"/>
<mml:math display="block" id="M19">
<mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">φ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">φ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>i</italic> and <italic>j</italic> are nucleotide indices chosen so that <italic>i</italic> &lt; <italic>i’</italic> &lt; <italic>j’</italic> &lt; <italic>j</italic> and there is no valid NCM containing the pairs <italic>i-j</italic> or <italic>i-j</italic> and <italic>i’-j’</italic>. CycleFold does not perform this calculation by default, but it may be enabled by the user. This is important when pairing constraints are used, where the constraints could force the prediction to use a “long loop.”</p>
<sec id="sec025">
<title>Calculation of base pairing probabilities</title>
<p>Once the dynamic programming tables have been filled, the probability for a base pair in a structure is given by
<disp-formula id="pcbi.1005827.e020">
<alternatives>
<graphic id="pcbi.1005827.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e020" xlink:type="simple"/>
<mml:math display="block" id="M20">
<mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mn>3</mml:mn><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">φ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">γ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">φ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">γ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>−</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="normal">φ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">γ</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where ϕ is the set of pairs of NCMs φ,γ that can form a junction sharing a pair at position <italic>i</italic>,<italic>j</italic>.</p>
</sec>
</sec>
<sec id="sec026">
<title>Ambiguity testing</title>
<p>The partition function recursions need to consider each valid NCM structure once and only once. The recursions were designed to non-redundantly consider each structure, where the multibranch loop recursions were taken from the prior implementation for canonical base pairs [<xref ref-type="bibr" rid="pcbi.1005827.ref036">36</xref>].</p>
<p>To test for redundancy, fuzz testing was performed using a set of 22,000 random sequences of length 75. Canonical base pairs were predicted for each sequence using stochastic sampling [<xref ref-type="bibr" rid="pcbi.1005827.ref066">66</xref>] in RNAstructure [<xref ref-type="bibr" rid="pcbi.1005827.ref067">67</xref>]. Then, the structures were predicted using CycleFold, where the canonical pairs were constrained to occur. The canonical base pair probabilities were then verified to exactly 1, within tolerance for machine precision, for all sequences. This empirically supports that the recursions are non-redundant because redundancy could result in probabilities smaller or larger than 1 for the constrained pairs.</p>
</sec>
<sec id="sec027">
<title>Adaptation of recursions to predict minimum free energy structure</title>
<p>These recurrence equations can be adapted to find the minimum-free energy structure by replacing each sum operation with a min operation and each product operation with a sum. In the CycleFold, a generic set of recursions that are used by both algorithms is implemented with C++ templates. The templated energy functions can be instantiated with integer types representing free energy changes (where free energies are multiplied by 10<sup>5</sup> and stored to 10<sup>−5</sup> kcal/mol precision), in which case mins of sums are calculated, yielding a minimum free energy. If the templates are instantiated with floating-point types, representing equilibrium constants, then sums of products are calculated, yielding a partition function.</p>
</sec>
<sec id="sec028">
<title>TurboFold algorithm</title>
<p>Consensus pair probabilities for multiple homologous sequences were determined using the TurboFold algorithm [<xref ref-type="bibr" rid="pcbi.1005827.ref047">47</xref>]. A TurboFold calculation uses tables of pairing probabilities from a partition function calculation on each sequence and a probabilistic alignment between each pair of sequences calculated with a pair Hidden Markov Model. The pairing probabilities are updated in each of multiple iterations of the algorithm. TurboFold follows the intuition that, if nucleotides <italic>i</italic> and <italic>j</italic> are likely to be paired in an RNA sequence <italic>A</italic>, and nucleotides <italic>i</italic> and <italic>j</italic> in sequence <italic>A</italic> are believed to be aligned to nucleotides <italic>i’</italic> and <italic>j’</italic> in a related sequence <italic>B</italic>, then this is evidence that <italic>i’</italic> and <italic>j’</italic> form a base pair. A table of pairing proclivities containing information about the structure of sequence <italic>B</italic> inferred from sequence <italic>A</italic> is called the <italic>E</italic><sub><italic>AB</italic></sub>, the extrinsic information about <italic>B</italic> from <italic>A</italic>. That is,
<disp-formula id="pcbi.1005827.e021">
<alternatives>
<graphic id="pcbi.1005827.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e021" xlink:type="simple"/>
<mml:math display="block" id="M21">
<mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Π</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Π</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
where <italic>N</italic><sub><italic>A</italic></sub> is the length of sequence <italic>A</italic>, <italic>π</italic><sub><italic>AB</italic></sub> is a table containing the pair HMM alignment between <italic>A</italic> and <italic>B</italic>, and <italic>P</italic><sub><italic>A</italic></sub> is the table of pairing probabilities for sequence <italic>A</italic>. An analogous calculation is used to calculate <italic>E</italic><sub><italic>BA</italic></sub>, the extrinsic information about <italic>A</italic> from <italic>B</italic>.</p>
<p>The extrinsic information for each related sequence is summed and normalized by the largest entry. This combined extrinsic information <italic>E</italic> can be incorporated into the partition function algorithm by altering the calculation of <italic>V</italic>(<italic>i</italic>,<italic>j</italic>,<italic>θ</italic>):
<disp-formula id="pcbi.1005827.e022">
<alternatives>
<graphic id="pcbi.1005827.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005827.e022" xlink:type="simple"/>
<mml:math display="block" id="M22">
<mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo><mml:mo>×</mml:mo><mml:mi>ρ</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup>
</mml:math>
</alternatives>
</disp-formula>
where <italic>ρ</italic> is a fitted parameter that quantifies the weight associated with the extrinsic information. In the implementation of CycleFold, the previously determined weight of 0.3 was used. Because the extrinsic information is normalized to a value between 0 and 1, this modification penalizes structures containing pairs inconsistent with the extrinsic information by weighting them less strongly in the partition function.</p>
<p>In the TurboFold calculation, pairwise probabilistic alignments are calculated between each structure using a pair hidden Markov model (HMM), and the partition function for each sequence is calculated. Then, the extrinsic information and the partition function for each sequence is iteratively re-calculated, first updating the partition function using the extrinsic information, then updating the extrinsic information with the partition function-determined pair probabilities.</p>
<p>The RNAstructure software package was updated to include a generic implementation of the TurboFold algorithm that is independent of the actual partition function implementation, and can iteratively re-estimate pair probabilities using any user-provided partition function. This could be useful for, as an example, custom partition dynamic programming algorithms that incorporate knowledge of the structure family of interest [<xref ref-type="bibr" rid="pcbi.1005827.ref068">68</xref>,<xref ref-type="bibr" rid="pcbi.1005827.ref069">69</xref>].</p>
</sec>
</sec>
<sec id="sec029">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005827.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title/>
<p>Native structures from (A) nuclease-resistant sequence from a Murray Valley Encephalitis virus 3’ UTR (PDB 4PQV), (B) <italic>D</italic>. <italic>radiodurans</italic> SRP hairpin domain (PDB 2XXA), and (C) twister ribozyme from <italic>Oryza sativa</italic> (PDB 4OIJ). Base pairs are drawn with black lines for canonical pairs and red lines for non-canonical pairs. Base pairs were found from the coordinates using 3DNA-DSSR version 1.1.2, all cis-Watson-Watson pairs are called canonical.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005827.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.s002" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>PDB codes of sequences used from RNAstrand in benchmark.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005827.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.s003" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Performance of structure prediction methods.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005827.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.s004" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Statistical comparison for prediction of canonical pairs with energy minimization algorithm.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005827.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.s005" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Statistical comparison of CycleFold partition function against energy minimization algorithms for canonical pairs.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005827.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.s006" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>Statistical comparison for prediction of non-canonical pairs with energy minimization algorithm.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005827.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.s007" xlink:type="simple">
<label>S6 Table</label>
<caption>
<title>Statistical comparison of CycleFold partition function against energy minimization algorithms for non-canonical pairs.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005827.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.s008" xlink:type="simple">
<label>S7 Table</label>
<caption>
<title>Statistical comparison of CycleFold (MFE) partition function with canonical constraints against energy minimization algorithms for non-canonical pairs.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005827.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.s009" xlink:type="simple">
<label>S8 Table</label>
<caption>
<title>Statistical comparison of performance between CycleFold-TurboFold and plmc.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005827.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.s010" xlink:type="simple">
<label>S9 Table</label>
<caption>
<title>Time benchmarks.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005827.s011" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005827.s011" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Information about structure prediction accuracy of each sequence when using CycleFold, Fold, MC-Fold, and MC-Fold-DP.</title>
<p>(CSV)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Richard M. Watson for his help preparing figures and preparing software for release.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005827.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cech</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Steitz</surname> <given-names>JA</given-names></name> (<year>2014</year>) <article-title>The noncoding RNA revolution-trashing old rules to forge new ones</article-title>. <source>Cell</source> <volume>157</volume>: <fpage>77</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2014.03.008" xlink:type="simple">10.1016/j.cell.2014.03.008</ext-link></comment> <object-id pub-id-type="pmid">24679528</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berman</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Westbrook</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Gilliland</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bhat</surname> <given-names>TN</given-names></name>, <etal>et al</etal>. (<year>2000</year>) <article-title>The Protein Data Bank</article-title>. <source>Nucleic Acids Res</source> <volume>28</volume>: <fpage>235</fpage>–<lpage>242</lpage>. <object-id pub-id-type="pmid">10592235</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref003"><label>3</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Leontis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Zirbel</surname> <given-names>CL</given-names></name> (<year>2012</year>) <chapter-title>Nonredundant 3D Structure Datasets for RNA Knowledge Extraction and Benchmarking</chapter-title>. In: <name name-style="western"><surname>Leontis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Westhof</surname> <given-names>E</given-names></name>, editors. <source>RNA 3D Structure Analysis and Prediction</source>: <publisher-name>Springer Berlin Heidelberg</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1005827.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Derrien</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bussotti</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Tanzer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Djebali</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The GENCODE v7 catalog of human long noncoding RNAs: analysis of their gene structure, evolution, and expression</article-title>. <source>Genome Res</source> <volume>22</volume>: <fpage>1775</fpage>–<lpage>1789</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.132159.111" xlink:type="simple">10.1101/gr.132159.111</ext-link></comment> <object-id pub-id-type="pmid">22955988</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dill</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>MacCallum</surname> <given-names>JL</given-names></name> (<year>2012</year>) <article-title>The protein-folding problem, 50 years on</article-title>. <source>Science</source> <volume>338</volume>: <fpage>1042</fpage>–<lpage>1046</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1219021" xlink:type="simple">10.1126/science.1219021</ext-link></comment> <object-id pub-id-type="pmid">23180855</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moult</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fidelis</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kryshtafovych</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schwede</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tramontano</surname> <given-names>A</given-names></name> (<year>2016</year>) <article-title>Critical assessment of methods of protein structure prediction: Progress and new directions in round XI</article-title>. <source>Proteins</source> <volume>84</volume> <issue>Suppl 1</issue>: <fpage>4</fpage>–<lpage>14</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005827.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Michel</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Westhof</surname> <given-names>E</given-names></name> (<year>1990</year>) <article-title>Modeling of the three-dimensional architecture of group I catalytic introns based on comparative sequence analysis</article-title>. <source>J Mol Biol</source> <volume>216</volume>: <fpage>585</fpage>–<lpage>610</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0022-2836(90)90386-Z" xlink:type="simple">10.1016/0022-2836(90)90386-Z</ext-link></comment> <object-id pub-id-type="pmid">2258934</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cate</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Gooding</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Podell</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Golden</surname> <given-names>BL</given-names></name>, <etal>et al</etal>. (<year>1996</year>) <article-title>Crystal structure of a group I ribozyme domain: Principles of RNA packing</article-title>. <source>Science</source> <volume>273</volume>: <fpage>1678</fpage>–<lpage>1685</lpage>. <object-id pub-id-type="pmid">8781224</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Golden</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Gooding</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Podell</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Cech</surname> <given-names>TR</given-names></name> (<year>1998</year>) <article-title>A preorganized active site in the crystal structure of the Tetrahymena ribozyme</article-title>. <source>Science</source> <volume>282</volume>: <fpage>259</fpage>–<lpage>264</lpage>. <object-id pub-id-type="pmid">9841391</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adams</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Stahley</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Kosek</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Strobel</surname> <given-names>SA</given-names></name> (<year>2004</year>) <article-title>Crystal structure of a self-splicing group I intron with both exons</article-title>. <source>Nature</source> <volume>430</volume>: <fpage>45</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature02642" xlink:type="simple">10.1038/nature02642</ext-link></comment> <object-id pub-id-type="pmid">15175762</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Major</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Turcotte</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gautheret</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lapalme</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Fillion</surname> <given-names>E</given-names></name>, <etal>et al</etal>. (<year>1991</year>) <article-title>The combination of symbolic and numerical computation for three-dimensional modeling of RNA</article-title>. <source>Science</source> <volume>253</volume>: <fpage>1255</fpage>–<lpage>1260</lpage>. <object-id pub-id-type="pmid">1716375</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parisien</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Major</surname> <given-names>F</given-names></name> (<year>2008</year>) <article-title>The MC-Fold and MC-Sym pipeline infers RNA structure from sequence data</article-title>. <source>Nature</source> <volume>452</volume>: <fpage>51</fpage>–<lpage>55</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature06684" xlink:type="simple">10.1038/nature06684</ext-link></comment> <object-id pub-id-type="pmid">18322526</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Das</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Karanicolas</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>D</given-names></name> (<year>2010</year>) <article-title>Atomic accuracy in predicting and designing noncanonical RNA structure</article-title>. <source>Nature Methods</source> <volume>7</volume>: <fpage>291</fpage>–<lpage>294</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.1433" xlink:type="simple">10.1038/nmeth.1433</ext-link></comment> <object-id pub-id-type="pmid">20190761</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Popenda</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Szachniuk</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Antczak</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Purzycka</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Lukasiak</surname> <given-names>P</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Automated 3D structure composition for large RNAs</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>e112</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gks339" xlink:type="simple">10.1093/nar/gks339</ext-link></comment> <object-id pub-id-type="pmid">22539264</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Seetin</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name> (<year>2011</year>) <article-title>Automated RNA tertiary structure prediction from secondary structure and low-resolution restraints</article-title>. <source>J Comput Chem</source> <volume>32</volume>: <fpage>2232</fpage>–<lpage>2244</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jcc.21806" xlink:type="simple">10.1002/jcc.21806</ext-link></comment> <object-id pub-id-type="pmid">21509787</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weinreb</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Riesselman</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Ingraham</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Gross</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <etal>et al</etal>. (<year>2016</year>) <article-title>3D RNA and Functional Interactions from Evolutionary Couplings</article-title>. <source>Cell</source> <volume>165</volume>: <fpage>963</fpage>–<lpage>975</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2016.03.030" xlink:type="simple">10.1016/j.cell.2016.03.030</ext-link></comment> <object-id pub-id-type="pmid">27087444</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gherghe</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Leonard</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Ding</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Dokholyan</surname> <given-names>NV</given-names></name>, <name name-style="western"><surname>Weeks</surname> <given-names>KM</given-names></name> (<year>2009</year>) <article-title>Native-like RNA tertiary structures using a sequence-encoded cleavage agent and refinement by discrete molecular dynamics</article-title>. <source>J Am Chem Soc</source> <volume>131</volume>: <fpage>2541</fpage>–<lpage>2546</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ja805460e" xlink:type="simple">10.1021/ja805460e</ext-link></comment> <object-id pub-id-type="pmid">19193004</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Krokhotin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Houlihan</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dokholyan</surname> <given-names>NV</given-names></name> (<year>2015</year>) <article-title>iFoldRNA v2: folding RNA with constraints</article-title>. <source>Bioinformatics</source> <volume>31</volume>: <fpage>2891</fpage>–<lpage>2893</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btv221" xlink:type="simple">10.1093/bioinformatics/btv221</ext-link></comment> <object-id pub-id-type="pmid">25910700</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sharma</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ding</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Dokholyan</surname> <given-names>NV</given-names></name> (<year>2008</year>) <article-title>iFoldRNA: three-dimensional RNA structure prediction and folding</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>1951</fpage>–<lpage>1952</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btn328" xlink:type="simple">10.1093/bioinformatics/btn328</ext-link></comment> <object-id pub-id-type="pmid">18579566</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jonikas</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Radmer</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Altman</surname> <given-names>RB</given-names></name> (<year>2009</year>) <article-title>Knowledge-based instantiation of full atomic detail into coarse-grain RNA 3D structural models</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>3259</fpage>–<lpage>3266</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btp576" xlink:type="simple">10.1093/bioinformatics/btp576</ext-link></comment> <object-id pub-id-type="pmid">19812110</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Flores</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Altman</surname> <given-names>RB</given-names></name> (<year>2010</year>) <article-title>Turning limited experimental information into 3D models of RNA</article-title>. <source>RNA</source> <volume>16</volume>: <fpage>1769</fpage>–<lpage>1778</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1261/rna.2112110" xlink:type="simple">10.1261/rna.2112110</ext-link></comment> <object-id pub-id-type="pmid">20651028</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Flores</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Sherman</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Bruns</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Eastman</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Altman</surname> <given-names>RB</given-names></name> (<year>2011</year>) <article-title>Fast flexible modeling of RNA structure using internal coordinates</article-title>. <source>IEEE/ACM Trans Comput Biol Bioinform</source> <volume>8</volume>: <fpage>1247</fpage>–<lpage>1257</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TCBB.2010.104" xlink:type="simple">10.1109/TCBB.2010.104</ext-link></comment> <object-id pub-id-type="pmid">21778523</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Laing</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Elmetwaly</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jung</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Curuksu</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Graph-based sampling for approximating global helical topologies of RNA</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>111</volume>: <fpage>4079</fpage>–<lpage>4084</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1318893111" xlink:type="simple">10.1073/pnas.1318893111</ext-link></comment> <object-id pub-id-type="pmid">24591615</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Zahran</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schlick</surname> <given-names>T</given-names></name> (<year>2015</year>) <article-title>Computational prediction of riboswitch tertiary structures including pseudoknots by RAGTOP: a hierarchical graph sampling approach</article-title>. <source>Methods Enzymol</source> <volume>553</volume>: <fpage>115</fpage>–<lpage>135</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/bs.mie.2014.10.054" xlink:type="simple">10.1016/bs.mie.2014.10.054</ext-link></comment> <object-id pub-id-type="pmid">25726463</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kerpedjiev</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Honer Zu Siederdissen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hofacker</surname> <given-names>IL</given-names></name> (<year>2015</year>) <article-title>Predicting RNA 3D structure using a coarse-grain helix-centered model</article-title>. <source>RNA</source> <volume>21</volume>: <fpage>1110</fpage>–<lpage>1121</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1261/rna.047522.114" xlink:type="simple">10.1261/rna.047522.114</ext-link></comment> <object-id pub-id-type="pmid">25904133</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rother</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rother</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Puton</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bujnicki</surname> <given-names>JM</given-names></name> (<year>2011</year>) <article-title>ModeRNA: a tool for comparative modeling of RNA 3D structure</article-title>. <source>Nucleic Acids Res</source> <volume>39</volume>: <fpage>4007</fpage>–<lpage>4022</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkq1320" xlink:type="simple">10.1093/nar/gkq1320</ext-link></comment> <object-id pub-id-type="pmid">21300639</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Miao</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Adamiak</surname> <given-names>RW</given-names></name>, <name name-style="western"><surname>Blanchet</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Boniecki</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bujnicki</surname> <given-names>JM</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>RNA-Puzzles Round II: assessment of RNA structure prediction programs applied to three large RNA structures</article-title>. <source>RNA</source> <volume>21</volume>: <fpage>1066</fpage>–<lpage>1084</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1261/rna.049502.114" xlink:type="simple">10.1261/rna.049502.114</ext-link></comment> <object-id pub-id-type="pmid">25883046</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leontis</surname> <given-names>NB</given-names></name>, <name name-style="western"><surname>Stombaugh</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Westhof</surname> <given-names>E</given-names></name> (<year>2002</year>) <article-title>The non-Watson-Crick base pairs and their associated isostericity matrices</article-title>. <source>Nucleic Acids Res</source> <volume>30</volume>: <fpage>3497</fpage>–<lpage>3531</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkf481" xlink:type="simple">10.1093/nar/gkf481</ext-link></comment> <object-id pub-id-type="pmid">12177293</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hendrix</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Brenner</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Holbrook</surname> <given-names>SR</given-names></name> (<year>2005</year>) <article-title>RNA structural motifs: building blocks of a modular biomolecule</article-title>. <source>Q Rev Biophys</source> <volume>38</volume>: <fpage>221</fpage>–<lpage>243</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S0033583506004215" xlink:type="simple">10.1017/S0033583506004215</ext-link></comment> <object-id pub-id-type="pmid">16817983</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Turner</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name> (<year>2010</year>) <article-title>NNDB: the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume>: <fpage>D280</fpage>–<lpage>282</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkp892" xlink:type="simple">10.1093/nar/gkp892</ext-link></comment> <object-id pub-id-type="pmid">19880381</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zuker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Stiegler</surname> <given-names>P</given-names></name> (<year>1981</year>) <article-title>Optimal computer folding of large RNA sequences using thermodynamics and auxiliary information</article-title>. <source>Nucleic Acids Res</source> <volume>9</volume>: <fpage>133</fpage>–<lpage>148</lpage>. <object-id pub-id-type="pmid">6163133</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lemieux</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Major</surname> <given-names>F</given-names></name> (<year>2006</year>) <article-title>Automated extraction and classification of RNA tertiary structure cyclic motifs</article-title>. <source>Nucleic Acids Res</source> <volume>34</volume>: <fpage>2340</fpage>–<lpage>2346</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkl120" xlink:type="simple">10.1093/nar/gkl120</ext-link></comment> <object-id pub-id-type="pmid">16679452</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Honer zu Siederdissen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bernhart</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Stadler</surname> <given-names>PF</given-names></name>, <name name-style="western"><surname>Hofacker</surname> <given-names>IL</given-names></name> (<year>2011</year>) <article-title>A folding algorithm for extended RNA secondary structures</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>i129</fpage>–<lpage>136</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr220" xlink:type="simple">10.1093/bioinformatics/btr220</ext-link></comment> <object-id pub-id-type="pmid">21685061</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dallaire</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Major</surname> <given-names>F</given-names></name> (<year>2016</year>) <article-title>Exploring Alternative RNA Structure Sets Using MC-Flashfold and db2cm</article-title>. <source>Methods Mol Biol</source> <volume>1490</volume>: <fpage>237</fpage>–<lpage>251</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/978-1-4939-6433-8_15" xlink:type="simple">10.1007/978-1-4939-6433-8_15</ext-link></comment> <object-id pub-id-type="pmid">27665603</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McCaskill</surname> <given-names>JS</given-names></name> (<year>1990</year>) <article-title>The equilibrium partition function and base pair probabilities for RNA secondary structure</article-title>. <source>Biopolymers</source> <volume>29</volume>: <fpage>1105</fpage>–<lpage>1119</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/bip.360290621" xlink:type="simple">10.1002/bip.360290621</ext-link></comment> <object-id pub-id-type="pmid">1695107</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name> (<year>2004</year>) <article-title>Using an RNA secondary structure partition function to determine confidence in base pairs predicted by free energy minimization</article-title>. <source>RNA</source> <volume>10</volume>: <fpage>1178</fpage>–<lpage>1190</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1261/rna.7650904" xlink:type="simple">10.1261/rna.7650904</ext-link></comment> <object-id pub-id-type="pmid">15272118</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>CY</given-names></name>, <name name-style="western"><surname>Maliyekkel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Roninson</surname> <given-names>IB</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Effect of target secondary structure on RNAi efficiency</article-title>. <source>RNA</source> <volume>13</volume>: <fpage>1631</fpage>–<lpage>1640</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1261/rna.546207" xlink:type="simple">10.1261/rna.546207</ext-link></comment> <object-id pub-id-type="pmid">17684233</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lu</surname> <given-names>ZJ</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name> (<year>2008</year>) <article-title>OligoWalk: An online siRNA design tool utilizing hybridization thermodynamics</article-title>. <source>Nucleic Acids Res</source> <volume>36</volume>: <fpage>W104</fpage>–<lpage>W108</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkn250" xlink:type="simple">10.1093/nar/gkn250</ext-link></comment> <object-id pub-id-type="pmid">18490376</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tafer</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ameres</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Obernosterer</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gebeshuber</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Schroeder</surname> <given-names>R</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>The impact of target site accessibility on the design of effective siRNAs</article-title>. <source>Nat Biotechnol</source> <volume>26</volume>: <fpage>578</fpage>–<lpage>583</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt1404" xlink:type="simple">10.1038/nbt1404</ext-link></comment> <object-id pub-id-type="pmid">18438400</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bellaousov</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name> (<year>2010</year>) <article-title>ProbKnot: Fast prediction of RNA secondary structure including pseudoknots</article-title>. <source>RNA</source> <volume>16</volume>: <fpage>1870</fpage>–<lpage>1880</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1261/rna.2125310" xlink:type="simple">10.1261/rna.2125310</ext-link></comment> <object-id pub-id-type="pmid">20699301</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dirks</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Pierce</surname> <given-names>NA</given-names></name> (<year>2003</year>) <article-title>A partition function algorithm for nucleic acid secondary structure including pseudoknots</article-title>. <source>J Comput Chem</source> <volume>24</volume>: <fpage>1664</fpage>–<lpage>1677</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jcc.10296" xlink:type="simple">10.1002/jcc.10296</ext-link></comment> <object-id pub-id-type="pmid">12926009</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Halvorsen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Broadaway</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Laederach</surname> <given-names>A</given-names></name> (<year>2010</year>) <article-title>Disease-associated mutations that alter the RNA structural ensemble</article-title>. <source>PLoS Genet</source> <volume>6</volume>: <fpage>e1001074</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1001074" xlink:type="simple">10.1371/journal.pgen.1001074</ext-link></comment> <object-id pub-id-type="pmid">20808897</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sabarinathan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Tafer</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Seemann</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Hofacker</surname> <given-names>IL</given-names></name>, <name name-style="western"><surname>Stadler</surname> <given-names>PF</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>RNAsnp: efficient detection of local RNA secondary structure changes induced by SNPs</article-title>. <source>Hum Mutat</source> <volume>34</volume>: <fpage>546</fpage>–<lpage>556</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/humu.22273" xlink:type="simple">10.1002/humu.22273</ext-link></comment> <object-id pub-id-type="pmid">23315997</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salari</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kimchi-Sarfaty</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gottesman</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Przytycka</surname> <given-names>TM</given-names></name> (<year>2013</year>) <article-title>Sensitive measurement of single-nucleotide polymorphism-induced changes of RNA conformation: application to disease studies</article-title>. <source>Nucleic Acids Res</source> <volume>41</volume>: <fpage>44</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gks1009" xlink:type="simple">10.1093/nar/gks1009</ext-link></comment> <object-id pub-id-type="pmid">23125360</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Corley</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Solem</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Qu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>HY</given-names></name>, <name name-style="western"><surname>Laederach</surname> <given-names>A</given-names></name> (<year>2015</year>) <article-title>Detecting riboSNitches with RNA folding algorithms: a genome-wide benchmark</article-title>. <source>Nucleic Acids Res</source> <volume>43</volume>: <fpage>1859</fpage>–<lpage>1868</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkv010" xlink:type="simple">10.1093/nar/gkv010</ext-link></comment> <object-id pub-id-type="pmid">25618847</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref046"><label>46</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Woese</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pace</surname> <given-names>N</given-names></name> (<year>1993</year>) <chapter-title>Probing RNA structure, function, and history by comparative analysis</chapter-title>. In: <name name-style="western"><surname>Gesteland</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Atkins</surname> <given-names>JF</given-names></name>, editor. <source>The RNA World</source>. <publisher-loc>Cold Spring Harbor, NY</publisher-loc>: <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>. pp. <fpage>91</fpage>–<lpage>117</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005827.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harmanci</surname> <given-names>AO</given-names></name>, <name name-style="western"><surname>Sharma</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name> (<year>2011</year>) <article-title>TurboFold: Iterative probabilistic estimation of secondary structures for multiple RNA sequences</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>108</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-12-108" xlink:type="simple">10.1186/1471-2105-12-108</ext-link></comment> <object-id pub-id-type="pmid">21507242</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Do</surname> <given-names>CB</given-names></name>, <name name-style="western"><surname>Woods</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Batzoglou</surname> <given-names>S</given-names></name> (<year>2006</year>) <article-title>CONTRAfold: RNA secondary structure prediction without physics-based models</article-title>. <source>Bioinformatics</source> <volume>22</volume>: <fpage>e90</fpage>–<lpage>98</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btl246" xlink:type="simple">10.1093/bioinformatics/btl246</ext-link></comment> <object-id pub-id-type="pmid">16873527</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lu</surname> <given-names>ZJ</given-names></name>, <name name-style="western"><surname>Gloor</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name> (<year>2009</year>) <article-title>Improved RNA secondary structure prediction by maximizing expected pair accuracy</article-title>. <source>RNA</source> <volume>15</volume>: <fpage>1805</fpage>–<lpage>1813</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1261/rna.1643609" xlink:type="simple">10.1261/rna.1643609</ext-link></comment> <object-id pub-id-type="pmid">19703939</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Gerczei</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Glover</surname> <given-names>LT</given-names></name>, <name name-style="western"><surname>Correll</surname> <given-names>CC</given-names></name> (<year>2001</year>) <article-title>Crystal structures of restrictocin-inhibitor complexes with implications for RNA recognition and base flipping</article-title>. <source>Nat Struct Biol</source> <volume>8</volume>: <fpage>968</fpage>–<lpage>973</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nsb1101-968" xlink:type="simple">10.1038/nsb1101-968</ext-link></comment> <object-id pub-id-type="pmid">11685244</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andronescu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bereg</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Hoos</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Condon</surname> <given-names>A</given-names></name> (<year>2008</year>) <article-title>RNA STRAND: the RNA secondary structure and statistical analysis database</article-title>. <source>BMC Bioinformatics</source> <volume>9</volume>: <fpage>340</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-9-340" xlink:type="simple">10.1186/1471-2105-9-340</ext-link></comment> <object-id pub-id-type="pmid">18700982</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gutell</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Cannone</surname> <given-names>JJ</given-names></name> (<year>2002</year>) <article-title>The accuracy of ribosomal RNA comparative structure models</article-title>. <source>Curr Opin Struct Biol</source> <volume>12</volume>: <fpage>301</fpage>–<lpage>310</lpage>. <object-id pub-id-type="pmid">12127448</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chapman</surname> <given-names>EG</given-names></name>, <name name-style="western"><surname>Costantino</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Rabe</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Moon</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Wilusz</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>The structural basis of pathogenic subgenomic flavivirus RNA (sfRNA) production</article-title>. <source>Science</source> <volume>344</volume>: <fpage>307</fpage>–<lpage>310</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1250897" xlink:type="simple">10.1126/science.1250897</ext-link></comment> <object-id pub-id-type="pmid">24744377</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ataide</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Schmitz</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ke</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shan</surname> <given-names>SO</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>The crystal structure of the signal recognition particle in complex with its receptor</article-title>. <source>Science</source> <volume>331</volume>: <fpage>881</fpage>–<lpage>886</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1196473" xlink:type="simple">10.1126/science.1196473</ext-link></comment> <object-id pub-id-type="pmid">21330537</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>McPhee</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Lilley</surname> <given-names>DM</given-names></name> (<year>2014</year>) <article-title>Crystal structure and mechanistic investigation of the twister ribozyme</article-title>. <source>Nat Chem Biol</source> <volume>10</volume>: <fpage>739</fpage>–<lpage>744</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nchembio.1587" xlink:type="simple">10.1038/nchembio.1587</ext-link></comment> <object-id pub-id-type="pmid">25038788</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Seetin</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name> (<year>2012</year>) <article-title>TurboKnot: Rapid Prediction of Conserved RNA Secondary Structures Including Pseudoknots</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>792</fpage>–<lpage>798</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bts044" xlink:type="simple">10.1093/bioinformatics/bts044</ext-link></comment> <object-id pub-id-type="pmid">22285566</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rivas</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name> (<year>1999</year>) <article-title>A dynamic programming algorithm for RNA structure prediction including pseudoknots</article-title>. <source>J Mol Biol</source> <volume>285</volume>: <fpage>2053</fpage>–<lpage>2068</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005827.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sloma</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name> (<year>2016</year>) <article-title>Exact calculation of loop formation probability identifies folding motifs in RNA secondary structures</article-title>. <source>RNA</source> <volume>22</volume>: <fpage>1808</fpage>–<lpage>1818</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1261/rna.053694.115" xlink:type="simple">10.1261/rna.053694.115</ext-link></comment> <object-id pub-id-type="pmid">27852924</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Sabina</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zuker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Turner</surname> <given-names>DH</given-names></name> (<year>1999</year>) <article-title>Expanded sequence dependence of thermodynamic parameters provides improved prediction of RNA secondary structure</article-title>. <source>J Mol Biol</source> <volume>288</volume>: <fpage>911</fpage>–<lpage>940</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/jmbi.1999.2700" xlink:type="simple">10.1006/jmbi.1999.2700</ext-link></comment> <object-id pub-id-type="pmid">10329189</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Woodson</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Crothers</surname> <given-names>DM</given-names></name> (<year>1987</year>) <article-title>Proton nuclear magnetic resonance studies on bulge-containing DNA oligonucleotides from a mutational hot-spot sequence</article-title>. <source>Biochemistry</source> <volume>26</volume>: <fpage>904</fpage>–<lpage>912</lpage>. <object-id pub-id-type="pmid">3567151</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref061"><label>61</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chang</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Tran</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nikonowicz</surname> <given-names>EP</given-names></name> (<year>2017</year>) <article-title>Structure and Dynamics of the Tetra-A Loop and (A-A)-U Sequence Motif within the Coliphage GA Replicase RNA Operator</article-title>. <source>Biochemistry</source> <volume>56</volume>: <fpage>2690</fpage>–<lpage>2700</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/acs.biochem.7b00123" xlink:type="simple">10.1021/acs.biochem.7b00123</ext-link></comment> <object-id pub-id-type="pmid">28488852</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref062"><label>62</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Znosko</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Silvestri</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Volkman</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Boswell</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Serra</surname> <given-names>MJ</given-names></name> (<year>2002</year>) <article-title>Thermodynamic parameters for an expanded nearest-neighbor model for the formation of RNA duplexes with single nucleotide bulges</article-title>. <source>Biochemistry</source> <volume>41</volume>: <fpage>10406</fpage>–<lpage>10417</lpage>. <object-id pub-id-type="pmid">12173927</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lu</surname> <given-names>XJ</given-names></name>, <name name-style="western"><surname>Bussemaker</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Olson</surname> <given-names>WK</given-names></name> (<year>2015</year>) <article-title>DSSR: an integrated software tool for dissecting the spatial structure of RNA</article-title>. <source>Nucleic Acids Res</source> <volume>43</volume>: <fpage>e142</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkv716" xlink:type="simple">10.1093/nar/gkv716</ext-link></comment> <object-id pub-id-type="pmid">26184874</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref064"><label>64</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andersen</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Rosenblad</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Larsen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Westergaard</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Burks</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>The tmRDB and SRPDB resources</article-title>. <source>Nucleic Acids Res</source> <volume>34</volume>: <fpage>D163</fpage>–<lpage>168</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkj142" xlink:type="simple">10.1093/nar/gkj142</ext-link></comment> <object-id pub-id-type="pmid">16381838</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref065"><label>65</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jones</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Oliphant</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>P</given-names></name> (<year>2001</year>) <article-title>SciPy: Open Source scientific tools for Python</article-title>.</mixed-citation></ref>
<ref id="pcbi.1005827.ref066"><label>66</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ding</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>CE</given-names></name> (<year>2003</year>) <article-title>A statistical sampling algorithm for RNA secondary structure prediction</article-title>. <source>Nucleic Acids Res</source> <volume>31</volume>: <fpage>7280</fpage>–<lpage>7301</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkg938" xlink:type="simple">10.1093/nar/gkg938</ext-link></comment> <object-id pub-id-type="pmid">14654704</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref067"><label>67</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reuter</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name> (<year>2010</year>) <article-title>RNAstructure: software for RNA secondary structure prediction and analysis</article-title>. <source>BMC Bioinformatics</source> <volume>11</volume>: <fpage>129</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-11-129" xlink:type="simple">10.1186/1471-2105-11-129</ext-link></comment> <object-id pub-id-type="pmid">20230624</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref068"><label>68</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reinkensmeier</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Giegerich</surname> <given-names>R</given-names></name> (<year>2015</year>) <article-title>Thermodynamic matchers for the construction of the cuckoo RNA family</article-title>. <source>RNA Biol</source> <volume>12</volume>: <fpage>197</fpage>–<lpage>207</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/15476286.2015.1017206" xlink:type="simple">10.1080/15476286.2015.1017206</ext-link></comment> <object-id pub-id-type="pmid">25779873</object-id></mixed-citation></ref>
<ref id="pcbi.1005827.ref069"><label>69</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hochsmann</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hochsmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Giegerich</surname> <given-names>R</given-names></name> (<year>2006</year>) <article-title>Thermodynamic matchers: strengthening the significance of RNA folding energies</article-title>. <source>Comput Syst Bioinformatics Conf</source>: <fpage>111</fpage>–<lpage>121</lpage>. <object-id pub-id-type="pmid">17369630</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>