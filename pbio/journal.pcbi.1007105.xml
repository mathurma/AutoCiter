<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01628</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1007105</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence motif analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Drosophila melanogaster</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Drosophila melanogaster</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Animal models</subject><subj-group><subject>Drosophila melanogaster</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Invertebrates</subject><subj-group><subject>Arthropoda</subject><subj-group><subject>Insects</subject><subj-group><subject>Drosophila</subject><subj-group><subject>Drosophila melanogaster</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Linguistics</subject><subj-group><subject>Grammar</subject><subj-group><subject>Syntax</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Behavior</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Behavior</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Abdomen</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Abdomen</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Neuroanatomy</subject><subj-group><subject>Neural pathways</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Neuroanatomy</subject><subj-group><subject>Neural pathways</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroanatomy</subject><subj-group><subject>Neural pathways</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Mathematical models</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title><italic>Drosophila melanogaster</italic> grooming possesses syntax with distinct rules at different temporal scales</article-title>
<alt-title alt-title-type="running-head">Syntax structure in <italic>Drosophila melanogaster</italic> grooming</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7916-4846</contrib-id>
<name name-style="western">
<surname>Mueller</surname> <given-names>Joshua M.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Ravbar</surname> <given-names>Primoz</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Simpson</surname> <given-names>Julie H.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Carlson</surname> <given-names>Jean M.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Interdepartmental Graduate Program in Dynamical Neuroscience, University of California, Santa Barbara, Santa Barbara, California, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Physics, University of California, Santa Barbara, Santa Barbara, California, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Molecular, Cellular, and Developmental Biology, University of California, Santa Barbara, Santa Barbara, California, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Calhoun</surname> <given-names>Adam</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Princeton University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="other" id="econtrib001">
<p>‡ These authors also contributed equally to this work.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">jmueller@ucsb.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>6</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>26</day>
<month>6</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>6</issue>
<elocation-id>e1007105</elocation-id>
<history>
<date date-type="received">
<day>19</day>
<month>9</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>5</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Mueller et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1007105"/>
<abstract>
<p>Mathematical modeling of behavioral sequences yields insight into the rules and mechanisms underlying sequence generation. Grooming in <italic>Drosophila melanogaster</italic> is characterized by repeated execution of distinct, stereotyped actions in variable order. Experiments demonstrate that, following stimulation by an irritant, grooming progresses gradually from an early phase dominated by anterior cleaning to a later phase with increased walking and posterior cleaning. We also observe that, at an intermediate temporal scale, there is a strong relationship between the amount of time spent performing body-directed grooming actions and leg-directed actions. We then develop a series of data-driven Markov models that isolate and identify the behavioral features governing transitions between individual grooming bouts. We identify action order as the primary driver of probabilistic, but non-random, syntax structure, as has previously been identified. Subsequent models incorporate grooming bout duration, which also contributes significantly to sequence structure. Our results show that, surprisingly, the syntactic rules underlying probabilistic grooming transitions possess action duration-dependent structure, suggesting that sensory input-independent mechanisms guide grooming behavior at short time scales. Finally, the inclusion of a simple rule that modifies grooming transition probabilities over time yields a generative model that recapitulates the key features of observed grooming sequences at several time scales. These discoveries suggest that sensory input guides action selection by modulating internally generated dynamics. Additionally, the discovery of these principles governing grooming in <italic>D. melanogaster</italic> demonstrates the utility of incorporating temporal information when characterizing the syntax of behavioral sequences.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Analysis of temporally rich behavioral sequences provides a quantitative description of the rules underlying their generation. <italic>Drosophila melanogaster</italic> grooming behavior consists of many complex sequences involving repetitions of well-characterized actions. In this paper, we leverage advances in machine vision to automatically annotate over 40 hours of video data of flies covered in dust and develop mathematical models that reveal the existence of syntax in <italic>D. melanogaster</italic> grooming. We find that sequence organization depends on grooming action identity, as has been well-established, and, more surprisingly, grooming action duration. The discovery of duration-dependent action selection leads us to conclude that, although sensory input informs grooming decisions on long time scales, internal dynamics also guide individual transitions between grooming actions. Therefore, incorporating action duration into our models allows us to uncover multi-scale temporal dynamics that suggest the existence of neural circuits dedicated to partially sensory-independent decision-making. Our approach highlights the importance of incorporating temporal information into sequential models, as doing so reveals the relative contributions of sensory input and internal dynamics to behavioral sequence generation.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by the David and Lucile Packard Foundation and the Institute for Collaborative Biotechnologies through contract no. W911NF-09-D-0001 from the U.S. Army Research Office (JMM and JMC). This work was also supported by HHMI (Janelia Research Campus) and UCSB start up funds (PR and JHS). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="0"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All MATLAB data files, including ethograms and transition probability matrices, used in this manuscript are available from The Open Science Framework in the project "Syntax structure in Drosophila melanogaster grooming depends on action order and duration" (<ext-link ext-link-type="uri" xlink:href="https://osf.io/h2uzb/" xlink:type="simple">https://osf.io/h2uzb/</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Sequential animal behaviors are often composed of repetitions of simple subroutines. In driving motor action execution, nervous systems must integrate sensory information with internal priorities and dynamics. Both external and internal conditions contribute to sequence organization, but their respective weights are unknown. At one extreme, purely sensory-driven, reflexive processes produce actions, such as larval escape sequences, solely based on recent sensory input [<xref ref-type="bibr" rid="pcbi.1007105.ref001">1</xref>]. At the other, internally generated and maintained nervous system dynamics, such as those found in the crustacean stomatogastric ganglion, may produce behaviors which proceed irrespective of changing external conditions [<xref ref-type="bibr" rid="pcbi.1007105.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1007105.ref003">3</xref>].</p>
<p>Grooming, a common behavior across species, confers social and survival benefits [<xref ref-type="bibr" rid="pcbi.1007105.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1007105.ref005">5</xref>] and provides a rich source of data for discovering rules that organisms use to produce behavioral sequences. The vocabulary of grooming consists of the possible actions that may be executed and has been cataloged in mice and several species of flies [<xref ref-type="bibr" rid="pcbi.1007105.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1007105.ref008">8</xref>]. However, the rules for grooming action sequence organization, or syntax, remain poorly understood. In <italic>Drosophila melanogaster</italic>, or fruit flies, these sequences are variable between individuals and within individuals across grooming sessions, suggesting that flies use non-deterministic rules to make grooming decisions. Because of the complex structure of these sequences, analysis of <italic>D. melanogaster</italic> grooming can reveal distinct rules of sequence generation at different temporal scales: the long time scale of bulk behavioral progression, the intermediate scale of grooming motifs, and the short scale of individual grooming bouts.</p>
<p>On long time scales, <italic>D. melanogaster</italic> grooming in response to exposure to an irritant is well-described as a process that typically progresses from an early phase characterized by preferential grooming of anterior body parts, such as eyes, to a later phase which exhibits heightened proportions of walking, abdomen cleaning, and wing cleaning. This progression occurs gradually over the course of many minutes. Previously published computational models which utilize either hierarchically structured suppression or graded sensory gain exhibit gross features of this progression, namely a gradual transition from early anterior-heavy grooming to a later quasi-steady state featuring increased posterior grooming and walking levels [<xref ref-type="bibr" rid="pcbi.1007105.ref009">9</xref>].</p>
<p>At an intermediate temporal scale, grooming is organized in units that we refer to as motifs. We identify two classes of motifs (anterior and posterior), which are named for the set of legs used to execute them (front and back, respectively). Motifs consist of consecutive alternations between body-directed grooming bouts and leg rubbing bouts. Bouts are defined as sustained periods of a single grooming action (e.g. head cleaning or wing cleaning). Grooming bouts occur at the shortest time scale we consider here, as individual bouts typically last somewhere between 150 ms and 2 s. Flies use the same pair of legs to execute bouts within a motif, allowing them to transition between within-motif actions easily. Specifically, an anterior grooming motif consists of consecutive alternations between bouts of head cleaning and front leg rubbing. A posterior motif consists of alternating bouts of abdomen cleaning, wing cleaning, and back leg rubbing.</p>
<p>Analysis of freely-behaving flies reveals behavioral structure at multiple time scales, with coarse-grained descriptions being sufficient to describe long-term trends and higher resolution descriptions providing increased predictive power at shorter time scales [<xref ref-type="bibr" rid="pcbi.1007105.ref010">10</xref>]. This finding suggests that there is value in examining sequential data at several levels of temporal resolution. Additionally, it suggests that treating behaviors as both continuously varying and discretely separated in the same analysis can yield more insight than considering either purely continuous or discrete models. Currently, we do not know how flies integrate sensory information with internal states in order to produce multi-scale grooming behavior. It is possible that long time scale grooming trends are governed principally by changing sensory conditions, as grooming results in the removal of irritant over time. Several studies also provide evidence that sensory input is sufficient to drive grooming behavior in a reflex-like fashion at short time scales [<xref ref-type="bibr" rid="pcbi.1007105.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1007105.ref012">12</xref>]. Here, we use statistical models to characterize grooming syntax at each of the temporal scales mentioned above.</p>
<p>Several classes of Markov models, in which the probability of an event occurring is contingent upon previous events, have been used to describe factors involved in non-deterministic decision-making in various animals. Different Markov models vary in their structure and number of parameters but they each require a well-defined state space. Navigation and foraging have been described using Markov models, as these sequential behaviors can be decomposed into subroutines which can be categorized using easily observable dimensions such as direction and velocity [<xref ref-type="bibr" rid="pcbi.1007105.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1007105.ref015">15</xref>]. These models are applicable to common behaviors exhibited by <italic>D. melanogaster</italic> as well, such as courtship and locomotion [<xref ref-type="bibr" rid="pcbi.1007105.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1007105.ref018">18</xref>]. Recent work from Tao et al. uses a Hierarchical Hidden Markov Model (HHMM) to analyze fruit fly locomotor behavior in the presence of odors [<xref ref-type="bibr" rid="pcbi.1007105.ref019">19</xref>]. They find that, although locomotor behavior is non-stereotyped, it can be decomposed into stereotyped units, making it suitable for analysis within a Markovian framework. Berman et al. [<xref ref-type="bibr" rid="pcbi.1007105.ref020">20</xref>] use high-order Markov models to describe the behavior of freely-roaming <italic>D. melanogaster</italic>, suggesting the applicability of such models to behavioral subsets identified in their analysis, including grooming behavior.</p>
<p>It should be noted that non-Markovian dynamics have also been identified in animal vocal sequence production, suggesting that other classes of models may be useful for describing behavioral generation [<xref ref-type="bibr" rid="pcbi.1007105.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1007105.ref023">23</xref>]. In fact, Berman et al. [<xref ref-type="bibr" rid="pcbi.1007105.ref020">20</xref>] report that, although a Markovian framework is useful for illustrating some features of behavioral transitions, they observe long time dependencies in their data that cannot be captured by their Markov models.</p>
<p>Here, we use our in-house Automatic Behavior Recognition System (ABRS, <ext-link ext-link-type="uri" xlink:href="https://github.com/AutomaticBehaviorRecognitionSystem/ABRS/" xlink:type="simple">https://github.com/AutomaticBehaviorRecognitionSystem/ABRS/</ext-link>), which can classify different grooming movements from videos of flies covered in dust, to generate a large data set of ethograms—records of cleaning actions over time—from wild-type flies removing dust. We analyze more than 40 total hours of video from over 90 flies (<xref ref-type="fig" rid="pcbi.1007105.g001">Fig 1</xref>).</p>
<fig id="pcbi.1007105.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007105.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Applying the ABRS classifier to video data generates large-scale ethogram data sets.</title>
<p>A: The ABRS classifier is trained to annotate video data with labels corresponding to one of five grooming actions observed in <italic>D. melanogaster</italic> (front leg rubbing = f, head cleaning = h, abdomen cleaning = a, back leg rubbing = b, wing cleaning = w) or two non-grooming actions (walking = wk, standing = s, not shown). Color bar (right) displays the corresponding color code used for visualization of grooming action sequences. B: Flies are covered with dust, placed in a chamber, and recorded from above. Video data is then passed through the ABRS classifier, which locates the fly in each frame and applies a behavioral label. Here, the fly is shown performing a front leg rub. C: After classification, video data can be represented by a vector. Each vector element represents one frame and contains a behavioral label, visualized here using a color code. Without loss of information, the real time ethogram (left) is recast as a discrete bout ethogram, defined by discrete transitions between individual bouts, which are labeled by both action and duration. We refer to this process as “discretizing” the ethogram. This results in a vector (right) containing both an ordered list of grooming action labels (color) and grooming action durations (number). For example, the first bout shown here consisting of consecutive frames of head grooming would be discretized such that its corresponding action label would be “h”, indicated by the purple block. For illustrative purposes, we choose bout durations, shown below the discrete bout ethogram, that are representative of the observed distributions. We refer to instances of sustained identical grooming actions as bouts. D: Real time ethograms for 92 dusted flies (left) are shown as a matrix containing 92 rows and 50,000 columns. After discretization, ethograms contain variable numbers of bouts but retain information about bout order and bout duration (right).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.g001" xlink:type="simple"/>
</fig>
<p>First, this data set allows us to quantify behavioral trends at several temporal scales on a larger data set than has been previously described. <xref ref-type="fig" rid="pcbi.1007105.g002">Fig 2</xref> provides a schematic overview of the temporal scales we analyze here. Notably, we observe the progression from anterior to posterior grooming that has been identified by Seeds et al. [<xref ref-type="bibr" rid="pcbi.1007105.ref009">9</xref>]. We also observe a strong correlation between body-directed and leg-directed cleaning actions within motifs. That is, the amount of head cleaning and front leg rubbing are extremely strongly correlated over the entire course of grooming, as are the amount of back leg rubbing and the sum of abdomen and wing cleaning. Finally, we observe a relaxation into steady state-like behavior after approximately 13 minutes of grooming.</p>
<fig id="pcbi.1007105.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007105.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Schematic overview of the multiple time scales present in <italic>Drosophila melanogaster</italic> grooming ethograms.</title>
<p>Grooming ethograms possess at least three distinct time scales. The grooming progression (top), which takes many minutes to observe in its entirety, occurs at the longest time scale we consider here. We refer to this phenomenon as a progression because we observe that, on average, flies begin grooming with anterior-oriented actions and end with posterior-oriented actions and more walking. At an intermediate time scale, ethograms consist of grooming motifs (middle). Motifs are composed of consecutive grooming bouts which use the same pair of legs (either anterior or posterior). At the shortest time scale, we observe individual grooming bouts (bottom), which consist of sustained grooming movements that range from several hundreds of milliseconds to a few seconds in duration.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.g002" xlink:type="simple"/>
</fig>
<p>Next, we use a set of Markov models to characterize probabilistic rules governing grooming action transitions. We use a Markovian framework as a first approximation in order to discover relevant features of grooming, since Markov models are simple and carry few assumptions. As such, these models serve as a tool for grooming sequence feature identification rather than as a full explication of grooming decision-making factors. Previous work has indicated that such analysis can reveal temporal relationships in sequential behavioral data, indicating that, even if the behavior being analyzed is not fully Markovian in reality, Markov models can still be useful as a descriptive exploratory tool [<xref ref-type="bibr" rid="pcbi.1007105.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1007105.ref020">20</xref>].</p>
<p>The simplest of our models, a first order discrete time Markov chain, highlights the presence of grooming motif structure. Subsequent models incorporate temporal information by considering grooming bout durations. By comparing these models to statistical null model hypotheses, which shuffle bout order or bout duration, we discover the contribution of bout duration to grooming sequence structure at short time scales.</p>
<p>Though we rely on a Markovian framework to identify features of grooming syntax, our analysis does not preclude the possibility of non-Markovian dynamics in fruit fly grooming. Indeed, our data exhibits two notable nonstationarities. First, we observe an overall trend in grooming proportions, as has been reported previously [<xref ref-type="bibr" rid="pcbi.1007105.ref009">9</xref>], wherein flies favor anterior grooming immediately after being dusted but favor posterior grooming and walking after approximately 10-15 minutes. Second, grooming transition probabilities change slightly over the course of grooming (though they are unexpectedly stationary over time), indicating that a purely stationary model is an oversimplification. To account for this, we extend our analysis to include a simple nonstationarity which captures sequence progression more closely than a first order Markov chain.</p>
<p>We find that a time-varying Markov renewal process (MRP) which incorporates bout duration dependence recapitulates the observed grooming structure at long, intermediate, and short time scales. This model is partially Markovian, as transition probability matrices dictate state transition dynamics. However, the model also includes renewal process dynamics, in which the duration of the ensuing bout is determined using a random draw from the empirically observed bout duration distribution. This model is nonstationary due to the fact that Markov transition probabilities change over time. This model recapitulates both the observed bulk grooming progression statistics and the fine-grain temporal structure of grooming motifs, suggesting that sensory drive can modulate internal programs in a simple manner to prioritize different grooming strategies in different contexts.</p>
<p>Our models clarify the syntax of grooming, demonstrating that, at the scale of individual bouts, transitions are dictated by both the identity and duration of the preceding bout. While previous studies have established the non-random nature of fruit fly grooming [<xref ref-type="bibr" rid="pcbi.1007105.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1007105.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1007105.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1007105.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1007105.ref020">20</xref>], this work reveals the previously unknown contribution of grooming bout duration to sequence structure, suggesting a role for sensory input-independent decision-making. Finally, a model that includes duration dependence at the scale of individual grooming decisions and a linear progression to mimic dust removal is able to generate synthetic ethograms that closely resemble observed data at the intermediate scale of motifs and the long scale of the grooming progression.</p>
<p>The discovery of duration dependence in grooming sequence structure suggests the existence of neural circuits in <italic>D. melanogaster</italic> that can generate patterned behavior irrespective of sensory drive, as transition rules and bout durations remain nearly constant even as the dust distribution varies over the course of grooming. Additionally, the tight correlation between body and leg-directed actions within motifs demonstrates for the first time the existence of duration dependence at an intermediate temporal scale. Finally, the model improvements provided by the inclusion of a simple nonstationarity suggest that sensory drive plays a role in guiding the implementation of internal programs over long time scales rather than serving a purely reflexive action selection function at short time scales. These discoveries provide the groundwork for future experiments and analysis of the neural underpinnings of duration-dependent action selection and sensory-driven modulation of decision-making in grooming and related behaviors.</p>
</sec>
<sec id="sec002">
<title>Methods and models</title>
<sec id="sec003">
<title>Ethogram generation</title>
<p><italic>Drosophila melanogaster</italic> (N = 92) were recorded at 30 Hz for 27.8 minutes after being uniformly covered in Reactive Yellow 86 dust (Organic Dyestuffs Corporation, Concord, North Carolina). To generate labeled ethograms, we apply the ABRS classifier to video (<ext-link ext-link-type="uri" xlink:href="https://github.com/AutomaticBehaviorRecognitionSystem/ABRS" xlink:type="simple">https://github.com/AutomaticBehaviorRecognitionSystem/ABRS</ext-link>). Following this, real time ethograms are converted to discrete bout ethograms and de-noised (<xref ref-type="fig" rid="pcbi.1007105.g001">Fig 1</xref>).</p>
<p>Briefly, the classifier is trained on grooming data using a combination of supervised and unsupervised protocols in several steps. First, a Fourier transform is performed on pixel intensity data across 17-frame sliding windows (∼0.5 s), resulting in two-dimensional spectra referred to as space-time images (ST-images). ST-images are subsequently modified by Radon transformation, which can be used to represent 2D shapes in a rotation and translation-invariant manner. Fast Fourier transformation is then applied to the Radon transformed ST-images, resulting in position and orientation-invariant ST-images [<xref ref-type="bibr" rid="pcbi.1007105.ref024">24</xref>].</p>
<p>ST-images are then decomposed using singular value decomposition (SVD) and clustered using linear discrimination analysis (LDA) with human labeled behavioral categories. Clusters identified using LDA correspond to five predefined grooming behaviors (f = front leg rubbing, h = head cleaning, a = abdomen cleaning, b = back leg rubbing, w = wing cleaning) and two non-grooming behaviors (wk = walking, s = standing). After classification, each video is represented by a 50,000-element vector, with each element containing a label denoting the behavior identified in the corresponding frame. Classifier performance and validation are shown in <xref ref-type="supplementary-material" rid="pcbi.1007105.s001">S1 Fig</xref>.</p>
<p>To generate discrete bout ethograms, each 50,000-element vector is transformed into a two-dimensional vector in a series of steps. The first row of this discrete bout ethogram contains the bout identity, or the label corresponding to one of the seven behaviors described above. The second row contains the bout durations, or the amount of time spent in the corresponding behavior before transitioning to another behavior.</p>
<p>Consecutive frames containing identical actions are consolidated into one bout identity entry. Then, the corresponding bout duration entry is calculated by counting the number of consecutive identical frames and converted into seconds by dividing by the video frame rate (30 Hz). As a result, the number of entries in discrete bout ethograms corresponds to the number of observed bouts, which varies between flies. However, the sum of bout durations for each ethogram is identical (27.8 minutes).</p>
<p>After ethogram generation, behavioral bouts persisting for less than 167 ms are deemed artifacts and deleted. This threshold is chosen because manual inspection of video data suggests that individual leg sweeps occur at approximately this time scale. This is also the approximate average transition time between behavioral states described by Berman et al. [<xref ref-type="bibr" rid="pcbi.1007105.ref010">10</xref>]. Deleted bouts account for 1.03% of total recording time. In subsequent analysis, we also neglect standing bouts, as they account for &lt; 1% of total recording time.</p>
</sec>
<sec id="sec004">
<title>Data binning</title>
<p>In order to include bout duration as a data dimension, we introduce a binning scheme. To implement this change, the continuous-valued entries in the second row of discrete bout ethograms are collapsed into duration category labels. Grooming bouts are classified into three categories (short, medium, and long) based on the duration of the associated bout. Although our results are consistent even when using more than three duration categories (<xref ref-type="supplementary-material" rid="pcbi.1007105.s002">S2 Fig</xref>), we limit analysis to three categories for the sake of simplicity.</p>
<p>Bin edges for these categories are determined independently for each grooming action (f, h, a, b, w) and walking (wk), as each action possesses a unique duration distribution. Bin edges are chosen such that each bin is populated by an equal number of samples (i.e. the total number of actions labeled “short” is equal to the number of “long” actions) and are depicted in <xref ref-type="fig" rid="pcbi.1007105.g003">Fig 3</xref>.</p>
<fig id="pcbi.1007105.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007105.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Binning grooming bouts by duration allows for analysis of temporal dependence.</title>
<p>Ethograms are modified by introducing a binning scheme based on grooming bout duration. Here, we show the binning strategy used to create three duration categories for grooming actions. Grooming actions are classified as short, medium, or long bouts, indicated by the red, green, and blue regions of the probability density functions, respectively. Region boundaries are chosen such that each duration category contains an equivalent number of samples. Notably, anterior motif actions (f, h) possess strikingly similar duration distributions, suggesting coupling between these actions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Markov chain analysis</title>
<p>Markov processes are a class of probabilistic models that describe transitions between states of a system in terms of previous states. The simplest version obeys the Markov property, which declares that the next transition between states depends only on the current state. As such, long-term history dependence can be neglected when considering Markov processes, greatly simplifying the models. In discrete time, the dynamics of a first order Markov chain are described by the equation
<disp-formula id="pcbi.1007105.e001"><alternatives><graphic id="pcbi.1007105.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007105.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi mathvariant="italic">t</mml:mi> <mml:mo mathvariant="italic">+</mml:mo> <mml:mn mathvariant="italic">1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi mathvariant="italic">t</mml:mi></mml:msub> <mml:mi mathvariant="bold">M</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <bold>x</bold><sub><italic>t</italic></sub> denotes the state probability vector at time <italic>t</italic>. The entries of <bold>x</bold><sub><italic>t</italic></sub> represent the probability of the system being in the state corresponding to that entry at time <italic>t</italic>. <bold>M</bold> is the matrix of state transition probabilities such that entry <bold>M</bold><sub><italic>ij</italic></sub> is the probability of transitioning from state <italic>i</italic> to state <italic>j</italic>. The vector <bold>x</bold><sub><italic>t</italic></sub> will have dimensionality corresponding to the number of possible states in the system. In this case, there are either six, twelve, or eighteen grooming states, depending on whether grooming bout duration is incorporated into the model. Given sufficient data about state transitions in a real system, it is possible to generate a maximum likelihood estimate (MLE) transition probability matrix, denoted by <inline-formula id="pcbi.1007105.e002"><alternatives><graphic id="pcbi.1007105.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007105.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mover accent="true"><mml:mi mathvariant="bold">M</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, which provides the best estimate of the transition probabilities governing the observed transitions. The entries of <inline-formula id="pcbi.1007105.e003"><alternatives><graphic id="pcbi.1007105.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007105.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mover accent="true"><mml:mi mathvariant="bold">M</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are given by
<disp-formula id="pcbi.1007105.e004"><alternatives><graphic id="pcbi.1007105.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007105.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">M</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>v</mml:mi></mml:msubsup> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>n</italic><sub><italic>ij</italic></sub> is the total number of observed transitions from state <italic>i</italic> to state <italic>j</italic>. The summation over <italic>n</italic><sub><italic>iu</italic></sub> is a normalization factor which counts the total number of transitions from state <italic>i</italic> to any other state, indexed by <italic>u</italic>, and <italic>v</italic> denotes the total number of possible states.</p>
<p>First order Markov chain maximum likelihood transition probabilities are determined for each ethogram as described in <xref ref-type="disp-formula" rid="pcbi.1007105.e004">Eq (2)</xref>. Probabilities are determined for ethograms with either one, two, or three bout duration bins. The resulting matrices represent population-wide average transition probabilities. We also calculated transition matrices for individual flies, examples of which are shown in <xref ref-type="supplementary-material" rid="pcbi.1007105.s003">S3 Fig</xref>.</p>
</sec>
<sec id="sec006">
<title>Null model hypothesis generation</title>
<p>Statistical null models, which randomize isolated features of data while maintaining overall statistical features, provide a basis for hypothesis testing to determine the significance of results obtained from experimental data. To assess the contributions of bout identity and bout duration to sequence structure, we generate null hypotheses which independently randomize these features of the ethogram data while preserving bout duration frequency distributions within grooming action types. Null hypothesis transition probabilities are analytically tractable in the limit of infinite permutations, so we use exact formulas to calculate matrix entries (<xref ref-type="supplementary-material" rid="pcbi.1007105.s008">S1 Table</xref>). A representative example of each permutation on grooming bout order and duration is shown schematically in <xref ref-type="fig" rid="pcbi.1007105.g004">Fig 4</xref>. Our null hypotheses are as follows:</p>
<list list-type="order">
<list-item>
<p>Duration permuted: This null hypothesis preserves action order information, but transition matrix entries are independent of duration.</p>
</list-item>
<list-item>
<p>Order permuted: This null hypothesis preserves action duration information, but transition matrix entries are independent of action order.</p>
</list-item>
</list>
<fig id="pcbi.1007105.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007105.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Statistical null model hypotheses (schematic).</title>
<p>By shuffling bout duration or bout order and comparing the resultant null hypothesis transition matrices to the maximum likelihood estimate, we identify which features are statistically significant in the data and contribute to sequence structure. Shown here are schematics of the permutations we perform on the observed ethograms to generate null hypothesis transition matrices. In the duration permuted hypothesis, bout order is preserved but duration categories are randomly permuted (h = head, wk = walking, f = front leg, s = short, m = medium, l = long). In the order permuted hypothesis, bout order is permuted but the durations associated with each bout remain the same.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.g004" xlink:type="simple"/>
</fig>
<p>The resulting model fit is determined using the Bayesian Information Criterion (BIC), defined as
<disp-formula id="pcbi.1007105.e005"><alternatives><graphic id="pcbi.1007105.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007105.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>BIC</mml:mtext> <mml:mo>=</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>L</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>n</italic> is the number of data points observed, <italic>k</italic> is the number of free model parameters, and log (<italic>L</italic>) is the maximized log-likelihood value. For first order Markov chains,
<disp-formula id="pcbi.1007105.e006"><alternatives><graphic id="pcbi.1007105.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007105.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>L</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi mathvariant="italic">t</mml:mi> <mml:mo mathvariant="italic">+</mml:mo> <mml:mn mathvariant="italic">1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi mathvariant="italic">t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
and
<disp-formula id="pcbi.1007105.e007"><alternatives><graphic id="pcbi.1007105.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007105.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi mathvariant="italic">t</mml:mi> <mml:mo mathvariant="italic">+</mml:mo> <mml:mn mathvariant="italic">1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi mathvariant="italic">t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">M</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>i</italic> is the row index for the behavior observed at time <italic>t</italic> and <italic>j</italic> is the column index for the behavior observed at time <italic>t+1</italic>.</p>
<p>The BIC provides a metric for evaluating model goodness-of-fit by penalizing models which use a large number of free parameters (the first term in <xref ref-type="disp-formula" rid="pcbi.1007105.e005">Eq 3</xref>) and rewarding models which accurately predict unobserved data (the second term in <xref ref-type="disp-formula" rid="pcbi.1007105.e005">Eq 3</xref>). Thus, models with low BIC values possess more explanatory power than models with higher BIC values but still avoid overfitting. BIC is similar to a related metric, Akaike’s Information Criterion (AIC), but penalizes models with more free parameters more severely than AIC in cases where the number of data points is much larger than the number of free parameters.</p>
</sec>
<sec id="sec007">
<title>Synthetic ethogram generation</title>
<p>To evaluate the ability of our models to generate sequences that are similar to our observed data, we use them to create synthetic ethograms. Synthetic sequences are generated using Monte Carlo methods within a Markov renewal process (MRP) framework. In an MRP, state transitions are governed in a manner identical to Markov chains (i.e. using a transition probability matrix). However, the amount of time spent in each state is determined in parallel by a renewal process, in which action durations are drawn from a known distribution. Here, we use the empirically observed duration distributions shown in <xref ref-type="fig" rid="pcbi.1007105.g003">Fig 3</xref>.</p>
</sec>
</sec>
<sec id="sec008" sec-type="results">
<title>Results</title>
<sec id="sec009">
<title><italic>Drosophila melanogaster</italic> grooming behavior progresses from anterior to posterior motifs on long time scales</title>
<p>After exposure to an irritant, <italic>D. melanogaster</italic> grooming begins with an initial phase of mostly front leg rubbing and head cleaning (f, h). We refer to these behaviors as anterior motif grooming actions. After roughly 13 minutes, flies reach an approximate steady state consisting of heightened amounts of abdomen cleaning, back leg rubbing, and wing cleaning (a, b, w). Together, these actions constitute the posterior motif. Flies also exhibit an increased proportion of walking (wk) during the late phase of grooming. Our result, visualized in <xref ref-type="fig" rid="pcbi.1007105.g005">Fig 5</xref> corroborates a similar finding reported by Seeds et al. [<xref ref-type="bibr" rid="pcbi.1007105.ref009">9</xref>] but utilizes a much larger, automatically annotated data set.</p>
<fig id="pcbi.1007105.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007105.g005</object-id>
<label>Fig 5</label>
<caption>
<title><italic>Drosophila melanogaster</italic> grooming progresses from anterior motif to posterior motif actions.</title>
<p>A: Average grooming progression of <italic>D. melanogaster</italic> population (N = 92) after exposure to an irritant. Colored lines show the percentage of time spent in each action (f = front leg, h = head, a = abdomen, b = back leg, w = wing, wk = walking) across a 16.7 second sliding window (500 frames). Front leg rubbing and head cleaning proportions track closely with one another for the entire course of grooming. Additionally, back leg rubbing tracks closely with the sum of abdomen and wing cleaning. Dashed gray vertical line indicates the boundary between early and late grooming phases, which occurs after approximately thirteen minutes, or nearly half of the recording duration. B: Proportion of time spent in each action during the early phase (left) and late phase (right) of grooming. During the early phase, <italic>D. melanogaster</italic> spend the majority of time performing anterior grooming movements. In the late phase, they spend a relatively larger proportion of time engaged in posterior grooming movements and walking.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Grooming bouts possess characteristic duration structure</title>
<p>We find that grooming bouts possess action-specific duration distributions. <xref ref-type="fig" rid="pcbi.1007105.g003">Fig 3</xref> depicts this result. We find that anterior motif grooming actions possess remarkably similarly shaped action duration profiles, with peaks in their probability functions near 1 s. In contrast, posterior motif actions tend to be shorter. Most notably, abdomen and wing cleaning exhibit sharp distribution with peaks near 250 ms, whereas back leg rubbing exhibits a smoother distribution which more closely resembles those of anterior motif actions.</p>
<p>Interestingly, bouts durations are not normally distributed, suggesting a mechanism other than random generation of durations around a mean value. Instead, anterior motif duration distributions possess “shoulders” on each side of the central peak, suggesting that dividing actions into bout duration categories is not an unnatural distinction. Moreover, these “shoulders” are relatively broad due to the fact that grooming bouts consist of many quanta of individual leg sweeps (in the case of body-directed actions) or rubs (in the case of leg-directed actions), which are cyclical in nature and last approximately 150 ms per cycle. Due to video frame rate resolution limitations, we do not consider this extremely fast behavioral scale here. In this analysis, we highlight results which divide grooming actions into three duration categories in order to provide an intuitive demarcation between “short”, “medium”, and “long” actions. However, it is important to note that our conclusions are not strictly dependent on this choice of categorization scheme, as our results hold for higher numbers of duration categories as well <xref ref-type="supplementary-material" rid="pcbi.1007105.s002">S2 Fig</xref>.</p>
</sec>
<sec id="sec011">
<title>Intra-motif grooming actions are tightly coupled</title>
<p>We find that the vast majority of transitions occur within grooming motifs. Approximately 88% of transitions from anterior motif grooming bouts are to another anterior motif behavior, while about 70% of transitions from posterior motif bouts are to another posterior motif behavior. This tight intra-motif coupling is illustrated in <xref ref-type="fig" rid="pcbi.1007105.g005">Fig 5</xref>, as the amount of front leg rubbing tracks the amount of head cleaning extremely closely. The amount of back leg rubbing also tracks the sum of abdomen and wing cleaning very closely. This result is not affected by the choice of sliding window, as we observe a similarly strong correlation even when using a 1.67 s (50 frame) window instead of the 16.7 s (500 frame) window used to illustrate the progression shown in <xref ref-type="fig" rid="pcbi.1007105.g005">Fig 5</xref>.</p>
<p>We find that this strong coupling emerges from the structure of individual grooming motifs. <xref ref-type="fig" rid="pcbi.1007105.g006">Fig 6</xref> provides an illustrated example of the structure of an anterior motif. We find that, across flies and independent of the time after grooming, anterior motifs contain nearly perfectly correlated amounts of body and leg-directed grooming. This strong correlation is somewhat surprising given that consecutive anterior grooming bouts exhibit a non-linear relationship (<xref ref-type="supplementary-material" rid="pcbi.1007105.s004">S4 Fig</xref>).</p>
<fig id="pcbi.1007105.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007105.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Anterior motifs are composed of highly correlated amounts of body-directed and leg-directed actions.</title>
<p>A: Schematic of an anterior motif. Anterior motifs are defined as continuous consecutive bouts of head grooming (h) or front leg rubbing (f) flanked by non-anterior motif actions on either side. Posterior motifs are defined similarly, but consist of abdomen grooming, back leg rubbing, and wing grooming (a, b, and w). Both motifs contain body-directed actions (h, a, and w), which clear irritant from the body. Leg-directed actions (f and b) clear irritant from the legs, which collect irritant during body-directed grooming actions. In this example, the anterior motif consists of six grooming bouts of varying duration. B: Anterior motifs exhibit a strong linear relationship between the total amount of time spent performing body and leg-directed actions (left). Each point corresponds to an observed motif consisting of four or more actions. Posterior motifs (right) display a weaker linear trend with greater amounts of leg-directed grooming.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.g006" xlink:type="simple"/>
</fig>
<p>This tight intra-motif coupling is also reflected in the structure of Markov transition matrices fit to our behavioral data (ethograms). We fit a first order discrete time Markov chain to our data and the resulting matrix, denoted by <inline-formula id="pcbi.1007105.e008"><alternatives><graphic id="pcbi.1007105.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007105.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mover accent="true"><mml:mi mathvariant="bold">M</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1007105.e004">Eq 2</xref>), contains the maximum likelihood estimates of the probabilities of transitioning from one grooming action to another. <xref ref-type="fig" rid="pcbi.1007105.g007">Fig 7</xref> depicts the structure of these transitions in both network and matrix form, illustrating the transition probabilities used to define the Markov chain in <xref ref-type="disp-formula" rid="pcbi.1007105.e001">Eq (1)</xref>. In <xref ref-type="fig" rid="pcbi.1007105.g007">Fig 7</xref>, anterior and posterior motif grooming actions are indicated by light red and blue outlines, respectively. Note that self-transitions are explicitly prohibited as a result of the ethogram discretization method. Consequently, the network diagram lacks self-loops and all diagonal elements in transition matrices are blacked out, signifying zero value entries.</p>
<fig id="pcbi.1007105.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007105.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Within-motif transitions dominate grooming syntax.</title>
<p>A: The maximum likelihood transition matrix, <inline-formula id="pcbi.1007105.e009"><alternatives><graphic id="pcbi.1007105.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007105.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mover accent="true"><mml:mi mathvariant="bold">M</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1007105.e004">Eq 2</xref>), provides the best estimate of the Markov chain dynamics observed in grooming behavior (<xref ref-type="disp-formula" rid="pcbi.1007105.e001">Eq 1</xref>). The network representation of <inline-formula id="pcbi.1007105.e010"><alternatives><graphic id="pcbi.1007105.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007105.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mover accent="true"><mml:mi mathvariant="bold">M</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (left) illustrates transition probabilities using edge thickness (thicker edges indicate higher probabilities). Shown on the right is the matrix representation of discrete time transition probabilities (fit to the discrete time ethogram from <xref ref-type="fig" rid="pcbi.1007105.g001">Fig 1</xref> with no duration information), with probability magnitude indicated by color. Here, the anterior motif, consisting of front leg rubbing and head cleaning, is indicated by the red circle (left) and red square (right). The posterior motif, consisting of abdominal grooming, back leg rubbing, and wing cleaning, is delineated by the blue circle (left) and blue square (right). B: Maximum likelihood transition probabilities for ethograms binned according to the schema shown in <xref ref-type="fig" rid="pcbi.1007105.g003">Fig 3</xref>. Matrices fit to data with two (left) and three (right) duration categories show similar within-motif structure with increased resolution (s = short, m = medium, l = long). For example, both matrices illustrate that anterior motif transitions between long bouts dominate syntax.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Grooming bout duration contributes to sequence structure at short time scales</title>
<p>In <xref ref-type="fig" rid="pcbi.1007105.g007">Fig 7</xref>, we illustrate the fine-grain temporal structure present within the identified motifs. Transition matrices with either two (left) or three (right) duration bins reveal the presence of certain high-probability transitions. Most notably, we observe that transitions between long anterior grooming actions dominate to an extent not found in the null hypotheses we use for comparison. For example, when using three duration categories, the probability of transitioning from a long front leg rub to a long head cleaning bout is ∼39%. This is significantly higher than the corresponding transition probabilities in the duration permuted and order permuted null hypotheses, which are ∼28% and ∼13% respectively. These differences are depicted in greater detail in <xref ref-type="fig" rid="pcbi.1007105.g008">Fig 8</xref>.</p>
<fig id="pcbi.1007105.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007105.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Grooming bout duration contributes to syntax at the scale of individual transitions.</title>
<p>A: Probabilities from the maximum likelihood transition matrix (top) differ significantly from null hypothesis transition matrices (bottom) to varying degrees, indicating that both grooming action order and bout duration contribute to grooming syntax. Shown on the top left is the network visualization of anterior motif transitions, with edge withs proportional to transition probabilities. Notice that transitions between actions belonging to the same duration category possess relatively high probabilities and appear nearly symmetric, suggesting a coupling mechanism between anterior motif actions. BIC values (right of matrices) provide validation that the maximum likelihood model captures statistically significant features of the data. The maximum likelihood transition matrix has a lower BIC value than the null hypotheses used for comparison, indicating that both bout order and duration contribute to sequence syntax. B: The residual values, or the difference between the maximum likelihood matrix and the null model matrices, illustrate that specific transitions differ from what the null hypotheses would predict. The duration permuted null model matrix exhibits block structure but fails to capture the temporal relationship between bouts, as illustrated by the red values in several “long-to-long” transitions, for example. The order permuted null model differs even more severely, indicating that, while duration dependence plays a role in sequence structure, action order is still the primary determinant.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.g008" xlink:type="simple"/>
</fig>
<p>Additionally, we observe that, regardless of the number of duration bins, the anterior motif transition probability structure is nearly mirror symmetrical along the diagonal (i.e. transitions between front leg rubbing and head cleaning bouts have the same probabilities). In contrast, posterior motif transitions are less strongly symmetrical, with transitions between abdomen cleaning and back leg rubbing exhibiting the highest probabilities (<xref ref-type="fig" rid="pcbi.1007105.g007">Fig 7</xref>).</p>
<p>We find that the probabilistic rules describing transitions between consecutive bouts depend on two features of immediate behavioral history: previous bout identity and previous bout duration. To validate this observation, we evaluate the quality of the maximum likelihood model using the Bayesian Information Criterion (BIC). This metric, which is described mathematically by <xref ref-type="disp-formula" rid="pcbi.1007105.e005">Eq 3</xref>, rewards models that produce accurate predictions and penalizes those that contain more parameters. The model with the lowest BIC score is considered the best fit to the observed data. Using BIC, we show that, compared to statistical null model hypotheses, the maximum likelihood transition probability best describes the data without overfitting. BIC values and null hypothesis matrices used for comparison are shown in <xref ref-type="fig" rid="pcbi.1007105.g008">Fig 8</xref>. Since each null hypothesis matrix contains fewer free parameters than the maximum likelihood model, the advantage of the maximum likelihood matrix in BIC is due entirely to its superior explanatory power.</p>
<p>Inspection of BIC values indicates that bout order is the strongest individual determinant of grooming syntax and that bout duration provides an additional contribution. <xref ref-type="fig" rid="pcbi.1007105.g008">Fig 8</xref> shows the BIC values for each matrix as determined using data binned into three duration categories. The order permuted null hypothesis possesses a significantly larger BIC value than the duration permuted null hypothesis, indicating that disrupting bout order degrades predictive power most significantly.</p>
<p>By construction, each null hypothesis transition matrix contains identical row structure within sets of rows corresponding to the same grooming action. However, only the duration permuted transition matrix possesses block structure similar to that found in the maximum likelihood matrix, as seen in <xref ref-type="fig" rid="pcbi.1007105.g008">Fig 8</xref>. This feature also reinforces the claim that action order provides a relatively larger contribution to syntax, since preserving action order results in the preservation of transition matrix block structure.</p>
</sec>
<sec id="sec013">
<title>Bout-to-bout transitions are largely stationary despite changing sensory conditions</title>
<p><xref ref-type="fig" rid="pcbi.1007105.g009">Fig 9</xref> shows the average transition probability matrices with three duration categories for the early and late phases of grooming, as separated by the dashed line in <xref ref-type="fig" rid="pcbi.1007105.g005">Fig 5</xref>. Data were separated into early and late phase data for each fly and maximum likelihood transition probabilities were determined as described in Methods and Models. Here, we determine the boundary between phases to be the average time elapsed after flies have performed half of their discrete grooming actions. We also conducted a similar analysis in which we fit transition matrices only to the first and last third of data so as to avoid using the middle portion of the progression. This did not alter our results (<xref ref-type="supplementary-material" rid="pcbi.1007105.s005">S5 Fig</xref>).</p>
<fig id="pcbi.1007105.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007105.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Transition probabilities are largely stationary across the entire grooming progression despite changing sensory conditions.</title>
<p>Shown here are the population average transition probabilities for the early phase (left) and late phase (right) of grooming. The border between these phases is indicated by the dashed gray line in <xref ref-type="fig" rid="pcbi.1007105.g005">Fig 5</xref>. In the early phase, flies prioritize anterior grooming motifs, indicated by the thick red outline. In the late phase, flies perform more posterior grooming, indicated by the thick blue outline. We observe that transitions between front leg rubbing and head cleaning bouts exhibit consistent duration dependence regardless of when they occur in the sequence. Posterior motif transitions display similarities as well, but transitions between long abdomen grooming bouts and long back leg rubbing bouts are significantly more likely late in grooming. Overall, the relative stationarity of these transition probabilities despite changing sensory conditions suggests the existence of an internal mechanism that dictates bout durations. However, sensory stimuli also appear to play a role in modulating grooming transitions on long time scales, as transitions from posterior motif actions to anterior motif actions become less likely in the late phase.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.g009" xlink:type="simple"/>
</fig>
<p>Qualitatively, these matrices exhibit strong similarities, despite the differences in grooming proportions, as shown in <xref ref-type="fig" rid="pcbi.1007105.g005">Fig 5</xref>. In particular, transitions between anterior motif grooming movements are similar across phases of the recording. Additionally, we find that 253 of the 266 (95.1%) non-zero entries change by less than 5% and 168 (63.2%) entries change by less than 1% (<xref ref-type="supplementary-material" rid="pcbi.1007105.s006">S6 Fig</xref>). This suggests that the rules for sequence generation are nearly fixed, in spite of changing sensory input. Most notably, transitions between long abdomen grooming bouts and long back leg rubbing bouts are enriched in the late phase of grooming, illustrating that grooming rules, while similar, are not completely stationary over time.</p>
</sec>
<sec id="sec014">
<title>A slowly varying model captures grooming syntax at long, intermediate, and short time scales</title>
<p>Markov models are steady state models and, as such, only exhibit equilibrium dynamics when used in a generative manner to create synthetic data. The first order maximum likelihood Markov model presented above is best suited for describing the late stages of grooming, which resembles steady state behavior. This is an obvious shortcoming of using a Markovian framework for analyzing the ethograms presented here, as flies display a dynamic progression (<xref ref-type="fig" rid="pcbi.1007105.g005">Fig 5</xref>), likely due to changing amounts of irritant over the course of grooming.</p>
<p>In order to more explicitly model these changing sensory dynamics, we utilize a nonstationary, or time-varying, Markov renewal process (MRP). Here, we introduce a nonstationarity in the form of a time-varying transition probability matrix. In order to maintain as parsimonious a model as possible, we define the transition probability matrix as a time-dependent convex combination of an early phase matrix and a late phase matrix (<xref ref-type="disp-formula" rid="pcbi.1007105.e011">Eq 6</xref>). The early phase matrix is determined using maximum likelihood fitting on only the first 200 actions of each fly. Likewise, the late matrix uses each fly’s final 200 actions. This ensures that early and late phases are well-separated, as each ethogram averages approximately 1000 bouts.</p>
<p>The time-varying transition probability matrix <bold>M</bold>(<italic>t</italic>) used in the MRP is defined as
<disp-formula id="pcbi.1007105.e011"><alternatives><graphic id="pcbi.1007105.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007105.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>13</mml:mn> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mn>13</mml:mn></mml:mfrac> <mml:msub><mml:mi mathvariant="bold">M</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>t</mml:mi> <mml:mn>13</mml:mn></mml:mfrac> <mml:msub><mml:mi mathvariant="bold">M</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mo>=</mml:mo> <mml:mn>13</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold">M</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mn>13</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>t</italic> is in minutes. After 13 minutes, the late phase transition matrix is used due to the observation that flies exhibit steady state behavior after approximately that amount of time. Bout duration distributions used in the MRP do not change over time, as we did not find any significant difference between early and late bout durations (<xref ref-type="supplementary-material" rid="pcbi.1007105.s007">S7 Fig</xref>).</p>
<p>Surprisingly, using this simple linear interpolation as a proxy for changing sensory conditions yields a model which produces ethograms that closely resemble our observed data (<xref ref-type="fig" rid="pcbi.1007105.g010">Fig 10</xref>). This interpolation serves as a first-order approximation to changing sensory drive, as flies constantly remove dust at an unknown rate over the course of grooming. Synthetic flies prioritize anterior grooming early on and gradually transition into a late phase which prioritizes posterior grooming and walking. This synthetic progression closely matches the actual progression shown in <xref ref-type="fig" rid="pcbi.1007105.g005">Fig 5</xref>. The synthetic ethograms also exhibit a tight coupling between the amount of anterior grooming actions over time. Moreover, synthetic motifs possess similar structure to observed motifs, as shown in panel C of <xref ref-type="fig" rid="pcbi.1007105.g010">Fig 10</xref>. Finally, the use of empirical transition matrices and bout duration distributions in our MRP guarantees that synthetic ethograms possess the same duration dependence at short time scales as actual data.</p>
<fig id="pcbi.1007105.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007105.g010</object-id>
<label>Fig 10</label>
<caption>
<title>A nonstationary Markov renewal process recapitulates grooming progression and bout structure.</title>
<p>A: Illustration of the time-varying transition matrix, <bold>M</bold>(<italic>t</italic>), used for generating synthetic ethograms. To approximate changing sensory conditions in the simplest possible manner, two transition matrices, <bold>M</bold><sub><italic>early</italic></sub> and <bold>M</bold><sub><italic>late</italic></sub>, are fit to the first and last 200 actions in the discrete time ethogram with 3 duration categories, respectively. As time evolves in the synthetic ethogram simulation, <bold>M</bold>(<italic>t</italic>) changes as described in <xref ref-type="disp-formula" rid="pcbi.1007105.e011">Eq 6</xref>. At the beginning of the simulation, <bold>M</bold>(<italic>t</italic>) is identical to <bold>M</bold><sub><italic>early</italic></sub> and after 13 minutes, it is identical to <bold>M</bold><sub><italic>late</italic></sub>. Between those times, it is a linear combination of the two matrices. B: Synthetic ethograms display the characteristic progression from anterior to posterior grooming, as seen from comparison with <xref ref-type="fig" rid="pcbi.1007105.g005">Fig 5</xref>. C: Synthetic ethograms reproduce observed anterior motif composition. Synthetic anterior motifs (left) exhibit a similar, though slightly weaker, trend as observed in our data (<xref ref-type="fig" rid="pcbi.1007105.g006">Fig 6</xref>). Posterior motifs are less similar, indicating that other factors may be necessary to explain posterior motif structure.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.g010" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec015" sec-type="conclusions">
<title>Discussion</title>
<sec id="sec016">
<title><italic>Drosophila melanogaster</italic> respond to irritant by executing structured, modular sequences of cleaning movements</title>
<p>After exposure to an irritant, <italic>D. melanogaster</italic> engage in a series of grooming actions in order to clear the irritant from their body. These movements are highly non-random, as indicated by their structure at three separate temporal scales. On the longest time scale, grooming progresses over several minutes from an early anterior-heavy phase to a later phase which contains elevated levels of posterior-directed actions and walking as illustrated in <xref ref-type="fig" rid="pcbi.1007105.g005">Fig 5</xref>. At an intermediate time scale, anterior and posterior grooming motifs exhibit strong correlations between the amount of body and leg-directed movements present in each motif, as shown in <xref ref-type="fig" rid="pcbi.1007105.g006">Fig 6</xref>. Finally, grooming syntax exhibits non-random structure at the short time scale of individual grooming bout decisions, as illustrated by the non-random structure of transition matrices shown in <xref ref-type="fig" rid="pcbi.1007105.g007">Fig 7</xref>. Together, these findings suggest that there are distinct syntactic rules that govern grooming sequence structure at different temporal scales.</p>
<p>Here, we isolate short time scale grooming syntax by using a binning scheme to represent grooming bouts as semi-discrete actions (e.g. short, medium, or long bouts). Across different binning schemes, within-motif transitions (i.e. anterior-to-anterior or posterior-to-posterior) dominate syntax at the scale of consecutive bouts, as indicated by the block-like structure of transition matrices in <xref ref-type="fig" rid="pcbi.1007105.g007">Fig 7</xref>. The likely functional explanation for this tight correlation is that <italic>D. melanogaster</italic> engage in leg-centric grooming as a way to clear irritant that has collected on their limbs after body-centric grooming. Past work on blowflies also suggests that this coupling may be due to postural considerations, since fewer motor actions are required to transition between movements which use the same set of legs [<xref ref-type="bibr" rid="pcbi.1007105.ref006">6</xref>].</p>
<p>Moreover, the amount of front leg rubbing over the course of the grooming progression corresponds nearly exactly to the amount of head cleaning performed by the flies. The amount of back leg rubbing is also directly proportional to the amount of abdomen and wing cleaning (<xref ref-type="fig" rid="pcbi.1007105.g005">Fig 5</xref>). Though the total amount of time spent performing actions within motifs is tightly coupled, consecutive bout durations do not exhibit a simple linear relationship (<xref ref-type="supplementary-material" rid="pcbi.1007105.s004">S4 Fig</xref>). Instead, transitions between body-centric and leg-centric actions of certain durations dominate. In particular, anterior motif movements exhibit nearly symmetric dynamics, with a preference for long-to-long transitions. In contrast, posterior motif transitions are asymmetric—this can be seen in <xref ref-type="fig" rid="pcbi.1007105.g007">Fig 7</xref>, as transitions from body-directed actions to leg-directed actions have different values than transitions in the opposite direction. This suggests a mechanism whereby internally generated dynamics that are specific to each motif guide intra-motif transitions.</p>
</sec>
<sec id="sec017">
<title>Symmetric anterior motif transition rules suggest higher-level transition frequency control</title>
<p>Anterior motif transitions display symmetric transition rules, as shown in <xref ref-type="fig" rid="pcbi.1007105.g007">Fig 7</xref>. The transition from head cleaning to leg rubbing may exhibit a strong correlation in duration for the following reason—the longer the head cleaning bout, the more particulate the legs accumulate, which subsequently requires more time to clear. However, it is more surprising that after performing a bout of leg rubbing the animal should display a similar duration preference upon transitioning back to head cleaning; once the front legs are sufficiently clean, we would not expect the animal to exhibit any duration preference on the subsequent bout. Additionally, the bout duration distributions for grooming actions remain strikingly similar across the entire recording, suggesting that sensory considerations do not account for the duration dependence we observe (<xref ref-type="supplementary-material" rid="pcbi.1007105.s007">S7 Fig</xref>).</p>
<p>These observations support the hypothesis that alternations between anterior grooming bouts are regulated by a common source or common dynamics that dictate intra-motif transition frequency. If this is the case, future investigation of neural circuitry could focus on identifying neural activity that oscillates in phase with grooming bout alternations. Under this model, flies would then need to combine discrete decisions about which motif to perform with continuous decisions about how long to maintain a motif. This provides other targets for future experiments, as we could look for neural activity corresponding to transitions between motifs, explore manipulations that induce transitions between motifs, and search for factors that affect the duration of motifs.</p>
</sec>
<sec id="sec018">
<title>Modeling suggests that sensory input modifies internal grooming programs</title>
<p>Although sensory input is sufficient to initiate individual grooming bouts, it has been difficult to assess the role of sensory input in grooming on longer time scales, since direct quantification of irritant relies on invasive protocols [<xref ref-type="bibr" rid="pcbi.1007105.ref025">25</xref>]. To date, the contribution of internal dynamics to grooming sequence generation also remains unknown. The discovery of duration dependence in grooming suggests that flies do not rely exclusively on sensory information to make grooming decisions, leaving open the possibility that sensory input modifies pre-existing autonomous grooming programs.</p>
<p>Here, we abstract the contribution of sensory input, incorporating it as a parameter in a time-varying Markov renewal process. Specifically, we approximate changing sensory conditions as a linear phenomenon which dictates the degree to which flies favor early versus late grooming rules (<xref ref-type="fig" rid="pcbi.1007105.g010">Fig 10</xref>). This choice of nonstationarity preserves the parsimony of our MRP, as it precludes the necessity of re-calculating transition probabilities over time. Additionally, the similarity between early and late intra-motif transition probabilities (<xref ref-type="fig" rid="pcbi.1007105.g009">Fig 9</xref>) provides some leeway for the choice of nonstationarity, bolstering our confidence that a simple linear rule is sufficient to approximate true sensory conditions.</p>
<p>Since our MRP reliably reproduces true ethogram statistics without explicitly modeling sensory input, we propose that, rather than acting in a purely reflexive manner, <italic>D. melanogaster</italic> instead use sensory information to modulate internal grooming programs. This type of slowly varying process has been observed in other organisms, suggesting that it is a useful framework for describing sequential behaviors [<xref ref-type="bibr" rid="pcbi.1007105.ref026">26</xref>]. Additionally, this hypothesis can be tested in future experiments which manipulate sensory conditions using irritants with different properties or optogenetic stimulation of sensory receptors.</p>
</sec>
<sec id="sec019">
<title>A role for sensory information-independent transition rules in grooming</title>
<p>From a computational perspective, sensing is costly when it requires high-frequency updates and can provide readouts at a high resolution, as specialized neural circuits must be formed, maintained, and integrated in order to provide accurate, real-time readouts. This can lead to increased metabolic costs on several fronts, as increased neural activity and behaviors intended to protect and maintain sensory machinery can also require energetic resources [<xref ref-type="bibr" rid="pcbi.1007105.ref027">27</xref>]. In contrast, autonomous internal dynamics require only sparse sensory updates and may not require the same level of neural activity as is needed for sensory processing. If sensory drive alone, triggered by the presence of an irritant, dictates sequence generation in a purely reflexive manner, competing priorities may lead to rapid alternations between actions without any distinctive duration structure, consistent with neural circuity implementing competitive inhibition with a transition cost [<xref ref-type="bibr" rid="pcbi.1007105.ref009">9</xref>].</p>
<p>During the execution of a grooming motif, frequent, high-resolution sensory updates may not be necessary. Instead, the moment-to-moment decisions about execution of grooming bouts can be automated by utilizing patterned internal dynamics. Several models of behavioral generation in which internal triggers drive sequence generation have been proposed [<xref ref-type="bibr" rid="pcbi.1007105.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1007105.ref029">29</xref>]. Since we show that intra-motif transitions exhibit bout duration-dependent structure, we suspect that internal triggers may provide a basis for transitions on short time scales after a discrete grooming motif decision is made. We consider this a strong possibility due to the fact that anterior motif transition probabilities are nearly stationary across grooming even though the dust distribution on the body is constantly changing. The near stationarity of these rules in spite of a changing stimulus suggests to us that behavior possesses an internally generated, fixed component. The discovery that grooming progresses gradually from anterior to posterior movements suggests that, on long time scales, <italic>D. melanogaster</italic> utilize sensory information to dictate decisions about which grooming motif to perform, since the dust distribution changes over the period of cleaning.</p>
<p>In discussing temporal correlations between neural activity across spatial scales, Berman et al. [<xref ref-type="bibr" rid="pcbi.1007105.ref010">10</xref>] note that “(a)lthough no such correlation has been specifically found in <italic>Drosophila</italic>, our results suggest that such neuronal patterns may exist: perhaps by combining descending commands from the brain with local circuitry within and emerging from the ventral nerve cord.” This observation is consistent with our interpretation of our results, as local circuitry in the ventral nerve cord could plausibly generate internal dynamics which introduce duration dependence to action selection.</p>
<p>By combining sensory input and internal dynamics, <italic>Drosophila melanogaster</italic> nervous systems may utilize multi-level control algorithms which make discrete, “ballistic” decisions about the onset and type of continuous behaviors, allowing them to update infrequently at low sensory resolution. Once the decision is made, the execution of the behavior can be guided primarily by autonomous internal dynamics. In flies, these internal dynamics may not be unique to grooming, as freely-behaving <italic>D. melanogaster</italic> exhibit hierarchical Markov-like behavior in the absence of external sensory stimuli [<xref ref-type="bibr" rid="pcbi.1007105.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007105.ref018">18</xref>]. Additionally, the identification of stereotyped subroutines in <italic>D. melanogaster</italic> locomotion further supports the idea that specialized neural circuits can automate and reproduce portions of behavior, reducing the need for constant calibration via sensory feedback [<xref ref-type="bibr" rid="pcbi.1007105.ref019">19</xref>]. We can further explore this idea by studying whether spontaneously grooming flies or those stimulated using optogenetic methods exhibit similar syntactic rules.</p>
<p>In larval and mature <italic>D. melanogaster</italic>, specialized, isolated neural circuits known as central pattern generators (CPGs), use rhythmic activity to guide execution of locomotion and courtship song sequences [<xref ref-type="bibr" rid="pcbi.1007105.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1007105.ref031">31</xref>]. In humans, CPGs are believed to facilitate chewing and breathing subroutines, such as individual jaw or pharyngeal movements [<xref ref-type="bibr" rid="pcbi.1007105.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1007105.ref033">33</xref>], indicating that such neural circuit elements are common and flexible enough to carry out a wide variety of functions.</p>
<p>Since CPGs can modulate motor programs independently of sensory input, they are a natural candidate to execute grooming behavior on the scale of individual leg sweeps and rubs within a grooming bout. We do not explicitly model behavior at this temporal scale, but the ABRS classifier applied to video at the frame rate used here identifies actions nearly at the temporal resolution of individual leg movements. We plan to extend analysis to this time scale in future work.</p>
<p>Additionally, robotic systems that utilize multi-layer CPG architectures can carry out locomotor tasks, indicating that hierarchical CPG structures can generate sequential behaviors from smaller elements [<xref ref-type="bibr" rid="pcbi.1007105.ref034">34</xref>]. Recent work indicates that circadian rhythms and genetic factors contribute to <italic>D. melanogaster</italic> grooming behavior as well, leaving open a role for internal regulation of sequence generation at longer time scales [<xref ref-type="bibr" rid="pcbi.1007105.ref035">35</xref>].</p>
</sec>
<sec id="sec020">
<title>Conclusion</title>
<p>When describing complex behavioral phenomena, formal mathematical models can bridge the gap between phenomenology and biological mechanisms by providing parameters that may correspond to underlying neuronal activity. In many cases, statistical model parameters do not directly describe to underlying biological structures, but data analysis can suggest hypotheses for future exploration.</p>
<p>Here, we analyze large-scale automatically annotated data sets to reveal the syntax of <italic>D. melanogaster</italic> grooming. Using Markov models to detect features of grooming sequences, we find that grooming actions exhibit duration dependence at the scale of individual bouts and grooming motifs. Then, we produce realistic synthetic ethograms by introducing a slow modulation of grooming rules meant to abstract the contribution of sensory input. Together, these findings suggest that internal programs dictate grooming decision on fast time scales but are modulated by sensory input over longer time scales.</p>
<p>As the tools for computational analysis of behavioral data continue to develop, interdisciplinary approaches that use mathematical tools to illuminate biological mechanisms will yield further insight into the generation of sequential behavior. Future experiments involving the manipulation of sensory experiences using optogenetic stimulation or other methods will also allow researchers to test hypotheses with unprecedented precision and scope. Together, these advances promise to improve our understanding of sequence generation by connecting mathematical descriptions of behavior with the underlying neural circuitry, as we are now motivated to search for circuits controlling long, intermediate, and short time scale grooming rules and determine how they interact with sensory circuits. Finally, our work suggests that temporal dynamics can and should be included when using statistical models to assess complex behaviors.</p>
</sec>
</sec>
<sec id="sec021">
<title>Supporting information</title>
<supplementary-material id="pcbi.1007105.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Machine classifier performance is similar to human classification accuracy.</title>
<p>A: Here, grooming behaviors are visualized in low-dimensional space using t-SNE, which preserves local distances between nearby points. Color indicates behavior type. Behaviors are well-separable by type. B: Example classifications of ethograms of grooming behaviors are shown. Human-algorithm agreement is about 75% (in terms of number of matching frames).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007105.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Transition probability matrices exhibit duration-dependent structure across many choices of binning schemes.</title>
<p>When transition probabilities are calculated from ethograms with 4 (left) or 5 (right) duration categories, fine-grain temporal structure is still present (compare the matrices shown here to those shown in <xref ref-type="fig" rid="pcbi.1007105.g007">Fig 7</xref>). The existence of this trend across binning schemes ensures that duration dependence is a phenomenon present in the data and not an artifact of data processing.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007105.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Individual flies possess stable syntax that resembles the group average.</title>
<p>Two examples of individual fly transition probabilities illustrate that, although syntax varies between individuals and over time, individuals are relatively stable and resemble the group average (compare to <xref ref-type="fig" rid="pcbi.1007105.g009">Fig 9</xref>). Though we did not fully characterize individual differences here, future studies will aim to examine individuals more closely.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007105.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Consecutive anterior bout durations do not exhibit a linear relationship.</title>
<p>Plotted here is the relationship between consecutive anterior grooming action durations. Linear regression produces a poor fit, indicating that duration dependence is not linear.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007105.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Sampling early and late phases differently does not alter the observed syntax.</title>
<p>To ensure that our choice of boundary between early and late phases does not alter our results, we partition our data in a stricter manner so that the transition period which occurs during the middle of the grooming progression is excluded. Partitioning the data into thirds produces transition matrices with structure and stationarity similar to those shown in <xref ref-type="fig" rid="pcbi.1007105.g008">Fig 8</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007105.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Small residuals between early and late transition probabilities indicate that most grooming rules are stationary over time.</title>
<p>We find that 253 of the 266 (95.1%) non-zero entries change by less than 5% and 168 (63.2%) entries change by less than 1%. This was a very surprising finding and suggests that, although some non-stationarity does exist, it is much smaller than we had expected given that the average time spent performing different behaviors varies between the early and late phases.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007105.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Bout durations do not change between early and late phases.</title>
<p>Probability density plots of bout duration distributions illustrate that bout durations remain consistent between early and late phases of grooming. Early phase data is plotted with a thick line. Late phase data is plotted with a thin line.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007105.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007105.s008" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Analytic formulas for null model transition matrices.</title>
<p>Given in S1 Table are the analytic formulas for transition matrix entries, <bold>M</bold><sub><italic>ij</italic></sub>, for each null hypothesis transition matrix. Here, <italic>i</italic> denotes the row and <italic>j</italic> denotes the column of <bold>M</bold>. Note that, in the three duration category case, each state has both an action and duration identifier (e.g. row h.s. corresponds to a head cleaning action in the short duration category). <italic>P</italic>(<italic>x</italic><sub><italic>action</italic>,<italic>j</italic></sub>|<italic>x</italic><sub><italic>action</italic>,<italic>i</italic></sub>) is the absolute probability of transitioning from the grooming action represented by row <italic>i</italic> to the action represented by row <italic>j</italic>, regardless of duration (this is given by the discrete time transition probability matrix in <xref ref-type="fig" rid="pcbi.1007105.g007">Fig 7A</xref>). <italic>P</italic>(<italic>x</italic><sub><italic>duration</italic>,<italic>j</italic></sub>) is the absolute probability of the grooming action represented by row <italic>j</italic> belonging to the duration category represented by row <italic>j</italic>. <italic>P</italic>(<italic>x</italic><sub><italic>j</italic></sub>) is the absolute probability of state <italic>j</italic>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Thanks to Tianyi Qin for drawings of individual grooming actions. Behavioral data collection assisted by Phuong Chung.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1007105.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hoyer</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Spitzweck</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tenedini</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gruschka</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Burchardt</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Szpotowicz</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Schweizer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Guntur</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Soba</surname> <given-names>P</given-names></name>. <article-title>Sensory integration and neuromodulatory feedback facilitate Drosophila mechanonociceptive behavior</article-title>. <source>Nat. Neurosci</source>. <year>2017</year>;<volume>20</volume>(<issue>8</issue>): <fpage>1085</fpage>–<lpage>1095</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4580" xlink:type="simple">10.1038/nn.4580</ext-link></comment> <object-id pub-id-type="pmid">28604684</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Selverston</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Elson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rabinovich</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Huerta</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Abarbanel</surname> <given-names>H</given-names></name>. <article-title>Basic Principles for Generating Motor Output in the Stomatogastric Ganglion</article-title>. <source>Ann. NY Acad. Sci</source>. <year>1998</year>;<volume>16</volume>(<issue>860</issue>): <fpage>35</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1749-6632.1998.tb09037.x" xlink:type="simple">10.1111/j.1749-6632.1998.tb09037.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marder</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bucher</surname> <given-names>D</given-names></name>. <article-title>Understanding Circuit Dynamics Using the Stomatogastric Nervous System of Lobsters and Crabs</article-title>. <source>Annu. Rev. Physiol</source>. <year>2007</year>;<volume>69</volume>: <fpage>291</fpage>–<lpage>316</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev.physiol.69.031905.161516" xlink:type="simple">10.1146/annurev.physiol.69.031905.161516</ext-link></comment> <object-id pub-id-type="pmid">17009928</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spruijt</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>van Hooff</surname> <given-names>JARAM</given-names></name>, <name name-style="western"><surname>Gispen</surname> <given-names>WH</given-names></name>. <article-title>Ethology and Neurobiology of Grooming Behavior</article-title>. <source>Physiological Rev</source>. <year>1992</year>;<volume>72</volume>(<issue>3</issue>): <fpage>825</fpage>–<lpage>852</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/physrev.1992.72.3.825" xlink:type="simple">10.1152/physrev.1992.72.3.825</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhukovskaya</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yanagawa</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Forschler</surname> <given-names>BT</given-names></name>. <article-title>Grooming Behavior as a Mechanism of Insect Disease Defense</article-title>. <source>Insects</source> <year>2013</year>;<volume>4</volume>: <fpage>609</fpage>–<lpage>630</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/insects4040609" xlink:type="simple">10.3390/insects4040609</ext-link></comment> <object-id pub-id-type="pmid">26462526</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dawkins</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Dawkins</surname> <given-names>M</given-names></name>. <article-title>Hierarchical organization and postural facilitation: rules for grooming in flies</article-title>. <source>Anim. Behav</source> <year>1976</year>;<volume>24</volume>: <fpage>739</fpage>–<lpage>755</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0003-3472(76)80003-6" xlink:type="simple">10.1016/S0003-3472(76)80003-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fentress</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Stilwell</surname> <given-names>FP</given-names></name>. <article-title>Grammar of a Movement Sequence in Inbred Mice</article-title>. <source>Nature</source> <year>1973</year>;<volume>244</volume>: <fpage>52</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/244052a0" xlink:type="simple">10.1038/244052a0</ext-link></comment> <object-id pub-id-type="pmid">4582491</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Szebenyi</surname> <given-names>AL</given-names></name>. <article-title>Cleaning Behaviour in Drosophila melanogaster</article-title>. <source>Anim. Behav</source>. <year>1969</year>;<volume>17</volume>: <fpage>641</fpage>–<lpage>651</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0003-3472(69)80006-0" xlink:type="simple">10.1016/S0003-3472(69)80006-0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Seeds</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Ravbar</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Chung</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hampel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Midgley</surname> <given-names>FM</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>Mensh</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Simpson</surname> <given-names>JH</given-names></name>. <article-title>A suppression hierarchy among competing motor programs drives sequential grooming in Drosophila</article-title>. <source>eLife</source> <year>2014</year>;<volume>3</volume>: <fpage>e02951</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.02951" xlink:type="simple">10.7554/eLife.02951</ext-link></comment> <object-id pub-id-type="pmid">25139955</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berman</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Shaevits</surname> <given-names>JW</given-names></name>. <article-title>Predictability and hierarchy in Drosophila behavior</article-title>. <source>PNAS</source> <year>2016</year>;<volume>113</volume>(<issue>42</issue>): <fpage>11943</fpage>–<lpage>11948</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1607601113" xlink:type="simple">10.1073/pnas.1607601113</ext-link></comment> <object-id pub-id-type="pmid">27702892</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raad</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ferveur</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Ledger</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Capovilla</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Robichon</surname> <given-names>A</given-names></name>. <article-title>Functional Gustatory Role of Chemoreceptors in Drosophila Wings</article-title>. <source>Cell Rep</source>. <year>2016</year>;<volume>15</volume>(<issue>7</issue>): <fpage>1442</fpage>–<lpage>1454</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.celrep.2016.04.040" xlink:type="simple">10.1016/j.celrep.2016.04.040</ext-link></comment> <object-id pub-id-type="pmid">27160896</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yanagawa</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Guigue</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Marion-Poll</surname> <given-names>F</given-names></name>. <article-title>Hygienic grooming is induced by contact chemicals in Drosophila melanogaster</article-title>. <source>Front. Beh. Neurosci</source>. <year>2014</year>;<volume>8</volume>: <fpage>254</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007105.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Agarwala</surname> <given-names>EK</given-names></name>, <name name-style="western"><surname>Chiel</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>PJ</given-names></name>. <article-title>Pursuit of food versus pursuit of information in a Markovian perception-action loop model of foraging</article-title>. <source>J. Theor. Biol</source>. <year>2012</year>;<volume>304</volume>: <fpage>235</fpage>–<lpage>272</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2012.02.016" xlink:type="simple">10.1016/j.jtbi.2012.02.016</ext-link></comment> <object-id pub-id-type="pmid">22381540</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>SH</given-names></name>. <article-title>Characterization of the crawling activity of Caenorhabditis elegans using a Hidden Markov model</article-title>. <source>Theory Biosci</source>. <year>2015</year>;<volume>134</volume>(<issue>3-4</issue>): <fpage>117</fpage>–<lpage>125</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s12064-015-0213-7" xlink:type="simple">10.1007/s12064-015-0213-7</ext-link></comment> <object-id pub-id-type="pmid">26319806</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sim</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SH</given-names></name>. <article-title>Using hidden Markov models to characterize termite traveling behavior in tunnels with different curvatures</article-title>. <source>Behav. Processes</source> <year>2015</year>;<volume>111</volume>: <fpage>101</fpage>–<lpage>108</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.beproc.2014.12.013" xlink:type="simple">10.1016/j.beproc.2014.12.013</ext-link></comment> <object-id pub-id-type="pmid">25562190</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cane</surname> <given-names>VR</given-names></name>. <article-title>Behaviour Sequences as Semi-Markov Chains</article-title>. <source>J. Royal. Stat. Society Series B (Methodological)</source> <year>1959</year>;<volume>21</volume>(<issue>1</issue>): <fpage>36</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.2517-6161.1959.tb00311.x" xlink:type="simple">10.1111/j.2517-6161.1959.tb00311.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Markow</surname> <given-names>TA</given-names></name>. <article-title>Behavioral and sensory basis of courtship success in Drosophila melanogaster</article-title>. <source>PNAS</source> <year>1987</year>;<volume>84</volume>: <fpage>6200</fpage>–<lpage>6204</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.84.17.6200" xlink:type="simple">10.1073/pnas.84.17.6200</ext-link></comment> <object-id pub-id-type="pmid">3114743</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Katsov</surname> <given-names>AY</given-names></name>, <name name-style="western"><surname>Freifeld</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Horowitz</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kuehn</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Clandinin</surname> <given-names>TR</given-names></name>. <article-title>Dynamic structure of locomotor behavior in walking fruit flies</article-title>. <source>eLife</source> <year>2017</year>;<volume>6</volume>: <fpage>e24610</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.26410" xlink:type="simple">10.7554/eLife.26410</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tao</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ozarkar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Beck</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Bhandawat</surname> <given-names>V</given-names></name>. <article-title>Statistical structure of locomotion and its modulation by odors</article-title>. <source>Elife</source> <year>2019</year>;<volume>8</volume>: <fpage>e41235</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.41235" xlink:type="simple">10.7554/eLife.41235</ext-link></comment> <object-id pub-id-type="pmid">30620334</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berman</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Choi</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Shaevits</surname> <given-names>JW</given-names></name>. <article-title>Mapping the stereotyped behavior of freely moving flies</article-title>. <source>J. R. Soc. Interface</source> <year>2014</year>;<volume>11</volume>: <fpage>20140672</fpage>, <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2014.0672" xlink:type="simple">http://dx.doi.org/10.1098/rsif.2014.0672</ext-link> <object-id pub-id-type="pmid">25142523</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jin</surname> <given-names>DZ</given-names></name>. <article-title>Generating variable birdsong syllable sequences with branching chain networks in avian premotor nucleus HVC</article-title>. <source>Phys. Rev. E</source> <year>2009</year>;<volume>80</volume>:<fpage>051902</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.80.051902" xlink:type="simple">10.1103/PhysRevE.80.051902</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Katahira</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Suzuki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Okanoya</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Okada</surname> <given-names>M</given-names></name>. <article-title>Complex Sequencing Rules of Birdsong Can be Explained by Simple Hidden Markov Processes</article-title>. <source>PLoS One</source> <year>2011</year>;<volume>6</volume>(<issue>9</issue>): <fpage>e24516</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0024516" xlink:type="simple">10.1371/journal.pone.0024516</ext-link></comment> <object-id pub-id-type="pmid">21915345</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kershenbaum</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bowles</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Freeberg</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>DZ</given-names></name>, <name name-style="western"><surname>Lameira</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Bohn</surname> <given-names>K</given-names></name>. <article-title>Animal vocal sequences: not the Markov chains we thought they were</article-title>. <source>Proc. R. Soc. B</source>;<volume>281</volume>: <fpage>20141370</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2014.1370" xlink:type="simple">10.1098/rspb.2014.1370</ext-link></comment> <object-id pub-id-type="pmid">25143037</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Ginke</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Luengo Hendriks</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>van Vliet</surname> <given-names>LJ</given-names></name>. <article-title>A short introduction to the Radon and Hough transforms and how they relate to each other</article-title>. <source>Delft University of Technology</source> (<year>2004</year>).</mixed-citation>
</ref>
<ref id="pcbi.1007105.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barradale</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Sinha</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lebestky</surname> <given-names>T</given-names></name>. <article-title>Quantification of Drosophila Grooming Behavior</article-title>. <source>J. Vis. Exp</source>. <year>2017</year>;<volume>125</volume>: <fpage>e55231</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007105.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Heiligenberg</surname> <given-names>W</given-names></name>. <article-title>Random processes describing the occurrence of behavioural patterns in a cichlid fish</article-title>. <source>Anim. Behav</source>. <year>1973</year>;<volume>21</volume>: <fpage>169</fpage>–<lpage>182</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0003-3472(73)80057-0" xlink:type="simple">10.1016/S0003-3472(73)80057-0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Niven</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Laughlin</surname> <given-names>SB</given-names></name>. <article-title>Energy limitation as a selective pressure on the evolution of sensory systems</article-title>. <source>J. Exp. Biol</source>. <year>2008</year>;<volume>211</volume>: <fpage>1792</fpage>–<lpage>1804</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.017574" xlink:type="simple">10.1242/jeb.017574</ext-link></comment> <object-id pub-id-type="pmid">18490395</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kristan</surname> <given-names>WB</given-names></name>. <article-title>Behavioral Sequencing: Competitive Queuing in the Fly CNS</article-title>. <source>Curr. Biol</source>. <year>2014</year>;<volume>24</volume>: <fpage>R743</fpage>–<lpage>746</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cub.2014.06.071" xlink:type="simple">10.1016/j.cub.2014.06.071</ext-link></comment> <object-id pub-id-type="pmid">25137585</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Long</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>DZ</given-names></name>, <name name-style="western"><surname>Fee</surname> <given-names>MS</given-names></name>. <article-title>Support for a synaptic chain model of neuronal sequence generation</article-title>. <source>Nature</source> <year>2010</year>;<volume>468</volume>(<issue>7322</issue>): <fpage>394</fpage>–<lpage>399</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature09514" xlink:type="simple">10.1038/nature09514</ext-link></comment> <object-id pub-id-type="pmid">20972420</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Suster</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Bate</surname> <given-names>M</given-names></name>. <article-title>Embryonic assembly of a central pattern generator without sensory input</article-title>. <source>Nature</source> <year>2002</year>;<volume>416</volume>(<issue>6877</issue>): <fpage>174</fpage>–<lpage>178</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/416174a" xlink:type="simple">10.1038/416174a</ext-link></comment> <object-id pub-id-type="pmid">11894094</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>von Philipsborn</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Masser</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bidaye</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Dickson</surname> <given-names>BJ</given-names></name>. <article-title>Neuronal Control of Drosophila Courtship Song</article-title>. <source>Neuron</source> <year>2011</year>;<volume>69</volume>(<issue>3</issue>): <fpage>509</fpage>–<lpage>522</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2011.01.011" xlink:type="simple">10.1016/j.neuron.2011.01.011</ext-link></comment> <object-id pub-id-type="pmid">21315261</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bautista</surname> <given-names>TG</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>QJ</given-names></name>, <name name-style="western"><surname>Pilowsky</surname> <given-names>PM</given-names></name>. <article-title>The generation of pharyngeal phase of swallow and its coordination with breathing: interaction between the swallow and respiratory central pattern generators</article-title>. <source>Prog. Brain. Res</source>. <year>2014</year>;<volume>212</volume>: <fpage>253</fpage>–<lpage>275</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/B978-0-444-63488-7.00013-6" xlink:type="simple">10.1016/B978-0-444-63488-7.00013-6</ext-link></comment> <object-id pub-id-type="pmid">25194202</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Westberg</surname> <given-names>KG</given-names></name>, <name name-style="western"><surname>Kolta</surname> <given-names>A</given-names></name>. <article-title>The trigeminal circuits responsible for chewing</article-title>. <source>Int. Rev. Neurobiol</source>. <year>2011</year>;<volume>97</volume>: <fpage>77</fpage>–<lpage>98</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/B978-0-12-385198-7.00004-7" xlink:type="simple">10.1016/B978-0-12-385198-7.00004-7</ext-link></comment> <object-id pub-id-type="pmid">21708308</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nassour</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Henaff</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Benouezdo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>G</given-names></name>. <article-title>Multi-layered multi-pattern CPG for adaptive locomotion of humanoid robots</article-title>. <source>Biol. Cybern</source>. <year>2014</year>;<volume>108</volume>(<issue>3</issue>): <fpage>291</fpage>–<lpage>303</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00422-014-0592-8" xlink:type="simple">10.1007/s00422-014-0592-8</ext-link></comment> <object-id pub-id-type="pmid">24570353</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007105.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qiao</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Allen</surname> <given-names>VW</given-names></name>, <name name-style="western"><surname>Shirasu-Hiza</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Syed</surname> <given-names>S</given-names></name>. <article-title>Automated analysis of long-term grooming behavior in Drosophila using a k-nearest neighbors classifier</article-title>. <source>eLife</source> <year>2015</year>;<volume>7</volume>: <fpage>e34497</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.34497" xlink:type="simple">https://doi.org/10.7554/eLife.34497</ext-link>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>