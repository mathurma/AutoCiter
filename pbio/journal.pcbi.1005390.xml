<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01090</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005390</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Approximation methods</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Systems science</subject><subj-group><subject>Nonlinear dynamics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Systems science</subject><subj-group><subject>Nonlinear dynamics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Mathematical functions</subject><subj-group><subject>Transfer functions</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>On the stability and dynamics of stochastic spiking neuron models: Nonlinear Hawkes process and point process GLMs</article-title>
<alt-title alt-title-type="running-head">Stability and dynamics of nonlinear Hawkes processes and PP-GLMs</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1733-3229</contrib-id>
<name name-style="western">
<surname>Gerhard</surname> <given-names>Felipe</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2775-2611</contrib-id>
<name name-style="western">
<surname>Deger</surname> <given-names>Moritz</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Truccolo</surname> <given-names>Wilson</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Neuroscience, Brown University, Providence, Rhode Island, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>School of Computer and Communication Sciences and School of Life Sciences, Brain Mind Institute, École polytechnique fédérale de Lausanne (EPFL), Lausanne, Switzerland</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Institute for Zoology, Faculty of Mathematics and Natural Sciences, University of Cologne, Cologne, Germany</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Institute for Brain Science, Brown University, Providence, Rhode Island, United States of America</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Center for Neurorestoration &amp; Neurotechnology, U. S. Department of Veterans Affairs, Providence, Rhode Island, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Beck</surname> <given-names>Jeff</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Duke University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> FG MD WT.</p>
</list-item>
<list-item>
<p><bold>Data curation:</bold> FG.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> FG MD.</p>
</list-item>
<list-item>
<p><bold>Funding acquisition:</bold> WT.</p>
</list-item>
<list-item>
<p><bold>Investigation:</bold> FG MD.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> FG MD.</p>
</list-item>
<list-item>
<p><bold>Project administration:</bold> WT.</p>
</list-item>
<list-item>
<p><bold>Resources:</bold> WT.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> FG MD.</p>
</list-item>
<list-item>
<p><bold>Supervision:</bold> WT.</p>
</list-item>
<list-item>
<p><bold>Visualization:</bold> FG.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> FG MD.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> FG MD WT.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">Wilson_Truccolo@brown.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>2</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>24</day>
<month>2</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>2</issue>
<elocation-id>e1005390</elocation-id>
<history>
<date date-type="received">
<day>6</day>
<month>7</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>28</day>
<month>1</month>
<year>2017</year>
</date>
</history>
<permissions>
<license xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">
<license-p>This is an open access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">Creative Commons CC0</ext-link> public domain dedication.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005390"/>
<abstract>
<p>Point process generalized linear models (PP-GLMs) provide an important statistical framework for modeling spiking activity in single-neurons and neuronal networks. Stochastic stability is essential when sampling from these models, as done in computational neuroscience to analyze statistical properties of neuronal dynamics and in neuro-engineering to implement closed-loop applications. Here we show, however, that despite passing common goodness-of-fit tests, PP-GLMs estimated from data are often unstable, leading to divergent firing rates. The inclusion of absolute refractory periods is not a satisfactory solution since the activity then typically settles into unphysiological rates. To address these issues, we derive a framework for determining the existence and stability of fixed points of the expected conditional intensity function (CIF) for general PP-GLMs. Specifically, in nonlinear Hawkes PP-GLMs, the CIF is expressed as a function of the previous spike history and exogenous inputs. We use a mean-field quasi-renewal (QR) approximation that decomposes spike history effects into the contribution of the last spike and an average of the CIF over all spike histories prior to the last spike. Fixed points for stationary rates are derived as self-consistent solutions of integral equations. Bifurcation analysis and the number of fixed points predict that the original models can show stable, divergent, and metastable (fragile) dynamics. For fragile models, fluctuations of the single-neuron dynamics predict expected divergence times after which rates approach unphysiologically high values. This metric can be used to estimate the probability of rates to remain physiological for given time periods, e.g., for simulation purposes. We demonstrate the use of the stability framework using simulated single-neuron examples and neurophysiological recordings. Finally, we show how to adapt PP-GLM estimation procedures to guarantee model stability. Overall, our results provide a stability framework for data-driven PP-GLMs and shed new light on the stochastic dynamics of state-of-the-art statistical models of neuronal spiking activity.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Earthquakes, gene regulatory elements, financial transactions, and action potentials produced by nerve cells are examples of sequences of discrete events in space or time. In many cases, such events do not appear independently of each other. Instead, the occurrence of one event changes the rate of upcoming events (e.g, aftershocks following an earthquake). The nonlinear Hawkes process is a statistical model that captures these complex dependencies. Unfortunately, for a given model, it is hard to predict whether stochastic samples will produce an event pattern consistent with observations. In particular, with positive feedback loops, the process might diverge and yield unrealistically high event rates. Here, we show that an approximation to the mathematical model predicts dynamical properties, in particular, whether the model will exhibit stable and finite rates. In the context of neurophysiology, we find that models estimated from experimental data often tend to show metastability or even unstable dynamics. Our framework can be used to add constraints to data-driven estimation procedures to find the optimal model with realistic event rates and help to build more robust models of single-cell spiking dynamics. It is a first step towards studying the stability of large-scale nonlinear spiking neural network models estimated from data.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000065</institution-id>
<institution>National Institute of Neurological Disorders and Stroke</institution>
</institution-wrap>
</funding-source>
<award-id>R01NS079533</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Truccolo</surname> <given-names>Wilson</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000738</institution-id>
<institution>U.S. Department of Veterans Affairs</institution>
</institution-wrap>
</funding-source>
<award-id>I01RX000668</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Truccolo</surname> <given-names>Wilson</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100006418</institution-id>
<institution>Brown University</institution>
</institution-wrap>
</funding-source>
<award-id>Pablo J. Salame ‘88 Goldman Sachs endowed Assistant Professorship of Computational Neuroscience</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Truccolo</surname> <given-names>Wilson</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001711</institution-id>
<institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution>
</institution-wrap>
</funding-source>
<award-id>P2ELP3-155278</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1733-3229</contrib-id>
<name name-style="western">
<surname>Gerhard</surname> <given-names>Felipe</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001711</institution-id>
<institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution>
</institution-wrap>
</funding-source>
<award-id>200020_147200</award-id>
</award-group>
<funding-statement>We acknowledge support from the National Institute of Neurological Disorders and Stroke (NINDS), grant R01NS079533 (WT); the U.S. Department of Veterans Affairs, Merit Review Award I01RX000668 (WT); the Pablo J. Salame ‘88 Goldman Sachs endowed Assistant Professorship of Computational Neuroscience at Brown University (WT); the Swiss National Science Foundation, grant no. P2ELP3-155278 (FG) and grant no. 200020_147200 (MD); and the European Union Seventh Framework Program (FP7) under grant agreement no. 604102, Human Brain Project (MD). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="0"/>
<page-count count="31"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data files are available from the Brown Digital Repository: DOI: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.7301/Z0K0726H" xlink:type="simple">10.7301/Z0K0726H</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Point-process generalized linear models (PP-GLMs) have become an important approach in the statistical modeling of neurophysiological responses from single nerve cells and their interactions in neural circuits [<xref ref-type="bibr" rid="pcbi.1005390.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005390.ref008">8</xref>]. A specific class of PP-GLMs are nonlinear Hawkes processes [<xref ref-type="bibr" rid="pcbi.1005390.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref010">10</xref>]. In this case, each action potential (spike) modulates the firing intensity of the neurons in the future. Nonlinear Hawkes PP-GLMs can capture the major canonical dynamics of single neurons [<xref ref-type="bibr" rid="pcbi.1005390.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1005390.ref013">13</xref>] and as phenomenological models avoid the many issues that arise in the specification of biophysically detailed neuronal models [<xref ref-type="bibr" rid="pcbi.1005390.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref015">15</xref>]. In this way, nonlinear Hawkes PP-GLMs are also important phenomenological models for the simulation and study of large-scale neuronal network models of brain function. However, nonlinear Hawkes PP-GLMs also lead to non-renewal point process spike train statistics because contributions to the intensity from many previous spikes can accumulate over arbitrary time scales [<xref ref-type="bibr" rid="pcbi.1005390.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref017">17</xref>]. This raises the question of whether such models will produce stable, stationary dynamics in simulations, or whether firing rates will diverge or settle into unphysiological rates depending on a specified absolute refractory period.</p>
<p>For the linear Hawkes point process model, stability can be assessed by calculating the integral of the spike-history kernel, i.e., the effect that each spike has on subsequent activity of the same cell [<xref ref-type="bibr" rid="pcbi.1005390.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1005390.ref020">20</xref>]. However, for the prevalent nonlinear case, no such practical criterion is currently available. Main stability results established by Brémaud and Massoulié are too restrictive for our applications [<xref ref-type="bibr" rid="pcbi.1005390.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref021">21</xref>]. Furthermore, model parameters are typically estimated from data using maximum-likelihood methods [<xref ref-type="bibr" rid="pcbi.1005390.ref002">2</xref>]. For linear autoregressive processes, it is well known that maximum-likelihood estimates can lead to unstable dynamics [<xref ref-type="bibr" rid="pcbi.1005390.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref023">23</xref>]. We expect this to be even more severe in nonlinear models.</p>
<p>Here, we first show that PP-GLMs estimated from physiological data might not generate spike train realizations that match even simple statistics such as mean firing rates of the original data. Instead, firing rates tend to diverge to the maximum firing rate that is allowed in the presence of an absolute refractory period. Firing patterns like this would typically be considered unphysiological. This can happen in spite of the models passing commonly used goodness-of-fit tests based on, for example, the time-rescaling theorem [<xref ref-type="bibr" rid="pcbi.1005390.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref025">25</xref>].</p>
<p>To address the above stability issues, we propose an approximative framework to derive stochastic stability conditions for PP-GLMs. For a stochastically stable point process, the state of the point process stochastically evolves in time, but can be described by a stable and time-invariant distribution of “states” (sample paths), resulting in a stationary point process [<xref ref-type="bibr" rid="pcbi.1005390.ref009">9</xref>]. In contrast, a process that is not stochastically stable may show similar stochastic dynamics for some time, but eventually its state may diverge and never return. In neural point processes, this scenario is typically associated with a divergence of the firing rate. In case of an actual divergence there is no stationary distribution of states. Note, however, that when considering absolute refractory periods, the divergence of the firing rate and associated internal states of the point process are limited. Firing with an inter-event interval equal to the refractory period is nonphysiological, and the state distribution in this mode of firing is singular. We call this a diverged state in slight deviance from the usual terminology. Our use of the term stochastic stability, however, is in line with the definition from stochastic dynamical systems, but generalized to stochastic point processes (see also [<xref ref-type="bibr" rid="pcbi.1005390.ref009">9</xref> Remark 4]).</p>
<p>Our approach to derive stability conditions for PP-GLMs is based on a recently developed mean-field theory of neural dynamics [<xref ref-type="bibr" rid="pcbi.1005390.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref027">27</xref>]. The approach relies on the following steps. First, we use a quasi-renewal (QR) approximation that decomposes spike history effects into the contribution of the last spike and an average of the conditional intensity function (CIF) over all spike histories prior to the most recent spike. Second, after truncation of a moment-based expansion, this decomposition leads to a tractable expression for the approximated CIF. Third, under stationarity conditions, fixed points can be derived as self-consistent solutions of an integral equation, which correspond to expected steady-state firing rates of the neuron. Fourth, depending on the number and stability of these fixed points, each single-neuron model can be unambiguously classified into one of three types: stable, divergent, or fragile. The latter corresponds to metastability which results from stochastic fluctuations perturbing the dynamics in the presence of multiple stable fixed points and when the upper fixed point corresponds to a stable but unphysiologically high firing rate. Fluctuations around the low-rate fixed point of the network dynamics predict an expected time horizon until rates will converge to the high-rate state. This expected time metric can be used to estimate the probability of firing rates to remain finite for a given time period. Examination of the stability of the fixed points and how it depends on the shape of the spike-history filter not only determines the stability of the stochastic dynamics, but also leads to general stability constraints on PP-GLM parameters.</p>
<p>In the following sections, we present our framework to assess the stability of a specific neuron model in detail. We validate the QR approximation in comparison to results of numerical simulations for a large range of artificial neuron models that are neurophysiologically plausible. We then apply the method to real-world data sets. Finally, we demonstrate and discuss how parameter estimation procedures could be adapted to ensure stability of estimated models.</p>
<p>As stated above, stability of neuron models is particularly important when numerical simulations are desired or spike trains are to be generated from the model. Generated spike trains can be used to assess model goodness-of-fit and to perform forecasting of neural activity over longer time scales. Our results are a first step towards ensuring stability for recurrently connected neural network models. These models can be put in the framework of multivariate nonlinear Hawkes models, and our classification framework conceptually translates to the multivariate case. Stable (or stabilized) neuron models play an important role in the field of computational neuroscience, especially in the simulation of large-scale models of brain function. They are also important in neuroengineering, where neuron models are embedded in hybrid and closed-loop applications [<xref ref-type="bibr" rid="pcbi.1005390.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref029">29</xref>].</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Estimated data-driven PP-GLMs can diverge, despite passing goodness-of-fit tests</title>
<p>The nonlinear Hawkes process is a point process model that is commonly used to describe neurophysiological responses. It defines the conditional intensity function (instantaneous firing rate) of a neuron as a nonlinear function of previous spiking activity (<xref ref-type="fig" rid="pcbi.1005390.g001">Fig 1A</xref>):
<disp-formula id="pcbi.1005390.e001"><alternatives><graphic id="pcbi.1005390.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>h</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where <inline-formula id="pcbi.1005390.e002"><alternatives><graphic id="pcbi.1005390.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> denotes the spiking history up to time <italic>t</italic> and <italic>ϕ</italic>(<italic>x</italic>) is a non-negative nonlinear function. The term <italic>h</italic>(<italic>t</italic>) consists of a constant offset <italic>I</italic><sub>0</sub> and a convolution of the spike train <italic>S</italic>(<italic>t</italic>) with (temporal) spike-history kernels or filters <italic>η</italic>(<italic>s</italic>):
<disp-formula id="pcbi.1005390.e003"><alternatives><graphic id="pcbi.1005390.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mrow><mml:mi>h</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>η</mml:mi> <mml:mo>*</mml:mo> <mml:mi>S</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
where the <inline-formula id="pcbi.1005390.e004"><alternatives><graphic id="pcbi.1005390.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> correspond to the previous spike times (see “<xref ref-type="sec" rid="sec012">Materials and Methods</xref>” for details). Based on both theoretical and empirical arguments [<xref ref-type="bibr" rid="pcbi.1005390.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref007">7</xref>], we set <italic>ϕ</italic>(<italic>x</italic>) = exp(<italic>x</italic>) to arrive at:
<disp-formula id="pcbi.1005390.e005"><alternatives><graphic id="pcbi.1005390.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mrow><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
with <inline-formula id="pcbi.1005390.e006"><alternatives><graphic id="pcbi.1005390.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<fig id="pcbi.1005390.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005390.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Schematic overview of the nonlinear Hawkes process and the quasi-renewal (QR) approximation.</title>
<p>The quasi-renewal approximation can be used to semi-analytically obtain steady-state firing rates of general, nonlinear Hawkes processes (PP-GLMs). Left: In the nonlinear Hawkes process, the conditional intensity of the point process, <inline-formula id="pcbi.1005390.e007"><alternatives><graphic id="pcbi.1005390.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mi>λ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, is a function of the whole spiking history (see <xref ref-type="disp-formula" rid="pcbi.1005390.e005">Eq (3)</xref>). It is modeled as a nonlinear function (here, an exponential function) of a linear convolution of the previous spike history with a spike-history filter <italic>η</italic>(<italic>s</italic>) plus a constant offset <italic>I</italic><sub>0</sub>. The dependence of the instantaneous firing rate on all previous spikes results in a non-renewal process. There are no closed-form solutions for even the first-order statistics of general, nonlinear Hawkes processes. Right: In the quasi-renewal approximation, the conditional intensity is modeled as a combination of the effect of the most recent spike <italic>t</italic><sub><italic>i</italic></sub> and a term involving the average over the whole spike history before the most recent spike (see <xref ref-type="disp-formula" rid="pcbi.1005390.e011">Eq (5)</xref>). This term includes the average firing activity in the past <italic>A</italic><sub>0</sub> ≡ <italic>A</italic>(<italic>t</italic> − <italic>s</italic>), which is filtered with the quasi-renewal filter <italic>γ</italic>(<italic>s</italic>) and added to the spike-history filter <italic>η</italic>(<italic>τ</italic>) of the most recent spike at <italic>t</italic> − <italic>τ</italic>. This predicts the instantaneous inter-spike interval density <italic>P</italic><sub>0</sub>(<italic>τ</italic>) from which the steady-state firing rate can be obtained as the inverse of the expected inter-spike interval <italic>E</italic>[<italic>τ</italic>]. The self-consistent solutions for which an assumed average history of <italic>A</italic><sub>0</sub> leads to an equivalent predicted steady-state rate are fixed points of the transfer function defined in the quasi-renewal approximation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.g001" xlink:type="simple"/>
</fig>
<p>Every previous spike contributes a spike-history kernel, and effects of all previous spikes accumulate. This leads to, in general, a non-renewal point process model. The model parameters that describe the kernel <italic>η</italic>(<italic>s</italic>) and the baseline firing rate <italic>c</italic> can be estimated using maximum-likelihood optimization within the framework of generalized linear models (GLMs) [<xref ref-type="bibr" rid="pcbi.1005390.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref004">4</xref>].</p>
<p>As stated earlier, these point-process GLMs (PP-GLMs) were recently shown to be able to describe all major canonical dynamics of single neurons [<xref ref-type="bibr" rid="pcbi.1005390.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1005390.ref013">13</xref>] and, thus, can serve as a canonical class of mathematically tractable models to describe general single-neuron spiking activity. For example, in [<xref ref-type="bibr" rid="pcbi.1005390.ref006">6</xref>], we analyzed spiking data from the stomatogastric nervous system of the crab. Neurons that are part of the pyloric network fire in stereotypical, rhythmic activity patterns (<xref ref-type="fig" rid="pcbi.1005390.g002">Fig 2A</xref>). Estimated PP-GLMs from this physiological dataset pass common goodness-of-fit tests such as based on residual analysis or the time-rescaling theorem. We created stochastic realizations of spike trains based on the model. These spike trains reproduce the observed burst pattern of the training data, and in a complete network simulation, the relative phases of the overall pyloric rhythm [<xref ref-type="bibr" rid="pcbi.1005390.ref006">6</xref>].</p>
<fig id="pcbi.1005390.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005390.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Point-process models estimated from physiological data can pass common goodness-of-fit tests, but simulated activity may diverge.</title>
<p>(A) Neurons in the stomatogastric ganglion (STG) of the crab show rhythmic bursts of spike patterns. Each line shows a random 2-second segment of the data from one neuron aligned to the first spike of a burst. The spike-history filter is estimated following the procedure in [<xref ref-type="bibr" rid="pcbi.1005390.ref006">6</xref>]. The neuron model passes commonly used goodness-of-fit tests, such as those based on the time-rescaling theorem [<xref ref-type="bibr" rid="pcbi.1005390.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref025">25</xref>]. Here, the Kolmogorov-Smirnov test is shown for rescaled inter-spike intervals to come from an exponential distribution with unit mean. The null hypothesis that observed spikes are coming from the estimated model is not rejected (<italic>P</italic> &gt; 0.05). When sampling spike trains from the model, the model regenerates the rhythmic, bursty activity that is qualitatively matched to the training data. (B) Similar analysis for single-unit activity from neocortical recordings in a person with pharmacologically intractable focal epilepsy [<xref ref-type="bibr" rid="pcbi.1005390.ref030">30</xref>]. Each line corresponds to a random ten-second segment of spontaneous activity during interictal periods, i.e., outside seizures. The estimated spike-history filter shows a refractory period and an excitatory rebound. The model passes commonly used goodness-of-fit tests (<italic>P</italic> &gt; 0.05). When stochastic samples are generated from the model, spiking activity diverges to a periodic firing pattern at the maximally allowed frequency given the absolute refractory period (here, 2 ms). For some sampled realizations, this divergence can happen very early in the simulated trial (e.g., trial 5). Therefore, simulated activity from the model is unphysiological. It does not match statistics of the spike train in the training data (mean firing rate, inter-spike interval statistics) despite passing the goodness-of-fit test. (C, D) Additional examples of single-unit activity from monkey cortex, areas PMv and M1 [<xref ref-type="bibr" rid="pcbi.1005390.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref032">32</xref>]. Each line represents a steady-state movement preparation period preceding visual cues leading to execution of reach and grasp actions. Although spike-history filters appear typical in both examples, and goodness-of-fit tests are passed, simulated activity diverges into unphysiological firing rates in one case (first example) and remains physiological in the other.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.g002" xlink:type="simple"/>
</fig>
<p>However, such simulations of spike trains from data-driven PP-GLMs do not always result in physiological spiking patterns. For example, when estimating PP-GLMs from single-unit data recorded from the neocortex of human epileptic patients [<xref ref-type="bibr" rid="pcbi.1005390.ref030">30</xref>], goodness-of-fit tests are generally passed, but simulated activity tends to diverge to unphysiologically high firing rates. One data set and estimated model are shown in <xref ref-type="fig" rid="pcbi.1005390.g002">Fig 2B</xref>.</p>
<p>In a more comprehensive analysis, we fitted PP-GLMs to spiking data from neurons recorded from motor-related cortical areas in the monkey [<xref ref-type="bibr" rid="pcbi.1005390.ref031">31</xref>]. We restricted data to a one-second steady-state movement preparation period of the trial. This period was roughly stationary since it did not include, by design, firing rate transients driven by sensory stimuli or movement execution. For 35 out of the 99 data-driven models, we find that simulated spike trains have finite divergence times. Some of these models diverge in simulations even when goodness-of-fit tests are passed. We show two examples in <xref ref-type="fig" rid="pcbi.1005390.g002">Fig 2C and 2D</xref>. Qualitatively similar results are obtained for all other models.</p>
<p>Instability is also observed when the simulation is performed using a nonlinearity that grows less rapidly than the exponential. We generated stochastic realizations of spike trains using two additional nonlinearities (a linear rectifier, and <italic>f</italic>(<italic>x</italic>) = log(1 + <italic>e</italic><sup><italic>x</italic></sup>), a smooth interpolation between an exponential and linear function, <xref ref-type="supplementary-material" rid="pcbi.1005390.s001">S1 Fig</xref>). Both functions are globally dominated by the exponential function (see <xref ref-type="supplementary-material" rid="pcbi.1005390.s001">S1A Fig</xref>). Potentially, nonstable behavior could be observed when simulating with the exponential nonlinearity but not with the two less rapidly accelerating nonlinearities. However, we find that even in these cases, firing rates diverged for the same data sets as presented in <xref ref-type="fig" rid="pcbi.1005390.g002">Fig 2B and 2C</xref>.</p>
<p>In summary, while PP-GLMs estimated from data may serve well in encoding and decoding analysis that require one-step spike prediction conditioned on actually observed spike history and may pass goodness-of-fit tests, they tend to be poor generative models because of the lack of stochastic stability. The use of PP-GLMs as generative models, however, is essential when statistical analyses of spike trains generated by the model are required, or when long-term prediction of future spiking states in single-neuron and neuronal networks is used in neural decoding or closed-loop interventions.</p>
<p>To our knowledge, the stability of PP-GLMs estimated from data has not been systematically examined before. In the next sections, we will develop a framework to assess the dynamics and stability of stochastic spiking neuron models.</p>
</sec>
<sec id="sec004">
<title>A framework to assess stability and dynamics of stochastic spiking neuron models</title>
<p>PP-GLMs have post-spike filters which typically make the spike train probability depend on many previous spikes. These dynamics are in contrast to the conditional intensity function of a renewal point process which depends only on the very last spike time. Therefore, PP-GLMs are generally not renewal processes. When assessing dynamics and stability of PP-GLMs, we are interested in the behavior of the corresponding firing rates. For such general PP-GLMs, however, there are no closed-form solutions for even simple statistical features, such as expected mean firing rates or second-order statistics. Here, to obtain estimates of such statistical features for a given nonlinear Hawkes process, we employ an approximation based on a recently introduced quasi-renewal approximation [<xref ref-type="bibr" rid="pcbi.1005390.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref027">27</xref>].</p>
<p>The quasi-renewal approximation (<xref ref-type="fig" rid="pcbi.1005390.g001">Fig 1B</xref>) consists of approximating the (non-renewal) PP-GLM by a process which is nearly a renewal-process (hence, “quasi-renewal”) that depends on the last spike time and on the average firing rate in the past [<xref ref-type="bibr" rid="pcbi.1005390.ref026">26</xref>]. Specifically, we consider the steady-state conditional intensity <inline-formula id="pcbi.1005390.e008"><alternatives><graphic id="pcbi.1005390.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> at time <italic>t</italic> as the average intensity over all possible spike histories that share the most recent spike at time <inline-formula id="pcbi.1005390.e009"><alternatives><graphic id="pcbi.1005390.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1005390.e010"><alternatives><graphic id="pcbi.1005390.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>λ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>〉</mml:mo></mml:mrow> <mml:mrow><mml:mi>S</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi> <mml:mspace width="1pt"/><mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mrow><mml:mo>〈</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>η</mml:mi> <mml:mo>*</mml:mo> <mml:mi>S</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow> <mml:mrow><mml:mi>S</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
The first term explicitly models the effect of the most recent spike only, and the second term represents the average of the spiking activity prior to the time of the last spike in the steady-state regime. It can be approximated by (see “<xref ref-type="sec" rid="sec012">Materials and Methods</xref>” for details):
<disp-formula id="pcbi.1005390.e011"><alternatives><graphic id="pcbi.1005390.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mrow><mml:msub><mml:mrow><mml:mo>〈</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>η</mml:mi> <mml:mo>*</mml:mo> <mml:mi>S</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow> <mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>≈</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:munder><mml:munder accentunder="true"><mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>η</mml:mi> <mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mi>γ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>u</mml:mi></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
with <italic>γ</italic>(<italic>u</italic>) = <italic>e</italic><sup><italic>η</italic>(<italic>u</italic>)</sup> − 1 for the exponentiated spike-history kernel. Here, <italic>A</italic><sub>0</sub> is the steady-state firing rate of the process. Intuitively, the convolution of the actual spike train <italic>S</italic>(<italic>t</italic>) with <italic>η</italic>(<italic>s</italic>) is replaced by the convolution of a homogeneous Poisson process spike history of intensity <italic>A</italic>(<italic>t</italic> − <italic>u</italic>) ≡ <italic>A</italic><sub>0</sub> with an effective filter <italic>γ</italic>(<italic>u</italic>) (<xref ref-type="fig" rid="pcbi.1005390.g001">Fig 1B</xref>). Since the convolution is applied to a constant <italic>A</italic><sub>0</sub>, the term reduces to a product of <italic>A</italic><sub>0</sub> and the integral of <italic>γ</italic>(<italic>u</italic>) with the lower bound dependent on <inline-formula id="pcbi.1005390.e012"><alternatives><graphic id="pcbi.1005390.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mi>τ</mml:mi> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. Using this approximation, we obtain a quasi-renewal CIF by combining Eqs (<xref ref-type="disp-formula" rid="pcbi.1005390.e010">4</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005390.e011">5</xref>). Given the QR-CIF, <xref ref-type="disp-formula" rid="pcbi.1005390.e010">Eq (4)</xref>, we can then as for ordinary renewal processes, derive the steady-state survivor function <inline-formula id="pcbi.1005390.e013"><alternatives><graphic id="pcbi.1005390.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula> as:
<disp-formula id="pcbi.1005390.e014"><alternatives><graphic id="pcbi.1005390.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>u</mml:mi></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
<inline-formula id="pcbi.1005390.e015"><alternatives><graphic id="pcbi.1005390.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula> then yields the steady-state probability density <italic>P</italic><sub>0</sub> of the inter-spike intervals:
<disp-formula id="pcbi.1005390.e016"><alternatives><graphic id="pcbi.1005390.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
The inverse of the expected inter-spike interval must equal the firing rate <italic>f</italic> which thus is an implicit function of <italic>A</italic><sub>0</sub> through <xref ref-type="disp-formula" rid="pcbi.1005390.e011">Eq (5)</xref>:
<disp-formula id="pcbi.1005390.e017"><alternatives><graphic id="pcbi.1005390.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mfenced close="]" open="[" separators=""><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mi>τ</mml:mi> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>τ</mml:mi></mml:mfenced> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
In effect, the QR theory derives a transfer function <italic>f</italic>(<italic>A</italic><sub>0</sub>) &gt; 0 that links an assumed average spike history to a predicted firing rate. Assuming stationarity, <italic>f</italic>(<italic>A</italic><sub>0</sub>) has to match <italic>A</italic><sub>0</sub> which leads to a fixed-point equation. Intersections of <italic>f</italic>(<italic>A</italic><sub>0</sub>) with the identity correspond to expected fixed points of the dynamics. Stable fixed points in the quasi-renewal approximation predict steady-state firing rates of nonlinear Hawkes processes (PP-GLMs).</p>
<p>We first show how the number and stability of fixed points of the derived transfer function <italic>f</italic>(<italic>A</italic><sub>0</sub>) for the nonlinear Hawkes process endowed with an absolute refractory period can be used to classify the dynamical behavior of the single-neuron model (<xref ref-type="fig" rid="pcbi.1005390.g003">Fig 3</xref>):</p>
<list list-type="bullet">
<list-item>
<p><bold>No fixed point</bold>: If there is no stable fixed point (i.e., <italic>f</italic>(<italic>A</italic><sub>0</sub>) &gt; <italic>A</italic><sub>0</sub> for all <italic>A</italic><sub>0</sub>), activity will diverge after a finite transient. However, this cannot happen in the presence of an absolute refractory period <italic>τ</italic><sub>ref</sub>. The maximal firing rate of the neuron is bounded by <italic>λ</italic><sub><italic>max</italic></sub> = 1/<italic>τ</italic><sub>ref</sub>. In that case, there is always at least one stable fixed point. Throughout the rest of the paper, we assume the existence of such an absolute refractory period and set <italic>τ</italic><sub>ref</sub> = 2 ms.</p>
</list-item>
<list-item>
<p><bold>One stable fixed point</bold>: Any perturbation in the firing rate will eventually decay back to the steady-state rate. If the steady-state firing rate predicted by the fixed point is close to the mean firing rate of the training data, the rate is considered physiological and we classify the neuron model as “stable” (<xref ref-type="fig" rid="pcbi.1005390.g003">Fig 3</xref> top, left). Conversely, if the fixed point is above <italic>λ</italic><sub><italic>thr</italic></sub> = 0.9 × <italic>λ</italic><sub><italic>max</italic></sub>, we define here the rate as unphysiologically high and classify the model as “divergent” (<xref ref-type="fig" rid="pcbi.1005390.g003">Fig 3</xref> top, center).</p>
</list-item>
<list-item>
<p><bold>Two stable fixed points</bold>: More than one stable fixed point leads to multi-stable dynamics. Due to the continuity of the transfer function, the first fixed point is necessarily stable, followed by an unstable fixed point, and so on, in alternating fashion. In general, in stochastic multi-stable dynamics, activity will remain around one state for some time before fluctuations drive it towards a different stable fixed point (metastability). Depending on the location of the stable fixed points, such multi-stable activity can be classified as “stable” (both fixed points smaller than <italic>λ</italic><sub><italic>thr</italic></sub>; <xref ref-type="fig" rid="pcbi.1005390.g003">Fig 3</xref> bottom, left) or “divergent” (both fixed points larger than <italic>λ</italic><sub><italic>thr</italic></sub>; <xref ref-type="fig" rid="pcbi.1005390.g003">Fig 3</xref> bottom, center). Interesting dynamics emerges when one fixed point is within the range of physiological rates and the other one is close to the “divergent”, maximal rate (<xref ref-type="fig" rid="pcbi.1005390.g003">Fig 3</xref> top, right). In that case, if activity is initialized in the lower state, it will remain in the lower state for a finite time before switching to the unphysiological, high-rate state. We call these metastable dynamics “fragile” to emphasize that such models may produce realistic firing rates in simulations when initialized in the low state but will ultimately escape the stable fixed point and diverge to unphysiological high-firing activity. By E[<italic>T</italic><sub>div</sub>], we denote the expected time to transition from the low-rate state to the high-rate state for the first time. Expected divergence times E[<italic>T</italic><sub>div</sub>] will depend on the distance between the fixed points and the location of the unstable fixed point.</p>
</list-item>
<list-item>
<p><bold>Three or more stable fixed points</bold>: Dynamics can be classified analogously to the previous cases based on how many fixed points are above and below <italic>λ</italic><sub><italic>thr</italic></sub> (<xref ref-type="fig" rid="pcbi.1005390.g003">Fig 3</xref> bottom, right). However, more than two stable fixed points seem rare in our datasets and simulations. Although they might be constructed by a deliberate choice of the spike-history filter <italic>η</italic>(<italic>s</italic>), all models that we estimated from physiological data turned out to have at most two stable fixed points.</p>
</list-item>
</list>
<fig id="pcbi.1005390.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005390.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Stochastic dynamics of nonlinear Hawkes PP-GLMs endowed with absolute refractory periods: Classification based on transfer functions in the quasi-renewal approximation.</title>
<p>The quasi-renewal approximation provides a predicted firing rate of a neuron model <italic>f</italic>(<italic>A</italic><sub>0</sub>) based on an assumed average firing rate in the past <italic>A</italic><sub>0</sub> (see “<xref ref-type="sec" rid="sec012">Materials and Methods</xref>”). This defines an iterative equation whose fixed points represent the steady-state firing rates. A qualitative classification of the dynamical behaviors is based on the location and stability of the fixed points. Note that throughout the study, we are assuming that there exists an absolute refractory period. Thereby, the maximum firing rate of any model is limited by a maximal firing rate <italic>λ</italic><sub><italic>max</italic></sub>. We define a steady-state firing rate to be unphysiological if it exceeds <italic>λ</italic><sub><italic>thr</italic></sub> = 0.9 × <italic>λ</italic><sub><italic>max</italic></sub> (gray area). Given an absolute refractory period, there always exists at least one stable fixed point. If it is the only one and below <italic>λ</italic><sub><italic>thr</italic></sub>, the model is classified as stable (top, left). If the only stable fixed point is above <italic>λ</italic><sub><italic>thr</italic></sub>, the model is divergent (top, center). If there are two stable fixed points, one above and one below <italic>λ</italic><sub><italic>thr</italic></sub>, the model is classified as “fragile” (metastable), indicating that the (physiological) low-rate fixed point is only transiently stable. Expected divergence times E[<italic>T</italic><sub>div</sub>] will depend on the distance between the fixed points. To provide a complete classification framework, we also need to consider the case of two or more stable fixed points, although the latter case seems to be rarely encountered in our experience. In case of two or more stable fixed points below the threshold, the model is classified as stable (bottom, left). Its dynamics is predicted to be multi-stable with steady-state rates fluctuating around two fixed points. If all stable fixed points lie above the threshold the model is considered “divergent” (bottom, center). Any case for which there are multiple stable fixed points both below and above <italic>λ</italic><sub><italic>thr</italic></sub> are considered “fragile” (bottom, right).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.g003" xlink:type="simple"/>
</fig>
<p>Overall, the above classification of the qualitative stochastic dynamics suggests a general framework to assess stability and dynamics of stochastic spiking neuron models (<xref ref-type="fig" rid="pcbi.1005390.g004">Fig 4</xref>). In the particular case of data-driven models, training data are used to estimate parameters of a nonlinear Hawkes model (PP-GLM) through (regularized) maximum-likelihood optimization. As shown above, we find empirically that simulating spike trains from these models often yields unphysiological spiking patterns, and firing rates may diverge (Figs <xref ref-type="fig" rid="pcbi.1005390.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1005390.g004">4</xref>, top). We can use the quasi-renewal approximation to analyze the stability of the estimated neuron model. This approximation predicts the dynamics of the neuron model and distinguishes three qualitatively different dynamical behaviors.</p>
<fig id="pcbi.1005390.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005390.g004</object-id>
<label>Fig 4</label>
<caption>
<title>A framework to assess stability and dynamics of stochastic spiking neuron models.</title>
<p>Stability of models estimated from physiological data is analyzed using the quasi-renewal approximation. When stable models are desired for sampling or simulations, stability constraints can be included in model estimation. Three types of dynamics can be distinguished: First, “stable” models have steady-state firing rates that are in the physiological range. Spike trains can be safely generated from the model. Second, “divergent” models have a steady-state firing rate that is very close to the maximally allowed firing rate. In this case, stabilization constraints can be added to the maximum-likelihood optimization problem to constrain the feasible parameter space to non-divergent models. Finally, model dynamics can be classified as “fragile”, indicating metastable dynamics. While there is a steady-state firing rate at physiological firing rates, there are additional steady-state rates at unphysiological high rates. A simulation that is started with physiological initial conditions may remain in the low-rate regime for a while, but will ultimately visit the unphysiological rate. The framework may provide an estimate of the expected escape or “divergence” time, E[<italic>T</italic><sub>div</sub>]. Depending on E[<italic>T</italic><sub>div</sub>], the model can be effectively treated as “stable” or “divergent” based on the typical time scales that would be relevant for simulation. In any of the three cases, the model (or its stabilized variant) is evaluated based on standard model selection and goodness-of-fit tests before any inference is made.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.g004" xlink:type="simple"/>
</fig>
<p>Stable or fragile models with high expected divergence times can be safely used to generate stochastic samples from the model. For divergent models or fragile models with low expected divergence times, stabilization constraints can be added to the maximum-likelihood optimization problem to constrain the feasible parameter space to non-divergent models. In any of the three cases, the model (or its stabilized variant) is evaluated based on standard model selection and goodness-of-fit tests before any inference is made (<xref ref-type="fig" rid="pcbi.1005390.g004">Fig 4</xref>, bottom).</p>
<p>In the next sections, we present the application of this framework to simulated and real data to demonstrate its validity and utility in modeling electrophysiological responses. First, we demonstrate the proposed method for PP-GLMs that have a spike-history filter that consists of either a single exponential or a sum of two exponentials before moving on to filters estimated from neurophysiological data.</p>
</sec>
<sec id="sec005">
<title>Predicted stability reflects simulation outcomes for exponential spike-history filters</title>
<p>We start with the analysis of a simple PP-GLM with a spike-history filter given by a single exponential and an absolute refractory period. The complete model is given by:
<disp-formula id="pcbi.1005390.e018"><alternatives><graphic id="pcbi.1005390.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>λ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>η</mml:mi> <mml:mo>*</mml:mo> <mml:mi>S</mml:mi> <mml:mo>]</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>η</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>J</mml:mi> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
with Heaviside function <italic>θ</italic>(<italic>x</italic>) and parameters <italic>τ</italic><sub>ref</sub> = 2 ms, <italic>J</italic><sub>ref</sub> = −∞ (−10<sup>12</sup> in numerical simulations), <italic>τ</italic> = 20 ms, and amplitude <italic>J</italic>.</p>
<p>We scanned the two-dimensional parameter space given by the amplitude <italic>J</italic> of the filter and the baseline firing rate <italic>c</italic> (<xref ref-type="fig" rid="pcbi.1005390.g005">Fig 5A</xref>; −2 ≤ <italic>J</italic> ≤ 4 with 121 equally spaced samples and 0.1 ≤ <italic>c</italic> ≤ 6.0 <italic>s</italic><sup>−1</sup> with 60 equally-spaced samples). The QR approximation predicts three regimes of dynamical activity: For slightly positive and negative kernel amplitude <italic>J</italic>, the model is stable. Indeed, in simulations, we observe finite and stable rates (<xref ref-type="fig" rid="pcbi.1005390.g005">Fig 5B</xref>, top row). For higher amplitudes, the dynamics are predicted to be fragile and ultimately divergent (for large <italic>J</italic> and <italic>c</italic>). As expected, the average divergence time estimated from numerical simulations gradually decreases with increasing <italic>J</italic> and <italic>c</italic> (color-coded in <xref ref-type="fig" rid="pcbi.1005390.g005">Fig 5A</xref>). Divergent models are almost instantly diverging (<xref ref-type="fig" rid="pcbi.1005390.g005">Fig 5B</xref>, bottom row), while for fragile models, a whole spectrum of divergence times is observed (<xref ref-type="fig" rid="pcbi.1005390.g005">Fig 5B</xref>, middle row). Within the variance given by the finite number of simulated models, we did not observe any discrepancies between the behavior predicted by the QR approximation and the numerical results.</p>
<fig id="pcbi.1005390.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005390.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Predicted stability reflects simulation outcomes: Exponential spike-history filter.</title>
<p>(A) Spike trains are simulated from a nonlinear Hawkes model with baseline firing rate <italic>c</italic> and an auto-history kernel <italic>η</italic>(<italic>s</italic>) = <italic>J</italic> exp(−<italic>s</italic>/<italic>τ</italic>) with amplitude <italic>J</italic>, time constant <italic>τ</italic> = 0.02 s, and absolute refractory period <italic>τ</italic><sub>ref</sub> = 2 ms. The QR approximation qualitatively predicts three classes of dynamics (separated by thick lines). Color indicates average divergence times estimated from simulations. In the dashed region, no finite divergence times were observed. (B) An example of a spike-history filter for each of the dynamics is shown together with a spike raster of simulated activity. Purely inhibitory filters produce stable dynamics (top, <italic>J</italic> = −1, <italic>c</italic> = 5 s<sup>−1</sup>). For fragile models, after an episode of irregular firing, dynamics switches into a tonic firing mode close to the limit frequency 1/<italic>τ</italic><sub>ref</sub> (middle, <italic>J</italic> = 1, <italic>c</italic> = 5 s<sup>−1</sup>). For divergent models, the only stable fixed point is close to the limit frequency (bottom, <italic>J</italic> = 3, <italic>c</italic> = 5 s<sup>−1</sup>). After a brief transient, the model switches to the tonic firing mode at limit frequency. All dynamics observed in simulations are in accordance with the prediction from the QR approximation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.g005" xlink:type="simple"/>
</fig>
<p>For all models of the parameter range that were classified as stable, we compared the predicted steady-state firing rate to the one observed in numerical simulations (<xref ref-type="fig" rid="pcbi.1005390.g006">Fig 6A</xref>). In this case, the QR approximation provides an excellent prediction of mean firing rates (Pearson’s correlation coefficient <italic>ρ</italic> &gt; 0.999).</p>
<fig id="pcbi.1005390.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005390.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Rate and time to divergence: Exponential spike-history filter.</title>
<p>(A) Observed steady-state firing rate versus predicted steady-state firing rate for every model classified as “stable” in <xref ref-type="fig" rid="pcbi.1005390.g005">Fig 5</xref>. Each dot corresponds to a model. Dashed line indicates equality. Linear correlation coefficient is <italic>ρ</italic> = 0.9996. (B) Observed versus predicted divergence times for all models classified as “fragile” in <xref ref-type="fig" rid="pcbi.1005390.g005">Fig 5</xref>. Note the logarithmic axes. The QR approximation provides an approximation of the divergence times. The divergence time of a simulation was defined as the end of the first two-second interval in which the average rate exceeded <italic>λ</italic><sub><italic>thr</italic></sub>. Therefore, estimated divergence times cannot be below 2 s (gray area).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.g006" xlink:type="simple"/>
</fig>
<p>A major feature of the QR approximation is to predict (an upper bound on) the expected divergence times for fragile models. In practice, this is relevant for model sampling via simulation where it is important to classify fragile models as “effectively stable” or divergent (see <xref ref-type="fig" rid="pcbi.1005390.g004">Fig 4</xref>). For high firing rates close to <inline-formula id="pcbi.1005390.e019"><alternatives><graphic id="pcbi.1005390.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, the regular spike train with inter-spike intervals around <italic>τ</italic><sub>ref</sub> is the only possible spike train realization. Therefore, one way to estimate E[<italic>T</italic><sub>div</sub>] is to consider periodic spike histories with different frequencies that would lead to self-sustained periodic firing at maximal rate with high probability (see “<xref ref-type="sec" rid="sec012">Materials and Methods</xref>” for details).</p>
<p><xref ref-type="fig" rid="pcbi.1005390.g006">Fig 6B</xref> compares predicted versus observed divergence times for all fragile models. The predicted <italic>T</italic><sub>div</sub> provide an upper bound on the observed divergence times. The divergence time of a simulation was defined as the end of the first two-second interval in which the average rate exceeded <italic>λ</italic><sub><italic>thr</italic></sub>. For this reason, estimated divergence times cannot be below 2 s (<xref ref-type="fig" rid="pcbi.1005390.g006">Fig 6B</xref>, gray area). Therefore, small estimated divergence times do not obey the predicted bound. However, there seems to be a reasonable (power-law) dependence between predicted and observed <italic>T</italic><sub>div</sub> (Pearson’s correlation coefficient <italic>ρ</italic> = 0.925).</p>
<p>We now look at more complex PP-GLMs to test the validity of our proposed framework. We consider spike-history filters consisting of a sum of two exponentials with amplitudes <italic>J</italic><sub><italic>r</italic></sub>, <italic>J</italic><sub><italic>a</italic></sub>, and corresponding time constants <italic>τ</italic><sub><italic>r</italic></sub> and <italic>τ</italic><sub><italic>a</italic></sub>:
<disp-formula id="pcbi.1005390.e020"><alternatives><graphic id="pcbi.1005390.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>λ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>η</mml:mi> <mml:mo>*</mml:mo> <mml:mi>S</mml:mi> <mml:mo>]</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>η</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Depending on the signs of the amplitudes, this model resembles many plausible single-neuron behaviors: <italic>J</italic><sub><italic>r</italic></sub> &lt; 0 indicates a relative refractory period beyond the absolute 2 ms refractory period while <italic>J</italic><sub><italic>r</italic></sub> &gt; 0 promotes bursty dynamics. Similarly, <italic>J</italic><sub><italic>a</italic></sub> ≠ 0 can be interpreted as inhibitory or facilitating adaptation (e.g., spike-frequency adaptation [<xref ref-type="bibr" rid="pcbi.1005390.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref033">33</xref>]).</p>
<p>We evaluated models on a wide range of combinations of amplitudes <italic>J</italic><sub><italic>r</italic></sub> and <italic>J</italic><sub><italic>a</italic></sub> (<xref ref-type="fig" rid="pcbi.1005390.g007">Fig 7A</xref>; −11 ≤ <italic>J</italic><sub><italic>r</italic></sub> ≤ 11 with 100 equally spaced samples and −3 ≤ <italic>J</italic><sub><italic>a</italic></sub> ≤ 3 with 75 equally-spaced samples), for <italic>τ</italic><sub><italic>r</italic></sub> = 20 ms and <italic>τ</italic><sub><italic>a</italic></sub> = 100 ms, respectively, and for fixed <italic>c</italic> = 5 <italic>s</italic><sup>−1</sup>. As expected, negative and positive but small values of <italic>J</italic><sub><italic>r</italic></sub> and <italic>J</italic><sub><italic>a</italic></sub> lead to stable dynamics. For a narrow band, models are expected to be fragile (<xref ref-type="fig" rid="pcbi.1005390.g007">Fig 7B</xref>, top row). This observation is consistent with divergence times estimated from numerical simulations. Finally, larger values of either <italic>J</italic><sub><italic>a</italic></sub> or <italic>J</italic><sub><italic>r</italic></sub> lead to divergent models, although in an asymmetric way (<xref ref-type="fig" rid="pcbi.1005390.g007">Fig 7A and 7B</xref>, bottom row). Qualitatively similar results are obtained for other values of the baseline <italic>c</italic> (<xref ref-type="supplementary-material" rid="pcbi.1005390.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005390.s003">S3</xref> Figs).</p>
<fig id="pcbi.1005390.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005390.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Predicted stability reflects simulation outcomes: Sum-of-exponentials spike-history filter.</title>
<p>(A) Spike trains are simulated from a nonlinear Hawkes model with fixed baseline <italic>c</italic> = 5 s<sup>−1</sup> and an auto-history kernel consisting of two exponentials with amplitudes <italic>J</italic><sub><italic>r</italic></sub>, <italic>J</italic><sub><italic>a</italic></sub>, and corresponding time constants <italic>τ</italic><sub><italic>r</italic></sub> = 0.02 s and <italic>τ</italic><sub><italic>a</italic></sub> = 0.1 s. Observed divergence times for simulated spike trains are color-coded (same scale as in <xref ref-type="fig" rid="pcbi.1005390.g005">Fig 5</xref>). In the dashed region, no finite divergence times were observed. (B) Auto-history kernels for three different parameter values (models a, b and c), displaying irregular, bursty and divergent dynamics, respectively, consistent with the prediction of the QR-approximation except for model b (see main text).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.g007" xlink:type="simple"/>
</fig>
<p>Estimated divergence times are generally consistent with the qualitative prediction of the QR approximation with one exception: For multiphasic spike-history filters, i.e. either strongly refractory neurons (<italic>J</italic><sub><italic>r</italic></sub> ≪ 0) with excitatory rebounds (<italic>J</italic><sub><italic>a</italic></sub> ≫ 0) or the opposite (<italic>J</italic><sub><italic>r</italic></sub> ≫ 0 and <italic>J</italic><sub><italic>a</italic></sub> ≪ 0), the QR approximation predicts divergent models, but simulations indicate that rates remain below the threshold <italic>λ</italic><sub><italic>thr</italic></sub> to be classified as divergent (<xref ref-type="fig" rid="pcbi.1005390.g007">Fig 7A</xref>, upper left and lower right corners; <xref ref-type="fig" rid="pcbi.1005390.g007">Fig 7B</xref>, middle row). Spike trains generated from models with these parameters tend to produce intermittent bursts. This is a condition for which the quasi-renewal approximation is known to become invalid [<xref ref-type="bibr" rid="pcbi.1005390.ref026">26</xref>]. The dynamics lead to the divergent state where the model neuron fires initially at maximally allowed firing rate (hence, unphysiological). However, the dynamics escape this high-firing rate fixed point after a finite number of such high-rate bursts, and the activity reverts back to the low-rate state. Averaged over a longer time period, the mean activity stays well below <italic>λ</italic><sub><italic>thr</italic></sub> and therefore, <inline-formula id="pcbi.1005390.e021"><alternatives><graphic id="pcbi.1005390.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> in contrast to the dynamics predicted by the QR approximation. The reason for this discrepancy is that the QR approximation assumes homogeneous, Poisson-like firing prior to the last spike time, while the only way to achieve firing rates close to the maximally allowed rate by the absolute refractory period is to have a highly regular spike train. For highly regular spike histories, the QR approximation does not provide valid fixed points of the dynamics. However, these cases can be captured by an analysis of the regular spiking limit (see “Bursting and the regular spiking limit”) which does not explicitly depend on the QR approximation.</p>
<p>A less severe limitation of the QR approximation is visible in the comparison between predicted and simulated steady-state firing rates for models classified as stable (<xref ref-type="fig" rid="pcbi.1005390.g008">Fig 8A</xref>). While most rates are accurately estimated (points near the diagonal line), very bursty neurons have higher firing rates in simulations than predicted by the QR approximation (stable models with <italic>J</italic><sub><italic>r</italic></sub> ≫ 0 and <italic>J</italic><sub><italic>a</italic></sub> ≪ 0). This is due to dependencies beyond the last spike that are ignored in the approximation but are non-negligible for burst firing. Loosely speaking, in this case the QR approximation predicts the rate of isolated spikes and <italic>bursts</italic>, but not the number of total spikes. The burst duration can be predicted from a simple criterion based on the conditional intensity function of the PP-GLM, independent of the QR approximation (see “Bursting and the regular spiking limit”).</p>
<fig id="pcbi.1005390.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005390.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Rate and time to divergence: Sum-of-exponentials spike-history filter.</title>
<p>(A) Observed steady-state firing rate versus predicted steady-state firing rate for every model classified as “stable” in <xref ref-type="fig" rid="pcbi.1005390.g007">Fig 7</xref>. Each dot corresponds to a model. Dashed line indicates equality. Linear correlation coefficient is <italic>ρ</italic> = 0.50. While steady-state rates are correctly predicted for most models, discrepancies arise due to limiting assumptions of the QR approximations when <italic>J</italic><sub><italic>r</italic></sub> ≫ 0 and <italic>J</italic><sub><italic>a</italic></sub> ≪ 0. However, the qualitative prediction of the dynamics as stable remains correct. (B) Observed versus predicted divergence times for all models classified as “fragile” in <xref ref-type="fig" rid="pcbi.1005390.g007">Fig 7</xref>. Note the logarithmic axes. Dashed line indicates diagonal. The QR approximation provides an approximation of the divergence times. The divergence time of a simulation was defined as the end of the first two-second interval in which the average rate exceeded <italic>λ</italic><sub><italic>thr</italic></sub>. Therefore, estimated divergence times cannot be below 2 s (gray area). The data suggest a power-law dependence between predicted and observed divergence times (Pearson’s correlation coefficient <italic>ρ</italic> = 0.94).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.g008" xlink:type="simple"/>
</fig>
<p>Finally, predicted and observed divergence times for all fragile models are well approximated by the QR approximation (<xref ref-type="fig" rid="pcbi.1005390.g008">Fig 8B</xref>) except for small divergence times whose estimation is biased due to the finite time window to detect divergence in numerical simulations.</p>
<p>In summary, the QR approximation yielded remarkably accurate predictions of the dynamical behavior of PP-GLMs for most parameter settings. When the steady-state rate was not accurately predicted for bursty neurons, the qualitative prediction was still consistent with simulations. For extreme parameter values, we observed intermittent burst activity that was incorrectly predicted to be divergent. Although not divergent according to the definition of <xref ref-type="fig" rid="pcbi.1005390.g003">Fig 3</xref>, the resulting spiking pattern would nevertheless be considered unphysiological and undesirable in modeling applications. Thus, in this case, the discrepancy between the QR prediction and the simulation does not play a significant role in practice.</p>
<p>So far, we have studied parametric spike-history filters in the form of a single exponential or sum of two exponential terms. In the next section, we will show that the validity of the QR approximation extends to physiological PP-GLM spike-history filters as they are typically obtained in the context of data-driven model estimation.</p>
</sec>
<sec id="sec006">
<title>The quasi-renewal approximation predicts stability for complex (physiologically plausible) model parameters</title>
<p>We applied the QR approximation to models estimated from actual neuronal recordings, specifically, multi-electrode single-unit recordings in monkey cortex (see “<xref ref-type="sec" rid="sec012">Materials and Methods</xref>”). Of the nonlinear Hawkes PP-GLMs estimated from 99 recorded single units, 11 were predicted to be stable, 86 were predicted as “fragile” with varying degrees of expected divergence times, and 2 were predicted to be divergent.</p>
<p>In all cases, the predictions were consistent with numerical simulations: For all models predicted to be stable, none of the <italic>N</italic> = 48 simulations of length <italic>T</italic> = 1000 s diverged (<inline-formula id="pcbi.1005390.e022"><alternatives><graphic id="pcbi.1005390.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>), and both divergent models showed finite divergence times (<inline-formula id="pcbi.1005390.e023"><alternatives><graphic id="pcbi.1005390.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mn>86</mml:mn> <mml:mspace width="2pt"/><mml:mtext>s</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005390.e024"><alternatives><graphic id="pcbi.1005390.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mspace width="2pt"/><mml:mtext>s</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula>, respectively). Fragile models did not diverge in our simulations of length <italic>T</italic> = 1000 s in 53 out of the 86 cases, while the other maximum-likelihood models diverged with varying degrees of observed divergence times (<inline-formula id="pcbi.1005390.e025"><alternatives><graphic id="pcbi.1005390.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mn>4</mml:mn> <mml:mo>-</mml:mo> <mml:mn>45</mml:mn> <mml:mspace width="0.166667em"/><mml:mn>000</mml:mn> <mml:mspace width="2pt"/><mml:mtext>s</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula>).</p>
<p>We examined in detail the stability predictions based on the QR approximation for a divergent neuron model in <xref ref-type="fig" rid="pcbi.1005390.g009">Fig 9</xref>. Spike-sorted single-unit activity (<xref ref-type="fig" rid="pcbi.1005390.g009">Fig 9A</xref>) was used to estimate a nonlinear Hawkes process with ten basis functions for the spike-history filter consisting of raised cosines [<xref ref-type="bibr" rid="pcbi.1005390.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref005">5</xref>]. The resulting maximum-likelihood estimate (MLE) displays a relative refractory period followed by an excitatory rebound (<xref ref-type="fig" rid="pcbi.1005390.g009">Fig 9B</xref>). The corresponding transfer function of the QR approximation shows a single stable fixed point close to the maximally allowed firing rate (<xref ref-type="fig" rid="pcbi.1005390.g009">Fig 9C</xref>). Therefore, this model is classified as divergent.</p>
<fig id="pcbi.1005390.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005390.g009</object-id>
<label>Fig 9</label>
<caption>
<title>The quasi-renewal approximation predicts stability for complex (physiologically plausible) model parameters.</title>
<p>(A) Single-unit activity (SUA) from multi-electrode recordings from monkey cortical area PMv [<xref ref-type="bibr" rid="pcbi.1005390.ref031">31</xref>] (same unit as in <xref ref-type="fig" rid="pcbi.1005390.g002">Fig 2C</xref>). Spike waveforms are shown (mean waveform in green) and indicate well-sorted SUA. (B) Estimated spike-history kernel using maximum-likelihood estimation. The kernel exhibits a relative refractory period followed by an excitatory rebound. (C) The transfer function predicted by the QR approximation. There is a single stable fixed point at ≈ 500 s<sup>−1</sup>. The model is therefore classified as “divergent”. (D) The QR approximation predicts the maximum-likelihood estimate (MLE) (center dot) to be divergent. Color indicates average divergence times in simulations for variations of the baseline rate <italic>c</italic> (y-axis) and scaled versions of the filter relative to the integral of <italic>e</italic><sup><italic>η</italic>(<italic>s</italic>)</sup> − 1 (x-axis). Thick lines indicate the separation between areas for which the QR approximation predicts stability, fragility, or divergence. Overall, estimated divergence times from simulations agree with the qualitative predictions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.g009" xlink:type="simple"/>
</fig>
<p>We then explored the neighboring parameter space by varying the baseline rate parameter <italic>c</italic> and using scaled versions of the MLE spike-history filter. The qualitative predictions (separated by thick lines in <xref ref-type="fig" rid="pcbi.1005390.g009">Fig 9D</xref>) were overall consistent with numerical simulations of the model (<xref ref-type="fig" rid="pcbi.1005390.g009">Fig 9D</xref>). Here, the color scale represents the estimated divergence time in simulations based on 48 independent simulations of <italic>T</italic> = 1000 s each.</p>
<p>In sum, the QR approximation not only predicted correctly the stability of the data-driven neurophysiological models, but also the stability of parameter variations around the MLE model.</p>
</sec>
<sec id="sec007">
<title>Neuron models can be stabilized with constrained maximum-likelihood estimation</title>
<p>We have shown that fitting PP-GLMs to electrophysiological data can lead to divergent and fragile models (Figs <xref ref-type="fig" rid="pcbi.1005390.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1005390.g009">9</xref>). The QR approximation not only offers a way to predict stability, but also to find stable models. As stated before, stability is an important feature when the goal is to sample from the model or to obtain data-driven models for simulations. Conceptually, we can constrain the parameter search for the maximum-likelihood solution to the parameter space for which the QR approximation predicts stable models. We will now provide a proof of concept of this approach by demonstrating how this constraint can be implemented in practice.</p>
<p>We search for the maximum-likelihood estimate (MLE) under the additional constraint that the model is predicted to be stable by the QR approximation. This can be implemented by minimizing the cost function consisting of the negative log-likelihood of the data plus a penalty term that is infinity whenever the model is predicted to be fragile or divergent and zero otherwise. We use a gradient-free numerical optimization scheme (see “<xref ref-type="sec" rid="sec012">Materials and Methods</xref>”). We initialize the parameter values with the unconstrained MLE for which all positive coefficients are set to zero. This corresponds to a non-positive spike-history filter and ensures that the initial evaluation of the cost function is finite. We call the constrained solution the “stabilized MLE”.</p>
<p>For illustration, in <xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10A</xref>, we use the same data from monkey electrophysiological recordings as in <xref ref-type="fig" rid="pcbi.1005390.g009">Fig 9</xref>. We find that the spike-history filter of the stabilized MLE resembles a regularized version of the (unconstrained) MLE (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10A</xref>), i.e., its coefficients are slightly biased towards zero. The MLE itself passes a goodness-of-fit test on training and test data and yields a substantial power in predicting spiking in 1 ms time bins (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10B–10D</xref>). However, sampling from the MLE leads to divergent and unphysiological spike trains (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10E</xref>). In contrast, sampling from the stabilized model yields firing rates comparable to the training data, and spike trains that are qualitatively similar (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10E</xref>).</p>
<fig id="pcbi.1005390.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005390.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Neuron models can be stabilized with constrained maximum-likelihood estimation.</title>
<p>(A) Estimated spike-history kernels using maximum-likelihood estimation (blue) and the constrained (stabilized) maximum-likelihood estimation (red). Data are from single-unit activity (SUA) recordings from monkey cortical area PMv [<xref ref-type="bibr" rid="pcbi.1005390.ref031">31</xref>]. (B) Power of predicting spiking activity on test data for both the maximum-likelihood estimate (MLE) and the stabilized MLE. The receiver operating characteristic (ROC) curve is shown for predicting spikes in 1 ms time bins with false positive rate (FP, x-axis) and true positive rates (TP, y-axis). Diagonal line indicates chance-level prediction. Predictive power is defined as PP = 2 ⋅ AUC − 1 with AUC being the area under the curve. Perfect spike prediction corresponds to PP = 1. Both models predict spikes equally well. (C) Log-likelihood evaluated on test data. Both MLE and stabilized MLE models preserve information about spike times. Model log-likelihoods (in bits per second) are relative to a homogeneous Poisson process with the correct spiking rate. (D) Kolmogorov-Smirnov test of rescaled inter-spike intervals following the time-rescaling theorem. Both MLE and the stabilized MLE pass the goodness-of-fit test (<italic>P</italic> &gt; 0.05). (E) Recorded spike trains and simulated spike trains from estimated models. Top: Randomly selected 10 s intervals of neural activity part of the training data (black). Simulating from the unconstrained MLE model (blue) leads to quickly diverging firing rates (<italic>T</italic><sub>div</sub> ≈ 10 s). Spiking activity from the stabilized MLE (red) remains finite and physiological. Simulating from the MLE with a reset condition after each spike (green, [<xref ref-type="bibr" rid="pcbi.1005390.ref034">34</xref>]) leads to non-divergent firing rates, but the firing rate of the training data is not matched. (F) Inter-spike interval statistics of real and simulated spiking activity for which rates were non-divergent. Same colors as in (D). The stabilized MLE qualitatively reproduces the training data ISI distribution. (G) Autocorrelation of recorded and simulated activity. (H) Serial ISI correlations of real and simulated spiking activity. The stabilized MLE accurately reproduces correlations in the training data. Simulating the MLE with a reset condition (green) leads to a renewal process, hence vanishing correlations at non-zero lags.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.g010" xlink:type="simple"/>
</fig>
<p>We quantified similarity of spike train statistics up to second order using the inter-spike interval (ISI) distribution (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10F</xref>) and spike train auto-correlation function (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10G</xref>). We evaluated the spiking pattern using three metrics (local ISI variability <italic>lv</italic>, shape (log <italic>κ</italic>) and scale parameter (log <italic>α</italic>) of the best-fitting Gamma distribution, following the methodology presented in [<xref ref-type="bibr" rid="pcbi.1005390.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref036">36</xref>]. Our data from monkey region PMv are consistent with reported values in [<xref ref-type="bibr" rid="pcbi.1005390.ref036">36</xref>, Table 1, row 15]: <italic>lv</italic><sup>(data)</sup> = 0.54 ± 0.18, log <italic>κ</italic><sup>(data)</sup> = 0.80 ± 0.38, log <italic>α</italic><sup>(data)</sup> = 3.16 ± 0.26 (mean ± standard deviation over segments of 20 consecutive ISIs). Metrics for spike trains generated from the stabilized MLE model are well aligned to those of the physiological data: <italic>lv</italic><sup>(stab.MLE)</sup> = 0.66 ± 0.22, log <italic>κ</italic><sup>(stab.MLE)</sup> = 0.69 ± 0.35, and log <italic>α</italic><sup>(stab.MLE)</sup> = 3.26 ± 0.26. In addition, the spike trains generated from the stabilized MLE also reproduce the serial correlations between consecutive ISIs in the physiological data (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10H</xref>).</p>
<p>Although this was not a direct optimization criterion, the stabilized MLE is almost as good in predicting spiking activity in 1 ms time bins conditioned on observed spiking history as the MLE (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10B</xref>) and scores only marginally worse on the goodness-of-fit tests (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10D</xref>). The cross-validated log-likelihood of the stabilized model is within 80% of the log-likelihood score of the MLE (2.43 bits/s versus 2.90 bits/s relative to the prediction of a homogeneous Poisson process with correct spiking rate, <xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10C</xref>).</p>
<p>Spike train statistics were not shown for the MLE because physiological spike trains could not be obtained. However, we explored the possibility of a simple modification in the simulation procedure for the MLE solution that guarantees stability of the generated spike train. In the “reset condition” [<xref ref-type="bibr" rid="pcbi.1005390.ref034">34</xref>], the conditional intensity of the point process at time <italic>t</italic> is not calculated using the original CIF (<xref ref-type="disp-formula" rid="pcbi.1005390.e005">Eq (3)</xref>) but instead using only the spike-history effect stemming from the most recent spike at <inline-formula id="pcbi.1005390.e026"><alternatives><graphic id="pcbi.1005390.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>:</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. This yields a renewal process with guaranteed finite rate in simulations.</p>
<p>We found that models simulated with the reset condition do produce finite firing rates and spike trains that look plausible on first sight (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10D</xref>). However, the firing rate and autocorrelation function are not matched with the training data. Most notably, neither ISI shape (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10F and 10G</xref>, green line; <italic>lv</italic><sup>(reset)</sup> = 0.72 ± 0.21, log <italic>κ</italic><sup>(reset)</sup> = 0.51 ± 0.31, log <italic>α</italic><sup>(reset)</sup> = 2.57 ± 0.20) nor ISI correlations are reproduced due to the renewal property of the modified model (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10H</xref>, green line).</p>
</sec>
</sec>
<sec id="sec008" sec-type="conclusions">
<title>Discussion</title>
<p>We have presented a framework to predict the stability and dynamics of a general class of stochastic neural point process models, specifically nonlinear Hawkes processes and point process GLMs. This framework is based on a quasi-renewal approximation of the exact conditional intensity function model. The assessment of stability can serve as an additional goodness-of-fit test along with other approaches, such as tests based on the time-rescaling theorem. We have also shown that simulated activity from point-process models estimated from neurophysiological data tends to exhibit unphysiologically high firing rates. This behavior results from lacking stochastic stability of the estimated PP-GLMs. When sampling and simulations based on these PP-GLMs is desired, our framework can be used to derive stability constraints which can be included into standard parameter estimation techniques such as (regularized) maximum-likelihood optimization. Furthermore, our framework provides a way to determine and classify the qualitative types of stochastic dynamics exhibited by PP-GLMs, specifically nonlinear Hawkes processes with absolute refractory periods.</p>
<p>Empirically, we have shown that many point-process GLMs estimated from neurophysiological data tend to show fragile or even divergent dynamics. Several reasons could explain this finding. One potential scenario is that of the actual recorded neural dynamics being close to instability. Even assuming a correctly specified model, finite data will lead to finite variance in the parameter sets estimated via maximum likelihood. If the true parameters are close to the boundary between stability and divergence, the estimated MLE from finite data may lie in the unstable (divergent) region of the parameter space. In this way, the simulated model would show qualitatively different dynamics than the underlying data set from which it was derived (i.e., it would diverge).</p>
<p>Another potential reason is the extent of model misspecification. Constraining the true data-generating process into the form of the nonlinear Hawkes process, as assumed here, might bias the parameter estimation towards the parameter space for which model dynamics is unstable. An example for such model misspecification are non-stationary firing rates. In the present models, we assumed a constant baseline firing rate. Maximum-likelihood estimates have shown to be systematically biased if the non-stationarity is not accounted for in the model [<xref ref-type="bibr" rid="pcbi.1005390.ref037">37</xref>]. Detecting and accounting for non-stationarity in neuronal spiking data is, however, a nontrivial task. The stability framework proposed here can be used as a tool for complementary analyses in this regard.</p>
<p>The quasi-renewal approximation can be used alongside other goodness-of-fit tests to assess model adequacy. It would be a reasonable demand for a model to be classified as stable or fragile with high expected divergence times if it is to be used within the context of simulations or closed-loop applications. Even outside the context of simulations, a model classified as divergent is failing a goodness-of-fit test as it is not able to reproduce the statistics of the training data. Conversely, a model classified as stable might produce finite steady-state firing rates but may still fail with regards to other statistics of the training data, such as first- and second-order firing statistics, interval correlations, or burst properties. Our work exemplifies that it is important to check goodness-of-fit using a comprehensive battery of tests to check for different types of model misspecifications.</p>
<p>The derivation of the quasi-renewal approximation involves a series expansion which here we truncated after the first order. As it was previously stated, this approximation becomes less valid with non-vanishing second- and higher-order spike-spike correlations [<xref ref-type="bibr" rid="pcbi.1005390.ref026">26</xref>]. This is the case, e.g., for strongly bursting neurons. We have observed these limitations in the exploration of the parameter space over which the QR approximation is valid (Figs <xref ref-type="fig" rid="pcbi.1005390.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1005390.g007">7</xref>). In principle, second- and higher-order correlation terms can be included in the expansion. In particular, Naud et al. [<xref ref-type="bibr" rid="pcbi.1005390.ref026">26</xref>] truncate the series after the second order. In this case, a self-consistent solution has to be found in terms of the steady-state firing rate and the steady-state spike train auto-correlation.</p>
<p>An additional limitation is inherent to the reduction of the spiking dynamics to a one-dimensional description of a transfer or gain function. For high firing rates, spike trains are constrained by the absolute refractory period and exhibit strong regularity. The transfer function can be qualitatively different when point process histories are assumed to be periodic spike trains of a particular rate rather than homogeneous Poisson-like firing with vanishing higher-order correlations. Hence, the description of the dynamics using a single transfer functions becomes less valid for high firing rates. In practice, this happens when activity diverges beyond which the usefulness of the QR approximation becomes limited.</p>
<sec id="sec009">
<title>Relaxing assumptions and extensions</title>
<p>We now discuss possible relaxing assumptions and extensions to the quasi-renewal framework to assess stability and dynamics of neural point process models.</p>
<p>First, the ability to separate the effect of the most recent spike from all previous spikes and to use the moment-generating functional are unique to the exponential nonlinearity. Possibly, for other specific choices of the nonlinearity a similar manipulation or approximation of <xref ref-type="disp-formula" rid="pcbi.1005390.e037">Eq (11)</xref> may be conceivable, or the firing rate transfer function may be estimated by numerical simulation of the model. However, we consider such an extension of the theory beyond the scope of the present work. Using a different nonlinearity will likely require to invoke some type of Lipschitz condition and alternative ways of studying the stability properties (see, e.g., [<xref ref-type="bibr" rid="pcbi.1005390.ref009">9</xref>]).</p>
<p>Second, the nonlinear Hawkes process can be formulated as a multivariate process to describe an ensemble of coupled neurons [<xref ref-type="bibr" rid="pcbi.1005390.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref021">21</xref>]. The corresponding extension of the quasi-renewal framework is possible [<xref ref-type="bibr" rid="pcbi.1005390.ref027">27</xref>] and may be used to study stability of such networks of heterogeneous neurons. Local linear stability analysis of derived fixed points for the neuronal network dynamics can then be readily implemented based on the spectral radius of a coupling matrix (obtained from coupling coefficients, history filters’ integrals, and the nonlinearity’s first derivative) computed at the fixed point locations [<xref ref-type="bibr" rid="pcbi.1005390.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref021">21</xref>].</p>
<p>Third, we assumed no (time-varying) exogenous input. The framework can be easily extended to accommodate non-stationary inputs, such as stimulus drive, by allowing the baseline firing rate <italic>c</italic> in <xref ref-type="disp-formula" rid="pcbi.1005390.e005">Eq (3)</xref> to be time-dependent and performing the QR stability analysis for the supremum of <italic>c</italic> as long as such a bound exists. If stability is predicted for this dominating model, the model with time-varying exogeneous input will be stable as long as the exogeneous drive is independent of the firing rate of the neuron itself [<xref ref-type="bibr" rid="pcbi.1005390.ref021">21</xref>]. This generalization allows the stability analysis to be performed, e.g., for state-space models such as linear dynamic systems with conditionally Poisson observations, where spike-history effects are combined with neural couplings to a low-dimensional latent state whose dynamics is stable itself [<xref ref-type="bibr" rid="pcbi.1005390.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref038">38</xref>–<xref ref-type="bibr" rid="pcbi.1005390.ref042">42</xref>].</p>
<p>Fourth, throughout this study, we assumed an absolute refractory period of 2 ms. Because the absolute length of such a refractory period does not impact the theoretical analysis, a refractory period of arbitrary length may be used. Although the existence of refractory periods is pervasive in most physical applications, the assumption of an absolute refractory period might not be justified in some cases. The refractory period leads to a finite support of the transfer function and a bounded firing rate. In the limit of a vanishing refractory period, there might be additional alignments of fixed points to those outlined in <xref ref-type="fig" rid="pcbi.1005390.g003">Fig 3</xref>, such as a single stable and a single unstable fixed point, which can be similarly classified into stable, fragile, and divergent dynamics.</p>
<p>Finally, we provided an approximation of the divergence time for fragile, metastable models. A more direct estimation of the divergence time seems desirable. One alternative to estimate the divergence time would be a fluctuation analysis in analogy to Brownian motion in a potential. In this case, the divergence time would correspond to the escape time of the particle from the potential given around the low-rate stable fixed point. In first order, noise in this process may be described by white noise, scaled with an intensity that should be proportional (if not equal) to the square root of the rate (Poisson statistics). A more insightful or useful estimate of the fluctuations may also be derived from the power spectral density of the activity in the metastable state [<xref ref-type="bibr" rid="pcbi.1005390.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref043">43</xref>]. Alternatively, a periodic perturbation approach as in [<xref ref-type="bibr" rid="pcbi.1005390.ref007">7</xref>] may be attempted to calculate the time scales of expected divergences.</p>
</sec>
<sec id="sec010">
<title>Alternative stabilization methods</title>
<p>We provided a proof-of-principle of how our proposed quasi-renewal framework can be incorporated into a maximum-likelihood parameter estimation procedure in order to guarantee the stability of models estimated from physiological data. We saw that the ordinary MLE provided unphysiological spike trains while the stabilized version matched first- and second-order statistics of the training data with only marginal loss in predictive power and goodness-of-fit scores.</p>
<p>In our current implementation, we maximize the likelihood of the model under the constraint that the model is predicted to be stable by the QR approximation. The determination of stability based on the number and location of fixed points—essentially a bifurcation analysis—consists of multiple steps and is highly nonlinear. We were not able to differentiate the penalty term to exploit more efficient gradient-based optimization schemes. However, empirically, we have observed that the space of admissible parameters seems to form a single connected, possibly even convex, set. From a computational point of view, the determination of stability involves one-dimensional (scalar) arithmetic that allows fast evaluation of many candidate parameter sets during the optimization procedure. If necessary, additional speed-ups could be obtained by parallelizing the computation of the penalty term when evaluating different local search directions.</p>
<p>We restricted the attainable parameter space to all models that are classified as stable, thereby explicitly excluding fragile models with long expected divergence times. In practice, stable models and fragile models are both candidates for physiological dynamics as long as simulation times are shorter than typical divergence times. Therefore, a more refined cost function than the one used here (see <xref ref-type="disp-formula" rid="pcbi.1005390.e087">Eq (35)</xref>) could involve a penalty proportional to the expected divergence rate E[<italic>T</italic><sub>div</sub>]<sup>−1</sup>, weighted by a corresponding regularization parameter. The calculation of the expected divergence rate is more computationally expensive than the determination of stability itself but would provide a continuous and potentially smooth penalty function that could be superior to the all-or-nothing penalty term of the proposed optimization scheme.</p>
<p>Alternatively, a computationally efficient regularization is the L1-regularized maximum-likelihood estimate. It provides a convex optimization problem that can be efficiently solved [<xref ref-type="bibr" rid="pcbi.1005390.ref044">44</xref>–<xref ref-type="bibr" rid="pcbi.1005390.ref046">46</xref>]. For stronger regularization parameters, estimated coefficients tend towards zero. Nonlinear Hawkes processes with vanishing spike-history filter (coefficients tending towards zero) are always stable. This implies the existence of an optimally L1-regularized solution that is predicted to be stable. Therefore, strong L1-regularization might be an alternative approach to model stabilization.</p>
<p>In addition, a more parametric description of the spike-history kernel could facilitate stability. For example, the addition of an adapting (inhibitory) power-law component is likely to prevent any runaway-excitation and has been observed experimentally under certain conditions [<xref ref-type="bibr" rid="pcbi.1005390.ref017">17</xref>]. A parametric form like this will have to be accompanied by model selection and appropriate goodness-of-fit tests.</p>
<p>A simple way to ensure stability of nonlinear Hawkes processes in simulations is to implement a “reset condition” following each spike when the previous spiking history is forgotten. This leads to a renewal process with a well-defined stationary and unique solutions [<xref ref-type="bibr" rid="pcbi.1005390.ref047">47</xref>]. However, by definition, second-order statistics such as ISI correlations cannot be reproduced and spike trains generated with this condition are not realizations from the original nonlinear Hawkes model. Nevertheless, it might be an easy fix in certain applications where stable network simulations are desired without explicitly reproducing physiological spike train statistics [<xref ref-type="bibr" rid="pcbi.1005390.ref034">34</xref>].</p>
<p>Finally, we note that while previous work in the mathematical domains covers uniqueness and existence theorems for stationary point processes [<xref ref-type="bibr" rid="pcbi.1005390.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref021">21</xref>], it does not provide predictions of dynamics, metastability, or whether steady-state rates are in a physiological regime. In the case of Lipschitz-continuous nonlinearities, existing conditions for stability are overly conservative and of little relevance for neurophysiologically plausible spike-history filters. We are currently working on relaxations of these conditions that would allow easier characterizations of stability of neuron models and neuronal networks, and we hope to report such results in the future.</p>
</sec>
<sec id="sec011">
<title>Importance of stable point process models for applications</title>
<p>The ability to predict stochastic stability of a given point process model has merit in its own right and is therefore a main contribution of our study. While stability in simulations is neither a necessary nor sufficient condition for the model fitting procedure itself, and a trade-off between stability constraints and other standard regularized MLE approaches should be considered case by case, data-driven models that are guaranteed to be stable are of major importance for many applications. We will conclude by giving a few examples.</p>
<p>First, to understand brain circuits may mean to be able to rebuild them using artificial components. PP-GLMs offer a direct and relatively well-understood method to derive neuron models from data. But their use in rebuilding brain circuits in simulation is limited if stochastic stability is uncertain. For the simple example of a PP-GLM fit of a neuronal network with an embedded “synfire chain”, Zaytsev et al. ensured stability of the network by adding a reset mechanism of the membrane after each spike to prevent run-away excitation [<xref ref-type="bibr" rid="pcbi.1005390.ref034">34</xref>].</p>
<p>Second, PP-GLMs are used in the context of (closed-loop) brain machine interfaces. Present-day experiments may interface brain tissue to virtual actuators that in turn provide feedback signals to the brain (e.g., [<xref ref-type="bibr" rid="pcbi.1005390.ref048">48</xref>]). Future applications of such technology may replace damaged neural tissue by simulated neural circuits which are connected bidirectionally to the brain. Such circuits could potentially be made using PP-GLMs or related models, fitted to the system that is being substituted. Stability of the model is essential in this case to exclude major system malfunction.</p>
<p>A final application is to make spike-timing predictions from neuron models: Given parallel recordings of neuronal activity, precise timing of single spikes can already be predicted using PP-GLMs [<xref ref-type="bibr" rid="pcbi.1005390.ref005">5</xref>]. However, such predictions have been limited to the very near future (on the order of milliseconds), but typically cannot be used for extended time differences into the future because of model instability. Ensuring stability of PP-GLMs potentially extends the time horizon of spike timing prediction. This may enable applications in epilepsy treatment, seismology, finance, and other fields that study self-exciting dynamical processes.</p>
</sec>
</sec>
<sec id="sec012" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec013">
<title>Ethics statement</title>
<p>For the non-human primate data, all procedures were in accordance with Brown University Institutional Animal Care and Use Committee approved protocols and the Guide for the Care and Use of Laboratory Animals. Approval for the human studies was granted by local Institutional Review Boards (Partners Human Research Committee, Massachusetts General Hospital, Harvard Medical School), and the participant was enrolled after obtaining informed consent.</p>
</sec>
<sec id="sec014">
<title>Experimental details</title>
<p>Full experimental details for the electrophysiological data from the crab can be found in [<xref ref-type="bibr" rid="pcbi.1005390.ref006">6</xref>], for the non-human primate data in [<xref ref-type="bibr" rid="pcbi.1005390.ref031">31</xref>], and for the human data in [<xref ref-type="bibr" rid="pcbi.1005390.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref049">49</xref>].</p>
</sec>
<sec id="sec015">
<title>The nonlinear Hawkes process</title>
<p>The nonlinear Hawkes process is a flexible class of self-exciting and/or self-inhibiting point process models [<xref ref-type="bibr" rid="pcbi.1005390.ref009">9</xref>]. For a stochastic point process, the conditional intensity function is given by [<xref ref-type="bibr" rid="pcbi.1005390.ref010">10</xref>]:
<disp-formula id="pcbi.1005390.e027"><alternatives><graphic id="pcbi.1005390.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mrow><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mo>→</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mtext>spike</mml:mtext> <mml:mspace width="0.166667em"/><mml:mtext>in</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
where <inline-formula id="pcbi.1005390.e028"><alternatives><graphic id="pcbi.1005390.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the history of the process (i.e., all <italic>K</italic> spikes at times <italic>t</italic><sub><italic>k</italic></sub> up to time <italic>t</italic>).</p>
<p>In the nonlinear Hawkes model, <inline-formula id="pcbi.1005390.e029"><alternatives><graphic id="pcbi.1005390.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mi>λ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is assumed to take the following form:
<disp-formula id="pcbi.1005390.e030"><alternatives><graphic id="pcbi.1005390.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mrow><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mo>[</mml:mo> <mml:mi>η</mml:mi> <mml:mo>*</mml:mo> <mml:mi>S</mml:mi> <mml:mo>]</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mspace width="1pt"/><mml:mfenced close=")" open="(" separators=""><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
where <inline-formula id="pcbi.1005390.e031"><alternatives><graphic id="pcbi.1005390.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:mo>:</mml:mo> <mml:mspace width="1pt"/> <mml:mi mathvariant="double-struck">R</mml:mi> <mml:mo>→</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is a nonlinearity that maps the convolution of the spike train <italic>S</italic> with a causal auto-history kernel <inline-formula id="pcbi.1005390.e032"><alternatives><graphic id="pcbi.1005390.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:mi>η</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> onto a non-negative conditional intensity <inline-formula id="pcbi.1005390.e033"><alternatives><graphic id="pcbi.1005390.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:mi>λ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Here, we consider <italic>ϕ</italic>(<italic>x</italic>) = <italic>c</italic> exp(<italic>x</italic>) = exp(<italic>I</italic><sub>0</sub> + <italic>x</italic>) with <italic>c</italic> = exp(<italic>I</italic><sub>0</sub>) &gt; 0. The exponential nonlinearity implies that modulations from previous spikes interact in a multiplicative way [<xref ref-type="bibr" rid="pcbi.1005390.ref050">50</xref>]. The choice for the exponential nonlinearity has both theoretical [<xref ref-type="bibr" rid="pcbi.1005390.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref007">7</xref>] and empirical support, e.g., from electrophysiological experiments [<xref ref-type="bibr" rid="pcbi.1005390.ref051">51</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref052">52</xref>]. We only consider the single-neuron (univariate) case although nonlinear Hawkes processes can be similarly defined for coupled neuronal ensembles with the corresponding matrix of auto- and cross-history kernels <italic>η</italic><sub><italic>ij</italic></sub>(<italic>s</italic>).</p>
<p>Furthermore, we assume constant exogenous input, i.e., <italic>c</italic> ≡ <italic>const</italic>. For time-varying inputs <italic>c</italic>(<italic>t</italic>) or other (potentially non-stationary) exogenous inputs, a conservative stability analysis can be performed by using <italic>c</italic><sub>sup</sub> = sup <italic>c</italic>(<italic>t</italic>) as long as such a bound exists.</p>
<p>Hence, the stochastic process is completely determined by two parameters: <italic>c</italic> (or equivalently <italic>I</italic><sub>0</sub>) and the causal auto-history kernel <italic>η</italic>(<italic>s</italic>).</p>
<p>To simplify analysis, we make certain assumptions about <italic>η</italic>(<italic>s</italic>). One is the introduction of an absolute refractory period <italic>τ</italic><sub>ref</sub> which indicates that the next spike can occur no closer than <italic>τ</italic><sub>ref</sub> to the last spike. It can be modeled by setting <italic>η</italic>(<italic>s</italic>) = −∞ for <italic>s</italic> &lt; <italic>τ</italic><sub>ref</sub>. Given that action potentials, the events that are modeled with the point process model, have an extent of around 1 ms, we assume <italic>τ</italic><sub>ref</sub> = 2 ms.</p>
</sec>
<sec id="sec016">
<title>Quasi-renewal approximation</title>
<p>In the nonlinear Hawkes model, the effects of previous spikes can accumulate. This leads, in general, to a non-renewal process. For this specific class of point process models, there are no closed-form formulas to predict mean intensities, inter-spike interval (ISI) distributions, power spectra, or other properties of the process. We are interested in whether a nonlinear Hawkes process with given parameters permits stable, finite steady-state firing rates.</p>
<p>To make progress, we need to approximate <xref ref-type="disp-formula" rid="pcbi.1005390.e030">Eq (10)</xref>. Our approach is based on the recently introduced quasi-renewal approximation [<xref ref-type="bibr" rid="pcbi.1005390.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref027">27</xref>]. To obtain an estimate of the mean rate of the process <italic>A</italic><sub>0</sub>, we average <inline-formula id="pcbi.1005390.e034"><alternatives><graphic id="pcbi.1005390.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:mi>λ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> over all possible spike trains <italic>S</italic>(<italic>t</italic>) prior to the last spike <inline-formula id="pcbi.1005390.e035"><alternatives><graphic id="pcbi.1005390.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1005390.e036"><alternatives><graphic id="pcbi.1005390.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow> <mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi> <mml:mspace width="0.166667em"/><mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msub><mml:mrow><mml:mo>〈</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>η</mml:mi> <mml:mo>*</mml:mo> <mml:mi>S</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow> <mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We identify the second term with the moment-generating functional of <italic>S</italic> that can be expanded in a series of moments [<xref ref-type="bibr" rid="pcbi.1005390.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005390.ref053">53</xref>] which we truncate after the first order:
<disp-formula id="pcbi.1005390.e037"><alternatives><graphic id="pcbi.1005390.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mi>c</mml:mi> <mml:mspace width="0.166667em"/><mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>η</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:munder accentunder="true"><mml:msub><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow> <mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>︸</mml:mo></mml:munder> <mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:munder> <mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
with <inline-formula id="pcbi.1005390.e038"><alternatives><graphic id="pcbi.1005390.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow> <mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> being the first moment of the averaged spike train, which corresponds to a constant by assuming stationarity. <italic>A</italic><sub>0</sub> is the steady-state firing rate which for now remains unknown.</p>
<p>We can rewrite the integration bounds and introduce <inline-formula id="pcbi.1005390.e039"><alternatives><graphic id="pcbi.1005390.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:mi>τ</mml:mi> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> as the time since the last spike to obtain:
<disp-formula id="pcbi.1005390.e040"><alternatives><graphic id="pcbi.1005390.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mspace width="0.166667em"/><mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>τ</mml:mi></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:munder><mml:munder accentunder="true"><mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>η</mml:mi> <mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mi>γ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>u</mml:mi></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
with <italic>γ</italic>(<italic>u</italic>) = <italic>e</italic><sup><italic>η</italic>(<italic>u</italic>)</sup> − 1 for the exponentiated kernel and <inline-formula id="pcbi.1005390.e041"><alternatives><graphic id="pcbi.1005390.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>u</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Γ is used in the rescaling of the filter for the analysis presented in <xref ref-type="fig" rid="pcbi.1005390.g009">Fig 9</xref>.</p>
<p>Using the quasi-renewal (QR) conditional intensity of <xref ref-type="disp-formula" rid="pcbi.1005390.e040">Eq (12)</xref>, we obtain the steady-state survivor function <inline-formula id="pcbi.1005390.e042"><alternatives><graphic id="pcbi.1005390.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula> and inter-spike interval (ISI) density <italic>P</italic><sub>0</sub> as:
<disp-formula id="pcbi.1005390.e043"><alternatives><graphic id="pcbi.1005390.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>u</mml:mi></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
<disp-formula id="pcbi.1005390.e044"><alternatives><graphic id="pcbi.1005390.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
which, in turn, predict the firing rate:
<disp-formula id="pcbi.1005390.e045"><alternatives><graphic id="pcbi.1005390.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mfenced close="]" open="[" separators=""><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mi>τ</mml:mi> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>τ</mml:mi></mml:mfenced> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula>
Because <inline-formula id="pcbi.1005390.e046"><alternatives><graphic id="pcbi.1005390.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>τ</mml:mi></mml:mrow></mml:mfrac> <mml:msub><mml:mi>S</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and integrating by parts:
<disp-formula id="pcbi.1005390.e047"><alternatives><graphic id="pcbi.1005390.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>τ</mml:mi><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>τ</mml:mi><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:mtext> </mml:mtext></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula>
which is continuous and differentiable in <italic>A</italic><sub>0</sub>.</p>
</sec>
<sec id="sec017">
<title>Stability based on the transfer function</title>
<p><xref ref-type="disp-formula" rid="pcbi.1005390.e047">Eq (16)</xref> defines an average input-output mapping for the single neuron, known as transfer or gain function, which maps an assumed mean input rate <italic>A</italic><sub>0</sub> to the mean output rate of the process <italic>f</italic>(<italic>A</italic><sub>0</sub>). The dynamics of the model can be characterised based on the properties of the transfer function. Fixed points of this map, <inline-formula id="pcbi.1005390.e048"><alternatives><graphic id="pcbi.1005390.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, can be locally stable or unstable. To detect the fixed points reliably, we search for the zero crossings of the function <italic>g</italic>(<italic>A</italic><sub>0</sub>) = <italic>f</italic>(<italic>A</italic><sub>0</sub>) − <italic>A</italic><sub>0</sub>.</p>
<p>A fixed point <inline-formula id="pcbi.1005390.e049"><alternatives><graphic id="pcbi.1005390.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula> is locally stable if <inline-formula id="pcbi.1005390.e050"><alternatives><graphic id="pcbi.1005390.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:msup><mml:mi>g</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and unstable if <inline-formula id="pcbi.1005390.e051"><alternatives><graphic id="pcbi.1005390.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:msup><mml:mi>g</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Based on the number and location of fixed points of the mean firing rate map (<xref ref-type="disp-formula" rid="pcbi.1005390.e047">Eq (16)</xref>) we can then classify the model (see <xref ref-type="sec" rid="sec002">Results</xref>).</p>
</sec>
<sec id="sec018">
<title>Prediction of divergence rate for fragile models</title>
<p>For fragile (metastable) models, we may ask whether there is an inter-spike interval <italic>x</italic>, which if several spikes occur repeatedly with this interval, causes a divergence of the firing rate. If such an <italic>x</italic> exists, we can compute the probability of this event. Although other routes to a divergent rate are possible, this one yields an explicit value for its rate of occurrence and can be used as a lower bound for the divergence rate of a metastable model.</p>
<p>Let <italic>t</italic><sub>1</sub> be the time of a spike of the process. Then the next spike occurs within the interval <italic>x</italic> with probability <inline-formula id="pcbi.1005390.e052"><alternatives><graphic id="pcbi.1005390.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi mathvariant="script">S</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1005390.e053"><alternatives><graphic id="pcbi.1005390.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> is the survivor function. We may now iterate this argument to compute the probability that, following <italic>t</italic><sub>1</sub>, there is a sequence of <italic>K</italic> spikes with intervals smaller or equal to <italic>x</italic>, as:
<disp-formula id="pcbi.1005390.e054"><alternatives><graphic id="pcbi.1005390.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e054" xlink:type="simple"/><mml:math display="block" id="M54"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="1pt"/><mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="1pt"/><mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>…</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="1pt"/><mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mo>︸</mml:mo></mml:munder></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
To evaluate <xref ref-type="disp-formula" rid="pcbi.1005390.e054">Eq (17)</xref> and compute <inline-formula id="pcbi.1005390.e055"><alternatives><graphic id="pcbi.1005390.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula>, we need to approximate the intensity function <inline-formula id="pcbi.1005390.e056"><alternatives><graphic id="pcbi.1005390.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mrow><mml:mi>λ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for the case that up to <italic>t</italic><sub>1</sub> we do not have information about the spike history apart from the rate <italic>A</italic><sub>0</sub>, but from <italic>t</italic><sub>1</sub> on it is defined as the regular firing case with spike times <italic>t</italic><sub><italic>k</italic></sub> = <italic>t</italic><sub>1</sub> + (<italic>k</italic> − 1)<italic>x</italic> for <italic>k</italic> ≥ 1. This gives rise to a similar quasi-renewal approximation as for <xref ref-type="disp-formula" rid="pcbi.1005390.e040">Eq (12)</xref>:
<disp-formula id="pcbi.1005390.e057"><alternatives><graphic id="pcbi.1005390.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mo>〈</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi><mml:mtext> exp</mml:mtext><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:mrow><mml:mtext> </mml:mtext><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mo>〈</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>η</mml:mi><mml:mo>*</mml:mo><mml:mi>S</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>≈</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi><mml:mtext> exp</mml:mtext><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:mrow><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mtext> exp</mml:mtext><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi><mml:mtext> exp</mml:mtext><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:mrow><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mtext> </mml:mtext></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mtext> exp</mml:mtext><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:mtext> </mml:mtext></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
Inserted into <xref ref-type="disp-formula" rid="pcbi.1005390.e054">Eq (17)</xref>, we then first check whether the sequence <italic>p</italic>(<italic>x</italic>, <italic>k</italic>) increases monotonically towards 1, setting <italic>t</italic><sub>1</sub> = 0. If for a given <italic>k</italic> we have <italic>p</italic>(<italic>x</italic>, <italic>k</italic>) &gt; <italic>p</italic>(<italic>x</italic>, <italic>k</italic> + 1), we terminate the iteration because <italic>x</italic> does not seem to lead to the regular divergence and return <italic>p</italic><sub>reg</sub> = 0. If, in contrast, for some value of <italic>k</italic>, <italic>p</italic>(<italic>x</italic>, <italic>k</italic>) is close to 1, we have found a divergent case that occurs with probability <italic>p</italic><sub>reg</sub>(<italic>x</italic>), as given by <xref ref-type="disp-formula" rid="pcbi.1005390.e054">Eq (17)</xref> with <italic>K</italic> = <italic>k</italic>.</p>
<p>This procedure is performed for all <inline-formula id="pcbi.1005390.e058"><alternatives><graphic id="pcbi.1005390.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and the maximum max<sub><italic>x</italic></sub> <italic>p</italic><sub>reg</sub>(<italic>x</italic>) is returned. As <italic>p</italic><sub>reg</sub>(<italic>x</italic>) is the probability of the regular divergence with intervals <italic>x</italic> or shorter to occur after any spike of the process, the rate of divergence is thus bounded from below by:
<disp-formula id="pcbi.1005390.e059"><alternatives><graphic id="pcbi.1005390.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mtext>div</mml:mtext></mml:msub> <mml:mo>≥</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mi>x</mml:mi></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mtext>reg</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(19)</label></disp-formula>
This provides an upper bound for <inline-formula id="pcbi.1005390.e060"><alternatives><graphic id="pcbi.1005390.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mtext>div</mml:mtext></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec019">
<title>Bursting and the regular spiking limit</title>
<p>Apart from the dynamic stability that we have discussed so far, a particular limit of the space of possible spike trains is of special interest. In case of a divergent firing rate, which occurs in unstable or fragile models, the analysis of the gain function predicts that the firing rate saturates at the limit given by the inverse of the refractory period, <inline-formula id="pcbi.1005390.e061"><alternatives><graphic id="pcbi.1005390.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. However, there is only one spike train that can realize this firing rate, which is the regular spike train:
<disp-formula id="pcbi.1005390.e062"><alternatives><graphic id="pcbi.1005390.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e062" xlink:type="simple"/><mml:math display="block" id="M62"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>∞</mml:mi></mml:munderover> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(20)</label></disp-formula>
with inter-spike-interval <italic>x</italic> = <italic>τ</italic><sub>ref</sub>. Here <italic>θ</italic> denotes the Heaviside function and <italic>δ</italic> denotes the Dirac delta function.</p>
<p>For the regular spike train <italic>S</italic><sub><italic>x</italic></sub>, with <italic>x</italic> &gt; <italic>τ</italic><sub>ref</sub> being close to the refractory period, to be a possible mode of firing of the model, it is necessary that the conditional intensity of the neuron (<xref ref-type="disp-formula" rid="pcbi.1005390.e030">Eq (10)</xref>), evaluated at time <italic>x</italic> after the last spike (at <italic>t</italic> − <italic>x</italic>),
<disp-formula id="pcbi.1005390.e063"><alternatives><graphic id="pcbi.1005390.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e063" xlink:type="simple"/><mml:math display="block" id="M63"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(21)</label></disp-formula>
reaches a sufficiently high value, so that the rate <italic>x</italic><sup>−1</sup> can be maintained, when the regular spike train extends into the past forever, <inline-formula id="pcbi.1005390.e064"><alternatives><graphic id="pcbi.1005390.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mtext>reg</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>→</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. But what precisely is that sufficiently high value of <italic>λ</italic><sub>reg</sub>? Since after <italic>τ</italic><sub>ref</sub> the refractory period is over, and because the conditional intensity changes approximately on the time scale of the filter <italic>η</italic> that is much greater than the remaining interval <italic>x</italic> − <italic>τ</italic><sub>ref</sub>, we may approximate the mean output inter-spike-interval of the process by:
<disp-formula id="pcbi.1005390.e065"><alternatives><graphic id="pcbi.1005390.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e065" xlink:type="simple"/><mml:math display="block" id="M65"><mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:mtext>reg</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(22)</label></disp-formula>
Now we can formulate a condition on the divergent firing model class: If the expected interval <italic>μ</italic><sub>reg</sub> in the regular firing case is smaller or equal to the input interval <italic>x</italic>, the regular firing state can be maintained. From Eqs (<xref ref-type="disp-formula" rid="pcbi.1005390.e065">22</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005390.e063">21</xref>), we obtain the condition:
<disp-formula id="pcbi.1005390.e066"><alternatives><graphic id="pcbi.1005390.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e066" xlink:type="simple"/><mml:math display="block" id="M66"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:munderover> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:mo>≥</mml:mo> <mml:mo>-</mml:mo> <mml:mo form="prefix">ln</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mfenced> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(23)</label></disp-formula>
This condition is instructive in two ways: First, to maintain the interval <italic>x</italic> = <italic>τ</italic><sub>ref</sub>, the series on the left hand side (LHS) has to diverge to positive infinity quicker than the logarithm on right hand side (RHS). Second, in case the series on the LHS of <xref ref-type="disp-formula" rid="pcbi.1005390.e066">Eq (23)</xref> converges for all <italic>x</italic> ≥ <italic>τ</italic><sub>ref</sub>, there is a minimum value of <italic>x</italic> for which <xref ref-type="disp-formula" rid="pcbi.1005390.e066">Eq (23)</xref> is still fulfilled. Then <italic>x</italic><sup>−1</sup> is the peak firing rate that this model can maintain close to the regular spiking limit.</p>
<p>Many models, even ones with an upper unstable fixed point, might not fulfill <xref ref-type="disp-formula" rid="pcbi.1005390.e066">Eq (23)</xref>. These models are fragile, but also cannot maintain the regular firing mode. Nonetheless we may ask for how many regular spikes they can maintain the tonic activity. This can be addressed by a modified condition like <xref ref-type="disp-formula" rid="pcbi.1005390.e063">Eq (21)</xref> considering <italic>K</italic> &lt; ∞. By analogous reasoning as above, we arrive at the condition:
<disp-formula id="pcbi.1005390.e067"><alternatives><graphic id="pcbi.1005390.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e067" xlink:type="simple"/><mml:math display="block" id="M67"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:mo>≥</mml:mo> <mml:mo>-</mml:mo> <mml:mo form="prefix">ln</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mfenced> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(24)</label></disp-formula>
For a given tonic firing interval <italic>x</italic> close to <italic>τ</italic><sub>ref</sub> (e.g., defined as <inline-formula id="pcbi.1005390.e068"><alternatives><graphic id="pcbi.1005390.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>9</mml:mn> <mml:mo>×</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>), the maximum <italic>K</italic><sub>max</sub> for which <xref ref-type="disp-formula" rid="pcbi.1005390.e067">Eq (24)</xref> is fulfilled yields a good approximation of the duration <italic>K</italic><sub>max</sub> <italic>x</italic> of the intermittent regular spiking episodes of the model.</p>
<p>If the spike-history filter is a sum of two exponential terms, the condition in <xref ref-type="disp-formula" rid="pcbi.1005390.e067">Eq (24)</xref> takes the specific form of a geometric series:
<disp-formula id="pcbi.1005390.e069"><alternatives><graphic id="pcbi.1005390.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e069" xlink:type="simple"/><mml:math display="block" id="M69"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo> <mml:mtext>ln</mml:mtext> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>≤</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mtext>r</mml:mtext></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mtext>a</mml:mtext></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>a</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mtext>r</mml:mtext></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mtext>a</mml:mtext></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>a</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>k</mml:mi> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>a</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mtext>r</mml:mtext></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>K</mml:mi> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mtext>a</mml:mtext></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>a</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>K</mml:mi> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>a</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>a</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mtext>r</mml:mtext></mml:msub> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>K</mml:mi> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow> <mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mtext>a</mml:mtext></mml:msub> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>K</mml:mi> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>a</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow> <mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>a</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
which for <italic>K</italic> → ∞ becomes condition <xref ref-type="disp-formula" rid="pcbi.1005390.e066">Eq (23)</xref>, which here is:
<disp-formula id="pcbi.1005390.e070"><alternatives><graphic id="pcbi.1005390.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e070" xlink:type="simple"/><mml:math display="block" id="M70"><mml:mrow><mml:mo>-</mml:mo> <mml:mtext>ln</mml:mtext> <mml:mfenced close="]" open="[" separators=""><mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mfenced> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(26)</label></disp-formula>
The boundary defined by <xref ref-type="disp-formula" rid="pcbi.1005390.e070">Eq (26)</xref> in the (<italic>J</italic><sub><italic>r</italic></sub>, <italic>J</italic><sub><italic>a</italic></sub>) space is a line: For every <italic>J</italic><sub><italic>r</italic></sub> there is a maximum <inline-formula id="pcbi.1005390.e071"><alternatives><graphic id="pcbi.1005390.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow> <mml:mtext>max</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> from which on <xref ref-type="disp-formula" rid="pcbi.1005390.e070">Eq (26)</xref> is true. For <inline-formula id="pcbi.1005390.e072"><alternatives><graphic id="pcbi.1005390.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow> <mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, in contrast, we are assured that the regular firing mode with interval <italic>x</italic> is unstable. Models for which <xref ref-type="disp-formula" rid="pcbi.1005390.e070">Eq (26)</xref> is not fulfilled will show intermittent bursting activity (compare with <xref ref-type="fig" rid="pcbi.1005390.g007">Fig 7</xref>).</p>
</sec>
<sec id="sec020">
<title>Estimation of average divergence time from simulations</title>
<p>We estimate the average divergence time of a given neuron model by simulating <italic>N</italic> = 48 independent neurons for <italic>T</italic> = 1000 s each. A neuron is said to have diverged at time <italic>t</italic> if its average firing rate in the interval [<italic>t</italic> − 1, <italic>t</italic> + 1] seconds exceeds <inline-formula id="pcbi.1005390.e073"><alternatives><graphic id="pcbi.1005390.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>h</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>9</mml:mn> <mml:mo>×</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Alternatively, the firing rate may stay below <italic>λ</italic><sub><italic>thr</italic></sub> until the end of the simulation (“censored observation”).</p>
<p>We can now derive the maximum-likelihood estimate of the divergence time. We assume that neurons diverge randomly with rate <italic>r</italic> = 1/<italic>T</italic><sub>div</sub>. This seems to be justified in practice based on our simulations. Then, the likelihood of observing a divergence time <italic>y</italic> smaller than <italic>T</italic> is <inline-formula id="pcbi.1005390.e074"><alternatives><graphic id="pcbi.1005390.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>y</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and the probability to observe a censored observation of length <italic>T</italic> is given by:
<disp-formula id="pcbi.1005390.e075"><alternatives><graphic id="pcbi.1005390.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e075" xlink:type="simple"/><mml:math display="block" id="M75"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mi>T</mml:mi> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>y</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mi>d</mml:mi> <mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(27)</label></disp-formula>
If we denote the observed divergence times as <italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, …, <italic>y</italic><sub><italic>k</italic></sub>, and we have <italic>N</italic><sub><italic>c</italic></sub> = <italic>N</italic> − <italic>k</italic> censored observations, the overall log-likelihood function is given by:
<disp-formula id="pcbi.1005390.e076"><alternatives><graphic id="pcbi.1005390.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e076" xlink:type="simple"/><mml:math display="block" id="M76"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mi>L</mml:mi> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:munderover> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(28)</label></disp-formula>
<disp-formula id="pcbi.1005390.e077"><alternatives><graphic id="pcbi.1005390.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e077" xlink:type="simple"/><mml:math display="block" id="M77"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mi>T</mml:mi></mml:mrow> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub></mml:mfrac> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mo>∑</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(29)</label></disp-formula>
At the maximal (log-)likelihood estimate <inline-formula id="pcbi.1005390.e078"><alternatives><graphic id="pcbi.1005390.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>, the gradient with respect to <italic>T</italic><sub>div</sub> has to vanish:
<disp-formula id="pcbi.1005390.e079"><alternatives><graphic id="pcbi.1005390.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e079" xlink:type="simple"/><mml:math display="block" id="M79"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mo form="prefix">log</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub></mml:mrow></mml:mfrac> <mml:msub><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mi>T</mml:mi> <mml:mtext>div</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mi>T</mml:mi></mml:mrow> <mml:msubsup><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mtext>div</mml:mtext></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mo>∑</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:msubsup><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mtext>div</mml:mtext></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mover><mml:mo>=</mml:mo> <mml:mo>!</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(30)</label></disp-formula>
<disp-formula id="pcbi.1005390.e080"><alternatives><graphic id="pcbi.1005390.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e080" xlink:type="simple"/><mml:math display="block" id="M80"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>+</mml:mo> <mml:mo>∑</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(31)</label></disp-formula>
<disp-formula id="pcbi.1005390.e081"><alternatives><graphic id="pcbi.1005390.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e081" xlink:type="simple"/><mml:math display="block" id="M81"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>+</mml:mo> <mml:mo>∑</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(32)</label></disp-formula>
This assumes that there was at least one non-censored observation (<italic>N</italic><sub><italic>c</italic></sub> &lt; <italic>N</italic>). Otherwise, we set <inline-formula id="pcbi.1005390.e082"><alternatives><graphic id="pcbi.1005390.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Note that if <italic>N</italic><sub><italic>c</italic></sub> &gt; 0, <inline-formula id="pcbi.1005390.e083"><alternatives><graphic id="pcbi.1005390.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>div</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> may be larger than <italic>T</italic>.</p>
</sec>
<sec id="sec021">
<title>Model estimation via maximum-likelihood optimization</title>
<p>If <italic>η</italic>(<italic>s</italic>) in <xref ref-type="disp-formula" rid="pcbi.1005390.e030">Eq (10)</xref> is parameterized through a set of basis functions {<italic>B</italic><sub><italic>i</italic></sub>(<italic>s</italic>)} with linear coefficients {<italic>β</italic><sub><italic>i</italic></sub>}, then <italic>η</italic>(<italic>s</italic>) = ∑<sub><italic>i</italic></sub> <italic>β</italic><sub><italic>i</italic></sub> <italic>B</italic><sub><italic>i</italic></sub>(<italic>s</italic>). All model parameters <inline-formula id="pcbi.1005390.e084"><alternatives><graphic id="pcbi.1005390.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> can be estimated via the statistical framework of generalized linear models (GLMs) [<xref ref-type="bibr" rid="pcbi.1005390.ref002">2</xref>]. We discretize the spike train to obtain a series of spike counts <italic>n</italic><sub><italic>i</italic></sub> in each time window of length Δ = 1 ms. The expected spike count is given by the discrete-time approximation of <xref ref-type="disp-formula" rid="pcbi.1005390.e030">Eq (10)</xref> as E[<italic>n</italic><sub><italic>i</italic></sub>] = <italic>λ</italic><sub><italic>i</italic></sub>Δ. The log-likelihood is then proportional to:
<disp-formula id="pcbi.1005390.e085"><alternatives><graphic id="pcbi.1005390.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e085" xlink:type="simple"/><mml:math display="block" id="M85"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mi>L</mml:mi> <mml:mo>∝</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(33)</label></disp-formula>
For the estimation of physiologically plausible model parameters (<xref ref-type="fig" rid="pcbi.1005390.g009">Fig 9</xref>), we used 10 raised cosine functions [<xref ref-type="bibr" rid="pcbi.1005390.ref004">4</xref>] with logarithmically spaced peaks up to 400 ms as basis functions {<italic>B</italic><sub><italic>i</italic></sub>(<italic>s</italic>)} for the spike-history filter. In addition, an absolute refractory period of <italic>τ</italic><sub>ref</sub> = 2 ms was enforced. To improve numerical convergence and to ensure finite parameters for very sparse data sets, we added a small L2-penalty term to the log-likelihood function so that the maximum-likelihood estimate (MLE) corresponds to the minimum of the cost function:
<disp-formula id="pcbi.1005390.e086"><alternatives><graphic id="pcbi.1005390.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e086" xlink:type="simple"/><mml:math display="block" id="M86"><mml:mrow><mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>10</mml:mn></mml:munderover> <mml:msubsup><mml:mi>β</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(34)</label></disp-formula>
with regularization parameter <italic>α</italic> = 5 ⋅ 10<sup>−4</sup>.</p>
</sec>
<sec id="sec022">
<title>Stabilization-constrained maximum-likelihood estimation</title>
<p>For the stabilization procedure (<xref ref-type="fig" rid="pcbi.1005390.g010">Fig 10</xref>), we performed the maximum-likelihood estimation (see previous section) under the additional constraint that the model is predicted to be stable by the QR approximation. That is, we optimized the cost function:
<disp-formula id="pcbi.1005390.e087"><alternatives><graphic id="pcbi.1005390.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e087" xlink:type="simple"/><mml:math display="block" id="M87"><mml:mrow><mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>10</mml:mn></mml:munderover> <mml:msubsup><mml:mi>β</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>the</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>model</mml:mtext> <mml:mspace width="4.pt"/><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>}</mml:mo></mml:mrow> <mml:mspace width="4.pt"/><mml:mtext>is</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>predicted</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>to</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>be</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>stable,</mml:mtext></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mi>∞</mml:mi></mml:mtd> <mml:mtd columnalign="left"><mml:mtext>otherwise.</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(35)</label></disp-formula>
We used a gradient-free optimization algorithm (Nelder-Mead) with a convergence criterion on the change in parameter values (<inline-formula id="pcbi.1005390.e088"><alternatives><graphic id="pcbi.1005390.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005390.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∥</mml:mo> <mml:mo>Δ</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mrow><mml:mo>∥</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>&lt;</mml:mo> <mml:msup><mml:mn>10</mml:mn> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>).</p>
<p>The initial condition was chosen as the MLE solution for which positive parameter coefficients were set to zero. Because basis functions <italic>B</italic><sub><italic>i</italic></sub>(<italic>s</italic>) are non-negative, this corresponds to a non-positive spike-history filter and ensures that the initial evaluation of the cost function is finite. Then, the optimization starts from a region with finite cost and allows the algorithm to descend to a (local) minimum.</p>
</sec>
<sec id="sec023">
<title>Simulation</title>
<p>All simulations with the spike-history filter consisting of one or two exponentials (Figs <xref ref-type="fig" rid="pcbi.1005390.g005">5</xref> to <xref ref-type="fig" rid="pcbi.1005390.g008">8</xref>) were performed using NEST [<xref ref-type="bibr" rid="pcbi.1005390.ref054">54</xref>], with neuron model “pp_psc_delta” in time steps of 0.5 ms. All other spike train simulations were performed with custom-written MATLAB software with a time discretization of 0.2 ms. Analysis and optimization were performed in MATLAB and Python.</p>
</sec>
</sec>
<sec id="sec024">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005390.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Less-rapidly growing nonlinearities do not prevent instability.</title>
<p>(A) In addition to the exponential nonlinearity used in <xref ref-type="fig" rid="pcbi.1005390.g002">Fig 2</xref> (blue), we also simulated spike trains using two less rapidly growing nonlinearities: First, a linear-rectifier function, i.e., <italic>f</italic>(<italic>x</italic>) = [<italic>x</italic> + 1]<sub>+</sub> which is <italic>x</italic> + 1 for <italic>x</italic> &gt; −1 and 0 otherwise. The offset is chosen so that the function matches the exponential nonlinearity at <italic>x</italic> = 0 (green). In addition, we used <italic>f</italic>(<italic>x</italic>) = log(1 + <italic>e</italic><sup><italic>x</italic></sup>) (red), i.e., a smooth interpolation between the exponential for small x with linear asymptotic behavior for large <italic>x</italic>. (B) Simulated spike trains for two additional nonlinearities for the two data sets that were shown to diverge in simulations (<xref ref-type="fig" rid="pcbi.1005390.g002">Fig 2B and 2C</xref>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005390.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Same as <xref ref-type="fig" rid="pcbi.1005390.g007">Fig 7A</xref> with <italic>c</italic> = 2 s<sup>−1</sup>.</title>
<p>Spike trains are simulated from a nonlinear Hawkes model with fixed baseline <italic>c</italic> = 2 s<sup>−1</sup> and an auto-history kernel consisting of two exponentials with amplitudes <italic>J</italic><sub><italic>r</italic></sub>, <italic>J</italic><sub><italic>a</italic></sub>, and corresponding time constants <italic>τ</italic><sub><italic>r</italic></sub> = 0.02 s and <italic>τ</italic><sub><italic>a</italic></sub> = 0.1 s. Observed divergence times for simulated spike trains are color-coded (same scale as in <xref ref-type="fig" rid="pcbi.1005390.g005">Fig 5</xref>). In the dashed region, no finite divergence times were observed.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005390.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005390.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Same as <xref ref-type="fig" rid="pcbi.1005390.g007">Fig 7A</xref> with <italic>c</italic> = 10 s<sup>−1</sup>.</title>
<p>Spike trains are simulated from a nonlinear Hawkes model with fixed baseline <italic>c</italic> = 10 s<sup>−1</sup> and an auto-history kernel consisting of two exponentials with amplitudes <italic>J</italic><sub><italic>r</italic></sub>, <italic>J</italic><sub><italic>a</italic></sub>, and corresponding time constants <italic>τ</italic><sub><italic>r</italic></sub> = 0.02 s and <italic>τ</italic><sub><italic>a</italic></sub> = 0.1 s. Observed divergence times for simulated spike trains are color-coded (same scale as in <xref ref-type="fig" rid="pcbi.1005390.g005">Fig 5</xref>). In the dashed region, no finite divergence times were observed.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005390.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Mitra</surname> <given-names>PP</given-names></name>. <article-title>Multiple neural spike train data analysis: state-of-the-art and future challenges</article-title>. <source>Nature Neuroscience</source>. <year>2004</year> <month>may</month>;<volume>7</volume>(<issue>5</issue>):<fpage>456</fpage>–<lpage>461</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1228" xlink:type="simple">10.1038/nn1228</ext-link></comment> <object-id pub-id-type="pmid">15114358</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Fellows</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>A point process framework for relating neural spiking activity to spiking history, neural ensemble, and extrinsic covariate effects</article-title>. <source>Journal of Neurophysiology</source>. <year>2005</year> <month>feb</month>;<volume>93</volume>(<issue>2</issue>):<fpage>1074</fpage>–<lpage>89</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00697.2004" xlink:type="simple">10.1152/jn.00697.2004</ext-link></comment> <object-id pub-id-type="pmid">15356183</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stevenson</surname> <given-names>IH</given-names></name>, <name name-style="western"><surname>Rebesco</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>LE</given-names></name>, <name name-style="western"><surname>Körding</surname> <given-names>KP</given-names></name>. <article-title>Inferring functional connections between neurons</article-title>. <source>Current Opinion in Neurobiology</source>. <year>2008</year> <month>dec</month>;<volume>18</volume>(<issue>6</issue>):<fpage>582</fpage>–<lpage>588</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.conb.2008.11.005" xlink:type="simple">10.1016/j.conb.2008.11.005</ext-link></comment> <object-id pub-id-type="pmid">19081241</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Shlens</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sher</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Litke</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Chichilnisky</surname> <given-names>EJ</given-names></name>, <etal>et al</etal>. <article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title>. <source>Nature</source>. <year>2008</year> <month>jul</month>;<volume>454</volume>(<issue>7207</issue>):<fpage>995</fpage>–<lpage>999</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature07140" xlink:type="simple">10.1038/nature07140</ext-link></comment> <object-id pub-id-type="pmid">18650810</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Hochberg</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>. <article-title>Collective dynamics in human and monkey sensorimotor cortex: predicting single neuron spikes</article-title>. <source>Nature Neuroscience</source>. <year>2010</year> <month>jan</month>;<volume>13</volume>(<issue>1</issue>):<fpage>105</fpage>–<lpage>111</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2455" xlink:type="simple">10.1038/nn.2455</ext-link></comment> <object-id pub-id-type="pmid">19966837</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerhard</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kispersky</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Gutierrez</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Marder</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kramer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>U</given-names></name>. <article-title>Successful reconstruction of a physiological circuit with known connectivity from spiking activity alone</article-title>. <source>PLOS Computational Biology</source>. <year>2013</year> <month>jan</month>;<volume>9</volume>(<issue>7</issue>):<fpage>e1003138</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003138" xlink:type="simple">10.1371/journal.pcbi.1003138</ext-link></comment> <object-id pub-id-type="pmid">23874181</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref007">
<label>7</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kistler</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>. <source>Neuronal Dynamics</source>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Takahashi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Coleman</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Suminski</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Best</surname> <given-names>MD</given-names></name>, <etal>et al</etal>. <article-title>Large-scale spatiotemporal spike patterning consistent with wave propagation in motor cortex</article-title>. <source>Nature Communications</source>. <year>2015</year>;<volume>6</volume>(<issue>May</issue>):<fpage>7169</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms8169" xlink:type="simple">10.1038/ncomms8169</ext-link></comment> <object-id pub-id-type="pmid">25994554</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brémaud</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Massoulié</surname> <given-names>L</given-names></name>. <article-title>Stability of nonlinear Hawkes processes</article-title>. <source>The Annals of Probability</source>. <year>1996</year> <month>jul</month>;<volume>24</volume>(<issue>3</issue>):<fpage>1563</fpage>–<lpage>1588</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/aop/1065725193" xlink:type="simple">10.1214/aop/1065725193</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref010">
<label>10</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Daley</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Vere-Jones</surname> <given-names>D</given-names></name>. <source>An Introduction to the Theory of Point Processes</source>, Volume <volume>1</volume> (<edition>2nd ed.</edition>). <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2003</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref011">
<label>11</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Mensi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <source>From Stochastic Nonlinear Integrate-and-Fire to Generalized Linear Models</source>. In: <name name-style="western"><surname>Shawe-Taylor</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zemel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bartlett</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pereira</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Weinberger</surname> <given-names>K</given-names></name>, editors. <publisher-name>NIPS</publisher-name>; <year>2011</year>. p. <fpage>1377</fpage>–<lpage>1385</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref012">
<label>12</label>
<mixed-citation publication-type="other" xlink:type="simple">Mensi S. A new Mathematical Framework to Understand Single Neuron Computations [PhD Thesis]. EPFL (Lausanne, Switzerland); 2014.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weber</surname> <given-names>AI</given-names></name>, <name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>. <article-title>Capturing the dynamical repertoire of single neurons with generalized linear models</article-title>. <source>arXiv</source>. <year>2016</year> <month>feb</month>;p. <fpage>1</fpage>–<lpage>19</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Prinz</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Bucher</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Marder</surname> <given-names>E</given-names></name>. <article-title>Similar network activity from disparate circuit parameters</article-title>. <source>Nature Neuroscience</source>. <year>2004</year> <month>dec</month>;<volume>7</volume>(<issue>12</issue>):<fpage>1345</fpage>–<lpage>1352</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1352" xlink:type="simple">10.1038/nn1352</ext-link></comment> <object-id pub-id-type="pmid">15558066</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marder</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Goaillard</surname> <given-names>JM</given-names></name>. <article-title>Variability, compensation and homeostasis in neuron and network function</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2006</year> <month>jul</month>;<volume>7</volume>(<issue>7</issue>):<fpage>563</fpage>–<lpage>574</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn1949" xlink:type="simple">10.1038/nrn1949</ext-link></comment> <object-id pub-id-type="pmid">16791145</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Benda</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Herz</surname> <given-names>AVM</given-names></name>. <article-title>A universal model for spike-frequency adaptation</article-title>. <source>Neural Computation</source>. <year>2003</year>;<volume>15</volume>:<fpage>2523</fpage>–<lpage>2564</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976603322385063" xlink:type="simple">10.1162/089976603322385063</ext-link></comment> <object-id pub-id-type="pmid">14577853</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pozzorini</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Mensi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Temporal whitening by power-law adaptation in neocortical neurons</article-title>. <source>Nature Neuroscience</source>. <year>2013</year> <month>jul</month>;<volume>16</volume>(<issue>7</issue>):<fpage>942</fpage>–<lpage>948</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3431" xlink:type="simple">10.1038/nn.3431</ext-link></comment> <object-id pub-id-type="pmid">23749146</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hawkes</surname> <given-names>AG</given-names></name>. <article-title>Spectra of Some Self-Exciting and Mutually Exciting Point Processes</article-title>. <source>Biometrika</source>. <year>1971</year> <month>apr</month>;<volume>58</volume>(<issue>1</issue>):<fpage>83</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/58.1.83" xlink:type="simple">10.1093/biomet/58.1.83</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hawkes</surname> <given-names>AG</given-names></name>. <article-title>Point Spectra of Some Mutually Exciting Point Processes</article-title>. <source>Journal of the Royal Statistical Society Series B</source>. <year>1971</year>;<volume>33</volume>(<issue>3</issue>):<fpage>438</fpage>–<lpage>443</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hawkes</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Oakes</surname> <given-names>D</given-names></name>. <article-title>A Cluster Process Representation of a Self-Exciting Process</article-title>. <source>Journal of Applied Probability</source>. <year>1974</year> <month>sep</month>;<volume>11</volume>(<issue>3</issue>):<fpage>493</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1017/S0021900200096273" xlink:type="simple">10.1017/S0021900200096273</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Massoulié</surname> <given-names>L</given-names></name>. <article-title>Stability results for a general class of interacting point processes dynamics, and applications</article-title>. <source>Stochastic Processes and their Applications</source>. <year>1998</year> <month>jun</month>;<volume>75</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>30</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref022">
<label>22</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Priestley</surname> <given-names>M B</given-names></name>. <source>Spectral analysis and time series</source>. <publisher-loc>London</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>1982</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref023">
<label>23</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Percival</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Walden</surname> <given-names>AT</given-names></name>. <source>Spectral Analysis for Physical Applications: Multitaper and Conventional Univariate Techniques</source>. vol. <volume>38</volume>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>1993</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Barbieri</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ventura</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>. <article-title>The Time-Rescaling Theorem and Its Application to Neural Spike Train Data Analysis</article-title>. <source>Neural Computation</source>. <year>2002</year> <month>feb</month>;<volume>14</volume>(<issue>2</issue>):<fpage>325</fpage>–<lpage>346</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/08997660252741149" xlink:type="simple">10.1162/08997660252741149</ext-link></comment> <object-id pub-id-type="pmid">11802915</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerhard</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Haslinger</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pipa</surname> <given-names>G</given-names></name>. <article-title>Applying the Multivariate Time-Rescaling Theorem to Neural Population Models</article-title>. <source>Neural Computation</source>. <year>2011</year> <month>jun</month>;<volume>23</volume>(<issue>6</issue>):<fpage>1452</fpage>–<lpage>1483</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00126" xlink:type="simple">10.1162/NECO_a_00126</ext-link></comment> <object-id pub-id-type="pmid">21395436</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Coding and Decoding with Adapting Neurons: A Population Approach to the Peri-Stimulus Time Histogram</article-title>. <source>PLOS Computational Biology</source>. <year>2012</year> <month>oct</month>;<volume>8</volume>(<issue>10</issue>):<fpage>e1002711</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002711" xlink:type="simple">10.1371/journal.pcbi.1002711</ext-link></comment> <object-id pub-id-type="pmid">23055914</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schwalger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Fluctuations and information filtering in coupled populations of spiking neurons with adaptation</article-title>. <source>Physical Review E</source>. <year>2014</year> <month>dec</month>;<volume>90</volume>(<issue>6</issue>):<fpage>062704</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.90.062704" xlink:type="simple">10.1103/PhysRevE.90.062704</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brookings</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Grashow</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Marder</surname> <given-names>E</given-names></name>. <article-title>Statistics of Neuronal Identification with Open- and Closed-Loop Measures of Intrinsic Excitability</article-title>. <source>Frontiers in Neural Circuits</source>. <year>2012</year> <month>jan</month>;<volume>6</volume>(<issue>April</issue>):<fpage>1</fpage>–<lpage>14</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Potter</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>El Hady</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fetz</surname> <given-names>EE</given-names></name>. <article-title>Closed-loop neuroscience and neuroengineering</article-title>. <source>Frontiers in Neural Circuits</source>. <year>2014</year> <month>sep</month>;<volume>8</volume>:<fpage>115</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncir.2014.00115" xlink:type="simple">10.3389/fncir.2014.00115</ext-link></comment> <object-id pub-id-type="pmid">25294988</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Ahmed</surname> <given-names>OJ</given-names></name>, <name name-style="western"><surname>Harrison</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Eskandar</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Cosgrove</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Madsen</surname> <given-names>JR</given-names></name>, <etal>et al</etal>. <article-title>Neuronal Ensemble Synchrony during Human Focal Seizures</article-title>. <source>Journal of Neuroscience</source>. <year>2014</year> <month>jul</month>;<volume>34</volume>(<issue>30</issue>):<fpage>9927</fpage>–<lpage>9944</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4567-13.2014" xlink:type="simple">10.1523/JNEUROSCI.4567-13.2014</ext-link></comment> <object-id pub-id-type="pmid">25057195</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vargas-Irwin</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Franquemont</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Black</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>. <article-title>Linking objects to actions: encoding of target object and grasping strategy in primate ventral premotor cortex</article-title>. <source>Journal of Neuroscience</source>. <year>2015</year>;<volume>35</volume>(<issue>30</issue>):<fpage>10888</fpage>–<lpage>10897</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1574-15.2015" xlink:type="simple">10.1523/JNEUROSCI.1574-15.2015</ext-link></comment> <object-id pub-id-type="pmid">26224870</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rule</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Vargas-Irwin</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>. <article-title>Contribution of LFP dynamics to single-neuron spiking variability in motor cortex during movement execution</article-title>. <source>Frontiers in Systems Neuroscience</source>. <year>2015</year> <month>jun</month>;<volume>9</volume>(<issue>June</issue>):<fpage>1</fpage>–<lpage>16</lpage>. <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.3389/fnsys.2015.00089" xlink:type="simple">https://doi.org/10.3389/fnsys.2015.00089</ext-link></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mensi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pozzorini</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Avermann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>CCH</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Parameter extraction and classification of three cortical neuron types reveals two distinct adaptation mechanisms</article-title>. <source>Journal of Neurophysiology</source>. <year>2012</year> <month>mar</month>;<volume>107</volume>(<issue>6</issue>):<fpage>1756</fpage>–<lpage>1775</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00408.2011" xlink:type="simple">10.1152/jn.00408.2011</ext-link></comment> <object-id pub-id-type="pmid">22157113</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zaytsev</surname> <given-names>YV</given-names></name>, <name name-style="western"><surname>Morrison</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Deger</surname> <given-names>M</given-names></name>. <article-title>Reconstruction of recurrent synaptic connectivity of thousands of neurons from simulated spiking activity</article-title>. <source>Journal of Computational Neuroscience</source>. <year>2015</year>;<volume>39</volume>(<issue>1</issue>):<fpage>77</fpage>–<lpage>103</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-015-0565-5" xlink:type="simple">10.1007/s10827-015-0565-5</ext-link></comment> <object-id pub-id-type="pmid">26041729</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shinomoto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Shima</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Tanji</surname> <given-names>J</given-names></name>. <article-title>Differences in spiking patterns among cortical neurons</article-title>. <source>Neural Computation</source>. <year>2003</year> <month>dec</month>;<volume>15</volume>(<issue>12</issue>):<fpage>2823</fpage>–<lpage>2842</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976603322518759" xlink:type="simple">10.1162/089976603322518759</ext-link></comment> <object-id pub-id-type="pmid">14629869</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mochizuki</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Onaga</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Shimazaki</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Shimokawa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tsubo</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kimura</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Similarity in Neuronal Firing Regimes across Mammalian Species</article-title>. <source>Journal of Neuroscience</source>. <year>2016</year>;<volume>36</volume>(<issue>21</issue>):<fpage>5736</fpage>–<lpage>47</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.0230-16.2016" xlink:type="simple">10.1523/JNEUROSCI.0230-16.2016</ext-link></comment> <object-id pub-id-type="pmid">27225764</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref037">
<label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Nadkarni D. The Incidental Parameter Problem in Network Analysis for Neural Spiking Data [PhD Thesis]. Brown University (Providence, RI, USA); 2015.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>Estimating a State-Space Model from Point Process Observations</article-title>. <source>Neural Computation</source>. <year>2003</year>;<volume>15</volume>:<fpage>965</fpage>–<lpage>991</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976603765202622" xlink:type="simple">10.1162/089976603765202622</ext-link></comment> <object-id pub-id-type="pmid">12803953</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref039">
<label>39</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Macke</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Buesing</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Cunningham</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Shenoy</surname> <given-names>KV</given-names></name>, <name name-style="western"><surname>Sahani</surname> <given-names>M</given-names></name>. <chapter-title>Empirical models of spiking in neural populations</chapter-title>. In: <name name-style="western"><surname>Shawe-Taylor</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zemel</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Bartlett</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Pereira</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Weinberger</surname> <given-names>KQ</given-names></name>, editors. <source>Advances in Neural Information Processing Systems 24</source>. <publisher-name>Curran Associates, Inc</publisher-name>.; <year>2011</year>. p. <fpage>1350</fpage>–<lpage>1358</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buesing</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Macke</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Sahani</surname> <given-names>M</given-names></name>. <article-title>Learning stable, regularised latent models of neural population dynamics</article-title>. <source>Network (Bristol, England)</source>. <year>2012</year> <month>jan</month>;<volume>23</volume>(<issue>1–2</issue>):<fpage>24</fpage>–<lpage>47</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref041">
<label>41</label>
<mixed-citation publication-type="other" xlink:type="simple">Aghagolzadeh M, Truccolo W. Latent state-space models for neural decoding. Conference proceedings: Annual International Conference of the IEEE Engineering in Medicine and Biology Society. 2014 aug;2014:3033–3036.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aghagolzadeh</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>. <article-title>Inference and Decoding of Motor Cortex Low-Dimensional Dynamics via Latent State-Space Models</article-title>. <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source>. <year>2016</year>;<volume>24</volume>(<issue>2</issue>):<fpage>272</fpage>–<lpage>282</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNSRE.2015.2470527" xlink:type="simple">10.1109/TNSRE.2015.2470527</ext-link></comment> <object-id pub-id-type="pmid">26336135</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref043">
<label>43</label>
<mixed-citation publication-type="other" xlink:type="simple">Schwalger T, Deger M, Gerstner W. Towards a theory of cortical columns: From spiking neurons to interacting neural populations of finite size. Preprint: arXiv:161100294 [q-bioNC]. 2016;.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Koh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Boyd</surname> <given-names>S</given-names></name>. <article-title>An Interior-Point Method for Large-Scale L1 -Regularized Logistic Regression</article-title>. <source>The Journal of Machine Learning Research</source>. <year>2007</year>;<volume>8</volume>:<fpage>1519</fpage>–<lpage>1555</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chen</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Putrino</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Ghosh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Barbieri</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>Statistical inference for assessing functional connectivity of neuronal ensembles with sparse spiking data</article-title>. <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source>. <year>2011</year>;<volume>19</volume>(<issue>2</issue>):<fpage>121</fpage>–<lpage>135</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNSRE.2010.2086079" xlink:type="simple">10.1109/TNSRE.2010.2086079</ext-link></comment> <object-id pub-id-type="pmid">20937583</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Batista</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cunningham</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Chestek</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rivera-Alvidrez</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Kalmar</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>An L1-regularized logistic model for detecting short-term neuronal interactions</article-title>. <source>Journal of Computational Neuroscience</source>. <year>2012</year>;<volume>32</volume>(<issue>3</issue>):<fpage>479</fpage>–<lpage>497</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-011-0365-5" xlink:type="simple">10.1007/s10827-011-0365-5</ext-link></comment> <object-id pub-id-type="pmid">22038503</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Galves</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Löcherbach</surname> <given-names>E</given-names></name>. <article-title>Infinite Systems of Interacting Chains with Memory of Variable Length—A Stochastic Model for Biological Neural Nets</article-title>. <source>Journal of Statistical Physics</source>. <year>2013</year>;<volume>151</volume>(<issue>5</issue>):<fpage>896</fpage>–<lpage>921</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10955-013-0733-9" xlink:type="simple">10.1007/s10955-013-0733-9</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Doherty</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Lebedev</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Ifft</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Zhuang</surname> <given-names>KZ</given-names></name>, <name name-style="western"><surname>Shokur</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bleuler</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Active tactile exploration using a brain-machine-brain interface</article-title>. <source>Nature</source>. <year>2011</year> <month>oct</month>;<volume>479</volume>(<issue>7372</issue>):<fpage>228</fpage>–<lpage>31</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10489" xlink:type="simple">10.1038/nature10489</ext-link></comment> <object-id pub-id-type="pmid">21976021</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hochberg</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Eskandar</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Madsen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Single-neuron dynamics in human focal epilepsy</article-title>. <source>Nature Neuroscience</source>. <year>2011</year> <month>may</month>;<volume>14</volume>(<issue>5</issue>):<fpage>635</fpage>–<lpage>641</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2782" xlink:type="simple">10.1038/nn.2782</ext-link></comment> <object-id pub-id-type="pmid">21441925</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cardanobile</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Multiplicatively interacting point processes and applications to neural modeling</article-title>. <source>Journal of Computational Neuroscience</source>. <year>2010</year> <month>apr</month>;<volume>28</volume>(<issue>2</issue>):<fpage>267</fpage>–<lpage>284</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-009-0204-0" xlink:type="simple">10.1007/s10827-009-0204-0</ext-link></comment> <object-id pub-id-type="pmid">20052525</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Carandini</surname> <given-names>M</given-names></name>. <article-title>Amplification of trial-to-trial response variability by neurons in visual cortex</article-title>. <source>PLoS Biology</source>. <year>2004</year> <month>sep</month>;<volume>2</volume>(<issue>9</issue>):<fpage>E264</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0020264" xlink:type="simple">10.1371/journal.pbio.0020264</ext-link></comment> <object-id pub-id-type="pmid">15328535</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jolivet</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rauch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lüscher</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Predicting spike timing of neocortical pyramidal neurons by simple threshold models</article-title>. <source>Journal of Computational Neuroscience</source>. <year>2006</year> <month>aug</month>;<volume>21</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>49</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-006-7074-5" xlink:type="simple">10.1007/s10827-006-7074-5</ext-link></comment> <object-id pub-id-type="pmid">16633938</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005390.ref053">
<label>53</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Van Kampen</surname> <given-names>NG</given-names></name>. <source>Stochastic processes in physics and chemistry</source>. <publisher-loc>Amsterdam</publisher-loc>: <publisher-name>Elsevier</publisher-name>; <year>1992</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005390.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gewaltig</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>. <article-title>NEST (NEural Simulation Tool)</article-title>. <source>Scholarpedia</source>. <year>2007</year>;<volume>2</volume>(<issue>4</issue>):<fpage>1430</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4249/scholarpedia.1430" xlink:type="simple">10.4249/scholarpedia.1430</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>