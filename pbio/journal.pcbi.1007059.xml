<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1007059</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-00439</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>RNA structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>RNA</subject><subj-group><subject>RNA structure</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>RNA structure</subject><subj-group><subject>RNA folding</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>RNA</subject><subj-group><subject>RNA structure</subject><subj-group><subject>RNA folding</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Behavior</subject><subj-group><subject>Recreation</subject><subj-group><subject>Games</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Behavior</subject><subj-group><subject>Recreation</subject><subj-group><subject>Games</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject><subj-group><subject>Free energy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>RNA</subject><subj-group><subject>RNA sequences</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Nucleotide sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Nucleotide sequencing</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>EternaBrain: Automated RNA design through move sets and strategies from an Internet-scale RNA videogame</article-title>
<alt-title alt-title-type="running-head">EternaBrain: Automated RNA design from an Internet-scale RNA videogame</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Koodli</surname>
<given-names>Rohan V.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0570-5515</contrib-id>
<name name-style="western">
<surname>Keep</surname>
<given-names>Benjamin</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Coppess</surname>
<given-names>Katherine R.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0238-9251</contrib-id>
<name name-style="western">
<surname>Portela</surname>
<given-names>Fernando</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<collab>Eterna participants</collab>
<xref ref-type="fn" rid="fn001"><sup>¶</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7497-0972</contrib-id>
<name name-style="western">
<surname>Das</surname>
<given-names>Rhiju</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Biochemistry, Stanford University School of Medicine, Stanford, CA, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Education, Stanford University, Stanford, CA, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Physics, Stanford University, Stanford, CA, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Chen</surname>
<given-names>Shi-Jie</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Missouri, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label>
<p>Current address: University of California, Berkeley, CA.</p>
</fn>
<fn fn-type="other" id="fn001">
<p>¶ Membership of Eterna participants is provided in Acknowledgments and Supplemental <xref ref-type="supplementary-material" rid="pcbi.1007059.s001">S1 File</xref>.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">rhiju@stanford.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>27</day>
<month>6</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<month>6</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>6</issue>
<elocation-id>e1007059</elocation-id>
<history>
<date date-type="received">
<day>18</day>
<month>3</month>
<year>2019</year>
</date>
<date date-type="accepted">
<day>30</day>
<month>4</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Koodli et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1007059"/>
<abstract>
<p>Emerging RNA-based approaches to disease detection and gene therapy require RNA sequences that fold into specific base-pairing patterns, but computational algorithms generally remain inadequate for these secondary structure design tasks. The Eterna project has crowdsourced RNA design to human video game players in the form of puzzles that reach extraordinary difficulty. Here, we demonstrate that Eterna participants’ moves and strategies can be leveraged to improve automated computational RNA design. We present an eternamoves-large repository consisting of 1.8 million of player moves on 12 of the most-played Eterna puzzles as well as an eternamoves-select repository of 30,477 moves from the top 72 players on a select set of more advanced puzzles. On eternamoves-select, we present a multilayer convolutional neural network (CNN) EternaBrain that achieves test accuracies of 51% and 34% in base prediction and location prediction, respectively, suggesting that top players’ moves are partially stereotyped. Pipelining this CNN’s move predictions with single-action-playout (SAP) of six strategies compiled by human players solves 61 out of 100 independent puzzles in the Eterna100 benchmark. EternaBrain-SAP outperforms previously published RNA design algorithms and achieves similar or better performance than a newer generation of deep learning methods, while being largely orthogonal to these other methods. Our study provides useful lessons for future efforts to achieve human-competitive performance with automated RNA design algorithms.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>The design of RNA sequences that fold into target structures is a computationally difficult task whose importance continues to grow with the advent of RNA-based therapeutics and diagnostics. This paper reports a new approach stemming from the Eterna massive open laboratory, a project that crowdsources RNA design to &gt;250,000 ‘players’ on the internet. The efforts of Eterna participants have led to the accumulation of nearly 2 million moves that lead to successful <italic>in silico</italic> solutions on difficult puzzles, many of which are only solvable by humans. Inspired by recent advances in automated game playing, we discovered that these moves are sufficiently stereotyped so that a neural network can be trained to predict moves with accuracy significantly higher than random guessing. The resulting method EternaBrain allows solution of new RNA design problems when used to predict complete series of moves rather than just single moves. Further improvement comes from heuristic strategies that are well known amongst the Eterna community but not described in prior publications on automated RNA design. EternaBrain appears highly complementary to other emerging next-generation RNA design methods based on neural-network and game playing approaches, suggesting new routes for automated methods to emulate human experts in RNA design.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>School of Medicine, Stanford University (US)</institution>
</funding-source>
<award-id>Discovery Innovation Award</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7497-0972</contrib-id>
<name name-style="western">
<surname>Das</surname>
<given-names>Rhiju</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Vice Provost for Graduate Education, Stanford University</institution>
</funding-source>
<award-id>Stanford Graduate Fellowship</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0570-5515</contrib-id>
<name name-style="western">
<surname>Keep</surname>
<given-names>Benjamin</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
<institution>National Institute of General Medical Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>R01 GM100953</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7497-0972</contrib-id>
<name name-style="western">
<surname>Das</surname>
<given-names>Rhiju</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
<institution>National Institute of General Medical Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>R35 GM122579</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7497-0972</contrib-id>
<name name-style="western">
<surname>Das</surname>
<given-names>Rhiju</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>We acknowledge funding from a Stanford Graduate Fellowship (to B.K.), the U.S. National Institutes of Health (R01 GM100953 and R35 GM122579 to R.D.), and a Discovery Innovation Award (Stanford University School of Medicine to R.D.). The funder websites are: <ext-link ext-link-type="uri" xlink:href="https://vpge.stanford.edu/fellowships-funding/sgf" xlink:type="simple">https://vpge.stanford.edu/fellowships-funding/sgf</ext-link> <ext-link ext-link-type="uri" xlink:href="https://www.nigms.nih.gov/" xlink:type="simple">https://www.nigms.nih.gov/</ext-link> <ext-link ext-link-type="uri" xlink:href="http://medicalgiving.stanford.edu/events/discovery-innovation-awards.html/" xlink:type="simple">http://medicalgiving.stanford.edu/events/discovery-innovation-awards.html/</ext-link> The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="4"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data are available in a Github repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/EteRNAgame/EternaBrain" xlink:type="simple">https://github.com/EteRNAgame/EternaBrain</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Due to its versatility and important roles throughout biology, there is strong interest in designing RNA-guided machines for disease detection, virus defense, and gene therapy, e.g., for gene silencing and CRISPR/Cas9 gene editing [<xref ref-type="bibr" rid="pcbi.1007059.ref001">1</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref002">2</xref>]. Much of RNA’s functionality is dependent on well-defined structures, and so these and future RNA technologies require computational methods to effectively design sequences that fold into a target structure or set of structures suited to a desired task. The simplest problem involves designing RNA sequences that energetically favor one specific secondary structure–a target pattern of Watson-Crick base pairs–over alternative secondary structures. Even this most basic problem is computationally difficult [<xref ref-type="bibr" rid="pcbi.1007059.ref003">3</xref>]. While exact solutions can be determined through exhaustive calculation [<xref ref-type="bibr" rid="pcbi.1007059.ref004">4</xref>], such computational enumeration generally takes an impractically long time for solve complex target structures.</p>
<p>Numerous groups have developed RNA secondary structure design algorithms, including MODENA [<xref ref-type="bibr" rid="pcbi.1007059.ref005">5</xref>], RNAinverse [<xref ref-type="bibr" rid="pcbi.1007059.ref006">6</xref>], INFO-RNA [<xref ref-type="bibr" rid="pcbi.1007059.ref007">7</xref>], RNA-SSD [<xref ref-type="bibr" rid="pcbi.1007059.ref008">8</xref>], and NUPACK [<xref ref-type="bibr" rid="pcbi.1007059.ref009">9</xref>]. In the original studies presenting these methods, tests typically involved simple structures that do not capture the symmetries, duplex lengths, and sizes needed for biotechnology applications [<xref ref-type="bibr" rid="pcbi.1007059.ref010">10</xref>]. The incompleteness of these prior methods and tests became clear with the release of the <italic>Eterna</italic> game [<xref ref-type="bibr" rid="pcbi.1007059.ref011">11</xref>] in 2011, which crowdsources RNA design in the form of puzzles through an internet-scale videogame (<xref ref-type="fig" rid="pcbi.1007059.g001">Fig 1A–1C</xref>). Eterna participants learn the basics of RNA design through examples that are initially tested <italic>in silico</italic> through a computational model of secondary structure folding. Advanced participants can submit their RNA designs in lab challenges and receive wet-lab feedback on how their molecules fold during <italic>in vitro</italic> experiments performed on a weekly time scale. These efforts expose the ‘reality gap’ in RNA design–the mismatch between current computational folding models and experiment. In preparation for these experimental challenges, participants also challenge fellow participants through <italic>in silico</italic> puzzles that require learning or developing sophisticated puzzle-solving strategies; these separate ‘games within the game’ are useful for guiding the development of computational RNA design methods [<xref ref-type="bibr" rid="pcbi.1007059.ref010">10</xref>]. Since Eterna’s inception, the community has grown to over 250,000 registered participants as of 2019, with over 17,000 player-created puzzles. This community has been successful in designing RNAs that consistently outperform RNA design algorithms in both <italic>in silico</italic> and <italic>in vitro</italic> tests [<xref ref-type="bibr" rid="pcbi.1007059.ref010">10</xref>].</p>
<fig id="pcbi.1007059.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007059.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Eterna and EternaBrain.</title>
<p>(A-C) Puzzle-solving interface presented to human players of Eterna including the state of the puzzle (whether it is solved or not) in the top left corner (red/green outline), the puzzle itself (in the middle), and the toolbar (bottom) with which the players can mutate the RNA sequence to make it fold into the desired state; yellow, blue, red, and green symbols represent A, U, G, and C nucleotides. (A) The desired target structure for the RNA molecule, as indicated by the bullseye in the bottom left (orange highlight). (B) Nature mode, as indicated by the leaf in the bottom left (orange highlight), gives the predicted minimum free energy structure for the current sequence. Since the bases in the top right should be paired with each other (orange circle), this puzzle is not yet folding correctly; this status is shown by the red indicator in the top left corner. (C) The solved puzzle. The nature-mode structure matches the target structure, and the indicator in the top left corner turns green, meaning the puzzle has been solved. (D) (left) Wide distribution of contributed Eterna solutions across different players. For preparing the <italic>eternamoves-select</italic> data set, we selected any player who had solved more than 3000 distinct puzzles, which left us with 72 players. (right) In EternaBrain, we tested whether information on players’ moves could be used to train a convolutional neural network. (E) For solving new puzzles, the final EternaBrain-SAP framework first uses the EternaBrain convolutional neural net model to predict sequence changes (‘moves’) for new RNA puzzles. In a second stage, the Single Action Playout (SAP), six additional hand-coded strategies are applied to complete the solution.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.g001" xlink:type="simple"/>
</fig>
<p>Since Eterna’s inception, participants have discovered classes of RNA secondary structures for which prior algorithms cannot find sequence solutions even <italic>in silico</italic>, i.e., when folded with computational energy models that can be rapidly evaluated [<xref ref-type="bibr" rid="pcbi.1007059.ref010">10</xref>]. However, under the same computational energy models, solutions to these design problems can be discovered by experienced human participants. Thus, there remains a gap between algorithms and humans even for the purely computational problem of <italic>in silico</italic> design. Fortunately, Eterna has produced rich resources that might allow for this gap to be closed. First, in 2016, several participants curated a benchmark of 100 problems of increasing difficulty, termed the ‘Eterna100’ [<xref ref-type="bibr" rid="pcbi.1007059.ref010">10</xref>]. By offering a wider spectrum of difficulty than prior benchmark sets based on inferred structures of random or biological RNAs [<xref ref-type="bibr" rid="pcbi.1007059.ref005">5</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref006">6</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref007">7</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref008">8</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref009">9</xref>], these secondary structures allow stringent tests of advances in computational design methods while still guaranteeing that solutions can be found. Second, player-created tutorial puzzles have ‘canonized’ new strategies for <italic>in silico</italic> RNA design. In 2016, Eterna developers installed these puzzles as the standard progression of problems for new participants. At the same time, Eterna participants have agreed to share the sequences of moves that lead to successful solutions to scientific research, resulting in a data repository including nearly 2 million player moves (<xref ref-type="fig" rid="pcbi.1007059.g001">Fig 1D</xref>).</p>
<p>The availability of such a large collection of move sets as well as canonical player strategies suggests new approaches to solving the RNA secondary structure design problem. While previous RNA design algorithms have used hierarchical decomposition of target structures, genetic algorithms, and probabilistic sampling of sequences [<xref ref-type="bibr" rid="pcbi.1007059.ref005">5</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref007">7</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref008">8</xref>], a recent generation of classification, translation, and game-playing algorithms make powerful use of statistical pattern recognition through multi-layer artificial neural networks [<xref ref-type="bibr" rid="pcbi.1007059.ref012">12</xref>]. One striking example is Google DeepMind’s AlphaGo [<xref ref-type="bibr" rid="pcbi.1007059.ref013">13</xref>], which outcompeted expert human participants in the complex game of <italic>Go</italic>. This approach was inspired by the discovery that expert participant moves in the game Go were sufficiently stereotyped that they could be predicted with better than 50% accuracy by a convolutional neural network (CNN), despite the large space of possible moves in this game (up to 19 x 19 = 361 board positions for pieces, giving a baseline random guess accuracy of less than 0.5%) [<xref ref-type="bibr" rid="pcbi.1007059.ref013">13</xref>]. AlphaGo and its successor AlphaGo Zero have further improved their performance using reinforcement learning [<xref ref-type="bibr" rid="pcbi.1007059.ref014">14</xref>]. While reinforcement learning has shown promise for RNA design, it is not yet human competitive [<xref ref-type="bibr" rid="pcbi.1007059.ref015">15</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref016">16</xref>]. This observation suggests that there remain lessons to be learned from human moves and strategies. Nevertheless, it remains unclear whether single base changes during human RNA design are sufficiently stereotyped as to inform neural network or other machine learning methods– strategies that involve back-and-forth flipping of base changes, sets of multiple sequence moves, or sequence explorations outside the game browser may be important for the success of the best Eterna participants.</p>
<p>To test whether new strategies for automated RNA design might be gleaned from successful single base moves, we present a data set of 1.8 million moves on Eterna’s most played puzzles, called <italic>eternamoves-large</italic>, appropriately cleaned and labeled for machine learning applications. We conduct tests of CNNs to predict these moves given the game state, and report generally poor results. However, we do find that a set of 30,477 moves made by the most experienced participants on more difficult puzzles (<italic>eternamoves-select</italic>) are sufficiently stereotyped to allow training of an automated neural network EternaBrain move predictor with accuracy well above random baseline. We then challenge the resulting predictor to go beyond simply predicting individual moves and to instead perform a series of moves to solve novel RNA secondary structure design problems from scratch (as evaluated by <italic>in silico</italic> folding models). We find generally modest performance from this CNN-only approach, with results poorer than previously published algorithms. We then collate several of the participants’ hand-crafted strategies and pipeline a single-action-playout (SAP) of these strategies to the EternaBrain neural network approach. We show that the resulting EternaBrain-SAP algorithm (<xref ref-type="fig" rid="pcbi.1007059.g001">Fig 1E</xref>) achieves excellent performance on the Eterna100 benchmark by completing 61 of 100 puzzles, exceeding the performance of methods published prior to our work. Furthermore, EternaBrain-SAP performs similarly to newer methods developed concomitantly by us and other groups using complementary algorithmic approaches. In the discussion, we compare EternaBrain-SAP’s performance on the Eterna100 with these more recently-reported methods, including SIMARD [<xref ref-type="bibr" rid="pcbi.1007059.ref017">17</xref>], SentRNA [<xref ref-type="bibr" rid="pcbi.1007059.ref018">18</xref>], NEMO [<xref ref-type="bibr" rid="pcbi.1007059.ref019">19</xref>], antaRNA [<xref ref-type="bibr" rid="pcbi.1007059.ref020">20</xref>], MCTS-RNA [<xref ref-type="bibr" rid="pcbi.1007059.ref021">21</xref>], and the reinforcement learning methods of Eastman et al. [<xref ref-type="bibr" rid="pcbi.1007059.ref015">15</xref>] and LEARNA [<xref ref-type="bibr" rid="pcbi.1007059.ref016">16</xref>], drawing lessons for future efforts in automated RNA design. Additionally, we highlight the likelihood of future progress as other methods [<xref ref-type="bibr" rid="pcbi.1007059.ref004">4</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref022">22</xref>] and newer computational energy functions [<xref ref-type="bibr" rid="pcbi.1007059.ref023">23</xref>] are developed and tested on the same benchmark as well as on biological RNA structures.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Initial training on 1.8 million moves</title>
<p>We tested several different neural network architectures and training sets for EternaBrain. We chose to use convolutional neural network (CNN) architectures, because of their success in other areas of game playing and machine learning [<xref ref-type="bibr" rid="pcbi.1007059.ref013">13</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref014">14</xref>] and also because of their expected ability to capture patterns visually recognized by humans during actual Eterna gameplay. A CNN [<xref ref-type="bibr" rid="pcbi.1007059.ref024">24</xref>] is a specific type of neural network that hierarchically builds up complex features from simpler features that neighbor each other. CNNs consist of convolutional and pooling layers which retrieve subsections of the input features and make their own larger-scale features. A CNN is a natural choice for tackling this problem because it mimics how human participants approach Eterna puzzles; that is, by learning features of the data from spatial information such as those seen in the puzzle interface and in solution browsers. Our work involves supervised learning: the CNN’s features and relationships were randomly initialized and then iteratively trained on large input datasets (training sets) and assessed for their predictive power when applied to previously unseen datasets (test sets).</p>
<p>We first trained the model on a large data set of 1.8 million moves spanning 12 representative puzzles from the Eterna progression (<xref ref-type="supplementary-material" rid="pcbi.1007059.s002">S1 Fig</xref>), which we call the <italic>eternamoves-large</italic> data set. The information in player move set data includes nucleotide sequence, RNA secondary structure (in ‘dot-bracket’ notation widely used in the RNA literature [<xref ref-type="bibr" rid="pcbi.1007059.ref025">25</xref>]), and predicted minimum Gibbs free energy of folding. These data on the game state are passed as input features to the CNN (<xref ref-type="table" rid="pcbi.1007059.t001">Table 1</xref>). The location of the player’s chosen nucleotide change and the nucleotide identity itself were passed as labels to the CNN–they are the output to be predicted (<xref ref-type="table" rid="pcbi.1007059.t001">Table 1</xref>). We chose to train one ‘base predictor’ CNN (BP-CNN) to predict the identity of the base change (e.g. A, U, C, or G) made by a player provided the location of the change; as well as a separate ‘location predictor’ CNN (LP-CNN) to predict the location of the change. For the BP-CNN, we did not require that the neural network change the base nor that it maintain Watson-Crick pairing at nucleotides that were supposed to be paired in the target structure. Doing so provided a means to assess if the neural network could independently derive these fundamental move requirements. For cross-validation, we randomly split the data into training and test sets (see <xref ref-type="sec" rid="sec011">Methods</xref>). Training took three days using 4 NVidia Titan X GPUs.</p>
<table-wrap id="pcbi.1007059.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007059.t001</object-id>
<label>Table 1</label> <caption><title>Input features used for training and testing EternaBrain convolutional neural network.</title></caption>
<alternatives>
<graphic id="pcbi.1007059.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Description</th>
<th align="left">Example</th>
<th align="left">Encoded example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Base Sequence</td>
<td align="left">CCAGAAAAAAAAACUGG</td>
<td align="left">[[0, 0, 0, 1], [0, 0, 0, 1], [1, 0, 0, 0], [0, 0, 1, 0], [1, 0, 0, 0], [1, 0, 0, 0], [1, 0, 0, 0], [1, 0, 0, 0], [1, 0, 0, 0], [1, 0, 0, 0], [1, 0, 0, 0], [1, 0, 0, 0], [1, 0, 0, 0], [0, 0, 0, 1], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 1, 0]]</td>
</tr>
<tr>
<td align="left">Predicted (‘Nature Mode’) Structure in dot-bracket notation</td>
<td align="left">((((.........)))) (dot-bracket)<break/></td>
<td align="left">2,2,2,2,1,1,1,1,1,1,1,1,1,1,3,3,3,3</td>
</tr>
<tr>
<td align="left">Target Structure in dot-bracket notation</td>
<td align="left">(((((.........))))) (dot-bracket)</td>
<td align="left">2,2,2,2,2,1,1,1,1,1,1,1,1,3,3,3,3,3</td>
</tr>
<tr>
<td align="left">Predicted Structure Energy</td>
<td align="left">-2.2 kcal/mol</td>
<td align="left">-2.2</td>
</tr>
<tr>
<td align="left">Target Energy</td>
<td align="left">4.9 kcal/mol</td>
<td align="left">4.9</td>
</tr>
<tr>
<td align="left">Predicted Structure in pairmap notation*</td>
<td align="left">((((.........)))) (pairmap)</td>
<td align="left">16,15,14,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,1,0</td>
</tr>
<tr>
<td align="left">Target Structure in pairmap notation*</td>
<td align="left">(((((.........))))) (pairmap)</td>
<td align="left">16,15,14,13,12,-1,-1,-1,-1,-1,-1,-1,4,3,2,1,0</td>
</tr>
<tr>
<td align="left">Locked bases</td>
<td align="left">xooooooooooooooox</td>
<td align="left">2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>* Additional features used for training on <italic>eternamoves</italic>-<italic>select</italic> and not <italic>eternamoves-large</italic> data set.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Random guessing of moves would give accuracies of 0.33 for the BP-CNN (if the base is forced to change from its starting identity to one of the three other bases) and 0.019 for the LP-CNN (based on the average inverse length of the puzzles). Our best training attempts achieved move accuracies for the BP-CNN and LP-CNN of 0.50 and 0.10, respectively on the training dataset- both higher than random guessing. However, when applied to the test dataset, the BP-CNN and LP-CNN achieved move accuracies of 0.34 and 0.021, respectively, which are not significantly better than random guessing. Furthermore, we discovered poor results in subsequent tests of this model applied to full puzzle playouts. In these playouts, we had the CNN predict both the identity and location of the move starting from its initial sequence. Then, we updated the puzzle state according to ViennaRNA energy calculations and repeated this process. The model was unable to solve the easiest puzzle on the Eterna100—<italic>Simple Hairpin</italic>—even with modifications to allow stochastic choice of moves after ranking by the CNN (see <xref ref-type="sec" rid="sec011">Methods</xref>).</p>
<p>The low test accuracies and problems in an actual puzzle playout suggested that the CNNs might be overfitting their parameters to the training data and not generalizing well to Eterna puzzles that were outside the dataset. To counteract this overfitting, we had the networks randomly exclude randomly chosen nodes in each of their layers (dropout) and thus reduce the chance of overfitting. However, increasing this dropout rate gave only marginal improvements in test accuracy, suggesting that there was high variance in the training data [<xref ref-type="bibr" rid="pcbi.1007059.ref026">26</xref>]. This could result if, in these 12 early Eterna puzzles, players were using a highly heterogeneous set of strategies or clicking randomly without a clear strategy. Other parameter changes to the network (e.g.. use of a single CNN to predict base and location; change in the type of neural network; number of layers; activation functions; see <xref ref-type="supplementary-material" rid="pcbi.1007059.s006">S1 Table</xref>) also did not significantly improve test accuracy. These results suggested that moves made by players across this entire set are not sufficiently similar to allow their automation, at least with the convolutional neural network architectures tested.</p>
</sec>
<sec id="sec004">
<title>Training on selected subsets of players and puzzles</title>
<p>We hypothesized that training on a select number of advanced Eterna participants would minimize the variance in the dataset. To select these ‘expert’ Eterna participants, we identified players who had solved at least 3000 Eterna puzzles. The resulting dataset contained moves from 72 players (<xref ref-type="fig" rid="pcbi.1007059.g001">Fig 1D</xref>; <xref ref-type="supplementary-material" rid="pcbi.1007059.s007">S2 Table</xref>). In addition, instead of using the 12 introductory simple puzzles used for <italic>eternamoves-large</italic> data set described above, we chose to collate moves from 78 puzzles compiled during a revision of the game’s main puzzle progression (<xref ref-type="supplementary-material" rid="pcbi.1007059.s003">S2 Fig</xref>). These puzzles were selected because they introduced key strategies used by Eterna players to solve many of the RNA design challenges on Eterna. The resulting dataset, dubbed <italic>eternamoves-select</italic>, comprised 30,447 moves. In addition to narrowing the training data to expert players and specialized puzzles, we added a more explicit representation of RNA secondary structure by introducing pairmaps. Rather than merely providing dot-bracket notation to the CNN, a structure pairmap uses indices of a list to explicitly show which bases are paired to other bases. The format of the pairmap is shown in <xref ref-type="table" rid="pcbi.1007059.t001">Table 1</xref>.</p>
<p>Combining <italic>eternamoves-select</italic> and introducing pairmaps increased the predictive power of our CNNs. The final move accuracies for cross-validation were 0.51 for the BP-CNN and 0.34 for the LP-CNN (<xref ref-type="supplementary-material" rid="pcbi.1007059.s004">S3A and S3B Fig</xref>; <xref ref-type="table" rid="pcbi.1007059.t002">Table 2</xref>) when applied to the test dataset of <italic>eternamoves-select</italic>. These move accuracies were higher than the expected random baselines for these puzzles of 0.33 and 0.031, respectively. We expected that the model’s predictive powers would negatively correlate with the puzzle length, and this trend was indeed apparent. For example, the LP-CNN accuracy dropped from 0.43 to 0.28 when going from puzzles with lengths of up to 50 nucleotides (nts) to puzzles with lengths from 101 to 150 nts; <xref ref-type="table" rid="pcbi.1007059.t003">Table 3</xref>). The BP-CNN accuracy reduced from 0.57 to 0.47 with the same increase in puzzle length (<xref ref-type="table" rid="pcbi.1007059.t003">Table 3</xref>). We also expected that the model would have higher prediction accuracy at nucleotides that involved paired regions of the target structure. In those regions, the model can correct ‘mismatches’–nucleotides that should be paired but are not A-U, G-C, or G-U–and such moves would provide obvious location and base choices. Surprisingly, our model exhibited slightly better performance in both base and location prediction in regions of the puzzle that were unpaired rather than paired in the target structure (0.62 vs. 0.49, base; 0.38 vs. 0.33, location; <xref ref-type="table" rid="pcbi.1007059.t003">Table 3</xref>).</p>
<table-wrap id="pcbi.1007059.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007059.t002</object-id>
<label>Table 2</label> <caption><title>EternaBrain CNN accuracies on <italic>eternamoves-select</italic> with different splits of training and test sets.</title></caption>
<alternatives>
<graphic id="pcbi.1007059.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Model</th>
<th align="left">Training Accuracy</th>
<th align="left">Test Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">EternaBrain—base</td>
<td align="left">0.71</td>
<td align="left">0.51</td>
</tr>
<tr>
<td align="left">EternaBrain—location</td>
<td align="left">0.31</td>
<td align="left">0.34</td>
</tr>
<tr>
<td align="left">Half experts—base</td>
<td align="left">0.66</td>
<td align="left">0.38</td>
</tr>
<tr>
<td align="left">Half experts—location</td>
<td align="left">0.30</td>
<td align="left">0.11</td>
</tr>
<tr>
<td align="left">Half puzzles—base</td>
<td align="left">0.70</td>
<td align="left">0.27</td>
</tr>
<tr>
<td align="left">Half puzzles—location</td>
<td align="left">0.33</td>
<td align="left">0.02</td>
</tr>
<tr>
<td align="left">One expert—base</td>
<td align="left">0.79</td>
<td align="left">0.25</td>
</tr>
<tr>
<td align="left">One expert—location</td>
<td align="left">0.5</td>
<td align="left">0.01</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pcbi.1007059.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007059.t003</object-id>
<label>Table 3</label> <caption><title>EternaBrain CNN accuracies on <italic>eternamoves-select</italic>, grouped by length of puzzle and paired/unpaired status of nucleotide at which move was applied.</title></caption>
<alternatives>
<graphic id="pcbi.1007059.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Length of Puzzles</th>
<th align="left">Number of Moves</th>
<th align="left">Location Accuracy</th>
<th align="left">Location Accuracy (%)</th>
<th align="left">Base Accuracy</th>
<th align="left">Base Accuracy (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>1–50</bold></td>
<td align="left">1034</td>
<td align="left">398</td>
<td align="left">38%</td>
<td align="left">537</td>
<td align="left">52%</td>
</tr>
<tr>
<td align="left"><bold>51–100</bold></td>
<td align="left">771</td>
<td align="left">232</td>
<td align="left">30%</td>
<td align="left">385</td>
<td align="left">50%</td>
</tr>
<tr>
<td align="left"><bold>101–150</bold></td>
<td align="left">1329</td>
<td align="left">346</td>
<td align="left">26%</td>
<td align="left">624</td>
<td align="left">47%</td>
</tr>
<tr>
<td align="left"><bold>151–400</bold></td>
<td align="left">313</td>
<td align="left">32</td>
<td align="left">10%</td>
<td align="left">141</td>
<td align="left">42%</td>
</tr>
<tr>
<td align="left"><bold>All</bold></td>
<td align="left">3447</td>
<td align="left">1008</td>
<td align="left">29%</td>
<td align="left">1687</td>
<td align="left">49%</td>
</tr>
<tr>
<td align="left" colspan="6"><bold>Paired</bold></td>
</tr>
<tr>
<td align="left"><bold>1–50</bold></td>
<td align="left">687</td>
<td align="left">257</td>
<td align="left">37%</td>
<td align="left">337</td>
<td align="left">49%</td>
</tr>
<tr>
<td align="left"><bold>51–100</bold></td>
<td align="left">674</td>
<td align="left">201</td>
<td align="left">29%</td>
<td align="left">324</td>
<td align="left">48%</td>
</tr>
<tr>
<td align="left"><bold>101–150</bold></td>
<td align="left">1206</td>
<td align="left">320</td>
<td align="left">27%</td>
<td align="left">557</td>
<td align="left">46%</td>
</tr>
<tr>
<td align="left"><bold>151–400</bold></td>
<td align="left">264</td>
<td align="left">23</td>
<td align="left">8%</td>
<td align="left">114</td>
<td align="left">43%</td>
</tr>
<tr>
<td align="left"><bold>All</bold></td>
<td align="left">2831</td>
<td align="left">801</td>
<td align="left">28%</td>
<td align="left">1332</td>
<td align="left">47%</td>
</tr>
<tr>
<td align="left" colspan="6"><bold>Unpaired</bold></td>
</tr>
<tr>
<td align="left"><bold>1–50</bold></td>
<td align="left">348</td>
<td align="left">141</td>
<td align="left">40%</td>
<td align="left">200</td>
<td align="left">57%</td>
</tr>
<tr>
<td align="left"><bold>51–100</bold></td>
<td align="left">96</td>
<td align="left">30</td>
<td align="left">31%</td>
<td align="left">61</td>
<td align="left">63%</td>
</tr>
<tr>
<td align="left"><bold>101–150</bold></td>
<td align="left">122</td>
<td align="left">26</td>
<td align="left">21%</td>
<td align="left">67</td>
<td align="left">55%</td>
</tr>
<tr>
<td align="left"><bold>151–400</bold></td>
<td align="left">50</td>
<td align="left">9</td>
<td align="left">18%</td>
<td align="left">27</td>
<td align="left">54%</td>
</tr>
<tr>
<td align="left"><bold>All</bold></td>
<td align="left">616</td>
<td align="left">206</td>
<td align="left">33%</td>
<td align="left">355</td>
<td align="left">58%</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The improved CNN accuracies using <italic>eternamoves-select</italic> compared to <italic>eternamoves-large</italic> suggested that moves from experienced players and on specially designed problems were sufficiently stereotyped so as to allow for CNN prediction. To further explore whether these improvements could be generalized across different puzzles or between different expert players, we split <italic>eternamoves-select</italic> into training and test sets in different ways (see <xref ref-type="table" rid="pcbi.1007059.t002">Table 2</xref>). Rather than allowing moves in the training and test sets to be drawn from the same puzzles (as above), we trained our CNNs on 15,265 moves from 39 of the 78 puzzles in our training set. The predictive accuracies on the 15,182 moves from the remaining 39 puzzles were 0.26 and 0.023 (BP-CNN and LP-CNN, respectively). These numbers were lower than for our initial CNN tests on <italic>eternamoves-select</italic>, in which the training and test set drew moves from the same puzzles. Indeed, the BP-CNN accuracy dropped below the random baseline value of 0.33 when the puzzles in the training and test set were separated. These observations indicate that the CNN predictions depend on the overlap between puzzles seen in training and testing. We next split the <italic>eternamoves-select</italic> dataset so that the moves in the training set derived from half of the expert players. The test accuracies of our models applied to the dataset of moves from the remaining half of expert players were 0.38 and 0.11. These accuracies remained above random baselines (0.33 and 0.031, respectively) and suggested that, while expert players vary in their puzzle solving styles, there are some commonalities that can be learned by the CNNs. Last, we trained our models on just 587 moves of a single expert player and tested its performance on the remaining 29,877 moves in the <italic>eternamoves-select</italic> dataset. The resulting test accuracies were 0.27 (BP-CNN) and 0.011 (LP-CNN)—significantly worse than above. However, this poor result may be due to the dramatic decrease in training data for the CNN compared to prior comparisons. Moving forward, we decided to utilize the CNN trained on our original random split of <italic>eternamoves-select</italic> across all puzzles and expert players, but taking note that its move prediction accuracy would likely depend on similarity of any new challenge puzzles to the puzzles in the training set. We named this predictor the EternaBrain CNN.</p>
</sec>
<sec id="sec005">
<title>Playouts on the Eterna100 benchmark</title>
<p>After the cross-validation tests above, we set out to solve complete puzzles with the EternaBrain CNN model trained on <italic>eternamoves-select</italic> and the stochastic playout scheme described above. Encouragingly, the model was successfully able to solve several puzzles completely, including the <italic>Simple Hairpin</italic> puzzle, which the CNN trained on <italic>eternamoves-large</italic> failed to do, as described earlier. However, EternaBrain CNN failed to solve puzzles greater than 40 nucleotides in length. Visual inspection of the CNN’s series of moves revealed minor but obvious mistakes, such as mismatched nucleotides at pairs of positions that should have been Watson-Crick paired in the target structure. In order to prevent some of these mistakes, we followed the CNN with a second stage that we called single action playout (SAP; <xref ref-type="fig" rid="pcbi.1007059.g001">Fig 1E</xref>). SAP uses six canonical strategies that are standard among Eterna players and are taught to new players during the game’s main puzzle progression (<xref ref-type="fig" rid="pcbi.1007059.g002">Fig 2</xref>). SAP traversed the puzzle to find areas that were not folding correctly, implemented the relevant strategies, and accepted the sequences if they made these specific areas of the puzzle fold correctly; <xref ref-type="fig" rid="pcbi.1007059.g002">Fig 2</xref> and Methods give more detailed descriptions of the SAP’s standard Watson-Crick pairing rule, the G-C end pair rule, the G-internal loop and hairpin-loop boosts, the U-G-U-G super boost, and the flipping pairs strategy.</p>
<fig id="pcbi.1007059.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007059.g002</object-id>
<label>Fig 2</label>
<caption>
<title>The 6 strategies included in the SAP.</title>
<p>(A) The original state of the puzzle before SAP. This represents a puzzle initiated with an arbitrary sequence of nucleotides; panel displays the target structure, where mismatched nucleotides (C-A) are highlighted. (B) The first step of the SAP is to correct mismatched pairs. Here, the cytosine nucleotides are switched to uracil to pair with adenine. (C) Changing end pairs to G-C. Changing base pairs that are at the edges of stems and flank loops to G-C pairs lowers the free energy of the molecule. (D) G-internal loop boost. The first nucleotide in an internal loop on either side is switched to a guanine. (E) U-G-U-G super boost. In an internal loop with 2 unpaired bases on either side, the 2 bases are changed to uracil and guanine, in that order, on either side. (F) G-hairpin boost. The first nucleotide in each strand of a hairpin loop is changed to a guanine. (G) Reorienting base pairs. Target base pairs that are not predicted to be folded correctly are ‘flipped’ to lower the energy of the structure. Here, alternating the A-U pairs lowers the energy of the stack. The 5’ end of each puzzle is at the top left, with the puzzle drawn counter-clockwise from that point.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.g002" xlink:type="simple"/>
</fig>
<p>We called this enhanced pipeline the EternaBrain-SAP method and tested it against the Eterna100 benchmark. These 100 puzzles span a wide range of different structural motifs but are known to be solvable in the Turner1999 energy model, which is widely used in RNA structure prediction software packages including the original RNAinverse and NUPACK [<xref ref-type="bibr" rid="pcbi.1007059.ref006">6</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref009">9</xref>]. EternaBrain-SAP was able to solve 61 of the 100 puzzles, surpassing six of the algorithms previously benchmarked with the Eterna100 puzzles (<xref ref-type="fig" rid="pcbi.1007059.g003">Fig 3A</xref>). We note, however, that newer design methods using complementary algorithmic strategies provide similar or better performance compare to EternaBrain-SAP, and these will be discussed below.</p>
<fig id="pcbi.1007059.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007059.g003</object-id>
<label>Fig 3</label>
<caption>
<title>EternaBrain performance.</title>
<p>(A) Performance of EternaBrain and 6 previously published algorithms on Eterna100 benchmark. EternaBrain solves 61/100, followed by MODENA (54/100), INFO-RNA (50/100), NUPACK (48/100), DSS-Opt (47/100), RNAinverse (28/100), and RNA-SSD (27/100). (B) Performance of Alternative Model Constructions. The CNN alone could solve only 20/100, and the SAP alone could solve 50/100. Removing various input features passed into the CNN resulted in drops in performance, confirming the importance of these features.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.g003" xlink:type="simple"/>
</fig>
<p>Importantly, both the CNN and the SAP stages were necessary for achieving this performance. Using EternaBrain’s CNN-based moves alone solves only 20 puzzles on the Eterna100. Using the SAP alone (i.e., hard-coded canonical player strategies) solves 50 puzzles on the Eterna100, 11 short of the 61 puzzles solved by the CNN-SAP combination. However, it is important to note that the puzzles become significantly more difficult, as evidenced by a steep decrease in the number of players and prior algorithms who have solved them with increasing number (<xref ref-type="fig" rid="pcbi.1007059.g003">Fig 3A</xref> and [<xref ref-type="bibr" rid="pcbi.1007059.ref010">10</xref>]); and so this represents a significant improvement over SAP alone. We confirmed that several choices that we made for the CNN architecture and game state representations (<xref ref-type="table" rid="pcbi.1007059.t001">Table 1</xref>) were important for the success of EternaBrain-SAP. Removing the sequence, the pairmap, or the dot-bracket representation as input features or not using dropout also decreased performance in Eterna100 playouts (from 61 to 51, 52, 56, and 57 puzzles solved, respectively). A puzzle-by-puzzle breakdown of the performance of the CNN alone, the SAP alone, and CNN-SAP with these reduced-input-feature training sets is given in <xref ref-type="fig" rid="pcbi.1007059.g003">Fig 3B</xref>. We also note that while EternaBrain’s CNN-based moves have a stochastic component (see <xref ref-type="sec" rid="sec011">Methods</xref>), its success on puzzles is consistent across runs using different random seeds (<xref ref-type="table" rid="pcbi.1007059.t004">Table 4</xref>).</p>
<table-wrap id="pcbi.1007059.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007059.t004</object-id>
<label>Table 4</label> <caption><title>EternaBrain-SAP performance on Eterna100 upon five additional playouts on the 61 puzzles it solved in its first run.</title></caption>
<alternatives>
<graphic id="pcbi.1007059.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.t004" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Puzzle</th>
<th align="left">Number of Times Solved out of 5</th>
<th align="left">Puzzle</th>
<th align="left">Number of Times Solved out of 5</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Simple_hairpin</td>
<td align="left">5</td>
<td align="left">medallion</td>
<td align="left">4</td>
</tr>
<tr>
<td align="left">Arabidopsis_Thaliana_6_RNA_-_Difficulty_Level_0</td>
<td align="left">5</td>
<td align="left">[RNA]_Repetitious_Sequences_8_10</td>
<td align="left">5</td>
</tr>
<tr>
<td align="left">Prion_Pseudoknot_-_Difficulty_Level_0</td>
<td align="left">5</td>
<td align="left">Documenting_repetitious_behavior</td>
<td align="left">5</td>
</tr>
<tr>
<td align="left">Human_integrated_adenovirus_-_Level_0</td>
<td align="left">4</td>
<td align="left">7_multiloop</td>
<td align="left">5</td>
</tr>
<tr>
<td align="left">The_Gammaretrovirus_Signal_-_Diffuculty_Level_0</td>
<td align="left">5</td>
<td align="left">Kyurem_7</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Saccharomyces_Cerevisiae_-_Difficulty_Level_0</td>
<td align="left">5</td>
<td align="left">JF1</td>
<td align="left">5</td>
</tr>
<tr>
<td align="left">The_fractal</td>
<td align="left">5</td>
<td align="left">multilooping_fun</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">G-C_Placement</td>
<td align="left">5</td>
<td align="left">Multiloop …</td>
<td align="left">3</td>
</tr>
<tr>
<td align="left">The_Sun</td>
<td align="left">5</td>
<td align="left">hard_Y</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Frog_Foot</td>
<td align="left">5</td>
<td align="left">Mat_-_Elements_&amp;_Sections</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">InfoRNA_test_16</td>
<td align="left">5</td>
<td align="left">Chicken_feet</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Mat_–_Martian_2</td>
<td align="left">5</td>
<td align="left">Bug_18</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">square</td>
<td align="left">5</td>
<td align="left">Fractal_star_x5</td>
<td align="left">5</td>
</tr>
<tr>
<td align="left">Six_legd_turtle_2</td>
<td align="left">5</td>
<td align="left">Crop_Circle_2</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Small_and_Easy_6</td>
<td align="left">0</td>
<td align="left">Branching_Loop</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Fractile</td>
<td align="left">5</td>
<td align="left">Bug_38</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Six_legd_turtle_2</td>
<td align="left">5</td>
<td align="left">Simple_Single_Bond</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">snoRNA_SNORD64</td>
<td align="left">5</td>
<td align="left">Taraxacumr_officinale</td>
<td align="left">5</td>
</tr>
<tr>
<td align="left">Chalk_Outline</td>
<td align="left">4</td>
<td align="left">Headless_Bug_on_Windshield</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">InfoRNA_bulge_test_9</td>
<td align="left">4</td>
<td align="left">Pokeball</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">Tilted_Russian_Cross</td>
<td align="left">5</td>
<td align="left">Variation_of_a_crop_circle</td>
<td align="left">3</td>
</tr>
<tr>
<td align="left">This_is_ACTUALLY_Small_And_Easy_6</td>
<td align="left">5</td>
<td align="left">Loop_next_to_a_Multiloop</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Shortie_4</td>
<td align="left">5</td>
<td align="left">Snowflake_4</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Shape_Test</td>
<td align="left">3</td>
<td align="left">Mat_-_Cuboid</td>
<td align="left">3</td>
</tr>
<tr>
<td align="left">The_Minitsry</td>
<td align="left">5</td>
<td align="left">Misfolded_Aptamer_6</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">stickshift_</td>
<td align="left">5</td>
<td align="left">Snowflake_3</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">U</td>
<td align="left">4</td>
<td align="left">Hard_Y_and_a_bit_more</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Still_Life_(Sunflower_In_A_Vase)</td>
<td align="left">5</td>
<td align="left">Mat_-_Lot_2–2_B</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Quasispecies_2–2_Loop_Challenge</td>
<td align="left">4</td>
<td align="left">Shapes_and_Energy</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Corner_bulge_training_</td>
<td align="left">5</td>
<td align="left">Spiral_of_5s</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Spiral</td>
<td align="left">5</td>
<td align="left">Campfire</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">InfoRNA_bulge_test</td>
<td align="left">5</td>
<td align="left">Anemone</td>
<td align="left">3</td>
</tr>
<tr>
<td align="left">Worm_1</td>
<td align="left">4</td>
<td align="left">Fractal_3</td>
<td align="left">5</td>
</tr>
<tr>
<td align="left">just_down_to_1_bulge</td>
<td align="left">3</td>
<td align="left">Kyurem_5</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Iron_Cross</td>
<td align="left">5</td>
<td align="left">Snowflake_Necklace_(_or_v2.0_)</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">loops_and_stems</td>
<td align="left">5</td>
<td align="left">Methaqualone_C16H14N2O_Structural_Representation</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Water_Strider</td>
<td align="left">5</td>
<td align="left">Cats_Toy_2</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">The_turtle(s)_move(s)</td>
<td align="left">5</td>
<td align="left">Zigzag_Semicircle</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Adenine</td>
<td align="left">5</td>
<td align="left">Short_string_4</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Tripod_5</td>
<td align="left">4</td>
<td align="left">Gladius</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Shortie_6</td>
<td align="left">5</td>
<td align="left">Thunderbolt</td>
<td align="left">4</td>
</tr>
<tr>
<td align="left">Runner_</td>
<td align="left">5</td>
<td align="left">Mutated_chicken_feet</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Recoil</td>
<td align="left">5</td>
<td align="left">Chicken_Tracks</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">[CloudBeta]_An_Arm_and_a_Leg_1.0_</td>
<td align="left">5</td>
<td align="left">Looking_Back_Again</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">[CloudBeta]_5_Adjacent_Stack_Multi-Branch_Loop</td>
<td align="left">5</td>
<td align="left">Multilooping_6</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Triple_Y</td>
<td align="left">0</td>
<td align="left">Cesspool</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Misfolded_Aptamer</td>
<td align="left">4</td>
<td align="left">Hoglafractal</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Flower_power</td>
<td align="left">0</td>
<td align="left">Bullseye</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Kudzu</td>
<td align="left">0</td>
<td align="left">Shooting_Star</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">1,2,3and4bulges</td>
<td align="left">0</td>
<td align="left">Teslagon</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec006">
<title>Performance on specific features of difficult puzzles</title>
<p>The Eterna100 benchmark puzzles showcase structural features that are difficult for RNA inverse folding algorithms to design. Comparison of EternaBrain-SAP’s performance across different puzzle types clarifies its current abilities and limitations.</p>
</sec>
<sec id="sec007">
<title>Simple motifs—Stacks, loops, hairpins</title>
<p>The EternaBrain-SAP algorithm was particularly successful at solving puzzles that contained several stacks (i.e., RNA stems), loops (i.e., internal loops or two-way junctions), and hairpins (i.e., external loops). One example of a difficult puzzle that EternaBrain’s CNN was able to solve is <italic>U</italic>. This puzzle contains several short stacks and short loops abutted next to each other (<xref ref-type="fig" rid="pcbi.1007059.g004">Fig 4A</xref>), and was not solvable by the SAP alone or by five of the six prior design algorithms (<xref ref-type="fig" rid="pcbi.1007059.g003">Fig 3A</xref>). This example suggests that EternaBrain had successfully learned from its training data how to strengthen stacks and to stabilize loops. Specifically, EternaBrain’s CNN was able to learn strategies like the G-C end pair strategy (which strengthens a base pair stack) and the G-hairpin boost (which stabilizes an internal loop); see <xref ref-type="fig" rid="pcbi.1007059.g002">Fig 2C and 2F</xref>. While these strategies are well known and, indeed, are encoded in the SAP (<xref ref-type="fig" rid="pcbi.1007059.g002">Fig 2</xref>), the EternaBrain CNN learned further patterns that were not encoded in the SAP, as is demonstrated by the inability of SAP alone to solve the puzzle <italic>U</italic> (<xref ref-type="fig" rid="pcbi.1007059.g003">Fig 3B</xref>).</p>
<fig id="pcbi.1007059.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007059.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Example EternaBrain-SAP solutions to Eterna100 puzzles.</title>
<p>(A) <italic>U</italic> solution highlights the fact that the EternaBrain CNN alone can solve puzzles with short stems. (B) <italic>Chicken Tracks</italic> solution: EternaBrain-SAP can solve puzzles with three stems intersecting in one internal loop. (C) <italic>Thunderbolt</italic> solution demonstrates that EternaBrain-SAP can solve large puzzles (400 nucleotides long) and solve loops and stems in combination. (D) <italic>Shortie 4</italic> solution shows EternaBrain-SAP can solve puzzles with multiple short stems (2 nucleotides long). (E) <italic>Shortie 6</italic> is quite similar to <italic>Shortie 4</italic>, but with the same motif (short stems) repeated. The other algorithms mentioned could not solve <italic>Shortie 6</italic> because of the repeated motifs. (F) <italic>Hard Y</italic>—target structure (left) vs nature-mode (right) structure. EternaBrain-SAP could not solve <italic>Hard Y</italic> because it required use of a little-used strategy to solve a motif called a zigzag. Since the strategy is not often used by players, the EternaBrain CNN did not learn the strategy and the strategy was not included in the SAP. In each panel, the 5’ end of each puzzle is at the top left, with the puzzle drawn counter-clockwise from that point.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Specific orientation of base pairs</title>
<p>If the puzzle contained motifs whose solutions critically depended on unique sequences, the CNN was inadequate and SAP was important for EternaBrain-SAP’s success. An example of such a puzzle was <italic>Chicken Tracks</italic> which required a very specific orientation of base pairs (<xref ref-type="fig" rid="pcbi.1007059.g004">Fig 4B</xref>). As a result, the SAP was used heavily in solving <italic>Chicken Tracks</italic>. By locating the areas that were not folding correctly and then using the canonical player strategy of reorienting base pairs, the SAP was able to find the optimal orientation of the base pairs to correctly solve <italic>Chicken Tracks</italic>.</p>
</sec>
<sec id="sec009">
<title>Repetitive structures</title>
<p>Some of EternaBrain-SAP’s successes can be attributed to its ability to solve repetitive structures better than previous automated RNA design algorithms. Example puzzles that include many repetitive structures include <italic>Thunderbolt</italic>, <italic>Shortie 4</italic>, and <italic>Shortie 6</italic> (<xref ref-type="fig" rid="pcbi.1007059.g004">Fig 4C–4E</xref>). Previous algorithms were able to solve puzzles with several stacks, such as <italic>Shortie 4</italic> (<xref ref-type="fig" rid="pcbi.1007059.g004">Fig 4D</xref>). However, when the number of stacks increased, e.g., in <italic>Shortie 6</italic> (<xref ref-type="fig" rid="pcbi.1007059.g004">Fig 4E</xref>), other algorithms struggled. EternaBrain-SAP, however, could solve both <italic>Shortie 4</italic> and <italic>Shortie 6</italic>. <italic>Thunderbolt</italic> involves repeating elements within a large structure (<xref ref-type="fig" rid="pcbi.1007059.g004">Fig 4C</xref>) and also was not solvable by prior algorithms (<xref ref-type="fig" rid="pcbi.1007059.g003">Fig 3A</xref>). Given that SAP was able to solve each of these puzzles alone (<xref ref-type="fig" rid="pcbi.1007059.g003">Fig 3B</xref>), the moveset-trained CNN of EternaBrain appears to offer little benefit over SAP alone in stabilizing repetitive structures.</p>
<p>EternaBrain-SAP’s failure to solve other puzzles in the benchmark seems, in part, to be a result of the incompleteness of the training data for the EternaBrain CNN and of the player strategies in the SAP algorithm. For example, <italic>Hard Y</italic> (<xref ref-type="fig" rid="pcbi.1007059.g004">Fig 4F</xref>), requires uncommon strategies, including a different type of boost (a stabilizer mutation at the beginning of a loop) to stabilize a special ‘zigzag’ structural motif which did not appear in the training set. The SAP was unable to solve this puzzle since reorienting bases without the required boost did not stabilize this zigzag. Training the CNN on larger movesets and incorporating more sophisticated player strategies in SAP might resolve these issues and help EternaBrain-SAP complete more complex puzzles.</p>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>EternaBrain-SAP attempts to solve the RNA secondary structure design problem by learning from a large compilation of human player moves and incorporating a special set of canonical player strategies. We decided to use a convolutional neural network (CNN) since it can be trained to extract information from the nearest neighbors of elements in the feature space, mimicking how Eterna players look at the local neighborhoods of structures and nucleotides to decide their next move. To reduce variance in the training set, we found it important to use movesets only from expert players. By reducing the full <italic>eternamoves-large</italic> moveset (1.8 million moves) to the <italic>eternamoves-select</italic> moveset (~30,000 moves), we were able to achieve test accuracies after CNN training that were better than random guesses. Notably, for the location predictor (LP-CNN), the test accuracy of 0.34 substantially exceeded the baseline prediction accuracy for random guessing (0.019).</p>
<p>Despite decreased variance from training on the <italic>eterna-select</italic> moveset, we found that the resulting EternaBrain CNN had difficulty with solving longer puzzles. Indeed, alternative splitting of test and training sets suggested that the CNNs’ prediction accuracy largely depends on similarity of puzzles in the training set with the puzzles of any new challenges. The inability to extrapolate “out of sample” has been noted to be a limitation of artificial neural networks [<xref ref-type="bibr" rid="pcbi.1007059.ref027">27</xref>]. To overcome this limitation, we added a single-action playout (SAP) algorithm based on compiled Eterna player strategies to aid the CNN model. We tested this hybrid EternaBrain-SAP algorithm on the Eterna100, and found that it could solve 61 of 100 puzzles. On one hand, this performance is better than other algorithms that had been tested on the Eterna100 at the time of development (54 of 100 was the previous maximum). On the other hand, the EternaBrain-SAP performance is similar to or worse than newer algorithms (SIMARD, sentRNA, the reinforcement learning algorithm of Eastman et al., NEMO) that have been developed concomitantly or after EternaBrain and whose performance on the Eterna100 has been reported in newer papers or preprints [<xref ref-type="bibr" rid="pcbi.1007059.ref015">15</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref016">16</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref017">17</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref018">18</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref019">19</xref>]. Furthermore, none of these methods match the level of the top ten Eterna human players, who can solve all 100 puzzles of the Eterna100 benchmark.</p>
<p>It is instructive to compare EternaBrain-SAP to the newer generation of RNA design algorithms. Like EternaBrain-SAP, the new methods SentRNA, the Eastman et al. method, and LEARNA use artificial neural networks to distill potentially useful information from gameplay and solve 80, 60, and 65 out of 100 Eterna100 puzzles, respectively [<xref ref-type="bibr" rid="pcbi.1007059.ref015">15</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref016">16</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref018">18</xref>]. SentRNA seeks to find solutions to RNA secondary design problems in ‘one shot’ rather than through EternaBrain’s iterative moves [<xref ref-type="bibr" rid="pcbi.1007059.ref018">18</xref>]. Furthermore, SentRNA differs from EternaBrain as it is trained on Eterna player’s solutions (the <italic>eternasolves</italic> data set) rather than the individual moves that lead to solutions, and it makes use of a three-layer fully-connected neural network rather than EternaBrain’s deep convolutional neural network. Despite these differences, both the SentRNA and our EternaBrain-SAP study find that neural network approaches alone give poor performance in test puzzles (in both cases solving fewer than half of the Eterna100 puzzles). The success of both studies required pipelining starting solutions from neural network approaches with hand-coded strategies that Eterna players collectively learned and ‘canonized’ in tutorial puzzles for new players. The Eastman et al. and LEARNA algorithms [<xref ref-type="bibr" rid="pcbi.1007059.ref015">15</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref016">16</xref>] are reinforcement learning methods which have not leveraged prior human solutions or strategies at all; nevertheless, both use additional hand-coded rules to enforce Watson-Crick pairing of nucleotides during design and, in the case of LEARNA, an additional refinement step. Furthermore, at least the Eastman et al. method does not learn ‘standard’ human strategies like the G-boosts (<xref ref-type="fig" rid="pcbi.1007059.g002">Fig 2</xref>), which might explain weaker performance compared to EternaBrain-SAP and SentRNA.</p>
<p>Given these initial results from neural network methods, we propose future updates that may allow automated design to reach the level of expert players and to allow for a general strategy that will work on more complex RNA design problems including multi-state switch design and 3D structure design. First, EternaBrain-SAP and SentRNA achieve success on different problems in the Eterna100. This observation suggests that the two methods could be integrated, with each one providing starter solutions for the other, or the convolutional neural network architecture from EternaBrain used as an alternative neural network for SentRNA. Second, the hand-coded player strategies used in both EternaBrain and SentRNA often involve multiple moves. These strategies could possibly be captured by the neural networks underlying all four available deep learning approaches if they are trained to make moves based not just on its current game state but also including immediately previous moves as input. For example, such training would allow EternaBrain-SAP to ensure Watson-Crick compatibility across nucleotides that are paired in the target structure, an ‘obvious’ feature that the CNN is not always recognizing and that had to be hard-coded into the Eastman et al. method and LEARNA. Finally, it is important to point out that more advanced deep learning architectures may outperform these approaches and achieve human-level performance. Recent results in protein structure prediction (13th Community Wide Experiment on the Critical Assessment of Techniques for Protein Structure Prediction, <ext-link ext-link-type="uri" xlink:href="http://predictioncenter.org/casp13/index.cgi" xlink:type="simple">http://predictioncenter.org/casp13/index.cgi</ext-link>) demonstrate how rapidly such gains are happening. These methods have benefitted strongly from large data sets drawn from the large public archives of protein sequence and structural data; for the RNA design problem, the <italic>eternamoves</italic> and <italic>eternasolves</italic> data sets provide potentially analogous data.</p>
<p>Complementary gains in automated RNA design methods may come not from fine-tuning the neural network architectures or training sets, but through adoption or integration of more completely distinct strategies. Methods like SIMARD [<xref ref-type="bibr" rid="pcbi.1007059.ref017">17</xref>][<xref ref-type="bibr" rid="pcbi.1007059.ref028">28</xref>], antaRNA [<xref ref-type="bibr" rid="pcbi.1007059.ref020">20</xref>], and MCTS-RNA [<xref ref-type="bibr" rid="pcbi.1007059.ref021">21</xref>] achieve performances similar to or slightly better than EternaBrain (54 to 67 out of 100) while using quite different but complementary simulated annealing, ant colony optimization, and Monte Carlo tree search strategies, respectively. Perhaps most strikingly, one of us (FP) has recently reported that a nested Monte Carlo (NEMO) method can solve 98/100 puzzles in the Eterna100 benchmark, only missing the last two problems, called <italic>Shooting Star</italic> and <italic>Teslagon</italic> [<xref ref-type="bibr" rid="pcbi.1007059.ref019">19</xref>]. While NEMO fills in candidate solutions from 5´ to 3´, like SentRNA, other aspects of the method are completely distinct, and NEMO does not use a neural network approach. Second, we note that human Eterna players often solve complex RNA design puzzles by manually preparing sub-puzzles and using detailed mathematical reasoning to infer solutions. Neither of these steps is recorded in the Eterna move sets or has, to our knowledge, been captured in design algorithms. Finally, other methods like RNAifold [<xref ref-type="bibr" rid="pcbi.1007059.ref004">4</xref>] and the recently presented RNAstructure <italic>Design_preselected</italic> routine [<xref ref-type="bibr" rid="pcbi.1007059.ref022">22</xref>] have yet to be tested on the Eterna100 benchmark; they may show promise on puzzles that are not solvable by other methods.</p>
<p>In addition to their prospects for achieving human-competitive performance on <italic>in silico</italic> single structure design, we speculate that CNN-based move prediction and deep learning frameworks will be useful for design of functional RNAs that work <italic>in vitro</italic> or <italic>in vivo</italic>. The Eterna project is currently soliciting designs for ligand-responsive multi-state riboswitches and for redesigning large biological RNAs like the ribosome for <italic>in vitro</italic> tests. Current computational design methods are not able to automatically provide solutions to these problems. When these computational methods are ready, datasets involving hundreds of thousands of RNA molecules are accumulating in the Eterna project [<xref ref-type="bibr" rid="pcbi.1007059.ref027">27</xref>] and should provide rich resources for training and prospective tests.</p>
</sec>
<sec id="sec011" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec012">
<title>Ethics statement</title>
<p>This study was approved by the Stanford Institutional Review Board (Approval Number 34669), and falls under “Waiver of Consent” (participants notified through Eterna End User License Agreement).</p>
</sec>
<sec id="sec013">
<title>Code availability</title>
<p>Code for training EternaBrain and solving puzzles with Eterna-SAP is freely available for non-commercial use at <ext-link ext-link-type="uri" xlink:href="https://github.com/EteRNAgame/EternaBrain" xlink:type="simple"><italic>https</italic>:<italic>//github</italic>.<italic>com/EteRNAgame/EternaBrain</italic></ext-link>.</p>
</sec>
<sec id="sec014">
<title>Data encoding</title>
<p>Through the Eterna puzzle-solving interface (<xref ref-type="fig" rid="pcbi.1007059.g001">Fig 1A–1C</xref>), players can mutate an RNA molecule’s base sequence by selecting an RNA nucleotide base (A, U, G, or C) and the location on the puzzle where they would like to make the change. Players can see the ‘target’ structure–the secondary structure they are trying to achieve–and the ‘nature-mode’ (or ‘natural’) structure–the secondary structure predicted to be the minimum free energy conformation for the current sequence. When the nature-mode and target structures match, the player has solved the puzzle. In both target and nature-mode states, players can see the predicted free energy of the molecules (in kilocalories per mole). These values are routinely used by players to guide moves that make their RNA structure more stable. These energies and structures are calculated using Vienna 1.8.5 [<xref ref-type="bibr" rid="pcbi.1007059.ref006">6</xref>], which provides the default energy model in Eterna; additional tests with newer energy functions are possible in EternaBrain but are not reported here.</p>
<p>All information given to Eterna players was encoded before being passed into the CNN (see <xref ref-type="table" rid="pcbi.1007059.t001">Table 1</xref>). Such information included the nucleotide sequence, nature-mode and target structure and pairmaps, nature-mode and target energy, and locked bases, as follows. The nucleotide bases were encoded using a standard ‘one-hot’ representation over four input layers; A, U, G, C were mapped to [1,0,0,0], [0,1,0,0], [0,0,1,0], and [0,0,0,1], respectively. Simultaneous mutations of bases were treated as separate changes, and any copying or resetting of bases sequences were encoded as [1,1,1,1] in the otherwise one-hot input for A, U, G, or C. For encoding the ‘nature-mode’ structure (minimum free energy structure predicted by Vienna 1.8.5) and target structure, dot-bracket notation was converted to one-hot representation, with unpaired bases set to zero and left- and right-paired bases set to one in three separate input layers. Another representation of the nature-mode and target structures used is structure pairmaps. Each entry in a pairmap, corresponding to a particular location in the sequence, stores the index of the base with which it forms a base pair. For example, if the base at location 1 is paired to location 10, then index 0 in the pairmap would contain the number 9, and index 9 in the pairmap would contain the number 0 (using a list starting at index 0). For training, the player’s chosen base and the location of base change were provided as labels and a standard soft-max [<xref ref-type="bibr" rid="pcbi.1007059.ref029">29</xref>] loss function computed agreement of the neural network predictions and the actual player moves. An example of the final data encoding is shown in <xref ref-type="table" rid="pcbi.1007059.t001">Table 1</xref>.</p>
</sec>
<sec id="sec015">
<title>Model construction and evaluation</title>
<p>Two CNNs were built: one for predicting the RNA base, and one for predicting the location of the base change. After running several experiments on different CNN architectures, the following architecture was used for each CNN: 10 convolutional layers (with convolution size 9 in the dimension that indexes across RNA sequence position, stride 2x2, and pooling; the number of neurons in each layer were 1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024) followed by 4 fully-connected layers (1024, 1024, 2048, 4096), a dropout rate of 0.1, a sigmoid activation function [<xref ref-type="bibr" rid="pcbi.1007059.ref030">30</xref>], minibatch size of 100 solutions, and Adam optimizer [<xref ref-type="bibr" rid="pcbi.1007059.ref031">31</xref>] to minimize the error of the neural network. A modest hyperparameter search was carried out before settling on this architecture, as described in <xref ref-type="supplementary-material" rid="pcbi.1007059.s006">S1 Table</xref>. Construction and training of CNNs were carried out using Google’s TensorFlow machine learning framework [<xref ref-type="bibr" rid="pcbi.1007059.ref032">32</xref>].</p>
<p>The models discussed in this work were trained on Nvidia Titan X GPUs available on Stanford’s Sherlock cluster.</p>
<p>For puzzle playouts, the CNN initially attempted to solve the puzzle by iteratively choosing moves and updating the game state. The number of such moves was chosen to be the length of the puzzle multiplied by three. The move choice was stochastic, with probabilities of base and location based on the respective CNN output renormalized to 1.0. If this stage was not able to solve the puzzle, the SAP was applied, implementing the player strategies in <xref ref-type="fig" rid="pcbi.1007059.g002">Fig 2</xref>. The SAP changed specific nucleotides in the puzzle according to the player strategy and compared if the nature-mode structure of the RNA more closely matched the target structure than if the player strategy had not been implemented. If the nature-mode structure more closely matched the target structure, then the resulting nucleotide sequence was kept. (For speed, closeness of two secondary structures was defined based on the length of the largest matching subsequence of the two secondary structures written in dot-bracket notation, using the SequenceMatcher class in Python.) This process was repeated for all of the player strategies. The current implementation of SAP uses a few straightforward player strategies, favoring simplicity over computational complexity (see <xref ref-type="fig" rid="pcbi.1007059.g002">Fig 2</xref>).</p>
<p>During development of the model, we evaluated the CNN using cross-validation, training on 30,000 moves and testing on the remaining moves; test moves were pulled randomly from the data set unless noted otherwise [<xref ref-type="bibr" rid="pcbi.1007059.ref029">29</xref>]. Playout tests were carried out on the 100 secondary structures of the Eterna100 benchmark [<xref ref-type="bibr" rid="pcbi.1007059.ref010">10</xref>]. To ensure fair comparison to prior work [<xref ref-type="bibr" rid="pcbi.1007059.ref010">10</xref>], we did not include puzzle constraints on, e.g., minimum or maximum number of A-U pairs, which arise in some of the Eterna100 puzzles when they are played by humans online.</p>
</sec>
<sec id="sec016">
<title>Descriptions of each SAP strategy</title>
<p>Single-action playout (SAP) consists of the application of six strategies:</p>
<list list-type="order">
<list-item><p>The first step of the SAP is to correct incorrect base pairings. The algorithm traverses the entire length of the sequence, identifying any mismatches in base pairings. Any incorrect pairings will be mutated to A-U or G-C, depending on one of the bases in the mismatch.</p></list-item>
<list-item><p>Second, the algorithm will identify any base pairs flanking a hairpin loop or an internal loop and change that base pair to G-C, since G-C pairs at the end of stacks lower the energy of that subregion.</p></list-item>
<list-item><p>Third, within any internal loop, the algorithm will change the first base on either side of the loop (see <xref ref-type="fig" rid="pcbi.1007059.g003">Fig 3B</xref>). This prevents mismatches with the flanking pairs of the stack.</p></list-item>
<list-item><p>Fourth, in any internal loop with two bases on either side, a U and a G are placed on both sides. This is a strategy (U-G-U-G ‘super-boost’) discovered by Eterna players which drastically lowers the free energy of the RNA molecule and takes advantage of a special parameter for tandem G•U’s in current RNA nearest-neighbor folding models.</p></list-item>
<list-item><p>Fifth, the SAP places a guanine at the beginning of any hairpin loop to lower the overall energy of the hairpin, again reflecting a special trend in current RNA nearest-neighbor folding models.</p></list-item>
<list-item><p>Lastly, if the puzzle is still not folding into the desired shape, the SAP will randomly flip base pairs in target helices that are not predicted to fold properly. Eterna players often do this flipping, as an incorrect orientation could potentially be the reason why that specific area is not folding correctly.</p></list-item>
</list>
<p>See <xref ref-type="fig" rid="pcbi.1007059.g002">Fig 2</xref> for illustrations of these six strategies.</p>
</sec>
<sec id="sec017">
<title>Puzzle-solving efficiency</title>
<p>The successful puzzle solution by EternaBrain-SAP would not be useful if it takes more time than experienced players to solve puzzles. <xref ref-type="supplementary-material" rid="pcbi.1007059.s005">S4 Fig</xref> shows player and EternaBrain-SAP times for puzzles of varying lengths. On one hand, EternaBrain-SAP generally takes more moves (approximately 2-fold) than top Eterna players to solve most puzzles, across all puzzle lengths. However, this disadvantage is ameliorated by the speed with which EternaBrain-SAP selects its moves: on a single 2.5 GHz dual-core Intel i5 CPU, the automated method takes less total time than top players across puzzles of varying lengths. We took random samples of 50 puzzles that both EternaBrain-SAP and players solved in order to see if there was a statistically significant difference in completion time. A two-sample t-test gave a <italic>p</italic>-value of 0.020, indicating that EternaBrain-SAP is significantly faster than players in solving Eterna puzzles despite no specific optimization for speed at this stage.</p>
</sec>
</sec>
<sec id="sec018">
<title>Supporting information</title>
<supplementary-material id="pcbi.1007059.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.s001" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>List of Eterna contributors to this study.</title>
<p>Participants who tooks part in solving the puzzles used to develop EternaBrain, with names listed in order of contributions, from most to least.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007059.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>The twelve puzzles used in the <italic>eternamoves-large</italic> dataset.</title>
<p>Most bases are adenine to represent the initial state of the puzzle before any mutations are made. Some bases that are not A represent “locked” bases which cannot be mutated. The 5’ end of each puzzle is at the top left, with the puzzle drawn counter-clockwise from that point.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007059.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>(This page and previous two pages) The 78 puzzles used in the <italic>eternamoves-select</italic> dataset.</title>
<p>Some puzzle structures are repeated because the locked bases (bases which cannot be mutated) are different for the two puzzles. The 5’ end of each puzzle is at the top left, with the puzzle drawn counter-clockwise from that point.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007059.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Training the EternaBrain convolutional neural network on <italic>eternamoves-select</italic>.</title>
<p>(A) Cross-validation accuracy of location predictor per epoch of training. (B) Cross-validation accuracy of base predictor per epoch of training. An epoch of training is one complete pass of backpropagation, retraining, and receiving feedback of performance over all 30,447 solutions (305 mini-batches of 100 solutions each).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007059.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.s005" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Time and number of moves of EternaBrain-SAP compared to Eterna human players.</title>
<p>(A) Median time and (B) number of moves needed to solve Eterna100 puzzles. Puzzles that were only solvable by Eterna human players are not shown.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007059.s006" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.s006" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Hyperparameter search for neural net architecture.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007059.s007" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007059.s007" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Number of solutions and moves for top players used in <italic>eternamoves-select</italic>.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank J. Nicol for expert technical assistance; J. Shi, M. Wu, P. Eastman, and B. Ramsundar for scientific discussions; and M. Gotrik for comments on the manuscript. We acknowledge the following Eterna participants for designing the puzzles used to develop EternaBrain: Kieros, jandersonlee, drake178, Brourd, hoglahoo, Janelle, eternacloud, Hyphema, RedSpah, nihilnove, steven123505, player4596, portalbob340, mat747, Jieux, redsoxwy, Eli Fisker, RedSimple, Malcolm, firedrake969, pdub93, ElNando888, Dennis9600, Nidoking, cake. We further acknowledge Eterna participants for taking part in solving the puzzles used to develop EternaBrain; the names of these contributors are provided in <xref ref-type="supplementary-material" rid="pcbi.1007059.s001">S1 File</xref>.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1007059.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wiedenheft</surname> <given-names>B.</given-names></name>, <name name-style="western"><surname>Sternberg</surname> <given-names>S. H.</given-names></name> &amp; <name name-style="western"><surname>Doudna</surname> <given-names>J. A.</given-names></name> <article-title>RNA-guided genetic silencing systems in bacteria and archaea</article-title>. <source><italic>Nature</italic></source> <volume>482</volume>, <fpage>331</fpage>–<lpage>338</lpage> (<year>2012</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature10886" xlink:type="simple">10.1038/nature10886</ext-link></comment> <object-id pub-id-type="pmid">22337052</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reynolds</surname> <given-names>A.</given-names></name> <etal>et al.</etal> <article-title>Rational siRNA design for RNA interference</article-title>. <source><italic>Nat</italic>. <italic>Biotechnol</italic></source>. <volume>22</volume>, <fpage>326</fpage>–<lpage>330</lpage> (<year>2004</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt936" xlink:type="simple">10.1038/nbt936</ext-link></comment> <object-id pub-id-type="pmid">14758366</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bonnet</surname> <given-names>É.</given-names></name>, <name name-style="western"><surname>Rzążewski</surname> <given-names>P.</given-names></name> &amp; <name name-style="western"><surname>Sikora</surname> <given-names>F.</given-names></name> <article-title>Designing RNA Secondary Structures is Hard</article-title>. <source><italic>Research in Computational and Molecular Biology</italic></source> <volume>248</volume> (<year>2017</year>).</mixed-citation></ref>
<ref id="pcbi.1007059.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Garcia-Martin</surname> <given-names>J. A.</given-names></name>, <name name-style="western"><surname>Clote</surname> <given-names>P.</given-names></name> &amp; <name name-style="western"><surname>Dotu</surname> <given-names>I.</given-names></name> <article-title>RNAiFOLD: a constraint programming algorithm for RNA inverse folding and molecular design</article-title>. <source><italic>J</italic>. <italic>Bioinform</italic>. <italic>Comput</italic>. <italic>Biol</italic></source>. <volume>11</volume>, <fpage>1350001</fpage> (<year>2013</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1142/S0219720013500017" xlink:type="simple">10.1142/S0219720013500017</ext-link></comment> <object-id pub-id-type="pmid">23600819</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Taneda</surname> <given-names>A.</given-names></name> <article-title>MODENA: a multi-objective RNA inverse folding</article-title>. <source><italic>Adv</italic>. <italic>Appl</italic>. <italic>Bioinform</italic>. <italic>Chem</italic></source>. <volume>4</volume>, <fpage>1</fpage>–<lpage>12</lpage> (<year>2011</year>). <object-id pub-id-type="pmid">21918633</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hofacker</surname> <given-names>I. L.</given-names></name> <article-title>Vienna RNA secondary structure server</article-title>. <source><italic>Nucleic Acids Res</italic></source>. <volume>31</volume>, <fpage>3429</fpage>–<lpage>3431</lpage> (<year>2003</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkg599" xlink:type="simple">10.1093/nar/gkg599</ext-link></comment> <object-id pub-id-type="pmid">12824340</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Busch</surname> <given-names>A.</given-names></name> &amp; <name name-style="western"><surname>Backofen</surname> <given-names>R.</given-names></name> <article-title>INFO-RNA—a server for fast inverse RNA folding satisfying sequence constraints</article-title>. <source><italic>Nucleic Acids Res</italic></source>. <volume>35</volume>, <fpage>W310</fpage>–<lpage>3</lpage> (<year>2007</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkm218" xlink:type="simple">10.1093/nar/gkm218</ext-link></comment> <object-id pub-id-type="pmid">17452349</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andronescu</surname> <given-names>M.</given-names></name>, <name name-style="western"><surname>Fejes</surname> <given-names>A. P.</given-names></name>, <name name-style="western"><surname>Hutter</surname> <given-names>F.</given-names></name>, <name name-style="western"><surname>Hoos</surname> <given-names>H. H.</given-names></name> &amp; <name name-style="western"><surname>Condon</surname> <given-names>A.</given-names></name> <article-title>A new algorithm for RNA secondary structure design</article-title>. <source><italic>J</italic>. <italic>Mol</italic>. <italic>Biol</italic></source>. <volume>336</volume>, <fpage>607</fpage>–<lpage>624</lpage> (<year>2004</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jmb.2003.12.041" xlink:type="simple">10.1016/j.jmb.2003.12.041</ext-link></comment> <object-id pub-id-type="pmid">15095976</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wolfe</surname> <given-names>B. R.</given-names></name>, <name name-style="western"><surname>Porubsky</surname> <given-names>N. J.</given-names></name>, <name name-style="western"><surname>Zadeh</surname> <given-names>J. N.</given-names></name>, <name name-style="western"><surname>Dirks</surname> <given-names>R. M.</given-names></name> &amp; <name name-style="western"><surname>Pierce</surname> <given-names>N. A.</given-names></name> <article-title>Constrained multistate sequence design for nucleic acid reaction pathway engineering</article-title>. <source><italic>J</italic>. <italic>Am</italic>. <italic>Chem</italic>. <italic>Soc</italic></source>. <volume>139</volume>, <fpage>3134</fpage>–<lpage>3144</lpage> (<year>2017</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/jacs.6b12693" xlink:type="simple">10.1021/jacs.6b12693</ext-link></comment> <object-id pub-id-type="pmid">28191938</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anderson-Lee</surname> <given-names>J.</given-names></name> <etal>et al.</etal> <article-title>Principles for predicting RNA secondary structure design difficulty</article-title>. <source><italic>J</italic>. <italic>Mol</italic>. <italic>Biol</italic></source>. <volume>428</volume>, <fpage>748</fpage>–<lpage>757</lpage> (<year>2016</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jmb.2015.11.013" xlink:type="simple">10.1016/j.jmb.2015.11.013</ext-link></comment> <object-id pub-id-type="pmid">26902426</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>J.</given-names></name> <etal>et al.</etal> <article-title>RNA design rules from a massive open laboratory</article-title>. <source><italic>Proc Natl Acad Sci USA</italic></source> <volume>111</volume>, <fpage>2122</fpage>–<lpage>2127</lpage> (<year>2014</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1313039111" xlink:type="simple">10.1073/pnas.1313039111</ext-link></comment> <object-id pub-id-type="pmid">24469816</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>W.</given-names></name> <etal>et al.</etal> <article-title>A survey of deep neural network architectures and their applications</article-title>. <source><italic>Neurocomputing</italic></source> <volume>234</volume>, <fpage>11</fpage>–<lpage>26</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="pcbi.1007059.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Silver</surname> <given-names>D.</given-names></name> <etal>et al.</etal> <article-title>Mastering the game of Go with deep neural networks and tree search</article-title>. <source><italic>Nature</italic></source> <volume>529</volume>, <fpage>484</fpage>–<lpage>489</lpage> (<year>2016</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature16961" xlink:type="simple">10.1038/nature16961</ext-link></comment> <object-id pub-id-type="pmid">26819042</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Silver</surname> <given-names>D.</given-names></name> <etal>et al.</etal> <article-title>Mastering the game of Go without human knowledge</article-title>. <source><italic>Nature</italic></source> <volume>550</volume>, <fpage>354</fpage>–<lpage>359</lpage> (<year>2017</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature24270" xlink:type="simple">10.1038/nature24270</ext-link></comment> <object-id pub-id-type="pmid">29052630</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eastman</surname> <given-names>P.</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>J.</given-names></name>, <name name-style="western"><surname>Ramsundar</surname> <given-names>B.</given-names></name> &amp; <name name-style="western"><surname>Pande</surname> <given-names>V. S.</given-names></name> <article-title>Solving the RNA design problem with reinforcement learning</article-title>. <source><italic>PLoS Comput</italic>. <italic>Biol</italic></source>. <volume>14</volume>, <fpage>e1006176</fpage> (<year>2018</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1006176" xlink:type="simple">10.1371/journal.pcbi.1006176</ext-link></comment> <object-id pub-id-type="pmid">29927936</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref016"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">Runge, F., Stoll, D., Falkner, S. &amp; Hutter, F. Learning to Design RNA. arXiv preprint arXiv:1812.11951 (2018).</mixed-citation></ref>
<ref id="pcbi.1007059.ref017"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Sav, S., Hampson, D. J. D. &amp; Tsang, H. H. SIMARD: A simulated annealing based RNA design algorithm with quality pre-selection strategies. in 2016 IEEE Symposium Series on Computational Intelligence (SSCI) 1–8 (IEEE, 2016). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/SSCI.2016.7849957" xlink:type="simple">10.1109/SSCI.2016.7849957</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1007059.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shi</surname> <given-names>J.</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R.</given-names></name> &amp; <name name-style="western"><surname>Pande</surname> <given-names>V. S.</given-names></name> <article-title>SentRNA: Improving computational RNA design by incorporating a prior of human design strategies</article-title>. <source><italic>arXiv preprint arXiv</italic></source>: <volume>1803.03146</volume> (<year>2018</year>).</mixed-citation></ref>
<ref id="pcbi.1007059.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Portela</surname> <given-names>F.</given-names></name> <article-title>An unexpectedly effective Monte Carlo technique for the RNA inverse folding problem</article-title>. <source><italic>BioRxiv</italic></source> (<year>2018</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/345587" xlink:type="simple">10.1101/345587</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1007059.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kleinkauf</surname> <given-names>R.</given-names></name>, <name name-style="western"><surname>Houwaart</surname> <given-names>T.</given-names></name>, <name name-style="western"><surname>Backofen</surname> <given-names>R.</given-names></name> &amp; <name name-style="western"><surname>Mann</surname> <given-names>M.</given-names></name> <article-title>antaRNA—Multi-objective inverse folding of pseudoknot RNA using ant-colony optimization</article-title>. <source><italic>BMC Bioinformatics</italic></source> <volume>16</volume>, <fpage>389</fpage> (<year>2015</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12859-015-0815-6" xlink:type="simple">10.1186/s12859-015-0815-6</ext-link></comment> <object-id pub-id-type="pmid">26581440</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>X.</given-names></name>, <name name-style="western"><surname>Yoshizoe</surname> <given-names>K.</given-names></name>, <name name-style="western"><surname>Taneda</surname> <given-names>A.</given-names></name> &amp; <name name-style="western"><surname>Tsuda</surname> <given-names>K.</given-names></name> <article-title>RNA inverse folding using Monte Carlo tree search</article-title>. <source><italic>BMC Bioinformatics</italic></source> <volume>18</volume>, <fpage>468</fpage> (<year>2017</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12859-017-1882-7" xlink:type="simple">10.1186/s12859-017-1882-7</ext-link></comment> <object-id pub-id-type="pmid">29110632</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bellaousov</surname> <given-names>S.</given-names></name>, <name name-style="western"><surname>Kayedkhordeh</surname> <given-names>M.</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>R. J.</given-names></name> &amp; <name name-style="western"><surname>Mathews</surname> <given-names>D. H.</given-names></name> <article-title>Accelerated RNA secondary structure design using preselected sequences for helices and loops</article-title>. <source><italic>RNA</italic></source> <volume>24</volume>, <fpage>1555</fpage>–<lpage>1567</lpage> (<year>2018</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1261/rna.066324.118" xlink:type="simple">10.1261/rna.066324.118</ext-link></comment> <object-id pub-id-type="pmid">30097542</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mathews</surname> <given-names>D. H.</given-names></name> <etal>et al.</etal> <article-title>Incorporating chemical modification constraints into a dynamic programming algorithm for prediction of RNA secondary structure</article-title>. <source><italic>Proc Natl Acad Sci USA</italic></source> <volume>101</volume>, <fpage>7287</fpage>–<lpage>7292</lpage> (<year>2004</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0401799101" xlink:type="simple">10.1073/pnas.0401799101</ext-link></comment> <object-id pub-id-type="pmid">15123812</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref024"><label>24</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Wu</surname> <given-names>J.</given-names></name> <chapter-title>Introduction to convolutional neural networks</chapter-title>. <source><italic>National Key Lab for Novel Software Technology</italic></source>. <publisher-name>Nanjing University</publisher-name>. <publisher-loc>China</publisher-loc> <volume>5–23</volume> (<year>2017</year>).</mixed-citation></ref>
<ref id="pcbi.1007059.ref025"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">Ramlan, E. I. &amp; Zauner, K.-P. An Extended Dot-Bracket-Notation for Functional Nucleic Acids. in Oesterreichische Computer Gesellschaft (eds. E, C.-V., Freund, R., Oswald, M. &amp; Salomaa, K.) 75–86 (Oesterreichische Computer Gesellschaft, 2008).</mixed-citation></ref>
<ref id="pcbi.1007059.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Srivastava</surname> <given-names>N.</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G.</given-names></name>, <name name-style="western"><surname>Krizhevsky</surname> <given-names>A.</given-names></name>, <name name-style="western"><surname>Sutskever</surname> <given-names>I.</given-names></name> &amp; <name name-style="western"><surname>Salakhutdinov</surname> <given-names>R.</given-names></name> <article-title>Dropout: A Simple Way to Prevent Neural Networks from Overfitting</article-title>. <source><italic>Journal of Machine Learning Research</italic></source> <volume>15</volume>, <fpage>1929</fpage>–<lpage>1958</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="pcbi.1007059.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Matthies</surname> <given-names>M. C.</given-names></name>, <name name-style="western"><surname>Bienert</surname> <given-names>S.</given-names></name> &amp; <name name-style="western"><surname>Torda</surname> <given-names>A. E.</given-names></name> <article-title>Dynamics in sequence space for RNA secondary structure design</article-title>. <source><italic>J</italic>. <italic>Chem</italic>. <italic>Theory Comput</italic></source>. <volume>8</volume>, <fpage>3663</fpage>–<lpage>3670</lpage> (<year>2012</year>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ct300267j" xlink:type="simple">10.1021/ct300267j</ext-link></comment> <object-id pub-id-type="pmid">26593011</object-id></mixed-citation></ref>
<ref id="pcbi.1007059.ref028"><label>28</label><mixed-citation publication-type="other" xlink:type="simple">Hampson, D. J. D. &amp; Tsang, H. H. Using matching substructures as an optimization objective for RNA design. in 2017 IEEE Symposium Series on Computational Intelligence (SSCI) 1–7 (IEEE, 2017). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/SSCI.2017.8285345" xlink:type="simple">10.1109/SSCI.2017.8285345</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1007059.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stone</surname> <given-names>M.</given-names></name> <article-title>Cross-Validatory Choice and Assessment of Statistical Predictions</article-title>. <volume>111–147</volume> (<source>Journal of the Royal Statistical Society</source>, <year>1974</year>).</mixed-citation></ref>
<ref id="pcbi.1007059.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Minai</surname> <given-names>A. A.</given-names></name> &amp; <name name-style="western"><surname>Williams</surname> <given-names>R. D.</given-names></name> <article-title>On the derivatives of the sigmoid</article-title>. <source>Neural Netw</source>. <volume>6</volume>, <fpage>845</fpage>–<lpage>853</lpage> (<year>1993</year>).</mixed-citation></ref>
<ref id="pcbi.1007059.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kingma</surname> <given-names>D. P.</given-names></name> &amp; <name name-style="western"><surname>Ba</surname> <given-names>J.</given-names></name> <article-title>Adam: A Method for Stochastic Optimization</article-title>. <source>arXiv preprint arXiv</source>: <volume>1412.6980</volume> (<year>2014</year>).</mixed-citation></ref>
<ref id="pcbi.1007059.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abadi</surname> <given-names>M.</given-names></name> <etal>et al.</etal> <article-title>Tensorflow: a system for large-scale machine learning</article-title>. <source>USENIX</source> <volume>16</volume>, <fpage>265</fpage>–<lpage>283</lpage> (<year>2016</year>).</mixed-citation></ref>
</ref-list>
</back>
</article>