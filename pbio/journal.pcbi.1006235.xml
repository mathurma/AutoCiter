<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-02105</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006235</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Biological transport</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Research design</subject><subj-group><subject>Experimental design</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov processes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Markov processes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular structures and organelles</subject><subj-group><subject>Cytoskeleton</subject><subj-group><subject>Microtubules</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>The impact of temporal sampling resolution on parameter inference for biological transport models</article-title>
<alt-title alt-title-type="running-head">Impact of temporal sampling resolution on inference for biological transport models</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2748-9921</contrib-id>
<name name-style="western">
<surname>Harrison</surname> <given-names>Jonathan U.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6304-9333</contrib-id>
<name name-style="western">
<surname>Baker</surname> <given-names>Ruth E.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Wolfson Centre for Mathematical Biology, Mathematical Institute, University of Oxford, Oxford, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Nie</surname> <given-names>Qing</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of California Irvine, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">harrison@maths.ox.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>6</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>25</day>
<month>6</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>6</issue>
<elocation-id>e1006235</elocation-id>
<history>
<date date-type="received">
<day>18</day>
<month>12</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>28</day>
<month>5</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Harrison, Baker</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006235"/>
<abstract>
<p>Imaging data has become an essential tool to explore key biological questions at various scales, for example the motile behaviour of bacteria or the transport of mRNA, and it has the potential to transform our understanding of important transport mechanisms. Often these imaging studies require us to compare biological species or mutants, and to do this we need to quantitatively characterise their behaviour. Mathematical models offer a quantitative description of a system that enables us to perform this comparison, but to relate mechanistic mathematical models to imaging data, we need to estimate their parameters. In this work we study how collecting data at different temporal resolutions impacts our ability to infer parameters of biological transport models by performing exact inference for simple velocity jump process models in a Bayesian framework. The question of how best to choose the frequency with which data is collected is prominent in a host of studies because the majority of imaging technologies place constraints on the frequency with which images can be taken, and the discrete nature of observations can introduce errors into parameter estimates. In this work, we mitigate such errors by formulating the velocity jump process model within a hidden states framework. This allows us to obtain estimates of the reorientation rate and noise amplitude for noisy observations of a simple velocity jump process. We demonstrate the sensitivity of these estimates to temporal variations in the sampling resolution and extent of measurement noise. We use our methodology to provide experimental guidelines for researchers aiming to characterise motile behaviour that can be described by a velocity jump process. In particular, we consider how experimental constraints resulting in a trade-off between temporal sampling resolution and observation noise may affect parameter estimates. Finally, we demonstrate the robustness of our methodology to model misspecification, and then apply our inference framework to a dataset that was generated with the aim of understanding the localization of RNA-protein complexes.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>We consider how the temporal resolution of imaging studies affects our ability to carry out accurate parameter estimation for a stochastic biological transport model. This model provides a mechanistic description of motile behaviour and is often used to interrogate transport processes, such as the motion of bacteria. Parameter inference is necessary to characterise different types of transport and to make predictions about biological behaviour under different conditions. Typically, observations of the transport process, at the level of individual trajectories, are made at discrete times. This can lead to errors in parameter estimation because we do not have complete trajectory information. We present a framework for Bayesian inference for these models of biological transport processes. Using this framework, we study the effects of collecting data more or less frequently, and with varying measurement noise, on what we can learn about the biological system via parameter estimation.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000266</institution-id>
<institution>Engineering and Physical Sciences Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>EP/G03706X/1</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2748-9921</contrib-id>
<name name-style="western">
<surname>Harrison</surname> <given-names>Jonathan U.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Royal Society</institution>
</funding-source>
<award-id>Wolfson Research Merit Award</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6304-9333</contrib-id>
<name name-style="western">
<surname>Baker</surname> <given-names>Ruth E.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution>Leverhulme Trust (GB)</institution>
</funding-source>
<award-id>Leverhulme Research Fellowship</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6304-9333</contrib-id>
<name name-style="western">
<surname>Baker</surname> <given-names>Ruth E.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by funding from the Engineering and Physical Sciences Research Council (EPSRC) (grant no. EP/G03706X/1) and the Biotechnology and Biological Sciences Research Council (BBSRC) (grant no. BB/R000816/1). REB is a Royal Society Wolfson Research Merit Award holder, and would like to thank the Leverhulme Trust for a Leverhulme Research Fellowship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="13"/>
<table-count count="0"/>
<page-count count="30"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-07-06</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Code implementing methods mentioned in the article are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/shug3502/pmmc_inference_for_vjps" xlink:type="simple">https://github.com/shug3502/pmmc_inference_for_vjps</ext-link> as described in the Supporting Information.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Biological transport processes occur on a wide range of spatial and temporal scales, and a common mechanism for transport involves two phases: fast active transport, and a quasi-stationary reorientation phase. This pattern of movements has been observed at a range of scales from the intracellular transport of cellular components such as mRNA particles moving on a microtubule network [<xref ref-type="bibr" rid="pcbi.1006235.ref001">1</xref>], to the run-and-tumble motion of bacteria such as <italic>Escherichia coli</italic> [<xref ref-type="bibr" rid="pcbi.1006235.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1006235.ref004">4</xref>], and the flights of birds between nesting sites [<xref ref-type="bibr" rid="pcbi.1006235.ref005">5</xref>]. To capture appropriately these two phases of motion, a class of models known as velocity jump process (VJP) models [<xref ref-type="bibr" rid="pcbi.1006235.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1006235.ref008">8</xref>] (also known as correlated random walks [<xref ref-type="bibr" rid="pcbi.1006235.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1006235.ref013">13</xref>] or Levy Walks [<xref ref-type="bibr" rid="pcbi.1006235.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1006235.ref017">17</xref>]) have been developed.</p>
<p>Estimating the parameters of these models can give us mechanistic information relating to the underlying biological process, such as the rate of reorientation. Being able to obtain accurate estimates, with appropriate uncertainty, for these parameters allows us to compare different biological species or mutants, and gain an understanding of the underlying mechanistic behaviour. Importantly, parameterising models and quantifying the uncertainty in parameter estimates, as can be achieved via Bayesian inference, enables us to use models to make quantitive predictions of behaviour in new conditions with quantifiable uncertainty. By performing experiments to test model predictions, we can evaluate the areas in which a given model fails to describe experimental data, and so iteratively refine our understanding of a given system or phenomenon.</p>
<p>In this work, we consider the effects that experimental design can have on the information we can obtain from a data set, in terms of using that data to estimate parameters of a mechanistic model. In particular, for time series data describing a biological transport process, we vary the time between successive measurements. We demonstrate a framework for estimating the parameters of a VJP model for data of this form in the presence of noise, and examine how the posterior estimates of the model parameters change for more coarsely sampled and noisier datasets. Our framework formulates the VJP model as a process with hidden states, as in a hidden Markov model (HMM), which allows us to use particle Markov Chain Monte Carlo (pMCMC) methods to perform exact Bayesian inference. We use our framework to suggest sensible experimental design choices in the context of microscopy studies, where there may be a trade-off between how frequently it is possible to image, and the noise resulting from more or less frequent observations of the process. We present a comparison between the pMCMC framework described in this work and approximate Bayesian computation (ABC) for parameter inference in this context. We demonstrate robustness to model mispecification in a situation where we attempt inference on synthetic data generated with a different model to the assumed model. Finally, we apply our method to an imaging dataset of tracks of RNA-protein complexes allowing us to estimate motility parameters for a mechanistic model.</p>
<sec id="sec002">
<title>Velocity jump process models</title>
<p>VJP models have been developed to describe biological transport processes where there is persistent or biased random motion [<xref ref-type="bibr" rid="pcbi.1006235.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref018">18</xref>]. Correlated, persistent motion is observed experimentally in a variety of contexts [<xref ref-type="bibr" rid="pcbi.1006235.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref020">20</xref>]. VJP models are most appropriate for motion consisting of multiple phases, such as a fast directed phase and a stationary or reorientation phase, and these models describe how an object moves in one direction before reorienting and moving in a new direction. This type of “run and reorientate” motion is exhibited, for example, by <italic>Escherichia coli</italic> [<xref ref-type="bibr" rid="pcbi.1006235.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref004">4</xref>], fibroblasts [<xref ref-type="bibr" rid="pcbi.1006235.ref020">20</xref>], and RNA-protein complexes [<xref ref-type="bibr" rid="pcbi.1006235.ref001">1</xref>].</p>
<p>We present here a mathematical description of a VJP model. Suppose we have a running time distribution, with probability density function (pdf) <italic>f</italic><sub><italic>τ</italic></sub>, and a waiting time distribution, with pdf <italic>f</italic><sub><italic>μ</italic></sub>. Random variables drawn from these distributions dictate the lengths of time spent in the fast active transport, or running, phase of the VJP and the reorientation phase, respectively. After the reorientation phase, a velocity for the new run is chosen according to a transition kernel, <italic>f</italic><sub><italic>v</italic></sub>. This transition kernel could incorporate a distribution of speeds as well as directions, or could rely on a fixed speed and specify only the directionality of the run. In the fixed speed case,
<disp-formula id="pcbi.1006235.e001"><alternatives><graphic id="pcbi.1006235.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mi>v</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>δ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>|</mml:mo> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mfrac> <mml:msub><mml:mi>f</mml:mi> <mml:mo>Φ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>f</italic><sub>Φ</sub> is a reorientation kernel descibing the angle change, and <italic>c</italic> is the constant running speed. For biological processes with a distinct separation of timescales between the running and reorientation phases, it is often possible to assume that reorientations between successive runs occur instantaneously and therefore neglect the reorientation phase in a model of the process [<xref ref-type="bibr" rid="pcbi.1006235.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref005">5</xref>]. Repeated simulation from this model can be used to generate trajectories of individual particles (see <xref ref-type="fig" rid="pcbi.1006235.g001">Fig 1</xref>, for example).</p>
<fig id="pcbi.1006235.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Four example VJP trajectories, simulated with a uniform reorientation kernel, running speed <italic>c</italic> = 50<italic>μ</italic>ms<sup>−1</sup>, exponential running time distribution, <italic>f</italic><sub><italic>τ</italic></sub>(<italic>t</italic>) = λ<italic>e</italic><sup>−λ<italic>t</italic></sup>, with reorientation frequency λ = 0.2 s<sup>−1</sup> and no waiting time between runs, for a duration of <italic>T</italic><sub>final</sub> = 64s.</title>
<p>These trajectories start from the origin, and are orientated initially parallel to the positive <italic>x</italic>-axis.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g001" xlink:type="simple"/>
</fig>
<p>In the simplest case, where we assume that the running time distribution is memoryless, that is, exponentially distributed, with <italic>f</italic><sub><italic>τ</italic></sub>(<italic>t</italic>) = λ exp(−λ<italic>t</italic>), the long time behaviour of the mean squared displacement scales linearly with time, <italic>t</italic> [<xref ref-type="bibr" rid="pcbi.1006235.ref002">2</xref>]. Further moments of the motion of individuals displaying such VJP behaviour have been characterised by making certain closure assumptions [<xref ref-type="bibr" rid="pcbi.1006235.ref007">7</xref>]. For the case of a more general running time distribution, with finite mean and variance, in the large time limit the probability of the particle being at position <italic>x</italic> at time <italic>t</italic> follows a diffusion equation [<xref ref-type="bibr" rid="pcbi.1006235.ref005">5</xref>].</p>
<p>In practice, VJP models are often parameterised by obtaining measurements of the effective diffusion coefficient or the mean squared displacement, and using these data to estimate the parameters of a specific running distribution [<xref ref-type="bibr" rid="pcbi.1006235.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref005">5</xref>]. Rosser et al. [<xref ref-type="bibr" rid="pcbi.1006235.ref004">4</xref>] parameterised a HMM via maximum likelihood estimation, whilst Nicosia et al. [<xref ref-type="bibr" rid="pcbi.1006235.ref021">21</xref>] fitted a hidden state random walk model to animal movement data using an expectation-maximization algorithm. These frequentist approaches can provide useful point estimates of the VJP parameters, and quantify the error in these estimates. However, Bayesian approaches can propagate uncertainty from both process noise and measurement noise, which can be crucial when dealing with noisy biological data (see <xref ref-type="fig" rid="pcbi.1006235.g001">Fig 1</xref>). In addition, they provide the added benefit that we can interpret the results of a Bayesian analysis as probabilistic statements about the model parameters. This quantification of uncertainty enables the generation of predictions of further biological behaviour using the model. In addition, we can consider the effects of noisy data measurements upon the accuracy of the inferred parameters distributions, something which has previously been difficult to deal with in practice, or has been neglected.</p>
<p>For simplicity, in this work we will assume that there is a separation of timescales between the lengths of the running and reorientation phases, such that reorientations can be considered instantaneous. In addition, we assume that the running time distribution, <italic>f</italic><sub><italic>τ</italic></sub>, is exponentially distributed, that particles run at a fixed speed, <italic>c</italic>, and the reorientation kernel is a uniform distribution on [−<italic>π</italic>, <italic>π</italic>). That is <italic>f</italic><sub><italic>τ</italic></sub>(<italic>t</italic>) = λ exp(−λ<italic>t</italic>) and <inline-formula id="pcbi.1006235.e002"><alternatives><graphic id="pcbi.1006235.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mo>Φ</mml:mo></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msub><mml:mn mathvariant="double-struck">1</mml:mn> <mml:mrow><mml:mo stretchy="false">[</mml:mo> <mml:mo>−</mml:mo> <mml:mi>π</mml:mi> <mml:mo>,</mml:mo> <mml:mi>π</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We follow the trajectory of a single, motile individual, and take, as experimental measurements, the change in angle between successive observed positions (calculated relative to the previous observed position, see <xref ref-type="fig" rid="pcbi.1006235.g002">Fig 2</xref>), subject to measurement noise drawn from a wrapped Normal distribution, <italic>N</italic>(0, <italic>σ</italic><sup>2</sup>), where <italic>σ</italic> is the magnitude of the noise. Our Bayesian inference approach will target estimation of the reorientation rate, λ, and the magnitude of the noise, <italic>σ</italic>.</p>
<fig id="pcbi.1006235.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g002</object-id>
<label>Fig 2</label>
<caption>
<title>The motile individual is observed at discrete times <italic>t</italic> = <italic>k</italic>Δ<italic>t</italic> for <italic>k</italic> ∈ {0, 1, …, <italic>T</italic>} (marked by crosses).</title>
<p>In each time interval between observations, we measure the angle change between the observed direction of travel between successive observations. We assign a hidden state to each time interval according to whether a reorientation event occurred in that time interval or not. In this example, which excludes measurement noise, there is a reorientation, through angle <italic>ϕ</italic>, between observations at times <italic>t</italic> = <italic>k</italic>Δ<italic>t</italic> and <italic>t</italic> = (<italic>k</italic> + 1)Δ<italic>t</italic>; however, the measured angle change between these observations is <italic>θ</italic><sub>1</sub>. Conversely, there is no reorientation event between observations at <italic>t</italic> = (<italic>k</italic> + 1)Δ<italic>t</italic> and <italic>t</italic> = (<italic>k</italic> + 2)Δ<italic>t</italic> and an observed angle change of <italic>θ</italic><sub>2</sub>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec003">
<title>Inference for velocity jump process models via particle Markov Chain Monte Carlo</title>
<p>Inference for partially observed Markov processes can be performed using particle Markov Chain Monte Carlo (pMCMC), as developed by Andrieu and Roberts [<xref ref-type="bibr" rid="pcbi.1006235.ref022">22</xref>] and Andrieu et al. [<xref ref-type="bibr" rid="pcbi.1006235.ref023">23</xref>]. pMCMC provides a Bayesian framework for parameter estimation by allowing samples to be drawn from the posterior distribution of the model parameters, given observed data, without needing to evaluate the likelihood function directly. For partially observed Markov process models, the model structure makes directly evaluating the likelihood difficult or expensive. (We note that VJP models can be viewed in this form by introducing hidden states, as explained in Section ‘Methods’.) Instead of evaluating the likelihood directly, we can use (unbiased) estimates of the likelihood within an MCMC algorithm. Estimating the likelihood of the observed data given certain parameters can be achieved with a particle filter (also known as a sequential Monte Carlo scheme) [<xref ref-type="bibr" rid="pcbi.1006235.ref024">24</xref>] for a fixed, finite, number of particles. The results of Andrieu et al. [<xref ref-type="bibr" rid="pcbi.1006235.ref023">23</xref>] demonstrate that, even when a finite number of particles are used in the filter to estimate the likelihood, the MCMC algorithm will still target the correct posterior distribution. These methods have been applied in the context of modelling epidemics [<xref ref-type="bibr" rid="pcbi.1006235.ref025">25</xref>] and biochemical reaction networks [<xref ref-type="bibr" rid="pcbi.1006235.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref027">27</xref>]. However, pMCMC methods for parameter inference have not previously been applied to spatial agent-based models, such as the VJP model considered here. The details of the pMCMC algorithm used is this work are given in Section ‘Methods’.</p>
</sec>
</sec>
<sec id="sec004" sec-type="materials|methods">
<title>Methods</title>
<p>We will demonstrate how to exploit pMCMC methods to obtain posterior parameter estimates for the VJP outlined in the Introduction by formulating the model within an appropriate framework that incorporates hidden states. This formulation additionally allows us to incorporate a model for measurement noise in our observations, as well as explicitly accounting for the temporal discretisation of the data. The hidden states (also known as latent variables) in our model will describe whether or not a reorientation event occurred between observations of the VJP. This is not a variable that we can observe directly, since we only measure the observed angle change. For example, in <xref ref-type="fig" rid="pcbi.1006235.g002">Fig 2</xref> there was a reorientation event between observations at <italic>t</italic> = <italic>k</italic>Δ<italic>t</italic> and <italic>t</italic> = (<italic>k</italic> + 1)Δ<italic>t</italic>, and an observed angle change of <italic>θ</italic><sub>1</sub>. On the other hand, there was no reorientation event between observations at <italic>t</italic> = (<italic>k</italic> + 1)Δ<italic>t</italic> and <italic>t</italic> = (<italic>k</italic> + 2)Δ<italic>t</italic> but still a non-zero observed angle change of <italic>θ</italic><sub>2</sub>. Note that the true reorientation angle for the reorientation event that takes place between observations at <italic>t</italic> = <italic>k</italic>Δ<italic>t</italic> and <italic>t</italic> = (<italic>k</italic> + 1)Δ<italic>t</italic> is <italic>ϕ</italic>.</p>
<p>We assume that we observe the system at times {<italic>k</italic>Δ<italic>t</italic>: <italic>k</italic> ∈ {0, 1, …, <italic>T</italic>}}, up until a final time <italic>T</italic><sub>final</sub> = <italic>T</italic>Δ<italic>t</italic>, by measuring the position of the individual of interest and recording the observed angle change. We define the hidden variable, <italic>X</italic><sub><italic>k</italic></sub>, as follows:
<disp-formula id="pcbi.1006235.e003"><alternatives><graphic id="pcbi.1006235.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="14.22636pt"/><mml:mspace width="4.pt"/><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>a</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>reorientation</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>event</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>occurred</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>during</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>[</mml:mo> <mml:mi>k</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="14.22636pt"/><mml:mspace width="4.pt"/><mml:mtext>otherwise.</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
The observed state is the observed angle change, <italic>θ</italic><sub><italic>k</italic></sub>, obtained as the difference between the observed direction of travel during [(<italic>k</italic> − 1)Δ<italic>t</italic>, <italic>k</italic>Δ<italic>t</italic>) and [<italic>k</italic>Δ<italic>t</italic>, (<italic>k</italic> + 1)Δ<italic>t</italic>), <italic>k</italic> ≥ 1, as illustrated in <xref ref-type="fig" rid="pcbi.1006235.g002">Fig 2</xref>. For example, if we directly observe as data the positions {(<italic>x</italic><sub><italic>k</italic></sub>, <italic>y</italic><sub><italic>k</italic></sub>): <italic>k</italic> ∈ {0, 1, …, <italic>T</italic>}}, then we can calculate the observed angle change as
<disp-formula id="pcbi.1006235.e004"><alternatives><graphic id="pcbi.1006235.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mtext>arctan</mml:mtext> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>:</mml:mo> <mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>T</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>}</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We illustrate the sequence of hidden and observed states in <xref ref-type="fig" rid="pcbi.1006235.g003">Fig 3</xref>, with dependence between these states given by the transition and emission probabilities, denoted <italic>β</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>ij</italic></sub>, respectively. The hidden variable, <italic>X</italic><sub><italic>k</italic></sub>, evolves according to the VJP model. Here, since we have an exponential distribution for the running time, <italic>P</italic>(reorientation event in [(<italic>k</italic> − 1)Δ<italic>t</italic>, <italic>k</italic>Δ<italic>t</italic>)) = 1 − exp(−λΔ<italic>t</italic>).</p>
<fig id="pcbi.1006235.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Hidden and observed states in a partially observed Markov process model.</title>
<p>We observe an angle change, <italic>θ</italic><sub><italic>k</italic></sub>, which is dependent on a hidden state <italic>X</italic><sub><italic>k</italic></sub> defined in <xref ref-type="disp-formula" rid="pcbi.1006235.e003">Eq (1)</xref>. This dependency is shown by the arrows between states. Here, we require dependencies on the previous hidden state, <italic>X</italic><sub><italic>k</italic>−1</sub>, since observation times will not coincide with reorientation events in general. Additionally, we introduce an extra layer of state dependencies to capture the measurement noise in this noisy biological system. We suppose that <italic>θ</italic><sub><italic>k</italic></sub> is the true observed angle change and our noisy observed version of this is <italic>z</italic><sub><italic>k</italic></sub>, with dependencies shown by the arrows.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g003" xlink:type="simple"/>
</fig>
<p>We assume that reorientation events are rare relative to the sampling rate such that λΔ<italic>t</italic> ≪ 1. This assumption allows us to neglect multiple reorientations in a single time interval, enabling us to greatly simplify the problem, so that it is tractable via the binary hidden variables <italic>X</italic><sub><italic>k</italic></sub>. We highlight that the model structure as shown in <xref ref-type="fig" rid="pcbi.1006235.g003">Fig 3</xref> is an approximation. In reality, observed data will not be a function of only the current and previous hidden states, <italic>X</italic><sub><italic>k</italic></sub> and <italic>X</italic><sub><italic>k</italic>−1</sub>, but may depend on other previous states also. The assumption that λΔ<italic>t</italic> ≪ 1 enables us to neglect dependence on earlier states.</p>
<sec id="sec005">
<title>Model without measurement noise</title>
<p>We initially make progress by simplifying the problem and its exposition via the assumption of zero measurement error. To relate the unobserved hidden state to the observed angle change, which we can measure, we derive probability distributions for the angle change given the hidden state. Note that there is additional dependence not only on the current hidden state, but also on the previous hidden states, as shown in <xref ref-type="fig" rid="pcbi.1006235.g003">Fig 3</xref>. We can obtain expressions for the emission probabilities by considering the path that is taken under different sequences of hidden states (<xref ref-type="fig" rid="pcbi.1006235.g004">Fig 4</xref>); we will outline simplifying assumptions as they are made.</p>
<fig id="pcbi.1006235.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Example paths for each pattern of hidden states.</title>
<p>The particle of interest moves from left to right, and is observed at times (<italic>k</italic> − 1)Δ<italic>t</italic>, <italic>k</italic>Δ<italic>t</italic>, and (<italic>k</italic> + 1)Δ<italic>t</italic>. In a), there are no reorientation events, so the particle continues along a straight trajectory. In b), there is a single reorientation in the time interval [<italic>k</italic>Δ<italic>t</italic>, (<italic>k</italic> + 1)Δ<italic>t</italic>), where the particle turns through an angle <italic>ϕ</italic>, but the observed angle change is <italic>θ</italic><sub>1</sub> due to the discrete nature of the observations. In c), there is a single reorientation in the time interval [(<italic>k</italic> − 1)Δ<italic>t</italic>, <italic>k</italic>Δ<italic>t</italic>). The particle turns through an angle <italic>ϕ</italic> and continues on its new trajectory. We observe an angle change <italic>θ</italic><sub>1</sub> for the time interval [(<italic>k</italic> − 1)Δ<italic>t</italic>, <italic>k</italic>Δ<italic>t</italic>), and observe an angle change <italic>θ</italic><sub>2</sub> for the next time interval [<italic>k</italic>Δ<italic>t</italic>, (<italic>k</italic> + 1)Δ<italic>t</italic>) even though there was no reorientation during this time interval. Similarly, in d), there was a reorientation of true angle change <italic>ϕ</italic> during [(<italic>k</italic> − 1)Δ<italic>t</italic>, <italic>k</italic>Δ<italic>t</italic>) followed by another reorientation of true angle change <italic>ϕ</italic>′ in the time interval [<italic>k</italic>Δ<italic>t</italic>, (<italic>k</italic> + 1)Δ<italic>t</italic>). In this case, we observe angle change <italic>θ</italic><sub>1</sub> for the time interval [(<italic>k</italic> − 1)Δ<italic>t</italic>, <italic>k</italic>Δ<italic>t</italic>), and observe an angle change of <inline-formula id="pcbi.1006235.e005"><alternatives><graphic id="pcbi.1006235.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for the time interval [<italic>k</italic>Δ<italic>t</italic>, (<italic>k</italic> + 1)Δ<italic>t</italic>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g004" xlink:type="simple"/>
</fig>
<p>Suppose we observe the system at times (<italic>k</italic> − 1)Δ<italic>t</italic>, <italic>k</italic>Δ<italic>t</italic>, and (<italic>k</italic> + 1)Δ<italic>t</italic> for some <italic>k</italic>, as shown in <xref ref-type="fig" rid="pcbi.1006235.g004">Fig 4</xref>. The sequence of hidden states <italic>i</italic>, <italic>j</italic>, corresponds to whether there were reorientation events in the time intervals [(<italic>k</italic> − 1)Δ<italic>t</italic>, <italic>k</italic>Δ<italic>t</italic>) and [<italic>k</italic>Δ<italic>t</italic>, (<italic>k</italic> + 1)Δ<italic>t</italic>), respectively. Let <italic>p</italic><sub><italic>ij</italic></sub>(<italic>θ</italic>) be the pdf of observing a reorientation angle of <italic>θ</italic> given the sequence of hidden states <italic>i</italic>, <italic>j</italic>. We assume angle change <italic>θ</italic> was observed over the time interval [<italic>k</italic>Δ<italic>t</italic>, (<italic>k</italic> + 1)Δ<italic>t</italic>) corresponding to the hidden state <italic>j</italic>. In the case where no reorientation occurs in either of the time intervals (corresponding to the situation in <xref ref-type="fig" rid="pcbi.1006235.g004">Fig 4a)</xref>), then, assuming no noise, we would observe zero angle change. That is, we have <italic>p</italic><sub>00</sub>(<italic>θ</italic>) = <italic>δ</italic><sub>0</sub>(<italic>θ</italic>). If a reorientation occurs in the time interval [<italic>k</italic>Δ<italic>t</italic>, (<italic>k</italic> + 1)Δ<italic>t</italic>), but not in the preceding time interval, [(<italic>k</italic> − 1)Δ<italic>t</italic>, <italic>k</italic>Δ<italic>t</italic>), (as shown in <xref ref-type="fig" rid="pcbi.1006235.g004">Fig 4b)</xref>), then the observed reorientation angle is <italic>θ</italic><sub>1</sub>, as labelled in <xref ref-type="fig" rid="pcbi.1006235.g004">Fig 4b</xref>). This gives <inline-formula id="pcbi.1006235.e006"><alternatives><graphic id="pcbi.1006235.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mspace width="4pt"/><mml:mo>≔</mml:mo><mml:mspace width="4pt"/><mml:msub><mml:mi>p</mml:mi> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The marginal distribution of Θ<sub>1</sub> is derived in the Section ‘Derivation of emission probabilities’, and depends on the running time distribution and the reorientation kernel.</p>
<p>If, immediately after a reorientation, we have no reorientation in the following time interval, then we may still observe a nonzero angle change since our discrete observation times do not in general coincide with the reorientation events. In this case, we have a reorientation event during [(<italic>k</italic> − 1)Δ<italic>t</italic>, <italic>k</italic>Δ<italic>t</italic>), and no reorientation during [<italic>k</italic>Δ<italic>t</italic>, (<italic>k</italic> + 1)Δ<italic>t</italic>). Such a situation with a pattern of hidden states 1,0 is shown in <xref ref-type="fig" rid="pcbi.1006235.g004">Fig 4c)</xref>, and the observed angle change during the time interval [<italic>k</italic>Δ<italic>t</italic>, (<italic>k</italic> + 1)Δ<italic>t</italic>) corresponds to <italic>θ</italic><sub>2</sub> in the diagram. We note that, by geometric arguments, we have
<disp-formula id="pcbi.1006235.e007"><alternatives><graphic id="pcbi.1006235.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>ϕ</italic> is the true angle change. Therefore, given a pattern of hidden states 1, 0 the angles <italic>θ</italic><sub>1</sub> and <italic>θ</italic><sub>2</sub> are not independent, and we have <inline-formula id="pcbi.1006235.e008"><alternatives><graphic id="pcbi.1006235.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:msub><mml:mo>Θ</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Note that throughout we will assume that we can observe the previous angle change directly, which is equivalent to assuming that the pattern of hidden states is in fact 0, 1, 0.</p>
<p>The remaining cases involve reorientation events in successive time intervals. Suppose we have the case where we have two successive reorientation events, giving a pattern of hidden states 1, 1, which is shown graphically in <xref ref-type="fig" rid="pcbi.1006235.g004">Fig 4d)</xref>. This case is similar to the case with hidden states 1, 0 (see <xref ref-type="fig" rid="pcbi.1006235.g004">Fig 4c)</xref>), in that we observe a contribution to the reorientation angle, <italic>θ</italic><sub>2</sub>, from the correction for the previous reorientation event, and also a contribution from the new reorientation event, <inline-formula id="pcbi.1006235.e009"><alternatives><graphic id="pcbi.1006235.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>. As can be seen in <xref ref-type="fig" rid="pcbi.1006235.g004">Fig 4d)</xref>, these contributions sum to give an observed angle change for the time interval [<italic>k</italic>Δ<italic>t</italic>, (<italic>k</italic> + 1)Δ<italic>t</italic>) of <inline-formula id="pcbi.1006235.e010"><alternatives><graphic id="pcbi.1006235.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi>θ</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. The probability density for sums of random variables can be expressed as a convolution [<xref ref-type="bibr" rid="pcbi.1006235.ref028">28</xref>]. Hence, <inline-formula id="pcbi.1006235.e011"><alternatives><graphic id="pcbi.1006235.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:msub><mml:mo>Θ</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where * is the convolution operator. Any further cases involve multiple reorientation events within a single time interval which occurs rarely, with probability on the order of <inline-formula id="pcbi.1006235.e012"><alternatives><graphic id="pcbi.1006235.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We can safely neglect these provided λΔ<italic>t</italic> ≪ 1.</p>
<p>To summarise therefore, the emission probabilities (that is the probability of observing a certain angle change given the sequence of hidden states) in the case without noise can be given as follows:
<disp-formula id="pcbi.1006235.e013"><alternatives><graphic id="pcbi.1006235.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable columnalign="left" displaystyle="true"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mn>00</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mn>01</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mn>10</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:msub><mml:mo>Θ</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mn>11</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:msub><mml:mo>Θ</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mo>Θ</mml:mo> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</sec>
<sec id="sec006">
<title>Model with measurement noise</title>
<p>To account for noise, we introduce another layer of states in our diagram of state dependencies, as shown in <xref ref-type="fig" rid="pcbi.1006235.g003">Fig 3</xref>. Let <italic>z</italic><sub><italic>k</italic></sub> be the noisy observed angle change at time <italic>k</italic>Δ<italic>t</italic>, which is a noisy observation of <italic>θ</italic><sub><italic>k</italic></sub>, such that for a noise model <italic>K</italic> we have <italic>z</italic><sub><italic>k</italic></sub> ∼ <italic>K</italic>(⋅, <italic>θ</italic><sub><italic>k</italic></sub>). Alternatively, we can write the noisy observed angle as
<disp-formula id="pcbi.1006235.e014"><alternatives><graphic id="pcbi.1006235.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>ϵ</italic><sub><italic>k</italic></sub> ∼ <italic>K</italic>(⋅, 0). Under the assumption of a wrapped normal noise model, <italic>ϵ</italic><sub><italic>k</italic></sub> ∼ <italic>N</italic>(0, <italic>σ</italic><sup>2</sup>), where <italic>σ</italic> is the magnitude of the measurement noise. Since <xref ref-type="disp-formula" rid="pcbi.1006235.e014">Eq (3)</xref> represents <italic>z</italic><sub><italic>k</italic></sub> as a sum of random variables, it becomes clear that we can obtain the noisy emission probabilities, <italic>q</italic><sub><italic>ij</italic></sub>, corresponding to a pattern of hidden states <italic>i</italic>, <italic>j</italic> via the following convolution:
<disp-formula id="pcbi.1006235.e015"><alternatives><graphic id="pcbi.1006235.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mo>Θ</mml:mo></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2pt"/><mml:mtext>d</mml:mtext><mml:mi>x</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
To extend our previous results to the noisy case, we therefore need to compute these convolutions, a task that must be carried out numerically.</p>
</sec>
<sec id="sec007">
<title>Derivation of emission probabilities</title>
<p>In previous work [<xref ref-type="bibr" rid="pcbi.1006235.ref029">29</xref>], marginal distributions for the observed angle change, Θ<sub>1</sub>, were obtained and we summarise the arguments here. <xref ref-type="fig" rid="pcbi.1006235.g005">Fig 5</xref> shows the true angle change, Φ, and the observed angle change, Θ<sub>1</sub>, based on discrete time observations of the VJP for the case of hidden states 0, 1.</p>
<fig id="pcbi.1006235.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g005</object-id>
<label>Fig 5</label>
<caption>
<title>True and observed angle changes (Φ and Θ<sub>1</sub>, respectively) based on discrete time observations of a VJP without measurement error.</title>
<p>Cartesian co-ordinates <italic>X</italic> and <italic>Y</italic> are shown in addition to polar co-ordinates <italic>R</italic> and Θ<sub>1</sub>. The particle is moving along the trajectory from left to right as shown by the arrows.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g005" xlink:type="simple"/>
</fig>
<p>By changing co-ordinates from the displacement, <italic>L</italic>, (which is given by the running time distribution <italic>f</italic><sub><italic>τ</italic></sub>) and true angle change, Φ, to Cartesian co-ordinates <italic>X</italic> and <italic>Y</italic>, and then to polar co-ordinates, <italic>R</italic> and Θ<sub>1</sub>, we can obtain a joint distribution for <italic>R</italic> and Θ<sub>1</sub> of
<disp-formula id="pcbi.1006235.e016"><alternatives><graphic id="pcbi.1006235.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mi>r</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>r</mml:mi> <mml:mtext>cos</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:msub><mml:mi>f</mml:mi> <mml:mo>Φ</mml:mo></mml:msub> <mml:mo>(</mml:mo> <mml:mtext>arccos</mml:mtext> <mml:mo>[</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msup><mml:mtext>sin</mml:mtext> <mml:mn>2</mml:mn></mml:msup> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>r</mml:mi> <mml:mtext>cos</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:msup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msup><mml:mtext>sin</mml:mtext> <mml:mn>2</mml:mn></mml:msup> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>r</mml:mi> <mml:mtext>cos</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="99.58464pt"/><mml:mtext>otherwise,</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>C</italic> = {<italic>r</italic> ≤ <italic>c</italic>Δ<italic>t</italic>, <italic>θ</italic> ∈ [−<italic>π</italic>, <italic>π</italic>)} is the set of permissible values for <italic>r</italic> and <italic>θ</italic>, Δ<italic>t</italic> is the discretisation in time and <italic>c</italic> is the running speed. Integrating <inline-formula id="pcbi.1006235.e017"><alternatives><graphic id="pcbi.1006235.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> over <italic>r</italic> allows us to obtain the marginal distribution for <italic>θ</italic><sub>1</sub> via
<disp-formula id="pcbi.1006235.e018"><alternatives><graphic id="pcbi.1006235.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mtext>d</mml:mtext> <mml:mi>r</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
In the case where we assume a uniform reorientation kernel, <inline-formula id="pcbi.1006235.e019"><alternatives><graphic id="pcbi.1006235.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mo>Φ</mml:mo></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msub><mml:mn mathvariant="double-struck">1</mml:mn> <mml:mrow><mml:mo stretchy="false">[</mml:mo> <mml:mo>−</mml:mo> <mml:mi>π</mml:mi> <mml:mo>,</mml:mo> <mml:mi>π</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, then this integral becomes
<disp-formula id="pcbi.1006235.e020"><alternatives><graphic id="pcbi.1006235.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mo>Θ</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>c</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mtext>cos</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="1pt"/><mml:mtext>d</mml:mtext><mml:mi>r</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>c</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mtext>cos</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>cos</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>cos</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>r</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>c</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mtext>cos</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>cos</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>cos</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mrow><mml:mtext>cos</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>cos</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>cos</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
We note that the marginal distribution for <italic>θ</italic><sub>1</sub> does not depend on the speed, <italic>c</italic>, or the time discretisation, Δ<italic>t</italic>. This is intuitive because <inline-formula id="pcbi.1006235.e021"><alternatives><graphic id="pcbi.1006235.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula> is the pdf of a certain observed angle change, <italic>θ</italic><sub>1</sub>, given there was a reorientation in that interval, irrespective of the length of that interval.</p>
<sec id="sec008">
<title>Derivation of the joint distribution of Θ<sub>1</sub> and Θ<sub>2</sub></title>
<p>By considering the displacement in the <italic>X</italic> and <italic>Y</italic> directions during a time step, we have
<disp-formula id="pcbi.1006235.e022"><alternatives><graphic id="pcbi.1006235.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>r</mml:mi> <mml:mtext>cos</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi> <mml:mo>)</mml:mo> <mml:mtext>cos</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>r</mml:mi> <mml:mtext>sin</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi> <mml:mo>)</mml:mo> <mml:mtext>sin</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Dividing these expressions, we can relate <italic>θ</italic><sub>1</sub> to <italic>l</italic> and <italic>ϕ</italic> by
<disp-formula id="pcbi.1006235.e023"><alternatives><graphic id="pcbi.1006235.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>tan</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi> <mml:mo>)</mml:mo> <mml:mtext>sin</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi> <mml:mo>)</mml:mo> <mml:mtext>cos</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
and rearranging for <italic>l</italic>, we have
<disp-formula id="pcbi.1006235.e024"><alternatives><graphic id="pcbi.1006235.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>(</mml:mo> <mml:mtext>tan</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>-</mml:mo> <mml:mtext>tan</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mtext>tan</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>+</mml:mo> <mml:mtext>tan</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>sec</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
Differentiating with respect to <italic>θ</italic><sub>1</sub>, we obtain
<disp-formula id="pcbi.1006235.e025"><alternatives><graphic id="pcbi.1006235.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:msup><mml:mtext>sec</mml:mtext> <mml:mn>2</mml:mn></mml:msup> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mtext>tan</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>+</mml:mo> <mml:mtext>tan</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>sec</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>tan</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>-</mml:mo> <mml:mtext>tan</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mtext>sec</mml:mtext> <mml:mn>2</mml:mn></mml:msup> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>sec</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mtext>tan</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>+</mml:mo> <mml:mtext>tan</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>sec</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
which can be simplified to give
<disp-formula id="pcbi.1006235.e026"><alternatives><graphic id="pcbi.1006235.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mtext>sin</mml:mtext> <mml:mi>ϕ</mml:mi></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mtext>sin</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mtext>cos</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mtext>sin</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mtext>cos</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
To transform from coordinates (<italic>L</italic>, Φ) to coordinates (Θ<sub>1</sub>, Φ), we can use the Jacobian <italic>J</italic><sub><italic>L</italic>, Φ</sub>, where
<disp-formula id="pcbi.1006235.e027"><alternatives><graphic id="pcbi.1006235.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>det</mml:mtext> <mml:mspace width="2.84526pt"/><mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>,</mml:mo> <mml:mo>Φ</mml:mo></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mtext>sin</mml:mtext> <mml:mi>ϕ</mml:mi></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mtext>sin</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mtext>cos</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mtext>sin</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mtext>cos</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
Therefore the joint distribution of <italic>θ</italic><sub>1</sub> and <italic>ϕ</italic> is
<disp-formula id="pcbi.1006235.e028"><alternatives><graphic id="pcbi.1006235.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Φ</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo> <mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mtext>sin</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mtext>sin</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mtext>cos</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mtext>sin</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mtext>cos</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mo>.</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>ϕ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="8.53581pt"/><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="99.58464pt"/><mml:mtext>otherwise,</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>C</italic> = {(<italic>θ</italic><sub>1</sub>, <italic>ϕ</italic>):<italic>ϕ</italic> ∈ [−<italic>π</italic>, <italic>π</italic>), <italic>θ</italic> ∈ (min(0, <italic>ϕ</italic>), max(0, <italic>ϕ</italic>))}. Under the assumption that <italic>ϕ</italic> is uniform on [−<italic>π</italic>, <italic>π</italic>), as described in the Section ‘Velocity jump process models’, such that <inline-formula id="pcbi.1006235.e029"><alternatives><graphic id="pcbi.1006235.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mo>Φ</mml:mo></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msub><mml:mn mathvariant="double-struck">1</mml:mn> <mml:mrow><mml:mo stretchy="false">[</mml:mo> <mml:mo>−</mml:mo> <mml:mi>π</mml:mi> <mml:mo>,</mml:mo> <mml:mi>π</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, we have
<disp-formula id="pcbi.1006235.e030"><alternatives><graphic id="pcbi.1006235.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Φ</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo> <mml:mtext>sin</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mtext>sin</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mtext>cos</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mtext>sin</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mtext>cos</mml:mtext> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="8.53581pt"/><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="99.58464pt"/><mml:mtext>otherwise.</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
Changing variables again to (<italic>θ</italic><sub>1</sub>, <italic>θ</italic><sub>2</sub>), via <italic>ϕ</italic> = <italic>θ</italic><sub>1</sub> + <italic>θ</italic><sub>2</sub>, we have
<disp-formula id="pcbi.1006235.e031"><alternatives><graphic id="pcbi.1006235.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo> <mml:mtext>sin</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>cos</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mtext>sin</mml:mtext> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mtext>cos</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="8.53581pt"/><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>∈</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="99.58464pt"/><mml:mtext>otherwise,</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
where <italic>C</italic> = {(<italic>θ</italic><sub>1</sub>, <italic>θ</italic><sub>2</sub>): <italic>θ</italic><sub>1</sub> + <italic>θ</italic><sub>2</sub> ∈ [−<italic>π</italic>, <italic>π</italic>)}. From this joint distribution, we can then find the conditional distribution of <italic>θ</italic><sub>2</sub> given <italic>θ</italic><sub>1</sub>, which is required to give <inline-formula id="pcbi.1006235.e032"><alternatives><graphic id="pcbi.1006235.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mn>10</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
</sec>
<sec id="sec009">
<title>Particle MCMC algorithm</title>
<p>The pMCMC algorithm used in this work is given in Algorithm 1 for an observed dataset <bold>y</bold> = {<italic>y</italic><sub><italic>k</italic></sub> | <italic>k</italic> = 1, 2, …, <italic>T</italic>}. We use a Metropolis-Hastings MCMC algorithm [<xref ref-type="bibr" rid="pcbi.1006235.ref030">30</xref>], proposing new parameters using a proposal distribution <italic>q</italic>(⋅|<italic>θ</italic>). In step 6 of Algorithm 1, we need to evaluate the likelihood, <italic>p</italic>(<bold>y</bold>|<italic>θ</italic>), in calculating the acceptance probability for the proposed move. We replace the likelihood with an unbiased estimate of the likelihood, <inline-formula id="pcbi.1006235.e033"><alternatives><graphic id="pcbi.1006235.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, obtained from a particle filter.</p>
<p><bold>Algorithm 1</bold> Particle MCMC</p>
<p specific-use="line">1: Initialise parameters, <inline-formula id="pcbi.1006235.e055"><alternatives><graphic id="pcbi.1006235.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p specific-use="line">2: Run a particle filter (see Algorithm 2) to compute an estimate of the marginalised likelihood <inline-formula id="pcbi.1006235.e034"><alternatives><graphic id="pcbi.1006235.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006235.e056"><alternatives><graphic id="pcbi.1006235.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></alternatives></inline-formula> is the observed data.</p>
<p specific-use="line">3: <bold>for</bold> <inline-formula id="pcbi.1006235.e057"><alternatives><graphic id="pcbi.1006235.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:mi>j</mml:mi><mml:mspace width="2pt"/><mml:mo>=</mml:mo><mml:mspace width="2pt"/><mml:mn>1</mml:mn><mml:mspace width="2pt"/><mml:mo mathvariant="bold">:</mml:mo><mml:mspace width="2pt"/><mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> <bold>do</bold></p>
<p specific-use="line">4:  Draw parameters <inline-formula id="pcbi.1006235.e058"><alternatives><graphic id="pcbi.1006235.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>*</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> from a proposal distribution <inline-formula id="pcbi.1006235.e059"><alternatives><graphic id="pcbi.1006235.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p specific-use="line">5:  Run a particle filter to compute an estimate of the marginalised likelihood <inline-formula id="pcbi.1006235.e035"><alternatives><graphic id="pcbi.1006235.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p specific-use="line">6:  Accept the proposed move with probability <inline-formula id="pcbi.1006235.e060"><alternatives><graphic id="pcbi.1006235.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> where
<disp-formula id="pcbi.1006235.e036"><alternatives><graphic id="pcbi.1006235.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>α</mml:mi> <mml:mo>=</mml:mo> <mml:mtext>max</mml:mtext> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mfrac><mml:mrow><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p specific-use="line"> If the move is accepted, set <inline-formula id="pcbi.1006235.e061"><alternatives><graphic id="pcbi.1006235.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub>
<mml:mspace width="2pt"/><mml:mo>=</mml:mo><mml:mspace width="2pt"/><mml:mi>θ</mml:mi><mml:mo>*</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, otherwise set <inline-formula id="pcbi.1006235.e062"><alternatives><graphic id="pcbi.1006235.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub>
<mml:mspace width="2pt"/><mml:mo>=</mml:mo><mml:mspace width="2pt"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow>
<mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p specific-use="line">7: <bold>end for</bold></p>
<p><bold>Algorithm 2</bold> Bootstrap particle filter</p>
<p specific-use="line">1: Sample a collection of particles <inline-formula id="pcbi.1006235.e037"><alternatives><graphic id="pcbi.1006235.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> from an initial density <inline-formula id="pcbi.1006235.e063"><alternatives><graphic id="pcbi.1006235.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub>
<mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p specific-use="line">2: <bold>for</bold> <inline-formula id="pcbi.1006235.e064"><alternatives><graphic id="pcbi.1006235.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="2pt"/><mml:mo>=</mml:mo><mml:mspace width="2pt"/><mml:mn>1</mml:mn><mml:mspace width="2pt"/><mml:mo mathvariant="bold">:</mml:mo><mml:mspace width="2pt"/><mml:mi>M</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> <bold>do</bold></p>
<p specific-use="line">3:  Compute the weights for each particle, <inline-formula id="pcbi.1006235.e065"><alternatives><graphic id="pcbi.1006235.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>, via <inline-formula id="pcbi.1006235.e038"><alternatives><graphic id="pcbi.1006235.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi> <mml:mn>1</mml:mn> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
<p specific-use="line">4:  Find the normalised weights
<disp-formula id="pcbi.1006235.e039"><alternatives><graphic id="pcbi.1006235.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>1</mml:mn> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>w</mml:mi> <mml:mn>1</mml:mn> <mml:mi>i</mml:mi></mml:msubsup> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>w</mml:mi> <mml:mn>1</mml:mn> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p specific-use="line">5: <bold>end for</bold></p>
<p specific-use="line">6: Resample <inline-formula id="pcbi.1006235.e066"><alternatives><graphic id="pcbi.1006235.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula> times with replacement from the collection of particles <inline-formula id="pcbi.1006235.e040"><alternatives><graphic id="pcbi.1006235.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with probabilities given by the normalised weights <inline-formula id="pcbi.1006235.e041"><alternatives><graphic id="pcbi.1006235.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mn>1</mml:mn> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mn>1</mml:mn> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p specific-use="line">7: <bold>for</bold> <inline-formula id="pcbi.1006235.e067"><alternatives><graphic id="pcbi.1006235.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> <bold>do</bold></p>
<p specific-use="line">8:  <bold>for</bold> <inline-formula id="pcbi.1006235.e068"><alternatives><graphic id="pcbi.1006235.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="2pt"/><mml:mo>=</mml:mo><mml:mspace width="2pt"/><mml:mn>1</mml:mn><mml:mspace width="2pt"/><mml:mo mathvariant="bold">:</mml:mo><mml:mspace width="2pt"/><mml:mi>M</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> <bold>do</bold></p>
<p specific-use="line">9:   Evolve the current collection of particles according to the forward model, by drawing <inline-formula id="pcbi.1006235.e042"><alternatives><graphic id="pcbi.1006235.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>∼</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
<p specific-use="line">10:   Compute the weights for each particle, <inline-formula id="pcbi.1006235.e069"><alternatives><graphic id="pcbi.1006235.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>, via <inline-formula id="pcbi.1006235.e043"><alternatives><graphic id="pcbi.1006235.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
<p specific-use="line">11:   Find the normalised weights
<disp-formula id="pcbi.1006235.e044"><alternatives><graphic id="pcbi.1006235.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>i</mml:mi></mml:msubsup> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p specific-use="line">12:  <bold>end for</bold></p>
<p specific-use="line">13:  Resample <inline-formula id="pcbi.1006235.e070"><alternatives><graphic id="pcbi.1006235.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mi>M</mml:mi></mml:math></alternatives></inline-formula> times with replacement from the collection of particles <inline-formula id="pcbi.1006235.e045"><alternatives><graphic id="pcbi.1006235.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with probabilities given by the normalised weights <inline-formula id="pcbi.1006235.e046"><alternatives><graphic id="pcbi.1006235.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p specific-use="line">14: <bold>end for</bold></p>
<p specific-use="line">15: Obtain an estimate of the marginal likelihood using the unnormalised weights, via
<disp-formula id="pcbi.1006235.e047"><alternatives><graphic id="pcbi.1006235.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>M</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msubsup><mml:mi>w</mml:mi> <mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(16)</label></disp-formula></p>
<p specific-use="line">16: <bold>return</bold> <inline-formula id="pcbi.1006235.e048"><alternatives><graphic id="pcbi.1006235.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
<p>Details of the bootstrap particle filter algorithm [<xref ref-type="bibr" rid="pcbi.1006235.ref024">24</xref>] used within the pMCMC algorithm are given in Algorithm 2. A particle filter represents the state of the system via a population of weighted particles [<xref ref-type="bibr" rid="pcbi.1006235.ref031">31</xref>]. We obtain an estimate of the likelihood by successively updating the hidden state of the system (represented via the particles) and comparing this hidden state with the observed data at each observed time point, to give new weights for the particles according to how well they match the observed data. To prevent a degenerate situation where the state of the system is represented solely by a single particle, it is necessary to resample from the population of particles according to their weights.</p>
</sec>
<sec id="sec010">
<title>Implementation of Markov Chain Monte Carlo methods</title>
<p>We use a Metropolis-Hastings algorithm to run the MCMC algorithm with a bootstrap particle filter [<xref ref-type="bibr" rid="pcbi.1006235.ref024">24</xref>] using 400 particles to provide an estimate of the likelihood. As a proposal distribution, we use the kernel <italic>K</italic>(., <italic>θ</italic>) ∼ <italic>N</italic>(<italic>θ</italic>, Σ), where
<disp-formula id="pcbi.1006235.e049"><alternatives><graphic id="pcbi.1006235.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Σ</mml:mo> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We run the Markov chain for <italic>N</italic> = 50,000 steps with thinning of <italic>m</italic> = 2 which gives a minimum effective sample size of <italic>n</italic><sub>eff</sub> = 743 for the slowest chain to converge, corresponding to the smallest value of Δ<italic>t</italic>. We demonstrate the convergence of our Markov chains in <xref ref-type="supplementary-material" rid="pcbi.1006235.s005">S4 Fig</xref>. We choose the number of particles in the filter by considering the variance in estimating the log likelihood using the particle filter at the true values of the parameters used to generate the synthetic data, and balancing this with the time needed to run the particle filter to obtain a single estimate. The variance and computational cost are shown in <xref ref-type="supplementary-material" rid="pcbi.1006235.s006">S5 Fig</xref>. To further tune the number of particles for optimal efficiency of the pMCMC algorithm, the recommendations in Sherlock et al. [<xref ref-type="bibr" rid="pcbi.1006235.ref032">32</xref>] and Pitt et al. [<xref ref-type="bibr" rid="pcbi.1006235.ref033">33</xref>] could be employed. The prior is uniform on the log of the parameters over the intervals [−1.70, 1.30] and [−5, 1] for λ and <italic>σ</italic>, respectively.</p>
</sec>
<sec id="sec011">
<title>Approximate Bayesian computation</title>
<p>An alternative method commonly used for parameter estimation for models with intractable likelihoods is approximate Bayesian computation, or ABC [<xref ref-type="bibr" rid="pcbi.1006235.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref035">35</xref>]. Suppose we can simulate data from a generative model, <italic>x</italic> ∼ <italic>g</italic>(<italic>x</italic>|<italic>θ</italic>). An example would be simulating a path from our VJP model. To generate samples from the posterior distribution, we repeatedly generate parameters from the prior, <italic>θ</italic> ∼ <italic>π</italic>(<italic>θ</italic>), and use these parameters in our model to simulate synthetic data, <italic>x</italic> ∼ <italic>g</italic>(<italic>x</italic>|<italic>θ</italic>). We compare the simulated data with the true observed data and, if it is similar enough, we accept the sampled parameter as a sample from the posterior. In cases where the data are discrete, we can consider whether simulated data, <italic>x</italic>, are equal to observed data, <italic>y</italic>, and accept parameters correspondingly, which gives exact samples from the posterior. Often, though, our models provide continuous data and the acceptance rate from an exact comparison is prohibitively small. Instead we can take a distance function and consider when the distance between <italic>x</italic> and <italic>y</italic> is within a chosen tolerance <italic>ϵ</italic>, that is <italic>d</italic>(<italic>x</italic>, <italic>y</italic>) &lt; <italic>ϵ</italic>. This introduces an approximation which becomes exact only in the limit <italic>ϵ</italic> → 0.</p>
<p>In practice, datasets can be high dimensional, resulting in very low acceptance rates for simulated data. By using summary statistics of data instead of the full datasets, we can reduce the dimensionality and obtain higher acceptance rates. Using (insufficient) summary statistics introduces another approximation into the method, meaning we compare <italic>d</italic>(<italic>s</italic>(<italic>x</italic>), <italic>s</italic>(<italic>y</italic>)) &lt; <italic>ϵ</italic>, where <italic>s</italic>(<italic>x</italic>) gives the summary statistics for dataset <italic>x</italic>. We present the ABC method in Algorithm 3, and will show a comparison between application of pMCMC and ABC for parameter estimation of a VJP model based on time series data.</p>
<p><bold>Algorithm 3</bold> ABC rejection sampling</p>
<p specific-use="line">1: Sample parameter value <inline-formula id="pcbi.1006235.e071"><alternatives><graphic id="pcbi.1006235.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mi>θ</mml:mi></mml:math></alternatives></inline-formula> from the prior <inline-formula id="pcbi.1006235.e072"><alternatives><graphic id="pcbi.1006235.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p specific-use="line">2: Generate synthetic dataset from the model <inline-formula id="pcbi.1006235.e073"><alternatives><graphic id="pcbi.1006235.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p specific-use="line">3: Accept sample <inline-formula id="pcbi.1006235.e074"><alternatives><graphic id="pcbi.1006235.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mi>θ</mml:mi></mml:math></alternatives></inline-formula> if <inline-formula id="pcbi.1006235.e075"><alternatives><graphic id="pcbi.1006235.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mspace width="2pt"/><mml:mo>&lt;</mml:mo><mml:mspace width="2pt"/><mml:mi>ϵ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, for a distance function, <inline-formula id="pcbi.1006235.e076"><alternatives><graphic id="pcbi.1006235.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, summary statistics, <inline-formula id="pcbi.1006235.e077"><alternatives><graphic id="pcbi.1006235.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and tolerance <inline-formula id="pcbi.1006235.e078"><alternatives><graphic id="pcbi.1006235.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:mi>ϵ</mml:mi></mml:math></alternatives></inline-formula>.</p>
<p>In practice, the choice of summary statistics can have a strong effect on the efficiency of the ABC algorithm. Here, we perform ABC with three different choices of summary statistic. First, we consider using the full data, a vector of the noisy observed angle changes, <italic>z</italic><sub><italic>i</italic></sub>, <italic>i</italic> = 1, …, <italic>T</italic>. Second, we use a simple threshold-based summary statistic which produces a count of the number of observed angle changes with magnitude above a certain threshold, <italic>h</italic>. That is <inline-formula id="pcbi.1006235.e050"><alternatives><graphic id="pcbi.1006235.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mn mathvariant="double-struck">1</mml:mn> <mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>&gt;</mml:mo> <mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. This provides an intuitive one-dimensional summary statistic. Finally, we use a transition matrix as a summary statistic of the data, an approach described by Jones et al. [<xref ref-type="bibr" rid="pcbi.1006235.ref013">13</xref>]. A transition matrix allows us to summarise time series data via a two-dimensional binning of the observed angle changes, based on the current observed angle change and the previous observed angle change. We bin the observed angle change time series data into an <italic>n</italic> by <italic>n</italic> matrix, where <italic>n</italic> = 5. This summary statistic provides a much lower dimensional summary of the data for small values of Δ<italic>t</italic>, although for large values of Δ<italic>t</italic> we may end up with higher dimensional (sparse) data compared to the full time series data, as in this case there will be fewer than <italic>n</italic><sup>2</sup> observations. The distance function, <italic>d</italic>(<italic>s</italic>(<italic>x</italic>), <italic>s</italic>(<italic>y</italic>)), used also plays a role in the parameter estimation possible via ABC, and has been investigated in other work [<xref ref-type="bibr" rid="pcbi.1006235.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006235.ref038">38</xref>].</p>
<p>In using Algorithm 3, we generate <italic>N</italic> = 1,000,000 synthetic datasets based on parameters sampled from the prior, calculate the Euclidean distance between these synthetic datasets and our observed data, and select the parameters corresponding to the 0.1% of the datasets closest to the observed data. As for the pMCMC approach, we take a duration of time series <italic>T</italic><sub>final</sub> = 64s, and a prior uniform on the log of the parameters on the intervals [−1.70, 1.30] and [−5, 1] for λ and <italic>σ</italic>, respectively.</p>
</sec>
</sec>
<sec id="sec012" sec-type="results">
<title>Results</title>
<p>We are able to investigate the effects of experimental design such as the discretisation, Δ<italic>t</italic>, of a time series on the estimated biophysical parameters, using the framework for inferring the parameters of a VJP described in the Section ‘Methods’. We demonstrate the effects of restrictions imposed by experimental constraints on a trade-off between discretisation in time versus measurement noise. Our results can be used to provide guidance for experimental design choices. As we vary experimental design hyperparameters, such as Δ<italic>t</italic>, we will produce a separate posterior distribution for each of the model parameters, λ and <italic>σ</italic>, for each value of the hyperparameter. This approach allows us to illustrate directly the effects of the experimental design hyperparameter on the inferred posterior distributions.</p>
<sec id="sec013">
<title>Increasing Δ<italic>t</italic> results in an abrupt breakdown in the posterior</title>
<p>We first assume that the magnitude of the noise on the observed angle, <italic>σ</italic>, is fixed. We vary the sampling frequency used to collect the data (corresponding to using different values of Δ<italic>t</italic>). We generate observed (<italic>in silico</italic>) data by simulating one single trajectory directly from the VJP model. We discretise this trajectory to generate observed angle changes with a temporal resolution of Δ<italic>t</italic>, and add independent Gaussian noise with zero mean and variance <italic>σ</italic><sup>2</sup> to these observations, to represent measurement noise. Using datasets generated from the same simulated path discretised at different temporal resolutions, Δ<italic>t</italic>, as shown in <xref ref-type="fig" rid="pcbi.1006235.g006">Fig 6</xref>, we infer the posterior distribution for the reorientation rate, λ, of the VJP model and the magnitude of the measurement noise, <italic>σ</italic>, via pMCMC.</p>
<fig id="pcbi.1006235.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g006</object-id>
<label>Fig 6</label>
<caption>
<title>The data used in the pMCMC inference discretised at differing resolutions.</title>
<p>The true trajectory is shown without discretisation in a). The same path is shown in b) with circle markers to show the observed positions with Δ<italic>t</italic> = 4s and filled triangular markers to show observed positions with Δ<italic>t</italic> = 8s. The corresponding observed angle changes are shown in c) for different values of Δ<italic>t</italic>. Observations corresponding to multiple reorientations in a single time interval are highlighted in red. Parameters used in generating these data were a reorientation rate of λ = 0.2 s<sup>−1</sup>, a run speed of <italic>c</italic> = 50<italic>μ</italic>ms<sup>−1</sup> and a total duration of observation of <italic>T</italic><sub>final</sub> = 64 s. A circular uniform distribution was used for the reorientation kernel. Observations are shown without measurement noise.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g006" xlink:type="simple"/>
</fig>
<p>The results of using pMCMC to infer model parameters are shown in <xref ref-type="fig" rid="pcbi.1006235.g007">Fig 7</xref> for Δ<italic>t</italic> = 1/8, 1/4, 1/2, 1, 2, 4, 8 seconds, with noise of unknown magnitude <italic>σ</italic>, where <italic>σ</italic> = 0.04 rad. The estimated posterior distributions are very similar for small Δ<italic>t</italic>, but we observe an abrupt breakdown in the quality of the posterior distributions obtained as Δ<italic>t</italic> is increased. This breakdown in posterior quality arises for values of Δ<italic>t</italic> ≥ 2s, as multiple reorientation events in a time interval start to become more common (see also <xref ref-type="supplementary-material" rid="pcbi.1006235.s003">S2 Fig</xref>). Provided that Δ<italic>t</italic> and λ are such that the probability of multiple reorientations in a time interval is small, we obtain accurate estimates of the joint posterior distribution for the model parameters.</p>
<fig id="pcbi.1006235.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Results of parameter estimation via pMCMC for the reorientation rate, λ, and measurement noise, <italic>σ</italic>.</title>
<p>Data collected with different values of Δ<italic>t</italic> and fixed measurement noise, <italic>σ</italic> = 0.04 rad, were used in a) and b). Data generated with a fixed value of Δ<italic>t</italic> = 1 s and different values of the measurement noise, <italic>σ</italic>, were used in c) and d). The marginal posterior distributions for λ are given in a) and c), while the marginal posterior distributions for <italic>σ</italic> are shown in b) and d). The red dashed lines indicate the true values of parameters used in simulation of the datasets. A reorientation rate of λ = 0.2 s<sup>−1</sup> was used throughout.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>Increasing <italic>σ</italic> increases the variance of the posterior for λ</title>
<p>To investigate sensitivity of the posterior to measurement noise, we now fix the discretisation, Δ<italic>t</italic>, and vary the measurement noise amplitude, <italic>σ</italic>, used to create each dataset. Applying the same analysis as in the previous subsection, for a fixed value of Δ<italic>t</italic> = 1s, we obtain posterior distributions for the reorientation rate, λ, and measurement noise, <italic>σ</italic>, as shown in <xref ref-type="fig" rid="pcbi.1006235.g007">Fig 7</xref>. We find that increasing the noise amplitude, <italic>σ</italic>, increases the variance in the posterior distribution obtained for the reorientation rate, λ. In addition, we are able to accurately estimate the value of <italic>σ</italic> used to generate the datasets.</p>
<p>We note that the presence of noise in the datasets results in a bias towards smaller estimates of the reorientation rate, λ. This can be explained intuitively by reasoning that some reorientations leading to very small observed angle changes are mistaken for noise as <italic>σ</italic> increases.</p>
</sec>
<sec id="sec015">
<title>More data provides better estimates</title>
<p>Let <italic>T</italic><sub>final</sub> be the total duration of our observations of the system. For a fixed value of the time discretisation, Δ<italic>t</italic>, varying <italic>T</italic><sub>final</sub> is equivalent to gathering a bigger dataset. We fix Δ<italic>t</italic> = 1s and allow <italic>T</italic><sub>final</sub> to vary so that we can consider the effects of collecting more data. In practice, collecting more data experimentally may come at a cost. Quantifying the benefits of collecting more data with an <italic>in silico</italic> model can aid decisions about whether it is worthwhile to collect a larger dataset. Posteriors for the reorientation rate, λ, are shown in <xref ref-type="fig" rid="pcbi.1006235.g008">Fig 8</xref>.</p>
<fig id="pcbi.1006235.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Results of parameter estimation via pMCMC for the reorientation rate, λ, with Δ<italic>t</italic> = 1s and <italic>σ</italic> = 0rad, whilst varying <italic>T</italic><sub>final</sub> to give different sized datasets.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g008" xlink:type="simple"/>
</fig>
<p>It is clear that larger datasets result in less bias and less variance for estimates of the reorientation rate, λ. However, we note that running the particle filter within the pMCMC algorithm becomes much more computationally intensive as the size of the dataset increases, scaling as <inline-formula id="pcbi.1006235.e051"><alternatives><graphic id="pcbi.1006235.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> as the size of the dataset increases.</p>
</sec>
<sec id="sec016">
<title>Experimental constraints</title>
<p>We investigate the implications of these results for experimental design by considering an imaging experiment to observe the position of a particle of interest (for example, a bacterium) at regular time points. The behaviour of our system of interest happens over a certain timescale inherent to the biological process, so we fix the total duration for the imaging experiment, <italic>T</italic><sub>final</sub>, based on this timescale. We consider how best to choose the time between successive observations, Δ<italic>t</italic>, given the restriction of a fixed photon budget. That is, we assume that the biological sample can only be exposed to a fixed number of photons before phototoxicity or photobleaching significantly reduce the quality of, or destroy, any further potential data. We assume that the sample is only exposed to photons during imaging. The results of Zhao et al. [<xref ref-type="bibr" rid="pcbi.1006235.ref039">39</xref>] suggest that the signal to noise ratio (SNR) is proportional to the square root of the time between successive frames, Δ<italic>t</italic>, giving a relationship of the form
<disp-formula id="pcbi.1006235.e052"><alternatives><graphic id="pcbi.1006235.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>SNR</mml:mtext> <mml:mo>=</mml:mo> <mml:mi>κ</mml:mi> <mml:msqrt><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msqrt> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
where <italic>κ</italic> is a constant that depends on the imaging set up, but not other experimental design choices. Assuming that for our model the noise is of magnitude <italic>σ</italic>, we find an inverse square relationship between <italic>σ</italic> and Δ<italic>t</italic>, such that
<disp-formula id="pcbi.1006235.e053"><alternatives><graphic id="pcbi.1006235.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>σ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>K</mml:mi> <mml:msqrt><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msqrt></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
for a new constant <italic>K</italic> which is <italic>κ</italic> times the average angle change.</p>
<p>To investigate how to choose Δ<italic>t</italic> given a fixed photon budget, we set a value of the proportionality constant and vary <italic>σ</italic> and Δ<italic>t</italic> according to this relationship. We take proportionality constants <italic>K</italic> = 0.08 and <italic>K</italic> = 0.8 in <xref ref-type="fig" rid="pcbi.1006235.g009">Fig 9</xref>. A larger value of the proportionality constant, <italic>K</italic>, corresponds to worse imaging conditions, in that for a fixed value of Δ<italic>t</italic>, the noise in the images obtained will be greater. Therefore we expect our inference method to perform worse for a larger value of <italic>K</italic>. We then ask the question, for a given value of <italic>K</italic>, how should we choose Δ<italic>t</italic> to improve the parameter estimation process? Our results in <xref ref-type="fig" rid="pcbi.1006235.g009">Fig 9</xref> suggest that the value of Δ<italic>t</italic> should be taken as small as possible, even if this increases the noise present in the data.</p>
<fig id="pcbi.1006235.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Results of parameter estimation via pMCMC for the reorientation rate, λ, and measurement noise, <italic>σ</italic>, using data generated with a fixed value of Δ<italic>t</italic> and different values of the measurement noise, <italic>σ</italic>.</title>
<p>We have varied both <italic>σ</italic> and Δ<italic>t</italic> with an inverse square root relationship between these, as in <xref ref-type="disp-formula" rid="pcbi.1006235.e053">Eq (9)</xref>. The posterior distributions for λ are given in a) and c), while the posterior distributions for <italic>σ</italic> are shown in b) and d). The proportionality constant is <italic>K</italic> = 0.08 for a) and b), and <italic>K</italic> = 0.8 for c) and d).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g009" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec017">
<title>Comparison to approximate Bayesian computation</title>
<p>A common approach for mathematical and computational models where the likelihood is intractable is to apply ABC for parameter inference [<xref ref-type="bibr" rid="pcbi.1006235.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref035">35</xref>]. Although ABC produces samples from an approximate posterior, rather than the exact posterior distribution, it is intuitively simple to understand and implement. ABC methods have been applied to parameter estimation for biased, persistent random walk models very similar to our VJP model [<xref ref-type="bibr" rid="pcbi.1006235.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref041">41</xref>]. For these methods, the choice of which summary statistics to use has notable effects on the approximate posterior distributions obtained via ABC. We consider three different summary statistic choices: the full time series of observed angle changes, a threshold-based summary statistic, and a transition matrix summary statistic.</p>
<p>We compare the quality of resulting posterior distributions obtainable with ABC to those from pMCMC. Our results, shown in <xref ref-type="fig" rid="pcbi.1006235.g010">Fig 10</xref>, indicate that the choice of summary statistic has a substantial effect on the inferred posterior distribution. When the dimensionality of the data observed is high, ABC performs poorly at approximating the posterior for the parameters of our VJP, which we were able to sample exactly using pMCMC. For the full time series summary statistic, the dimensionality is high (up to 511 dimensions for Δ<italic>t</italic> = 0.125s), meaning that the approximation we obtain to the posterior is very poor (see <xref ref-type="fig" rid="pcbi.1006235.g010">Fig 10a) and 10b)</xref>). Since reorientation events are rare, particularly for small Δ<italic>t</italic>, a greater fraction of the distance between simulated datasets and observed data is accounted for by the observation noise. ABC excludes part of the parameter space considered in the prior, but does poorly at identifying the reorientation rate, λ, since reorientations are rare events.</p>
<fig id="pcbi.1006235.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Parameter estimation via ABC rejection sampling for the reorientation rate, λ, in a), c), and e) and for the measurement noise, <italic>σ</italic>, in b), d), and f) using different summary statistics and data collected with noise of magnitude <italic>σ</italic> = 0.04rad, for different values of Δ<italic>t</italic>.</title>
<p><italic>N</italic> = 1,000,000 datasets were generated and parameter samples corresponding to the closest 0.1% of the datasets were retained to give the approximate posterior. As summary statistics, we take the full time series of observed angle changes in a) and b). In c) and d), we use a simple threshold summary statistic counting the number of observed angle changes with magnitude above a threshold, here taken as <italic>h</italic> = 0.1 rad. In d) and e), we use a transition matrix summary statistic using <italic>n</italic> = 5 bins to discretise the observed angle change.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g010" xlink:type="simple"/>
</fig>
<p>The threshold summary statistic is effective at identifying the number of reorientation events and provides a reasonable approximation of the marginal posterior for λ. However, it offers very little information about the observation noise, <italic>σ</italic>, except in relation to the threshold chosen. As a result the approximate marginal posteriors for <italic>σ</italic> are poor (see <xref ref-type="fig" rid="pcbi.1006235.g010">Fig 10c) and 10d)</xref>). Another summary statistic more informative about <italic>σ</italic> could be used in addition here to improve results.</p>
<p>When using the transition matrix summary statistic, the approximate posteriors for small Δ<italic>t</italic> provide better estimates of the true reorientation rate and are much closer to the true posterior, as shown in <xref ref-type="fig" rid="pcbi.1006235.g010">Fig 10e) and 10f)</xref>. The transition matrix is able to capture the distribution of the angle changes and dependence on recent history, whilst also reducing the dimensionality of the data. However, the transition matrix is unable to distinguish angle changes smaller than the resolution of the discretisation, 2<italic>π</italic>/<italic>n</italic>, and so offers limited information about the measurement noise, <italic>σ</italic>. This issue could be mitigated by increasing the number of bins used, <italic>n</italic>, to give a finer discretisation of the observed angle changes (which would require sufficient data), or by targeting the noise with an additional summary statistic.</p>
<p>We still notice a deterioration in the quality of the approximate posterior distributions as Δ<italic>t</italic> increases when using ABC for each choice of summary statistic even though there are no explicit assumptions made about multiple reorientations within a time interval, as was the case when using pMCMC. This suggests that the lack of information content about the parameters may be a property of the data, rather than the inference method. For large values of Δ<italic>t</italic>, the data contains limited information about the model parameters, particularly the reorientation rate, λ.</p>
<p>To obtain potentially improved results for inference with ABC for this type of data (time series observations of angle changes), we could consider a more systematic choice of summary statistics [<xref ref-type="bibr" rid="pcbi.1006235.ref042">42</xref>–<xref ref-type="bibr" rid="pcbi.1006235.ref044">44</xref>] or a more efficient version of the ABC algorithm, such as ABC-SMC [<xref ref-type="bibr" rid="pcbi.1006235.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1006235.ref046">46</xref>], which applies sequential Monte Carlo methods to generate a sequence of approximations to the posterior distribution, using the previous posterior distribution to propose parameters for the next approximation. Other improvements could be possible by applying a regression adjustment, via linear regression [<xref ref-type="bibr" rid="pcbi.1006235.ref035">35</xref>] or using nonlinear regression techniques such as with a neural network [<xref ref-type="bibr" rid="pcbi.1006235.ref047">47</xref>].</p>
</sec>
<sec id="sec018">
<title>Model misspecification</title>
<p>In general, in applying a model to a real world dataset, any model that we choose will be an approximation of the true data generating process. Before applying our inference methods to real world data, where we will fit to a model that is but an approximation to the true biological process, it is important to check the robustness of our method to fit a misspecified model. We investigate this robustness computationally by considering a misspecified model which should be no longer misspecified in an appropriate limit. It has previously been shown by Frazier et al. [<xref ref-type="bibr" rid="pcbi.1006235.ref048">48</xref>] that inference with ABC on a misspecified model can concentrate posterior mass around different pseudo-true parameter values depending on the version of ABC used.</p>
<p>Here, we demonstrate the robustness of our inference framework, using the pMCMC algorithm within a hidden states framework, to give relevant estimates for a misspecified model. We generate synthetic datasets using a wrapped normal reorientation kernel with dispersion parameter <italic>γ</italic>, but choose to estimate the model parameters with a model different to the data generating process by assuming a uniform reorientation kernel. As previously, we attempt to infer posterior distributions for the reorientation rate, λ, and the measurement noise, <italic>σ</italic>. The effect of misspecifying the model will be that some of the transmission probabilities used in the particle filter estimate of the likelihood of model parameters given the data will be wrong (see <xref ref-type="supplementary-material" rid="pcbi.1006235.s004">S3 Fig</xref>). This will give rise to some bias in our estimates of the likelihood within the particle filter (as demonstrated by <xref ref-type="fig" rid="pcbi.1006235.g011">Fig 11</xref>), and hence to some bias in our final approximation of the posterior. We will consider the effect of varying the dispersion parameter, <italic>γ</italic>, in the reorientation kernel used to generate the synthetic dataset, on the resulting posterior distribution for the model parameters. In the limit <italic>γ</italic> → ∞, the wrapped normal distribution converges to the uniform distribution on (−<italic>π</italic>, <italic>π</italic>], meaning that the model is no longer misspecified. The misspecification of the model is most pronounced for smaller values of <italic>γ</italic>.</p>
<fig id="pcbi.1006235.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Estimates of the log likelihood via a particle filter for data generated with the true model and under a misspecified model.</title>
<p>In a) and b), we show estimates of the log likelihood for different values of λ and <italic>σ</italic> based on a dataset simulated with a uniform reorientation kernel, and assuming this same reorientation kernel in estimating the log likelihood via the particle filter. The peak of the log likelihood coincides with the true values of the parameters shown by the red dashed line. In c) and d), we show estimates of the log likelihood for different values of λ and <italic>σ</italic> based on a dataset simulated with a wrapped normal reorientation kernel with dispersion <italic>γ</italic> = 0.1. However, we assume a uniform reorientation kernel in the particle filter. This model misspecification results in a slight shift in the peak of the log likelihood compared to the true parameter values used shown by the red dashed line. The log likelihood estimates will be biased in the case of the misspecified model.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g011" xlink:type="simple"/>
</fig>
<p>We find, for a fixed value of the measurement noise, <italic>σ</italic>, that a reasonable approximation to the true posterior can be obtained for values of the dispersion, <italic>γ</italic>, larger than the measurement noise, <italic>σ</italic>. The approximate posterior distributions obtained are shown in <xref ref-type="fig" rid="pcbi.1006235.g012">Fig 12</xref>. When the dispersion, <italic>γ</italic>, is a similar magnitude to the measurement noise, which here is <italic>σ</italic> = 0.04rad, then reorientation events are frequently missed resulting in low estimates of the reorientation rate. For larger values of the dispersion parameter, we are able to robustly sample from the posterior distribution for λ and <italic>σ</italic>, despite notable differences in the misspecified reorientation kernel compared to the assumed uniform reorientation kernel. In this case, when a reorientation occurs, the observed angle changes are sufficiently different to the background measurement noise, that often it is interpreted as a reorientation event by the particle filter, despite error in the emission probabilities due to the model misspecification.</p>
<fig id="pcbi.1006235.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g012</object-id>
<label>Fig 12</label>
<caption>
<title>The posterior distribution obtained under model misspecification converges to the distribution obtained with the true model as the misspecified model approaches the true model.</title>
<p>We assume a wrapped normal reorientation kernel with dispersion parameter <italic>γ</italic> and vary this dispersion parameter. For large <italic>γ</italic>, this tends in distribution towards a uniform reorientation kernel, as shown in a). The posterior distributions obtained from performing inference with data generated for different values of <italic>γ</italic> are shown in b), with the corresponding marginal distributions shown in c) and d). In b), the true parameter values used are shown by the dark blue circle. In c) and d), the true parameter values are given by the red dashed line. Parameters used to generate the synthetic datasets are λ = 0.2 s<sup>−1</sup>, <italic>σ</italic> = 0.04 rad, Δ<italic>t</italic> = 0.25 s, <italic>c</italic> = 50<italic>μ</italic>ms<sup>−1</sup>, and the details of the pMCMC are as in <xref ref-type="fig" rid="pcbi.1006235.g007">Fig 7</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g012" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec019">
<title>Application to RNA transport dataset</title>
<p>To demonstrate the effectiveness of our inference framework, we apply it here to a dataset of tracks obtained from imaging the transport of RNA-protein (RNP) complexes in a <italic>Drosophila</italic> oocyte. These complexes move on microtubules via molecular motors [<xref ref-type="bibr" rid="pcbi.1006235.ref001">1</xref>]. Occasionally, the complexes fall off a microtubule, and reattach on a different microtubule moving in a different direction. We neglect the diffusive stationary phase between falling off and reattaching on microtubules, meaning that we assume a running phase is followed immediately by another running phase. We apply our modelling framework, assuming an exponentially distributed running time distribution, <italic>f</italic><sub><italic>τ</italic></sub>(<italic>t</italic>) = λ exp(−λ<italic>t</italic>), with constant running speed, <italic>c</italic>, and a uniform reorientation kernel, <inline-formula id="pcbi.1006235.e054"><alternatives><graphic id="pcbi.1006235.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006235.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mo>Φ</mml:mo></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msub><mml:mn mathvariant="double-struck">1</mml:mn> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mo>−</mml:mo> <mml:mi>π</mml:mi> <mml:mo>,</mml:mo> <mml:mi>π</mml:mi> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>We take 10 tracks of separate complexes moving in <italic>Drosophila</italic> nurse cells obtained from an <italic>in vivo</italic> imaging dataset of movements of staufen protein available in Zimyanin et al. [<xref ref-type="bibr" rid="pcbi.1006235.ref049">49</xref>]. Each track is short since the dataset is imaged in a single plane in the <italic>z</italic> direction, meaning that complexes move out of the frame of view frequently. The tracks used are shown in <xref ref-type="fig" rid="pcbi.1006235.g013">Fig 13a</xref>). We infer a subposterior distribution for each individual track and combine these together to produce a single posterior distribution combining data from different tracks. To combine the subposteriors, we use the consensus Monte Carlo algorithm of Scott et al. [<xref ref-type="bibr" rid="pcbi.1006235.ref050">50</xref>] developed for running MCMC on large datasets, via the implementation in the R [<xref ref-type="bibr" rid="pcbi.1006235.ref051">51</xref>] package <monospace>parallelMCMCcombine</monospace> [<xref ref-type="bibr" rid="pcbi.1006235.ref052">52</xref>]. This produces an approximate posterior distribution for the turning rate, λ, and measurement noise, <italic>σ</italic>, as shown in <xref ref-type="fig" rid="pcbi.1006235.g013">Fig 13b)</xref>. We find 95% credible intervals for the turning rate λ of [1.06, 1.58] s<sup>−1</sup> and for the measurement noise <italic>σ</italic> of [0.27, 0.47] rad, respectively. Based on a VJP model corresponding to Brownian motion, the relation λ = <italic>c</italic><sup>2</sup>/(2<italic>D</italic>) holds for a constant running speed <italic>c</italic> and diffusion constant <italic>D</italic>. The running speed in active transport for staufen RNPs is of the order 0.5<italic>μ</italic>ms<sup>−1</sup> [<xref ref-type="bibr" rid="pcbi.1006235.ref049">49</xref>], and based on the size of the staufen protein, we can estimate its diffusion coefficient as 1<italic>μ</italic>m<sup>2</sup>s<sup>−1</sup> [<xref ref-type="bibr" rid="pcbi.1006235.ref053">53</xref>], which gives a similar order of magnitude for λ as the estimate obtained here. Evidently the dataset used here is very noisy, but nonetheless we are able to obtain estimates for the turning rate in a model of RNA transport.</p>
<fig id="pcbi.1006235.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006235.g013</object-id>
<label>Fig 13</label>
<caption>
<title>Posterior distribution for model parameters λ and <italic>σ</italic> for RNA transport in a <italic>Drosophila</italic> oocyte.</title>
<p>The results are based on 10 tracks labelled manually and sampled at a resolution of Δ<italic>t</italic> = 0.478 s, with subposteriors obtained for each track and combined to give a single posterior via Consensus Monte Carlo. The tracks are shown drawn on the first frame in a), although not all tracks start from the same time point. The marginal posterior distributions for the reorientation rate, λ, and the measurement noise, <italic>σ</italic>, are shown in b).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.g013" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec020" sec-type="conclusions">
<title>Discussion</title>
<p>In this work, we have considered parameter estimation of a VJP model for biological transport and how insights from this parameter inference process can inform experimental design. We generated estimates of the posterior distribution for parameters of a VJP model based on noisy datasets collected at varying temporal resolutions. To perform this parameter inference, we used pMCMC and derived the appropriate emission probabilities. We observed an abrupt breakdown in the quality of the posteriors obtained when decreasing the temporal resolution. This transition corresponds to a breakdown in modelling assumptions underlying the derivation of the emission probabilities. For example, as Δ<italic>t</italic> increases we see multiple reorientations in a time interval. These assumptions are necessary in the development of our inference framework which relies on hidden states consisting of binary variables indicating whether or not a reorientation occurred in a time interval.</p>
<p>Increasing the magnitude of the noise in the data slowly decreased the quality of the median posterior estimates and increased the posterior variance. In general, better estimates were obtained when more data was available, either by decreasing Δ<italic>t</italic>, or by increasing the total duration of the experimental observations, <italic>T</italic><sub>final</sub>. These results are intuitive, but the real benefit here is in quantifying the effects of choices of these experimental hyperparameters to enable researchers to make decisions about experimental design.</p>
<p>We also compared parameter estimation with pMCMC to that with ABC, and results suggest that different methods are appropriate in different situations, dependent on the data available. In particular, pMCMC performs well provided the assumptions made in deriving the emission probabilities hold, which is true for small Δ<italic>t</italic>. For larger values of Δ<italic>t</italic>, neither ABC nor pMCMC provide accurate samples from the full posterior distribution. The information about the model parameters present in the data for large Δ<italic>t</italic> is limited. In terms of computational cost comparisons between ABC and pMCMC, an ABC rejection sampler is highly parallelisable over independent parameter samples [<xref ref-type="bibr" rid="pcbi.1006235.ref054">54</xref>] whereas pMCMC is less amenable to simple parallelisation. Making use of this parallelisation, our implementation of ABC rejection sampling was more computationally efficient than pMCMC. We show a quantitative comparison between the methods in <xref ref-type="supplementary-material" rid="pcbi.1006235.s007">S6 Fig</xref>. We note that the computational cost is strongly problem and implementation dependent.</p>
<p>Through comparison between inference with pMCMC and ABC, our results highlight a weakness of inference with ABC, in that it performs poorly for high dimensional data, and also a weakness of our application of pMCMC, which is that it relies upon assumptions about the number of reorientation events in a time step; when this fails our posterior estimates are no longer accurate. We note, additionally, that pMCMC allows us to sample from the exact posterior for parameters from a model (given that model is appropriate to describe the data), whereas via ABC we obtain approximate posteriors for a fixed tolerance, <italic>ϵ</italic>, which only become exact in the limit as <italic>ϵ</italic> → 0.</p>
<p>In Section ‘Methods’, we described a framework for inference using pMCMC, and made certain assumptions about the VJP model, such as a separation in timescales between runs and reorientations, and a memoryless exponential distribution for the running time. Although many of these are standard assumptions, it would be possible to perform the same analysis in a more general model. For instance, if a running time distribution was chosen that does not satisfy the memoryless property, we could introduce an extra hidden variable, <italic>s</italic>, for the time since the last reorientation. In addition, in this work we have described parameter estimation via a hidden states formulation of the VJP model using dependence on hidden states from two time intervals. This can be extended to hidden states from three time intervals, which can allow rare consecutive reorientation events to be handled more accurately, albeit at greater computational cost.</p>
<p>Given a fixed photon budget and a trade-off between temporal sampling frequency and measurement noise, our results in the Section ‘Experimental constraints’ indicate that a small value of Δ<italic>t</italic> should be used for the discretisation in time i.e. that motile individuals should be imaged as frequently as possible. In practice, there may be disadvantages to this choice of Δ<italic>t</italic>. Computationally, conducting parameter inference via pMCMC will be significantly more expensive, although the computational run time may still be small in comparison to the duration of an experimental protocol. Datasets with higher noise present may also be much harder to interpret. Here, we have assumed that the noise present in the data is applied to the observed angle change. In reality there is noise on each pixel, which may contribute to an uncertainty in identifying the observed position of the object of interest.</p>
<p>Additionally, we considered using our particle MCMC inference framework to fit data from a misspecified model; our results indicate that the framework is robust to moderate amounts of model misspecification. This allowed us to be confident in applying our framework to a real dataset of RNA tracks to consider the motility of RNA-protein complexes moving on the cytoskeleton, demonstrating the ability of our framework to obtain parameter estimates in challenging conditions with very noisy data.</p>
</sec>
<sec id="sec021">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006235.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Comparison with simulations.</title>
<p>Description of simulations to verify the analytic form for the emission probabilities.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006235.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Comparison with simulations.</title>
<p>Comparison between simulated results and theoretical predictions of the observed angle change for hidden states of the form 0, 1 in a), 1, 0 in b), and 1, 1 in c). The simulated results are shown by the histogram and the theoretical prediction for the observed angle change distribution is shown as the red dashed line. For both b) and c), we have conditioned on an observed angle change in the previous time interval of 0.1 rad, and for c) we also conditioned on an observed angle change prior to that of −1.0 rad. To generate these results, we used <italic>N</italic> = 10<sup>7</sup> simulated trajectories with running speed <italic>c</italic> = 50<italic>μ</italic>ms<sup>−1</sup>, uniform reorientation kernel, reorientation rate λ = 0.2 s<sup>−1</sup> and time discretization Δ<italic>t</italic> = 1 s.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006235.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Probability of hidden state sequences.</title>
<p>The probability of sequences of hidden states as Δ<italic>t</italic> varies with reorientation rate λ = 0.2 s<sup>−1</sup>. For large values of Δ<italic>t</italic>, the assumptions of the model start to break down as multiple reorientations appear within a single time interval.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006235.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Emission probabilities for misspecified model.</title>
<p>Comparison between assumed distribution of observed angle changes and simulated distributions when using a misspecified model for the reorientation kernel. We simulate <italic>N</italic> = 10<sup>7</sup> angle changes using a wrapped normal reorientation kernel with dispersion parameter <italic>γ</italic> given a certain sequence of hidden states (0, 1 in a), d), g); 1, 0 in b), e), h); 1, 1 in c), f), i)) and show a grey histogram of the simulated observed angle changes. To demonstrate the misspecification in the emission probabilities, we plot the assumed theoretical distribution of the observed angle changes as a red dashed line, based on assuming that the reorientation kernel is a uniform distribution. The model is more misspecified for a smaller value of the dispersion parameter <italic>γ</italic>. As in <xref ref-type="supplementary-material" rid="pcbi.1006235.s002">S1 Fig</xref>, we have conditioned on an observed angle change in the previous time interval of 0.1 rad for b), c), e), f), h), and i). For c), f), and i), we also conditioned on an observed angle change prior to that of −1.0 rad. We used a dispersion parameter, <italic>γ</italic>, in the reorientation kernel of <italic>γ</italic> = 0.4 for a), b), and c), <italic>γ</italic> = 1 for d), e), and f), and <italic>γ</italic> = 6.4 for g), h), and i).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006235.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.s005" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Traceplots and autocorrelation functions for MCMC chains.</title>
<p>Traceplots and autocorrelation functions for MCMC chains to analyse convergence are shown for data generated with parameters λ = 0.2 s<sup>−1</sup>, Δ<italic>t</italic> = 0.25 s, <italic>σ</italic> = 0.04 rad, as for the first posterior shown in <xref ref-type="fig" rid="pcbi.1006235.g007">Fig 7a)</xref>. Similar results are seen in sampling for other posterior distributions shown.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006235.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.s006" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Analysis of number of particles in the particle filter.</title>
<p>The number of particles used in the particle filter affects the variance of estimates of the log-likelihood. However, a higher computational cost is required to use more particles. In a), we show how the distribution of the log-likelihood estimates varies (provided the filter does not become degenerate) as we change the number of particles. We use 1000 runs of the particle filter with the specified number of particles and estimate the log-likelihood at the true value of the parameters (λ = 0.2 s and <italic>σ</italic> = 0.08 rad) used to generate a synthetic dataset. In b), we illustrate the variance in the (nondegenerate) log-likelihood estimates, and the mean time to obtain a single estimate. A moderate increase in the compute time to run the particle filter offers substantial decrease in the variance of the log-likelihood estimates. To strike a reasonable balance, we use 400 particles to generate the results presented in this work.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006235.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.s007" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>The computational cost of pMCMC and ABC per effective sample size.</title>
<p>The computational cost of parameter estimation with pMCMC and ABC per effective sample size depends on Δ<italic>t</italic>. We quantify here a comparison between the computational cost of the pMCMC and ABC methods for parameter estimation when varying Δ<italic>t</italic>. Datasets were generated with <italic>σ</italic> = 0.04 rad as in <xref ref-type="fig" rid="pcbi.1006235.g007">Fig 7a)</xref>. The cost to produce a sample via pMCMC increases as Δ<italic>t</italic> decreases, as shown by the grey squares. The cost for ABC remains approximately constant with Δ<italic>t</italic> as we simulate data from the model a fixed number of times, <italic>N</italic>. The acceptance rate, <italic>α</italic>, in ABC affects the sample size we produce for a fixed number of simulations, <italic>N</italic>. For the results in <xref ref-type="fig" rid="pcbi.1006235.g010">Fig 10</xref>, an acceptance rate of <italic>α</italic> = 0.1% was used. This gives a cost per sample lower than for pMCMC, shown by the blue circles and triangles. For a smaller acceptance rate, <italic>α</italic> = 0.01% (shown by red circles and triangles), the cost per sample is much higher and the plots of the posterior are unchanged compared to those for <italic>α</italic> = 0.1%. The results for pMCMC are given by squares, ABC with transition matrix summary statistics are shown as circles and ABC with time series summary statistics are shown as triangles. We note that the computational cost depends strongly on the problem considered and the implementation used.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006235.s008" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006235.s008" xlink:type="simple">
<label>S1 Code</label>
<caption>
<title>Code implementing Bayesian inference via pMCMC for a VJP model.</title>
<p>Example code to implement pMCMC for a VJP model, as described in Section “Methods”, is available in a .zip folder or at <ext-link ext-link-type="uri" xlink:href="https://github.com/shug3502/pmmc_inference_for_vjps" xlink:type="simple">https://github.com/shug3502/pmmc_inference_for_vjps</ext-link>.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors are grateful to Richard Parton and Ilan Davis for helpful discussions of the application to RNA transport.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006235.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Parton</surname> <given-names>R M</given-names></name>, <name name-style="western"><surname>Davidson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>I</given-names></name>, and <name name-style="western"><surname>Weil</surname> <given-names>T T</given-names></name>. <article-title>Subcellular mRNA localisation at a glance</article-title>. <source><italic>Journal of Cell Science</italic></source>, <volume>127</volume>(<issue>10</issue>):<fpage>2127</fpage>–<lpage>2133</lpage>, <year>2014</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jcs.114272" xlink:type="simple">10.1242/jcs.114272</ext-link></comment> <object-id pub-id-type="pmid">24833669</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Othmer</surname> <given-names>H G</given-names></name>, <name name-style="western"><surname>Dunbar</surname> <given-names>S R</given-names></name>, and <name name-style="western"><surname>Alt</surname> <given-names>W</given-names></name>. <article-title>Models of dispersal in biological systems</article-title>. <source><italic>Journal of Mathematical Biology</italic></source>, <volume>26</volume>(<issue>3</issue>):<fpage>263</fpage>–<lpage>298</lpage>, <year>1988</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00277392" xlink:type="simple">10.1007/BF00277392</ext-link></comment> <object-id pub-id-type="pmid">3411255</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berg</surname> <given-names>H C</given-names></name> and <name name-style="western"><surname>Brown</surname> <given-names>D A</given-names></name>. <article-title>Chemotaxis in Escherichia coli analysed by three-dimensional tracking</article-title>. <source><italic>Nature</italic></source>, <volume>239</volume>(<issue>5374</issue>):<fpage>500</fpage>–<lpage>504</lpage>, <year>1972</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/239500a0" xlink:type="simple">10.1038/239500a0</ext-link></comment> <object-id pub-id-type="pmid">4563019</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosser</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Fletcher</surname> <given-names>A G</given-names></name>, <name name-style="western"><surname>Wilkinson</surname> <given-names>D A</given-names></name>, <name name-style="western"><surname>de Beyer</surname> <given-names>J A</given-names></name>, <name name-style="western"><surname>Yates</surname> <given-names>C A</given-names></name>, <name name-style="western"><surname>Armitage</surname> <given-names>J P</given-names></name>, <name name-style="western"><surname>Maini</surname> <given-names>P K</given-names></name>, and <name name-style="western"><surname>Baker</surname> <given-names>R E</given-names></name>. <article-title>Novel methods for analysing bacterial tracks reveal persistence in Rhodobacter sphaeroides</article-title>. <source><italic>PLOS Computational Biology</italic></source>, <volume>9</volume>(<issue>10</issue>):<fpage>1:18</fpage>, <year>2013</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003276" xlink:type="simple">10.1371/journal.pcbi.1003276</ext-link></comment> <object-id pub-id-type="pmid">24204227</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Taylor-King</surname> <given-names>J P</given-names></name>, <name name-style="western"><surname>van Loon</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Rosser</surname> <given-names>G</given-names></name>, and <name name-style="western"><surname>Chapman</surname> <given-names>S J</given-names></name>. <article-title>From birds to bacteria: generalised velocity jump processes with resting states</article-title>. <source><italic>Bulletin of Mathematical Biology</italic></source>, <volume>77</volume>(<issue>7</issue>):<fpage>1213</fpage>–<lpage>1236</lpage>, <year>2015</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11538-015-0083-7" xlink:type="simple">10.1007/s11538-015-0083-7</ext-link></comment> <object-id pub-id-type="pmid">26060098</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Othmer</surname> <given-names>H G</given-names></name> and <name name-style="western"><surname>Hillen</surname> <given-names>T</given-names></name>. <article-title>The diffusion limit of transport equations derived from velocity-jump processes</article-title>. <source><italic>SIAM Journal on Applied Mathematics</italic></source>, <volume>61</volume>(<issue>3</issue>):<fpage>751</fpage>–<lpage>775</lpage>, <year>2000</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1137/S0036139999358167" xlink:type="simple">10.1137/S0036139999358167</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Codling</surname> <given-names>E A</given-names></name> and <name name-style="western"><surname>Hill</surname> <given-names>N A</given-names></name>. <article-title>Calculating spatial statistics for velocity jump processes with experimentally observed reorientation parameters</article-title>. <source><italic>Journal of Mathematical Biology</italic></source>, <volume>51</volume>(<issue>5</issue>):<fpage>527</fpage>–<lpage>556</lpage>, <year>2005</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00285-005-0317-7" xlink:type="simple">10.1007/s00285-005-0317-7</ext-link></comment> <object-id pub-id-type="pmid">15868200</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Codling</surname> <given-names>E A</given-names></name>, <name name-style="western"><surname>Plank</surname> <given-names>M J</given-names></name>, and <name name-style="western"><surname>Benhamou</surname> <given-names>S</given-names></name>. <article-title>Random walk models in biology</article-title>. <source><italic>Journal of the Royal Society Interface</italic></source>, <volume>5</volume>(<issue>25</issue>):<fpage>813</fpage>–<lpage>834</lpage>, <year>2008</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2008.0014" xlink:type="simple">10.1098/rsif.2008.0014</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kareiva</surname> <given-names>P M</given-names></name> and <name name-style="western"><surname>Shigesada</surname> <given-names>N</given-names></name>. <article-title>Analyzing insect movement as a correlated random walk</article-title>. <source><italic>Oecologia</italic></source>, <volume>56</volume>(<issue>2</issue>):<fpage>234</fpage>–<lpage>238</lpage>, <year>1983</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00379695" xlink:type="simple">10.1007/BF00379695</ext-link></comment> <object-id pub-id-type="pmid">28310199</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bovet</surname> <given-names>P</given-names></name> and <name name-style="western"><surname>Benhamou</surname> <given-names>S</given-names></name>. <article-title>Spatial analysis of animals’ movements using a correlated random walk model</article-title>. <source><italic>Journal of Theoretical Biology</italic></source>, <volume>131</volume>(<issue>4</issue>):<fpage>419</fpage>–<lpage>433</lpage>, <year>1988</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0022-5193(88)80038-9" xlink:type="simple">10.1016/S0022-5193(88)80038-9</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jonsen</surname> <given-names>I D</given-names></name>, <name name-style="western"><surname>Flemming</surname> <given-names>J M</given-names></name>, and <name name-style="western"><surname>Myers</surname> <given-names>R A</given-names></name>. <article-title>Robust state-space modeling of animal movement data</article-title>. <source><italic>Ecology</italic></source>, <volume>86</volume>(<issue>11</issue>):<fpage>2874</fpage>–<lpage>2880</lpage>, <year>2005</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1890/04-1852" xlink:type="simple">10.1890/04-1852</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liepe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Barnes</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Huvet</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bugeon</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Thorne</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lamb</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dallman</surname> <given-names>M</given-names></name>, and <name name-style="western"><surname>Stumpf</surname> <given-names>M P H</given-names></name>. <article-title>Calibrating spatio-temporal models of leukocyte dynamics against in vivo live-imaging data using approximate Bayesian computation</article-title>. <source><italic>Integrative Biology</italic></source>, <volume>4</volume>(<issue>3</issue>):<fpage>335</fpage>–<lpage>345</lpage>, <year>2012</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1039/c2ib00175f" xlink:type="simple">10.1039/c2ib00175f</ext-link></comment> <object-id pub-id-type="pmid">22327539</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jones</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sim</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bugeon</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Dallman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pereira</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>M P H</given-names></name>, and <name name-style="western"><surname>Liepe</surname> <given-names>J</given-names></name>. <article-title>Inference of random walk models to describe leukocyte migration</article-title>. <source><italic>Physical Biology</italic></source>, <volume>12</volume>(<issue>6</issue>):<fpage>66001</fpage>–<lpage>66012</lpage>, <year>2015</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/1478-3975/12/6/066001" xlink:type="simple">10.1088/1478-3975/12/6/066001</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Viswanathan</surname> <given-names>G M</given-names></name>, <name name-style="western"><surname>Afanasyev</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Buldyrev</surname> <given-names>S V</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>E J</given-names></name>, <name name-style="western"><surname>Prince</surname> <given-names>P A</given-names></name>, and <name name-style="western"><surname>Stanley</surname> <given-names>H E</given-names></name>. <article-title>Lévy flight search patterns of wandering albatrosses</article-title>. <source><italic>Nature</italic></source>, <volume>381</volume>(<issue>6581</issue>):<fpage>413</fpage>–<lpage>415</lpage>, <year>1996</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/381413a0" xlink:type="simple">10.1038/381413a0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Viswanathan</surname> <given-names>G M</given-names></name>, <name name-style="western"><surname>Afanasyev</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Buldyrev</surname> <given-names>S V</given-names></name>, <name name-style="western"><surname>Havlin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Da Luz</surname> <given-names>M G</given-names></name>, <name name-style="western"><surname>Raposo</surname> <given-names>E P</given-names></name>, and <name name-style="western"><surname>Stanley</surname> <given-names>H E</given-names></name>. <article-title>Lévy flights in random searches</article-title>. <source><italic>Physica A</italic></source>, <volume>282</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>, <year>2000</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0378-4371(00)00071-6" xlink:type="simple">10.1016/S0378-4371(00)00071-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edwards</surname> <given-names>A M</given-names></name>, <name name-style="western"><surname>Phillips</surname> <given-names>R A</given-names></name>, <name name-style="western"><surname>Watkins</surname> <given-names>N W</given-names></name>, <name name-style="western"><surname>Freeman</surname> <given-names>M P</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>E J</given-names></name>, <name name-style="western"><surname>Afanasyev</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Buldyrev</surname> <given-names>S V</given-names></name>, <name name-style="western"><surname>da Luz</surname> <given-names>M G</given-names></name>, <name name-style="western"><surname>Raposo</surname> <given-names>E P</given-names></name>, and <name name-style="western"><surname>Stanley</surname> <given-names>H E</given-names></name>. <article-title>Revisiting Lévy flight search patterns of wandering albatrosses, bumblebees and deer</article-title>. <source><italic>Nature</italic></source>, <volume>449</volume>(<issue>7165</issue>):<fpage>1044</fpage>–<lpage>1048</lpage>, <year>2007</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature06199" xlink:type="simple">10.1038/nature06199</ext-link></comment> <object-id pub-id-type="pmid">17960243</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Benhamou</surname> <given-names>S</given-names></name>. <article-title>How many animals really do the Lévy walk?</article-title> <source><italic>Ecology</italic></source>, <volume>88</volume>(<issue>8</issue>):<fpage>1962</fpage>–<lpage>1969</lpage>, <year>2007</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1890/06-1769.1" xlink:type="simple">10.1890/06-1769.1</ext-link></comment> <object-id pub-id-type="pmid">17824427</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Painter</surname> <given-names>K J</given-names></name>. <article-title>Modelling cell migration strategies in the extracellular matrix</article-title>. <source><italic>Journal of Mathematical Biology</italic></source>, <volume>58</volume>(<issue>4</issue>):<fpage>511</fpage>–<lpage>543</lpage>, <year>2009</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00285-008-0217-8" xlink:type="simple">10.1007/s00285-008-0217-8</ext-link></comment> <object-id pub-id-type="pmid">18787826</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mandeville</surname> <given-names>J T</given-names></name>, <name name-style="western"><surname>Ghosh</surname> <given-names>R N</given-names></name>, and <name name-style="western"><surname>Maxfield</surname> <given-names>F R</given-names></name>. <article-title>Intracellular calcium levels correlate with speed and persistent forward motion in migrating neutrophils</article-title>. <source><italic>Biophysical Journal</italic></source>, <volume>68</volume>(<issue>4</issue>):<fpage>1207</fpage>–<lpage>1217</lpage>, <year>1995</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0006-3495(95)80336-X" xlink:type="simple">10.1016/S0006-3495(95)80336-X</ext-link></comment> <object-id pub-id-type="pmid">7787012</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pankov</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Endo</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Even</surname> <given-names>S-Ram</given-names></name>, <name name-style="western"><surname>Araki</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Cukierman</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Matsumoto</surname> <given-names>K</given-names></name>, and <name name-style="western"><surname>Yamada</surname> <given-names>K M</given-names></name>. <article-title>A Rac switch regulates random versus directionally persistent cell migration</article-title>. <source><italic>Journal of Cell Biology</italic></source>, <volume>170</volume>(<issue>5</issue>):<fpage>793</fpage>–<lpage>802</lpage>, <year>2005</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1083/jcb.200503152" xlink:type="simple">10.1083/jcb.200503152</ext-link></comment> <object-id pub-id-type="pmid">16129786</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nicosia</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Duchesne</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Rivest</surname> <given-names>L P</given-names></name>, and <name name-style="western"><surname>Fortin</surname> <given-names>D</given-names></name>. <article-title>A general hidden state random walk model for animal movement</article-title>. <source><italic>Computational Statistics and Data Analysis</italic></source>, <volume>105</volume>:<fpage>76</fpage>–<lpage>95</lpage>, <year>2017</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csda.2016.07.009" xlink:type="simple">10.1016/j.csda.2016.07.009</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Andrieu</surname> <given-names>C</given-names></name> and <name name-style="western"><surname>Roberts</surname> <given-names>G O</given-names></name>. <article-title>The pseudo-marginal approach for efficient Monte Carlo computations</article-title>. <source><italic>The Annals of Statistics</italic></source>, <volume>37</volume>(<issue>2</issue>):<fpage>697</fpage>–<lpage>725</lpage>, <year>2009</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/07-AOS574" xlink:type="simple">10.1214/07-AOS574</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Andrieu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Doucet</surname> <given-names>A</given-names></name>, and <name name-style="western"><surname>Holenstein</surname> <given-names>R</given-names></name>. <article-title>Particle Markov chain Monte Carlo methods</article-title>. <source><italic>Journal of the Royal Statistical Society: Series B</italic></source>, <volume>72</volume>(<issue>3</issue>):<fpage>269</fpage>–<lpage>342</lpage>, <year>2010</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1467-9868.2009.00736.x" xlink:type="simple">10.1111/j.1467-9868.2009.00736.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref024">
<label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">
Gordon N J, Salmond D J, and Smith A F. Novel approach to nonlinear non-Gaussian Bayesian state estimation. In <italic>IEE Proceedings F</italic>, volume 140, pages 107–113. IET, 1993.</mixed-citation>
</ref>
<ref id="pcbi.1006235.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rasmussen</surname> <given-names>D A</given-names></name>, <name name-style="western"><surname>Ratmann</surname> <given-names>O</given-names></name>, and <name name-style="western"><surname>Koelle</surname> <given-names>K</given-names></name>. <article-title>Inference for nonlinear epidemiological models using genealogies and time series</article-title>. <source><italic>PLOS Computational Biology</italic></source>, <volume>7</volume>(<issue>8</issue>):<fpage>e1002136</fpage>, <year>2011</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002136" xlink:type="simple">10.1371/journal.pcbi.1002136</ext-link></comment> <object-id pub-id-type="pmid">21901082</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Golightly</surname> <given-names>A</given-names></name> and <name name-style="western"><surname>Wilkinson</surname> <given-names>D J</given-names></name>. <article-title>Bayesian parameter inference for stochastic biochemical network models using particle Markov chain Monte Carlo</article-title>. <source><italic>Interface Focus</italic></source>, <volume>1</volume>(<issue>6</issue>):<fpage>807</fpage>, <year>2011</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsfs.2011.0047" xlink:type="simple">10.1098/rsfs.2011.0047</ext-link></comment> <object-id pub-id-type="pmid">23226583</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Golightly</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Henderson</surname> <given-names>D A</given-names></name>, and <name name-style="western"><surname>Sherlock</surname> <given-names>C</given-names></name>. <article-title>Delayed acceptance particle MCMC for exact inference in stochastic kinetic models</article-title>. <source><italic>Statistics and Computing</italic></source>, <volume>25</volume>(<issue>5</issue>):<fpage>1039</fpage>–<lpage>1055</lpage>, <year>2015</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11222-014-9469-x" xlink:type="simple">10.1007/s11222-014-9469-x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref028">
<label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Grimmett</surname> <given-names>G</given-names></name> and <name name-style="western"><surname>Stirzaker</surname> <given-names>D</given-names></name>. <source><italic>Probability and Random Processes</italic></source>. <publisher-name>Oxford University Press</publisher-name>, <year>2001</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006235.ref029">
<label>29</label>
<mixed-citation publication-type="other" xlink:type="simple">Rosser G. <italic>Mathematical modelling and analysis of aspects of planktonic bacterial motility</italic>. PhD thesis, University of Oxford, 2012.</mixed-citation>
</ref>
<ref id="pcbi.1006235.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Metropolis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname> <given-names>A W</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname> <given-names>M N</given-names></name>, <name name-style="western"><surname>Teller</surname> <given-names>A H</given-names></name>, and <name name-style="western"><surname>Teller</surname> <given-names>E</given-names></name>. <article-title>Equation of state calculations by fast computing machines</article-title>. <source><italic>The Journal of Chemical Physics</italic></source>, <volume>21</volume>(<issue>6</issue>):<fpage>1087</fpage>–<lpage>1092</lpage>, <year>1953</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.1699114" xlink:type="simple">10.1063/1.1699114</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doucet</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Godsill</surname> <given-names>S</given-names></name>, and <name name-style="western"><surname>Andrieu</surname> <given-names>C</given-names></name>. <article-title>On sequential Monte Carlo sampling methods for Bayesian filtering</article-title>. <source><italic>Statistics and Computing</italic></source>, <volume>10</volume>(<issue>3</issue>):<fpage>197</fpage>–<lpage>208</lpage>, <year>2000</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1023/A:1008935410038" xlink:type="simple">10.1023/A:1008935410038</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sherlock</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Thiery</surname> <given-names>A H</given-names></name>, <name name-style="western"><surname>Roberts</surname> <given-names>G O</given-names></name>, and <name name-style="western"><surname>Rosenthal</surname> <given-names>J S</given-names></name>. <article-title>On the efficiency of pseudo-marginal random walk Metropolis algorithms</article-title>. <source><italic>The Annals of Statistics</italic></source>, <volume>43</volume>(<issue>1</issue>):<fpage>238</fpage>–<lpage>275</lpage>, <year>2015</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/14-AOS1278" xlink:type="simple">10.1214/14-AOS1278</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pitt</surname> <given-names>M K</given-names></name>, <name name-style="western"><surname>dos Santos Silva</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Giordani</surname> <given-names>P</given-names></name>, and <name name-style="western"><surname>Kohn</surname> <given-names>R</given-names></name>. <article-title>On some properties of Markov chain Monte Carlo simulation methods based on the particle filter</article-title>. <source><italic>Journal of Econometrics</italic></source>, <volume>171</volume>(<issue>2</issue>):<fpage>134</fpage>–<lpage>151</lpage>, <year>2012</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jeconom.2012.06.004" xlink:type="simple">10.1016/j.jeconom.2012.06.004</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pritchard</surname> <given-names>J K</given-names></name>, <name name-style="western"><surname>Seielstad</surname> <given-names>M T</given-names></name>, <name name-style="western"><surname>Perez-Lezaun</surname> <given-names>A</given-names></name>, and <name name-style="western"><surname>Feldman</surname> <given-names>M W</given-names></name>. <article-title>Population growth of human Y chromosomes: a study of Y chromosome microsatellites</article-title>. <source><italic>Molecular Biology and Evolution</italic></source>, <volume>16</volume>(<issue>12</issue>):<fpage>1791</fpage>–<lpage>1798</lpage>, <year>1999</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/oxfordjournals.molbev.a026091" xlink:type="simple">10.1093/oxfordjournals.molbev.a026091</ext-link></comment> <object-id pub-id-type="pmid">10605120</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Beaumont</surname> <given-names>M A</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>W</given-names></name>, and <name name-style="western"><surname>Balding</surname> <given-names>D J</given-names></name>. <article-title>Approximate Bayesian computation in population genetics</article-title>. <source><italic>Genetics</italic></source>, <volume>162</volume>(<issue>4</issue>):<fpage>2025</fpage>–<lpage>2035</lpage>, <year>2002</year>. <object-id pub-id-type="pmid">12524368</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref036">
<label>36</label>
<mixed-citation publication-type="other" xlink:type="simple">Prangle D. Adapting the ABC distance function. <italic>arXiv preprint arXiv:1507.00874</italic>, 2015.</mixed-citation>
</ref>
<ref id="pcbi.1006235.ref037">
<label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Harrison J U and Baker R E. An automatic adaptive method to combine summary statistics in approximate Bayesian computation. <italic>arXiv preprint arXiv:1703.02341</italic>, 2017.</mixed-citation>
</ref>
<ref id="pcbi.1006235.ref038">
<label>38</label>
<mixed-citation publication-type="other" xlink:type="simple">E Bernton, Jacob P E, Gerber M, and Robert C P. Inference in generative models using the wasserstein distance. <italic>arXiv preprint arXiv:1701.05146</italic>, 2017.</mixed-citation>
</ref>
<ref id="pcbi.1006235.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>I T</given-names></name>, and <name name-style="western"><surname>De Jong</surname> <given-names>J G</given-names></name>. <article-title>Photon budget analysis for fluorescence lifetime imaging microscopy</article-title>. <source><italic>Journal of Biomedical Optics</italic></source>, <volume>16</volume>(<issue>8</issue>):<fpage>086007</fpage>–<lpage>086007</lpage>, <year>2011</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1117/1.3608997" xlink:type="simple">10.1117/1.3608997</ext-link></comment> <object-id pub-id-type="pmid">21895319</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Taylor</surname> <given-names>H B</given-names></name>, <name name-style="western"><surname>Liepe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Barthen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bugeon</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Huvet</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kirk</surname> <given-names>P W</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>S B</given-names></name>, <name name-style="western"><surname>Lamb</surname> <given-names>J R</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>M P H</given-names></name>, and <name name-style="western"><surname>Dallman</surname> <given-names>M</given-names></name>. <article-title>P38 and JNK have opposing effects on persistence of in vivo leukocyte migration in zebrafish</article-title>. <source><italic>Immunology and Cell Biology</italic></source>, <volume>91</volume>(<issue>1</issue>):<fpage>60</fpage>–<lpage>69</lpage>, <year>2013</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/icb.2012.57" xlink:type="simple">10.1038/icb.2012.57</ext-link></comment> <object-id pub-id-type="pmid">23165607</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weavers</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Liepe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sim</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wood</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>P</given-names></name>, and <name name-style="western"><surname>Stumpf</surname> <given-names>M P H</given-names></name>. <article-title>Systems analysis of the dynamic inflammatory response to tissue damage reveals spatiotemporal properties of the wound attractant gradient</article-title>. <source><italic>Current Biology</italic></source>, <volume>26</volume>(<issue>15</issue>):<fpage>1975</fpage>–<lpage>1989</lpage>, <year>2016</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cub.2016.06.012" xlink:type="simple">10.1016/j.cub.2016.06.012</ext-link></comment> <object-id pub-id-type="pmid">27426513</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fearnhead</surname> <given-names>P</given-names></name> and <name name-style="western"><surname>Prangle</surname> <given-names>D</given-names></name>. <article-title>Constructing summary statistics for approximate Bayesian computation: semi-automatic approximate Bayesian computation</article-title>. <source><italic>Journal of the Royal Statistical Society: Series B</italic></source>, <volume>74</volume>(<issue>3</issue>):<fpage>419</fpage>–<lpage>474</lpage>, <year>2012</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1467-9868.2011.01010.x" xlink:type="simple">10.1111/j.1467-9868.2011.01010.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barnes</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Filippi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>M P H</given-names></name>, and <name name-style="western"><surname>Thorne</surname> <given-names>T</given-names></name>. <article-title>Considerate approaches to constructing summary statistics for ABC model selection</article-title>. <source><italic>Statistics and Computing</italic></source>, <volume>22</volume>(<issue>6</issue>):<fpage>1181</fpage>–<lpage>1197</lpage>, <year>2012</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11222-012-9335-7" xlink:type="simple">10.1007/s11222-012-9335-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Blum</surname> <given-names>M G</given-names></name>, <name name-style="western"><surname>Nunes</surname> <given-names>M A</given-names></name>, <name name-style="western"><surname>Prangle</surname> <given-names>D</given-names></name>, and <name name-style="western"><surname>Sisson</surname> <given-names>S A</given-names></name>. <article-title>A comparative review of dimension reduction methods in approximate Bayesian computation</article-title>. <source><italic>Statistical Science</italic></source>, <volume>28</volume>(<issue>2</issue>):<fpage>189</fpage>–<lpage>208</lpage>, <year>2013</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/12-STS406" xlink:type="simple">10.1214/12-STS406</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sisson</surname> <given-names>S A</given-names></name>, <name name-style="western"><surname>Fan</surname> <given-names>Y</given-names></name>, and <name name-style="western"><surname>Tanaka</surname> <given-names>M M</given-names></name>. <article-title>Sequential Monte Carlo without likelihoods</article-title>. <source><italic>Proceedings of the National Academy of Sciences</italic></source>, <volume>104</volume>(<issue>6</issue>):<fpage>1760</fpage>–<lpage>1765</lpage>, <year>2007</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0607208104" xlink:type="simple">10.1073/pnas.0607208104</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Toni</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Welch</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Strelkowa</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ipsen</surname> <given-names>A</given-names></name>, and <name name-style="western"><surname>Stumpf</surname> <given-names>M P H</given-names></name>. <article-title>Approximate Bayesian computation scheme for parameter inference and model selection in dynamical systems</article-title>. <source><italic>Journal of the Royal Society Interface</italic></source>, <volume>6</volume>(<issue>31</issue>):<fpage>187</fpage>–<lpage>202</lpage>, <year>2009</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2008.0172" xlink:type="simple">10.1098/rsif.2008.0172</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Blum</surname> <given-names>M G</given-names></name> and <name name-style="western"><surname>François</surname> <given-names>O</given-names></name>. <article-title>Non-linear regression models for approximate Bayesian computation</article-title>. <source><italic>Statistics and Computing</italic></source>, <volume>20</volume>(<issue>1</issue>):<fpage>63</fpage>–<lpage>73</lpage>, <year>2010</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11222-009-9116-0" xlink:type="simple">10.1007/s11222-009-9116-0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref048">
<label>48</label>
<mixed-citation publication-type="other" xlink:type="simple">
Frazier D T, Robert C P, and Rousseau J. Model misspecification in abc: Consequences and diagnostics. <italic>arXiv preprint arXiv:1708.01974</italic>, 2017.</mixed-citation>
</ref>
<ref id="pcbi.1006235.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zimyanin</surname> <given-names>V L</given-names></name>, <name name-style="western"><surname>Belaya</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Pecreaux</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gilchrist</surname> <given-names>M J</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>I</given-names></name>, and <name name-style="western"><surname>St Johnston</surname> <given-names>D</given-names></name>. <article-title>In vivo imaging of oskar mRNA transport reveals the mechanism of posterior localization</article-title>. <source><italic>Cell</italic></source>, <volume>134</volume>(<issue>5</issue>):<fpage>843</fpage>–<lpage>853</lpage>, <year>2008</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2008.06.053" xlink:type="simple">10.1016/j.cell.2008.06.053</ext-link></comment> <object-id pub-id-type="pmid">18775316</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scott</surname> <given-names>S L</given-names></name>, <name name-style="western"><surname>Blocker</surname> <given-names>A W</given-names></name>, <name name-style="western"><surname>Bonassi</surname> <given-names>F V</given-names></name>, <name name-style="western"><surname>Chipman</surname> <given-names>H A</given-names></name>, <name name-style="western"><surname>George</surname> <given-names>E I</given-names></name>, and <name name-style="western"><surname>McCulloch</surname> <given-names>R E</given-names></name>. <article-title>Bayes and big data: The consensus Monte Carlo algorithm</article-title>. <source><italic>International Journal of Management Science and Engineering Management</italic></source>, <volume>11</volume>(<issue>2</issue>):<fpage>78</fpage>–<lpage>88</lpage>, <year>2016</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/17509653.2016.1142191" xlink:type="simple">10.1080/17509653.2016.1142191</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref051">
<label>51</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>R Core Team</collab>. <source><italic>R: A Language and Environment for Statistical Computing</italic></source>. <publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna, Austria</publisher-loc>, <year>2013</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org/" xlink:type="simple">http://www.R-project.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006235.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Miroshnikov</surname> <given-names>A</given-names></name> and <name name-style="western"><surname>Conlon</surname> <given-names>E M</given-names></name>. <article-title>ParallelMCMCcombine: an R package for Bayesian methods for big data and analytics</article-title>. <source><italic>PLOS One</italic></source>, <volume>9</volume>(<issue>9</issue>):<fpage>e108425</fpage>, <year>2014</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0108425" xlink:type="simple">10.1371/journal.pone.0108425</ext-link></comment> <object-id pub-id-type="pmid">25259608</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kumar</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mommer</surname> <given-names>S M</given-names></name> and <name name-style="western"><surname>Sourjik</surname> <given-names>V</given-names></name>. <article-title>Mobility of cytoplasmic, membrane, and DNA-binding proteins in Escherichia coli</article-title>. <source><italic>Biophysical Journal</italic></source>, <volume>98</volume>(<issue>4</issue>):<fpage>552</fpage>–<lpage>559</lpage>, <year>2010</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.bpj.2009.11.002" xlink:type="simple">10.1016/j.bpj.2009.11.002</ext-link></comment> <object-id pub-id-type="pmid">20159151</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006235.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Owen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wilkinson</surname> <given-names>D J</given-names></name>, and <name name-style="western"><surname>Gillespie</surname> <given-names>C S</given-names></name>. <article-title>Scalable inference for Markov processes with intractable likelihoods</article-title>. <source><italic>Statistics and Computing</italic></source>, <volume>25</volume>(<issue>1</issue>):<fpage>145</fpage>–<lpage>156</lpage>, <year>2015</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11222-014-9524-7" xlink:type="simple">10.1007/s11222-014-9524-7</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>