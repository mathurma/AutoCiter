<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01245</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003652</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject></subj-group></subj-group><subj-group><subject>Neuroscience</subject><subj-group><subject>Sensory systems</subject><subj-group><subject>Visual system</subject></subj-group></subj-group><subj-group><subject>Sensory perception</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Unsupervised Learning of Cone Spectral Classes from Natural Images</article-title>
<alt-title alt-title-type="running-head">Unsupervised Learning of Cone Spectral Classes</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Benson</surname><given-names>Noah C.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Manning</surname><given-names>Jeremy R.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="fn" rid="fn1"><sup>¤</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Brainard</surname><given-names>David H.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Psychology, University of Pennsylvania, Philadelphia, Pennsylvania, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Neurology, University of Pennsylvania, Philadelphia, Pennsylvania, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Bethge</surname><given-names>Matthias</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Tübingen and Max Planck Institute for Biologial Cybernetics, Germany</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">dhb@psych.upenn.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: NCB DHB. Performed the experiments: NCB. Analyzed the data: NCB DHB. Contributed reagents/materials/analysis tools: JRM. Wrote the paper: NCB DHB.</p></fn>
<fn id="fn1" fn-type="current-aff"><label>¤</label><p>Current address: Princeton Neuroscience Institute &amp; Department of Computer Science, Princeton University, Princeton, New Jersey, United States of America</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>6</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>26</day><month>6</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>6</issue>
<elocation-id>e1003652</elocation-id>
<history>
<date date-type="received"><day>13</day><month>7</month><year>2013</year></date>
<date date-type="accepted"><day>3</day><month>4</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Benson et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>The first step in the evolution of primate trichromatic color vision was the expression of a third cone class not present in ancestral mammals. This observation motivates a fundamental question about the evolution of any sensory system: how is it possible to detect and exploit the presence of a novel sensory class? We explore this question in the context of primate color vision. We present an unsupervised learning algorithm capable of both detecting the number of spectral cone classes in a retinal mosaic and learning the class of each cone using the inter-cone correlations obtained in response to natural image input. The algorithm's ability to classify cones is in broad agreement with experimental evidence about functional color vision for a wide range of mosaic parameters, including those characterizing dichromacy, typical trichromacy, anomalous trichromacy, and possible tetrachromacy.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>The human visual system encodes color by comparing the responses of three different kinds of photoreceptors: the long- (reddish), medium- (greenish), and short- (bluish) wavelength-sensitive cone cells. In order for the visual system to accurately represent the color of stimuli, it must (in effect) know the class of the cone that produced each response. The long- and medium-wavelength-sensitive cones, however, are virtually identical in every known way except that their responses to a given spectrum of light differ. Here, we simulate cones in a model human retina and show that by examining the correlation of the responses of cones to natural scenes, it is possible to determine both the number cone classes present in a retinal mosaic and to explicitly determine the class of each cone. These findings shed light on the computational mechanisms that may have enabled the evolution of human color vision, as well as on the more general question of whether and when it is possible for sensory systems to self-organize.</p>
</abstract>
<funding-group><funding-statement>This work was supported by the Commonwealth Universal Research Enhancement (CURE) program from the Pennsylvania Department of Health (<ext-link ext-link-type="uri" xlink:href="http://www.portal.state.pa.us/portal/server.pt/community/health_research_program_cure/" xlink:type="simple">http://www.portal.state.pa.us/portal/server.pt/community/health_research_program_cure/</ext-link>) and by NIH RO1 EY10016. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="13"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Primate color vision is initiated when light spectra entering the eye are encoded by three classes of retinal cone photoreceptors: the long- (L), medium- (M), and short- (S) wavelength-sensitive cones. Trichromatic encoding alone, however, is not sufficient to support functional trichromatic color vision. In addition, the information encoded by the cones must be preserved by post-receptoral neural circuitry in a manner that enables both color discrimination and the representation of stimulus color.</p>
<p>The emergence of distinct L and M cones in primates is a recent evolutionary event <xref ref-type="bibr" rid="pcbi.1003652-Nathans1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1003652-Dulai1">[4]</xref>, and the only known difference between these cones is the photopigment opsin contained in their outer segments <xref ref-type="bibr" rid="pcbi.1003652-Hendry1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Smallwood1">[6]</xref>. These observations make it unlikely, given current knowledge, that the formation of appropriate post-receptoral circuitry can rely on biochemical markers that distinguish L and M cones and suggest instead that this circuitry must be learned.</p>
<p>The fact that the first step in the evolution of trichromatic color vision was the expression of a third cone class leads to two important questions. First, how can a post-receptoral visual system detect the presence of a new cone class? Second, how can such a system classify individual cones according to their spectral class, so as to take advantage of the information carried by the newly expressed opsin? More generally, the question of what information enables the brain to initially detect and differentiate the presence of novel sensory transducers applies to any sensory modality which provides a multidimensional perceptual representation. Here we provide a computational treatment of these fundamental questions in the context of primate color vision and show that the inter-cone correlations induced by natural images may be used to detect when a mosaic contains three rather than two cone classes and to accurately classify L versus M cones.</p>
<p>We build on previous work, some available only in abstract form, that considers the concrete question of how learning might produce model neural units whose wiring differentiates signals from L and M cones <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Ahumada1">[8]</xref>. Importantly, this work shows that there is indeed information in the cone responses to natural images that can differentiate L and M cones to some degree, in the sense that learning enabled above-chance formation of cone-class specific wiring of model units. Here, we extend the previous work in two ways.</p>
<p>First, we develop an algorithm that uses inter-cone response correlations to explicitly classify cones by their spectral type. Although such explicit classification is not a necessary feature of the brain's implementation of visual processing, it allows us to quantify the degree to which unsupervised learning can differentiate cones by type to support color vision. This quantification allows us to explore how classification performance depends on key parameters of the mosaic, for example particular on the number of cone types, the ratio of L to M cones, and the spectral sensitivities of the different cone classes.</p>
<p>Second, the appropriate representation of stimulus color depends on the number of cone classes present in the mosaic. In humans <xref ref-type="bibr" rid="pcbi.1003652-Pokorny1">[9]</xref> (and also New World primates <xref ref-type="bibr" rid="pcbi.1003652-Jacobs1">[2]</xref>) there is individual variation in this number, primarily in the form of red-green dichromacy. Thus it is also of interest to investigate whether learning can detect the number of longer-wavelength-sensitive cone classes present in an individual retinal mosaic.</p>
<p>Our approach is computational. That is, we abstract, for the most part, from known features of retinal and cortical circuitry and consider what is possible using information encoded by the distal retina in response to natural images.</p>
</sec><sec id="s2">
<title>Results</title>
<p>We begin by considering how to classify L versus M cones in a mosaic that is known to contain both cone classes; below we return to the problem of detecting the number of cone classes present in a mosaic. To proceed, we simulated the responses of retinal cone mosaics to natural images. The images used in the simulations were collected from three hyperspectral image databases <xref ref-type="bibr" rid="pcbi.1003652-Prraga1">[10]</xref>–<xref ref-type="bibr" rid="pcbi.1003652-Chakrabarti1">[12]</xref>. A hyperspectral image specifies the full light spectrum at each pixel, in contrast to standard color images which contain only red, green, and blue (RGB) values. The use of hyperspectral images allows us to accurately simulate the responses of cones from their specified spectral sensitivities. An RGB rendering of a hyperspectral image from the dataset is shown in <xref ref-type="fig" rid="pcbi-1003652-g001">Figure 1A</xref>.</p>
<fig id="pcbi-1003652-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003652.g001</object-id><label>Figure 1</label><caption>
<title>Natural image correlations are highly regular in both space and spectrum.</title>
<p>(<bold>A</bold>) An RGB rendering of a hyperspectral image taken from the natural image database described by Chakrabarti and Zickler <xref ref-type="bibr" rid="pcbi.1003652-Chakrabarti1">[12]</xref>. The code used to render this figure is included in our gitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/DavidBrainard/ReceptorLearning/" xlink:type="simple">https://github.com/DavidBrainard/ReceptorLearning/</ext-link>). (<bold>B</bold>) Image correlations for images from our combined database. Correlation is plotted as a function of distance (pixel). Each curve represents a different wavelength separation: the black curve represents no wavelength difference while the yellow curve represents a difference of 320 nm (<italic>i.e.</italic>, the 400 nm channel correlated with the 720 nm channel).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003652.g001" position="float" xlink:type="simple"/></fig>
<p>We constructed simulated cone mosaics using parameters typical of human vision. <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2A</xref> illustrates one of our simulated mosaics. The assumed spectral sensitivities are shown in <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2B</xref>. We simulated the responses of each cone in the mosaic to 2 million image patches sampled randomly from our full hyperspectral image dataset and computed the 400 by 400 correlation matrix between the responses of all pairs of cones in the mosaic. Because the distal retina forms spatially antagonistic receptive fields <xref ref-type="bibr" rid="pcbi.1003652-Hirasawa1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Verweij1">[14]</xref>, our main analysis used simulated cone responses that incorporated an opponent surround that draws on neighboring cones irrespective of their type (see <xref ref-type="sec" rid="s4">Methods</xref>).</p>
<fig id="pcbi-1003652-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003652.g002</object-id><label>Figure 2</label><caption>
<title>Inter-cone correlations carry information about cone spectral class and mosaic arrangement.</title>
<p>(<bold>A</bold>) A <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e001" xlink:type="simple"/></inline-formula> cone mosaic with an L∶M∶S ratio of 47∶47∶6; each cone is colored by class (red, green, and blue for L, M, and S cones, respectively). (<bold>B</bold>) The spectral sensitivities of L, M, and S cones in a typical fovea <xref ref-type="bibr" rid="pcbi.1003652-Stockman1">[52]</xref>. (<bold>C</bold>) The mosaic from Panel <bold>A</bold> with grayscale indicating the correlation of each cone's response to the response of the single M cone plotted in green. The correlations are calculated from the responses to 2,000,000 natural images. At this scale it is readily apparent that correlations decrease with inter-cone distance and that S cones are distinguished from M cones by their correlations. (<bold>D</bold>) Magnified view of the correlation of the immediately adjacent neighbors of the green M cone from Panel <bold>C</bold>, with grayscale indicating correlation. Red and green circles indicate the class of each neighboring cone. Of the four immediate neighbors of the central cone, the two neighboring M cones (green) have higher correlations than the neighboring L cones (red). (<bold>E</bold>) Magnified view of the correlation of the diagonal neighbors of the green M cone from Panel <bold>C</bold>, with grayscale indicating correlation. The neighboring M cones have higher correlations than the two neighboring L cones. (<bold>F</bold>) A smoothed histogram of the correlations of immediately neighboring longer-wavelength-sensitive cones in 54 simulated mosaics whose M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e002" xlink:type="simple"/></inline-formula> value was 530 nm and whose L cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e003" xlink:type="simple"/></inline-formula> value was 558.9 nm. The 54 mosaics differed in their L∶M cone ratios and sizes. Correlations between neighboring L cones, neighboring M cones, and L-M neighbors are shown in red, green, and black respectively. The histograms represent correlations from 9,862 L-L cone pairs, 9,769 M-M cone pairs, and 8,369 L-M cone pairs.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003652.g002" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2C</xref> depicts one row of the full correlation matrix in image format, with the gray level of each cone in the panel indicating the correlation between that cone and the single M cone shown in green. Two previously observed features of the correlation structure may be seen in this representation <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Burton1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Tkaik1">[16]</xref>. First, correlation in cone responses decreases as a function of spatial distance. Second, once distance is equated, correlations between cones of the same class are higher than correlations between cones of different classes (<xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2D and 2E</xref>). These two features are induced by the spatial-spectral correlation structure of natural hyperspectral images (<xref ref-type="fig" rid="pcbi-1003652-g001">Figure 1B</xref>).</p>
<p><xref ref-type="fig" rid="pcbi-1003652-g002">Figures 2D and 2E</xref> provide intuition about what information could be used to classify L versus M cones. Consider an illustrative algorithm that starts with a single cone (<italic>e.g.</italic>, the M cone shown in <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2C</xref>) and labels it (arbitrarily) as an M cone. The algorithm would then classify that cone's neighbors as being of the same or different class by setting a threshold on the correlation values. By propagating this procedure across the mosaic, labels would be assigned to all cones. Such an algorithm would be effective if the distributions of nearest neighbor within-class correlations had little if any overlap with the distribution of between-class correlations.</p>
<p><xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2F</xref> shows the histograms of such correlations for our dataset. Although the histograms make clear that within-class correlations are on average higher than between-class correlations and therefore carry information about cone class, the overlap between the two types of correlation means that nearest neighbor correlations alone are not sufficient for good classification. Note, however, that the histograms shown in <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2F</xref> only depict the information carried by nearest neighbor correlations, leaving open the possibility that additional information carried by the full correlation matrix could support a robust solution to the cone classification problem.</p>
<p>To visualize and exploit the information about cone class carried by the full correlation matrix, consider a three-dimensional representational space where the first two dimensions, call them <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e004" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e005" xlink:type="simple"/></inline-formula>, provide the spatial position of a cone in the mosaic and where the third dimension, call it <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e006" xlink:type="simple"/></inline-formula>, indicates spectral class. To conceive of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e007" xlink:type="simple"/></inline-formula> as continuous, we treat it as indicating the wavelength of peak sensitivity, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e008" xlink:type="simple"/></inline-formula>, of each cone. Because the correlation between two cones decreases both with increasing spatial distance and with increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e009" xlink:type="simple"/></inline-formula> difference between them, the negative log of the correlation matrix may be thought of as a proxy for the distance between cones in this abstract representational space.</p>
<p>We used the well-developed technique of non-metric multidimensional scaling (MDS) <xref ref-type="bibr" rid="pcbi.1003652-Kruskal1">[17]</xref> to place each cone from the mosaic shown in <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2A</xref> at a position in a three-dimensional space such that the inter-cone distances in this space best predicted, up to a free monotonic transformation, the negative log of the correlation matrix. <xref ref-type="fig" rid="pcbi-1003652-g003">Figure 3A</xref> shows the result. Each point represents a single cone, and the cones are colored red, green, or blue for L, M, and S respectively. It is clear that when the full correlation matrix is used to embed the mosaic cones, their positions separate strongly by class. <xref ref-type="fig" rid="pcbi-1003652-g003">Figure 3B</xref> shows an expanded view of the embedding that includes only the L and M cones. In both <xref ref-type="fig" rid="pcbi-1003652-g003">Figure 3A and 3B</xref>, the view is of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e010" xlink:type="simple"/></inline-formula>-<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e011" xlink:type="simple"/></inline-formula> plane of the representational space. A view of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e012" xlink:type="simple"/></inline-formula>-<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e013" xlink:type="simple"/></inline-formula> plane for the L and M cones is provided in <xref ref-type="supplementary-material" rid="pcbi.1003652.s001">Figure S1</xref> and shows that the relative spatial positions of these cones are also well-preserved in the embedding. <xref ref-type="supplementary-material" rid="pcbi.1003652.s002">Figure S2</xref> shows that the embedding accounts well for the underlying correlation matrix. <xref ref-type="supplementary-material" rid="pcbi.1003652.s003">Figure S3</xref> shows embeddings for additional simulations where the separation of L and M cone spectral sensitivities and L∶M cone ratio were varied. These additional simulations are discussed in more detail below.</p>
<fig id="pcbi-1003652-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003652.g003</object-id><label>Figure 3</label><caption>
<title>Multidimensional scaling allows classification of cones for a typical trichromatic retinal mosaic.</title>
<p>(<bold>A</bold>) 3D embeddings of the correlation matrix of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e014" xlink:type="simple"/></inline-formula> mosaic from <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2A</xref>. Each point represents a single cone and is colored red, green, or blue for L, M, or S respectively, according to its actual identity in the mosaic. The 3D embeddings shown here and in other figures in this paper are oriented so that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e015" xlink:type="simple"/></inline-formula>-<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e016" xlink:type="simple"/></inline-formula> plane (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e017" xlink:type="simple"/></inline-formula> horizontal, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e018" xlink:type="simple"/></inline-formula> vertical) of the representational space described in the text is shown. The absolute units on these axes are not meaningful, because MDS solutions are determined only up to a relative-distance preserving transformation. (<bold>B</bold>) The same 3D embedding shown in A zoomed in on the embedding of the L and M cones only. (<bold>C</bold>) The 3D embedding of the L and M cones from <bold>A</bold> after flattening. (<bold>D</bold>) A histogram of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e019" xlink:type="simple"/></inline-formula> positions of the embedding from <bold>C</bold> (<italic>i.e.</italic>, after flattening); best fit skew normals are shown in red and green. Rotating animations that show the three-dimensional structure of the embeddings are available online (<ext-link ext-link-type="uri" xlink:href="http://color.psych.upenn.edu/supplements/receptorlearning" xlink:type="simple">http://color.psych.upenn.edu/supplements/receptorlearning</ext-link>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003652.g003" position="float" xlink:type="simple"/></fig>
<p>Note that MDS embeddings are determined only up to a distance preserving transformation. In our simulations, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e020" xlink:type="simple"/></inline-formula> mosaics that contained S as well as longer-wavelength-sensitive cones, the first dimension of the embedding returned by the MDS algorithm we used (Matlab's mdscale, found in the Statistics Toolbox) generally corresponded approximately to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e021" xlink:type="simple"/></inline-formula> dimension of the conceptual representational space described above. This first dimension is by the conventions of MDS the one that explains most of the variance in the similarity matrix, and it is the large separation between the responses of S cones compared to longer-wavelength-sensitive cones that drives this alignment. Throughout this paper, then, we refer to the first, second, and third dimensions of the MDS solution as the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e022" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e023" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e024" xlink:type="simple"/></inline-formula> dimensions respectively. The only exceptions to this ordering of the dimensions were simulations of tritanopic (no S cones) mosaics and small (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e025" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e026" xlink:type="simple"/></inline-formula>) mosaics. When we simulated tritanopic mosaics and the smaller mosaics, the MDS solutions reliably separated cone type along the third instead of the first dimension, instead organizing the spatial arrangement of the mosaic along the first two dimensions. For all simulations of mosaics containing S cones, we used an algorithmic procedure to rotate the embedding returned by the MDS algorithm so that the first dimension of the rotated solution corresponded more precisely to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e027" xlink:type="simple"/></inline-formula> dimension of the conceptual representational space. The rotation algorithm is described in <xref ref-type="sec" rid="s4">Methods</xref>. It relied on the fact that the S cones could be easily identified from the embeddings (again, see <xref ref-type="sec" rid="s4">Methods</xref>) and it aligned the vector from the mean of the embedded positions of the non-S cones to the mean of the embedded position of the S cones. For all simulations with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e028" xlink:type="simple"/></inline-formula> mosaics the effect of this rotation was small. We return to the analysis of learning for tritanopes below.</p>
<p>The embedding shown in <xref ref-type="fig" rid="pcbi-1003652-g003">Figure 3</xref> separates the three cone classes along the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e029" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e030" xlink:type="simple"/></inline-formula>) dimension of the representational space. The positions of the S cones are highly distinct from those of the L and M cones. The L and M cones also separate well from each other, although in other simulation conditions there is overlap in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e031" xlink:type="simple"/></inline-formula> positions of these two cone classes (see, for example, <xref ref-type="supplementary-material" rid="pcbi.1003652.s003">Figure S3</xref>). In most such cases, however, the L and M cones are actually embedded along separate curved surfaces within the full-three dimensional representation, but the curvature of these surfaces produces overlap in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e032" xlink:type="simple"/></inline-formula> positions of L and M cones. The curved surfaces may be flattened in a manner that preserves the local planar structure of each (see <xref ref-type="sec" rid="s4">Methods</xref>). The result of applying the flattening procedure to the embedding shown in <xref ref-type="fig" rid="pcbi-1003652-g003">Figure 3B</xref> is provided in <xref ref-type="fig" rid="pcbi-1003652-g003">Figure 3C</xref>, where the separation between the L and M clusters remains apparent. To classify cones, we extracted the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e033" xlink:type="simple"/></inline-formula> position of each cone in the flattened representation and fit the resulting distribution as the mixture of two skew normal distributions (<xref ref-type="fig" rid="pcbi-1003652-g003">Figure 3D</xref>). We then used the parameters of the two distributions to determine a threshold along the flattened <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e034" xlink:type="simple"/></inline-formula>-axis, and labeled all cones to the left of the threshold as M and all cones to the right as L. The threshold was taken as the point between the means of the two fit distributions where their probability density functions were equal. Note that the labeling of L versus M is not arbitrary, but rather is determined by the position of the well-separated S cones, which are themselves classified algorithmically through a preprocessing step (again see <xref ref-type="sec" rid="s4">Methods</xref>). This algorithm classifies 100% of the L and M cones correctly from the correlation matrix, for the mosaic shown in <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2A</xref>.</p>
<p>Across individuals, human retinal mosaics vary in two key ways. First, there is substantial variation in the L∶M cone ratio, from approximately 1∶3 to 16∶1 <xref ref-type="bibr" rid="pcbi.1003652-Roorda1">[18]</xref>–<xref ref-type="bibr" rid="pcbi.1003652-Hofer1">[20]</xref>. Second, polymorphisms in the genes that encode the L and M cone opsins lead to variation in the wavelength of peak sensitivity (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e035" xlink:type="simple"/></inline-formula>) of the L and M cones; individuals possessing L or M opsins with atypical spectral sensitivities are referred to as anomalous trichromats <xref ref-type="bibr" rid="pcbi.1003652-Neitz1">[21]</xref>. The existence of these variations motivated us to study how the ability to classify L and M cones depends on the L∶M cone ratio and on the separation between the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e036" xlink:type="simple"/></inline-formula> values of the L and M cones.</p>
<p><xref ref-type="fig" rid="pcbi-1003652-g004">Figure 4A</xref> shows the results. Each square in the figure indicates the mean percentage of cones correctly classified for a particular choice of L∶M cone ratio and particular separation of L and M <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e037" xlink:type="simple"/></inline-formula> across three simulations. The results for individual simulations are given in <xref ref-type="supplementary-material" rid="pcbi.1003652.s004">Figure S4</xref>. Although both L and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e038" xlink:type="simple"/></inline-formula> can vary across individuals, we parameterized differences by holding the L cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e039" xlink:type="simple"/></inline-formula> fixed at its typical value of 558.9 nm and varying the M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e040" xlink:type="simple"/></inline-formula> in 5 nm steps between its typical value of 530 nm and an upper bound of 555 nm. The figure shows that the algorithm is generally robust, but that classification performance falls off at the more extreme cone ratios. Approximately 16∶1 is the largest reported L∶M ratio for individuals whose color vision is normal by standard tests <xref ref-type="bibr" rid="pcbi.1003652-Hofer1">[20]</xref>. Algorithm performance also degrades with respect to decreases in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e041" xlink:type="simple"/></inline-formula> separation between the L and M cones.</p>
<fig id="pcbi-1003652-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003652.g004</object-id><label>Figure 4</label><caption>
<title>The algorithm detects the number of longer-wavelength-sensitive cone classes and correctly classifies individual cones for a range of trichromatic mosaic parameters.</title>
<p>(<bold>A</bold>) The fraction of cones correctly classified for various combinations of L∶M cone ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e042" xlink:type="simple"/></inline-formula> value, when the number of longer-wavelength cone classes (L and M) was assumed to be 2. The S cone proportion was held at 6%, and S cones were given a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e043" xlink:type="simple"/></inline-formula> value of 420.7 nm in all simulations. The L cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e044" xlink:type="simple"/></inline-formula> value was 558.9 nm. Each cell in the plot represents the aggregate results of three simulations, each with a different mosaic and each shown a different random sample of 2 million natural image patches. Mosaic responses for each simulation were obtained with different draws of natural image patches. Accuracies are reported as the average accuracy for L and M cones, each calculated separately. For example, if the algorithm correctly classified 354 of 354 L cones and 1 of 22 M cones in a mosaic with an L∶M ratio of 16∶1, the overall accuracy reported here would be 52% (the mean of 354/354 and 1/22) rather than 94% (the fraction of all cones correctly classified). (<bold>B</bold>) The number of simulations (of three) for each L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e045" xlink:type="simple"/></inline-formula> value where the algorithm correctly detected that there were two longer-wavelength-sensitive cone classes. The results for individual simulations are given in <xref ref-type="supplementary-material" rid="pcbi.1003652.s004">Figure S4</xref>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003652.g004" position="float" xlink:type="simple"/></fig>
<p>The fact that good classification is accomplished with a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e046" xlink:type="simple"/></inline-formula> mosaic indicates that the information necessary to support learning can be accessed by local computations in either the retina or early retinotopic visual cortex. Indeed, we found that good learning was maintained when the mosaic size was reduced to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e047" xlink:type="simple"/></inline-formula> and was reduced only slightly for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e048" xlink:type="simple"/></inline-formula> mosaics (<xref ref-type="supplementary-material" rid="pcbi.1003652.s005">Figure S5</xref>). In separate simulations, we examined the effect of showing fewer natural image patches to the retinal mosaic (<xref ref-type="supplementary-material" rid="pcbi.1003652.s006">Figure S6</xref>). For many of our mosaic conditions, asymptotic learning occurs for many fewer than the 2,000,000 images used in the main simulations.</p>
<p>Results for simulations without a suppressive surround are given in <xref ref-type="supplementary-material" rid="pcbi.1003652.s007">Figure S7</xref>. A comparison with <xref ref-type="fig" rid="pcbi-1003652-g004">Figure 4</xref> shows that the presence of a randomly-wired surround enhances learning performance slightly relative to no surround while smaller retinal mosaics result in slightly worse learning. Additional simulations, run using a retinas with the same parameters as those shown in <xref ref-type="fig" rid="pcbi-1003652-g004">Figure 4</xref> but such that the suppressive surround was cone selective (<italic>i.e.</italic>, L cone surrounds were made only of M cones, M cone surrounds were made only of L cones), were also performed (<xref ref-type="supplementary-material" rid="pcbi.1003652.s008">Figure S8</xref>). Interestingly, the presence of cone specific opponent surrounds early in the visual pathways impedes the performance of our algorithm.</p>
<p>The algorithm as described and evaluated above relied on the assumption that the mosaic contains both L and M cones. This assumption entered the calculations at the step where we fit two skew normal distributions to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e049" xlink:type="simple"/></inline-formula> position histograms of the embedded cones (<xref ref-type="fig" rid="pcbi-1003652-g003">Figure 3D</xref>). In addition to variation in L and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e050" xlink:type="simple"/></inline-formula>, however, there are also individuals who are dichromats with mosaics containing S cones and only one longer-wavelength-sensitive cone class (<italic>i.e.</italic>, red/green color blindness). For such dichromatic retinal mosaics this algorithm would randomly divide the single longer-wavelength-sensitive cones into two classes. To address the question of whether it is possible to determine the number of longer-wavelength-sensitive cone classes present in a mosaic, we elaborated the algorithm with a step that compared how well a mixture of 1, 2, or 3 skew normal distributions fit the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e051" xlink:type="simple"/></inline-formula> position histograms and chose the number of longer-wavelength-sensitive cone classes based on this fit. Specifically, we applied a Kolmogorov-Smirnov goodness of fit test <xref ref-type="bibr" rid="pcbi.1003652-Gibbons1">[22]</xref> to the discovered mixture distributions and chose the smallest mixture number whose fit to the flattened <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e052" xlink:type="simple"/></inline-formula> positions could not be rejected using a two-tailed critical <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e053" xlink:type="simple"/></inline-formula>-value of 0.01. When the elaborated algorithm is applied to the correlation matrices of a dichromatic retinal mosaic, it correctly detects that there is only a single longer-wavelength-sensitive cone class and thus classifies all of the longer-wavelength-sensitive cones as belonging together in a single class (<xref ref-type="fig" rid="pcbi-1003652-g005">Figure 5A–5D</xref>).</p>
<fig id="pcbi-1003652-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003652.g005</object-id><label>Figure 5</label><caption>
<title>The algorithm detects dichromatic and tetrachromatic retinal mosaics.</title>
<p>On the left are embeddings of the dichromatic retinal mosaic: (<bold>A</bold>) the full embedding; (<bold>B</bold>) the embedding zoomed in on just the L cones; (<bold>C</bold>) the flattened L cone embedding; and (<bold>D</bold>) a histogram of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e054" xlink:type="simple"/></inline-formula> positions of the flattened L cone embedding with the best-fit of the single detected skew normal. On the right are embeddings of the tetrachromatic retinal mosaic: (<bold>E</bold>) the full embedding; (<bold>F</bold>) the embedding zoomed in on just the L, M, and anomalous (A) cones; (<bold>G</bold>) the flattened L, M, and A cone embedding; and (<bold>H</bold>) a histogram of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e055" xlink:type="simple"/></inline-formula> coordinates of the flattened L, M, and A cone embedding with best fit of a mixture of the detected skew normals. Note that the units on Panels <bold>A</bold>, <bold>B</bold>, <bold>C</bold>, <bold>E</bold>, <bold>F</bold>, and <bold>G</bold> are arbitrary, as MDS does not produce meaningful units, but rather yields a relative-distance-preserving embedding. Spectral sensitivity curves for L, M, and S cones are shown in <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2A</xref>. Anomalous A cones were given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e056" xlink:type="simple"/></inline-formula> values of 545 nm, and the tetrachromatic retinal mosaic had an L∶M∶A ratio of 1∶1∶1. L, A, M, and S cones are colored red, yellow, green, and blue, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003652.g005" position="float" xlink:type="simple"/></fig>
<p>Given the success of the elaborated algorithm at correctly detecting that the dichromatic retinal mosaic is missing a cone class, we then asked whether it also detected that trichromatic retinal mosaics are in fact trichromatic. <xref ref-type="fig" rid="pcbi-1003652-g004">Figure 4B</xref> plots how well the elaborated algorithm detects that trichromatic retinal mosaics contain two classes of longer-wavelength-sensitive cones, as a function of L∶M ratio and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e057" xlink:type="simple"/></inline-formula> separation. Cells colored white indicate cases where the elaborated algorithm correctly detected the presence of both longer-wavelength-sensitive cone classes for all simulations. The pattern of accurate detection performance is generally similar to the patter of accurate classification performance, with detection accuracy falling off as the L∶M ratio becomes more extreme and as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e058" xlink:type="simple"/></inline-formula> separation decreases. The range of good performance for detection shown, however, is narrower than the range of good classification. An examination of <xref ref-type="supplementary-material" rid="pcbi.1003652.s004">Figure S4</xref> indicates that more cases of failure occur when the algorithm detects one (as opposed to three) longer-wavelength-sensitive cone classes than the other way around. Thus, we could presumably improve the range of good performance somewhat by adopting a more lenient criterion (lower critical <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e059" xlink:type="simple"/></inline-formula>-value) in our algorithm. We have not systematically explored this parameter space, however, as our view is that the key conclusion to be drawn from this work is that detection is possible for a reasonable range of mosaic parameters. A large number of additional factors (size of image patches, number of images sampled, presence of surround, cone-specificity of surround, nature of images sampled, optical blur, noisiness of cone responses) will all interact to push the exact boundaries of good performance as well as the direction of the failure modes around, and we do not wish to make too much of the particular location of these boundaries but rather focus on their general properties. <xref ref-type="supplementary-material" rid="pcbi.1003652.s005">Figures S5</xref>–<xref ref-type="supplementary-material" rid="pcbi.1003652.s011">S11</xref> show both detection and classification performance as various of these factors are varied. Online supplemental material available at <ext-link ext-link-type="uri" xlink:href="http://color.psych.upenn.edu/supplements/receptorlearning" xlink:type="simple">http://color.psych.upenn.edu/supplements/receptorlearning</ext-link> provides animated GIF renderings of the 3D embeddings corresponding to each of these supplemental figures (as well as to <xref ref-type="supplementary-material" rid="pcbi.1003652.s004">Figures S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003652.s009">S9</xref>). These additional simulations do reveal some cases where the algorithm detects three rather than two longer-wavelength-sensitive cone classes for some of the mosaic parameters. For the same reasons outlined above, we have not pursued the degree to which these over detections could be remedied by adjustment of the critical <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e060" xlink:type="simple"/></inline-formula>-value or model selection procedure. Rather, the broad point we draw from the set of additional simulations is that the algorithm is generally robust; see <xref ref-type="sec" rid="s3">Discussion</xref> for additional consideration of these simulations.</p>
<p>Some dichromats lack S cones but retain both L and M cones <xref ref-type="bibr" rid="pcbi.1003652-Wright1">[23]</xref>. These individuals are called tritanopes and can make color discriminations that rely on longer-wavelength-sensitive cones. Accordingly, we simulated a set of tritanopic retinal mosaics containing only L and M cones. The resulting embeddings indicate that there is generally sufficient information in the inter-cone correlation matrix to classify the L and M cones (<xref ref-type="supplementary-material" rid="pcbi.1003652.s009">Figure S9</xref>; also online supplemental material referenced just above). As discussed in the legend of <xref ref-type="supplementary-material" rid="pcbi.1003652.s009">Figure S9</xref>, however, extracting this information automatically would require design and implementation of an additional algorithmic step that aligned the direction of cone separation in the embedding with the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e061" xlink:type="simple"/></inline-formula> axis of our representational space, which we have not implemented. That is, the good alignment of the first dimension of the MDS solutions with the representational <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e062" xlink:type="simple"/></inline-formula> axis is driven by the presence of S cones in the mosaic, presumably because the presence of these cones produces greater correlation variation along this dimension (and in addition we could exploit the presence of S cones to refine the alignment). Additionally, simulation of a larger number of image patches (4.5 million) was required to produce good separation of the cone classes in the embedding. Thus, although the presence of S cones is probably not necessary for learning about longer-wavelength-sensitive cones, their presence does enhance the performance of our current algorithm. Note also that in the absence of S cones, the labeling of which cones are M and which are L becomes arbitrary; it is correct here because of the manual alignment procedure.</p>
<p>Some female humans possess genes that code for three longer-wavelength-sensitive cone photopigments, and there is evidence that all of these photopigments can be expressed in separate cones <xref ref-type="bibr" rid="pcbi.1003652-Neitz2">[24]</xref>. It is uncertain, however, whether these individuals process the output of their genetically tetrachromatic cone mosaics in a fashion that enables functional tetrachromatic color vision <xref ref-type="bibr" rid="pcbi.1003652-Nagy1">[25]</xref>–<xref ref-type="bibr" rid="pcbi.1003652-Jordan2">[27]</xref>. We simulated a tetrachromatic mosaic and applied our classification algorithm to the resulting correlation matrix. The fourth cone class, which we will call A, was given a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e063" xlink:type="simple"/></inline-formula> value of 545 nm, and the L∶M∶A ratio was 1∶1∶1. The algorithm correctly detected that this mosaic was tetrachromatic. <xref ref-type="fig" rid="pcbi-1003652-g005">Figure 5E–5H</xref> shows the classification results. The L, M, and A cones separate reasonably well but not perfectly in the embedding, and if we fit the flattened <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e064" xlink:type="simple"/></inline-formula> positions with three skew normal distributions (<xref ref-type="fig" rid="pcbi-1003652-g005">Figure 5H</xref>), the L, M, and A cones were classified with 100%, 100%, and 84% accuracy, respectively. This indicates that there is information in the correlation matrix that can support unsupervised cone classification in human tetrachromats, albeit imperfectly, at least for these specific simulation conditions.</p>
<p>In addition, we simulated tetrachromatic retinal mosaics with L, M, A, and S cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e065" xlink:type="simple"/></inline-formula> values of 558.9, 512.8, 466.8, and 420.7 (<italic>i.e.</italic>, with M and A cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e066" xlink:type="simple"/></inline-formula> values evenly spaced between the typical L and S cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e067" xlink:type="simple"/></inline-formula> values) and with L∶M∶A ratios of 1∶1∶1, 2∶1∶1, 2∶2∶1, 1∶2∶1, 1∶2∶2, 1∶1∶2, and 2∶1∶2. We found that the algorithm correctly detected 3 longer-wavelength-sensitive cone classes in all cases and correctly classified all but 7 cones correctly between the 7 simulations.</p>
</sec><sec id="s3">
<title>Discussion</title>
<p>The emergence of red-green color vision in primates is relatively recent, initiated by mutations that led to the expression of three rather than two cone opsins. In Old World Monkeys, this occurred approximately 35 million years ago via duplication of an ancestral M/L opsin gene followed by divergence of the two copies into the modern M and L cone opsin genes <xref ref-type="bibr" rid="pcbi.1003652-Nathans1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Hunt1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Dulai1">[4]</xref>. New World primates have also acquired functional trichromatic color vision, but through a different evolutionary path <xref ref-type="bibr" rid="pcbi.1003652-Jacobs1">[2]</xref>. The recent evolution of the L/M split may mean that biochemical differentiation of post-receptoral circuitry has not yet occurred. Consistent with this, there are no known molecular markers that differentiate L and M cones aside from their opsins <xref ref-type="bibr" rid="pcbi.1003652-Hendry1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Smallwood1">[6]</xref>. Earlier work <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref> established that unsupervised learning could produce a degree of cone-specific wiring, based on statistics of mosaic responses to natural images. Here we extend our understanding of what can be learned in two fundamental and important ways: we show that it is possible to learn the number of longer-wavelength-sensitive cone classes, and we quantify learning through the performance of an unsupervised learning algorithm that explicitly classifies each cone in the mosaic.</p>
<p>At present, the precise circuitry underlying red-green color vision in primates is not fully understood, and for this reason it is difficult to draw firm conclusions as to the locus where cone-class specific processing occurs. Some authors have suggested that circuitry in the adult retina does not distinguish L from M cones <xref ref-type="bibr" rid="pcbi.1003652-Lennie1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Jusuf1">[29]</xref>. They note that because midget cell centers in the primate fovea receive input from a single cone <xref ref-type="bibr" rid="pcbi.1003652-Rodieck1">[30]</xref>, random wiring of cones to ganglion cells would still preserve most of the color information in the fovea. This would then leave the full separation of L and M cone signals to be learned at the level of the cortex. Other authors <xref ref-type="bibr" rid="pcbi.1003652-Shapley1">[31]</xref>–<xref ref-type="bibr" rid="pcbi.1003652-Lee1">[33]</xref> report varying degrees of L versus M cone-specific wiring for retinal ganglion cells. Such retinal specificity could result from activity-dependent synaptic plasticity during development <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref>, via the type of learning mechanisms considered here or in earlier work <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Ahumada1">[8]</xref>.</p>
<p>For trichromatic mosaics, our algorithm correctly classified the cones in the retinal mosaic most of the time, with performance at ceiling for mosaic parameters most typical of human vision. The lowest accuracies are found when the L∶M ratio is either very large or very small. One reason for this is that our flattening routine performs best when the number of cones of each type is approximately equal (see <xref ref-type="sec" rid="s4">Methods</xref>). This observation is equally true of the number of longer-wavelength-sensitive cone classes that our algorithm detects in the trichromatic simulations. The algorithm was most likely to detect only 1 longer-wavelength-sensitive cone class in the case of those simulations with extreme L∶M cone ratios. It is possible that a better flattening routine or an embedding algorithm more attuned to the correlation structure of natural images could lead to selective increases in our algorithm's accuracy for the more extreme L∶M ratios. On the other hand, it could be that the worsened flattening is a symptom reflecting a greater underlying difficulty in learning for mosaics with more extreme L∶M ratios. In this case, the fact that learning performance degrades as cone ratios become asymmetric may indicate fundamental constraints on the mosaic parameters that support trichromacy. The decreased performance with more extreme L∶M ratios was consistent across many variations in the details of the simulations (see <xref ref-type="supplementary-material" rid="pcbi.1003652.s004">Figures S4</xref>–<xref ref-type="supplementary-material" rid="pcbi.1003652.s011">S11</xref>).</p>
<p>Another subset of retinal parameters for which our algorithm's performance was degraded were the simulations whose M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e068" xlink:type="simple"/></inline-formula> values were close to those of the L cones, primarily when the M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e069" xlink:type="simple"/></inline-formula> value was 555 nm, only 3.9 nm from the L cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e070" xlink:type="simple"/></inline-formula> value of 558.9 nm. In most such cases, the algorithm grouped these cones into a single class. Considering the small difference in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e071" xlink:type="simple"/></inline-formula>, this is perhaps not surprising. Our results are thus consistent with experimental studies finding that intermediate color discrimination deficiencies result when the separation of L and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e072" xlink:type="simple"/></inline-formula> values is between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e073" xlink:type="simple"/></inline-formula>–<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e074" xlink:type="simple"/></inline-formula> but severe color discrimination deficiencies when the L and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e075" xlink:type="simple"/></inline-formula> values are separated by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e076" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003652-Neitz1">[21]</xref>. That said, the idea that learning limits performance in anomalous trichromats is speculative, as we have not attempted to quantify the performance losses that would be expected with a failure to correctly classify all of the cones. Nor have we compared this to the performance losses expected simply because a reduced separation in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e077" xlink:type="simple"/></inline-formula> values reduces the signal-to-noise ratio of the information available to make color discriminations. Also of note with regard to the effect of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e078" xlink:type="simple"/></inline-formula> separation on performance is the fact that a single nucleotide polymorphism in the longer-wavelength-sensitive opsin gene can produce a shift in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e079" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e080" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003652-Neitz3">[34]</xref>, so that a single mutational event could have produced a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e081" xlink:type="simple"/></inline-formula> shift large enough to enable learning.</p>
<p>Performance for simulations that included a cone-specific surround (<xref ref-type="supplementary-material" rid="pcbi.1003652.s008">Figure S8</xref>) was lower than for simulations in which the surround drew uniformly on neighboring cones. Although the algorithm classified 100% of the cones correctly in the case of a retina with an L∶M ratio of 1 and an M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e082" xlink:type="simple"/></inline-formula> value of 530 nm, and also correctly detected that there were two longer-wavelength-sensitive cone classes present in the mosaic, the algorithm struggled with many other simulations with cone selective surrounds. In fact, the embeddings of these simulations were less organized than other simulations. Although a full analysis is beyond the scope of this paper, one feature of cone selective surrounds of fixed spatial extent in mosaics with extreme L∶M ratios is that the number of cones contributing to the surround will be different for units with L cone centers than for cones with M cone centers. It is possible that this produces variability that impedes learning.</p>
<p>Our algorithm correctly detected a tetrachromatic mosaic and did a reasonable but not perfect job of classifying the cones for this mosaic, indicating that there is sufficient information in the correlation of cone responses to natural images to support a degree of tetrachromatic learning. Although it is established that certain female carriers of anomalous trichromacy express four cone classes, whether these individuals exhibit tetrachromatic color matching performance has been difficult to determine <xref ref-type="bibr" rid="pcbi.1003652-Nagy1">[25]</xref>–<xref ref-type="bibr" rid="pcbi.1003652-Jordan2">[27]</xref>. As noted in the results section, our cone classification results were reasonable but not perfect, suggesting that one reason for the lack of routine functional tetrachromacy in female carriers may be that it is difficult for the post-receptoral visual system to reliably classify all of the cones <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[see also 7]</xref>. That is, it may be that rather narrowly delineated conditions must be met for the visual system to learn that its mosaic contains a fourth cone type and classify the cones with sufficient accuracy.</p>
<p>Dichromatic mosaics are also correctly detected by our learning algorithm (<xref ref-type="fig" rid="pcbi-1003652-g005">Figure 5A–5D</xref>), but more easily. This classification relies partly on an arbitrary choice of a confidence threshold (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e083" xlink:type="simple"/></inline-formula>) regarding the goodness-of-fit of the flattened <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e084" xlink:type="simple"/></inline-formula> positions of the embedded correlation matrix to a single skew normal distribution, beneath which we reject dichromacy as an explanation of the retinal mosaic. Although this threshold is arbitrary, it represents a requirement that we be 99% confident that a distribution is not dichromatic in order to consider it trichromatic. Considering our algorithm's good performance on trichromatic mosaics, this implies that the dichromat/trichromat decision is one that the visual system could make reliably.</p>
<p>The multi-dimensional scaling approach that we took to explicitly classifying cones shares theoretical foundations with the approach taken in <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref>. The point of commonality is that the coordinates of each cone on a dimension in an MDS representation may be viewed as analogous to the cone weights for a corresponding model unit obtained via principal components (PCA) or independent components (ICA) analysis. Indeed, cone positions obtained via classical metric MDS and cone weights obtained via PCA correspond to the rows and columns of the same underling matrix. That noted, different insights are obtained through the two approaches. Whereas in <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref> the emphasis is most naturally on the degree of cone selectivity shown by the most selective model units, in our work the emphasis is on the accuracy of cone classification possible using the first three dimensions of the correlation matrix embedding. Indeed, the rotation and flattening of the embeddings performed by our algorithm use the information carried jointly by these first three dimensions. We have observed that perfect cone classification is possible in the absence of high cone-selectivity in the implied cone weights of model units corresponding to these dimensions. On the other hand, our algorithm does not take advantage of cone selectivity present in units beyond the initial three returned by the MDS algorithm. Given these similarities and differences, it is of interest to compare the results of our work with those obtained in <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref>. First, we find that good classification is possible using the correlation matrix without considering higher-order statistical structure, whereas <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref> did not find high cone selectivity with PCA. We believe that the primary reason for this difference is as noted above, that our algorithm classifies based on information carried jointly by multiple dimensions. Other factors probably also come into play (e.g., size of mosaics and number of images simulated both of which were larger in our work). None-the-less, both approaches lead to the conclusion that learning is improved with the addition of blur and is inhibited by a decrease in the spectral separation between L and M cones. In addition, we find that learning is improved in the presence of an opponent surround for each cone that draws non-selectively on its neighbors, consistent with an analysis of the effect of such surrounds on correlations (see Figure 8 in <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref>). On the other hand, we find that we can detect the presence of a third longer-wavelength-sensitive cone class, while their approach did not lead to learning of cone-selectivity with respect to a mosaic representative of human tetrachromats. Given the considerations discussed above, this is probably a difference in degree and criterion. We also studied additional factors and find that learning remains possible when cone spacing is increased relative to the underlying image data, remains possible when noise is added to the simulated cone responses, becomes more difficult in the presence of a cone-selective opponent surround, and becomes more difficult as the L∶M cone ratio becomes more extreme.</p>
<p>Our work embodies a number of simplifying assumptions. First, we simulated photoreceptors arranged in a rectilinear grid rather than a more realistic hexagonal grid in order to more easily align the photoreceptors with the rectilinear pixel grid of the database images. Nothing in the algorithm relies on rectilinearity, however. Second, since we have limited information about the optical quality, and spatial resolution of the cameras used to acquire the hyperspectral images, we rely on a scale invariance assumption about natural images to interpret the hyperspectral images as being matched to foveal resolution. We also do not know how noisy the camera responses were nor how small artifacts due to limited camera sensor bit depth might have perturbed our results. A full exploration of the effect of camera parameters awaits a hyperspectral image dataset acquired at a resolution matched to that of human vision with a fully characterized camera. We doubt, however, that the basic features of the spatial and spectral correlations in natural images would be so sensitive to camera parameters so as to change our basic conclusions. To explore this, we investigated the effect of increasing cone spacing relative to the image scale by a factor of 2 (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e085" xlink:type="simple"/></inline-formula> cone mosaic) and a factor of 4 (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e086" xlink:type="simple"/></inline-formula> cone mosaic), for the standard L and M cone spectral sensitivities (558.9 and 530 nm) and an L∶M ratio of 1∶1. Learning continued to work well (2 classes of longer-wavelength-sensitive cones correctly detected and cones classed with 100% accuracy). This result suggests that our main analysis is not highly sensitive to image scale. It also serves to explore how learning might generalize from foveal to peripheral cones, since a key difference between fovea and periphery is an increase in cone spacing. Third, we assumed that the hyperspectral images in our database are representative of natural scenes. As a check on this assumption, we scrubbed the database of images of obviously man-made objects and repeated our simulations. The results are generally similar to those run using the full database, although there are more instances of failure to detect the correct number of longer-wavelength-sensitive cones (<xref ref-type="supplementary-material" rid="pcbi.1003652.s010">Figure S10</xref>). Finally, we assume that the responses of the cones to natural images contain no noise. To address this assumption, we performed simulations in which noise on the order of both 1% and 5% of the mean of the cone responses to each natural image was added randomly to each cone (<xref ref-type="supplementary-material" rid="pcbi.1003652.s011">Figure S11</xref>). The accuracy of the algorithm for these simulations is comparable with the corresponding no-noise results shown in <xref ref-type="fig" rid="pcbi-1003652-g004">Figure 4</xref>.</p>
<p>We did not incorporate the blur introduced by the optics of the human eye into our main simulations, in part because we do not know how much blurring was already introduced by the various hyperspectral cameras. In this regard, we note that the addition of optical blur makes the classification problem easier rather than harder for our algorithm (<xref ref-type="supplementary-material" rid="pcbi.1003652.s012">Figure S12</xref>). This is because blur reduces the variation in cone correlation caused by variation in the spatial structure of natural images <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref>. It is therefore perhaps of interest that in humans, red-green color vision develops over the first three months of infancy <xref ref-type="bibr" rid="pcbi.1003652-Wachtler1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Teller1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Brown1">[36]</xref>, during a period when the optical quality of the image is not yet as good as that in adults <xref ref-type="bibr" rid="pcbi.1003652-Banks1">[37]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Norcia1">[38]</xref>. As an explicit test we explored the effect of introducing Gaussian blur (standard deviation of 4 pixels). Accuracies for the simulations with blur were high and are shown in <xref ref-type="supplementary-material" rid="pcbi.1003652.s012">Figure S12</xref>. The algorithm chose 2 cone classes in 40 of 54 simulations and correctly typed all cones in 49 of 54 simulations performed with blur. In addition to evidence that red-green human color vision develops after birth, monkeys raised in an unusual environment in which the illumination was always one of four monochromatic lights displayed impaired color discrimination <xref ref-type="bibr" rid="pcbi.1003652-Sugita1">[39]</xref>. Our algorithm as currently implemented does not capture this effect: we found that when we ran the algorithm with input that simulated the deprivation experiment, it still correctly detected that the mosaic was trichromatic and correctly classified all of the cones. However, the embedding (not shown) produced by this simulation, while leading to good separation by cone class along the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e087" xlink:type="simple"/></inline-formula> axis, was not typical of other simulation embeddings and did not produce an reasonable representation of the spatial positions of the cones as do our typical embeddings.</p>
<p>Why might the visual system have implemented a learning algorithm based on inter-cone correlations in advance of needing to determine the class of a newly expressed cone opsin? Previous authors <xref ref-type="bibr" rid="pcbi.1003652-Ahumada2">[40]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Maloney1">[41]</xref> have suggested that high acuity spatial vision requires learning of the spatial arrangement of cone positions, and suggested that spontaneous retinal activity as well as changes in interpolated neural images across eye movements provide information that would enable such learning. Although not the focus of this paper, our results (<xref ref-type="supplementary-material" rid="pcbi.1003652.s001">Figure S1</xref>) show that inter-cone correlations contain useful information for learning cone positions. Thus it seems possible that a learning algorithm based on this information could already have been in place as part of a system designed for spatial vision, and as such might have been ready to learn cone classes as well.</p>
<p>Another possibility is suggested by recent studies of adult dichromatic monkeys and of knock-in mice expressing the human long-wavelength opsin. Knock-in female mice heterozygous for the native mouse and human opsins have been shown to be capable of limited trichromatic discrimination <xref ref-type="bibr" rid="pcbi.1003652-Jacobs2">[42]</xref>. Similarly, the addition of a third opsin using gene therapy can enable trichromatic color discriminations in adult dichromatic monkeys <xref ref-type="bibr" rid="pcbi.1003652-Mancuso1">[43]</xref>. Although the enhanced discrimination does not necessarily mean that the visual system has used the new cone class to add a dimension to the perceptual representation of color <xref ref-type="bibr" rid="pcbi.1003652-Makous1">[44]</xref>, it does indicate that an immediate adaptive benefit can be bestowed by the expression of a novel photopigment, thus allowing for selective preservation of the mutation and subsequent enhancement through the implementation of a learning algorithm that classifies the cones.</p>
<p>Our work is at the computational level and does not speak directly to underlying neural mechanisms. Rather, we show that the information contained in the inter-cone correlation matrix in response to natural images is sufficient for detection of the number of cone classes as well as for classification of individual cones. Exploring how the information used by our algorithm might be exploited in a biologically-plausible manner, as well as how the learned information could be represented, remains an important future direction. For example, the computations described in <xref ref-type="bibr" rid="pcbi.1003652-Brainard1">[45]</xref> can be viewed as a method for using the knowledge of the class of each cone in the mosaic to determine the particular cone selective wiring that optimizes the veridicality of stimulus reconstruction, given a linking assumption of how the output of model units determined color appearance at each location. How the information used by algorithm could be used by a neural system to set up wiring with these particular properties, however, remains to be elucidated. Even in the absence of a neural theory, however, our work does make experimental predictions: altering inter-cone correlations during learning should alter how individual cones contribute to color vision. Recently it has become possible to independently stimulate individual primate cones using an <italic>in vitro</italic> retinal preparation <xref ref-type="bibr" rid="pcbi.1003652-Field1">[32]</xref> and similar possibilities with human psychophysics are on the horizon <xref ref-type="bibr" rid="pcbi.1003652-Tuten1">[46]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Hofer2">[47]</xref>. Such techniques might be used to alter the correlation between a targeted M cone and its neighbors so as to test whether it is possible to make the post-receptoral visual system treat the responses from the targeted M cone as if they originated in an L cone. A second prediction of our work, to the extend that our current algorithm captures how the information available for learning varies with mosaic parameters, is that the range of observed L∶M cone ratios for human observers with functional trichromatic vision will decrease as the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e088" xlink:type="simple"/></inline-formula> separation between the L and M cones decreases.</p>
<p>In terms of mechanism, it is also important to note that although the multidimensional scaling technique at the core of our algorithm provides one way to exploit the inter-cone correlations, we are not claiming that it is an optimal method nor that the neural representation of color includes an explicitly labeling of each type of cone. Multidimensional scaling is a well-established and principled unsupervised learning method that produces embeddings that allow detection of the number of cone classes and the classification of individual cones (<xref ref-type="supplementary-material" rid="pcbi.1003652.s003">Figure S3</xref>; online supplemental material). The components of our algorithm that exploit the structure of the embedding (flattening, fitting with skew normals, model comparison), however, are somewhat ad hoc and tailored to the specific problems we address. We view these steps as allowing us to quantify the quality of the information available in the embeddings, not as steps that necessarily reflect how a biological system would extract the same information. In any case, with respect to optimality, it is difficult if not impossible to evaluate our or any algorithm's optimality without an explicit probabilistic model of the statistical structure of natural images, and at present we do not have such a model <xref ref-type="bibr" rid="pcbi.1003652-Simoncelli1">[48]</xref>. Study of performance with respect to explicit models of natural image statistics would also allow investigation into what features of these statistics are key for supporting learning, a direction which we regard as interesting for future research. In addition, although we have shown that the inter-cone correlations contain sufficient information to enable the requisite learning, we have not shown that they are the only source of relevant information. For example, previous authors have suggested that comparison of interpolated neural images across eye movements might also provide information for separating L from M cones <xref ref-type="bibr" rid="pcbi.1003652-Ahumada1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Brainard1">[45]</xref>. Such a proposal is consistent with the idea that sensorimotor contingencies provide key information for enabling an organism to interact successfully with the external world <xref ref-type="bibr" rid="pcbi.1003652-ORegan1">[49]</xref>.</p>
<p>With respect to representation, it may be that the the analysis of signals to extract an appropriate representational structure for stimuli, which is what MDS accomplishes when applied to response correlation matrices, is a canonical biological computation. If so, then the biological extraction of the information about cone classes that we demonstrate is available may occur, in effect, as a result of a more general perceptual learning processes. This notion also provides another possible explanation of why the brain is prepared to learn about and exploit the addition of novel classes of sensory transducers.</p>
<p>In summary, we have studied a question that is fundamental to the formation of any sensory system that provides multidimensional information. Given that the enabling step in the evolution of such systems must be the expression of novel sensory transducers, how is it possible to detect and differentiate their presence? We address these two fundamental questions at the computational level, using primate color vision as a model system. We find that inter-cone correlations provide sufficient information for unsupervised learning to detect the number of cone classes present and to classify individual cones accurately by demonstrating an algorithm that capitalizes on this information. These results fill an important gap in our understanding of how color vision could have evolved, and may also provide insight into the evolution and operation of other sensory systems.</p>
</sec><sec id="s4" sec-type="methods">
<title>Methods</title>
<sec id="s4a">
<title>Simulating cone responses</title>
<p>We simulated the responses of retinal mosaics to hyperspectral images. Individual mosaics were specified by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e089" xlink:type="simple"/></inline-formula> parameters: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e090" xlink:type="simple"/></inline-formula>, the number of cone classes in the simulated mosaic; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e091" xlink:type="simple"/></inline-formula>, the size of the mosaic; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e092" xlink:type="simple"/></inline-formula>, a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e093" xlink:type="simple"/></inline-formula> dimensional vector of the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e094" xlink:type="simple"/></inline-formula> for cone classes other than L and S, whose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e095" xlink:type="simple"/></inline-formula> values were held at 558.9 and 420.7 nm respectively; and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e096" xlink:type="simple"/></inline-formula>, a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e097" xlink:type="simple"/></inline-formula> dimensional vector that determined the relative number of cones of different classes (see below). The code used to simulate cone responses and compute correlation matrices was developed in Clojure (<ext-link ext-link-type="uri" xlink:href="http://clojure.org/" xlink:type="simple">http://clojure.org/</ext-link>), a functional open-source Java Virtual Machine language, and is freely available on gitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/DavidBrainard/ReceptorLearning/" xlink:type="simple">https://github.com/DavidBrainard/ReceptorLearning/</ext-link>).</p>
<p>Given mosaic size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e098" xlink:type="simple"/></inline-formula>, we simulated mosaics consisting of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e099" xlink:type="simple"/></inline-formula> cones, with one cone at each location of an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e100" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e101" xlink:type="simple"/></inline-formula> rectangular grid. The use of a rectangular grid was chosen for computational convenience. We specified that 6% of the cones be S cones; these were placed at quasi-regular locations by randomly choosing each S cone's position on the grid and rejecting it if it was too close to another already-placed S cone. The classes of the other cones in the mosaic were set randomly using the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e102" xlink:type="simple"/></inline-formula> as a ratio in which the probability of drawing a cone of class <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e103" xlink:type="simple"/></inline-formula> is equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e104" xlink:type="simple"/></inline-formula>; for example, an L∶M ratio of 4∶1 can be expressed by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e105" xlink:type="simple"/></inline-formula> such that the probability of drawing an L cone would be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e106" xlink:type="simple"/></inline-formula> and the probability of drawing an M cone would be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e107" xlink:type="simple"/></inline-formula>.</p>
<p>Given the class of a cone, we determined its spectral sensitivity from its photopigment's wavelength of maximum sensitivity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e108" xlink:type="simple"/></inline-formula>. As noted above, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e109" xlink:type="simple"/></inline-formula> values for L and S cones were held at 558.9 and 420.7 nm respectively. These correspond to typical values for a human observer. Across simulations, we varied <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e110" xlink:type="simple"/></inline-formula> for the M cones between its typical value of 530 nm up to values of 555 nm to simulate anomalous trichromacy. To simulate human tetrachromatic mosaics, we specified an M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e111" xlink:type="simple"/></inline-formula> of 530 nm and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e112" xlink:type="simple"/></inline-formula> for a fourth cone type of 545 nm. Given its <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e113" xlink:type="simple"/></inline-formula> value, the spectral sensitivity of a cone was determined using the CIE 2-degree physiological cone fundamental standard <xref ref-type="bibr" rid="pcbi.1003652-CIE1">[50]</xref>, as implemented in the Psychophysics Toolbox <xref ref-type="bibr" rid="pcbi.1003652-Brainard2">[51]</xref>. This implementation extends the CIE standard by allowing specification of non-standard <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e114" xlink:type="simple"/></inline-formula> values via the photopigment absorbance nomogram of Stockman <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003652-Stockman1">[52]</xref>. <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2A</xref> shows an example mosaic; <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2B</xref> shows spectral sensitivities for typical L, M, and S cones (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e115" xlink:type="simple"/></inline-formula> values of 558.9, 530, and 420.7 nm, respectively). This same procedure was also used in other simulation conditions where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e116" xlink:type="simple"/></inline-formula> was varied.</p>
<p>Input images for simulations were taken from three hyperspectral image databases, details of each of which can be found elsewhere <xref ref-type="bibr" rid="pcbi.1003652-Prraga1">[10]</xref>–<xref ref-type="bibr" rid="pcbi.1003652-Chakrabarti1">[12]</xref>. The images in all three databases sampled scenes along at least 31 evenly-spaced wavelengths. The sampling depended on the database. All contained data between 420 and 700 nm at 10 nm steps; across databases we had data between 400 nm and 720 nm. Of the 33 total wavelengths available across all three databases, we extrapolated quadratically to the missing two (either 400 and 410 nm or 710 and 720 nm) when necessary so that the combined database specified the spectrum at each pixel in each image at 10 nm intervals between 400 and 720 nm. Although there were fewer than 100 images in the three databases, the simulated mosaics were sufficiently small and the images sufficiently large that we were able to sub-sample the full images to produce many possible image patches. For each simulation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e117" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e118" xlink:type="simple"/></inline-formula> image patches were randomly chosen from the image database. For the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e119" xlink:type="simple"/></inline-formula> used in our main simulations, the database contained <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e120" xlink:type="simple"/></inline-formula> million distinct image patches with overlap allowed. Unless otherwise specified, each simulation used a different set of natural image draws. Image patches were drawn randomly with replacement. For our main calculations, we simulated the response of each specified mosaic to 2 million image patches. In supplemental simulations, we explored the effect of varying the number of image patches used (<xref ref-type="supplementary-material" rid="pcbi.1003652.s006">Figure S6</xref>) as well as the size of the patches (<xref ref-type="supplementary-material" rid="pcbi.1003652.s005">Figure S5</xref>).</p>
<p>To simulate the response of a mosaic to an image, we first computed the raw response <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e121" xlink:type="simple"/></inline-formula> of each mosaic cone to the image. This was calculated as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e122" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e123" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e124" xlink:type="simple"/></inline-formula> are the spectral sensitivity of the photoreceptor and the image intensity, respectively, at wavelength <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e125" xlink:type="simple"/></inline-formula> (in nanometers). This gave us the raw responses to the image that are proportional to photopigment isomerization rates. Such rates, however, are not directly available to post-receptoral circuitry, because lateral processes in the retina form an antagonistic surround that may be measured as early as the cone synapse <xref ref-type="bibr" rid="pcbi.1003652-Hirasawa1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003652-Verweij1">[14]</xref>. To capture this effect, we computed a suppressive surround for each cone by computing a weighted sum of the raw responses of the cone's neighbors, with the weights <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e126" xlink:type="simple"/></inline-formula> chosen according to a 2D Gaussian in which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e127" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e128" xlink:type="simple"/></inline-formula> represent the distance from the cone of interest to its neighbors in units of inter-cone distance. The surround value was subtracted from the cone response to provide the signal available to our learning algorithm. We used a standard deviation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e129" xlink:type="simple"/></inline-formula> cones and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e130" xlink:type="simple"/></inline-formula>) where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e131" xlink:type="simple"/></inline-formula> was a constant chosen to give the surround a sum of 0.25. In supplemental simulations, we simulated mosaics without a surround (<xref ref-type="supplementary-material" rid="pcbi.1003652.s007">Figure S7</xref>) as well as mosaics with a cone-specific surround in which L cone surrounds were composed only of M cones and vice versa (<xref ref-type="supplementary-material" rid="pcbi.1003652.s008">Figure S8</xref>).</p>
</sec><sec id="s4b">
<title>Analysis of responses</title>
<p>The responses of each cone from a particular set of natural images were used to calculate an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e132" xlink:type="simple"/></inline-formula> correlation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e133" xlink:type="simple"/></inline-formula>. We used <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e134" xlink:type="simple"/></inline-formula> as an approximation of the distance between cones in the 3D representational space of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e135" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e136" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e137" xlink:type="simple"/></inline-formula>, <italic>i.e.</italic>, position on the retina and cone class. We applied non-metric multidimensional scaling (MDS) to this distance metric to produce a 3D embedding of the response correlations. MDS was performed using the mdscale function in Matlab 8.1.0.604 (R2013a). A three dimensional solution was requested and all parameters were given default values. Specifically, the following default parameters were used: ‘Criterion’: ‘stress’ (also known as STRESS1); ‘Start’: ‘cmdscale’ (use classical multidimensional scaling as the starting state); ‘Replicates’: 1; ‘Weights’: uniform (<italic>i.e.</italic>, all weights were 1). <xref ref-type="fig" rid="pcbi-1003652-g003">Figure 3A</xref> shows the 3D embedding of the mosaic shown in <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2A</xref>, based on 2 million images. We consistently found (for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e138" xlink:type="simple"/></inline-formula> mosaics that contained S cones) that the first dimension of the MDS solution corresponded approximately to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e139" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e140" xlink:type="simple"/></inline-formula>) dimension of our desired representational space. This alignment was refined by rotating embeddings such that the separation between non-S cone and S cone positions fell along the first dimension by aligning the vector pointing from the mean of the longer-wavelength-sensitive cone positions to the mean of the S cone positions to the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e141" xlink:type="simple"/></inline-formula>. For most simulations, this rotation was negligible, with the exception being <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e142" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e143" xlink:type="simple"/></inline-formula> mosaics. In our algorithm, we used <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e144" xlink:type="simple"/></inline-formula>-means clustering with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e145" xlink:type="simple"/></inline-formula> to identify the S cones. These were taken as the members of the cluster with fewer cones. In the tritanope simulations, this step was skipped, and instead embeddings were rotated by hand to resemble the orientation of other non-tritanope simulations, using knowledge of which cones were M and which were L.</p>
<p>The L and M cone embeddings were flattened by modeling the average surface along which the embedded L and M cones fell (see, for example, <xref ref-type="supplementary-material" rid="pcbi.1003652.s003">Figure S3</xref>), and removing the curvature of that modeled surface from the cones in the embedding. This step, as well as the fitting of skew normals and model comparison, was implemented in Mathematica, and the implementation's code is also available in our gitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/DavidBrainard/ReceptorLearning/" xlink:type="simple">https://github.com/DavidBrainard/ReceptorLearning/</ext-link>). The model surface was discovered by minimizing the standard deviation of the distance from each non-S cone coordinate in the embedding to a second order polynomial surface parameterized by the second and third embedded dimensions (<italic>i.e.</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e146" xlink:type="simple"/></inline-formula>). The flattened <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e147" xlink:type="simple"/></inline-formula> value was calculated as the distance of each cones unflattened embedded position to the surface; the sign of the flattened <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e148" xlink:type="simple"/></inline-formula> value was negative if the point was on the same side of the surface as the S cones and was positive if the point was on the other side. (For the tritanopic simulations, this direction was determined manually as part of the embedding rotation procedure described above.) The standard deviation of the distances from the surface was chosen as the function to be minimized; this encourages the nonlinear minimization to find the surface that is equally distant from each cone rather than a surface that is close to most cones. When the sum of residual distances is minimized instead, the discovered surface can sometimes find an optimal fit without capturing the shape of the surfaces on which the cones are embedded. Notably, these minimization techniques perform best when the numbers of cones in each class are approximately the same. In the cases where the L∶M cone ratios are extreme, the surface can over-represent the more numerous cone class, resulting in a flattened embedding in which the more numerous cone class has been flattened, but the other cone class is spread over a large range in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e149" xlink:type="simple"/></inline-formula> dimension.</p>
<p>The flattened <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e150" xlink:type="simple"/></inline-formula> positions were used to classify cone types. A mixture distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e151" xlink:type="simple"/></inline-formula> skew normal distributions was fit to the flattened <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e152" xlink:type="simple"/></inline-formula> positions using nonlinear minimization. For each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e153" xlink:type="simple"/></inline-formula>, a two-tailed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e154" xlink:type="simple"/></inline-formula>-value of the Kolmogorov-Smirnov goodness-of-fit <xref ref-type="bibr" rid="pcbi.1003652-Gibbons1">[22]</xref> was calculated such that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e155" xlink:type="simple"/></inline-formula>-value gave the probability that the flattened <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e156" xlink:type="simple"/></inline-formula> positions came from the fit distribution. This <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e157" xlink:type="simple"/></inline-formula>-value was used to discriminate between possible choices of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e158" xlink:type="simple"/></inline-formula>. The distribution with the fewest parameters (<italic>i.e.</italic>, the smallest number of predicted cone classes) whose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e159" xlink:type="simple"/></inline-formula>-value was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e160" xlink:type="simple"/></inline-formula> was selected as the best fit. Cones were divided into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e161" xlink:type="simple"/></inline-formula> classes according to the distribution in the mixture whose value was highest at that point's flattened <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e162" xlink:type="simple"/></inline-formula> position. Skew normal distributions were assumed to represent one cone class each and were assumed to represent cones with higher <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e163" xlink:type="simple"/></inline-formula> values when their mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e164" xlink:type="simple"/></inline-formula> positions were farther from those of the S cones.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003652.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>The algorithm finds the approximate relative spatial locations of the L and M cones.</bold> The figure shows the arrangement of the points in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e165" xlink:type="simple"/></inline-formula>-<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e166" xlink:type="simple"/></inline-formula> plane for our algorithm's embedding of the randomly-generated retinal mosaic shown in <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2A</xref>. The original (correct) mosaic is plotted as open circles colored red and green for L and M cones according to their identity in the mosaic. The embedding is plotted as filled points, colored according to the cone class found by the algorithm. Lines are drawn from the embedded position of each cone to its correct mosaic position. A rigid least-squares relative-distance-preserving transformation in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e167" xlink:type="simple"/></inline-formula>-<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e168" xlink:type="simple"/></inline-formula> plane was applied to align the embedded positions to the original (correct) locations prior to plotting. Note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e169" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e170" xlink:type="simple"/></inline-formula> here refer to the representational space discussed in the Results section and not to the first two dimensions of the raw MDS solution.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003652.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>The distances in the multidimensional scaling embedding capture the structure of the correlation matrix.</bold> The figure shows the probability density function of the correlation between pairs of cones during the simulation versus their distance in the 3D embedding. This figure is for the simulation whose mosaic is shown in <xref ref-type="fig" rid="pcbi-1003652-g002">Figure 2</xref>. Each contour line represents approximately 4,725 pairs of cones.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003652.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p><bold>The 3D embeddings of the L and M cones vary systematically with changes in L∶M ratio and </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e171" xlink:type="simple"/></inline-formula><bold> separation.</bold> Example embeddings are shown for L∶M ratios varying from 1∶16 to 16∶1 and for M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e172" xlink:type="simple"/></inline-formula> values ranging from 530 nm 555 nm; results for these conditions are also shown in <xref ref-type="fig" rid="pcbi-1003652-g004">Figure 4</xref> and are arranged identically here. In many cases, the L and M cones appear as 2D surfaces with similar shape but with different offsets. Rotating animations that show the three-dimensional structure of these embeddings are available online at: <ext-link ext-link-type="uri" xlink:href="http://color.psych.upenn.edu/supplements/receptorlearning" xlink:type="simple">http://color.psych.upenn.edu/supplements/receptorlearning</ext-link>.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003652.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p><bold>Algorithm performance is consistent across individual runs of the simulations.</bold> This figure shows the fraction of cones correctly classified in each of the three simulations that were aggregated to produce <xref ref-type="fig" rid="pcbi-1003652-g004">Figure 4</xref>. The left column shows the fraction of cones correctly classified for various combinations of L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e173" xlink:type="simple"/></inline-formula> value, when the number of longer-wavelength-sensitive cone classes was assumed to be 2. The right column shows the number of longer-wavelength-sensitive cone classes (1, 2, or 3) detected by the algorithm for each L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e174" xlink:type="simple"/></inline-formula> value. All three simulations were run with different randomly-generated retinal mosaics and different draws of 2 million natural image patches. Reported accuracies in the left column are the average of the fraction of L and M cones correctly typed.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003652.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p><bold>Algorithm performance varies across image patch size.</bold> As the size of the image patch declines, classification performance remains stable, while detection performance declines slightly. All retinal mosaics were shown a different set of 2 million randomly-drawn natural image patches. (<bold>A</bold>) The fraction of cones correctly typed for a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e175" xlink:type="simple"/></inline-formula> mosaic (left) and a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e176" xlink:type="simple"/></inline-formula> mosaic (right), for various combinations of L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e177" xlink:type="simple"/></inline-formula> value, when the number of longer-wavelength-sensitive cone classes was assumed to be 2. S cones were held at 6% of the cones and were given a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e178" xlink:type="simple"/></inline-formula> value of 420.7 in all simulations. (<bold>B</bold>) The number of longer-wavelength-sensitive cone classes detected by the algorithm for each L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e179" xlink:type="simple"/></inline-formula> value.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003652.s006" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s006" position="float" xlink:type="simple"><label>Figure S6</label><caption>
<p><bold>Algorithm performance depends on the number of simulated image patches.</bold> The figure panels show the accuracy of the classification algorithm as a function of the number of natural image patches shown to the mosaic for simulations in which the M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e180" xlink:type="simple"/></inline-formula> was 530 nm (bottom), 540 nm (middle), and 550 nm (top). The number of images required to achieve good classification varies with L∶M ratio and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e181" xlink:type="simple"/></inline-formula> separation, but reaches asymptotic levels at about 200,000–300,000 images for retinas with an M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e182" xlink:type="simple"/></inline-formula> value of 530 nm or 540 nm and an L∶M ratio of 1. Simulations with an L∶M ratio of 1 but with an M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e183" xlink:type="simple"/></inline-formula> value of 550 nm have high performance but the performance is less stable. Although 300,000 images may seem like a large number, it represents fewer than one image per second for 6 hours per day for two weeks. Classification accuracy is lower and less stable for mosaics with M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e184" xlink:type="simple"/></inline-formula> values near that of the L cones and mosaics whose L∶M ratios are much greater than or less than 1. Because our entire natural image database was several gigabytes in size, it was much more efficient to read each natural image only once during a simulation and to draw all patches from the simulation in batch. Accordingly, the ordering of the images is not fully shuffled for numbers of image patches less than 2,000,000 (our sampling algorithm does ensure equal representation for the primary case of 2,000,000 image patches studied in the main conditions of the paper.) The non-random sampling may be responsible for the fluctuations in performance with image number that can be seen for some simulation conditions.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003652.s007" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s007" position="float" xlink:type="simple"><label>Figure S7</label><caption>
<p><bold>Algorithm performance degrades somewhat without simulated surround suppression.</bold> This figure shows the fraction of cones correctly classified when no surround suppression was simulated. The performance of the algorithm, when compared to <xref ref-type="fig" rid="pcbi-1003652-g004">Figure 4</xref>, degrades most clearly as the M and L cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e185" xlink:type="simple"/></inline-formula> values approach each other, suggesting that surround suppression helps distinguish cones when their responses are very similar. All simulations were shown a different randomly-drawn set of 2 million hyperspectral image patches. (<bold>A</bold>) Fraction of cones correctly classified for various combinations of L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e186" xlink:type="simple"/></inline-formula> value, when the number of longer-wavelength-sensitive cone classes was assumed to be 2. S cones were held at 6% of the cones and were given a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e187" xlink:type="simple"/></inline-formula> value of 420.7 in all simulations. Accuracies are the average of the fraction of L and M cone correctly typed. (<bold>B</bold>) The number of longer-wavelength-sensitive cone classes detected by the algorithm for each L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e188" xlink:type="simple"/></inline-formula> value.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003652.s008" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s008" position="float" xlink:type="simple"><label>Figure S8</label><caption>
<p><bold>The algorithm performs more poorly when a cone-specific surround suppression is employed.</bold> Simulations were run with a Gaussian surround suppression (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e189" xlink:type="simple"/></inline-formula> cones, weight = 0.25) such that each cone was suppressed only by nearby cones of different type. L and M cones opposed each other, and S cone surrounds consisted of both L and M cones. In the case of retinas with extreme L∶M ratios, this often required that some cones have no surround (no nearby cones of a different type) while others had very strong surrounds (all nearby cones were of a different type). Each retinal mosaic was shown a different set of 2 million randomly-drawn natural image patches. (<bold>A</bold>) The fraction of cones correctly typed for a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e190" xlink:type="simple"/></inline-formula> mosaic, for L∶M ratios ranging from 16∶1 to 1∶16 and for M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e191" xlink:type="simple"/></inline-formula> values ranging from 530 nm and 555 nm. The number of cone classes was assumed to be 2. S cones were held at 6% of the cones and were given a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e192" xlink:type="simple"/></inline-formula> value of 420.7 in all simulations. (<bold>B</bold>) The number of longer-wavelength-sensitive cone classes detected by the algorithm for each L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e193" xlink:type="simple"/></inline-formula>.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003652.s009" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s009" position="float" xlink:type="simple"><label>Figure S9</label><caption>
<p><bold>Information in the correlation matrix supports classification of L and M cones for tritanopes (no S cones).</bold> Results are shown for simulations of tritanopic mosaics with 4.5 million natural image patches. This is more image patches than were required for mosaics containing S cones. Although separation of L and M cones could be clearly observed in the 3D embeddings with 4.5 million image patches (see online supplement), the embeddings produced by the MDS algorithm were not aligned such that the first dimension of the MDS solution corresponded to the direction along which L and M cones separated. Nor, obviously, could we leverage the positions of the S cones to rotate the solution to produce such alignment as we did for simulations of mosaics with S cones. Accordingly, we manually rotated these embeddings before applying the flattening and classification steps of our algorithm so as to be able to quantify the separation between the L and M cones that could be achieved in a manner comparable with our other simulations. (<bold>A</bold>) The fraction of cones correctly typed for a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e194" xlink:type="simple"/></inline-formula> mosaic, for various values of the L∶M ratio when the number of cone classes was assumed to be 2. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e195" xlink:type="simple"/></inline-formula> values for L and M cones were 558.9 and 530.3 nm, respectively. Note, however, the labeling of which cones are L and which are M by our algorithm becomes arbitrary in the absence of an S cone anchor. This arbitrariness was accounted for here as part of the manual rotation of the embedding. (<bold>B</bold>) The number of longer-wavelength-sensitive cone classes detected by the algorithm for each L∶M ratio.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003652.s010" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s010" position="float" xlink:type="simple"><label>Figure S10</label><caption>
<p><bold>The algorithm performs well for images that exclude man-made objects.</bold> Performance is similar to those simulations in <xref ref-type="fig" rid="pcbi-1003652-g004">Figure 4</xref>, in which man-made items were not scrubbed from the image set, although there are a set of cases for M cone-rich retinas where three rather than two longer-wavelength-sensitive cone classes are detected. All retinal mosaics were shown a different set of 2 million randomly-drawn natural image patches. (<bold>A</bold>) The fraction of cones correctly typed for a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e196" xlink:type="simple"/></inline-formula> mosaic, for various combinations of L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e197" xlink:type="simple"/></inline-formula> value, when the number of longer-wavelength-sensitive cone classes was assumed to be 2. S cones were held at 6% of the cones and were given a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e198" xlink:type="simple"/></inline-formula> value of 420.7 in all simulations. (<bold>B</bold>) The number of longer-wavelength-sensitive cone classes detected by the algorithm for each L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e199" xlink:type="simple"/></inline-formula> value.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003652.s011" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s011" position="float" xlink:type="simple"><label>Figure S11</label><caption>
<p><bold>The algorithm is robust to noise.</bold> Noise was modeled by adding to each cone's response a random draw from a normal distribution whose standard deviation was 1% (left) or 5% (right) of the mean response from all cones. Each retinal mosaic was shown a different set of 2 million randomly-drawn natural image patches. (<bold>A</bold>) The fraction of cones correctly typed for a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e200" xlink:type="simple"/></inline-formula> mosaic, for L∶M ratios ranging from 16∶1 to 1∶16 and for M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e201" xlink:type="simple"/></inline-formula> values ranging from 530 nm and 555 nm. The number of cone classes was assumed to be 2. S cones were held at 6% of the cones and were given a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e202" xlink:type="simple"/></inline-formula> value of 420.7 in all simulations. (<bold>B</bold>) The number of longer-wavelength-sensitive cone classes detected by the algorithm for each L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e203" xlink:type="simple"/></inline-formula>.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003652.s012" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003652.s012" position="float" xlink:type="simple"><label>Figure S12</label><caption>
<p><bold>The algorithm performs well when images are blurred</bold>, although there are a few cases where three rather than two longer-wavelength-sensitive cone classes are detected. Blurring was accomplished by convolving each image with a 2D Gaussian with a standard deviation of 4 pixels. Each retinal mosaic was shown a different draw of 2 million natural image patches. (<bold>A</bold>) The fraction of cones correctly typed for a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e204" xlink:type="simple"/></inline-formula> mosaic, for various combinations of L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e205" xlink:type="simple"/></inline-formula> value, when the number of longer-wavelength-sensitive cone classes was assumed to be 2. S cones were held at 6% of the cones and were given a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e206" xlink:type="simple"/></inline-formula> value of 420.7 in all simulations. (<bold>B</bold>) The number of longer-wavelength-sensitive cone classes detected by the algorithm for each L∶M ratio and M cone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003652.e207" xlink:type="simple"/></inline-formula> value.</p>
<p>(TIFF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank D. H. Foster for providing us with hyperspectral images <xref ref-type="bibr" rid="pcbi.1003652-Foster1">[11]</xref> in advance of their subsequent release online. We thank J. I. Gold and G. K. Aguirre for comments on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003652-Nathans1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nathans</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Thomas</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Hogness</surname><given-names>DS</given-names></name> (<year>1986</year>) <article-title>Molecular genetics of human color vision: the genes encoding blue, green, and red pigments</article-title>. <source>Science</source> <volume>232</volume>: <fpage>193</fpage>–<lpage>202</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Jacobs1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jacobs</surname><given-names>GH</given-names></name>, <name name-style="western"><surname>Neitz</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Deegan</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Neitz</surname><given-names>J</given-names></name> (<year>1996</year>) <article-title>Trichromatic colour vision in new world monkeys</article-title>. <source>Nature</source> <volume>382</volume>: <fpage>156</fpage>–<lpage>158</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Hunt1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hunt</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Dulai</surname><given-names>KS</given-names></name>, <name name-style="western"><surname>Cowing</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Julliot</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Mollon</surname><given-names>JD</given-names></name>, <etal>et al</etal>. (<year>1998</year>) <article-title>Molecular evolution of trichromacy in primates</article-title>. <source>Vision Research</source> <volume>38</volume>: <fpage>3299</fpage>–<lpage>3306</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Dulai1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dulai</surname><given-names>KS</given-names></name>, <name name-style="western"><surname>von Dornum</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Mollon</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Hunt</surname><given-names>DM</given-names></name> (<year>1999</year>) <article-title>The evolution of trichromatic color vision by opsin gene duplication in new world and old world primates</article-title>. <source>Genome Research</source> <volume>9</volume>: <fpage>629</fpage>–<lpage>638</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Hendry1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hendry</surname><given-names>SHC</given-names></name>, <name name-style="western"><surname>Calkins</surname><given-names>DJ</given-names></name> (<year>1998</year>) <article-title>Neuronal chemistry and functional organization in the primate visual system</article-title>. <source>Trends in Neurosciences</source> <volume>21</volume>: <fpage>344</fpage>–<lpage>349</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Smallwood1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smallwood</surname><given-names>PM</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Nathans</surname><given-names>J</given-names></name> (<year>2002</year>) <article-title>Role of a locus control region in the mutually exclusive expression of human red and green cone pigment genes</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>99</volume>: <fpage>1008</fpage>–<lpage>1011</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Wachtler1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wachtler</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Doi</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>TW</given-names></name>, <name name-style="western"><surname>Sejnowski</surname><given-names>TJ</given-names></name> (<year>2007</year>) <article-title>Cone selectivity derived from the responses of the retinal cone mosaic to natural scenes</article-title>. <source>Journal of Vision 7</source> <volume>6</volume>: <fpage>1</fpage>–<lpage>14</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Ahumada1"><label>8</label>
<mixed-citation publication-type="book" xlink:type="simple">Ahumada AJ, Mulligan JB (1990) Learning networks for the red-green opponent system. In: Investigative Ophthalmology and Visual Science. ARVO, volume 32, p. 1215.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Pokorny1"><label>9</label>
<mixed-citation publication-type="book" xlink:type="simple">Pokorny J, Smith V, Verriest G, Pinckers A (1979) Congenital and acquired color vision defects, volume 66. New York: Grune and Stratton.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Prraga1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Párraga</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Brelstaff</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Troscianko</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Moorehead</surname><given-names>IR</given-names></name> (<year>1998</year>) <article-title>Color and luminance information in natural scenes</article-title>. <source>J Opt Soc Am A</source> <volume>15</volume>: <fpage>563</fpage>–<lpage>569</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Foster1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Foster</surname><given-names>DH</given-names></name>, <name name-style="western"><surname>Amano</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Nascimento</surname><given-names>SMC</given-names></name>, <name name-style="western"><surname>Foster</surname><given-names>MJ</given-names></name> (<year>2006</year>) <article-title>Frequency of metamerism in natural scenes</article-title>. <source>Journal of the Optical Society of America A, Optics, Image Science, and Vision</source> <volume>23</volume>: <fpage>2359</fpage>–<lpage>2372</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Chakrabarti1"><label>12</label>
<mixed-citation publication-type="book" xlink:type="simple">Chakrabarti A, Zickler T (2011) Statistics of real-world hyperspectral images. In: Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition. IEEE, pp. 193–200.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Hirasawa1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hirasawa</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Kaneko</surname><given-names>A</given-names></name> (<year>2003</year>) <article-title>pH changes in the invaginating synaptic cleft mediate feedback from horizontal cells to cone photoreceptors by modulating Ca<sup>2+</sup> channels</article-title>. <source>Journal of General Physiology</source> <volume>122</volume>: <fpage>657</fpage>–<lpage>671</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Verweij1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Verweij</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hornstein</surname><given-names>EP</given-names></name>, <name name-style="western"><surname>Schnapf</surname><given-names>JL</given-names></name> (<year>2003</year>) <article-title>Surround antagonism in macaque cone photoreceptors</article-title>. <source>Journal of Neuroscience</source> <volume>23</volume>: <fpage>10249</fpage>–<lpage>10257</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Burton1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Burton</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Moorhead</surname><given-names>IR</given-names></name> (<year>1987</year>) <article-title>Color and spatial structure in natural scenes</article-title>. <source>Applied Optics</source> <volume>26</volume>: <fpage>157</fpage>–<lpage>170</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Tkaik1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tkačik</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Garrigan</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Ratliff</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Milčinski</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Klein</surname><given-names>JM</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Natural images from the birthplace of the human eye</article-title>. <source>PLoS One</source> <volume>6</volume>: <fpage>e20409</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Kruskal1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kruskal</surname><given-names>JB</given-names></name> (<year>1964</year>) <article-title>Multidimensional scaling by optimizing goodness of fit to a nonmetric hypothesis</article-title>. <source>Psychometrika</source> <volume>29</volume>: <fpage>1</fpage>–<lpage>27</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Roorda1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roorda</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>DR</given-names></name> (<year>1999</year>) <article-title>The arrangement of the three cone classes in the living human eye</article-title>. <source>Nature</source> <volume>397</volume>: <fpage>520</fpage>–<lpage>522</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Carroll1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carroll</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Neitz</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Neitz</surname><given-names>M</given-names></name> (<year>2002</year>) <article-title>Estimates of l:m cone ratio from erg icker photometry and genetics</article-title>. <source>Journal of Vision</source> <volume>2</volume>: <fpage>531</fpage>–<lpage>542</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Hofer1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hofer</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Carroll</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Neitz</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Neitz</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>DR</given-names></name> (<year>2005</year>) <article-title>Organization of the human trichromatic cone mosaic</article-title>. <source>Journal of Neuroscience</source> <volume>25</volume>: <fpage>9669</fpage>–<lpage>9679</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Neitz1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neitz</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Neitz</surname><given-names>J</given-names></name> (<year>2000</year>) <article-title>Molecular genetics of color vision and color vision defects</article-title>. <source>Archives of Ophthalmology</source> <volume>118</volume>: <fpage>691</fpage>–<lpage>700</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Gibbons1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gibbons</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Chakraborti</surname><given-names>S</given-names></name> (<year>2003</year>) <article-title>Nonparametric Statistical Inference. Textbooks and Monographs</article-title>. <source>Marcel Dekker</source></mixed-citation>
</ref>
<ref id="pcbi.1003652-Wright1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wright</surname><given-names>WD</given-names></name> (<year>1952</year>) <article-title>The characteristics of tritanopia</article-title>. <source>Journal of the Optical Society of America</source> <volume>42</volume>: <fpage>509</fpage>–<lpage>521</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Neitz2"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neitz</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kraft</surname><given-names>TW</given-names></name>, <name name-style="western"><surname>Neitz</surname><given-names>J</given-names></name> (<year>1998</year>) <article-title>Expression of l cone pigment gene subtypes in females</article-title>. <source>Vision Research</source> <volume>38</volume>: <fpage>3221</fpage>–<lpage>3225</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Nagy1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nagy</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>MacLeod</surname><given-names>DI</given-names></name>, <name name-style="western"><surname>Heyneman</surname><given-names>NE</given-names></name>, <name name-style="western"><surname>Eisner</surname><given-names>A</given-names></name> (<year>1981</year>) <article-title>Four cone pigments in women heterozygous for color deficiency</article-title>. <source>Journal of the Optical Society of America</source> <volume>71</volume>: <fpage>719</fpage>–<lpage>722</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Jordan1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jordan</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Mollon</surname><given-names>JD</given-names></name> (<year>1993</year>) <article-title>A study of women heterozygous for colour deficiencies</article-title>. <source>Vision Research</source> <volume>33</volume>: <fpage>1495</fpage>–<lpage>1508</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Jordan2"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jordan</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Deeb</surname><given-names>SS</given-names></name>, <name name-style="western"><surname>Bosten</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Mollon</surname><given-names>JD</given-names></name> (<year>2010</year>) <article-title>The dimensionality of color vision in carriers of anomalous trichromacy</article-title>. <source>Journal of Vision</source> <volume>10</volume>: <fpage>12</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Lennie1"><label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">Lennie P, Haake PW, Williams DR (1991) The design of chromatically opponent receptive fields. In: Landy MS, Movshon JA, editors, Computational models of visual processing, Cambridge, MA, USA: MIT Press. 71–82 p.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Jusuf1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jusuf</surname><given-names>PR</given-names></name>, <name name-style="western"><surname>Martin</surname><given-names>PR</given-names></name>, <name name-style="western"><surname>Grünert</surname><given-names>U</given-names></name> (<year>2006</year>) <article-title>Random wiring in the midget pathway of primate retina</article-title>. <source>Journal of Neuroscience</source> <volume>26</volume>: <fpage>3908</fpage>–<lpage>3917</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Rodieck1"><label>30</label>
<mixed-citation publication-type="book" xlink:type="simple">Rodieck RW (1998) The First Steps in Seeing. Sunderland, MA, USA: Sinauer Associates, Incorporated.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Shapley1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shapley</surname><given-names>R</given-names></name> (<year>2006</year>) <article-title>Specificity of cone connections in the retina and color vision. Focus on “specificity of cone inputs to macaque retinal ganglion cells”</article-title>. <source>Journal of Neurophysiology</source> <volume>95</volume>: <fpage>587</fpage>–<lpage>588</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Field1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Field</surname><given-names>GD</given-names></name>, <name name-style="western"><surname>Gauthier</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Sher</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Greschner</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Machado</surname><given-names>TA</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Functional connectivity in the retina at the resolution of photoreceptors</article-title>. <source>Nature</source> <volume>467</volume>: <fpage>673</fpage>–<lpage>677</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Lee1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname><given-names>BB</given-names></name>, <name name-style="western"><surname>Shapley</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Hawken</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>H</given-names></name> (<year>2012</year>) <article-title>Spatial distributions of cone inputs to cells of the parvocellular pathway investigated with cone-isolating gratings</article-title>. <source>Journal of the Optical Society of America</source> <volume>29</volume>: <fpage>A233</fpage>–<lpage>A232</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Neitz3"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neitz</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Neitz</surname><given-names>J</given-names></name>, <name name-style="western"><surname>GH</surname><given-names>GHJ</given-names></name> (<year>1991</year>) <article-title>Spectral tuning of pigments underlying red-green color vision</article-title>. <source>Science</source> <volume>252</volume>: <fpage>971</fpage>–<lpage>974</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Teller1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Teller</surname><given-names>DY</given-names></name> (<year>1982–1983</year>) <article-title>Scotopic vision, color vision, and stereopsis in infants</article-title>. <source>Current Eye Research</source> <volume>2</volume>: <fpage>199</fpage>–<lpage>210</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Brown1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname><given-names>AM</given-names></name> (<year>1990</year>) <article-title>Development of visual sensitivity to light and color vision in human infants: a critical review</article-title>. <source>Vision Research</source> <volume>30</volume>: <fpage>1159</fpage>–<lpage>1188</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Banks1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Banks</surname><given-names>MS</given-names></name>, <name name-style="western"><surname>Bennett</surname><given-names>PJ</given-names></name> (<year>1988</year>) <article-title>Optical and photoreceptor immaturities limit the spatial and chromatic vision of human neonates</article-title>. <source>Journal of the Optical Society of America A, Optics, Image Science, and Vision</source> <volume>5</volume>: <fpage>2059</fpage>–<lpage>2079</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Norcia1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Norcia</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Tyler</surname><given-names>CW</given-names></name>, <name name-style="western"><surname>Hamer</surname><given-names>RD</given-names></name> (<year>1990</year>) <article-title>Development of contrast sensitivity in the human infant</article-title>. <source>Vision Research</source> <volume>30</volume>: <fpage>1475</fpage>–<lpage>1486</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Sugita1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sugita</surname><given-names>Y</given-names></name> (<year>2004</year>) <article-title>Experience in early infancy is indispensable for color perception</article-title>. <source>Current Biology</source> <volume>14</volume>: <fpage>1267</fpage>–<lpage>1271</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Ahumada2"><label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">Ahumada AJ Jr (1991) Learning receptor positions. In: Landy MS, Movshon JA, editors, Computational Models of Visual Processing, Cambridge, MA, USA: MIT Press. 23–34 p.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Maloney1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maloney</surname><given-names>LT</given-names></name>, <name name-style="western"><surname>Ahumada</surname><given-names>AJ</given-names></name> (<year>1989</year>) <article-title>Learning by assertion: Two methods for calibrating a linear visual system</article-title>. <source>Neural Computation</source> <volume>1</volume>: <fpage>392</fpage>–<lpage>401</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Jacobs2"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jacobs</surname><given-names>GH</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>GA</given-names></name>, <name name-style="western"><surname>Cahill</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Nathans</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>Emergence of novel color vision in mice engineered to express a human cone photopigment</article-title>. <source>Science</source> <volume>315</volume>: <fpage>1723</fpage>–<lpage>1725</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Mancuso1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mancuso</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Hauswirth</surname><given-names>WW</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Connor</surname><given-names>TB</given-names></name>, <name name-style="western"><surname>Kuchenbecker</surname><given-names>JA</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Gene therapy for redgreen colour blindness in adult primates</article-title>. <source>Nature</source> <volume>461</volume>: <fpage>784</fpage>–<lpage>787</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Makous1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Makous</surname><given-names>W</given-names></name> (<year>2007</year>) <article-title>Comment on “emergence of novel color vision in mice engineered to express a human cone photopigment”</article-title>. <source>Science</source> <volume>318</volume>: <fpage>196</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Brainard1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brainard</surname><given-names>DH</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Hofer</surname><given-names>H</given-names></name> (<year>2008</year>) <article-title>Trichromatic reconstruction from the interleaved cone mosaic: Bayesian model and the color appearance of small spots</article-title>. <source>Journal of Vision</source> <volume>8</volume>: <fpage>15</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Tuten1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tuten</surname><given-names>WS</given-names></name>, <name name-style="western"><surname>Tiruveedhula</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Roorda</surname><given-names>A</given-names></name> (<year>2012</year>) <article-title>Adaptive optics scanning laser ophthalmoscope-based microperimetry</article-title>. <source>Optometry and Vision Science</source> <volume>89</volume>: <fpage>563</fpage>–<lpage>74</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Hofer2"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hofer</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Singer</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>DR</given-names></name> (<year>2005</year>) <article-title>Different sensations from cones with the same photopig- ment</article-title>. <source>Journal of Vision</source> <volume>5</volume>: <fpage>444</fpage>–<lpage>454</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Simoncelli1"><label>48</label>
<mixed-citation publication-type="book" xlink:type="simple">Simoncelli EP (2005) Statistical modeling of photographic images, Academic Press. 431–441 p.</mixed-citation>
</ref>
<ref id="pcbi.1003652-ORegan1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>O'Regan</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Noë</surname><given-names>A</given-names></name> (<year>2001</year>) <article-title>A sensorimotor account of vision and visual consciousness</article-title>. <source>Behavioral and Brain Sciences</source> <volume>24</volume>: <fpage>939</fpage>–<lpage>1031</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-CIE1"><label>50</label>
<mixed-citation publication-type="book" xlink:type="simple">CIE (2007) Fundamental chromaticity diagram with physiological axes - Parts 1 and 2. Technical Report 170-1. Vienna: Central Bureau of the Commission Internationale de l'éclairage.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Brainard2"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brainard</surname><given-names>DH</given-names></name> (<year>1997</year>) <article-title>The psychophysics toolbox</article-title>. <source>Spatial Vision</source> <volume>10</volume>: <fpage>433</fpage>–<lpage>436</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003652-Stockman1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stockman</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sharpe</surname><given-names>LT</given-names></name> (<year>2000</year>) <article-title>The spectral sensitivities of the middle- and long-wavelength-sensitive cones derived from measurements in observers of known genotype</article-title>. <source>Vision Research</source> <volume>40</volume>: <fpage>1711</fpage>–<lpage>1737</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>