<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosbiol</journal-id>
<journal-title-group>
<journal-title>PLOS Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1544-9173</issn>
<issn pub-type="epub">1545-7885</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pbio.2003663</article-id>
<article-id pub-id-type="publisher-id">pbio.2003663</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Physiological processes</subject><subj-group><subject>Sleep</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Physiological processes</subject><subj-group><subject>Sleep</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Bioassays and physiological analysis</subject><subj-group><subject>Electrophysiological techniques</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Brain mapping</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Clinical medicine</subject><subj-group><subject>Clinical neurophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Bioassays and physiological analysis</subject><subj-group><subject>Electrophysiological techniques</subject><subj-group><subject>Muscle electrophysiology</subject><subj-group><subject>Electromyography</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Mouse models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Mouse models</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Animal models</subject><subj-group><subject>Mouse models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Sensory physiology</subject><subj-group><subject>Visual system</subject><subj-group><subject>Eye movements</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Sensory physiology</subject><subj-group><subject>Visual system</subject><subj-group><subject>Eye movements</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Sensory systems</subject><subj-group><subject>Visual system</subject><subj-group><subject>Eye movements</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Physiological processes</subject><subj-group><subject>Homeostasis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Physiological processes</subject><subj-group><subject>Homeostasis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Neurology</subject><subj-group><subject>Sleep deprivation</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Chronobiology</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>A novel unsupervised analysis of electrophysiological signals reveals new sleep substages in mice</article-title>
<alt-title alt-title-type="running-head">Unsupervised analysis of sleep substages</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4974-4767</contrib-id>
<name name-style="western">
<surname>Katsageorgiou</surname>
<given-names>Vasiliki-Maria</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Sona</surname>
<given-names>Diego</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zanotto</surname>
<given-names>Matteo</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Lassi</surname>
<given-names>Glenda</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Garcia-Garcia</surname>
<given-names>Celina</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Tucci</surname>
<given-names>Valter</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Murino</surname>
<given-names>Vittorio</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Pattern Analysis and Computer Vision (PAVIS), Istituto Italiano di Tecnologia, Genova, Italy</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Neuroinformatics Lab (NILab), Fondazione Bruno Kessler, Trento, Italy</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Genetics and Epigenetics of Behaviour, Neuroscience and Brain Technologies (NBT), Istituto Italiano di Tecnologia, Genova, Italy</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Department of Computer Science, University of Verona, Verona, Italy</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ganguly</surname>
<given-names>Karunesh</given-names>
</name>
<role>Academic Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>UCSF School of Medicine, United States of America</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">Vasiliki.Katsageorgiou@iit.it</email> (V-MK); <email xlink:type="simple">Diego.Sona@iit.it</email> (DS); <email xlink:type="simple">Vittorio.Murino@iit.it</email> (VM); <email xlink:type="simple">Valter.Tucci@iit.it</email> (VT)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>29</day>
<month>5</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<month>5</month>
<year>2018</year>
</pub-date>
<volume>16</volume>
<issue>5</issue>
<elocation-id>e2003663</elocation-id>
<history>
<date date-type="received">
<day>18</day>
<month>7</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>9</day>
<month>5</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Katsageorgiou et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pbio.2003663"/>
<abstract>
<p>Sleep science is entering a new era, thanks to new data-driven analysis approaches that, combined with mouse gene–editing technologies, show a promise in functional genomics and translational research. However, the investigation of sleep is time consuming and not suitable for large-scale phenotypic datasets, mainly due to the need for subjective manual annotations of electrophysiological states. Moreover, the heterogeneous nature of sleep, with all its physiological aspects, is not fully accounted for by the current system of sleep stage classification. In this study, we present a new data-driven analysis approach offering a plethora of novel features for the characterization of sleep. This novel approach allowed for identifying several substages of sleep that were hidden to standard analysis. For each of these substages, we report an independent set of homeostatic responses following sleep deprivation. By using our new substages classification, we have identified novel differences among various genetic backgrounds. Moreover, in a specific experiment with the <italic>Zfhx3</italic> mouse line, a recent circadian mutant expressing both shortening of the circadian period and abnormal sleep architecture, we identified specific sleep states that account for genotypic differences at specific times of the day. These results add a further level of interaction between circadian clock and sleep homeostasis and indicate that dissecting sleep in multiple states is physiologically relevant and can lead to the discovery of new links between sleep phenotypes and genetic determinants. Therefore, our approach has the potential to significantly enhance the understanding of sleep physiology through the study of single mutations. Moreover, this study paves the way to systematic high-throughput analyses of sleep.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Sleep is a heterogeneous process determined by a number of genetic and epigenetic factors. To investigate the biology of sleep, animal models, such as mice, are extensively used in sleep studies, and large-scale phenotypic datasets are required to reach meaningful conclusions. Currently, manual annotations of electrophysiological states by a researcher is the gold-standard approach to classifying sleep stages. Only a few sleep states are identified through such manual annotations, namely non-rapid-eye-movement (NREM) and rapid-eye-movement (REM) sleep. In this work, we present a new computational approach that identified multiple new substages of sleep based on standard electroencephalography (EEG)/electromyography (EMG) features. Using this new approach, we studied each individual identified state and discovered that many of these states respond to the basic principles of sleep physiology: for example, some states homeostatically respond to sleep deprivation. We also applied our method to different mouse strains and to a circadian mutant line of mice. In all experimental groups, we were able to refine our understanding by associating specific substages with the genetic variations. We conclude that our new unbiased computational approach can help refine the study of sleep by further dissecting sleep biology.</p>
</abstract>
<funding-group>
<funding-statement>European Commission FP7 Programme (grant number Project 223263 (PhenoScale)). Awarded to VT. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="0"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-06-08</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All the raw datasets used in the experiments carried out in the paper are available at: <ext-link ext-link-type="uri" xlink:href="http://pavis.iit.it/datasets/mouse-sleep-analysis" xlink:type="simple">http://pavis.iit.it/datasets/mouse-sleep-analysis</ext-link> The code developed for the analysis of the above electrophysiological data that produced the results summarized in the Figures is available at: <ext-link ext-link-type="uri" xlink:href="https://gitlab.iit.it/vkatsageorgiou/mouseSleepAnalysis" xlink:type="simple">https://gitlab.iit.it/vkatsageorgiou/mouseSleepAnalysis</ext-link>. The code is also accompanied by the preprocessed data used in the experiments in this study in a python format (.npz). In particular, results shown in Figs <xref ref-type="fig" rid="pbio.2003663.g002">2</xref>, <xref ref-type="fig" rid="pbio.2003663.g003">3</xref>, <xref ref-type="fig" rid="pbio.2003663.g004">4</xref>, <xref ref-type="fig" rid="pbio.2003663.g005">5A – top and 5B – top</xref>, <xref ref-type="supplementary-material" rid="pbio.2003663.s001">S1</xref>, <xref ref-type="supplementary-material" rid="pbio.2003663.s002">S2</xref>, <xref ref-type="supplementary-material" rid="pbio.2003663.s003">S3</xref>, <xref ref-type="supplementary-material" rid="pbio.2003663.s004">S4</xref>, <xref ref-type="supplementary-material" rid="pbio.2003663.s005">S5</xref>, <xref ref-type="supplementary-material" rid="pbio.2003663.s006">S6</xref> and <xref ref-type="supplementary-material" rid="pbio.2003663.s007">S7</xref> can be reproduced using the “Experiment1.npz” data file that can be found in the “datasets” folder in the above repository. In the same folder, the “Experiment2.npz” data file can be used to reproduce the results depicted in Figs <xref ref-type="fig" rid="pbio.2003663.g005">5A – bottom, 5B – bottom</xref> and <xref ref-type="fig" rid="pbio.2003663.g006">6</xref>. Finally, results in <xref ref-type="fig" rid="pbio.2003663.g007">Fig 7</xref> can be reproduced using the “Experiment3.npz” data file.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Sleep is a physiological, metabolic, and behavioral state of the organism that plays an important role in many biological functions. It is described by 2 different states—namely, non-rapid-eye-movement (NREM) sleep and rapid-eye-movement (REM) sleep. In laboratory settings, sleep is conventionally defined by properties of electrophysiological signals, and many features of these biological signals are shared across species. For this reason and thanks to the advances in mouse genetics, the study of sleep in mice has become popular in many laboratories.</p>
<p>A guideline for sleep scoring was developed for human studies as a tool for visual analysis of electroencephalography (EEG) and electromyography (EMG) traces according to a predefined set of rules [<xref ref-type="bibr" rid="pbio.2003663.ref001">1</xref>]. Based on these rules, a simplified catalog of electrophysiological properties was determined for rodents as well. Differently from humans, in rodents NREM sleep is considered to be a single state. It is characterized by low EEG frequencies (below 5 Hz) with a progressive reduction of muscular tone, and it is usually referred to as deep sleep. On the other hand, REM sleep is characterized by EEG frequencies in the range 5–9 Hz. This makes it an electrophysiologically active state, similar to wakefulness in many aspects, even though the muscle tone decreases dramatically during this state. Due to this fact, REM sleep is also called paradoxical sleep. These basic criteria and some additional properties (i.e., periodic electrophysiological phenomena that occur in EEG) are used to manually classify long series of time epochs (each epoch usually lasts 4 seconds) into either one of the two aforementioned sleep states or into the wakefulness state.</p>
<p>Visual scoring of the different time epochs is the current gold-standard approach that provides fundamental insights into sleep regulation and physiology; however, it is a time-consuming process that can be affected by errors and misjudgments across different scorers. This is caused by the subjective decisions that can easily bias the labeling process. Indeed, inter- and intrascorer variability is always present, and studies evaluating the consistency between scorers have shown an average agreement of about 80%, which varies significantly across different sleep states [<xref ref-type="bibr" rid="pbio.2003663.ref002">2</xref>,<xref ref-type="bibr" rid="pbio.2003663.ref003">3</xref>,<xref ref-type="bibr" rid="pbio.2003663.ref004">4</xref>]. In addition to the difficulties related to manual scoring, it is well recognized that sleep states are nonhomogeneous units representing an aggregation of different substages [<xref ref-type="bibr" rid="pbio.2003663.ref005">5</xref>]. For example, NREM sleep in humans is typically characterized by 3 substages, and in some animals, it can be divided into 2 substages (slow-wave sleep I and II) [<xref ref-type="bibr" rid="pbio.2003663.ref006">6</xref>]. However, whether sleep stages should be divided into multiple substages, each one having a physiological relevance, remains an open question in sleep biology.</p>
<p>In this scenario, we attempted to go beyond the current state of knowledge in the study of sleep in mice, trying to extrapolate unforeseen phenomena from the data. Our study is driven by the assumption that a richer structure of electrophysiologically derived properties can be discovered from standard datasets. Thus, we present here a different conceptual and technical framework for the analysis of sleep in mice based on the adoption of unsupervised machine learning. The proposed scheme has the potential to represent a paradigm shift in the study of sleep, allowing for an investigation without prior assumptions on the different states, thus facilitating an agnostic exploratory data analysis. Indeed, employing models that are capable of detecting regularities in large datasets, we can discover many sleep substages that a human scorer would never detect by a standard visual inspection of signals.</p>
<p>The class of latent (hidden) variable models have proven to be very effective in capturing hidden regularities in the data, due to their ability to encode rich structured priors and infer latent properties of the data without requiring human annotations [<xref ref-type="bibr" rid="pbio.2003663.ref007">7</xref>]. Out of all potential models, we decided to adopt the mean-covariance restricted Boltzmann machine (mcRBM) [<xref ref-type="bibr" rid="pbio.2003663.ref008">8</xref>] to model brain and muscle activities. This model is capable of learning the joint distribution between a set of continuous observed random variables and a set of binary unobserved (latent) ones, modeling complex (multimodal) distributions from Gaussian-like data (like in our case, see <xref ref-type="fig" rid="pbio.2003663.g001">Fig 1A</xref>), and exploiting correlations between the input variables. Specifically, it allows inferring a set of latent representations (namely, latent states) describing different modes in the input data distribution, each one ideally corresponding to a cluster associated with a reoccurring sleep pattern. These latent states can be therefore interpreted as model descriptors identifying different sleep substages. For this reason, in the following text, we will interchangeably refer to them as latent states or substages.</p>
<fig id="pbio.2003663.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2003663.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Multisubject data analysis pipeline.</title>
<p>(A) Data collection and preprocessing per subject; FFT was applied to EEG signals to derive the power histogram of 5 bands (Alpha, Beta, Delta, Gamma, and Theta), and the ratios between all possible pairwise combinations of the 5 EEG bands were computed. For the EMG, we used its integral values. Each individual dataset was preprocessed by taking the natural logarithm of the data and zeroing the mean of each feature separately. (B) Scatter plot of the log-(Delta/Theta) and the log-EMG features showing the existence of more clusters in the samples of one subject. Notice that REM sleep is characterized by at least 2 substages. Data points belong to a single-subject time series. Blue, green, and red samples are associated with wakefulness, NREM sleep, and REM sleep, respectively, as hand-labeled by the expert. (C) Data modeling: time series of EEG/EMG data of all subjects were concatenated into a unique dataset and modeled with an mcRBM, resulting in a set of latent variables’ representation of the input data. (D) Evolution of mcRBM’s latent variables activity while processing an input time series in which, for a visualization purpose, the sequence of states has been grouped according to the 3 known stages, i.e., NREM (NR), REM (R), and wakefulness (W), as defined by the manual scoring. Time flows from left to right, with each pixel-wide column representing 1 time step (4 s epoch) and each pixel-wide row representing 1 latent variable. Black pixels represent nonactive units, while white pixels represent active ones. It is interesting to see how the model mostly gives similar configurations to epochs that belong to the same sleep stage. For this reason, blocks that belong to the same stage look similar to each other. Notice that units that are active in REM are generally not active in NREM and wakefulness (units in yellow frame). With the mcRBM, we are fitting Gaussian distributions to the data. Hence, each single binary representation is associated with a multivariate normal distribution [<xref ref-type="bibr" rid="pbio.2003663.ref008">8</xref>]. EEG, electroencephalography; EMG, electromyography; FFT, fast Fourier transformation; mcRBM, mean-covariance restricted Boltzmann machine; NREM, non-rapid eye movement; REM, rapid eye movement.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.g001" xlink:type="simple"/>
</fig>
<p>This model has been demonstrated to be capable of learning such regularities and discovering meaningful phenomena [<xref ref-type="bibr" rid="pbio.2003663.ref007">7</xref>]. Indeed, thanks to the unsupervised nature of the approach, we were able to study unforeseen complex phenomena appearing in electrophysiological data that cannot be studied with common rule-based and supervised learning approaches [<xref ref-type="bibr" rid="pbio.2003663.ref009">9</xref>,<xref ref-type="bibr" rid="pbio.2003663.ref010">10</xref>,<xref ref-type="bibr" rid="pbio.2003663.ref011">11</xref>,<xref ref-type="bibr" rid="pbio.2003663.ref012">12</xref>] just because such phenomena are not entirely modeled or described by the experts’ prior knowledge. This approach, for the first time, allowed the identification of multiple substages both in sleep and wakefulness phases. Thus, we explored the variability in the sleep behavior between different mouse genotypes. In particular, we performed a multisubject analysis applied on groups of mice with different genetic backgrounds, i.e., a classical pure inbred mouse strain, an outbred strain, and a strain with mixed background. From this multisubject data analysis, we identified a repertoire of novel substages that characterize the different physiological states of mouse sleep. Taking this as a starting point, we identified novel sleep-behavioral differences among mouse genotypes. Indeed, the results of our experiments robustly show that there are several substages that are characteristic of 1 strain, and this can be informative of the genetic differences across mice.</p>
<p>In an effort to further investigate the use of our approach, we applied our analysis to the recently identified <italic>Zfhx3</italic><sup><italic>Sci/+</italic></sup> mouse strain, which presents a shortening of the circadian clock and alterations in sleep homeostasis [<xref ref-type="bibr" rid="pbio.2003663.ref013">13</xref>]. Our new approach provides a deeper understanding of the sleep abnormalities in this circadian mutant mouse line, revealing specific EEG anomalies and circadian modulations. We assessed the physiological relevance of each new stage by testing the homeostatic response to a perturbation (i.e., sleep deprivation). Thus, we identified a general heterogeneous homeostatic response, suggesting that these states carry a potentially unique physiological role. Yet we observed that specific substages show distorted responses in mutants’ sleep, which may indicate the presence of subtle microstructures in the sleep of mice that are governed by single genes.</p>
<p>It is important to highlight that, beyond being a novel approach to the analysis of complex sleep phenomena, the proposed method allows management of sleep longitudinal studies, transferring the inferred knowledge across experiments. In addition, it can also be applied to other investigations in any biological domain involving the analysis of similar data (i.e., time series), such as other behavioral studies.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Identification of new sleep–wakefulness substages</title>
<p>We explored the homogeneity of the 3 standard physiological states (NREM sleep, REM sleep, and wakefulness) using a cohort of 46 animals from 3 different strains: (i) a common inbred mouse strain (C57BL/6J); (ii) a mixed background strain (BALB/c × C3H/HeH × C57BL/6J); and (iii) an outbred mouse line (CD1). We investigated the existence of substages that are common across animals through a multisubject data analysis pipeline. To deal with the subject-to-subject variability, each individual dataset was preprocessed separately, obtaining a uniform representation across subjects (see <xref ref-type="fig" rid="pbio.2003663.g001">Fig 1A</xref>). After preprocessing, it was possible to observe the presence of nonhomogeneous state distributions. For example, <xref ref-type="fig" rid="pbio.2003663.g001">Fig 1B</xref> shows in one animal that REM sleep episodes are distributed across at least 2 main clusters.</p>
<p>Since we were looking for co-occurring regularities in the data, aiming at discovering common sleep substages across subjects and across groups, all individual datasets of the aforementioned 3 mouse lines were modeled jointly with a single mcRBM (<xref ref-type="fig" rid="pbio.2003663.g001">Fig 1C</xref>). This allowed us to search for regularities within the dataset, inferred through the states of the model’s latent variables (<xref ref-type="fig" rid="pbio.2003663.g001">Fig 1D</xref>). As a result, approximately 190 different latent states (i.e., binary configurations of latent variables) were identified, most of which were strongly representative of the labeling performed by manual scoring. In <xref ref-type="fig" rid="pbio.2003663.g002">Fig 2A</xref>, we provide a visual representation of this relationship, showing the probability for each latent state (rows) to correspond to each of the 3 manually scored sleep states (columns). From this probability matrix, we can observe that a significant number of latent states map with high probability to only 1 of the 3 known states. There are also some latent states that could be associated with approximately equal probability (whitish color in the graph) to at least 2 states. For example, there are latent states mapping to both wakefulness and REM and others mapping to both NREM and REM. While these latter latent states are likely to be misclassified in the classical scoring system—for example, by different scorers—in our unbiased classification, they are independent states with a specific frequency and timing.</p>
<fig id="pbio.2003663.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2003663.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Evaluation of the observed substages.</title>
<p>(A) Probability matrix of LS being associated with the known sleep stages. Rows refer to LS and columns to wakefulness, NREM, and REM sleep stages. Color shades range from blue, representing low probability, to red, representing high probability, for the corresponding LS to belong to each of the 3 known stages. The order of the substages in the graph has been achieved using agglomerative hierarchical clustering. (B) Analysis of the NMI between the observed substages and the 3 stages. Each bar represents the NMI per stage. The right bar corresponds to ratio assuming as 2 random variables the “substages” and the “three stages.” (C) Examples of distributions of the input features associated with 3 substages corresponding with high probability to the NREM stage. The top row shows the distributions of the input samples in a box plot. The bottom row shows the covariance between the input variables. EMG, electromyography; LS, latent states; MI, mutual information; NMI, normalized mutual information; NREM, non-rapid eye movement; REM, rapid eye movement.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.g002" xlink:type="simple"/>
</fig>
<p>We also measured how informative the different latent states are about the 3 states by estimating the normalized mutual information (NMI) [<xref ref-type="bibr" rid="pbio.2003663.ref014">14</xref>], which measures how well the learnt latent states have encoded the sleep states. In our case, it was approximately 0.6, indicating a good informativeness of the latent states. Mutual information (MI) and state entropy were also computed for each state separately and, as shown in the graph in <xref ref-type="fig" rid="pbio.2003663.g002">Fig 2B</xref>, the observed latent states are highly informative about the 3 states (i.e., NMI &gt; 0.5).</p>
<p>Thanks to the fact that the mcRBM is a generative model, we were able to further investigate the variability of the input data distributions associated with each inferred latent state. Specifically, a multivariate normal distribution (represented by its mean vector and covariance matrix) over the input variables was inferred for each latent state (see <xref ref-type="fig" rid="pbio.2003663.g001">Fig 1D</xref>). Different latent states correspond to different distributions in the input data, even when they can be statistically associated with the same sleep stage (see <xref ref-type="fig" rid="pbio.2003663.g002">Fig 2C</xref> and <xref ref-type="supplementary-material" rid="pbio.2003663.s001">S1 Fig</xref>). This result points to the existence of a more elaborate electrophysiological characterization of sleep than expected, showing that the 3 main states are nonhomogeneous entities. This supports our hypothesis that the known 3 sleep stages can be described by multiple latent states in the model, hence by different sleep substages that experts cannot detect by a simple visual inspection of the signals.</p>
</sec>
<sec id="sec004">
<title>Substages discriminate mouse genotypes</title>
<p>In light of the findings described in the previous section, we investigated whether there are substages that are characteristic of specific mouse genotypes. Indeed, we observed that a significant number of substages are mostly associated to 1 of the 3 strains. In order to determine those that best describe each strain, we used the 2-sample independent <italic>t</italic> test, comparing the distributions of the substages across the mouse genotypes. Three examples are shown in <xref ref-type="fig" rid="pbio.2003663.g003">Fig 3</xref>, in which the graphs depict for each strain the statistics on the number of epochs in which each latent state is observed. The arrows below each graph show the <italic>p</italic>-values of the 2-sample independent <italic>t</italic> test, giving a picture of the difference between each combination of 2 distributions. This approach allows determining analytically the sets of all latent states that best characterize each single genotype.</p>
<fig id="pbio.2003663.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2003663.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Examples of 3 substages that are characteristic of the 3 mouse genetic backgrounds.</title>
<p>Box plots describing the statistics on the number of epochs each strain falls in the corresponding substage. Arrows below each graph show the <italic>p</italic>-values for the 2-sample independent <italic>t</italic> test computed on the top distributions. (A) A substage associated with the wakefulness stage for which the C57BL/6J mouse group is significantly different from the other 2 groups (<italic>p</italic>-values &lt; 0.05). (B) A substage mapping to the NREM stage that is characteristic for the CD1 strain. (C) A substage associated with NREM sleep that is characteristic for the mixed background group. LS, latent stage; NREM, non-rapid eye movement; REM, rapid eye movement.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.g003" xlink:type="simple"/>
</fig>
<p>Prompted by the variability of sleep among mouse groups, we attempted to test whether we can use the substages to discriminate between the mouse genetic backgrounds with a supervised machine-learning approach. Each group and each subject is described by a discrete probability distribution over the observed latent states. In a leave-one-subject-out classification framework and using a majority-voting criterion, we achieved a discrimination performance of 85.11%. The resulting confusion matrix is shown in <xref ref-type="supplementary-material" rid="pbio.2003663.s002">S2 Fig</xref>, in which we can see that only 2 subjects for each strain have been misclassified. We can also observe that both misclassified subjects of the mixed background strain have been classified as belonging to the C57BL/6J group, which is interesting because the C57BL/6J background and mixed background groups are genetically related. This experiment highlights the power of our study in detecting genetic background effects. Since different genetic backgrounds are associated with specific traits, our capability to discriminate between mouse groups indicates that some latent states we identified depend on specific genetic components.</p>
</sec>
<sec id="sec005">
<title>Transitions across substages show a robust clustering of sleep and wakefulness</title>
<p>Transitions between different substages can be informative in the analysis of sleep over 24 hours. We computed the transition probabilities between the latent states for the entire dataset. As expected, latent states mapping to a certain sleep stage among NREM, REM, and wakefulness have higher probability to be followed by latent states mapping to the same stage. We visualized the transition probabilities in a graph where nodes (the latent states) are clustered according to their overall connectivity using a multidimensional scaling algorithm (<xref ref-type="fig" rid="pbio.2003663.g004">Fig 4</xref> top). The absolute position of each node in this graph is not relevant; the overall grouping of nodes is what can give us useful insight. Indeed, as a first result, we noticed that clustering the latent states according to their connectivity surprisingly also results in a meaningful grouping of nodes in terms of the 3 known sleep stages. The clustered graph confirms basic knowledge regarding the transitions across sleep states. For example, the cluster of latent states mapping to NREM sleep is near to the cluster of latent states mapping to REM sleep, and both are far away from the cluster of latent states associated with wakefulness. Interestingly, latent states not having a clear mapping to any of the 3 known sleep stages (whitish substages in <xref ref-type="fig" rid="pbio.2003663.g002">Fig 2A</xref>) are usually interleaving substages positioned between the 3 overall clusters and associated with a transitional state between the 3 known sleep stages (see purple nodes in <xref ref-type="fig" rid="pbio.2003663.g004">Fig 4</xref>).</p>
<fig id="pbio.2003663.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2003663.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Transitions’ probabilities between substages and daily profiles analysis.</title>
<p>Top: state-transition graph in which nodes have been clustered according to the transition probabilities. Nodes correspond to the substages, and edges identify the transitions between stages. Nodes’ size is related to their in-degree. Blue, green, and red nodes are associated with substages mapping with high probability to wakefulness, NREM sleep, and REM sleep, respectively. Purple nodes correspond to substages that do not have a clear mapping to 1 of the 3 known stages (probability lower than 0.6 for any stage). Edges’ weight is related to the corresponding transition probability, and their color is related to the source node. Graphs were built using the ForceAtlas2 algorithm [<xref ref-type="bibr" rid="pbio.2003663.ref015">15</xref>,<xref ref-type="bibr" rid="pbio.2003663.ref016">16</xref>] (see also interactive graphs at <ext-link ext-link-type="uri" xlink:href="http://pavis.iit.it/datasets/mouse-sleep-analysis" xlink:type="simple">http://pavis.iit.it/datasets/mouse-sleep-analysis</ext-link>). Bottom: examples of daily profiles associated with NREM sleep, in which the profile of C57BL/6J mouse group is slightly shifted. Histograms describe the distribution of epochs using bins of 1 hour. Polynomial curves are fitted to the histograms to obtain a simplified visual representation of daily oscillations. LS, latent state; NREM, non-rapid eye movement; REM, rapid eye movement; ZT, zeitgeber time.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.g004" xlink:type="simple"/>
</fig>
<p>In a deeper investigation of the differences among mouse genetic backgrounds, we also built the graphs for each strain separately, following the same principle (see graphs in <xref ref-type="supplementary-material" rid="pbio.2003663.s003">S3 Fig</xref> and interactive graphs at <ext-link ext-link-type="uri" xlink:href="http://pavis.iit.it/datasets/mouse-sleep-analysis" xlink:type="simple">http://pavis.iit.it/datasets/mouse-sleep-analysis</ext-link>). This allowed us to look for possible differences among the 3 groups. We searched for nodes assuming a different role in the 3 strains (e.g., nodes that are central to a cluster in a group and become transitional between 2 clusters in another graph). Indeed, even though the general clustering is common across graphs, there are some nodes whose role changes significantly. For instance, node 53, while being associated with REM sleep according to human labeling, seems to be a transitional state between wakefulness and NREM sleep in the graph generated from the CD1 strain. On the contrary, the same node in the graphs generated from both C57BL/6J and mixed background groups has transitions only with NREM and REM sleep nodes (see black arrows pointing out this node in each graph in <xref ref-type="supplementary-material" rid="pbio.2003663.s003">S3 Fig</xref>). Similarly, node 174 in the mixed background group appears as a transitional state between wakefulness and sleep, while in the other groups, it has transitions only with nodes associated with wakefulness (see orange arrows pointing out this node in each graph in <xref ref-type="supplementary-material" rid="pbio.2003663.s003">S3 Fig</xref>). These results imply that specific substages can have different roles according to a specific genetic background and cannot be considered as isolated stages. This offers an unprecedented dynamic aspect in studying sleep physiology within multiple sleep microstructures.</p>
</sec>
<sec id="sec006">
<title>Substages follow daily variations</title>
<p>To investigate how substages develop over time, we analyzed the daily behavior over the 24 hours for each genotype. Specifically, we computed the histogram of the 4-second epochs that fall in each single latent state using bins of 1 hour, starting from 7:00 AM. Histograms are computed for each latent state and for each group separately. A polynomial curve is fitted to the histogram to obtain a representation of daily oscillations. We observed that some latent states show different daily profiles across mouse genotypes. For example, the profile of the C57BL/6J strain in latent state 104 (see <xref ref-type="fig" rid="pbio.2003663.g004">Fig 4</xref> bottom left) is shifted compared to the other 2 strains. Interestingly, the latter state (as well as latent state 110 in <xref ref-type="supplementary-material" rid="pbio.2003663.s004">S4B Fig</xref>) is quite numerous within the dataset and particularly in NREM sleep, suggesting that the daily distribution of the latent states is an additional powerful discriminator of mouse genotypes. A similar shift in the profile of C57BL/6J was observed in many other latent states, including those that do not have a clear mapping to only 1 of the 3 known sleep stages, like latent state 19 (see <xref ref-type="fig" rid="pbio.2003663.g004">Fig 4</xref> bottom right). In <xref ref-type="supplementary-material" rid="pbio.2003663.s004">S4</xref> and <xref ref-type="supplementary-material" rid="pbio.2003663.s005">S5</xref> Figs, we report further examples of daily profiles of specific latent states and the manually annotated known sleep stages, respectively. This shift in the profile of C57BL/6J is present in almost all the latent states, as well in the 3 known stages, and it is due to its genetic background that, to the best of our knowledge, it has not been described in literature before.</p>
</sec>
<sec id="sec007">
<title>During the subjective night, latent states are divided in early and late peaks</title>
<p>We further analyzed the latent states having maximum peaks during the subjective night (light phase: 7:00–19:00). We observed that there is a group of latent states having maximum peak in the first half of the light phase, while some others have a peak in the second half of the light phase. Interestingly, we observed that 91% of the latent states mapping with high probability to REM have peaks in the second half of the light phase (see <xref ref-type="fig" rid="pbio.2003663.g005">Fig 5A</xref>). This compartmentalization of REM-like sleep substages across the subjective night resembles the classical distribution of REM sleep in humans, in which the majority of REM sleep occurs in the second part of the night. Our result, suggesting that a microstructure of REM-like sleep occurs in the second part of the subjective night of a mouse, was never described before. Thus, we can speculate that the temporal profile of these latent states could be informative of the full REM-like sleep in mice. Indeed, REM sleep is often reported to be 5%–10% of sleep in mice, while in humans, it reaches up to 20%. In <xref ref-type="fig" rid="pbio.2003663.g005">Fig 5B</xref>, we compared the percentage of REM sleep annotated with manual scoring versus the percentage of REM-like sleep, considering all latent states that present a profile that peaks in the second half of the subjective night. Remarkably, the account of latent states is close to the percentage (in range of 20%–30%, see <xref ref-type="fig" rid="pbio.2003663.g005">Fig 5B</xref>) of REM sleep reported in humans. These results may suggest that this new method has the potential to describe a microstructure of REM-like sleep states in mice that resemble the human one.</p>
<fig id="pbio.2003663.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2003663.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Temporal profile of REM-like states.</title>
<p>(A) Analysis of the peaks during the light phase (07:00–19:00) identified 2 populations of latent states, presenting peaks either in the first or the second half of the subjective night. Top graphs are associated with the first experiment (data coming from the 3 wild-type genetic backgrounds). Bottom graphs are associated with the second experiment (<italic>Zfhx3</italic><sup><italic>Sci/+</italic></sup> mutant strain versus <italic>Zfhx3</italic><sup><italic>+/+</italic></sup> littermate controls). In both experiments, the majority of the substages that map into the second half of the light phase has a high probability to be classified as REM (therefore REM-like). The substages classified as NREMs are equally divided into the first and second half of the light phase. (B) Comparison between manually annotated REMs versus REM-like states generated by our approach, which peak in the second half of the light phase, in the 2 experiments. Graph shows the percentage of epochs labeled as REM (refer also to <xref ref-type="supplementary-material" rid="pbio.2003663.s008">S1 Data</xref>). NREM, non-rapid eye movement; REM, rapid eye movement; ZT, zeitgeber time.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>The latent states are homeostatically regulated and genetically determined</title>
<p>In order to explore in more detail the idea of using specific latent states as biomarkers for the identification of single gene determinants (i.e., in circadian clock alterations), we also performed an additional sleep analysis of the <italic>Zfhx3</italic><sup><italic>Sci/+</italic></sup> mutant strain, which is characterized by a reduced circadian period and some other differences in their sleep architecture compared to their littermate control <italic>Zfhx3</italic><sup><italic>+/+</italic></sup> mice [<xref ref-type="bibr" rid="pbio.2003663.ref013">13</xref>].</p>
<p>Following the same processing pipeline as in the previous experiment, all datasets of the 2 groups were modeled jointly with an mcRBM. Analyzing the daily profile of the inferred configurations, we observed the existence of latent states where <italic>Zfhx3</italic><sup><italic>Sci/+</italic></sup> mutants have a reduced profile (see <xref ref-type="fig" rid="pbio.2003663.g006">Fig 6B and 6C</xref> left). This is also evident from the analysis of the profiles of the 3 known states using the manually scored epochs (see <xref ref-type="fig" rid="pbio.2003663.g006">Fig 6A</xref>), as was already shown in [<xref ref-type="bibr" rid="pbio.2003663.ref013">13</xref>]. Moreover, some latent states show flat profiles during the dark phase for both strains (see <xref ref-type="fig" rid="pbio.2003663.g006">Fig 6B</xref> right and <xref ref-type="fig" rid="pbio.2003663.g006">Fig 6C</xref> right), showing more specific information in the data that is not evident when only relying on standard scoring. Looking at the mean of the distributions over the input data (see bottom plots in <xref ref-type="fig" rid="pbio.2003663.g006">Fig 6B and 6C</xref>), we also observed that such states have different data distributions compared to the previous cases. Finally, we also noted that for some latent states, mainly associated with REM or NREM stages, the profile of <italic>Zfhx3</italic><sup><italic>Sci/+</italic></sup> mutants has a forward shift compared to their littermate control group (see <xref ref-type="fig" rid="pbio.2003663.g006">Fig 6D</xref>, first 2 top graphs).</p>
<fig id="pbio.2003663.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2003663.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Daily behavior analysis in the circadian mutants.</title>
<p>(A) Profiles per sleep stage of Zfhx3<sup>Sci/+</sup> versus Zfhx3<sup>+/+</sup>, using the manually scored epochs. (B) Examples of substages mapping with high probability to wakefulness. Left: the Zfhx3<sup>Sci/+</sup> mutants show a reduced profile compared to the Zfhx3<sup>+/+</sup>. Right: the profiles of both groups are flat during the dark phase. As can be observed from the graphs on the bottom, also the distributions of the input variables across the 2 substages are different. (C) Examples of substages mapping with high probability to NREM. Similarly to C, there are substages where the Zfhx3<sup>Sci/+</sup> mutants show a reduced profile compared to the Zfhx3<sup>+/+</sup> (left), as well as substages where the profiles of both groups are flat during the dark phase (right). Also, in this case, the distributions of the input variables across the 2 substages are different (bottom graphs). (D) Top left and middle graphs: examples of substages mapping with high probability to REM, in which we observed that the profile of Zfhx3<sup>Sci/+</sup> has an advance compared to the one of Zfhx3<sup>+/+</sup>. Top right: example of a substage in which no difference is observed across the 2 groups. Bottom: Differences in the input data distributions can be observed across the 3 examples. EMG, electromyography; LS, latent state; NREM, non-rapid eye movement; REM, rapid eye movement; ZT, zeitgeber time.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.g006" xlink:type="simple"/>
</fig>
<p>A further validation of the physiological value of each latent state came from the study of how each substage responds to sleep deprivation. Indeed, sleep is a homeostatic process that is best described by its rebound response following sleep deprivation; hence, we tested it for each latent state. In <xref ref-type="fig" rid="pbio.2003663.g007">Fig 7A</xref>, we show the distribution of rebound responses in Zfhx3 wild-type and mutant mice. In particular, we classified between immediate (i.e., at zeitgeber time [ZT] 6), intermediate (i.e., within ZT 6 and ZT 12), and late (i.e., beyond ZT 12) responses over the 6 hours following sleep deprivation. The dynamic of rebound responses in the 2 groups of mice is similar, with both groups having similar peaks at different times along the recovery phase (<xref ref-type="fig" rid="pbio.2003663.g007">Fig 7A</xref>). Then, we looked at the rebound for each latent state by assessing the different response compared to its baseline value for the same time of the day (<xref ref-type="fig" rid="pbio.2003663.g007">Fig 7B</xref> shows the amount of rebound of latent states for the 2 models). This analysis provides an initial screening of latent states that present similar responses in the 2 groups (i.e., linearly correlated in <xref ref-type="fig" rid="pbio.2003663.g007">Fig 7B</xref> corresponding to quadrants 1 and 3) and latent states that respond differently according to the genotype (i.e., nonlinearly correlated in <xref ref-type="fig" rid="pbio.2003663.g007">Fig 7B</xref> corresponding to quadrants 2 and 4). Thus, we performed a more detailed analysis of individual responses to sleep deprivation, and this provided a set of heterogeneous behaviors across different latent states, ranging from high-frequency states (e.g., &gt;17,000 epochs) to low-frequency ones (e.g., &lt;1,000 epochs). As we can appreciate from <xref ref-type="fig" rid="pbio.2003663.g007">Fig 7C</xref>, some latent states respond equally in the 2 groups of mice. The analysis also revealed specific latent states in which the homeostatic rebound following sleep deprivation is attenuated or fully suppressed in mutants compared to wild-type mice (<xref ref-type="fig" rid="pbio.2003663.g007">Fig 7D</xref>). We also identified states in which the response to deprivation is increased in mutants (<xref ref-type="fig" rid="pbio.2003663.g007">Fig 7E</xref>) or not present in both groups (<xref ref-type="fig" rid="pbio.2003663.g007">Fig 7F</xref>). Overall, the results of applying our approach to a perturbed condition such as sleep deprivation indicate that the latent states we have identified are independent states that can differentially respond to homeostatic rebound and that single gene change may influence each state separately.</p>
<fig id="pbio.2003663.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2003663.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Homeostatic responses of latent states.</title>
<p>(A) Percentage of peak rebounds at ZT 6 (immediate), within ZT 6 and ZT 12 (intermediate), and beyond ZT 12 (late). Within each category, the distribution of wake (blue), NREM (green), and REM (red) stages according to the manual annotation is represented (refer also to <xref ref-type="supplementary-material" rid="pbio.2003663.s009">S2 Data</xref>). (B) Analysis of responses in Zfhx3 mutants versus wild-type mice. Each dot describes the difference between the rebound and the baseline phase of a latent state for the same period of the day. Examples of latent-state occurrences are presented for states presenting no differences between mutants and wild-types (C); for states in which mutants present reduced response (D); for states in which mutants present higher response compared to wild-types (E); and for states in which both groups are not responding, then not homeostatically regulated (F). Note that the shaded region in the plots C-F corresponds to the period of sleep deprivation. NREM, non-rapid eye movement; REM, rapid eye movement; ZT, zeitgeber time.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.g007" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>Our study presents an advancement in the methodologies allowing the study of EEG-based sleep physiology in mice. Using our approach, we were able to identify sleep substages using standard electrophysiological data collected from mice. The observed sleep substages are well contained within the standard NREM sleep, REM sleep, and wakefulness categories, providing a preliminary validation of the proposed approach. Moreover, this new unbiased method also provides a rich repertoire of substages in wakefulness, which are, however, difficult to characterize because they correspond to a large range of behaviors. Therefore, we focused our study mainly on the latent states that emerge within sleep. Our method, by its own nature, can be used independently from classical NREM/REM annotation, offering an unbiased approach to the analysis of sleep states.</p>
<p>In order to validate the biological relevance of the learnt latent states, we applied our method to a multisubject analysis framework including different groups of mice. Specifically, we used 3 groups of mice representing the most commonly used genetic backgrounds in mouse genetics. Our study has shown that a number of latent states are characteristic of specific genotypes, and this greatly enriches the study of the genetic components of EEG sleep. Indeed, the results of our study advocate for a new set of endophenotypes that can be studied in mice by reanalyzing electrophysiological data. Interestingly, we also observed that the majority of the latent states follow a circadian-like profile and are homeostatically regulated, which adds further information in the physiological relevance of states determined by our approach. Furthermore, the definition of latent states according to the circadian phase in which they are expressed or according to their homeostatic response after sleep deprivation generates new scientific questions to be investigated. For example, our study on the <italic>Zfhx3</italic> circadian mutants refined the understanding of the sleep patterns affected by the mutation. In particular, we identified specific states that can account for increased sleep episodes in the dark phase of mutants. Within the NREM alterations reported for this line, we were also able to identify specific latent states that are characteristic of the mutants. Moreover, the oscillation of specific mutant states over 24 hours is shortened compared to littermate control mice, suggesting a specific correlation between sleep physiology and circadian clock. Yet, reanalyzing the homeostatic defect of this mutant line by means of the proposed analysis framework, we noticed that some specific latent states can account for the genotype differences, while this is not possible considering the whole NREM stage. Moreover, the mutation may be characterized by various latent states presenting either reduced rebound or increased rebound; therefore, the overall effect we observe in the mutants is the result of a highly dynamic sleep structure. This latter example indicates that our approach may be applied to additional datasets of sleep and circadian mutants. The general outcome emerging from our study is that, as expected, sleep in mice is more complex than what was analyzed so far, and applying our multistage dissection of sleep may highlight different dynamic structures of sleep that are physiologically relevant and genetically determined.</p>
<p>In the future, our methodological pipeline can be applied to datasets coming from different mouse mutants, promising a deeper understanding of the influence of genetic variations on specific physiological processes in sleep.</p>
<p>Last but not least, our method can naturally cope with a large dataset, allowing it to be employed in the analysis of high-throughput experiments, which are very much needed in large-scale screening in mouse genetics and drug discovery. Indeed, despite its unsupervised nature, the presented analysis pipeline can easily be turned into an automatic tool for scoring sleep in mice. Moreover, although it was out of the scope of the current work, the proposed approach allows the study of the physiological role of specific latent states corresponding to interesting modes, i.e., multivariate normal distributions over the input variables. In principle, it is possible to label relevant modes, creating a set of ground-truth distributions that can be used to identify and label the substages in new experiments.</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec011">
<title>Ethics statement</title>
<p>All animal procedures were approved by our institutional animal committee (“<italic>Organismo preposto al benessere degli animali</italic>”, OPBA, IIT, Genova) and by the ethical national committee in Italy for IIT Genova. All procedures were done under the Italian Policy (license issued on 19 June 2009, decreto N<sup>o</sup>106/2009-B). The study followed ARRIVE guidelines (<ext-link ext-link-type="uri" xlink:href="http://www.nc3rs.org.uk/arrive-guidelines" xlink:type="simple">http://www.nc3rs.org.uk/arrive-guidelines</ext-link>, see <xref ref-type="supplementary-material" rid="pbio.2003663.s010">S1 Checklist</xref>). All mice were anesthetized IP with Ketamine/Xilazine, 90-150K/7.5-16X and implanted with telemetry transmitters (Data Sciences, F20-EET, Gold system) for recording EEG.</p>
</sec>
<sec id="sec012">
<title>Animals</title>
<p>We analyzed EEG/EMG recordings coming from 46 male mice of 3 different groups:</p>
<list list-type="bullet">
<list-item><p>a classical inbred strain: C57BL/6J (<italic>n</italic> = 13 subjects),</p></list-item>
<list-item><p>an outbred strain: CD1 (<italic>n</italic> = 14 subjects),</p></list-item>
<list-item><p>and a mixed background group (BALB/c × C3H/HeH × C57BL/6J; <italic>n</italic> = 19 subjects).</p></list-item>
</list>
<p>Isogenic C57BL/6J mice are the most widely used mice in neuroscience due to the fact that, as with any other inbred genetic background model, it reduces variability in phenotypic expression. Moreover, a number of mouse mutant models have been developed and are available on C57BL/6J background. However, in the study of mouse models for translational medicine, the testing of mutations on mixed background models (e.g., BALB/c × C3H/HeH × C57BL/6J) or outbred mice (CD1), which resemble human genetic variations better, brings a great value.</p>
<p>To test whether our approach could be a valuable tool for the identification of specific electrophysiological alterations and circadian modulations, in a second experiment, we analyzed EEG/EMG recordings coming from 14 male mice:</p>
<list list-type="bullet">
<list-item><p>a circadian mouse mutant strain: <italic>Zfhx3</italic><sup><italic>Sci/+</italic></sup> (<italic>n</italic> = 7 subjects)</p></list-item>
<list-item><p>and its wild-type littermate control group: <italic>Zfhx3</italic><sup><italic>+/+</italic></sup> (<italic>n</italic> = 7 subjects).</p></list-item>
</list>
<p>All <italic>Zfhx3</italic><sup><italic>Sci/+</italic></sup> and <italic>Zfhx3</italic><sup><italic>+/+</italic></sup> mice were genotyped as described in [<xref ref-type="bibr" rid="pbio.2003663.ref017">17</xref>]. For more details regarding animals’ breeding and maintenance, please refer to [<xref ref-type="bibr" rid="pbio.2003663.ref013">13</xref>].</p>
</sec>
<sec id="sec013">
<title>Animal husbandry and data acquisition</title>
<p>Mice (10–14 weeks of age) were anesthetized with Ketamine/Xylazine (65/5 mg/kg, 2 ml/kg, IP) and implanted with a subcutaneous transmitter that records EEG and EMG with 2 biopotential channels (Data Sciences, F20-EET, Gold system). Electrodes (1 mm diameter) were placed on the parietal cortex of the mouse, only on 1 hemisphere. EEG electrodes were implanted on the dura, and EMG electrodes were attached to the muscle in the nape of the neck to acquire signals (Dataquest A.R.T. software, DSI) while the animals freely move in their home cage. EEG activity was sampled at 500 Hz with a 50 Hz cut-off filter. EEG signals were band-pass filtered at 0.3 Hz (low-pass filter) and 0.1 kHz (high-pass filter). After 10 days of postsurgery recovery, continuous electrophysiological signals were recorded for 24 hours (first experiment—light/dark cycle 12:12 with light switched off and on at 7 PM and 7 AM, respectively) and for 72 hours (second and third experiment—same light/dark condition with 6-hour sleep deprivation after the first 48 hours). Sleep deprivation was performed by introducing novel objects in the home cage of the animal and/or by gentle touch. All data was analyzed in 4-second epochs (the total number of epochs per subject was 21,600). The range 0.25–50 Hz was partitioned into 5 frequency bands: Delta (0.25–5 Hz), Theta (5–9 Hz), Alpha (9–12 Hz), Beta (12–20 Hz), and Gamma (20–50 Hz). Each epoch was subject to a fast Fourier transformation (FFT) with 0.48-Hz resolution using the Hanning window method. The EMG integral was exported as a measure of the muscular activity. Semiautomatic sleep scoring to annotate the 3 sleep stages (wakefulness, NREM sleep, REM sleep) was performed using the SleepSign software followed by visual inspection and correction by experts. This hand labeling was used as ground truth to better characterize our experiments. Epochs associated with artefacts (i.e., 6.74% of the dataset in the first experiment, 0.835% in the second experiment—first 24 hours of baseline; 0.655% in the third experiment—second 24 hours of baseline plus 18 hours of recovery) were excluded from the analysis.</p>
<p>The resulting visual scoring statistics in terms of the 3 sleep stages were as follows:</p>
<list list-type="bullet">
<list-item><p>Experiment 1: wakefulness = 56.3%, NREM sleep = 38.09%, REM sleep = 5.61%;</p></list-item>
<list-item><p>Experiment 2: wakefulness = 57.17%, NREM sleep = 37.77%, REM sleep = 5.06%;</p></list-item>
<list-item><p>Experiment 3 (i.e., 24 hours of baseline plus 18 hours of recovery after 6 hours of sleep deprivation): wakefulness = 54.3%, NREM sleep = 40.38%, REM sleep = 5.32%.</p></list-item>
</list>
</sec>
<sec id="sec014">
<title>Data preprocessing</title>
<p>A common issue to address in multisubject analysis is the variability across subjects’ physiology, which is reflected in different ranges of EEG/EMG signal for different subjects. This issue can be solved with a proper preprocessing of data. In our case, each individual dataset was preprocessed separately by first computing all possible ratios between the 5 EEG bands, because we observed that using the ratios instead of bands’ power produces less variability across subjects. A full representation of the EEG spectra is plotted in <xref ref-type="supplementary-material" rid="pbio.2003663.s006">S6 Fig</xref>, showing the classical band distribution across NREM/REM stages, as determined by the manual scoring. Similarly, <xref ref-type="supplementary-material" rid="pbio.2003663.s007">S7 Fig</xref> shows examples of the power bands of some latent states compared to those of the known sleep stages they are associated with. From this comparison, it can be observed that the latent states show a more compact representation of specific structure in the data than the standard sleep stages; hence, they are more specific concerning the microstructure that can be found in the data. Since our data are log-Gaussian, to deal with the skewness in the features’ distributions, we used the natural logarithm, obtaining more bell-shaped distributions [<xref ref-type="bibr" rid="pbio.2003663.ref018">18</xref>] that facilitate the modeling process performed by the mcRBM. The zero-mean normalization was further applied to each single feature to make all the subjects comparable.</p>
</sec>
<sec id="sec015" sec-type="materials|methods">
<title>Modeling</title>
<p>We seek for modes in the input data distribution by modeling the joint distribution of the input variables (ratios between EEG bands and EMG) using the mcRBM [<xref ref-type="bibr" rid="pbio.2003663.ref008">8</xref>]. The mcRBM is a probabilistic energy-based graphical model consisting of 2 fully connected layers of stochastic random variables (also called units): a layer of visible variables representing the observed data (visible units, <italic>v</italic>) and a layer of latent variables (hidden units, <italic>h</italic>) that capture dependencies between the visible ones (see <xref ref-type="fig" rid="pbio.2003663.g008">Fig 8</xref> for an illustration).</p>
<fig id="pbio.2003663.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2003663.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Graphical model associated to the RBM.</title>
<p>The visible variables are represented by <italic>v</italic> (in our case, the ratios between the EEG frequency bands and the EMG), <italic>h</italic> are the latent variables, and <italic>w</italic> are the weights on the undirected connections between visible and hidden units. EEG, electroencephalography; EMG, electromyography; RBM, restricted Boltzmann machine.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.g008" xlink:type="simple"/>
</fig>
<p>The advantage of using the mcRBM for this task is related to its effectiveness in modeling real-valued Gaussian distributed data, together with the ability to exploit the correlations between the input variables. Another important feature making the selected model more suitable than other variants of restricted Boltzmann machines (RBMs) is the fact that its latent variables are divided into 2 different sets (see section mcRBM for more details regarding the model). One of these sets ({<italic>h</italic><sub>1</sub>, …, <italic>h</italic><sub><italic>m</italic></sub>}) is used to model the mean value of the input variables, while the other one ({<italic>h</italic><sub><italic>m</italic>+1</sub>, …, <italic>h</italic><sub><italic>m+c</italic></sub>}) is thought to be for explicitly modeling their covariance. This second set of latent variables allows for a better fitting of the data distribution presenting dependencies between input variables than what can be achieved with simpler models (e.g., Gaussian RBMs).</p>
<p>Once the model is trained, its bipartite graph structure allows for representing regularities in the observed input variables through the inferred values of the latent binary variables. In other words, the model can be used to generate a set of latent representations (the states of the inferred hidden variables) for the observed EEG/EMG data. Indeed, the model processes each input vector (corresponding to one sample of the dataset—in our case, one 4-second epoch), generating its related latent representation consisting of a series of binary values according to the probability of each single latent variable to be active.</p>
<p>Notably, in this Bayesian framework, the observed variables are approximately jointly Gaussian distributed [<xref ref-type="bibr" rid="pbio.2003663.ref008">8</xref>], given the latent ones, with the mean and covariance jointly defined by the specific values of latent variables and model parameters (see Eqs <xref ref-type="disp-formula" rid="pbio.2003663.e006">6</xref> and <xref ref-type="disp-formula" rid="pbio.2003663.e007">7</xref>). This means that each single latent configuration is associated with one mode in the joint distribution of the input variables, reflecting the regularities in the data. Hence, one latent representation may be considered a model representation of a sleep or a wakefulness substage.</p>
<p>In each of the 2 experiments performed in this study, a single mcRBM was used to model the joint distribution of the EEG ratios and the EMG. After training the model, the latent states of the 2 sets of hidden units were inferred according to Eqs <xref ref-type="disp-formula" rid="pbio.2003663.e004">4</xref> and <xref ref-type="disp-formula" rid="pbio.2003663.e005">5</xref>.</p>
<p>The size of the mcRBM (the number of its latent variables) was set after a series of validation trials in which we “calibrated” the model to the problem at hand. We observed that having too few hidden units results in a very small number of fuzzy clusters, while, as expected, the size escalation leads to a higher computational cost. We also realized that there is a certain number of hidden units, beyond which there is no real advantage in increasing the network size, since they remain inactive. We reached a good tradeoff between computational cost and quality of the results (i.e., significantly high MI, easy interpretability of visible data distributions, good performance in groups’ discrimination, etc.) using 11 hidden covariance units (<italic>h</italic><sub><italic>c</italic></sub>), 11 visible-to-hidden covariance factors, and 10 hidden mean units (<italic>h</italic><sub><italic>m</italic></sub>). Similarly, all the other parameters were set after a series of trials, taking into account the average quality of the results. Finally, the models were trained on GPU over minibatches of 256 data points with learning rate set to 10<sup>−2</sup>.</p>
</sec>
<sec id="sec016">
<title>mcRBM</title>
<p>Like all RBM models, the mcRBM [<xref ref-type="bibr" rid="pbio.2003663.ref008">8</xref>] is a probabilistic energy-based graphical model with a bipartite undirected graph structure, which consists of 2 fully connected layers of stochastic random variables (also called units): a layer of visible variables representing the observed data (visible units, <italic>v</italic>), and a layer of latent variables (hidden units, <italic>h</italic>) that capture dependencies between the visible ones. Unlike the standard RBM models, the mcRBM has 2 groups of hidden units: mean units (<italic>h</italic><sub><italic>m</italic></sub>) that model the mean of the input elements and precision units (<italic>h</italic><sub><italic>c</italic></sub>) that represent pairwise dependencies between the visible variables, modeling their covariance structure (see <xref ref-type="fig" rid="pbio.2003663.g009">Fig 9</xref> for an illustration).</p>
<fig id="pbio.2003663.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2003663.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Graphical model associated with the mcRBM.</title>
<p><italic>v</italic> represents the visible variables (in our case, the EEG frequency bands and the EMG), <italic>h</italic><sup><italic>m</italic></sup> the latent variables modeling the mean of variables <italic>v</italic>, and <italic>h</italic><sup><italic>c</italic></sup> those modeling their covariance. <italic>F</italic> is the number of factors. <italic>W</italic> is the 2D matrix of the weights on the undirected connections between <italic>v</italic> and <italic>h</italic><sup><italic>m</italic></sup> variables. <italic>C</italic> is the weight matrix of the connections from the <italic>v</italic> variables to the factors (<italic>F</italic>). <italic>P</italic> is the weight matrix of the connections from the factors (<italic>F</italic>) to the <italic>h</italic><sub><italic>c</italic></sub>. EEG, electroencephalography; EMG, electromyography; mcRBM, mean-covariance restricted Boltzmann machine.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.g009" xlink:type="simple"/>
</fig>
<p>Due to the absence of connections between the variables within the layers, the variables of a layer are independent of each other, given the variables of the other layer. The model is defined in terms of an energy function that is given by the sum of the energy functions of the 2 groups of variables:
<disp-formula id="pbio.2003663.e001">
<alternatives>
<graphic id="pbio.2003663.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2003663.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula></p>
<p>The energy function of the precision variables <italic>E</italic><sub><italic>c</italic></sub> defines a zero-mean Gaussian distribution over the visible variables, while adding the second energy term <italic>E</italic><sub><italic>m</italic></sub> allows the mcRBM to produce conditional distributions over the visible units having nonzero means.</p>
<p><italic>E</italic><sub><italic>c</italic></sub> is defined as follows:
<disp-formula id="pbio.2003663.e002">
<alternatives>
<graphic id="pbio.2003663.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2003663.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="normal">C</mml:mi><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
in which <italic>C</italic> is the weight matrix from the visible (<italic>v</italic>) units to the factors (<italic>F</italic>), <italic>P</italic> is a weight matrix with nonpositive entries for connections from the factors (<italic>F</italic>) to the hidden covariance units (<italic>h</italic><sub><italic>c</italic></sub>), and <italic>d</italic> is the <italic>h</italic><sub><italic>c</italic></sub> bias vector. <italic>P</italic> is constrained to have nonpositive entries in order to avoid having a model that assigns larger and larger probabilities (more negative energies) to larger and larger inputs. To control great disparity in the input features and make the model more robust, we used the normalized version of <xref ref-type="disp-formula" rid="pbio.2003663.e002">Eq 2</xref> [<xref ref-type="bibr" rid="pbio.2003663.ref008">8</xref>].</p>
<p>The energy function of mean variables <italic>E</italic><sub><italic>m</italic></sub> is given by:
<disp-formula id="pbio.2003663.e003">
<alternatives>
<graphic id="pbio.2003663.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2003663.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mspace width="1pt"/><mml:mo>-</mml:mo><mml:mspace width="1pt"/><mml:mi mathvariant="normal">b</mml:mi><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mspace width="1pt"/><mml:mo>-</mml:mo><mml:mspace width="1pt"/><mml:mi mathvariant="normal">b</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="normal">W</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
with <italic>W</italic> denoting the direct connections from the hidden mean units (<italic>h</italic><sub><italic>m</italic></sub>) to the visible ones (<italic>v</italic>), <italic>b</italic> being the visible bias, and <italic>c</italic> being the hidden mean bias.</p>
<p>After the training process, the model allows us to infer the states of its latent variables given the observed data. Given a training sample, the binary states of the <italic>h</italic><sub><italic>c</italic></sub> units can be inferred according to the following conditional distribution:
<disp-formula id="pbio.2003663.e004">
<alternatives>
<graphic id="pbio.2003663.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2003663.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>σ</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="normal">C</mml:mi><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
in which σ(x) = 1 / (1 + exp(-x)) is the logistic function, while the states of <italic>h</italic><sub><italic>m</italic></sub> units can be inferred according to the following conditional distribution:
<disp-formula id="pbio.2003663.e005">
<alternatives>
<graphic id="pbio.2003663.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2003663.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>σ</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">W</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula></p>
<p>Conditioning on the latent variables, the resulting distribution over the visible ones is approximately Gaussian, which depends on both the hidden covariance and hidden mean latent states and is given by:
<disp-formula id="pbio.2003663.e006">
<alternatives>
<graphic id="pbio.2003663.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2003663.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="1pt"/><mml:mo>∝</mml:mo><mml:mspace width="1pt"/><mml:mi mathvariant="normal">N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi mathvariant="normal">W</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
in which <italic>Σ</italic> is given by:
<disp-formula id="pbio.2003663.e007">
<alternatives>
<graphic id="pbio.2003663.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2003663.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula></p>
</sec>
<sec id="sec017">
<title>Entropy and MI</title>
<p>To evaluate how well the model fits the observed data in our experiments, we analyzed how informative the learnt latent states are about the stages of wakefulness, NREM sleep, and REM sleep, as defined by the manual scoring. Since each latent state corresponds to a discrete probability distribution over the 3 manually scored stages, the informativeness we want to measure can be expressed in terms of entropy and MI.</p>
<p>Entropy [<xref ref-type="bibr" rid="pbio.2003663.ref014">14</xref>] is a measure of the uncertainty of a random variable and is defined by:
<disp-formula id="pbio.2003663.e008">
<alternatives>
<graphic id="pbio.2003663.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2003663.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">y</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
in which Y corresponds to the set of the known 3 sleep stages (wakefulness, NREM sleep, and REM sleep), while p<sub>L</sub>(y) is the probability of each of these 3 stages to appear in each latent state (hopefully, for each latent state, only one of the sleep stages will have a high probability).</p>
<p>MI [<xref ref-type="bibr" rid="pbio.2003663.ref014">14</xref>] is a measure of the amount of information that one random variable contains about another random variable. In our case, we would like to see how informative the latent states X are about the 3 sleep stages Y. The MI I(X;Y) is the relative entropy between the joint distribution and the product distribution p(x)p(y):
<disp-formula id="pbio.2003663.e009">
<alternatives>
<graphic id="pbio.2003663.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2003663.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:mi mathvariant="normal">I</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
in which p(x,y) is the joint probability of latent state x and sleep stage y, p(x) is the probability of latent state x, and p(y) is the probability of sleep stage y.</p>
<p>Finally, the NMI is computed as follows:
<disp-formula id="pbio.2003663.e010">
<alternatives>
<graphic id="pbio.2003663.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2003663.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula></p>
<p>NMI (I<sub>n</sub>) is expressed as a real number in the range [0, 1], allowing us to compare it to its theoretical upper bound (i.e., which is equal to 1 when there is a perfect correlation between the 2 variables).</p>
</sec>
<sec id="sec018">
<title>Transition probabilities graph</title>
<p>Transitions between sleep stages can provide additional information regarding the structure of sleep in 24 hours. For this reason, we analyzed the transition probabilities between the observed latent states, which were computed and summarized in a squared transition probabilities matrix. The matrix was visualized as a graph whose nodes are the latent states and edges are the transitions between them. The weight of each edge is the probability of the corresponding transition. We used the ForceAtlas2 [<xref ref-type="bibr" rid="pbio.2003663.ref015">15</xref>] algorithm to cluster the network. Briefly, the algorithm randomly positions the nodes in a 2D space, which are then moved according to the attraction and repulsion forces among the nodes until the network reaches a state of equilibrium. These forces cause nodes with a big number of connections (hubs) to strongly repel each other and nodes connected with a heavily weighted edge (meaning a very probable transition) to attract each other [<xref ref-type="bibr" rid="pbio.2003663.ref015">15</xref>].</p>
</sec>
<sec id="sec019">
<title>Group discrimination</title>
<p>One question we addressed was whether we could use the discovered latent states to discriminate between different mouse genotypes. To do so, each subject was represented with a discrete probability distribution over the k = 1,2, …, <italic>n</italic> observed latent states, with P<sub>i</sub>(x<sub>k</sub>) being the probability of latent state k for subject i.</p>
<p>We then performed a classification with a leave-one-subject-out schema (train the model on <italic>N</italic> − 1 subjects and test over the left-out subject, iterating <italic>N</italic> times over all <italic>N</italic> subjects). We used an ensemble of classifiers based on a linear support vector machine (SVM), a linear discriminant analysis (LDA), and a 1-nearest neighbor (1-NN) to classify with a majority vote the left-out subject as belonging to 1 of the 3 groups.</p>
</sec>
</sec>
<sec id="sec020">
<title>Supporting information</title>
<supplementary-material id="pbio.2003663.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Examples of input data (bands’ ratios) distributions associated with 3 latent states corresponding with high probability to (A) REM sleep state and (B) wakefulness state.</title>
<p>Top: distributions of bands’ ratios along the input samples associated with the represented latent state are visualized in a box plot. Bottom: matrices describe for each latent state the pairwise covariance between all input variables. REM, rapid-eye-movement.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2003663.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Strains’ discrimination results with an ensemble classifier composed by an LDA, a linear SVM, and a 1-NN classifier.</title>
<p>Confusion matrix showing the detailed misclassification errors, in which we can see that only 2 subjects for each strain have been misclassified. Interestingly, we can also observe that both misclassified subjects of the mixed background strain have been classified as belonging to the C57BL/6J group. This can be due to the fact that C57BL/6J background and mixed background groups are genetically related. 1-NN, 1-nearest neighbor; LDA, linear discrimination analysis; SVM, support vector machine.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2003663.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Transition probabilities graphs of the 3 wild-type mouse models: (A) C57BL/6J; (B) CD1; (C) mixed background.</title>
<p>Nodes correspond to latent states, edges to transitions between them. Nodes’ size is related to their in-degree. Blue, green, and red nodes are associated with latent states mapping with high probability to wakefulness, NREM sleep, and REM sleep, respectively. Purple nodes correspond to substages that cannot be clearly associated to any of the known sleep states. Edges are weighted with the probability of the corresponding transition and colored according to the source node. Graphs were built using the ForceAtlas2 algorithm [<xref ref-type="bibr" rid="pbio.2003663.ref015">15</xref>,<xref ref-type="bibr" rid="pbio.2003663.ref016">16</xref>]. See also the interactive graphs available at <ext-link ext-link-type="uri" xlink:href="http://pavis.iit.it/datasets/mouse-sleep-analysis" xlink:type="simple">http://pavis.iit.it/datasets/mouse-sleep-analysis</ext-link>. NREM, non-rapid eye movement; REM, rapid eye movement.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2003663.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Daily profiles.</title>
<p>Examples of circadian patterns associated with (A) wakefulness, (B) NREM sleep, and (C) REM sleep. NREM, non-rapid eye movement; REM, rapid eye movement.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2003663.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Daily profiles of the 3 sleep stages according to the manual scoring.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2003663.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Box plots associated to bands’ power, representing the full EEG spectra for the 3 groups of wild-type mice (C57BL/6J, CD1, mixed background) in NREM and REM sleep.</title>
<p>EEG, electroencephalography; NREM, non-rapid eye movement; REM, rapid eye movement.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2003663.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Left: box plots of the bands’ power of the latent states in <xref ref-type="fig" rid="pbio.2003663.g003">Fig 3</xref> that are characteristic of the 3 genetic backgrounds (A—C57BL/6J, B—CD1, C—mixed background) compared to the box plots of the power of the known according to the GT stage (right) they are associated with.</title>
<p>GT, ground truth.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2003663.s008" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.s008" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Data associated with the statistics summarized in the bar plots in <xref ref-type="fig" rid="pbio.2003663.g005">Fig 5</xref>.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2003663.s009" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.s009" xlink:type="simple">
<label>S2 Data</label>
<caption>
<title>Data associated with the statistics summarized in the bar plots in <xref ref-type="fig" rid="pbio.2003663.g007">Fig 7A</xref>.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2003663.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pbio.2003663.s010" xlink:type="simple">
<label>S1 Checklist</label>
<caption>
<title>ARRIVE checklist.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We gratefully acknowledge the support of NVIDIA Corporation with the donation of the Titan X GPU used for the training of the mcRBM.</p>
</ack>
<glossary>
<title>Abbreviations</title>
<def-list>
<def-item><term>1-NN</term>
<def><p>1-nearest neighbor</p></def>
</def-item>
<def-item><term>EEG</term>
<def><p>electroencephalography</p></def>
</def-item>
<def-item><term>EMG</term>
<def><p>electromyography</p></def>
</def-item>
<def-item><term>FFT</term>
<def><p>fast Fourier transformation</p></def>
</def-item>
<def-item><term>LDA</term>
<def><p>linear discriminant analysis</p></def>
</def-item>
<def-item><term>mcRBM</term>
<def><p>mean-covariance restricted Boltzmann machine</p></def>
</def-item>
<def-item><term>MI</term>
<def><p>mutual information</p></def>
</def-item>
<def-item><term>NMI</term>
<def><p>normalized mutual information</p></def>
</def-item>
<def-item><term>NREM</term>
<def><p>non-rapid eye movement</p></def>
</def-item>
<def-item><term>RBM</term>
<def><p>restricted Boltzmann machine</p></def>
</def-item>
<def-item><term>REM</term>
<def><p>rapid eye movement</p></def>
</def-item>
<def-item><term>SVM</term>
<def><p>support vector machine</p></def>
</def-item>
<def-item><term>ZT</term>
<def><p>zeitgeber time</p></def>
</def-item>
</def-list>
</glossary>
<ref-list>
<title>References</title>
<ref id="pbio.2003663.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hobson</surname> <given-names>JA</given-names></name>. <article-title>A manual of standardized terminology, techniques and scoring system for sleep stages of human subjects</article-title>: <name name-style="western"><surname>Rechtschaffen</surname> <given-names>A.</given-names></name> and <name name-style="western"><surname>Kales</surname> <given-names>A.</given-names></name> (Editors).(Public Health Service, US Government Printing Office, Washington, DC, 1968, 58 p., $4.00). <source>Electroencephalography and clinical neurophysiology</source>. <year>1969</year> <month>Jun</month> <day>1</day>;<volume>26</volume>(<issue>6</issue>):<fpage>644</fpage>.</mixed-citation></ref>
<ref id="pbio.2003663.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Younes</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Raneri</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hanly</surname> <given-names>P</given-names></name>. <article-title>Staging sleep in polysomnograms: analysis of inter-scorer variability</article-title>. <source>Journal of clinical sleep medicine: JCSM: official publication of the American Academy of Sleep Medicine</source>. <year>2016</year> <month>Jun</month> <day>15</day>;<volume>12</volume>(<issue>6</issue>):<fpage>885</fpage>.</mixed-citation></ref>
<ref id="pbio.2003663.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rosenberg</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Van Hout</surname> <given-names>S</given-names></name>. <article-title>The American Academy of Sleep Medicine inter-scorer reliability program: sleep stage scoring</article-title>. <source>Journal of clinical sleep medicine: JCSM: official publication of the American Academy of Sleep Medicine</source>. <year>2013</year> <month>Jan</month> <day>15</day>;<volume>9</volume>(<issue>1</issue>):<fpage>81</fpage>.</mixed-citation></ref>
<ref id="pbio.2003663.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Penzel</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Fietze</surname> <given-names>I</given-names></name>. <article-title>Inter-scorer reliability between sleep centers can teach us what to improve in the scoring rules</article-title>. <source>Journal of Clinical Sleep Medicine</source>. <year>2013</year> <month>Jan</month> <day>15</day>;<volume>9</volume>(<issue>01</issue>):<fpage>89</fpage>–<lpage>91</lpage>.</mixed-citation></ref>
<ref id="pbio.2003663.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Müller</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gäbelein</surname> <given-names>WD</given-names></name>, <name name-style="western"><surname>Schulz</surname> <given-names>H</given-names></name>. <article-title>A taxonomic analysis of sleep stages</article-title>. <source>Sleep</source>. <year>2006</year> <month>Jul</month> <day>1</day>;<volume>29</volume>(<issue>7</issue>):<fpage>967</fpage>–<lpage>74</lpage>. <object-id pub-id-type="pmid">16895265</object-id></mixed-citation></ref>
<ref id="pbio.2003663.ref006"><label>6</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Koob</surname> <given-names>GF</given-names></name>, <name name-style="western"><surname>Le Moal</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>RF</given-names></name>. <source>Encyclopedia of behavioral neuroscience</source>. <publisher-name>Elsevier</publisher-name>; <year>2010</year> <month>Apr</month> <day>16</day>.</mixed-citation></ref>
<ref id="pbio.2003663.ref007"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Katsageorgiou VM, Zanotto M, Huang H, Ferretti V, Papaleo F, Sona D, et al. Unsupervised mouse behavior analysis: A data-driven study of mice interactions. In Pattern Recognition (ICPR), 2016 23rd International Conference on 2016 Dec 4 (pp. 925–930). IEEE.</mixed-citation></ref>
<ref id="pbio.2003663.ref008"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Ranzato MA, Hinton GE. Modeling pixel means and covariances using factorized third-order Boltzmann machines. In Computer Vision and Pattern Recognition (CVPR), 2010 IEEE Conference on 2010 Jun 13 (pp. 2551–2558). IEEE.</mixed-citation></ref>
<ref id="pbio.2003663.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gross</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Walsh</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Turakhia</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Booth</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Mashour</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Poe</surname> <given-names>GR</given-names></name>. <article-title>Open-source logic-based automated sleep scoring software using electrophysiological recordings in rats</article-title>. <source>Journal of neuroscience methods</source>. <year>2009</year> <month>Oct</month> <day>30</day>;<volume>184</volume>(<issue>1</issue>):<fpage>10</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jneumeth.2009.07.009" xlink:type="simple">10.1016/j.jneumeth.2009.07.009</ext-link></comment> <object-id pub-id-type="pmid">19615408</object-id></mixed-citation></ref>
<ref id="pbio.2003663.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kreuzer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Polta</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gapp</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schuler</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kochs</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Fenzl</surname> <given-names>T</given-names></name>. <article-title>Sleep scoring made easy—Semi-automated sleep analysis software and manual rescoring tools for basic sleep research in mice</article-title>. <source>MethodsX</source>. <year>2015</year> <month>Jan</month> <day>1</day>;<volume>2</volume>:<fpage>232</fpage>–<lpage>40</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.mex.2015.04.005" xlink:type="simple">10.1016/j.mex.2015.04.005</ext-link></comment> <object-id pub-id-type="pmid">26150993</object-id></mixed-citation></ref>
<ref id="pbio.2003663.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bastianini</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Berteotti</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gabrielli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Del Vecchio</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Amici</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Alexandre</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>SCOPRISM: a new algorithm for automatic sleep scoring in mice</article-title>. <source>Journal of neuroscience methods</source>. <year>2014</year> <month>Sep</month> <day>30</day>;<volume>235</volume>:<fpage>277</fpage>–<lpage>84</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jneumeth.2014.07.018" xlink:type="simple">10.1016/j.jneumeth.2014.07.018</ext-link></comment> <object-id pub-id-type="pmid">25092499</object-id></mixed-citation></ref>
<ref id="pbio.2003663.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rempe</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Clegern</surname> <given-names>WC</given-names></name>, <name name-style="western"><surname>Wisor</surname> <given-names>JP</given-names></name>. <article-title>An automated sleep-state classification algorithm for quantifying sleep timing and sleep-dependent dynamics of electroencephalographic and cerebral metabolic parameters</article-title>. <source>Nature and science of sleep</source>. <year>2015</year>;<volume>7</volume>:<fpage>85</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2147/NSS.S84548" xlink:type="simple">10.2147/NSS.S84548</ext-link></comment> <object-id pub-id-type="pmid">26366107</object-id></mixed-citation></ref>
<ref id="pbio.2003663.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balzani</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lassi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Maggi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sethi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Parsons</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Simon</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>The Zfhx3-mediated axis regulates sleep and interval timing in mice</article-title>. <source>Cell reports</source>. <year>2016</year> <month>Jul</month> <day>19</day>;<volume>16</volume>(<issue>3</issue>):<fpage>615</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.celrep.2016.06.017" xlink:type="simple">10.1016/j.celrep.2016.06.017</ext-link></comment> <object-id pub-id-type="pmid">27373158</object-id></mixed-citation></ref>
<ref id="pbio.2003663.ref014"><label>14</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Cover</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>JA</given-names></name>. <source>Elements of information theory</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>; <publisher-loc>Vancouver</publisher-loc>; <year>2012</year> <month>Nov</month> <day>28</day>.</mixed-citation></ref>
<ref id="pbio.2003663.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jacomy</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Venturini</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Heymann</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bastian</surname> <given-names>M</given-names></name>. <article-title>ForceAtlas2, a continuous graph layout algorithm for handy network visualization designed for the Gephi software</article-title>. <source>PloS ONE</source>. <year>2014</year> <month>Jun</month> <day>10</day>;<volume>9</volume>(<issue>6</issue>):<fpage>e98679</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0098679" xlink:type="simple">10.1371/journal.pone.0098679</ext-link></comment> <object-id pub-id-type="pmid">24914678</object-id></mixed-citation></ref>
<ref id="pbio.2003663.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bastian</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Heymann</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jacomy</surname> <given-names>M</given-names></name>. <article-title>Gephi: an open source software for exploring and manipulating networks</article-title>. <source>Icwsm</source>. <year>2009</year> <month>May</month> <day>17</day>;<volume>8</volume>:<fpage>361</fpage>–<lpage>2</lpage>.</mixed-citation></ref>
<ref id="pbio.2003663.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parsons</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Brancaccio</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sethi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Maywood</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Satija</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Edwards</surname> <given-names>JK</given-names></name>, <etal>et al</etal>. <article-title>The regulatory factor ZFHX3 modifies circadian function in SCN via an AT motif-driven axis</article-title>. <source>Cell</source>. <year>2015</year> <month>Jul</month> <day>30</day>;<volume>162</volume>(<issue>3</issue>):<fpage>607</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2015.06.060" xlink:type="simple">10.1016/j.cell.2015.06.060</ext-link></comment> <object-id pub-id-type="pmid">26232227</object-id></mixed-citation></ref>
<ref id="pbio.2003663.ref018"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Katsageorgiou VM, Lassi G, Tucci V, Murino V, Sona D. Sleep-stage scoring in mice: The influence of data pre-processing on a system’s performance. In Engineering in Medicine and Biology Society (EMBC), 2015 37th Annual International Conference of the IEEE 2015 Aug 25 (pp. 598–601). IEEE.</mixed-citation></ref>
</ref-list>
</back>
</article>