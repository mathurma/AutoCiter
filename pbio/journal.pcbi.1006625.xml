<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="other" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006625</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01696</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Perspective</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Epigenomics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Epigenomics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Plants</subject><subj-group><subject>Trees</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Chromosome biology</subject><subj-group><subject>Chromosomes</subject><subj-group><subject>Autosomes</subject><subj-group><subject>Chromosome pairs</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Chromosome biology</subject><subj-group><subject>Chromosomes</subject><subj-group><subject>Chromosome pairs</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject><subj-group><subject>Gene regulation</subject><subj-group><subject>Enhancer elements</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Research design</subject><subj-group><subject>Experimental design</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Machine learning</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Epigenetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Operator theory</subject><subj-group><subject>Kernel functions</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Local epigenomic state cannot discriminate interacting and non-interacting enhancer–promoter pairs with high accuracy</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Xi</surname>
<given-names>Wang</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9955-3809</contrib-id>
<name name-style="western">
<surname>Beer</surname>
<given-names>Michael A.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Biomedical Engineering John Hopkins, Baltimore, MD, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>McKusick-Nathans Institute of Genetic Medicine, Johns Hopkins University, Baltimore, MD, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Noble</surname>
<given-names>William Stafford</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Washington, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">mbeer@jhu.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>18</day>
<month>12</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<month>12</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>12</issue>
<elocation-id>e1006625</elocation-id>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Xi, Beer</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006625"/>
<abstract>
<p>We report an experimental design issue in recent machine learning formulations of the enhancer-promoter interaction problem arising from the fact that many enhancer-promoter pairs share features. Cross-fold validation schemes which do not correctly separate these feature sharing enhancer-promoter pairs into one test set report high accuracy, which is actually arising from high training set accuracy and a failure to properly evaluate generalization performance. Cross-fold validation schemes which properly segregate pairs with shared features show markedly reduced ability to predict enhancer-promoter interactions from epigenomic state. Parameter scans with multiple models indicate that local epigenomic features of individual pairs of enhancers and promoters cannot distinguish those pairs that interact from those which do with high accuracy, suggesting that additional information is required to predict enhancer-promoter interactions.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by NIH grants HG007348 and HG009380. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="3"/>
<table-count count="0"/>
<page-count count="7"/>
</counts>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>While quantitative modeling of cell-specific enhancer activity and variant impact is progressing rapidly, predicting the promoter and gene targets of enhancers remains challenging. We therefore read with great interest the paper by Whalen, et al,[<xref ref-type="bibr" rid="pcbi.1006625.ref001">1</xref>] which reported a computational model (TargetFinder) using epigenomic features that could predict enhancer-promoter (EP) interactions with high accuracy. In this brief note we report that because many EP pairs share features, the random cross-fold validation scheme used in Ref. 1 fails to properly evaluate generalization error and produces inflated test set accuracy. Proper cross-fold validation schemes predict EP interactions with much lower accuracy, due to the fact that many of the models used exhibit significantly lower performance on a reserved test set than on the training set data. If a test set is not fully reserved, these classifiers will fail to generalize to data outside the training data.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>Whalen, et al,[<xref ref-type="bibr" rid="pcbi.1006625.ref001">1</xref>] used an F1-score performance measure, F1 = 2P∙R/(P+R), where P = precision and R = recall, and reported that their average F1 across 6 cell lines was 0.83. This typically implies P,R&gt;0.8 and AUPRC,AUROC~0.9, and that most EP pairs are being correctly classified as interacting or not according the epigenomic state of the enhancer (E), promoter (P), and the intervening genomic interval, or window (W), between the enhancer and the promoter. Interestingly, they found that window features (W) were often selected as being most predictive in the model, and that lack of some epigenomic marks in the genomic interval were correlated with positive EP interactions, a compelling hypothesis. Curiously, this high performance was only achieved with gradient boosting using a very large number of trees, and not with a linear SVM, which achieved F1-score≈0.2. In the course of examining their training data to find direct evidence in support of this hypothesis, we noticed that partly due to the coarser resolution of the Hi-C interaction data, multiple contiguous enhancers often positively interact with the same promoter, but are all labelled independent positive EP interactions for training, even though they potentially share P and W features. If samples with identical features are not in the same cross-fold validation test set, these shared features could lead to incorrect evaluation of generalization performance. There are two distinct mechanisms by which features could be shared. The simplest is that many EP pairs share a promoter. In the K562 and GM12878 training data from Whalen, et al,[<xref ref-type="bibr" rid="pcbi.1006625.ref001">1</xref>] over 92% of EP pairs share a promoter with another EP pair and have a 2-fold or greater positive/negative class imbalance, and are thus subject to significant test set contamination through the shared P features. In <xref ref-type="fig" rid="pcbi.1006625.g001">Fig 1</xref> we show how many EP pairs share a promoter with a given number of positive and negative enhancers (positive and negative EP pairs connected to a single promoter). For clarity, this plot is repeated in <xref ref-type="supplementary-material" rid="pcbi.1006625.s001">S1 Fig</xref> showing the number of promoters and shared enhancers, but since these models are trained on EP pairs, the EP pair counts in <xref ref-type="fig" rid="pcbi.1006625.g001">Fig 1</xref> are relevant for understanding the degree of potential test set contamination. The greater the class imbalance, the more accurately this set of EP pairs can be predicted from training set promoter features alone. This is a serious problem for all pairs labelled red or blue in <xref ref-type="fig" rid="pcbi.1006625.g001">Fig 1</xref>. For example, at position (7,2) in <xref ref-type="fig" rid="pcbi.1006625.g001">Fig 1A</xref>, there are 27/(7+2) = 3 distinct promoters in the training data which each interact positively with 7 enhancers and negatively with two enhancers (two negative EP pairs) in the training data. When one of these positive pairs is in the training set, a specific but non-generalizable rule on that promoter’s features would predict the other pairs with accuracy of 78% when they are in the test-set. This potential problem becomes especially problematic for all EP pairs near the x and y axes in <xref ref-type="fig" rid="pcbi.1006625.g001">Fig 1</xref>, and most of the negative samples are particularly susceptible. The second mechanism by which EP pairs could share features is that the window (W) features are defined to be the epigenomic signals in the interval between the enhancer and promoter elements, so enhancers on the same side of the promoter can share window features, or more generally, any overlapping EP pair can share some common W signal features. We used cross-fold validation (CV) test sets sorted by chromosomal position so that no EP pairs with either P or W shared features could be in the same test set, and test set performance could be correctly evaluated. We also tested a cross-fold validation scheme where all EP pairs sharing a promoter were constrained to be in the same test set (promoter segregated). In this case, promoter features cannot lead to test set contamination, but window features can when using EPW features or W features to train the model.</p>
<fig id="pcbi.1006625.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006625.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Most of the EP pairs used for training in Ref. 1 share promoters and promoter features with multiple EP pairs.</title>
<p><bold>a)</bold> For cell line K562, and <bold>b)</bold> for cell line GM12878, for each promoter we show the number of positive and negative EP pairs sharing a promoter. In <bold>a)</bold> for example, there are 27 interactions in position (7,2), which means three distinct promoters each interact positively with 7 enhancers and negatively with two enhancers in the training data. When the number of negative and positive EP pairs interacting with a promoter are imbalanced, they can be predicted correctly from training set promoter features. The blue interactions have a 2-fold or greater imbalance (pos&gt;neg) and the red interactions have a 2-fold or greater imbalance (neg&gt;pos), and both red and blue interactions (92% of the data) can lead to test set contamination by shared promoter features.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006625.g001" xlink:type="simple"/>
</fig>
<p>We reproduced the published results from TargetFinder using the training data for the K562 cell line as shown in <xref ref-type="fig" rid="pcbi.1006625.g002">Fig 2A</xref>), and when we further observed that a nonlinear SVM (rbf with default C and <inline-formula id="pcbi.1006625.e001"><alternatives><graphic id="pcbi.1006625.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula>) could not achieve the high performance of gradient boosting, and that high test-set F1 is only achieved with 4000 trees, we suspected that test set contamination was important. When we instead used cross-fold validation (CV) test sets sorted by chromosomal position so that no EP pairs with shared features could be in the same test set, we found that test-set F1 dropped dramatically, as shown in <xref ref-type="fig" rid="pcbi.1006625.g002">Fig 2B</xref>. In fact, with sorted chromosomal CV test tests the predictive performance is only slightly better than random (F1 = 1/11 for this 1:20 ratio of positive to negative interactions). When using the promoter segregated CV test set scheme, P features cannot lead to test set contamination, but window features can, and do (EPW and W), when a gradient boosting classifier is used, <xref ref-type="fig" rid="pcbi.1006625.g002">Fig 2C</xref>. A similar but slightly less dramatic reduction in test-set predictive power is seen when removing or reducing the potential for test set contamination in the GM12878 cell line (<xref ref-type="fig" rid="pcbi.1006625.g002">Fig 2D</xref>, <xref ref-type="fig" rid="pcbi.1006625.g002">2E and 2F</xref>).</p>
<fig id="pcbi.1006625.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006625.g002</object-id>
<label>Fig 2</label>
<caption>
<title>The apparently high predictive power of epigenetic state to identify enhancer-promoter (EP) interactions is largely due to incorrect evaluation of generalization performance.</title>
<p><bold>a)</bold> For cell line K562, using training data from Ref. 1, with random assignment of positive and negative EP pairs to cross-fold validation (CV) test sets, a gradient boosting classifier with a very large number of trees (4000) is able to achieve F1&gt;0.8 with EPW or W features. <bold>b)</bold> If EP pairs with shared epigenomic features are properly forced to be in the same CV test set by sorting by chromosomal position, the predictive power is only slightly better than random, F1 = 1/11. <bold>c)</bold> If EP pairs sharing the same promoter are forced to be the same test sets, test set contamination through EP features is eliminated, but some can still occur through shared window features (W). <bold>d,e,f)</bold> A similar reduction in performance is observed when removing test set contamination in cell line GM12878 with sorted chromosomal CV test sets.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006625.g002" xlink:type="simple"/>
</fig>
<p>To examine generalization performance of these models detail, we directly compared training-set and test-set performance with multiple models, feature sets, and parameters, on both the random and chromosomally sorted CV test-set schemes. Test and training set F1 are shown in <xref ref-type="fig" rid="pcbi.1006625.g003">Fig 3A and 3B</xref> as the number of trees are varied for gradient boosting (used in Targetfinder) and random forest methods, using EPW features for K562. Training set F1 is much greater than test set F1 and increases with the number of trees. With random CV test sets this leads to an artificially inflated test set F1 = 0.84 for N<sub>tree</sub> = 4000 (as reported in Ref. 1 and similar methods), while with chromosomal CV test sets the correct test set performance is F1 = 0.13. Full scans of training and test set AUROC, AUPRC, and F1 performance metrics for gradient boosting and random forests are shown in <xref ref-type="supplementary-material" rid="pcbi.1006625.s002">S2 Fig</xref>, showing high training set performance with large number of trees and low test set performance for all tree models with chromosomal CV test sets.</p>
<fig id="pcbi.1006625.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006625.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Parameter variation in gradient boosting (GB, black), random forest (RF, blue), and SVM models show significantly higher training set accuracy than test set accuracy for large number of trees or large C and <inline-formula id="pcbi.1006625.e002"><alternatives><graphic id="pcbi.1006625.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:math></alternatives></inline-formula>.</title>
<p><bold>a)</bold> For cell line K562, with random CV test sets, test set performance appears high, but comparison with chromosomal CV test sets shows that this is due to test set contamination and failure to properly evaluate generalization performance. <bold>b)</bold> With chromosomal CV test sets, training set accuracy approaches 1 with large number of trees but now test set performance is correctly evaluated and test set F1 is very low. <bold>c)</bold> Nonlinear RBF SVM performance for incorrect random, and <bold>d)</bold> proper chromosomal CV test sets. For large <inline-formula id="pcbi.1006625.e003"><alternatives><graphic id="pcbi.1006625.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula>, SVM training set accuracy approaches 1 and test set accuracy is low. For typical default RBF parameters C = 1 and <inline-formula id="pcbi.1006625.e004"><alternatives><graphic id="pcbi.1006625.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula> = 1/n<sub>features</sub> (red) test set performance is still not significantly better than random.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006625.g003" xlink:type="simple"/>
</fig>
<p>We next varied parameters for the nonlinear RBF SVM model. In the RBF SVM the key parameters are C, which controls the weighting for misclassification error, and <inline-formula id="pcbi.1006625.e005"><alternatives><graphic id="pcbi.1006625.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula>, which describes the scale of the RBF kernel function and thus controls the smoothness of the decision boundary. For large C and <inline-formula id="pcbi.1006625.e006"><alternatives><graphic id="pcbi.1006625.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula> the SVM is able to fit the training data with a convoluted decision boundary. The training and test set F1 of the RBF SVM are shown in <xref ref-type="fig" rid="pcbi.1006625.g003">Fig 3C and 3D</xref> for C = 1 and C = 1000 as <inline-formula id="pcbi.1006625.e007"><alternatives><graphic id="pcbi.1006625.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula> is varied, and as expected, training set F1 approaches 1 for large <inline-formula id="pcbi.1006625.e008"><alternatives><graphic id="pcbi.1006625.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula>. The default sklearn package defaults for the rbf SVM are C = 1 and <inline-formula id="pcbi.1006625.e009"><alternatives><graphic id="pcbi.1006625.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula><sub>features</sub>. For EPW, EP, and W feature sets n<sub>features</sub> = (408, 272, and 136), so the default RBF SVM parameters are in the regime where there is little difference between training and test set accuracy (red points in <xref ref-type="fig" rid="pcbi.1006625.g003">Fig 3C and 3D</xref>). Full test set and training set performance for C = 1 and C = 1000 are shown in <xref ref-type="supplementary-material" rid="pcbi.1006625.s003">S3 Fig</xref>, and test set F1 for a complete C and <inline-formula id="pcbi.1006625.e010"><alternatives><graphic id="pcbi.1006625.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula> grid scan is shown in <xref ref-type="supplementary-material" rid="pcbi.1006625.s004">S4 Fig</xref> for K562 and GM12878. SVM performance was slightly better for GM12878. Consistent with our results from the tree models, no choice of RBF SVM parameters or features yielded performance significantly better than random with proper chromosomal CV test sets.</p>
</sec>
<sec id="sec003" sec-type="conclusions">
<title>Discussion</title>
<p>We have shown that the high accuracy of TargetFinder[<xref ref-type="bibr" rid="pcbi.1006625.ref001">1</xref>] in predicting EP interactions is mostly due to improper evaluation of generalization performance. We consider it extremely likely that subsequent publications using similar or identical training data are also subject to this problem, and that reports of accurate predictive modelling of EP interactions from local epigenomic state should be re-evaluated.[<xref ref-type="bibr" rid="pcbi.1006625.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1006625.ref004">4</xref>] On the bright side, there is now considerable room for improvement in models of EP interactions. Our results showing that no model performs much better than random guessing strongly suggests that local EP (and W) epigenomic state features alone are insufficient to distinguish interacting and non-interacting EP pairs. We suspect that EP interactions indeed may be specified by epigenomic state, but that additional features need to be considered, which are distinguishable from the feature set used in Ref 1 by their “non-local” nature. These additional features may include relative genomic position, the presence or absence of competition or interactions between E or P elements, conformational constraints, or subtle epigenomic state differences between enhancers competing for the same promoter or multiple promoters. Finally, we note that the inability to correctly evaluate test set performance is likely to be less of a problem in approaches which learn interactions between larger scale domains in non-overlapping chromosomal bins.[<xref ref-type="bibr" rid="pcbi.1006625.ref005">5</xref>]</p>
</sec>
<sec id="sec004">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006625.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006625.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title/>
<p><bold>a)</bold> For cell line K562, and <bold>b)</bold> for cell line GM12878, we show the number of promoters with the specified number of positive and negative enhancers sharing a promoter. This is equivalent to <xref ref-type="fig" rid="pcbi.1006625.g001">Fig 1</xref> but counts promoters instead of EP pairs.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006625.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006625.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Training (dashed) and test set (solid) AUROC, AUPRC, and F1 performance for EPW, EP, and W feature sets and for random (top) and chromosomal (bottom) CV test sets using gradient boosting (GB, black) and random forest (RF, blue) methods, as number of trees is increased.</title>
<p>Training set accuracy is significantly larger than test set accuracy for large numbers of trees, and test set performance is near random for all models with correctly segregated chromosomal CV test sets.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006625.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006625.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Training (dashed) and test set (solid) AUROC, AUPRC, and F1 performance for EPW, EP, and W feature sets and for random (top) and chromosomal (bottom) CV test sets using a nonlinear RBF SVM model with C = 1 (black) and C = 100 (blue), as <inline-formula id="pcbi.1006625.e011"><alternatives><graphic id="pcbi.1006625.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula> is varied.</title>
<p>Training set accuracy is significantly greater than test set accuracy for large <inline-formula id="pcbi.1006625.e012"><alternatives><graphic id="pcbi.1006625.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula>, and test set performance is near random for all feature sets with properly segregated chromosomal CV test sets.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006625.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006625.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Test set F1 performance for nonlinear RBF SVM as C and <inline-formula id="pcbi.1006625.e013"><alternatives><graphic id="pcbi.1006625.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006625.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula> are varied in complete grid parameter scan.</title>
<p>For K562 performance is near random for chromosomal CV test sets for all parameter choices. For GM12878 F1 is only is slightly higher than random with chromosomal CV test sets.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1006625.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Whalen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Truty</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Pollard</surname> <given-names>KS</given-names></name> (<year>2016</year>) <article-title>Enhancer–promoter interactions are encoded by complex genomic signatures on looping chromatin</article-title>. <source>Nature Genetics</source> <volume>48</volume>: <fpage>488</fpage>–<lpage>496</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3539" xlink:type="simple">10.1038/ng.3539</ext-link></comment> <object-id pub-id-type="pmid">27064255</object-id></mixed-citation></ref>
<ref id="pcbi.1006625.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cao</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Anyansi</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Xiong</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>W</given-names></name>, <etal>et al</etal>. (<year>2017</year>) <article-title>Reconstruction of enhancer–target networks in 935 samples of human primary cells, tissues and cell lines</article-title>. <source>Nature Genetics</source> <volume>49</volume>: <fpage>1428</fpage>–<lpage>1436</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3950" xlink:type="simple">10.1038/ng.3950</ext-link></comment> <object-id pub-id-type="pmid">28869592</object-id></mixed-citation></ref>
<ref id="pcbi.1006625.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>J</given-names></name> (<year>2017</year>) <article-title>Exploiting sequence-based features for predicting enhancer–promoter interactions</article-title>. <source>Bioinformatics</source> <volume>33</volume>: <fpage>i252</fpage>–<lpage>i260</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btx257" xlink:type="simple">10.1093/bioinformatics/btx257</ext-link></comment> <object-id pub-id-type="pmid">28881991</object-id></mixed-citation></ref>
<ref id="pcbi.1006625.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Singh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Poczos</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>J</given-names></name> (<year>2016</year>) <article-title>Predicting Enhancer-Promoter Interaction from Genomic Sequence with Deep Neural Networks</article-title>. <source>bioRxiv</source> <volume>085241</volume> <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/085241" xlink:type="simple">10.1101/085241</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006625.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schreiber</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Libbrecht</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bilmes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Noble</surname> <given-names>W</given-names></name> (<year>2018</year>) <article-title>Nucleotide sequence and DNaseI sensitivity are predictive of 3D chromatin architecture</article-title>. <source>bioRxiv</source> <volume>103614</volume> <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/103614" xlink:type="simple">10.1101/103614</ext-link></comment></mixed-citation></ref>
</ref-list>
</back>
</article>