<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01049</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003270</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories>
<title-group>
<article-title>CAPE: An R Package for Combined Analysis of Pleiotropy and Epistasis</article-title>
<alt-title alt-title-type="running-head">CAPE: Software to Analyze Pleiotropy and Epistasis</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Tyler</surname><given-names>Anna L.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Lu</surname><given-names>Wei</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hendrick</surname><given-names>Justin J.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Philip</surname><given-names>Vivek M.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Carter</surname><given-names>Gregory W.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>The Jackson Laboratory, Bar Harbor, Maine, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Electrical and Computer Engineering, Duke University, Durham, North Carolina, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Gardner</surname><given-names>Paul P.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Canterbury, New Zealand</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">Greg.Carter@jax.org</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Analyzed the data: ALT VMP. Wrote the paper: ALT GWC. Designed and wrote the software: ALT WL JJH VMP GWC.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>10</month><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>24</day><month>10</month><year>2013</year></pub-date>
<volume>9</volume>
<issue>10</issue>
<elocation-id>e1003270</elocation-id>
<history>
<date date-type="received"><day>13</day><month>6</month><year>2013</year></date>
<date date-type="accepted"><day>15</day><month>8</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Tyler et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Contemporary genetic studies are revealing the genetic complexity of many traits in humans and model organisms. Two hallmarks of this complexity are epistasis, meaning gene-gene interaction, and pleiotropy, in which one gene affects multiple phenotypes. Understanding the genetic architecture of complex traits requires addressing these phenomena, but interpreting the biological significance of epistasis and pleiotropy is often difficult. While epistasis reveals dependencies between genetic variants, it is often unclear how the activity of one variant is specifically modifying the other. Epistasis found in one phenotypic context may disappear in another context, rendering the genetic interaction ambiguous. Pleiotropy can suggest either redundant phenotype measures or gene variants that affect multiple biological processes. Here we present an R package, R/cape, which addresses these interpretation ambiguities by implementing a novel method to generate predictive and interpretable genetic networks that influence quantitative phenotypes. R/cape integrates information from multiple related phenotypes to constrain models of epistasis, thereby enhancing the detection of interactions that simultaneously describe all phenotypes. The networks inferred by R/cape are readily interpretable in terms of directed influences that indicate suppressive and enhancing effects of individual genetic variants on other variants, which in turn account for the variance in quantitative traits. We demonstrate the utility of R/cape by analyzing a mouse backcross, thereby discovering novel epistatic interactions influencing phenotypes related to obesity and diabetes. R/cape is an easy-to-use, platform-independent R package and can be applied to data from both genetic screens and a variety of segregating populations including backcrosses, intercrosses, and natural populations. The package is freely available under the GPL-3 license at <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/cape" xlink:type="simple">http://cran.r-project.org/web/packages/cape</ext-link>.</p>
</abstract>
<funding-group><funding-statement>This work was supported by NIGMS grants K25 GM079404 and P50 GM076468, and NCI grant CA034196. JJH was supported by the Howard Hughes Medical Institute and the Hearst Endowment. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="5"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Software Article</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>Advances in genomic and phenotypic technologies have vastly expanded the scope of genetic studies. Multidimensional phenotyping and high density genotyping are routinely combined to produce highly detailed views of biological systems. Translating these data into predictive models of health and disease will require new analytical methods to understand how genetic variants combine to influence multiple phenotypes. Here we present an R-based software application to use the information in multiple phenotypes to interpret statistical epistasis. The method derives models of genetic interactions as quantitative variant-to-variant and variant-to-phenotype influences. By fitting models to multiple phenotypes simultaneously, the method constrains possibilities for how individual variants interact to affect each phenotype. The result is a directed network of quantitative, variant-to-variant influences that represent specific levels of suppression or enhancement (<xref ref-type="fig" rid="pcbi-1003270-g001">Figure 1</xref>). The application is suitable to data sets involving engineered genetic perturbations, genetic intercross populations, and natural outbred populations containing multiple common variants. We demonstrate R/cape here using data from a mouse backcross study <xref ref-type="bibr" rid="pcbi.1003270-Reifsnyder1">[1]</xref>.</p>
<fig id="pcbi-1003270-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003270.g001</object-id><label>Figure 1</label><caption>
<title>Overview of coefficient reparametrization for two phenotypes.</title>
<p>On the left, main effect and interaction parameters for two variants (<italic>var1</italic> and <italic>var2</italic>) are derived from pairwise regressions (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003270.e001" xlink:type="simple"/></inline-formula>). The interaction coefficients are reparametrized as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003270.e002" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003270.e003" xlink:type="simple"/></inline-formula> on the right, which describe variant-to-variant influences that fit both phenotypes via indirect associations. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003270.e004" xlink:type="simple"/></inline-formula> the source variant is <italic>var1</italic> and the target variant is <italic>var2</italic>, with the source and target reversed for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003270.e005" xlink:type="simple"/></inline-formula>. The intercept and possible covariate terms are not shown. Note the main effects (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003270.e006" xlink:type="simple"/></inline-formula>) are unchanged in the reparametrization.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003270.g001" position="float" xlink:type="simple"/></fig></sec><sec id="s3">
<title>Design and Implementation</title>
<p>R/cape is designed to detect and interpret pleiotropy and statistical epistasis. The user begins by loading their data in R/qtl format <xref ref-type="bibr" rid="pcbi.1003270-Broman1">[2]</xref>. Briefly, this format encodes samples in rows and phenotype and genotype values in columns. R/cape requires a minimum of two quantitative phenotypes along with any potential covariates such as sex, lineage, or experimental treatment. The user identifies the potential covariates that are thereafter coded as genetic markers. These covariates can subsequently be included in the interaction analysis, following the same procedure as any marker. The phenotypes should exhibit limited pleiotropy, with some shared QTL but incomplete correlation, and be involved in the same high-level biological process (e.g. metabolism). Complex traits with moderate Pearson correlation (0.4≤|<italic>r</italic>|≤0.8) are ideal.</p>
<p>To maximize linear independence of phenotypes, R/cape by default performs singular value decomposition (SVD) on two or more selected phenotypes to derive eigentraits (ETs). R/cape includes functions to visualize the percent variance accounted for by each ET as well as their individual contributions to the phenotypes, thereby aiding the selection of ETs on which subsequent analysis should be performed. <xref ref-type="fig" rid="pcbi-1003270-g002">Figure 2A</xref> shows the ET decomposition of the example data set (<xref ref-type="sec" rid="s4">Results</xref>). By default R/cape selects the first two ETs, which typically contain the most relevant phenotypic variation, and in this example we used the default settings. For very high-dimensional phenotype data it is possible to analyze up to 12 ETs. It should be noted, however, that while increasing the number of ETs increases the information available to the algorithm, the additional information will likely contain components that may be difficult to consistently fit with single pair-wise models (<xref ref-type="fig" rid="pcbi-1003270-g001">Figure 1</xref>). The addition of more ETs that represent either biological signal or experimental noise will potentially reduce the significance of directed genetic interactions, as was found in a study of interacting variants that affected multiple patterns of global gene expression <xref ref-type="bibr" rid="pcbi.1003270-Carter1">[3]</xref>.</p>
<fig id="pcbi-1003270-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003270.g002</object-id><label>Figure 2</label><caption>
<title>Overview of R/cape workflow and visualization tools using example data <xref ref-type="bibr" rid="pcbi.1003270-Reifsnyder1">[1]</xref>.</title>
<p>(A) Phenotypes are first decomposed into orthogonal eigentraits (ETs). Phenotype composition and global variance fraction are displayed for each ET, facilitating the selection of ETs for interaction analysis. In this study, the first two ETs were selected, which contained the correlated signal between all phenotypes and a divergence between phenotypes, respectively. (B) Pair-wise linear regression is next performed on each ET. Symmetric matrices of all marker pair interaction terms are displayed in matrix form, with gray and white bars along the axes to mark chromosome boundaries. The first two ETs for this study are shown. (C) Regression parameters are next reparametrized (<xref ref-type="fig" rid="pcbi-1003270-g001">Figure 1</xref>) to derive models of directed interactions between markers and from markers to phenotypes. In the adjacency matrix view (left), markers are designated as sources or targets of directed interactions, and marker-to-phenotype influences are in the rightmost columns. Only variants with significant main effect or interaction are shown, and gray dots mark pairs that were not included in the model due to linkage disequilibrium. In the network view (right), arrows are directed from source to target marker positions across all chromosomes. Red arrows indicate suppressive (negative) interactions. Main effects are represented below the variants with green indicating an effect that increases phenotype and gray indicating no significant main effect on phenotype.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003270.g002" position="float" xlink:type="simple"/></fig>
<p>After ET selection, the user performs a genome-wide single-variant scan to assess the association of each individual marker. Since very strong main-effect markers can obscure interactions between other marker pairs, the user can assign covariates for the pair-scans that follow. The single-variant scan can also be used to specify marker pairs to test for interactions. The default setting is to test all possible pairs that are not in linkage disequilibrium. However, for data sets with a large number of markers, a subset of loci can be selected based on single-locus significance. Pair-scans are performed for each ET by multivariate linear regression, with an intercept, covariates, main effects, and interaction term for each pair of markers. Interaction (epistasis) coefficients from each ET can be plotted as shown in <xref ref-type="fig" rid="pcbi-1003270-g002">Figure 2B</xref>.</p>
<p>The regression coefficients are the basis for the R/cape reparametrization that determines variant-to-variant influences (<xref ref-type="fig" rid="pcbi-1003270-g001">Figure 1</xref>). Main effects coefficients from the pair-scans constitute the variant-to-phenotype influences <xref ref-type="bibr" rid="pcbi.1003270-Carter1">[3]</xref>. For two ETs, the reparametrization is exact and the fit residuals are unchanged. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003270.e007" xlink:type="simple"/></inline-formula> ETs, the <italic>N</italic> interaction coefficients are dimensionally reduced to two variant-to-variant influences (<xref ref-type="fig" rid="pcbi-1003270-g001">Figure 1</xref>) <xref ref-type="bibr" rid="pcbi.1003270-Carter1">[3]</xref>. Significance is determined by standardized effect size, with thresholds estimated by permutation tests. Correction of p-values for multiple testing is implemented by the Holm step-down procedure <xref ref-type="bibr" rid="pcbi.1003270-Holm1">[4]</xref>, false discovery rate (FDR) <xref ref-type="bibr" rid="pcbi.1003270-Benjamini1">[5]</xref>, or local false discovery rate (lFDR) <xref ref-type="bibr" rid="pcbi.1003270-Liao1">[6]</xref>. Null distributions are constructed by pooling all standardized effects from each permutation, with separate distributions for variant-to-variant and variant-to-phenotype distributions. This pooling procedure saves substantial computational effort and produces significance estimates indistinguishable from estimates based on distinct null distributions for every individual parameter. The final result is a directed network indicating how “source” variants influence “target” variants and how variants influence phenotypes. This directed network is represented by an asymmetric adjacency matrix with source variants in rows and target variants and phenotypes in columns. This matrix can be visualized to help identify patterns in variant-variant influences or plotted as a network (<xref ref-type="fig" rid="pcbi-1003270-g002">Figure 2C</xref>) with directed interactions plotted as arrows and main effects plotted as colored bars below the chromosomes. In the network, green and red denote positive and negative values, respectively.</p>
</sec><sec id="s4">
<title>Results</title>
<p>To demonstrate the use and capabilities of R/cape, we analyzed a mouse study of obesity and type 2 diabetes <xref ref-type="bibr" rid="pcbi.1003270-Reifsnyder1">[1]</xref>. This study backrossed the diabetes-prone New Zealand Obese (NZO) inbred mouse with the Non-Obese, Non-diabetic (NON) inbred strain. Body weight, serum glucose, and serum insulin were measured. All 203 male mice were genotyped at 83 autosomal microsatellite markers, with the presence of a NZO allele coded as the perturbation at each locus. Maternal obesity, here coded as “mom,” was used as a covariate and assessed for interactions with genetic variants. The data provided a system in which R/cape analysis could exploit both the identical and distinct factors contributing to obesity, glucose levels, and insulin regulation in deriving a polygenic model <xref ref-type="bibr" rid="pcbi.1003270-Permutt1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003270-Burcelin1">[8]</xref>. After normalization, all phenotypes exhibited Pearson correlation coefficients around 0.6.</p>
<p>Phenotypes were decomposed into uncorrelated eigentraits (ETs). Phenotype contributions to each ET are shown in <xref ref-type="fig" rid="pcbi-1003270-g002">Figure 2A</xref>. The first ET represented the common, correlated signal for all traits, while the second encodes the divergence between plasma glucose and body weight. These two ET were selected for R/cape analysis, and their pair-wise regression results are shown in <xref ref-type="fig" rid="pcbi-1003270-g002">Figure 2B</xref>. These symmetric, marker pair regression results were reparametrized (<xref ref-type="fig" rid="pcbi-1003270-g001">Figure 1</xref>) to derive directed influences from source markers to target markers (<xref ref-type="fig" rid="pcbi-1003270-g002">Figure 2C</xref>).</p>
<p>R/cape analysis was then performed on the selected ETs. Two markers were excluded due to full redundancy with adjacent markers and individual pairs with substantial linkage disequilibrium (LD) were not tested, defined as fewer than six instances of the four possible pair-wise genotypes at the two loci. These pairs are marked by gray dots in the pairscan results (<xref ref-type="fig" rid="pcbi-1003270-g002">Figure 2C</xref>). We identified both influences of markers on phenotypes as well as directed interactions between markers using a false discovery rate of 0.01. NZO variants on multiple chromosomes show positive effects on all traits (<xref ref-type="fig" rid="pcbi-1003270-g002">Figure 2C</xref>), denoting increased body weight and diabetes risk. The effects between alleles, on the other hand, are uniformly negative, which may indicate canalization of these traits in the inbred founder lines. Maternal obesity was found to suppress the effects of markers on Chromosome 15, and a marker on Chromosome 2 suppressed the effects of a marker on Chromosome 18. In the latter interaction, neither marker had an individual main effect, although the Chromosome 18 marker has a marginally significant effect (q = 0.018) on body weight that is completely suppressed by the Chromosome 2 marker. NZO variants in a region on Chromosome 1 increased all three phenotypes individually and were the hub of a small epistatic network suppressing the effects of markers on Chromosomes 10 and 12.</p>
<p>The interaction between Chromosomes 1 and 12 is illustrative of the R/cape strategy (<xref ref-type="fig" rid="pcbi-1003270-g003">Figure 3</xref>). Although both loci have a positive effects on body weight, their joint effect is less than additive (<xref ref-type="fig" rid="pcbi-1003270-g003">Figure 3A</xref>, center plot). This suggests that one or both of the loci are suppressing the effect of the other, but is ambiguous about the direction of suppression. In contrast, only the Chromosome 1 locus has an effect on insulin and this effect is independent of the Chromosome 12 locus (<xref ref-type="fig" rid="pcbi-1003270-g003">Figure 3A</xref>, left plot). This second phenotype provides R/cape the information necessary to infer the directionality of the interaction from Chromosome 1 to 12, since a reversed interaction would imply epistasis for insulin along with body weight. Specifically, if the Chromosome 12 locus suppressed the Chromosome 1 locus effect, we would expect to see the solid line in the insulin plot to have a reduced slope, since the presence of heterozygosity at Chromosome 12 would reduce the effect of a heterozygous allele at Chromosome 1. This was not observed. R/cape thus provides a more stringent hypothesis for gene candidates in the two loci through the constraint of directional genetic effects.</p>
<fig id="pcbi-1003270-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003270.g003</object-id><label>Figure 3</label><caption>
<title>R/cape-derived interaction between Chromosome 1 and Chromosome 12.</title>
<p>(A) R/cape effect plots showing normalized phenotype values for each combination of the Chromosome 1 (D1Mit123) and Chromosome 12 (D12Mit150) genotypes. NON denotes a homozygous locus and Het denotes an NON/NZO heterozygote. Positive slopes correspond to Chromosome 1 effects, while differences between solid and dashed lines represent the Chromosome 12 effects. Positive and significant weight effects were detected for both loci, whereas effects on insulin were only significant for the Chromosome 1 marker. Neither locus had a significant effect on serum glucose. Significant epistasis was detected for weight, and appears as the convergence of solid and dashed lines for heterozygosity at the Chromosome 1 locus. Note that plotted data are not conditioned on maternal obesity, which was a covariate in the analysis. (B) Interaction network for variants on Chromosomes 1 and 12, extracted from <xref ref-type="fig" rid="pcbi-1003270-g002">Figure 2C</xref>, showing the significant suppressive interaction (red arrow) from the Chromosome 1 variant to the Chromosome 12 variant (gray circular nodes). Significant main effects (green arrows) link the source variants with the target phenotypes weight and insulin (square nodes labeled “I” and “W” respectively).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003270.g003" position="float" xlink:type="simple"/></fig>
<p>The interacting loci we detected were distinct from those reported in the original analysis <xref ref-type="bibr" rid="pcbi.1003270-Reifsnyder1">[1]</xref>, in which phenotypes were separately tested for evidence of interaction. The discrepancy is a result of R/cape integrating signals across multiple phenotypes. R/cape interactions may be of low significance for any single phenotype, and therefore not detected in the previous study. Furthermore, the integration strategy requires differential information across multiple phenotypes, so the instances of redundant epistasis reported in <xref ref-type="bibr" rid="pcbi.1003270-Reifsnyder1">[1]</xref> were not detected with R/cape. R/cape also uses permutation testing and conservative correction for multiple testing to limit the discovery of false positive interactions. Permutation testing in particular guards against false positives arising from linkage between markers.</p>
<p>By simultaneously anlayzing multiple phenotypes, R/cape can reveal complex interactions between genotype and phenotype not seen when examining phenotypes in isolation. While the original study was based on detecting loci involved in the composite phenotype “diabesity,” R/cape parses how genetic loci both jointly and distinctly affect diabetes and obesity. This is of interest to geneticists because, although these traits are correlated, not all obese individuals are diabetic and not all diabetic individuals are obese <xref ref-type="bibr" rid="pcbi.1003270-Permutt1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003270-Burcelin1">[8]</xref>. The effects of one locus can be direct or indirectly mediated by the genotype at a second locus, as mapped by our algorithm. Parsing how genetic factors directly and indirectly affect these phenotypes provides a clearer model of how certain loci are more relevant to the diabetic state. As genetic studies gain power through larger sample sizes, improved population design, and increased phenotype precision, the R/cape algorithm is designed to parse multiple genetic loci into interacting subnetworks of variants that differentially affect a number of related traits <xref ref-type="bibr" rid="pcbi.1003270-Carter2">[9]</xref>.</p>
<p>Together these findings illustrate how R/cape is designed to find interactions that simultaneously model all phenotypes under the assumption that interactions between variants across multiple contexts represent a single underlying interaction network. We note that in a large-scale, highly-powered study based on genetic interaction screens R/cape analysis yielded significant interactions for 55% of the interactions identified as significant using standard epistasis analysis <xref ref-type="bibr" rid="pcbi.1003270-Carter2">[9]</xref>. Thus we recommend users assess single-phenotype epistasis using functions in R/cape or in parallel analyses using tools such as R/qtl and R/qtlbim <xref ref-type="bibr" rid="pcbi.1003270-Yandell1">[10]</xref> as the results are expected to be somewhat complementary.</p>
</sec><sec id="s5">
<title>Availability and Future Directions</title>
<p>The R/cape package is freely available under the GPL-3 license at the Comprehensive R Archive Network (CRAN), <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/cape" xlink:type="simple">http://cran.r-project.org/web/packages/cape</ext-link>. The R platform and all R dependencies are similarly available from CRAN.</p>
<p>The time required to perform an R/cape analysis depends on multiple parameters including the number of markers, the number of phenotypes, and the amount of linkage between markers since linked marker pairs are not tested. Overall processor time is proportional to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003270.e008" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003270.e009" xlink:type="simple"/></inline-formula> is the number of markers tested and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003270.e010" xlink:type="simple"/></inline-formula> is the number of permutations performed. The analysis reported here used 83 markers and one covariate, generating 3463 pairs (after exclusion of markers in LD). Each pair was tested with 100 permutations. On an iMac with a 2.7 GHz Intel processor and 8 GB of memory the full analysis took 5.5 hours. Since permutation results are pooled to generate null distributions, preliminary analyses can be performed with fewer permutations in order to save substantial processing time. Optional limits are implemented for the number of pairs and permutations passed to the main analysis functions.</p>
<p>Future additions to R/cape will include advanced graphics capabilities and additional features to manage populations. We intend to augment the current graphic with scalable graphs. Application of the software to genome-wide association studies is currently possible but requires quantitative data and care in managing population structure. Corrections for sample relatedness are under development. Finally, we will expand allele encoding to address more than two alleles at each locus, based on precision genotyping or inferred haplotype probabilities. This will enable application of R/cape to data from the Collaborative Cross <xref ref-type="bibr" rid="pcbi.1003270-Churchill1">[11]</xref>, Diversity Outbred <xref ref-type="bibr" rid="pcbi.1003270-Svenson1">[12]</xref>, Heterogeneous Stock <xref ref-type="bibr" rid="pcbi.1003270-Talbot1">[13]</xref>, and similar resources.</p>
<p>In conclusion, R/cape is an efficient tool to represent genetic complexity in terms of models of variant action. The program will aid in the interpretation of epistasis without prior knowledge by providing a fast overview and hypothesis generation tool.</p>
</sec><sec id="s6">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003270.s001" mimetype="application/x-gzip" xlink:href="info:doi/10.1371/journal.pcbi.1003270.s001" position="float" xlink:type="simple"><label>Software S1</label><caption>
<p><bold>R/cape software package.</bold> Source code, documentation, test data, and an instructive vignette for R/cape.</p>
<p>(GZ)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank Robert Valenzuela and Mehmet Umut Çağlar for helpful comments and Charles Donnely for his contributions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003270-Reifsnyder1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reifsnyder</surname><given-names>PC</given-names></name> (<year>2000</year>) <article-title>Maternal Environment and Genotype Interact to Establish Diabesity in Mice</article-title>. <source>Genome Research</source> <volume>10</volume>: <fpage>1568</fpage>–<lpage>1578</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Broman1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Broman</surname><given-names>KW</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Sen</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Churchill</surname><given-names>GA</given-names></name> (<year>2003</year>) <article-title>R/qtl: QTL mapping in experimental crosses</article-title>. <source>Bioinformatics</source> <volume>19</volume>: <fpage>889</fpage>–<lpage>890</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Carter1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carter</surname><given-names>GW</given-names></name>, <name name-style="western"><surname>Hays</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Sherman</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Galitski</surname><given-names>T</given-names></name> (<year>2012</year>) <article-title>Use of pleiotropy to model genetic interactions in a population</article-title>. <source>PLoS Genetics</source> <volume>8</volume>: <fpage>e1003010</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Holm1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holm</surname><given-names>S</given-names></name> (<year>1979</year>) <article-title>A simple sequentially rejective multiple test procedure</article-title>. <source>Scandinavian Journal of Statistics</source> <volume>6</volume>: <fpage>65</fpage>–<lpage>70</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Benjamini1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benjamini</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Hochberg</surname><given-names>Y</given-names></name> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source> <volume>57</volume>: <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Liao1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liao</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Selvanayagam</surname><given-names>ZE</given-names></name>, <name name-style="western"><surname>Shih</surname><given-names>WJ</given-names></name> (<year>2004</year>) <article-title>A mixture model for estimating the local false discovery rate in DNA microarray analysis</article-title>. <source>Bioinformatics</source> <volume>20</volume>: <fpage>2694</fpage>–<lpage>2701</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Permutt1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Permutt</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Wasson</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Cox</surname><given-names>N</given-names></name> (<year>2005</year>) <article-title>Genetic epidemiology of diabetes</article-title>. <source>The Journal of Clinical Investigation</source> <volume>115</volume>: <fpage>1431</fpage>–<lpage>1439</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Burcelin1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Burcelin</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Crivelli</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Dacosta</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Roy-Tirelli</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Thorens</surname><given-names>B</given-names></name> (<year>2002</year>) <article-title>Heterogeneous metabolic adaptation of C57BL/6J mice to high-fat diet</article-title>. <source>American Journal of Physiology Endocrinology and Metabolism</source> <volume>282</volume>: <fpage>E834</fpage>–<lpage>42</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Carter2"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carter</surname><given-names>GW</given-names></name> (<year>2013</year>) <article-title>Inferring gene function and network organization in Drosophila signaling by combined analysis of pleiotropy and epistasis</article-title>. <source>G3: Genes|Genomes|Genetics</source> <volume>3</volume>: <fpage>807</fpage>–<lpage>814</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Yandell1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yandell</surname><given-names>BS</given-names></name>, <name name-style="western"><surname>Mehta</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Banerjee</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Shriner</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Venkataraman</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>R/qtlbim: QTL with Bayesian interval mapping in experimental crosses</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>641</fpage>–<lpage>643</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Churchill1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Churchill</surname><given-names>GA</given-names></name>, <name name-style="western"><surname>Airey</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Allayee</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Angel</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Attie</surname><given-names>AD</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>The collaborative cross, a community resource for the genetic analysis of complex traits</article-title>. <source>Nature Genetics</source> <volume>36</volume>: <fpage>1133</fpage>–<lpage>1137</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Svenson1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Svenson</surname><given-names>KL</given-names></name>, <name name-style="western"><surname>Gatti</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Valdar</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Welsh</surname><given-names>CE</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>High-resolution genetic mapping using the mouse diversity outbred population</article-title>. <source>Genetics</source> <volume>190</volume>: <fpage>437</fpage>–<lpage>447</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003270-Talbot1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Talbot</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>Nicod</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Cherny</surname><given-names>SS</given-names></name>, <name name-style="western"><surname>Fulker</surname><given-names>DW</given-names></name>, <name name-style="western"><surname>Collins</surname><given-names>AC</given-names></name>, <etal>et al</etal>. (<year>1999</year>) <article-title>High-resolution mapping of quantitative trait loci in outbred mice</article-title>. <source>Nature Genetics</source> <volume>21</volume>: <fpage>305</fpage>–<lpage>308</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>