<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-00838</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1007283</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>RNA structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>RNA</subject><subj-group><subject>RNA structure</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure prediction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure prediction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>RNA-binding proteins</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>RNA</subject><subj-group><subject>RNA sequences</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure networks</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure networks</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence motif analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Integrating thermodynamic and sequence contexts improves protein-RNA binding prediction</article-title>
<alt-title alt-title-type="running-head">Integrating thermodynamic and sequence contexts improves protein-RNA binding prediction</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Su</surname> <given-names>Yufeng</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7728-6412</contrib-id>
<name name-style="western">
<surname>Luo</surname> <given-names>Yunan</given-names></name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7214-5426</contrib-id>
<name name-style="western">
<surname>Zhao</surname> <given-names>Xiaoming</given-names></name>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Liu</surname> <given-names>Yang</given-names></name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1736-2978</contrib-id>
<name name-style="western">
<surname>Peng</surname> <given-names>Jian</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Computer Science, University of Illinois at Urbana-Champaign, Urbana, Illinois, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>School of Electronic Information and Electrical Engineering, Shanghai Jiao Tong University, Shanghai, China</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ay</surname> <given-names>Ferhat</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>La Jolla Institute for Allergy and Immunology, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">jianpeng@illinois.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>9</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>4</day>
<month>9</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>9</issue>
<elocation-id>e1007283</elocation-id>
<history>
<date date-type="received">
<day>28</day>
<month>5</month>
<year>2019</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>7</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Su et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1007283"/>
<abstract>
<p>Predicting RNA-binding protein (RBP) specificity is important for understanding gene expression regulation and RNA-mediated enzymatic processes. It is widely believed that RBP binding specificity is determined by both the sequence and structural contexts of RNAs. Existing approaches, including traditional machine learning algorithms and more recently, deep learning models, have been extensively applied to integrate RNA sequence and its predicted or experimental RNA structural probabilities for improving the accuracy of RBP binding prediction. Such models were trained mostly on the large-scale <italic>in vitro</italic> datasets, such as the RNAcompete dataset. However, in RNAcompete, most synthetic RNAs are unstructured, which makes machine learning methods not effectively extract RBP-binding structural preferences. Furthermore, RNA structure may be variable or multi-modal according to both theoretical and experimental evidence. In this work, we propose ThermoNet, a thermodynamic prediction model by integrating a new sequence-embedding convolutional neural network model over a thermodynamic ensemble of RNA secondary structures. First, the sequence-embedding convolutional neural network generalizes the existing k-mer based methods by jointly learning convolutional filters and k-mer embeddings to represent RNA sequence contexts. Second, the thermodynamic average of deep-learning predictions is able to explore structural variability and improves the prediction, especially for the structured RNAs. Extensive experiments demonstrate that our method significantly outperforms existing approaches, including RCK, DeepBind and several other recent state-of-the-art methods for predictions on both <italic>in vitro</italic> and <italic>in vivo</italic> data. The implementation of ThermoNet is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/suyufeng/ThermoNet" xlink:type="simple">https://github.com/suyufeng/ThermoNet</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>RNA-binding proteins (RBPs) play a key role in modulating various cellular processes, including transcription, alternative splicing, and translational regulation. Identifying protein-RNA interactions and the binding preferences of RBPs are critical to unraveling the mechanism of post-transcriptional gene regulation. In the current study, we present a computational approach that integrates both structure and sequence contexts for protein-RNA binding prediction. We propose to incorporate the structure information using a thermodynamic ensemble of secondary structures, which effectively identifies RBP-binding structural preferences, especially for structured RNAs. Our model is further empowered by a deep neural network that combines the sequence and structure information to achieve improved protein-RNA binding prediction. Extensive experiments on both <italic>in vitro</italic> and <italic>in vivo</italic> datasets demonstrate the superior performance of our method compared to several state-of-the-art approaches. This study suggests the great potential of our method as a practical tool for identifying novel protein-RNA interactions and binding sites of RBPs.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported in part by the NSF CAREER Award (to J.P.) and the CompGen Fellowship (to Y. Luo). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="0"/>
<page-count count="14"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-09-19</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The in vitro protein-RNA binding data is downloaded from <ext-link ext-link-type="uri" xlink:href="http://tools.genes.toronto.edu/deepbind/nbtcode/" xlink:type="simple">http://tools.genes.toronto.edu/deepbind/nbtcode/</ext-link>. The in vivo protein-RNA binding data is downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/mstrazar/iONMF" xlink:type="simple">https://github.com/mstrazar/iONMF</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>RNA-binding proteins (RBPs) modulate the processing of cellular RNAs, including their production, transportation, splicing, stability, translation, and degradation [<xref ref-type="bibr" rid="pcbi.1007283.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1007283.ref002">2</xref>]. There are more than 1,500 RBPs in the human genome which are identified with well-defined RNA-binding domains (RBDs) [<xref ref-type="bibr" rid="pcbi.1007283.ref003">3</xref>], including the RNA recognition motif (RRM) [<xref ref-type="bibr" rid="pcbi.1007283.ref004">4</xref>], the K-homology domain (KH) [<xref ref-type="bibr" rid="pcbi.1007283.ref004">4</xref>], and the C3H1 zinc-finger (ZF) domain [<xref ref-type="bibr" rid="pcbi.1007283.ref005">5</xref>]. Existing studies on different RNA binding domains indicate that their interaction specificities with RNAs are determined by various sequence- and/or structure-specific patterns. For example, sequence motifs on hairpins or loops are more accessible to many RBPs, while some RBPs, such as RBM22, RBM6 and PRR3, show a structural preference on bulged stems [<xref ref-type="bibr" rid="pcbi.1007283.ref006">6</xref>]. Understanding of the sequence/structure specificity of RNA-binding proteins is therefore critical for developing hypotheses and models of post-transcriptional gene regulation [<xref ref-type="bibr" rid="pcbi.1007283.ref007">7</xref>].</p>
<p><italic>In vitro</italic> and <italic>in vivo</italic> methods have been developed for determining RBP binding specificities. RNAcompete is a high-throughput <italic>in vitro</italic> assay that quantifies the relative affinity of a specific RBP to a pre-defined set of more than 240,000 short RNAs. In a recent work, more than 200 human RBPs are analyzed by RNAcompete, generating the first large-scale dataset of protein-RNA interaction measurements [<xref ref-type="bibr" rid="pcbi.1007283.ref008">8</xref>]. A major limitation of RNAcompete is that the designed RNAs are only 41nt long and not structurally stable, therefore the motifs identified by this approach are predominantly in short unstructured contexts. SELEX (systematic evolution of ligands by exponential selection) [<xref ref-type="bibr" rid="pcbi.1007283.ref009">9</xref>] iteratively selects a set of high-affinity RNA sequences from a large pool, similar to the evolutionary procedure used in optimization, which is generally biased or suffers from undersampling. Different from <italic>in vitro</italic> methods, high-throughput <italic>in vivo</italic> techniques have been developed to measure genome-wide RBP-RNA interactions in their cellular contexts. For example, CLIP-seq, RIP-seq and their variants [<xref ref-type="bibr" rid="pcbi.1007283.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007283.ref011">11</xref>] provide high-resolution protein-RNA binding sites. However, it is usually not easy to clearly derive binding motifs from these experiments, because of the existence of protein cofactors, technical artifacts, RNA folding, and high levels of noise or non-specific background. Therefore, learning algorithms for computational prediction of protein-RNA binding from <italic>in vitro</italic> data may be less affected by the noise and provide insights that can be generalized to <italic>in vivo</italic> data.</p>
<p>Different computational methods have been introduced to protein-RNA binding prediction. Traditionally, the sequence specificities of an RBP is most commonly modeled by position weight matrix (PWM) [<xref ref-type="bibr" rid="pcbi.1007283.ref012">12</xref>] or hidden Markov models, which are solely based on the biases or enrichments of nucleotides on the binding sites. Such models can be learned from a collection of RNA sequences with high binding affinities. To take RNA structure into consideration, MEMERIS [<xref ref-type="bibr" rid="pcbi.1007283.ref013">13</xref>] applies MEME [<xref ref-type="bibr" rid="pcbi.1007283.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1007283.ref015">15</xref>] to identify binding sites in unpaired loop regions. RNAcontext [<xref ref-type="bibr" rid="pcbi.1007283.ref016">16</xref>] learns a joint probabilistic model of both sequence and structure contexts. RCK [<xref ref-type="bibr" rid="pcbi.1007283.ref017">17</xref>], a recent improvement of RNAcontext, uses <italic>k</italic>-mer based contexts incorporating both sequence- and structure-based binding preferences. More recently, deep learning methods have been adapted to protein-RNA binding prediction. DeepBind [<xref ref-type="bibr" rid="pcbi.1007283.ref018">18</xref>] and DLPRB [<xref ref-type="bibr" rid="pcbi.1007283.ref019">19</xref>] utilize convolutional neural networks (CNN) to jointly extract binding preferences from both RNA sequence and structure and demonstrate substantial improvements, compared to previous approaches.</p>
<p>In both deep learning approaches, DeepBind [<xref ref-type="bibr" rid="pcbi.1007283.ref018">18</xref>] and DLPRB [<xref ref-type="bibr" rid="pcbi.1007283.ref020">20</xref>], RNA sequence contexts are modeled by a small number of convolutional filters, each resembling a <italic>k</italic>-mer or a binding site. RNA structural contexts are represented as a probability matrix for structure types (paired (P), hairpin loop (H), inner loop (I), multi-loop (M) or external region (E)) [<xref ref-type="bibr" rid="pcbi.1007283.ref016">16</xref>], each measuring the thermodynamic average of a structure type of the full ensemble of all possible structures. This matrix can be computed by an RNA folding algorithm with dynamic programming [<xref ref-type="bibr" rid="pcbi.1007283.ref021">21</xref>]. Models in both DeepBind and DLPRB were trained on the large-scale <italic>in vitro</italic> RNAcompete dataset. However, in RNAcompete, most synthetic RNAs are unstructured, which makes deep learning methods not effectively identifying RBP-binding structural preferences. Furthermore, RNA structure may be variable or multi-modal according to both theoretical and experimental evidence. In this work, we propose ThermoNet, a thermodynamic prediction model by integrating a new sequence-embedding convolutional neural network model over a thermodynamic ensemble of RNA secondary structures. First, our sequence-embedding convolutional neural network generalizes the existing <italic>k</italic>-mer based methods by jointly learning convolutional filters and <italic>k</italic>-mer embeddings to represent RNA sequence contexts. In this way, each <italic>k</italic>-mer is represented by a low-dimensional continuous vector, and convolutional filters combine a set of <italic>k</italic>-mer embeddings of consecutive positions and their corresponding structural contexts, thus providing more flexibility and higher expressiveness. Second, the thermodynamic average of structure-specific predictions explores structural variability and improves the prediction especially for the structured RNAs in <italic>in vivo</italic> datasets. Structural contexts in the high-probability structures are not simply averaged but used for providing structure-specific predictions. Extensive experiments demonstrate that our method significantly outperforms existing approaches, including RCK, DeepBind, DLPRB and several other recent state-of-the-art methods for predictions on both <italic>in vitro</italic> and <italic>in vivo</italic> data.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<p>We introduce a deep learning-based thermodynamic prediction model for protein-RNA binding prediction. The model integrates both sequence information and structural contexts to better capture RBP-binding preferences. As an overview (<xref ref-type="fig" rid="pcbi.1007283.g001">Fig 1</xref>), our method takes an RNA sequence as input and extracts informative features from the sequence and a thermodynamic ensemble of its corresponding secondary structures. A deep convolutional neural network is used to integrate the sequence and structure information and produce the prediction of binding affinity. We have two main contributions here: first, we use a sequence-embedding convolutional neural network (CNN) to represent each <italic>k</italic>-mer as a low-dimensional continuous vector, which is more flexible and expressive than previous methods that directly apply CNN on nucleotides [<xref ref-type="bibr" rid="pcbi.1007283.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1007283.ref022">22</xref>] or solely use traditional <italic>k</italic>-mer based features [<xref ref-type="bibr" rid="pcbi.1007283.ref017">17</xref>]; second, we use a thermodynamic ensemble of RNA secondary structures to explore the structural variability and provide structure-specific predictions—this differentiates our method from previous approaches that simply collapse the set of (predicted) secondary structures by taking the average, in which the structure-specific information of high-probability structures may be mixed. We describe the details of our method below.</p>
<fig id="pcbi.1007283.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007283.g001</object-id>
<label>Fig 1</label>
<caption>
<title/>
<p>(A) <bold>Overall framework of ThermoNet</bold>. (a) Our model receives the RNA sequence as the input and <italic>k</italic>-mers with various lengths are extracted as sequence features. (b) Each <italic>k</italic>-mer is mapped to a low-dimensional continuous vector (called sequence embedding) through an embedding layer to construct a sequence representation of the input sequence. (c) An ensemble of possible secondary structures of the input RNA are sampled using the RNAsubopt function of Vienna RNA package. (d) High-probability structures from the structure ensemble are encoded using one-hot representation separately and the remaining structures are summarized by averaging their one-hot representations into an average structure profile. (e) Each of the high-probability structures is integrated with the sequence embedding by a convolutional neural network (CNN) to produce structure-specific predictions. The average structure profile is also combined with the sequence embedding to generate a prediction. (f) The final predicted protein-RNA binding intensity is obtained by computing the weighted average of individual predictions. (B) <bold>Prediction network structure</bold>. The convolutional neural network takes the sequence embedding and secondary structure representation as input. The network is composed of multiple 1D convolutional kernels, followed by a batch normalization layer, a ReLU activation layer and fully-connected (fc) layer. The output of the network is the predicted binding intensity for the input RNA.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Input sequence and structure representations</title>
<p>An RNA sequence of length <italic>ℓ</italic> is a string of <italic>ℓ</italic> nucleotides over the alphabet {A, C, G, U}. We represent the sequence using the one-hot encoding scheme, where A, C, G and U are represented by [1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], and [0, 0, 0, 1], respectively. The secondary structure of the RNA is a string of the same length <italic>ℓ</italic> over the alphabet {P, H, I, M, E}, representing the five types of structural contexts, namely, paired (P), hairpin loop (H), inner-loop (I), multi-loop (M) or external region (E). Existing approaches, including DeepBind [<xref ref-type="bibr" rid="pcbi.1007283.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1007283.ref018">18</xref>], DLPRB [<xref ref-type="bibr" rid="pcbi.1007283.ref020">20</xref>] and RCK [<xref ref-type="bibr" rid="pcbi.1007283.ref017">17</xref>], represent the structural context of a position as a five-dimensional distribution vector corresponding to the probabilities of each type of structural contexts predicted by an RNA folding algorithm such as RNAplfold [<xref ref-type="bibr" rid="pcbi.1007283.ref021">21</xref>]. If only a specific structure is considered, the five-dimensional vector becomes one-hot.</p>
</sec>
<sec id="sec004">
<title>Extracting sequence context features using <italic>k</italic>-mer embeddings</title>
<p>To better extract informative features from the RNA sequence, we propose a sequence-embedding convolutional neural network that first augments sequence features with <italic>k</italic>-mers and then uses a convolutional neural network (CNN) to extract higher-order features.</p>
<p>It has been demonstrated that incorporating <italic>k</italic>-mer based features, in addition to nucleotide based features, can encode larger sequence contexts, model dependencies between binding site positions and thus improve the prediction performance [<xref ref-type="bibr" rid="pcbi.1007283.ref017">17</xref>]. Here we generalize this approach to account for <italic>k</italic>-mers with various lengths (e.g., <italic>k</italic> = 1, …, 5). The straightforward way is to simply concatenate <italic>k</italic>-mers with various lengths together and encode it using one-hot representation. However, the dimensionality of this representation increases exponentially (4<sup><italic>k</italic></sup>), which poses computational challenges in the prediction. To address this, we apply the embedding layer that is widely used in deep learning to do dimensionality reduction. The embedding layer can be thought of as a look-up table, which maps the 4<sup><italic>k</italic></sup>-dimensional one-hot vector to a <italic>d</italic>-dimensional continuous vector. The values of the <italic>d</italic>-dimensional vector are not pre-specified but rather learned from the data during the model training process. For an input RNA sequence of length <italic>ℓ</italic> and a fixed <italic>k</italic>-mer length <italic>k</italic>, the output of the embedding layer is a matrix with dimension <italic>ℓ</italic> × <italic>d</italic>, in which the <italic>i</italic>-th row is the low-dimensional representation of the <italic>k</italic>-mer starting at the position <italic>i</italic> (<italic>k</italic>-mers go beyond the RNA sequence length are zero-padded). To account for various <italic>k</italic>-mer lengths (i.e., <italic>k</italic> = 1, …, <italic>k</italic><sub><italic>m</italic></sub>), we stack the representations of each <italic>k</italic>-mer length to produce a sequence representation matrix <bold>E</bold> with dimension <italic>ℓ</italic> × <italic>k</italic><sub><italic>m</italic></sub><italic>d</italic> where <italic>k</italic><sub><italic>m</italic></sub><italic>d</italic> ≪ 4<sup><italic>k</italic></sup>. These low-dimensional representations of <italic>k</italic>-mers will be integrated by a CNN to further capture the higher-order dependencies in the RNA sequence (described below).</p>
<p>Compared with existing approaches, our method has more flexibility and higher expressiveness in extracting sequence features: Unlike RCK [<xref ref-type="bibr" rid="pcbi.1007283.ref017">17</xref>] that uses <italic>k</italic>-mer based features with only a specific length (<italic>k</italic> = 5), our method is more flexible in that it can handle various lengths of <italic>k</italic>-mers through a dimensionality reduction process, capturing multi-resolution local sequence information. cDeepbind [<xref ref-type="bibr" rid="pcbi.1007283.ref022">22</xref>] directly applies CNN on nucleotide based input features, while our method incorporates <italic>k</italic>-mer based features and then uses a CNN on top of the <italic>k</italic>-mer embeddings to further extract higher-order features, providing richer information from the RNA sequence.</p>
</sec>
<sec id="sec005">
<title>Incorporating thermodynamics contexts using an ensemble of structures</title>
<p>Previous studies have shown that RNA secondary structure information can provide additional prediction power in predicting protein-RNA binding [<xref ref-type="bibr" rid="pcbi.1007283.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1007283.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1007283.ref022">22</xref>]. These methods use the RNA secondary structure context profiles predicted by RNAplfold [<xref ref-type="bibr" rid="pcbi.1007283.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1007283.ref021">21</xref>], which is a five-dimensional vector of the probabilities of five contexts (paired, hairpin loop, inner loop, multi-loop or external region) for each position in the sequence. The structure context profile can be thought of as an ‘average’ of all possible secondary structures. However, informative structural features of high-probability structures may be buried in this uniform average. To enable structure-specific prediction, we propose to sample an ensemble of possible structures for a given RNA sequence. Each of the high-probability structures is then integrated with the sequence features to give structure-specific predictions separately, and the final prediction is obtained by combining the structure-specific predictions.</p>
<p>Specifically, for a given RNA sequence, we sample <italic>N</italic> possible secondary structures using the RNAsubopt function of the ViennaRNA package [<xref ref-type="bibr" rid="pcbi.1007283.ref021">21</xref>], which draws a specific structure with probability proportional to its Boltzmann energy. In our experiment, we choose <italic>N</italic> = 100 for computational consideration and we also found that an ensemble of this size generally reflects the distribution of the secondary structures of an RNA sequence. We then identify high-probability structures by counting the occurrence for each unique structures of the <italic>N</italic> sampled structures. Denote the <italic>U</italic> unique structures by <bold>R</bold><sub>1</sub>, <bold>R</bold><sub>2</sub>, …, <bold>R</bold><sub><italic>U</italic></sub> and their associated frequency by <italic>m</italic><sub>1</sub>, <italic>m</italic><sub>2</sub>, …, <italic>m</italic><sub><italic>U</italic></sub>, where <bold>R</bold><sub><italic>i</italic></sub> (1 ≤ <italic>i</italic> ≤ <italic>U</italic>) is a <italic>ℓ</italic> × 5 one-hot matrix that represents the structural contexts of the <italic>i</italic>-th sampled structure. Here we assume the unique structures are sorted in descending order of their frequencies, i.e., <italic>m</italic><sub>1</sub> ≥ <italic>m</italic><sub>2</sub> ≥ …, ≥<italic>m</italic><sub><italic>U</italic></sub>. The top <italic>T</italic> structures are considered as high-probability structures. The choice of the value of <italic>T</italic> is a joint consideration of structures diversity and computational cost: we want to include more high-probability structures, while also prevent <italic>T</italic> being too large otherwise the model training and prediction would be inefficient. Based on the analysis of the frequency histogram, we found <italic>T</italic> = 5 is a good balance between structures diversity and computation efficiency for both <italic>in vitro</italic> and <italic>in vivo</italic> datasets (<xref ref-type="supplementary-material" rid="pcbi.1007283.s005">S1 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007283.s001">S1 Table</xref>). For example, in the <italic>in vitro</italic> dataset, the top 5 unique structures are highly frequent, contributing ∼50% frequencies in all sampled structures. To reduce noise, we thus consider the top <italic>T</italic> structures as high-probability structures, while for the remaining <italic>U</italic> − <italic>T</italic> structures, we summarize their structure information by computing an average structure profile
<disp-formula id="pcbi.1007283.e001"><alternatives><graphic id="pcbi.1007283.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007283.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:msub><mml:mi mathvariant="bold">R</mml:mi> <mml:mrow><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>+</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mi>T</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>U</mml:mi></mml:munderover> <mml:mfrac><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mi>T</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mi>U</mml:mi></mml:mrow></mml:msubsup> <mml:msub><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msub><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>Next, we build a series of rank-specific neural networks (described below) <inline-formula id="pcbi.1007283.e002"><alternatives><graphic id="pcbi.1007283.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007283.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1007283.e003"><alternatives><graphic id="pcbi.1007283.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007283.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>, …, <inline-formula id="pcbi.1007283.e004"><alternatives><graphic id="pcbi.1007283.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007283.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>T</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>, parameterized by <italic>θ</italic><sub>1</sub>, …, <italic>θ</italic><sub><italic>T</italic></sub>, respectively. Each neural network takes as input one of the high-probability structures <bold>R</bold><sub><italic>i</italic></sub> as well as the sequence embedding <bold>E</bold> to produce a structure-specific prediction (a binding intensity). We also build an additional neural network <inline-formula id="pcbi.1007283.e005"><alternatives><graphic id="pcbi.1007283.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007283.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> that makes the prediction based on the average structure profile and the sequence embedding. Predictions of each individual neural network are combined as a weighted average to give the final prediction <italic>f</italic>(<italic>s</italic>) for an RNA sequence <italic>s</italic>,
<disp-formula id="pcbi.1007283.e006"><alternatives><graphic id="pcbi.1007283.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007283.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:mfrac><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>N</mml:mi></mml:mfrac> <mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">E</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:mfrac><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>N</mml:mi></mml:mfrac> <mml:mo>)</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">E</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">R</mml:mi> <mml:mrow><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>+</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>Note that previous methods like cDeepbind [<xref ref-type="bibr" rid="pcbi.1007283.ref022">22</xref>] make predictions using only the average structure profile as input, in which the structure-specific information may not be revealed. In contrast, our method, while accounting for the average structure profile, also explicitly teases high-probability structures apart from the uniform average profile to enable structure-specific predictions.</p>
</sec>
<sec id="sec006">
<title>Convolutional neural network as base predictor</title>
<p>Deep learning continues to proliferate as a powerful set of tools to solve an increasingly diverse range of problems, including many in structural and systems biology [<xref ref-type="bibr" rid="pcbi.1007283.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1007283.ref029">29</xref>]. We use the convolutional neural network (CNN) as the base model <italic>f</italic><sub><italic>θ</italic></sub> to predict protein-RNA binding, where <italic>θ</italic> represents the network weights. CNNs are useful when local groups of data with high correlation and forming distinct patterns by combining lower level features and capturing more complex feature dependencies in the sequence input. In our model, we stack five convolutional layers. Every layer contains several one-dimensional convolutional kernels, each of which produces an output with the same size of the input. After applying the batch normalization technique [<xref ref-type="bibr" rid="pcbi.1007283.ref030">30</xref>] to the intermediate output from kernels, we fed it to the ReLU activation function [<xref ref-type="bibr" rid="pcbi.1007283.ref031">31</xref>] and give the output to the next convolutional layer. Following the last convolutional layer, we append a fully-connected layer to produce the predicted binding intensity of the protein-RNA binding. The overall structure is depicted in <xref ref-type="fig" rid="pcbi.1007283.g001">Fig 1B</xref>. Please refer to Results section for parameter-tuning details. In order to improve the training stability of ThermoNet, we train the <italic>T</italic> + 1 models individually. Each model <inline-formula id="pcbi.1007283.e007"><alternatives><graphic id="pcbi.1007283.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007283.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula> was trained using stochastic gradient descent to find the parameters of the embedding layer and CNNs that minimize the following loss function
<disp-formula id="pcbi.1007283.e008"><alternatives><graphic id="pcbi.1007283.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007283.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mtext>Huber</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">E</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>y</italic><sub><italic>s</italic></sub> is the (normalized) binding affinity of the RNA <italic>s</italic> to a given protein, <inline-formula id="pcbi.1007283.e009"><alternatives><graphic id="pcbi.1007283.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007283.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">E</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the predicted binding intensity by the model, and <italic>L</italic><sub>Huber</sub>() is the Huber loss, which is defined by
<disp-formula id="pcbi.1007283.e010"><alternatives><graphic id="pcbi.1007283.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007283.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:msub><mml:mi>L</mml:mi> <mml:mtext>Huber</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>y</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mo>≤</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>y</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mo>-</mml:mo></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
We choose Huber loss as it is less sensitive to outlier data points than the squared error loss.</p>
</sec>
</sec>
<sec id="sec007" sec-type="results">
<title>Results</title>
<sec id="sec008">
<title>Implementation</title>
<p>We performed the grid search to find the optimal hyperparameters of our model and chose the one with the lowest validation cost using a two-fold cross-validation on the training data. In particular, we grid-searched the initial learning rate in {0.001, 0.0001, 0.00001}, the filter lengths in {7, 12, 16}, the number of convolutional kernels in {16, 64}, the regularization coefficient of the <italic>L</italic><sub>2</sub> norm in {0.001, 0.0001, 0.00001}, the size of sequence embedding vector in {10, 20, 30} and the maximum <italic>k</italic>-mer length <italic>k</italic><sub>m</sub> in {2, 3, 4, 5}. A total of five convolutional layers were stacked in the CNN. All CNN parameters were initialized by Xavier initializer [<xref ref-type="bibr" rid="pcbi.1007283.ref032">32</xref>]. We chose Huber loss to define the loss function and Adam [<xref ref-type="bibr" rid="pcbi.1007283.ref033">33</xref>] as the optimizer for training the network. We reduced the learning rate to one-tenth of the previous one after the 5th epoch.</p>
</sec>
<sec id="sec009">
<title>Evaluation of prediction performance on <italic>in vitro</italic> data</title>
<p>We first assessed the prediction ability of our method using <italic>in vitro</italic> protein-RNA binding dataset. We used the comprehensive RNAcompete dataset [<xref ref-type="bibr" rid="pcbi.1007283.ref008">8</xref>] which includes binding intensities for over 240,000 sequences across 244 experiments. The dataset consists of a training set of sequences (set A) and a test set (set B). For each experiment, we trained a model on sequences extracted from set A and then predicted the intensities for sequences from set B. To evaluate the performance, we used the Pearson correlation between predicted and measured intensities on set B as the metric. Similar to Deepbind [<xref ref-type="bibr" rid="pcbi.1007283.ref018">18</xref>], we removed outlier intensities in the dataset: we clamped all intensities greater than the 99.5 percentile to the 99.5 percentile. Furthermore, the scores were normalized to have a mean of zero and a variance of one.</p>
<p>We compared our method against four existing methods that use both sequence and structure information for protein-RNA binding prediction, including two probabilistic model based method—RNAcontext [<xref ref-type="bibr" rid="pcbi.1007283.ref016">16</xref>] and RCK [<xref ref-type="bibr" rid="pcbi.1007283.ref017">17</xref>], and two deep learning algorithms—DLPRB with the CNN network (DLPRB-CNN) [<xref ref-type="bibr" rid="pcbi.1007283.ref019">19</xref>] and cDeepbind with the CNN network (cDeepbind-CNN) [<xref ref-type="bibr" rid="pcbi.1007283.ref022">22</xref>]. We found that our method consistently outperformed all other methods (<xref ref-type="fig" rid="pcbi.1007283.g002">Fig 2A</xref>) with an average Pearson correlation of 0.6710 over all proteins, compared to 0.4344, 0.4600, 0.6058 and 0.5061 for RNAcontext, RCK, DLPRB-CNN and cDeepbind-CNN, respectively. The relative improvements achieved by our method over the for methods were 54.46%, 45.87%, 10.76% and 32.58%, respectively. In a pairwise comparison to the best performing probabilistic model RCK and the best performing deep learning model DLPRB-CNN (<xref ref-type="fig" rid="pcbi.1007283.g002">Fig 2B and 2C</xref>), we observed that our method achieves significantly higher Pearson correlation than the two baseline methods (Wilcoxon signed rank test <italic>p</italic>-value 4.50 × 10<sup>−42</sup> and 4.82 × 10<sup>−38</sup>, respectively). Moreover, we found that the improvements achieved by ThermoNet are not biased toward certain predominant RNA binding domains (<xref ref-type="supplementary-material" rid="pcbi.1007283.s006">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007283.s007">S3</xref> Figs). For example, investigating the histogram of relative improvements achieved by our method (<xref ref-type="supplementary-material" rid="pcbi.1007283.s008">S4 Fig</xref>), we found that the subset of RBPs with the most noticeable improvements covered a wide range of RNA binding domains. Raw numbers of prediction performance of all methods in this experiment can be found in <xref ref-type="supplementary-material" rid="pcbi.1007283.s002">S2 Table</xref>.</p>
<fig id="pcbi.1007283.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007283.g002</object-id>
<label>Fig 2</label>
<caption>
<title/>
<p>(A) Comparison between ThermoNet and four state-of-the-art methods in predicting <italic>in vitro</italic> binding. Performances were evaluated using the Pearson correlation between the predicted and measured binding intensities. Points in each box plot represent the 244 experiments in the RNAcompete [<xref ref-type="bibr" rid="pcbi.1007283.ref008">8</xref>] dataset. (B)-(C) Pairwise comparisons of ThermoNet to RCK [<xref ref-type="bibr" rid="pcbi.1007283.ref017">17</xref>] and DLPRB-CNN [<xref ref-type="bibr" rid="pcbi.1007283.ref020">20</xref>], respectively. The <italic>p</italic>-values were calculated using one-sided Wilcoxon singed rank test.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Evaluation of prediction performance on <italic>in vivo</italic> data</title>
<p>We then assessed the performance of ThermoNet on <italic>in vivo</italic> protein-RNA binding dataset. We obtained a large-scale dataset of RBP binding sites from a previous work [<xref ref-type="bibr" rid="pcbi.1007283.ref034">34</xref>], including a compendium of 31 published CLIP-seq experiments on 19 RBPs. In this dataset, nucleotide positions with the highest cDNA counts were first identified as a pool of positive samples. A random sampling process preventing consecutive genomic positions was then applied to reduce the redundancy. Negative sites were randomly sampled from genes that were not detected as positive sites in any of the 31 experiments. Each experiment consists of 40,000 samples divided into a training set of 20,000 samples and a test set of 20,000 samples. The length of each RNA sequence is 101nt. Unlike the <italic>in vitro</italic> dataset that gives a real-valued binding intensity for every binding event, the <italic>in vivo</italic> dataset only gives a binary label (0 or 1) based on the cDNA counts to indicate whether a protein binds to an RNA or not. Therefore, we treated the prediction for <italic>in vivo</italic> data as a binary classification problem and used AUROC (Area Under the Receiver Operating Characteristics) as the evaluation metric.</p>
<p>We compared ThermoNet against two state-of-the-art deep learning algorithms, DeepBind and DLPRB-CNN (<xref ref-type="fig" rid="pcbi.1007283.g003">Fig 3</xref>), using the average of the AUROCs over the 31 experiments as the evaluation metric. We found that ThermoNet outperformed the other two methods, achieving an average AUROC of 0.864 against 0.835 for DLPRB-CNN and 0.836 for DeepBind. In a pairwise comparison of ThermoNet to DeepBind and DLPRB-CNN over the 31 experiments, we observed that the improvement gaps between ThermoNet and the two methods were also statistically significant (Wilcoxon signed rank test <italic>p</italic>-value 4.53 × 10<sup>−6</sup> and 2.11 × 10<sup>−6</sup> for DLPRB-CNN and DeepBind, respectively). Raw numbers of prediction performance of all methods in this experiment can be found in <xref ref-type="supplementary-material" rid="pcbi.1007283.s003">S3 Table</xref>.</p>
<fig id="pcbi.1007283.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007283.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Pairwise comparisons of ThermoNet to (A) DLPRB-CNN and (B) DeepBind in <italic>in vivo</italic> binding.</title>
<p>AUROC was used as the evaluation metric. Each point in the scatter plot represents one of 31 CLIP-seq experiments. The <italic>p</italic>-values were calculated using one-sided Wilcoxon singed rank test.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec011">
<title>Ablation analysis of ThermoNet</title>
<p>Having demonstrated the superior prediction ability of ThermoNet for both the <italic>in vitro</italic> and <italic>in vivo</italic> bindings, we proceeded to perform an ablation analysis to explain the sources of performance improvements achieved by ThermoNet. We built several variants of ThermoNet to investigate the importance of different novel designs in ThermoNet. The variants include i) “<italic>1-struc</italic>”: using only 1-mer and the average structure profile as input; ii) “<italic>k-no-struc</italic>”: using <italic>k</italic>-mers of various lengths and without using structure information as input; iii) “<italic>k-struct</italic>”: using <italic>k</italic>-mers of various lengths and the average structure profile as input; and iv) “<italic>k-struc-sampling</italic>”: the full model, i.e., using <italic>k</italic>-mers of various lengths, individual secondary structures and average structure profile as input. All variants were trained and tested on the aforementioned <italic>in vitro</italic> dataset. We evaluated the performance of each variant using the average Pearson correlation over the 244 experiments in the <italic>in vitro</italic> dataset and the 31 experiments in the <italic>in vivo</italic> dataset (<xref ref-type="fig" rid="pcbi.1007283.g004">Fig 4</xref>; Detailed results in <xref ref-type="supplementary-material" rid="pcbi.1007283.s004">S4 Table</xref>).</p>
<fig id="pcbi.1007283.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007283.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Ablation analysis of various designs in ThermoNet using (A) <italic>in vitro</italic> and (B) <italic>in vivo</italic> datasets.</title>
<p>Several variants of ThermoNet were built and evaluated, including <italic>1-struc</italic> (blue): training only one CNN with 1-mer representations and averaged secondary structure information. <italic>k-no-struc</italic> (brown): training only one network with various <italic>k</italic>-mer representations but without any structure information. <italic>k-struc</italic> (green): training only one CNN with various <italic>k</italic>-mer representations as well as averaged structure information. <italic>k-struc-sampling</italic> (red): training various networks for individual secondary structures. All variants received the sequence embedding settings as input. ⋆: one-sided Wilcoxon signed rank test <italic>p</italic>-value &lt; 0.05.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.g004" xlink:type="simple"/>
</fig>
<p>We first observed that the <italic>k-struc</italic> model (green) improves the <italic>1-struc</italic> model (blue) with a pronounced gap (average correlation 0.663 compared to 0.620 for the <italic>in vitro</italic> dataset and AUROC 0.861 compared to 0.856 for the <italic>in vivo</italic> dataset). Note that previous methods such as DeepBind, cDeepbind and DLPRB only used single nucleotide based sequences. The improvements of our method over these methods can thus be partially explained by the richer sequence information we have captured in the <italic>k</italic>-mer embedding process of our method.</p>
<p>In addition, the performance gap between the <italic>k-struc</italic> model (green) and the <italic>k-no-struc</italic> model (brown) was not significant: on the <italic>in vitro</italic> dataset, the <italic>k-struc</italic> model achieved an average correlation of 0.663 as compared to 0.661 for the <italic>k-no-struc</italic> model; on the <italic>in vivo</italic> dataset, both models achieved an AUROC of 0.861. The only difference between these two models is that <italic>k-struc</italic> used the average structure profile but <italic>k-no-struc</italic> did not. As the average structure profile is a uniform average of all sampled secondary structures, informative features of high-probability structures that are useful for protein-RNA binding prediction may not be revealed by the average profile, and thus the performance improvement was not significant. The small performance gap between the two variants may also be explained by the high expressiveness of the sequence embeddings, which already capture the information that the average structure profile can provide for the binding prediction.</p>
<p>Moreover, we found that adding individual high-probability structures as input (the <italic>k-struc-sampling</italic> model) further improved the prediction performance of the <italic>k-struc</italic> model (average correlation 0.671 compared to 0.663 for the <italic>in vitro</italic> dataset and AUROC 0.864 compared to 0.861 for the <italic>in vivo</italic> dataset). This result highlights the effectiveness of using the thermodynamic ensemble of secondary structures in ThermoNet. The unique features of structured RNAs revealed by the high-probability structures and the thermodynamic average of structure-specific predictions have resulted in a substantial improvement over existing methods.</p>
</sec>
</sec>
<sec id="sec012" sec-type="conclusions">
<title>Discussion</title>
<p>We have introduced ThermoNet, a deep learning-based thermodynamic model for protein-RNA binding prediction. ThermoNet incorporates the thermodynamic and sequence contexts by integrating a sequence-embedding convolutional neural network over a thermodynamic ensemble of RNA secondary structures. The model both explores structural variability and captures the higher-order dependencies in the RNA sequences, providing richer information and higher expressiveness for protein-RNA binding prediction. In addition, high-probability structures are utilized in ThermoNet to better extract informative structure features that enable structure-specific predictions. We compared ThermoNet to multiple state-of-the-art methods for protein-RNA binding prediction on both <italic>in vitro</italic> and <italic>in vivo</italic> binding datasets, and ThermoNet has achieved substantial improvements over other methods on both datasets. Ablation study performed on a series of ThermoNet also demonstrated the effectiveness of multiple novel designs in ThermoNet that lead to improved prediction performance.</p>
<p>ThermoNet is a flexible and scalable model that can be applied to a broad range of RNA-binding proteins. We expect ThermoNet to be an effective tool in practice for identifying novel binding sites for RBPs. In addition to its direct application in protein-RNA binding prediction, multiple novel model designs of ThermoNet can also be used as a stand-alone tool in other applications. For example, the sequence-embedding convolutional neural network can also be applied to understand signals in biological sequence data of other molecular events, including transcription factor (TF) binding, DNA accessibility, and histone modification. Interpreting the ThermoNet model is one of the directions worth pursuing in future work. A better understanding of what the deep learning model has learned, for example, what sequence and structure motifs contribute to protein-RNA binding, may reveal new biological insights. A great challenge of protein-RNA binding prediction is the <italic>in vitro</italic>-to-<italic>in vivo</italic> generalization. It was observed in previous works [<xref ref-type="bibr" rid="pcbi.1007283.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1007283.ref020">20</xref>] that a model trained on <italic>in vitro</italic> data did not perform very well on <italic>in vivo</italic> data, possibly due to the biases of different experimental protocols [<xref ref-type="bibr" rid="pcbi.1007283.ref035">35</xref>]. We think the generalization requires not only a generalizable prediction model but also an in-depth characterization of the <italic>in vitro</italic> and <italic>in vivo</italic> datasets. Achieving a robust <italic>in vitro</italic>-to-<italic>in vivo</italic> generalization in protein-RNA binding prediction is also one of our future directions.</p>
</sec>
<sec id="sec013">
<title>Supporting information</title>
<supplementary-material id="pcbi.1007283.s001" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Secondary structures frequency statistics in <italic>in vitro</italic> dataset and <italic>in vivo</italic> dataset.</title>
<p>This table is also available at <ext-link ext-link-type="uri" xlink:href="https://github.com/suyufeng/ThermoNet/tree/master/supplementary" xlink:type="simple">https://github.com/suyufeng/ThermoNet/tree/master/supplementary</ext-link>.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007283.s002" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.s002" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Comparison of ThermoNet against RNAcontext, RCK, DLPRB-CNN and cDeepBind-CNN on <italic>in vitro</italic> binding, measured using pearson correlation.</title>
<p>This table is also available at <ext-link ext-link-type="uri" xlink:href="https://github.com/suyufeng/ThermoNet/tree/master/supplementary" xlink:type="simple">https://github.com/suyufeng/ThermoNet/tree/master/supplementary</ext-link>.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007283.s003" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.s003" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Comparison of ThermoNet against DLPRB-CNN and DeepBind on <italic>in vivo</italic> binding, measured using AUROC.</title>
<p>This table is also available at <ext-link ext-link-type="uri" xlink:href="https://github.com/suyufeng/ThermoNet/tree/master/supplementary" xlink:type="simple">https://github.com/suyufeng/ThermoNet/tree/master/supplementary</ext-link>.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007283.s004" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.s004" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Ablation study for various features on <italic>in vivo</italic> and <italic>in vitro</italic> binding.</title>
<p>This table is also available at <ext-link ext-link-type="uri" xlink:href="https://github.com/suyufeng/ThermoNet/tree/master/supplementary" xlink:type="simple">https://github.com/suyufeng/ThermoNet/tree/master/supplementary</ext-link>.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007283.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.s005" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Frequency histogram of unique sampled secondary structures in (A) <italic>in vitro</italic> and (B) <italic>in vivo</italic> datasets.</title>
<p>Structures are sorted from the most frequent to the least frequent in the x-axis. The y-axis shows the average frequencies of structures across all RNAs in each dataset. Structures ranked at the top <italic>T</italic> = 5 are colored in purple and the remaining structures are colored in yellow.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007283.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.s006" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>The distribution of the RNA-binding domains on the <italic>in vitro</italic> dataset (RNAcompete).</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007283.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.s007" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Pairwise comparisons of ThermoNet to (A) RCK and (B) DLPRB-CNN on the RNAcompete dataset.</title>
<p>Each point in the scatter plots represents an experiment in the RNAcompete dataset and is labeled with a color specific to its corresponding RNA-binding domain.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007283.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007283.s008" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>The histogram of relative improvements achieved by ThermoNet.</title>
<p>We compute the relative improvement over DLPRB-CNN achieved by our method for each experiment in the RNAcompete dataset. These relative improvements are sorted from the largest to the smallest and then discretized into bins of percentiles (0<sup><italic>th</italic></sup>, 10<sup><italic>th</italic></sup>], (10<sup><italic>th</italic></sup>, 25<sup><italic>th</italic></sup>], (25<sup><italic>th</italic></sup>, 50<sup><italic>th</italic></sup>], (50<sup><italic>th</italic></sup>, 100<sup><italic>th</italic></sup>]. The normalized counts of each RNA-binding domain within each bin are shown in the histogram. Note that the S1 binding domain has only one protein hence the relative count of the S1 domain in the (0<sup><italic>th</italic></sup>, 10<sup><italic>th</italic></sup>] bin is 1.0.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1007283.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>König</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zarnack</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Luscombe</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Jernej</surname> <given-names>U</given-names></name>. <article-title>Protein–RNA interactions: new genomic technologies and perspectives</article-title>. <source>Nature Reviews Genetics</source>. <year>2012</year>;<volume>13</volume>:<fpage>77</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3141" xlink:type="simple">10.1038/nrg3141</ext-link></comment> <object-id pub-id-type="pmid">22251872</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rinn</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Jernej</surname> <given-names>U</given-names></name>. <article-title>’Oming in on RNA–protein interactions</article-title>. In: <source>Genome Biology</source>; <year>2014</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/gb4158" xlink:type="simple">10.1186/gb4158</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerstberger</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hafner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tuschl</surname> <given-names>T</given-names></name>. <article-title>A census of human RNA-binding proteins</article-title>. <source>Nature Reviews Genetics</source>. <year>2014</year>;<volume>15</volume>:<fpage>829</fpage>–<lpage>845</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3813" xlink:type="simple">10.1038/nrg3813</ext-link></comment> <object-id pub-id-type="pmid">25365966</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lorković</surname> <given-names>ZJ</given-names></name>, <name name-style="western"><surname>Barta</surname> <given-names>A</given-names></name>. <article-title>Genome analysis: RNA recognition motif (RRM) and K homology (KH) domain RNA-binding proteins from the flowering plant Arabidopsis thaliana</article-title>. <source>Nucleic acids research</source>. <year>2002</year>;<volume>30</volume> <issue>3</issue>:<fpage>623</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/30.3.623" xlink:type="simple">10.1093/nar/30.3.623</ext-link></comment> <object-id pub-id-type="pmid">11809873</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nakashima</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Kunkel</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Behringer</surname> <given-names>RR</given-names></name>, <etal>et al</etal>. <article-title>The Novel Zinc Finger-Containing Transcription Factor Osterix Is Required for Osteoblast Differentiation and Bone Formation</article-title>. <source>Cell</source>. <year>2002</year>;<volume>108</volume>:<fpage>17</fpage>–<lpage>29</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/s0092-8674(01)00622-5" xlink:type="simple">10.1016/s0092-8674(01)00622-5</ext-link></comment> <object-id pub-id-type="pmid">11792318</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dominguez</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Freese</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Alexis</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hochman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Palden</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Sequence, Structure, and Context Preferences of Human RNA Binding Proteins</article-title>. <source>Molecular cell</source>. <year>2018</year>;<volume>70</volume>(<issue>5</issue>):<fpage>854</fpage>–<lpage>867</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.molcel.2018.05.001" xlink:type="simple">10.1016/j.molcel.2018.05.001</ext-link></comment> <object-id pub-id-type="pmid">29883606</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Glisovic</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bachorik</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Yong</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dreyfuss</surname> <given-names>G</given-names></name>. <article-title>RNA-binding proteins and post-transcriptional gene regulation</article-title>. <source>FEBS letters</source>. <year>2008</year>;<volume>582</volume> <issue>14</issue>:<fpage>1977</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.febslet.2008.03.004" xlink:type="simple">10.1016/j.febslet.2008.03.004</ext-link></comment> <object-id pub-id-type="pmid">18342629</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ray</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kazan</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Cook</surname> <given-names>KB</given-names></name>, <name name-style="western"><surname>Weirauch</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Najafabadi</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>X</given-names></name>, <etal>et al</etal>. <article-title>A compendium of RNA-binding motifs for decoding gene regulation</article-title>. <source>Nature</source>. <year>2013</year>;<volume>499</volume>(<issue>7457</issue>):<fpage>172</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature12311" xlink:type="simple">10.1038/nature12311</ext-link></comment> <object-id pub-id-type="pmid">23846655</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tuerk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>L</given-names></name>. <article-title>Systematic evolution of ligands by exponential enrichment: RNA ligands to bacteriophage T4 DNA polymerase</article-title>. <source>Science</source>. <year>1990</year>;<volume>249</volume> <issue>4968</issue>:<fpage>505</fpage>–<lpage>10</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007283.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spitale</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Flynn</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>QC</given-names></name>, <name name-style="western"><surname>Crisalli</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Jung</surname> <given-names>JW</given-names></name>, <etal>et al</etal>. <article-title>Structural imprints in vivo decode RNA regulatory mechanisms</article-title>. In: <source>Nature</source>; <year>2015</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14263" xlink:type="simple">10.1038/nature14263</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ray</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kazan</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Cook</surname> <given-names>KB</given-names></name>, <name name-style="western"><surname>Weirauch</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Najafabadi</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>X</given-names></name>, <etal>et al</etal>. <article-title>A compendium of RNA-binding motifs for decoding gene regulation</article-title>. <source>Nature</source>. <year>2013</year>;<volume>499</volume>:<fpage>172</fpage>–<lpage>177</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature12311" xlink:type="simple">10.1038/nature12311</ext-link></comment> <object-id pub-id-type="pmid">23846655</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stormo</surname> <given-names>GD</given-names></name>. <article-title>DNA binding sites: representation and discovery</article-title>. <source>Bioinformatics</source>. <year>2000</year>;<volume>16</volume> <issue>1</issue>:<fpage>16</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/16.1.16" xlink:type="simple">10.1093/bioinformatics/16.1.16</ext-link></comment> <object-id pub-id-type="pmid">10812473</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hiller</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pudimat</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Busch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Backofen</surname> <given-names>R</given-names></name>. <article-title>Using RNA secondary structures to guide sequence motif finding towards single-stranded regions</article-title>. <source>Nucleic acids research</source>. <year>2006</year>;<volume>34</volume>(<issue>17</issue>):<fpage>e117</fpage>–<lpage>e117</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkl544" xlink:type="simple">10.1093/nar/gkl544</ext-link></comment> <object-id pub-id-type="pmid">16987907</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bailey</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Elkan</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <source>Fitting a mixture model by expectation maximization to discover motifs in bipolymers</source>. <year>1994</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1007283.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bailey</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Elkan</surname> <given-names>C</given-names></name>. <article-title>Unsupervised learning of multiple motifs in biopolymers using expectation maximization</article-title>. <source>Machine learning</source>. <year>1995</year>;<volume>21</volume>(<issue>1-2</issue>):<fpage>51</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00993379" xlink:type="simple">10.1007/BF00993379</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kazan</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ray</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Hughes</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>Q</given-names></name>. <article-title>RNAcontext: a new method for learning the sequence and structure binding preferences of RNA-binding proteins</article-title>. <source>PLoS computational biology</source>. <year>2010</year>;<volume>6</volume>(<issue>7</issue>):<fpage>e1000832</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000832" xlink:type="simple">10.1371/journal.pcbi.1000832</ext-link></comment> <object-id pub-id-type="pmid">20617199</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Orenstein</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>B</given-names></name>. <article-title>RCK: accurate and efficient inference of sequence-and structure-based protein–RNA binding models from RNAcompete data</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>12</issue>):<fpage>i351</fpage>–<lpage>i359</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btw259" xlink:type="simple">10.1093/bioinformatics/btw259</ext-link></comment> <object-id pub-id-type="pmid">27307637</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alipanahi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Delong</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weirauch</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Frey</surname> <given-names>BJ</given-names></name>. <article-title>Predicting the sequence specificities of DNA-and RNA-binding proteins by deep learning</article-title>. <source>Nature biotechnology</source>. <year>2015</year>;<volume>33</volume>(<issue>8</issue>):<fpage>831</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.3300" xlink:type="simple">10.1038/nbt.3300</ext-link></comment> <object-id pub-id-type="pmid">26213851</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ben-Bassat</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Chor</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Orenstein</surname> <given-names>Y</given-names></name>. <article-title>A deep neural network approach for learning intrinsic protein-RNA binding preferences</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>17</issue>):<fpage>i638</fpage>–<lpage>i646</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bty600" xlink:type="simple">10.1093/bioinformatics/bty600</ext-link></comment> <object-id pub-id-type="pmid">30423078</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ben-Bassat</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Chor</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Orenstein</surname> <given-names>Y</given-names></name>. <article-title>A deep neural network approach for learning intrinsic protein-RNA binding preferences</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume> <issue>17</issue>:<fpage>i638</fpage>–<lpage>i646</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bty600" xlink:type="simple">10.1093/bioinformatics/bty600</ext-link></comment> <object-id pub-id-type="pmid">30423078</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lorenz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bernhart</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>zu Siederdissen</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Tafer</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Flamm</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Stadler</surname> <given-names>PF</given-names></name>, <etal>et al</etal>. <article-title>ViennaRNA Package 2.0</article-title>. In: <source>Algorithms for Molecular Biology</source>; <year>2011</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1748-7188-6-26" xlink:type="simple">10.1186/1748-7188-6-26</ext-link></comment> <object-id pub-id-type="pmid">22115189</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gandhi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Delong</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Duvenaud</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Frey</surname> <given-names>B</given-names></name>. <article-title>cDeepbind: A context sensitive deep learning model of RNA-protein binding</article-title>. <source>bioRxiv</source>. <year>2018</year>; p. 345140.</mixed-citation>
</ref>
<ref id="pcbi.1007283.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhou</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Troyanskaya</surname> <given-names>OG</given-names></name>. <article-title>Predicting effects of noncoding variants with deep learning–based sequence model</article-title>. <source>Nature methods</source>. <year>2015</year>;<volume>12</volume>(<issue>10</issue>):<fpage>931</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3547" xlink:type="simple">10.1038/nmeth.3547</ext-link></comment> <object-id pub-id-type="pmid">26301843</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Angermueller</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pärnamaa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Parts</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Stegle</surname> <given-names>O</given-names></name>. <article-title>Deep learning for computational biology</article-title>. <source>Molecular systems biology</source>. <year>2016</year>;<volume>12</volume>(<issue>7</issue>):<fpage>878</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.15252/msb.20156651" xlink:type="simple">10.15252/msb.20156651</ext-link></comment> <object-id pub-id-type="pmid">27474269</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>J</given-names></name>. <article-title>Accurate de novo prediction of protein contact map by ultra-deep learning model</article-title>. <source>PLoS computational biology</source>. <year>2017</year>;<volume>13</volume>(<issue>1</issue>):<fpage>e1005324</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005324" xlink:type="simple">10.1371/journal.pcbi.1005324</ext-link></comment> <object-id pub-id-type="pmid">28056090</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ye</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Peng</surname> <given-names>J</given-names></name>. <article-title>Learning structural motif representations for efficient protein structure search</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>17</issue>):<fpage>i773</fpage>–<lpage>i780</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bty585" xlink:type="simple">10.1093/bioinformatics/bty585</ext-link></comment> <object-id pub-id-type="pmid">30423083</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Palmedo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ye</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Peng</surname> <given-names>J</given-names></name>. <article-title>Enhancing evolutionary couplings with deep convolutional neural networks</article-title>. <source>Cell systems</source>. <year>2018</year>;<volume>6</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cels.2017.11.014" xlink:type="simple">10.1016/j.cels.2017.11.014</ext-link></comment> <object-id pub-id-type="pmid">29275173</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Luo</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ye</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Ideker</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Peng</surname> <given-names>J</given-names></name>. <article-title>Deciphering signaling specificity with interpretable deep neural networks</article-title>. <source>bioRxiv</source>. <year>2018</year>; p. 288647.</mixed-citation>
</ref>
<ref id="pcbi.1007283.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Luo</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ideker</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Mitigating Data Scarcity in Protein Binding Prediction Using Meta-Learning</article-title>. <source>bioRxiv</source>. <year>2019</year>; p. 519413.</mixed-citation>
</ref>
<ref id="pcbi.1007283.ref030">
<label>30</label>
<mixed-citation publication-type="other" xlink:type="simple">Ioffe S, Szegedy C. Batch normalization: Accelerating deep network training by reducing internal covariate shift. arXiv preprint arXiv:150203167. 2015;.</mixed-citation>
</ref>
<ref id="pcbi.1007283.ref031">
<label>31</label>
<mixed-citation publication-type="other" xlink:type="simple">Nair V, Hinton GE. Rectified linear units improve restricted boltzmann machines. In: Proceedings of the 27th international conference on machine learning (ICML-10); 2010. p. 807–814.</mixed-citation>
</ref>
<ref id="pcbi.1007283.ref032">
<label>32</label>
<mixed-citation publication-type="other" xlink:type="simple">Glorot X, Bengio Y. Understanding the difficulty of training deep feedforward neural networks. In: Proceedings of the thirteenth international conference on artificial intelligence and statistics; 2010. p. 249–256.</mixed-citation>
</ref>
<ref id="pcbi.1007283.ref033">
<label>33</label>
<mixed-citation publication-type="other" xlink:type="simple">Kingma DP, Ba J. Adam: A method for stochastic optimization. arXiv preprint arXiv:14126980. 2014;.</mixed-citation>
</ref>
<ref id="pcbi.1007283.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Strazar</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zitnik</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zupan</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Jernej</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Curk</surname> <given-names>T</given-names></name>. <article-title>Orthogonal matrix factorization enables integrative analysis of multiple RNA binding proteins</article-title>. In: <source>Bioinformatics</source>; <year>2016</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btw003" xlink:type="simple">10.1093/bioinformatics/btw003</ext-link></comment> <object-id pub-id-type="pmid">26787667</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007283.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Koo</surname> <given-names>PK</given-names></name>, <name name-style="western"><surname>Anand</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Paul</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>. <article-title>Inferring Sequence-Structure Preferences of RNA-Binding Proteins with Convolutional Residual Networks</article-title>. <source>bioRxiv</source>. <year>2018</year>; p. 418459.</mixed-citation>
</ref>
</ref-list>
</back>
</article>