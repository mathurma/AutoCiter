<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004557</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00232</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>High-Specificity Targeted Functional Profiling in Microbial Communities with ShortBRED</article-title>
<alt-title alt-title-type="running-head">Targeted Functional Profiling in Microbial Communities with ShortBRED</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Kaminski</surname>
<given-names>James</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Gibson</surname>
<given-names>Molly K.</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Franzosa</surname>
<given-names>Eric A.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Segata</surname>
<given-names>Nicola</given-names>
</name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Dantas</surname>
<given-names>Gautam</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Huttenhower</surname>
<given-names>Curtis</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Biostatistics, Harvard T.H. Chan School of Public Health, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Center for Genome Sciences and Systems Biology, Washington University School of Medicine, St. Louis, Missouri, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Broad Institute, Cambridge, Massachusetts, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Centre for Integrative Biology (CIBIO), University of Trento, Trento, Trentino, Italy</addr-line></aff>
<aff id="aff005"><label>5</label> <addr-line>Department of Pathology and Immunology, Washington University School of Medicine, St. Louis, Missouri, United States of America</addr-line></aff>
<aff id="aff006"><label>6</label> <addr-line>Department of Biomedical Engineering, Washington University, St. Louis, Missouri, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Noble</surname>
<given-names>William Stafford</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Washington, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: JK MKG EAF NS GD CH. Performed the experiments: JK MKG. Analyzed the data: JK MKG EAF GD CH. Wrote the paper: JK MKG EAF GD CH. Wrote the software: JK.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">dantas@wustl.edu</email> (GD), <email xlink:type="simple">chuttenh@hsph.harvard.edu</email> (CH)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>18</day>
<month>12</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>12</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>12</issue>
<elocation-id>e1004557</elocation-id>
<history>
<date date-type="received">
<day>10</day>
<month>2</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>15</day>
<month>9</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Kaminski et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004557"/>
<abstract>
<p>Profiling microbial community function from metagenomic sequencing data remains a computationally challenging problem. Mapping millions of DNA reads from such samples to reference protein databases requires long run-times, and short read lengths can result in spurious hits to unrelated proteins (loss of specificity). We developed ShortBRED (Short, Better Representative Extract Dataset) to address these challenges, facilitating fast, accurate functional profiling of metagenomic samples. ShortBRED consists of two components: (i) a method that reduces reference proteins of interest to short, highly representative amino acid sequences (“markers”) and (ii) a search step that maps reads to these markers to quantify the relative abundance of their associated proteins. After evaluating ShortBRED on synthetic data, we applied it to profile antibiotic resistance protein families in the gut microbiomes of individuals from the United States, China, Malawi, and Venezuela. Our results support antibiotic resistance as a core function in the human gut microbiome, with tetracycline-resistant ribosomal protection proteins and Class A beta-lactamases being the most widely distributed resistance mechanisms worldwide. ShortBRED markers are applicable to other homology-based search tasks, which we demonstrate here by identifying phylogenetic signatures of antibiotic resistance across more than 3,000 microbial isolate genomes. ShortBRED can be applied to profile a wide variety of protein families of interest; the software, source code, and documentation are available for download at <ext-link ext-link-type="uri" xlink:href="http://huttenhower.sph.harvard.edu/shortbred" xlink:type="simple">http://huttenhower.sph.harvard.edu/shortbred</ext-link></p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>High throughput DNA sequencing of the human microbiome presents a tremendous resource for researchers interested in studying microbial community functions such as antibiotic resistance. However, assigning DNA reads to protein families remains a challenging problem, as reads derived from a given protein-coding gene may map spuriously to homologous regions from unrelated proteins, which results in false positives. We addressed this problem with our method ShortBRED, which first identifies short peptide sequences (“markers”) that are highly representative for specific protein families, and then searches for these markers in metagenomic sequencing data to accurately detect and quantify protein families. In this work, we applied ShortBRED to profile antibiotic resistance in the healthy human microbiome of individuals worldwide and across bacterial genomes. ShortBRED can be similarly applied to profile many other protein families of interest.</p>
</abstract>
<funding-group>
<funding-statement>Research reported in this publication was supported in part by NIH grants of a Director’s New Innovator Award, DP2DK098089, and R01GM099538, and the March of Dimes Foundation 6-FY12-394 to GD; and by NIH grants R01HG005969, NSF grant DBI-1053486, ARO grant W911NF-11-1-0473, and Danone Research grant PLF-5972-GD (PI Wendy Garrett) to CH. MKG is supported by a Mr. and Mrs. Spencer T. Olin Fellowship at Washington University and is a NSF Graduate Research Fellow (DGE-11143954). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="2"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The software and markers are available at <ext-link ext-link-type="uri" xlink:href="http://huttenhower.sph.harvard.edu/shortbred" xlink:type="simple">http://huttenhower.sph.harvard.edu/shortbred</ext-link>. The metagenomic data were obtained from the following studies: * Human Microbiome Project Consortium (2012)—(USA-HMP)—doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11234" xlink:type="simple">10.1038/nature11234</ext-link>—The 82 sample ID's can be found in <xref ref-type="supplementary-material" rid="pcbi.1004557.s013">S3 Table</xref> of our paper, and downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.hmpdacc.org/HMASM/" xlink:type="simple">http://www.hmpdacc.org/HMASM/</ext-link>; * Qin et al 2012—(China)—doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11450" xlink:type="simple">10.1038/nature11450</ext-link>—These are stored at the Sequence Read Archive (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sra/" xlink:type="simple">http://www.ncbi.nlm.nih.gov/sra/</ext-link>) as accessions SRA045646 and SRA050230.; * Yatsunenko et al 2012 (Malawai, USA-Global, Venezula and Unknown)—doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11053" xlink:type="simple">10.1038/nature11053</ext-link>—These are stored at MG-RAST (<ext-link ext-link-type="uri" xlink:href="http://metagenomics.anl.gov/" xlink:type="simple">http://metagenomics.anl.gov/</ext-link>) as the accession ‘qiime:621'.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Quantifying proteins of interest from metagenomic sequencing data in a fast and accurate manner is a central challenge in microbial community analysis. Whole metagenome shotgun (WMS) sequencing provides millions of short nucleotide sequences (often 100–250 bases long) from the DNA of organisms in a sample; we refer to these short DNA sequences as “reads.” A common approach to profiling protein families from these data involves (i) mapping reads to a database of reference protein sequences followed by (ii) interpreting the mapping results to estimate protein family relative abundance. This process is complicated by regions of local similarity in otherwise unrelated protein families: reads drawn from such regions will map non-specifically, which can result in false positive identifications (reduced specificity). Reducing the time spent on mapping reads is also an important task, as typical metagenomic sequencing depths and reference database sizes continue to grow rapidly.</p>
<p>Protein families are typically profiled in metagenomic sequencing data by one of three approaches: (i) mapping DNA reads to a database of nucleotide sequences [<xref ref-type="bibr" rid="pcbi.1004557.ref001">1</xref>], (ii) mapping translated DNA reads to a database of protein sequences [<xref ref-type="bibr" rid="pcbi.1004557.ref002">2</xref>], or (iii) assembling full-length genes from DNA reads <italic>de novo</italic> and then annotating them via comparison with reference databases [<xref ref-type="bibr" rid="pcbi.1004557.ref003">3</xref>]. Approaches (i) and (ii) rely on homology-based searches, as enabled by programs such as BLAST [<xref ref-type="bibr" rid="pcbi.1004557.ref004">4</xref>], USEARCH [<xref ref-type="bibr" rid="pcbi.1004557.ref005">5</xref>], and RAPSearch2 [<xref ref-type="bibr" rid="pcbi.1004557.ref006">6</xref>]. Methods such as MEGAN [<xref ref-type="bibr" rid="pcbi.1004557.ref007">7</xref>] and HUMAnN [<xref ref-type="bibr" rid="pcbi.1004557.ref002">2</xref>] can achieve very high sensitivity by mapping reads to large nucleotide and protein reference databases. However, this approach is vulnerable to false positives, as a read derived from a given protein-coding sequence may spuriously align to other genes as a result of local sequence homology, as mentioned above [<xref ref-type="bibr" rid="pcbi.1004557.ref008">8</xref>]. Moreover, searching nucleotide sequences against large, full-length protein reference databases comes at great computational cost, as search time is roughly proportional to database size and translated search is more computationally demanding than searching in nucleotide space. Assembly-based methods, while advantageous for identifying new genes, tend to underrepresent known, low-abundance genes, as more reads are required to assemble a gene than to identify it by homology-based search. Like search-based methods, assembly is also challenged by regions of local homology, which may lead to the construction of chimeric contigs.</p>
<p>False positive hits to regions of local homology can be mitigated by identifying and mapping against only unique substrings of protein sequences. This has the added benefit of reducing search time, as the unique portions of each database sequence constitute a smaller search space. One approach to this method involves identifying unique <italic>k</italic>-mers within bacterial protein sequences relative to a larger reference database [<xref ref-type="bibr" rid="pcbi.1004557.ref009">9</xref>]. While this approach makes progress toward increasing specificity and decreasing runtime, exact <italic>k</italic>-mer matching is not always biologically satisfying as it can fail to model common patterns in protein sequence evolution. For example, two peptide <italic>k</italic>-mers that differ by a single substitution between glutamic and aspartic acid (biochemically similar amino acids) are biologically similar, but would be scored as completely distinct by exact <italic>k</italic>-mer matching. Moreover, while <italic>k</italic>-mer approaches focus on matches to unique substrings of specific protein sequences, many metagenomics applications—particularly those involving poorly characterized microbial communities—benefit from alignment to more sequence-diverse protein families.</p>
<p>Here we present ShortBRED (Short, Better Representative Extract Dataset): a method for profiling protein family abundance in metagenomic data by first identifying short peptide markers that (i) are conserved within protein families and (ii) uniquely distinguish families from one another. ShortBRED achieves equivalent sensitivity, enhanced specificity, and enhanced speed relative to profiling strategies that map reads against full-length protein sequences. Unlike <italic>k</italic>-mer based profiling, ShortBRED relies on standard sequence homology-based methods to map reads to peptide markers, thus making it robust to common patterns in protein sequence evolution. By enabling faster, more accurate profiling of protein families in large metagenomes, ShortBRED allows researchers to better measure the prevalence and abundance of protein families of interest, and can lead to better understanding of biological phenomena. As proof-of-principle, we applied ShortBRED to profile antibiotic resistance (AR) families in both human microbiomes and bacterial isolate genomes, revealing new, population-specific, and phylogenetic trends in the distribution of this important class of proteins.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>We developed ShortBRED as a method to quickly and accurately quantify the relative abundance of protein families in WMS sequencing data. ShortBRED profiles protein family abundance in metagenomes by a two-step process: (i) <italic>ShortBRED-Identify</italic> isolates representative peptide sequences (markers) for the protein families, and (ii) <italic>ShortBRED-Quantify</italic> maps metagenomic reads against these markers to determine the relative abundance of their corresponding families (<bold><xref ref-type="fig" rid="pcbi.1004557.g001">Fig 1</xref></bold>). To evaluate ShortBRED, we measured its speed and accuracy in profiling synthetic metagenomes, and then tested its specificity by searching for yeast proteins in a synthetic bacterial metagenome. We next applied ShortBRED to profile AR genes in the gut microbiomes of healthy American [<xref ref-type="bibr" rid="pcbi.1004557.ref010">10</xref>], Chinese [<xref ref-type="bibr" rid="pcbi.1004557.ref011">11</xref>], and Venezuelan and Malawian [<xref ref-type="bibr" rid="pcbi.1004557.ref012">12</xref>] populations, as well as ~3,000 microbial isolate genomes.</p>
<fig id="pcbi.1004557.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004557.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The ShortBRED algorithm.</title>
<p>ShortBRED-Identify creates distinctive markers for protein families of interest. ShortBRED-Quantify maps nucleotides reads to markers and normalizes abundance.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Profiling protein families in metagenomes using representative marker sequences</title>
<p>Current approaches to functional profiling of metagenomic samples often involve mapping reads to full-length protein sequences (e.g. centroid sequences of previously defined protein families). ShortBRED obtains higher speed and specificity relative to these approaches by reducing protein families to short, highly representative peptide sequences (markers), and then mapping reads against only those markers. To create the markers, <italic>ShortBRED-Identify</italic> uses two inputs: (i) a FASTA file of proteins-of-interest and (ii) a comprehensive reference database of additional protein sequences (provided as a FASTA file or preformatted BLAST database; <bold><xref ref-type="fig" rid="pcbi.1004557.g001">Fig 1</xref></bold>). <italic>ShortBRED-Identify</italic> first clusters the protein sequences of interest to identify protein families by global sequence homology, with each collapsed to form a single consensus sequence. Regions of a family’s consensus sequence that share strong, local sequence homology (“overlaps”) with proteins outside of the family are then penalized. Based on these overlaps, ShortBRED then isolates short peptide markers from the consensus that best represent the protein family. We classify these markers into three groups: <italic>True Markers</italic>, which do not overlap with the other protein families, <italic>Junction Markers</italic>, which overlap partially with the other protein families, and <italic>Quasi Markers</italic>, which are completely overlapped by another protein family.</p>
<p>The marker creation process is run once for a given set of proteins, resulting in a reusable and distributable marker database. <italic>ShortBRED-Quantify</italic> then (i) maps WMS sequencing reads against a given protein marker database using a translated search, (ii) counts high-quality hits, (iii) normalizes the counts based on marker length and sequencing depth, and (iv) produces a relative abundance profile of the protein families of interest represented by the marker database (<bold><xref ref-type="fig" rid="pcbi.1004557.g001">Fig 1</xref></bold>). Creating a highly specific marker sequence database has two major advantages: (i) searches against this database are more accurate, as the exclusion of non-specific (overlap) regions reduces false positive hits, and (ii) searches proceed more quickly, as the search space is considerably reduced relative to the full database.</p>
</sec>
<sec id="sec004">
<title>ShortBRED achieves better specificity than mapping reads to centroids</title>
<p>We constructed synthetic datasets to train ShortBRED’s default parameter settings and validate its performance. For one set of AR protein families (ARDB [<xref ref-type="bibr" rid="pcbi.1004557.ref013">13</xref>]) and one set of virulence factor protein families (VFDB [<xref ref-type="bibr" rid="pcbi.1004557.ref014">14</xref>]), we created three synthetic bacterial metagenomes spiked with the proteins of interest at 5%, 10%, and 25% relative abundance. We first tuned ShortBRED’s ability to correctly call the presence and absence of protein families in the 5%-spiked metagenomes by varying the initial protein clustering identity (80%, 85%, 90%, 95%, and 100%) and minimum allowed marker length (8, 10, 12, 15, 18, 20, 22, 25, and 30 amino acids; <bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s001">S1</xref>–<xref ref-type="supplementary-material" rid="pcbi.1004557.s008">S8</xref> Figs</bold>). We first restricted the allowed parameter space to those combinations yielding a specificity of at least 99% in our initial evaluation. From among these combinations, we selected a clustering identity of 85% and minimum marker length of 8 amino acids as ShortBRED’s defaults as they gave the best sensitivity performance on the ARDB-spiked metagenome (there was little variation in performance on the VFDB-spiked metagenome). These parameter settings were used for the remaining analyses in this work; they can be easily tuned with command-line arguments for other applications.</p>
<p>To further validate our parameter settings and ShortBRED’s performance, we generated markers for the ARDB and VFDB protein families based on the optimal settings described above (<bold><xref ref-type="table" rid="pcbi.1004557.t001">Table 1</xref></bold>). We then used these markers to profile six synthetic metagenomes, including the 10%- and 25%-spiked metagenomes that were not used in the training process. We compared ShortBRED to an alternative profiling strategy in which reads were mapped directly to the centroid sequences of protein families. Centroids were obtained by clustering the proteins of interest at 85% identity; during the quantification stage, any matches to centroids with length ≥30 amino acids and ≥95% identity were considered valid hits.</p>
<table-wrap id="pcbi.1004557.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004557.t001</object-id>
<label>Table 1</label> <caption><title>Characteristics of ShortBRED markers used to profile synthetic metagenomes.</title></caption>
<alternatives>
<graphic id="pcbi.1004557.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="left">ARDB</th>
<th align="left">VFDB</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>Families after initial clustering</bold></td>
<td align="right">618</td>
<td align="right">2,089</td>
</tr>
<tr>
<td align="left">    Families with true markers</td>
<td align="right">594</td>
<td align="right">2,041</td>
</tr>
<tr>
<td align="left">    Families without true markers</td>
<td align="right">24</td>
<td align="right">48</td>
</tr>
<tr>
<td align="left"><bold>Total markers</bold></td>
<td align="right">2,886</td>
<td align="right">7,869</td>
</tr>
<tr>
<td align="left">    True markers</td>
<td align="right">2,845</td>
<td align="right">7,730</td>
</tr>
<tr>
<td align="left">    Junction markers</td>
<td align="right">37</td>
<td align="right">139</td>
</tr>
<tr>
<td align="left">    Quasi markers</td>
<td align="right">4</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>Legend: This table lists the number of protein families and maker types present in the ARDB and VFDB markers created by ShortBRED-Identify for profiling synthetic metagenomes.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>An ideal search methodology will correctly identify all protein families present in a metagenome (true positive rate, TPR, equal to 1) and will not erroneously identify any protein families absent from the metagenome (false positive rate, FPR, equal to 0). As we intensify the criteria for calling a family as present (e.g. requiring a higher normalized count for the family), TPR and FPR will both decrease: a tradeoff we quantify using a receiver operating characteristic (ROC) curve (<bold><xref ref-type="fig" rid="pcbi.1004557.g002">Fig 2A and 2B</xref></bold>; <bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s011">S1 Table</xref></bold>). Notably, even treating a single hit to a ShortBRED marker as evidence of the corresponding protein family’s presence resulted in exceptional sensitivity with very low false positives (&lt;5%). As we increased the number of protein families present and the share they comprised of the metagenome, ShortBRED achieved TPR and FPR values comparable to or exceeding those of the centroids method (<bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s011">S1 Table</xref></bold>). Since greater spike-in percentages provided more opportunities for centroids from one cluster to match to reads from another cluster by local homology, the centroids method performed well for the 5%-spiked metagenomes but experienced a substantial drop in specificity at similar levels of sensitivity to ShortBRED in analyses of the 10%- and 25%-spiked metagenomes.</p>
<fig id="pcbi.1004557.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004557.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Accuracy of ShortBRED and centroid-based profiling within synthetic metagenomes.</title>
<p>(<bold>A</bold>, <bold>B</bold>) ROC curves report the sensitivity and specificity (in terms of TPR and FPR) of the two methods for correctly identifying the presence and absence of protein families of interest in six synthetic metagenomes, spiked with 5%, 10%, and 25% of their material from the ARDB (panel A) and VFDB (panel B). (<bold>C</bold>, <bold>D</bold>) Scatterplots of protein family “predicted from mapping”, the abundance values calculated by ShortBRED and the centroids, versus “expected from gold standard”, the abundance values of the protein families in the 10% synthetic metagenome.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.g002" xlink:type="simple"/>
</fig>
<p>Beyond correctly calling protein family presence and absence, an ideal search strategy will be able to accurately quantify the relative abundances of these families in a metagenome, which may vary over several orders of magnitude. Using Spearman’s correlation to compare known and predicted relative abundances, ShortBRED outperformed the centroid-based method in the six Illumina metagenomes (median <italic>r</italic> = 0.95 versus 0.82; <bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s011">S1 Table</xref></bold>). The weaker performance of the centroid-based method was due in part to a larger fraction of false positive detection events (defined to have 0 expected abundance; <bold><xref ref-type="fig" rid="pcbi.1004557.g002">Fig 2C and 2D</xref></bold>). We additionally performed a more challenging evaluation on sequences with either 3% or 5% amino acid substitutions, retaining specificity &gt;0.95 and &gt;0.98 respectively, and sensitivities &gt;0.88 and &gt;0.79 (<bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s011">S1 Table</xref></bold>). This is in contrast to centroid matching on the same datasets, which achieved minimum specificities of only 0.80 and 0.77, respectively. Thus, ShortBRED’s increased specificity not only provides a more accurate qualitative profile of protein family presence and absence, but also contributes to more accurate quantitative profiling. As an additional evaluation of specificity, we applied ShortBRED and the centroid-based profiling method to search for yeast proteins in a synthetic bacterial metagenome. Given that yeast and bacteria are extremely distantly diverged [<xref ref-type="bibr" rid="pcbi.1004557.ref015">15</xref>], homology between a short, bacterial DNA sequence and a yeast protein is likely to have resulted from chance. ShortBRED did not identify any false positive hits to yeast proteins among the bacterial DNA reads, while the centroid-based method produced fifteen high-identity and long-length hits (<bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s012">S2 Table</xref></bold>). The centroid-based profiling method offered some advantages over ShortBRED when working with shallow sequencing data (e.g. as derived from older 454 sequencing experiments), wherein reads are less likely to have been sampled from marker regions (<bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s009">S9 Fig</xref></bold>). However, this limitation vanishes when working with typical modern sequencing depths, while the drawbacks of the centroid-based approach will only grow as typical depths continue to increase.</p>
</sec>
<sec id="sec005">
<title>ShortBRED is faster than centroid-based profiling</title>
<p>In addition to increasing the accuracy of metagenomic search, ShortBRED’s focus on a reduced sequence database (the markers) results in considerably shorter run-times relative to searching against full-length centroids (<bold><xref ref-type="fig" rid="pcbi.1004557.g003">Fig 3</xref></bold>). Focusing on metagenomes spiked with proteins from ARDB, we were able to process ~10,400 reads/sec (on average) by mapping against full-length ARDB centroid sequences, while ShortBRED processed ~19,600 reads/sec using the previously generated ARDB marker sequences (a 1.9x increase in speed). For the VFDB-spiked metagenomes, we were able to map ~5,400 reads/sec against centroid sequences, while ShortBRED processed ~11,300 reads/sec (a 2.1x increase in speed). All mapping experiments were carried out on the same computer hardware using 5 CPU cores and the same underlying mapping program (USEARCH); hence, ShortBRED’s increased speed can be attributed to the reduced size of the marker database. For a modern metagenomics study producing 100s of millions of reads for 100s of samples, this speedup corresponds to savings of 100s of CPU-hours of compute time.</p>
<fig id="pcbi.1004557.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004557.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Speed of execution: ShortBRED versus centroid-based profiling.</title>
<p>Results are based on time used by USEARCH in ShortBRED-Quantify.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec006">
<title>Antibiotic resistance in the human gut microbiome worldwide</title>
<p>We leveraged the improved specificity of ShortBRED to accurately quantify antibiotic resistance (AR) worldwide in the human gut microbiomes of 552 individuals from the United States [<xref ref-type="bibr" rid="pcbi.1004557.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1004557.ref012">12</xref>], China [<xref ref-type="bibr" rid="pcbi.1004557.ref011">11</xref>], Malawi, and Venezuela [<xref ref-type="bibr" rid="pcbi.1004557.ref012">12</xref>] (<bold><xref ref-type="fig" rid="pcbi.1004557.g004">Fig 4</xref> </bold>and <bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s013">S3 Table</xref></bold>). We identified centroid sequences (appropriate for the more shallow 454 sequencing in [<xref ref-type="bibr" rid="pcbi.1004557.ref012">12</xref>]) and ShortBRED markers (for Illumina sequences from 10–12) for 849 AR protein families derived from the ARDB and independent curation [<xref ref-type="bibr" rid="pcbi.1004557.ref016">16</xref>]. These families were further grouped into broader classes such as such as “Class A beta-lactamase” and “quinolone resistance.” 107 microbiome samples based on older 454 sequencing methods were mapped to centroid sequences to avoid loss of sensitivity from low sequencing depths; all other samples were profiled with ShortBRED (see <xref ref-type="sec" rid="sec010">Methods</xref>).</p>
<fig id="pcbi.1004557.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004557.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Antibiotic resistance in the human gut microbiome.</title>
<p>RPKM values produced by ShortBRED for antibiotic resistance protein families, summed by class of resistance. Samples in the USA-Global, Venezuela, and Malawi cohorts were profiled by mapping reads to centroids due to their lower sequencing depth. Marker information is listed in <bold><xref ref-type="table" rid="pcbi.1004557.t002">Table 2</xref></bold>. Samples (columns) were clustered according to Canberra distance and antibiotic resistance families (rows) were clustered according to Euclidean distance.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.g004" xlink:type="simple"/>
</fig>
<p>Our results support AR as a core function in the human gut microbiome, with every individual gut microbiome containing at least one AR determinant (<bold><xref ref-type="fig" rid="pcbi.1004557.g004">Fig 4</xref></bold>). As previously observed [<xref ref-type="bibr" rid="pcbi.1004557.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004557.ref018">18</xref>], resistance to the tetracyclines was the most widespread AR function in the human gut microbiome, with at least one tetracycline resistance mechanism being identified in 99% of individuals across all three studies' global populations (97% ribosomal protection; 87% efflux; 3% inactivation). In addition, Class A beta-lactamases were identified in 90% of individuals and were widespread throughout all populations, with CfxA and CblA the most common variants (as represented by families P30898 at 68.5% prevalence and P30899 at 60.1% prevalence; see <bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s014">S4 Table</xref></bold>). Based on the diversity of participant ages present particularly in the Yatsunenko et al study, these prevalent AR families appear early in life and appear cross-sectionally across a wide range of subject demographics.</p>
<p>Consistent with previous findings [<xref ref-type="bibr" rid="pcbi.1004557.ref019">19</xref>], this global distribution of AR determinants in the human gut microbiome appears to be driven by the underlying bacterial phylogenetic profile. For example, while Class A beta-lactamases are known to be the most diverse and widely disseminated class of beta-lactamase genes [<xref ref-type="bibr" rid="pcbi.1004557.ref020">20</xref>], the most abundant variants (CfxA and CblA) have been previously shown to be specific to <italic>Bacteroides</italic> species [<xref ref-type="bibr" rid="pcbi.1004557.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1004557.ref022">22</xref>]. Hence, enrichment for these families may be a direct marker for the presence of specific bacterial clades in the gut microbiota rather than a response to selective pressures of individual-specific antibiotic use. The relationship between microbiome-specific AR and phylogenetic profiles are addressed in greater detail in subsequent sections.</p>
<p>In addition to the universal AR trends described above, ShortBRED revealed several consistent differences in AR profiles between global populations. For example, Chinese individuals were particularly enriched for a number of AR factors: quinolone resistance, aminoglycoside acetyltransferases, and genes modulating antibiotic efflux. Among these individuals, the two most prevalent quinolone resistance families (variants of fluoroquinolone-resistant DNA topoisomerases) were found in 78% and 29% of individuals, the most prevalent aminoglycoside acetyltransferase (YP_002559372) was found in 99.7% of individuals, and the next-most-prevalent (P13246) followed at 19.3% of individuals. Four gene-modulating antibiotic efflux families (phoQ_1, soxR_5, marA_1, and baeR_2) had individual prevalence values exceeding 58% (<bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s014">S4 Table</xref></bold>). In addition, while many AR genes were discretely strongly present or absent within the Chinese cohort (<bold><xref ref-type="fig" rid="pcbi.1004557.g004">Fig 4</xref></bold>), their gut resistomes were differentiated into four clear clusters based largely on the abundance of antibiotic efflux pumps, including major facilitator superfamily (MFS) antibiotic efflux, resistance/nodulation/cell division (RND) antibiotic efflux, and small multidrug resistance (SMR) antibiotic efflux pumps. Many multidrug antibiotic efflux pumps are chromosomally encoded and highly conserved across all members of a given bacterial species [<xref ref-type="bibr" rid="pcbi.1004557.ref023">23</xref>], further suggesting that observed AR distribution patterns are driven by underlying community membership and phylogeny.</p>
<p>In comparison with the Chinese cohort, gut microbiome samples from the American (HMP) cohort were much more homogeneous. This difference was likely influenced by the greater diversity in membership among the Chinese cohort, which contained individuals with and without type II diabetes and a wide range of ages (13–86). In comparison, the HMP cohort consisted solely of young (ages 18–40), healthy individuals. Differences between the cohorts may also reflect variation in the sampling and sequencing protocols used by their corresponding studies (in addition to real biological variation). American individuals were characterized by increased abundance of four protein families within the Class A beta-lactamases (CfxA_11, AAA22905, P30898, and P30899; <bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s014">S4 Table</xref></bold>). Conversely, these individuals were depleted for aminoglycosides and acetyltranferases. These observed differences between the American and Chinese cohorts stress that, while AR is (at a high level) core to the global human gut microbiome, variation emerges in specific resistances present in individual populations.</p>
</sec>
<sec id="sec007">
<title>Connecting antibiotic resistance to phylogeny</title>
<p>In order to understand and control the spread of AR, it is necessary to characterize the connections between AR determinants, source genomes and their phylogeny, and the relative propensity of horizontal gene transfer (HGT). In addition to their usefulness in metagenomics profiling, ShortBRED markers can aid in this goal by providing highly specific signatures of AR protein families for microbial genome annotation. We used ShortBRED to profile the 849 AR protein families introduced above across 3,305 phylogenetically diverse microbial isolate genomes [<xref ref-type="bibr" rid="pcbi.1004557.ref024">24</xref>] (see <xref ref-type="sec" rid="sec010">Methods</xref>).</p>
<p>Over 40% of microbial isolate genomes surveyed encoded at least one AR determinant, with significant enrichments among particular genera (<bold><xref ref-type="fig" rid="pcbi.1004557.g005">Fig 5</xref></bold>). For example, <italic>Escherichia</italic> and <italic>Salmonella</italic> are closely related bacterial genera that contain many human pathogens [<xref ref-type="bibr" rid="pcbi.1004557.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1004557.ref026">26</xref>]; both were highly enriched for AR determinants. Specifically, all <italic>Escherichia</italic> and <italic>Salmonella</italic> encoded at least one AR class, with an average of 20.3 AR genes for <italic>Escherichia</italic> and 11.2 AR genes for <italic>Salmonella</italic> (<bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s015">S5 Table</xref></bold>). In addition, while these two genera shared many similar AR determinants, they appear to resist beta-lactam antibiotics using largely orthogonal mechanisms: 94.6% of <italic>Escherichia</italic> genomes were enriched for Class C beta-lactamases and were completely depleted of Class B beta-lactamases, while <italic>Salmonella</italic> showed the opposite trend (6.5% of genomes encoded Class C resistance, while all genomes encoded Class B resistance, <bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s010">S10 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004557.s015">S5 Table</xref></bold>). While these examples illustrate cases of strong coupling between AR determinants and particular genera, this was not always the case. For example, glycopeptide resistance was highly variable within the genus <italic>Enterococcus</italic>, with ~1/3 of isolate genomes possessing the function while the remaining 2/3 lacked it.</p>
<fig id="pcbi.1004557.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004557.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Prevalence of antibiotic resistance across bacterial isolate genomes.</title>
<p>Phylogenetic tree of bacterial genomes from IMG [<xref ref-type="bibr" rid="pcbi.1004557.ref024">24</xref>] overlaid with presence/absence of ShortBRED antibiotic resistance protein families. The outermost ring indicates the share of genes in each species’ genome that mapped to any of the AR protein families. This figure was produced using GraPhlAn [<xref ref-type="bibr" rid="pcbi.1004557.ref027">27</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.g005" xlink:type="simple"/>
</fig>
<p>Our observations further suggested that AR functions could be subdivided into two categories of phylogenetic distribution: (i) functions that are clade-specific, i.e. highly conserved across all members of a bacterial clade, and (ii) functions that are broadly distributed across the phylogenetic tree. Both distribution patterns were observed among abundant AR classes in the human gut microbiome (<bold><xref ref-type="fig" rid="pcbi.1004557.g005">Fig 5</xref> </bold>and <bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s015">S5 Table</xref></bold>). For example, multi-drug antibiotic efflux pumps and rRNA methyltransferases showed strong signatures of clade-specific enrichment among the <italic>Staphylococcus</italic>, <italic>Escherichia</italic>, <italic>Salmonella</italic>, and <italic>Yersinia</italic> genera. Functions that are tightly linked to particular clades are notable in that their presence and abundance can be inferred from profiles of community composition alone, including profiles based on lower-resolution amplicon sequencing [<xref ref-type="bibr" rid="pcbi.1004557.ref028">28</xref>]. Conversely, tetracycline ribosomal protection determinants were widely dispersed across the phylogenetic tree—a pattern more consistent with recent spread by mechanisms such as HGT [<xref ref-type="bibr" rid="pcbi.1004557.ref001">1</xref>]. The presence and abundance of functions in this category would be difficult to infer from community profiling and are best quantified directly from a metagenome—a process facilitated by ShortBRED.</p>
</sec>
<sec id="sec008">
<title>Predicting antibiotic resistance profiles from community composition</title>
<p>The previous section stressed that, while some AR functions can be accurately quantified based on microbial community composition, broadly distributed functions pose a greater challenge. To further explore this idea, we compared observed and predicted AR profiles for 82 gut metagenomes from HMP individuals. We predicted the AR profile for a given gut metagenome by first quantifying the sample’s microbial community composition with MetaPhlAn [<xref ref-type="bibr" rid="pcbi.1004557.ref029">29</xref>]. This step resulted in a vector of relative abundance measurements for species present in the sample (in RPKM units). Then, using the ShortBRED based-annotations of AR functions in bacterial genomes described above, we computed the abundance of each AR function in the sample by multiplication. For example, if species A had a relative abundance of 5 RPKM and contained 1 copy of AR protein X, while species B had a relative abundance of 10 RPKM and contained 2 copies of AR protein X, then the total abundance of AR protein X in the metagenome was predicted to be:
<disp-formula id="pcbi.1004557.e001">
<alternatives>
<graphic id="pcbi.1004557.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004557.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mspace width="0.25em"/><mml:mtext>RPKM</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.25em"/><mml:mtext>RPKM</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>25</mml:mn><mml:mspace width="0.25em"/><mml:mtext>RPKM</mml:mtext><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>This procedure was repeated for all samples and AR functions.</p>
<p>At the level of individual AR gene families, ShortBRED and the predicted profiles co-detected 63 families, 57 were detected by ShortBRED but never observed in the predicted profiles, and 14 were predicted to be present but never confirmed by ShortBRED. Among the co-detected families, the average quantitative agreement between the ShortBRED and predicted profiles (as measured by Spearman’s correlation) was 0.43. When gene families were grouped into broader AR classes, 17 were co-detected, 5 were found only by ShortBRED, and 1 was predicted to occur but not confirmed by ShortBRED. Average quantitative agreement for the 17 co-detected classes was 0.33 (Spearman’s correlation). The AR classes most under-represented by the community composition-based predictions were tetracycline ribosomal protection, Class A beta-lactamase, rRNA methyltransferase, MFS antibiotic efflux, and RND antibiotic efflux (<bold><xref ref-type="supplementary-material" rid="pcbi.1004557.s016">S6 Table</xref></bold>). Notably, tetracycline resistance was also among the most broadly-distributed AR classes.</p>
<p>In addition, individual-specific ShortBRED-based versus predicted AR profiles showed poor quantitative agreement (average Spearman correlation = 0.53). There are a number of reasons why the two profiles would agree poorly on an individual basis or for particular AR families. While ShortBRED is able to profile AR gene abundance in cases where the genes are present in uncharacterized genomes, the taxonomic profile method is limited to species with known isolate genomes. Hence, predicting AR content from taxonomic composition will tend to underestimate AR content, and explains why ShortBRED detects several families that the predictive method does not. In instances where multiple isolate genomes were available for a species detected in a sample, the species’ contributions were based on the median gene copy number for each AR family across its isolate genomes. If the sample isolate contained fewer copies of an AR gene than the median estimate, then we would tend to overestimate its abundance; conversely, if the sample isolate contained more copies of an AR gene than the median estimate, then we would tend to underestimate its abundance (both serving to weaken signal-to-noise ratio among the predictions). For these reasons, directly profiling AR content in a metagenome is preferable to predicting functional content from community composition. ShortBRED offers a means to profile AR content and other protein families in a fast, highly specific manner.</p>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>In this work, we have presented and validated ShortBRED: a tool to build short peptide markers for protein families and then apply them to profile protein family content in a metagenomic sequencing sample. We demonstrated that ShortBRED is both faster and more accurate than the common approach of mapping reads to full-length protein family centroid sequences. ShortBRED is extensible to a diverse collection of functional profiling tasks. The most straightforward of these was demonstrated in our profiling of antibiotic resistance in human gut metagenomes, which we discuss further below. Although this example was based on DNA sequence data, ShortBRED’s markers are also applicable for profiling microbial community RNA-Seq data (metatranscriptomics), which reveals the relative functional activity of protein families in a community. In addition to profiling meta’omic sequencing data, ShortBRED’s markers have proven useful for identifying protein families of interest in microbial isolate genomes, as the markers’ small sizes and highly representative sequences facilitate rapid, unambiguous gene annotation. The functional profiles produced in these applications are amenable to a variety of downstream analysis methods, including comparing functional composition in case versus control samples or monitoring temporal variation in functional composition or activity from longitudinal samples.</p>
<p>Mapping metagenomic reads to protein families of interest is an example of a search problem in which new queries (samples) arise more frequently than changes to the database (proteins of interest). In such cases, it is desirable to pre-process the database in order to accelerate downstream search. ShortBRED accomplishes this by reducing large numbers of protein sequences first to clusters of related proteins (families) and then to representative peptide markers. Searching a new metagenomic sample against these marker sequences represents a considerable savings in computation relative to searching against the full database. ShortBRED’s pre-processing steps, while not computationally trivial, can reduce a collection of ~1,000 protein families to identifying markers in a matter of hours on typical desktop or server hardware (i.e. taking advantage of multiple CPU cores for parallelization, but not requiring special high-memory or accelerated file I/O configurations). The bottleneck in this process is the BLAST-based search of the proteins of interest against the universal protein reference database. In the future, it may be possible to further accelerate pre-processing steps by incorporating an alternative program for protein homology search, provided that it meets or exceeds BLAST’s sensitivity. In the same vein, downstream performance mapping reads to markers depends largely on the speed of ShortBRED’s chosen translated search tool (currently USEARCH), which could also be replaced or supplemented by future alternatives.</p>
<p>In our evaluations, the vast majority of protein families could be identified by one or more unique amino acid subsequences (True Markers). Although these sequences are used here for protein family identification and quantification, they are themselves interesting targets for investigation. For example, the conservation of these sequences within a family may indicate the presence of a functionally relevant domain, peptide recognition motif, or enzyme active site. The small minority of protein families that lacked unique identifying subsequences are also worthy of consideration (<bold>Tables <xref ref-type="table" rid="pcbi.1004557.t001">1</xref> </bold>and <bold><xref ref-type="table" rid="pcbi.1004557.t002">2</xref></bold>). In such cases, ShortBRED constructs a Quasi Marker to represent the family: i.e. the amino acid sub-sequence which, while not unique to the family, is found in a minimal number of other families. Users may wish to exclude Quasi Markers (and their associated families) in their analyses to increase specificity. That said, Quasi Markers were always included in the analyses reported here and were found to compromise specificity only slightly (far less than the centroid-based approach; <bold><xref ref-type="fig" rid="pcbi.1004557.g002">Fig 2</xref> </bold>and <bold><xref ref-type="table" rid="pcbi.1004557.t002">Table 2</xref></bold>). In the future, an expectation maximization (EM) step could be incorporated in ShortBRED-Quantify to improve the accuracy of protein family quantification when mapping reads to ambiguous Quasi-Markers</p>
<table-wrap id="pcbi.1004557.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004557.t002</object-id>
<label>Table 2</label> <caption><title>Characteristics of ShortBRED markers used to profile metagenomes and bacterial genomes.</title></caption>
<alternatives>
<graphic id="pcbi.1004557.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="left">HMP</th>
<th align="left">T2D</th>
<th align="left">T2D_Short</th>
<th align="left">Yatsunenko</th>
<th align="left">Bacterial Genomes</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>Parameter settings</bold></td>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left">Clustering ID</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
</tr>
<tr>
<td align="left">Minimum marker length</td>
<td align="right">85%</td>
<td align="right">85%</td>
<td align="right">85%</td>
<td align="right">85%</td>
<td align="right">85%</td>
</tr>
<tr>
<td align="left">Average read BP</td>
<td align="right">101</td>
<td align="right">90</td>
<td align="right">75</td>
<td align="right">450</td>
<td align="right">100</td>
</tr>
<tr>
<td align="left">Min trusted BP</td>
<td align="right">90</td>
<td align="right">81</td>
<td align="right">68</td>
<td align="right">200</td>
<td align="right">30</td>
</tr>
<tr>
<td align="left">QM length</td>
<td align="right">30</td>
<td align="right">27</td>
<td align="right">22</td>
<td align="right">66</td>
<td align="right">33</td>
</tr>
<tr>
<td align="left"><bold>Statistics</bold></td>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left">Families after initial clustering</td>
<td align="right">849</td>
<td align="right">849</td>
<td align="right">849</td>
<td align="right">849</td>
<td align="right">849</td>
</tr>
<tr>
<td align="left">    Families with true markers</td>
<td align="right">820</td>
<td align="right">820</td>
<td align="right">820</td>
<td align="center"><xref ref-type="table-fn" rid="t002fn002">**</xref></td>
<td align="right">820</td>
</tr>
<tr>
<td align="left">    Families without true markers</td>
<td align="right">29</td>
<td align="right">29</td>
<td align="right">29</td>
<td align="center"><xref ref-type="table-fn" rid="t002fn002">**</xref></td>
<td align="right">29</td>
</tr>
<tr>
<td align="left"><bold>Total markers</bold></td>
<td align="right">4132</td>
<td align="right">4135</td>
<td align="right">4142</td>
<td align="center"><xref ref-type="table-fn" rid="t002fn002">**</xref></td>
<td align="right">4132</td>
</tr>
<tr>
<td align="left">        True markers</td>
<td align="right">4078</td>
<td align="right">4078</td>
<td align="right">4078</td>
<td align="center"><xref ref-type="table-fn" rid="t002fn002">**</xref></td>
<td align="right">4078</td>
</tr>
<tr>
<td align="left">        Junction markers</td>
<td align="right">48</td>
<td align="right">50</td>
<td align="right">61</td>
<td align="center"><xref ref-type="table-fn" rid="t002fn002">**</xref></td>
<td align="right">48</td>
</tr>
<tr>
<td align="left">        Quasi markers</td>
<td align="right">6</td>
<td align="right">7</td>
<td align="right">3</td>
<td align="center"><xref ref-type="table-fn" rid="t002fn002">**</xref></td>
<td align="right">6</td>
</tr>
<tr>
<td align="left"><bold>Dataset profiled</bold></td>
<td align="right"/>
<td align="right"/>
<td align="right"/>
<td align="center"/>
<td align="right"/>
</tr>
<tr>
<td align="left">        Samples profiled</td>
<td align="right">82</td>
<td align="right">272</td>
<td align="right">91</td>
<td align="center">107</td>
<td align="right">3305</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001"><p>Legend: This table lists characteristics of the markers used to profile the metagenomes and bacterial genomes. Each metagenome from the Chinese cohort was profiled with one of two sets of markers (T2D and T2D_Short) corresponding to the two different read sizes used in the dataset (90 and 75 bp) None of the families without True Markers were combined in the second round of clustering.</p></fn>
<fn id="t002fn002"><p>** Centroids were used to profile the Yatsunenko dataset.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>We demonstrated ShortBRED’s utility by generating and applying AR gene markers to profile AR gene content in 552 human gut metagenomes and 3,305 bacterial isolate genomes. AR determinants in pathogens are increasingly compromising infectious disease treatment due to their acquisition from commensal or environmental bacteria [<xref ref-type="bibr" rid="pcbi.1004557.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1004557.ref031">31</xref>]. The human gut microbiome serves as a transferable reservoir of AR readily available to human pathogens [<xref ref-type="bibr" rid="pcbi.1004557.ref032">32</xref>], leading to an increased focus on characterization and quantification of AR genes in large metagenomic studies [<xref ref-type="bibr" rid="pcbi.1004557.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004557.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1004557.ref033">33</xref>]. However, accurate quantification of AR genes using short reads is challenging: AR determinants are often originally genes with diverse native functions repurposed through mutation or expression modulation to provide AR [<xref ref-type="bibr" rid="pcbi.1004557.ref034">34</xref>], therefore sharing large sequence similarity to genes with no AR function. For example, when particular RND efflux pumps (such as CmeABC, AcrB, and Mex) highly expressed, they are capable of exporting multiple antibiotics [<xref ref-type="bibr" rid="pcbi.1004557.ref035">35</xref>]. However, members of the RND efflux pump superfamily also serve important functions as transporters of proteins required for nodulation and cell division and, while they do not always demonstrate inherent AR activity, they share high sequence similarity with proteins shown to serve resistance functions. As a result, previous attempts to profile antibiotic resistance in human gut metagenomes by mapping short reads to full-length protein sequences may have been compromised by spurious mapping events.</p>
<p>Our ShortBRED-based profiles avoided this complication by using only the most information-rich portions of AR genes for identification and quantification of AR in microbial communities and isolate genomes. Notably, our results agree with several of the major findings from previous profiling attempts, specifically (i) high relative abundance of AR genes in the gut microbiota of Chinese individuals compared to individuals from other countries as well as (ii) ubiquity of tetracycline resistance worldwide [<xref ref-type="bibr" rid="pcbi.1004557.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004557.ref018">18</xref>]. Hence, we can be confident that these results are not the result of spurious mapping to full-length protein sequences. ShortBRED demonstrated increased sensitivity for identification of additional classes of AR genes, including resistance to the quinolone class of antibiotics. The application of ShortBRED to the identification and quantification of AR genes in microbial communities addresses a significant challenge in the computational investigation of AR using high-throughput sequencing technology. In addition, just as ShortBRED markers enabled confident differentiation between closely-related AR and non-AR proteins in metagenomes, the same advantage applied to annotating full-length protein sequences in bacterial isolate genomes. Indeed, we used this method to dissect phylogenetic properties of the AR families under study, revealing distinct patterns of clade-specific versus broad distribution. In the future, the same technique could be applied to quickly and accurately determine AR gene content in a newly-sequenced bacterial strain—an application with relevance to infectious disease management.</p>
<p>To facilitate such applications, the antibiotic resistance markers produced here are available for download, along with the ShortBRED software and documentation, at the ShortBRED website: <ext-link ext-link-type="uri" xlink:href="http://huttenhower.sph.harvard.edu/shortbred" xlink:type="simple">http://huttenhower.sph.harvard.edu/shortbred</ext-link>. Although the preceding examples have focused on applying ShortBRED to profile antibiotic resistance in genomes and metagenomes, this is only one possible application. Indeed, the same analyses described above can be applied to a wide range of protein families of interest, limited largely by the imagination of the user. To that end, users who produce marker sets with ShortBRED and who would also like to share them with the scientific community are encouraged to submit the markers (along with a relevant citation) for posting on the ShortBRED website.</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec011">
<title>Creating protein family-specific marker sequences with ShortBRED-Identify</title>
<p>ShortBRED-Identify takes two inputs: (i) a FASTA file of proteins of interest and (ii) a comprehensive catalog of reference protein sequences (as a FASTA file or preformatted BLAST database). The reference database used here was based on version 3.5 of the Integrated Microbial Genomes database [<xref ref-type="bibr" rid="pcbi.1004557.ref024">24</xref>]. The full version of this database contained 12,607,998 protein coding sequences, which we previously reduced to 4,981,629 representative protein coding sequences proteins by clustering at 80% nucleotide identity [<xref ref-type="bibr" rid="pcbi.1004557.ref036">36</xref>]. As of this writing, IMG is no longer available for download, and we recommend using UniRef100 or UniRef90 as alternative comprehensive protein reference datasets [<xref ref-type="bibr" rid="pcbi.1004557.ref037">37</xref>].</p>
<p>ShortBRED-Identify first clusters the proteins of interest at 85% identity using CD-HIT [<xref ref-type="bibr" rid="pcbi.1004557.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1004557.ref039">39</xref>] to group them into highly conserved protein families. For each clustered protein family, ShortBRED-Identify first calls MUSCLE [<xref ref-type="bibr" rid="pcbi.1004557.ref040">40</xref>] to generate a multiple sequence alignment (MSA) for the family, then uses Biopython [<xref ref-type="bibr" rid="pcbi.1004557.ref041">41</xref>] to generate a consensus sequence for the MSA. If the most common amino acid for a given MSA column occurred in less than 95% of sequences, the corresponding position in the consensus sequence is marked as ambiguous (“X”).</p>
<p>ShortBRED-Identify then uses BLAST [<xref ref-type="bibr" rid="pcbi.1004557.ref004">4</xref>] to query consensus sequences (i) against one another and (ii) against the reference protein database. The results of these searches are used to identify short segments of each consensus sequence that align with high sequence identity (≥90%) to unrelated proteins in the reference database, or share high identity with a length greater than 80% of minimum marker length with other consensus sequences. (A short sequence is defined as having a length between 80% of the minimum marker length and 15% of a target sequence in the reference database.) Metagenomic reads derived from such segments will be prone to false positive matches across protein families. ShortBRED-Identify thus interprets the BLAST results to find segments of a consensus sequence that participate in a minimal number of such alignments (markers) and then uses these sequences as a basis for more accurate functional profiling. Consensus sequences from different families can share long regions of similarity even after initial clustering at high sequence identity. Because of this, ShortBRED-Identify penalizes high-identity alignments of any length greater than 80% of marker length between pairs of consensus sequences in order to minimize inter-family false positives. ShortBRED does not penalize high-coverage, high-identity alignments between a consensus sequence and a protein from the reference database, as such proteins are likely members of the protein family represented by the consensus.</p>
<p>ShortBRED counts the number of times each amino acid of each consensus sequence appeared in a valid alignment with another protein. These “overlap counts” are then used to identify the most representative segments (markers) for the consensus. For a given consensus sequence, ShortBRED will first try to build as many “True Markers” as possible. A True Marker is a contiguous sequence of amino acids with zero overlap count; i.e. the corresponding peptide was unique among the consensus sequences and non-member reference sequences. If no True Markers are found above a minimum length (with a default of 8 amino acids), ShortBRED next tries to make up to three “Junction Markers” for the consensus sequence. A Junction Marker is a sequence of amino acids that partially overlaps with other consensus sequences or reference sequences, but is not completely overlapped by any single consensus or reference sequence. Note that when mapping reads to marker sequences, ShortBRED-Quantify requires high-identity (≥95%) and high-length (minimum of the marker’s length or 95% of a read length), and hence these partial overlaps will not lead to false positive matches. If it is not possible to build a True Marker or a Junction Marker for a consensus sequence, ShortBRED-Identify will create a single “Quasi Marker” for the consensus, which is a sequence of amino acids above a given minimum length (with a default of 33 amino acids) that has the lowest total adjusted overlap count. The adjusted overlap count is the fourth root of the raw overlap count, and helps to down-weight very short outlier regions with extremely high overlap counts. Protein families with similar Quasi Markers and Junction Markers (≥95% identity) are merged, and then all marker sequences are output as a FASTA file for use by ShortBRED-Quantify.</p>
<p>For Junction Markers and Quasi Markers, ShortBRED also lists the percentage of each marker that overlaps with each other consensus sequence. Each sequence is given a weight, which is defined as its total length in amino acids divided by the sum of that value, and all overlapping amino acids from other reference or consensus sequences. The weight is printed in the FASTA header, along with other highly overlapping consensus sequences from the input database. An additional text file lists the overlapping regions from the consensus sequences and the reference database.</p>
<p>This ShortBRED-Identify process requires ~100 CPU-hours to complete given a set of proteins of interest which cluster to ~1,000 protein families. The bottleneck in this process is the BLAST-based search of the protein family consensus sequences against the comprehensive reference database. Notably, this process is highly parallelizable, as each consensus sequence can be searched independently of the others. By allowing ShortBRED-Identify to use multiple cores during the search process, the actual run-time can be reduced considerably. Once the initial BLAST results have been generated, new markers can be generated in a few minutes provided that the initial clustering identity and consensus thresholds are not changed. Precomputed markers for the antibiotic resistance proteins (ARDB) [<xref ref-type="bibr" rid="pcbi.1004557.ref013">13</xref>] and virulence factors (VFDB) [<xref ref-type="bibr" rid="pcbi.1004557.ref014">14</xref>] are available for download at <ext-link ext-link-type="uri" xlink:href="http://huttenhower.sph.harvard.edu/shortbred" xlink:type="simple">http://huttenhower.sph.harvard.edu/shortbred</ext-link>. Notably, the ShortBRED-Identify process needs to be applied only once to produce a set of markers, which can then be used repeatedly to profile metagenomic datasets using ShortBRED-Quantify.</p>
</sec>
<sec id="sec012">
<title>Profiling protein family metagenomic abundance with ShortBRED-Quantify</title>
<p>After markers have been created for each protein family, the user can call ShortBRED-Quantify to profile the relative abundance of these families in a whole metagenomic shotgun (WMS) sequencing sample. ShortBRED-Quantify calls USEARCH [<xref ref-type="bibr" rid="pcbi.1004557.ref005">5</xref>] to find the best matching marker for each nucleotide read. USEARCH specializes in fast search for high-identity matches, which fits with ShortBRED’s objective of profiling metagenomic samples quickly with high specificity.</p>
<p>By default, ShortBRED-Quantify will record a hit to a marker if the resulting alignment has at least 95% identity, and is at least as long as the minimum of (i) the marker length or (ii) 95% of the read length. For each marker, ShortBRED-Quantify computes an adjusted marker length, which takes into account how much of the marker is available to participate in a hit meeting our length and percent identity requirements. When a marker of length L is longer than the average read length (R), a read from the corresponding gene anywhere in the region from 5% downstream of the marker to 5% upstream of the marker is allowed to align to the marker. Therefore, the adjusted marker length (L’) is:
<disp-formula id="pcbi.1004557.e002">
<alternatives>
<graphic id="pcbi.1004557.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004557.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>0.9</mml:mn><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>When the marker is shorter than the expected read length (L&lt;R), the we require the entire marker to align to the read. Thus, the adjusted marker length is:
<disp-formula id="pcbi.1004557.e003">
<alternatives>
<graphic id="pcbi.1004557.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004557.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>ShortBRED then normalizes the number of raw USEARCH hits to a marker (H) to produce a normalized count (C), adjusting for average read length, marker length, and sequencing depth (number of reads in the sample, N):
<disp-formula id="pcbi.1004557.e004">
<alternatives>
<graphic id="pcbi.1004557.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004557.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The normalized count is in units of RPKMs (reads per kilobase of reference sequence per million sample reads). For protein families characterized by multiple markers, a normalized count is first computed for each marker separately and then the median of these values is taken to represent the protein family; this procedure adds robustness to variation in sequencing depth across the markers. Finally, ShortBRED-Quantify outputs these normalized counts as a relative abundance table for the protein families of interest.</p>
</sec>
<sec id="sec013">
<title>Creation of synthetic spiked metagenomes</title>
<p>We used GemSim [<xref ref-type="bibr" rid="pcbi.1004557.ref042">42</xref>] to create synthetic metagenomes containing five million 100 nucleotide-long reads, designed to mimic a typical WMS-sequencing run on an Illumina HiSeq instrument (Illumina, San Diego, CA). Reads were drawn from twenty bacterial genomes obtained from the KEGG database [<xref ref-type="bibr" rid="pcbi.1004557.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1004557.ref044">44</xref>]. We used USEARCH [<xref ref-type="bibr" rid="pcbi.1004557.ref005">5</xref>] to identify and exclude from these genomes any naturally-occurring antibiotics resistance genes and virulence factors (defined as a sequence matching a gene from the ARDB or VFDB with &gt;90% identity). This ensured that the only ARDB and VFDB sequences in our synthetic metagenomes were those that had been artificially spiked in for the purposes of evaluating ShortBRED. Each bacterial genome was assigned an abundance value drawn from a log-normal distribution with unit mean and standard deviation.</p>
<p>We created six Illumina-like synthetic metagenomes with material spiked in from the ARDB and VFDB sequence datasets. Three metagenomes were made for each dataset, with 150, 500, and 1,000 genes from the corresponding protein dataset spiked among the genomic reads at 5%, 10%, and 25% relative abundance. Two additional sets of Illumina-like synthetic metagenomes were created with 3% and 5% of the amino acid content of the sequences mutated based on relative amino acid mutability and transition probabilities from the BLOSUM62 table. An additional set of six metagenomes were created using the same procedure but based on a simulated 454 sequencing instrument (454 Life Sciences, Branford, CT); these samples contained only 155,890 reads each, consistent with the lower sequencing depth of the 454 platform. We used 164 nucleotide sequences corresponding to ARDB protein sequences as a base for the ARDB metagenomes and 2,296 VFDB nucleotide sequences as a base for VFDB metagenomes. Nucleotide sequences were not always provided for ARDB proteins; in these cases, we used the EMBOSS program <italic>backtranseq</italic> [<xref ref-type="bibr" rid="pcbi.1004557.ref045">45</xref>] to create nucleotide sequences that were compatible with the available amino acid sequences.</p>
<p>Code for creating the synthetic metagenomes can be found at <ext-link ext-link-type="uri" xlink:href="http://bitbucket.org/biobakery/shortbred_doit" xlink:type="simple">http://bitbucket.org/biobakery/shortbred_doit</ext-link>.</p>
</sec>
<sec id="sec014">
<title>Application of ShortBRED to human gut metagenomes</title>
<p>We applied ShortBRED to profile antibiotic resistance (AR) in the human gut microbiome. We first produced a set of new AR marker sequences by applying ShortBRED-Identify to a combination of (i) a curated version of the ARDB which we obtained by deleting sequences no longer stored at NCBI and (ii) a set of known antibiotic resistance genes obtained from resistant bacterial libraries. We then used ShortBRED-Quantify to profile the relative abundance of corresponding AR protein families across 552 gut metagenomes: 82 from U.S. adults sampled during the Human Microbiome Project (HMP) [<xref ref-type="bibr" rid="pcbi.1004557.ref010">10</xref>], 363 from Chinese adults with and without diabetes [<xref ref-type="bibr" rid="pcbi.1004557.ref011">11</xref>], and 107 individuals from Malawi, Venezuela, and the U.S. [<xref ref-type="bibr" rid="pcbi.1004557.ref012">12</xref>]. We used the first-visit samples from multi-visit HMP subjects to avoid redundancy. For 454-based samples characterized by sub-optimal sequencing depth, we mapped reads to full-length centroid sequences to avoid compromising sensitivity.</p>
</sec>
<sec id="sec015">
<title>Application of ShortBRED to bacterial isolate genomes</title>
<p>ShortBRED can be applied to identify protein families in a bacterial isolate genome given a corresponding set of ShortBRED markers for those families. To do so, ShortBRED first creates a USEARCH database for the genome and then searches the markers against that database (allowing for multiple hits per marker query). For protein families characterized by more than one marker sequence, ShortBRED requires that a critical fraction of the markers map to a gene in the genome before assigning it to that protein family. The default value for this cutoff is 10% [i.e. 1 in 10 markers], but it can be tuned to be more conservative.</p>
</sec>
</sec>
<sec id="sec016">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004557.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Training/testing of ShortBRED’s default parameters–ARDB AUC.</title>
<p>Values reflect area under the ROC curve (AUC) as minimum marker length and initial clustering ID are varied. This analysis was based on the 5%-spiked synthetic metagenomes containing ARDB sequences.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Training/testing of ShortBRED’s default parameters–VFDB AUC.</title>
<p>Values reflect area under the ROC curve (AUC) as minimum marker length and initial clustering ID are varied. This analysis was based on the 5%-spiked synthetic metagenomes containing VFDB sequences.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Training/testing of ShortBRED’s default parameters–ARDB specificity.</title>
<p>Values reflect specificity as minimum marker length and initial clustering ID are varied. This analysis was based on the 5%-spiked synthetic metagenomes containing ARDB sequences.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Training/testing of ShortBRED’s default parameters–VFDB specificity.</title>
<p>Values reflect specificity as minimum marker length and initial clustering ID are varied. This analysis was based on the 5%-spiked synthetic metagenomes containing VFDB sequences.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Training/testing of ShortBRED’s default parameters–ARDB sensitivity.</title>
<p>Values reflect sensitivity as minimum marker length and initial clustering ID are varied. This analysis was based on the 5%-spiked synthetic metagenomes containing ARDB sequences.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Training/testing of ShortBRED’s default parameters–VFDB sensitivity.</title>
<p>Values reflect sensitivity as minimum marker length and initial clustering ID are varied. This analysis was based on the 5%-spiked synthetic metagenomes containing VF sequences.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Training/testing of ShortBRED’s default parameters–ARDB Spearman correlation.</title>
<p>Values reflect Spearman correlation between estimated abundances and true abundances as minimum marker length and initial clustering ID are varied. This analysis was based on the 5%-spiked synthetic metagenomes containing ARDB sequences.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Training/testing of ShortBRED’s default parameters–VFDB Spearman correlation.</title>
<p>Values reflect Spearman correlation between estimated abundances and true abundances as minimum marker length and initial clustering ID are varied. This analysis was based on the 5%-spiked synthetic metagenomes containing VFDB sequences.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Accuracy of ShortBRED and centroid-based mapping in applications involving 454 sequencing data.</title>
<p>(<bold>A</bold>) and (<bold>B</bold>) report the sensitivity and specificity of the two methods for mapping reads to their correct families on six synthetic 454 metagenomes, spiked with 5%, 10%, and 25% of their material from the ARDB (panel A) and VFDB (panel B). (<bold>C</bold>) and (<bold>D</bold>) display scatterplots of protein family “predicted by mapping”, the abundance values calculated by ShortBRED and the centroids, vs. “expected from gold standard”, the abundance values of the protein families in the 10% synthetic metagenome. This figure is an analog of <xref ref-type="fig" rid="pcbi.1004557.g002">Fig 2</xref> from the main text.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s010" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Prevalence of all antibiotic resistance classes across bacterial isolate genomes.</title>
<p>Phylogenetic tree of bacterial genomes from IMG [<xref ref-type="bibr" rid="pcbi.1004557.ref024">24</xref>] overlaid with presence/absence of ShortBRED antibiotic resistance protein families. The outermost ring indicates the share of genes in the species’ genome that mapped to any of the AR protein families.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s011" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s011" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Performance of ShortBRED and centroid method across synthetic metagenomes.</title>
<p>This table displays measures of the performance of ShortBRED and centroids to profile synthetic metagenomes. The results for ShortBRED using its default settings on the six synthetic metagenomes are in bold. Illumina_05,Illumina_10, and Illumina_25 represent synthetic Illumina metagenomes with reads from input dataset sequences comprising 5%, 10%, and 25% of the metagenome. Illumina-mutated-3pct and Illumina-mutated-5pct metagenomes had 3% and 5% of their amino acid content mutated before being incorporated into the metagenome. Centroids were also obtained by clustering at 85% identity. Any result mapping to centroid with length ≥30 and ID ≥95% was considered a “match”.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s012" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s012" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>False positive yeast hits detected by centroids in synthetic bacterial metagenome.</title>
<p>These are yeast centroids which had false positive matches to reads from a synthetic bacterial metagenome at high identity (≥95%) and long length ≥30 amino acids. Source: Kyoto Encyclopedia of Genes and Genomes (KEGG) (Kanehisa et al, 2000 and 2012)</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s013" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s013" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>ShortBRED counts (RPKM) by AR family for each microbiome sample.</title>
<p>Each row of this table represents a family of antibiotic resistance (AR) proteins and each column corresponds to a sample in our dataset. The abundance of the AR family in the sample is given in RPKM.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s014" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s014" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Summary statistics of ShortBRED counts for AR families in metagenomes.</title>
<p>Each row represents a family of antibiotic resistance (AR) proteins. Column B lists the corresponding AR class. (The classes are groups of AR families.) The columns provide summary statistics of the ShortBRED RPKM counts for each family. Sample statistics for columns C through I are based on the entire sample of all three datasets. Summary statistics are also provided for the individual three datasets. Please note that the Yatsunenko et al dataset results were based on running ShortBRED using the centroids, as opposed to the markers from ShortBRED-Identify. This is because this particular dataset has shallower coverage than the Illumina datasets (HMP and T2D).</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s015" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s015" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>Summary statistics of AR ORF counts in bacterial genomes by AR class.</title>
<p>Each row in this table represents summary statistics for the abundance of a particular AR class in a genus of bacteria. We used 3,305 bacterial genomes obtained from the Integrated Microbial Genomes database. In "annotated genome" mode, ShortBRED takes a fasta file of open reading frames from the genome, calls USEARCH to build a database, and then checks the markers against the database for hits.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004557.s016" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004557.s016" xlink:type="simple">
<label>S6 Table</label>
<caption>
<title>ShortBRED count for AR class minus count for "genome by median gene" method.</title>
<p>This table presents the differences between counting antibiotic resistance (AR) abundance in microbiome samples using ShortBRED, and inferring AR abundance in the same samples based on the abundance of bacteria in the microbiome multiplied by the median count of each AR class found in available bacterial genomes. Each row is a class, each column is sample from the HMP and the value in each cell equals [ShortBRED Count in RPKM—Sum(Bacterial Genome's Abundance in Sample * Median ShortBRED AR Count Across Copies of Bacterial Genome in our 3,305 isolates from IMG.]</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Levi Waldron, Timothy L. Tickle, Joseph Moon, Xochitl C. Morgan, and Daniela Börnigen provided helpful feedback throughout ShortBRED’s development and initial application.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004557.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smillie</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cordero</surname> <given-names>OX</given-names></name>, <name name-style="western"><surname>David</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Alm</surname> <given-names>EJ</given-names></name>. <article-title>Ecology drives a global network of gene exchange connecting the human microbiome</article-title>. <source>Nature</source>. <year>2011</year>;<volume>480</volume>(<issue>7376</issue>):<fpage>241</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10571" xlink:type="simple">10.1038/nature10571</ext-link></comment> <object-id pub-id-type="pmid">22037308</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abubucker</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Segata</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Goll</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schubert</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Izard</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cantarel</surname> <given-names>BL</given-names></name>, <etal>et al</etal>. <article-title>Metabolic reconstruction for metagenomic data and its application to the human microbiome</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>6</issue>):<fpage>e1002358</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002358" xlink:type="simple">10.1371/journal.pcbi.1002358</ext-link></comment> <object-id pub-id-type="pmid">22719234</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Raes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Arumugam</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Burgdorf</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Manichanh</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A human gut microbial gene catalogue established by metagenomic sequencing</article-title>. <source>Nature</source>. <year>2010</year>;<volume>464</volume>(<issue>7285</issue>):<fpage>59</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08821" xlink:type="simple">10.1038/nature08821</ext-link></comment> <object-id pub-id-type="pmid">20203603</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Gish</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Lipman</surname> <given-names>DJ</given-names></name>. <article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source>. <year>1990</year>;<volume>215</volume>(<issue>3</issue>):<fpage>403</fpage>–<lpage>10</lpage>. <object-id pub-id-type="pmid">2231712</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>Search and clustering orders of magnitude faster than BLAST</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>19</issue>):<fpage>2460</fpage>–<lpage>1</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq461" xlink:type="simple">10.1093/bioinformatics/btq461</ext-link></comment> <object-id pub-id-type="pmid">20709691</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ye</surname> <given-names>Y</given-names></name>. <article-title>RAPSearch2: a fast and memory-efficient protein similarity search tool for next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>1</issue>):<fpage>125</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr595" xlink:type="simple">10.1093/bioinformatics/btr595</ext-link></comment> <object-id pub-id-type="pmid">22039206</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Auch</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Qi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schuster</surname> <given-names>SC</given-names></name>. <article-title>MEGAN analysis of metagenomic data</article-title>. <source>Genome Res</source>. <year>2007</year>;<volume>17</volume>(<issue>3</issue>):<fpage>377</fpage>–<lpage>86</lpage>. <object-id pub-id-type="pmid">17255551</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carr</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Borenstein</surname> <given-names>E</given-names></name>. <article-title>Comparative analysis of functional metagenomic annotation and the mappability of short reads</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>8</issue>):<fpage>e105776</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0105776" xlink:type="simple">10.1371/journal.pone.0105776</ext-link></comment> <object-id pub-id-type="pmid">25148512</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berendzen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bruno</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Cohn</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Hengartner</surname> <given-names>NW</given-names></name>, <name name-style="western"><surname>Kuske</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>McMahon</surname> <given-names>BH</given-names></name>, <etal>et al</etal>. <article-title>Rapid phylogenetic and functional classification of short genomic fragments with signature peptides</article-title>. <source>BMC Res Notes</source>. <year>2012</year>;<volume>5</volume>:<fpage>460</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1756-0500-5-460" xlink:type="simple">10.1186/1756-0500-5-460</ext-link></comment> <object-id pub-id-type="pmid">22925230</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><collab>The Human Microbiome Project Consortium</collab>. <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>207</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11234" xlink:type="simple">10.1038/nature11234</ext-link></comment> <object-id pub-id-type="pmid">22699609</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Cai</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>F</given-names></name>, <etal>et al</etal>. <article-title>A metagenome-wide association study of gut microbiota in type 2 diabetes</article-title>. <source>Nature</source>. <year>2012</year>;<volume>490</volume>(<issue>7418</issue>):<fpage>55</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11450" xlink:type="simple">10.1038/nature11450</ext-link></comment> <object-id pub-id-type="pmid">23023125</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yatsunenko</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Rey</surname> <given-names>FE</given-names></name>, <name name-style="western"><surname>Manary</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Trehan</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Dominguez-Bello</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Contreras</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Human gut microbiome viewed across age and geography</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>222</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11053" xlink:type="simple">10.1038/nature11053</ext-link></comment> <object-id pub-id-type="pmid">22699611</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Pop</surname> <given-names>M</given-names></name>. <article-title>ARDB—Antibiotic Resistance Genes Database</article-title>. <source>Nucleic Acids Res</source>. <year>2009</year>;<volume>37</volume>(Database issue):<fpage>D443</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkn656" xlink:type="simple">10.1093/nar/gkn656</ext-link></comment> <object-id pub-id-type="pmid">18832362</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Xiong</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>Q</given-names></name>. <article-title>VFDB 2012 update: toward the genetic diversity and molecular evolution of bacterial virulence factors</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume>(Database issue):<fpage>D641</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr989" xlink:type="simple">10.1093/nar/gkr989</ext-link></comment> <object-id pub-id-type="pmid">22067448</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Doolittle</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Tsang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cho</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Little</surname> <given-names>E</given-names></name>. <article-title>Determining divergence times of the major kingdoms of living organisms with a protein clock</article-title>. <source>Science</source>. <year>1996</year>;<volume>271</volume>(<issue>5248</issue>):<fpage>470</fpage>–<lpage>7</lpage>. <object-id pub-id-type="pmid">8560259</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gibson</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Forsberg</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Dantas</surname> <given-names>G</given-names></name>. <article-title>Improved annotation of antibiotic resistance determinants reveals microbial resistomes cluster by ecology</article-title>. <source>Isme j</source>. <year>2015</year>;<volume>9</volume>(<issue>1</issue>):<fpage>207</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ismej.2014.106" xlink:type="simple">10.1038/ismej.2014.106</ext-link></comment> <object-id pub-id-type="pmid">25003965</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Forslund</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sunagawa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kultima</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Mende</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Arumugam</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Typas</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Country-specific antibiotic use practices impact the human gut resistome</article-title>. <source>Genome Res</source>. <year>2013</year>;<volume>23</volume>(<issue>7</issue>):<fpage>1163</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.155465.113" xlink:type="simple">10.1101/gr.155465.113</ext-link></comment> <object-id pub-id-type="pmid">23568836</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Qin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Metagenome-wide analysis of antibiotic resistance genes in a large cohort of human gut microbiota</article-title>. <source>Nat Commun</source>. <year>2013</year>;<volume>4</volume>:<fpage>2151</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms3151" xlink:type="simple">10.1038/ncomms3151</ext-link></comment> <object-id pub-id-type="pmid">23877117</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Forsberg</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Patel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Lauber</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Fierer</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Bacterial phylogeny structures soil resistomes across habitats</article-title>. <source>Nature</source>. <year>2014</year>;<volume>509</volume>(<issue>7502</issue>):<fpage>612</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature13377" xlink:type="simple">10.1038/nature13377</ext-link></comment> <object-id pub-id-type="pmid">24847883</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hawkey</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>AM</given-names></name>. <article-title>The changing epidemiology of resistance</article-title>. <source>J Antimicrob Chemother</source>. <year>2009</year>;<volume>64</volume> <issue>Suppl 1</issue>:<fpage>i3</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/jac/dkp256" xlink:type="simple">10.1093/jac/dkp256</ext-link></comment> <object-id pub-id-type="pmid">19675017</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Bennett</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Parker</surname> <given-names>AC</given-names></name>. <article-title>Molecular and genetic analysis of the Bacteroides uniformis cephalosporinase gene, cblA, encoding the species-specific beta-lactamase</article-title>. <source>Antimicrob Agents Chemother</source>. <year>1994</year>;<volume>38</volume>(<issue>8</issue>):<fpage>1711</fpage>–<lpage>5</lpage>. <object-id pub-id-type="pmid">7985999</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parker</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>CJ</given-names></name>. <article-title>Genetic and biochemical analysis of a novel Ambler class A beta-lactamase responsible for cefoxitin resistance in Bacteroides species</article-title>. <source>Antimicrob Agents Chemother</source>. <year>1993</year>;<volume>37</volume>(<issue>5</issue>):<fpage>1028</fpage>–<lpage>36</lpage>. <object-id pub-id-type="pmid">8517690</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alvarez-Ortega</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Olivares</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Martinez</surname> <given-names>JL</given-names></name>. <article-title>RND multidrug efflux pumps: what are they good for?</article-title> <source>Front Microbiol</source>. <year>2013</year>;<volume>4</volume>:<fpage>7</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fmicb.2013.00007" xlink:type="simple">10.3389/fmicb.2013.00007</ext-link></comment> <object-id pub-id-type="pmid">23386844</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Markowitz</surname> <given-names>VM</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Palaniappan</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Szeto</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Grechkin</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>IMG: the Integrated Microbial Genomes database and comparative analysis system</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume>(Database issue):<fpage>D115</fpage>–<lpage>22</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1044" xlink:type="simple">10.1093/nar/gkr1044</ext-link></comment> <object-id pub-id-type="pmid">22194640</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kaper</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Nataro</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Mobley</surname> <given-names>HL</given-names></name>. <article-title>Pathogenic Escherichia coli</article-title>. <source>Nat Rev Microbiol</source>. <year>2004</year>;<volume>2</volume>(<issue>2</issue>):<fpage>123</fpage>–<lpage>40</lpage>. <object-id pub-id-type="pmid">15040260</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Coburn</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Grassl</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Finlay</surname> <given-names>BB</given-names></name>. <article-title>Salmonella, the host and disease: a brief review</article-title>. <source>Immunol Cell Biol</source>. <year>2007</year>;<volume>85</volume>(<issue>2</issue>):<fpage>112</fpage>–<lpage>8</lpage>. <object-id pub-id-type="pmid">17146467</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Asnicar</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Weingart</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Tickle</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Huttenhower</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Segata</surname> <given-names>N</given-names></name>. <article-title>Compact graphical representation of phylogenetic data and metadata with GraPhlAn</article-title>. <source>PeerJ</source>. <year>2015</year>;<volume>3</volume>:<fpage>e1029</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.7717/peerj.1029" xlink:type="simple">10.7717/peerj.1029</ext-link></comment> <object-id pub-id-type="pmid">26157614</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Langille</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Zaneveld</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Caporaso</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>McDonald</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Knights</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Predictive functional profiling of microbial communities using 16S rRNA marker gene sequences</article-title>. <source>Nat Biotechnol</source>. <year>2013</year>;<volume>31</volume>(<issue>9</issue>):<fpage>814</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2676" xlink:type="simple">10.1038/nbt.2676</ext-link></comment> <object-id pub-id-type="pmid">23975157</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Segata</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Waldron</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ballarini</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Narasimhan</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Jousson</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Huttenhower</surname> <given-names>C</given-names></name>. <article-title>Metagenomic microbial community profiling using unique clade-specific marker genes</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>(<issue>8</issue>):<fpage>811</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2066" xlink:type="simple">10.1038/nmeth.2066</ext-link></comment> <object-id pub-id-type="pmid">22688413</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Forsberg</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Selleck</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Sommer</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Dantas</surname> <given-names>G</given-names></name>. <article-title>The shared antibiotic resistome of soil bacteria and human pathogens</article-title>. <source>Science</source>. <year>2012</year>;<volume>337</volume>(<issue>6098</issue>):<fpage>1107</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1220761" xlink:type="simple">10.1126/science.1220761</ext-link></comment> <object-id pub-id-type="pmid">22936781</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Poirel</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Rodriguez-Martinez</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Mammeri</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Liard</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nordmann</surname> <given-names>P</given-names></name>. <article-title>Origin of plasmid-mediated quinolone resistance determinant QnrA</article-title>. <source>Antimicrob Agents Chemother</source>. <year>2005</year>;<volume>49</volume>(<issue>8</issue>):<fpage>3523</fpage>–<lpage>5</lpage>. <object-id pub-id-type="pmid">16048974</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shoemaker</surname> <given-names>NB</given-names></name>, <name name-style="western"><surname>Vlamakis</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hayes</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Salyers</surname> <given-names>AA</given-names></name>. <article-title>Evidence for extensive resistance gene transfer among Bacteroides spp. and among Bacteroides and other genera in the human colon</article-title>. <source>Appl Environ Microbiol</source>. <year>2001</year>;<volume>67</volume>(<issue>2</issue>):<fpage>561</fpage>–<lpage>8</lpage>. <object-id pub-id-type="pmid">11157217</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nesme</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cecillon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Delmont</surname> <given-names>TO</given-names></name>, <name name-style="western"><surname>Monier</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Vogel</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Simonet</surname> <given-names>P</given-names></name>. <article-title>Large-scale metagenomic-based study of antibiotic resistance in the environment</article-title>. <source>Curr Biol</source>. <year>2014</year>;<volume>24</volume>(<issue>10</issue>):<fpage>1096</fpage>–<lpage>100</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cub.2014.03.036" xlink:type="simple">10.1016/j.cub.2014.03.036</ext-link></comment> <object-id pub-id-type="pmid">24814145</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martinez</surname> <given-names>JL</given-names></name>. <article-title>Antibiotics and antibiotic resistance genes in natural environments</article-title>. <source>Science</source>. <year>2008</year>;<volume>321</volume>(<issue>5887</issue>):<fpage>365</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1159483" xlink:type="simple">10.1126/science.1159483</ext-link></comment> <object-id pub-id-type="pmid">18635792</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Webber</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Piddock</surname> <given-names>LJ</given-names></name>. <article-title>The importance of efflux pumps in bacterial antibiotic resistance</article-title>. <source>J Antimicrob Chemother</source>. <year>2003</year>;<volume>51</volume>(<issue>1</issue>):<fpage>9</fpage>–<lpage>11</lpage>. <object-id pub-id-type="pmid">12493781</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Segata</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bornigen</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Morgan</surname> <given-names>XC</given-names></name>, <name name-style="western"><surname>Huttenhower</surname> <given-names>C</given-names></name>. <article-title>PhyloPhlAn is a new method for improved phylogenetic and taxonomic placement of microbes</article-title>. <source>Nat Commun</source>. <year>2013</year>;<volume>4</volume>:<fpage>2304</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms3304" xlink:type="simple">10.1038/ncomms3304</ext-link></comment> <object-id pub-id-type="pmid">23942190</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Suzek</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>McGarvey</surname> <given-names>PB</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>UniProt</surname> <given-names>C</given-names></name>. <article-title>UniRef clusters: a comprehensive and scalable alternative for improving sequence similarity searches</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>6</issue>):<fpage>926</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu739" xlink:type="simple">10.1093/bioinformatics/btu739</ext-link></comment> <object-id pub-id-type="pmid">25398609</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Niu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>. <article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>23</issue>):<fpage>3150</fpage>–<lpage>2</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts565" xlink:type="simple">10.1093/bioinformatics/bts565</ext-link></comment> <object-id pub-id-type="pmid">23060610</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Godzik</surname> <given-names>A</given-names></name>. <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1658</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">16731699</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res</source>. <year>2004</year>;<volume>32</volume>(<issue>5</issue>):<fpage>1792</fpage>–<lpage>7</lpage>. <object-id pub-id-type="pmid">15034147</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cock</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Antao</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Chapman</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Cox</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Dalke</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>11</issue>):<fpage>1422</fpage>–<lpage>3</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp163" xlink:type="simple">10.1093/bioinformatics/btp163</ext-link></comment> <object-id pub-id-type="pmid">19304878</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McElroy</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Luciani</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>T</given-names></name>. <article-title>GemSIM: general, error-model based simulator of next-generation sequencing data</article-title>. <source>BMC Genomics</source>. <year>2012</year>;<volume>13</volume>:<fpage>74</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-13-74" xlink:type="simple">10.1186/1471-2164-13-74</ext-link></comment> <object-id pub-id-type="pmid">22336055</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sato</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kawashima</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Furumichi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tanabe</surname> <given-names>M</given-names></name>. <article-title>Data, information, knowledge and principle: back to metabolism in KEGG</article-title>. <source>Nucleic Acids Res</source>. <year>2014</year>;<volume>42</volume>(Database issue):<fpage>D199</fpage>–<lpage>205</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt1076" xlink:type="simple">10.1093/nar/gkt1076</ext-link></comment> <object-id pub-id-type="pmid">24214961</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>. <article-title>KEGG: kyoto encyclopedia of genes and genomes</article-title>. <source>Nucleic Acids Res</source>. <year>2000</year>;<volume>28</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>30</lpage>. <object-id pub-id-type="pmid">10592173</object-id></mixed-citation></ref>
<ref id="pcbi.1004557.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rice</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Longden</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Bleasby</surname> <given-names>A</given-names></name>. <article-title>EMBOSS: the European Molecular Biology Open Software Suite</article-title>. <source>Trends Genet</source>. <year>2000</year>;<volume>16</volume>(<issue>6</issue>):<fpage>276</fpage>–<lpage>7</lpage>. <object-id pub-id-type="pmid">10827456</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>