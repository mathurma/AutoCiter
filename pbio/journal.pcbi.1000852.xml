<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-1330R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000852</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Computational Biology/Macromolecular Sequence Analysis</subject><subject>Computational Biology/Protein Homology Detection</subject><subject>Computational Biology/Sequence Motif Analysis</subject></subj-group></article-categories><title-group><article-title>The Construction and Use of Log-Odds Substitution Scores for Multiple Sequence Alignment</article-title><alt-title alt-title-type="running-head">Log-Odds Scores for Multiple Alignment</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Altschul</surname><given-names>Stephen F.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Wootton</surname><given-names>John C.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Zaslavsky</surname><given-names>Elena</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Yu</surname><given-names>Yi-Kuo</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>National Center for Biotechnology Information, National Library of Medicine, National Institutes of Health, Bethesda, Maryland, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Center for Translational Systems Biology and Department of Neurology, Mount Sinai School of Medicine, New York, New York, United States of America</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Siepel</surname><given-names>Adam</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Cornell University, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">altschul@ncbi.nlm.nih.gov</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: SFA JCW EZ YKY. Performed the experiments: SFA JCW YKY. Analyzed the data: SFA JCW YKY. Wrote the paper: SFA JCW EZ YKY. Developed mathematical theory: SFA YKY.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>7</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>15</day><month>7</month><year>2010</year></pub-date><volume>6</volume><issue>7</issue><elocation-id>e1000852</elocation-id><history>
<date date-type="received"><day>30</day><month>10</month><year>2009</year></date>
<date date-type="accepted"><day>3</day><month>6</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Public Domain declaration which stipulates that, once placed in the public domain, this work may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose.</license-p></license></permissions><abstract>
<p>Most pairwise and multiple sequence alignment programs seek alignments with optimal scores. Central to defining such scores is selecting a set of substitution scores for aligned amino acids or nucleotides. For local pairwise alignment, substitution scores are implicitly of log-odds form. We now extend the log-odds formalism to multiple alignments, using Bayesian methods to construct “BILD” (“<underline>B</underline>ayesian <underline>I</underline>ntegral <underline>L</underline>og-o<underline>d</underline>ds”) substitution scores from prior distributions describing columns of related letters. This approach has been used previously only to define scores for aligning individual sequences to sequence profiles, but it has much broader applicability. We describe how to calculate BILD scores efficiently, and illustrate their uses in Gibbs sampling optimization procedures, gapped alignment, and the construction of hidden Markov model profiles. BILD scores enable automated selection of optimal motif and domain model widths, and can inform the decision of whether to include a sequence in a multiple alignment, and the selection of insertion and deletion locations. Other applications include the classification of related sequences into subfamilies, and the definition of profile-profile alignment scores. Although a fully realized multiple alignment program must rely upon more than substitution scores, many existing multiple alignment programs can be modified to employ BILD scores. We illustrate how simple BILD score based strategies can enhance the recognition of DNA binding domains, including the Api-AP2 domain in <italic>Toxoplasma gondii</italic> and <italic>Plasmodium falciparum</italic>.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Multiple sequence alignment is a fundamental tool of biological research, widely used to identify important regions of DNA or protein molecules, to infer their biological functions, to reconstruct ancestries, and in numerous other applications. The effectiveness and accuracy of sequence comparison programs depends crucially upon the quality of the scoring systems they use to measure sequence similarity. To compare pairs of DNA or protein sequences, the best strategy for constructing similarity measures has long been understood, but there has been a lack of consensus about how to measure similarity among multiple (i.e. more than two) sequences. In this paper, we describe a natural generalization to multiple alignment of the accepted measure of pairwise similarity. A large variety of methods that are used to compare and analyze DNA or protein molecules, or to model protein domain families, could be rendered more sensitive and precise by adopting this similarity measure. We illustrate how our measure can enhance the recognition of important DNA binding domains.</p>
</abstract><funding-group><funding-statement>This work was supported by the Intramural Research Program of the National Library of Medicine at the National Institutes of Health (SFA, JCW, Y-KY), and NIH NIAID contract HHSN266200500021C (EZ). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="17"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Protein and DNA sequence alignment is a fundamental tool of computational molecular biology. It is used for functional prediction, genome annotation, the discovery of functional elements and motifs, homology-based structure prediction and modeling, phylogenetic reconstruction, and in numerous other applications. The effectiveness of alignment programs depends crucially upon the scoring systems they employ to evaluate possible alignments. For pairwise alignments, scores typically are defined as the sum of “substitution scores” for aligning pairs of letters (amino acids or nucleotides), and “gap scores” for aligning letters in one sequence with null characters between letters in the other. Substitution and gap scores may be generalized to multiple alignments, i.e. those involving three or more sequences.</p>
<p>Most useful local pairwise alignment algorithms allow gaps and explicitly assign them scores <xref ref-type="bibr" rid="pcbi.1000852-Smith1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Altschul1">[4]</xref>. However, many local multiple alignment algorithms do not allow gaps, or allow them only implicitly as spacers between distinct ungapped alignment blocks. Indeed the alignments recorded in some protein family databases are explicitly constructed with ungapped alignment blocks separated by variable length spacers <xref ref-type="bibr" rid="pcbi.1000852-MarchlerBauer1">[5]</xref>, and it has been argued that this formalism corresponds well to the observed relationships imposed by protein structure <xref ref-type="bibr" rid="pcbi.1000852-Kann1">[6]</xref>. Short ungapped blocks are also used in the DNA context, to represent, for example, transcription factor binding sites.</p>
<p>Many pairwise substitution scores have been developed for protein <xref ref-type="bibr" rid="pcbi.1000852-Dayhoff1">[7]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Goonesekere1">[20]</xref> and DNA <xref ref-type="bibr" rid="pcbi.1000852-States1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Chiaromonte1">[22]</xref> sequence comparison, and a statistical theory for substitution scores has been developed for local alignments without gaps <xref ref-type="bibr" rid="pcbi.1000852-Karlin1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Dembo1">[24]</xref>. It is not trivial to generalize pairwise scoring systems to multiple alignments, and the following four principal approaches have been proposed to this long-standing problem: A) <italic>Tree scores</italic>. An evolutionary tree can be defined relating the sequences in question, with each sequence residing at one leaf of the tree. By reconstructing letters at the internal nodes of the tree, the score for an aligned column of letters is defined as the sum of pairwise substitution scores for all edges of the tree <xref ref-type="bibr" rid="pcbi.1000852-Sankoff1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Sankoff2">[26]</xref>. B) <italic>Star scores</italic>. As a special case of tree-scores, a single “consensus” letter can be defined for an alignment column. The column score is defined as the sum of pairwise scores for the consensus letter to each letter in the column. The tree in question reduces to a star, with the consensus at the central node. C) <italic>Sum-of-the-Pairs or SP scores</italic>. A column score can be constructed as the sum of substitution scores for all pairs of letters in the column <xref ref-type="bibr" rid="pcbi.1000852-Murata1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Bacon1">[28]</xref>. D) <italic>Entropy scores</italic>. Scores can be based on the entropy of the letter frequencies observed in a column <xref ref-type="bibr" rid="pcbi.1000852-Schneider1">[29]</xref>; these scores have become particularly popular for DNA alignments. All these approaches are open to refinement, for example by weighting the pairwise scores of the sequences involved.</p>
<p>All reasonable substitution scores for pairwise local alignment are implicitly log-odds scores <xref ref-type="bibr" rid="pcbi.1000852-Karlin1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Altschul2">[30]</xref>, which compare the probabilities of aligning two letters under models of relatedness and non-relatedness, and the most popular are explicitly so constructed <xref ref-type="bibr" rid="pcbi.1000852-Dayhoff1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Schwartz1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Henikoff1">[14]</xref>. We argue that multiple alignment column scores should be similarly constructed, based upon explicit target frequency predictions for columns from accurate alignments of related sequences. For this purpose, we propose, the method with the strongest theoretical foundation relies upon the specification of a Bayesian prior, over the space of multinomial distributions for describing alignment columns representing true biological relationships <xref ref-type="bibr" rid="pcbi.1000852-Brown1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Sjlander1">[32]</xref>. We call column scores based on such a formalism “<underline>B</underline>ayesian <underline>I</underline>ntegral <underline>L</underline>og-o<underline>d</underline>ds” or BILD scores. Although these scores are implicit in earlier work, their full generality and utility has not been recognized. They may be calculated efficiently, and may be generalized to allow for the differential weighting of sequences in a multiple alignment. We also consider an alternative approach that allows log-odds column scores to be derived from any pairwise substitution matrix.</p>
<p>Given their form, multiple alignment log-odds scores can be used directly to define the proper extent of multiple alignment blocks, and to derive natural scores for profile-profile comparison. We show that they also arise from the perspective of the Minimum Description Length Principle <xref ref-type="bibr" rid="pcbi.1000852-Grnwald1">[33]</xref>, which allows them to be combined naturally with other information theoretic measures. Other direct applications are specifying when a sequence should be included in a multiple alignment at all, and when an alignment of many related sequences is better split into several alignments each involving fewer sequences.</p>
<p>Efficient methods for calculating BILD scores allow them to be incorporated into Gibbs sampling algorithms for ungapped local multiple alignment. Most practical protein applications, however, require provisions for gaps. We describe two methods for extending an ungapped local multiple alignment produced by the Gibbs sampling strategy to a gapped alignment, the first using asymmetric affine gap costs, and the second hidden Markov models. In the latter, column BILD scores inform the construction of position-specific gap costs, and yield gapped alignments in greater conformity with considerations of protein structure. We illustrate the applications of the programs by using them to uncover previously undescribed Api-AP2 domains of <italic>Toxoplasma gondii</italic> and <italic>Plasmodium falciparum</italic>.</p>
<p>Multiple sequence alignment comprises a diverse set of problems and approaches. Many sophisticated statistical inference techniques have been applied to the multiple alignment problem and to the related problem of phylogenetic reconstruction, e.g. <xref ref-type="bibr" rid="pcbi.1000852-Xing1">[34]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Satija1">[37]</xref>. It is not our purpose here to develop a new multiple alignment program. Rather, we seek only to argue that the “substitution scores” for multiple alignment columns which lie at the core of most multiple alignment methods can in many cases be improved. Although many statistical alignment methods are Bayesian-based, the BILD scores directly implied by Bayesian reasoning have been heretofore unrecognized.</p>
</sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<sec id="s2a">
<title>Multiple Alignment Log-Odd Scores</title>
<p>Log-odds pairwise substitution scores can be written <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e001" xlink:type="simple"/></inline-formula>. Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e002" xlink:type="simple"/></inline-formula> is the frequency with which residues <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e003" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e004" xlink:type="simple"/></inline-formula> correspond in accurate alignments of related sequences, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e005" xlink:type="simple"/></inline-formula> is the background probability with which residue <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e006" xlink:type="simple"/></inline-formula> occurs. The base of the logarithm is arbitrary, and merely defines a scale for the scoring system. We henceforth assume that unless the natural logarithm is specified, all logarithms are base <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e007" xlink:type="simple"/></inline-formula>, and the resulting scores are therefore in the units of bits <xref ref-type="bibr" rid="pcbi.1000852-Altschul2">[30]</xref>. Note that no target frequencies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e008" xlink:type="simple"/></inline-formula> are uniquely optimal for pairwise sequence alignment, because different <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e009" xlink:type="simple"/></inline-formula> are appropriate for comparing sequences diverged by different amounts of evolution <xref ref-type="bibr" rid="pcbi.1000852-Dayhoff1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Schwartz1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Gonnet1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Altschul2">[30]</xref>. This perception gives rise to families of substitution matrices, such as the PAM <xref ref-type="bibr" rid="pcbi.1000852-Dayhoff1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Schwartz1">[8]</xref> and BLOSUM <xref ref-type="bibr" rid="pcbi.1000852-Henikoff1">[14]</xref> series for protein comparison.</p>
<p>To generalize log-odds scores to multiple alignments, we first develop some notation. We consider the alphabet <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e010" xlink:type="simple"/></inline-formula> from which the letters in our sequences are drawn to consist of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e011" xlink:type="simple"/></inline-formula> elements, which for convenience we represent by the numbers 1 through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e012" xlink:type="simple"/></inline-formula>. An ungapped column from a multiple alignment of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e013" xlink:type="simple"/></inline-formula> sequences is a vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e014" xlink:type="simple"/></inline-formula>, each of whose components <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e015" xlink:type="simple"/></inline-formula> through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e016" xlink:type="simple"/></inline-formula> takes on a value in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e017" xlink:type="simple"/></inline-formula>. In essence, the log-odds approach compares two theories, one in which all the letters aligned are related or homologous, and the other in which none are. Each theory implies a probability for observing any given set of data. For the alignment column <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e018" xlink:type="simple"/></inline-formula>, we define <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e019" xlink:type="simple"/></inline-formula> as the probability of observing the data under the assumption of relatedness, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e020" xlink:type="simple"/></inline-formula> under the assumption of non-relatedness. Then the log-odds score for this column is defined as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e021" xlink:type="simple"/><label>(1)</label></disp-formula>Assuming background probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e022" xlink:type="simple"/></inline-formula> through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e023" xlink:type="simple"/></inline-formula> for the various letters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e024" xlink:type="simple"/></inline-formula> is given simply by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e025" xlink:type="simple"/><label>(2)</label></disp-formula>We will consider one primary strategy for deriving <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e026" xlink:type="simple"/></inline-formula>. As with pairwise scores, all sets of multiple alignment column scores with negative expected value are implicitly log-odds scores <xref ref-type="bibr" rid="pcbi.1000852-Karlin1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Altschul2">[30]</xref>. However, unless their values for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e027" xlink:type="simple"/></inline-formula> are explicitly constructed in a sensible way, log-odds scores are unlikely to perform well in the applications suggested below.</p>
<p>For alignments of more than two sequences, there are of course other possibilities than for all or none of the sequences to be related. However, as we will describe below, scores of the form of equation (1) can be applied to the comparison of sequences where only a subset are related, by adding indicator variables to include or exclude sequences.</p>
<p>Log-odds scores <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e028" xlink:type="simple"/></inline-formula> for alignment columns immediately suggest substitution scores <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e029" xlink:type="simple"/></inline-formula> for aligning two different columns of letters. Specifically, letting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e030" xlink:type="simple"/></inline-formula> be the concatenation of the vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e031" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e032" xlink:type="simple"/></inline-formula>, define<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e033" xlink:type="simple"/><label>(3)</label></disp-formula>These column-column alignment scores may be used consistently in progressive alignment algorithms, which proceed by aligning the most closely related sequences first <xref ref-type="bibr" rid="pcbi.1000852-Feng2">[38]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Thompson1">[39]</xref>, although as will be discussed below problems may arise in the definition of gap scores. They may also be used for profile-profile alignment, a topic of considerable recent interest <xref ref-type="bibr" rid="pcbi.1000852-Pietrokovski1">[40]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Sding1">[48]</xref>.</p>
</sec><sec id="s2b">
<title>BILD Scores</title>
<p>For multiple alignments, perhaps the best approach to defining and calculating <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e034" xlink:type="simple"/></inline-formula> is a Bayesian one <xref ref-type="bibr" rid="pcbi.1000852-Brown1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Sjlander1">[32]</xref>. (An alternative approach, based on pairwise scoring matrices, is described in <xref ref-type="supplementary-material" rid="pcbi.1000852.s001">Text S1</xref>.) Assume that the letters in a specific column from an accurate alignment of related sequences are generated independently, but with probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e035" xlink:type="simple"/></inline-formula> through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e036" xlink:type="simple"/></inline-formula> that in general differ from the background probabilities. Assume further that it is possible to assign a prior probability distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e037" xlink:type="simple"/></inline-formula> to the multinomial distributions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e038" xlink:type="simple"/></inline-formula> associated with columns of related letters. This prior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e039" xlink:type="simple"/></inline-formula> can be derived from a detailed study of related protein or DNA sequences.</p>
<p>Although the data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e040" xlink:type="simple"/></inline-formula> associated with a specific column generally have no temporal or other privileged order, assume for convenience that they are observed sequentially, in the order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e041" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e042" xlink:type="simple"/></inline-formula>. Then we may apply Bayes' theorem to transform the prior distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e043" xlink:type="simple"/></inline-formula> to a posterior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e044" xlink:type="simple"/></inline-formula>, after the observation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e045" xlink:type="simple"/></inline-formula>. More generally, each subsequent observation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e046" xlink:type="simple"/></inline-formula> can be seen to transform the prior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e047" xlink:type="simple"/></inline-formula> into a posterior distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e048" xlink:type="simple"/></inline-formula>. We may then use the chain rule to write<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e049" xlink:type="simple"/><label>(4)</label></disp-formula>The individual terms in this product may be calculated by integrating over all possible multinomial distributions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e050" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e051" xlink:type="simple"/><label>(5)</label></disp-formula>Finally, combining equations (1), (2) and (4) yields<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e052" xlink:type="simple"/><label>(6)</label></disp-formula></p>
<p>We call scores defined in this way Bayesian Integral Log-odds or BILD scores. They can be understood simply as the sum of log-odds scores for the individual letters observed in a column, with the “target frequency” for each letter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e053" xlink:type="simple"/></inline-formula> calculated based upon the prior distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e054" xlink:type="simple"/></inline-formula>, and the “previously observed” letters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e055" xlink:type="simple"/></inline-formula> through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e056" xlink:type="simple"/></inline-formula>. Even though, by this formula, the log-odds score for a letter varies with its position in the column, the total column score is nevertheless invariant under permutation of the column's letters.</p>
<p>BILD scores have some conceptual connections to star- and entropy-based multiple alignment scoring systems. The simplest generalization of star scores imposes a prior probability distribution on the consensus letter, but still assumes a probabilistic pairwise substitution model. As we describe in <xref ref-type="supplementary-material" rid="pcbi.1000852.s001">Text S1</xref>, this yields a class of log-odds scores we call MELD scores. BILD scores arise, in contrast, by thinking of the “consensus” not as an ancestral letter, but rather as a generative probabilistic model, and by integrating over a prior distribution placed on this model.</p>
<p>Given observed and background letter distributions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e057" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e058" xlink:type="simple"/></inline-formula>, entropy scores have been defined variously, and conceptually distinctly, as: i) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e059" xlink:type="simple"/></inline-formula>, the entropy difference between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e060" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e061" xlink:type="simple"/></inline-formula>; ii) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e062" xlink:type="simple"/></inline-formula>, the entropy difference between a uniform distribution on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e063" xlink:type="simple"/></inline-formula> letters and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e064" xlink:type="simple"/></inline-formula>; and iii) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e065" xlink:type="simple"/></inline-formula>, the relative entropy of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e066" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e067" xlink:type="simple"/></inline-formula>. Definitions i) and ii) differ only by a constant. One may refine any of these definitions by taking <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e068" xlink:type="simple"/></inline-formula> to be a posterior letter distribution, derived from a prior and a set of observations. Both BILD and entropy-based scores can be viewed as the sum of scores derived from the probabilities for individual observations. The central distinction is that BILD scores estimate the probability for a given such observation using only “earlier” ones, whereas entropy scores estimate this probability using the complete collection of observations.</p>
</sec><sec id="s2c">
<title>Dirichlet Distributions</title>
<p>Although the definition of BILD scores is valid for any prior distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e069" xlink:type="simple"/></inline-formula> one wishes to specify, it is in general impractical to calculate the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e070" xlink:type="simple"/></inline-formula>, or the integral in equation (5), except when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e071" xlink:type="simple"/></inline-formula> takes the form of a Dirichlet distribution <xref ref-type="bibr" rid="pcbi.1000852-MacKay1">[49]</xref>, or a mixture of a finite number of Dirichlet distributions <xref ref-type="bibr" rid="pcbi.1000852-Brown1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Sjlander1">[32]</xref>. In this case, as described below, all the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e072" xlink:type="simple"/></inline-formula> are also Dirichlet distributions, or Dirichlet mixtures, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e073" xlink:type="simple"/></inline-formula> is easily calculated. Therefore, for mathematical as opposed to biological reasons, we always assume that BILD scores are defined using a Dirichlet or Dirichlet mixture prior. The family of Dirichlet mixtures, however, is rich enough that it can capture well much relevant prior knowledge concerning relationships among the various amino acids or nucleotides.</p>
<p>We review here the essentials of Dirichlet distributions. A multinomial distribution on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e074" xlink:type="simple"/></inline-formula> letters is specified by an <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e075" xlink:type="simple"/></inline-formula>-dimensional vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e076" xlink:type="simple"/></inline-formula>, within the simplex defined by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e077" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e078" xlink:type="simple"/></inline-formula>. The requirement that the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e079" xlink:type="simple"/></inline-formula> sum to 1 renders the space of multinomials <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e080" xlink:type="simple"/></inline-formula> dimensional. A Dirichlet distribution, defined over this space, is parametrized by an <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e081" xlink:type="simple"/></inline-formula>-dimensional vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e082" xlink:type="simple"/></inline-formula> with all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e083" xlink:type="simple"/></inline-formula> positive. We shall sometimes refer to such a distribution by its parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e084" xlink:type="simple"/></inline-formula>, and we define <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e085" xlink:type="simple"/></inline-formula> as the sum of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e086" xlink:type="simple"/></inline-formula>. The Dirichlet distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e087" xlink:type="simple"/></inline-formula> is given by the probability density function<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e088" xlink:type="simple"/><label>(7)</label></disp-formula>where the normalizing scalar <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e089" xlink:type="simple"/></inline-formula> ensures that integrating <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e090" xlink:type="simple"/></inline-formula> over its domain yields 1. Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e091" xlink:type="simple"/></inline-formula>, is the Gamma function, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e092" xlink:type="simple"/></inline-formula> for positive integral <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e093" xlink:type="simple"/></inline-formula>. The uniform density is a special case that arises when all the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e094" xlink:type="simple"/></inline-formula> are 1.</p>
<p>Dirichlet distributions have two convenient properties. First, the expected frequency of letter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e095" xlink:type="simple"/></inline-formula> implied by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e096" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e097" xlink:type="simple"/></inline-formula>. Second, the posterior distribution yielded by Bayes' theorem, after the observation of the letter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e098" xlink:type="simple"/></inline-formula>, is a Dirichlet distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e099" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e100" xlink:type="simple"/></inline-formula>, but with all other parameters equal to those of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e101" xlink:type="simple"/></inline-formula>.</p>
<p>To illustrate how to calculate BILD scores using these properties, consider the case of DNA comparison (with the numbers 1 through 4 identified respectively with the nucleotides A, C, G and T), with uniform background probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e102" xlink:type="simple"/></inline-formula>, and a Dirichlet prior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e103" xlink:type="simple"/></inline-formula> given by the parameter vector (1,1,1,1). By equation (4), the target frequency <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e104" xlink:type="simple"/></inline-formula> associated with the alignment column “AATC” is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e105" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e106" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e107" xlink:type="simple"/></inline-formula>. Thus the score for the column is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e108" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e109" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e110" xlink:type="simple"/></inline-formula> bits. In contrast, for the column “AAAC”, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e111" xlink:type="simple"/></inline-formula>, and the score for this column is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e112" xlink:type="simple"/></inline-formula> bits.</p>
<p>The essence of a Dirichlet distribution is perhaps best understood through the alternative parametrization (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e113" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e114" xlink:type="simple"/></inline-formula>), where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e115" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e116" xlink:type="simple"/></inline-formula>. Because the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e117" xlink:type="simple"/></inline-formula> must sum to 1, there are still only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e118" xlink:type="simple"/></inline-formula> independent parameters. The vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e119" xlink:type="simple"/></inline-formula> describes the center of mass of the distribution, while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e120" xlink:type="simple"/></inline-formula> indicates how concentrated the distribution is about this point. Large values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e121" xlink:type="simple"/></inline-formula> correspond to distributions with most of their mass near <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e122" xlink:type="simple"/></inline-formula>, whereas values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e123" xlink:type="simple"/></inline-formula> near 0 correspond to distributions with most of their mass near the boundaries of the simplex. It is frequently sensible, although not necessary, to choose a prior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e124" xlink:type="simple"/></inline-formula> whose <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e125" xlink:type="simple"/></inline-formula> is identical to the background frequencies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e126" xlink:type="simple"/></inline-formula>. In this case, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e127" xlink:type="simple"/></inline-formula>, and the first summand in equation (6) is always 0. In other words, no letter in a column, considered in isolation, carries any information as to whether the column represents a true biological relationship.</p>
</sec><sec id="s2d">
<title>Dirichlet Mixtures</title>
<p>Single Dirichlet distributions frequently are adequate for capturing prior knowledge concerning “true” alignment columns of related DNA sequences, but this is not the case for proteins. Most simply, distinct regions of multinomial space, representing different collections of amino acids, should have high prior probabilities. In order to address the deficiency of single Dirichlet distributions, Brown <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e128" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000852-Brown1">[31]</xref> proposed the use of Dirichlet mixture priors. A Dirichlet mixture is simply the weighted sum of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e129" xlink:type="simple"/></inline-formula> distinct Dirichlet distributions. It is specified by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e130" xlink:type="simple"/></inline-formula> positive “mixture parameters” <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e131" xlink:type="simple"/></inline-formula> through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e132" xlink:type="simple"/></inline-formula> that sum to 1, and a set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e133" xlink:type="simple"/></inline-formula> standard Dirichlet parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e134" xlink:type="simple"/></inline-formula> through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e135" xlink:type="simple"/></inline-formula>, for each of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e136" xlink:type="simple"/></inline-formula> component Dirichlet distributions. (It will be useful later to define <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e137" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e138" xlink:type="simple"/></inline-formula>.) In all, because of the restriction on the sum of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e139" xlink:type="simple"/></inline-formula>, a Dirichlet mixture has <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e140" xlink:type="simple"/></inline-formula> independent parameters. The Dirichlet components of a mixture generally are thought of as describing various types of positions (e.g. hydrophobic, charged, aromatic) typically found in proteins.</p>
<p>Bayes' theorem implies that, given a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e141" xlink:type="simple"/></inline-formula>-component Dirichlet mixture as a prior, the posterior distribution after the observation of a single letter is also a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e142" xlink:type="simple"/></inline-formula>-component Dirichlet mixture <xref ref-type="bibr" rid="pcbi.1000852-Brown1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Sjlander1">[32]</xref>. Brown <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e143" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000852-Brown1">[31]</xref> proposed Dirichlet mixture priors in the context of deriving “substitution” scores for aligning amino acids to columns from a multiple protein sequence alignment. This restricted context can be understood as comprehending a single summand from equation (6). BILD scores extend Brown <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e144" xlink:type="simple"/></inline-formula>'s sequence-profile alignment scores to comprehensive scores for multiple alignment columns.</p>
<p>Generalizing the development above, we describe here how to calculate the probability of a particular observation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e145" xlink:type="simple"/></inline-formula> given a Dirichlet mixture prior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e146" xlink:type="simple"/></inline-formula>, and how to calculate the posterior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e147" xlink:type="simple"/></inline-formula> resulting from this observation. First, given a Dirichlet mixture, with parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e148" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e149" xlink:type="simple"/></inline-formula>, the probability of observing letter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e150" xlink:type="simple"/></inline-formula> is given simply by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e151" xlink:type="simple"/><label>(8)</label></disp-formula>which follows directly from the definition of Dirichlet mixtures, and the result for single Dirichlet distributions. Second, given the observation of letter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e152" xlink:type="simple"/></inline-formula>, and a Dirichlet mixture prior parametrized as above, the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e153" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e154" xlink:type="simple"/></inline-formula> of the posterior distribution may be calculated as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e155" xlink:type="simple"/><label>(9)</label></disp-formula>In short, first multiply the mixture parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e156" xlink:type="simple"/></inline-formula> by the Bayesian factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e157" xlink:type="simple"/></inline-formula> and normalize, and then add 1 to each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e158" xlink:type="simple"/></inline-formula>. Mathematics establishing the validity of this procedure appears in <xref ref-type="bibr" rid="pcbi.1000852-Sjlander1">[32]</xref>. Their development is more complex than we require here, because we modify the Dirichlet mixture parameters only one observation at a time. We note that given the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e159" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e160" xlink:type="simple"/></inline-formula>, it is simple to invert procedure (9) to determine the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e161" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e162" xlink:type="simple"/></inline-formula>. This is useful for applications such as the Gibbs sampling algorithm discussed below.</p>
<p>Many multiple alignment problems involve subsets of sequences that are much more closely related to one another than to the other sequences being considered, and this may yield suboptimal results, because a large number of closely related sequences can “outvote” a few more divergent sequences. One remedy has been to assign each sequence a numerical weight, with closely related sequences down-weighted <xref ref-type="bibr" rid="pcbi.1000852-Altschul3">[50]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Sunyaev1">[61]</xref>. Also, subsumed in such weights may be the recognition that the total number of effective observations represented by an alignment column may be smaller than the number of sequences it comprehends <xref ref-type="bibr" rid="pcbi.1000852-Altschul1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Brown2">[62]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Altschul4">[63]</xref>. Thus, for certain applications it may be desirable to generalize BILD scores to weighted sequences. To do so, we need to define the concept of the probability of a “fractional observation” of a letter, and describe as well how a posterior distribution is calculated after such a fractional observation. Arguments supporting how this may be done can be extracted from the mathematical development in <xref ref-type="bibr" rid="pcbi.1000852-Sjlander1">[32]</xref>. Both equation (8) and the first step of procedure (9) involve multiplication by the factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e163" xlink:type="simple"/></inline-formula>. For the fraction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e164" xlink:type="simple"/></inline-formula> of an observation of letter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e165" xlink:type="simple"/></inline-formula>, these factors must be replaced by the alternative factors<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e166" xlink:type="simple"/><label>(10)</label></disp-formula>Also, in the last step of procedure (9), the quantity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e167" xlink:type="simple"/></inline-formula> rather than 1 must be added to each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e168" xlink:type="simple"/></inline-formula>. The factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e169" xlink:type="simple"/></inline-formula> are identical to the original factors when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e170" xlink:type="simple"/></inline-formula>, and all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e171" xlink:type="simple"/></inline-formula> approach 1 as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e172" xlink:type="simple"/></inline-formula> approaches 0, as some reflection shows they must.</p>
<p>Finally, note that equation (10) may be applied to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e173" xlink:type="simple"/></inline-formula> as well as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e174" xlink:type="simple"/></inline-formula>, and may be useful even when all observations are unitary. Thus, by aggregating observations, the BILD score for a column containing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e175" xlink:type="simple"/></inline-formula> unique letters may be calculated with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e176" xlink:type="simple"/></inline-formula> summands, rather than the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e177" xlink:type="simple"/></inline-formula> summands of equation (6). For a single Dirichlet prior, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e178" xlink:type="simple"/></inline-formula> reduces to the simple formula<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e179" xlink:type="simple"/><label>(11)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e180" xlink:type="simple"/></inline-formula> is the count of letter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e181" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e182" xlink:type="simple"/></inline-formula> is the total count of all residues. Only the numerator inside the product varies from column to column within an alignment, yielding further efficiency for calculation.</p>
</sec><sec id="s2e">
<title>The Choice of Priors</title>
<p>Only the research team that first proposed Dirichlet mixtures for protein sequence comparison has derived, from analyses of large protein alignment collections, sets of Dirichlet mixture prior parameters <xref ref-type="bibr" rid="pcbi.1000852-Brown1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Sjlander1">[32]</xref>. Twelve such sets, involving various numbers of Dirichlet components, can currently be found at <ext-link ext-link-type="uri" xlink:href="http://compbio.soe.ucsc.edu/dirichlets/index.html" xlink:type="simple">http://compbio.soe.ucsc.edu/dirichlets/index.html</ext-link>. We list five of these in <xref ref-type="table" rid="pcbi-1000852-t001">Table 1</xref>, which we refer to as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e183" xlink:type="simple"/></inline-formula> through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e184" xlink:type="simple"/></inline-formula>.</p>
<table-wrap id="pcbi-1000852-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000852.t001</object-id><label>Table 1</label><caption>
<title>Dirichlet mixture priors for protein sequence comparison.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000852-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Name of prior</td>
<td align="left" colspan="1" rowspan="1">Name on UCSC website</td>
<td align="left" colspan="1" rowspan="1">Number of components</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e185" xlink:type="simple"/></inline-formula> (bits)</td>
<td align="left" colspan="1" rowspan="1">Equivalent PAM matrix</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e186" xlink:type="simple"/></inline-formula> (bits)</td>
<td align="left" colspan="1" rowspan="1">Equivalent PAM matrix</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e187" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">uprior</td>
<td align="left" colspan="1" rowspan="1">9</td>
<td align="left" colspan="1" rowspan="1">1.44</td>
<td align="left" colspan="1" rowspan="1">80</td>
<td align="left" colspan="1" rowspan="1">2.85</td>
<td align="left" colspan="1" rowspan="1">20</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e188" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">byst</td>
<td align="left" colspan="1" rowspan="1">9</td>
<td align="left" colspan="1" rowspan="1">0.91</td>
<td align="left" colspan="1" rowspan="1">130</td>
<td align="left" colspan="1" rowspan="1">2.34</td>
<td align="left" colspan="1" rowspan="1">35</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e189" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">recode3</td>
<td align="left" colspan="1" rowspan="1">20</td>
<td align="left" colspan="1" rowspan="1">0.61</td>
<td align="left" colspan="1" rowspan="1">175</td>
<td align="left" colspan="1" rowspan="1">1.88</td>
<td align="left" colspan="1" rowspan="1">55</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e190" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">recode4</td>
<td align="left" colspan="1" rowspan="1">20</td>
<td align="left" colspan="1" rowspan="1">0.37</td>
<td align="left" colspan="1" rowspan="1">245</td>
<td align="left" colspan="1" rowspan="1">1.63</td>
<td align="left" colspan="1" rowspan="1">70</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e191" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">fournier</td>
<td align="left" colspan="1" rowspan="1">20</td>
<td align="left" colspan="1" rowspan="1">0.18</td>
<td align="left" colspan="1" rowspan="1">360</td>
<td align="left" colspan="1" rowspan="1">0.92</td>
<td align="left" colspan="1" rowspan="1">125</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label/><p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e192" xlink:type="simple"/></inline-formula> is the relative entropy <xref ref-type="bibr" rid="pcbi.1000852-Altschul2">[30]</xref> of the pairwise substitution matrix implied by the Dirichlet mixture prior. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e193" xlink:type="simple"/></inline-formula> is the mean relative entropy of the multinomial distribution (<xref ref-type="supplementary-material" rid="pcbi.1000852.s002">Text S2</xref>).</p></fn></table-wrap-foot></table-wrap>
<p>Proteins diverged by different degrees of evolutionary change are best studied using pairwise substitution matrices with different relative entropies <xref ref-type="bibr" rid="pcbi.1000852-Altschul2">[30]</xref>, and the analogous claim should hold for Dirichlet mixture priors. A Dirichlet mixture prior implies a background amino acid frequency distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e194" xlink:type="simple"/></inline-formula>, as well as a symmetric pairwise substitution matrix, by means of the formula <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e195" xlink:type="simple"/></inline-formula>. The relative entropies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e196" xlink:type="simple"/></inline-formula> of the substitution matrices implicit in the priors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e197" xlink:type="simple"/></inline-formula> through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e198" xlink:type="simple"/></inline-formula> range from 1.44 bits, roughly equivalent to that of the PAM-80 matrix <xref ref-type="bibr" rid="pcbi.1000852-Dayhoff1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Schwartz1">[8]</xref>, which is appropriate for fairly close evolutionary relationships, to 0.18 bits, roughly equivalent to that of the PAM-360 matrix, which is appropriate only for extremely distant relationships (<xref ref-type="table" rid="pcbi-1000852-t001">Table 1</xref>).</p>
<p>As well as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e199" xlink:type="simple"/></inline-formula>, one may calculate the mean relative entropy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e200" xlink:type="simple"/></inline-formula> of the multinomial distributions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e201" xlink:type="simple"/></inline-formula> described by a Dirichlet mixture prior to the background frequencies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e202" xlink:type="simple"/></inline-formula> (see <xref ref-type="supplementary-material" rid="pcbi.1000852.s002">Text S2</xref>). For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e203" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e204" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e205" xlink:type="simple"/></inline-formula> ranges from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e206" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e207" xlink:type="simple"/></inline-formula> bits (<xref ref-type="table" rid="pcbi-1000852-t001">Table 1</xref>). That <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e208" xlink:type="simple"/></inline-formula> has a much greater value than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e209" xlink:type="simple"/></inline-formula> indicates that on average much more information is available per position from an accurate multiple alignment of many related sequences than from a single sequence. We note that, in lieu of using different priors, the effective relative entropy of a particular Dirichlet mixture may be tuned by scaling the weights of the sequences to which it is applied <xref ref-type="bibr" rid="pcbi.1000852-Edgar1">[43]</xref>.</p>
<p>Standard pairwise substitution matrices are constructed from sets of proteins with certain background amino acid frequencies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e210" xlink:type="simple"/></inline-formula>, and are non-optimal for the comparison of proteins with compositions that differ greatly from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e211" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000852-Yu1">[64]</xref>. Similarly, a Dirichlet mixture prior has an implicit background amino acid composition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e212" xlink:type="simple"/></inline-formula>, and should not be optimal when applied to proteins with compositions that differ greatly from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e213" xlink:type="simple"/></inline-formula>. It is possible to adjust standard matrices for use with non-standard compositions <xref ref-type="bibr" rid="pcbi.1000852-Yu1">[64]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Yu2">[65]</xref>, and we will discuss elsewhere an analogous strategy that can be applied to adjust Dirichlet mixture priors.</p>
<p>Single Dirichlet priors may be appropriate for DNA sequence comparison. The uniform density, arising when all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e214" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e215" xlink:type="simple"/></inline-formula>), has frequently been advocated in the absence of prior knowledge, and “Jeffreys' prior” <xref ref-type="bibr" rid="pcbi.1000852-Jeffreys1">[66]</xref>, which is uninformative in a deeper sense, corresponds to all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e216" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e217" xlink:type="simple"/></inline-formula>) <xref ref-type="bibr" rid="pcbi.1000852-Grnwald1">[33]</xref>. When specific prior knowledge concerning an application domain is available, however, there is generally not a strong argument for using uninformative priors. For related DNA sequences, the columns of accurate alignments are sometimes dominated by one or two nucleotides, suggesting that all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e218" xlink:type="simple"/></inline-formula> should be smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e219" xlink:type="simple"/></inline-formula>. Furthermore, it usually makes sense for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e220" xlink:type="simple"/></inline-formula> to be proportional to the background frequencies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e221" xlink:type="simple"/></inline-formula>. If this is stipulated, the specification of a Dirichlet prior reduces to the specification of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e222" xlink:type="simple"/></inline-formula>. Assuming a uniform nucleotide composition, the values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e223" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e224" xlink:type="simple"/></inline-formula> implied by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e225" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e226" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e227" xlink:type="simple"/></inline-formula> are given in <xref ref-type="table" rid="pcbi-1000852-t002">Table 2</xref>. An empirical study of transcription factor binding sites <xref ref-type="bibr" rid="pcbi.1000852-Nishida1">[67]</xref> concludes that, at least for the analysis of such sites, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e228" xlink:type="simple"/></inline-formula> should be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e229" xlink:type="simple"/></inline-formula> or lower.</p>
<table-wrap id="pcbi-1000852-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000852.t002</object-id><label>Table 2</label><caption>
<title>Relative entropies for DNA sequence comparison.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000852-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e230" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e231" xlink:type="simple"/></inline-formula> (bits)</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e232" xlink:type="simple"/></inline-formula> (bits)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">0.5</td>
<td align="left" colspan="1" rowspan="1">0.792</td>
<td align="left" colspan="1" rowspan="1">1.387</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1.0</td>
<td align="left" colspan="1" rowspan="1">0.451</td>
<td align="left" colspan="1" rowspan="1">1.062</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1.5</td>
<td align="left" colspan="1" rowspan="1">0.294</td>
<td align="left" colspan="1" rowspan="1">0.860</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">2.0</td>
<td align="left" colspan="1" rowspan="1">0.208</td>
<td align="left" colspan="1" rowspan="1">0.721</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">2.5</td>
<td align="left" colspan="1" rowspan="1">0.155</td>
<td align="left" colspan="1" rowspan="1">0.621</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">3.0</td>
<td align="left" colspan="1" rowspan="1">0.120</td>
<td align="left" colspan="1" rowspan="1">0.545</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">3.5</td>
<td align="left" colspan="1" rowspan="1">0.096</td>
<td align="left" colspan="1" rowspan="1">0.485</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">4.0</td>
<td align="left" colspan="1" rowspan="1">0.078</td>
<td align="left" colspan="1" rowspan="1">0.437</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt102"><label/><p>See footnote to <xref ref-type="table" rid="pcbi-1000852-t001">Table 1</xref>.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2f">
<title>Local Alignment Width and Local Multiple Alignment</title>
<p>A direct application of multiple alignment log-odds scores is to determining local alignment width. As formulated by Smith and Waterman <xref ref-type="bibr" rid="pcbi.1000852-Smith1">[1]</xref>, an optimal local alignment is one that maximizes an alignment score but is of arbitrary width. Such scores should fall on the log side of the “log-linear phase transition” <xref ref-type="bibr" rid="pcbi.1000852-Vingron2">[68]</xref>, which implies that for ungapped local alignments, substitution scores must be of log-odds form <xref ref-type="bibr" rid="pcbi.1000852-Karlin1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Altschul2">[30]</xref>.</p>
<p>Equation (1) explicitly generalizes pairwise log-odds scores to the multiple alignment case. They are positive for some alignment columns, negative for others, and must have negative expected value. Therefore it is appropriate to define an optimal ungapped multiple alignment as one with maximal aggregate log-odds score. This immediately allows one to define the proper width or extent of an ungapped multiple DNA or protein alignment, without resorting to the <italic>ad hoc</italic> principles frequently required for other scoring systems <xref ref-type="bibr" rid="pcbi.1000852-Lawrence1">[69]</xref>. Although the Smith-Waterman algorithm can be applied to optimize log-odds-scored local multiple alignments, it is too slow for most purposes. Nevertheless, once relative offsets have been fixed for a set of sequences, it is trivial to determine an optimal ungapped local multiple alignment along the single implied diagonal.</p>
<p>The ungapped local multiple alignment problem may be formulated as seeking segments of common width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e233" xlink:type="simple"/></inline-formula> within multiple DNA or protein sequences that, when aligned, optimize a defined objective function. We take this function here to be the aggregate log-odds score for the aligned columns. One way to approach this optimization is by means of a Gibbs sampling strategy, as described by Lawrence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e234" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000852-Lawrence1">[69]</xref>. Log-odds scores can be used to adjust <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e235" xlink:type="simple"/></inline-formula> dynamically, by applying the Smith-Waterman algorithm to the diagonal implied by a provisional alignment, without the need for an arbitrary parameter or an <italic>ad hoc</italic> optimization. They may also be used to determine dynamically whether or not a sequence should participate in the multiple alignment at all, for which purpose it is useful first to consider log-odds scores from the perspective of the Minimum Description Length Principle.</p>
</sec><sec id="s2g">
<title>Log-Odds Scores and the Minimum Description Length Principle</title>
<p>The Minimum Description Length (MDL) Principle provides a criterion for choosing among alternative theories for describing a set of data <xref ref-type="bibr" rid="pcbi.1000852-Grnwald1">[33]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-MacKay1">[49]</xref>. To simplify greatly, it suggests that given a set of alternative theories <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e236" xlink:type="simple"/></inline-formula> to describe a set of data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e237" xlink:type="simple"/></inline-formula>, that theory should be chosen which minimizes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e238" xlink:type="simple"/></inline-formula>, defined as the sum of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e239" xlink:type="simple"/></inline-formula>, the description length of the theory, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e240" xlink:type="simple"/></inline-formula>, the description length of the data given the theory. By convention, description lengths are measured in bits.</p>
<p>From information theory <xref ref-type="bibr" rid="pcbi.1000852-Cover1">[70]</xref>, the information associated with an event of probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e241" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e242" xlink:type="simple"/></inline-formula> bits. Focusing on actual encoding schemes for probabilistic events can unduly complicate MDL analyses. Accordingly, we here follow the approach of section 3.2.2 of <xref ref-type="bibr" rid="pcbi.1000852-Grnwald1">[33]</xref>, in which description lengths are allowed to be non-integral, and are identified with negative log probabilities. Thus, if the data can be described probabilistically, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e243" xlink:type="simple"/></inline-formula>. The length of the theory <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e244" xlink:type="simple"/></inline-formula> is defined as the number of bits needed to specify the free parameters of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e245" xlink:type="simple"/></inline-formula>, i.e. those that are fitted to the data <xref ref-type="bibr" rid="pcbi.1000852-Grnwald1">[33]</xref>.</p>
<p>For local multiple alignment, the theory <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e246" xlink:type="simple"/></inline-formula> that the input sequences are unrelated has only the background probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e247" xlink:type="simple"/></inline-formula> as parameters, whose description length we will call <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e248" xlink:type="simple"/></inline-formula>. The data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e249" xlink:type="simple"/></inline-formula> is comprised of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e250" xlink:type="simple"/></inline-formula> sequences, with lengths <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e251" xlink:type="simple"/></inline-formula> through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e252" xlink:type="simple"/></inline-formula>, and consisting of the letters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e253" xlink:type="simple"/></inline-formula>. Then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e254" xlink:type="simple"/></inline-formula>. The theory <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e255" xlink:type="simple"/></inline-formula> states that segments of width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e256" xlink:type="simple"/></inline-formula> beginning at positions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e257" xlink:type="simple"/></inline-formula> within the various sequences are related, and that the probability of the data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e258" xlink:type="simple"/></inline-formula> within each column <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e259" xlink:type="simple"/></inline-formula> of the implied alignment is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e260" xlink:type="simple"/></inline-formula>; the probability of the rest of the data may be described with the background frequencies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e261" xlink:type="simple"/></inline-formula>. The free parameters are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e262" xlink:type="simple"/></inline-formula>, the vector of starting positions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e263" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e264" xlink:type="simple"/></inline-formula>. Each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e265" xlink:type="simple"/></inline-formula> may take on one of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e266" xlink:type="simple"/></inline-formula> values, so its description length is approximately <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e267" xlink:type="simple"/></inline-formula>, if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e268" xlink:type="simple"/></inline-formula> is not too large compared to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e269" xlink:type="simple"/></inline-formula>. Thus, we have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e270" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e271" xlink:type="simple"/></inline-formula> is the description length of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e272" xlink:type="simple"/></inline-formula>. (If all feasible widths are taken to be equally likely, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e273" xlink:type="simple"/></inline-formula> is just <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e274" xlink:type="simple"/></inline-formula>. Other encodings have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e275" xlink:type="simple"/></inline-formula> grow slowly with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e276" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000852-Grnwald1">[33]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-MacKay1">[49]</xref>.) It is apparent that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e277" xlink:type="simple"/></inline-formula>, where the latter sum is taken only over those letters not participating in the local multiple alignment. Everything simplifies when we consider the difference in the total description lengths of the two theories:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e278" xlink:type="simple"/><label>(12)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e279" xlink:type="simple"/></inline-formula> is simply the log-odds score for the implied alignment. In other words, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e280" xlink:type="simple"/></inline-formula> is preferred whenever <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e281" xlink:type="simple"/></inline-formula> exceeds <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e282" xlink:type="simple"/></inline-formula>. As described in <xref ref-type="supplementary-material" rid="pcbi.1000852.s003">Text S3</xref>, this prescription is related to the statistical theory for ungapped local alignments <xref ref-type="bibr" rid="pcbi.1000852-Karlin1">[23]</xref>.</p>
<p>To allow one or more sequences to be excluded from the multiple alignment, we consider not 2, but <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e283" xlink:type="simple"/></inline-formula> theories, distinguished by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e284" xlink:type="simple"/></inline-formula> binary indices <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e285" xlink:type="simple"/></inline-formula>, which take on the value 1 to indicate that sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e286" xlink:type="simple"/></inline-formula> participates in the alignment, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e287" xlink:type="simple"/></inline-formula> otherwise. These theories need not be <italic>a priori</italic> equally likely; if necessary, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e288" xlink:type="simple"/></inline-formula> from 1 to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e289" xlink:type="simple"/></inline-formula> we can specify prior probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e290" xlink:type="simple"/></inline-formula> that sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e291" xlink:type="simple"/></inline-formula> contains a segment related to segments in the other sequences. Let us consider the difference in the description lengths of two theories, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e292" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e293" xlink:type="simple"/></inline-formula>, that differ only in their index <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e294" xlink:type="simple"/></inline-formula>. Theory <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e295" xlink:type="simple"/></inline-formula> incurs the cost <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e296" xlink:type="simple"/></inline-formula> for the prior probability that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e297" xlink:type="simple"/></inline-formula>, and also requires describing the location of the related segment, which costs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e298" xlink:type="simple"/></inline-formula> bits. In contrast, theory <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e299" xlink:type="simple"/></inline-formula> incurs only the cost <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e300" xlink:type="simple"/></inline-formula>, so <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e301" xlink:type="simple"/></inline-formula> costs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e302" xlink:type="simple"/></inline-formula> more bits to describe than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e303" xlink:type="simple"/></inline-formula>. Thus, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e304" xlink:type="simple"/></inline-formula> to be preferred, the log-odds score of the multiple alignment must increase by at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e305" xlink:type="simple"/></inline-formula> when the segment from the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e306" xlink:type="simple"/></inline-formula>th sequence is added. If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e307" xlink:type="simple"/></inline-formula> is close to 1, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e308" xlink:type="simple"/></inline-formula> can be negative, and is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e309" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e310" xlink:type="simple"/></inline-formula>. In short, the greater the prior probability that a given sequence contains a relevant segment, the lower the score of such a segment need be for inclusion in the alignment.</p>
<p>The change in the log-odds score with the addition of a segment from the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e311" xlink:type="simple"/></inline-formula>th sequence depends upon which other sequences, and which of their segments, participate in the alignment. Consequently, the values of the indicator variables <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e312" xlink:type="simple"/></inline-formula> must be part of the larger optimization, and their selection can be readily incorporated into a Gibbs sampling algorithm. The MDL Principle can also be extended to the case where a single sequence may contain more than one copy of a pattern, and, as previously described <xref ref-type="bibr" rid="pcbi.1000852-Brown2">[62]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Sjlander2">[71]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Brown3">[72]</xref> and discussed in <xref ref-type="supplementary-material" rid="pcbi.1000852.s004">Text S4</xref>, to the clustering of multiple alignments into subfamilies.</p>
</sec><sec id="s2h">
<title>Gap Scores</title>
<p>Although our central concern is to define a new type of multiple alignment substitution score, many important applications require the construction of gapped multiple alignments, and these generally entail scores for insertions and deletions. Multiple alignment gap scores should be defined in a manner consistent with the substitution scores used <xref ref-type="bibr" rid="pcbi.1000852-Altschul5">[73]</xref>, so we will consider what type gap scores might fruitfully be paired with BILD scores.</p>
<p>Just as the log-odds perspective places pairwise substitution scores in a probabilistic framework <xref ref-type="bibr" rid="pcbi.1000852-Dayhoff1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Schwartz1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Karlin1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Altschul2">[30]</xref>, so pairwise gap scores can be viewed as specifying probabilities for insertions and deletions within biologically accurate alignments <xref ref-type="bibr" rid="pcbi.1000852-Thorne1">[74]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Neuwald1">[82]</xref>. For pairwise alignments, “affine” gap scores, of the form <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e313" xlink:type="simple"/></inline-formula> for a gap of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e314" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000852-Gotoh2">[83]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Altschul6">[85]</xref>, are those most commonly used <xref ref-type="bibr" rid="pcbi.1000852-Pearson1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Altschul1">[4]</xref>, although more complex gap scores have frequently been proposed <xref ref-type="bibr" rid="pcbi.1000852-Waterman1">[86]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Goonesekere2">[89]</xref>. When there is an essential asymmetry between the sequences being aligned, differing scores may be assigned to gaps within the two sequences. Furthermore, when substitution and gap scores are properly integrated and both expressed in the units of bits, the two parameters of affine gap scores can be understood to specify jointly the average frequencies and lengths of gaps in the alignments sought <xref ref-type="bibr" rid="pcbi.1000852-Neuwald1">[82]</xref>. If gaps are to be introduced into the BILD score formalism, an immediate problem is which, if any, letters from individual sequences should be understood as insertions with respect to the “canonical” pattern. In other words, it appears a canonical width for the multiple alignment must somehow be chosen, with respect to which gaps arising in the alignment of individual sequences can be assessed.</p>
</sec><sec id="s2i">
<title>Profile-Sequence Alignment</title>
<p>For simplicity, suppose we have a “canonical” multiple alignment <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e315" xlink:type="simple"/></inline-formula>, i.e. one with a specified number of columns, to which we wish to align a single sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e316" xlink:type="simple"/></inline-formula>, to produce a new multiple alignment <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e317" xlink:type="simple"/></inline-formula>. It is reasonable to define the alignment score of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e318" xlink:type="simple"/></inline-formula> as the pre-existing alignment score for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e319" xlink:type="simple"/></inline-formula> plus the incremental pairwise score for aligning <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e320" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e321" xlink:type="simple"/></inline-formula>. This pairwise alignment involves substitutions (letters from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e322" xlink:type="simple"/></inline-formula> aligned to columns from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e323" xlink:type="simple"/></inline-formula>), insertions (runs of letters from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e324" xlink:type="simple"/></inline-formula> that are not aligned to any columns from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e325" xlink:type="simple"/></inline-formula>), and deletions (runs of columns from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e326" xlink:type="simple"/></inline-formula> that are not aligned to any letters from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e327" xlink:type="simple"/></inline-formula>). BILD scores for the columns of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e328" xlink:type="simple"/></inline-formula> arise naturally when one defines the substitution scores for aligning <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e329" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e330" xlink:type="simple"/></inline-formula> as incremental BILD scores. It remains then only to define gap scores for insertions and deletions in the alignment of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e331" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e332" xlink:type="simple"/></inline-formula>.</p>
<p>There is an essential asymmetry in gap scores for aligning <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e333" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e334" xlink:type="simple"/></inline-formula>, relevant in many biological applications. For proteins, the columns of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e335" xlink:type="simple"/></inline-formula> represent canonical positions, present in most sequences of a protein family, and it should accordingly be very costly to delete any of these columns. In contrast, individual proteins often contain long loops not present in the great majority of related sequences <xref ref-type="bibr" rid="pcbi.1000852-Ladurner1">[90]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-ScalleyKim1">[91]</xref>, so even long insertions should not be very costly. Uniform but asymmetric affine insertion and deletion scores can capture this simple idea, and we have implemented them in one program described in the <xref ref-type="sec" rid="s3">Results</xref> section below. These scores can be derived from the average frequencies and lengths <xref ref-type="bibr" rid="pcbi.1000852-Neuwald1">[82]</xref> of insertions and deletions with respect to canonical protein family multiple alignments.</p>
<p>Just as incremental BILD substitution scores change as more sequences are added to a multiple alignment, so it is possible to let insertion and deletion scores change as well, and vary by position. In the context of Hidden Markov Models <xref ref-type="bibr" rid="pcbi.1000852-Tanaka1">[76]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Karplus1">[81]</xref>, many methods for doing this have been described. Below, we implement one simple procedure that depends only upon the BILD scores of multiple alignment columns, and not upon the relatively sparse gaps observed in any particular alignment.</p>
</sec><sec id="s2j">
<title>Progressive Multiple Alignment and Profile-Profile Alignment</title>
<p>Formula (3) permits BILD substitution scores to be used for progressive multiple alignment. However, as described above, gaps scores pose a particular problem, because to define insertions and deletions one needs to construct a canonical alignment, and this is difficult for a small number of sequences. For example, when just two proteins are aligned, it is quite possible that gaps in both sequences would ultimately be seen as insertions with respect to a model describing the whole protein family, but there is no obvious way to determine this in advance. (The problem does not arise when substitution and gap scores are defined using the sum-of-pairs or SP formalism <xref ref-type="bibr" rid="pcbi.1000852-Murata1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Bacon1">[28]</xref>, for which no canonical alignment is necessary <xref ref-type="bibr" rid="pcbi.1000852-Altschul5">[73]</xref>.) Accordingly, the approach we take below is eschew gaps at first, and thereby construct a canonical multiple alignment whose columns represent positions present in the majority of sequences. Only then do we realign individual sequences to this model, allowing gaps.</p>
<p>There has been considerable recent interest in aligning profiles that describe different protein families <xref ref-type="bibr" rid="pcbi.1000852-Pietrokovski1">[40]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Sding1">[48]</xref>. If BILD substitution scores, defined by equation (3), are to be used for this purpose, it would seem that we face the same problem for gaps that we do for progressive multiple alignment. Specifically, an insertion with respect to one profile is seen as a deletion with respect to the other, so how may one determine which, if either, perspective to adopt in a model describing both? However, so long as this goal is only to compare pairs of profiles, and not to proceed further, this problem may be elided. It is consistent to define pairwise gap costs for the alignment of two profiles, just as one would for the alignment of two sequences, without reference to a canonical alignment, and the substitution scores of equation (3) can be used sensibly with such gap costs. The gap costs chosen may depend upon the profiles being aligned, and may therefore be asymmetric and position specific. We leave for elsewhere the comparative evaluation of profile-profile alignment using substitution scores defined by equation (3), and those defined in other ways <xref ref-type="bibr" rid="pcbi.1000852-Pietrokovski1">[40]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Sding1">[48]</xref>.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<p>Substitution scores for multiple alignment columns form only one element of successful multiple alignment programs. Depending upon their specific purposes, such programs may also employ gap scores, sequence weights, heuristic optimization algorithms, low-complexity filters, discontiguous patterns, provisions for no or multiple copies of a pattern within a sequence, the search for multiple distinct patterns, statistical assessments, etc. It is not our purpose here to develop a fully realized program to outperform existing state-of-the-art programs that involve multiple alignment. Rather, we seek only to argue that the use of explicitly constructed log-odds substitution scores can in many cases add values to these methods.</p>
<p>The programs we consider below have been constructed for evaluation purposes, to isolate the contribution of log-odds scores as much as possible. These programs are parsimonious in their complexity and use of free parameters, and employ various ideas that have appeared frequently elsewhere, and for which no novelty is claimed.</p>
<sec id="s3a">
<title>A. Ungapped Multiple Local Alignment Using Gibbs Sampling</title>
<p>BILD scores find perhaps their purest application in the ungapped local alignment problem described above, so it is worth studying them in this restricted context. The Gibbs sampling approach to finding optimal local multiple alignments was introduced by Lawrence et al. <xref ref-type="bibr" rid="pcbi.1000852-Lawrence1">[69]</xref>, and this algorithm can easily be modified to employ BILD scores. Potential advantages are improved sensitivity and the automatic definition of domain boundaries. Evaluation ideally requires a set of proteins with ungapped domains whose correct alignment is structurally validated, but such sets are unfortunately very rare. Nevertheless, the collection of ungapped helix-turn-helix (HTH) domains in <xref ref-type="bibr" rid="pcbi.1000852-Lawrence1">[69]</xref> provides a limited test set for analyzing BILD scores in the absence of gaps. As we describe in <xref ref-type="supplementary-material" rid="pcbi.1000852.s005">Text S5</xref>, with <xref ref-type="supplementary-material" rid="pcbi.1000852.s006">Tables S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000852.s007">S2</xref>, BILD scores achieve success on two fronts. First, they have greater average sensitivity than the entropy-based scores proposed by Lawrence et al. <xref ref-type="bibr" rid="pcbi.1000852-Lawrence1">[69]</xref>, in yielding accurate alignment from fewer sequences; second, they recognize with good precision the extent of the structurally-defined domains, and therefore do not require a prior specification of alignment width.</p>
</sec><sec id="s3b">
<title>B. Extension to Gapped Local Alignment</title>
<p>Local multiple alignment programs generally must allow for gaps, either implicitly or explicitly. However, even for aligning gapped domains, the search for ungapped local alignments can be a fruitful first step. BILD scores can play an important role at this stage in defining the common core of a protein family, and can be adapted in subsequent stages to score gapped multiple alignments. As a proof of principle, we here develop a relatively simple algorithm, Program 1, that uses BILD scores as part of a gapped multiple alignment strategy. We describe this program's architecture and motivation below, and use a standard artificial test set to evaluate its ability to recognize the boundaries of local motifs, and to properly construct gapped local alignments. We then describe in section C how Program 1 may be refined through the consideration of features of protein structure, and illustrate the application of our methods to the delineation of a protein domain family.</p>
<sec id="s3b1">
<title>Program 1 architecture</title>
<p>Input: A set of putatively related protein sequences potentially containing zero, one, or multiple instances of a common pattern. The sequences are in a standard unaligned format such as fasta.</p>
<p>Goal: To find a gapped local multiple alignment that optimizes an objective function defined as the sum of column BILD scores, minus gap costs, minus costs for describing the start locations of patterns. The user may specify whether a single or multiple instances of the pattern in each sequence should be sought, as well as whether the pattern may be absent in some sequences.</p>
<p>Heuristic algorithm:</p>
<list list-type="alpha-lower"><list-item>
<p>Execute the Gibbs sampling strategy (<xref ref-type="supplementary-material" rid="pcbi.1000852.s005">Text S5</xref>) to determine a preliminary pattern width, and a preliminary ungapped local alignment, allowing at most one instance of the pattern per sequence.</p>
</list-item><list-item>
<p>For each input sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e336" xlink:type="simple"/></inline-formula>, remove any and all segments of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e337" xlink:type="simple"/></inline-formula> from the multiple alignment, and construct a BILD-score based position-specific score matrix (PSSM) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e338" xlink:type="simple"/></inline-formula> from the remaining alignment. Allowing gaps with affine gap costs <xref ref-type="bibr" rid="pcbi.1000852-Gotoh2">[83]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Altschul6">[85]</xref>, optimally align the whole of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e339" xlink:type="simple"/></inline-formula> to a segment from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e340" xlink:type="simple"/></inline-formula>, using for this purpose a generalization of the semi-global alignment algorithm of Erickson and Sellers <xref ref-type="bibr" rid="pcbi.1000852-Erickson1">[92]</xref>. Consider all sequences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e341" xlink:type="simple"/></inline-formula>, whether or not they were identified as containing a pattern in the initial Gibbs sampling stage, or in subsequent gapped alignment iterations. Asymmetric gap costs for insertions and deletions may be specified. (Note that, as described in the hidden Markov model (HMM) literature <xref ref-type="bibr" rid="pcbi.1000852-Tanaka1">[76]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Neuwald1">[82]</xref>, for bit scores to retain their meaning, a small penalty, equivalent to the log probability of <italic>not</italic> initiating a gap, must be assessed whenever a letter is aligned to a motif column. For our purposes, this penalty is best viewed as an additional “gap score”, although it may be coded as a modification to the substitution scores. Also, when a letter is not aligned to a motif column, the number of observations and aggregate BILD score for that column do not change.) Retain the alignment if the score exceeds a calculated threshold. Multiple non-overlapping segments within <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e342" xlink:type="simple"/></inline-formula> that align to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e343" xlink:type="simple"/></inline-formula> can be found using a greedy approach.</p>
</list-item><list-item>
<p>Collect all the aligned segments from step b) into a new, gapped multiple alignment, and return to step b). Iterate until the objective score function stops increasing.</p>
</list-item><list-item>
<p>Adjust the width of the original pattern to optimize the alignment score. Alternatively, this step may be inserted between iterations.</p>
</list-item></list>
</sec><sec id="s3b2">
<title>Program 1 motivation</title>
<p>The initial search for ungapped segments in the Gibbs sampling step can delineate a common core pattern width, and provisional amino acid frequencies for each column, shared by a set of sequences, even when most segments are at first partially misaligned. For sequences containing repeated or multiple distinct patterns, it may be useful to restrict the width of the pattern sought. The MDL Principle can be used to provisionally exclude some sequences from the alignment at this stage, which may then be included later. Adopting this core pattern generally minimizes the average number of gaps that subsequently need to be introduced when aligning to members of the family. Using Erickson-Sellers semi-global alignment conserves the pattern width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e344" xlink:type="simple"/></inline-formula>, recognizing the importance of complete domains, and thereby both reduces the noise from chance partial similarities and aids the discovery of long insertions. Gapped alignment avoids the imposition of a block structure that may not be universally appropriate. However, columns are not added to the evolving profile to represent insertions, which can be idiosyncratic in length and location. Deletions may be present, but these are generally short and in a small minority of the sequences. Thus, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e345" xlink:type="simple"/></inline-formula> concatenated aligned columns are densely occupied by amino acid data and are highly informative. This compressed type of profile, like the similar representation of Neuwald and Liu <xref ref-type="bibr" rid="pcbi.1000852-Neuwald1">[82]</xref>, generally corresponds well to the core structural elements of a domain. The use of asymmetric gap costs (with greater penalties for deletions) captures the natural asymmetry implied in aligning a sequence to such a core model. Note that elsewhere Gibbs sampling has been extended directly to the construction of gapped alignments <xref ref-type="bibr" rid="pcbi.1000852-Rocke1">[93]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Wareham1">[94]</xref>, whereas Program 1 takes the simpler approach of confining the Gibbs sampling stage to the discovery of a provisional ungapped pattern.</p>
</sec><sec id="s3b3">
<title>Program 1 performance</title>
<p>The evaluation of the performance of a multiple alignment program requires a collection of sequence sets for each of which the correct alignment is known <xref ref-type="bibr" rid="pcbi.1000852-Thompson3">[95]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Subramanian1">[96]</xref>. Multiple alignment programs may focus on the construction of global alignments, or on the discovery of local patterns, and different collections are accordingly appropriate for their evaluation. Among those collections in common use, “ref1” from IRMBase <xref ref-type="bibr" rid="pcbi.1000852-Subramanian1">[96]</xref>, which we will call IRM-1, appears the most appropriate for our gapped local multiple alignment program. IRM-1 contains 60 sets of sequences, with the sequences in each set containing a single, possibly gapped, local motif, embedded within otherwise random sequence. The motifs were generated artificially using the Rose program for simulated evolution <xref ref-type="bibr" rid="pcbi.1000852-Stoye1">[97]</xref>. This construction, although not completely realistic, means, however, that the extent and correct alignment of the motifs within the various sequences are precisely known. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e346" xlink:type="simple"/></inline-formula> sets are divided into three groups of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e347" xlink:type="simple"/></inline-formula>, consisting respectively of sets of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e348" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e349" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e350" xlink:type="simple"/></inline-formula> sequences.</p>
<p>First, we evaluated the ability of Program 1 to identify properly the left and right motif boundaries within the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e351" xlink:type="simple"/></inline-formula> IRM-1 sequence sets. The results, grouped by the number of sequences within the various IRM-1 sets, are shown in <xref ref-type="table" rid="pcbi-1000852-t003">Table 3</xref>, with positive deviations referring to patterns identified by Program 1 that are too long. Program 1 identifies 80% of the motif boundaries exactly, and 92% to within 1 residue. Furthermore, the accuracy of boundary detection clearly improves as the number of sequences considered increases.</p>
<table-wrap id="pcbi-1000852-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000852.t003</object-id><label>Table 3</label><caption>
<title>The recognition of motif boundaries.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000852-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.t003" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="10" rowspan="1">Program 1</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="9" rowspan="1">Deviation from true boundary</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">IRM-1 subset</td>
<td align="left" colspan="1" rowspan="1">&lt;−3</td>
<td align="left" colspan="1" rowspan="1">−3</td>
<td align="left" colspan="1" rowspan="1">−2</td>
<td align="left" colspan="1" rowspan="1">−1</td>
<td align="left" colspan="1" rowspan="1">0</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1">2</td>
<td align="left" colspan="1" rowspan="1">3</td>
<td align="left" colspan="1" rowspan="1">&gt;3</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">4</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1">5</td>
<td align="left" colspan="1" rowspan="1">29</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1">2</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">8</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1">31</td>
<td align="left" colspan="1" rowspan="1">6</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">16</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">36</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Total</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1">2</td>
<td align="left" colspan="1" rowspan="1">6</td>
<td align="left" colspan="1" rowspan="1">96</td>
<td align="left" colspan="1" rowspan="1">8</td>
<td align="left" colspan="1" rowspan="1">3</td>
<td align="left" colspan="1" rowspan="1">2</td>
<td align="left" colspan="1" rowspan="1">1</td>
</tr>
</tbody>
</table><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="10" rowspan="1">DIALIGN-TX</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="9" rowspan="1">Deviation from true boundary</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">IRM-1 subset</td>
<td align="left" colspan="1" rowspan="1">&lt;−3</td>
<td align="left" colspan="1" rowspan="1">−3</td>
<td align="left" colspan="1" rowspan="1">−2</td>
<td align="left" colspan="1" rowspan="1">−1</td>
<td align="left" colspan="1" rowspan="1">0</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1">2</td>
<td align="left" colspan="1" rowspan="1">3</td>
<td align="left" colspan="1" rowspan="1">&gt;3</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">4</td>
<td align="left" colspan="1" rowspan="1">2</td>
<td align="left" colspan="1" rowspan="1">2</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1">6</td>
<td align="left" colspan="1" rowspan="1">23</td>
<td align="left" colspan="1" rowspan="1">4</td>
<td align="left" colspan="1" rowspan="1">2</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">8</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">6</td>
<td align="left" colspan="1" rowspan="1">24</td>
<td align="left" colspan="1" rowspan="1">7</td>
<td align="left" colspan="1" rowspan="1">2</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">16</td>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">3</td>
<td align="left" colspan="1" rowspan="1">3</td>
<td align="left" colspan="1" rowspan="1">11</td>
<td align="left" colspan="1" rowspan="1">10</td>
<td align="left" colspan="1" rowspan="1">9</td>
<td align="left" colspan="1" rowspan="1">3</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Total</td>
<td align="left" colspan="1" rowspan="1">3</td>
<td align="left" colspan="1" rowspan="1">2</td>
<td align="left" colspan="1" rowspan="1">4</td>
<td align="left" colspan="1" rowspan="1">15</td>
<td align="left" colspan="1" rowspan="1">58</td>
<td align="left" colspan="1" rowspan="1">21</td>
<td align="left" colspan="1" rowspan="1">13</td>
<td align="left" colspan="1" rowspan="1">4</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt103"><label/><p>Counts were made of the deviations found by Program 1 and DIALIGN-TX of the left and right pattern boundaries (120 total) for the embedded motifs within the 60 IRM-1 sequence sets, divided into the sets involving 4, 8, and 16 sequences <xref ref-type="bibr" rid="pcbi.1000852-Subramanian1">[96]</xref>. At all 120 boundaries of the reported patterns, both programs align in register at least 50% of the sequences. This consensus allows us to determine to what extent the programs report conserved regions that are too long or too short. Positive deviations in the table refer to patterns identified by the programs that are longer than the actual patterns. To make an equitable comparison of the two programs, several non-default options and procedures were employed, as follows: (1) Asymmetric affine gap costs were inappropriate for Program 1 because the Rose program <xref ref-type="bibr" rid="pcbi.1000852-Stoye1">[97]</xref> used in the construction of IRM-1 does not simulate the differential rates with which insertions and deletions occur within real protein motifs. Accordingly, we empirically assigned all gaps of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e352" xlink:type="simple"/></inline-formula> a score of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e353" xlink:type="simple"/></inline-formula> bits, which corresponds <xref ref-type="bibr" rid="pcbi.1000852-Neuwald1">[82]</xref> to an average frequency of 0.67% for insertions (and similarly for deletions) beginning at each motif position, and an average insertion or deletion length of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e354" xlink:type="simple"/></inline-formula>. (2) We ran DIALIGN-TX at its least sensitive setting, using the “-l2” option, to avoid the excessive extensions into randomly aligned flanking sequences that degrade the accuracy of motif boundary recognition with the more sensitive default setting. (3) For DIALIGN-TX, we defined the boundary of a conserved motif as the maximum left or right extent to which <italic>all</italic> of the set of sequences aligned in register were reported as conserved. An alternative criterion might be to take a majority vote on the left or right extent of the reported pattern, but this criterion often gave unreasonably long extensions with DIALIGN-TX, and so was not used. For Program 1 run with the 16-sequence input sets, two outliers were found (columns headed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e355" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e356" xlink:type="simple"/></inline-formula>). These are cases where roughly half the sequences in the set contained large insertions or deletions, leading Program 1 to misalign a substantial minority of sequences at one of the boundaries.</p></fn></table-wrap-foot></table-wrap>
<p>Most multiple alignment programs do not explicitly identify in their output conserved motifs as distinct from randomly aligned sequence. However, the output of program DIALIGN-TX <xref ref-type="bibr" rid="pcbi.1000852-Subramanian2">[98]</xref>, developed by the same research group that constructed IRM-1, displays the significantly conserved residues within each sequence in upper case letters, although these do not generally fall into completely consistent aligned columns. We have used this feature to compare the performance of DIALIGN-TX at identifying motif boundaries with that of Program 1 (<xref ref-type="table" rid="pcbi-1000852-t003">Table 3</xref>, with details in the caption). DIALIGN-TX identifies 48% of motif boundaries exactly and 78% to within 1 residue, but its performance appears to degrade as the number of sequences considered increases. In summary, although existing multiple alignment programs such as DIALIGN-TX can do quite a good job at identifying the extent of common motifs embedded within random sequence, the use of BILD scores for this purpose can lead to noticeably improved precision.</p>
<p>The IRM database has been used previously to evaluate the performance of multiple alignment programs by computing how accurately they align the letters that are, by construction, “homologous” <xref ref-type="bibr" rid="pcbi.1000852-Subramanian1">[96]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Papadopoulos1">[99]</xref>. Given a set of sequences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e357" xlink:type="simple"/></inline-formula> from IRM, and the multiple alignment <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e358" xlink:type="simple"/></inline-formula> produced by a particular program, the quality score for the program is defined to be the percentage, taken over all pairs of sequences within <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e359" xlink:type="simple"/></inline-formula>, of the homologous pairs of letters, within the annotated IRM-1 motif, that are aligned in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e360" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000852-Papadopoulos1">[99]</xref>. We used this measure to compare Program 1 to a variety of multiple alignment programs representative of distinct strategies: ClustalW <xref ref-type="bibr" rid="pcbi.1000852-Thompson4">[100]</xref>; PCMA <xref ref-type="bibr" rid="pcbi.1000852-Pei1">[101]</xref>; MUSCLE <xref ref-type="bibr" rid="pcbi.1000852-Edgar3">[102]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Edgar4">[103]</xref>; ProbCons <xref ref-type="bibr" rid="pcbi.1000852-Do1">[104]</xref>; COBALT <xref ref-type="bibr" rid="pcbi.1000852-Papadopoulos1">[99]</xref>; and DIALIGN-TX <xref ref-type="bibr" rid="pcbi.1000852-Subramanian2">[98]</xref>. For each program, various quality score statistics for IRM-1 are presented in <xref ref-type="table" rid="pcbi-1000852-t004">Table 4</xref>, along with aggregate program execution time. As can be seen, Program 1 performs better than or comparably to all the other multiple alignment programs, as measured by the various quality score statistics, and also runs substantially faster. Caution should be employed in interpreting <xref ref-type="table" rid="pcbi-1000852-t004">Table 4</xref>, since Program 1 was explicitly designed for discovering single local patterns within otherwise unrelated sequences, while the other programs were primarily designed to construct global multiple alignments, and some use strategies or parameters that are not well adapted to local multiple alignment.</p>
<table-wrap id="pcbi-1000852-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000852.t004</object-id><label>Table 4</label><caption>
<title>Multiple alignment accuracy.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000852-t004-4" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.t004" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="4" rowspan="1">Quality Score Statistics</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Program</td>
<td align="left" colspan="1" rowspan="1">Minimum</td>
<td align="left" colspan="1" rowspan="1">Mean</td>
<td align="left" colspan="1" rowspan="1">Median</td>
<td align="left" colspan="1" rowspan="1">% Perfect</td>
<td align="left" colspan="1" rowspan="1">Execution time (sec.)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Program 1</td>
<td align="left" colspan="1" rowspan="1">60.7</td>
<td align="left" colspan="1" rowspan="1">95.0</td>
<td align="left" colspan="1" rowspan="1">99.8</td>
<td align="left" colspan="1" rowspan="1">48</td>
<td align="left" colspan="1" rowspan="1">18</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">DIALIGN-TX</td>
<td align="left" colspan="1" rowspan="1">37.6</td>
<td align="left" colspan="1" rowspan="1">94.2</td>
<td align="left" colspan="1" rowspan="1">98.4</td>
<td align="left" colspan="1" rowspan="1">38</td>
<td align="left" colspan="1" rowspan="1">95</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">PCMA 2.0</td>
<td align="left" colspan="1" rowspan="1">16.7</td>
<td align="left" colspan="1" rowspan="1">92.3</td>
<td align="left" colspan="1" rowspan="1">98.4</td>
<td align="left" colspan="1" rowspan="1">23</td>
<td align="left" colspan="1" rowspan="1">376</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">COBALT</td>
<td align="left" colspan="1" rowspan="1">45.6</td>
<td align="left" colspan="1" rowspan="1">95.1</td>
<td align="left" colspan="1" rowspan="1">98.0</td>
<td align="left" colspan="1" rowspan="1">22</td>
<td align="left" colspan="1" rowspan="1">303</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">ProbCons 1.10</td>
<td align="left" colspan="1" rowspan="1">16.7</td>
<td align="left" colspan="1" rowspan="1">82.8</td>
<td align="left" colspan="1" rowspan="1">92.2</td>
<td align="left" colspan="1" rowspan="1">27</td>
<td align="left" colspan="1" rowspan="1">506</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MUSCLE 3.6</td>
<td align="left" colspan="1" rowspan="1">0.0</td>
<td align="left" colspan="1" rowspan="1">38.0</td>
<td align="left" colspan="1" rowspan="1">31.5</td>
<td align="left" colspan="1" rowspan="1">3</td>
<td align="left" colspan="1" rowspan="1">115</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">ClustalW 1.83</td>
<td align="left" colspan="1" rowspan="1">0.0</td>
<td align="left" colspan="1" rowspan="1">8.0</td>
<td align="left" colspan="1" rowspan="1">3.9</td>
<td align="left" colspan="1" rowspan="1">0</td>
<td align="left" colspan="1" rowspan="1">27</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt104"><label/><p>Quality score statistics were measured in the 60 sequence sets of the IRM-1 database <xref ref-type="bibr" rid="pcbi.1000852-Subramanian1">[96]</xref>. “Percent perfect” refers to the proportion of the 60 datasets in which all homologous residues were correctly aligned. All programs were run with default parameters, except that Program 1 and DIALIGN-TX used the parameters detailed in <xref ref-type="table" rid="pcbi-1000852-t003">Table 3</xref>. Because all programs other than Program 1 produce global multiple alignments as a matter of course, the quality score credits them for aligned residues independently of whether these residues are identified as lying within a conserved region. None of these programs explicitly identifies such regions, although DIALIGN-TX does so implicitly, as described in the caption to <xref ref-type="table" rid="pcbi-1000852-t003">Table 3</xref>. Accordingly, in order not to artificially handicap Program 1 on this test, we calculated its quality scores by aligning, immediately adjacent to the conserved pattern it identifies within each sequence, and without gaps, all the residues deemed to lie beyond this pattern. In the small fraction of cases where the identified pattern stops short of the boundary of the embedded motif (see <xref ref-type="table" rid="pcbi-1000852-t003">Table 3</xref>), this can produce a slightly better quality score than the pattern, considered in isolation, would yield. CPU execution times are for programs run on a Dual Pentium 4 Xeon 3.0 GHz CPU Linux computer with 64-bit architecture, and are averaged over three runs.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s3c">
<title>C. Protein Structure Considerations</title>
<p>As mentioned above, real protein domains are subject, on average, to much longer insertions than deletions, and this implies the utility of asymmetric affine gap costs for Program 1. The particular costs that are best will depend upon the statistical properties of gaps, and a possible refinement of Program 1 would be to adjust gap costs dynamically. From the analysis of a variety of protein families, we have found empirically that reasonable gap scores to use in conjunction with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e361" xlink:type="simple"/></inline-formula> Dirichlet mixture priors are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e362" xlink:type="simple"/></inline-formula> bits for a deletion of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e363" xlink:type="simple"/></inline-formula> motif positions (corresponding <xref ref-type="bibr" rid="pcbi.1000852-Neuwald1">[82]</xref> to an initiation frequency per motif position of 0.28%, and a mean length of 2.0), and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e364" xlink:type="simple"/></inline-formula> bits for an insertion of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e365" xlink:type="simple"/></inline-formula> into the motif (corresponding to a frequency of 0.87%, and a mean length of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e366" xlink:type="simple"/></inline-formula>).</p>
<p>Protein structure implies more than an asymmetry between the frequency and length statistics of insertions and deletions. Reflecting the evolution of secondary structure elements and loops, certain motif positions are much less likely to be deleted than others and, similarly, insertions are much less likely to occur between certain pairs of motif positions than others. We describe below an extension of Program 1 to an HMM-based Program 2 that relies only upon column BILD scores to calculate position-specific gap score parameters. We then apply Programs 1 and 2 to the detection of Api-AP2 domains.</p>
<sec id="s3c1">
<title>Program 2 motivation and architecture</title>
<p>Protein families or domains are often described by HMMs <xref ref-type="bibr" rid="pcbi.1000852-Tanaka1">[76]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Karplus1">[81]</xref>. HMMs, in addition to specifying the probabilities for amino acids to occur in various profile positions, may specify distinct probabilities for insertions or deletions to occur in various locations. A more dynamic strategy for model construction than typical for HMMs may be based on the approach described above. As an example of a current strategy, the construction of a Pfam model <xref ref-type="bibr" rid="pcbi.1000852-Sonnhammer1">[105]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Finn1">[107]</xref> starts with a manually-curated gapped multiple alignment of selected members of the protein domain family, the “seed alignment”, from which an HMM profile is built. The seed alignment and HMM are the static canonical entities that define a Pfam family. Then, as a separate procedure, sequence database search programs using this HMM are applied to identify and align additional family members. In contrast, our approach does not entail an initial manual alignment. We start with unaligned sequences, which may include a large proportion of flanking sequence and negative cases of proteins lacking the domain of interest. Moreover, any interesting new proteins discovered can readily be added to the input sequence set to compute a new model. This facilitates a flexible strategy of model updating as knowledge accumulates, although a static HMM could, of course, be retrieved at any stage, if desired.</p>
<p>When translated into the HMM formalism, specifying the asymmetric affine gap cost parameters of Program 1, two for insertions and two for deletions, is equivalent to specifying average frequencies and lengths for insertions and deletions <xref ref-type="bibr" rid="pcbi.1000852-Neuwald1">[82]</xref>, uniformly along the HMM. An HMM's free insertion and deletion parameters generally are optimized for the seed alignment provided. Given the sparsity of the seed data concerning the location of gaps, care must be taken to avoid overfitting <xref ref-type="bibr" rid="pcbi.1000852-Yada1">[108]</xref>–<xref ref-type="bibr" rid="pcbi.1000852-Won2">[110]</xref>. In contrast, we here take the following approach to restricting gap locations based solely upon the BILD scores for columns in the core model, which are data-dense, combined with a few fixed parameters motivated by basic ideas concerning protein structure.</p>
<p>First, we observe that a high BILD score for a column <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e367" xlink:type="simple"/></inline-formula> correlates with the column's importance, and indicates the column is unlikely to be deleted, consistent with a general tendency for conserved residues to occur within structural elements crucial for the folding energetics. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e368" xlink:type="simple"/></inline-formula> be the mean incremental BILD score for aligning a random residue to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e369" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e370" xlink:type="simple"/></inline-formula> is always negative, and large negative values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e371" xlink:type="simple"/></inline-formula> correlate strongly with large positive BILD scores. We set the score (i.e. the log-probability) for extending a deletion through column <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e372" xlink:type="simple"/></inline-formula> to an empirically chosen multiple <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e373" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e374" xlink:type="simple"/></inline-formula>. By default, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e375" xlink:type="simple"/></inline-formula> is 2.5. This has the desired effect of penalizing the deletion of columns with high BILD scores. An additional cost <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e376" xlink:type="simple"/></inline-formula> for the existence of a deletion (default: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e377" xlink:type="simple"/></inline-formula> bits) is left uniform throughout the HMM.</p>
<p>Second, we recognize that insertions are relatively unlikely to occur within regions of a protein that show a close clustering of more conserved positions. Let the normalized score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e378" xlink:type="simple"/></inline-formula> be the BILD score for column <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e379" xlink:type="simple"/></inline-formula> divided by the number of sequences it aligns. We simply disallow insertions anywhere between two columns <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e380" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e381" xlink:type="simple"/></inline-formula> separated by at most one intervening column, when both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e382" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e383" xlink:type="simple"/></inline-formula> exceed a set threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e384" xlink:type="simple"/></inline-formula> (default: 1 bit). Otherwise, the existence and extension costs, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e385" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e386" xlink:type="simple"/></inline-formula> for an insertion are left uniform throughout the HMM with default values of 9.25 and 0.25 bits, as for Program 1. This treatment is motivated by the typical unbroken patterns of local conserved clusters often observed in domain alignments, e.g. the alternating residues of a beta-strand face, or residue pairs within some turn geometries and cap structures. It may be fruitful to extend this insertion model, to conform with observed differences in the frequencies of long and short gaps <xref ref-type="bibr" rid="pcbi.1000852-Goonesekere2">[89]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Mott1">[111]</xref>, or to explicitly model the 3–4 spacing of conserved positions commonly seen in alpha-helices.</p>
<p>This simple approach to HMM parameter construction can of course be refined. Nevertheless, it captures central features of the location of insertions and deletions within proteins, without relying upon a preconstructed alignment, or on the relatively small sample of gaps present in a particular data set. Program 2 proceeds identically to Program 1, except that in place of the Erickson-Sellers algorithm with asymmetric affine gap costs, it uses the Viterbi algorithm to find an optimal path through the constructed HMM.</p>
</sec><sec id="s3c2">
<title>Application to Api-AP2 domains</title>
<p>To illustrate how our methods may be applied to typical problems, we consider the sequence-specific DNA recognition domains from the Api-AP2 transcription factor family of apicomplexan parasites. Multiple paralogous Api-AP2 domains in the translated proteomes of <italic>Plasmodium</italic> and <italic>Cryptosporidium</italic> parasites were initially discovered using PSI-BLAST searches by Balaji et al. <xref ref-type="bibr" rid="pcbi.1000852-Balaji1">[112]</xref>, based on weak similarity to the plant AP2 (APETALA2) transcription factors. These domains also have weak similarity to part of the HNH domain of homing endonucleases <xref ref-type="bibr" rid="pcbi.1000852-Magnani1">[113]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Wuitschick1">[114]</xref>. As the principal known sequence-specific DNA binding domains of Apicomplexa, Api-AP2 sequences represent a major lineage-specific gene expansion within the alveolate protists and are currently a topic of intense research <xref ref-type="bibr" rid="pcbi.1000852-DeSilva1">[115]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Yuda1">[116]</xref>. They are believed to function in transcriptional activation crucial for parasite biology and development, and have potential as stage-specific anti-parasitic drug targets, due to the absence of AP2 homologs in the mammalian hosts. It is important to develop a system-level understanding of the Api-AP2 factors, and a prerequisite for this is to discover and annotate the entire complement of Api-AP2 proteins in each of these parasite genomes, possibly beyond the lists obtained from PSI-BLAST and the current HMM-based (Pfam model 00847) searches.</p>
<p>The Api-AP2 family presents a weakly-clustered pattern of amino acid conservation at variable spacing within the typically 50–60 amino acid domain. This profile is present one to approximately six times within otherwise extremely variable protein sequences of typically more than 1000 amino acids. The proteins show little significant homology outside the Api-AP2 regions: there are many low-complexity segments and occasional recognizable domains of other types, but the latter do not show any consistent relationship to the Api-AP2 regions. On the order of 20 to 80 Api-AP2 domains are encoded in each apicomplexan genome. Although relatively small, this domain has typical globular protein structure with a 3-strand beta-sheet packed against an alpha-helix, with several classes of beta-turn, and a longer loop. The more conserved positions occur mainly within the sheet, the helix and beta-turn structural elements. Consequently, multiple alignment profiles tend to show a loosely-patterned clustering of column scores, as is typical of globular domains.</p>
<p>Using PSI-BLAST searches of apicomplexan translated genome databases, we collected proteins containing at least one candidate Api-AP2 domain from <italic>Toxoplasma gondii</italic> (53 proteins) and <italic>Plasmodium falciparum</italic> (18 proteins; similar to the set identified by <xref ref-type="bibr" rid="pcbi.1000852-Balaji1">[112]</xref>). These sequences were used as input to develop the features of Programs 1 and 2 and to test their ability to construct protein domain profiles and discover additional domains. The results are outlined below, illustrated in <xref ref-type="fig" rid="pcbi-1000852-g001">Figures 1</xref>–<xref ref-type="fig" rid="pcbi-1000852-g002"/><xref ref-type="fig" rid="pcbi-1000852-g003">3</xref>, and presented more fully in <xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Tables S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000852.s009">S4</xref> and their caption.</p>
<fig id="pcbi-1000852-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000852.g001</object-id><label>Figure 1</label><caption>
<title>Distributions of bit scores from Api-AP2 domains and negative controls.</title>
<p>The histograms in <bold>A</bold> and <bold>B</bold> represent data for both positive and negative cases reported by Program 1 at different intermediate stages of a run. The input file contained 107 amino acid sequences consisting of 54 <italic>T. gondii</italic> proteins with Api-AP2 domain candidates, and 53 random sequences obtained by shuffling the concatenated sequence of 53 of the 54 Api-AP2 proteins and cutting this shuffled string into the original lengths (method of <xref ref-type="bibr" rid="pcbi.1000852-Wootton1">[119]</xref>). The Dirichlet mixture prior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e387" xlink:type="simple"/></inline-formula> was specified. <bold>A</bold>: Results after the initial Gibbs sampling stage. The ungapped local alignment with optimal aggregate BILD score had width 53. For each sequence, we plot the incremental BILD score, resulting from the addition of a segment from that sequence to the alignment of all the other segments, minus the log of the effective length of that sequence. Scores from the real and random sequences are shown respectively in red and blue. If a prior probability for the existence of a domain in each sequence were specified, segments with scores below a calculated threshold would be rejected. Here, however, the Gibbs sampling step includes one ungapped segment from each of the 107 input sequences in the initial pattern it constructs. <bold>B</bold>: Results after the iterative gapped alignment stage. In each gapped alignment iteration of Program 1, the evolving length-53 pattern is aligned to each input sequence, perhaps multiple times, using a greedy application of the Erickson-Sellers algorithm. Incremental BILD scores are calculated from the current multiple alignment, excluding the sequence to which it is being realigned. Deletions of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e388" xlink:type="simple"/></inline-formula> are assigned a score of −8.5−<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e389" xlink:type="simple"/></inline-formula> bits, and insertions of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e390" xlink:type="simple"/></inline-formula> a score of −9.25–0.25<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e391" xlink:type="simple"/></inline-formula> bits. The cost for the existence of a pattern is based on assuming a mean of one instance per sequence, but with uniform probability at all positions of all sequences. In addition, the score for each aligned letter is adjusted slightly to reflect a small cost for not having a gap. At each iteration, the program reports segments with score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e392" xlink:type="simple"/></inline-formula>−25 bits, but only segments with positive score are included in the next iteration. We show the data reported for the highest-scoring alignment; at this stage, at least one positively scoring segment derives from each of the 54 real sequences but only 2 segments (each with score less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e393" xlink:type="simple"/></inline-formula> bits) derive from the 53 random sequences. 88 positive-scoring instances of the pattern are found, at least one from each of the real sequences, but none from the random sequences. In addition, 19 instances of the pattern with negative score are found, 2 of which derive from the random sequences. For an aligned segment, a log-odds bit score of 0 indicates an equal probability of being generated by the model implied by the other sequences, or at random by background amino acid frequencies. In <bold>B</bold>, the bars are colored according to the presence (cyan) or absence (brown) of strong sequence matches to the 3 beta-strands and the alpha-helix of the core Api-AP2 structure; the positions of these elements are shown in <xref ref-type="fig" rid="pcbi-1000852-g003">Figure 3</xref>. To qualify for a cyan bar, a sequence was required to contain either identities or high-structural-propensity substitutions that match the strongly conserved amino acids (with column BILD score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e394" xlink:type="simple"/></inline-formula>1.5 bits per residue) in the helix and at least 2 of the 3 beta-strands. The fairly clean separation, near 0 bits, of the cyan bars from the others indicates that a positive score is a good criterion for nominating a segment as an Api-AP2 candidate.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.g001" xlink:type="simple"/></fig><fig id="pcbi-1000852-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000852.g002</object-id><label>Figure 2</label><caption>
<title>Near-identical Api-AP2 profiles from two parasites with very different background frequencies.</title>
<p>For <italic>P. falciparum</italic> (<bold>A</bold>, <bold>B</bold>) and <italic>T. gondii</italic> (<bold>C</bold>, <bold>D</bold>), the logos <xref ref-type="bibr" rid="pcbi.1000852-Schneider2">[120]</xref> (<ext-link ext-link-type="uri" xlink:href="http://weblogo.berkeley.edu/" xlink:type="simple">http://weblogo.berkeley.edu/</ext-link>) represent the letters aligned in the columns of the core Api-AP2 patterns (<bold>A</bold>, <bold>C</bold>). In the letter clouds (<ext-link ext-link-type="uri" xlink:href="http://www.wordle.net/advanced" xlink:type="simple">http://www.wordle.net/advanced</ext-link>) (<bold>B</bold>, <bold>D</bold>), the area occupied by each letter indicates the background frequency of an amino acid in the input sequence set (compare Fig. 2.1 of <xref ref-type="bibr" rid="pcbi.1000852-MacKay1">[49]</xref>). Colors represent various amino acid classes. For both organisms, Programs 1 or 2, run with Dirichlet mixture priors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e395" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e396" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e397" xlink:type="simple"/></inline-formula>, converged on essentially the same 53- to 54-column core models that correspond to these logos. Api-AP2 models and logos almost identical to these were also obtained from other apicomplexan parasites <italic>Cryptosporidium hominis</italic>, <italic>Babesia bovis</italic>, <italic>Theilleria parva</italic>, and from the basal alveolate <italic>Perkinsus marinus</italic>, whereas the distantly related plant AP2 domains and HNH homing endonuclease/integrase domains gave distinct characteristic patterns similar in parts to Api-AP2 (data not shown). Thus, the core structural features of the Api-AP2 domain have been strongly conserved in long-diverged members of the Alveolata, following an ancestral gene expansion, whereas the background amino acid content of these organisms is strikingly different due to genome-wide drift.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.g002" xlink:type="simple"/></fig><fig id="pcbi-1000852-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000852.g003</object-id><label>Figure 3</label><caption>
<title>Large insertions in the central loop region of Api-AP2 domains.</title>
<p>As a consequence of asymmetric gap costs, Programs 1 and 2 reported several positive Api-AP2 candidates which have long insertions but, in the other parts of the domain, show high-scoring matches to the canonical pattern. Here, the sequence of <italic>T. gondii</italic> protein TGME49_06420, which has a 45 amino acid insertion in the central loop region, is shown aligned with the two most-closely-matching domains of typical length. Program 2, run with Dirichlet mixture prior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e398" xlink:type="simple"/></inline-formula> and default parameters, assigned the insertion to the central loop location shown, which avoided the more conserved columns of the secondary structural elements indicated above the sequences. In contrast, Program 1 placed the same inserted residues in three separate locations, two of which would disrupt secondary structure. Moreover, with an established HMM search method <xref ref-type="bibr" rid="pcbi.1000852-Eddy2">[80]</xref> (<ext-link ext-link-type="uri" xlink:href="http://hmmer.janelia.org/" xlink:type="simple">http://hmmer.janelia.org/</ext-link>), only the right end alignment of this TGME49_06420 domain was found, but with a negative score well below the rejection threshold. Structural assignments E (beta-strand) and H (alpha-helix) are based on homologous experimental structures <xref ref-type="bibr" rid="pcbi.1000852-Allen1">[121]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Lindner1">[122]</xref> (PDB codes 2gcc,3gcc,3igm).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.g003" xlink:type="simple"/></fig>
<p>To explore how Programs 1 and 2 can tolerate negative cases, lacking the domain of interest, we spiked the Api-AP2 input sets with various proportions of (a) random sequences constructed by shuffling input sequences, or (b) real sequences lacking annotated conserved patterns, or (c) sequences that shared a conserved domain unrelated to Api-AP2. Spikes of types (a) and (b) comprising half of the total input sequences did not affect the final Api-AP2 models: the random and unrelated patterns in the spike sequences were all rejected (<xref ref-type="fig" rid="pcbi-1000852-g001">Figure 1</xref>) during or after the initial ungapped Gibbs sampling step, and this step runs faster if one specifies a prior expectation that a fraction of the input sequences do not contain the pattern of interest. If the Gibbs sampling stage of either Program 1 or 2 is run with a prior expectation that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e399" xlink:type="simple"/></inline-formula> of the input sequences do not contain an instance of the pattern, then all the random sequences and five of the Api-AP2 sequences are initially excluded, but subsequent gapped alignment steps recover segments from the initially rejected Api-AP2 sequences. The final result is the same whether or not sequences are excluded in the initial stage. With some spikes of type (c), the Gibbs sampling step converged on the competing domain instead of the Api-AP2 pattern. This suggests that input sequence domain parsing, e.g. by methods in <xref ref-type="bibr" rid="pcbi.1000852-Phuong1">[117]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Raphael1">[118]</xref>, may sometimes be beneficial.</p>
<p>The amino acid frequencies observed within the core Api-AP2 model were strikingly similar for <italic>Plasmodium</italic> and <italic>Toxoplasma</italic> (<xref ref-type="fig" rid="pcbi-1000852-g002">Figure 2</xref>), consistent with an evolutionary expansion of this family from a single ancestral gene within the Alveolata, as proposed by <xref ref-type="bibr" rid="pcbi.1000852-Balaji1">[112]</xref>. Present day parasite lineages have evolved strikingly different codon and background amino acid content arising from genomic drift, e.g. in the very AT-rich <italic>Plasmodium</italic> and the more GC-enriched <italic>Toxoplasma</italic>. This contrast in background frequencies (<xref ref-type="fig" rid="pcbi-1000852-g002">Figure 2</xref>) demonstrates the value of log-odds scores for identifying a subtle pattern in very different sequence contexts.</p>
<p>The Api-AP2 pattern is present more than once in many of the input sequences as is often the case with eukaryotic multidomain proteins, potentially enabling these transcription factors to recognize combinations of DNA sites. The greedy algorithm included in Programs 1 and 2 allows such repeated domains to be identified. A total of 89 domains were found within the initial 53 <italic>Toxoplasma</italic> input sequences. Only 2 domains had borderline scores and may be candidates for classification as degenerate pseudo-domains. As shown in <xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Table S3</xref>, repeats in the same protein can be very diverse in sequence. Programs 1 and 2 found several repeated domains additional to those reported in searches with Pfam model 00847, including some that differ from the canonical domain length by relatively long insertions in the central loop region (<xref ref-type="fig" rid="pcbi-1000852-g003">Figure 3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Table S3</xref>).</p>
<p>We conducted further searches of the <italic>Toxoplasma</italic> and <italic>Plasmodium</italic> databases based on the core Api-AP2 alignment obtained from Programs 1 and 2. These revealed new candidate proteins with Api-AP2 domains (<xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Tables S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000852.s009">S4</xref>), not found with Pfam model 00847, some of which also show long loop insertions, but are otherwise strongly similar to the canonical Api-AP2 domain sequence (<xref ref-type="fig" rid="pcbi-1000852-g003">Figure 3</xref>). Including these new Api-AP2 cases, we have identified a total of 68 proteins (103 domains) for <italic>Toxoplasma</italic> and 29 proteins (50 domains) for <italic>Plasmodium</italic> (<xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Tables S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000852.s009">S4</xref>).</p>
<p>It is not yet known if Api-AP2 domains with long insertions are active in DNA binding and transcriptional control, or whether any are inactive pseudo-domains, or are artifacts from errors in gene modeling. However, their occurrence illustrates that a relatively small minority of members of a domain family may contain long insertions, a general feature of protein evolution. Experimental studies confirm that many such long insertions, when artificially engineered into structural loops, have surprisingly low costs for the free energy of folding and little effect on the functional interactions of the proteins <xref ref-type="bibr" rid="pcbi.1000852-Ladurner1">[90]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-ScalleyKim1">[91]</xref>. Thus, both the observed occurrence and the statistical thermodynamics of long insertions justify our treatment, described above, using asymmetric affine gap costs.</p>
</sec></sec></sec><sec id="s4">
<title>Discussion</title>
<p>We have described a natural generalization of log-odds substitution scores for pairwise alignments to substitution scores for multiple alignment columns. Multiple alignment log-odds scores probably are best derived using a Bayesian approach, yielding what we have called BILD scores. Log-odds scores imply scores for aligning multiple alignment columns to one another, or for aligning multiple alignment columns to single sequences, and it was in this latter context that the Bayesian approach was first formulated by Brown <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000852.e400" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000852-Brown1">[31]</xref>. In conjunction with the Minimum Description Length Principle, log-odds scores provide a means for determining the proper width or extent of a local multiple alignment, and for deciding whether a segment should be included in the alignment. They may also be used to cluster a set of related segments into subclasses; see <xref ref-type="supplementary-material" rid="pcbi.1000852.s004">Text S4</xref> and <xref ref-type="bibr" rid="pcbi.1000852-Brown2">[62]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Sjlander2">[71]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Brown3">[72]</xref>.</p>
<p>One may compute rapidly the BILD score for a multiple alignment column, as well as the new score that results from the addition or subtraction of a single letter. This permits BILD scores to be used practically in Gibbs-sampling local multiple alignment programs. They can improve the performance of such programs, and remove the need for specifying the width of a pattern sought.</p>
<p>The proper description of protein domains in most cases requires a provision for gaps. We have implemented two relatively simple programs for extending a core ungapped pattern or profile to a gapped local multiple alignment. There are several key elements to our approach. First, the initial maximization of aggregate BILD scores using Gibbs sampling yields a core pattern and pattern length for further refinement. Second, the semi-global alignment of this pattern to the input sequences recognizes the importance of complete occurrences of the pattern. Third, the use of asymmetric affine gap costs (Program 1) recognizes that, with respect to the core pattern, long deletions generally are much more deleterious than long insertions. The placement of gaps can be refined using position-specific gap costs derived from column BILD scores (Program 2). Fourth, greedy alignment allows multiple instances of a pattern to be found within a single sequence. In conjunction with length-dependent gap costs, it discourages alignments spanning more than one instance of a pattern, but can still uncover long insertions. Fifth, iteration permits the core model to be refined, improving the discrimination of true relationships from chance similarities. This strategy, informed by considerations of protein structure, has proved a rapid and effective method for delineating protein families. Although our programs were developed only for research purposes, with the limited goal of testing the impact of BILD scores, their code is available upon request.</p>
<p>We have sought here primarily to describe the construction and potential uses of log-odds scores in the multiple alignment context. However, many avenues for further research, involving the development and benchmarking of complete multiple alignment programs, remain. To what extent can BILD scores improve the accuracy of profile-profile comparison programs? How does Erickson-Sellers semi-global alignment <xref ref-type="bibr" rid="pcbi.1000852-Erickson1">[92]</xref>, with uniform asymmetric affine gap costs, compare to HMM <xref ref-type="bibr" rid="pcbi.1000852-Eddy2">[80]</xref>, <xref ref-type="bibr" rid="pcbi.1000852-Karplus1">[81]</xref> and other methods <xref ref-type="bibr" rid="pcbi.1000852-Kann1">[6]</xref> in recognizing related sequence in database searches? We look forward to investigating some of these questions.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000852.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.s001" xlink:type="simple"><label>Text S1</label><caption>
<p>MELD Scores</p>
<p>(0.05 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000852.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.s002" xlink:type="simple"><label>Text S2</label><caption>
<p>The Mean Relative Entropy of Dirichlet Mixtures</p>
<p>(0.05 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000852.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.s003" xlink:type="simple"><label>Text S3</label><caption>
<p>The MDL Principle and Local Alignment Statistics</p>
<p>(0.04 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000852.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.s004" xlink:type="simple"><label>Text S4</label><caption>
<p>The MDL Principle and the Clustering of Multiple Alignments</p>
<p>(0.05 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000852.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.s005" xlink:type="simple"><label>Text S5</label><caption>
<p>Gibbs Sampling Algorithms and HTH Proteins</p>
<p>(0.05 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000852.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.s006" xlink:type="simple"><label>Table S1</label><caption>
<p>Helix-turn-helix proteins.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000852.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.s007" xlink:type="simple"><label>Table S2</label><caption>
<p>Number of sequences misaligned by Gibbs sampling programs. Sequence sets supplied to the BILD and Wadsworth samplers consist of the first <italic>M</italic> sequences listed in <xref ref-type="supplementary-material" rid="pcbi.1000852.s006">Table S1</xref>. For each sequence set, the BILD sampler determines an optimal motif width <italic>W</italic>. Both BILD and Wadsworth samplers optimize contiguous motifs of widths <italic>W</italic>, 17, 21 and 25. The number of sequences misaligned by the Wadsworth sampler are given in the table without parentheses; the number misaligned by the BILD sampler within parentheses.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000852.s008" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.s008" xlink:type="simple"><label>Table S3</label><caption>
<p><xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Tables S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000852.s009">S4</xref> show Api-AP2 domains and bit scores reported by Programs 1 and 2 for <italic>Toxoplasma gondii</italic> (<xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Table S3</xref>) and <italic>Plasmodium falciparum</italic> (<xref ref-type="supplementary-material" rid="pcbi.1000852.s009">Table S4</xref>). Also shown are the bit scores obtained using HMMsearch database searches [Eddy SR (1998) <italic>Bioinformatics</italic> 14: 755–763] seeded with aligned Api-AP2 domains and with the current Pfam AP2 model number 00847 (<ext-link ext-link-type="uri" xlink:href="http://pfam.sanger.ac.uk/family?entry=PF00847" xlink:type="simple">http://pfam.sanger.ac.uk/family?entry=PF00847</ext-link>). Programs 1 and 2 were run with the Dirichlet mixture prior and default parameters described in the <xref ref-type="sec" rid="s3">Results</xref> section and <xref ref-type="fig" rid="pcbi-1000852-g001">Figures 1</xref> and <xref ref-type="fig" rid="pcbi-1000852-g003">3</xref>. As input, we collected 68 amino acid sequences from <italic>T. gondii</italic> and 29 from <italic>P. falciparum</italic>, based on inspection of low-threshold PSI-BLAST and HMMsearch searches of the parasite genomic translation databases of ToxoDB [Gajria <italic>et al.</italic> (2008) <italic>Nucleic Acids Res</italic> 36: D553–556] and PlasmoDB [Aurrecoechea <italic>et al.</italic> (2009) <italic>Nucleic Acids Res</italic> 37: D539–543] (<ext-link ext-link-type="uri" xlink:href="http://eupathdb.org/eupathdb/" xlink:type="simple">http://eupathdb.org/eupathdb/</ext-link>). These database searches were seeded with earlier alignments produced (as described in the <xref ref-type="sec" rid="s3">Results</xref> section and <xref ref-type="fig" rid="pcbi-1000852-g001">Figure 1</xref> legend) from more preliminary sets of 54 <italic>T. gondii</italic> and 18 <italic>P. falciparum</italic> sequences. We anticipated that the larger sets of input sequences might include some false positives; however, the final evolved models included at least one positive score from each of the 68 and 29 sequences, totaling 103 Api-AP2 domain candidates for <italic>T. gondii</italic> and 50 for <italic>P. falciparum</italic>. The corresponding core domain alignments assigned by Program 2 are shown, denoted respectively ‘Tg-core’ (with 53 columns in the evolved model plus 2 adjacent positively-scoring columns added from the left-flank) and ‘Pf-core’ (with 53 columns) respectively. These patterns exclude any insertions in individual sequences: the number of inserted residues is shown in a separate column. All of these domains have positive bit scores with Programs 1 and 2, except for the special case of domain 1.7, <xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Table S3</xref>, which has been added manually to the <italic>T. gondii</italic> alignment. This domain is notable because of its occurrence within a multi-Api-AP2 protein and its strong match to the canonical 53-column pattern; however, it also has an unusually long insertion of 66 amino acids (assigned to the central loop by Program 2), the cost of which results in an overall negative score. The Tg-core (excluding domain 1.7) and the Pf-core alignments shown in <xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Tables S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000852.s009">S4</xref> were used as seed alignments for further analysis with HMMER version 2.3.2 (<ext-link ext-link-type="uri" xlink:href="http://hmmer.janelia.org" xlink:type="simple">http://hmmer.janelia.org</ext-link>). HMMbuild and HMMcalibrate were used with default parameters to construct HMMs and calibrate their E-value distributions, and HMMsearch was used with a permissive E-value threshold of 100 to search the parasite genomic translation databases against these HMMs. These searches gave positive bit scores for the domains used for HMM construction (except domain 1.8, which was not reported, <xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Table S3</xref>), as shown in the columns headed ‘bits (HMMsearch, Tg-core seed)’ and ‘bits (HMMsearch, Pf-core seed)’. In some cases, HMMsearch alignments encompassed only part of the Api-AP2 pattern, either to the left or right of the central loop, denoted, respectively, ‘LH only’ and ‘RH only’ in comments columns. Note that all of the positively scoring sequences reported were present in the seed alignment, and no new Api-AP2 domain candidates were found in these HMMsearch database searches. HMMsearch scans of the same databases were also seeded by Pfam model 00847 (converted to a version 2.3.2 HMM with HMMbuild and HMMcalibrate as described above). The resulting bit scores are given in the columns headed ‘bits (HMMsearch, Pfam00847 seed)’. The Pfam00847 model seed alignment contains both plant and apicomplexan AP2 domains, including some from <italic>P. falciparum</italic> but none from <italic>T. gondii</italic>. Consequently, the matches of Pfam00847 to the Api-AP2 domains are generally weaker than the matches obtained with the more specific models from Program 2 Api-AP2 core alignments, resulting in substantially lower bit scores. Several domain candidates (highlighted in color), 10 from <italic>T. gondii</italic> and 4 from <italic>P. falciparum</italic>, were not reported by the Pfam00847 HMMsearch above the E-value 100 threshold, and others (9 and 3 respectively) were given negative scores (and non-significant E-values). These low scores reflect misalignments (e.g. missed long insertions) in some cases. In other cases, limited deviations from the canonical conserved patterns occur, commonly in the first beta-strand. However, such deviant residues appear to be structurally compatible with the domain, with beta-strand-favoring propensities in most cases, suggesting that these examples may be authentic but non-canonical Api-AP2 domains. HMMER methodology is capable of identifying and aligning such domains if they are included in the seed alignment, as shown by the bit scores given by the Tg-core and Pf-core seeded searches. Indeed, the <italic>T. gondii</italic> domain 62.1 (TGME49_062420), which is the example with a 45/46 amino acid insertion shown in <xref ref-type="fig" rid="pcbi-1000852-g003">Figure 3</xref>, obtains a positive bit score with HMMsearch (and 46 inserted residues) when it is included in the Tg-core seed alignment (as in <xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Table S3</xref>) but a negative score and only a partial alignment otherwise, as indicated in <xref ref-type="fig" rid="pcbi-1000852-g003">Figure 3</xref> legend. In several cases, HMMsearch alignments report different gap positions from Program 2, mostly with shorter insertions. In the case of domain 66.1 (<xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Table S3</xref>) the alignment produced by HMMsearch appears to be more compatible with beta-strand propensities than the Program 2 alignment shown in <xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Table S3</xref>, whereas in 6 other cases, the HMMsearch alignment appears more disruptive of secondary structure. This observation supports the potential benefit of incorporating secondary structure prediction into an HMM-based domain recognition strategy, as proposed by Won <italic>et al.</italic> [(2007) <italic>BMC Bioinformatics</italic> 8: 357]. Overall, the HMMsearch results shown in these Tables, compared with the Programs 1 and 2 output, show many more similarities than differences: the two approaches can achieve very similar results with appropriate inputs. Our examples also illustrate how the relatively simple BILD score based approaches, by reducing the strict dependence on seed alignments, might facilitate more automated processes for the discovery and reporting of protein domain families and more flexible updating strategies.</p>
<p>(0.05 MB XLS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000852.s009" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000852.s009" xlink:type="simple"><label>Table S4</label><caption>
<p>Api-AP2 domains and bit scores reported by Programs 1 and 2 for <italic>Plasmodium falciparum</italic>. For more details please see caption to <xref ref-type="supplementary-material" rid="pcbi.1000852.s008">Table S3</xref>.</p>
<p>(0.03 MB XLS)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>The authors thank Dr. Richa Agarwala for assistance in the benchmarking of Program 1 and other multiple alignment programs.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000852-Smith1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smith</surname><given-names>TF</given-names></name>
<name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name>
</person-group>             <year>1981</year>             <article-title>Identification of common molecular subsequences.</article-title>             <source>J Mol Biol</source>             <volume>147</volume>             <fpage>195</fpage>             <lpage>197</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Sellers1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sellers</surname><given-names>PH</given-names></name>
</person-group>             <year>1984</year>             <article-title>Pattern recognition in genetic sequences by mismatch density.</article-title>             <source>Bull Math Biol</source>             <volume>46</volume>             <fpage>501</fpage>             <lpage>514</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Pearson1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pearson</surname><given-names>WR</given-names></name>
<name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name>
</person-group>             <year>1988</year>             <article-title>Improved tools for biological sequence comparison.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>85</volume>             <fpage>2444</fpage>             <lpage>2448</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Altschul1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
<name name-style="western"><surname>Madden</surname><given-names>TL</given-names></name>
<name name-style="western"><surname>Schäffer</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name>
<etal/></person-group>             <year>1997</year>             <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs.</article-title>             <source>Nucleic Acids Res</source>             <volume>25</volume>             <fpage>3389</fpage>             <lpage>3402</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-MarchlerBauer1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Marchler-Bauer</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Anderson</surname><given-names>JB</given-names></name>
<name name-style="western"><surname>Chitsaz</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Derbyshire</surname><given-names>MK</given-names></name>
<name name-style="western"><surname>DeWeese-Scott</surname><given-names>C</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>CDD: specific functional annotation with the Conserved Domain Database.</article-title>             <source>Nucleic Acids Res</source>             <volume>37</volume>             <fpage>D205</fpage>             <lpage>D210</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Kann1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kann</surname><given-names>MG</given-names></name>
<name name-style="western"><surname>Sheetlin</surname><given-names>SL</given-names></name>
<name name-style="western"><surname>Park</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Bryant</surname><given-names>SH</given-names></name>
<name name-style="western"><surname>Spouge</surname><given-names>JL</given-names></name>
</person-group>             <year>2007</year>             <article-title>The identification of complete domains within protein sequences using accurate e-values for semi-global alignment.</article-title>             <source>Nucleic Acids Res</source>             <volume>35</volume>             <fpage>4678</fpage>             <lpage>4685</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Dayhoff1"><label>7</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dayhoff</surname><given-names>MO</given-names></name>
<name name-style="western"><surname>Schwartz</surname><given-names>RM</given-names></name>
<name name-style="western"><surname>Orcutt</surname><given-names>BC</given-names></name>
</person-group>             <year>1978</year>             <article-title>A model of evolutionary change in proteins.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Dayhoff</surname><given-names>MO</given-names></name>
</person-group>             <source>Atlas of Protein Sequence and Structure</source>             <publisher-loc>Washington, DC</publisher-loc>             <publisher-name>Natl. Biomed. Res. Found.</publisher-name>             <volume>volume 5</volume><supplement>suppl. 3</supplement><fpage>345</fpage>             <lpage>352</lpage>            </element-citation></ref>
<ref id="pcbi.1000852-Schwartz1"><label>8</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schwartz</surname><given-names>RM</given-names></name>
<name name-style="western"><surname>Dayhoff</surname><given-names>MO</given-names></name>
</person-group>             <year>1978</year>             <article-title>Matrices for detecting distant relationships.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Dayhoff</surname><given-names>MO</given-names></name>
</person-group>             <source>Atlas of Protein Sequence and Structure</source>             <publisher-loc>Washington, DC</publisher-loc>             <publisher-name>Natl. Biomed. Res. Found.</publisher-name>             <volume>volume 5</volume><supplement>suppl. 3</supplement><fpage>353</fpage>             <lpage>358</lpage>            </element-citation></ref>
<ref id="pcbi.1000852-Feng1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Feng</surname><given-names>DF</given-names></name>
<name name-style="western"><surname>Johnson</surname><given-names>MS</given-names></name>
<name name-style="western"><surname>Doolittle</surname><given-names>RF</given-names></name>
</person-group>             <year>1985</year>             <article-title>Aligning amino acid sequences: comparison of commonly used methods.</article-title>             <source>J Mol Evol</source>             <volume>21</volume>             <fpage>112</fpage>             <lpage>125</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Taylor1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Taylor</surname><given-names>WR</given-names></name>
</person-group>             <year>1986</year>             <article-title>The classification of amino acid conservation.</article-title>             <source>J Theor Biol</source>             <volume>119</volume>             <fpage>205</fpage>             <lpage>218</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Rao1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rao</surname><given-names>JKM</given-names></name>
</person-group>             <year>1987</year>             <article-title>New scoring matrix for amino acid residue exchanges based on residue characteristic physical parameters.</article-title>             <source>Int J Peptide Protein Res</source>             <volume>29</volume>             <fpage>276</fpage>             <lpage>281</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Risler1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Risler</surname><given-names>JL</given-names></name>
<name name-style="western"><surname>Delorme</surname><given-names>MO</given-names></name>
<name name-style="western"><surname>Delacroix</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Henaut</surname><given-names>A</given-names></name>
</person-group>             <year>1988</year>             <article-title>Amino acid substitutions in structurally related proteins.</article-title>             <source>J Mol Biol</source>             <volume>204</volume>             <fpage>1019</fpage>             <lpage>1029</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Gonnet1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gonnet</surname><given-names>GH</given-names></name>
<name name-style="western"><surname>Cohen</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Benner</surname><given-names>SA</given-names></name>
</person-group>             <year>1992</year>             <article-title>Exhaustive matching of the entire protein sequence database.</article-title>             <source>Science</source>             <volume>256</volume>             <fpage>1443</fpage>             <lpage>1445</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Henikoff1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Henikoff</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Henikoff</surname><given-names>JG</given-names></name>
</person-group>             <year>1992</year>             <article-title>Amino acid substitution matrices from protein blocks.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>89</volume>             <fpage>10915</fpage>             <lpage>10919</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Overington1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Overington</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Donnelly</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Johnson</surname><given-names>MS</given-names></name>
<name name-style="western"><surname>Sali</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Blundell</surname><given-names>TL</given-names></name>
</person-group>             <year>1992</year>             <article-title>Environment-specific amino acid substitution tables: Tertiary templates and prediction of protein folds.</article-title>             <source>Prot Sci</source>             <volume>1</volume>             <fpage>216</fpage>             <lpage>226</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Jones1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Jones</surname><given-names>DT</given-names></name>
<name name-style="western"><surname>Taylor</surname><given-names>WR</given-names></name>
<name name-style="western"><surname>Thornton</surname><given-names>JM</given-names></name>
</person-group>             <year>1992</year>             <article-title>The rapid generation of mutation data matrices from protein sequences.</article-title>             <source>Comput Appl Biosci</source>             <volume>8</volume>             <fpage>275</fpage>             <lpage>282</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Kann2"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kann</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Qian</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Goldstein</surname><given-names>RA</given-names></name>
</person-group>             <year>2000</year>             <article-title>Optimization of a new score function for the detection of remote homologs.</article-title>             <source>Proteins</source>             <volume>41</volume>             <fpage>498</fpage>             <lpage>503</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Ng1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ng</surname><given-names>PC</given-names></name>
<name name-style="western"><surname>Henikoff</surname><given-names>JG</given-names></name>
<name name-style="western"><surname>Henikoff</surname><given-names>S</given-names></name>
</person-group>             <year>2000</year>             <article-title>PHAT: a transmembrane-specific substitution matrix.</article-title>             <source>Bioinformatics</source>             <volume>16</volume>             <fpage>760</fpage>             <lpage>766</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Mller1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Müller</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Rahmann</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Rehmsmeier</surname><given-names>M</given-names></name>
</person-group>             <year>2001</year>             <article-title>Non-symmetric score matrices and the detection of homologous transmembrane proteins.</article-title>             <source>Bioinformatics</source>             <volume>17,</volume>             <supplement>Suppl. 1</supplement>             <fpage>S182</fpage>             <lpage>S189</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Goonesekere1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Goonesekere</surname><given-names>NC</given-names></name>
<name name-style="western"><surname>Lee</surname><given-names>B</given-names></name>
</person-group>             <year>2008</year>             <article-title>Context-specific amino acid substitution matrices and their use in the detection of protein homologs.</article-title>             <source>Proteins</source>             <volume>71</volume>             <fpage>910</fpage>             <lpage>919</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-States1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>States</surname><given-names>DJ</given-names></name>
<name name-style="western"><surname>Gish</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
</person-group>             <year>1991</year>             <article-title>Improved sensitivity of nucleic acid database searches using application-specific scoring matrices.</article-title>             <source>Methods</source>             <volume>3</volume>             <fpage>66</fpage>             <lpage>70</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Chiaromonte1"><label>22</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chiaromonte</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Yap</surname><given-names>VB</given-names></name>
<name name-style="western"><surname>Miller</surname><given-names>W</given-names></name>
</person-group>             <year>2002</year>             <article-title>Scoring pairwise genomic sequence alignments.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Altman</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Dunker</surname><given-names>AK</given-names></name>
<name name-style="western"><surname>Hunter</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Lauderdale</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Klein</surname><given-names>TE</given-names></name>
</person-group>             <source>Proc. Pacific Symp. Biocomput</source>             <publisher-loc>Mountain View, CA</publisher-loc>             <publisher-name>World Scientific</publisher-name>             <fpage>115</fpage>             <lpage>126</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Karlin1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Karlin</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
</person-group>             <year>1990</year>             <article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>87</volume>             <fpage>2264</fpage>             <lpage>2268</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Dembo1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dembo</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Karlin</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Zeitouni</surname><given-names>O</given-names></name>
</person-group>             <year>1994</year>             <article-title>Limit distribution of maximal nonaligned two-sequence segmental score.</article-title>             <source>Ann Prob</source>             <volume>22</volume>             <fpage>2022</fpage>             <lpage>2039</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Sankoff1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name>
</person-group>             <year>1975</year>             <article-title>Minimal mutation trees of sequences.</article-title>             <source>SIAM J Appl Math</source>             <volume>28</volume>             <fpage>35</fpage>             <lpage>42</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Sankoff2"><label>26</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Cedergren</surname><given-names>RJ</given-names></name>
</person-group>             <year>1983</year>             <article-title>Simultaneous comparison of three or more sequences related by a tree.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Kruskal</surname><given-names>JB</given-names></name>
</person-group>             <source>Time Warps, String Edits and Macromolecules: The Theory and Practice of Sequence Comparison</source>             <publisher-loc>Reading, MA</publisher-loc>             <publisher-name>Addison-Wesley</publisher-name>             <fpage>253</fpage>             <lpage>263</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Murata1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Murata</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Richardson</surname><given-names>JS</given-names></name>
<name name-style="western"><surname>Sussman</surname><given-names>JL</given-names></name>
</person-group>             <year>1985</year>             <article-title>Simultaneous comparison of three protein sequences.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>82</volume>             <fpage>3073</fpage>             <lpage>3077</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Bacon1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bacon</surname><given-names>DJ</given-names></name>
<name name-style="western"><surname>Anderson</surname><given-names>WF</given-names></name>
</person-group>             <year>1986</year>             <article-title>Multiple sequence alignment.</article-title>             <source>J Mol Biol</source>             <volume>191</volume>             <fpage>153</fpage>             <lpage>161</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Schneider1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schneider</surname><given-names>TD</given-names></name>
<name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name>
<name name-style="western"><surname>Gold</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Ehrenfeucht</surname><given-names>A</given-names></name>
</person-group>             <year>1986</year>             <article-title>Information content of binding sites on nucleotide sequences.</article-title>             <source>J Mol Biol</source>             <volume>188</volume>             <fpage>415</fpage>             <lpage>431</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Altschul2"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
</person-group>             <year>1991</year>             <article-title>Amino acid substitution matrices from an information theoretic perspective.</article-title>             <source>J Mol Biol</source>             <volume>219</volume>             <fpage>555</fpage>             <lpage>565</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Brown1"><label>31</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brown</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Mian</surname><given-names>IS</given-names></name>
<name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name>
<etal/></person-group>             <year>1993</year>             <article-title>Using Dirichlet mixture priors to derive hidden Markov models for protein families.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Hunter</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Searls</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Shavlik</surname><given-names>J</given-names></name>
</person-group>             <source>Proc. First Int. Conf. on Intelligent System for Mol. Biol</source>             <publisher-loc>Menlo Park, CA</publisher-loc>             <publisher-name>AAAI Press</publisher-name>             <fpage>47</fpage>             <lpage>55</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Sjlander1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Brown</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
<etal/></person-group>             <year>1996</year>             <article-title>Dirichlet mixtures: a method for improved detection of weak but significant protein sequence homology.</article-title>             <source>Comput Appl Biosci</source>             <volume>12</volume>             <fpage>327</fpage>             <lpage>345</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Grnwald1"><label>33</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Grünwald</surname><given-names>PD</given-names></name>
</person-group>             <year>2007</year>             <source>The Minimum Description Length Principle</source>             <publisher-loc>Cambridge, MA</publisher-loc>             <publisher-name>MIT Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000852-Xing1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Xing</surname><given-names>EP</given-names></name>
<name name-style="western"><surname>Karp</surname><given-names>RM</given-names></name>
</person-group>             <year>2004</year>             <article-title>MotifPrototyper: a Bayesian profile model for motif families.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>101</volume>             <fpage>10523</fpage>             <lpage>10528</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Lunter1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lunter</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Miklós</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Drummond</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Jensen</surname><given-names>JL</given-names></name>
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
</person-group>             <year>2005</year>             <article-title>Bayesian coestimation of phylogeny and sequence alignment.</article-title>             <source>BMC Bioinformatics</source>             <volume>6</volume>             <fpage>83</fpage>          </element-citation></ref>
<ref id="pcbi.1000852-Bradley1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bradley</surname><given-names>RK</given-names></name>
<name name-style="western"><surname>Roberts</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Smoot</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Juvekar</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Do</surname><given-names>J</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Fast statistical alignment.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>e1000392</fpage>          </element-citation></ref>
<ref id="pcbi.1000852-Satija1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Satija</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Novák</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Miklós</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Lyngsø</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
</person-group>             <year>2009</year>             <article-title>BigFoot: Bayesian alignment and phylogenetic footprinting with MCMC.</article-title>             <source>BMC Evol Biol</source>             <volume>9</volume>             <fpage>217</fpage>          </element-citation></ref>
<ref id="pcbi.1000852-Feng2"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Feng</surname><given-names>DF</given-names></name>
<name name-style="western"><surname>Doolittle</surname><given-names>RF</given-names></name>
</person-group>             <year>1987</year>             <article-title>Progressive sequence alignment as a prerequisite to correct phylogenetic trees.</article-title>             <source>J Mol Evol</source>             <volume>25</volume>             <fpage>351</fpage>             <lpage>360</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Thompson1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thompson</surname><given-names>JD</given-names></name>
<name name-style="western"><surname>Higgins</surname><given-names>DG</given-names></name>
<name name-style="western"><surname>Gibson</surname><given-names>TJ</given-names></name>
</person-group>             <year>1994</year>             <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice.</article-title>             <source>Nucleic Acids Res</source>             <volume>22</volume>             <fpage>4673</fpage>             <lpage>4680</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Pietrokovski1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pietrokovski</surname><given-names>S</given-names></name>
</person-group>             <year>1996</year>             <article-title>Searching databases of conserved sequence regions by aligning protein multiple-alignments.</article-title>             <source>Nucleic Acids Res</source>             <volume>24</volume>             <fpage>3836</fpage>             <lpage>3845</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Rychlewski1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rychlewski</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Jaroszewski</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Li</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Godzik</surname><given-names>A</given-names></name>
</person-group>             <year>2000</year>             <article-title>Comparison of sequence profiles. strategies for structural predictions using sequence information.</article-title>             <source>Protein Sci</source>             <volume>9</volume>             <fpage>232</fpage>             <lpage>241</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Yona1"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yona</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Levitt</surname><given-names>M</given-names></name>
</person-group>             <year>2002</year>             <article-title>Within the twilight zone: a sensitive profile-profile comparison tool based on information theory.</article-title>             <source>J Mol Biol</source>             <volume>315</volume>             <fpage>1257</fpage>             <lpage>1275</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Edgar1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name>
<name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name>
</person-group>             <year>2003</year>             <article-title>SATCHMO: sequence alignment and tree construction using hidden markov models.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <fpage>1404</fpage>             <lpage>1411</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Panchenko1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Panchenko</surname><given-names>AR</given-names></name>
</person-group>             <year>2003</year>             <article-title>Finding weak similarities between proteins by sequence profile comparison.</article-title>             <source>Nucleic Acids Res</source>             <volume>31</volume>             <fpage>683</fpage>             <lpage>689</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Sadreyev1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sadreyev</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Grishin</surname><given-names>N</given-names></name>
</person-group>             <year>2003</year>             <article-title>COMPASS: a tool for comparison of multiple protein alignments with assessment of statistical significance.</article-title>             <source>J Mol Biol</source>             <volume>326</volume>             <fpage>317</fpage>             <lpage>336</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Edgar2"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name>
<name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name>
</person-group>             <year>2004</year>             <article-title>A comparison of scoring functions for protein sequence profile alignment.</article-title>             <source>Bioinformatics</source>             <volume>20</volume>             <fpage>1301</fpage>             <lpage>1308</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Wang1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wang</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Dunbrack</surname><given-names>RL</given-names><suffix>Jr</suffix></name>
</person-group>             <year>2004</year>             <article-title>Scoring profile-to-profile sequence alignments.</article-title>             <source>Protein Sci</source>             <volume>13</volume>             <fpage>1612</fpage>             <lpage>1626</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Sding1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Söding</surname><given-names>J</given-names></name>
</person-group>             <year>2005</year>             <article-title>Protein homology detection by HMM-HMM comparison.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>951</fpage>             <lpage>960</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-MacKay1"><label>49</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>MacKay</surname><given-names>DJC</given-names></name>
</person-group>             <year>2003</year>             <source>Information Theory, Inference, and Learning Algorithms</source>             <publisher-loc>New York, NY</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000852-Altschul3"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
<name name-style="western"><surname>Carroll</surname><given-names>RJ</given-names></name>
<name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name>
</person-group>             <year>1989</year>             <article-title>Weights for data related by a tree.</article-title>             <source>J Mol Biol</source>             <volume>207</volume>             <fpage>647</fpage>             <lpage>653</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Sibbald1"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sibbald</surname><given-names>PR</given-names></name>
<name name-style="western"><surname>Argos</surname><given-names>P</given-names></name>
</person-group>             <year>1990</year>             <article-title>Weighting aligned protein or nucleic acid sequences to correct for unequal representation.</article-title>             <source>J Mol Biol</source>             <volume>216</volume>             <fpage>813</fpage>             <lpage>818</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Sander1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Schneider</surname><given-names>R</given-names></name>
</person-group>             <year>1991</year>             <article-title>Database of homology-derived protein structures and the structural meaning of sequence alignment.</article-title>             <source>Proteins</source>             <volume>9</volume>             <fpage>56</fpage>             <lpage>68</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Vingron1"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Sibbald</surname><given-names>PR</given-names></name>
</person-group>             <year>1993</year>             <article-title>Weighting in sequence space: a comparison of methods in terms of generalized sequences.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>90</volume>             <fpage>8777</fpage>             <lpage>8781</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Gerstein1"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gerstein</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Sonnhammer</surname><given-names>ELL</given-names></name>
<name name-style="western"><surname>Chothia</surname><given-names>C</given-names></name>
</person-group>             <year>1994</year>             <article-title>Volume changes in protein evolution. Appendix: A method to weight protein sequences to correct for unequal representation.</article-title>             <source>J Mol Biol</source>             <volume>236</volume>             <fpage>1067</fpage>             <lpage>1078</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Henikoff2"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Henikoff</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Henikoff</surname><given-names>JG</given-names></name>
</person-group>             <year>1994</year>             <article-title>Position-based sequence weights.</article-title>             <source>J Mol Biol</source>             <volume>243</volume>             <fpage>574</fpage>             <lpage>578</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Thompson2"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thompson</surname><given-names>JD</given-names></name>
<name name-style="western"><surname>Higgins</surname><given-names>DG</given-names></name>
<name name-style="western"><surname>Gibson</surname><given-names>TJ</given-names></name>
</person-group>             <year>1994</year>             <article-title>Improved sensitivity of profile searches through the use of sequence weights and gap excision.</article-title>             <source>Comput Appl Biosci</source>             <volume>10</volume>             <fpage>19</fpage>             <lpage>29</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Eddy1"><label>57</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
<name name-style="western"><surname>Mitchison</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>
</person-group>             <year>1995</year>             <article-title>Maximum discrimination hidden Markov models of sequence consensus.</article-title>             <source>J Comput Biol</source>             <volume>2</volume>             <fpage>9</fpage>             <lpage>23</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Gotoh1"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gotoh</surname><given-names>O</given-names></name>
</person-group>             <year>1995</year>             <article-title>A weighting system and algorithm for aligning many phylogenetically related sequences.</article-title>             <source>Comput Appl Biosci</source>             <volume>11</volume>             <fpage>543</fpage>             <lpage>551</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Krogh1"><label>59</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Mitchison</surname><given-names>G</given-names></name>
</person-group>             <year>1995</year>             <article-title>Maximum entropy weighting of aligned sequences of protein or DNA.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Rawlings</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Clark</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Altman</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Hunter</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Lengauer</surname><given-names>T</given-names></name>
<etal/></person-group>             <source>Proc. Third Int. Conf. on Intelligent System for Mol. Biol</source>             <publisher-loc>Menlo Park, CA</publisher-loc>             <publisher-name>AAAI Press</publisher-name>             <fpage>215</fpage>             <lpage>221</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Bailey1"><label>60</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name>
<name name-style="western"><surname>Gribskov</surname><given-names>M</given-names></name>
</person-group>             <year>1996</year>             <article-title>The megaprior heuristic for discovering protein sequence patterns.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>States</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Agarwal</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Gaasterland</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Hunter</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>R</given-names></name>
</person-group>             <source>Proc. Fourth Int. Conf. on Intelligent System for Mol. Biol</source>             <fpage>15</fpage>             <lpage>24</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Sunyaev1"><label>61</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sunyaev</surname><given-names>SR</given-names></name>
<name name-style="western"><surname>Eisenhaber</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Rodchenkov</surname><given-names>IV</given-names></name>
<name name-style="western"><surname>Eisenhaber</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Tumanyan</surname><given-names>VG</given-names></name>
<etal/></person-group>             <year>1999</year>             <article-title>PSIC: profile extraction from sequence alignments with position-specific counts of independent observations.</article-title>             <source>Protein Eng</source>             <volume>12</volume>             <fpage>387</fpage>             <lpage>394</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Brown2"><label>62</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brown</surname><given-names>DP</given-names></name>
<name name-style="western"><surname>Krishnamurthy</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name>
</person-group>             <year>2007</year>             <article-title>Automated protein subfamily identification and classification.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e160</fpage>          </element-citation></ref>
<ref id="pcbi.1000852-Altschul4"><label>63</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
<name name-style="western"><surname>Gertz</surname><given-names>EM</given-names></name>
<name name-style="western"><surname>Agarwala</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Schäffer</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>Yu</surname><given-names>YK</given-names></name>
</person-group>             <year>2009</year>             <article-title>PSI-BLAST pseudocounts and the minimum description length principle.</article-title>             <source>Nucleic Acids Res</source>             <volume>37</volume>             <fpage>815</fpage>             <lpage>824</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Yu1"><label>64</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yu</surname><given-names>YK</given-names></name>
<name name-style="western"><surname>Wootton</surname><given-names>JC</given-names></name>
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
</person-group>             <year>2003</year>             <article-title>The compositional adjustment of amino acid substitution matrices.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>100</volume>             <fpage>15688</fpage>             <lpage>15693</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Yu2"><label>65</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yu</surname><given-names>YK</given-names></name>
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
</person-group>             <year>2005</year>             <article-title>The construction of amino acid substitution matrices for the comparison of proteins with non-standard compositions.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>902</fpage>             <lpage>911</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Jeffreys1"><label>66</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Jeffreys</surname><given-names>H</given-names></name>
</person-group>             <year>1946</year>             <article-title>An invariant form of the prior probability in estimation problems.</article-title>             <source>Proc Royal Soc London Series A</source>             <volume>186</volume>             <fpage>453</fpage>             <lpage>461</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Nishida1"><label>67</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nishida</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Frith</surname><given-names>MC</given-names></name>
<name name-style="western"><surname>Nakai</surname><given-names>K</given-names></name>
</person-group>             <year>2009</year>             <article-title>Pseudocounts for transcription factor binding sites.</article-title>             <source>Nucleic Acids Res</source>             <volume>37</volume>             <fpage>939</fpage>             <lpage>944</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Vingron2"><label>68</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name>
</person-group>             <year>1994</year>             <article-title>Sequence alignment and penalty choice. Review of concepts, case studies and implications.</article-title>             <source>J Mol Biol</source>             <volume>235</volume>             <fpage>1</fpage>             <lpage>12</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Lawrence1"><label>69</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name>
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
<name name-style="western"><surname>Boguski</surname><given-names>MS</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name>
<name name-style="western"><surname>Neuwald</surname><given-names>AF</given-names></name>
<etal/></person-group>             <year>1993</year>             <article-title>Detecting subtle sequence signals: A Gibbs sampling strategy for multiple alignment.</article-title>             <source>Science</source>             <volume>262</volume>             <fpage>208</fpage>             <lpage>214</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Cover1"><label>70</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cover</surname><given-names>TM</given-names></name>
<name name-style="western"><surname>Thomas</surname><given-names>JA</given-names></name>
</person-group>             <year>1991</year>             <source>Elements of Information Theory</source>             <publisher-loc>New York, NY</publisher-loc>             <publisher-name>Wiley</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000852-Sjlander2"><label>71</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name>
</person-group>             <year>1998</year>             <article-title>Phylogenetic inference in protein superfamilies: analysis of SH2 domains.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Glasgow</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Littlejohn</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Major</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Lathrop</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name>
<etal/></person-group>             <source>Proc. Sixth Int. Conf. on Intelligent System for Mol. Biol</source>             <publisher-loc>Menlo Park, CA</publisher-loc>             <publisher-name>AAAI Press</publisher-name>             <fpage>165</fpage>             <lpage>174</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Brown3"><label>72</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brown</surname><given-names>DP</given-names></name>
</person-group>             <year>2008</year>             <article-title>Efficient functional clustering of protein sequences using the Dirichlet process.</article-title>             <source>Bioinformatics</source>             <volume>24</volume>             <fpage>1765</fpage>             <lpage>1771</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Altschul5"><label>73</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
</person-group>             <year>1989</year>             <article-title>Gap costs for multiple sequence alignment.</article-title>             <source>J Theor Biol</source>             <volume>138</volume>             <fpage>297</fpage>             <lpage>309</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Thorne1"><label>74</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thorne</surname><given-names>JL</given-names></name>
<name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name>
</person-group>             <year>1991</year>             <article-title>An evolutionary model for maximum likelihood alignment of DNA sequences.</article-title>             <source>J Mol Evol</source>             <volume>33</volume>             <fpage>114</fpage>             <lpage>124</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Thorne2"><label>75</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thorne</surname><given-names>JL</given-names></name>
<name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name>
</person-group>             <year>1992</year>             <article-title>Inching toward reality: an improved likelihood model of sequence evolution.</article-title>             <source>J Mol Evol</source>             <volume>34</volume>             <fpage>3</fpage>             <lpage>16</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Tanaka1"><label>76</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tanaka</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Ishikawa</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Asai</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Konagaya</surname><given-names>A</given-names></name>
</person-group>             <year>1993</year>             <article-title>Hidden Markov models and iterative aligners: study of their equivalence and possibilities.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Hunter</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Searls</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Shavlik</surname><given-names>J</given-names></name>
</person-group>             <source>Proc. First Int. Conf. on Intelligent System for Mol. Biol</source>             <publisher-loc>Menlo Park, CA</publisher-loc>             <publisher-name>AAAI Press</publisher-name>             <fpage>395</fpage>             <lpage>401</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Baldi1"><label>77</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Baldi</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Chauvin</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Hunkapiller</surname><given-names>T</given-names></name>
<name name-style="western"><surname>McClure</surname><given-names>MA</given-names></name>
</person-group>             <year>1994</year>             <article-title>Hidden Markov models of biological primary sequence information.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>91</volume>             <fpage>1059</fpage>             <lpage>1063</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Krogh2"><label>78</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Brown</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Mian</surname><given-names>IS</given-names></name>
<name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name>
</person-group>             <year>1994</year>             <article-title>Hidden Markov models in computational biology. Applications to protein modeling.</article-title>             <source>J Mol Biol</source>             <volume>235</volume>             <fpage>1501</fpage>             <lpage>1531</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Durbin1"><label>79</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Mitchison</surname><given-names>G</given-names></name>
</person-group>             <year>1998</year>             <source>Biological sequence analysis. Probabilistic models of proteins and nucleic acids</source>             <publisher-loc>Cambridge, England</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000852-Eddy2"><label>80</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
</person-group>             <year>1998</year>             <article-title>Profile hidden Markov models.</article-title>             <source>Bioinformatics</source>             <volume>14</volume>             <fpage>755</fpage>             <lpage>763</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Karplus1"><label>81</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Barrett</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name>
</person-group>             <year>1998</year>             <article-title>Hidden Markov models for detecting remote protein homologies.</article-title>             <source>Bioinformatics</source>             <volume>14</volume>             <fpage>846</fpage>             <lpage>856</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Neuwald1"><label>82</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Neuwald</surname><given-names>AF</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name>
</person-group>             <year>2004</year>             <article-title>Gapped alignment of protein sequence motifs through Monte Carlo optimization of a hidden Markov model.</article-title>             <source>BMC Bioinformatics</source>             <volume>5</volume>             <fpage>157</fpage>          </element-citation></ref>
<ref id="pcbi.1000852-Gotoh2"><label>83</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gotoh</surname><given-names>O</given-names></name>
</person-group>             <year>1982</year>             <article-title>An improved algorithm for matching biological sequences.</article-title>             <source>J Mol Biol</source>             <volume>162</volume>             <fpage>705</fpage>             <lpage>708</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Fitch1"><label>84</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fitch</surname><given-names>WM</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>TF</given-names></name>
</person-group>             <year>1983</year>             <article-title>Optimal sequence alignments.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>80</volume>             <fpage>1382</fpage>             <lpage>1386</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Altschul6"><label>85</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
<name name-style="western"><surname>Erickson</surname><given-names>BW</given-names></name>
</person-group>             <year>1986</year>             <article-title>Optimal sequence alignment using affine gap costs.</article-title>             <source>Bull Math Biol</source>             <volume>48</volume>             <fpage>603</fpage>             <lpage>616</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Waterman1"><label>86</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>TF</given-names></name>
<name name-style="western"><surname>Beyer</surname><given-names>WA</given-names></name>
</person-group>             <year>1976</year>             <article-title>Some biological sequence metrics.</article-title>             <source>Adv Math</source>             <volume>20</volume>             <fpage>367</fpage>             <lpage>387</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Miller1"><label>87</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Miller</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name>
</person-group>             <year>1988</year>             <article-title>Sequence comparison with concave weighting functions.</article-title>             <source>Bull Math Biol</source>             <volume>50</volume>             <fpage>97</fpage>             <lpage>120</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Benner1"><label>88</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Benner</surname><given-names>SA</given-names></name>
<name name-style="western"><surname>Cohen</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Gonnet</surname><given-names>GH</given-names></name>
</person-group>             <year>1993</year>             <article-title>Empirical and structural models for insertions and deletions in the divergent evolution of proteins.</article-title>             <source>J Mol Biol</source>             <volume>229</volume>             <fpage>1065</fpage>             <lpage>1082</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Goonesekere2"><label>89</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Goonesekere</surname><given-names>NC</given-names></name>
<name name-style="western"><surname>Lee</surname><given-names>B</given-names></name>
</person-group>             <year>2004</year>             <article-title>Frequency of gaps observed in a structurally aligned protein pair database suggests a simple gap penalty function.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>2838</fpage>             <lpage>2843</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Ladurner1"><label>90</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ladurner</surname><given-names>AG</given-names></name>
<name name-style="western"><surname>Fersht</surname><given-names>AR</given-names></name>
</person-group>             <year>1997</year>             <article-title>Glutamine, alanine or glycine repeats inserted into the loop of a protein have minimal effects on stability and folding rates.</article-title>             <source>J Mol Biol</source>             <volume>273</volume>             <fpage>330</fpage>             <lpage>337</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-ScalleyKim1"><label>91</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Scalley-Kim</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Minard</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Baker</surname><given-names>D</given-names></name>
</person-group>             <year>2003</year>             <article-title>Low free energy cost of very long loop insertions in proteins.</article-title>             <source>Protein Sci</source>             <volume>12</volume>             <fpage>197</fpage>             <lpage>206</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Erickson1"><label>92</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Erickson</surname><given-names>BW</given-names></name>
<name name-style="western"><surname>Sellers</surname><given-names>PH</given-names></name>
</person-group>             <year>1983</year>             <article-title>Recognition of patterns in genetic sequences.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Kruskal</surname><given-names>JB</given-names></name>
</person-group>             <source>Time Warps, String Edits and Macromolecules: The Theory and Practice of Sequence Comparison</source>             <publisher-loc>Reading, MA</publisher-loc>             <publisher-name>Addison-Wesley</publisher-name>             <fpage>55</fpage>             <lpage>91</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Rocke1"><label>93</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rocke</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Tompa</surname><given-names>M</given-names></name>
</person-group>             <year>1998</year>             <article-title>An algorithm for finding novel gapped motifs in dna sequences.</article-title>             <fpage>228</fpage>             <lpage>233</lpage>             <comment>In: RECOMB '98: Proceedings of the second annual international conference on Computational molecular biology</comment>          </element-citation></ref>
<ref id="pcbi.1000852-Wareham1"><label>94</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wareham</surname><given-names>HT</given-names></name>
<name name-style="western"><surname>Jiang</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Zhang</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Trendall</surname><given-names>CG</given-names></name>
</person-group>             <year>2000</year>             <article-title>Stochastic heuristic algorithms for target motif identification (extended abstract).</article-title>             <source>Pac Symp Biocomput</source>             <fpage>392</fpage>             <lpage>403</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Thompson3"><label>95</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thompson</surname><given-names>JD</given-names></name>
<name name-style="western"><surname>Plewniak</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Poch</surname><given-names>O</given-names></name>
</person-group>             <year>1999</year>             <article-title>BAliBASE: a benchmark alignment database for the evaluation of multiple alignment programs.</article-title>             <source>Bioinformatics</source>             <volume>15</volume>             <fpage>87</fpage>             <lpage>88</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Subramanian1"><label>96</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Subramanian</surname><given-names>AR</given-names></name>
<name name-style="western"><surname>Weyer-Menkhoff</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Kaufmann</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Morgenstern</surname><given-names>B</given-names></name>
</person-group>             <year>2005</year>             <article-title>DIALIGN-T: an improved algorithm for segment-based multiple sequence alignment.</article-title>             <source>BMC Bioinformatics</source>             <volume>6</volume>             <fpage>66</fpage>          </element-citation></ref>
<ref id="pcbi.1000852-Stoye1"><label>97</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stoye</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Evers</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Meyer</surname><given-names>F</given-names></name>
</person-group>             <year>1998</year>             <article-title>Rose: generating sequence families.</article-title>             <source>Bioinformatics</source>             <volume>14</volume>             <fpage>157</fpage>             <lpage>163</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Subramanian2"><label>98</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Subramanian</surname><given-names>AR</given-names></name>
<name name-style="western"><surname>Kaufmann</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Morgenstern</surname><given-names>B</given-names></name>
</person-group>             <year>2008</year>             <article-title>DIALIGN-TX: greedy and progressive approaches for segment-based multiple sequence alignment.</article-title>             <source>Algorithms Mol Biol</source>             <volume>3</volume>             <fpage>6</fpage>          </element-citation></ref>
<ref id="pcbi.1000852-Papadopoulos1"><label>99</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Papadopoulos</surname><given-names>JS</given-names></name>
<name name-style="western"><surname>Agarwala</surname><given-names>R</given-names></name>
</person-group>             <year>2007</year>             <article-title>COBALT: constraint-based alignment tool for multiple protein sequences.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>1073</fpage>             <lpage>1079</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Thompson4"><label>100</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thompson</surname><given-names>JD</given-names></name>
<name name-style="western"><surname>Higgins</surname><given-names>DG</given-names></name>
<name name-style="western"><surname>Gibson</surname><given-names>TJ</given-names></name>
</person-group>             <year>1994</year>             <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice.</article-title>             <source>Nucleic Acids Res</source>             <volume>22</volume>             <fpage>4673</fpage>             <lpage>4680</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Pei1"><label>101</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pei</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Sadreyev</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Grishin</surname><given-names>NV</given-names></name>
</person-group>             <year>2003</year>             <article-title>PCMA: fast and accurate multiple sequence alignment based on profile consistency.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <fpage>427</fpage>             <lpage>428</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Edgar3"><label>102</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name>
</person-group>             <year>2004</year>             <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>1792</fpage>             <lpage>1797</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Edgar4"><label>103</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name>
</person-group>             <year>2004</year>             <article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity.</article-title>             <source>BMC Bioinformatics</source>             <volume>5</volume>             <fpage>113</fpage>          </element-citation></ref>
<ref id="pcbi.1000852-Do1"><label>104</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Do</surname><given-names>CB</given-names></name>
<name name-style="western"><surname>Mahabhashyam</surname><given-names>MS</given-names></name>
<name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name>
</person-group>             <year>2005</year>             <article-title>ProbCons: Probabilistic consistency-based multiple sequence alignment.</article-title>             <source>Genome Res</source>             <volume>15</volume>             <fpage>330</fpage>             <lpage>340</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Sonnhammer1"><label>105</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sonnhammer</surname><given-names>EL</given-names></name>
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
<name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>
</person-group>             <year>1997</year>             <article-title>Pfam: a comprehensive database of protein domain families based on seed alignments.</article-title>             <source>Proteins</source>             <volume>28</volume>             <fpage>405</fpage>             <lpage>420</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Sonnhammer2"><label>106</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sonnhammer</surname><given-names>EL</given-names></name>
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
<name name-style="western"><surname>Birney</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Bateman</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>
</person-group>             <year>1998</year>             <article-title>Pfam: multiple sequence alignments and HMM-profiles of protein domains.</article-title>             <source>Nucleic Acids Res</source>             <volume>26</volume>             <fpage>320</fpage>             <lpage>322</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Finn1"><label>107</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Finn</surname><given-names>RD</given-names></name>
<name name-style="western"><surname>Tate</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Mistry</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Coggill</surname><given-names>PC</given-names></name>
<name name-style="western"><surname>Sammut</surname><given-names>SJ</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>The Pfam protein families database.</article-title>             <source>Nucleic Acids Res</source>             <volume>36</volume>             <fpage>D281</fpage>             <lpage>288</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Yada1"><label>108</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yada</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Ishikawa</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Tanaka</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Asai</surname><given-names>K</given-names></name>
</person-group>             <year>1996</year>             <article-title>Extraction of hidden Markov model representations of signal patterns in DNA sequences.</article-title>             <source>Pac Symp Biocomput</source>             <fpage>686</fpage>             <lpage>696</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Won1"><label>109</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Won</surname><given-names>KJ</given-names></name>
<name name-style="western"><surname>Prugel-Bennett</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
</person-group>             <year>2004</year>             <article-title>Training HMM structure with genetic algorithm for biological sequence analysis.</article-title>             <source>Bioinformatics</source>             <volume>20</volume>             <fpage>3613</fpage>             <lpage>3619</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Won2"><label>110</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Won</surname><given-names>KJ</given-names></name>
<name name-style="western"><surname>Sandelin</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Marstrand</surname><given-names>TT</given-names></name>
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
</person-group>             <year>2008</year>             <article-title>Modeling promoter grammars with evolving hidden Markov models.</article-title>             <source>Bioinformatics</source>             <volume>24</volume>             <fpage>1669</fpage>             <lpage>1675</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Mott1"><label>111</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mott</surname><given-names>R</given-names></name>
</person-group>             <year>1999</year>             <article-title>Local sequence alignments with monotonic gap penalties.</article-title>             <source>Bioinformatics</source>             <volume>15</volume>             <fpage>455</fpage>             <lpage>462</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Balaji1"><label>112</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Balaji</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Babu</surname><given-names>MM</given-names></name>
<name name-style="western"><surname>Iyer</surname><given-names>LM</given-names></name>
<name name-style="western"><surname>Aravind</surname><given-names>L</given-names></name>
</person-group>             <year>2005</year>             <article-title>Discovery of the principal specific transcription factors of Apicomplexa and their implication for the evolution of the AP2-integrase DNA binding domains.</article-title>             <source>Nucleic Acids Res</source>             <volume>33</volume>             <fpage>3994</fpage>             <lpage>4006</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Magnani1"><label>113</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Magnani</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Hake</surname><given-names>S</given-names></name>
</person-group>             <year>2004</year>             <article-title>From endonucleases to transcription factors: evolution of the AP2 DNA binding domain in plants.</article-title>             <source>Plant Cell</source>             <volume>16</volume>             <fpage>2265</fpage>             <lpage>2277</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Wuitschick1"><label>114</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wuitschick</surname><given-names>JD</given-names></name>
<name name-style="western"><surname>Lindstrom</surname><given-names>PR</given-names></name>
<name name-style="western"><surname>Meyer</surname><given-names>AE</given-names></name>
<name name-style="western"><surname>Karrer</surname><given-names>KM</given-names></name>
</person-group>             <year>2004</year>             <article-title>Homing endonucleases encoded by germ line-limited genes in Tetrahymena thermophila have APETELA2 DNA binding domains.</article-title>             <source>Eukaryotic Cell</source>             <volume>3</volume>             <fpage>685</fpage>             <lpage>694</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-DeSilva1"><label>115</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>De Silva</surname><given-names>EK</given-names></name>
<name name-style="western"><surname>Gehrke</surname><given-names>AR</given-names></name>
<name name-style="western"><surname>Olszewski</surname><given-names>K</given-names></name>
<name name-style="western"><surname>León</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Chahal</surname><given-names>JS</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Specific DNA-binding by apicomplexan AP2 transcription factors.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>105</volume>             <fpage>8393</fpage>             <lpage>8398</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Yuda1"><label>116</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yuda</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Iwanaga</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Shigenobu</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Mair</surname><given-names>GR</given-names></name>
<name name-style="western"><surname>Janse</surname><given-names>CJ</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Identification of a transcription factor in the mosquito-invasive stage of malaria parasites.</article-title>             <source>Mol Microbiol</source>             <volume>71</volume>             <fpage>1402</fpage>             <lpage>1414</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Phuong1"><label>117</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Phuong</surname><given-names>TM</given-names></name>
<name name-style="western"><surname>Do</surname><given-names>CB</given-names></name>
<name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name>
<name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name>
</person-group>             <year>2006</year>             <article-title>Multiple alignment of protein sequences with repeats and rearrangements.</article-title>             <source>Nucleic Acids Res</source>             <volume>34</volume>             <fpage>5932</fpage>             <lpage>5942</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Raphael1"><label>118</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Raphael</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Zhi</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Tang</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Pevzner</surname><given-names>P</given-names></name>
</person-group>             <year>2004</year>             <article-title>A novel method for multiple alignment of sequences with repeated and shuffled elements.</article-title>             <source>Genome Res</source>             <volume>14</volume>             <fpage>2336</fpage>             <lpage>2346</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Wootton1"><label>119</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wootton</surname><given-names>JC</given-names></name>
</person-group>             <year>1994</year>             <article-title>Non-globular domains in protein sequences: automated segmentation using complexity measures.</article-title>             <source>Comput Chem</source>             <volume>18</volume>             <fpage>269</fpage>             <lpage>285</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Schneider2"><label>120</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schneider</surname><given-names>TD</given-names></name>
<name name-style="western"><surname>Stephens</surname><given-names>RM</given-names></name>
</person-group>             <year>1990</year>             <article-title>Sequence logos: a new way to display consensus sequences.</article-title>             <source>Nucleic Acids Res</source>             <volume>18</volume>             <fpage>6097</fpage>             <lpage>6100</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Allen1"><label>121</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Allen</surname><given-names>MD</given-names></name>
<name name-style="western"><surname>Yamasaki</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Ohme-Takagi</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Tateno</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Suzuki</surname><given-names>M</given-names></name>
</person-group>             <year>1998</year>             <article-title>A novel mode of DNA recognition by a beta-sheet revealed by the solution structure of the GCC-box binding domain in complex with DNA.</article-title>             <source>EMBO J</source>             <volume>17</volume>             <fpage>5484</fpage>             <lpage>5496</lpage>          </element-citation></ref>
<ref id="pcbi.1000852-Lindner1"><label>122</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lindner</surname><given-names>SE</given-names></name>
<name name-style="western"><surname>De Silva</surname><given-names>EK</given-names></name>
<name name-style="western"><surname>Keck</surname><given-names>JL</given-names></name>
<name name-style="western"><surname>Llinás</surname><given-names>M</given-names></name>
</person-group>             <year>2010</year>             <article-title>Structural determinants of DNA binding by a P. falciparum ApiAP2 transcriptional regulator.</article-title>             <source>J Mol Biol</source>             <volume>395</volume>             <fpage>558</fpage>             <lpage>567</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>