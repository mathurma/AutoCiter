<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00716</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005232</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical compounds</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Carbohydrates</subject><subj-group><subject>Monosaccharides</subject><subj-group><subject>Glucose</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Organic chemistry</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Carbohydrates</subject><subj-group><subject>Monosaccharides</subject><subj-group><subject>Glucose</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Endocrinology</subject><subj-group><subject>Endocrine disorders</subject><subj-group><subject>Diabetes mellitus</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Metabolic disorders</subject><subj-group><subject>Diabetes mellitus</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Endocrinology</subject><subj-group><subject>Endocrine disorders</subject><subj-group><subject>Diabetes mellitus</subject><subj-group><subject>Type 2 diabetes</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Metabolic disorders</subject><subj-group><subject>Diabetes mellitus</subject><subj-group><subject>Type 2 diabetes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject><subj-group><subject>Diabetes diagnosis and management</subject><subj-group><subject>HbA1c</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Hemoglobin</subject><subj-group><subject>HbA1c</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Nutrition</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Nutrition</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Blood</subject><subj-group><subject>Blood sugar</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Blood</subject><subj-group><subject>Blood sugar</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Blood</subject><subj-group><subject>Blood sugar</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Blood</subject><subj-group><subject>Blood sugar</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical compounds</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Carbohydrates</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Organic chemistry</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Carbohydrates</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Personalized glucose forecasting for type 2 diabetes using data assimilation</article-title>
<alt-title alt-title-type="running-head">Glucose forecasting for type 2 diabetes</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Albers</surname> <given-names>David J.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5627-3169</contrib-id>
<name name-style="western">
<surname>Levine</surname> <given-names>Matthew</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Gluckman</surname> <given-names>Bruce</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ginsberg</surname> <given-names>Henry</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hripcsak</surname> <given-names>George</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Mamykina</surname> <given-names>Lena</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Biomedical Informatics, Columbia University, New York, New York, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Departments of Engineering Sciences and Mechanics, Neurosurgery, and Biomedical Engineering, Pennsylvania State University, University Park, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Medicine, Columbia University, New York, New York, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Mac Gabhann</surname> <given-names>Feilim</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Johns Hopkins University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> DJA ML BG HG GH LM.</p>
</list-item>
<list-item>
<p><bold>Data curation:</bold> DJA ML LM.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> DJA ML BG GH LM.</p>
</list-item>
<list-item>
<p><bold>Funding acquisition:</bold> GH LM DJA.</p>
</list-item>
<list-item>
<p><bold>Investigation:</bold> LM ML DJA GH.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> DJA ML BG GH.</p>
</list-item>
<list-item>
<p><bold>Project administration:</bold> DJA LM ML.</p>
</list-item>
<list-item>
<p><bold>Resources:</bold> DJA GH LM.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> DJA ML.</p>
</list-item>
<list-item>
<p><bold>Supervision:</bold> DJA LM.</p>
</list-item>
<list-item>
<p><bold>Validation:</bold> DJA ML BG GH LM.</p>
</list-item>
<list-item>
<p><bold>Visualization:</bold> DJA ML BG GH.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> DJA.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> DJA ML BG HG GH LM.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">dja2119@cumc.columbia.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>27</day>
<month>4</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>4</issue>
<elocation-id>e1005232</elocation-id>
<history>
<date date-type="received">
<day>3</day>
<month>5</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>31</day>
<month>10</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Albers et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005232"/>
<abstract>
<p>Type 2 diabetes leads to premature death and reduced quality of life for 8% of Americans. Nutrition management is critical to maintaining glycemic control, yet it is difficult to achieve due to the high individual differences in glycemic response to nutrition. Anticipating glycemic impact of different meals can be challenging not only for individuals with diabetes, but also for expert diabetes educators. Personalized computational models that can accurately forecast an impact of a given meal on an individual’s blood glucose levels can serve as the engine for a new generation of decision support tools for individuals with diabetes. However, to be useful in practice, these computational engines need to generate accurate forecasts based on limited datasets consistent with typical self-monitoring practices of individuals with type 2 diabetes. This paper uses three forecasting machines: (i) data assimilation, a technique borrowed from atmospheric physics and engineering that uses Bayesian modeling to infuse data with human knowledge represented in a mechanistic model, to generate real-time, personalized, adaptable glucose forecasts; (ii) model averaging of data assimilation output; and (iii) dynamical Gaussian process model regression. The proposed data assimilation machine, the primary focus of the paper, uses a modified dual unscented Kalman filter to estimate states and parameters, personalizing the mechanistic models. Model selection is used to make a personalized model selection for the individual and their measurement characteristics. The data assimilation forecasts are empirically evaluated against actual postprandial glucose measurements captured by individuals with type 2 diabetes, and against predictions generated by experienced diabetes educators after reviewing a set of historical nutritional records and glucose measurements for the same individual. The evaluation suggests that the data assimilation forecasts compare well with specific glucose measurements and match or exceed in accuracy expert forecasts. We conclude by examining ways to present predictions as forecast-derived range quantities and evaluate the comparative advantages of these ranges.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Type 2 diabetes is a devastating disease that requires constant patient self-management of glucose, insulin, nutrition and exercise. Nevertheless, glucose and insulin dynamics are complicated, nonstationary, nonlinear, and individual-dependent, making self-management of diabetes a complex task. To help alleviate some of the difficulty for patients, we develop a method for personalized, real-time, glucose forecasting based on nutrition. Specifically, we create and evaluate the computational machinery based on both Gaussian process models and data assimilation that leverages the physiologic knowledge of two mechanistic models to produce a personalized, nutrition-based glucose forecast for individuals with type 2 diabetes in real time that is robust to sparse data and nonstationary patients. Our computational engine was conceived to be of potential use for diabetes self-management.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000092</institution-id>
<institution>U.S. National Library of Medicine</institution>
</institution-wrap>
</funding-source>
<award-id>LM006910</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Hripcsak</surname> <given-names>George</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000867</institution-id>
<institution>Robert Wood Johnson Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>RWJF 73070</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Mamykina</surname> <given-names>Lena</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000062</institution-id>
<institution>National Institute of Diabetes and Digestive and Kidney Diseases</institution>
</institution-wrap>
</funding-source>
<award-id>R01DK090372</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Mamykina</surname> <given-names>Lena</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>GH, ML, and DJA are supported by a grant from the National Library of Medicine LM006910. LM, DJA and ML are supported by a grant from the Robert Wood Johnson Foundation RWJF 73070. LM is supported by a grant from the National Institute of Diabetes and Digestive Kidney diseases R01DK090372.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="5"/>
<page-count count="38"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>A de-identified version of the data used in this study, including all glucose finger stick data and carbohydrate estimates for meals, are available on PhysioNet under the project titled "Glucose and Nutrition Forecasting: Small”.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>One promise of data science is the application of elegant solutions to new and important problems. In this way, personal health care can be seen as a prediction challenge: Identifying the disease the patient has contracted—<italic>estimating the current state</italic>, forecasting the disease progression under different interventions—<italic>estimating the evolution of the state</italic>, and therapy—<italic>optimization of feedback to achieve target state</italic>. The ability to predict outcomes is important in selection of treatment. It is also important for self-management of chronic diseases, as it can help individuals to select the most beneficial self-management strategies and improve their health. The increase in data related to individuals’ behaviors and health biomarkers opens an unprecedented opportunity to use computational and data science methods to predict health outcomes based on basic physiological knowledge and individuals’ historical records. However, to be useful in the real world, such methods need to generate accurate and actionable predictions based on realistic datasets that are consistent with current standards for health monitoring.</p>
<p>Data assimilation (DA) [<xref ref-type="bibr" rid="pcbi.1005232.ref001">1</xref>], an application of filtering theory [<xref ref-type="bibr" rid="pcbi.1005232.ref002">2</xref>], pairs mechanistic models with data via Bayesian statistics to create a forecast. It has been applied or deployed successfully in fields including atmospheric physics and meteorology [<xref ref-type="bibr" rid="pcbi.1005232.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref004">4</xref>], engineering [<xref ref-type="bibr" rid="pcbi.1005232.ref005">5</xref>], statistics and computer science [<xref ref-type="bibr" rid="pcbi.1005232.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref007">7</xref>], and, in a more limited way, biomedicine [<xref ref-type="bibr" rid="pcbi.1005232.ref008">8</xref>]. The power of DA is in its ability to incorporate human knowledge into a forecast; in contrast to the more traditional machine learning approaches, DA with mechanistic models does not require extensive datasets and can be personalized and adapted quickly by estimating mechanistic model parameters. As a result, such models can arrive at an accurate forecast with data that are fewer, more sporadic, or incomplete. The use of DA and control theory in medicine is relatively rare and has been applied in limited situations where data are collected in highly controlled <italic>data-rich</italic> environments. Examples include algorithms in implantable defibrillators and pacemakers to cope with irregular heartbeats [<xref ref-type="bibr" rid="pcbi.1005232.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1005232.ref013">13</xref>], model construction and fitting for prostate cancer treatment [<xref ref-type="bibr" rid="pcbi.1005232.ref014">14</xref>], epidemiology [<xref ref-type="bibr" rid="pcbi.1005232.ref015">15</xref>], and the artificial beta-cell or pancreas project designed to manage insulin and glucose for individuals with type 1 diabetes [<xref ref-type="bibr" rid="pcbi.1005232.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1005232.ref020">20</xref>].</p>
<p>Here we focus on DA for uses related to type 2 diabetes. Diabetes mellitus is a high-impact disease. In 2012, 8.3% of all Americans and 25% of Americans over the age of 65 had diabetes. It is the 7<sup>th</sup> leading cause of death in the United States, and costs associated with this disease amount to $176 billion in direct medical costs and $69 billion in reduced productivity in 2012. Type 1 diabetes is an autoimmune disease that destroys pancreatic beta cells and typically renders the body unable to produce insulin. Type 1 accounts for 5% of patients with diabetes. The remaining 95% of diabetic patients have type 2 diabetes [<xref ref-type="bibr" rid="pcbi.1005232.ref021">21</xref>], a disease with complex causes (cf. Fig. 1 of [<xref ref-type="bibr" rid="pcbi.1005232.ref022">22</xref>]) where the individual remains capable of producing insulin but has elevated glucose levels.</p>
<p>The main approach to diabetes management is maintaining blood glucose within ranges considered safe. For diabetes patients, such maintenance is done through a combination of nutrition management, physical activity, and medication. Hemoglobin A1c (HbA1c), a physiologic measurement that correlates to a three-month average of blood glucose [<xref ref-type="bibr" rid="pcbi.1005232.ref023">23</xref>], is a clinical indication commonly used to evaluate diabetes management. Elevated HbA1c values above 8% lead to elevated mortality [<xref ref-type="bibr" rid="pcbi.1005232.ref024">24</xref>], while individuals with HbA1c in the near normal range of 6–6.5% have improved outcomes [<xref ref-type="bibr" rid="pcbi.1005232.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref026">26</xref>]. These observations have led to the clinical goal of reducing HbA1c to near normal levels of 6–7% [<xref ref-type="bibr" rid="pcbi.1005232.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref026">26</xref>] when possible, and maintaining below 8% in nearly all circumstances. From the perspective of self-management, HbA1c normality serves as a long-term goal for patients, but has little practical utility in guiding individuals’ daily choices. Instead, individuals with diabetes self-monitor daily blood glucose readings; higher frequency of self-monitoring of glucose has been associated with better glycemic control and improved clinical outcomes [<xref ref-type="bibr" rid="pcbi.1005232.ref027">27</xref>–<xref ref-type="bibr" rid="pcbi.1005232.ref029">29</xref>]. The current recommended frequency of glucose self-monitoring for individuals on intensive insulin regimens is 6–10 times daily; however, no clear guidelines are available for individuals who use basal insulin or oral agents [<xref ref-type="bibr" rid="pcbi.1005232.ref030">30</xref>].</p>
<p>Nutrition-based glucose management is hard to achieve because it is difficult to understand the impact of foods on glucose levels on a meal-by-meal basis [<xref ref-type="bibr" rid="pcbi.1005232.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref031">31</xref>]. Glucose-insulin dynamics are high-dimensional, nonlinear, oscillatory, noisy, multi-scale, and dependent on many personal and demographic factors [<xref ref-type="bibr" rid="pcbi.1005232.ref022">22</xref>]. Studies have demonstrated great variability in individuals’ glycemic response to meals with identical nutritional composition [<xref ref-type="bibr" rid="pcbi.1005232.ref031">31</xref>]. Anticipating the impact of different meals on one’s blood glucose levels is challenging for both individuals with diabetes and diabetes educators [<xref ref-type="bibr" rid="pcbi.1005232.ref032">32</xref>]. This personal diversity and forecasting difficulty has led the American Diabetes Association to recommend personalized treatment [<xref ref-type="bibr" rid="pcbi.1005232.ref033">33</xref>]. There is a clear need for tools and mechanisms that assist individuals with diabetes in understanding and predicting the impact of their nutritional choices on glucose levels and identifying approaches to regulating nutrition to minimize its glycemic impact.</p>
<p>The method requirements to implement personalized forecasting for type 2 diabetes (diabetes will refer to type 2 diabetes unless otherwise noted) glucose management differ from data-rich applications because diabetes data are collected primarily by patients and are sparse, irregularly measured, and noisy. A recent study examining fluctuations in glucose levels for non-diabetics in response to nutrition, physical activity, and sleep established feasibility of utilizing machine learning methods when high density data on glucose levels is available through continuous glucose monitoring [<xref ref-type="bibr" rid="pcbi.1005232.ref031">31</xref>]. However, because continuous glucose monitoring continues to be out of reach for the vast majority of individuals with diabetes, these data-dense methods are not likely to lead to practical solutions in the near future. Because of this gap, we focus on forecasting glucose in scenarios consistent with common self-monitoring practices of individuals with diabetes. We extend DA to clinical settings that lack tight monitoring and are subject to the constraints of collecting data in real-world clinical situations where the data are complex, irregularly sampled, and biased [<xref ref-type="bibr" rid="pcbi.1005232.ref034">34</xref>].</p>
<p>Glucose prediction in the context of diabetes has been studied by researchers across many disciplines, and has resulted in a diversity of data-driven approaches for personalized glucose forecasting [<xref ref-type="bibr" rid="pcbi.1005232.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref036">36</xref>]. These efforts have attempted different tasks (e.g. prediction of hypoglycemia [<xref ref-type="bibr" rid="pcbi.1005232.ref037">37</xref>–<xref ref-type="bibr" rid="pcbi.1005232.ref039">39</xref>], glucose control [<xref ref-type="bibr" rid="pcbi.1005232.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref040">40</xref>–<xref ref-type="bibr" rid="pcbi.1005232.ref045">45</xref>], and physiologic inference [<xref ref-type="bibr" rid="pcbi.1005232.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref046">46</xref>–<xref ref-type="bibr" rid="pcbi.1005232.ref049">49</xref>]), and have taken a variety of approaches to identifying suitable models of a diabetic’s glucose system (e.g. nonlinear Weiner model [<xref ref-type="bibr" rid="pcbi.1005232.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref050">50</xref>], neural networks [<xref ref-type="bibr" rid="pcbi.1005232.ref042">42</xref>], probabilistic models [<xref ref-type="bibr" rid="pcbi.1005232.ref038">38</xref>], and mechanistic systems of ordinary differential equations (ODEs) [<xref ref-type="bibr" rid="pcbi.1005232.ref048">48</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref049">49</xref>]). Many of the desired prediction tasks have been approached by wrapping the aforementioned models in different predictive algorithms and inference schemes (e.g. stochastic filters [<xref ref-type="bibr" rid="pcbi.1005232.ref044">44</xref>], PI controllers [<xref ref-type="bibr" rid="pcbi.1005232.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref051">51</xref>], Gaussian process models [<xref ref-type="bibr" rid="pcbi.1005232.ref052">52</xref>], fuzzy logic [<xref ref-type="bibr" rid="pcbi.1005232.ref045">45</xref>], and many other machine learning methods [<xref ref-type="bibr" rid="pcbi.1005232.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref053">53</xref>]). These studies have paved the way towards personalized interventions for people with diabetes, but most studies fail to show their applicability in settings where data are restricted to those with realistic qualities.</p>
<p>A number of recent studies have begun to focus more on this point of realistic applicability. Zitar and Al-Jabali demonstrated that neural networks could be constructed, based on mechanistic ODEs, to fit a large real-world data set of type 2 diabetics, but lacks sensitivity to nutrition, making the approach less useful for personalized nutritional adjustments [<xref ref-type="bibr" rid="pcbi.1005232.ref042">42</xref>]. Beverlin et al., on the other hand, demonstrated that glucose predictions can be generated with low error and high correlation by fitting a nonlinear Weiner box model to four patients with type 2 diabetes [<xref ref-type="bibr" rid="pcbi.1005232.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref041">41</xref>]. However, their model was trained with glucose data sampled every 5 minutes by an implantable sensor, which is neither used nor recommended for the majority of people with type 2 diabetes. Barazandegan et al. proposed the use of online sequential Monte Carlo estimation using a mechanistic model of glucose-insulin dynamics in response to nutrition developed by Vahadi et al., and demonstrated that sequential importance resampling particle filter can be used for accurate individualized forecasting, even in the presence of missing and noisy data [<xref ref-type="bibr" rid="pcbi.1005232.ref044">44</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref048">48</xref>]. However, this work was based entirely on simulated data, rather than free-living biological data. The research presented here aims to bridge the gap in the literature between proposed methods for personalized glucose forecasting and evaluation of those methods on real-world data. We fit a mechanistic model of type 2 diabetes glucose dynamics ([<xref ref-type="bibr" rid="pcbi.1005232.ref049">49</xref>]) using a simple data assimilation strategy for sequential estimation (unscented Kalman filter [<xref ref-type="bibr" rid="pcbi.1005232.ref054">54</xref>]), and demonstrate the efficacy of this approach in 3 individuals with type 2 diabetes and 2 individuals without diabetes who only used a smart phone application to capture pre and post-meal glucose readings and descriptions of their meals.</p>
<p>The goal of the research presented here is to generate personalized, accurate, and actionable predictions of glucose in response to nutrition that can assist individuals with diabetes in making <italic>quantitatively informed</italic> nutritional choices. Our solution uses DA to translate the systems physiology knowledge of glucose-insulin dynamics encoded in mechanistic models into a clinical context to create personalized modeling engines capable of generating nutrition-based, post-meal glucose and HbA1c forecasts in real time. These forecasts would then be integrated into mobile applications such as the one developed by Mamykina <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005232.ref032">32</xref>]. To make the information useful for individuals with diabetes, these forecasts must: <italic>(i)</italic> use the minimally invasive data that diabetes patients collect in routine care, up to a maximum of 6–10 measurements a day, <italic>(ii)</italic> personalize to the individual and adapt to changes in behavior and health-state, <italic>(iii)</italic> work in real time, and <italic>(iv)</italic> be accurate enough to produce a forecast that can differentiate glucose values that correspond to between 0.5–2% differences in HbA1c values.</p>
<p>Our solution is constructed and evaluated in eight steps. The data assimilation-based solution is developed and internally evaluated in the inital five steps. Then we show how the DA methodology can potentially be generalized using model averaging in step six, compare the DA against non-personalized versions of itself and with machine learning-based forecasting in step seven, and then demonstrate how the DA output could be translated into a more useful form in step eight. In more detail: <italic>First</italic>, we develop the DA framework within the context of diabetes. <italic>Second</italic>, we show that the DA can generate a personalized forecast using data collected routinely by individuals with diabetes. <italic>Third</italic>, the DA predictions are shown to have similar and sometimes higher correlation with measured postprandial glucose levels than predictions generated by Certified Diabetes Educators who rely on their extensive knowledge and experience, and whose predictions, from the perspective of the patient trying to estimate the glycemic impact of their meal choices, represents the current clinical gold standard prediction. <italic>Fourth</italic>, we show that the DA will not only adapt to the individual, but will also adjust with minimal data when the individual changes behavior quickly. <italic>Fifth</italic>, because there is no single model that will provide the best forecast in all situations, we use statistical model selection [<xref ref-type="bibr" rid="pcbi.1005232.ref055">55</xref>–<xref ref-type="bibr" rid="pcbi.1005232.ref057">57</xref>] to pick the best model for each individual given their data capture habits and the employed DA strategies. <italic>Sixth</italic>, armed with the individual model performance results and motivated by achieving the most robust and accurate possible forecast, we show how model averaging techniques can be used to improve model forecast performance. <italic>Seventh</italic>, to demonstrate the impact of tracking states and parameters on a forecast and to contrast the mechanism-based DAs with more traditional machine learning techniques, we generate forecasts using DAs with the state and parameter filters turned off in parallel with a dynamic Gaussian process model. And <italic>eighth</italic>, we take initial steps towards establishing glucose level forecast accuracy benchmarks for individuals with diabetes by examining accuracy of individual forecasts generated using DA over a period of time relevant for self-management.</p>
<p><bold>Roadmap for the rest of the paper.</bold> This paper is not the least complex and parts of it can be read independently of other parts. To help make reading the paper easier, we are including a descriptive outline of the paper. The <italic>methods section</italic> has five components: (i) DA, the mechanistic models, and basic model selection and evaluation tools, (ii) DA-based model-forecast averaging, (iii) dynamical Gaussian process models, (iv) the study designs and data we use in the paper, and (iv) validation methods for the DA and its forecasts. The <italic>results section</italic> has seven components: (i) DA-based glucose state estimation and convergence, (ii) a comparison between DA-based postprandial glucose forecasts and certified diabetes educator-based postprandial glucose forecasts, (iii) personalization of models though DA-based parameter estimation, (iv) model selection and evaluation, (v) model averaging, (vi) a comparison between the Gaussian process model forecasts and the DA where sub-filters, e.g., state and parameter filters, are turned off, and (vii) a consideration of the potential impact of a clinical intervention. The <italic>discussion section</italic> has two large components: (i) a summary of our results and related discussions, and (ii) a more broad discussion of issues related to applying DA in clinical and biological contexts. Many of the results and discussion sections can be read relatively independently assuming the reader understands the relevant methods introduced in the methods section.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec003">
<title>Development of the data assimilation framework with two endocrine models relevant for diabetes</title>
<p>Data assimilation (DA) is a data science machine that unifies models with data to reconstruct the model state and provide forecasts. Crudely, DA is a sophisticated interpolation and forecasting scheme. We focus on the use of mechanistic models that represent human understanding of the system dynamics, although versions also exist for unsupervised models as well. Our objectives here are to reconstruct the state of the endocrine system relevant to glucose-insulin dynamics regulation from the sporadic blood-glucose measurements clinically expected from a patient with diabetes. A detailed explanation of the methods we use can be found in <xref ref-type="supplementary-material" rid="pcbi.1005232.s001">S1 Appendix</xref>.</p>
<p>Concretely, the objective of a DA filter is to reconstruct and predict state <italic>x</italic><sub><italic>k</italic></sub> of a system from noisy, sparse measurements <italic>y</italic><sub><italic>k</italic></sub>, where <italic>k</italic> indexes time. Inherent in this process is assumed uncertainty in how well the state <italic>x</italic><sub><italic>k</italic></sub> is known. Therefore a distribution of state is assumed and tracked. Because of the combination of the nonlinear, high-dimensional dynamics of the endocrine models and the sparsity of the data, we utilize a variant of an unscented Kalman filter (UKF) or Bayesian sigma point processor [<xref ref-type="bibr" rid="pcbi.1005232.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref058">58</xref>–<xref ref-type="bibr" rid="pcbi.1005232.ref061">61</xref>] for DA. Critical in our implementation are the capacities to accommodate sparsely and non-periodically acquired data appropriate for diabetic monitoring and non-stationary system parameters consistent with changes in patient behavior and physiology.</p>
<sec id="sec004">
<title>State estimation</title>
<p>Kalman filter-based methods utilize a prediction-correction scheme to dynamically track and adjust both the system state and its uncertainty to agree with measurements as they are made: the system model <inline-formula id="pcbi.1005232.e001"><alternatives><graphic id="pcbi.1005232.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>w</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> as a function of state <italic>x</italic> and parameter <italic>w</italic> is used to iterate the distribution of system state forward in time to produce a <italic>prediction</italic>; the prediction is then <italic>corrected</italic> to both adjust the prediction and collapse its uncertainty. The objective is to determine the best estimate of state, denoted <inline-formula id="pcbi.1005232.e002"><alternatives><graphic id="pcbi.1005232.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>The Unscented Kalman Filter serves the function of smoothing the data in the sense of reconstructing a best, de-noised estimate of all state variables from noisy, incomplete measurements made at times {<italic>t</italic><sub><italic>k</italic></sub>}, and to provide extrapolated estimates of state for all times. For times ahead of the most recent measurement at time <italic>t</italic><sub><italic>k</italic>−1</sub>, with best estimate <inline-formula id="pcbi.1005232.e003"><alternatives><graphic id="pcbi.1005232.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, these extrapolations <inline-formula id="pcbi.1005232.e004"><alternatives><graphic id="pcbi.1005232.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (later referred to as <italic>χ</italic><sub><italic>o</italic></sub>, due to its relationship to the central sigma point as described in the Appendix) provide forecasts of future state:
<disp-formula id="pcbi.1005232.e005"><alternatives><graphic id="pcbi.1005232.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mrow><mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mi>w</mml:mi> <mml:mo>)</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula> <disp-formula id="pcbi.1005232.e006"><alternatives><graphic id="pcbi.1005232.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>w</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
The forecast at the next measurement time <inline-formula id="pcbi.1005232.e007"><alternatives><graphic id="pcbi.1005232.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>w</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is then corrected to agree with measurements <italic>y</italic><sub><italic>k</italic></sub> in proportion to the difference between this forecast and measurement,
<disp-formula id="pcbi.1005232.e008"><alternatives><graphic id="pcbi.1005232.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
where <inline-formula id="pcbi.1005232.e009"><alternatives><graphic id="pcbi.1005232.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the projection of <inline-formula id="pcbi.1005232.e010"><alternatives><graphic id="pcbi.1005232.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> onto the measurement subspace spanned by <italic>y</italic>. The Kalman gain <italic>K</italic><sub><italic>k</italic></sub> is derived from a linearization of the dynamics’ flow about <inline-formula id="pcbi.1005232.e011"><alternatives><graphic id="pcbi.1005232.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, and provides correction of all state variables from the subset of ones actually measured. Once corrected, the new best estimate <inline-formula id="pcbi.1005232.e012"><alternatives><graphic id="pcbi.1005232.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is used to generate revised future predictions until another measurement is made, while <inline-formula id="pcbi.1005232.e013"><alternatives><graphic id="pcbi.1005232.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> serves as a smooth extrapolation of <inline-formula id="pcbi.1005232.e014"><alternatives><graphic id="pcbi.1005232.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> for <italic>t</italic><sub><italic>k</italic>−1</sub> &lt; <italic>t</italic> &lt; <italic>t</italic><sub><italic>k</italic></sub>. A full description of the UKF can be found in <xref ref-type="supplementary-material" rid="pcbi.1005232.s001">S1 Appendix</xref>.</p>
<p>The <italic>unscented</italic> Kalman filter efficiently accommodates nonlinear models by assuming the state is a multivariate Gaussian distribution around the best estimate <inline-formula id="pcbi.1005232.e015"><alternatives><graphic id="pcbi.1005232.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, whose covariance represents the state uncertainty, and then propagating <inline-formula id="pcbi.1005232.e016"><alternatives><graphic id="pcbi.1005232.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and a representative finite set of symplex points used to approximate the distribution—denoted as sigma points—forward through the dynamics. The spread of the forward iterates of these sigma points then represent the forecast uncertainty, and their covariance is used to compute the Kalman gain at the next correction step. The appendix contains a detailed explanation of the unscented Kalman filter we use here.</p>
<p>The application of DA to biological and clinically relevant models is not in itself novel. The application of DA to type 2 diabetes using data <italic>constrained</italic> to normal everyday patient collection <italic>is</italic> novel because this application poses particular challenges: the clinical environment is data-poor because data collection is strictly constrained to real-world patient self-measurement patterns, the lack of a first principles model allows for multiple possible best models, and the reality of non-stationary health implies non-stationary model parameters. We address each of these issues below.</p>
</sec>
<sec id="sec005">
<title>Model choice, evaluation and selection</title>
<p>There are numerous models of glucose-insulin dynamics of varying complexity [<xref ref-type="bibr" rid="pcbi.1005232.ref062">62</xref>], and it is neither obvious <italic>a priori</italic> which of these will best fit and predict the relevant dynamics from the limited measurements made, nor whether such optimization may be patient specific. For this study we have limited our analysis to the comparison of two models chosen for their balance between modeled mechanisms and limited complexity: First, we use a relatively simple ultradian model [<xref ref-type="bibr" rid="pcbi.1005232.ref063">63</xref>] with 6 state variables and 30 parameters. This model is a minimal model developed in a non-pathophysiologic context and represents relatively simple physiologic mechanics. Second, to contrast the ultradian model we use the meal model [<xref ref-type="bibr" rid="pcbi.1005232.ref049">49</xref>] with 12 state variables and 70 parameters. The meal model includes more digestive mechanics, was developed to include both physiologic and pathophysiologic dynamics, and represents a substantial increase in mechanical modeling complexity over the ultradian model. Each of these models are utilized in the DA framework to reconstruct and forecast the glucose dynamics from patient recorded data. The fidelity of the forecasts is then used to differentiate model performance. The full details and descriptions of the models are included in <xref ref-type="supplementary-material" rid="pcbi.1005232.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005232.s003">S3</xref> Appendices.</p>
</sec>
<sec id="sec006">
<title>Parameter selection and estimation</title>
<p>Because of differences between individuals and the non-stationary nature of their behavior and health, we personalize the application of these models by estimating and continually refining model parameters in real-time. Parameters are estimated using a parameter filter that is analogous to the state filter where the states are replaced with parameters.</p>
<p>Due to the practical overfitting constraints imposed by sparse data collection, only a small subset of the parameters—<italic>three parameters per model</italic>—are continually refined. We chose the parameters to estimate using physiologic insight and motivation towards the clinical goal of post-meal glucose forecasting by restricting the estimated parameters to those that strongly influence the mean and variance of glucose. Moreover, we chose parameters that are relatively independent of one another to maximize the effective parameter space and reduce parameter interdependency issues within the parameter filter. Although the measurements are quite sparse, they include measurements just before meals, providing a baseline, and measurements taken at various times after meals, helping to capture variation in glucose dynamics. The result is not only a patient-specific model and forecast, but one that adapts over time with changing individual behavior. It may be possible to devise an optimal measurement pattern but we do not address this topic here. Because the models we use embody established physiological systems and their dynamics, the parameters themselves have direct physiological interpretation. We therefore hypothesize that parameter changes detected over time may be useful indicators of changing health, a topic we address in more detail in the discussion.</p>
</sec>
<sec id="sec007">
<title>Data assimilation for states and parameters—Methodological summary</title>
<p>We developed a <italic>modified</italic> dual unscented Kalman filter (UKF) that uses two separate filters to estimate states and parameters. The state filter was modeled after Wan and van der Merwe [<xref ref-type="bibr" rid="pcbi.1005232.ref061">61</xref>], but augmentation of posterior sigma points was done in proportion to the estimated posterior covariance, rather than with respect to an assumed noise term (Appendix, eq. 28-29). The parameter filter was implemented as defined by Gove and Hollinger [<xref ref-type="bibr" rid="pcbi.1005232.ref058">58</xref>], where prior parameter covariance is inflated by a “forgetting factor” to allow an additional growth of parameter uncertainty proportional to its covariance, rather than with respect to an assumed noise term (Appendix, eq 46-47). In addition, we enforce a positivity constraint on parameter and state sigma points by setting negative elements to the smallest positive value taken by that element across all sigma points. If no positive values are present, we set the element to zero. Negative (non-physical) parameters and states are inappropriate for the models we use, and can lead to problems with numerical integration, which can subsequently erode the quality of the fit. These ad-hoc adjustments can lead to ill-conditioning of the updated covariance—to overcome this, we generate the next iteration of sigma points with only the real part of the covariance square root. These constraints introduce their own weaknesses, and can lead to underfitting through pre-mature parameter convergence in cases where much of the volume of the covariance square root exists in the complex plane. While this approach is certainly suboptimal, we find it useful for ensuring robustness in an algorithm that must perform reliably in an online clinical setting.</p>
</sec>
<sec id="sec008">
<title>Clinical variable estimation</title>
<p>The UKF generates continuous smoothed estimates of states and parameters that can be used to compute estimates of clinically relevant measures, e.g., HbA1c. Clinically, HbA1c is linearly related to the mean of the glucose over the previous three months [<xref ref-type="bibr" rid="pcbi.1005232.ref023">23</xref>] and summarizes glucose control over that time period. Because HbA1c is an averaged value of blood glucose over a 3-months timeframe, individuals can find it difficult to relate this average to any particular meals or other activities that contributed to it. This problem exists largely due to the sparsity of glucose data collection—individuals don’t collect enough measurements to calculate an accurate average over short time periods. The continuous state UKF estimates allow for short term—order hours to months—moving window mean glucose estimates, providing an opportunity for individuals to understand the source of their HbA1c by understanding <italic>quantitatively</italic> the events that compose their mean glucose over short time periods related to nutrition consumption.</p>
</sec>
<sec id="sec009">
<title>Data utilized</title>
<p>The data we use in this paper reflect our goals of proving that a DA can: <italic>(i)</italic> successfully forecast glucose based only on data typically available to individuals with diabetes: carbohydrates in meals and sparse, irregularly sampled glucose measurements, <italic>(ii)</italic> personalize to an individual, <italic>(iii)</italic> adapt when the individual changes, and <italic>(iv)</italic> cope with the <italic>data-poor</italic> constraints of real-life diabetes self-monitoring. Because of these goals, we restricted the data to three individuals with diabetes chosen to capture specific disease and measurement characteristics. Participant 1 measured glucose with a frequency at the upper bound of what is common among individuals with diabetes (1 preprandial and 1–3 postprandial) and self-reported a change in their diet over the course of the study. Participant 1 has well controlled diabetes, with pre- and post-study HbA1c measurements of 6.4% and 5.6%. Participant 2 measured blood glucose in accordance with a typical clinical recommendation for individuals with diabetes (preprandial and 2h postprandial) and did not report any changes in their diet over the course of the study; this participant’s HbA1c at the end of the study was 6.4%. Participant 3 contributed the most sparse and irregular dataset, which included irregular records of meals, days with no records, and glucose captured at random times of day often without reference to meals. This case is included to demonstrate the relative success of the DA forecasts in data-poor situations that imply its particular relevance in real-world practice. Moreover, while participants 1 and 2 represent best-case self-monitoring among people with type 2 diabetes, participant 3’s data presents a snap-shoot of are more average to low level of self-monitoring common among people with type 2 diabetes. Participants 4 and 5 do not have diabetes but were participants in a usability study for a later generation of the mobile application used during the collection of data from participants 1 and 2. We have included participants 4 and 5 because they are physiologically distinct from the participants 1–3 and this difference both increases our data set and provides more evidence of the robustness of the methods we develop in this paper.The details of the data and its collection are included in the methods section.</p>
</sec>
</sec>
<sec id="sec010">
<title>Model averaging</title>
<p>The model averaged output quantity, <inline-formula id="pcbi.1005232.e017"><alternatives><graphic id="pcbi.1005232.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, is estimated from a set of models <italic>f</italic><sub><italic>i</italic></sub>, a set of continuous and potentially nonlinear functions that translate the model output into a <inline-formula id="pcbi.1005232.e018"><alternatives><graphic id="pcbi.1005232.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>-compatible form. Here <italic>g</italic> is the mean of the posterior distribution or the mean of the sigma points output by the DAs, via an optimized weighted sum:
<disp-formula id="pcbi.1005232.e019"><alternatives><graphic id="pcbi.1005232.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msub><mml:mi>w</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where we assume <italic>M</italic> models and positive weights <italic>w</italic><sub><italic>i</italic></sub> that sum to one, or <inline-formula id="pcbi.1005232.e020"><alternatives><graphic id="pcbi.1005232.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Due to this constraint, <italic>M</italic> − 1 weights <italic>w</italic><sub><italic>i</italic></sub> are sufficient to determine <inline-formula id="pcbi.1005232.e021"><alternatives><graphic id="pcbi.1005232.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>; thus, with two models, we seek the optimal value of <italic>w</italic><sub>1</sub>. There are many methods for selecting the optimal weights where optimal is defined by the set of weights such that <inline-formula id="pcbi.1005232.e022"><alternatives><graphic id="pcbi.1005232.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> minimizes a model evaluation metric, three of which are introduced in the sections that follow.</p>
<sec id="sec011">
<title>Linear prediction based model averaging</title>
<p>A clinically relevant and intuitive method for selecting the model averaging weights is to maximize the linear correlation between forecasts and measurements over some time period. Or, assuming measurements <italic>y</italic> and forecasts <italic>x</italic><sub><italic>i</italic></sub> generated by model <italic>i</italic> on a time period <italic>T</italic> we estimate the linear correlation with:
<disp-formula id="pcbi.1005232.e023"><alternatives><graphic id="pcbi.1005232.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:mi>y</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>β</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
and we select the weight <italic>w</italic><sub>1</sub> that <italic>maximizes</italic> the linear correlation, <italic>β</italic>.</p>
</sec>
<sec id="sec012">
<title>Mean square error based model averaging</title>
<p>Possibly the most common method for selecting the model averaging weights is to minimize the mean squared error (MSE) between forecasts and measurements over some time period. Or, assuming <italic>N</italic> measurements <italic>y</italic> and forecasts <italic>x</italic><sub><italic>i</italic></sub> from model <italic>i</italic> collected over a time period <italic>T</italic> we estimate the MSE with:
<disp-formula id="pcbi.1005232.e024"><alternatives><graphic id="pcbi.1005232.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mrow><mml:mi>M</mml:mi> <mml:mi>S</mml:mi> <mml:mi>E</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
and we select the weight <italic>w</italic><sub>1</sub> that <italic>minimizes</italic> the MSE.</p>
</sec>
<sec id="sec013">
<title>Information criterion based model averaging</title>
<p>The information criterion ([<xref ref-type="bibr" rid="pcbi.1005232.ref056">56</xref>]) model evaluation method we use here is based on the Kullback-Leibler divergence ([<xref ref-type="bibr" rid="pcbi.1005232.ref064">64</xref>]). This method focuses neither on prediction, like linear correlation evaluation, nor error, like MSE evaluation, but rather on the overall closeness between the distributions defined by data and model forecast output. The intuitive interpretation of KL-divergence between two distributions <italic>p</italic> and <italic>q</italic> is the information lost when approximating <italic>p</italic> with <italic>q</italic>. In the context of model averaging, we formulate the KL-divergence as:
<disp-formula id="pcbi.1005232.e025"><alternatives><graphic id="pcbi.1005232.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mrow><mml:mi>K</mml:mi> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">log</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
where <italic>p</italic>(<italic>w</italic><sub>1</sub> <italic>x</italic><sub>1</sub>(<italic>T</italic>) + <italic>w</italic><sub>2</sub> <italic>x</italic><sub>2</sub>(<italic>T</italic>)) is the kernel density estimate (KDE) of the model averaged forecasts and <italic>q</italic>(<italic>y</italic>(<italic>T</italic>)) is the KDE of the data. We select the weight <italic>w</italic><sub>1</sub> that <italic>minimizes</italic> information loss, or <italic>KL</italic>(<italic>w</italic><sub>1</sub>, <italic>w</italic><sub>2</sub>).</p>
</sec>
</sec>
<sec id="sec014">
<title>Gaussian process regression model</title>
<p>Some previous studies have used non-mechanism-based machine learning methodology to forecast post meal glucose. We do not use continuous glucose monitor data here and therefore cannot directly compare the DA output with what has been done in other studies, but we can use machine learning methods on our data and compare those forecasts with the DA forecasts to some degree. In the same spirit as was used with the UKF—we use standard methods and do not optimize hyperparameters to simulate what is possible in the high-throughput setting—we use a Gaussian Process Model Regression (GPMR) [<xref ref-type="bibr" rid="pcbi.1005232.ref065">65</xref>] modified for next step prediction [<xref ref-type="bibr" rid="pcbi.1005232.ref066">66</xref>]. The theory for these regressions is well-known, so we will not discuss it in detail here. However, it is necessary for us to explain the details of the methodology we use for training, forecasting, and evaluating the GPMR. The regression takes two input variables, pre-meal glucose defined as a glucose measurement within 15 minutes of eating and the carbohydrate content of a meal. The output is the post meal glucose forecast that is independent of time and represents a post-meal glucose value. The GPMR will be trained initially on 50 meals; when new meals are encountered, a post-meal glucose forecast will be made, and then that meal will be incorporated into the training set for the next, yet to be observed, meal. In this way, the training set increases with every meal while the post-meal glucose forecast is always made for a single meal as it would be encountered in real time. The post-meal glucose forecast is compared with the first post-meal glucose measurement on a time interval of 45–180 minutes after the meal. Because of these data constraints, the GPMR cannot be used to forecast pre-meal glucose, glucose at random times, or glucose without a meal and without a pre- and post-meal glucose measurement, and therefore there are fewer meals available to forecast. Because of these practical issues, the GPMR uses a different training set than the UKF schemes. As we have mentioned earlier, there is a lot of space for improving both GPMR and UKF or more broadly DA inference machines, a topic we will address in the discussion.</p>
<p>There are two details worth mentioning related to DAs with mechanism-based models and GPMR. First, both the DAs and the GPMR we use in the paper are Gaussian processes in the formal sense [<xref ref-type="bibr" rid="pcbi.1005232.ref067">67</xref>], but their primary dynamics are generated by very different processes, one mechanistic with a random component and one has only a random component. Second, the DAs generate continuous forecasts and therefore can forecast all glucose measurements regardless of the data available, making them flexible and robust to missing or partially missing data.</p>
</sec>
<sec id="sec015">
<title>Study design</title>
<p>In this study, we create the mechanistic model-based glucose forecasting machinery with data assimilation that provides real-time, personalized glucose forecasts that adapt to and track an individual patient’s changing state over time, and we validate it on longitudinal time series from five patients. We demonstrate that the DA forecasts, subject to real world constraints of sparse, noisy, real patient-collected data, personalize, adapt over time, and track quickly relative to postprandial blood glucose readings captured by the participants, such that the DA machinery can be used as the engine in a diabetes self-intervention application. Through the DA we translate physiologic knowledge directly to an individual to help them make disease self-management decisions. The DA we use is designed to track, forecast, and correct states and parameters of nonstationary systems in real time without the luxury of an explicit training set. Instead, the algorithm is adjusted to each patient, using the prior data for training and predicting unseen subsequent data points. Similar methodology was used in the DA model averaging construction. The GPMR construction differs as is demanded by the details of the GPMR computation. It is initialized with a training set of 50 meals when possible and then forecasts post-meal glucose given carbohydrate and pre-meal glucose measurements. For the DA, we use two independent mechanistic-model-based DAs to forecast because different individuals, or individuals in changing states, may require different mechanistic models as forecasting engines. We also develop the model selection criteria for evaluating and selecting the most accurate model, given a prediction task, in the results section.</p>
<p>The five independent datasets chosen represent typical self-monitoring scenarios for individuals with type 2 diabetes from three different diabetes studies. The first three participants have type 2 diabetes while the last two participants do not. In addition, we compared accuracy of the DA predictions with accuracy of predictions generated by certified diabetes educators, whose judgement often represents the gold standard with respect to human-based post-meal glucose prediction and is used to arrive at nutritional therapy recommendations for individuals with diabetes. We compare the DA forecast to that of the diabetes educators to demonstrate that the DA can perform as well as the most skilled humans. This evaluation is important because it compares human and machine accuracy for the prediction task that people with type 2 diabetes must perform every time they consume food. We chose an N of five because our goal is to understand and validate the personalized performance of the DA in depth. In this way we performed five independent experiments and compare their outcomes. We have two layers of inclusion/exclusion requirements, those for this paper and those of the original studies where the data originate; the details of the data collection for the diabetes studies are discussed in paragraphs below and the related citations. For this study we chose five individuals with the following characteristics:</p>
<list list-type="order">
<list-item>
<p>(i) more than two measurements over the course of a meal, (ii) relatively dense measurements in time, (iii) <italic>changing patient state over course of measurement.</italic>, (iv) type 2 diabetes.</p>
</list-item>
<list-item>
<p>(i) two measurements over the course of a meal (before and after), (ii) realistic, sustainable measurements in time, (iii) static patient state over course of measurement, (iv) type 2 diabetes.</p>
</list-item>
<list-item>
<p>(i) relatively random measurement times, (ii) sparse measurements in time, (iii) unknown patient state over course of measurement, (iv) type 2 diabetes.</p>
</list-item>
<list-item>
<p>(i) more than two measurements over the course of a meal, (ii) relatively dense measurements in time, (iii) <italic>changing patient state over course of measurement.</italic>, (iv) non-diabetic.</p>
</list-item>
<list-item>
<p>(i) more than two measurements over the course of a meal, (ii) relatively dense measurements in time, (iii) <italic>changing patient state over course of measurement.</italic>, (iv) non-diabetic.</p>
</list-item>
</list>
<p>Their data are shown in more detail in <xref ref-type="table" rid="pcbi.1005232.t001">Table 1</xref>. We did not exclude data outliers because we want to show the DA performance under realistic, real-time circumstances. Each participant is treated as an independent experimental set-up, and the number of glucose measurements represent the number of experiments per experimental set-up.</p>
<table-wrap id="pcbi.1005232.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.t001</object-id>
<label>Table 1</label>
<caption>
<title>Demographics, data characteristics, and medication information for the five individuals we used to evaluate the DA.</title>
<p>Each participant is treated as an independent experimental set-up, and the number of glucose measurements represent the number of experiments per experimental set-up.</p>
</caption>
<alternatives>
<graphic id="pcbi.1005232.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" colspan="6" style="border-bottom:thick">Demographic and medication information for five individuals used in our study</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ID</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">3</td>
<td align="left">4</td>
<td align="left">5</td>
</tr>
<tr>
<td align="left">Disease state</td>
<td align="left">DM2</td>
<td align="left">DM2</td>
<td align="left">DM2</td>
<td align="left">no-DM2</td>
<td align="left">no-DM2</td>
</tr>
<tr>
<td align="left">Age</td>
<td align="left">40–50</td>
<td align="left">40–50</td>
<td align="left">40–50</td>
<td align="left">40–50</td>
<td align="left">40–50</td>
</tr>
<tr>
<td align="left">Meds</td>
<td align="left">metformin</td>
<td align="left">metformin</td>
<td align="left">insulin</td>
<td align="left">none</td>
<td align="left">none</td>
</tr>
<tr>
<td align="left"># of glucose measurements</td>
<td align="left">304</td>
<td align="left">211</td>
<td align="left">24</td>
<td align="left">520</td>
<td align="left">322</td>
</tr>
<tr>
<td align="left"># of HbA1c measurements</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left"># of days measured</td>
<td align="left">27</td>
<td align="left">28</td>
<td align="left">15</td>
<td align="left">90</td>
<td align="left">90</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<sec id="sec016">
<title>Diabetes data collection studies</title>
<p>The three datasets included in the analysis were collected during two separate studies with individuals with diabetes. Participant 3 was a participant in a randomized controlled trial of a mobile application for diabetes self-management, MAHI [<xref ref-type="bibr" rid="pcbi.1005232.ref068">68</xref>]. Participants 1 and 2 took part in a study that investigated how individuals with diabetes reason about personal data collected with self-monitoring technologies [<xref ref-type="bibr" rid="pcbi.1005232.ref032">32</xref>]. All three datasets included images of meals taken with smart phones, unstructured textual descriptions of these meals, and blood glucose readings captured at different times of day. During the first study (participant 3), the participants were asked to follow their typical glucose testing schedule; as a result, the first dataset included sparse glucose readings taken 2–3 times per day and often irrespective of meals (e.g. only before or only after). In the second study (participants 1 and 2), the participants were explicitly asked to check their glucose readings before meals, and at least once (2 hours postprandial) or more after meals. Consequently, data sets for participants 1 and 2 include considerably more glucose readings, 7–11 daily. Importantly, while the first study was an intervention study, designed to instigate changes in participants’ behavior over its course, the second was a data collection study without an interventional component or expectations for changes in participants’ behaviors. Yet qualitative interviews with participants of the second study, particularly participant 1 suggested that simple participation in the study alerted them to their nutritional choices and led to some changes in their diet (which was consistent with the change in their reported HbA1c). In contrast, participant 2 did not report any changes in their diet. The demographic information of study participants and statistics on the captured data are included in <xref ref-type="table" rid="pcbi.1005232.t001">Table 1</xref>. Both studies were approved by the corresponding Institutional Review Boards; all participants signed informed consent form prior to participating. In both studies the participants were reimbursed the cost of testing strips.</p>
</sec>
<sec id="sec017">
<title>Diabetes educator prediction data collection study</title>
<p>To compare the predictions of the model with best available human-based glucose predictions, we used predictions of postprandial glucose levels collected during our previous study of reasoning with personally generated data [<xref ref-type="bibr" rid="pcbi.1005232.ref068">68</xref>]. In that study, two Certified Diabetes Educators were asked to review meals, their textual descriptions, macronutrient breakdown of those meals, and glucose readings before and after those meals extracted from data sets collected by participants one and two. The extracted sets included records made during 5 consecutive days. After that, the diabetes educators were presented with records of meals captured during another 5 days (not included in the previous phase) and glucose levels before these meals, and were asked to predict postprandial glucose levels (at 1h and 2h postprandial for participant one and at 2h postprandial for participant two). We previously reported on these results in comparison with predictions generated by individuals with diabetes. Here we use the diabetes educator forecasts, the best available human-generated predictions, as a point of comparison with the DA glucose forecasts. If the DA forecasts are comparable to those of the best human forecasts, the case can be made that the DA forecasts could be potentially made useful to individuals with type 2 diabetes.</p>
</sec>
<sec id="sec018">
<title>Non-diabetes data collection study</title>
<p>Data for non-diabetic individuals was collected as part of the pilot study of a smart phone application for forecasting individual’s glycemic reaction to prospective meals based on their previous history. The two individuals whose data was used in this paper were recruited as part of a convenience sample, were both in their early 40s, had no known health issues, varied in gender (one male, one female), and had college degrees. They used the app for 4-6 weeks each to capture all their meals and blood glucose levels before and after each meal (2 hours postprandial) for the duration of the study.</p>
<p>All of the studies were approved by the corresponding Institutional Review Boards; all participants signed informed consent form prior to participating. In all studies that involved collecting blood glucose readings, the participants were reimbursed the cost of testing strips.</p>
</sec>
</sec>
<sec id="sec019">
<title>Evaluation, validation, generalizability and usability of the model-based UKF construction</title>
<p>In this paper we address the validation or evaluation, generalizability, and usability of the mechanistic model-based UKF forecasts. The UKF is a prediction/correction machine, meaning that it uses the most recent data to make predictions until the new data point is encountered, at which point the prediction is evaluated and the UKF states and parameters are corrected. This implies a different validation and generalizability situation from what is often encountered in biomedical studies.</p>
<p><italic>Validation</italic> of the UKF, because of the prediction/correction construction, requires each person to be treated as an independent experimental set-up. Therefore, sample size for validation is the number of meals per person. For validation purposes, we conducted five experiments on different experimental set-ups where the experiments range from having sample sizes of 24 to 520. We validate the model/UKF combination using mean squared error, linear correlation, and a KL-divergence-based distance on a per-person/experiment basis. Moreover, we compare expert nutritionist forecasts to model forecasts, but this is not so much a validation of the UKF as it is a quantitative validation of the challenges that individuals with type 2 diabetes face in the course of their self management and a demonstration of a way the UKF-based forecast could potentially help individuals with type 2 diabers. The nutritionist is the gold standard baseline for <italic>human-based</italic> prediction of the glycemic impact of a chosen meal. Therefore, when we compare the nutritionist forecasts with the model-based forecasts we are comparing machine-forecasting to human-based forecasting to demonstrate the potential usefulness of the UKF framework. It is important to understand that the nutritionist is not the gold standard by which we evaluate the UKF, the glucose measurements serve that purpose.</p>
<p><italic>Generalizability</italic> moves beyond validation of the UKF and addresses the likelihood, for a population, that the UKF equipped with one or another of the mechanistic models would be applicable. Relative to generalizability to the population of human beings, we have a sample size of five including three individuals with type 2 diabetes and two individuals without type 2 diabetes. While these five individuals are rather diverse and have different disease states with only five people we cannot claim that the models or the UKF will generalize to all people. However, this is not the purpose of this paper; before justifying imposing the UKF on a larger population, it is important to validate and understand, on an individual level, the accuracy of the UKF forecast and how well the UKF can personalize to different individuals.</p>
<p><italic>Usability</italic> moves beyond validation but in a different direction than generalizability. Usability addresses the usefulness, to a person with type 2 diabetes, of the UKF output. To address usability one must address the consistency of the accuracy of the UKF output and the nature of the presentation of the UKF output. For example, the usability is often quantified based on the impact of the presentation of the forecast on the patient state as the study progresses. The retrospective nature of this paper and the limited population size prevent us from addressing usability in earnest here. What we do instead is investigate the building blocks for a potential diabetes management intervention. We do this to help put the UKF forecasts in a more clinical context and justify that the UKF forecasts can be of potential use for a diabetes intervention. But a first set in any usability study is to understand the accuracy of the information given to the users—this paper was written with this step in mind.</p>
</sec>
</sec>
<sec id="sec020" sec-type="results">
<title>Results</title>
<sec id="sec021">
<title>Glucose state estimation using data assimilation</title>
<p>The visualization of the personalized glucose forecasts from both models, the continuous glucose imputation, and the convergence to better forecasts as more data are accumulated for participant 1 is shown in <xref ref-type="fig" rid="pcbi.1005232.g001">Fig 1</xref>. To demonstrate the model forecasts at the beginning and how they improve over time, we have included plots of forecasts for days 1–5 and 20–25. In these plots, the DA receives data as if it were collected in real time, makes forecasts, corrects the glucose trajectory and model parameters according to each individual measurement, and then repeats this process. There are four features in <xref ref-type="fig" rid="pcbi.1005232.g001">Fig 1</xref> of note. <italic>First</italic>, the models seem to converge over time and provide better forecasts. <italic>Second</italic>, the models appear to generate accurate forecasts. <italic>Third</italic>, the glucose dynamics of both model-based DA outputs lie within the range of measured glucose values. And <italic>fourth</italic>, the off-data model dynamics differ substantially between models despite the similar accuracy of both model forecasts.</p>
<fig id="pcbi.1005232.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Glucose measurements, forecasts, corrections, and continuous forecasts of both models for days 1–5 (left) and 20–25 (right) for participant 1.</title>
<p>These representations of the tracking and forecasting processes performed by the UKF provide an intuitive understanding of the estimation procedure, as well as for the dynamics of each model. Forecast errors are generally larger for both models during early stages of training (days 1–5), but while both models produce similarly reasonable forecasts of each discrete measurement (which we establish quantitatively), both models predict qualitatively <italic>different</italic> off-data continuous forecasts, represented by the lines, over the same time periods and subject to the same measurements; this difference demonstrates that the models represent different physiology.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.g001" xlink:type="simple"/>
</fig>
<p>While the DA output looks reasonable in <xref ref-type="fig" rid="pcbi.1005232.g001">Fig 1</xref>, it is important to quantify the goodness of fit. <xref ref-type="fig" rid="pcbi.1005232.g002">Fig 2</xref> shows the mean squared error between the <italic>real-time</italic> DA forecasts and the measurements over time for both models. There are three notable features in <xref ref-type="fig" rid="pcbi.1005232.g002">Fig 2</xref> <italic>First</italic>, the models converge after about 50 measurements—at 8 glucose measurements per day, convergence is achieved with about one week’s worth of data. <italic>Second</italic>, while the ultradian model does better initially relative to the mean squared error, the models provide approximately equally accurate forecasts given two to three weeks of data. And <italic>third</italic>, the mean squared error improves over time—most of the point-wise mass of the mean squared error lies below the mean, implying that much of the post-convergence error is generated by a few large-error forecasts.</p>
<fig id="pcbi.1005232.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Mean squared error <italic>integrated</italic> over time after day 7 for participant 1 for both ultradian and meal models.</title>
<p>Notice: both models show convergence in mean squared error over time; after 200 measurements the integrated mean squared error for both models does not differentiate them; and as the number of measurements increase, the majority of the errors are below the integrated mean squared error value.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec022">
<title>Comparing DA glucose forecasting to Certified Diabetes Educator forecasts</title>
<p>We have established that the DAs converge and generate accurate forecasts; the next question is to compare predictions generated by the model with those generated by human experts, here Certified Diabetes Educators. To be clear, we are not using the diabetes educators as a gold standard for the DA but rather as a gold standard for human-based forecasting of the glycemic impact of individual meals. There are two reasons why we want to compare diabetes educators to the UKF forecasts. First, while human-based glycemic forecast evaluation is not the topic of this paper, it is important that we demonstrate the difficulty of the task we are asking of patients, every time they eat, by showing how well a highly educated/trained individual performs at the task of forecasting glycemic impact of a given food intake. Second, we need to have a proof in principle from a clinical standpoint that the DA predictions of by-meal glycemic impact were comparable or better than to what a trained diabetes counselor would forecast for individual meals; i.e., demonstrating that the DA can do as well as the best trained humans at forecasting glycemic impact. By doing this we can establish a proof in principle, from the clinical standpoint, that with little tuning the DA could automatically match or beat the state of the art in clinical care.</p>
<p>Before we present the results, there are some important caveats related to this analysis and comparison. <italic>First</italic>, comparison we present here is relatively underpowered. We compare only 14 experiments—meals—for three experimental set-ups, participant one’s glucose forecasts and measurements one hour and two hours post-meal and participant two’s glucose forecasts and measurements two hours post meal. Recall that the dataset for participant 1 typically had two postprandial blood glucose measurements, while the dataset for participant 2 typically had only one postprandial blood glucose measurement. Because of this, we do not have one-hour correlations for participant 2. Participant 3 did not have enough data to calculate statistically significant one or two-hour post meal correlations between measured and forecasted glucose. Some of the quantities we would like to calculate are not resolvable with these data, but we can make enough good estimates to make useful and important comparisons. <italic>Second</italic>, the educators generally estimate the glycemic impact of a meal not post-meal glucose at a precise time, making pin-point forecasts an unusual task for them. Because of this, we might expect the linear correlation—the quantity that captures accuracy the estimate of the mean—to be well forecast by the diabetes educators while the MSE—the quantity that captures point-wise forecast error—to be more difficult for the diabetes educators. <italic>Third</italic>, the DAs are continuous models and generate a glucose forecast every minute regardless of the data present. The continuous glucose dynamics are oscillatory—like that of an oscillator driven by nutrition and damped by insulin and metabolism—so the model output can differ by 100 mg/dl within a 15 minute interval over the first two hours after food has been consumed. The oscillations driven by meal consumption for both models can be seen in Figs. 1 in <xref ref-type="supplementary-material" rid="pcbi.1005232.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005232.s003">S3</xref> Appendices respectively. Because of this, we might expect that the model forecasts would have high MSE and low linear correlation with measurements at one hour post-meal and low MSE and high linear correlation at two hours post-meal.</p>
<p>
<xref ref-type="table" rid="pcbi.1005232.t002">Table 2</xref> has the results of the comparison between the diabetes educator post-meal glucose forecast accuracy and the DA post-meal glucose forecast accuracy. The <italic>primary conclusion</italic> is that the DA forecasts compare favorably to the forecasts of the certified diabetes educators given the same data. This conclusion can be reached though five observations drawn from <xref ref-type="table" rid="pcbi.1005232.t002">Table 2</xref>. <italic>First</italic>, the DAs do not have good point-wise accuracy one hour after a meal as expected. <italic>Second</italic> the DAs have better point-wise accuracy two hours after the meal in comparison with the point-wise accuracy of the diabetes educators, as expected. <italic>Third</italic>, the diabetes educators have the same point-wise accuracy at one and two hours after the meal, but their point-wise accuracy is higher than we had expected. <italic>Fourth</italic> it is difficult to compare the linear correlation—the estimate of the post-meal mean—between the post-meal measurement and forecasts of the diabetes educators and the DAs for participant one because of data sparsity. And <italic>fifth</italic>, the linear correlations between the between the two hour post-meal measurement and forecasts of the diabetes educators and the DAs for for participant two were roughly comparable.</p>
<table-wrap id="pcbi.1005232.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.t002</object-id>
<label>Table 2</label>
<caption>
<title>A comparison between the post-meal glucose forecasts of Certified Diabetes Educators and the DAs for a subset of the meals consumed by participants one and two.</title>
<p>The model forecasts compare well with expert forecasts. There is no one-hour correlation for participant 2 because participant 2 did not have one-hour post-meal glucose measurements.</p>
</caption>
<alternatives>
<graphic id="pcbi.1005232.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" colspan="4">Comparing DA forecasts with certified diabetes educator forecasts</th>
</tr>
<tr>
<th align="left">Patient</th>
<th align="left">Forecast</th>
<th align="left">MSE</th>
<th align="left">LC</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="4" style="border-bottom:thick">P1, 1 Hr, 14 Meals</td>
<td align="left">Ultradian Model</td>
<td align="left">2400</td>
<td align="left">-0.44, p = 0.11</td>
</tr>
<tr>
<td align="left">Meal Model</td>
<td align="left">1900</td>
<td align="left">0.13, p = 0.65</td>
</tr>
<tr>
<td align="left">Expert 1</td>
<td align="left">870</td>
<td align="left">0.36, p = 0.2</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">Expert 2</td>
<td align="left" style="border-bottom:thick">660</td>
<td align="left" style="border-bottom:thick">0.62, p = 0.02</td>
</tr>
<tr>
<td align="left" rowspan="4" style="border-bottom:thick">P1, 2 Hr, 14 Meals</td>
<td align="left">Ultradian Model</td>
<td align="left">520</td>
<td align="left">0.18, p = 0.54</td>
</tr>
<tr>
<td align="left">Meal Model</td>
<td align="left">290</td>
<td align="left">0.73, p = 0.003</td>
</tr>
<tr>
<td align="left">Expert 1</td>
<td align="left">890</td>
<td align="left">0.14, p = 0.64</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">Expert 2</td>
<td align="left" style="border-bottom:thick">900</td>
<td align="left" style="border-bottom:thick">0.14, p = 0.55</td>
</tr>
<tr>
<td align="left" rowspan="4">P2, 2 Hr, 14 Meals</td>
<td align="left">Ultradian Model</td>
<td align="left">570</td>
<td align="left">0.77, p = 6e-4</td>
</tr>
<tr>
<td align="left">Meal Model</td>
<td align="left">1000</td>
<td align="left">0.58, p = 0.02</td>
</tr>
<tr>
<td align="left">Expert 1</td>
<td align="left">470</td>
<td align="left">0.72, p = 0.003</td>
</tr>
<tr>
<td align="left">Expert 2</td>
<td align="left">340</td>
<td align="left">0.75, p = 0.001</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>It is, of course, relatively easy for us to improve the DA performance such that the DAs will outperform the diabetes educators if we tune the DA hyper-parameters by hand to a given individual. But, one of the key points of this paper is to demonstrate that the DAs, with no human intervention, can <italic>automatically</italic> generate a glucose forecast that is of similar or better quality as a highly trained human expert. Given the likelihood that knowledge of Certified Diabetes Educators greatly exceeds knowledge of a typical individual with diabetes, it is likely that DA-generated predictions will be more accurate than those generated by individuals with diabetes and therefore of potential help to individuals with type 2 diabetes.</p>
</sec>
<sec id="sec023">
<title>DA-based personalized medicine: Model personalization and adaptation</title>
<p>People, their metabolism, their behavior, and their presentation of diabetes are both <italic>personal and dynamic</italic>. To be useful, the DA must both personalize to the individual and adapt to changes in the individual over time. The models forecast glucose based on three features: glucose measurements, carbohydrate measurements, and model state defined by the parameter settings. While glucose and carbohydrate dynamics change on fast time scales (order minutes to hours), the baseline endocrine state and the model parameters that represent it are slower moving variables with dynamics evolving on the order of days to months.</p>
<p>We estimate three parameters for each model every time a new measurement is encountered. The ultradian model parameters we personalize include the exchange rate for insulin between remote and plasma compartments, <italic>E</italic>, the volume of insulin distribution in the plasma, <italic>V</italic><sub>1</sub>, and the time constant for plasma insulin degradation <italic>t</italic><sub>1</sub>, all of which affect the glucose mean and variance [<xref ref-type="bibr" rid="pcbi.1005232.ref069">69</xref>]. The meal model parameters that we estimate include the insulin volume, <italic>V</italic><sub><italic>I</italic></sub>, and the glucose kinetics parameters <italic>k</italic><sub>1</sub> and <italic>k</italic><sub>2</sub>, both of which are related to the severity of diabetes and also affect the glucose mean and variance.</p>
<p>To initially visualize and evaluate the adaptation of the models, we will first focus on HbA1c as a long-term clinically-motivated proxy for glucose. The relationship between HbA1c and glucose is understood physiologically and is well documented empirically [<xref ref-type="bibr" rid="pcbi.1005232.ref023">23</xref>]—HbA1c is linearly related to the mean glucose value averaged over the previous 90 days. The time period necessary to estimate HbA1c can be considerably shorter than 90 days, and the lower bound on the length of this time window is unknown. The problem of predicting HbA1c can then be framed as the challenge of determining the true mean glucose over such a time window. However, because we are focusing on opportunities for <italic>real time</italic> decision support, it is of greater interest to relate short term behaviors to long-term outcomes. As such, we explore methods for computing accurate daily glucose averages that can be easily converted to proportional HbA1c values. Concretely, these daily HbA1c estimates represent the expected HbA1c outcome for a patient if they were to maintain that day’s mean glucose over 90 days. In <xref ref-type="fig" rid="pcbi.1005232.g003">Fig 3</xref>, we evaluate daily HbA1c estimates by computing daily mean glucose levels for patient-recorded measurements and continuous off-data model forecasts.</p>
<fig id="pcbi.1005232.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.g003</object-id>
<label>Fig 3</label>
<caption>
<title/>
<p><bold>Top row</bold>—carbohydrate consumption in grams averaged every day for participants 1 and 2; participant 1 reported making dietary changes during the course of the study, with a particular focus on reducing the amount of consumed carbohydrates, while participant 2 did not report any changes in their diet during the study. <bold>Bottom row</bold>—HbA1c measurements for participants 1 and 2, measured-glucose-based HbA1c estimate, and the associated continuous DA generated <italic>χ</italic><sub><italic>o</italic></sub>-based <italic>daily</italic> HbA1c smoothed estimates for both the meal and ultradian models; the <italic>χ</italic><sub><italic>o</italic></sub>-based HbA1c forecasts are accurate <italic>and track broad glucose trends</italic> in all cases and <italic>the ultradian model HbA1c forecast for participant 1 predicted both the trend and the final measured HbA1c value</italic>. The initial underestimate of participant 1’s HbA1c is due to a combination of two factors: (i) the initial HbA1c measurement is taken at a time where the model error is high because it is early in the sequential estimation process and (ii) the model training set does not include much data prior to the first HbA1c measurement.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.g003" xlink:type="simple"/>
</fig>
<p>
<xref ref-type="fig" rid="pcbi.1005232.g003">Fig 3</xref> shows the carbohydrate consumption of participants 1 and 2, daily HbA1c estimates, and real HbA1c measurements. Embedded in <xref ref-type="fig" rid="pcbi.1005232.g003">Fig 3</xref> are five important results. <italic>First</italic>, by observing the changes in carbohydrates, we can verify that participant 1 consistently reduced their carbohydrate intake over the course of the study. Participant 2 also reduced their carbohydrate consumption, but not consistently, and by the end of the study their mean glucose was trending upwards. Participant 1’s HbA1c changed in the course of the study, potentially due to the change in carbohydrate consumption. For participant 2, the single HbA1c collected during the study is consistent with the HbA1c estimates from both glucose measurements and forecasts. <italic>Second</italic>, the results make evident the challenges related to estimating HbA1c on a time scale of days from only glucose measurements <italic>taken in the course of self-management</italic>. The culprit is sparsity of measurements; estimating a reliable and low-variance mean given 3–8 numbers taken from an oscillatory signal is non-trivial. Importantly, mean glucose may be more stable across days than is made apparent to patients by infrequent measurements.</p>
<p><italic>Third</italic>, the <italic>smoothed</italic>, fast time scale HbA1c estimate computed from the continuous glucose forecasts provided by the DA is more reliable, stable, and accurate than an estimate based on glucose measurements collected with frequencies <italic>consistent with common practices of individuals with diabetes</italic>. It is possible that continuous or carefully selected glucose readings could be as good or better than DA smoothing, however, neither of these approaches are feasible for the majority of individuals with T2D. For participant 1, DA is able to overcome the data-quality deficit: the ultradian model forecasts participant 1’s second HbA1c measurement nearly perfectly. The models track mean glucose well and are able to provide <italic>real-time forecasts</italic> that give us the ability to compute real-time smoothed mean glucose and HbA1c estimates, thus providing both a short-term glucose forecast and a long-term forecast of meals’ impact on glycemic control. However, which of these model outputs are most useful for self-management remains an open question. <italic>Fourth</italic>, both models track the HbA1c with expected accuracy. The glucose-measurement estimated HbA1c is well tracked by a smoothed DA-based HbA1c estimate. <italic>Fifth</italic>, the DA-based HbA1c forecasts seem to have a roughly 5-8 day lag behind nutrition as can best be observed in the plot of participant 2’s HbA1c and carbohydrate dynamics. The carbohydrate and HbA1c trends are roughly 5 days out of phase. This suggests that, given the constraints imposed by real-world frequency of data collection, the DAs change the basic endocrine state on the order of 5–8 days, or 50 measurements. This rate of adaptation is consistent with the initial convergence rate that required roughly 5–8 days or 50 measurements to converge. However, the key point is that the DAs continuously adapt and correct the endocrine basic state, improving forecasting accuracy, on the order of 50 measurements or 5–8 days, a speed that is likely fast enough to be useful in the context of diabetes self-management.</p>
<p>The convergence and adaptation of the model parameters estimated by the DA are shown in <xref ref-type="fig" rid="pcbi.1005232.g004">Fig 4</xref>. This plot shows the evolution of three estimated parameters as new measurements are encountered. There are four notable results in these figures. <italic>First</italic>, the model parameters generally converge to a curve with much slower or no change after approximately 50 measurements—this is consistent with the convergence rates we observed in the mean squared error in <xref ref-type="fig" rid="pcbi.1005232.g002">Fig 2</xref>. <italic>Second</italic>, both models adapt continuously to participant 1 who <italic>consistently decreased</italic> carbohydrate intake. The models show the adaptation to this change primarily in a single parameter—the exchange rate for insulin between remote and plasma compartments, <italic>E</italic>, of the ultradian model and the estimated insulin volume, <italic>V</italic><sub><italic>I</italic></sub>, of the meal model. <italic>Third</italic>, participant 3 did not have enough measurements to converge to a personalized state, but it is clear that the convergence was underway because several of the parameters appear to be leveling off to a constant state, following a <italic>qualitatively similar</italic> path as participant 2’s parameter convergence. This helps establish a measurement constraint, participant 3 has only 24 measurements and while the DA can issue better forecasts than a linear regression, the DA appears to need closer to 50 measurements to personalize. And <italic>fourth</italic>, the participants were all in relatively different health states and the models evolved through distinctly different health states, providing evidence of personalization.</p>
<fig id="pcbi.1005232.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Convergence in time, i.e., <italic>personalization</italic> of the DA, for three parameters of ultradian model (left) and three <italic>different</italic> parameters for the meal model over the course of measurements for all five patients.</title>
<p>Recall that the models have few overlapping parameters so it is not possible to compare parameters between models. Notice: (i) each model converges to a different state, depending on the patients, personalizing to the individual, (ii) visually, initial convergence of the parameters requires about 50 data points, (iii) patient 1, who continuously changed their behavior, had parameters that evolved in time in contrast to patient 2 whose behavior did not evolve and whose parameters did not change appreciably after 50 data points, and (iv) when using the meal model with patient 1, the potential for underfitting due to the sigma-point constraint in the parameter filter can be observed at measurement 50—recall that the sigma-point constraints were added to ensure robustness of the UKF, and that there exist methods for rectifying such issues, which we do not address.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec024">
<title>Model selection: Identifying the best model to drive the DA for a person and circumstance</title>
<p>We have no first principles type understanding of systems physiology, instead mechanistic models are constructed using empirical observation and stylized facts as is often done in economics [<xref ref-type="bibr" rid="pcbi.1005232.ref070">70</xref>]. Our object of study here, the endocrine system, is a complex, high dimensional physiologic system that depends on spatial scales from the molecular to the societal and time scales from microseconds to decades. We do not know which model with what components will most accurately represent a given person in a given circumstance. Because of this, to achieve accurate personalized forecast of glucose, it is important to include several different models and to develop a methodology for selecting the most useful model for a given set of circumstances, or employ a model-averaging scheme [<xref ref-type="bibr" rid="pcbi.1005232.ref055">55</xref>–<xref ref-type="bibr" rid="pcbi.1005232.ref057">57</xref>]. For simplicity, here we have restricted our choices to two mechanistic models and focus on model selection, rather than model averaging.</p>
<p>There is neither an objectively best model nor an objectively best model evaluation methodology [<xref ref-type="bibr" rid="pcbi.1005232.ref055">55</xref>]. To present a holistic picture and triangulate an understanding of what the different models do well and how they differ, we use four model selection techniques. Our <italic>first</italic> model evaluation—mean glucose—is likely the most intuitive, but not the most robust or accurate evaluation metric. <italic>Second</italic>, as previously discussed and seen in <xref ref-type="fig" rid="pcbi.1005232.g002">Fig 2</xref>, we use the pointwise mean squared error. <italic>Third</italic>, we use an information criterion technique—the Kullback-Leibler (KL)-divergence between the kernel density estimate of the real measurements and the kernel density estimate of the forecasts [<xref ref-type="bibr" rid="pcbi.1005232.ref064">64</xref>]. The <italic>fourth</italic> method we use to evaluate model performance is the linear correlation between DA forecasts and measured glucose values.</p>
<p>Forecast means in <xref ref-type="table" rid="pcbi.1005232.t003">Table 3</xref> show measured and DA-based mean glucose estimates for all five participants. While all models produce reasonable results, the ultradian glucose forecasts generate the most accurate mean glucose estimates. This result is surprising because the ultradian model is the simpler model and does not reproduce the measured glucose distribution as accurately as the meal model, as seen in <xref ref-type="fig" rid="pcbi.1005232.g005">Fig 5</xref>. The accuracy of the continuous off-data forecast of the ultradian model is important because the continuous forecasts are produced every few minutes, generating enough glucose values to render an accurate <italic>short term</italic>, e.g., 24 hour HbA1c forecast that can illustrate long-term impact of immediate nutritional choices, an option that is usually unavailable.</p>
<table-wrap id="pcbi.1005232.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.t003</object-id>
<label>Table 3</label>
<caption>
<title>Model evaluations for individual DA estimates is presented.</title>
<p>KL designates the KL divergence between the kernel density estimate of measured and DA-output glucose, LC designates linear correlation, potentially with a lag. Notice: <italic>(i)</italic> all models produce reasonable results, the ultradian mean glucose forecasts are the most accurate, <italic>(ii)</italic> the accuracy of the continuous forecast is important because the forecasts are produced every minute, generating enough glucose values to render an accurate <italic>short term</italic> HbA1c forecast that patients can immediately relate to their nutrition intake, <italic>(iii)</italic> the metrics do not always select the same best model, <italic>(iv)</italic> no single model is the representative of all patients, and <italic>(v)</italic> both models are capable of representing and forecasting patients.</p>
</caption>
<alternatives>
<graphic id="pcbi.1005232.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" colspan="6" style="border-bottom:thick">Model evaluation metrics of the DA forecasts</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Participant</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">3</td>
<td align="left">4</td>
<td align="left">5</td>
</tr>
<tr>
<td align="left">Disease state</td>
<td align="left">T2D</td>
<td align="left">T2D</td>
<td align="left">T2D</td>
<td align="left">no-T2D</td>
<td align="left">no-T2D</td>
</tr>
<tr>
<td align="left">Mean glucose, measured</td>
<td align="left">113 ± 25, (<italic>σ</italic>)</td>
<td align="left">127 ± 32, (<italic>σ</italic>)</td>
<td align="left">119 ± 16, (<italic>σ</italic>)</td>
<td align="left">92 ± 17, (<italic>σ</italic>)</td>
<td align="left">101 ± 16, (<italic>σ</italic>)</td>
</tr>
<tr>
<td align="left">Mean glucose, ultradian model forecast</td>
<td align="left"><bold>115</bold> ± <bold>15</bold>, (<italic>σ</italic>)</td>
<td align="left">124 ± 12, (<italic>σ</italic>)</td>
<td align="left">115 ± 9, (<italic>σ</italic>)</td>
<td align="left">90 ± 13, (<italic>σ</italic>)</td>
<td align="left"><bold>101</bold> ± <bold>12</bold> (<italic>σ</italic>)</td>
</tr>
<tr>
<td align="left">Mean glucose, ultradian model <italic>continuous</italic> forecast</td>
<td align="left">116 ± 14, (<italic>σ</italic>)</td>
<td align="left"><bold>129</bold> ± <bold>16</bold>, (<italic>σ</italic>)</td>
<td align="left"><bold>120</bold> ± <bold>17</bold>, (<italic>σ</italic>)</td>
<td align="left"><bold>91</bold> ± <bold>13</bold>, (<italic>σ</italic>)</td>
<td align="left">100 ± 10, (<italic>σ</italic>)</td>
</tr>
<tr>
<td align="left">Mean glucose, meal model forecast</td>
<td align="left">105 ± 28, (<italic>σ</italic>)</td>
<td align="left">120 ± 26, (<italic>σ</italic>)</td>
<td align="left">126 ± 37, (<italic>σ</italic>)</td>
<td align="left">87 ± 22, (<italic>σ</italic>)</td>
<td align="left">97 ± 27, (<italic>σ</italic>)</td>
</tr>
<tr>
<td align="left">Mean glucose, meal model <italic>continuous</italic> forecast</td>
<td align="left">101 ± 15, (<italic>σ</italic>)</td>
<td align="left">118 ± 28, (<italic>σ</italic>)</td>
<td align="left">132 ± 35, (<italic>σ</italic>)</td>
<td align="left">76 ± 19, (<italic>σ</italic>)</td>
<td align="left">86 ± 17, (<italic>σ</italic>)</td>
</tr>
<tr>
<td align="left">KL, Ultradian model and glucose</td>
<td align="left"><bold>0.54</bold></td>
<td align="left">0.29</td>
<td align="left">3.9</td>
<td align="left">0.65</td>
<td align="left">2.6</td>
</tr>
<tr>
<td align="left">KL, Meal model and glucose</td>
<td align="left">1.2</td>
<td align="left"><bold>0.11</bold></td>
<td align="left"><bold>1.4</bold></td>
<td align="left"><bold>0.18</bold></td>
<td align="left"><bold>0.20</bold></td>
</tr>
<tr>
<td align="left">MSE, Ultradian model and glucose</td>
<td align="left"><bold>680</bold></td>
<td align="left"><bold>950</bold></td>
<td align="left"><bold>250</bold></td>
<td align="left"><bold>260</bold></td>
<td align="left"><bold>280</bold></td>
</tr>
<tr>
<td align="left">MSE, Meal model and glucose</td>
<td align="left">730</td>
<td align="left">1300</td>
<td align="left">2800</td>
<td align="left">540</td>
<td align="left">590</td>
</tr>
<tr>
<td align="left">LC(1HR) Glucose with itself</td>
<td align="left">0.3, <italic>p</italic> = 0.07</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left">0.1 <italic>p</italic> = 0.4</td>
<td align="left">0.12 <italic>p</italic> = 0.3</td>
</tr>
<tr>
<td align="left">LC (2HR) Glucose with itself</td>
<td align="left">−0.02, <italic>p</italic> = 0.9</td>
<td align="left">0.07, <italic>p</italic> = 0.6</td>
<td align="left">—</td>
<td align="left">−0.13 <italic>p</italic> = 0.11</td>
<td align="left">0.18 <italic>p</italic> = 0.13</td>
</tr>
<tr>
<td align="left">LC Ultradian model forecast with glucose</td>
<td align="left">0.12, <italic>p</italic> = 0.04</td>
<td align="left"><bold>0.33</bold>, <italic>p</italic> = 6.0<italic>e</italic><sup>−7</sup></td>
<td align="left">0.10, <italic>p</italic> = 0.67</td>
<td align="left"><bold>0.38</bold>, <italic>p</italic> = 9.0<italic>e</italic><sup>−20</sup></td>
<td align="left">0.32 <italic>p</italic> = 5.0<italic>e</italic><sup>−9</sup></td>
</tr>
<tr>
<td align="left">LC Meal model forecast with glucose</td>
<td align="left"><bold>0.24</bold>, <italic>p</italic> = 3.5<italic>e</italic><sup>−5</sup></td>
<td align="left">0.31, <italic>p</italic> = 6.0<italic>e</italic><sup>−6</sup></td>
<td align="left"><bold>-0.47</bold>, <italic>p</italic> = 0.03</td>
<td align="left">0.36 <italic>p</italic> = 3.0<italic>e</italic><sup>−17</sup></td>
<td align="left"><bold>0.38</bold>, <italic>p</italic> = 4.0<italic>e</italic><sup>−12</sup></td>
</tr>
<tr>
<td align="left">LC(1HR) Ultradian model forecast with glucose</td>
<td align="left"><bold>0.31</bold>, <italic>p</italic> = 0.03</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left"><bold>0.39</bold>, <italic>p</italic> = 0.001</td>
<td align="left"><bold>0.32</bold>, <italic>p</italic> = 0.006</td>
</tr>
<tr>
<td align="left">LC(1HR) Meal model forecast with glucose</td>
<td align="left">0.20, <italic>p</italic> = 0.16</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left">0.28 <italic>p</italic> = 0.02</td>
<td align="left">0.29 <italic>p</italic> = 0.01</td>
</tr>
<tr>
<td align="left">LC(2HR) Ultradian model forecast with glucose</td>
<td align="left">−0.11, <italic>p</italic> = 0.39</td>
<td align="left">0.43, <italic>p</italic> = 0.004</td>
<td align="left">—</td>
<td align="left">0.44 <italic>p</italic> = 3.0<italic>e</italic><sup>−9</sup></td>
<td align="left">0.18 <italic>p</italic> = 0.13</td>
</tr>
<tr>
<td align="left">LC(2HR) Meal model forecast with glucose</td>
<td align="left">0.07, <italic>p</italic> = 0.55</td>
<td align="left"><bold>0.55</bold>, <italic>p</italic> = 8.6<italic>e</italic><sup>−5</sup></td>
<td align="left">—</td>
<td align="left"><bold>0.46</bold>, <italic>p</italic> = 7.3<italic>e</italic><sup>−10</sup></td>
<td align="left"><bold>0.46</bold>, <italic>p</italic> = 4.0<italic>e</italic><sup>−5</sup></td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1005232.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.g005</object-id>
<label>Fig 5</label>
<caption>
<title>The kernel density estimates of the probability densities (PDFs) of glucose measurements and a variety of forecasts after day 7 for participant 1 for both ultradian and meal models.</title>
<p>These PDFs are used to estimate the KL-divergence between the kernel density estimate of measured and model forecasted glucose values. For this patient the PDF generated by the meal model appears to more closely resemble the PDF generated by the measured glucose than the PDF generated by the ultradian model. Importantly, the PDFs of the ultradian and meal models are distinct and different from one another, implying differing physiologic processes and mechanisms present.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.g005" xlink:type="simple"/>
</fig>
<p>The KL-divergence is a measure of the distance between two probability density functions—here the difference between glucose probability density function estimates. Small KL-divergence implies the <italic>graphs</italic> of the two probability density functions are similar, indicating good model estimates. Visual intuition of the KL-divergence can be gleaned from <xref ref-type="fig" rid="pcbi.1005232.g005">Fig 5</xref> that shows the kernel density estimates of the glucose measurements and forecasts for participant 1. Formally, the KL divergence is defined by:
<disp-formula id="pcbi.1005232.e026"><alternatives><graphic id="pcbi.1005232.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005232.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:mi>K</mml:mi> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>,</mml:mo> <mml:mi>q</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>p</mml:mi> <mml:mo form="prefix">log</mml:mo> <mml:mfrac><mml:mi>p</mml:mi> <mml:mi>q</mml:mi></mml:mfrac> <mml:mi>d</mml:mi> <mml:mi>μ</mml:mi></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
where <italic>p</italic> and <italic>q</italic> are probability densities and <italic>μ</italic> is the Lebesgue measure. The KL-divergence between <italic>p</italic> and <italic>q</italic> is interpreted as the information lost when <italic>p</italic> is approximated by <italic>q</italic>. For us, the interpretation becomes more complex because of measurement biases—biases caused by the missing values and the noise associated with them due to the self-monitoring data collection process for an individual with diabetes. Here we compare the kernel density estimates of real, sparse measurements, DA forecasts <italic>restricted to times where there are real glucose measurements</italic>, and continuous DA-based imputation of glucose. The differences between the kernel density estimates for these quantities shown in <xref ref-type="fig" rid="pcbi.1005232.g005">Fig 5</xref> may be nontrivial. Without continuous blood glucose monitoring, the true continuous distribution of glucose is unknown. Nevertheless, combining the information in <xref ref-type="table" rid="pcbi.1005232.t003">Table 3</xref> with what we observe in <xref ref-type="fig" rid="pcbi.1005232.g005">Fig 5</xref> suggests that while the measurements and model outputs all generate a similar mean glucose value, the <italic>graphs of the kernel density estimates are qualitatively different</italic>. Moreover, it does appear that the kernel density estimate of the meal model based forecasts most closely resembles the kernel density estimate of the measured glucose values, while the mean of the ultradian model forecasts is closer to the mean of measured glucose. This highlights why there is not an optimal method for model selection. Contrasting different evaluation metrics, different integrals, allows for a clearer picture of how well the models are performing.</p>
<p>The full summary of the model evaluation shown in <xref ref-type="table" rid="pcbi.1005232.t003">Table 3</xref> presents a consistent vision. For participants 1, 2, 4 and 5 the ultradian model generally matches or outperforms the meal model, except when it comes to the linear correlation between forecast and measurement likely because the ultradian model represents an estimate of the mean. For participant 3, the ultradian model outperforms the meal model. This implies that even in our simplified situation, there is clearly no best model for all patients and model evaluation metrics, although the ultradian model does appear to be the better choice unless estimation of a distributional or linear correlation based quantity is the desired goal. Most importantly, both models perform quite well, implying that any choice have the potential to yield accurate forecasts.</p>
</sec>
<sec id="sec025">
<title>Model averaging—Blending models to achieve a more accurate forecast</title>
<sec id="sec026">
<title>Finding an optimal model average relative to different quality metrics</title>
<p>The first question to ask is what value of <italic>w</italic><sub>1</sub>, when applied uniformly in retrospect to all forecasts, optimizes model evaluation metrics. <xref ref-type="fig" rid="pcbi.1005232.g006">Fig 6</xref> depicts the relationship between the averaging parameter, <italic>w</italic><sub>1</sub>, for ultradian model and meal model output versus mean square error, KL divergence, and linear correlation. All metrics for all patients are optimized (shown by the squares in the plot) by weighting a portion of each model. The optimal weights for MSE and LC are both between 0.5–0.8, favoring a larger proportion of the ultradian model. The KL divergence also shows <italic>local</italic> minima in this range for all patients, although KL also tends to be low for <italic>w</italic><sub>1</sub> = 0 (i.e. meal model forecasts only). These results push three conclusions. First, model averaging, even in relatively simple implementations, can improve forecast accuracy. Second, model averaging re-enforces what we observed in <xref ref-type="table" rid="pcbi.1005232.t003">Table 3</xref>, that choosing an optimal model can depend on the quality metric being optimized. And third, for clinical applications, it will be necessary to carefully choose the quality metric that will most usefully help patients and clinicians make bedside decisions.</p>
<fig id="pcbi.1005232.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Mean square error, KL-divergence, and linear correlation for the entire set of forecasts for each participant was plotted with respect to ultradian model weight.</title>
<p>Boxes represent the points at which each metric is optimized. Note that most optima exist between 0.5–0.8. Both mean square error and linear correlation have single inflection points, whereas KL-divergence takes on many local minima. The presence of optimal weights that are far from both 0 and 1 indicate the potential value of model averaging in this context.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec027">
<title>Model averaging by optimizing a single quality metric</title>
<p>A straight-forward method of picking model weights for a forecasting task is to use the weighting that optimizes a particular metric for all previous forecasts. The efficacy of this approach can be evaluated by looking for improvements not only in the optimized metric, but in other metrics as well. In <xref ref-type="table" rid="pcbi.1005232.t004">Table 4</xref>, we report the MSE, LC, and KL evaluations of forecasts that were generated with model weights that were selected at each forecasting step to optimize one of the three metrics for all past data.</p>
<table-wrap id="pcbi.1005232.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.t004</object-id>
<label>Table 4</label>
<caption>
<title>Model averaging with sequential weight selection, based on mean square error, KL-divergence, and linear correlation, is evaluated for all three performance metrics and compared to the performance of individual models.</title>
<p>Values are bolded to designate the model that performs best under each criterion for each participant. While MSE-based averaging consistently outperformed the individual models, the ideal scheme varies across patients.</p>
</caption>
<alternatives>
<graphic id="pcbi.1005232.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" colspan="5">Evaluation of DA-based model forecast averaging</th>
</tr>
<tr>
<th align="left">Patient</th>
<th align="left">DA/averaging</th>
<th align="left">MSE</th>
<th align="left">LC</th>
<th align="left">KL</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="5" style="border-bottom:thick">P1</td>
<td align="left">Ultradian Model</td>
<td align="left">750</td>
<td align="char" char=".">0.12</td>
<td align="char" char=".">0.55</td>
</tr>
<tr>
<td align="left">Meal Model</td>
<td align="left">1110</td>
<td align="char" char="."><bold>0.24</bold></td>
<td align="char" char=".">1.2</td>
</tr>
<tr>
<td align="left">MSE-based <bold>average</bold></td>
<td align="left"><bold>640</bold></td>
<td align="char" char=".">0.21</td>
<td align="char" char="."><bold>0.25</bold></td>
</tr>
<tr>
<td align="left">LC-based <bold>average</bold></td>
<td align="left">850</td>
<td align="char" char=".">0.23</td>
<td align="char" char=".">2.6</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">KL-based <bold>average</bold></td>
<td align="left" style="border-bottom:thick">810</td>
<td align="char" char="." style="border-bottom:thick">0.18</td>
<td align="char" char="." style="border-bottom:thick">3.2</td>
</tr>
<tr>
<td align="left" rowspan="5" style="border-bottom:thick">P2</td>
<td align="left">Ultradian Model</td>
<td align="left">920</td>
<td align="char" char=".">0.33</td>
<td align="char" char=".">0.72</td>
</tr>
<tr>
<td align="left">Meal Model</td>
<td align="left">1250</td>
<td align="char" char=".">0.31</td>
<td align="char" char=".">0.11</td>
</tr>
<tr>
<td align="left">MSE-based <bold>average</bold></td>
<td align="left"><bold>905</bold></td>
<td align="char" char="."><bold>0.37</bold></td>
<td align="char" char=".">0.75</td>
</tr>
<tr>
<td align="left">LC-based <bold>average</bold></td>
<td align="left">990</td>
<td align="char" char=".">0.36</td>
<td align="char" char=".">0.18</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">KL-based <bold>average</bold></td>
<td align="left" style="border-bottom:thick">960</td>
<td align="char" char="." style="border-bottom:thick"><bold>0.37</bold></td>
<td align="char" char="." style="border-bottom:thick"><bold>0.07</bold></td>
</tr>
<tr>
<td align="left" rowspan="5" style="border-bottom:thick">P3</td>
<td align="left">Ultradian Model</td>
<td align="left">310</td>
<td align="char" char=".">0.1</td>
<td align="char" char=".">3.0</td>
</tr>
<tr>
<td align="left">Meal Model</td>
<td align="left">2100</td>
<td align="char" char=".">-0.47</td>
<td align="char" char="."><bold>1.6</bold></td>
</tr>
<tr>
<td align="left">MSE-based <bold>average</bold></td>
<td align="left">480</td>
<td align="char" char=".">-0.25</td>
<td align="char" char=".">3.3</td>
</tr>
<tr>
<td align="left">LC-based <bold>average</bold></td>
<td align="left"><bold>300</bold></td>
<td align="char" char="."><bold>0.13</bold></td>
<td align="char" char=".">3.1</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">KL-based <bold>average</bold></td>
<td align="left" style="border-bottom:thick">370</td>
<td align="char" char="." style="border-bottom:thick">0.0088</td>
<td align="char" char="." style="border-bottom:thick">3.2</td>
</tr>
<tr>
<td align="left" rowspan="5" style="border-bottom:thick">P4</td>
<td align="left">Ultradian Model</td>
<td align="left">280.6004</td>
<td align="char" char=".">0.3846</td>
<td align="char" char=".">0.6477</td>
</tr>
<tr>
<td align="left">Meal Model</td>
<td align="left">520</td>
<td align="char" char=".">0.36</td>
<td align="char" char="."><bold>0.18</bold></td>
</tr>
<tr>
<td align="left">MSE-based <bold>average</bold></td>
<td align="left"><bold>240</bold></td>
<td align="char" char="."><bold>0.48</bold></td>
<td align="char" char=".">0.29</td>
</tr>
<tr>
<td align="left">LC-based <bold>average</bold></td>
<td align="left">270</td>
<td align="char" char=".">0.46</td>
<td align="char" char=".">0.23</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">KL-based <bold>average</bold></td>
<td align="left" style="border-bottom:thick">360</td>
<td align="char" char="." style="border-bottom:thick">0.39</td>
<td align="char" char="." style="border-bottom:thick">0.49</td>
</tr>
<tr>
<td align="left" rowspan="5">P5</td>
<td align="left">Ultradian Model</td>
<td align="left">280</td>
<td align="char" char=".">0.32</td>
<td align="char" char=".">2.6</td>
</tr>
<tr>
<td align="left">Meal Model</td>
<td align="left">700</td>
<td align="char" char=".">0.3751</td>
<td align="char" char="."><bold>0.18</bold></td>
</tr>
<tr>
<td align="left">MSE-based <bold>average</bold></td>
<td align="left"><bold>260</bold></td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">3.0</td>
</tr>
<tr>
<td align="left">LC-based <bold>average</bold></td>
<td align="left">330</td>
<td align="char" char=".">0.35</td>
<td align="char" char=".">0.95</td>
</tr>
<tr>
<td align="left">KL-based <bold>average</bold></td>
<td align="left">280</td>
<td align="char" char="."><bold>0.44</bold></td>
<td align="char" char=".">0.91</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>In all cases except P3, MSE-based averaging outperformed both models in MSE, and the LC-based averaging forecasts outperformed both models in LC for two of the five patients. <italic>KL-based model averaging underperformed noticeably</italic>, since it produced an inferior KL-divergence when compared with the meal model alone for four of five patients. Moreover, KL-based model average forecasts tended to have higher MSE as compared with other methods.</p>
<p>The results in <xref ref-type="table" rid="pcbi.1005232.t004">Table 4</xref> demonstrate that <italic>the ideal model averaging scheme varies across patients</italic>. Forecasts for P1 were best optimized by an MSE-based average or MSE and KL, whereas forecasts for P3 were best optimized for MSE and LC by the KL-based average. Optimal averaging schemes for P2, P4, and P5 varied more greatly depending on the metrics we wish to optimize. Overall, the MSE-based average seems to be a good choice for everyone except P3, who collected far fewer data points than the other four participants. KL-based averaging achieved high ranking results for P2 and P5, but, interestingly, other methods do a better job of improving the KL divergence.</p>
</sec>
<sec id="sec028">
<title>Time variation in model averaging weights</title>
<p>It is also informative to explore how each of these evaluation-based weighting schemes would function in an applied setting by plotting their efficacy in time, along with the weights selected at each point by each method. This allows us to evaluate <italic>if and when an ideal model averaging metric is knowable</italic>. In <xref ref-type="fig" rid="pcbi.1005232.g007">Fig 7</xref>, we see that for P1, it was beneficial overall to favor ultradian forecasts. When optimizing MSE, the ultradian forecasts proved more valuable, whereas optimizing LC required a more even pairing across models. The performance of model averaging in time for P1 shows that better model averaging methods revealed themselves within 50–100 measurements (MSE-based and LC-based averaging already achieved improved MSE and LC scores after 50 measurements compared to the individual model performance). After 100 measurements, all participants’ forecasts were improved by model averaging methods that, indeed, remained valuable throughout the rest of the patient timeline. In some cases, an additional 50 forecasts were needed to perform an informed model selection across averaging approaches, but most often, the first 100 measurements were sufficient to determine the optimal model selection strategy.</p>
<fig id="pcbi.1005232.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.g007</object-id>
<label>Fig 7</label>
<caption>
<title>The progression of model averaging performance is shown for P1, along with the weights selected by each method at each forecasting step.</title>
<p>MSE-based and LC-based averaging show immediate improvements in their respective quantities, and are able to strike a balance between the high linear correlation of the meal model and the low MSE of the ultradian model. For P1, only the MSE-based average improved long-term KL divergence. In addition, the MSE-based average achieved better error than the ultradian model while nearly doubling the correlation of its forecasts with real measurements. This pattern becomes evident within the first 75 forecasts, demonstrating the feasibility and utility of doing model selection across model averaging modalities.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.g007" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec029">
<title>The impacts of mechanisms and filtering analysis</title>
<p>We have shown that the DA converges given our clinical data constraints, the DA personalizes to an individual, and that averaging models can help produce a better forecast. To demonstrate the impact and necessity of the state and parameter filters and the mechanistic UKF set up as well as comparing the DA to standard non-mechanism-based forecasting machines, we must turn off the various filters and implement different forecasting machinery and observe how the forecasts accuracy changes. <xref ref-type="table" rid="pcbi.1005232.t005">Table 5</xref> shows the mean forecasted glucose and the mean square error and KL-divergence between the measured and the forecast glucose values. This table prompts two comparisons—the DA with different filters included and the dual UKF DA with the GPMR.</p>
<table-wrap id="pcbi.1005232.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.t005</object-id>
<label>Table 5</label>
<caption>
<title>Comparing filters and a non-mechanistic forecasting machine.</title>
<p>The different filter configurations include all filters off, state-only filters and dual (state and parameter) filters enabled. The non-mechanistic forecast is provided by the Gaussian Process Model Regression (GPMR). In all but one case, the dual UKF based on the ultradian model provides the most accurate forecast—although model averaging in <xref ref-type="table" rid="pcbi.1005232.t004">Table 4</xref> provides an even more accurate forecast. While the GPMR does have a potentially useful MSE, it is not as useful for tracking the mean glucose state because it is trained only on glucose measurements surrounding meal times.</p>
</caption>
<alternatives>
<graphic id="pcbi.1005232.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.t005" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" colspan="7">Model and filtering comparison</th>
</tr>
<tr>
<th align="left">Patient</th>
<th align="left">Model</th>
<th align="left">Filter</th>
<th align="left">Mean BG</th>
<th align="left">Forecast mean BG</th>
<th align="left">MSE</th>
<th align="left">KL</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="7" style="border-bottom:thick">P1</td>
<td align="left" rowspan="3">Ultradian</td>
<td align="left">no-filter</td>
<td align="left" rowspan="7">115 ± 15</td>
<td align="left">109 ± 15</td>
<td align="left">770</td>
<td align="char" char=".">0.04</td>
</tr>
<tr>
<td align="left">state filter</td>
<td align="left">108 ± 18</td>
<td align="left">780</td>
<td align="char" char=".">0.29</td>
</tr>
<tr>
<td align="left">dual filter</td>
<td align="left">115 ± 15</td>
<td align="left">680</td>
<td align="char" char=".">0.54</td>
</tr>
<tr>
<td align="left" rowspan="3">Meal</td>
<td align="left">no-filter</td>
<td align="left">109 ± 15</td>
<td align="left">3600</td>
<td align="char" char=".">0.06</td>
</tr>
<tr>
<td align="left">state filter</td>
<td align="left">108 ± 18</td>
<td align="left">2100</td>
<td align="char" char=".">0.19</td>
</tr>
<tr>
<td align="left">dual filter</td>
<td align="left">105 ± 28</td>
<td align="left">730</td>
<td align="char" char=".">1.2</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">GPMR</td>
<td align="left" style="border-bottom:thick"/>
<td align="left" style="border-bottom:thick">130 ± 9</td>
<td align="left" style="border-bottom:thick">630</td>
<td align="char" char="." style="border-bottom:thick">0.30</td>
</tr>
<tr>
<td align="left" rowspan="7" style="border-bottom:thick">P2</td>
<td align="left" rowspan="3">Ultradian</td>
<td align="left">no-filter</td>
<td align="left" rowspan="7">127 ± 32</td>
<td align="left">107 ± 6</td>
<td align="left">1800</td>
<td align="char" char=".">0.14</td>
</tr>
<tr>
<td align="left">state filter</td>
<td align="left">107 ± 8</td>
<td align="left">1800</td>
<td align="char" char=".">0.35</td>
</tr>
<tr>
<td align="left">dual filter</td>
<td align="left">124 ± 12</td>
<td align="left">950</td>
<td align="char" char=".">0.29</td>
</tr>
<tr>
<td align="left" rowspan="3">Meal</td>
<td align="left">no-filter</td>
<td align="left">107 ± 6</td>
<td align="left">1800</td>
<td align="char" char=".">0.07</td>
</tr>
<tr>
<td align="left">state filter</td>
<td align="left">107 ± 9</td>
<td align="left">1700</td>
<td align="char" char=".">0.03</td>
</tr>
<tr>
<td align="left">dual filter</td>
<td align="left">120 ± 26</td>
<td align="left">1300</td>
<td align="char" char=".">0.11</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">GPMR</td>
<td align="left" style="border-bottom:thick"/>
<td align="left" style="border-bottom:thick">140 ± 17</td>
<td align="left" style="border-bottom:thick">1200</td>
<td align="char" char="." style="border-bottom:thick">0.08</td>
</tr>
<tr>
<td align="left" rowspan="7" style="border-bottom:thick">P3</td>
<td align="left" rowspan="3">Ultradian</td>
<td align="left">no-filter</td>
<td align="left" rowspan="7">119 ± 16</td>
<td align="left">107 ± 7</td>
<td align="left">330</td>
<td align="char" char=".">0.36</td>
</tr>
<tr>
<td align="left">state filter</td>
<td align="left">107 ± 7</td>
<td align="left">330</td>
<td align="char" char=".">1.33</td>
</tr>
<tr>
<td align="left">dual filter</td>
<td align="left">115 ± 9</td>
<td align="left">250</td>
<td align="char" char=".">3.9</td>
</tr>
<tr>
<td align="left" rowspan="3">Meal</td>
<td align="left">no-filter</td>
<td align="left">107 ± 7</td>
<td align="left">3500</td>
<td align="char" char=".">2.9</td>
</tr>
<tr>
<td align="left">state filter</td>
<td align="left">107 ± 7</td>
<td align="left">3500</td>
<td align="char" char=".">2.7</td>
</tr>
<tr>
<td align="left">dual filter</td>
<td align="left">126 ± 37</td>
<td align="left">2800</td>
<td align="char" char=".">1.4</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">GPM</td>
<td align="left" style="border-bottom:thick"/>
<td align="left" style="border-bottom:thick">—</td>
<td align="left" style="border-bottom:thick">—</td>
<td align="center" style="border-bottom:thick">—</td>
</tr>
<tr>
<td align="left" rowspan="7" style="border-bottom:thick">P4</td>
<td align="left" rowspan="3">Ultradian</td>
<td align="left">no-filter</td>
<td align="left" rowspan="7">92 ± 17</td>
<td align="left">108 ± 17</td>
<td align="left">640</td>
<td align="char" char=".">0.60</td>
</tr>
<tr>
<td align="left">state filter</td>
<td align="left">108 ± 17</td>
<td align="left">630</td>
<td align="char" char=".">0.97</td>
</tr>
<tr>
<td align="left">dual filter</td>
<td align="left">90 ± 13</td>
<td align="left">260</td>
<td align="char" char=".">0.65</td>
</tr>
<tr>
<td align="left" rowspan="3">Meal</td>
<td align="left">no-filter</td>
<td align="left">108 ± 17</td>
<td align="left">7000</td>
<td align="char" char=".">0.34</td>
</tr>
<tr>
<td align="left">state filter</td>
<td align="left">107 ± 7</td>
<td align="left">5300</td>
<td align="char" char=".">2.1</td>
</tr>
<tr>
<td align="left">dual filter</td>
<td align="left">87 ± 22</td>
<td align="left">540</td>
<td align="char" char=".">1.4</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">GPM</td>
<td align="left" style="border-bottom:thick"/>
<td align="left" style="border-bottom:thick">93 ± 4</td>
<td align="left" style="border-bottom:thick">330</td>
<td align="char" char="." style="border-bottom:thick">0.57</td>
</tr>
<tr>
<td align="left" rowspan="7">P5</td>
<td align="left" rowspan="3">Ultradian</td>
<td align="left">no-filter</td>
<td align="left" rowspan="7">101 ± 16</td>
<td align="left">110 ± 14</td>
<td align="left">500</td>
<td align="char" char=".">0.2</td>
</tr>
<tr>
<td align="left">state filter</td>
<td align="left">110 ± 14</td>
<td align="left">500</td>
<td align="char" char=".">0.27</td>
</tr>
<tr>
<td align="left">dual filter</td>
<td align="left">101 ± 12</td>
<td align="left">280</td>
<td align="char" char=".">2.6</td>
</tr>
<tr>
<td align="left" rowspan="3">Meal</td>
<td align="left">no-filter</td>
<td align="left">110 ± 14</td>
<td align="left">4000</td>
<td align="char" char=".">0.16</td>
</tr>
<tr>
<td align="left">state filter</td>
<td align="left">110 ± 14</td>
<td align="left">2800</td>
<td align="char" char=".">0.14</td>
</tr>
<tr>
<td align="left">dual filter</td>
<td align="left">97 ± 27</td>
<td align="left">590</td>
<td align="char" char=".">0.20</td>
</tr>
<tr>
<td align="left">GPM</td>
<td align="left"/>
<td align="left">110 ± 5</td>
<td align="left">350</td>
<td align="char" char=".">0.17</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>To demonstrate the impacts of the state and parameter filters, we consider three DAs: (i) no-filter—we set the initial glucose and nutrition to be the latest measurement and run it forward to the next measurement; (ii) state-filter—were we run the UKF state filter but not the parameter filter, and (iii) the dual UKF state and parameter filters. In this setting the mean for the state and no-filter is mostly determined by the initial parameter settings because the parameters are not changed. There are four results of note. First, the effects of the different filtering constructions was consistent between models. Second, we did not observe much difference between the state filter and the no-filter DAs. Third, the dual filter, which includes parameter correction, provides a substantial improvement over the no-filter and the state-only filters with respect to the accuracy of the mean and pointwise mean square error. Fourth, the KL-divergence is usually minimized by the no-filter and the state filter, but none of the KL-divergences are particularly large.</p>
<p>Comparing the dual UKF powered by mechanistic models with a non-mechanistic machine is difficult to make completely equitable or unbiased, largely because the natural input and training sets for the two different models are so different. The UKF really track and re-aligns the mechanistic model using whatever data are currently available, substituting model data for any missing data maintaining a continuous-time model of the system where as the GPMR is a regression that takes a full input vector and maps it to an output vector. It is possible that with a continuous glucose monitor data such a comparison between the GPMR and the UKF would be more equitable, but this is not the situation we address in this paper. The dual UKF forecasts were generated as previously discussed. The GPMR forecasts were generated using data for meals restricted to the situation where there is a pre-meal glucose taken within 15 minutes of eating the meal, a post-meal glucose taken within 45–180 minutes of the beginning of the meal—the most recent post-meal glucose is always used as the post-meal glucose—and of course carbohydrate estimates. The GPRM is trained on the first 50 meals and when it encounters a new meal, it makes a forecast based on the pre-meal glucose and carbohydrate estimates, and then that meal is added to the training set. The GPMR can be very sensitive to nonstationarity—participants 1 and 2 in particular—and when it is, the its accuracy is highly sensitive to the training window length. We chose the training and forecasting procedure to minimize the dependence on the training window size. Relative to this construction we have four key results. First, the GPMR generally overestimates the mean glucose by a substantial amount, expect for participant 4. Second, the GPMR has a competitive MSE—is is usually the second lowest compared with the dual UKF using the ultradian model. The KL divergence for the GPMR is low and usually preforms about as well as the no-filter DA, likely because both the processes are Gaussian without too much imposed mechanistic structure. And fourth, if we instead use a fixed window size, unless the meal training window is short—less than 50 meals—the GPMR performs considerably more poorly than any of the dual UKF implementations. We will save more analysis of the GPMR for another time.</p>
</sec>
<sec id="sec030">
<title>Building blocks for a diabetes management intervention</title>
<p>The underlying expectation of this research is that generating accurate predictions of individuals’ glycemic response to particular meals can inform their decision-making and improve their glycemic control. Our final objective, then, is to examine different ways of communicating predictions generated with DA that provide actionable information and convey different degrees of confidence and precision. The natural output of the model is a continuous forecast with a potentially indefinite endpoint, and there exist many different ways to present this information to individuals with diabetes in order to inform their decisions. Previous research suggested that visualizing these projections in a graphical way, as a continuous curve, can lead to improved understanding [<xref ref-type="bibr" rid="pcbi.1005232.ref071">71</xref>]. Another possibility is to condense this continuous forecast into a projected range that communicates to the individual the anticipated glycemic impact of the meal. While traditional static error terms communicate average forecast uncertainty, they do not convey higher-order information (e.g. extreme values, velocity) that are relevant to understanding the case-specific effects of nutrition. Instead, we consider different ways of generating interval predictions that reflect expected fluctuations in blood glucose and have the added benefit of communicating forecast uncertainty. Specifically, we examine three dynamic forecast intervals derived from continuous DA output and characterize them by comparing the magnitude of their bounds with an empirical estimate of the confidence interval they represent.</p>
<p>The left plot of <xref ref-type="fig" rid="pcbi.1005232.g008">Fig 8</xref> shows the last 25 glucose measurements and three model-derived <italic>dynamic</italic> bounds <italic>on a moving window</italic>, ± standard deviation, ± variance, and range (maximum minus minimum) of the continuous ultradian model-based glucose forecast 30–120 minutes after a meal. The right plot shows percentage of measurements captured by those boundaries. Recalling <xref ref-type="fig" rid="pcbi.1005232.g001">Fig 1</xref>, the ultradian model has high amplitude oscillations while the meal model has limited oscillations; this dynamic difference has a profound impact on which model may provide the most useful forecast <italic>boundary</italic>. Generally, the ultradian model forecasts capture a higher percentage of future measurements. The variance is too wide to be useful for any of our participants. The ultradian model range provides a better balance of frequency of accuracy; the dynamic range of ±15–20 capturing 50–60% of future measurements compared to standard deviation of ±15 capturing 40% of future measurements. Here participant 3 is the exception with a standard deviation of ±25 capturing 82% of future measurements. This difference demonstrates the complexity of translating a forecast that is a density into a quantity such as a single number—the ideal range may have to be chosen automatically for a given person. These results are a proof in principle that a plausibly useful forecast range could be created.</p>
<fig id="pcbi.1005232.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005232.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Practical forecast accuracy of DA forecasts can be captured by calculating the percentage of measurements that are contained within glucose forecast-derived forecast ranges.</title>
<p>Here we consider three such ranges, standard deviation, variance, and range of the glucose forecast 30–120 minutes after a given meal. The <italic>left plot</italic> shows the last 25 glucose measurements of participant 1 and a moving window of the ultradian model-based off-data forecast ranges. From this we can see how the windowed forecast ranges predict the glucose value: the variance is too wide to be useful but contains all measurements, and the range encapsulates proportionally more measurements as the <italic>more narrow standard deviation</italic>. The <italic>right plot</italic> shows the percentage of post meal measurements captures versus with width of the boundary window.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.g008" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec031" sec-type="conclusions">
<title>Discussion</title>
<p>The broad goal of this research is to develop new ways to forecast postprandial blood glucose levels given an individual’s preprandial blood glucose level and nutritional composition of a meal, particularly amount of carbohydrates. To achieve this goal we developed a DA and integrated it with two mechanistic endocrine models, a model averaging methodology, and a dynamical Gaussian process model regression, largely for comparison purposes. We can observe the DA <italic>personalizing</italic> the models by estimating model parameters for individuals in real-time with as few as 50 glucose measurements. We then formulated model selection to choose the right model for the individual in a way that is generalizable and allows for inclusion of additional models if necessary. Similarly, we constructed a model averaging methodology to demonstrate that more accurate predictions can be achieved by averaging models. Our reasons for selecting a <italic>DA framework</italic> were that it allows for incorporation of systems physiology knowledge into the forecast to reduce reliance on dense historical data, and to generate reliable predictions based on sparse data, consistent with existing self-monitoring guidelines and practices, typically available to individuals with diabetes.</p>
<p>We then tested the proposed models using data collected by three individuals with diabetes and two without diabetes. These datasets were selected because they illustrated different self-monitoring scenarios, had different unique properties, and allowed us to test the models under different sets of constraints. In our study, the DA: <italic>(i)</italic> estimated the data well in real time according to standard model evaluation metrics; <italic>(ii)</italic> produced forecasts that compared favorably with the forecasts of certified diabetes educators whose judgment the gold standard for devising personalized nutritional recommendations for individuals with diabetes and represents the best available human-based glucose forecasting; <italic>(iii)</italic> personalized the model to an individual and adapted as the individual changed, providing a personalized medicine approach to diabetes treatment; <italic>(iv)</italic> was integrated with model selection machinery that differentiated model types according to how they estimated the data, allowing a best model to be chosen; <italic>(v)</italic> preformed well given realistic self-monitoring data quality; <italic>(vi)</italic> had accurate output at a high enough frequency, potentially forming the basis for a self-management intervention, and <italic>(vii)</italic> could be averaged in real time to produce even more accurate forecasts.</p>
<p>An ability to accurately forecast postprandial glucose levels has a number of important clinical implications. There exists a considerable body of evidence showing that postprandial hyperglycemia contributes substantially to cardiovascular risks and other complications of diabetes [<xref ref-type="bibr" rid="pcbi.1005232.ref072">72</xref>], [<xref ref-type="bibr" rid="pcbi.1005232.ref073">73</xref>]. Previous research argued that an ability to generate accurate predictions of postprandial blood glucose can enable personalized self-management interventions, for example personalized meal planning [<xref ref-type="bibr" rid="pcbi.1005232.ref031">31</xref>]. We propose that the computational machinery described here could be applied more directly to display glucose forecasts to individuals in order to inform their nutritional choices. Yet communicating predictions with a degree of uncertainty in a useful way is non-trivial, as is evidenced from the extensive research on communicating weather forecasts [<xref ref-type="bibr" rid="pcbi.1005232.ref074">74</xref>]. In the context of health and health management, the research on communicating risks and uncertainties has primarily focused on informing significant, potentially life-changing decisions, such as surgery, rather than such mundane common decisions as daily meal choices [<xref ref-type="bibr" rid="pcbi.1005232.ref075">75</xref>]. Moreover, generating glucose forecasts in real time requires accurate macronutrient assessment of meals. Previous research has suggested leveraging crowdsourcing communities for generating timely and accurate nutritional assessments of meals based on these meals’ photographs [<xref ref-type="bibr" rid="pcbi.1005232.ref076">76</xref>]. Still, more research is needed to identify ways to implement DA-based forecasting to facilitate nutritional decision-making in real-world settings.</p>
<p>Originally designed to guide satellites, control chemical plants and electrical grids, and forecast weather, DA has mostly been applied to <italic>data-rich</italic> situations outside of biomedicine. Inside the biomedical context, DA and control are used in pacemakers, to treat cancer, and to treat patients with type 1 diabetes. The unique advantage of DA is that it infuses data with human knowledge, thus allowing the model to quickly adapt to environmental changes, cope with highly nonlinear systems, and confront forecasting problems, all while <italic>reducing reliance on data in real time</italic>. This is particularly important for such complex multi-dimensional systems as the human endocrine system and blood glucose regulation. Previous research already established feasibility of using machine learning for forecasting individuals’ postprandial blood glucose levels based on nutrition, physical activity, and sleep, while incorporating individuals’ personal clinical and microbiome profiles [<xref ref-type="bibr" rid="pcbi.1005232.ref031">31</xref>]. Moreover, this work showed that such predictions could be used to inform personalized nutritional interventions. However, because the traditional machine learning approaches do not incorporate knowledge of human physiology, they require massive amounts of relatively clean data that, in the case of diabetes, can only be generated with continuous glucose monitoring. Yet continuous glucose monitoring is not a recommended practice for the vast majority of individuals with diabetes, who continue to rely on infrequent blood glucose measures taken with commercial blood glucose meters. The DA approach is uniquely positioned to reduce the need for data and provide a viable solution with a high translational potential.</p>
<p>The DA methodology can also be used to demonstrate the difficulty of the problem-solving task facing individuals with type 2 diabetes. For the individuals without type 2 diabetes, the point-wise accuracy of the DA forecasts quickly converged to approximately the error present in the glucose measurements—a MSE of 250 translates to about 15 mg/dl of accuracy. In contrast, the point-wise predictive accuracy of the glucose forecasts for the participants with type 2 diabetes was on the order of 500—approximately 22 mg/dl—for both the diabetes educators and the DA. This implies that people with type 2 diabetes seem to face a more difficult glycemic impact prediction task than people who do not have type 2 diabetes, as is reflected in both the diabetes educators and the DA’s ability accurately forecast glucose.</p>
<p>Reaching beyond the direct clinical translation, the DA approach has the potential to forge a deeper understanding of physiology due to its dependency on mechanistic physiology for generating forecasts. The DA allows the ability to exchange and evaluate different mechanistic models with different mechanistic features and observe how adding or subtracting mechanistic components affects forecasts and inferences. In this way the DA enables causal analysis because it allows researchers to <italic>perturb the system</italic> that generates the observable data in time and observe the effects—in other words, perturb the mapping between the mechanistic models that govern the glucose-insulin dynamics [<xref ref-type="bibr" rid="pcbi.1005232.ref077">77</xref>]. The potential of such causal and comparative analysis is apparent when observing the differences in the forecasts shown in <xref ref-type="fig" rid="pcbi.1005232.g005">Fig 5</xref> and <xref ref-type="table" rid="pcbi.1005232.t003">Table 3</xref>. Higher frequency measurements would enable further probing of what physiologic mechanisms are the most important drivers of glucose dynamics. Exchanging different mechanistic engines in the context of DA can promote a better understanding of the mechanisms of the generating process; this goal motivates several data-science challenges. Because forecasts can depend on the DA implementation, there is a need to evaluate the forecasting ability of different DAs. In addition, there is a need for a systematic methodology for relating models with different parameters and mechanisms to one another; if one model with few parameters is a subset of a larger model class, comparing the two only accomplishes a dimensionality reduction of parameter space, and does not probe fundamentally different physiology. Moreover, there is a need for an efficient means of choosing which model parameters to estimate. Finally, there is a need for efficient and accurate methods for patient-specific, real-time optimization of important DA hyper-parameters, such as assumed measurement and process noise.</p>
<p>By design, we restricted our data set to five differently measured, distinct individuals who were all measured relatively sparsely to delve deeply into how DA performs in a practical, patient-level diabetes setting, but this approach has limitations. We could not perform a population-scale analysis, nor could we evaluate which model best reproduced postprandial continuous glucose <italic>dynamics</italic>, as was done with machine learning models in [<xref ref-type="bibr" rid="pcbi.1005232.ref031">31</xref>]. Nevertheless, we were able to show some boundaries for useful prediction and convergence (about 50 glucose measurements combined with recorded carbohydrates), and we were able to demonstrate how the knowledge embedded in the DA can make up for poor data conditions. Similarly, while the use of a mechanistic model and DA potentially requires substantially less data to achieve an accurate forecast, this choice narrows the ability to fit data and could exclude a good solution if the model cannot represent the physiology of the individual. The fact that forecasts for each individual converged to different levels of error is evidence of these person-specific model errors. Moreover, P3, P4, and P5 converged to mean error rates similar to the error of the glucometers used to make measurements (mean absolute forecast errors were under 15%, which is the maximum error tolerance permitted for most commercially available glucometers).</p>
<sec id="sec032">
<title>Our vision for the use of data assimilation in clinical and biological contexts</title>
<sec id="sec033">
<title>Alternative methods of parameter estimation</title>
<p>In this paper we chose to use a dual UKF parameter filter to estimate parameters. We made this choice because the UKF has been shown to work well in online situations with minimal tinkering. We could have similarly chosen an Ensemble Kalman Filter [<xref ref-type="bibr" rid="pcbi.1005232.ref078">78</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref079">79</xref>] or a Particle Filter [<xref ref-type="bibr" rid="pcbi.1005232.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005232.ref079">79</xref>] and those filters would likely work well. It would be useful to compare different filtering techniques, but to do so would require optimizing the filters, a task we purposely did not do because we are focused on applying the filter to a large population soon in a way that can scale large populations. It is likely that there is some space for improvement of parameter estimation using sophisticated methods, such as Markov Chain Monte Carlo methods [<xref ref-type="bibr" rid="pcbi.1005232.ref055">55</xref>] (MCMC), offline to provide better starting and intermittent parameter estimates.</p>
</sec>
<sec id="sec034">
<title>Optimizing parameters, hyperparameters, and properties</title>
<p>The goal of this paper is a proof in principle that we could create an online model-based forecasting machine for predicting glucose for people with type 2 diabetes that is practically scalable to a large population. By doing this we ignored first principles parameter selection, hyperparameter optimization, and general tweaking of the models or DA. This means that there is a lot of space for improvement for all the methods and models. Selecting more useful mechanistic model parameters would improve model and forecasting accuracy. Similarly, adapting noise-related parameters in real time, e.g., <italic>R</italic> and <italic>Q</italic>, or parameters that are sensitive to measurement frequency would likely increase forecast performance. Nearly every UKF hyperparameter could potentially be optimized and many would result in forecast accuracy improvements. The same is true for the non-mechanistic machinery. With the GPMR, for example, it is clear that the training window must be optimized in real-time to make this machine adaptable and useful in real world situations. There is much space remaining for further innovation.</p>
</sec>
<sec id="sec035">
<title>Mechanistic model averaging</title>
<p>We demonstrated that it is possible to average models to get a more accurate forecast. We have three comments regarding these results. First, there do exist many different mechanistic glucose-insulin models—for a comprehensive list of linear, nonlinear, and comprehensive models, cf chapter 4 of [<xref ref-type="bibr" rid="pcbi.1005232.ref008">8</xref>]—therefore it would be relatively easy to add more models to potentially achieve an ever more accurate glucose forecast. Second, we used elementary model averaging machinery. It is easy to imagine using a Bayesian framework for averaging models and their output that would produce improved results, especially when the number of models is increased and may include non-mechanistic models. Third, from the perspective of biological fidelity, it maybe be possible to reduce model error by adding biologically orthogonal models, models that contain weakly interacting mechanisms, or models that operate on different time-scales. We suspect that such an effect is the reason why model averaging worked so well our construction. Specifically, the ultradian model dynamics are on a fast time scale—oscillations on the order of minutes—whereas the meal model tends to capture slower speed dynamics and usually misses the faster oscillatory dynamics. Because of this—in the Fourier-frequency coordinate system sense of breaking the signals down into amplitudes and frequencies of sinusoid functions—these two models are somewhat orthogonal in frequency space. In this way, by averaging in this setting we may be both decreasing model and forecast error; such may not always be the case. Further investigation of this interesting hypothesis will have to wait for another paper.</p>
</sec>
<sec id="sec036">
<title>Mechanistic model comparison</title>
<p>It is very difficult to quantify or compare either model’s biological fidelity with the restricted data set we use in this paper—we cannot and do not intend to claim superiority of either model in any objective sense. Similarly, given the limited, clinically realistic data set and complex parameter space where some of the parameters have codependencies, we assume we cannot claim to have achieved a globally optimal model estimate—and such an estimate was not the goal of this paper. The models powering the DA are not general purpose models but mechanistic models with specific physiological constraints. Having more parameters does not translate to complete freedom—in fact, the interrelationships between the parameters of the models are not well understood and can cause obvious problems with parameter estimation. For example, we know that there are parameters we can add to the set being estimated for both models that will, given the data we have, make the MSE forecasts worse and visa versa. Checking all parameter combinations is, especially in real time, hopelessly out of our computational reach. In general, selecting an optimal set of parameters to estimate is a very difficult task—this is why did made our selections based on biological insight constrained by a clinical task. Finally, the models were designed for different purposes, and are, in some sense, orthogonal—we see the shadow of this in the model averaging results where adding the models together made a better forecast implying some degree of independence of the models. We can claim that, relative to a given evaluation metric, particular data set, subset of parameters being estimated, and initial conditions for those parameters, one model can out perform another. This conclusion is supported by Tables <xref ref-type="table" rid="pcbi.1005232.t003">3</xref>–<xref ref-type="table" rid="pcbi.1005232.t005">5</xref>, and even for different metrics, the metrics sometimes conflict as to which model is the most accurate—model selection is evaluation-metric-dependent.</p>
</sec>
<sec id="sec037">
<title>Phenotyping and understanding disease progression</title>
<p>A very natural goal using DA and mechanistic modeling is to compute an endocrine-related phenotype defined by the model parameters—doing this and linking it to a genome-wide or phenome-wide association study may help identify diabetes subtypes, help predict onset of type 2 diabetes, and deepen our physiologic understanding of diabetes. While much work has been done in predicting diabetes onset in at-risk adult populations, longer prediction horizons (i.e. identifying latent susceptibilities in young children) would be of exceptional clinical and biological import due to the opportunities for meaningful interventions and the enhanced understanding of long-term endocrine dynamics. Understanding the mechanics of the transition into type 2 diabetes, whether it is simply a smooth change of state or a bifurcation with or without hysteresis, is a different story entirely, but such an understanding requires a strong belief in the biological fidelity of the models. At the heart of this and the phenotyping problem lies the task of addressing model error—or forging an argument that the model and all its parameters do represent the real physiologic processes. To attain adequate biological fidelity, we would likely need to fit all model parameters, control for uncertainty in the parameter estimates, provide external validation, and have mechanistic explanations for the parameter estimates. This task requires more data than is used in this paper because, at the very least, it would require external information—e.g., markers for other physiologic processes such as liver and kidney function—and doing so was neither the goal of, nor within the scope of, this paper.</p>
</sec>
<sec id="sec038">
<title>Model error</title>
<p>We have shown that the models personalize to individuals, and there are hints that they do so according to real physiology. We have even seen that Ultradian model error rates for P3, P4, and P5 approach the levels of glucose meter accuracy. Nevertheless, there are obvious limitations to the models implemented—they do not explicitly model many processes known to influence the glucose-insulin system, including stress, exercise, and sleep. Moreover, current models of the glucose-insulin system parameterize nutrition only in terms of carbohydrates, and do not consider the impact of other macronutrients, like protein, fiber, and fat. We have already seen evidence for protein, fiber, and fat-based model errors by identifying significant correlations between forecasting errors and non-carbohydrate meal content. While model improvement is an essential part of accounting for these errors and improving biological fidelity, there also exist opportunites in both machine learning and data assimilation for real-time error correction.</p>
</sec>
<sec id="sec039">
<title>Realism and clinical data</title>
<p>Self-monitoring among people with type 2 diabetes is a personal process that has great variability depending on the disease state, personality, and socio-economic status. The data of participants 1 and 2 in this paper represents a realistic best-case well measured patient with type 2 diabetes. A more common data type might be the data of participant 3 who has sparse measurements—sometimes a measurement a day, sometimes a measurement a week, and sometimes several measurements a day. Currently we do not know the bounds of what patients are willing to self-monitor and we do not know the most effective data measurement frequency for powering the DAs. It is clear that machine learning is difficult to use in this context—we could not use participant 3’s data to estimate the GPMR for example because there were not enough data that satisfied the data constraints of the GPMR. We knew about this problem in advance which is why we choose to leverage the physiologic knowledge and online estimation capacity of data assimilation. While it may be tempting to use simulated data to find the optimal measurement frequency or pattern, the problem with using simulated data in this setting is twofold. First, patients do not measure randomly. And second, the real processes driving the physiology are nonstationary and may lie outside what the models typically include—e.g., behaviors such as exercise levels.</p>
</sec>
<sec id="sec040">
<title>Filter sensitivity</title>
<p>The results we present in this work are specific to the UKF construction outlined in detail in the appendix. It is important to understand that we can perturb the filtering scheme and get different results; e.g., we know of several filter characteristics we can change that flip which model performs better according to the MSE. We choose the filtering construction not to necessarily optimize the MSE for all people or models, but as a balance between robustness to different people against goodness of fit. But, this brings up two problems that we have attempted to solve by hand but would be valuable problems to solve in a more general setting with a more firm theoretical foundation: robustness of the filter to perturbations of the filter and optimal filtering choice. We do not have good answers for either of these questions from either an analytical or computational framework, but the paper provides clear practical motivation for solving those problems.</p>
</sec>
<sec id="sec041">
<title>Nutrition sensitivity</title>
<p>Nutrition is the first order driver of glucose and insulin dynamics. In our study, we established a protocol for nutritionists to follow when estimating the nutritional content of meals and multiple nutritionists estimated meal content for every participant. It is assumed that there is some noise and some bias in the nutritional estimates of the nutritionists, but we do not have a good understanding of the filter sensitivity to nutritionist-generated noise, noise that could be systematic. We did have, in some cases, multiple nutritionists provide nutrition estimates for the same meals and observed a consistency across nutritionists, but if this machinery is made high-throughput, understanding the sensitivity of the filters to nutrition estimates will be important.</p>
</sec>
</sec>
<sec id="sec042">
<title>Conclusion</title>
<p>We found that the DA estimated future glucose in a personalized way and showed via model selection that different models have unique advantages, depending on the task (prediction, inference, etc.) and the data source (i.e. patient). There exist certain lower-bounds on data quality for DA-based forecasting, but found these constraints to be mild relative to typical self-management expectations. Overall, we believe that DA-based forecasting is accurate enough, frequently enough to form the basis for a self-management intervention.</p>
</sec>
</sec>
<sec id="sec043">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005232.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Dual unscented Kalman filter.</title>
<p>(TEX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005232.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.s002" xlink:type="simple">
<label>S2 Appendix</label>
<caption>
<title>Ultradian endocrine model.</title>
<p>(TEX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005232.s003" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005232.s003" xlink:type="simple">
<label>S3 Appendix</label>
<caption>
<title>Meal endocrine model.</title>
<p>(TEX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005232.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Law</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Stuart</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zygalakis</surname> <given-names>K</given-names></name>. <source>Data assimilation</source>. <publisher-name>Springer</publisher-name>; <year>2015</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref002">
<label>2</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Jazwinski</surname> <given-names>A</given-names></name>. <source>Stochastic processes and Filtering Theory</source>. <publisher-name>Dover</publisher-name>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lorenc</surname> <given-names>A</given-names></name>. <article-title>Analysis methods for numerical weather prediction</article-title>. <source>Q J R Meterol Soc</source>. <year>1988</year>;<volume>112</volume>:<fpage>1177</fpage>–<lpage>1194</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/qj.49711247414" xlink:type="simple">10.1002/qj.49711247414</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref004">
<label>4</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Daley</surname> <given-names>R</given-names></name>. <source>Atmospheric data analysis</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>1991</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref005">
<label>5</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ristic</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Arulampalam</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gordon</surname> <given-names>N</given-names></name>. <source>Beyond the Kalman filter: particle filters for tracking and applications</source>. <publisher-name>Artech house</publisher-name>; <year>2004</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref006">
<label>6</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Haug</surname> <given-names>A</given-names></name>. <source>Baysian estimation and tracking</source>. <publisher-name>Wiley</publisher-name>; <year>2012</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref007">
<label>7</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Candy</surname> <given-names>J</given-names></name>. <source>Bayesian signal processing: classical, modern, and particle filtering methods</source>. <publisher-name>Wiley</publisher-name>; <year>2009</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref008">
<label>8</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Chee</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Fernando</surname> <given-names>T</given-names></name>. <source>Closed-loop control of blood glucose</source>. <publisher-name>Springer</publisher-name>; <year>2007</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mirowski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mower</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Watkins</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Gott</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Schauble</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Termination of Malignant Ventricular Arrhythmias with an Implanted Automatic Defibrillator in Human Beings</article-title>. <source>New England Journal of Medicine</source>. <year>1980</year>;<volume>303</volume>:<fpage>322</fpage>–<lpage>324</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1056/NEJM198008073030607" xlink:type="simple">10.1056/NEJM198008073030607</ext-link></comment> <object-id pub-id-type="pmid">6991948</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref010">
<label>10</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Glass</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Courtemanche</surname> <given-names>M</given-names></name>. <chapter-title>Control of atrial fibrillation: A theoretical perspective</chapter-title>. In: <name name-style="western"><surname>Ovsyshcher</surname> <given-names>I</given-names></name>, editor. <source>Cardiac Arrhythmias and Device Therapy: Results and Perspectives for the New Century</source>. <publisher-name>Futura</publisher-name>; <year>2000</year>. p. <fpage>87</fpage>–<lpage>94</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Christini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Glass</surname> <given-names>L</given-names></name>. <article-title>Mapping and control of complex cardiac arrhythmias</article-title>. <source>Chaos</source>. <year>2002</year>;<volume>12</volume>:<fpage>732</fpage>–<lpage>739</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.1504061" xlink:type="simple">10.1063/1.1504061</ext-link></comment> <object-id pub-id-type="pmid">12779601</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref012">
<label>12</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Christini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Glass</surname> <given-names>L</given-names></name>. <chapter-title>Controlling cardiac arrhythmias: The relevance of nonlinear dynamics</chapter-title>. In: <name name-style="western"><surname>Moss</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gielen</surname> <given-names>S</given-names></name>, editors. <source>Handbook of Biological Physics, Volume 4: Neuro-informatics, Neural Modelling</source>. <publisher-name>Elsevier</publisher-name>; <year>2000</year>. p. <fpage>205</fpage>–<lpage>227</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hall</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Christini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tremblay</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Glass</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Billette</surname> <given-names>J</given-names></name>. <article-title>Dynamic control of cardiac alternans</article-title>. <source>Physical Review Letters</source>. <year>1997</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.78.4518" xlink:type="simple">10.1103/PhysRevLett.78.4518</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hirata</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>de Bernardo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bruchovsky</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Aihara</surname> <given-names>K</given-names></name>. <article-title>Hybrid optimal scheduling for intermittent androgen suppression of prostate cancer</article-title>. <source>CHAOS</source>. <year>2010</year>;<volume>20</volume>:<fpage>0451251</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.3526968" xlink:type="simple">10.1063/1.3526968</ext-link></comment> <object-id pub-id-type="pmid">21198137</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dukic</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Lopes</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Polson</surname> <given-names>N</given-names></name>. <article-title>Tracking Epidemics With Google Flu Trends Data and a State-Space SEIR Model</article-title>. <source>Journal of the American Statistical Association</source>. <year>2012</year>;<volume>107</volume>:<fpage>1410</fpage>–<lpage>1426</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.2012.713876" xlink:type="simple">10.1080/01621459.2012.713876</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thabit</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Tauschman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Allen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Leelarathna</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Hartnell</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wilinska</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Home Use of an Artificial Beta Cell in Type 1 Diabetes</article-title>. <source>New England Journal of Medicine</source>. <year>2015</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1056/NEJMoa1509351" xlink:type="simple">10.1056/NEJMoa1509351</ext-link></comment> <object-id pub-id-type="pmid">26379095</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>P</surname> <given-names>PB</given-names></name>, <name name-style="western"><surname>Orsini</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>MBenedetti</surname> <given-names>M</given-names></name>. <article-title>The artificial pancreas</article-title>. <source>Artif Cells Blood Substit Immobil Biotechnol</source>. <year>2003</year>;<volume>2</volume>:<fpage>127</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fabietti</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Canonico</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Orsini-Federici</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sarti</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Massi-Benedetti</surname> <given-names>M</given-names></name>. <article-title>Clinical validation of a new control-oriented model of insulin and glucose dynamics in subjects with type 1 diabetes</article-title>. <source>Diabetes Technol Ther</source>. <year>2007</year>;<volume>4</volume>:<fpage>327</fpage>–<lpage>338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/dia.2006.0030" xlink:type="simple">10.1089/dia.2006.0030</ext-link></comment> <object-id pub-id-type="pmid">17705688</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kovatchev</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Breton</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Man</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cobelli</surname> <given-names>C</given-names></name>. <article-title>In Silico preclinical trials: a proof of concept in closed-loop control of type 1 diabetes</article-title>. <source>J Diabetes Sci Technol</source>. <year>2009</year>;<volume>3</volume>:<fpage>44</fpage>–<lpage>55</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1177/193229680900300106" xlink:type="simple">10.1177/193229680900300106</ext-link></comment> <object-id pub-id-type="pmid">19444330</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fabietti</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Canonico</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Federici</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Benedetti</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sart</surname> <given-names>E</given-names></name>. <article-title>Control oriented model of insulin and glucose dynamics in type 1 diabetics</article-title>. <source>Med Biol Eng Comput</source>. <year>2006</year>;<volume>44</volume>:<fpage>69</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11517-005-0012-2" xlink:type="simple">10.1007/s11517-005-0012-2</ext-link></comment> <object-id pub-id-type="pmid">16929923</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref021">
<label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">for disease control C, prevention. National diabetes statistics report: estimates of diabetes and its burden in the United States. US Department of Health and Human Services; 2014.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ismal-Beigi</surname> <given-names>F</given-names></name>. <article-title>Glycemic management of Type 2 Diabettes Mellitus</article-title>. <source>NEJM</source>. <year>2012</year>;<volume>366</volume>:<fpage>1319</fpage>–<lpage>1327</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1056/NEJMcp1013127" xlink:type="simple">10.1056/NEJMcp1013127</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nathan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kuenen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Borg</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zheng</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Schoenfeld</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Heine</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Translating the A1C assay into estimated average glucose values</article-title>. <source>Diabetes Care</source>. <year>2008</year>;<volume>31</volume>:<fpage>1473</fpage>–<lpage>1478</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2337/dc08-0545" xlink:type="simple">10.2337/dc08-0545</ext-link></comment> <object-id pub-id-type="pmid">18540046</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerstein</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Byington</surname> <given-names>R</given-names></name>. <article-title>Effects of intensive glucose lowering in type 2 diabetes</article-title>. <source>NEJM</source>. <year>2008</year>;<volume>358</volume>:<fpage>2545</fpage>–<lpage>2559</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1056/NEJMoa0802743" xlink:type="simple">10.1056/NEJMoa0802743</ext-link></comment> <object-id pub-id-type="pmid">18539917</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nathan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Buse</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Davidson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Holman</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sherwin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zinman</surname> <given-names>B</given-names></name>. <article-title>Medical management of hyperglycemia in type 2 diabetes: a consensus algorithm for the initiation and adjustment of therapy: a consensus statement of the American Diabetes Association and the European Association for the Study of Diabete</article-title>. <source>Diabetes Care</source>. <year>2009</year>;<volume>32</volume>:<fpage>193</fpage>–<lpage>203</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2337/dc08-9025" xlink:type="simple">10.2337/dc08-9025</ext-link></comment> <object-id pub-id-type="pmid">18945920</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Handelsman</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Mechanick</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Blonde</surname> <given-names>L</given-names></name>. <article-title>American Association of Clinical Endocrinologists medical guidelines for clinical practice for developing a diabetes mellitus comprehensive care plan: executive summary</article-title>. <source>Endocr Pract</source>. <year>2011</year>;<volume>17</volume>:<fpage>287</fpage>–<lpage>302</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4158/EP.17.2.287" xlink:type="simple">10.4158/EP.17.2.287</ext-link></comment> <object-id pub-id-type="pmid">21474421</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Martin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Heinemann</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lodwig</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Kurth</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Kolb</surname> <given-names>H</given-names></name>. <article-title>Self-monitoring of blood glucose in type 2 diabetes and long-term outcome: an epidemiological cohort study</article-title>. <source>Diabetologia</source>. <year>2006</year>;<volume>49</volume>:<fpage>271</fpage>–<lpage>278</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00125-005-0083-5" xlink:type="simple">10.1007/s00125-005-0083-5</ext-link></comment> <object-id pub-id-type="pmid">16362814</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Kane</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bunting</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Copeland</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Coates</surname> <given-names>V</given-names></name>. <article-title>Efficacy of self monitoring of blood glucose in patients with newly diagnosed type 2 diabetes (ESMON study): randomised controlled trial</article-title>. <source>BMJ</source>. <year>2008</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1136/bmj.39534.571644.BE" xlink:type="simple">10.1136/bmj.39534.571644.BE</ext-link></comment> <object-id pub-id-type="pmid">18420662</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Welschen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Bloemendal</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Nijpels</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Dekker</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Heine</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Stalman</surname> <given-names>W</given-names></name>. <article-title>Self-Monitoring of Blood Glucose in Patients With Type 2 Diabetes Who Are Not Using Insulin A systematic review</article-title>. <source>Diabetes Care</source>. <year>2005</year>;<volume>28</volume>:<fpage>1510</fpage>–<lpage>1517</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2337/diacare.28.6.1510" xlink:type="simple">10.2337/diacare.28.6.1510</ext-link></comment> <object-id pub-id-type="pmid">15920083</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>ADA</collab>. <article-title>Standards of Medical Care in Diabetes—2015</article-title>. <source>Diabetes Care</source>. <year>2015</year>;<volume>38</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zeevi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Korem</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Zmora</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Israeli</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rothschild</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Weinberger</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Personalized Nutrition by Prediction of Glycemic Responses</article-title>. <source>Cell</source>. <year>2015</year>;<volume>163</volume>:<fpage>1079</fpage>–<lpage>1094</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2015.11.001" xlink:type="simple">10.1016/j.cell.2015.11.001</ext-link></comment> <object-id pub-id-type="pmid">26590418</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mamykina</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Davidson</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Smaldone</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Elhadad</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Albers</surname> <given-names>D</given-names></name>. <article-title>Reasoning about Personally Generated Nutritional Data in Diabetes with Information Technologies</article-title>. <source>J Am Med Inform Asso</source>. <year>2015</year> in press;.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Association</surname> <given-names>AD</given-names></name>. <collab>American Diabetes Association</collab>. <article-title>Standards of medical care in diabetes</article-title>. <source>Diabetes Care</source>. <year>2014</year>;<volume>37</volume>:<fpage>S14</fpage>–<lpage>S80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2337/dc14-S014" xlink:type="simple">10.2337/dc14-S014</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hripcsak</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Albers</surname> <given-names>D</given-names></name>. <article-title>Next-generation phenotyping of electronic health records</article-title>. <source>JAMIA</source>. <year>2012</year>;<volume>10</volume>:<fpage>1</fpage>–<lpage>5</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref035">
<label>35</label>
<mixed-citation publication-type="other" xlink:type="simple">Marmarelis V, Mitsis G, editors. Data-driven Modeling for Diabetes. Lecture Notes in Bioengineering. Berlin, Heidelberg: Springer Berlin Heidelberg; 2014. Available from: <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/10.1007/978-3-642-54464-4" xlink:type="simple">http://link.springer.com/10.1007/978-3-642-54464-4</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref036">
<label>36</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>I</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>C</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>I</surname> <given-names>D</given-names></name>. <chapter-title>Glucose Prediction in Type 1 and Type 2 Diabetic Patients Using Data Driven Techniques</chapter-title>. In: <name name-style="western"><surname>Funatsu</surname> <given-names>K</given-names></name>, editor. <source>Knowledge-Oriented Applications in Data Mining</source>. <publisher-name>InTech</publisher-name>; <year>2011</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sudharsan</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Peeples</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Shomali</surname> <given-names>M</given-names></name>. <article-title>Hypoglycemia Prediction Using Machine Learning Models for Patients With Type 2 Diabetes</article-title>. <source>J Diabetes Sci Technol</source>. <year>2015</year>;<volume>9</volume>(<issue>1</issue>):<fpage>86</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1177/1932296814554260" xlink:type="simple">10.1177/1932296814554260</ext-link></comment> <object-id pub-id-type="pmid">25316712</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Murata</surname> <given-names>GH</given-names></name>, <name name-style="western"><surname>Hoffman</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Shah</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Wendel</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Duckworth</surname> <given-names>WC</given-names></name>. <article-title>A probabilistic model for predicting hypoglycemia in type 2 diabetes mellitus: The diabetes outcomes in veterans study (doves)</article-title>. <source>Arch Intern Med</source>. <year>2004</year>;<volume>164</volume>(<issue>13</issue>):<fpage>1445</fpage>–<lpage>1450</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1001/archinte.164.13.1445" xlink:type="simple">10.1001/archinte.164.13.1445</ext-link></comment> <object-id pub-id-type="pmid">15249354</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gibson</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Colberg</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Poirier</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Vancea</surname> <given-names>DMM</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Marcus</surname> <given-names>R</given-names></name>. <article-title>Development and validation of a predictive model of acute glucose response to exercise in individuals with type 2 diabetes</article-title>. <source>Diabetol Metab Syndr</source>. <year>2013</year>;<volume>5</volume>:<fpage>33</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1758-5996-5-33" xlink:type="simple">10.1186/1758-5996-5-33</ext-link></comment> <object-id pub-id-type="pmid">23816355</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rollins</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Bhandari</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Kleinedler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kotz</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Strohbehn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Boland</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Free-living inferential modeling of blood glucose level using only noninvasive inputs</article-title>. <source>Journal of Process Control</source>. <year>2010</year>;<volume>20</volume>(<issue>1</issue>):<fpage>95</fpage>–<lpage>107</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jprocont.2009.09.008" xlink:type="simple">10.1016/j.jprocont.2009.09.008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Beverlin</surname> <given-names>LP</given-names></name>, <name name-style="western"><surname>Rollins</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Vyas</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Andre</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Beverlin</surname> <given-names>LP</given-names></name>, <name name-style="western"><surname>Rollins</surname> <given-names>DK</given-names></name>, <etal>et al</etal>. <article-title>An Algorithm for Optimally Fitting a Wiener Model, An Algorithm for Optimally Fitting a Wiener Model</article-title>. <source>Mathematical Problems in Engineering, Mathematical Problems in Engineering</source>. <year>2011</year>;<volume>2011</volume>, <issue>2011</issue>:<fpage>e570509</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zitar</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Al-Jabali</surname> <given-names>A</given-names></name>. <article-title>Towards neural network model for insulin/glucose in diabetics-II</article-title>. <source>Informatica</source>. <year>2005</year>;<volume>29</volume>(<issue>2</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Holt</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Khovanova</surname> <given-names>N</given-names></name>. <article-title>A data driven nonlinear stochastic model for blood glucose dynamics</article-title>. <source>Computer Methods and Programs in Biomedicine</source>. <year>2016</year>;<volume>125</volume>:<fpage>18</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cmpb.2015.10.021" xlink:type="simple">10.1016/j.cmpb.2015.10.021</ext-link></comment> <object-id pub-id-type="pmid">26707373</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barazandegan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ekram</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kwok</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gopaluni</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tulsyan</surname> <given-names>A</given-names></name>. <article-title>Assessment of type II diabetes mellitus using irregularly sampled measurements with missing data</article-title>. <source>Bioprocess Biosyst Eng</source>. <year>2014</year>;<volume>38</volume>(<issue>4</issue>):<fpage>615</fpage>–<lpage>629</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00449-014-1301-7" xlink:type="simple">10.1007/s00449-014-1301-7</ext-link></comment> <object-id pub-id-type="pmid">25348655</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ekram</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Vahidi</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Kwok</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gopaluni</surname> <given-names>RB</given-names></name>. <article-title>A feedback glucose control strategy for type II diabetes mellitus based on fuzzy logic</article-title>. <source>Can J Chem Eng</source>. <year>2012</year>;<volume>90</volume>(<issue>6</issue>):<fpage>1411</fpage>–<lpage>1417</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/cjce.21667" xlink:type="simple">10.1002/cjce.21667</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vahidi</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Gopaluni</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Kwok</surname> <given-names>E</given-names></name>. <article-title>Detection of Abnormalities in Type II Diabetic Patients Using Particle Filters</article-title>. <source>J Med Biol Eng</source>. <year>2015</year>;<volume>35</volume>:<fpage>188</fpage>–<lpage>201</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s40846-015-0018-7" xlink:type="simple">10.1007/s40846-015-0018-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref047">
<label>47</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Vahidi</surname> <given-names>O</given-names></name>. <source>Dynamic modeling of glucose metabolism for the assessment of type II diabetes mellitus</source>. <publisher-name>University of British Columbia</publisher-name>; <year>2013</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vahidi</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Kwok</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Gopaluni</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Knop</surname> <given-names>FK</given-names></name>. <article-title>A comprehensive compartmental model of blood glucose regulation for healthy and type 2 diabetic subjects</article-title>. <source>Med Biol Eng Comput</source>. <year>2015</year>; p. <fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Man</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Rizza</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Corbelli</surname> <given-names>C</given-names></name>. <article-title>Meal simulation model of the glucose-insulin system</article-title>. <source>IEEE Transactions on biomedical engineering</source>. <year>2007</year>;<volume>54</volume>:<fpage>1740</fpage>–<lpage>1749</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TBME.2007.893506" xlink:type="simple">10.1109/TBME.2007.893506</ext-link></comment> <object-id pub-id-type="pmid">17926672</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kotz</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Cinar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mei</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Roggendorf</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Littlejohn</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Quinn</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Multiple-Input Subject-Specific Modeling of Plasma Glucose Concentration for Feedforward Control</article-title>. <source>Ind Eng Chem Res</source>. <year>2014</year>;<volume>53</volume>(<issue>47</issue>):<fpage>18216</fpage>–<lpage>18225</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ie404119b" xlink:type="simple">10.1021/ie404119b</ext-link></comment> <object-id pub-id-type="pmid">25620845</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Csete</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Doyle</surname> <given-names>J</given-names></name>. <article-title>The mathematician’s control toolbox for management of type 1 diabetes</article-title>. <source>Interface Focus</source>. <year>2014</year>;<volume>4</volume>(<issue>5</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsfs.2014.0042" xlink:type="simple">10.1098/rsfs.2014.0042</ext-link></comment> <object-id pub-id-type="pmid">25285200</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref052">
<label>52</label>
<mixed-citation publication-type="other" xlink:type="simple">Valletta JJ, Chipperfield AJ, Byrne CD. Gaussian process modelling of blood glucose response to free-living physical activity data in people with type 1 diabetes. In: 2009 Annual International Conference of the IEEE Engineering in Medicine and Biology Society; 2009. p. 4913–4916.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref053">
<label>53</label>
<mixed-citation publication-type="other" xlink:type="simple">Plis K, Bunescu R, Marling C, Shubrook J, Schwartz F. A machine learning approach to predicting blood glucose levels for diabetes management. Modern Artificial Intelligence for Health Analytics Papers from the AAAI-14. 2014;.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref054">
<label>54</label>
<mixed-citation publication-type="other" xlink:type="simple">Wan E, Merwe R. The unscented Kalman filter for nonlinear estimation. In: Adaptive Systems for Signal Processing, Communications, and Control Symposium. IEEE. Wiley; 2000. p. 153–158.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref055">
<label>55</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Carlin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Dunson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Vehtari</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>D</given-names></name>. <source>Bayesian data analysis</source>. <edition>3rd ed</edition>. <publisher-name>CRC Press</publisher-name>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref056">
<label>56</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Burnham</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>D</given-names></name>. <source>Model selection and multimodel inference: A practical information-theoretic approach</source>. <publisher-name>Springer</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref057">
<label>57</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Claeskens</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hjort</surname> <given-names>N</given-names></name>. <source>Model selection and model averaging</source>. <publisher-name>Cambridge Univesity Press</publisher-name>; <year>2008</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gove</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hollinger</surname> <given-names>D</given-names></name>. <article-title>Application of a dual unscented Kalman for simultaneous state and parameter estimation problems of surface-atmospher exchange</article-title>. <source>J Geophys Res</source>. <year>2006</year>;<volume>111</volume>:<fpage>DO8S07</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1029/2005JD006021" xlink:type="simple">10.1029/2005JD006021</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref059">
<label>59</label>
<mixed-citation publication-type="other" xlink:type="simple">Julier S, Uhlmann J, Durrant-Whyte H. A new approach for filtering nonlinear systems. In: American Control Conference. IEEE. IEEE; 1995.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Julier</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Uhlmann</surname> <given-names>J</given-names></name>. <article-title>Unscented filtering and nonlinear estimation</article-title>. <source>Proc IEEE</source>. <year>2004</year>;<volume>92</volume>:<fpage>401</fpage>–<lpage>422</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/JPROC.2003.823141" xlink:type="simple">10.1109/JPROC.2003.823141</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref061">
<label>61</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Wan</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Merwe</surname> <given-names>RVD</given-names></name>. <chapter-title>The Unscented Kalman Filter</chapter-title>. In: <source>Kalman Filtering and Neural Networks</source>. <publisher-name>Wiley</publisher-name>; <year>2001</year>. p. <fpage>221</fpage>–<lpage>280</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Corbelli</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Man</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sparacino</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Magni</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>De Nicolao</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kovatchev</surname> <given-names>B</given-names></name>. <article-title>Diabetes: models, signals, and control</article-title>. <source>IEEE Reviews in Biomedical Engineering</source>. <year>2009</year>;<volume>2</volume>:<fpage>54</fpage>–<lpage>96</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/RBME.2009.2036073" xlink:type="simple">10.1109/RBME.2009.2036073</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sturis</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Polonsky</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Mosekilde</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Cauter</surname> <given-names>EV</given-names></name>. <article-title>Computer model for mechanisms underlying ultradian oscillations of insulin and glucose</article-title>. <source>Am J Physiol Endocrinol Metab</source>. <year>1991</year>;<volume>260</volume>:<fpage>E801</fpage>–<lpage>E809</lpage>. <object-id pub-id-type="pmid">2035636</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref064">
<label>64</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Cover</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>JA</given-names></name>. <source>Elements of information theory</source>. <edition>2nd ed</edition>. <publisher-name>Wiley-Interscience</publisher-name>;.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref065">
<label>65</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rasmussen</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>CKI</given-names></name>. <source>Gaussian Processes in Machine Learning</source>. <publisher-name>MIT Press</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref066">
<label>66</label>
<mixed-citation publication-type="other" xlink:type="simple">Wang J, Fleet D, Hertzmann A. Gaussian process dynamical models. In: NIPS; <year>2005</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref067">
<label>67</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rogers</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>D</given-names></name>. <source>Diffusions, Markov processes and Martingales</source>. <volume>vol. 1</volume>. <publisher-name>Cambridge University Press</publisher-name>; <year>2000</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref068">
<label>68</label>
<mixed-citation publication-type="other" xlink:type="simple">Mamykina L, Mynatt E, Davidson P, Greenblatt D. MAHI: investigation of social scaffolding for reflective thinking in diabetes management. In: Proceeding of the Twenty-Sixth Annual SIGCHI Conference on Human Factors in Computing Systems. ACM; 2008. p. 477–486.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Albers</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Elhadad</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Tabak</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Perotte</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hripcsak</surname> <given-names>G</given-names></name>. <article-title>Dynamical Phenotyping: Using Temporal Analysis of Clinically Collected Physiologic Data to Stratify Populations</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>6</volume>:<fpage>e96443</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0096443" xlink:type="simple">10.1371/journal.pone.0096443</ext-link></comment> <object-id pub-id-type="pmid">24933368</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref070">
<label>70</label>
<mixed-citation publication-type="other" xlink:type="simple">Kandor N. Capital Accumulation and Economic Growth. In: Lutz, Hague, editors. The theory of captial; 1961. p. 177–222.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gibson</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Marcus</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Staggers</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Samore</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Weir</surname> <given-names>C</given-names></name>. <article-title>Efficacy of a Computerized Simulation in Promoting Walking in Individuals With Diabetes</article-title>. <source>J Med Internet Res</source>. <year>2012</year>;<volume>14</volume>:<fpage>e71</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2196/jmir.1965" xlink:type="simple">10.2196/jmir.1965</ext-link></comment> <object-id pub-id-type="pmid">22576226</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gallwitz</surname> <given-names>B</given-names></name>. <article-title>Implications of Postprandial Glucose and Weight Control in People With Type 2 Diabetes</article-title>. <source>Diabetes Care</source>. <year>2009</year>;<volume>32</volume>:<fpage>S322</fpage>–<lpage>S325</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2337/dc09-S331" xlink:type="simple">10.2337/dc09-S331</ext-link></comment> <object-id pub-id-type="pmid">19875573</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref073">
<label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bell</surname> <given-names>D</given-names></name>. <article-title>Postprandial Hyperglycemia/Hyperlipidemia (Postprandial Dysmetabolism) Is a Cardiovascular Risk Factor</article-title>. <source>The American Journal of Cardiology</source>. <year>2007</year>;<volume>100</volume>:<fpage>899</fpage>–<lpage>904</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.amjcard.2007.03.107" xlink:type="simple">10.1016/j.amjcard.2007.03.107</ext-link></comment> <object-id pub-id-type="pmid">17719342</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Demuth</surname> <given-names>RMJ</given-names></name>, <name name-style="western"><surname>Lazo</surname> <given-names>J</given-names></name>. <article-title>Communicating Uncertainty in Weather Forecasts: A Survey of the U.S. Public</article-title>. <source>Weather and Forecasting</source>. <year>2008</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref075">
<label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stacey</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bennett</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Barry</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Col</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Holmes-Rovner</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Decision aids for people facing health treatment or screening decisions</article-title>. In: <source>The Cochrane Database of Systematic Reviews</source>. <volume>vol. 10</volume>; <year>2011</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/14651858.CD001431.pub3" xlink:type="simple">10.1002/14651858.CD001431.pub3</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref076">
<label>76</label>
<mixed-citation publication-type="other" xlink:type="simple">Noronha J, Hysen E, Zhang H, Gajos K. Platemate: Crowdsourcing Nutritional Analysis from Food Photographs. In: Proceedings of the 24th Annual ACM Symposium on User Interface Software and Technology. ACM; 2011. p. 1–12.</mixed-citation>
</ref>
<ref id="pcbi.1005232.ref077">
<label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pearl</surname> <given-names>J</given-names></name>. <article-title>Causal inference in statistics: an overview</article-title>. <source>Statistics surveys</source>. <year>2009</year>;<volume>3</volume>:<fpage>96</fpage>–<lpage>146</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/09-SS057" xlink:type="simple">10.1214/09-SS057</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref078">
<label>78</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Arnold</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Calvetti</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Somersalo</surname> <given-names>E</given-names></name>. <article-title>Parameter estimation for stiff deterministic dynamical systems via ensemble Kalman filter</article-title>. <source>Inverse Problems</source>. <year>2014</year>;<volume>30</volume>(<issue>10</issue>):<fpage>105008</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0266-5611/30/10/105008" xlink:type="simple">10.1088/0266-5611/30/10/105008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005232.ref079">
<label>79</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Reich</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cotter</surname> <given-names>C</given-names></name>. <source>Probabilistic forecasting and Bayesian data assimilation</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2015</year>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>