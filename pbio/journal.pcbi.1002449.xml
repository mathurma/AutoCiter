<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-11-01859</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002449</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Zoology</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Computer modeling</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied mathematics</subject>
          </subj-group>
          <subj-group>
            <subject>Nonlinear dynamics</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computer Science</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories><title-group><article-title>Dynamical Modeling of Collective Behavior from Pigeon Flight Data: Flock Cohesion and Dispersion</article-title><alt-title alt-title-type="running-head">Dynamical Modeling of Collective Behavior</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" deceased="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Dieck Kattas</surname>
            <given-names>Graciano</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Xu</surname>
            <given-names>Xiao-Ke</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Small</surname>
            <given-names>Michael</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Electronic and Information Engineering, The Hong Kong Polytechnic University, Hung Hom, Kowloon, Hong Kong</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>School of Communication and Electronic Engineering, Qingdao Technological University, Qingdao, China</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>School of Mathematics and Statistics, University of Western Australia, Crawley, Australia</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Lu</surname>
            <given-names>Jinhu</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">RMIT University, Australia</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">xiaokeeie@gmail.com</email> (XKX); <email xlink:type="simple">michael.small@uwa.edu.au</email> (MS)</corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: GDK XKX MS. Performed the experiments: GDK. Analyzed the data: GDK XKX MS. Contributed reagents/materials/analysis tools: GDK XKX MS. Wrote the paper: GDK MS.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>3</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>29</day>
        <month>3</month>
        <year>2012</year>
      </pub-date><volume>8</volume><issue>3</issue><elocation-id>e1002449</elocation-id><history>
        <date date-type="received">
          <day>8</day>
          <month>12</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>13</day>
          <month>2</month>
          <year>2012</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>Dieck Kattas et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Several models of flocking have been promoted based on simulations with qualitatively naturalistic behavior. In this paper we provide the first direct application of computational modeling methods to infer flocking behavior from experimental field data. We show that this approach is able to infer general rules for interaction, or lack of interaction, among members of a flock or, more generally, any community. Using experimental field measurements of homing pigeons in flight we demonstrate the existence of a basic distance dependent attraction/repulsion relationship and show that this rule is sufficient to explain collective behavior observed in nature. Positional data of individuals over time are used as input data to a computational algorithm capable of building complex nonlinear functions that can represent the system behavior. Topological nearest neighbor interactions are considered to characterize the components within this model. The efficacy of this method is demonstrated with simulated noisy data generated from the classical (two dimensional) Vicsek model. When applied to experimental data from homing pigeon flights we show that the more complex three dimensional models are capable of simulating trajectories, as well as exhibiting realistic collective dynamics. The simulations of the reconstructed models are used to extract properties of the collective behavior in pigeons, and how it is affected by changing the initial conditions of the system. Our results demonstrate that this approach may be applied to construct models capable of simulating trajectories and collective dynamics using experimental field measurements of herd movement. From these models, the behavior of the individual agents (animals) may be inferred.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>The construction of mathematical models from experimental time-series data has been considered with some success in many areas of science and engineering, using the power of computer algorithms to build model structures and suitably tuning their parameters. When considering complex systems with nonlinear or collective behavior, computational models built from real data are the alternative to emulating the system as best as possible, since classic modeling approaches based on observation could prove difficult for complex dynamics. In this study, we provide a method to build models of collective dynamics from homing pigeon flight data. We show that our models follow the source dynamics well, and from them we are able to infer that significant collective behavior occurs in pigeon flights. Our results are consistent with the basic principles of previous hypotheses and models that have been proposed. Our approach serves as an initial outline towards the usage of experimental data to construct computational models to understand many complex phenomena with hypothesized collective behavior.</p>
      </abstract><funding-group><funding-statement>This research was supported with funding from the Hong Kong University Grants Council General Research Fund grant number PolyU 5300/09E. GDK is currently supported by the Hong Kong PHD Fellowship Scheme (HKPFS) from the Research Grants Council (RGC) of Hong Kong. XKX is currently supported by the PolyU Postdoctoral Fellowships Scheme (G-YX4A) and the Hong Kong University Grants Council General Research Fund (PolyU 5300/09E). XKX also acknowledges the Natural Science Foundation of China (61004104,61104143). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="15"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>The collective behavior exhibited by interacting individuals in a population has recently attracted interest in scientific and engineering communities. Many different definitions have been used to formally describe this behavior, in order to establish new theories and further advance the contributions to this new field. In simple words, collective behavior can be described as local actions taken by individuals in a socially interacting group, which are directly related to the conditions of the group and somehow affect the overall behavior of the group as a single global entity. Many kinds of systems from different areas of application are known to exhibit such behavior, ranging from areas like sociology, psychology, zoology, and all the way to more technical disciplines like bioengineering, computer science, and robotics. The objective of analyzing the collective behavior of a system can be either to further understand the system in question, or to apply the observed behavioral structures in other systems or circumstances in order to provide innovative solutions to problems.</p>
      <p>The movement of groups of animals is a common and well studied example involving the emergence of collective behavior in an interacting population. It is well known that animals tend to work in groups to achieve goals; simple examples that can come to mind are ant colonies, herds, fish schools, and bird flocks. In particular, the collective movement of a group of animals in the same direction is called swarming. Bird flocking in particular, has attracted much recent attention. The ability to gain accurate positional data from GPS devices on pigeons, has opened the door to more advanced and meaningful analysis of flocking <xref ref-type="bibr" rid="pcbi.1002449-Nagy1">[1]</xref>. Photographic data has also lead to deeper analysis of the interaction properties of flocking <xref ref-type="bibr" rid="pcbi.1002449-Ballerini1">[2]</xref>. In general, with accurate 3D positional data, it is now possible to perform statistical analysis which leads to the understanding of the structural and behavioral properties of flocking.</p>
      <p>Mathematical models, especially dynamical models, have been used by biologists, physicists, and mathematicians, to illustrate animal movement or interaction, though usually the dynamics have been observed to be not amenable to linear models. The classical Lotka-Volterra equations are a good example of early attempts to model the growth and decay of populations of predators and preys over time, using nonlinear ordinary differential equations (ODEs). Later efforts to characterize social animal movement involved models that use physical laws and diffusion equations to describe the movement of groups of fish, insects, and herds <xref ref-type="bibr" rid="pcbi.1002449-Okubo1">[3]</xref>. Discrete-time generic models of collective systems, with no particular application, but which can be used to simulate swarming with complex behavior using very simple mathematical rules, are an initial step towards the full understanding of nonlinear properties in real systems, or even graphic visualization. The Boids model <xref ref-type="bibr" rid="pcbi.1002449-Reynolds1">[4]</xref> is a well known example, and it has been used in movies and video games to generate 3D animated collective movement of animals. Another such case is the Vicsek model <xref ref-type="bibr" rid="pcbi.1002449-Vicsek1">[5]</xref>, which is a simpler 2D model of particles, but capable of describing behaviors ranging from the swarming of small groups moving in random directions, to a global directed motion of the whole population. Recent approaches using more complicated but realistic dynamics for swarming with parameter tuning, include metric distance models with informed leaders <xref ref-type="bibr" rid="pcbi.1002449-Couzin1">[6]</xref>, zonal interaction models <xref ref-type="bibr" rid="pcbi.1002449-Lukeman1">[7]</xref>, molecular physics models with geometric and topological interactions <xref ref-type="bibr" rid="pcbi.1002449-Eriksson1">[8]</xref>, and predator-prey models using radial force laws <xref ref-type="bibr" rid="pcbi.1002449-Zhdankin1">[9]</xref>.</p>
      <p>Most of the typical approaches to modeling collective behavior using dynamical systems, have involved developing models using physical laws or well known mathematical functions that are known to resemble the phenomena in question. Later these are tested or tuned with observations or data, in order to verify whether they resemble the original behavior. The opposite approach is to use time series data from experiments to build a full model that fits the data as well as possible, using the power of computers. This methodology, commonly referred as system identification, is used in areas like control engineering and econometrics, although most of the available literature is linked to linear models. Some new generic techniques use data to identify nonlinear ODE models <xref ref-type="bibr" rid="pcbi.1002449-Bongard1">[10]</xref>, while others have focused on inferring the natural laws of physical systems <xref ref-type="bibr" rid="pcbi.1002449-Schmidt1">[11]</xref>. Efficient computer algorithms for structural ODE building have been proposed especially in biological systems literature <xref ref-type="bibr" rid="pcbi.1002449-Gennemark1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Vilela1">[13]</xref>, due to the necessity of scaling the automated building of models to large complex systems involving many variables. The usage of generic and flexible modeling paradigms to capture a wider range of complex behaviors from different fields, can also be considered when designing approaches for automated model building. The automated construction of discrete-time models using radial basis functions, has shown the ability to adequately model chaotic dynamics in systems such as infant respiration, vibrating strings, and lasers <xref ref-type="bibr" rid="pcbi.1002449-Judd1">[14]</xref>–<xref ref-type="bibr" rid="pcbi.1002449-Small2">[17]</xref>.</p>
      <p>Due to the complex dynamics observed in collective systems, we suggest taking this data-driven approach. We use computational methods to process time series data and automatically build nonlinear dynamical models that are able to carry out simulations for further analysis. Compared to previous approaches that use a fixed mathematical structure and fit parameters to swarming data <xref ref-type="bibr" rid="pcbi.1002449-Lukeman1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Eriksson1">[8]</xref>, we provide the first modeling scheme capable of fully building a model, using only limited prior information. In our previous study of homing pigeon flight data <xref ref-type="bibr" rid="pcbi.1002449-Xu1">[18]</xref>, we found that in addition to the discovered hierarchical structure by Nagy et al. <xref ref-type="bibr" rid="pcbi.1002449-Nagy1">[1]</xref>, there are very important local interaction rules that the pigeons follow to maintain a cohesive and synchronized unit. Our objective here is to infer these essential behavioral rules that characterize collective behavior, i.e. the dynamics involved locally between individuals which create emergent global behavior of the whole flock. The question we wish to address is whether these local interactions can be used to provide a mechanistic explanation of flocking behavior, using a simpler egalitarian modeling structure in concordance with the classical models of swarming <xref ref-type="bibr" rid="pcbi.1002449-Reynolds1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Vicsek1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Couzin2">[19]</xref>. Consequently, the prediction of individual trajectories, the influence of “leaders”, and the shapes of the flock are not the focus of our study.</p>
      <p>As a first step, we build models from simulated data of the well studied Vicsek model <xref ref-type="bibr" rid="pcbi.1002449-Vicsek1">[5]</xref>, in order to confirm that our approach is adequate for modeling collective behavior. The approach is extended progressively to handle experimental 3D positional data of pigeon flocks <xref ref-type="bibr" rid="pcbi.1002449-Nagy1">[1]</xref> and then used to construct realistic models capable of performing simulations that emulate the collective dynamics of the data. By evaluating simulations of the retrieved models, new data is generated and used to perform analysis of the system and quantify hypothesized collective behavioral properties such as the separation, attraction, and speed of the flock. Our main contributions in this paper include the modeling scheme itself, which can be used with any adequate function fitting method, for constructing the models based on positional data from the whole flock; a simulation methodology based on the dynamics of neighbor separations in order to visualize and compare the collective behavior; and, the inference of an averaged rule from our model simulations which summarizes basic attraction and repulsion between neighbors in accordance to previous observations and models of collective animal movement <xref ref-type="bibr" rid="pcbi.1002449-Okubo1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Reynolds1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Couzin2">[19]</xref>.</p>
    </sec>
    <sec id="s2" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s2a">
        <title>Input data</title>
        <p>Both simulated and real experimental data were used as input to build flocking models. The former were generated using the well known Vicsek model <xref ref-type="bibr" rid="pcbi.1002449-Vicsek1">[5]</xref>, capable of performing 2D simulations of swarming using simple interaction rules. The latter data set was obtained from pigeon flights using GPS devices attached to the pigeons, and has been previously presented and analyzed <xref ref-type="bibr" rid="pcbi.1002449-Nagy1">[1]</xref>.</p>
        <sec id="s2a1">
          <title>The Vicsek model</title>
          <p>The Vicsek model <xref ref-type="bibr" rid="pcbi.1002449-Vicsek1">[5]</xref>, is a simple nonlinear model capable of simulating swarming behavior. The model is essentially a discrete-time system of several particles in a square domain, with their 2D positions updated according to:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e001" xlink:type="simple"/><label>(1)</label></disp-formula>The velocities have a constant speed <italic>v</italic> and an orientation defined by an angle <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e002" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e003" xlink:type="simple"/><label>(2)</label></disp-formula>In this paper we consider a slightly different update for the angles of the particles:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e004" xlink:type="simple"/><label>(3)</label></disp-formula>In equation (3), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e005" xlink:type="simple"/></inline-formula> denotes average over the <italic>M</italic> nearest neighbors and itself and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e006" xlink:type="simple"/></inline-formula> is a uniformly distributed random number, which is basically the noise of the system. The former differs from the original Vicsek model <xref ref-type="bibr" rid="pcbi.1002449-Vicsek1">[5]</xref> that considered the average of <italic>all</italic> neighbors within a fixed radius <italic>r</italic> of the particle. Our modification is inspired by a recent study on the topological distance in flocks <xref ref-type="bibr" rid="pcbi.1002449-Ballerini1">[2]</xref>, and therefore the model considers a fixed number of nearest neighbors regardless of the separation distance. Other important parameters are <italic>N</italic> (number of particles), <italic>L</italic> (the linear size of the cell with the particle), and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e007" xlink:type="simple"/></inline-formula> (the range of the noise). The periodic boundary conditions of the original model in <xref ref-type="bibr" rid="pcbi.1002449-Vicsek1">[5]</xref> were removed for this study in order to have more realistic data, and thus the boundaries of the square cell were extended to infinity to allow continuous motion. From the Vicsek model, we are interested in generating data for cases of high and low density initial conditions (with low noise) since these correspond to a global directed motion of the whole population and the formation of small groups moving in random directions respectively. These two behaviors are good examples of dynamics that can be observed in real collective systems.</p>
        </sec>
        <sec id="s2a2">
          <title>Pigeon flight data from GPS</title>
          <p>Relevant research in flocking has provided 3D positional data of pigeon flights, with a very fast sampling rate <xref ref-type="bibr" rid="pcbi.1002449-Nagy1">[1]</xref>. These data were obtained from lightweight GPS devices attached to ten homing pigeons. The datasets include eleven free flights of pigeons near their roost and four homing flights which basically involve the flock moving from one position to another. In this study we shall consider the data from the four homing flights, due to the simpler flight patterns that are followed. In addition, our previous study <xref ref-type="bibr" rid="pcbi.1002449-Xu1">[18]</xref> confirmed that the homing flights have higher correlations between individuals, and thus are a better source of information about how pigeons interact, in accordance to our objective defined in the introduction.</p>
          <p>The data from the four homing flights was further sampled to provide smaller datasets that are easier to handle computationally, but still with a rate that is fast enough to capture adequate flight dynamics. With this in mind, sampling rates of one and two seconds were considered depending on the particular properties of each of the flights. In addition to this, the flights were cut to remove idle moments with no significant movement of the birds. Stranded pigeons were also removed from the input data in order to have datasets that resemble a fully interacting population as far as possible. All these edits were made based on thorough manual visualization of the flight data. Some specific details of each of the flights will be explained, since their particular properties will be important to interpret some of the results later on:</p>
          <list list-type="order">
            <list-item>
              <p>Homing flight 1 (hf1): A flight of 5 pigeons with separations of around 300–350 m from mean position of flock. Initial conditions have some pigeons moving in opposite directions. Sampling rate: 1 sec.</p>
            </list-item>
            <list-item>
              <p>Homing flight 2 (hf2): A flight of 9 pigeons with separations of around 650–700 m from mean position of flock. Two pigeons separate from the flock and move together by the end of the flight. Sampling rate: 2 sec.</p>
            </list-item>
            <list-item>
              <p>Homing flight 3 (hf3): A flight of 6 pigeons with separations of more than 1 km from mean position of flock. Sampling rate: 2 sec.</p>
            </list-item>
            <list-item>
              <p>Homing flight 4 (hf4): A flight of 8 pigeons with separations of around 45–55 m from mean position of flock. Sampling rate: 1 sec.</p>
            </list-item>
          </list>
          <p>The sampling rates were selected according to the interaction distance between pigeons. That is, for the flights with higher separations (hf2 and hf3), a slower sampling rate of 2 seconds was used, while the flights with closer interactions (hf1 and hf4) were sampled every second. This was done to have a more precise account of the movement when shorter separations are involved in the flight patterns. The different sampling rates also imply that the models built in each case will be specific to that single flight, and this is actually expected, since each flight is different and might contain different terrain, weather, and behavioral properties.</p>
        </sec>
      </sec>
      <sec id="s2b">
        <title>Modeling schemes</title>
        <p>Recent investigations have led to conclusions about hierarchical structures present in pigeon flights <xref ref-type="bibr" rid="pcbi.1002449-Nagy1">[1]</xref>, which points to some “leader” birds having a stronger influence in the decisions of the flock. If we take this into account in our modeling scheme, we would need to build a separate model for each pigeon, and this is certainly possible. Nevertheless, in order to reach our established objective, our focus is on capturing the basic local interactions that all the individuals follow, and thus we build a single general model from the data of all the birds. This produces a model akin to classical approaches <xref ref-type="bibr" rid="pcbi.1002449-Reynolds1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Vicsek1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Couzin2">[19]</xref>, where the same mathematical function is used to update the movement of every individual.</p>
        <p>To capture a wide range of complex behaviors, black box discrete-time nonlinear dynamical systems can be used to build arbitrary mathematical functions. Their good function fitting properties make such models very useful for performing simulations and getting conclusions and statistics from newly generated data. In our modeling scheme we present a methodology to build models of collective dynamics using an efficient black box modeling method. We emphasize that the method we chose for our paper is not central to our current contribution, and that any other capable fitting algorithm could be used with our approach. Also of importance is the selection of an adequate embedding scheme for the data to model, i.e. selecting the past values from the data that will be used by the model to predict new positions. The values to consider should be inspired by known physical properties of the phenomena in question (in this case pigeon flights). In addition, we use a fixed number of nearest neighbors (<italic>M</italic>) for interactions between individuals, as prior information to build our models. We use this assumption as our neighborhood strategy because previous analyses of bird flocking from experimental data have lead to this conclusion <xref ref-type="bibr" rid="pcbi.1002449-Nagy1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Ballerini1">[2]</xref>. First the general framework and method used to build the functions of the models will be introduced, and after that, the three different kinds of models to be considered will be outlined.</p>
        <sec id="s2b1">
          <title>Radial basis functions</title>
          <p>Any competent nonlinear modeling algorithm could be used to fit a dynamical system to the data. We selected the discrete-time radial basis approach originally presented in <xref ref-type="bibr" rid="pcbi.1002449-Judd1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Small1">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Small2">[17]</xref> as the modeling framework and algorithm to use, because of its proven capability of modeling highly nonlinear systems. In summary, the method receives as an input a scalar time series <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e008" xlink:type="simple"/></inline-formula>, and attempts to build the best model of the form:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e009" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e010" xlink:type="simple"/></inline-formula> is the embedding of the system and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e011" xlink:type="simple"/></inline-formula> is the model prediction error. The former corresponds to the past values from the time series data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e012" xlink:type="simple"/></inline-formula> that the model will consider for calculating the prediction for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e013" xlink:type="simple"/></inline-formula>. The samples used for optimization of the model are built from time series <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e014" xlink:type="simple"/></inline-formula> using the embedding <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e015" xlink:type="simple"/></inline-formula>. The structure of the function to build follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e016" xlink:type="simple"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e017" xlink:type="simple"/></inline-formula> represents a time lag of the time series, <italic>n</italic> is the number of time lags in the model, <italic>m</italic> is the number of radial basis functions, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e018" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e019" xlink:type="simple"/></inline-formula> are scalar constants. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e020" xlink:type="simple"/></inline-formula> parameters denote randomly chosen points, known as centers of the radial basis functions. The first sum (and constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e021" xlink:type="simple"/></inline-formula>) in (5) is the linear part of the system, equivalent to commonly used reduced autoregressive models. The second sum is the nonlinear part of the function, and it is characterized by radial basis functions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e022" xlink:type="simple"/></inline-formula>, which can be of different types, as shown in <xref ref-type="bibr" rid="pcbi.1002449-Small1">[16]</xref>. The algorithm that builds and optimizes the model, described in detail in <xref ref-type="bibr" rid="pcbi.1002449-Reynolds1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Small1">[16]</xref>, basically consists of generating a new set of random candidate radial basis functions at each iteration, estimating parameters, and keeping the ones that minimize residuals (all the others are discarded). This is continued incrementally until the Minimum Description Length (MDL) <xref ref-type="bibr" rid="pcbi.1002449-Rissanen1">[20]</xref> of the model is obtained. The algorithm itself is not the focus of this paper, but we can rely on its effectiveness because it has been previously used to model highly nonlinear data from infant respiration, lasers, and vibrating strings <xref ref-type="bibr" rid="pcbi.1002449-Judd2">[15]</xref>–<xref ref-type="bibr" rid="pcbi.1002449-Small2">[17]</xref>.</p>
        </sec>
        <sec id="s2b2">
          <title>Relative position modeling for Vicsek data</title>
          <p>The first and simplest model to be built is the one based on the data of the Vicsek model. These models will be referred to as type <bold>R1</bold>, symbolizing the first variant of <italic>relative</italic> models. As mentioned in the introduction to this section, the idea is to use the same general model for each particle of the system. Since the Vicsek data is two-dimensional, we require two different functions for a single model (to predict each coordinate). Therefore the single model that all individuals follow can be defined as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e023" xlink:type="simple"/><label>(6)</label></disp-formula></p>
          <p>Since the Vicsek model considers relative positioning (the numerical positional value of a particle does not influence its movement), instead of trying to predict the absolute position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e024" xlink:type="simple"/></inline-formula> at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e025" xlink:type="simple"/></inline-formula>, we can re-define equation (4) by predicting the relative change in position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e026" xlink:type="simple"/></inline-formula>.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e027" xlink:type="simple"/><label>(7)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e028" xlink:type="simple"/></inline-formula> is an array with the model prediction errors for each coordinate. To capture the collective behavior of the source system in our model, the embedding <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e029" xlink:type="simple"/></inline-formula> of a particle <italic>i</italic> should consider enough information from the nearest neighbors that influence its motion. An adequate embedding would be to consider the average change in position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e030" xlink:type="simple"/></inline-formula> of <italic>i</italic> and its neighbors, since it gives enough information about the magnitude and direction of velocity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e031" xlink:type="simple"/></inline-formula>, which actually is enough to model the Vicsek rules (excluding the noise, see equations (1)–(3)). In contrast to the original temporal embedding of the radial basis method, this new embedding considers data from the nearest neighbors, but it does not affect the modeling algorithm since the method fits a function to emulate the output samples from given embedding instances (inputs), regardless of the embedding form. Taking this into consideration, the embedding would be different for each particle due to the difference in nearest neighbors:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e032" xlink:type="simple"/><label>(8)</label></disp-formula>Of importance here is that the neighborhood of the average in (8) considers the fixed-number interaction introduced previously for the modified Vicsek model in (3), which is the averaging over particle <italic>i</italic> and a fixed number of <italic>M</italic> nearest neighbors. Also of relevance is that positions are two-dimensional, and thus the embedding in (8) consists of two variables.</p>
        </sec>
        <sec id="s2b3">
          <title>Absolute position modeling for pigeon homing flights</title>
          <p>When modeling the real 3D homing flights, we must take into account that the pigeons are following a trajectory, which can be summarized as a flight from point <italic>A</italic> to point <italic>B</italic>, with some terrain information on the way that will influence their flight patterns. This means that for adequate modeling of a homing flight, we require absolute positioning in our model. In other words, in contrast to the Vicsek model, the position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e033" xlink:type="simple"/></inline-formula> of pigeon <italic>i</italic> is necessary for an adequate prediction of its value at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e034" xlink:type="simple"/></inline-formula>, due to the terrain information being absolute. Equation (9) shows the absolute model structure to be used.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e035" xlink:type="simple"/><label>(9)</label></disp-formula>This model type will be referred to as <bold>A</bold>, symbolizing the word <italic>absolute</italic>. Even though we do not explicitly define an update for the velocity of an individual (or change in position), our model function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e036" xlink:type="simple"/></inline-formula> calculates it implicitly “within the black box” from the embedding <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e037" xlink:type="simple"/></inline-formula>, and consequently affects the positional update in equation (9). It is also worth mentioning that since positions are now three-dimensional, the model consists of three functions instead of the two that were required for the Vicsek data (6). The usage of experimental data requires a more complete embedding for adequate modeling. First of all, physical common sense should be taken into consideration to define a model. That is, at least second-order components must be considered, which translates into the necessity of using velocity information (values at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e038" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e039" xlink:type="simple"/></inline-formula>) to calculate a prediction for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e040" xlink:type="simple"/></inline-formula>. In addition to this, we are interested in modeling the collective behavior, and thus neighbor interactions must be included. Taking all of this into consideration, the proposed embedding is displayed in (10).<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e041" xlink:type="simple"/><label>(10)</label></disp-formula>This embedding scheme for a pigeon <italic>i</italic> considers its absolute position at the two previous time intervals (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e042" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e043" xlink:type="simple"/></inline-formula>) and the average position of its <italic>M</italic> nearest neighbors in the same intervals. Despite the fact that interactions between pigeons are likely not isotropic <xref ref-type="bibr" rid="pcbi.1002449-Ballerini1">[2]</xref> (i.e. a pigeon might only interact with the neighbors within its sight), for simplicity we compute the <italic>M</italic> nearest neighbors with no restrictions. Note that each of the four components in (10) is three-dimensional, which translates into a 12 variable embedding, making it much more complex than the two variable embedding used for the Vicsek data. Another distinction from the Vicsek embedding, is that the nearest neighbor averaging in (10) considers only the <italic>M</italic> nearest neighbors and not itself. This is a reasonable thing to do, since the position of pigeon <italic>i</italic> is already being directly considered in the embedding, taking into account the more realistic consideration of a significant difference between its own position and that of its neighbors. From this, we will denote <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e044" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e045" xlink:type="simple"/></inline-formula> as the <italic>individual</italic> and <italic>collective</italic> components of the model respectively.</p>
        </sec>
        <sec id="s2b4">
          <title>Relative position modeling for general flocking model</title>
          <p>The modeling scheme presented in the previous subsection was designed for navigational flights, where absolute positioning is important due to the influence of the terrain in the flight. In addition to these models, it is of our interest to build a general flocking model using relative positioning similar to the Vicsek model, but based on real experimental data. This final model type shall be referred as <bold>R2</bold>, which refers to the second variant of <italic>relative</italic> models. As a first step, we should mention that the desired relative position model structure is the same as in (7), and introduce a new nine-variable embedding:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e046" xlink:type="simple"/><label>(11)</label></disp-formula>Here the first component represents the positional change of bird <italic>i</italic> at time <italic>t</italic>: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e047" xlink:type="simple"/></inline-formula>, the second component is the average positional change of the nearest neighbors, and the third component is the averaged positional difference between <italic>i</italic> and its nearest neighbors. The first two components resemble the Vicsek embedding introduced in (8), though now separating the change in position of bird <italic>i</italic> from that of its neighbors. The third component symbolizes a directional separation between <italic>i</italic> and its neighbors, which should be useful to characterize collective behavior. For example, we can expect that the separation distance to its neighbors in some direction (front, back, left, right) will surely have an effect on the movement of bird <italic>i</italic>. This component introduces a dependence on the metric distance between neighbors, which makes the model a hybrid inspired by both topological and metric distance approaches (see <xref ref-type="bibr" rid="pcbi.1002449-Ballerini1">[2]</xref>). Essentially the metric separation distance to its <italic>M</italic> nearest neighbors will influence an individual's movement, and therefore we can expect the interaction strength of a good model to be weak or near zero at very long distances, when the pigeons no longer interact.</p>
          <p>We must emphasize that the plain homing flight data is not appropriate for building this general flocking model, due to the navigational bias that it has. To exemplify this, the four homing flights previously introduced consist of pigeon flocks moving from a point <italic>A</italic> to <italic>B</italic> in a loosely southwest direction. This means that if data of one or all the flights is used to build the model, it will undoubtedly be biased with southwest movement. In order to attenuate the bias, we performed uniform 2D rotation transformations to produce new embedded data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e048" xlink:type="simple"/></inline-formula> and prediction values <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e049" xlink:type="simple"/></inline-formula>. For simplicity, these rotations were only done for the latitude and longitude coordinates, leaving the altitude component intact. <xref ref-type="fig" rid="pcbi-1002449-g001">Figure 1</xref> shows a graphical example of a −90 degree rotation of a single embedding and prediction instance. Each rotation angle for an instance of (11) is calculated so that the orientations of the prediction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e050" xlink:type="simple"/></inline-formula>, span a full circle (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e051" xlink:type="simple"/></inline-formula>) in the whole dataset. These transformations are done with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e052" xlink:type="simple"/></inline-formula> because this vector is the actual navigational force of the model, which has the previously mentioned bias in the original data. In summary, by spanning a full circle in the navigational direction of the samples, we are attempting to remove the bias.</p>
          <fig id="pcbi-1002449-g001" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g001</object-id>
            <label>Figure 1</label>
            <caption>
              <title>A graphical example of a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e053" xlink:type="simple"/></inline-formula> rotation of embedding and prediction.</title>
              <p>In (a) we have the hypothetical original data, and (b) the new data.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g001" xlink:type="simple"/>
          </fig>
        </sec>
      </sec>
      <sec id="s2c">
        <title>Measuring flock dynamics</title>
        <p>As a valuable tool for the analysis of flocking data, a measure that can characterize and illustrate the dynamics of the collective behavior should be used. Velocity correlation functions have been considered in previous studies <xref ref-type="bibr" rid="pcbi.1002449-Okubo1">[3]</xref> to calculate the positional variation of individuals in swarming populations. Since our models and analyses are based on the local interactions between neighbors, the velocities or positions of individuals are not the most straightforward way to see how they are interacting on both a local and global scale. Therefore we propose using dynamic separation measures between individuals to properly characterize how they flock over time. The average separation of individuals from the mean position of the whole population (<italic>N</italic>) at a time interval <italic>t</italic> is defined as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e054" xlink:type="simple"/><label>(12)</label></disp-formula></p>
        <p>This measure should be relevant when analyzing the global dynamical properties of a whole flock, but it could also be important to measure the separations in local neighborhoods instead of the whole population, especially when swarming in small groups is significant. A slight modification to (12) gives us the average separation of individuals from the centroid of their local neighborhood of neighbors:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e055" xlink:type="simple"/><label>(13)</label></disp-formula></p>
        <p>Besides the analysis of each data set, the main idea of introducing these measures is to perform qualitative comparisons between the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e056" xlink:type="simple"/></inline-formula> of the input data and data obtained from model simulations, in order to verify the dynamics of a retrieved model. Another important feature of using these time-dependent measures is that transient and steady state properties of the system can be easily visualized, in a way that is very similar to analyses commonly done in control theory. Essentially a stable steady state in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e057" xlink:type="simple"/></inline-formula> signal represents ordered synchronized movement of the whole flock (or a small group if considering the local measure). For some cases, it might be more convenient and compact to express the separation of a system as a single numeric quantity, and therefore the average separation over all time intervals <italic>T</italic> will be defined as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e058" xlink:type="simple"/></inline-formula>.</p>
      </sec>
      <sec id="s2d">
        <title>Methodology</title>
        <p>The automated modeling process shall now be outlined. As described previously, radial basis functions are used to build three different model types (R1, A, R2), according to the introduced modeling schemes. Essentially the same procedure is followed to build the three types of models, with the notable differences being the input data, number of functions per model, and embedding. The general process to build a single model will be described, with additional special comments for each model type:</p>
        <p>Input: Time series matrix containing positional data: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e059" xlink:type="simple"/></inline-formula></p>
        <list list-type="bullet">
          <list-item>
            <p>Vicsek model simulations for R1 models</p>
          </list-item>
          <list-item>
            <p>Homing pigeon data from a single flight for A models</p>
          </list-item>
          <list-item>
            <p>Homing pigeon data from multiple flights for R2 models</p>
          </list-item>
        </list>
        <p>For each positional coordinate <italic>j</italic>:</p>
        <list list-type="order">
          <list-item>
            <p>Build samples for the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e060" xlink:type="simple"/></inline-formula> using as output <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e061" xlink:type="simple"/></inline-formula> (for R1 and R2 types) or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e062" xlink:type="simple"/></inline-formula> for (A types) with their respective embedding <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e063" xlink:type="simple"/></inline-formula>, using data from all individuals/pigeons.</p>
          </list-item>
          <list-item>
            <p>Run the radial basis modeling algorithm.</p>
          </list-item>
          <list-item>
            <p>Set the retrieved function as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e064" xlink:type="simple"/></inline-formula>.</p>
          </list-item>
        </list>
        <p>The randomness in the radial basis modeling algorithm used to construct the models (see <xref ref-type="bibr" rid="pcbi.1002449-Judd1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Small1">[16]</xref>), makes it necessary to run the algorithm several times to retrieve several models and find the most appropriate one, or average their statistics. Specific details on the number of retrieved models, and model selection criteria will be presented in the results section.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <p>Using the methodology we presented, several models were retrieved for each dataset. To analyze the models, the main philosophy followed in this study was to perform simulations with different sets of initial conditions and verify their behavior using separation measures <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e065" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e066" xlink:type="simple"/></inline-formula>, by either comparing with the source input data or simply by analyzing the simulated data itself. Since we are discriminating models based on the separation measures, differing from the MDL that the modeling algorithm uses, we argue that our chosen models do not overfit the dataset, but give a good emulation of the separation dynamics. More specific details for each model type shall be discussed in each subsection.</p>
      <sec id="s3a">
        <title>R1 models (Vicsek model data)</title>
        <p>From samples of five different instances of low density simulations of the modified Vicsek model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e067" xlink:type="simple"/></inline-formula> see <xref ref-type="bibr" rid="pcbi.1002449-Vicsek1">[5]</xref>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e068" xlink:type="simple"/></inline-formula>), five different R1 models were obtained. From there, we decided to select a single “best” model by comparing the global behaviors of the models under high density conditions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e069" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002449-Vicsek1">[5]</xref>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e070" xlink:type="simple"/></inline-formula>), which was done by averaging <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e071" xlink:type="simple"/></inline-formula> over ten simulations (<italic>K</italic>) of high density initial conditions, each with 500 time intervals (<italic>T</italic>). The model with least absolute error: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e072" xlink:type="simple"/></inline-formula> was selected with this criterion. We chose to discriminate the models by comparing their extrapolative capabilities to simulate initial conditions with different density than their input data, i.e. the phase transition in the classic Vicsek model. The number of nearest neighbors (<italic>M</italic>) in the model structures and for calculating <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e073" xlink:type="simple"/></inline-formula> were chosen to be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e074" xlink:type="simple"/></inline-formula> for low density initial conditions and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e075" xlink:type="simple"/></inline-formula> for the high density case, which from simulations resemble the steady state number of neighbors from the original radius interaction in the Vicsek paper <xref ref-type="bibr" rid="pcbi.1002449-Vicsek1">[5]</xref>.</p>
        <p>In <xref ref-type="fig" rid="pcbi-1002449-g002">Figure 2</xref> we can see a comparison between the global separation dynamics of the modified Vicsek model and the R1 model. The retrieved model closely emulates the behavior of the source model. The low density cases show an expected higher separation rate than the high density simulations, which is related to swarming occurring in small groups and moving away. Even for the extrapolating case of high density initial conditions, the model exhibits close following of the dynamics. <xref ref-type="fig" rid="pcbi-1002449-g003">Figure 3</xref> shows a comparison of the local neighborhood dynamics of the same two models. In (a), the Vicsek data reaches a pseudo-steady state for low density initial conditions, with the R1 model closely following it but reaching a more stable state. The high density case in <xref ref-type="fig" rid="pcbi-1002449-g003">Figure 3(b)</xref> considers closer interactions, and thus both models reach a stable state, with a small transient in the source model, and a small steady state error. The deviations between the Vicsek and R1 models, especially for the local separations in the high density simulations, are likely due to the fact that the former has a noise term (see <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e076" xlink:type="simple"/></inline-formula> in equation (3)), which is not being modeled in the latter, i.e. the R1 model emulates the deterministic component of the Vicsek model, and thus the small errors are reasonable.</p>
        <fig id="pcbi-1002449-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Comparison of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e077" xlink:type="simple"/></inline-formula> between the modified Vicsek model data and the “best” R1 model.</title>
            <p>Statistics were averaged over 10 simulations, with both models using the same initial conditions. In (a) low density initial conditions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e078" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e079" xlink:type="simple"/></inline-formula>) and in (b) high density initial conditions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e080" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e081" xlink:type="simple"/></inline-formula>). The range of the simulations is delimited by the dashed lines.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g002" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002449-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Comparison of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e082" xlink:type="simple"/></inline-formula> between the modified Vicsek model data and the “best” R1 model.</title>
            <p>Statistics were averaged over 10 simulations, with both models using the same initial conditions. In (a) low density initial conditions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e083" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e084" xlink:type="simple"/></inline-formula>) and in (b) high density initial conditions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e085" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e086" xlink:type="simple"/></inline-formula>). The range of the simulations is delimited by the dashed lines.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g003" xlink:type="simple"/>
        </fig>
        <p>As inferred with the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e087" xlink:type="simple"/></inline-formula> curves, the low density initial conditions of the Vicsek model feature swarming in separate groups moving in different directions. <xref ref-type="fig" rid="pcbi-1002449-g004">Figure 4</xref> shows snapshots of simulations of both models for the same low density initial conditions (see <xref ref-type="supplementary-material" rid="pcbi.1002449.s001">Video S1</xref>). Qualitatively the retrieved model follows the behavior of the source model quite well, and this was verified through several simulations. The only noticeable issue observed through the simulations is a slightly biased default direction followed by some individuals, but this should be expected when constructing a model with imperfect data. Using more data to build the model, this bias is removed, but the trade-off is longer computation time. Nevertheless, the observed bias was small, and many different directions were still seen in the simulations. The same conclusions were observed for the high density simulation comparisons, which involves ordered movement of the swarm in only one or two big groups (see <xref ref-type="supplementary-material" rid="pcbi.1002449.s002">Video S2</xref>). <xref ref-type="fig" rid="pcbi-1002449-g005">Figure 5</xref> shows how a split in the population was emulated well qualitatively by the R1 model, but with an alignment difference.</p>
        <fig id="pcbi-1002449-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Low density simulations of the modified Vicsek model and the “best” R1 model.</title>
            <p>The same initial conditions were used for both models. Qualitatively, the R1 model dynamics resemble the modified Visek model: individuals move away in groups. Plot (a) shows a snapshot at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e088" xlink:type="simple"/></inline-formula> and (b) one at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e089" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g004" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002449-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>High density simulations of the modified Vicsek model and the “best” R1 model.</title>
            <p>The same initial conditions were used for both. Qualitatively, the R1 model dynamics resemble the modified Visek model: the population is split into two. Plot (a) shows a snapshot at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e090" xlink:type="simple"/></inline-formula> and (b) one at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e091" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g005" xlink:type="simple"/>
        </fig>
        <p>In order to verify how well the R1 model is capturing the basic local neighbor alignment rule of the Vicsek model, in <xref ref-type="fig" rid="pcbi-1002449-g006">Figure 6</xref> we show how the orientation of the neighborhood of an individual: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e092" xlink:type="simple"/></inline-formula>, affects the orientation of the individual at the next time interval: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e093" xlink:type="simple"/></inline-formula>. The statistics for this relationship were averaged over 50 simulations of 250 time intervals in the R1 model under low density initial conditions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e094" xlink:type="simple"/></inline-formula>). In the ideal case of a noiseless Vicsek model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e095" xlink:type="simple"/></inline-formula>), we can infer from equation (3) that these two quantities are equal, and actually represent the rule which produces swarming behavior. <xref ref-type="fig" rid="pcbi-1002449-g006">Figure 6</xref> shows how the model is mostly capturing this essential relationship, with only some discrepancy in a region between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e096" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e097" xlink:type="simple"/></inline-formula>. As pointed out previously, the variation likely occurs because of the noise in the source data, and can be reduced by using more input data to build the model. The modeling scenario of the Vicsek data and its corresponding results, are a good introduction to the task of building models from real experimental data, which is noisy and even more imperfect, as shall be considered in the next subsections.</p>
        <fig id="pcbi-1002449-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Retrieved alignment rule by the “best” R1 model.</title>
            <p>Extracted rule representing alingment of an individual <italic>i</italic> at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e098" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e099" xlink:type="simple"/></inline-formula>, as a function of the neighborhood alignments at time <italic>t</italic>: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e100" xlink:type="simple"/></inline-formula>. In an ideal noiseless modified Vicsek model, these alignments are equal. This synchronization principle is the basis for the swarming behavior of the Vicsek model.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g006" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s3b">
        <title>A models (Homing pigeon flight data)</title>
        <p>The main purpose of the A models is to emulate their respective flight (input data) through simulations, and to confirm that there is collective behavior influencing the models and not simply an individual navigational force. In order to see the effect of the collective components and the interaction structures, models with different number of nearest neighbors (<italic>M</italic>) were obtained for comparison. In addition to those, models with no collective components (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e101" xlink:type="simple"/></inline-formula>) and thus a six variable embedding (see equation 10), were also retrieved for the same purpose. To obtain better conclusions of the collective effects, five different 3D models were obtained for each value of <italic>M</italic> considered, and all statistics averaged over the five. For the model analysis, two different simulation scenarios were considered for each homing flight: same initial conditions as the input data and random initial conditions. The latter were calculated from a normal distribution with the same mean and variance as the absolute initial positions of the input data (for each of the three coordinates), in order to preserve similar flight conditions, but with no initial velocity, (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e102" xlink:type="simple"/></inline-formula>). The global separation measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e103" xlink:type="simple"/></inline-formula> calculated in the simulations, was used as the comparison statistic between model structures and input data.</p>
        <p>For simulations of the homing flight 1 (hf1) models (from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e104" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e105" xlink:type="simple"/></inline-formula>) with five pigeons, <xref ref-type="fig" rid="pcbi-1002449-g007">Figure 7(a)</xref> shows that models with low <italic>M</italic> (0, 1 and 2) on average do not follow the input data for the same initial conditions. This deviation in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e106" xlink:type="simple"/></inline-formula> was observed to happen early in the simulations at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e107" xlink:type="simple"/></inline-formula> and the opposite velocities in the initial conditions of some of the individuals is what likely causes this difficulty. Nevertheless, the models with higher <italic>M</italic> (3 and 4) follow the input data neatly (<xref ref-type="fig" rid="pcbi-1002449-g007">Figure 7(a)</xref> shows <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e108" xlink:type="simple"/></inline-formula>, see <xref ref-type="supplementary-material" rid="pcbi.1002449.s003">Video S3</xref>). When considering random initial conditions with no initial velocity, in <xref ref-type="fig" rid="pcbi-1002449-g007">Figure 7(b)</xref> we can see how the individual models (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e109" xlink:type="simple"/></inline-formula>) do not keep cohesion of the flock as good as the collective models. This confirms that a collective force is modeled, and that an interaction structure with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e110" xlink:type="simple"/></inline-formula> offers both accurate path simulation and more cohesion (The M = 4 curves are not displayed in <xref ref-type="fig" rid="pcbi-1002449-g007">Figure 7</xref> for better visualization; they follow <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e111" xlink:type="simple"/></inline-formula> closely).</p>
        <fig id="pcbi-1002449-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Homing flight 1: flock separation for models with different interaction structure.</title>
            <p>In (a), simulations consider initial conditions from the input data, while (b) averages over ten simulations of random initial conditions. From the plots, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e112" xlink:type="simple"/></inline-formula> shows the best resemblance to the input data (see (a)) and the strongest collective component (see (b)).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g007" xlink:type="simple"/>
        </fig>
        <p>The models of homing flight 2 present probably the most difficult case to analyze. As can be seen in <xref ref-type="fig" rid="pcbi-1002449-g008">Figure 8(a)</xref>, the input data considers the separation increasing at around <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e113" xlink:type="simple"/></inline-formula>, and this happens because the data has two pigeons moving together away from the main flock at that time. This causes an interesting modeling case, since these particular data contradict the cohesive tendencies found at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e114" xlink:type="simple"/></inline-formula>. All this has repercussions with the retrieved models. <xref ref-type="fig" rid="pcbi-1002449-g008">Figure 8(a)</xref> shows how with the input data initial conditions, the individual models (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e115" xlink:type="simple"/></inline-formula>) follow this separation better than the others. This can be reasoned with the fact that it is purely using positional information to estimate the trajectory, and the small variations between positions at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e116" xlink:type="simple"/></inline-formula> are what cause the divergence that mimics the input data. Nevertheless, the collective models are again expressing a significant collective force, since they give preference to the group tendencies and thus do not follow the separation increase (see <xref ref-type="supplementary-material" rid="pcbi.1002449.s004">Video S4</xref>). To better visualize how the interaction structure affects the collective component for this flight, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e117" xlink:type="simple"/></inline-formula> was averaged over all time intervals for each model structure. <xref ref-type="fig" rid="pcbi-1002449-g008">Figure 8(b)</xref> shows that the simulations with random initial conditions found the most cohesive interaction structure to be at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e118" xlink:type="simple"/></inline-formula>, and a surprising separation for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e119" xlink:type="simple"/></inline-formula>. This likely stems from the fact that the two-bird deviation in the input data causes models with larger interaction neighborhoods to be more sensitive to the deviations of some individuals. Overall, this particular flight illustrates how the input data can also affect what the models will try to capture, as well as the trade-offs between modeling the navigational trajectory or the collective behavior more closely.</p>
        <fig id="pcbi-1002449-g008" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g008</object-id>
          <label>Figure 8</label>
          <caption>
            <title>Homing flight 2: flock separation for models with different interaction structure.</title>
            <p>In (a), simulations consider initial conditions from the input data, while (b) averages over ten simulations of random initial conditions, and all time intervals. From the plots, a split occurs in the flock after <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e120" xlink:type="simple"/></inline-formula> (see (a)), while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e121" xlink:type="simple"/></inline-formula> has the strongest collective component (see (b)).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g008" xlink:type="simple"/>
        </fig>
        <p>Differing from the previous two homing flights, the third one has separations of up to 1 km between pigeons, and thus it considers the longest interaction range of all the flights. The number of pigeons in this data set is 6, and models with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e122" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e123" xlink:type="simple"/></inline-formula> were retrieved. It was found that every single model structure follows the input data closely when using the same initial conditions. <xref ref-type="fig" rid="pcbi-1002449-g009">Figure 9(a)</xref> shows it for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e124" xlink:type="simple"/></inline-formula>. When using random initial conditions as shown in <xref ref-type="fig" rid="pcbi-1002449-g009">Figure 9(b)</xref>, no significant decrease was found for the average global separation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e125" xlink:type="simple"/></inline-formula> as a function of adding nearest neighbors, with all values very close to 1.1 km. This implies that the large separations in this flight could be causing no interaction (or a very weak one) between birds, and therefore the models mostly consider the navigational component as the driving force of the individuals. From this, we infer that there is no significant collective behavior for this flight, likely due to the large separations, and an individual model with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e126" xlink:type="simple"/></inline-formula> should be as good as any to simulate the dynamics (see <xref ref-type="supplementary-material" rid="pcbi.1002449.s005">Video S5</xref>).</p>
        <fig id="pcbi-1002449-g009" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g009</object-id>
          <label>Figure 9</label>
          <caption>
            <title>Homing flight 3: Flock separation for models with different interaction structure.</title>
            <p>In (a), simulations consider initial conditions from the input data, while (b) averages over ten simulations of random initial conditions, and all time intervals. No significant collective behavior is found due to the long separations.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g009" xlink:type="simple"/>
        </fig>
        <p>Finally we arrive with homing flight 4, which considers eight pigeons with the shortest average separations of them all, at around 50 m. This causes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e127" xlink:type="simple"/></inline-formula> to appear quite noisy due to the expected sensitivity of separation distances in a higher density flock. With <italic>M</italic> ranging from 0 to 6, we found that the models with highest value at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e128" xlink:type="simple"/></inline-formula> produced both the best following of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e129" xlink:type="simple"/></inline-formula> for the input data initial conditions and the highest cohesion when simulating random initial conditions (see <xref ref-type="supplementary-material" rid="pcbi.1002449.s006">Video S6</xref>). <xref ref-type="fig" rid="pcbi-1002449-g010">Figure 10</xref> shows a comparison of models with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e130" xlink:type="simple"/></inline-formula>. As a difference with the previous three flights, for the random initial conditions we considered a normal distribution with two times the standard deviation of the input initial conditions, instead of one. This was done in order to start with larger separations and verify the dynamic attraction properties of the models. From the results, all the collective models clearly had more attraction, and in <xref ref-type="fig" rid="pcbi-1002449-g010">Figure 10(b)</xref> we can observe how two of them show sharp convergence tendencies that the individual models do not have.</p>
        <fig id="pcbi-1002449-g010" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g010</object-id>
          <label>Figure 10</label>
          <caption>
            <title>Homing flight 4: Flock separation for models with different interaction structure.</title>
            <p>In (a), simulations consider initial conditions from the input data, while (b) averages over ten simulations of random initial conditions. From the plots, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e131" xlink:type="simple"/></inline-formula> shows the best resemblance to the input data (see (a)) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e132" xlink:type="simple"/></inline-formula> the strongest collective component (see (b)).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g010" xlink:type="simple"/>
        </fig>
        <p>In general, from analyzing the results of the four homing flight models, we can confirm that our approach is adequate for simulating pigeon flock trajectories that are qualitatively close to the experimental data. For flights with short interaction ranges (less than 700 m from mean position per bird), the collective models can better capture the flight properties and offer the best flock cohesion when changing initial conditions. For long interaction ranges (around 1 km), simple individual models that consider only own positional information, were enough for a simulation of the flight.</p>
        <p>As a final step with our <italic>A</italic> models, we estimate the “optimal” value of <italic>M</italic> for each homing flight with collective behavior (all except hf3), by calculating the mean absolute error of each individual model and its source data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e133" xlink:type="simple"/></inline-formula>, from a simulation with the same initial conditions. After that, we averaged the MAE for each type of model (each value of <italic>M</italic>) in order to verify which interaction structure follows the separation dynamics of the source data better on average. For hf2 we only considered up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e134" xlink:type="simple"/></inline-formula> to exclude the section of the data where the flock splits. <xref ref-type="table" rid="pcbi-1002449-t001">Table 1</xref> shows our results, and interestingly for all flights <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e135" xlink:type="simple"/></inline-formula> gave the least average MAE values. This does not mean that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e136" xlink:type="simple"/></inline-formula> models were always the best for each flight, but that on average they performed better than the others. This tells us that considering an interaction neighborhood of the four nearest neighbors is a reasonable assumption for the modeling of these particular homing pigeon flights.</p>
        <table-wrap id="pcbi-1002449-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.t001</object-id><label>Table 1</label><caption>
            <title>The “optimal” <italic>M</italic> value.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002449-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">M</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">6</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">hf1</td>
                <td align="left" colspan="1" rowspan="1">343.2</td>
                <td align="left" colspan="1" rowspan="1">563.2</td>
                <td align="left" colspan="1" rowspan="1">424.4</td>
                <td align="left" colspan="1" rowspan="1">50.2</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>47.8</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">N/A</td>
                <td align="left" colspan="1" rowspan="1">N/A</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">hf2</td>
                <td align="left" colspan="1" rowspan="1">17.2</td>
                <td align="left" colspan="1" rowspan="1">21.0</td>
                <td align="left" colspan="1" rowspan="1">14.2</td>
                <td align="left" colspan="1" rowspan="1">13.9</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>12.4</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">14.3</td>
                <td align="left" colspan="1" rowspan="1">17.6</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">hf4</td>
                <td align="left" colspan="1" rowspan="1">2.8</td>
                <td align="left" colspan="1" rowspan="1">4.5</td>
                <td align="left" colspan="1" rowspan="1">5.2</td>
                <td align="left" colspan="1" rowspan="1">4.5</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>2.1</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">3.2</td>
                <td align="left" colspan="1" rowspan="1">4.5</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>Averaged mean absolute error (MAE) values between models and their source data for each homing flight. The MAEs from all the models of the same type (same <italic>M</italic>) were averaged in order to find which interaction followed best the separation dynamics. The models with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e137" xlink:type="simple"/></inline-formula> show the least averaged MAE in all flights.)</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
      <sec id="s3c">
        <title>R2 models (homing pigeon flight data)</title>
        <p>The data from hf1, hf2, and hf4 was used to build five models for each structure with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e138" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e139" xlink:type="simple"/></inline-formula>, and using two second sampling on the data. The third homing flight was excluded since our results in the previous subsection confirm that there is no strong collective behavior in that dataset, and <italic>M</italic> was limited to a maximum value of 4 because of the hf1 data that only considers five pigeons. In contrast to the A models, the R2 models were set to be 2D for simplification, with the height component removed from predictions and simulations. To select the “best” model, ten different sets of initial conditions that resemble the properties of hf1 (mid-range interaction around 300 m) were used to simulate flights of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e140" xlink:type="simple"/></inline-formula> individuals, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e141" xlink:type="simple"/></inline-formula> measures calculated. Since the data that we use for our R2 model comes from different flights with different separation, navigational, and environmental properties, it is not adequate to select a “best” model based on a direct comparison of separations with the data, and thus we decided to select based on best flock cohesion, due to better flocking capabilities. Not surprisingly, the selected model had a structure of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e142" xlink:type="simple"/></inline-formula>, which is consistent with our calculation of the “optimal” <italic>M</italic> value in the previous subsection. The selected model was used for all the analysis and it shall now be referred to as the R2 model in general terms. Also important to note is the fact that the R2 model has a slightly biased overall direction, which was reduced as much as possible using the rotations in the data that we described in the modeling section. MATLAB files for our five R2 models with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e143" xlink:type="simple"/></inline-formula> have been made available on the internet for usage <xref ref-type="bibr" rid="pcbi.1002449-DieckKattas1">[21]</xref>.</p>
        <p>Many different variations of initial conditions or even values of <italic>M</italic> and <italic>N</italic> could be considered on the R2 model simulations for analysis. For this study we decided to fix <italic>N</italic> and <italic>M</italic> at 300 and 4 respectively. We varied the initial positional density of the individuals according to the formula <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e144" xlink:type="simple"/></inline-formula>, where <italic>r</italic> is the radius (in meters) of the circle in which the initial positions of the individuals are distributed (following a uniform random distribution), and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e145" xlink:type="simple"/></inline-formula> is the actual coefficient that we change. Additionally. we alter the initial speed of the individuals (the magnitudes of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e146" xlink:type="simple"/></inline-formula>) using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e147" xlink:type="simple"/></inline-formula>, and spanning <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e148" xlink:type="simple"/></inline-formula> from 0 to 1. All the individuals are initialized with the same speed but with different orientations, the latter obtained from a random uniform distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e149" xlink:type="simple"/></inline-formula>. Considering that the R2 model has two-second updates (input data with two second samples), this limits the initial speed to a maximum of 15 m/s, which is roughly the average of the speeds in the pigeon homing flights. Even though speed and density could be seen as rescalings of each other, the model is built from real data and therefore the actual numerical values for each quantity affect the model considerably and in different ways. From the R2 embedding in equation (11), we can see that separations and velocities will influence the model, and thus both quantities are important for a complete analysis of the dynamics. Seven different <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e150" xlink:type="simple"/></inline-formula> values and eleven <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e151" xlink:type="simple"/></inline-formula> values were considered for a total of 77 combinations of initial condition parameters. Each parameter setting was considered for ten different simulations, in order to get better averaged statistics.</p>
        <p>In <xref ref-type="fig" rid="pcbi-1002449-g011">Figure 11</xref>, we can see a comparison of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e152" xlink:type="simple"/></inline-formula> for four extreme cases of high and low densities and velocities. <xref ref-type="fig" rid="pcbi-1002449-g011">Figure 11(a)</xref> shows that cases of low velocity settle approximately into steady states, while the high velocity cases have increases in global separation; more drastically in the high density case. This tells us that global flocking is highly dependent on the velocities of the individuals, and not so much on the population density. In <xref ref-type="fig" rid="pcbi-1002449-g011">Figure 11(b)</xref>, the local separation properties can be observed. Basically for all cases, the individuals tend to converge into local groups with less than 20 m separation, with the low density cases having drastic drops in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e153" xlink:type="simple"/></inline-formula> that symbolize strong attraction. This means that larger separations provoke individuals to move strongly toward their neighbors. The high density and high speed case shows an interesting initial increase in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e154" xlink:type="simple"/></inline-formula> and then decrease to settle down into its steady state. This is likely due to velocity synchronization: individuals are initially close together with random directions but later on they separate and align with neighbors with similar orientations and synchronize their velocities.</p>
        <fig id="pcbi-1002449-g011" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g011</object-id>
          <label>Figure 11</label>
          <caption>
            <title>Comparison of separation measures between extreme cases of initial conditions for the R2 model.</title>
            <p>Statistics were averaged over 10 simulations for each case. Plot (a) shows that the initial speed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e155" xlink:type="simple"/></inline-formula> plays an important part in the global separation of the system <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e156" xlink:type="simple"/></inline-formula>. In plot (b), the local separations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e157" xlink:type="simple"/></inline-formula> tend to similar steady states regardless of the initial conditions.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g011" xlink:type="simple"/>
        </fig>
        <p><xref ref-type="fig" rid="pcbi-1002449-g012">Figure 12</xref> shows how in the low density and low speed simulation, the individuals attract into small groups and globally move together in the main direction (the biased direction: roughly southwest, see <xref ref-type="supplementary-material" rid="pcbi.1002449.s007">Video S7</xref>). For the high speed case, the flock has less cohesion, including some stranded individuals moving in other directions, and therefore their alignment is not fully synchronized (see <xref ref-type="supplementary-material" rid="pcbi.1002449.s008">Video S8</xref>). From here we can see that when individuals are separated by a longer distance, if they are moving at slower speeds then they have a better chance of finding each other and aligning. The higher speeds make it more difficult, and thus provoke less cohesion and stranded groups of individuals moving on their own. These tendencies are consistent with <xref ref-type="fig" rid="pcbi-1002449-g011">Figure 11</xref>. For the two cases of high density initial conditions we have a drastic difference. <xref ref-type="fig" rid="pcbi-1002449-g013">Figure 13</xref> shows how for low speeds, the flock stays together, spaces out, and then slightly moves in the main direction (see <xref ref-type="supplementary-material" rid="pcbi.1002449.s009">Video S9</xref>). For high speeds, small groups are formed and they move away from the center independently (see <xref ref-type="supplementary-material" rid="pcbi.1002449.s010">Video S10</xref>). This shows that the velocities are usually roughly maintained within nearest neighbors, and thus cause the significant difference in system behavior.</p>
        <fig id="pcbi-1002449-g012" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g012</object-id>
          <label>Figure 12</label>
          <caption>
            <title>Simulations of low density instances (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e158" xlink:type="simple"/></inline-formula>) of the R2 model.</title>
            <p>Low and high initial speeds are considered. The simulation with low initial speed shows a more aligned and cohesive flock. Plot (a) shows a snapshot after 100 s and (b) one after 500 s.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g012" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002449-g013" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g013</object-id>
          <label>Figure 13</label>
          <caption>
            <title>Simulations of high density instances (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e159" xlink:type="simple"/></inline-formula>) of the R2 model.</title>
            <p>Low and high initial speeds are considered. The simulation with high initial speed shows small groups dispersing in many directions. Plot (a) shows a snapshot after 100 s and (b) one after 500 s.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g013" xlink:type="simple"/>
        </fig>
        <p>To generalize how the initial densities and speeds affect the system behavior, <xref ref-type="fig" rid="pcbi-1002449-g014">Figure 14</xref> shows a plot of the averaged separation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e160" xlink:type="simple"/></inline-formula> in shades of gray, for the different initial parameters. In <xref ref-type="fig" rid="pcbi-1002449-g014">Figure 14(a)</xref>, we can see how by increasing the speed, the separation increases for every density value, though in a lower rate for the low density cases. For a fixed speed value, when decreasing the density (increasing the radius coefficient <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e161" xlink:type="simple"/></inline-formula>), the separation tends to decrease and then increase again, which implies that there is a critical density value with highest cohesion for each different speed value (marked on the figure). As the speed increases, a lower density (higher <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e162" xlink:type="simple"/></inline-formula>) value will be required to achieve highest cohesion. <xref ref-type="fig" rid="pcbi-1002449-g014">Figure 14(b)</xref> shows how the local separation follows the expected pattern of higher cohesion at higher densities and lower cohesion at lower densities, with no strong dependency on the speed. It is relevant to notice that the cohesive force does not decrease so drastically until it passes a distance threshold of no interaction between individuals. From these observations, we can conclude that speed has a higher influence on the global dynamics of the system, while density influences the local interactions. In other words, the density seems to have a greater influence on the directional alignment of individuals: lower separations causing almost immediate neighbor alignment, while larger separations require a transient to first converge and then align (see <xref ref-type="fig" rid="pcbi-1002449-g011">Figure 11(b)</xref>).</p>
        <fig id="pcbi-1002449-g014" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g014</object-id>
          <label>Figure 14</label>
          <caption>
            <title>Comparison of averaged separation measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e163" xlink:type="simple"/></inline-formula> for simulations of R2 model.</title>
            <p>Initial speeds and population radius (densities) for the R2 model were varied. Critical density values (highest cohesion) for each speed are marked for global separation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e164" xlink:type="simple"/></inline-formula> in (a). Loosely invariant behavior for local separation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e165" xlink:type="simple"/></inline-formula> is shown in (b). Statistics were averaged over 10 simulations for each parameter case.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g014" xlink:type="simple"/>
        </fig>
        <p>As final illustrations of the behavior of the R2 model, averaged distributions of how the separation of a particle <italic>i</italic> from its nearest neighbors affects its attraction and speed at the next time interval, were calculated from all the simulations considered in this subsection (all 77 combinations of parameter values and their ten simulations). The average nearest neighbor separation of a particle <italic>i</italic> at a time interval is defined as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e166" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pcbi-1002449-g015">Figure 15(a)</xref> shows that there is a small repulsion force spanning up to slightly less than 20 m of separation and then the strong attraction force with a maximum strength at around 120 m and ending near 500 m, which tells us that the maximum interaction range is approximately 500 m. This limit in the interaction range is consistent with our conclusion of no collective behavior in hf3, which had separations of more than 1 km. The distribution is much smoother for short range interactions, likely because cohesive scenarios dominated the simulations. <xref ref-type="fig" rid="pcbi-1002449-g015">Figure 15(b)</xref> shows how the speed of a particle is highest within 20 and 120 meters of separation, with a maximum near 35 m. This region is strongly correlated with the strong attraction region also roughly covering that span until the minimum (maximum attraction) is reached in <xref ref-type="fig" rid="pcbi-1002449-g015">Figure 15(a)</xref>. For higher separations, the speed decreases steadily, which follows that individuals are attracted less to their neighbors as their interaction decreases. The maximum speed at 35 m presents an interesting interpretation, because it only amounts to a weak attraction force, implying an interaction range where individuals are aligned and moving fast together.</p>
        <fig id="pcbi-1002449-g015" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002449.g015</object-id>
          <label>Figure 15</label>
          <caption>
            <title>Change in separation symbolizing attraction(−)/repulsion(+), and speed distributions estimated from the simulations.</title>
            <p>In (a) and (b) we have the changes in neighbor separation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e167" xlink:type="simple"/></inline-formula> and speed <italic>v</italic> respectively at the next time interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e168" xlink:type="simple"/></inline-formula>, as a function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e169" xlink:type="simple"/></inline-formula> at time t. The R2 model was built upon two-second sampling, and thus each time interval update <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e170" xlink:type="simple"/></inline-formula> is after two seconds. Plot (a) is consistent with short range repulsion and long range attraction as the main mechanisms of neighbor interactions.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.g015" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>The contribution of our work encompasses both the modeling scheme and methodology to build flocking models which can emulate the collective behavior (represented by separation dynamics) of input experimental data, and the inference of essential dynamical properties of the models using simulations. As a first step to verify our approach, we inferred the basic neighborhood alignment principle of the Vicsek model, since our R1 model mostly captured this synchronizing relationship. From the simulations of our more complete R2 model, built from data of three flights of pigeon flocks, we averaged attraction and speed distributions based on the separation of an individual to its nearest neighbors. Our results shown in <xref ref-type="fig" rid="pcbi-1002449-g015">Figure 15</xref> are consistent with classical swarming models that consider a short range repulsion force followed by attraction at longer ranges within the sphere of interaction of an individual <xref ref-type="bibr" rid="pcbi.1002449-Reynolds1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002449-Couzin2">[19]</xref>. This interaction range between the fixed number of nearest neighbors was found to have a maximum attraction force near 120 m of separation and its limit at around 500 m. We emphasize that our model and results are not a replacement to approaches that consider “leaders” as the driving force of the flock <xref ref-type="bibr" rid="pcbi.1002449-Couzin1">[6]</xref>, but an essential complement to the hierarchical structure <xref ref-type="bibr" rid="pcbi.1002449-Nagy1">[1]</xref>. This augmentation is composed of the essential interaction mechanisms that are the foundations of flocking <xref ref-type="bibr" rid="pcbi.1002449-Reynolds1">[4]</xref>. Our results are consistent with our previous study, where we analyzed the reciprocal relationships of the flock from the same datasets, and found that these basic local dynamics are fundamental for the collective behavior in pigeon flights <xref ref-type="bibr" rid="pcbi.1002449-Xu1">[18]</xref>.</p>
      <p>The methodology presented in this paper is capable of obtaining models of collective systems exhibiting swarming properties, from which simulations and statistics can be obtained. A related method using Gaussian processes to model pigeon trajectories and identify terrain landmarks has been recently proposed <xref ref-type="bibr" rid="pcbi.1002449-Mann1">[22]</xref>, with the main difference being that we build a multi-agent model that emphasizes the collective dynamics of a flock instead of a model for the trajectory followed by a single pigeon. The Vicsek model served as an introductory example of a simulated system with noisy data, to verify the efficiency of our approach on modeling dynamics with collective behavior. The results showed adequate qualitative emulation of the dynamics for two extreme density scenarios, even when the sampled data used to build the model was only based on a single density case, thus showing the capability for extrapolation. When modeling the four homing pigeon flock trajectories with the A models, different interaction structures were retrieved in order to test and verify both the trajectory and the collective dynamics. The best retrieved models showed the capability of qualitatively simulating the collective dynamics of the input data, and we found that on average, models that consider each individual interacting with its four nearest neighbors (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e171" xlink:type="simple"/></inline-formula>) gave the best emulation of the global separation dynamics of the flock. We do not claim that pigeons strictly interact with only their four nearest neighbors, but our results do show that this is a good premise for our models to follow the collective dynamics of the data.</p>
      <p>The R2 model showed the ability to represent significant swarming behaviors. In general, it illustrated that global swarming of a population is largely dependent on the speeds of the individuals, with low speeds favoring unified organized movement, and high speeds causing local swarming and separation in different directions. The population density also had an effect on the simulations, by essentially having a critical value of highest cohesion for a fixed value of initial velocities. This implies that for given velocities, a certain density distribution will offer the best global cohesion and synchronization between individuals. From the same observations we concluded that lower speeds facilitate pigeon flocking, and this is consistent with common sense, since the pigeons can easily converge and synchronize with no major effort. Higher speeds will cause only pigeons with similar alignments to synchronize their directions and move together, which is synonymous to flocking in small groups. Nevertheless, certain densities can still cause global flocking with high speeds, as long as there is enough space for these small pigeon groups to converge and synchronize their velocities.</p>
      <p>Our approach has the potential of being used to model other kinds of complex systems where similar spatiotemporal measurements are available. Depending on the properties of the systems in question, we consider that continuous improvements to the embedding schemes, are a worthy direction to continue our work and infer other essential relationships between interacting entities of collective systems. In addition, another possible future direction is to construct simplified mathematical models manually which use these extracted rules as a basis for the dynamics, and thus be able to have a wider range of simulations that could help understand new behaviors that can emerge from local interactions of individuals.</p>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002449.s001" mimetype="Video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.s001" xlink:type="simple">
        <label>Video S1</label>
        <caption>
          <p><bold>Low density simulations of the modified Vicsek model and the “best” R1 model.</bold> Individuals move away in small groups.</p>
          <p>(MP4)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002449.s002" mimetype="Video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.s002" xlink:type="simple">
        <label>Video S2</label>
        <caption>
          <p><bold>High density simulations of the modified Vicsek model and the “best” R1 model.</bold> Individuals move away in two large groups.</p>
          <p>(MP4)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002449.s003" mimetype="Video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.s003" xlink:type="simple">
        <label>Video S3</label>
        <caption>
          <p>
            <bold>Dynamics of homing flight 1: experimental data vs. A model simulation.</bold>
          </p>
          <p>(MP4)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002449.s004" mimetype="Video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.s004" xlink:type="simple">
        <label>Video S4</label>
        <caption>
          <p><bold>Dynamics of homing flight 2: experimental data vs. A model simulation.</bold> The model has more cohesion in final time intervals (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e172" xlink:type="simple"/></inline-formula>).</p>
          <p>(MP4)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002449.s005" mimetype="Video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.s005" xlink:type="simple">
        <label>Video S5</label>
        <caption>
          <p><bold>Dynamics of homing flight 3: experimental data vs. A model simulation.</bold> No significant collective behavior. Model with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e173" xlink:type="simple"/></inline-formula>.</p>
          <p>(MP4)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002449.s006" mimetype="Video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.s006" xlink:type="simple">
        <label>Video S6</label>
        <caption>
          <p><bold>Dynamics of homing flight 4: experimental data vs. A model simulation. Low separations.</bold> Model with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002449.e174" xlink:type="simple"/></inline-formula>.</p>
          <p>(MP4)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002449.s007" mimetype="Video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.s007" xlink:type="simple">
        <label>Video S7</label>
        <caption>
          <p><bold>Low density and low speed simulation of the R2 model.</bold> Individuals find each other.</p>
          <p>(MP4)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002449.s008" mimetype="Video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.s008" xlink:type="simple">
        <label>Video S8</label>
        <caption>
          <p><bold>Low density and high speed simulation of the R2 model.</bold> Some dispersion in the population.</p>
          <p>(MP4)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002449.s009" mimetype="Video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.s009" xlink:type="simple">
        <label>Video S9</label>
        <caption>
          <p><bold>High density and low speed simulation of the R2 model.</bold> Global movement.</p>
          <p>(MP4)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002449.s010" mimetype="Video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002449.s010" xlink:type="simple">
        <label>Video S10</label>
        <caption>
          <p><bold>High density and high speed simulation of the R2 model.</bold> Neighbors align easily and move away.</p>
          <p>(MP4)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>The authors would like to thank Máté Nagy who kindly provided the trajectory data of the pigeon flocks. Additionally the authors are grateful for the valuable comments of the anonymous reviewers who gave some key suggestions to polish the final version of the paper. Xu Xiaoke and Michael Small wish to dedicate this paper to the memory of Graciano Dieck Kattas, an excellent student and a good friend, who passed away before seeing this paper published.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002449-Nagy1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nagy</surname><given-names>M</given-names></name><name name-style="western"><surname>Akos</surname><given-names>Z</given-names></name><name name-style="western"><surname>Biro</surname><given-names>D</given-names></name><name name-style="western"><surname>Vicsek</surname><given-names>T</given-names></name></person-group>             <year>2010</year>             <article-title>Hierarchical group dynamics in pigeon flocks.</article-title>             <source>Nature</source>             <volume>464</volume>             <fpage>890</fpage>             <lpage>893</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Ballerini1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ballerini</surname><given-names>M</given-names></name><name name-style="western"><surname>Cabibbo</surname><given-names>N</given-names></name><name name-style="western"><surname>Candelier</surname><given-names>R</given-names></name><name name-style="western"><surname>Cavagna</surname><given-names>A</given-names></name><name name-style="western"><surname>Cisbani</surname><given-names>E</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Interaction ruling animal collective behavior depends on topological rather than metric distance: Evidence from a field study.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>105</volume>             <fpage>1232</fpage>             <lpage>1237</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Okubo1">
        <label>3</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Okubo</surname><given-names>A</given-names></name><name name-style="western"><surname>Levin</surname><given-names>SA</given-names></name></person-group>             <year>2001</year>             <source>Diffusion and Ecological Problems: Modern Perspectives</source>             <publisher-name>Springer Verlag</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Reynolds1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Reynolds</surname><given-names>CW</given-names></name></person-group>             <year>1987</year>             <article-title>Flocks, herds and schools: A distributed behavioral model.</article-title>             <source>SIGGRAPH Comput Graph</source>             <volume>21</volume>             <fpage>25</fpage>             <lpage>34</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Vicsek1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Vicsek</surname><given-names>T</given-names></name><name name-style="western"><surname>Czirok</surname><given-names>A</given-names></name><name name-style="western"><surname>Ben-Jacob</surname><given-names>E</given-names></name><name name-style="western"><surname>Cohen</surname><given-names>I</given-names></name><name name-style="western"><surname>Shochet</surname><given-names>O</given-names></name></person-group>             <year>1995</year>             <article-title>Novel type of phase transition in a system of self-driven particles.</article-title>             <source>Phys Rev Lett</source>             <volume>75</volume>             <fpage>1226</fpage>             <lpage>1229</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Couzin1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Couzin</surname><given-names>ID</given-names></name><name name-style="western"><surname>Krause</surname><given-names>J</given-names></name><name name-style="western"><surname>Franks</surname><given-names>NR</given-names></name><name name-style="western"><surname>Levin</surname><given-names>SA</given-names></name></person-group>             <year>2005</year>             <article-title>Effective leadership and decision-making in animal groups on the move.</article-title>             <source>Nature</source>             <volume>433</volume>             <fpage>513</fpage>             <lpage>516</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Lukeman1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lukeman</surname><given-names>R</given-names></name><name name-style="western"><surname>Li</surname><given-names>YX</given-names></name><name name-style="western"><surname>Edelstein-Keshet</surname><given-names>L</given-names></name></person-group>             <year>2010</year>             <article-title>Inferring individual rules from collective behavior.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>107</volume>             <fpage>12576</fpage>             <lpage>12580</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Eriksson1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Eriksson</surname><given-names>A</given-names></name><name name-style="western"><surname>Nilsson Jacobi</surname><given-names>M</given-names></name><name name-style="western"><surname>Nystrom</surname><given-names>J</given-names></name><name name-style="western"><surname>Tunstrom</surname><given-names>K</given-names></name></person-group>             <year>2010</year>             <article-title>Determining interaction rules in animal swarms.</article-title>             <source>Behav Ecol</source>             <volume>21</volume>             <fpage>1106</fpage>             <lpage>1111</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Zhdankin1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhdankin</surname><given-names>V</given-names></name><name name-style="western"><surname>Sprott</surname><given-names>JC</given-names></name></person-group>             <year>2010</year>             <article-title>Simple predator-prey swarming model.</article-title>             <source>Phys Rev E</source>             <volume>82</volume>             <fpage>056209</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Bongard1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bongard</surname><given-names>J</given-names></name><name name-style="western"><surname>Lipson</surname><given-names>H</given-names></name></person-group>             <year>2007</year>             <article-title>Automated reverse engineering of nonlinear dynamical systems.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>9943</fpage>             <lpage>9948</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Schmidt1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schmidt</surname><given-names>M</given-names></name><name name-style="western"><surname>Lipson</surname><given-names>H</given-names></name></person-group>             <year>2009</year>             <article-title>Distilling free-form natural laws from experimental data.</article-title>             <source>Science</source>             <volume>324</volume>             <fpage>81</fpage>             <lpage>85</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Gennemark1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gennemark</surname><given-names>P</given-names></name><name name-style="western"><surname>Wedelin</surname><given-names>D</given-names></name></person-group>             <year>2007</year>             <article-title>Efficient algorithms for ordinary differential equation model identification of biological systems.</article-title>             <source>IET Syst Biol</source>             <volume>1</volume>             <fpage>120</fpage>             <lpage>129</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Vilela1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Vilela</surname><given-names>M</given-names></name><name name-style="western"><surname>Vinga</surname><given-names>S</given-names></name><name name-style="western"><surname>Maia</surname><given-names>M</given-names></name><name name-style="western"><surname>Voit</surname><given-names>E</given-names></name><name name-style="western"><surname>Almeida</surname><given-names>J</given-names></name></person-group>             <year>2009</year>             <article-title>Identification of neutral biochemical network models from time series data.</article-title>             <source>BMC Syst Biol</source>             <volume>3</volume>             <fpage>47</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Judd1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Judd</surname><given-names>K</given-names></name><name name-style="western"><surname>Mees</surname><given-names>A</given-names></name></person-group>             <year>1995</year>             <article-title>On selecting models for nonlinear time series.</article-title>             <source>Physica D</source>             <volume>82</volume>             <fpage>426</fpage>             <lpage>444</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Judd2">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Judd</surname><given-names>K</given-names></name><name name-style="western"><surname>Mees</surname><given-names>A</given-names></name></person-group>             <year>1996</year>             <article-title>Modeling chaotic motions of a string from experimental data.</article-title>             <source>Physica D</source>             <volume>92</volume>             <fpage>221</fpage>             <lpage>236</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Small1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Small</surname><given-names>M</given-names></name><name name-style="western"><surname>Judd</surname><given-names>K</given-names></name></person-group>             <year>1998</year>             <article-title>Comparisons of new nonlinear modeling techniques with applications to infant respiration.</article-title>             <source>Physica D</source>             <volume>117</volume>             <fpage>283</fpage>             <lpage>298</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Small2">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Small</surname><given-names>M</given-names></name><name name-style="western"><surname>Tse</surname><given-names>CK</given-names></name></person-group>             <year>2002</year>             <article-title>Minimum description length neural networks for time series prediction.</article-title>             <source>Phys Rev E</source>             <volume>66</volume>             <fpage>066701</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Xu1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Xu</surname><given-names>XK</given-names></name><name name-style="western"><surname>Dieck Kattas</surname><given-names>G</given-names></name><name name-style="western"><surname>Small</surname><given-names>M</given-names></name></person-group>             <year>2012</year>             <article-title>Reciprocal relationships in collective flights of homing pigeons.</article-title>             <source>Phys Rev E</source>             <comment>In press</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Couzin2">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Couzin</surname><given-names>ID</given-names></name><name name-style="western"><surname>Krause</surname><given-names>J</given-names></name><name name-style="western"><surname>James</surname><given-names>R</given-names></name><name name-style="western"><surname>Ruxton</surname><given-names>GD</given-names></name><name name-style="western"><surname>Franks</surname><given-names>NR</given-names></name></person-group>             <year>2002</year>             <article-title>Collective memory and spatial sorting in animal groups.</article-title>             <source>J Theor Biol</source>             <volume>218</volume>             <fpage>1</fpage>             <lpage>11</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Rissanen1">
        <label>20</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rissanen</surname><given-names>J</given-names></name></person-group>             <year>1989</year>             <source>Stochastic Complexity in Statistical Inquiry Theory</source>             <publisher-name>World Scientific Publishing Co., Inc</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-DieckKattas1">
        <label>21</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dieck Kattas</surname><given-names>G</given-names></name></person-group>             <year>2011</year>             <article-title>R2 model iteration, version 1.0.</article-title>             <comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.eie.polyu.edu.hk/~chano/r2it.zip" xlink:type="simple">www.eie.polyu.edu.hk/~chano/r2it.zip</ext-link>. Accessed 21 February 2012</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002449-Mann1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mann</surname><given-names>R</given-names></name><name name-style="western"><surname>Freeman</surname><given-names>R</given-names></name><name name-style="western"><surname>Osborne</surname><given-names>M</given-names></name><name name-style="western"><surname>Garnett</surname><given-names>R</given-names></name><name name-style="western"><surname>Armstrong</surname><given-names>C</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Objectively identifying landmark use and predicting flight trajectories of the homing pigeon using gaussian processes.</article-title>             <source>J R Soc Interface</source>             <volume>8</volume>             <fpage>210</fpage>             <lpage>219</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>