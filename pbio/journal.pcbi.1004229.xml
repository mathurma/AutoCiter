<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004229</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-00946</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>ConPADE: Genome Assembly Ploidy Estimation from Next-Generation Sequencing Data</article-title>
<alt-title alt-title-type="running-head">Genome Assembly Ploidy Estimation</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Margarido</surname>
<given-names>Gabriel R. A.</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Heckerman</surname>
<given-names>David</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Microsoft Research, Los Angeles, California, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Departamento de Genética, Escola Superior de Agricultura ‘‘Luiz de Queiroz”, Universidade de São Paulo, Piracicaba, Brazil</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ioshikhes</surname>
<given-names>Ilya</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Ottawa University, CANADA</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>GRAM and DH are paid employees of Microsoft. This does not alter the authors’ adherence to the PLOS Computational Biology policies on sharing data and materials.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: GRAM DH. Performed the experiments: GRAM. Analyzed the data: GRAM. Contributed reagents/materials/analysis tools: GRAM DH. Wrote the paper: GRAM DH.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">gramarga@usp.br</email> (GRAM); <email xlink:type="simple">heckerma@microsoft.com</email> (DH)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>16</day>
<month>4</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>4</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>4</issue>
<elocation-id>e1004229</elocation-id>
<history>
<date date-type="received">
<day>28</day>
<month>5</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>9</day>
<month>3</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Margarido, Heckerman</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004229" xlink:type="simple"/>
<abstract>
<p>As a result of improvements in genome assembly algorithms and the ever decreasing costs of high-throughput sequencing technologies, new high quality draft genome sequences are published at a striking pace. With well-established methodologies, larger and more complex genomes are being tackled, including polyploid plant genomes. Given the similarity between multiple copies of a basic genome in polyploid individuals, assembly of such data usually results in collapsed contigs that represent a variable number of homoeologous genomic regions. Unfortunately, such collapse is often not ideal, as keeping contigs separate can lead both to improved assembly and also insights about how haplotypes influence phenotype. Here, we describe a first step in avoiding inappropriate collapse during assembly. In particular, we describe ConPADE (Contig Ploidy and Allele Dosage Estimation), a probabilistic method that estimates the ploidy of any given contig/scaffold based on its allele proportions. In the process, we report findings regarding errors in sequencing. The method can be used for whole genome shotgun (WGS) sequencing data. We also show applicability of the method for variant calling and allele dosage estimation. Results for simulated and real datasets are discussed and provide evidence that ConPADE performs well as long as enough sequencing coverage is available, or the true contig ploidy is low. We show that ConPADE may also be used for related applications, such as the identification of duplicated genes in fragmented assemblies, although refinements are needed.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Diploid organisms, such as human beings, have two “copies” of each chromosome, whereas polyploid organisms have multiple “copies” (we use quotes to stress that the “copies” are not identical). A key difference between diploid and polyploid organisms is that the “copies” tend to be less similar in polyploid organisms. This difference leads to important differences in the process of <italic>de novo</italic> genome assembly from short fragments of DNA. In particular, when assembling polyploid organisms, contigs corresponding to different copies of the chromosomes can be quite different, and merging them leads to loss of information. Thus, it is important to maintain distinct contigs, even though they correspond to copies of the same chromosomal region. An important step in doing so is to determine how many truly distinct copies of a chromosomal region are found in a single contig. For example, if there are 12 copies of a particular chromosome, the possible number of distinct copies could be anywhere from 1 to 12. We call this task “contig ploidy estimation”, and present a method for accomplishing it. This set of methods is useful for the <italic>de novo</italic> assembly of complex, polyploid genomes such as sugarcane, switchgrass, and wheat.</p>
</abstract>
<funding-group>
<funding-statement>The authors received no specific funding for this work.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="2"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All bacterial sequence read files are available from the NCBI SRA database (accession numbers SRX131047, SRX101577, SRX084335, SRX160387, SRX096307, SRX110128). Bacterial genomes are available from the NCBI Genome database (accession numbers ASM584v1, PB_Kleb_oxyt_10-5248_V1, ASM19595v1, ASM1290v1, ASM1150v1, ASM688v1). Switchgrass sequence read files are available from the NCBI SRA database (accession numbers SRX109496, SRX109498, SRX109499, SRX109501, SRX109503, SRX109505, SRX110233 and SRX110234). The switchgrass genome reference is available from Phytozome (<ext-link ext-link-type="uri" xlink:href="http://www.phytozome.com/panicumvirgatum.php" xlink:type="simple">http://www.phytozome.com/panicumvirgatum.php</ext-link>). Wheat sequence read files are available from the EMBL-EBI ENA database (accession numbers ERR277132 through ERR277135, ERR277139, ERR277140, ERR277146 and ERR277147). The wheat references for the long arms of chromosomes 5A, 5B and 5D are available at <ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/iwgsc/" xlink:type="simple">http://urgi.versailles.inra.fr/download/iwgsc/</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Complete genome <italic>de novo</italic> sequencing and assembly is a major initial step in understanding the underlying genetic architecture of important traits in any species [<xref rid="pcbi.1004229.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1004229.ref003" ref-type="bibr">3</xref>]. Reliable reference genomes are pivotal for finding genetic variations such as single nucleotide polymorphisms (SNP) and insertions/deletions (indels), which bolster downstream applications such as genome-wide association studies, population genomics and comparative biology [<xref rid="pcbi.1004229.ref004" ref-type="bibr">4</xref>–<xref rid="pcbi.1004229.ref007" ref-type="bibr">7</xref>]. Genetic breeding programs also benefit from reference genomes through the identification of superior promoters and genes [<xref rid="pcbi.1004229.ref008" ref-type="bibr">8</xref>], which may later be channeled to transformation applications. There have been many algorithmic developments yielding a myriad of software for assembly of the large amounts of short reads generated by next-generation sequencing technologies, mainly developed under a haploid or diploid mindset [<xref rid="pcbi.1004229.ref009" ref-type="bibr">9</xref>–<xref rid="pcbi.1004229.ref012" ref-type="bibr">12</xref>]. Such methods have been successfully applied to many diploid species for which high quality or draft reference genomes are now available [<xref rid="pcbi.1004229.ref013" ref-type="bibr">13</xref>–<xref rid="pcbi.1004229.ref015" ref-type="bibr">15</xref>]. In the case of more thoroughly studied species, particularly <italic>Homo sapiens</italic>, current work involves resequencing of a large number of individuals to characterize genetic variation, as illustrated by the 1000 Genomes Project [<xref rid="pcbi.1004229.ref016" ref-type="bibr">16</xref>].</p>
<p>With these already established methodologies, research is moving to larger and more complex genomes [<xref rid="pcbi.1004229.ref017" ref-type="bibr">17</xref>]. Plants are particularly challenging, due to the highly repetitive nature of their genomes, combined with widespread occurrence of different forms of polyploidy, such as allopolyploidy (<italic>e</italic>.<italic>g</italic>., wheat, many species of the genus <italic>Brassica</italic> and some types of cotton) [<xref rid="pcbi.1004229.ref018" ref-type="bibr">18</xref>], autopolyploidy (such as potato, sugarcane and switchgrass) [<xref rid="pcbi.1004229.ref019" ref-type="bibr">19</xref>] and even paleopolyploidy (<italic>e</italic>.<italic>g</italic>., <italic>Arabidopsis</italic> and maize) [<xref rid="pcbi.1004229.ref020" ref-type="bibr">20</xref>]. To circumvent many of the difficulties arising from such high complexity, researchers have undertaken approaches such as sequencing doubled monoploids to reduce heterozygosity, as was done with autotetraploid potato [<xref rid="pcbi.1004229.ref021" ref-type="bibr">21</xref>], chromosome sorting and/or bacterial artificial chromosome (BAC) sequencing, such as done for allohexaploid wheat [<xref rid="pcbi.1004229.ref022" ref-type="bibr">22</xref>]. These approaches are time and resource consuming and may not be applicable to all species. On the other hand, whole genome shotgun (WGS) sequencing is a much less costly option that does not require extensive library preparation or cloning efforts, but in turn results in more fragmented assemblies [<xref rid="pcbi.1004229.ref023" ref-type="bibr">23</xref>]. Hybrid approaches, for example combining WGS with BAC sequencing, can be used to balance the tradeoffs.</p>
<p>When a genome is assembled with WGS data, regions where two or more copies are similar to each other result in a collapsed assembly, such that a single contig represents more than one haploid segment. Unfortunately, such collapse is often not ideal. Keeping contigs separate can lead to improved assembly due to simplification of downstream analyses such as genome finishing. Maintaining separation will also yield a more detailed view of the polyploid genome, which in turn can lead to (<italic>e</italic>.<italic>g</italic>.) insights about how haplotypes influence phenotype.</p>
<p>Here, we describe a first step in avoiding inappropriate collapse during assembly. Our goal is to identify the number of potentially collapsed haplotypes in any given contig, affording information for subsequent efforts aimed at properly separating distinct genomic segments. In particular, we describe a method to estimate the ploidy of a contig. The algorithm, called ConPADE (Contig Ploidy and Allele Dosage Estimation), estimates ploidy using the relative proportions of alleles in heterozygous positions along with a learned model of measurement error. We evaluate the accuracy of ConPADE with both simulated and real datasets, and show how the approach can also be used for allele dosage estimation in polyploid species. Our approach is applicable to shotgun data from an entire genome or from subsets of a genome, and is valid as long as there is random sampling of all segments potentially collapsed into a single contig—that is, there is no preferential sequencing or higher coverage from one or another genomic segment. It is fundamentally different from copy-number detection algorithms, which are designed to look for departures from a normal situation of diploidy [<xref rid="pcbi.1004229.ref024" ref-type="bibr">24</xref>,<xref rid="pcbi.1004229.ref025" ref-type="bibr">25</xref>], and from SNP calling algorithms, which find variants based on the assumption of diploidy [<xref rid="pcbi.1004229.ref026" ref-type="bibr">26</xref>], or assume an user defined ploidy level [<xref rid="pcbi.1004229.ref027" ref-type="bibr">27</xref>,<xref rid="pcbi.1004229.ref028" ref-type="bibr">28</xref>].</p>
<p>At first glance, it may seem that ploidy estimation is trivial when the number of homoeologous copies is known prior to assembly. However, for aneuploid species such as sugarcane, the number of copies varies from one chromosome to another [<xref rid="pcbi.1004229.ref029" ref-type="bibr">29</xref>]. Furthermore, even if the number of homoeologues is the same for each chromosome, in a given region, some homoeologues will be identical, some will be different, and some will be lacking the region altogether. Consequently, if a region has <italic>k</italic> homoeologues, the contig ploidy in that region can range from 1 to <italic>k</italic>.</p>
<p>ConPADE should also prove useful in estimating the true ploidy of an organism. With lower sequencing costs and better assembly methods, we anticipate that many species for which there is no genomic information will undergo genome sequencing. Even for more well-known species, there may only be rough ploidy information available. In all these situations, it would be beneficial to have information on the ploidy of specific contigs.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>HiSeq Error Model</title>
<p>Examination of the quality score distribution showed an apparent excess of bases with quality 2 (<xref rid="pcbi.1004229.s001" ref-type="supplementary-material">S1 Fig</xref>), the lowest possible value, indicating that the base calling algorithm could not reliably call a nucleotide for over 12% of the cases. Furthermore, assessment of realized error probabilities showed a strong deviation from the expected value particularly for a quality score of 2 (<xref rid="pcbi.1004229.g001" ref-type="fig">Fig 1</xref>). These observations indicate that many sequenced nucleotides were inappropriately assigned a poor quality score. One approach for dealing with low scores would be to trim reads or remove entire reads. In Section <italic>Simulations</italic>, however, we show that such reads can be incorporated into the analysis of ploidy, provided an appropriate error model is used.</p>
<fig id="pcbi.1004229.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004229.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Sequencing error probabilities.</title>
<p>Observed sequencing error probability as a function of the Phred quality score (dots connected by the dotted line) and the expected error probability according to the expression 10<sup>(−<italic>QS</italic> /10)</sup>, where <italic>QS</italic> represents the quality score (solid line). There is overall agreement between empirical observations and theoretical expectation, expect for the quality score of 2.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.g001" position="float" xlink:type="simple"/>
</fig>
<p>Sequencing quality of the neighboring region gives further indication of whether a given nucleotide can be relied upon. In particular, it is known that nucleotides with high quality scores can nonetheless be of lower actual quality when surrounded by a region of low quality [<xref rid="pcbi.1004229.ref030" ref-type="bibr">30</xref>]. Our observed error probability surface over the nucleotide quality score and the average neighboring quality score does indeed show a slight bump in the plot for high quality nucleotides in a poor quality region (bottom part of <xref rid="pcbi.1004229.g002" ref-type="fig">Fig 2</xref>). More interestingly, however, we have also observed that the error probability is significantly increased when an intermediate quality nucleotide is surrounded by a high quality neighborhood.</p>
<fig id="pcbi.1004229.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004229.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Error probability surface depicting predictive influence of the average neighboring quality score.</title>
<p>Note that Phred quality score 2 was not included.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.g002" position="float" xlink:type="simple"/>
</fig>
<p>Modeling the sequencing error probability by taking into account quality score and neighboring quality score features, as well as specific nucleotide substitutions and the preceding sequenced nucleotides, resulted in a substantially superior fit over the quality score information alone, as shown by cross validation analyses. By doing so, we were also able to keep all aligned reads in the dataset, without removing allegedly low quality bases. We note that the modeling of sequencing errors is similar to the approach taken by some SNP calling methods, such as the one employed by GATK [<xref rid="pcbi.1004229.ref027" ref-type="bibr">27</xref>]. Evaluation of the error model on ploidy estimation is given in Section <italic>Simulations</italic>.</p>
</sec>
<sec id="sec004">
<title>Summary of the Ploidy Estimation Model</title>
<p>In our model, we assume that there are at most two possible alleles at any given position. For a genomic region with any given level of ploidy, herein denoted <italic>M</italic>, heterozygous sites in the genome can hold varying proportions of these two alleles. As an example, all heterozygous positions in a diploid region will display the two alleles in a 1:1 ratio. Alleles in a triploid region can be present in 2:1 or 1:2 ratios. A tetraploid can display the ratios 3:1, 2:2 and 1:3. In general, the number of heterozygous possibilities is <italic>M</italic>−1. This structure is captured in the generative model displayed in <xref rid="pcbi.1004229.g003" ref-type="fig">Fig 3</xref>. Because particular contigs or scaffolds can represent a varying number of copies in a polyploid individual, due to collapsing during assembly, this model assumes ploidy is constant along each contig, instead of along the entire genome.</p>
<fig id="pcbi.1004229.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004229.g003</object-id>
<label>Fig 3</label>
<caption>
<title>The graphical model for ploidy estimation and variant calls.</title>
<p>Each node represents a variable. Edges represent probabilistic dependencies. Each node is associated with a probability distribution of the corresponding variable conditioned on the variables corresponding to its parents. Variables within the same plate (rectangle) are replicated according to the number of positions in a contig (the “Positions” rectangle) or the number of reads overlapping a given position of a given contig (the “Reads” rectangle). Shaded variables represent the HiSeq error model, which is a component of the ploidy estimation model.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.g003" position="float" xlink:type="simple"/>
</fig>
<p>For a given contig or scaffold, the genotype at each position refers to the ratio between the two alleles. First, we define the probability of there being a SNP in any position as <italic>P</italic>(<italic>SNP</italic>). We then assume a uniform distribution for all possible heterozygous proportions, as done by others in a polyploid genotyping context [<xref rid="pcbi.1004229.ref031" ref-type="bibr">31</xref>], which corresponds to setting <inline-formula id="pcbi.1004229.e001"><alternatives><graphic id="pcbi.1004229.e001g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e001" xlink:type="simple"/><mml:math display="inline" id="M1" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>G</italic> denotes the dosage of the first allele, with <italic>g</italic> = 1, ⋯, <italic>M</italic>−1. The dosage of the other allele is consequently <italic>M</italic>−<italic>g</italic>. The order of alleles is defined arbitrarily without loss of generality. For <italic>g</italic> = 0 and <italic>g</italic> = <italic>M</italic>, which correspond to a position with no true variation, we set <inline-formula id="pcbi.1004229.e002"><alternatives><graphic id="pcbi.1004229.e002g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e002" xlink:type="simple"/><mml:math display="inline" id="M2" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula>, such that both possibilities are uniformly distributed. Lastly, for each read at each position, we assume that the true (unobserved) nucleotide follows a Bernoulli distribution with probability equal to the proportion of the first allele—that is, <inline-formula id="pcbi.1004229.e003"><alternatives><graphic id="pcbi.1004229.e003g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e003" xlink:type="simple"/><mml:math display="inline" id="M3" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mtext>Bern</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>T</italic> takes on the value 1 or 2 representing the first or second allele. Our previously learned HiSeq error model is then plugged into this ploidy model.</p>
<p>Our model takes into account information from all genomic positions of a given contig/scaffold, having a nested model for all reads covering each position. We use the model to infer the probability of observing each particular nucleotide in the dataset for all possible genotypes for any given ploidy, and subsequently infer the ploidy that maximizes the likelihood of the observed data. The default implementation sets a uniform prior for every ploidy, but prior information can be easily incorporated.</p>
<p>After selecting the ploidy with highest posterior probability, an estimate of the most likely genotype can be obtained for each individual position. More or less conservative thresholds, as well as other optional filters, can be used to call variants—that is, heterozygous genotypes.</p>
<p>The model is described in more detail in <italic>Methods</italic>.</p>
</sec>
<sec id="sec005">
<title>Simulations</title>
<p>To evaluate the performance of this ploidy estimation model, we simulated data from several different scenarios and applied the ConPADE method to each of them. We evaluated contigs with ploidy ranging from one to 16, consistent with the vast majority of real data. For example, potato is tetraploid (<italic>Solanum tuberosum</italic>, 2n = 4x = 48) [<xref rid="pcbi.1004229.ref021" ref-type="bibr">21</xref>], sweet potato is hexaploid (<italic>Ipomoea batatas</italic>, 2n = 6x = 90) [<xref rid="pcbi.1004229.ref032" ref-type="bibr">32</xref>], and sugarcane cultivars present different levels of ploidy, from 5X to 12X or more, with further aneuploidy (<italic>Saccharum spp</italic>, 2n = ca 110 to 120) [<xref rid="pcbi.1004229.ref033" ref-type="bibr">33</xref>]. We simulated coverage levels varying from 10X per copy, which is typically less than optimal, to a coverage of 75X per haploid copy, which is higher than the usually employed datasets, although currently practicable given the continuously decreasing costs of next-generation sequencing data. Some eukaryote genome sequencing projects have already used such depth of coverage [<xref rid="pcbi.1004229.ref034" ref-type="bibr">34</xref>,<xref rid="pcbi.1004229.ref035" ref-type="bibr">35</xref>].</p>
<p>To assess the effect of different levels of sequencing coverage, for each ploidy, we initially simulated a 10 Mb long contig, which is a long enough sequence to contain thousands of SNPs spaced at a reasonable distance. Our goal was to isolate the effect of sequencing coverage from contig length in this first set of simulations. Results from such simulations are shown in <xref rid="pcbi.1004229.s002" ref-type="supplementary-material">S2 Fig</xref> and <xref rid="pcbi.1004229.s008" ref-type="supplementary-material">S1 Table</xref>. When using the full error model, ploidy was correctly estimated in each experimental condition for depths of coverage of 15X and above. For the lowest coverage of 10X per haploid segment, ploidies from one to 11 were correctly called. However, for generated ploidies of 12 through 16, estimates were consistently downward biased such that the estimated ploidy was one unit below the underlying truth. Indeed, with low coverage, higher ploidies are expected to be harder to distinguish from one another, because of the increasingly smaller distances between the dosage-to-ploidy ratios. When using a “naïve” error model that only take quality scores into account, ploidy estimate errors were more substantial. For 10X coverage, the contig with ploidy eight was estimated as having ploidy 16, indicating that many sequencing errors were not correctly weighted by the error model. Furthermore, there was an error for coverage of 15X, because ploidy 15 was called as 14, which did not happen with the full model.</p>
<p>Having called the most likely ploidy for each simulated scenario, we then checked whether the dosages of both alleles were correctly inferred (<xref rid="pcbi.1004229.s009" ref-type="supplementary-material">S2 Fig</xref> and <xref rid="pcbi.1004229.s008" ref-type="supplementary-material">S1 Table</xref>). When using the full model, correct dosage was obtained for over 95% of the SNPs for levels of coverage of 50X and 75X, across every simulated ploidy. As expected, dosage calling accuracy decreased with decreasing coverage, reaching a minimum of 76.12% for ploidy 16 at 15X coverage. With the exception of two cases (ploidy eight, with coverage levels of 50X and 75X), percentage of correct dosages was always equal or lower when using the naïve error model. Discrepancies in dosage calling accuracy between the two models tended to increase with higher ploidy and lower coverage, such that in the most extreme situation of ploidy 16 at 15X coverage, the full model made 3.24% more correct calls. Higher levels of coverage resulted in more similar accuracies, with differences mostly below 2%. False positive and false negative levels of variant calling were extremely low for all simulations, never going above 1.7%.</p>
<p>These initial results indicate that ploidy estimation is more challenging for higher levels of ploidy, and that there can be random variation leading to errors in estimates. In order to provide estimates of ploidy calling accuracy with varying coverage levels, we simulated 100 sets of 200 kb-long contigs for each ploidy level and evaluated the performance of ConPADE in each situation. Results are shown in <xref rid="pcbi.1004229.g004" ref-type="fig">Fig 4</xref> and <xref rid="pcbi.1004229.s009" ref-type="supplementary-material">S2 Table</xref>, where warmer colors indicate higher ploidy estimation accuracy. For a coverage level of 50X, ploidy estimation with the full error model yielded correct results for all 100 simulated contigs, for all ploidy levels. The accuracy of ploidy estimation decreased with decreasing coverage, particularly for higher ploidies. In that context, we note that the lowest accuracies were 83%, 44% and 19% for coverages of 25X, 15X and 10X, respectively, for a ploidy of 15. It is interesting to note that, whenever ploidy was incorrectly called, the estimated and actual ploidy usually differed by at most two, and never more than three. Specific ploidy calls for coverage of 15X are found in <xref rid="pcbi.1004229.s003" ref-type="supplementary-material">S3 Fig</xref> and <xref rid="pcbi.1004229.s010" ref-type="supplementary-material">S3 Table</xref>.</p>
<fig id="pcbi.1004229.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004229.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Coverage simulation results.</title>
<p>Color in each cell indicates the percentage of correct ploidy calls, out of 100 simulations of 200 kb-long contigs for each ploidy level.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.g004" position="float" xlink:type="simple"/>
</fig>
<p>With regards to allele dosage estimation, we observed that 50X coverage resulted in correctly estimated dosages for 94% or more of the SNPs, for every simulated ploidy. Again, accuracy was reduced with decreasing coverage, reaching values as low as 86.08%, 75.56% and 64.32% for coverages of 25X, 15X and 10X, respectively, for the ploidy of 16. Finally, the sensitivity of variant detection was high for all simulated situations, with false negative rates for SNP calling ranging from zero to 7.05%. As expected, higher false negative rates occurred for the lower coverage levels. Similarly to what we observed for incorrect ploidy calls, estimated and actual allele dosage calls differed by one or two. Particular dosage calls for a ploidy of 15 with sequencing coverage of 15X are shown in <xref rid="pcbi.1004229.s004" ref-type="supplementary-material">S4 Fig</xref> and <xref rid="pcbi.1004229.s011" ref-type="supplementary-material">S4 Table</xref>. The latter table also shows that dosage calling accuracy was lower for intermediate allele ratios, because of the larger variance of the Bernoulli distribution for intermediate probability values. For example, a SNP with allele ratio 7:8 resulted in lower dosage accuracy than a SNP with allele ratio 13:2. It is worth mentioning that we conducted some of the above simulations with 10 Mb-long contigs, but saw little improvement over the 200 kb length. Similarly, coverage of 75X was only slightly superior to 50X coverage.</p>
<p>When using the naïve error model, ConPADE achieved substantially lower ploidy estimation accuracy, especially for coverages of 10X and 15X at intermediate ploidy levels (<xref rid="pcbi.1004229.g004" ref-type="fig">Fig 4</xref> and <xref rid="pcbi.1004229.s009" ref-type="supplementary-material">S2 Table</xref>). Even for 25X coverage, with ploidies 14 and above, the naïve model failed to provide correct estimates in many instances. Investigation of the likelihoods showed that the naïve model did not appropriately control for the influence of sequencing errors, which led to overestimated ploidy levels. This can be seen more clearly for the ploidy of 16 at 10X coverage, which displayed inflated accuracy due to the fact that this error model up-biased ploidy estimates. In the cases where ploidy was correctly inferred, the naïve and full error models showed only minor differences in dosage calling accuracy. For ploidies above three, the full model always produced more correct dosage calls than the naïve model, with differences ranging from 0.10% (ploidy level four, coverage of 50X) to 2.83% (ploidy 16, 15X coverage). The sensitivity of variant calling of the naïve error model was greater than that of the full error model, particularly for low coverage situations, which is indicative of its less conservative nature (<xref rid="pcbi.1004229.s009" ref-type="supplementary-material">S2 Table</xref>). With higher coverage levels, both models had similar false negative rates of SNP discovery.</p>
<p>Because a coverage level of 50X resulted in correct estimated ploidies and high dosage estimation accuracy in the previous simulation sets, while still being viable in practice for <italic>de novo</italic> genome assembly efforts, we chose this value for more detailed simulations regarding contig lengths, the results of which are shown in <xref rid="pcbi.1004229.g005" ref-type="fig">Fig 5</xref> and <xref rid="pcbi.1004229.s012" ref-type="supplementary-material">S5 Table</xref>. For contigs of 20,000 nucleotides or longer, which in this case contain 100 informative variants on average, the full model resulted in correct ploidy estimates in every simulated dataset. For very small contigs, containing only a handful of SNPs, ploidy estimation accuracy decreased with increasing ploidy, with 60 to 70% of correct estimates for ploidies over 13. Once more, the percentage of correctly called dosages was above or close to 95%, providing evidence that, given the correct ploidy, dosage estimation with this level of coverage is accurate. False negative rates were higher for shorter contigs, due to the fact that there was lower or no read coverage on the edges of contigs (<xref rid="pcbi.1004229.s012" ref-type="supplementary-material">S5 Table</xref>).</p>
<fig id="pcbi.1004229.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004229.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Length simulation results.</title>
<p>Color in each cell indicates the percentage of correct ploidy calls, out of 100 simulations of contigs sequenced at 50X coverage for each ploidy level.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.g005" position="float" xlink:type="simple"/>
</fig>
<p>ConPADE yielded less accurate ploidy estimates for short contigs when combined with the naïve error model, especially for higher ploidy levels, with differences of up to 16% between the two models, as was the case for ploidy 16. Contigs of 20,000 bases or more displayed similar results between both error models, with slightly lower dosage estimation accuracy for the naïve model. Again, false negative rates tended to be slightly lower with the naïve model, indicating a more conservative nature of the full model, because the simpler model resulted in a larger number of SNP calls (<xref rid="pcbi.1004229.s012" ref-type="supplementary-material">S5 Table</xref>).</p>
<p>Finally, to assess the ploidy estimation accuracy profile on different coverage levels and contig length combinations, we downsampled the latter simulations to achieve coverages of 25X and 15X, for ploidies varying from one to eight, which are the most commonly observed in practice. The results are shown in <xref rid="pcbi.1004229.s005" ref-type="supplementary-material">S5 Fig</xref>. There was little effect of contig length for 50X sequencing coverage, and ploidies were called with a minimum accuracy of 93% across all conditions. When coverage dropped to 25X, contigs of 2,000 bases yielded correct estimates 75% or more of the time for ploidies of seven or less, and 20,000 bp contigs performed almost as well as the longest ones for all ploidy levels. Lastly, coverage of 15X allowed accurate estimation only for ploidies lower than or equal to four, in the case of short 2,000 bp contigs, while the intermediate contig length still afforded reliable ploidy estimates in all scenarios.</p>
<p>Collectively, these simulation results show that high ploidy levels can be reliably estimated only with high sequencing coverage, even for long contigs. Short contigs require higher depths of coverage, but still produce useful results in low coverage circumstances when the true ploidy is low.</p>
</sec>
<sec id="sec006">
<title>Switchgrass Dataset</title>
<p>To further evaluate our ploidy estimation model, we analyzed a real dataset for Switchgrass. Switchgrass (<italic>Panicum virgatum</italic> L.) is a member of the grasses (<italic>Poaceae</italic> family) and has recently gained importance as a source of bioenergy [<xref rid="pcbi.1004229.ref036" ref-type="bibr">36</xref>]. It is believed that most grasses are polyploids, with occurring instances of autopolyploidy, allopolyploidy and aneuploidy [<xref rid="pcbi.1004229.ref037" ref-type="bibr">37</xref>]. Switchgrass, in particular, is comprised of (pseudo)tetraploid and octoploid genotypes, some of which are commonly aneuploid and display genome instability [<xref rid="pcbi.1004229.ref038" ref-type="bibr">38</xref>].</p>
<p>We used the preliminary <italic>Panicum virgatum</italic> AP13 genome reference as a test case for our model. AP13 is a tetraploid clone with two sub-genomes, which are highly similar in some genomic segments, due to the recentness of the polyploidization event [<xref rid="pcbi.1004229.ref036" ref-type="bibr">36</xref>]. The reference genome consists of an assembly of 15X coverage of the expected 1.4 Gb genome with Roche 454 data, which resulted in a total of 410,030 contigs with L50 of 4.2 kb. The contig length distribution from this assembly is shown in <xref rid="pcbi.1004229.s006" ref-type="supplementary-material">S6 Fig</xref>. Total assembly length was 1.358 Gb. Next, we downloaded from the NCBI Sequence Read Archive whole genome shotgun reads from the same genotype, obtained through the Illumina HiSeq 2000 platform, in a total of 106.4 Gb of sequence data, and aligned all read pairs against the reference genome.</p>
<p>From 5,000 randomly sampled contigs, 4,879 had at least one aligned read pair and could be analyzed. Average sequencing coverage was 232.2X. The distribution of estimated ploidies for these 4,879 contigs showed that almost 90% of them (4,381) represented more than four collapsed haploid copies. In particular, we observed a peak at ploidy eight. The fact that many contigs displayed ploidies higher than the expected organismal ploidy likely indicates contigs containing paralogous regions collapsed into a single reference sequence.</p>
<p>Overall, we called 134,464 variants within the contigs, with an average density of one SNP every 47 nucleotides. Manual examination of the called SNPs showed that, without explicitly enforcing any filter or threshold, all heterozygous positions had at least three reads supporting the minor allele, from a total of at least seven overlapping reads. We also performed variant calling with GATK [<xref rid="pcbi.1004229.ref027" ref-type="bibr">27</xref>] and obtained a density of one SNP every 60 bases. We note that these SNP densities may be inflated due to homoeologue collapse and may not reflect exclusively allelic variation.</p>
<p><xref rid="pcbi.1004229.g006" ref-type="fig">Fig 6</xref> displays observed allele ratios for called variants, from examples of contigs representative of each estimated ploidy. Allele ratios were in agreement with possible values given estimated ploidies, as visualized by distances of individual SNPs from the dashed lines. It is also interesting to note that allele ratios provide a rough guide to sequence diversity within a given segment. For instance, contig 238988 had an estimated ploidy of six and virtually all called variants displayed an allele ratio of 1:5 (<xref rid="pcbi.1004229.g006" ref-type="fig">Fig 6E</xref>). In other words, most identified SNPs presented only one copy of the less frequent allele. A closer look at the reads aligned against a region containing some of the variants in that contig provides a picture of how the alleles are organized in haplotypes (<xref rid="pcbi.1004229.s007" ref-type="supplementary-material">S7 Fig</xref>). Interestingly, in this case, most minor alleles are linked to each other in the same reads, forming a single haplotype. This haplotype is present in a roughly 1:5 ratio with regards to the underlying reference sequence.</p>
<fig id="pcbi.1004229.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004229.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Observed allele ratios of variants called by ConPADE for switchgrass contigs with various estimated ploidies.</title>
<p>Each dot represents a significantly identified variant position. For each estimated ploidy, dashed lines represent expected genotypes.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.g006" position="float" xlink:type="simple"/>
</fig>
<p>It is also interesting to investigate the distribution of estimated genotypes, because doing so can provide insights about how the genome is structured. Because genotype AP13 is expected to be a tetraploid, we focus on contigs with an estimated ploidy of four (<xref rid="pcbi.1004229.g007" ref-type="fig">Fig 7</xref>). The apparent excess of SNPs with genotype 2/2 possibly reflects the (pseudo)tetraploid nature of this particular switchgrass individual, such that these SNPs likely arise from differences between the two sub-genomes. Additionally, this result provides empirical evidence that our uniform parameterization for genotypes does not excessively constrain <italic>a posteriori</italic> estimates of allele dosage, given moderate sequencing coverage levels.</p>
<fig id="pcbi.1004229.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004229.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Genotype distribution for switchgrass contigs with a ploidy estimate of four.</title>
<p>Bars represent the frequency of each SNP genotype, for all identified variants in contigs estimated to have ploidy four.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.g007" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec007">
<title>Wheat Dataset</title>
<p>In the Switchgrass analysis, we saw examples where the estimated ploidy of a contig was greater than the known organismal ploidy due to potential collapse of non-allelic regions in the assembly. We also investigated possible collapse in wheat. Common wheat (<italic>Triticum aestivum</italic> L.) is an important food source, cultivated worldwide to provide carbohydrates and protein for human consumption. The genome is allohexaploid (2<italic>n</italic> = 6<italic>x</italic> = 42) containing three related subgenomes, denoted A, B and D. It is believed that the A genome was donated by a species related to <italic>T</italic>. <italic>urartu</italic> (2<italic>n</italic> = 2<italic>x</italic> = 14), the B genome from a relative of <italic>Aegilops speltoides</italic> (2<italic>n</italic> = 2<italic>x</italic> = 14), and the D genome from <italic>Aegilops tauschii</italic> (2<italic>n</italic> = 2<italic>x</italic> = 14). Cultivated common wheat thus has genomic constitution AABBDD [<xref rid="pcbi.1004229.ref039" ref-type="bibr">39</xref>]. The complete polyploid genome is 17 Gb in length [<xref rid="pcbi.1004229.ref034" ref-type="bibr">34</xref>].</p>
<p>Because of its size and complexity, a draft sequence of the wheat genome was created by sequencing and assembly of isolated chromosome arms, instead of a complete <italic>de novo</italic> genome assembly. Chromosome arms were sequenced with Illumina short read technologies and assembled with ABySS [<xref rid="pcbi.1004229.ref040" ref-type="bibr">40</xref>]. Owing to the employed strategy, based on physical separation of individual chromosome arms, the true ploidy of each partial assembly is one.</p>
<p>To investigate the effectiveness of ConPADE in that situation, as a validation procedure, we initially applied it to sequence data from the large arm of chromosome 5D—that is, chromosome 5 from the subgenome D. This data contains 236.8 Mb of sequence, with a contig L50 of 2,647 bp, and is expected to cover roughly half of the complete long arm of chromosome 5D.</p>
<p>After stringent read alignment, we could evaluate the ploidy of a set of 16,684 contigs with varying levels of coverage. More than 80% of the contigs (13,385) were confirmed to have a ploidy of one, that is, were inferred to represent a single haploid segment. Contigs with a ploidy level of two represented almost 9% of the total (1,499), as did contigs with a ploidy of four (1,471). Only 329 contigs (1.97% of the total) had an estimated ploidy of three (<xref rid="pcbi.1004229.g008" ref-type="fig">Fig 8</xref>).</p>
<fig id="pcbi.1004229.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004229.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Ploidy estimate distribution for common wheat chromosome arm 5D contigs.</title>
<p>Bars represent the frequency of each ploidy estimated by ConPADE, for a set of 16,684 wheat contigs from the <italic>de novo</italic> assembly of chromosome arm 5D.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.g008" position="float" xlink:type="simple"/>
</fig>
<p>Investigation of 30 contigs with estimated ploidy above one revealed that most contain repetitive DNA sequences, with enrichment for known mobile elements, particularly transposons and retrotransposons, ribosomal RNA genes, centromeric and telomeric sequences (<xref rid="pcbi.1004229.s013" ref-type="supplementary-material">S6 Table</xref>). Furthermore, common wheat has been shown to exhibit intrachromosomal gene duplication at higher degrees than other grasses, likely arising by tandem duplication. Even more importantly, there is evidence that the current individual chromosome arm assemblies may underestimate the occurrence of gene duplication, due to inappropriate collapse of very similar duplicates [<xref rid="pcbi.1004229.ref040" ref-type="bibr">40</xref>]. Our ploidy estimation results provide candidates of this phenomenon for further investigation.</p>
<p>To gauge the applicability of ConPADE to an allopolyploid of known genomic origins, we fashioned the scenario that would be obtained had the wheat genome been sequenced via a whole genome shotgun strategy. With this goal, we pooled sequencing reads from the large arm of chromosomes 5A, 5B and 5D and assembled them following a strategy similar to that employed in the published assembly of the wheat genome [<xref rid="pcbi.1004229.ref040" ref-type="bibr">40</xref>]. This assembly yielded 771.3 Mb of sequence, with a contig L50 of 2,253 bp.</p>
<p>As a benchmark for our method, we aligned these assembled contigs to the three separate published assemblies with BLAST [<xref rid="pcbi.1004229.ref041" ref-type="bibr">41</xref>], assessing in how many of the subgenomes any newly assembled contig was present. Interestingly, roughly 99% of the analyzed contigs (43,461 out of 43,819) were found in a single subgenome of the three original assemblies, providing evidence that the three wheat subgenomes are different enough that the assembler was able to separate them into different contigs.</p>
<p>Application of our method to this dataset revealed that approximately 93% of the contigs had a ploidy estimate consistent with what was expected based on subgenome assignment by the previous benchmark alignments (<xref rid="pcbi.1004229.t001" ref-type="table">Table 1</xref>). In the case of contigs that could be assigned to a single genome, ConPADE had an accuracy of 93.51%, and most of cases in which the ploidy was incorrectly called were due to subregions of a given contig being contaminated with reads from the other subgenomes, leading to an upward bias in ploidy estimates. In cases where there was collapse of two or the three genomes, accuracy dropped to 68.20% and 58.67%, respectively. However, manual inspection showed that these contigs were usually shorter than 2 kb and had lower coverage. Confining the analysis to contigs for which the average coverage was 25X or above yielded 100% correct ploidy calls.</p>
<table-wrap id="pcbi.1004229.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004229.t001</object-id>
<label>Table 1</label> <caption><title>Ploidy estimation for an artificially combined wheat dataset.</title></caption>
<alternatives>
<graphic id="pcbi.1004229.t001g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.t001" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">Number of subgenomes in which a contig was found<xref rid="t001fn002" ref-type="table-fn"><sup>a</sup></xref></th>
<th colspan="4" align="center" rowspan="1">Estimated ploidy</th>
</tr>
<tr>
<th align="left" rowspan="1" colspan="1"/>
<th align="left" rowspan="1" colspan="1">One</th>
<th align="left" rowspan="1" colspan="1">Two</th>
<th align="left" rowspan="1" colspan="1">Three</th>
<th align="left" rowspan="1" colspan="1">Four</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">One</td>
<td align="left" rowspan="1" colspan="1">40,642</td>
<td align="left" rowspan="1" colspan="1">244</td>
<td align="left" rowspan="1" colspan="1">230</td>
<td align="left" rowspan="1" colspan="1">2,345</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Two</td>
<td align="left" rowspan="1" colspan="1">26</td>
<td align="left" rowspan="1" colspan="1">193</td>
<td align="left" rowspan="1" colspan="1">44</td>
<td align="left" rowspan="1" colspan="1">20</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Three</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">18</td>
<td align="left" rowspan="1" colspan="1">44</td>
<td align="left" rowspan="1" colspan="1">12</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>Reads from the large arms of chromosomes 5A, 5B and 5D were pooled, assembled and used for ploidy estimation. Only contigs with average coverage of 10X or above, and for which the individual ploidy in a given subgenome was estimated to be one were considered.</p></fn>
<fn id="t001fn002"><p><sup>a</sup>Based on BLAST alignments to the individual assemblies.</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
</sec>
<sec id="sec008" sec-type="conclusions">
<title>Discussion</title>
<p>We have presented a ploidy estimation model and verified with both simulated and real data that it gave correct results when sufficient read coverage was available. We have also observed that it can be successfully applied to variant calling in newly assembled genomes.</p>
<p>When learning the parameters of the HiSeq error model, bacterial data was utilized and any variations from the reference genome for the same strain were regarded as sequencing errors. Even monomorphic bacterial strains may hold some genetic variability, and hence these variations may have erroneously inflated error rates. Moreover, some of the reference genomes were originally assembled from HiSeq data, such that systematic errors may have been considered as ground truth. Nonetheless, given the rarity of such events and the large amount of data used, these sources of inaccuracies should have little effect on the final parameters learned, and as we observed empirically, led to good performance of our model.</p>
<p>An underlying assumption of ConPADE is that ploidy is constant along each contig or scaffold, a good assumption in practice for the task at hand. This is fundamentally different from copy number variant detection algorithms, which look for changes in allele ratios (<italic>e</italic>.<italic>g</italic>., using a Hidden Markov Model) [<xref rid="pcbi.1004229.ref024" ref-type="bibr">24</xref>] or read coverage [<xref rid="pcbi.1004229.ref025" ref-type="bibr">25</xref>] to find discrepancies from a reference sequence. The assumption of constant ploidy for any given contig makes inference computationally more efficient than (<italic>e</italic>.<italic>g</italic>.) a Hidden Markov Model that allows for changes in copy number, and is also particularly well suited given shorter contig lengths for polyploid genome assemblies. Furthermore, with the assumption of constant ploidy, all positions (SNP or not) can be included in the model without compromising feasibility.</p>
<p>Ploidy estimation is also commonly done in cancer research. However, because cancer is an abnormality derived from a naturally occurring diploid state, the nature of the polyploidy is vastly different, and methods for ploidy estimation in cancer rely on different assumptions. In the cancer framework, a single haplotype is usually expected to be present in multiple copies. As a consequence, heterozygous positions in long stretches of the genome are expected to display the same allele ratio. Consequently, methods for ploidy estimation in cancer can make use of segmentation algorithms to look for particular regions of the genome departing from diploidy [<xref rid="pcbi.1004229.ref042" ref-type="bibr">42</xref>,<xref rid="pcbi.1004229.ref043" ref-type="bibr">43</xref>]. In contrast, for polyploid plants, there is no such restriction. The ancestral genotypes leading to the polyploid genotype under analysis, which are potentially polyploid themselves, may have varying allele dosages. In addition, evolution and/or artificial selection during breeding will drastically alter the genomic constitution and shape different genomic configurations, and ploidy estimation in a plant research context needs to be more flexible to accommodate multiple sources of polyploidy.</p>
<p>Another assumption that deserves attention is the fact that only biallelic variations are considered in the model. Combinatorial possibilities of up to four different alleles in different dosages would result in an exceedingly large number of model states to be fit, which would make analysis infeasible. Nonetheless, there is some evidence that SNPs, even for species with high degrees of ploidy, are generally biallelic [<xref rid="pcbi.1004229.ref031" ref-type="bibr">31</xref>]. In our default implementation, we assumed a uniform distribution for possible dosages within any given ploidy. Because genotypes being sequenced for <italic>de novo</italic> assembly of important crop species are usually chosen from a pool of bred cultivars, the recurrent cycles of crossing and selection make expectations about allele dosage distribution non-trivial. In other situations, such as when a wild genotype is sequenced, it may be more appropriate to assume an exponential distribution for dosages, due to the presence of rare mutations. When more sequencing and SNP data becomes available for higher ploidy species, the empirical distribution of dosages might become more apparent for many distinct scenarios. As such data is gathered, it is straightforward to change the underlying assumption and incorporate such knowledge into our framework. Accurate information about the dosage of each variant will be very useful for downstream analyses such as association studies, where the number of copies of a given locus can have an effect on a phenotype of interest.</p>
<p>In principle, it is possible to leverage information both from SNPs and indels for ploidy estimation. However, ConPADE utilizes only SNPs, because (1) current sequencing technologies lack sensitivity to identify indels, (2) indel processing is more complex than SNP processing [<xref rid="pcbi.1004229.ref044" ref-type="bibr">44</xref>] and (3) indels are usually less abundant than SNPs [<xref rid="pcbi.1004229.ref045" ref-type="bibr">45</xref>,<xref rid="pcbi.1004229.ref046" ref-type="bibr">46</xref>] and would thus contribute little information for ploidy estimation.</p>
<p>From a computational standpoint, exact inference in our model can be performed efficiently for scaffolds that are millions of base pairs long and covered at high sequencing depth. Probabilities arising from the error model can be cached, enhancing efficiency. Also, because each contig/scaffold is analyzed independently from all the others, execution is easily parallelized.</p>
<p>The single input required by the method is a BAM file with alignments of reads or read pairs against the final assembly. The user has control over which short read aligner to use and how to filter alignments. During our experiments with real and simulated data, only reads that aligned to a unique point in the genome with high mapping quality were included in the analysis to reduce occurrence of spurious alignments. In addition, whenever mate information is available, only pairs aligned with the expected range of distances should be considered.</p>
<p>Because ConPADE is based on allele ratios in heterozygous positions, alignment parameters may have a significant impact on the results obtained. In particular, if two distinct genomic regions are sufficiently different such that the assembly software is able to separate them into two distinct contigs, some of the sequencing reads will ambiguously align with both contigs, and will thus have low mapping quality. This situation can be avoided by excluding low quality reads from the analysis.</p>
<p>It is important to stress that our model accommodates all possible <italic>M</italic>−1 heterozygous allele ratios for a genomic region with ploidy <italic>M</italic>, but it is not necessary that they all be present simultaneously. Furthermore, it is interesting to note that SNPs in which the major/minor alleles are present in a <italic>M</italic>−1 to 1 ratio are the most informative ones, since they cannot be present in lower ploidy levels. Because this particular configuration is expected to be more frequent than others in some cases, we note that this situation affords the ideal ploidy estimation scenario.</p>
<p>Simulation results also indicated that ConPADE works well for contigs of small size, on the order of a few thousand nucleotides in length. This is crucial for de novo assemblies of polyploid genomes, which are naturally more fragmented due to genomic complexity. Although high sequencing coverage is necessary for accurate ploidy and allele dosage estimation, we expect that high coverage data will be available for many species with complex genomes in the near future, affording more reliable results and the chance for important insights into their genomic organization.</p>
<p>Variant calling performance was also good, showing that the error model was slightly more conservative than a simple model that only takes quality scores into account. However, the full model was able to leverage information that would otherwise be disregarded. Such a conservative model that performs well on high coverage situations is naturally suited to a newly assembled genome, where large numbers of reads are usually available due to the difficulty of <italic>de novo</italic> assembly. Notwithstanding, because the correct estimation of ploidy is not overly sensitive to the error model used, it is important to note that our goal in developing this model was to make it complex enough to ensure accurate results, while keeping it simple enough to allow efficient computation. Complexity of the ploidy estimation algorithm is only marginally increased with the full model—that is, we only need to gather auxiliary information within the neighborhood of each nucleotide. In such context, the more informative error model is nevertheless advantageous.</p>
<p>Analysis of a real switchgrass dataset revealed potential issues with the current reference assembly—namely the fact that several contigs may represent paralogs or anciently duplicated regions, which should ideally be separated. We analyzed a small fraction of the switchgrass genome assembly because these data are not yet openly released for whole genome-scale analyses. Indeed, polyploid datasets are only now being extensively obtained; and we propose ConPADE in anticipation of such datasets becoming more commonly analyzed. Additionally, because this is a novel task, to the best of our knowledge, there are currently no other approaches for solving it.</p>
<p>We also analyzed a fraction of the latest wheat genome assembly, which leverages physical chromosome arm separation to reduce assembly complexity. Results for this haploid assembly provided clues about the annotation of repetitive elements, known or putative, and further provided candidates for the inference of intrachromosomal gene duplication. This scenario illustrates other possible applications for ConPADE. Furthermore, we have shown that application of our method to a mock whole genome shotgun assembly of the polyploid wheat genome would correctly identify the ploidy of almost 93% of the contigs, indicating that most of them could be separated by the genome assembler, with very limited collapse of the three subgenomes. When additional WGS data from polyploid species become available, this method can be more extensively tested and improved as necessary. Particularly, the HiSeq error model can be improved to take into account other sources of information about errors or to represent more complex models, for example the inclusion of interactions between variables, or the use of models other than logistic regression to assign error probabilities.</p>
<p>ConPADE is available as a binary executable at <ext-link ext-link-type="uri" xlink:href="https://github.com/microsoftgenomics" xlink:type="simple">https://github.com/microsoftgenomics</ext-link>. Source code will be available in the near future.</p>
</sec>
<sec id="sec009" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec010">
<title>HiSeq Error Model</title>
<p>We downloaded data from six different bacterial organisms from the NCBI Sequence Read Archive, according to the following accession numbers: <italic>Eschericia coli</italic> (SRX131047), <italic>Klebsiella oxytoca</italic> (SRX101577), <italic>Mycobacterium tuberculosis</italic> (SRX084335), <italic>Rhodobacter sphaeroides</italic> (SRX160387), <italic>Staphylococcus aureus</italic> (SRX096307) and <italic>Streptococcus pneumoniae</italic> (SRX110128) (<xref rid="pcbi.1004229.t002" ref-type="table">Table 2</xref>). These species were chosen to represent different bacterial groups with a range of genomic GC contents, and to meet the following criteria: (1) high coverage obtained from whole genome sequencing with the Illumina HiSeq platform, and (2) availability of a finished reference genome for the corresponding strain with a single contig/scaffold closely representing the entire chromosome. We gave preference to curated reference genomes sequenced through capillary methods, whenever possible.</p>
<table-wrap id="pcbi.1004229.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004229.t002</object-id>
<label>Table 2</label> <caption><title>Bacterial datasets used to learn the error model.</title></caption>
<alternatives>
<graphic id="pcbi.1004229.t002g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.t002" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">Species</th>
<th align="left" rowspan="1" colspan="1">Strain</th>
<th align="left" rowspan="1" colspan="1">Genome size (Mb)</th>
<th align="left" rowspan="1" colspan="1">GC content (%)</th>
<th align="left" rowspan="1" colspan="1">Coverage (X)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>S</italic>. <italic>aureus</italic></td>
<td align="left" rowspan="1" colspan="1">MRSA252</td>
<td align="left" rowspan="1" colspan="1">2.90</td>
<td align="left" rowspan="1" colspan="1">32.8</td>
<td align="left" rowspan="1" colspan="1">1,096.43</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>S</italic>. <italic>pneumoniae</italic></td>
<td align="left" rowspan="1" colspan="1">Tigr4</td>
<td align="left" rowspan="1" colspan="1">2.16</td>
<td align="left" rowspan="1" colspan="1">39.7</td>
<td align="left" rowspan="1" colspan="1">533.43</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>E</italic>. <italic>coli</italic></td>
<td align="left" rowspan="1" colspan="1">K-12 sub. MG1655</td>
<td align="left" rowspan="1" colspan="1">4.64</td>
<td align="left" rowspan="1" colspan="1">50.8</td>
<td align="left" rowspan="1" colspan="1">239.63</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>K</italic>. <italic>oxytoca</italic></td>
<td align="left" rowspan="1" colspan="1">10–5248</td>
<td align="left" rowspan="1" colspan="1">6.03<xref rid="t002fn001" ref-type="table-fn"><sup>a</sup></xref></td>
<td align="left" rowspan="1" colspan="1">55.0</td>
<td align="left" rowspan="1" colspan="1">122.59</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>M</italic>. <italic>tuberculosis</italic></td>
<td align="left" rowspan="1" colspan="1">H37Rv</td>
<td align="left" rowspan="1" colspan="1">4.41</td>
<td align="left" rowspan="1" colspan="1">65.6</td>
<td align="left" rowspan="1" colspan="1">633.32<xref rid="t002fn002" ref-type="table-fn"><sup>b</sup></xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>R</italic>. <italic>sphaeroides</italic></td>
<td align="left" rowspan="1" colspan="1">2.4.1</td>
<td align="left" rowspan="1" colspan="1">3.19+0.94</td>
<td align="left" rowspan="1" colspan="1">68.8</td>
<td align="left" rowspan="1" colspan="1">234.80</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001"><p><sup>a</sup>For <italic>K</italic>. <italic>oxytoca</italic>, only the largest contig was used, representing approximately 96.95% of the genome.</p></fn>
<fn id="t002fn002"><p><sup>b</sup>For <italic>M</italic>. <italic>tuberculosis</italic>, we sampled a small portion of the data to avoid oversampling a single genome (original coverage for downloaded data was 5,598.69X).</p></fn>
</table-wrap-foot>
</table-wrap>
<p>We downloaded reference genomes from the NCBI genome archive according to the following assembly numbers: ASM584v1 (<italic>E</italic>. <italic>coli</italic>), PB_Kleb_oxyt_10–5248_V1 (<italic>K</italic>. <italic>oxytoca</italic>), ASM19595v1 (<italic>M</italic>. <italic>tuberculosis</italic>), ASM1290v1 (<italic>R</italic>. <italic>sphaeroides</italic>), ASM1150v1 (<italic>S</italic>. <italic>aureus</italic>) and ASM688v1 (<italic>S</italic>. <italic>pneumoniae</italic>). We aligned the reads against the corresponding reference genome with the Scalable Nucleotide Alignment Program (SNAP) [<xref rid="pcbi.1004229.ref047" ref-type="bibr">47</xref>] using default parameters, which are tuned for short reads: seed size of 20, maximum combined edit distance of 15 for both reads in a pair, with 25 seeds per read and a maximum of 250 hits considered per seed. We only considered uniquely aligned read pairs for which the distance between mates was within the expected library range.</p>
<p>Next we compared the observed and reference nucleotide, assuming all reference genomes contained no errors. Because real variability is rare in monomorphic bacterial strains, differences between an observed and reference nucleotide are likely due to sequencing errors. We also collected a set of informative features from each available nucleotide: (1) the associated quality score, (2) the neighboring quality score—that is, the average of ten adjacent bases, five on each side, (3) whether the nucleotide was preceded by the 2-mer GG, and (4) the specific nucleotide substitution that took place. Previous studies showed that these features provide more information about the occurrence of (systematic) errors beyond the quality score [<xref rid="pcbi.1004229.ref030" ref-type="bibr">30</xref>,<xref rid="pcbi.1004229.ref048" ref-type="bibr">48</xref>,<xref rid="pcbi.1004229.ref049" ref-type="bibr">49</xref>]. We used these data to estimate parameters of our model relating to the probability of there being a sequencing error, that is, parameters associated with arcs pointing to the <italic>Sequencing error</italic> and <italic>Observed nucleotide</italic> variables in the graphical model of <xref rid="pcbi.1004229.g003" ref-type="fig">Fig 3</xref>.</p>
<p>We held the model structure fixed and estimated parameters for two sets of models. First, we fit a logistic regression model to assign an error probability to each nucleotide observation, with input features representing the logarithm of the quality score, the logarithm of the neighboring quality score, and for each of the four possible nucleotides, whether the base at hand was preceded by the 2-mer GG [<xref rid="pcbi.1004229.ref049" ref-type="bibr">49</xref>]. The model can be represented as follows:
<disp-formula id="pcbi.1004229.e004">
<alternatives>
<graphic id="pcbi.1004229.e004g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e004" xlink:type="simple"/>
<mml:math display="block" id="M4" overflow="scroll">
<mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mi>Q</mml:mi><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>E</italic> = 1 represents the event of a sequencing error; <italic>T</italic> represents the true nucleotide, with <italic>t</italic> = {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>T</italic>}; <italic>GG</italic> is an indicator variable taking value 1 if the nucleotide is preceded by GG and 0 otherwise; <italic>QS</italic> represents the Phred quality score; <italic>NQS</italic> is the average neighboring quality score (<italic>i</italic>.<italic>e</italic>., the average of the 10 closest bases, five on each side); <italic>α</italic><sub><italic>t</italic>,<italic>gg</italic>,<italic>q</italic></sub>, <italic>β</italic><sub><italic>t</italic>,<italic>gg</italic>,<italic>q</italic></sub> and <italic>γ</italic><sub><italic>t</italic>,<italic>gg</italic>,<italic>q</italic></sub> are parameters of the model, with <italic>q</italic> an indicator variable taking value 1 if the sequenced base at hand has a quality score of 2 and 0 otherwise. Parameters <italic>β</italic><sub><italic>t</italic>,<italic>gg</italic>,1</sub> were fixed at zero, to take into account the fact that nucleotides with quality 2 deviate from the general trend. We used the scikit-learn Python package to train this model [<xref rid="pcbi.1004229.ref050" ref-type="bibr">50</xref>]. We applied a 4-fold cross validation scheme to compare this model with the naïve error model that only uses the Phred quality score and sets the probability of observing an error to be <italic>P</italic>(<italic>E</italic> = 1|<italic>QS</italic> = <italic>qs</italic>) = 10<sup>(−<italic>qs</italic>/10)</sup>.</p>
<p>Second, we also used the data to learn specific substitution rates—that is, to estimate probabilities that a given nucleotide was replaced by another specific one. To that end, we estimated multinomial probabilities to represent specific substitution rates, both for cases where the nucleotide was preceded by GG or not. We employed a 10-fold cross validation step to evaluate the fit of the model.</p>
</sec>
<sec id="sec011">
<title>Ploidy Estimation Model</title>
<p>The likelihood of the model depicted in <xref rid="pcbi.1004229.g003" ref-type="fig">Fig 3</xref> is given by:
<disp-formula id="pcbi.1004229.e005">
<alternatives>
<graphic id="pcbi.1004229.e005g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e005" xlink:type="simple"/>
<mml:math display="block" id="M5" overflow="scroll">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="3em"/><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Q</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>Q</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mi>q</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="3em"/><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mi>Q</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mi>q</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="3em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
</disp-formula>
where <italic>p</italic> = 1,⋯, <italic>C</italic> corresponds to a position in a contig of length <italic>C</italic>, <italic>i</italic><sub><italic>p</italic></sub> = 1,⋯, <italic>n</italic><sub><italic>p</italic></sub> is the <italic>i</italic>th read covering position <italic>p</italic> and <italic>n</italic><sub><italic>p</italic></sub> is the total number of reads covering the same position, <inline-formula id="pcbi.1004229.e006"><alternatives><graphic id="pcbi.1004229.e006g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e006" xlink:type="simple"/><mml:math display="inline" id="M6" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is an observed variable indicating whether a nucleotide is preceded by GG, <inline-formula id="pcbi.1004229.e007"><alternatives><graphic id="pcbi.1004229.e007g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e007" xlink:type="simple"/><mml:math display="inline" id="M7" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the associated quality score; <inline-formula id="pcbi.1004229.e008"><alternatives><graphic id="pcbi.1004229.e008g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e008" xlink:type="simple"/><mml:math display="inline" id="M8" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mi>Q</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the neighboring quality score (<italic>i</italic>.<italic>e</italic>., the average of the 10 closest bases, five on each side), <inline-formula id="pcbi.1004229.e009"><alternatives><graphic id="pcbi.1004229.e009g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e009" xlink:type="simple"/><mml:math display="inline" id="M9" overflow="scroll"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> represents whether the current base is a sequencing error or not, <inline-formula id="pcbi.1004229.e010"><alternatives><graphic id="pcbi.1004229.e010g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e010" xlink:type="simple"/><mml:math display="inline" id="M10" overflow="scroll"><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> denotes the observed nucleotide for read <italic>i</italic> in position <italic>p</italic>, and other variables are as previously defined. Because many variables are always observed, this expression can be simplified to:</p>
<disp-formula id="pcbi.1004229.e011">
<alternatives>
<graphic id="pcbi.1004229.e011g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e011" xlink:type="simple"/>
<mml:math display="block" id="M11" overflow="scroll">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="3em"/><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mi>Q</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mi>q</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="3em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
</disp-formula>
<p>As most variables are observed, marginalization has to be done only for the unknown true nucleotide (variable <inline-formula id="pcbi.1004229.e012"><alternatives><graphic id="pcbi.1004229.e012g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e012" xlink:type="simple"/><mml:math display="inline" id="M12" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>) and the possible occurrence of a sequencing error (<inline-formula id="pcbi.1004229.e013"><alternatives><graphic id="pcbi.1004229.e013g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004229.e013" xlink:type="simple"/><mml:math display="inline" id="M13" overflow="scroll"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>), which makes such inference efficient for scaffolds millions of nucleotides long covered at high sequencing depth. The remaining summation and product terms gather information from all reads in all positions, for all possible genotypes under a given ploidy. The above computations are done for the desired range of ploidies. The ploidy with the maximum likelihood is chosen.</p>
</sec>
</sec>
<sec id="sec012">
<title>Simulations</title>
<p>For the first set of simulations, we created a 10 Mb long consensus sequence for each ploidy level, from one to 16. We then simulated heterozygous sites at an average interval of 1,000 bases, and for each SNP we uniformly sampled the dosage from 1 to (ploidy−1). Illumina short reads were simulated through SimSeq [<xref rid="pcbi.1004229.ref051" ref-type="bibr">51</xref>], in pairs of 100 bases, at different levels of coverage: 10X, 15X, 25X, 50X and 75X per haploid unit (<italic>i</italic>.<italic>e</italic>., per contig copy). SimSeq uses real Illumina runs to generate empirical short read profiles including sequencing errors and quality scores. We note that such sequencing runs are completely independent from the ones we used to train our error model. We aligned the reads against the corresponding scaffold with SNAP and applied our method to estimate ploidy and call variants for each scenario. We conducted dosage analyses only for cases where the correct ploidy was estimated and employed a Phred-like threshold of 40 to call variants.</p>
<p>To further evaluate the effect of sequencing coverage on ploidy and dosage estimation, we subsequently simulated 100 sets of consensus contigs with 200 kb in length each, for ploidy levels again ranging from one to 16. We simulated variant positions and dosages using the same criteria as before, and simulated sequencing reads at coverage levels of 10X, 15X, 25X and 50X. Analysis of each simulated contig followed the same approach as for the previous scenario, comprising read alignment, ploidy estimation, variant calling and dosage inference.</p>
<p>Next, to evaluate the effect of contig length on ploidy estimation, we simulated contigs with lengths 2,000, 20,000 and 200,000 bases, for each ploidy. We simulated one SNP every 200 bases, such that the number of informative variants was on average 10, 100 and 1,000, respectively, for the different contig lengths. We employed the same uniform distribution to simulate allele dosages. Finally, we simulated short reads at 50X coverage per haploid copy. We simulated each combination of ploidy and contig length 100 times to provide an estimate of ploidy estimation accuracy. Again, for each simulation, we aligned reads against the original contig and applied ConPADE.</p>
<p>We also analyzed all simulated datasets with the ploidy estimation model, but replacing our calculated HiSeq error model with the naïve model that only takes quality scores into account. Our goal is not in exhaustively comparing both error models, but rather assessing how strongly the error model affects ploidy estimates and variant dosage calls.</p>
<sec id="sec013">
<title>Analysis of a Switchgrass Dataset</title>
<p>We downloaded the <italic>Panicum virgatum</italic> AP13 genome reference from Phytozome (<ext-link ext-link-type="uri" xlink:href="http://www.phytozome.com/panicumvirgatum.php" xlink:type="simple">http://www.phytozome.com/panicumvirgatum.php</ext-link>). For all analyses, we utilized the genomic assembly hardmasked for repetitive sequence, to ensure spurious alignments to repetitive regions did not affect results. We also downloaded from the NCBI Sequence Read Archive whole genome shotgun reads from AP13, from accession numbers SRX109496, SRX109498, SRX109499, SRX109501, SRX109503, SRX109505, SRX110233 and SRX110234. We only used the first run for the latter accession. There were a total of 106.4 Gb of sequence in 354,733,809 read pairs of 150 nucleotides each, 102 Gb in 340,008,647 read pairs of 157 and 143 nucleotides, and 103 Gb in 515,426,302 read pairs of 100 nucleotides each.</p>
<p>Next we then aligned all read pairs against the reference genome with Bowtie 2 [<xref rid="pcbi.1004229.ref052" ref-type="bibr">52</xref>], using very sensitive parameters. If the distance between paired reads was outside the expected fragment size, the Phred mapping quality was below 40, or the reads were marked as PCR duplicates, the read pair was discarded. Finally, we randomly sampled 5,000 contigs and used the alignment results as input for the ploidy estimation method and for variant calling. For this analysis, we set <italic>P</italic>(<italic>SNP</italic>) equal to one variant every 200 bases, to represent SNP densities commonly observed in higher plants [<xref rid="pcbi.1004229.ref053" ref-type="bibr">53</xref>–<xref rid="pcbi.1004229.ref055" ref-type="bibr">55</xref>]. We estimated the most likely ploidy for each sampled contig and calculated SNP posterior probabilities, which were subsequently used for variant calling. The existence of variants at positions with Phred score over 40 were deemed significant.</p>
</sec>
<sec id="sec014">
<title>Analysis of a Wheat Dataset</title>
<p>We downloaded the survey sequence assembly of the large arm of chromosomes 5A, 5B and 5D from <italic>Triticum aestivum</italic> L., genotype Chinese Spring line 42 (CS42) (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/iwgsc/" xlink:type="simple">http://urgi.versailles.inra.fr/download/iwgsc/</ext-link>). Next we downloaded from the EMBL-EBI European Nucleotide Archive shotgun reads from the same chromosome arms, also from genotype CS42, obtained through the Illumina Genome Analyzer IIx and HiSeq 2000 technologies, corresponding to accession numbers ERR277132 through ERR277135 (large arm of chromosome 5A), ERR277139 and ERR277140 (large arm of chromosome 5B), and ERR277146 and ERR277147 (large arm of chromosome 5D). These runs comprised 25.72 Gb, 60.58 Gb and 46.26 Gb of sequence for chromosomes 5A, 5B and 5D, respectively. Based on the estimated wheat chromosome arm sizes [<xref rid="pcbi.1004229.ref056" ref-type="bibr">56</xref>], these data correspond to coverage levels of 48.35X, 104.45X and 94.41X, for chromosomes 5A, 5B and 5D, respectively.</p>
<p>As an initial validation procedure, we aligned all read pairs from chromosome 5D against its corresponding reference arm assembly with Bowtie 2 [<xref rid="pcbi.1004229.ref052" ref-type="bibr">52</xref>], using very sensitive parameters. We only kept reads for which the distance between mates was within the empirically determined library fragment length distribution, and for which the Phred mapping quality was higher than 40. Reads marked as PCR duplicates were removed from the analysis. We used these alignment results as input for the ploidy estimation method and for variant calling, again setting <italic>P</italic>(<italic>SNP</italic>) to one variant every 200 bases. Ploidy estimation and variant calling followed the same strategy as for the switchgrass dataset.</p>
<p>After ploidy estimation analyses, we sampled 30 contigs with a ploidy estimate of four and conducted manual annotation via BLAST searches [<xref rid="pcbi.1004229.ref041" ref-type="bibr">41</xref>]. To that end, we aligned these contigs to the NCBI nucleotide (NT) database with BLASTN, using default parameters. We filtered alignments with an E-value cutoff of 1<italic>e</italic><sup>−10</sup> and manually parsed the results. When a contig aligned to a BAC or other long sequence with multiple annotations, we only considered the portion to which said contig actually aligned.</p>
<p>Next, we performed similar analyses for a dataset obtained by pooling data from the three individual wheat subgenomes. To that end, we firstly downsampled data from chromosomes 5B and 5D, such that the coverage levels for the three subgenomes were equivalent. We then assembled the combined reads with ABySS [<xref rid="pcbi.1004229.ref011" ref-type="bibr">11</xref>], using a k-mer size of 71 to mirror the strategy utilized for the assembly of the wheat genome [<xref rid="pcbi.1004229.ref040" ref-type="bibr">40</xref>]. In order to assess the presence or absence of each resulting contig in the original subgenome assemblies, we aligned the contigs to the individual assemblies using BLAST [<xref rid="pcbi.1004229.ref041" ref-type="bibr">41</xref>], and considered a contig to be present in a given subgenome if an alignment to a reference contig covered more than 95% of the query length with more than 95% identity. Finally, we aligned the pooled short reads to our newly created assembly and conducted ploidy estimation using the same criteria applied to the individual analysis of the large arm of chromosome 5D. We supplemented these analyses by estimating the ploidy of each contig in each individual subgenome, by separately aligning reads from the three subgenomes and applying ConPADE.</p>
</sec>
</sec>
<sec id="sec015">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004229.s001" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s001" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Distribution of Phred quality scores for combined bacterial datasets.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s002" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s002" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Coverage simulation results.</title>
<p>A white cell indicates an error in ploidy estimation, with the corresponding called ploidy overlaid. Color in each cell indicates the percentage of correct variant dosage calls for scenarios where ConPADE identified the correct ploidy.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s003" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s003" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Ploidy calls for 100 contigs with different simulated ploidies and sequencing coverage of 15X.</title>
<p>Each panel represents the distribution of ploidy calls from 100 contigs, 200 kb in length each, with a given simulated ploidy level. Ploidy calls made with the full error model.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s004" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s004" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Allele dosage calls of SNPs in contigs with ploidy 15 and coverage 15X.</title>
<p>Each panel represents the distribution of ConPADE dosage calls from a set of variants with a given simulated allele dosage. Data from 33 contigs with a correctly estimated ploidy of 15, with 200 SNPs each. Only significantly called SNPs included. Dosage calls made with the full error model.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s005" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s005" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Ploidy estimation accuracy for varying contig lengths and coverage levels.</title>
<p>Accuracy indicates the number of correct calls out of 100 simulations. Ploidy calls made with the full error model.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s006" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s006" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Distribution of contig lengths from the switchgrass genome assembly.</title>
<p>Only contigs shorter than 30 kb are shown.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s007" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s007" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Stack of short reads aligned against a sub-region of switchgrass contig 17625.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s008" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s008" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Coverage simulation results.</title>
<p>Top (bottom) number in each cell represents the most likely ploidy estimated for a 10 Mb-long contig with the full (naïve) error model. Corresponding percentages of correct variant dosage calls are inside parentheses. Variant calling accuracy was not measured when the ploidy was incorrectly estimated.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s009" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s009" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Results from the coverage simulations.</title>
<p>Top (bottom) number in each cell displays the results with the full (naïve) error model, out of 100 simulations of 200 kb-long contigs for each scenario. FNR denotes false negative rate of SNP detection.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s010" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s010" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Results of ploidy calls for a simulated coverage of 15X.</title>
<p>The number in each cell represents the frequency of each estimated ploidy for a set of 100 contigs, 200 kb in length each, for each simulated ploidy level. Ploidy calls made with the full error model.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s011" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s011" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Results of SNP dosage calls for a simulated ploidy of 15 and coverage of 15X.</title>
<p>The number in each cell represents the frequency of each estimated dosage for a set of SNPs from 33 contigs, with 200 SNPs each, for each simulated dosage level. Only cases in which the estimated ploidy was correct and the SNP was deemed significant are included. Dosage calls made with the full error model.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s012" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s012" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>Results from the length simulations.</title>
<p>Top (bottom) number in each cell displays the results with the full (naïve) error model, out of 100 simulations for each scenario, each with 50X coverage. FNR denotes false negative rate of SNP detection.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004229.s013" xlink:href="info:doi/10.1371/journal.pcbi.1004229.s013" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S6 Table</label>
<caption>
<title>Wheat annotation results.</title>
<p>Annotation results of 30 wheat (<italic>Triticum aestivum</italic>) contigs from chromosome arm 5D with an estimated ploidy of four. Results based on BLASTN alignments against the nucleotide database of NCBI (NT).</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The switchgrass sequence data were produced by the US Department of Energy Joint Genome Institute <ext-link ext-link-type="uri" xlink:href="http://www.jgi.doe.gov/" xlink:type="simple">http://www.jgi.doe.gov/</ext-link> in collaboration with the user community.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004229.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Myers</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Sutton</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Delcher</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Dew</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Fasulo</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Flanigan</surname> <given-names>MJ</given-names></name>, <etal>et al</etal>. <article-title>A Whole-Genome Assembly of Drosophila</article-title>. <source>Science</source>. <year>2000</year>;<volume>287</volume>:<fpage>2196</fpage>–<lpage>2204</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.287.5461.2196" xlink:type="simple">10.1126/science.287.5461.2196</ext-link></comment> <object-id pub-id-type="pmid">10731133</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Baker</surname> <given-names>M</given-names></name>. <article-title>De novo genome assembly: what every biologist should know</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>:<fpage>333</fpage>–<lpage>337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1935" xlink:type="simple">10.1038/nmeth.1935</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004229.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schatz</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Witkowski</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>McCombie</surname> <given-names>WR</given-names></name>. <article-title>Current challenges in de novo plant genome sequencing and assembly</article-title>. <source>Genome Biol</source>. <year>2012</year>;<volume>13</volume>:<fpage>243</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2012-13-4-243" xlink:type="simple">10.1186/gb-2012-13-4-243</ext-link></comment> <object-id pub-id-type="pmid">22546054</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sawyer</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Parsch</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Hartl</surname> <given-names>DL</given-names></name>. <article-title>Prevalence of positive selection among nearly neutral amino acid replacements in Drosophila</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2007</year>;<volume>104</volume>:<fpage>6504</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0701572104" xlink:type="simple">10.1073/pnas.0701572104</ext-link></comment> <object-id pub-id-type="pmid">17409186</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Paterson</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Bowers</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Bruggmann</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Dubchak</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Grimwood</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gundlach</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>The Sorghum bicolor genome and the diversification of grasses</article-title>. <source>Nature</source>. <year>2009</year>;<volume>457</volume>:<fpage>551</fpage>–<lpage>556</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature07723" xlink:type="simple">10.1038/nature07723</ext-link></comment> <object-id pub-id-type="pmid">19189423</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ku</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Loy</surname> <given-names>EY</given-names></name>, <name name-style="western"><surname>Pawitan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Chia</surname> <given-names>KS</given-names></name>. <article-title>The pursuit of genome-wide association studies: where are we now?</article-title> <source>J Hum Genet</source>. <year>2010</year>;<volume>55</volume>:<fpage>195</fpage>–<lpage>206</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/jhg.2010.19" xlink:type="simple">10.1038/jhg.2010.19</ext-link></comment> <object-id pub-id-type="pmid">20300123</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Albers</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Lunter</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>MacArthur</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>McVean</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ouwehand</surname> <given-names>WH</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>. <article-title>Dindel: accurate indel calls from short-read data</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>:<fpage>961</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.112326.110" xlink:type="simple">10.1101/gr.112326.110</ext-link></comment> <object-id pub-id-type="pmid">20980555</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maruyama</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Todaka</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mizoi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yoshida</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kidokoro</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Matsukura</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Identification of cis-acting promoter elements in cold- and dehydration-induced transcriptional pathways in Arabidopsis, rice, and soybean</article-title>. <source>DNA Res</source>. <year>2012</year>;<volume>19</volume>:<fpage>37</fpage>–<lpage>49</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/dnares/dsr040" xlink:type="simple">10.1093/dnares/dsr040</ext-link></comment> <object-id pub-id-type="pmid">22184637</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gnerre</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Maccallum</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Przybylski</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ribeiro</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Burton</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Walker</surname> <given-names>BJ</given-names></name>, <etal>et al</etal>. <article-title>High-quality draft assemblies of mammalian genomes from massively parallel sequence data</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2011</year>;<volume>108</volume>:<fpage>1513</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1017351108" xlink:type="simple">10.1073/pnas.1017351108</ext-link></comment> <object-id pub-id-type="pmid">21187386</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ruan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Qian</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Fang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>De novo assembly of human genomes with massively parallel short read sequencing</article-title>. <source>Genome Res</source>. <year>2010</year>;<volume>20</volume>:<fpage>265</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.097261.109" xlink:type="simple">10.1101/gr.097261.109</ext-link></comment> <object-id pub-id-type="pmid">20019144</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simpson</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Wong</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Jackman</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Schein</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>SJM</given-names></name>, <name name-style="western"><surname>Birol</surname> <given-names>I</given-names></name>. <article-title>ABySS: a parallel assembler for short read sequence data</article-title>. <source>Genome Res</source>. <year>2009</year>;<volume>19</volume>:<fpage>1117</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.089532.108" xlink:type="simple">10.1101/gr.089532.108</ext-link></comment> <object-id pub-id-type="pmid">19251739</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zerbino</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Birney</surname> <given-names>E</given-names></name>. <article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>. <source>Genome Res</source>. <year>2008</year>;<volume>18</volume>:<fpage>821</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.074492.107" xlink:type="simple">10.1101/gr.074492.107</ext-link></comment> <object-id pub-id-type="pmid">18349386</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bennetzen</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Schmutz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Percifield</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hawkins</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pontaroli</surname> <given-names>AC</given-names></name>, <etal>et al</etal>. <article-title>Reference genome sequence of the model plant Setaria</article-title>. <source>Nat Biotechnol</source>. <year>2012</year>;<volume>30</volume>:<fpage>555</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2196" xlink:type="simple">10.1038/nbt.2196</ext-link></comment> <object-id pub-id-type="pmid">22580951</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Murchison</surname> <given-names>EP</given-names></name>, <name name-style="western"><surname>Schulz-Trieglaff</surname> <given-names>OB</given-names></name>, <name name-style="western"><surname>Ning</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Alexandrov</surname> <given-names>LB</given-names></name>, <name name-style="western"><surname>Bauer</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Fu</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Genome sequencing and analysis of the Tasmanian devil and its transmissible cancer</article-title>. <source>Cell</source>. <year>2012</year>;<volume>148</volume>:<fpage>780</fpage>–<lpage>91</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2011.11.065" xlink:type="simple">10.1016/j.cell.2011.11.065</ext-link></comment> <object-id pub-id-type="pmid">22341448</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schnable</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Ware</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Fulton</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Stein</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Wei</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pasternak</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>The B73 maize genome: complexity, diversity, and dynamics</article-title>. <source>Science</source>. <year>2009</year>;<volume>326</volume>:<fpage>1112</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1178534" xlink:type="simple">10.1126/science.1178534</ext-link></comment> <object-id pub-id-type="pmid">19965430</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abecasis</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Altshuler</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Auton</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Brooks</surname> <given-names>LD</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Gibbs</surname> <given-names>R a</given-names></name>, <etal>et al</etal>. <article-title>A map of human genome variation from population-scale sequencing</article-title>. <source>Nature</source>. <year>2010</year>;<volume>467</volume>:<fpage>1061</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09534" xlink:type="simple">10.1038/nature09534</ext-link></comment> <object-id pub-id-type="pmid">20981092</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neale</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Kremer</surname> <given-names>A</given-names></name>. <article-title>Forest tree genomics: growing resources and applications</article-title>. <source>Nat Rev Genet</source>. <year>2011</year>;<volume>12</volume>:<fpage>111</fpage>–<lpage>22</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg2931" xlink:type="simple">10.1038/nrg2931</ext-link></comment> <object-id pub-id-type="pmid">21245829</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shaked</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kashkush</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ozkan</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Feldman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Levy</surname> <given-names>AA</given-names></name>. <article-title>Sequence elimination and cytosine methylation are rapid and reproducible responses of the genome to wide hybridization and allopolyploidy in wheat</article-title>. <source>Plant Cell</source>. <year>2001</year>;<volume>13</volume>:<fpage>1749</fpage>–<lpage>59</lpage>. <object-id pub-id-type="pmid">11487690</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Roe</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Macmil</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Microcollinearity between autopolyploid sugarcane and diploid sorghum genomes</article-title>. <source>BMC Genomics</source>. <year>2010</year>;<volume>11</volume>:<fpage>261</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-11-261" xlink:type="simple">10.1186/1471-2164-11-261</ext-link></comment> <object-id pub-id-type="pmid">20416060</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blanc</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wolfe</surname> <given-names>KH</given-names></name>. <article-title>Widespread Paleopolyploidy in Model Plant Species Inferred from Age Distributions of Duplicate Genes</article-title>. <source>Plant Cell</source>. <year>2004</year>;<volume>16</volume>:<fpage>1667</fpage>–<lpage>1678</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1105/tpc.021345.formed" xlink:type="simple">10.1105/tpc.021345.formed</ext-link></comment> <object-id pub-id-type="pmid">15208399</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Pan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Mu</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ni</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Genome sequence and analysis of the tuber crop potato</article-title>. <source>Nature</source>. <year>2011</year>;<volume>475</volume>:<fpage>189</fpage>–<lpage>95</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10158" xlink:type="simple">10.1038/nature10158</ext-link></comment> <object-id pub-id-type="pmid">21743474</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gill</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Appels</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Botha-Oberholster</surname> <given-names>A-M</given-names></name>, <name name-style="western"><surname>Buell</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Bennetzen</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Chalhoub</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>A workshop report on wheat genome sequencing: International Genome Research on Wheat Consortium</article-title>. <source>Genetics</source>. <year>2004</year>;<volume>168</volume>:<fpage>1087</fpage>–<lpage>96</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.104.034769" xlink:type="simple">10.1534/genetics.104.034769</ext-link></comment> <object-id pub-id-type="pmid">15514080</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alkan</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sajjadian</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Eichler</surname> <given-names>EE</given-names></name>. <article-title>Limitations of next-generation genome sequence assembly</article-title>. <source>Nat Methods</source>. <year>2011</year>;<volume>8</volume>:<fpage>61</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeTh.1527" xlink:type="simple">10.1038/nmeTh.1527</ext-link></comment> <object-id pub-id-type="pmid">21102452</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hadley</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Glessner</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Grant</surname> <given-names>SFA</given-names></name>, <etal>et al</etal>. <article-title>PennCNV: an integrated hidden Markov model designed for high-resolution copy number variation detection in whole-genome SNP genotyping data</article-title>. <source>Genome Res</source>. <year>2007</year>;<volume>17</volume>:<fpage>1665</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.6861907" xlink:type="simple">10.1101/gr.6861907</ext-link></comment> <object-id pub-id-type="pmid">17921354</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xie</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Tammi</surname> <given-names>MT</given-names></name>. <article-title>CNV-seq, a new method to detect copy number variation using high-throughput sequencing</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>;<volume>10</volume>:<fpage>80</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-10-80" xlink:type="simple">10.1186/1471-2105-10-80</ext-link></comment> <object-id pub-id-type="pmid">19267900</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Handsaker</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wysoker</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fennell</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ruan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Homer</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp352" xlink:type="simple">10.1093/bioinformatics/btp352</ext-link></comment> <object-id pub-id-type="pmid">19505943</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McKenna</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hanna</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Banks</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sivachenko</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cibulskis</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kernytsky</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source>. <year>2010</year>;<volume>20</volume>:<fpage>1297</fpage>–<lpage>303</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.107524.110" xlink:type="simple">10.1101/gr.107524.110</ext-link></comment> <object-id pub-id-type="pmid">20644199</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref028"><label>28</label><mixed-citation publication-type="other" xlink:type="simple">Garrison E, Marth G. Haplotype-based variant detection from short-read sequencing. arXiv. 2012;1207.3907v:9.</mixed-citation></ref>
<ref id="pcbi.1004229.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grivet</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Arruda</surname> <given-names>P</given-names></name>. <article-title>Sugarcane genomics: depicting the complex genome of an important tropical crop</article-title>. <source>Curr Opin Plant Biol</source>. <year>2002</year>;<volume>5</volume>:<fpage>122</fpage>–<lpage>127</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1369-5266(02)00234-0" xlink:type="simple">10.1016/S1369-5266(02)00234-0</ext-link></comment> <object-id pub-id-type="pmid">11856607</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shen</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Wan</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Coarfa</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Drabek</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ostrowski</surname> <given-names>EA</given-names></name>, <etal>et al</etal>. <article-title>A SNP discovery method to assess variant allele probability from next-generation resequencing data</article-title>. <source>Genome Res</source>. <year>2010</year>;<volume>20</volume>:<fpage>273</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.096388.109" xlink:type="simple">10.1101/gr.096388.109</ext-link></comment> <object-id pub-id-type="pmid">20019143</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Serang</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Mollinari</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Garcia</surname> <given-names>AAF</given-names></name>. <article-title>Efficient exact maximum a posteriori computation for bayesian SNP genotyping in polyploids</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume>:<fpage>e30906</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0030906" xlink:type="simple">10.1371/journal.pone.0030906</ext-link></comment> <object-id pub-id-type="pmid">22363513</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kriegner</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cervantes</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Burg</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Mwanga</surname> <given-names>ROM</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>D</given-names></name>. <article-title>A genetic linkage map of sweetpotato [Ipomoea batatas (L.) Lam.] based on AFLP markers</article-title>. <source>Mol Breed</source>. <year>2003</year>;<volume>11</volume>:<fpage>169</fpage>–<lpage>185</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004229.ref033"><label>33</label><mixed-citation publication-type="other" xlink:type="simple">Souza GM, Ming R, Henry RJ, D’Hont A, Potier B, Paterson A. The sugarcane genome sequencing effort: an overview of the strategy, goals and existing data. Proceedings of the Plant and Animal Genomes XVIII Conference. 2010;W538.</mixed-citation></ref>
<ref id="pcbi.1004229.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brenchley</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Spannagl</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pfeifer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Barker</surname> <given-names>GLA</given-names></name>, <name name-style="western"><surname>D’Amore</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Allen</surname> <given-names>AM</given-names></name>, <etal>et al</etal>. <article-title>Analysis of the bread wheat genome using whole-genome shotgun sequencing</article-title>. <source>Nature</source>. <year>2012</year>;<volume>491</volume>:<fpage>705</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11650" xlink:type="simple">10.1038/nature11650</ext-link></comment> <object-id pub-id-type="pmid">23192148</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref035"><label>35</label><mixed-citation publication-type="other" xlink:type="simple">Johnson J, Alfoldi J, Lara M, Mauceli E, Russell P, Swofford R, et al. Branching Out—Expanding the Sequencing of the Mammalian Tree. Proceedings of the Plant and Animal Genomes XX Conference. 2012;P0078.</mixed-citation></ref>
<ref id="pcbi.1004229.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Casler</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Tobias</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Kaeppler</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Buell</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Z-Y</given-names></name>, <name name-style="western"><surname>Cao</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>The Switchgrass Genome: Tools and Strategies</article-title>. <source>Plant Genome</source>. <year>2011</year>;<volume>4</volume>:<fpage>273</fpage>–<lpage>282</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3835/plantgenome2011.10.0026" xlink:type="simple">10.3835/plantgenome2011.10.0026</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004229.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Levy</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Feldman</surname> <given-names>M</given-names></name>. <article-title>The Impact of Polyploidy on Grass Genome Evolution</article-title>. <source>Plant Physiol</source>. <year>2002</year>;<volume>130</volume>:<fpage>1587</fpage>–<lpage>93</lpage>. <object-id pub-id-type="pmid">12481041</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Costich</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Friebe</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sheehan</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Casler</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Buckler</surname> <given-names>ES</given-names></name>. <article-title>Genome-size variation in switchgrass (Panicum virgatum): Flow cytometry and cytology reveal rampant aneuploidy</article-title>. <source>Plant Genome</source>. <year>2010</year>;<volume>3</volume>:<fpage>130</fpage>–<lpage>41</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3835/plantgenome2010.04.0010" xlink:type="simple">10.3835/plantgenome2010.04.0010</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004229.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Petersen</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Seberg</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Yde</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Berthelsen</surname> <given-names>K</given-names></name>. <article-title>Phylogenetic relationships of Triticum and Aegilops and evidence for the origin of the A, B, and D genomes of common wheat (Triticum aestivum)</article-title>. <source>Mol Phylogenet Evol</source>. <year>2006</year>;<volume>39</volume>:<fpage>70</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ympev.2006.01.023" xlink:type="simple">10.1016/j.ympev.2006.01.023</ext-link></comment> <object-id pub-id-type="pmid">16504543</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mayer</surname> <given-names>KFX</given-names></name>, <name name-style="western"><surname>Rogers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dole el</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pozniak</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Eversole</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Feuillet</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A chromosome-based draft sequence of the hexaploid bread wheat (Triticum aestivum) genome</article-title>. <source>Science</source>. <year>2014</year>;<volume>345</volume>:<fpage>1251788</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1251788" xlink:type="simple">10.1126/science.1251788</ext-link></comment> <object-id pub-id-type="pmid">25035500</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Gish</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Lipman</surname> <given-names>DJ</given-names></name>. <article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source>. <year>1990</year>;<volume>215</volume>:<fpage>403</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0022-2836(05)80360-2" xlink:type="simple">10.1016/S0022-2836(05)80360-2</ext-link></comment> <object-id pub-id-type="pmid">2231712</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carter</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Cibulskis</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Helman</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>McKenna</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Zack</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Absolute quantification of somatic DNA alterations in human cancer</article-title>. <source>Nat Biotechnol</source>. <year>2012</year>;<volume>30</volume>:<fpage>413</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2203" xlink:type="simple">10.1038/nbt.2203</ext-link></comment> <object-id pub-id-type="pmid">22544022</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Van Loo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Nordgard</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Lingjærde</surname> <given-names>OC</given-names></name>, <name name-style="western"><surname>Russnes</surname> <given-names>HG</given-names></name>, <name name-style="western"><surname>Rye</surname> <given-names>IH</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Allele-specific copy number analysis of tumors</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2010</year>;<volume>107</volume>:<fpage>16910</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1009843107" xlink:type="simple">10.1073/pnas.1009843107</ext-link></comment> <object-id pub-id-type="pmid">20837533</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lam</surname> <given-names>HYK</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Natsoulis</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>O’Huallachain</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Performance comparison of whole-genome sequencing platforms</article-title>. <source>Nat Biotechnol</source>. <year>2012</year>;<volume>30</volume>:<fpage>78</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2065" xlink:type="simple">10.1038/nbt.2065</ext-link></comment> <object-id pub-id-type="pmid">22178993</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Batley</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Barker</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>O’Sullivan</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Edwards</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Edwards</surname> <given-names>D</given-names></name>. <article-title>Mining for Single Nucleotide Polymorphisms and Insertions/Deletions in Maize Expressed Sequence Tag Data</article-title>. <source>Plant Physiol</source>. <year>2003</year>;<volume>132</volume>:<fpage>84</fpage>–<lpage>91</lpage>. <object-id pub-id-type="pmid">12746514</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hayashi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hashimoto</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Daigen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ashikawa</surname> <given-names>I</given-names></name>. <article-title>Development of PCR-based SNP markers for rice blast resistance genes at the Piz locus</article-title>. <source>Theor Appl Genet</source>. <year>2004</year>;<volume>108</volume>:<fpage>1212</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00122-003-1553-0" xlink:type="simple">10.1007/s00122-003-1553-0</ext-link></comment> <object-id pub-id-type="pmid">14740086</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref047"><label>47</label><mixed-citation publication-type="other" xlink:type="simple">Zaharia M, Bolosky WJ, Curtis K, Fox A, Patterson D, Shenker S, et al. Faster and More Accurate Sequence Alignment with SNAP. arXiv. 2011;1111.5572v1.</mixed-citation></ref>
<ref id="pcbi.1004229.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altshuler</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pollara</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Cowles</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Van Etten</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Baldwin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Linton</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>An SNP map of the human genome generated by reduced representation shotgun sequencing</article-title>. <source>Nature</source>. <year>2000</year>;<volume>407</volume>:<fpage>513</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35035083" xlink:type="simple">10.1038/35035083</ext-link></comment> <object-id pub-id-type="pmid">11029002</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meacham</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Boffelli</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Dhahbi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>DIK</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pachter</surname> <given-names>L</given-names></name>. <article-title>Identification and correction of systematic error in high-throughput sequence data</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>:<fpage>451</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-451" xlink:type="simple">10.1186/1471-2105-12-451</ext-link></comment> <object-id pub-id-type="pmid">22099972</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pedregosa</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Varoquaux</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gramfort</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Michel</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Thirion</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Grisel</surname> <given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Scikit-learn: Machine Learning in Python</article-title>. <source>J Mach Learn Res</source>. <year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004229.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Earl</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bradnam</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>St John</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Darling</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Fass</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Assemblathon 1: a competitive assessment of de novo short read assembly methods</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>:<fpage>2224</fpage>–<lpage>41</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.126599.111" xlink:type="simple">10.1101/gr.126599.111</ext-link></comment> <object-id pub-id-type="pmid">21926179</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Langmead</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name>. <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>:<fpage>357</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1923" xlink:type="simple">10.1038/nmeth.1923</ext-link></comment> <object-id pub-id-type="pmid">22388286</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tenaillon</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Sawkins</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Long</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Gaut</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Doebley</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Gaut</surname> <given-names>BS</given-names></name>. <article-title>Patterns of DNA sequence polymorphism along chromosome 1 of maize (Zea mays ssp. mays L.)</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2001</year>;<volume>98</volume>:<fpage>9161</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.151244298" xlink:type="simple">10.1073/pnas.151244298</ext-link></comment> <object-id pub-id-type="pmid">11470895</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bundock</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Eliott</surname> <given-names>FG</given-names></name>, <name name-style="western"><surname>Ablett</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Benson</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Casu</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Aitken</surname> <given-names>KS</given-names></name>, <etal>et al</etal>. <article-title>Targeted single nucleotide polymorphism (SNP) discovery in a highly polyploid plant species using 454 sequencing</article-title>. <source>Plant Biotechnol J</source>. <year>2009</year>;<volume>7</volume>:<fpage>347</fpage>–<lpage>54</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-7652.2009.00401.x" xlink:type="simple">10.1111/j.1467-7652.2009.00401.x</ext-link></comment> <object-id pub-id-type="pmid">19386042</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Deulvot</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Charrel</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Marty</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jacquin</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Donnadieu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lejeune-Hénaut</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Highly-multiplexed SNP genotyping for genetic mapping and germplasm diversity studies in pea</article-title>. <source>BMC Genomics</source>. <year>2010</year>;<volume>11</volume>:<fpage>468</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-11-468" xlink:type="simple">10.1186/1471-2164-11-468</ext-link></comment> <object-id pub-id-type="pmid">20701750</object-id></mixed-citation></ref>
<ref id="pcbi.1004229.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Šafář</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Šimková</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kubaláková</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Číhalíková</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Suchánková</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Bartoš</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Development of chromosome-specific BAC resources for genomics of bread wheat</article-title>. <source>Cytogenet Genome Res</source>. <year>2010</year>;<volume>129</volume>:<fpage>211</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1159/000313072" xlink:type="simple">10.1159/000313072</ext-link></comment> <object-id pub-id-type="pmid">20501977</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>