<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
      <journal-id journal-id-type="pmc">ploscomp</journal-id>
      <journal-title-group>
        <journal-title>PLoS Computational Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1553-734X</issn>
      <issn pub-type="epub">1553-7358</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-01230</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pcbi.1002877</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Genetics</subject>
            <subj-group>
              <subject>Human genetics</subject>
              <subj-group>
                <subject>Genetic association studies</subject>
                <subject>Personalized medicine</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Population genetics</subject>
              <subj-group>
                <subject>Haplotypes</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Genome-wide association studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Computer Science</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Multi-Population Classical HLA Type Imputation</article-title>
        <alt-title alt-title-type="running-head">Multi-Population Classical HLA Type Imputation</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Dilthey</surname>
            <given-names>Alexander</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Leslie</surname>
            <given-names>Stephen</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Moutsianas</surname>
            <given-names>Loukas</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Shen</surname>
            <given-names>Judong</given-names>
          </name>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Cox</surname>
            <given-names>Charles</given-names>
          </name>
          <xref ref-type="aff" rid="aff5">
            <sup>5</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Nelson</surname>
            <given-names>Matthew R.</given-names>
          </name>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>McVean</surname>
            <given-names>Gil</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff1">
        <label>1</label>
        <addr-line>Department of Statistics, University of Oxford, Oxford, United Kingdom</addr-line>
      </aff>
      <aff id="aff2">
        <label>2</label>
        <addr-line>Wellcome Trust Centre for Human Genetics, Oxford, United Kingdom</addr-line>
      </aff>
      <aff id="aff3">
        <label>3</label>
        <addr-line>Murdoch Childrens Research Institute, Royal Children's Hospital, Parkville, Victoria, Australia</addr-line>
      </aff>
      <aff id="aff4">
        <label>4</label>
        <addr-line>Quantitative Sciences, GlaxoSmithKline, Research Triangle Park, North Carolina, United States of America</addr-line>
      </aff>
      <aff id="aff5">
        <label>5</label>
        <addr-line>Quantitative Sciences, GlaxoSmithKline, Stevenage, United Kingdom</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Browning</surname>
            <given-names>Sharon</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>University of Washington, United States of America</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">dilthey@well.ox.ac.uk</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: AD SL MRN GM. Performed the experiments: AD SL LM JS. Analyzed the data: AD SL. Contributed reagents/materials/analysis tools: CC. Wrote the paper: AD SL MRN GM.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="collection">
        <month>2</month>
        <year>2013</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>14</day>
        <month>2</month>
        <year>2013</year>
      </pub-date>
      <volume>9</volume>
      <issue>2</issue>
      <elocation-id>e1002877</elocation-id>
      <history>
        <date date-type="received">
          <day>27</day>
          <month>7</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>16</day>
          <month>11</month>
          <year>2012</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2013</copyright-year>
        <copyright-holder>Dilthey et al</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>Statistical imputation of classical HLA alleles in case-control studies has become established as a valuable tool for identifying and fine-mapping signals of disease association in the MHC. Imputation into diverse populations has, however, remained challenging, mainly because of the additional haplotypic heterogeneity introduced by combining reference panels of different sources. We present an HLA type imputation model, HLA*IMP:02, designed to operate on a multi-population reference panel. HLA*IMP:02 is based on a graphical representation of haplotype structure. We present a probabilistic algorithm to build such models for the HLA region, accommodating genotyping error, haplotypic heterogeneity and the need for maximum accuracy at the HLA loci, generalizing the work of Browning and Browning (2007) and Ron et al. (1998). HLA*IMP:02 achieves an average 4-digit imputation accuracy on diverse European panels of 97% (call rate 97%). On non-European samples, 2-digit performance is over 90% for most loci and ethnicities where data available. HLA*IMP:02 supports imputation of HLA-DPB1 and HLA-DRB3-5, is highly tolerant of missing data in the imputation panel and works on standard genotype data from popular genotyping chips. It is publicly available in source code and as a user-friendly web service framework.</p>
      </abstract>
      <abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>The human leukocyte antigen (HLA) proteins influence how pathogens and components of body cells are presented to immune cells. It has long been known that they are highly variable and that this variation is associated with differential risk for autoimmune and infectious diseases. Variant frequencies differ substantially between and even within continents. Determining HLA genotypes is thus an important part of many studies to understand the genetic basis of disease risk. However, conventional methods for HLA typing (e.g. targeted sequencing, hybridisation, amplification) are typically laborious and expensive. We have developed a method for inferring an individual's HLA genotype based on evaluating genetic information from nearby variable sites that are more easily assayed, which aims to integrate heterogeneous data. We introduce two key innovations: we allow for single HLA types to appear on heterogeneous backgrounds of genetic information and we take into account the possibility of genotyping error, which is common within the HLA region. We show that the method is well-suited to deal with multi-population datasets: it enables integrated HLA type inference for individuals of differing ancestry and ethnicity. It will therefore prove useful particularly in international collaborations to better understand disease risks, where samples are drawn from multiple countries.</p>
      </abstract>
      <funding-group>
        <funding-statement>We acknowledge funding from Studienstiftung des deutschen Volkes, EPSRC, The Leverhulme Trust, HFSP, The Wellcome Trust, and GlaxoSmithKline. We also acknowledge funding from the Wellcome Trust core grant. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <page-count count="13"/>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Statistical imputation of classical human leukocyte antigen (HLA) alleles from SNP genotypes in case-control studies has become established as a valuable tool for identifying and fine-mapping signals of disease association in the MHC. Application of the HLA type imputation framework HLA*IMP <xref ref-type="bibr" rid="pcbi.1002877-Dilthey1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Leslie1">[2]</xref> has, for example, helped to fine-map secondary HLA-based risk effects in multiple sclerosis <xref ref-type="bibr" rid="pcbi.1002877-Sawcer1">[3]</xref>, contributed to characterizing an HLA-related gene-gene interaction in psoriasis <xref ref-type="bibr" rid="pcbi.1002877-Strange1">[4]</xref>, and was essential in refuting a suspected strong HLA contribution to childhood B-cell precursor acute lymphoblastic leukaemia <xref ref-type="bibr" rid="pcbi.1002877-Hosking1">[5]</xref>. Classical HLA allele imputation has, in other settings, been used to identify particular amino acids within classical peptides contributing to disease risk <xref ref-type="bibr" rid="pcbi.1002877-Raychaudhuri1">[6]</xref>.</p>
      <p>Classical HLA allele imputation is complicated by hyperpolymorphism (<italic>HLA-B</italic> , for example, has dozens of common alleles and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e001" xlink:type="simple"/></inline-formula> rare alleles) and the complex haplotype structure of the HLA region, justifying the development of specialized imputation machinery. Linkage disequilibrium (LD) between loci usually declines with distance, as LD is broken down by recombination. In the HLA, however, this is not always empirically true. Many comparatively distant SNPs carry information on the allelic state of the classical HLA genes <xref ref-type="bibr" rid="pcbi.1002877-deBakker1">[7]</xref>. Fully capturing this information is not trivial. For example, a commonly used model in statistical genetics, the Li and Stephens approximation <xref ref-type="bibr" rid="pcbi.1002877-Li1">[8]</xref>, does not allow for explicit modelling of long-distance LD relationships due to its reliance on a first order Markov chain. HLA*IMP therefore uses a particular formulation of the Li and Stephens approximation that assigns equal weight to all selected SNPs irrespective of distance from the classical locus of interest <xref ref-type="bibr" rid="pcbi.1002877-Leslie1">[2]</xref>. We have since demonstrated (e.g., <xref ref-type="bibr" rid="pcbi.1002877-Dilthey1">[1]</xref>) that this formulation leads to highly accurate HLA type imputations, at least when reference and imputation panel are derived from the same population.</p>
      <p>For the increasingly important use case of multi-population studies (where the reference and analysis panels consist of samples taken from multiple, possibly diverse, populations), HLA type imputation has, however, remained challenging: Imputation accuracy is limited by the extent to which the reference panel captures the diversity of the target population and current methods typically rely on single-source reference panels of Northern European origin <xref ref-type="bibr" rid="pcbi.1002877-Dilthey1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-International1">[9]</xref>.</p>
      <p>The obvious solution, successfully applied in SNP genotype imputation <xref ref-type="bibr" rid="pcbi.1002877-Huang1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Jostins1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Howie1">[12]</xref>, is to make use of diverse multi-population reference panels. However, an additional challenge of multi-population classical HLA type imputation is that single HLA alleles can appear on multiple SNP haplotype backgrounds <xref ref-type="bibr" rid="pcbi.1002877-deBakker1">[7]</xref>, a phenomenon we refer to as “haplotypic heterogeneity”. Moreover, genetic data obtained from multiple data sets from different populations is likely to contain systematic genotyping artefacts. Here we present HLA*IMP:02, an HLA type imputation method that is particularly aimed at inference in multi-population and multi-ethnicity settings. That is, it is designed to accommodate both haplotypic heterogeneity and genotyping error.</p>
      <p>Inference under HLA*IMP:02 is based on a graphical model of the haplotype structure of the MHC region. We motivate this choice by restating an observation made by Browning and Browning <xref ref-type="bibr" rid="pcbi.1002877-Browning1">[13]</xref>: Graphical haplotype models are well-suited to model LD relationships spanning different scales of distance (“variable-length Markov chains”), which fits with the HLA region's empirically observed LD structure. We present an algorithm to build such models from a set of reference genotype data. The main design features of the algorithm are that it takes into account haplotype uncertainty introduced by potential genotyping error, that it allows for haplotypic heterogeneity and that it tailors the graphs to make them maximally informative about the allelic state of the HLA loci. Our algorithm can be viewed as a probabilistic generalization of the works of Browning and Browning <xref ref-type="bibr" rid="pcbi.1002877-Browning2">[14]</xref>. Compared with HLA*IMP, HLA*IMP:02 also offers a couple of practical advantages: it is highly tolerant of missing data in the inference panel and supports imputation of HLA-DPB1 and HLA-DRB3-5.</p>
      <p>It is instructive to explicitly consider how the design of HLA*IMP:02 leads to an improved ability to deal with heterogeneous data, as compared to HLA*IMP:</p>
      <list list-type="bullet">
        <list-item>
          <p>Data representation: HLA*IMP:02 builds a combined locus-specific haplotype graph model of the whole dataset. In HLA*IMP, in contrast, reference genotype data is phased and separated by HLA alleles. All further steps are based on these allelic groups (one for each HLA allele in the reference panel). This design prevents HLA*IMP from sharing SNP haplotype information across haplotypes carrying different HLA alleles.</p>
        </list-item>
        <list-item>
          <p>Maximising imputation performance: HLA*IMP:02, uses all available SNPs in the HLA region. However, while building the haplotype graph no two internal haplotype states that exhibit different association patterns to HLA alleles are combined, thus maintaining accuracy specifically for HLA allele prediction. HLA*IMP, in contrast, carries out a process of SNP selection, identifying SNPs in the region that are informative for accurate prediction of HLA types. Finding a set of consistently informative SNPs becomes increasingly difficult as the degree of stratification in the reference panel increases.</p>
        </list-item>
        <list-item>
          <p>Inference model: In the haplotype-graph approach of HLA*IMP:02, haplotypes are not grouped in advance. If an allele appears on multiple SNP haplotypes, there will be multiple paths through the graph leading to the allele. Inference is based on comparing the likelihoods of all possible paths. Ambiguity therefore typically only arises if two or more alleles share the same SNP haplotypes, but not if one allele appears on more than one background. Additional heterogeneity in the reference panel (characterized by alleles appearing on more than one unique background) does not decrease the model's ability to correctly infer HLA genotypes. HLA*IMP, in contrast, appears to suffer decreased performance in both scenarios (one allele/multiple backgrounds, multiple alleles/one background). This is perhaps because inference under HLA*IMP is based on finding the most similar <italic>group</italic> of haplotypes (implemented through a particular formulation of the Li and Stephens <xref ref-type="bibr" rid="pcbi.1002877-Li1">[8]</xref> Hidden Markov Model, HMM). Additional heterogeneity in an allele's SNP background necessarily reduces group-wise average similarity and dilutes the model's ability to correctly infer HLA genotypes.</p>
        </list-item>
      </list>
      <p>We carry out three experiments to investigate the performance of HLA*IMP:02 on reference panels of varying heterogeneity. In the first experiment, we apply HLA*IMP:02 to a homogeneous (predominately British) reference panel and show that it performs as well as HLA*IMP in this baseline scenario. In the second experiment, we demonstrate that HLA*IMP:02 achieves high imputation accuracy at 4-digit HLA type resolution (reflecting primary sequence of the HLA proteins) when applied to an integrated cross-European reference panel, clearly outperforming HLA*IMP. In the third experiment, we use a highly heterogeneous multi-ethnic reference panel to impute HLA genotypes of Asian, African-American, African, European and Hispanic individuals. We show that accuracy for the European individuals remains essentially unchanged by making the reference panel more heterogeneous and that the model achieves high imputation accuracy for the other ethnicities at 2-digit resolution, which reflects the serological properties of the HLA alleles (see Subsection “Validation” for a precise definition in our context).</p>
    </sec>
    <sec id="s2" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s2a">
        <title>HLA*IMP:02</title>
        <p>We use an acyclic probabilistic finite automaton (“haplotype graph”, see <xref ref-type="fig" rid="pcbi-1002877-g001">Figure 1</xref>) to represent haplotype structure in the HLA region <xref ref-type="bibr" rid="pcbi.1002877-Browning2">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Ron1">[15]</xref>. The haplotype graph describes the haplotype structure of SNPs around the classical HLA loci. In <xref ref-type="fig" rid="pcbi-1002877-g001">Figure 1</xref>, each possible path through the graph also passes through an edge carrying an HLA allele, and therefore specifies a corresponding HLA genotype. The likelihood of any particular path depends on the branching structure of the graph (as specified by the probabilities on the edges in <xref ref-type="fig" rid="pcbi-1002877-g001">Figure 1</xref>) as well as on the observed SNP genotypes from an individual that we want to make inference for. For example, if we observe the SNP genotypes <monospace>TTA?TA</monospace> (the question mark stands for the unknown HLA allele, and we only consider the haploid case here for simplicity), the likelihood of the path passing through the bottom nodes (and the 1501 allele) is 0.2, and the likelihood of all others paths is 0 (not allowing for any deviations from the edge labels for the sake of this argument). For <monospace>ATA?GA</monospace>, the case is also clear: <monospace>0301</monospace> is the only possible allele. If we now change the second-last genotype to <monospace>T</monospace> (yielding <monospace>ATA?TA</monospace>), there are two possible paths. The one passing through <monospace>1501</monospace> has a likelihood of 0.012, and the other one passing through <monospace>0301</monospace> has a likelihood of 0.056. Conditional on the observed SNP genotypes, <monospace>1501</monospace> is therefore approximately twice as probable as <monospace>0301</monospace>. Changing the second and third genotypes would not influence this result (which relates back to our introductory comments on the variable length of captured LD relationships: the first position influences inference, the second and third do not).</p>
        <fig id="pcbi-1002877-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002877.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Features of haplotype graph models.</title>
            <p>Illustration of the features of haplotype graph models. Haplotype graphs are a subclass of connected directed graphs and belong to the class of acyclic probabilistic finite automata. Their most important properties are illustrated here: 1) They are leveled, i.e. each vertex <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e002" xlink:type="simple"/></inline-formula> has an associated positive number 1, and all edges emanating from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e003" xlink:type="simple"/></inline-formula> at level <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e004" xlink:type="simple"/></inline-formula> lead to a vertex at level <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e005" xlink:type="simple"/></inline-formula> and represent the same genetic locus. Vertices at level <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e006" xlink:type="simple"/></inline-formula> are final vertices with no outgoing edges, and there is a path from every vertex in the graph to one of the final vertices. 2) Edges carry “emission symbols” which are emitted when an edge is traversed (in the figure: the symbols after the “|” character adjacent to the edges), and there are no two edges emanating from the same vertex which carry the same symbol. 3) Each vertex has an edge probability distribution over its attached edges (in the figure: the numbers in front of the “|” character adjacent to the edges), according to which an edge is selected conditional in being at that vertex.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002877.g001" position="float" xlink:type="simple"/>
        </fig>
        <p>In order to use haplotype graphs for imputation, there are two general problems to address: how to construct a haplotype graph from a set of reference data, and how to use an existing graph for imputing the genotype of an additional individual. Methods to construct and use haplotype graph-like objects from a set of reference data were discussed by Ron et al. <xref ref-type="bibr" rid="pcbi.1002877-Ron1">[15]</xref> and introduced into the field of statistical genetics by Browning <xref ref-type="bibr" rid="pcbi.1002877-Browning1">[13]</xref> and Browning and Browning <xref ref-type="bibr" rid="pcbi.1002877-Browning2">[14]</xref>. The work we present here can be viewed as a probabilistic generalization of the works of Ron et al. <xref ref-type="bibr" rid="pcbi.1002877-Ron1">[15]</xref> and Browning and Browning <xref ref-type="bibr" rid="pcbi.1002877-Browning2">[14]</xref>. To use haplotype graph models specifically for HLA type inference, we have developed solutions to two related tasks: how to build a haplotype graph model from the reference panel allowing for errors in SNP genotype data and haplotypic heterogeneity and how to boost accuracy for HLA allele imputations. A full and formal description of the HLA*IMP:02 algorithm can be found in the Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s011">Text S1</xref>. Here we provide outline of our algorithm and the inference process, highlighting where we generalized and extended previous approaches.</p>
        <p>Constructing a haplotype graph from a set of reference data (including both SNP and HLA genotypes) is an iterative process, consisting, as in BEAGLE, of three main steps:</p>
        <list list-type="bullet">
          <list-item>
            <p>Initialization: for each individual, populate the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e007" xlink:type="simple"/></inline-formula> of current haplotype estimates by sampling from the uniform distribution over all genotype-consistent haplotype pairs. In contrast to BEAGLE, we preserve missing data in the generated haplotype pairs.</p>
          </list-item>
          <list-item>
            <p>Probabilistic graph construction: build a haplotype graph object from the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e008" xlink:type="simple"/></inline-formula> of current haplotype estimates. Each element in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e009" xlink:type="simple"/></inline-formula> corresponds to one path through the graph which is going to be constructed. We define a probability distribution over possible paths for each element in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e010" xlink:type="simple"/></inline-formula> and probabilistically attach the elements in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e011" xlink:type="simple"/></inline-formula> to nodes in the graph. This enables us to allow for genotyping errors and missing data in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e012" xlink:type="simple"/></inline-formula> and puts some part of the probability mass of similar haplotypes on the same nodes, even if they differ in single positions (by setting the probability of genotyping error to 0, one obtains the deterministic BEAGLE/Ron et al. <xref ref-type="bibr" rid="pcbi.1002877-Ron1">[15]</xref> mode of haplotype propagation through the graph). In the process of building the graph, we collapse similar nodes for reasons of parsimony and computational efficiency. In defining node similarity, we introduce criteria that relate to each node's pattern of association with the HLA loci along the graph, and prevent collapsing two nodes that exhibit differing patterns of LD with HLA alleles (by setting the set of the loci that these additional criteria apply to the empty set, one obtains the conventional similarity criterion from BEAGLE/Ron et al. <xref ref-type="bibr" rid="pcbi.1002877-Ron1">[15]</xref>).</p>
          </list-item>
          <list-item>
            <p>Resampling: Construct the diploid HMM induced by the constructed haplotype graph and re-populate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e013" xlink:type="simple"/></inline-formula>. If a predefined number of iterations has not been exceeded, fit this HMM to the reference genotype data, re-populate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e014" xlink:type="simple"/></inline-formula> with haplotype samples from the HMM (imputing missing data) and go to step 2. Like Browning and Browning <xref ref-type="bibr" rid="pcbi.1002877-Browning3">[16]</xref>, we use an HMM that allows for genotyping error.</p>
          </list-item>
        </list>
        <p>The HMM resulting from the final iteration is used to generate HLA type estimates for all following imputation operations (BEAGLE, in contrast, builds joint haplotype graphs of imputation and reference panels, and carries out imputation as part of this procedure, which requires special measures for assuring convergence if the joint set is dominated by samples from the imputation dataset).</p>
      </sec>
      <sec id="s2b">
        <title>Availability, Performance, Usability</title>
        <p>Source code for HLA*IMP:02 is available from <ext-link ext-link-type="uri" xlink:href="http://oxfordhla.well.ox.ac.uk" xlink:type="simple">http://oxfordhla.well.ox.ac.uk</ext-link> (free for academic use). Compiling and running the program requires a standard UNIX server environment (ideally with multiple CPU cores and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e015" xlink:type="simple"/></inline-formula> GB RAM).</p>
        <p>To give an idea of the expected runtime, producing the graph for <italic>HLA-A</italic> for the first experiment presented in the “<xref ref-type="sec" rid="s3">Results</xref>” section took approximately 137 CPU hours (user plus system time for a single CPU; the program supports parallelization via openMP, so that the actual runtime on modern multi-CPU systems is much lower); carrying out inference for a single individual required approximately 4 CPU seconds (user plus system time).</p>
        <p>Like HLA*IMP, HLA*IMP:02 is also available as a front-end/back-end web service that integrates data preparation, QC and imputation. <xref ref-type="fig" rid="pcbi-1002877-g002">Figure 2</xref> shows the steps typically required to produce HLA type imputations, starting from SNP genotypes (for example in PLINK <xref ref-type="bibr" rid="pcbi.1002877-Purcell1">[17]</xref>, CHIAMO <xref ref-type="bibr" rid="pcbi.1002877-Marchini1">[18]</xref> or VCF formats). The system supports virtually all currently employed genotyping platforms, including genotyping arrays from Affymetrix, Illumina, and the Immunochip. The front-end converts genotype data into the format used by HLA*IMP:02, carries out quality control based on data completeness and aligns SNP genotypes to the positive strand (as defined in HapMap). All output data from the front-end can be directly uploaded to the HLA*IMP:02 server. Run in standard mode, the HLA*IMP:02 back-end will also produce allele- and locus-specific cross-validation estimates of accuracy, specific to the SNPs available in the user dataset. To ensure data protection and security, sample identifiers have to be anonymized prior to submission. The server stores all user data in a specially protected area, with no read access for the normal web server processes. Upon completion of an imputation job, the server generates a secondary access key, which is directly sent to the user; only the combination of access key and user account password will enable access to the imputation results.</p>
        <fig id="pcbi-1002877-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002877.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Standard workflow for HLA*IMP:02.</title>
            <p>Standard workflow for HLA*IMP:02: standard output data from popular genotyping platforms, for example current Illumina or Affymetrix chips, are converted into the HLA*IMP format using the locally installed front-end program. The front-end also carries out necessary steps of quality control, such as aligning SNP strandedness. The output files from the front-end are submitted to the HLA*IMP:02 server, which processes the data and produces imputations (posterior probabilities over pairs of alleles as well as a “best guess” pair of two alleles with associated quality scores).</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002877.g002" position="float" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2c">
        <title>HLA*IMP:01</title>
        <p>We compare the performance of HLA*IMP:02 to HLA*IMP, which we refer to as “HLA*IMP:01” for clarity. HLA*IMP:01 has been described elsewhere <xref ref-type="bibr" rid="pcbi.1002877-Dilthey1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Leslie1">[2]</xref>. Windows of 400 SNPs around the classical HLA loci and population prior frequencies, estimated from the reference panel, for classical HLA alleles were found to give good results, and these settings are identical to those used by the Internet implementation of HLA*IMP (<ext-link ext-link-type="uri" xlink:href="http://oxfordhla.well.ox.ac.uk" xlink:type="simple">http://oxfordhla.well.ox.ac.uk</ext-link>) and those used for recent genome-wide association studies <xref ref-type="bibr" rid="pcbi.1002877-Sawcer1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Strange1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Evans1">[19]</xref>.</p>
      </sec>
      <sec id="s2d">
        <title>Validation</title>
        <p>We validate HLA type imputations at the genotype level in a locus-specific manner, i.e. compare two unordered sets with two elements each for each individual and locus, one set (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e016" xlink:type="simple"/></inline-formula>) representing the imputation results and the other (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e017" xlink:type="simple"/></inline-formula>) containing the lab-derived types. We only consider individuals who carry two HLA alleles typed at 4-digit resolution at the locus under validation or one allele at 4-digit resolution and one missing allele. For 2-digit (serological properties of the HLA alleles) validation, we consider the same individuals, but we set the last 2 digits of each HLA allele to ‘00’ (this will lead to an underestimate of accuracy in some cases, as there are some serologically defined 2-digit allele groups that map to more than one pair of leading two digits). We may or may not apply a posterior probability call threshold <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e018" xlink:type="simple"/></inline-formula> on the per-allele level (see Section “HLA type inference” of the Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s011">Text S1</xref> for a description of how we calculate allele-specific posterior probabilities) to our imputations before validating.</p>
        <p>If there is no missing data in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e019" xlink:type="simple"/></inline-formula>, there are three possible cases:</p>
        <list list-type="bullet">
          <list-item>
            <p>0 imputations left after thresholding: we count 0 correctly imputed alleles out of 0.</p>
          </list-item>
          <list-item>
            <p>1 imputation (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e020" xlink:type="simple"/></inline-formula>) left after thresholding: we count 1 correctly imputed alleles out of 1 if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e021" xlink:type="simple"/></inline-formula>, otherwise 0 out of 1.</p>
          </list-item>
          <list-item>
            <p>2 imputations left after thresholding: we count 0 correct imputations out of 2 if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e022" xlink:type="simple"/></inline-formula>, 1 out of 2 if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e023" xlink:type="simple"/></inline-formula>, 2 out of 2 otherwise. (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e024" xlink:type="simple"/></inline-formula> is the “exclusive OR” operator, which is true if and only if exactly one of the arguments is true).</p>
          </list-item>
        </list>
        <p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e025" xlink:type="simple"/></inline-formula> (i.e. only one allele has been typed), there are also three possible cases:</p>
        <list list-type="bullet">
          <list-item>
            <p>0 imputations left after thresholding: we count 0 correctly imputed alleles out of 0.</p>
          </list-item>
          <list-item>
            <p>1 imputation (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e026" xlink:type="simple"/></inline-formula>) left after thresholding: we count 1 correctly imputed alleles out of 1 if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e027" xlink:type="simple"/></inline-formula>, otherwise 0 out of 1.</p>
          </list-item>
          <list-item>
            <p>2 imputations left after thresholding: we count 1 correct imputations out of 1 if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e028" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e029" xlink:type="simple"/></inline-formula> or both.</p>
          </list-item>
        </list>
        <p>In terms of thresholding strategies, we use either no threshold; or a threshold of T = 0.7 for both models; or a threshold of T = 0.7 for HLA*IMP:01 (as recommended in Dilthey et al. <xref ref-type="bibr" rid="pcbi.1002877-Dilthey1">[1]</xref>) and a threshold matched to obtain equal call rates for HLA*IMP:02. The last strategy is only employed to ensure comparability of results for the first baseline experiment (see next section), in which we compare the performance of HLA*IMP:01 and HLA*IMP:02 on a homogeneous dataset.</p>
        <p>At the per-locus level, we use concordance (which is, at the per-locus level, identical to PPV) as a measure of accuracy. We also provide more detailed statistics at the allele level (see below).</p>
      </sec>
      <sec id="s2e">
        <title>Data</title>
        <p>The experiments presented in this paper are based on different combinations of two datasets.</p>
        <p>The first set, denoted “Golden Set” (GS), has been described elsewhere <xref ref-type="bibr" rid="pcbi.1002877-Dilthey1">[1]</xref> and comprises 2512 individuals from the 1958 Birth Cohort (<ext-link ext-link-type="uri" xlink:href="http://www.b58cgene.sgul.ac.uk/" xlink:type="simple">http://www.b58cgene.sgul.ac.uk/</ext-link>), the HapMap CEU <xref ref-type="bibr" rid="pcbi.1002877-International2">[20]</xref> and the CEPH CEU+ <xref ref-type="bibr" rid="pcbi.1002877-deBakker1">[7]</xref> cohorts. Genotyping of the GS was carried out on the Illumina 1.2M and Affymetrix Genome-Wide Human SNP Array 6.0 chips. HLA typing methods vary according to the original cohort. Protocols for 1958 BC HLA genotyping are described online (<ext-link ext-link-type="uri" xlink:href="https://www-gene.cimr.cam.ac.uk/public_data/HLA/HLA.shtml" xlink:type="simple">https://www-gene.cimr.cam.ac.uk/public_data/HLA/HLA.shtml</ext-link>). CEU and CEU+ were typed using exon-sequencing methods.</p>
        <p>The second set, denoted “HLARES_ALL”, has been provided by GlaxoSmithKline and comprises (post quality control, as described in Dilthey et al. <xref ref-type="bibr" rid="pcbi.1002877-Dilthey1">[1]</xref>) 1460 individuals from diverse, though mainly European or European-ancestry, populations (see Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s007">Table S2</xref>). The individuals in HLARES_ALL were drawn from several clinical trials and typed on the Illumina 1 M SNP genotyping platform, and classical HLA type information (derived by exon sequencing) is available for many of them (see <xref ref-type="table" rid="pcbi-1002877-t001">Table 1</xref> for details). Genome-wide principal components analysis (PCA) of the samples in HLARES_ALL was carried out using the program EIGENSTRAT <xref ref-type="bibr" rid="pcbi.1002877-Price1">[21]</xref>.</p>
        <table-wrap id="pcbi-1002877-t001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002877.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Dataset characteristics summary.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002877-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002877.t001" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td colspan="12" align="left" rowspan="1">Number of individuals with at least one allele typed at 4-digit resolution (2-digit for DRB3, DRB4, DRB5)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">SNPs</td>
                  <td align="left" rowspan="1" colspan="1">HLA-A</td>
                  <td align="left" rowspan="1" colspan="1">HLA-B</td>
                  <td align="left" rowspan="1" colspan="1">HLA-C</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DQA1</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DQB1</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DRB1</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DPB1</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DRB3</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DRB4</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DRB5</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">7733</td>
                  <td align="left" rowspan="1" colspan="1">1556</td>
                  <td align="left" rowspan="1" colspan="1">1570</td>
                  <td align="left" rowspan="1" colspan="1">1153</td>
                  <td align="left" rowspan="1" colspan="1">87</td>
                  <td align="left" rowspan="1" colspan="1">1585</td>
                  <td align="left" rowspan="1" colspan="1">1517</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>HLARES_EU</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">7568</td>
                  <td align="left" rowspan="1" colspan="1">308</td>
                  <td align="left" rowspan="1" colspan="1">1060</td>
                  <td align="left" rowspan="1" colspan="1">349</td>
                  <td align="left" rowspan="1" colspan="1">279</td>
                  <td align="left" rowspan="1" colspan="1">446</td>
                  <td align="left" rowspan="1" colspan="1">897</td>
                  <td align="left" rowspan="1" colspan="1">74</td>
                  <td align="left" rowspan="1" colspan="1">282</td>
                  <td align="left" rowspan="1" colspan="1">282</td>
                  <td align="left" rowspan="1" colspan="1">282</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_EU</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">6056</td>
                  <td align="left" rowspan="1" colspan="1">1864</td>
                  <td align="left" rowspan="1" colspan="1">2630</td>
                  <td align="left" rowspan="1" colspan="1">1502</td>
                  <td align="left" rowspan="1" colspan="1">366</td>
                  <td align="left" rowspan="1" colspan="1">2031</td>
                  <td align="left" rowspan="1" colspan="1">2414</td>
                  <td align="left" rowspan="1" colspan="1">74</td>
                  <td align="left" rowspan="1" colspan="1">282</td>
                  <td align="left" rowspan="1" colspan="1">282</td>
                  <td align="left" rowspan="1" colspan="1">282</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_EU 2/3</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">6056</td>
                  <td align="left" rowspan="1" colspan="1">1253</td>
                  <td align="left" rowspan="1" colspan="1">1758</td>
                  <td align="left" rowspan="1" colspan="1">1017</td>
                  <td align="left" rowspan="1" colspan="1">250</td>
                  <td align="left" rowspan="1" colspan="1">1359</td>
                  <td align="left" rowspan="1" colspan="1">1592</td>
                  <td align="left" rowspan="1" colspan="1">50</td>
                  <td align="left" rowspan="1" colspan="1">187</td>
                  <td align="left" rowspan="1" colspan="1">187</td>
                  <td align="left" rowspan="1" colspan="1">187</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_EU 1/3</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">6056</td>
                  <td align="left" rowspan="1" colspan="1">611</td>
                  <td align="left" rowspan="1" colspan="1">872</td>
                  <td align="left" rowspan="1" colspan="1">485</td>
                  <td align="left" rowspan="1" colspan="1">116</td>
                  <td align="left" rowspan="1" colspan="1">672</td>
                  <td align="left" rowspan="1" colspan="1">822</td>
                  <td align="left" rowspan="1" colspan="1">24</td>
                  <td align="left" rowspan="1" colspan="1">95</td>
                  <td align="left" rowspan="1" colspan="1">95</td>
                  <td align="left" rowspan="1" colspan="1">95</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_ALL</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">7632</td>
                  <td align="left" rowspan="1" colspan="1">2028</td>
                  <td align="left" rowspan="1" colspan="1">3063</td>
                  <td align="left" rowspan="1" colspan="1">1675</td>
                  <td align="left" rowspan="1" colspan="1">521</td>
                  <td align="left" rowspan="1" colspan="1">2223</td>
                  <td align="left" rowspan="1" colspan="1">2809</td>
                  <td align="left" rowspan="1" colspan="1">112</td>
                  <td align="left" rowspan="1" colspan="1">353</td>
                  <td align="left" rowspan="1" colspan="1">353</td>
                  <td align="left" rowspan="1" colspan="1">353</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_ALL 2/3</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">7632</td>
                  <td align="left" rowspan="1" colspan="1">1356</td>
                  <td align="left" rowspan="1" colspan="1">2055</td>
                  <td align="left" rowspan="1" colspan="1">1129</td>
                  <td align="left" rowspan="1" colspan="1">354</td>
                  <td align="left" rowspan="1" colspan="1">1495</td>
                  <td align="left" rowspan="1" colspan="1">1853</td>
                  <td align="left" rowspan="1" colspan="1">77</td>
                  <td align="left" rowspan="1" colspan="1">242</td>
                  <td align="left" rowspan="1" colspan="1">242</td>
                  <td align="left" rowspan="1" colspan="1">242</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_ALL 1/3</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">7632</td>
                  <td align="left" rowspan="1" colspan="1">672</td>
                  <td align="left" rowspan="1" colspan="1">1008</td>
                  <td align="left" rowspan="1" colspan="1">546</td>
                  <td align="left" rowspan="1" colspan="1">167</td>
                  <td align="left" rowspan="1" colspan="1">728</td>
                  <td align="left" rowspan="1" colspan="1">956</td>
                  <td align="left" rowspan="1" colspan="1">35</td>
                  <td align="left" rowspan="1" colspan="1">111</td>
                  <td align="left" rowspan="1" colspan="1">111</td>
                  <td align="left" rowspan="1" colspan="1">111</td>
                </tr>
              </tbody>
            </table>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td colspan="12" align="left" rowspan="1">Number of 4-digit HLA alleles (2-digit for DRB3, DRB4, DRB5)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="center" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">HLA-A</td>
                  <td align="left" rowspan="1" colspan="1">HLA-B</td>
                  <td align="left" rowspan="1" colspan="1">HLA-C</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DQA1</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DQB1</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DRB1</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DPB1</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DRB3</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DRB4</td>
                  <td align="left" rowspan="1" colspan="1">HLA-DRB5</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">27</td>
                  <td align="left" rowspan="1" colspan="1">46</td>
                  <td align="left" rowspan="1" colspan="1">21</td>
                  <td align="left" rowspan="1" colspan="1">7</td>
                  <td align="left" rowspan="1" colspan="1">18</td>
                  <td align="left" rowspan="1" colspan="1">34</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>HLARES_EU</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">34</td>
                  <td align="left" rowspan="1" colspan="1">60</td>
                  <td align="left" rowspan="1" colspan="1">28</td>
                  <td align="left" rowspan="1" colspan="1">14</td>
                  <td align="left" rowspan="1" colspan="1">17</td>
                  <td align="left" rowspan="1" colspan="1">43</td>
                  <td align="left" rowspan="1" colspan="1">18</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                  <td align="left" rowspan="1" colspan="1">3</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_EU</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">38</td>
                  <td align="left" rowspan="1" colspan="1">65</td>
                  <td align="left" rowspan="1" colspan="1">30</td>
                  <td align="left" rowspan="1" colspan="1">14</td>
                  <td align="left" rowspan="1" colspan="1">19</td>
                  <td align="left" rowspan="1" colspan="1">47</td>
                  <td align="left" rowspan="1" colspan="1">18</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                  <td align="left" rowspan="1" colspan="1">3</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_EU 2/3</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">33</td>
                  <td align="left" rowspan="1" colspan="1">60</td>
                  <td align="left" rowspan="1" colspan="1">27</td>
                  <td align="left" rowspan="1" colspan="1">13</td>
                  <td align="left" rowspan="1" colspan="1">19</td>
                  <td align="left" rowspan="1" colspan="1">42</td>
                  <td align="left" rowspan="1" colspan="1">15</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                  <td align="left" rowspan="1" colspan="1">3</td>
                  <td align="left" rowspan="1" colspan="1">3</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_EU 1/3</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">28</td>
                  <td align="left" rowspan="1" colspan="1">52</td>
                  <td align="left" rowspan="1" colspan="1">24</td>
                  <td align="left" rowspan="1" colspan="1">11</td>
                  <td align="left" rowspan="1" colspan="1">17</td>
                  <td align="left" rowspan="1" colspan="1">37</td>
                  <td align="left" rowspan="1" colspan="1">13</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                  <td align="left" rowspan="1" colspan="1">3</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_ALL</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">58</td>
                  <td align="left" rowspan="1" colspan="1">110</td>
                  <td align="left" rowspan="1" colspan="1">39</td>
                  <td align="left" rowspan="1" colspan="1">15</td>
                  <td align="left" rowspan="1" colspan="1">21</td>
                  <td align="left" rowspan="1" colspan="1">62</td>
                  <td align="left" rowspan="1" colspan="1">21</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                  <td align="left" rowspan="1" colspan="1">3</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_ALL 2/3</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">48</td>
                  <td align="left" rowspan="1" colspan="1">99</td>
                  <td align="left" rowspan="1" colspan="1">34</td>
                  <td align="left" rowspan="1" colspan="1">14</td>
                  <td align="left" rowspan="1" colspan="1">20</td>
                  <td align="left" rowspan="1" colspan="1">56</td>
                  <td align="left" rowspan="1" colspan="1">17</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                  <td align="left" rowspan="1" colspan="1">3</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>GS&amp;HLARES_ALL 1/3</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">45</td>
                  <td align="left" rowspan="1" colspan="1">85</td>
                  <td align="left" rowspan="1" colspan="1">30</td>
                  <td align="left" rowspan="1" colspan="1">13</td>
                  <td align="left" rowspan="1" colspan="1">20</td>
                  <td align="left" rowspan="1" colspan="1">49</td>
                  <td align="left" rowspan="1" colspan="1">17</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                  <td align="left" rowspan="1" colspan="1">3</td>
                  <td align="left" rowspan="1" colspan="1">3</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>The upper part of this table shows the number of individuals that are available for building the HLA*IMP:02 graphs in a locus-specific manner. For HLA*IMP, the number of available haplotypes is approximately double the individual number. The bottom part of the table shows allelic diversity for all reference and validation datasets used in our study. Note that the allelic diversity in the HLARES and in the GS&amp;HLARES 2/3 datasets is bigger than in the GS.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>We resolve ambiguous HLA type information by using the maximum population frequency call. Besides that, we treat all HLA genotypes “as is”; that is, we make no attempt to control, for example, for changes of HLA nomenclature or allele databases. This might lead to slight underestimates of accuracy (in the worst case, we do not recognize identical alleles as identical).</p>
        <p>In the first experiment (homogeneous reference), we evaluate the performance of statistical HLA type imputation (<italic>HLA-A</italic> , <italic>-B</italic> , <italic>-C</italic> , <italic>-DQA1</italic> , <italic>-DQB1</italic> and <italic>-DRB1</italic>) on cross-European samples, based on a mainly British reference panel. We use the GS as reference panel to impute classical HLA types of those samples in HLARES_ALL with self-declared European ancestry (HLARES_EU) and measure concordance with lab-derived HLA type information where available. Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s007">Table S2</xref> describes the distribution of countries the individuals in HLARES_EU were sampled from. There are 6056 SNPs in the extended MHC region (xMHC, here defined as the chromosomal region on chromosome 6 from position 25,921,129 to position 33,535,328, build 36; see Horton et al. <xref ref-type="bibr" rid="pcbi.1002877-Horton1">[22]</xref>) in the intersection of the GS and HLARES_EU datasets. To mirror the context in which HLA*IMP:01 was applied in recent genome-wide association studies <xref ref-type="bibr" rid="pcbi.1002877-Sawcer1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Strange1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Evans1">[19]</xref>, we further restrict the available SNP set to those also present in one of them <xref ref-type="bibr" rid="pcbi.1002877-Sawcer1">[3]</xref>, resulting in 2020 SNPs.</p>
        <p>In the second experiment (medium heterogeneity), we evaluate the performance of statistical HLA type imputation on European samples, based on a cross-European reference panel. To obtain a cross-European reference panel (GS&amp;HLARES_EU), we merge the GS and HLARES_EU datasets, keeping only SNPs in the intersection of the two panels (6056 xMHC SNPs). We randomly split GS&amp;HLARES_EU into two panels, and use the first one (GS&amp;HLARES_EU 2/3, containing approximately 2/3 of the original data) as reference, and the second one (GS&amp;HLARES_EU 1/3, approximately 1/3 of the original data) as validation panel. Referring to the increased population structure in GS&amp;HLARES_EU 2/3 as compared to GS, we call GS&amp;HLARES_EU 2/3 a heterogeneous reference panel. We measure concordance with experimentally-derived HLA type information where available. We use the data on additional loci present in GS&amp;HLARES_EU (<italic>HLA-DPB1</italic> , <italic>-DRB3</italic> , <italic>-DRB4</italic> , <italic>-DRB5</italic>) to evaluate how well their allelic states can be imputed. Also, in a variation of the second experiment, we modify the SNP density in the xMHC region to investigate to what extent performance will depend on the selected SNP genotyping platform and data missingness profiles.</p>
        <p>In the third experiment (high heterogeneity), we evaluate the performance of statistical HLA type imputation on multi-ethnic samples, based on a multi-ethnic reference panel. To obtain a multi-ethnic reference panel (GS&amp;HLARES_ALL), we merge the GS and HLARES_ALL datasets. We also include the HapMap YRI cohort <xref ref-type="bibr" rid="pcbi.1002877-International2">[20]</xref>, as individuals self-reporting as of African ancestry constitute a subset of HLARES_ALL. We keep all available SNP genotypes from the intersection of GS and YRI (7733 SNPs from GS of which 7632 xMHC SNPs are also present in YRI), and combine them with the SNP genotypes from HLARES_ALL (6050 SNPs, setting the remaining 1582 SNP genotypes to “missing”). The resulting set GS&amp;HLARES_ALL has 7632 xMHC SNPs. We randomly split GS&amp;HLARES_ALL in two panels, and use the first one (GS&amp;HLARES_ALL 2/3, containing approximately 2/3 of the original data) as reference, and the second one as (GS&amp;HLARES_ALL 1/3, approximately 1/3 of the original data) as validation panel. We call GS&amp;HLARES_ALL 1/3 a “highly heterogeneous” reference panel. Note that GS&amp;HLARES_ALL is still dominated by samples of European origin. We measure concordance with experimentally-derived HLA type information where available.</p>
        <p><xref ref-type="table" rid="pcbi-1002877-t001">Table 1</xref> provides a summary of the number of individuals and HLA alleles present in all reference and validation panels.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <p>We have repeated some of the initial HapMap-based experiments from Dilthey et al. <xref ref-type="bibr" rid="pcbi.1002877-Dilthey1">[1]</xref> to investigate the effects of the methodological innovations proposed in this paper (see Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s006">Table S1</xref> and Section “Properties of the presented model and parameter inference” in the Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s011">Text S1</xref>). We find that allowing for path uncertainty has a positive effect across all examined loci. The additional localization criteria, though theoretically appealing, do not consistently improve accuracy across loci (see Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s011">Text S1</xref>, Section “Properties of the presented model and parameter inference”). Based on our initial experiments, localization is not used for <italic>HLA-B</italic> and <italic>HLA-DRB1</italic> .</p>
      <p>On a homogeneous reference panel (first experiment, GS), HLA*IMP:02 achieves the same level of performance as HLA*IMP (see <xref ref-type="table" rid="pcbi-1002877-t002">Table 2</xref>). Measured at six classical HLA loci (<italic>HLA-A</italic> , <italic>-B</italic> , <italic>-C</italic> , <italic>-DQA1</italic> , <italic>-DQB1</italic> and <italic>-DRB1</italic>), HLA*IMP:02 achieves an average 4-digit resolution accuracy of 94% at an average call rate of 97%, vs. 93% accuracy at a call rate of 97% for HLA*IMP:01 (call threshold T = 0.7 for HLA*IMP:01 and matched to obtain equal or higher call rates for HLA*IMP:02). Locus-specific performance is very similar for both models. We observe the lowest accuracy at <italic>HLA-DQA1</italic> (88%) and the lowest call rate at <italic>HLA-DRB1</italic> (90%).</p>
      <table-wrap id="pcbi-1002877-t002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002877.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Baseline validation on a homogeneous reference panel.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi-1002877-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002877.t002" xlink:type="simple"/>
          <table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Threshold</td>
                <td align="left" rowspan="1" colspan="1">Locus</td>
                <td align="left" rowspan="1" colspan="1"># Validated</td>
                <td colspan="3" align="left" rowspan="1">HLA*IMP:02</td>
                <td colspan="3" align="left" rowspan="1">HLA:IMP:01</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Call Rate</td>
                <td align="left" rowspan="1" colspan="1">Accuracy</td>
                <td align="left" rowspan="1" colspan="1">T</td>
                <td align="left" rowspan="1" colspan="1">Call Rate</td>
                <td align="left" rowspan="1" colspan="1">Accuracy</td>
                <td align="left" rowspan="1" colspan="1">T</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">T =  0.00</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">574</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">2002</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">596</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">446</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.87</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.87</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">758</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1730</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.89</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">T = Matched</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">574</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.55</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
                <td align="left" rowspan="1" colspan="1">0.700</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">2002</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
                <td align="left" rowspan="1" colspan="1">0.92</td>
                <td align="left" rowspan="1" colspan="1">0.40</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
                <td align="left" rowspan="1" colspan="1">0.700</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">596</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.60</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.700</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">446</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
                <td align="left" rowspan="1" colspan="1">0.40</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
                <td align="left" rowspan="1" colspan="1">0.700</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">758</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
                <td align="left" rowspan="1" colspan="1">0.60</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.700</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1730</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
                <td align="left" rowspan="1" colspan="1">0.60</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
                <td align="left" rowspan="1" colspan="1">0.700</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt102">
            <label/>
            <p>Non-thresholded and thresholded HLARES validation results for HLA*IMP:02 and HLA*IMP:01: the complete GS is used to impute HLARES_EU samples. Accuracy (PPV) is measured at 4-digit resolution. “# Validated” refers to the number of validated alleleles (pre-thresholding). Note that the call threshold for HLA*IMP:02 was matched to obtain equal or higher call rates than with HLA*IMP:01.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>On a heterogeneous reference panel (second experiment, GS&amp;HLARES_EU 2/3), HLA*IMP:02 achieves an average accuracy of 97% at an average call rate of 97% (see <xref ref-type="table" rid="pcbi-1002877-t003">Table 3</xref>). HLA*IMP:01, in contrast, achieves an average accuracy of 93% at an average call rate of 93% (using a call threshold of T = 0.7 for both models). The most problematic locus for HLA*IMP:02 is <italic>HLA-DRB1</italic> , with an achieved accuracy/call rate of 95%/91%. Even without call threshold, HLA*IMP:02 achieves an all-loci average accuracy of 96% (vs. 90% for HLA*IMP:01). At T = 0.00, HLA*IMP:02 outperforms HLA*IMP:01 at every locus, by 6% on average. Applied to <italic>HLA-DPB1</italic> and the allelic state of the <italic>DRB</italic> paralogs (see Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s008">Table S3</xref>), HLA*IMP:02 achieves an accuracy of 90% on <italic>DPB1</italic> without any call threshold. Due to the limitations of the data set, we can only evaluate the performance at the <italic>DRB</italic> paralogous loci at 2-digit resolution, including one pseudo-allele for absence from a haplotype. We find the imputations to be correct in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e030" xlink:type="simple"/></inline-formula>94% of cases (T = 0.00, very similar results obtained for HLA*IMP:01, data not shown). HLA*IMP:02 produces well-calibrated imputations (see Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s001">Figure S1</xref>).</p>
      <table-wrap id="pcbi-1002877-t003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002877.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Multi-population European validation results.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi-1002877-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002877.t003" xlink:type="simple"/>
          <table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Threshold</td>
                <td align="left" rowspan="1" colspan="1">Locus</td>
                <td align="left" rowspan="1" colspan="1"># Validated</td>
                <td colspan="2" align="left" rowspan="1">HLA*IMP:02</td>
                <td colspan="2" align="left" rowspan="1">HLA:IMP:01</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Call Rate</td>
                <td align="left" rowspan="1" colspan="1">Accuracy</td>
                <td align="left" rowspan="1" colspan="1">Call Rate</td>
                <td align="left" rowspan="1" colspan="1">Accuracy</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">T =  0.00</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">808</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1646</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.89</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">752</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">194</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.87</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">934</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.92</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1358</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.87</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">T = 0.70</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">808</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1646</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
                <td align="left" rowspan="1" colspan="1">0.92</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">752</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">194</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">934</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1358</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
                <td align="left" rowspan="1" colspan="1">0.89</td>
                <td align="left" rowspan="1" colspan="1">0.92</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt103">
            <label/>
            <p>Medium heterogeneity non-thresholded and thresholded cross-validation results for HLA*IMP:02 and HLA*IMP:01: GS&amp;HLARES_EU 2/3 is used to impute GS&amp;HLARES_EU 1/3. Accuracy (PPV) is measured at 4-digit resolution. “# Validated” refers to the number of validated alleleles (pre-thresholding).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>By analyzing allele- and locus-specific error profiles, we can identify factors influencing the imputation accuracy of HLA*IMP:02 (see <xref ref-type="fig" rid="pcbi-1002877-g003">Figure 3</xref>). First, we note that most alleles are imputed reliably at 4-digit resolution, in particular those with higher frequencies in the reference panel. Alleles that exhibit problems at 4-digit imputation are typically correctly imputed at 2-digit resolution. Second, we can distinguish between at least three classes of problems. Some alleles, for example HLA-A*33:01, are not present in the reference dataset at all. They can therefore not be correctly imputed. Other alleles, for example HLA-B*27:02, are present in the reference dataset, but at low frequencies. Non-calls and 4-digit errors accumulate for these alleles. Third, some alleles, for example DRB1*01:01, are better represented in the reference panel, but there are still some problems with imputing them correctly. We note that these error modes are also seen in HLA*IMP:01 and that the identified classes of error also apply to the homogeneous reference experiment (see Supporting Figures S2, S3, S4). Finally, there is another abundant type of error, seen only in HLA*IMP:01 and not observed in the low heterogeneity case, which drives the observed drop in performance difference relative to HLA*IMP:02: classification problems for well-represented alleles. It seems likely that this is due to within-Europe population structure and heterogeneity in haplotype backgrounds, which the model of HLA*IMP:01 cannot take into account appropriately. We provide allele-specific measures of sensitivity, specificity, PPV and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e031" xlink:type="simple"/></inline-formula>, based on HLA*IMP:02, for the first two experiments in Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s009">Tables S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002877.s010">S5</xref>.</p>
      <fig id="pcbi-1002877-g003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002877.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Per-allele accuracies on a diverse European reference panel (HLA*IMP:02).</title>
          <p>Per-allele analysis of HLA*IMP:02 imputation accuracy for six classical loci in the GS&amp;HLARES_EU cross-European validation experiment at a call threshold of T = 0.70. The x-axis represents the different HLA alleles in the validation panel. The downward blue bars indicate how often each allele appears in the reference panel (the GS&amp;HLARES_EU 2/3 dataset). Imputation success is indicated by the upward stack plots: green indicates correct imputations at 4-digit HLA type resolution; orange indicates correct imputations at 2-digit resolution; black indicates alleles below the call threshold; red indicates incorrect imputations. Non-calls and imputations which are only correct at 2-digit resolution accumulate in the alleles which are rare or not present at all in the reference panel.</p>
        </caption>
        <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002877.g003" position="float" xlink:type="simple"/>
      </fig>
      <p>To investigate how strong an effect the utilized SNP genotyping array and missing data in the imputation dataset will have on expected accuracy, we carry out a variation of the second experiment. Instead of separately evaluating a range of genotyping platforms and missingness profiles, we present two generic experiments, focusing on SNP density in the xMHC region: we randomly delete 70% and 90% of the SNP genotypes from the inference panel (independently for each individual, to minimize sampling effects), while the graph from the second experiment remains unchanged. In the 70% scenario, each individual remains with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e032" xlink:type="simple"/></inline-formula>1500 SNPs in the xMHC region, which is comparable to the SNP density of many 500 K arrays. In the 90% scenario, approximately 600 SNPs in the xMHC region remain, which is substantially less than the number provided by older <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e033" xlink:type="simple"/></inline-formula>00 K genotyping arrays. We observe that even with low SNP densities, the observed performance of HLA*IMP:02 is relatively stable: Setting 70% of the SNP genotypes in the inference panel (GS&amp;HLARES_EU 1/3) to “missing”, the drop in achieved per-locus accuracy is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e034" xlink:type="simple"/></inline-formula>1% (at a call threshold of T = 0.00, see <xref ref-type="table" rid="pcbi-1002877-t004">Table 4</xref>). Setting 90% of the SNP genotypes in the inference panel to “missing”, the maximum loss in accuracy is 5% for all loci but <italic>DQA1</italic> (probably related to the smaller amount of reference data for this locus, see <xref ref-type="table" rid="pcbi-1002877-t001">Table 1</xref>), where it is 7%. Of note, many reference panel SNPs are present on the Immunochip platform; repeating the second experiment constrained to the Immunochip SNP set for the imputation panel shows virtually the same results as the 70% experiment (data not shown).</p>
      <table-wrap id="pcbi-1002877-t004" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002877.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>Missing data in the inference panel.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi-1002877-t004-4" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002877.t004" xlink:type="simple"/>
          <table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Locus</td>
                <td align="left" rowspan="1" colspan="1"># Validated</td>
                <td align="left" rowspan="1" colspan="1">70% missing</td>
                <td align="left" rowspan="1" colspan="1">90% missing</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">808</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1646</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">752</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">194</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">934</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1358</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1">0.86</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt104">
            <label/>
            <p>4-digit resolution accuracies (PPV) when 70% and 90% of the inference panel SNP genotypes (GS&amp;HLARES_EU 1/3) in the second experiment are randomly set to “missing”. No call threshold is employed. “# Validated” refers to the number of validated alleleles.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Increasing the heterogeneity in the reference panel (third experiment, GS&amp;HLARES_ALL 2/3) by including individuals of other ethnicities (African-ancestry, Asian, Hispanic, third experiment) only slightly decreases the achieved performance on the European validation samples for HLA*IMP:02 (see <xref ref-type="table" rid="pcbi-1002877-t005">Table 5</xref>), yielding an average accuracy of 97% and an average call rate of 95% (T = 0.70). At 4-digit resolution, performance on the non-European samples is markedly lower, with an average accuracy and an average call rate of 87% (T = 0.70). Imputation accuracy is lowest for the Asian samples (average accuracy 76% at T = 0.00) and comparable for African-ancestry and Hispanic samples (84% and 85% respectively, at T = 0.00). There are more pronounced locus-specific differences in the non-European validation data: In the African-ancestry samples and at T = 0.00, for example, accuracy at <italic>HLA-DRB1</italic> is at 71%, whereas it is at 97% at <italic>HLA-C</italic> . At 2-digit resolution, alleles are imputed more reliably: average accuracy at T = 0.00 is 90% for Asian samples (ranging from 78% at <italic>HLA-B</italic> to 98% at <italic>HLA-DRB1</italic>); 93% for samples of African ancestry (ranging from 82% at <italic>HLA-B</italic> to 100% at <italic>HLA-C/DQA1/DQB1</italic>); and 99% for Hispanic samples (ranging from 97% at <italic>HLA-B</italic> to 100% at all other loci);</p>
      <table-wrap id="pcbi-1002877-t005" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002877.t005</object-id>
        <label>Table 5</label>
        <caption>
          <title>Multi-ethnic validation results.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi-1002877-t005-5" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002877.t005" xlink:type="simple"/>
          <table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Threshold</td>
                <td align="left" rowspan="1" colspan="1">Population</td>
                <td align="left" rowspan="1" colspan="1">Locus</td>
                <td align="left" rowspan="1" colspan="1"># Validated</td>
                <td align="left" rowspan="1" colspan="1">Call Rate</td>
                <td align="left" rowspan="1" colspan="1">Accuracy 4-digit</td>
                <td align="left" rowspan="1" colspan="1">Accuracy 2-digit</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">T = 0.00</td>
                <td align="left" rowspan="1" colspan="1">African-American/African</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">30</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.73</td>
                <td align="left" rowspan="1" colspan="1">0.83</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">44</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.73</td>
                <td align="left" rowspan="1" colspan="1">0.82</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">30</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">30</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.87</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">34</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.71</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Asian</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.79</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">110</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.68</td>
                <td align="left" rowspan="1" colspan="1">0.78</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.82</td>
                <td align="left" rowspan="1" colspan="1">0.89</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">22</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.73</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">36</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.83</td>
                <td align="left" rowspan="1" colspan="1">0.89</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">102</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.72</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">European</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">824</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1662</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">752</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">206</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">924</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1356</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Hispanic</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.82</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">126</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.63</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">36</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.92</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">40</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">128</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.80</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">T = 0.70</td>
                <td align="left" rowspan="1" colspan="1">African-American/African</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">30</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
                <td align="left" rowspan="1" colspan="1">0.79</td>
                <td align="left" rowspan="1" colspan="1">0.89</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">44</td>
                <td align="left" rowspan="1" colspan="1">0.89</td>
                <td align="left" rowspan="1" colspan="1">0.79</td>
                <td align="left" rowspan="1" colspan="1">0.85</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">30</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">30</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
                <td align="left" rowspan="1" colspan="1">0.89</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">34</td>
                <td align="left" rowspan="1" colspan="1">0.59</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Asian</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.81</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">110</td>
                <td align="left" rowspan="1" colspan="1">0.71</td>
                <td align="left" rowspan="1" colspan="1">0.85</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">0.86</td>
                <td align="left" rowspan="1" colspan="1">0.79</td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">22</td>
                <td align="left" rowspan="1" colspan="1">0.82</td>
                <td align="left" rowspan="1" colspan="1">0.78</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">36</td>
                <td align="left" rowspan="1" colspan="1">0.83</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">102</td>
                <td align="left" rowspan="1" colspan="1">0.74</td>
                <td align="left" rowspan="1" colspan="1">0.83</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">European</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">824</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1662</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">752</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">206</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">924</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">1356</td>
                <td align="left" rowspan="1" colspan="1">0.87</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Hispanic</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.82</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">126</td>
                <td align="left" rowspan="1" colspan="1">0.75</td>
                <td align="left" rowspan="1" colspan="1">0.73</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-C</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">36</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQA1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">0.86</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DQB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">40</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>HLA-DRB1</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">128</td>
                <td align="left" rowspan="1" colspan="1">0.73</td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt105">
            <label/>
            <p>High heterogeneity non-thresholded and thresholded cross-validation results for HLA*IMP:02, stratified by ethnicity of the imputed samples. GS&amp;HLARES_ALL 2/3 is used to impute GS&amp;HLARES_ALL 1/3. Accuracy (PPV) is measured at 4-digit resolution and at 2-digit resolution. “# Validated” refers to the number of validated alleleles (pre-thresholding).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>Better imputation of classical HLA alleles is an important goal in enabling association studies to understand the genetic risk of many complex and infectious diseases. We have developed HLA*IMP:02, a statistical model for the imputation of classical HLA types, which attempts to address problems arising in performing imputation from multiple heterogeneous (both in experimental origin and ethnicity) data sets. We have shown that HLA*IMP:01 (our previous method; <xref ref-type="bibr" rid="pcbi.1002877-Dilthey1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Leslie1">[2]</xref>) and HLA*IMP:02 achieve similar levels of performance on homogeneous reference panels, but that HLA*IMP:02 clearly outperforms HLA*IMP:01 on heterogeneous European reference panels, yielding accuracies and call rates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e035" xlink:type="simple"/></inline-formula>95% at 4-digit resolution in nearly all European scenarios. Using HLA*IMP:02 instead of HLA*IMP:01 can therefore be expected to increase power and accuracy in cross-European genome-wide association studies.</p>
      <p>The improved performance of HLA*IMP:02 (when compared with HLA*IMP:01) is likely due to the path-based approach that allows for HLA alleles to appear on multiple haplotype backgrounds, a known consequence of population stratification in the HLA region. To further investigate this hypothesis, we have examined the local haplotype structure around the HLA-A*02:01 allele in GS&amp;HLARES_EU, as inferred (and used) by HLA*IMP:01 (Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s005">Figure S5</xref>, part B). From visual inspection of the figure, it is clear that there are at least three major haplotypic backgrounds for 02:01 (when inspecting the corresponding figure for the GS, we find two major haplotypic backgrounds; Supporting <xref ref-type="supplementary-material" rid="pcbi.1002877.s005">Figure S5</xref>, part A). What is more, when comparing the haplotypes that HLA*IMP:01 correctly imputes with those that it doesn't, we find that there are features which appear virtually exclusively in the second group (marked in S11 part B). Interestingly, these features are also present in the group of haplotypes that serve as reference panel, but the model does not seem to utilize this information in the right way. This is consistent with our interpretation that the model of HLA*IMP:01 does not cope well with haplotypic heterogeneity. HLA*IMP:02, on the other hand, can accommodate haplotypic heterogeneity and imputes A*02:01 nearly perfectly in the same experiment.</p>
      <p>The observed performance of HLA*IMP:02 is relatively stable under high levels of missing data in the inference panel. This property represents an important improvement upon HLA*IMP:01, which offered no conceptually consistent way (except for repeating the computationally intensive process of SNP selection) towards dealing with missing SNPs in the inference panel. Of note, the HLA*IMP:02 back end web service will automatically carry out the SNP density experiment presented here, constraining the set of available SNPs to those found in the user dataset. The results from this experiment (including average per-locus accuracies and PPV, sensitivity and specificity for each allele) are included in the archive file which contains the main imputations.</p>
      <p>The model of HLA*IMP:02 could handle pre-phased data in a straightforward way. There is no evidence to suggest that recent encouraging results from SNP genotype imputation <xref ref-type="bibr" rid="pcbi.1002877-Howie2">[23]</xref> do not apply to pre-phasing with the aim of HLA type imputation. However, in light of the complex regional haplotype structure and high levels of diversity, we believe that the effect of pre-phasing on HLA type imputation accuracy needs to be studied in more detail.</p>
      <p>At 2-digit resolution, HLA*IMP:02 achieves average accuracies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e036" xlink:type="simple"/></inline-formula>90% for all tested ethnicities using a multi-ethnic reference panel. These results suggest that the model's ability to deal with heterogeneity in the reference set extends to highly diverse panels. Moreover, extensions of the reference panel in a way that matches imputation study panels can be expected to furthermore increase (4-digit) performance, in particular for samples that are not well-represented by the current reference. We illustrate this effect in <xref ref-type="fig" rid="pcbi-1002877-g004">Figure 4</xref> for <italic>HLA-DRB1</italic> , one of the more challenging loci for HLA type imputation. The figure displays samples from HLARES_ALL 1/3 stratified by the samples' first two principal components (it is well-known that PCA can be used to control for population stratification <xref ref-type="bibr" rid="pcbi.1002877-Novembre1">[24]</xref> and is informative of relatedness <xref ref-type="bibr" rid="pcbi.1002877-McVean1">[25]</xref>). In one experiment, we use an exclusively European reference to impute the samples (left-hand panel). In the other experiment, we make use of the full reference panel GS&amp;HLARES ALL 2/3 (right-hand panel). Particularly samples in the periphery of PC space benefit from improving reference panel size and match with the imputation panel, whereas samples in the proximity of European data are hardly affected. Averaged over all loci, accuracy for the non-European samples increases by 8% when including the non-European reference data (data not shown). These observations are consistent with results from SNP genotype imputation, where using matched and diverse reference panels is also known to have a positive effect on accuracy <xref ref-type="bibr" rid="pcbi.1002877-Jostins1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Howie1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Marchini2">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1002877-Li2">[27]</xref>.</p>
      <fig id="pcbi-1002877-g004" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002877.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Accuracy comparison between complete and European-restricted reference panels.</title>
          <p>PCA-stratified accuracy comparison (<italic>HLA-DRB1</italic>) between the complete reference panel (GS&amp;HLARES_ALL, right plot) and a European-restricted reference panel (left side) for the high heterogeneity scenario (imputing GS&amp;HLARES_ALL 1/3, only samples from HLARES displayed). In each quadrant, mean accuracy (PPV) is indicated by color. The red triangle indicates the (approximate) centre of the European reference data. Note that incorporating the non-European reference data increases accuracy in particular for the non-European samples.</p>
        </caption>
        <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002877.g004" position="float" xlink:type="simple"/>
      </fig>
      <p>In summary, the model of HLA*IMP:02 contributes to solving the important challenge of making HLA type inference from combined multi-population reference panels. Raising the accuracy of 4-digit imputation accuracy for non-European populations to the level currently observed for European samples is an important future goal that will require collection of reference data from other populations. However, the framework developed here should enable such integration to happen without compromising accuracy in European-ancestry populations.</p>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002877.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002877.s001" position="float" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>Calibration HLA*IMP:02.</bold> Calibration plot HLA*IMP:02, second experiment, medium heterogeneity. The red points show expected (x-axis) and achieved mean accuracies (y-axis) in each bin of step size 0.1, and the blue line is a plot of x = y. Note that the first four data points (bins 0–3) are only based on 37 individuals.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002877.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002877.s002" position="float" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p><bold>Per-allele analysis for HLA*IMP:02/HLARES.</bold> Per-allele analysis of HLA*IMP:02 imputation accuracy for six classical loci in the HLARES validation experiment (first experiment, homogeneous reference) at a call threshold of T = 0.70. The x-axis represents the different HLA alleles in the validation panel. The downward blue bars indicate how often each allele appears in the reference panel (the GS dataset). Imputation success is indicated by the upward stack plots: green indicates correct imputations at 4-digit HLA type resolution; orange indicates correct imputations at 2-digit resolution; black indicates alleles below the call threshold; red indicates incorrect imputations.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002877.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002877.s003" position="float" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p><bold>Per-allele analysis for HLA*IMP:01/HLARES.</bold> Per-allele analysis of HLA*IMP:01 imputation accuracy for six classical loci in the HLARES validation experiment (first experiment, homogeneous reference) at a call threshold of T = 0.70. The x-axis represents the different HLA alleles in the validation panel. The downward blue bars indicate how often each allele appears in the reference panel (the GS dataset). Imputation success is indicated by the upward stack plots: green indicates correct imputations at 4-digit HLA type resolution; orange indicates correct imputations at 2-digit resolution; black indicates alleles below the call threshold; red indicates incorrect imputations.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002877.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002877.s004" position="float" xlink:type="simple">
        <label>Figure S4</label>
        <caption>
          <p><bold>Per-allele analysis for HLA*IMP:01/GS&amp;HLARES_EU.</bold> Per-allele analysis of HLA*IMP:01 imputation accuracy for six classical loci in the GS&amp;HLARES_EU validation experiment (second experiment, medium heterogeneity reference) at a call threshold of T = 0.70. The x-axis represents the different HLA alleles in the validation panel. The downward blue bars indicate how often each allele appears in the reference panel (the GS dataset). Imputation success is indicated by the upward stack plots: green indicates correct imputations at 4-digit HLA type resolution; orange indicates correct imputations at 2-digit resolution; black indicates alleles below the call threshold; red indicates incorrect imputations.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002877.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002877.s005" position="float" xlink:type="simple">
        <label>Figure S5</label>
        <caption>
          <p><bold>Barcode plot for HLA-A*02:01 in in GS and GS&amp;HLARES_EU.</bold> This plot shows the inferred haplotype structure (“barcode plot”) for HLA-A*02:01 in the first (based on GS, part A) and second experiment (based on GS&amp;HLARES_EU, part B). Each row represents one haplotype, and each SNP is depicted as a little square. The colouring of the boxes indicates whether the haplotype carries the major SNP allele (bright box) or a minor allele (dark box). The black/white rows represent the haplotypes carrying the 02:01 allele in the reference panel. Red and green rows represent haplotypes carrying 02:01 in the validation panel, with green indicating successful imputation and red indicating misimputation. We only show SNPs selected by HLA*IMP:01 in the process of SNP selection, and the inferred haplotypes are taken from the phased reference panel for HLA*IMP:01. The inferred haplotype structure in the second experiment in more complex than in the first experiment. Comparing correctly and incorrectly imputed haplotypes in the second experiment, it is clear that there are features (highlighted) which appear virtually exclusively in incorrectly imputed haplotypes (although they are present in the reference panel). Note that A*02:01 is imputed virtually perfectly by HLA*IMP:02 in this experiment, consistent with our hypothesis that HLA*IMP:02 is more tolerant of heterogeneous haplotype structures.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002877.s006" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1002877.s006" position="float" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <p><bold>HapMap-based BC58 validation accuracy.</bold> Accuracies (PPV) for the HapMap-based BC58 validation, as described in Leslie et al. <xref ref-type="bibr" rid="pcbi.1002877-Leslie1">[2]</xref> and Dilthey et al. <xref ref-type="bibr" rid="pcbi.1002877-Dilthey1">[1]</xref>. No call threshold is employed. The column “HLA*IMP:02” refers to the full model with error parameters ! =  0 and localization (other parameters set to accommodate the much reduced sample size). In column I, the error probabilities for sampling from the graph (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e037" xlink:type="simple"/></inline-formula>) and for building the graph <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e038" xlink:type="simple"/></inline-formula> are set to 0 (all other parameters equal to the column “HLA*IMP:02”). In column II, the error probability for building the graph is set to 0, and in column III, the error probability for sampling from the graph is set to 0. In column IV, localization is deactivated.</p>
          <p>(DOCX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002877.s007" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1002877.s007" position="float" xlink:type="simple">
        <label>Table S2</label>
        <caption>
          <p><bold>Countries and ethnicities in HLARES.</bold> Country and ethnicity of samples in the HLARES_EU and HLARES_ALL datasets.</p>
          <p>(DOCX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002877.s008" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1002877.s008" position="float" xlink:type="simple">
        <label>Table S3</label>
        <caption>
          <p><bold>HLA-DPB1 and DRB3-5.</bold> HLARES_EU cross validation for additional loci and structural variation (second experiment, medium heterogeneity): 2/3 of the HLARES_EU dataset are used as reference to impute the remaining 1/3. No call threshold is employed. Accuracy (PPV) for HLA-DPB1 measured at 4-digit resolution, at 2-digit resolution (including one pseudo-allele for absence) for DRB orthologs.</p>
          <p>(DOCX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002877.s009" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1002877.s009" position="float" xlink:type="simple">
        <label>Table S4</label>
        <caption>
          <p><bold>HLA-DPB1 and DRB3-5.</bold> Allele-specific sensitivity, specificity, PPV and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e039" xlink:type="simple"/></inline-formula> for the first experiment (HLA*IMP:02, GS <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e040" xlink:type="simple"/></inline-formula> HLARES_EU). “NValidation” specifies how often an allele appears in the validation data (according to classical typing results, which we treat as the truth in this experiment). “NImputation” specifies how often an allele appears in the imputations for the validation data. The following columns specify sensitivity, specificity, PPV and r2 for each allele. All numbers are based on “best-guess” called alleles.</p>
          <p>(DOCX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002877.s010" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1002877.s010" position="float" xlink:type="simple">
        <label>Table S5</label>
        <caption>
          <p><bold>HLA-DPB1 and DRB3-5.</bold> Allele-specific sensitivity, specificity, PPV and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e041" xlink:type="simple"/></inline-formula> for the second experiment (HLA*IMP:02, GS&amp;HLARES_EU 2/3 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002877.e042" xlink:type="simple"/></inline-formula> GS&amp;HLARES_EU 1/3). “NValidation” specifies how often an allele appears in the validation data (according to classical typing results, which we treat as the truth in this experiment). “NImputation” specifies how often an allele appears in the imputations for the validation data. The following columns specify sensitivity, specificity, PPV and r2 for each allele. All numbers are based on “best-guess” called alleles.</p>
          <p>(DOCX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002877.s011" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1002877.s011" position="float" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p><bold>The HLA*IMP:02 model and algorithms.</bold> Mathematical and algorithmic characterization of the haplotype graph model of HLA*IMP:02, allowing for integrating over path uncertainty and localization.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We acknowledge the Oxford Supercomputing Centre (OSC). We also acknowledge use of genotype data from the British 1958 Birth Cohort DNA collection, funded by the Medical Research Council grant G0000934 and the Wellcome Trust grant 068545/Z/02. We also thank three anonymous reviewers for their comments.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002877-Dilthey1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dilthey</surname><given-names>AT</given-names></name>, <name name-style="western"><surname>Moutsianas</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Leslie</surname><given-names>S</given-names></name>, <name name-style="western"><surname>McVean</surname><given-names>G</given-names></name> (<year>2011</year>) <article-title>HLA*IMP – an integrated framework for imputing classical HLA alleles from SNP genotypes</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>968</fpage>–<lpage>72</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Leslie1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leslie</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Donnelly</surname><given-names>P</given-names></name>, <name name-style="western"><surname>McVean</surname><given-names>G</given-names></name> (<year>2008</year>) <article-title>A statistical method for predicting classical HLA alleles from SNP data</article-title>. <source>Am J Hum Genet</source> <volume>82</volume>: <fpage>48</fpage>–<lpage>56</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Sawcer1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sawcer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Hellenthal</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Pirinen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Spencer</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Patsopoulos</surname><given-names>NA</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Genetic risk and a primary role for cell-mediated immune mechanisms in multiple sclerosis</article-title>. <source>Nature</source> <volume>476</volume>: <fpage>214</fpage>–<lpage>9</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Strange1">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Strange</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Capon</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Spencer</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Weale</surname><given-names>ME</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>A genomewide association study identifies new psoriasis susceptibility loci and an interaction between HLA-C and ERAP1</article-title>. <source>Nat Genet</source> <volume>43</volume>: <fpage>761</fpage>–<lpage>7</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Hosking1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hosking</surname><given-names>FJ</given-names></name>, <name name-style="western"><surname>Leslie</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Dilthey</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Moutsianas</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>MHC variation and risk of childhood B-cell precursor acute lymphoblastic leukemia</article-title>. <source>Blood</source> <volume>117</volume>: <fpage>1633</fpage>–<lpage>40</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Raychaudhuri1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raychaudhuri</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sandor</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Stahl</surname><given-names>EA</given-names></name>, <name name-style="western"><surname>Freudenberg</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>HS</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Five amino acids in three HLA proteins explain most of the association between MHC and seropositive rheumatoid arthritis</article-title>. <source>Nat Genet</source> <volume>44</volume>: <fpage>291</fpage>–<lpage>6</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-deBakker1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>de Bakker</surname><given-names>PI</given-names></name>, <name name-style="western"><surname>McVean</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Sabeti</surname><given-names>PC</given-names></name>, <name name-style="western"><surname>Miretti</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Green</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>A highresolution HLA and SNP haplotype map for disease association studies in the extended human MHC</article-title>. <source>Nat Genet</source> <volume>38</volume>: <fpage>1166</fpage>–<lpage>72</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Li1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M</given-names></name> (<year>2003</year>) <article-title>Modeling linkage disequilibrium and identifying recombination hotspots using single-nucleotide polymorphism data</article-title>. <source>Genetics</source> <volume>165</volume>: <fpage>2213</fpage>–<lpage>33</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-International1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><collab xlink:type="simple">International H I V Controllers Study</collab> (<year>2010</year>) <name name-style="western"><surname>Pereyra</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Jia</surname><given-names>X</given-names></name>, <name name-style="western"><surname>McLaren</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Telenti</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>The major genetic determinants of HIV-1 control affect HLA class I peptide presentation</article-title>. <source>Science</source> <volume>330</volume>: <fpage>1551</fpage>–<lpage>7</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Huang1">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Singleton</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>Hardy</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Abecasis</surname><given-names>G</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Genotypeimputation accuracy across worldwide human populations</article-title>. <source>Am J Hum Genet</source> <volume>84</volume>: <fpage>235</fpage>–<lpage>50</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Jostins1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jostins</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Morley</surname><given-names>KI</given-names></name>, <name name-style="western"><surname>Barrett</surname><given-names>JC</given-names></name> (<year>2011</year>) <article-title>Imputation of low-frequency variants using the HapMap3 benefits from large, diverse reference sets</article-title>. <source>Eur J Hum Genet</source> <volume>19</volume>: <fpage>662</fpage>–<lpage>6</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Howie1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Howie</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Marchini</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>Genotype imputation with thousands of genomes</article-title>. <source>G3 (Bethesda)</source> <volume>1</volume>: <fpage>457</fpage>–<lpage>70</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Browning1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Browning</surname><given-names>SR</given-names></name> (<year>2006</year>) <article-title>Multilocus association mapping using variable-length Markov chains</article-title>. <source>Am J Hum Genet</source> <volume>78</volume>: <fpage>903</fpage>–<lpage>13</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Browning2">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Browning</surname><given-names>SR</given-names></name>, <name name-style="western"><surname>Browning</surname><given-names>BL</given-names></name> (<year>2007</year>) <article-title>Rapid and accurate haplotype phasing and missing-data inference for whole-genome association studies by use of localized haplotype clustering</article-title>. <source>Am J Hum Genet</source> <volume>81</volume>: <fpage>1084</fpage>–<lpage>97</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Ron1">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ron</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Singer</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Tishby</surname><given-names>N</given-names></name> (<year>1998</year>) <article-title>On the learnability and usage of acyclic probabilistic finite automata</article-title>. <source>Journal of Computer and System Sciences</source> <volume>56</volume>: <fpage>133</fpage>–<lpage>152</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Browning3">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Browning</surname><given-names>BL</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>Z</given-names></name> (<year>2009</year>) <article-title>Simultaneous genotype calling and haplotype phasing improves genotype accuracy and reduces false-positive associations for genome-wide association studies</article-title>. <source>Am J Hum Genet</source> <volume>85</volume>: <fpage>847</fpage>–<lpage>61</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Purcell1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Purcell</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Neale</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Todd-Brown</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Thomas</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ferreira</surname><given-names>MA</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>. <source>Am J Hum Genet</source> <volume>81</volume>: <fpage>559</fpage>–<lpage>75</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Marchini1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marchini</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Howie</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Myers</surname><given-names>S</given-names></name>, <name name-style="western"><surname>McVean</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Donnelly</surname><given-names>P</given-names></name> (<year>2007</year>) <article-title>A new multipoint method for genome-wide association studies by imputation of genotypes</article-title>. <source>Nat Genet</source> <volume>39</volume>: <fpage>906</fpage>–<lpage>13</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Evans1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Evans</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Spencer</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Pointon</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Su</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Harvey</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Interaction between ERAP1 and HLA-B27 in ankylosing spondylitis implicates peptide handling in the mechanism for HLA-B27 in disease susceptibility</article-title>. <source>Nat Genet</source> <volume>43</volume>: <fpage>761</fpage>–<lpage>767</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-International2">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><collab xlink:type="simple">International HapMap Consortium</collab> (<year>2007</year>) <name name-style="western"><surname>Frazer</surname><given-names>KA</given-names></name>, <name name-style="western"><surname>Ballinger</surname><given-names>DG</given-names></name>, <name name-style="western"><surname>Cox</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Hinds</surname><given-names>DA</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>A second generation human haplotype map of over 3.1 million SNPs</article-title>. <source>Nature</source> <volume>449</volume>: <fpage>851</fpage>–<lpage>61</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Price1">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Price</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Patterson</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Plenge</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Weinblatt</surname><given-names>ME</given-names></name>, <name name-style="western"><surname>Shadick</surname><given-names>NA</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>. <source>Nat Genet</source> <volume>38</volume>: <fpage>904</fpage>–<lpage>9</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Horton1">
        <label>22</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Horton</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Gibson</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Coggill</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Miretti</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Allcock</surname><given-names>RJ</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Variation analysis and gene annotation of eight MHC haplotypes: the MHC Haplotype Project</article-title>. <source>Immunogenetics</source> <volume>60</volume>: <fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Howie2">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Howie</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Fuchsberger</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Marchini</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Abecasis</surname><given-names>GR</given-names></name> (<year>2012</year>) <article-title>Fast and accurate genotype imputation in genome-wide association studies through prephasing</article-title>. <source>Nat Genet</source> <volume>44</volume>: <fpage>955</fpage>–<lpage>9</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Novembre1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Novembre</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Bryc</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Kutalik</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Boyko</surname><given-names>AR</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Genes mirror geography within Europe</article-title>. <source>Nature</source> <volume>456</volume>: <fpage>98</fpage>–<lpage>101</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-McVean1">
        <label>25</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McVean</surname><given-names>G</given-names></name> (<year>2009</year>) <article-title>A genealogical interpretation of principal components analysis</article-title>. <source>PLoS Genet</source> <volume>5</volume>: <fpage>e1000686</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Marchini2">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marchini</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Howie</surname><given-names>B</given-names></name> (<year>2010</year>) <article-title>Genotype imputation for genome-wide association studies</article-title>. <source>Nat Rev Genet</source> <volume>11</volume>: <fpage>499</fpage>–<lpage>511</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002877-Li2">
        <label>27</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Willer</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Sanna</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Abecasis</surname><given-names>G</given-names></name> (<year>2009</year>) <article-title>Genotype imputation</article-title>. <source>Annu Rev Genomics Hum Genet</source> <volume>10</volume>: <fpage>387</fpage>–<lpage>406</lpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>