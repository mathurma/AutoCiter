<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006221</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01826</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Geometry</subject><subj-group><subject>Ellipses</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject><subj-group><subject>Dendritic structure</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject><subj-group><subject>Dendritic structure</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neuronal morphology</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Microscopy</subject><subj-group><subject>Light microscopy</subject><subj-group><subject>Fluorescence microscopy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Ganglion cells</subject><subj-group><subject>Pyramidal cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject><subj-group><subject>Ganglion cells</subject><subj-group><subject>Pyramidal cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>3D morphology-based clustering and simulation of human pyramidal cell dendritic spines</article-title>
<alt-title alt-title-type="running-head">3D morphology-based clustering and simulation of dendritic spines</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8537-1879</contrib-id>
<name name-style="western">
<surname>Luengo-Sanchez</surname>
<given-names>Sergio</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Fernaud-Espinosa</surname>
<given-names>Isabel</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Bielza</surname>
<given-names>Concha</given-names>
</name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Benavides-Piccione</surname>
<given-names>Ruth</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Larrañaga</surname>
<given-names>Pedro</given-names>
</name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>DeFelipe</surname>
<given-names>Javier</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Computational Intelligence Group, Departamento de Inteligencia Artificial, Escuela Técnica Superior de Ingenieros Informáticos, Universidad Politécnica de Madrid, Campus Montegancedo, Madrid, Spain</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Laboratorio Cajal de Circuitos Corticales, Centro de Tecnología Biomédica, Universidad Politécnica de Madrid, Campus Montegancedo, Madrid, Spain</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Centro de Investigación Biomédica en Red Sobre Enfermedades Neurodegenerativas, Instituto de Salud Carlos III, Madrid, Spain</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Departamento de Neurobiología Funcional y de Sistemas, Instituto Cajal (CSIC), Madrid, Spain</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Cuntz</surname>
<given-names>Hermann</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Goethe University, GERMANY</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">sluengo@fi.upm.es</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>13</day>
<month>6</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<month>6</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>6</issue>
<elocation-id>e1006221</elocation-id>
<history>
<date date-type="received">
<day>2</day>
<month>11</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>5</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Luengo-Sanchez et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006221"/>
<abstract>
<p>The dendritic spines of pyramidal neurons are the targets of most excitatory synapses in the cerebral cortex. They have a wide variety of morphologies, and their morphology appears to be critical from the functional point of view. To further characterize dendritic spine geometry, we used in this paper over 7,000 individually 3D reconstructed dendritic spines from human cortical pyramidal neurons to group dendritic spines using model-based clustering. This approach uncovered six separate groups of human dendritic spines. To better understand the differences between these groups, the discriminative characteristics of each group were identified as a set of rules. Model-based clustering was also useful for simulating accurate 3D virtual representations of spines that matched the morphological definitions of each cluster. This mathematical approach could provide a useful tool for theoretical predictions on the functional features of human pyramidal neurons based on the morphology of dendritic spines.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Dendritic spines of pyramidal neurons are the targets of most excitatory synapses in the cerebral cortex and their morphology appears to be critical from the functional point of view. Thus, characterizing this morphology is necessary to link structural and functional spine data and thus interpret and make them more meaningful. We have used a large database of more than 7,000 individually 3D reconstructed dendritic spines from human cortical pyramidal neurons that is first transformed into a set of 54 quantitative features characterizing spine geometry mathematically. The resulting data set is grouped into spine clusters based on a probabilistic model with Gaussian finite mixtures. We uncover six groups of spines whose discriminative characteristics are identified with machine learning methods as a set of rules. The clustering model allows us to simulate accurate spines from human pyramidal neurons to suggest new hypotheses of the functional organization of these cells.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Spanish Ministry of Economy and Competitiveness</institution>
</funding-source>
<award-id>Cajal Blue Brain (C080020-09; the Spanish partner of the Blue Brain initiative from EPFL)</award-id>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Spanish Ministry of Economy and Competitiveness</institution>
</funding-source>
<award-id>TIN2016-79684-P</award-id>
</award-group>
<award-group id="award003">
<funding-source>
<institution>Regional Government of Madrid</institution>
</funding-source>
<award-id>S2013/ICE-2845-CASI-CAM-CM</award-id>
</award-group>
<award-group id="award004">
<funding-source>
<institution>European Union Horizon 2020</institution>
</funding-source>
<award-id>No. 720270 (HBP SGA1)</award-id>
</award-group>
<funding-statement>This work has been partially supported by the Spanish Ministry of Economy, Industry and Competitiveness through the Cajal Blue Brain (C080020-09; the Spanish partner of the Blue Brain initiative from EPFL) and TIN2016-79684-P projects, and by the Regional Government of Madrid through the S2013/ICE-2845-CASI-CAM-CM project. This project has received funding from the European Union`s Horizon 2020 Research and Innovation Programme under Grant Agreement No. 720270 (HBP SGA1). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="2"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-07-24</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The software to characterize the morphology of three-dimensional spines is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ComputationalIntelligenceGroup/3DSpineMFE" xlink:type="simple">https://github.com/ComputationalIntelligenceGroup/3DSpineMFE</ext-link>. The software and the dataset to simulate dendritic spines is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sergioluengosanchez/spineSimulation" xlink:type="simple">https://github.com/sergioluengosanchez/spineSimulation</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>It is known that the dendritic spines (for simplicity’s sake, spines) of pyramidal neurons are the targets of most excitatory synapses in the cerebral cortex [<xref ref-type="bibr" rid="pcbi.1006221.ref001">1</xref>]. Numerous studies suggest that spine shape could determine their synaptic strength and learning rules and is also related to the storage and integration of excitatory synaptic inputs in pyramidal neurons [<xref ref-type="bibr" rid="pcbi.1006221.ref002">2</xref>]. Quantitative analyses have demonstrated strong correlations between spine morphological variables and synaptic structure. Specifically, the spine head volume in the neocortex is correlated with the area of the postsynaptic density (PSD) [<xref ref-type="bibr" rid="pcbi.1006221.ref003">3</xref>]. Both parameters are highly variable across spines. Interestingly, however, the spine head volume (like the total spine volume) is positively correlated with the PSD area, and there is a remarkably small variance. Moreover, PSD area is correlated with the number of presynaptic vesicles, the number of postsynaptic receptors and the readily-releasable pool of transmitters. By contrast, the length and diameter of the spine neck is proportional to the extent to which the spine is biochemically and electrically isolated from its parent dendrite [<xref ref-type="bibr" rid="pcbi.1006221.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1006221.ref008">8</xref>]. Also, it has been shown that larger spines can generate larger synaptic currents than smaller spines [<xref ref-type="bibr" rid="pcbi.1006221.ref009">9</xref>]. Furthermore, dendritic spines are dynamic structures with volume fluctuations that appear to have important implications for cognition and memory [<xref ref-type="bibr" rid="pcbi.1006221.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1006221.ref013">13</xref>]. Therefore, spine morphology appears to be critical from the functional point of view (for a review, see [<xref ref-type="bibr" rid="pcbi.1006221.ref014">14</xref>]).</p>
<p>There are a wide variety of spine morphologies, especially in the human cortex [<xref ref-type="bibr" rid="pcbi.1006221.ref015">15</xref>]. While many different classifications of spines have been proposed on the basis of their morphological characteristics, the most widely used was proposed by Peters and Kaiserman-Abramof [<xref ref-type="bibr" rid="pcbi.1006221.ref016">16</xref>] which groups spines into three basic categories—thin, mushroom and stubby spines—and an additional category—filopodia. However, it has also been argued that the large diversity of spine sizes reflects a continuum of morphologies rather than the existence of discrete groups [<xref ref-type="bibr" rid="pcbi.1006221.ref003">3</xref>]. Automatic clustering techniques over 2D spine representations have recently been used [<xref ref-type="bibr" rid="pcbi.1006221.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1006221.ref018">18</xref>] to address this argument with the aim of avoiding the subjectivity and bias involved in manual analysis. Both studies consider that some spines cannot be clearly assigned to one of Peters and Kaiserman-Abramof’s classes because these spines are transitions between shapes.</p>
<p>However, the geometry of spines can be more accurately determined by means of 3D reconstructions, since many morphological features are not taken into account in 2D.</p>
<p>Ideally, 3D reconstruction using electron microscopy serial sections is the gold standard to obtain accurate estimations of the geometry of spines. However, a relatively low number of spines (at best in the order of a few hundred) can be reconstructed in 3D using electron microscopy in a reasonable time period, and these reconstructions can only be carried out in small segments of the dendritic arbor of the neurons. Furthermore, the quality of electron microscopy when using human brain tissue is usually suboptimal due to technical constraints. On the contrary, fluorescent labeling of neurons and the use of high power reconstruction with confocal microscopy (or other techniques) allow the visualization of thousands of spines with high quality along the dendritic arbor (apical and basal dendrites). Thus, in this study, we used a large, quantitative database of completely 3D-reconstructed spines (7,916) of human cortical pyramidal neurons—using intracellular injections of Lucifer Yellow in fixed tissue—to further characterize spine geometry [<xref ref-type="bibr" rid="pcbi.1006221.ref015">15</xref>].</p>
<p>Here we proposed a new set of 54 features. They were selected so as to unambiguously approximate the 3D shape of spines, enabling 3D simulation of spines. A probabilistic clustering grouped the 3D reconstructed human spines according to the selected set of morphology-based features. The best number of groups for probabilistic clustering based on the Bayesian information criterion was six groups of human spines. The interpretation of the clusters in terms of their most discriminative characteristics relied on the rules generated automatically by a rule induction algorithm. Since previous studies have shown that there are selective changes in dendritic and spine parameters with aging and dendritic compartments [<xref ref-type="bibr" rid="pcbi.1006221.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1006221.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1006221.ref021">21</xref>], we also explored the distributions of the groups according to dendritic compartment, age and distance from soma to further characterize possible variations according to these parameters. Finally, we present a stochastic method designed to simulate biologically feasible spines according to the probabilities defined by the clustering model. We introduce a procedure to shape simulated spines generating their 3D representations. To the best of our knowledge, this is the first attempt to fully characterize, model and simulate 3D spines.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Clustering of spines into six different groups according to a selected set of geometrical features</title>
<p>We used a set of 7,916 3D reconstructed individual spines along the apical and basal dendrites of layer III pyramidal neurons in the cingulate cortex of two individuals (aged 40 [C40] and 85 [C85] years) (<xref ref-type="fig" rid="pcbi.1006221.g001">Fig 1</xref>). For each individual spine, a particular threshold was selected to constitute a solid surface that exactly matched the contour of each spine. In many cases, it was necessary to use several surfaces of different intensity thresholds to capture the complete morphology of a spine [<xref ref-type="bibr" rid="pcbi.1006221.ref015">15</xref>]. In such cases, spines were usually fragmented or detached from their parent dendrite (<xref ref-type="fig" rid="pcbi.1006221.g002">Fig 2A and 2B</xref>) due to the diffraction limitation of confocal microscopy. Therefore, they had to be repaired by means of a novel semi-supervised mesh processing algorithm (see <xref ref-type="sec" rid="sec008">Materials and Methods</xref>) which generated a new dataset of corrected spines. Those spines that were extremely fragmented, far removed from the dendrite or significantly deferred from their original shape were discarded. As a result, the original set of 7,916 spines yielded 7,297 (92.18%) spines. The number and percentage of spines after repair by their dendritic compartment and age can be found as <xref ref-type="supplementary-material" rid="pcbi.1006221.s001">S1 Table</xref>. For the repair process, the insertion point of each spine was manually marked, approximately at the center of the created spine surface side that was in contact with the dendritic shaft. In those cases where the created spine surface did not reach the dendritic shaft, the insertion point was placed directly on the dendritic shaft where the spine emerged from the shaft, while rotating the image in 3D (<xref ref-type="fig" rid="pcbi.1006221.g001">Fig 1G</xref>). The insertion point was useful for repairing the detached spines and computing a multiresolutional Reeb graph for feature extraction.</p>
<fig id="pcbi.1006221.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006221.g001</object-id>
<label>Fig 1</label>
<caption>
<title>3D reconstructions of human dendritic spines.</title>
<p><bold>(A)</bold> Confocal microscopy z-projection image showing a horizontally projecting basal dendrite of an intracellular injected layer III pyramidal neuron of the C40 human cingulate cortex. <bold>(B)</bold> Three-dimensional reconstruction of the complete morphology of each spine shown in (A). <bold>(C)</bold> Estimation of the spine volume values shown in (B) by color codes (blue-white: 0.0–0.8 μm<sup>3</sup>). <bold>(D-I)</bold> Higher magnification images of a dendritic segment shown in A-C to illustrate the three-dimensional triangular mesh (I) obtained for each individual spine. Scale bar in panel I corresponds to: 4.5 μm in panels A-C; 2.5 μm in panels D-F and 1 μm in panels G-I.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.g001" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006221.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006221.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Spine repair process and multiresolutional Reeb graph computation.</title>
<p>Spines are colored with a gradient whereby the closest points to the insertion point were colored green and the furthest points were colored purple. <bold>(A)</bold> Example of a fragmented spine. The fragmentation problem is solved by applying the closing morphological operator, and the spine is completely connected. <bold>(B)</bold> Example of the reconstruction of a spine detached from its dendritic shaft. The spine was oriented so as to align the insertion point and its closest vertex with the z-axis. The gap between the spine and the dendritic shaft is filled by means of an iterative process starting from the base of the spine. This resulted in the growth of the missing neck. <bold>(C)</bold> Geodesic distance computation from the insertion point. The black line denotes the shortest path from the insertion point to an arbitrary point on the surface of the spine. <bold>(D)</bold> The domain of the geodesic distance on the surface of the spine was divided into seven regions. <bold>(E)</bold> Regions and segments between curves provide enough information to reconstruct an approximation of the surface. Features extracted from these regions and segments must conform a complete set of spine topology to provide for a proper computer simulation. <bold>(F)</bold> Curves were approximated by the best fitting plane resulting in ellipses that improve the characterization and interpretation of the geometry of the spine. Features were computed on this final 3D representation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.g002" xlink:type="simple"/>
</fig>
<p>The characterization of spines was addressed by dividing the surface of the spine into regions according to a multiresolutional Reeb graph (<xref ref-type="fig" rid="pcbi.1006221.g002">Fig 2C–2F</xref> and <xref ref-type="sec" rid="sec008">Materials and Methods</xref>). Thus, regions provided local information on the spine topology while the combination of all regions gave global details of the morphology. Major morphological aspects like length, width, size or curvature were measured for each region to build a set of 36 spine features (see <xref ref-type="sec" rid="sec008">Materials and methods</xref>). This set was complemented with 18 features, like growth direction for example. These features were included to achieve an unambiguous representation of the spine morphology. The complete set of 54 features unambiguously describes the position and orientation of all the ellipses that characterize the geometry of a spine. The software to compute the features can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/ComputationalIntelligenceGroup/3DSpineMFE" xlink:type="simple">https://github.com/ComputationalIntelligenceGroup/3DSpineMFE</ext-link>.</p>
<p>To find groups of spines, we applied a model-based clustering approach which assigned spines to six clusters according to the Bayesian information criterion (BIC) (<xref ref-type="fig" rid="pcbi.1006221.g003">Fig 3A</xref> and <xref ref-type="sec" rid="sec008">Materials and Methods</xref>). Our approach, based on probabilistic clustering, assigned a probability distribution (<italic>p</italic><sub>1</sub>,…,<italic>p</italic><sub>6</sub>) of belonging to each of the six clusters to each spine, where <italic>p</italic><sub><italic>i</italic></sub> is the probability of belonging to cluster (<italic>p</italic><sub><italic>i</italic></sub> ∈ [0,1],∑<sub><italic>i</italic></sub><italic>p</italic><sub><italic>i</italic></sub> = 1). Furthermore, we counted the number of spines whose maximum probability, <italic>p</italic>* = max{<italic>p</italic><sub>1</sub>,…,<italic>p</italic><sub>6</sub>}, was lower than a given threshold (<xref ref-type="table" rid="pcbi.1006221.t001">Table 1</xref>). We found that the membership probability of most of the spines was greater than 0.99 and clearly belonged to a cluster, whereas a very small number were more scattered and, consequently, their membership was not so clear. Therefore, we can conclude that with this set of features most of spines had very high membership probabilities.</p>
<fig id="pcbi.1006221.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006221.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Model-based clustering representation and interpretation.</title>
<p><bold>(A)</bold> Graph showing the resulting BIC values depending on the number of clusters. Results are shown in a range from two to ten clusters. The model that achieved the highest BIC value had six clusters. <bold>(B)</bold> Representative examples of dendritic spines with a <italic>p</italic>* = 1 (highest membership probability) from the six different clusters. <bold>(C)</bold> 2D projection of the 6D probability distributions representing the membership probability of each spine to each cluster according to classical multidimensional scaling. Spines were colored combining cluster colors according to their probabilities of membership to each cluster. <bold>(D)</bold> The absolute value of the logarithm of the total variance for each cluster, i.e., |log<sub>10</sub>det(<bold>Σ</bold><sub><italic>i</italic></sub>)|, where <bold>Σ</bold><sub><italic>i</italic></sub> is the variance-covariance matrix of cluster <italic>i</italic>. It is a value that summarizes the heterogeneity of morphologies within a cluster.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.g003" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1006221.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006221.t001</object-id>
<label>Table 1</label> <caption><title>Number of spines whose maximum probability <italic>p</italic>* of belonging to a cluster is greater than a threshold.</title></caption>
<alternatives>
<graphic id="pcbi.1006221.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Prob./Cl.</th>
<th align="center">Cluster 1 (1,025)</th>
<th align="center">Cluster 2 (1,588)</th>
<th align="center">Cluster 3 (1,273)</th>
<th align="center">Cluster 4 (1,454)</th>
<th align="center">Cluster 5 (1,264)</th>
<th align="center">Cluster 6 (693)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0.99</td>
<td align="center">953</td>
<td align="center">1464</td>
<td align="center">1110</td>
<td align="center">1289</td>
<td align="center">1155</td>
<td align="center">648</td>
</tr>
<tr>
<td align="center">0.9</td>
<td align="center">995</td>
<td align="center">1558</td>
<td align="center">1229</td>
<td align="center">1404</td>
<td align="center">1226</td>
<td align="center">679</td>
</tr>
<tr>
<td align="center">0.8</td>
<td align="center">1008</td>
<td align="center">1575</td>
<td align="center">1248</td>
<td align="center">1425</td>
<td align="center">1244</td>
<td align="center">682</td>
</tr>
<tr>
<td align="center">0.7</td>
<td align="center">1013</td>
<td align="center">1581</td>
<td align="center">1257</td>
<td align="center">1441</td>
<td align="center">1254</td>
<td align="center">687</td>
</tr>
<tr>
<td align="center">0.6</td>
<td align="center">1016</td>
<td align="center">1585</td>
<td align="center">1268</td>
<td align="center">1448</td>
<td align="center">1260</td>
<td align="center">690</td>
</tr>
<tr>
<td align="center">0.5</td>
<td align="center">1025</td>
<td align="center">1588</td>
<td align="center">1273</td>
<td align="center">1454</td>
<td align="center">1264</td>
<td align="center">693</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>The total number of spines for each cluster is specified between parentheses. Column 1 establishes a threshold probability. Each cell denotes the number of spines that belong to its column cluster with a probability greater than is indicated by its row. For example, 953 spines out of the 1,025 grouped in Cluster 1 had a maximum probability <italic>p</italic>* greater than 0.99.</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec004">
<title>Cluster interpretation and visualization</title>
<p>To gain a deeper insight into the characterization of each group unveiled by the probabilistic clustering, we identified the most representative features for each cluster. The process was based on the generation of classification rules according to the RIPPER algorithm (see <xref ref-type="sec" rid="sec008">Materials and Methods</xref>). Each spine was attributed to its most probable cluster. Then, the RIPPER algorithm generated discriminative rules for each cluster, turning the problem into a binary supervised classification problem which pitched each cluster label against the rest. We forced the algorithm to generate a unique rule in order to improve our understanding of the differences between clusters. However, a single rule cannot be regarded as enough to characterize all the spines within a cluster because it is unable to capture all the relations between the variables defined by the model-based clustering. The result was that each cluster was characterized by only one, two or three observable features (<xref ref-type="fig" rid="pcbi.1006221.g004">Fig 4</xref>). The discriminative rules are available in <xref ref-type="supplementary-material" rid="pcbi.1006221.s004">S1 Text</xref>. An example of representative spines of the six clusters is shown in <xref ref-type="fig" rid="pcbi.1006221.g003">Fig 3B</xref>. The rules generated by RIPPER when it comes to classify the spines according to their cluster label, with their accuracy between parentheses, may be summarized as:</p>
<list list-type="bullet">
<list-item><p>Cluster 1: The height of the spines is extremely low in region 2. (92.94%).</p></list-item>
<list-item><p>Cluster 2: Spines with a low curvature across regions 4, 5 and 6 and a small volume in region 7 (80.90%).</p></list-item>
<list-item><p>Cluster 3: These spines have a medium-small volume, a low curvature across regions 2 and 3 and the area of their 6th ellipse area may not be more than double or less than half of the area of their 4th ellipse (75.89%).</p></list-item>
<list-item><p>Cluster 4: Their volume is high in region 4 and the 6th ellipse has a smaller area than the 4th (82.16%).</p></list-item>
<list-item><p>Cluster 5: Groups spines whose height in region 2 is high and whose 6th ellipse has an area that is almost equal to or greater than that of the 4th region (81.95%).</p></list-item>
<list-item><p>Cluster 6: Contains the spines with a large volume in region 7 (70.68%).</p></list-item>
</list>
<fig id="pcbi.1006221.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006221.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Graphical representations of the main features that characterize each cluster of spines.</title>
<p>Representative examples of the spines of each cluster have been rescaled to improve the visualization of their characteristics. The actual proportions between spines are shown in <xref ref-type="fig" rid="pcbi.1006221.g003">Fig 3B</xref>. The correspondences between spines and clusters are: (A) Cluster 1, (B) Cluster 2, (C) Cluster 3, (D) Cluster 4, (E) Cluster 5 and (F) Cluster 6.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.g004" xlink:type="simple"/>
</fig>
<p>The diversity of morphologies within a cluster was estimated by computing the total variance for each cluster. <xref ref-type="fig" rid="pcbi.1006221.g003">Fig 3D</xref> shows that Cluster 2 has the lowest total variance, denoting similarity among its spines, whereas variance in Cluster 6 has the highest total variance, suggesting more heterogeneity.</p>
<p>To improve cluster visualization and interpretation, the distances between the membership probabilities (<italic>p</italic><sub>1</sub>,…,<italic>p</italic><sub>6</sub>) of the spines in a 6D space were projected to 2D according to multidimensional scaling (see <xref ref-type="fig" rid="pcbi.1006221.g003">Fig 3C</xref> and <xref ref-type="sec" rid="sec008">Materials and Methods</xref>). Spines were colored in line with their probability of belonging to each cluster. Accordingly, “intermediate” spines whose membership probabilities were distributed evenly across several clusters have a mixture of colors. In this representation, we find that most of the points are clearly assigned to a cluster, as suggested by the results reported in <xref ref-type="table" rid="pcbi.1006221.t001">Table 1</xref>. Clusters 1 and 6 are outstanding examples of a clearly defined cluster, since they are quite isolated and, consequently, easy to discriminate from the other clusters. However, clusters like 3 and 4 are quite closely related. This tallies with the results reported in <xref ref-type="table" rid="pcbi.1006221.t001">Table 1</xref>, where the clusters identified as being clearly separate had a higher threshold than highly related clusters that needed a lower threshold for all their spines to be crisply assigned. To quantify the distance of the points observed by multidimensional scaling, we measured the overlap between clusters (see <xref ref-type="sec" rid="sec008">Materials and Methods</xref>). Note that clearly defined clusters should not overlap. The results reported in <xref ref-type="supplementary-material" rid="pcbi.1006221.s002">S2 Table</xref> support the interpretation of multidimensional scaling. By selecting <italic>p</italic>* of each spine, the spines can be crisply assigned to a unique cluster yielding the distribution shown in <xref ref-type="fig" rid="pcbi.1006221.g005">Fig 5A</xref>. This bar chart represents the percentage of spines that belong to each cluster.</p>
<fig id="pcbi.1006221.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006221.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Bar charts showing the distribution of spines by cluster according to maximum probability <italic>p</italic>*.</title>
<p><bold>(A)</bold> Distribution of spines into the six clusters. <bold>(B)</bold> Relative frequency distribution of clusters for apical (left) and basal (right) spines. <bold>(C)</bold> Relative frequency distribution of clusters for C40 (left) and C85 (right) spines. <bold>(D)</bold> Relative frequency distribution of clusters for the combination of dendritic compartment and age, apical C40 (left end), apical C85 (center left), basal C40 (center right) and basal C85 (right end). Horizontal lines in (B), (C) and (D) denote the heights shown in (A). <bold>(E)</bold> Bar chart showing the distribution of spines belonging to each of the six clusters according to distance from soma. Horizontal lines denote the percentage of spines in each cluster (A). Spines were grouped into intervals of 50 μm to improve visualization.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Distribution of clusters by dendritic compartment, age and distance from soma</title>
<p>To gain a deeper insight, we analyzed how it changes the cluster distribution of the whole population of spines (<xref ref-type="fig" rid="pcbi.1006221.g005">Fig 5A</xref>) when a dendritic compartment (apical/basal), an age (40/85) or a combination of both (<xref ref-type="fig" rid="pcbi.1006221.g005">Fig 5B–5D</xref>) is selected. The study of the cluster distribution of the spines according to their dendritic compartment unveiled that the proportion of spines in Clusters 3, 5 and 6 increase for apical dendrites and diminish for basal dendrites compared with those observed in <xref ref-type="fig" rid="pcbi.1006221.g005">Fig 5A</xref>, whereas the major increment for basal dendrites and decrement for apical dendrites is yielded in Cluster 1. In order to evaluate these differences, we used <italic>χ</italic><sup>2</sup> hypothesis testing, that is, we tested whether the cluster distribution is independent of the dendritic compartment (null hypothesis <italic>H</italic><sub>0</sub>). The hypothesis test returned a p-value lower than 3.80 × 10<sup>−34</sup> thereby the null hypothesis <italic>H</italic><sub>0</sub> was rejected.</p>
<p>The same process as applied for dendritic compartment was repeated for age. <xref ref-type="fig" rid="pcbi.1006221.g005">Fig 5C</xref> shows that Cluster 2 is overrepresented in C40 and Clusters 4 and 6 in C85. On the contrary, the major decreases occur in Cluster 2 in C85 and Clusters 4 and 6 in C40. To test if cluster distribution is independent of age, we tested the hypothesis again. Results rejected the null hypothesis (the p-value was lower than 3.73 × 10<sup>−06</sup>). Furthermore, we run the clustering algorithm for each subject (C40 and C85) to study their distribution independently. As a result, six clusters emerged from C40 spines mostly matching those obtained for the complete population of spines and an additional one of 36 spines that only grouped spines from Clusters 5 and 6. Clustering of C85 spines generated five clusters showing similar results to those achieved for the global population but combining spines from Cluster 2 with Cluster 4 in a unique cluster and tending to include some spines of original Cluster 6 into Cluster 5.</p>
<p>We then tested the cluster distribution and the combination of dendritic compartment and age for independence (<xref ref-type="fig" rid="pcbi.1006221.g005">Fig 5D</xref>). <xref ref-type="fig" rid="pcbi.1006221.g005">Fig 5D</xref> shows that there is an increase of Clusters 3 and 5 for C40 apical dendrites; Clusters 3, 5 and 6 for C85 apical dendrites; Clusters 1 and 2 for C40 basal dendrites and Clusters 1 and 4 for C85 basal dendrites with respect to the distribution observed for the whole population of spines. Additionally, from <xref ref-type="fig" rid="pcbi.1006221.g005">Fig 5D</xref> it can be observed that Clusters 1 and 4 are underrepresented in C40 apical dendrites; Clusters 1 and 2 in C85 apical dendrites; Clusters 5 and 6 in C40 basal dendrites and Clusters 2, 3 and 4 in C85 basal dendrites. The null hypothesis was rejected (p-value ≈ 4.11 × 10<sup>−36</sup>). Hence we can reject independence between cluster distribution and dendritic compartment combined with age.</p>
<p>In spite of the fact that the null hypothesis was rejected for all the above cases, <xref ref-type="fig" rid="pcbi.1006221.g005">Fig 5B–5D</xref> show that the discrepancies in the distributions are confined to only a few clusters and are not evenly spread. With the aim of pinpointing those clusters that exhibit significant differences, each one was analyzed individually. A Pearson’s <italic>χ</italic><sup>2</sup> test was performed cluster by cluster to check if the proportion of spines in each individual cluster was independent of the dendritic compartment, age and combination of both. The outcome of the tests is shown in <xref ref-type="table" rid="pcbi.1006221.t002">Table 2</xref>. Results confirm that only some clusters vary significantly depending on dendritic compartment, age or combination of both and indicate how strongly the hypothesis was rejected for each cluster. An example can be found for age where the null hypothesis was only rejected for Clusters 2, 4 and 6, showing that they are the only clusters whose distribution varies significantly with age.</p>
<table-wrap id="pcbi.1006221.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006221.t002</object-id>
<label>Table 2</label> <caption><title>Results for Pearson’s <italic>χ</italic><sup>2</sup> test checking if the distribution of each cluster is independent of its dendritic compartment, age and combination of both.</title></caption>
<alternatives>
<graphic id="pcbi.1006221.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="justify"/>
<th align="center">Cluster 1</th>
<th align="center">Cluster 2</th>
<th align="center">Cluster 3</th>
<th align="center">Cluster 4</th>
<th align="center">Cluster 5</th>
<th align="center">Cluster 6</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Dendritic compartment</td>
<td align="center"><bold>***</bold></td>
<td align="center"/>
<td align="center"><bold>**</bold></td>
<td align="center"/>
<td align="center"><bold>***</bold></td>
<td align="center"><bold>**</bold></td>
</tr>
<tr>
<td align="center">Age</td>
<td align="center"/>
<td align="center"><bold>*</bold></td>
<td align="center"/>
<td align="center"><bold>*</bold></td>
<td align="center"/>
<td align="center"><bold>**</bold></td>
</tr>
<tr>
<td align="center">Combination</td>
<td align="center"><bold>***</bold></td>
<td align="center"><bold>*</bold></td>
<td align="center"><bold>*</bold></td>
<td align="center"><bold>*</bold></td>
<td align="center"><bold>***</bold></td>
<td align="center"><bold>***</bold></td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001"><p>The * symbol denotes that the resulting p-value is lower than 0.05 and the null hypothesis is rejected, ** denotes p-value &lt; 0.001 and *** denotes p-value &lt; 0.0001.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Furthermore, we evaluated the cluster distribution according to the distance from soma (<xref ref-type="fig" rid="pcbi.1006221.g005">Fig 5E</xref>). The number of spines was categorized in 50 μm long sections, from 0 μm (the beginning of the dendrite) to 300 μm. A <italic>χ</italic><sup>2</sup> hypothesis test was applied in order to test the independence between cluster distribution and distance from soma. The outcome rejected the null hypothesis <italic>H</italic><sub>0</sub> (p-value ≈ 8.00 × 10<sup>−23</sup>). The number of spines assigned to each section is specified in <xref ref-type="supplementary-material" rid="pcbi.1006221.s003">S3 Table</xref>. Briefly, <xref ref-type="fig" rid="pcbi.1006221.g005">Fig 5E</xref> shows that there is a predominance of Clusters 1 and 2 at proximal distances (0–50 μm) whereas Clusters 1 and 4 show a higher percentage than expected at longer distances.</p>
</sec>
<sec id="sec006">
<title>Three-dimensional simulation of spines</title>
<p>Model-based clustering describes the probability distributions governing each cluster. Given a cluster, a spine is simulated sampling the values for the 54 features from its probability distribution (see <xref ref-type="sec" rid="sec008">Materials and Methods</xref>). This set of features unambiguously specifies the position and orientation of ellipses that define the skeleton of a simulated spine (<xref ref-type="fig" rid="pcbi.1006221.g006">Fig 6A</xref>). The simulated spine is represented in 3D by surfacing the skeleton (<xref ref-type="fig" rid="pcbi.1006221.g006">Fig 6B</xref>). However, simulated spines have an artificial appearance because the regions delimited by the ellipses are clearly distinguishable between them (<xref ref-type="fig" rid="pcbi.1006221.g006">Fig 6C</xref>). A more accurate morphology for the simulated spine is generated by smoothing the surface (<xref ref-type="fig" rid="pcbi.1006221.g006">Fig 6D</xref>). Examples of simulations of each cluster can be found in <xref ref-type="fig" rid="pcbi.1006221.g006">Fig 6E</xref>. R code, model and dataset to perform clustering and simulation of dendritic spines can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/sergioluengosanchez/spineSimulation" xlink:type="simple">https://github.com/sergioluengosanchez/spineSimulation</ext-link>.</p>
<fig id="pcbi.1006221.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006221.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Simulation of 3D dendritic spines.</title>
<p><bold>(A)</bold> Skeleton built from the set of features computed according to the multiresolution Reeb graph. <bold>(B)</bold> Generation of the surface between two ellipses through the triangulation of the region. <bold>(C)</bold> Three-dimensional representation of a spine. Once all the regions of the spine have been triangulated, the spine is a closed mesh used to visualize an artificial spine. <bold>(D)</bold> Improved spine representation. Loop’s subdivision algorithm yields a smoother and more accurate version of the artificial spine. <bold>(E)</bold> Examples of simulated spines for each cluster.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.g006" xlink:type="simple"/>
</fig>
<p>To be useful for future research, simulated spines must be geometrically equivalent to real spines. Thus, simulated and real must be indistinguishable. To test for equivalence, we state a supervised classification problem within each cluster, where the possible labels are “simulated” vs. “real”. Hence, if both groups were indistinguishable, a classifier would perform badly, having a classification accuracy of around 50%. As a result we found that both groups of spines are almost indistinguishable (accuracy being around 60%), with the exception of cluster 1 (80%), where the size of simulated spines is usually somewhat larger than real spines.</p>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>Discussion</title>
<p>This study illustrates the geometrical clustering results from over 7,000 complete manual 3D reconstructions of human cortical pyramidal neuron spines. Specifically, we uncovered six different classes of human spines according to a particular set of features. Additionally, we found that particular clusters were predominant in different dendritic compartments, ages and distances from soma. Furthermore, we created 3D virtual representations of spines that matched the morphological definitions of each cluster. To the best of our knowledge, this is the first time that such a large dataset of individual manually 3D reconstructed spines from identified human pyramidal neurons is used to automatically generate objective morphological clusters with a probabilistic model.</p>
<p>Technically, serial electron microscopy is the technique of choice to obtain highly accurate measurements of the dendritic spine structure. However, it is very time-consuming and difficult, which makes it challenging to obtain large numbers of measurements. Even using high throughput 3D reconstruction of identified dendritic spines by means of automatic electron microscope techniques such as FIB/SEM technology (combined use of focused ion beam milling [FIB] and scanning electron microscopy [SEM]), the number of reconstructed spines is relatively low. For example, FIB/SEM technology has permitted the full 3D reconstruction of up to 248 spines and their synaptic inputs in the adult-generated granule cells in mice [<xref ref-type="bibr" rid="pcbi.1006221.ref022">22</xref>], which represents a major achievement in the field. Light microscopic techniques, although limited by the lower level of resolution, remain the method of choice to obtain large-scale spatial information regarding the number and distribution of dendritic spines along the dendrites (in the order of several thousands of spines). Nevertheless, light microscopic studies normally estimate dendritic spine volumes from measurement of the spine head volumes, whereas spine necks are usually not included, due to the lack of software tools to reconstruct these structures accurately and because some of the spine necks have spatial dimensions of around 50–200 nm and, therefore, are not resolvable by confocal microscopy. Moreover, as discussed by Tønnesen and Nägerl [<xref ref-type="bibr" rid="pcbi.1006221.ref014">14</xref>], image projection artifacts and limited spatial resolution mask short spine necks, leading to the false identification of stubby spines. In addition, it is difficult to distinguish the border between the head and the neck in many cases. Thus, in the present study, we used 3D reconstructed dendritic spine morphology using commercially available module software (Imaris surface), which allowed us to create our own protocol to accurately represent the morphology of the spine within the limits of light microscopy (see [<xref ref-type="bibr" rid="pcbi.1006221.ref015">15</xref>]).</p>
<p>Model-based clustering methods used in this study yield six clusters based on their BIC value (see <xref ref-type="fig" rid="pcbi.1006221.g003">Fig 3A</xref>). This criterion resulted in high cluster membership probabilities for this set of features. These included measurements of major morphological aspects like length, width or size of the spine but also other aspects such as curvature. Thus, these and previous results [<xref ref-type="bibr" rid="pcbi.1006221.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1006221.ref015">15</xref>], where only their volume and length were measured, are not comparable.</p>
<p>Interestingly, we observed that there are particular clusters of spines that are proportionally highly represented in a particular dendritic compartment/age combination. Specifically, basal dendrites contained a higher proportion of the small Cluster 1 spines (<xref ref-type="fig" rid="pcbi.1006221.g003">Fig 3B</xref>), whereas apical dendrites contained a higher proportion of the medium/large Clusters 3, 5 and 6 spines. These differences would imply that their functional properties should be expected to be different in the two dendritic compartments [<xref ref-type="bibr" rid="pcbi.1006221.ref002">2</xref>]. Regarding individuals, Cluster 2 spines accounted for a higher percentage in the younger individual, whereas Clusters 4 and 6 of bigger spines had higher values than the mean percentage in the older individual. Since small spines have been reported to be preferential sites for long-term potentiation induction and large spines might represent physical traces of long-term memory [<xref ref-type="bibr" rid="pcbi.1006221.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1006221.ref013">13</xref>], the results suggest that the younger individual has a higher potential for plasticity than in the aged case. The dendritic compartment/age combination results also agreed with our previously reported study [<xref ref-type="bibr" rid="pcbi.1006221.ref015">15</xref>] that found that apical dendrites have longer spines than basal dendrites, and younger basal dendrites are significantly smaller than aged basal dendrites. For instance, small and short spines of aged basal dendrites and long spines of apical dendrites were lost. Regarding the distance from soma, there is a higher predominance of the small Clusters 1 and 2 spines than expected at proximal distances (0–50μm) and the small Cluster 1 spines at distal distances. Also, distal distances showed a higher percentage of the medium-sized Cluster 4 spines than expected. Since variations in spine geometry reflect different functional properties of the spine, this particular distribution of spines might be related to the morphofunctional compartmentalization of the dendrites along the length of the dendritic pyramidal neurons. For example, it has been reported that different domains of the basal dendritic arbors of pyramidal cells have different properties with respect to afferent connectivity, plasticity and integration rules [<xref ref-type="bibr" rid="pcbi.1006221.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1006221.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1006221.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1006221.ref026">26</xref>]. Thus, these results may be a reflection of a functional dendritic organization based on spine geometry.</p>
<p>Using the technique of model-based clustering described in this study, we were able to simulate accurate spines from human pyramidal neurons. This is important for three main reasons. First, it is not necessary to store large volumes of data because all the information is summarized in the mathematical model. Second, spines are known to be dynamic structures (see [<xref ref-type="bibr" rid="pcbi.1006221.ref027">27</xref>] for a recent review), and changes in spine morphology have important functional implications potentially affecting not only the storage and integration of excitatory inputs in pyramidal neurons but also mediating evoked and experience-dependent synaptic plasticity. This, in turn, has major repercussions on cognition and memory [<xref ref-type="bibr" rid="pcbi.1006221.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1006221.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1006221.ref032">32</xref>]. Thus, it is necessary to link the structural data with theoretical studies and physiological data on spines in order to interpret and make the geometrical data on spines more meaningful. Functional modeling of spines is commonly carried out according to their values of surface area, spine maximum diameter, spine neck diameter, spine length, and spine neck length. Since each cluster contains a spine population with a range of morphological features, it is necessary to model all of these morphological variations within each cluster in order to compare the possible functional differences between the clusters found in the present study. Third, one of the major goals in neuroscience is to simulate human brain neuronal circuitry based on data-driven models because ethical limitations prevent all of the necessary datasets from being acquired directly from human brains. Therefore, the implementation of this mathematical model of spines of human pyramidal cells in current models of pyramidal neurons is a potentially useful tool for translating neuronal circuitry components from experimental animals to human brain circuits. The simulation of the spines in this study represents a mathematical model that could be implemented in pyramidal cell models [<xref ref-type="bibr" rid="pcbi.1006221.ref033">33</xref>] in order to present the data in a form that can be used to reason, make predictions and suggest new hypotheses of the functional organization of the pyramidal neurons. Finally, spine heads and necks of human pyramidal cells are significantly larger in terms of their area and longer, respectively, than mouse spines [<xref ref-type="bibr" rid="pcbi.1006221.ref034">34</xref>]. Therefore, it would be interesting to compare human and non-human spines using the present model-based clustering to ascertain whether the clusters that appear are the same or different in other species, or whether there are differences between different cortical areas.</p>
</sec>
<sec id="sec008" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec009">
<title>Ethics statement</title>
<p>Brain samples were obtained from the Institute of Neuropathology Brain Bank, a branch of the HUB-ICO-IDIBELL Biobank and member of the Spanish Biobank network (RETIC Biobank) of the Institute of Health Carlos III, following the guidelines of Spanish legislation (real Decreto 1716/2011) and the approval of the local ethics committee, and in accordance with recently published criteria for sample quality (PMID: 25113170).</p>
</sec>
<sec id="sec010">
<title>Tissue preparation</title>
<p>A set of 7,916 individually 3D reconstructed spines from layer III pyramidal neurons from the cingular cortex of two human males (aged 40 [C40] and 85 [C85]) were used for analyses. These cases were used as controls in a previous study unrelated to the present investigation that was dealing with Alzheimer’s disease [<xref ref-type="bibr" rid="pcbi.1006221.ref035">35</xref>]. The cause of death was traffic accident (case C40) and pneumonia plus interstitial pneumonitis (aged case, C85). The tissue (kindly supplied by Dr I. Ferrer, Instituto de Neuropatología, Servicio de Anatomía Patológica, IDIBELL-Hospital Universitario de Bellvitge, Barcelona, Spain) was obtained at autopsy (2–3 h post-mortem). The brains were immediately immersed in cold 4% paraformaldehyde in 0.1 M phosphate buffer, pH 7.4 (PB) and sectioned into 1.5-cm-thick coronal slices. Small blocks of the cortex (15 × 10 × 10 mm) were then transferred to a second solution of 4% paraformaldehyde in PB for 24 h at 4°C. After fixation, vibratome sections (250 μm) from the anterior cingular gyri (Brodmann's area 24;[<xref ref-type="bibr" rid="pcbi.1006221.ref036">36</xref>]) were obtained with a Vibratome and labelled with 4,6 diamino-2-phenylindole (DAPI; Sigma, St Louis, MO) to identify cell bodies. Pyramidal cells were then individually injected with Lucifer Yellow (LY; 8% in 0.1 M Tris buffer, pH 7.4), in cytoarchitectonically identified layer III of the anterior cingular gyrus. LY was applied to each injected cell by continuous current until the distal tips of each cell fluoresced brightly, indicating that the dendrites were completely filled and ensuring that the fluorescence did not diminish at a distance from the soma (for a detailed methodology of the cell injections, see [<xref ref-type="bibr" rid="pcbi.1006221.ref037">37</xref>–<xref ref-type="bibr" rid="pcbi.1006221.ref039">39</xref>]). Apical and basal dendrites were then scanned at high magnification by confocal microscopy and reconstructed in three dimensions using a methodology previously described in detail [<xref ref-type="bibr" rid="pcbi.1006221.ref015">15</xref>]. Sections were imaged with a Leica TCS 4D confocal scanning laser attached to a Leitz DMIRB fluorescence microscope. Fluorescent labeling profiles were imaged, using an excitation wavelength of 491 nm to visualize Alexa fluor 488. Consecutive stacks of images (3 ± 0.6 stacks per dendrite; 52 ± 17 images) were acquired at high magnification (×63 glycerol; voxel size, 0.075 × 0.075 × 0.28 μm<sup>3</sup>) to capture the full dendritic depth, length, and width of basal dendrites, each originating from a different pyramidal neuron (10 per case). The voxel size was calculated to acquire images at the highest resolution possible for the microscope which made it possible to capture the traditional diffraction limits of fluorescence microscopy (approximately 200 nanometers). Regarding apical dendrites, the main apical dendrite was scanned, at a distance of 100 μm from the soma up to 200 μm (8 dendrites per case). Thus, no apical dendritic tufts were included in the analyses. As a result, a dataset containing 7,916 3D reconstructed individual spines along the apical and basal dendrites was built (<xref ref-type="fig" rid="pcbi.1006221.g001">Fig 1</xref>).</p>
</sec>
<sec id="sec011">
<title>Repairing spines</title>
<p>We addressed the task of repairing spines by means of a semi-automatic mesh processing algorithm (<xref ref-type="fig" rid="pcbi.1006221.g002">Fig 2A</xref>). The procedure starts by identifying fragmented spines. A spine is fragmented if there is no path between every pair of vertices on the surface of the 3D mesh, and all the vertices belong to a closed mesh. If this is the case, fragmentation is repaired by applying a closing morphological operator to each spine individually. This operator requires a binary image as input, and therefore 3D meshes are voxelized [<xref ref-type="bibr" rid="pcbi.1006221.ref040">40</xref>]. As a result of applying the closing operator to each voxel of the volumetric spine using a sphere as a structuring element, fragments are joined to form a single body. The marching cubes algorithm [<xref ref-type="bibr" rid="pcbi.1006221.ref041">41</xref>] recovers the mesh representation from the volumetric image of the repaired spine.</p>
<p>The repair process was continued by connecting spines to dendrites by means of spine path reconstruction (<xref ref-type="fig" rid="pcbi.1006221.g002">Fig 2B</xref>). Several points were created to attach the spine to the dendrite, using the measurement point tool in Imaris software. These are considered to be the spine insertion points. Spine reconstruction was applied to any spines whose insertion point was not on the surface of the mesh. This step in the repair process consists of filling the gap between the closest vertex of the spine to the insertion point and the insertion point according to an iterative process that grew the missing base of the spine. Specifically, each detached spine was oriented so that both points bounding the gap were aligned with the z-axis. Then, the mesh of each spine was voxelized. Each voxel slice perpendicular to the z-axis between the spine and the insertion point was filled with the result of applying a 2D Gaussian filter to the slice immediately above. The mesh representation of the completely repaired spine was recovered from the volumetric representation by the marching cubes algorithm. Finally, we smoothed the triangular mesh with a curvature flow technique [<xref ref-type="bibr" rid="pcbi.1006221.ref042">42</xref>]. As result of this process a new dataset of corrected spines is obtained.</p>
</sec>
<sec id="sec012">
<title>Feature extraction</title>
<p>Given 3D meshes representing the surface of the spines, our goal was to extract a set of morphological features providing enough information to reconstruct an approximation of their original shapes. Our work was partially inspired by the concept of multiresolutional Reeb graph (MRG) [<xref ref-type="bibr" rid="pcbi.1006221.ref043">43</xref>] and its particular implementation in [<xref ref-type="bibr" rid="pcbi.1006221.ref044">44</xref>], a technique that constructs a graph from a 3D geometric model to describe its topology (<xref ref-type="fig" rid="pcbi.1006221.g002">Fig 2C–2F</xref>). This approach partitions a triangular mesh into regions based on the value of a function <italic>μ</italic>(⋅). This function should preferably be the geodesic distance, i.e., the shortest path between two points of the mesh along the surface because it is invariant to translation and rotation and is robust against mesh simplification and subdivision. We computed geodesic distance from the insertion point of the spine to each vertex of the mesh (<xref ref-type="fig" rid="pcbi.1006221.g002">Fig 2C</xref>). The domain of <italic>μ</italic>(⋅) was divided into K = 7 equal length intervals, where <italic>r</italic><sub><italic>i</italic></sub> indicates the beginning and the end of each region such that <inline-formula id="pcbi.1006221.e001"><alternatives><graphic id="pcbi.1006221.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:mi>α</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:mi>α</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>α</italic> is max <italic>μ</italic>(⋅). This means that each of the vertices in the triangular mesh was allocated to a particular region depending on its evaluation function <italic>μ</italic>(⋅) (<xref ref-type="fig" rid="pcbi.1006221.g002">Fig 2D–2E</xref>). At each region <italic>i</italic>, the curves defining the top and bottom bounds were assumed to be ellipses contained in the best fitting plane computed using principal component analysis. We denote <italic>T</italic><sub><italic>i</italic></sub> and <italic>B</italic><sub><italic>i</italic></sub> the top and the bottom ellipses of each region <italic>i</italic> respectively. Thus, each region provided a local description of the morphology while the combination of the information of all regions represented a global characterization of the spine. Representing a spine as a set of ellipses allows us to capture its most relevant morphological aspects while spurious details are avoided.</p>
<p>The proposed set of 54 features must unambiguously describe the placement of the ellipses. To achieve this, at each region <italic>i</italic> a set of features was computed according to their ellipses <italic>T</italic><sub><italic>i</italic></sub> and <italic>B</italic><sub><italic>i</italic></sub>. Since the surface was required to be continuous coherence constraints were imposed on adjacent regions: <inline-formula id="pcbi.1006221.e002"><alternatives><graphic id="pcbi.1006221.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Thus, to satisfy the previous condition the following features were considered to characterize the spine (<xref ref-type="fig" rid="pcbi.1006221.g007">Fig 7</xref>):</p>
<p><underline>Height (|<bold><italic>h</italic></bold></underline><sub><underline><italic>i</italic></underline></sub><underline>|))</underline>: This variable measures the length of the vector <bold><italic>h</italic></bold><sub><italic>i</italic></sub> between the centroids of two consecutive ellipses. The higher the value of this variable, the longer the spine in that region.</p>
<p><underline>Length of major axis of ellipse <inline-formula id="pcbi.1006221.e003"><alternatives><graphic id="pcbi.1006221.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula></underline>: Low values mean that spine is thin around <inline-formula id="pcbi.1006221.e004"><alternatives><graphic id="pcbi.1006221.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
<p><underline>Length of minor axis of ellipse <inline-formula id="pcbi.1006221.e005"><alternatives><graphic id="pcbi.1006221.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula></underline>: It gives information about the squishiness of the spine when it is compared with <inline-formula id="pcbi.1006221.e006"><alternatives><graphic id="pcbi.1006221.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. If <inline-formula id="pcbi.1006221.e007"><alternatives><graphic id="pcbi.1006221.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006221.e008"><alternatives><graphic id="pcbi.1006221.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> have the same values the ellipse is in fact a circle while when <inline-formula id="pcbi.1006221.e009"><alternatives><graphic id="pcbi.1006221.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> gets smaller the ellipse becomes more squished.</p>
<p><underline>Ratio between sections (<italic>φ</italic></underline><sub><underline><italic>ij</italic></underline></sub><underline>)</underline>: It is the ratio between the area of the ellipses <italic>j</italic> and <italic>i</italic>, i.e., <inline-formula id="pcbi.1006221.e010"><alternatives><graphic id="pcbi.1006221.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>π</mml:mi><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>π</mml:mi><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. If it is higher than 1 it means that ellipse <italic>j</italic> is bigger than ellipse <italic>i</italic>. When values are between 0 and 1 it means that ellipse <italic>i</italic> is bigger than ellipse <italic>j</italic>. It can be interpreted as the widening or narrowing along the spine. We compute <italic>φ</italic><sub>24</sub>, <italic>φ</italic><sub>26</sub> and <italic>φ</italic><sub>46</sub>.</p>
<p><underline>Growing direction of the spine</underline>: The vector between ellipse centroids <bold><italic>h</italic></bold><sub><italic>i</italic></sub> defines a direction which can be expressed in spherical coordinates, i.e., an azimuth angle <italic>ϕ</italic><sub><italic>i</italic></sub> and an elevation angle <italic>θ</italic><sub><italic>i</italic></sub>.</p>
<list list-type="bullet">
<list-item><p>cos(<italic>ϕ</italic><sub><italic>i</italic></sub>): Cosine of the azimuth or azimuthal angle, obtained as the angle between the vectors defined by three consecutive ellipses. The cosine is computed from the dot product: <inline-formula id="pcbi.1006221.e011"><alternatives><graphic id="pcbi.1006221.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic&gt;">h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. It measures the curvature of the spine.</p></list-item>
<list-item><p><italic>θ</italic><sub><italic>i</italic></sub>: The polar angle, also called colatitude in the spherical coordinate system. It is needed for simulation.</p></list-item>
</list>
<p><underline>Ellipse direction</underline>: It is the direction of the perpendicular vector to ellipse <italic>B</italic><sub><italic>i</italic></sub>. It is obtained from <inline-formula id="pcbi.1006221.e012"><alternatives><graphic id="pcbi.1006221.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> (vectorial product). It is expressed in spherical coordinates as:</p>
<list list-type="bullet">
<list-item><p><italic>Θ</italic><sub><italic>i</italic></sub>: The polar angle or colatitude in spherical coordinate system. It is the inclination of the vector perpendicular to the ellipse with respect to <inline-formula id="pcbi.1006221.e013"><alternatives><graphic id="pcbi.1006221.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Z</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> axis. If it is 0 then the spine grows horizontally at that point. When it is <inline-formula id="pcbi.1006221.e014"><alternatives><graphic id="pcbi.1006221.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mfrac><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, it means that the spine grows completely vertical at that point. It is needed for simulation.</p></list-item>
<list-item><p><italic>Φ</italic><sub><italic>i</italic></sub>: The azimuth or azimuthal angle. It indicates if the spine is growing to the right, left, forward or backward as it was previously explained for the growing direction but in this case it is computed for the perpendicular vector to the ellipse. It is needed for simulation.</p></list-item>
</list>
<p><underline>Volume (V)</underline>: It is the total volume of the spine.</p>
<p><underline>Volume of each region (<italic>V</italic></underline><sub><underline><italic>i</italic></underline></sub>): It an approximation of the volume between two consecutive ellipses. It is computed from the convex hull of <italic>T</italic><sub><italic>i</italic></sub> and <italic>B</italic><sub><italic>i</italic></sub>.</p>
<fig id="pcbi.1006221.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006221.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Spine features description.</title>
<p>An ellipse is defined by its centroid, major axis (<inline-formula id="pcbi.1006221.e015"><alternatives><graphic id="pcbi.1006221.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mo>−</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) and minor axis (<inline-formula id="pcbi.1006221.e016"><alternatives><graphic id="pcbi.1006221.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mo>−</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>). These points are connected by vectors <bold><italic>h</italic></bold><sub><italic>i</italic></sub> whose length is |<bold><italic>h</italic></bold><sub><italic>i</italic></sub>|. From vectors <bold><italic>h</italic></bold><sub><italic>i</italic></sub> and <bold><italic>h</italic></bold><sub><italic>i</italic><bold>−1</bold></sub>, <bold><italic>θ</italic></bold><sub><bold><italic>i</italic></bold></sub> and <bold><italic>ϕ</italic></bold><sub><bold><italic>i</italic></bold></sub> are obtained. <bold><italic>Θ</italic></bold><sub><bold><italic>i</italic></bold></sub> and <bold><italic>Φ</italic></bold><sub><bold><italic>i</italic></bold></sub> are the ellipse directions of the spine.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.g007" xlink:type="simple"/>
</fig>
<p>By generating a surface between each pair of ellipses, we get an approximation of the shape of the spine (<xref ref-type="fig" rid="pcbi.1006221.g006">Fig 6B and 6C</xref>). Surfaces between regions can be computed by the method that we propose in the spine simulation section under Materials and Methods.</p>
</sec>
<sec id="sec013">
<title>Model-based clustering</title>
<p>Model-based clustering [<xref ref-type="bibr" rid="pcbi.1006221.ref045">45</xref>] is a probabilistic approach that assumes that data were generated by a statistical model. Its goal is to recover that model from the observed data. Finite mixture models provide a formal setting for model-based clustering. In finite mixture models, each cluster is represented by a probability distribution. The linear superposition of such distributions generates the finite mixture <italic>M</italic>. The fit of the model to the data depends on a set of parameters that are usually optimized by means of maximum-likelihood estimation. This estimation method finds the set of parameters <bold><italic>θ</italic></bold> that maximize the observed data likelihood, i.e., max<sub><bold><italic>θ</italic></bold></sub> <italic>f</italic>(<bold><italic>x</italic></bold><sub>1</sub>,…,<bold><italic>x</italic></bold><sub><italic>N</italic></sub>|<bold><italic>θ</italic></bold>), where <bold><italic>x</italic></bold><sub>1</sub>,…,<bold><italic>x</italic></bold><sub><italic>N</italic></sub> are a data sample of size <italic>N</italic>. Then, we assume that the vector of features describing the spines is distributed according to a Gaussian mixture, as it can approximate any multivariate density given enough components [<xref ref-type="bibr" rid="pcbi.1006221.ref046">46</xref>]. Thus, the density is
<disp-formula id="pcbi.1006221.e017">
<alternatives>
<graphic id="pcbi.1006221.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e017" xlink:type="simple"/>
<mml:math display="block" id="M17">
<mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
where <inline-formula id="pcbi.1006221.e018"><alternatives><graphic id="pcbi.1006221.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> denotes a multivariate normal distribution with prior probability <italic>π</italic><sub><italic>c</italic></sub>, mean vector <bold><italic>μ</italic></bold><sub><italic>c</italic></sub> and variance-covariance matrix <bold>Σ</bold><sub><italic>c</italic></sub>, <italic>C</italic> is the total number of clusters and each cluster is denoted by <italic>c</italic>. Thus, the goal is to get the values for the set of parameters <bold><italic>θ</italic></bold> = {<italic>π</italic><sub><italic>c</italic></sub>,<bold><italic>μ</italic></bold><sub><italic>c</italic></sub>,<bold>Σ</bold><sub><italic>c</italic></sub>}<sub><italic>c</italic></sub> that maximize the likelihood. This was approximated using an iterative two-step procedure called expectation-maximization algorithm [<xref ref-type="bibr" rid="pcbi.1006221.ref047">47</xref>]. To choose the most suitable number of clusters, we computed the Bayesian information criterion (BIC) score [<xref ref-type="bibr" rid="pcbi.1006221.ref048">48</xref>] for different values of <italic>C</italic>. BIC is a measure that adds a penalty to the log-likelihood of the model based on the number of model parameters. Therefore, it is used to select the best parameterization and number of clusters by trying to avoid the selection of overly complex models.</p>
<p>After the clustering process, each spine has a certain probability of belonging to each cluster (“soft” clustering). We used mclust, a contributed R package [<xref ref-type="bibr" rid="pcbi.1006221.ref049">49</xref>], for model-based clustering and density estimation.</p>
</sec>
<sec id="sec014">
<title>Clustering interpretation tools</title>
<p>In order to shed light on the features that characterize each cluster, we generated classification rules according to the RIPPER algorithm [<xref ref-type="bibr" rid="pcbi.1006221.ref050">50</xref>]. The spines were crisply assigned to a unique cluster by selecting the most probable cluster for each spine. Then, RIPPER compared each cluster against the others, generating discriminative rules. SMOTE [<xref ref-type="bibr" rid="pcbi.1006221.ref051">51</xref>] was applied as a pre-processing step before running RIPPER to avoid bias and deal with the unbalanced distribution of instances arising from data splitting (one cluster versus the rest). SMOTE is a technique for adjusting the class distribution so that the set of observations of the least represented class is resampled. We also forced RIPPER to select a unique rule to improve the interpretability of each cluster, highlighting its most discriminative features. We used the RIPPER implementation included in the collection of algorithms of Weka, a software for machine learning tasks [<xref ref-type="bibr" rid="pcbi.1006221.ref052">52</xref>].</p>
<p>To make the clustering results graphically interpretable, we applied multidimensional scaling to represent the distance of spines to clusters according to their membership probability (<xref ref-type="fig" rid="pcbi.1006221.g003">Fig 3C</xref>). To achieve this goal, distances between each pair of multivariate Gaussians defined by the clusters were calculated according to the Bhattacharyya distance [<xref ref-type="bibr" rid="pcbi.1006221.ref053">53</xref>]. Based on this measure, we were then able to project the above distances, originally in a 6D space, onto a 2D space using multidimensional scaling [<xref ref-type="bibr" rid="pcbi.1006221.ref054">54</xref>]. Thus, spines were placed in this space in proportion to the probability of their belonging to each cluster.</p>
<p>Clustering aims to group similar instances and separate dissimilar instances. Therefore, method performance depends on whether the clusters overlap with each other. Non overlapping clusters are easily discovered. However, clustering algorithms have trouble separating overlapped clusters because instances cannot be clearly assigned to clusters. Hence, overlapping was understood according to [<xref ref-type="bibr" rid="pcbi.1006221.ref055">55</xref>,<xref ref-type="bibr" rid="pcbi.1006221.ref056">56</xref>] as the probability of misclassifying an instance from cluster <italic>i</italic> in a cluster <italic>j</italic>. Thus, the probability <italic>ω</italic><sub><italic>j</italic>|<italic>i</italic></sub> of misclassifying an instance of the <italic>i</italic>-<italic>th</italic> component to the <italic>j</italic>-<italic>th</italic> component was computed as
<disp-formula id="pcbi.1006221.e019">
<alternatives>
<graphic id="pcbi.1006221.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006221.e019" xlink:type="simple"/>
<mml:math display="block" id="M19">
<mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
</disp-formula></p>
</sec>
<sec id="sec015">
<title>Spine simulation</title>
<p>The simulation process aimed at achieving accurate 3D representations of spines generated by the computer. This process is divided into two main phases.</p>
<p>First, we sampled new instances from the mixture model of multivariate Gaussians. As a result of sampling, we got a dataset where each instance consisted of a vector with 54 feature values defined by a multiresolution Reeb graph.</p>
<p>Second, we generated a 3D representation for each instance. From the set of features of a sampled spine, we built a skeleton composed of the ellipses establishing the beginning and end of regions (<xref ref-type="fig" rid="pcbi.1006221.g006">Fig 6A</xref>). Because all the ellipses had the same number of points, each pair of consecutive ellipses was easily triangulated to obtain a closed mesh (<xref ref-type="fig" rid="pcbi.1006221.g006">Fig 6B and 6C</xref>). Although this mesh is a 3D spine, ellipses are clearly distinguishable. We improved this result by smoothing the surface with the Loop’s subdivision algorithm [<xref ref-type="bibr" rid="pcbi.1006221.ref057">57</xref>]. Thus, we obtained a more accurate 3D representation of the spine (<xref ref-type="fig" rid="pcbi.1006221.g006">Fig 6D</xref>).</p>
<p>To objectively validate the realism of the simulated spines, we used a binary classifier, specifically the RIPPER algorithm. First, for each cluster, we sampled from the probability distribution of each cluster the same number of simulated spines as real spines are. Second, we combined these with real spines to generate a dataset for each cluster. Third, we applied the RIPPER algorithm with ten-fold cross-validation [<xref ref-type="bibr" rid="pcbi.1006221.ref058">58</xref>] over the datasets to discriminate between real and simulated spines. This process yields classifier accuracy, which can be regarded as the degree of realism.</p>
</sec>
</sec>
<sec id="sec016">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006221.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Number and percentage of spines after repair by their dendritic compartment and age.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006221.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.s002" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>This table reports the probability of misclassifying a spine from cluster <italic>i</italic> in cluster <italic>j</italic>.</title>
<p>The probability of classifying a spine from Cluster 3 in Cluster 4 is 1.69e-05. These values are interpreted as a measure of the overlap between clusters. Spines that are not clearly assigned to a cluster are placed between clusters that overlap. This matches the relations between clusters observed in the multidimensional scaling representation.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006221.s003" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.s003" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Number of dendritic spines as a function of their distance from the soma.</title>
<p>The spines were ascribed to sections of 50 μm long, from 0 μm (beginning of the dendrite) to 300μm.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006221.s004" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006221.s004" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supplementary information.</title>
<p>Plain discriminative rules and summary statistics of the features.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors would like to thank Mr. Federico Baguear, Dr. Luis Guerra and Mr. Jesús Pérez for their initial help in preliminary analysis.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006221.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>DeFelipe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fariñas</surname> <given-names>I</given-names></name>. <article-title>The pyramidal neuron of the cerebral cortex: Morphological and chemical characteristics of the synaptic inputs</article-title>. <source>Prog Neurobiol</source>. <year>1992</year>;<volume>39</volume>: <fpage>563</fpage>–<lpage>607</lpage>. <object-id pub-id-type="pmid">1410442</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Araya</surname> <given-names>R</given-names></name>. <article-title>Input transformation by dendritic spines of pyramidal neurons</article-title>. <source>Front Neuroanat</source>. <year>2014</year>;<volume>8</volume>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arellano</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Benavides-Piccione</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>DeFelipe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>. <article-title>Ultrastructure of dendritic spines: correlation between synaptic and spine morphologies</article-title>. <source>Front Neurosci</source>. <year>2007</year>;<fpage>1</fpage>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harris</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Stevens</surname> <given-names>JK</given-names></name>. <article-title>Dendritic spines of rat cerebellar Purkinje cells: serial electron microscopy with reference to their biophysical characteristics</article-title>. <source>J Neurosci</source>. <year>1988</year>;<volume>8</volume>: <fpage>4455</fpage>–<lpage>4469</lpage>. <object-id pub-id-type="pmid">3199186</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harris</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Stevens</surname> <given-names>JK</given-names></name>. <article-title>Dendritic spines of CA 1 pyramidal cells in the rat hippocampus: Serial electron microscopy with reference to their biophysical characteristics</article-title>. <source>J Neurosci</source>. <year>1989</year>;<volume>9</volume>: <fpage>2982</fpage>–<lpage>2997</lpage>. <object-id pub-id-type="pmid">2769375</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Denk</surname> <given-names>W</given-names></name>. <article-title>Dendritic spines as basic functional units of neuronal integration</article-title>. <source>Nature</source>. <year>1995</year>;<volume>375</volume>: <fpage>682</fpage>–<lpage>684</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/375682a0" xlink:type="simple">10.1038/375682a0</ext-link></comment> <object-id pub-id-type="pmid">7791901</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Majewska</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Holthoff</surname> <given-names>K</given-names></name>. <article-title>From form to function: Calcium compartmentalization in dendritic spines</article-title>. <source>Nat Neurosci</source>. <year>2000</year>;<volume>3</volume>: <fpage>653</fpage>–<lpage>659</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/76609" xlink:type="simple">10.1038/76609</ext-link></comment> <object-id pub-id-type="pmid">10862697</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nusser</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Naylor</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mody</surname> <given-names>I</given-names></name>. <article-title>Synapse-specific contribution of the variation of transmitter concentration to the decay of inhibitory postsynaptic currents</article-title>. <source>Biophys J</source>. <year>2001</year>;<volume>80</volume>: <fpage>1251</fpage>–<lpage>1261</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0006-3495(01)76101-2" xlink:type="simple">10.1016/S0006-3495(01)76101-2</ext-link></comment> <object-id pub-id-type="pmid">11222289</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Matsuzaki</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Honkura</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ellis-Davies</surname> <given-names>GCR</given-names></name>, <name name-style="western"><surname>Kasai</surname> <given-names>H</given-names></name>. <article-title>Structural basis of long-term potentiation in single dendritic spines</article-title>. <source>Nature</source>. <year>2004</year>;<volume>429</volume>: <fpage>761</fpage>–<lpage>766</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature02617" xlink:type="simple">10.1038/nature02617</ext-link></comment> <object-id pub-id-type="pmid">15190253</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dunaevsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tashiro</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Majewska</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mason</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>. <article-title>Developmental regulation of spine motility in the mammalian central nervous system</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>1999</year>;<volume>96</volume>: <fpage>13438</fpage>–<lpage>13443</lpage>. <object-id pub-id-type="pmid">10557339</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Matus</surname> <given-names>A</given-names></name>. <article-title>Actin-Based Plasticity in Dendritic Spines</article-title>. <source>Science (80-)</source>. <year>2000</year>;<volume>290</volume>: <fpage>754</fpage>–<lpage>758</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.290.5492.754" xlink:type="simple">10.1126/science.290.5492.754</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006221.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bonhoeffer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>. <article-title>Spine motility. Phenomenology, mechanisms, and function</article-title>. <source>Neuron</source>. <year>2002</year>;<volume>35</volume>: <fpage>1019</fpage>–<lpage>1027</lpage>. <object-id pub-id-type="pmid">12354393</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kasai</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Fukuda</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Watanabe</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hayashi-Takagi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Noguchi</surname> <given-names>J</given-names></name>. <article-title>Structural dynamics of dendritic spines in memory and cognition</article-title>. <source>Trends Neurosci</source>. <year>2010</year>;<volume>33</volume>: <fpage>121</fpage>–<lpage>129</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tins.2010.01.001" xlink:type="simple">10.1016/j.tins.2010.01.001</ext-link></comment> <object-id pub-id-type="pmid">20138375</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tønnesen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nägerl</surname> <given-names>U</given-names></name>. <article-title>Dendritic Spines as Tunable Regulators of Synaptic Signals</article-title>. <source>Front Psychiatry</source>. <year>2016</year>;<volume>7</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fpsyt.2016.00101" xlink:type="simple">10.3389/fpsyt.2016.00101</ext-link></comment> <object-id pub-id-type="pmid">27340393</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benavides-Piccione</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Fernaud-Espinosa</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Robles</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>DeFelipe</surname> <given-names>J</given-names></name>. <article-title>Age-based comparison of human dendritic spine structure using complete three-dimensional reconstructions</article-title>. <source>Cereb Cortex</source>. <year>2013</year>;<volume>23</volume>: <fpage>1798</fpage>–<lpage>1810</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/bhs154" xlink:type="simple">10.1093/cercor/bhs154</ext-link></comment> <object-id pub-id-type="pmid">22710613</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peters</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kaiserman-Abramof</surname> <given-names>IR</given-names></name>. <article-title>The small pyramidal neuron of the rat cerebral cortex. The perikaryon, dendrites and spines</article-title>. <source>Am J Anat</source>. <year>1970</year>;<volume>127</volume>: <fpage>321</fpage>–<lpage>355</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/aja.1001270402" xlink:type="simple">10.1002/aja.1001270402</ext-link></comment> <object-id pub-id-type="pmid">4985058</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bokota</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Magnowska</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kuśmierczyk</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Łukasik</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Roszkowska</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dariusz</surname> <given-names>P</given-names></name>. <article-title>Computational approach to dendritic spine taxonomy and shape transition analysis</article-title>. <source>Front Comput Neurosci</source>. <year>2016</year>;<volume>10</volume>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref018"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Ghani MU, Erdil E, Kanik SD, Argunsah AO, Hobbiss AF, Israely I, et al. Dendritic spine shape analysis: A clustering perspective. Computer Vision—ECCV 2016 Workshops: Amsterdam, The Netherlands, October 8–10 and 15–16, 2016, Proceedings, Part I. 2016. pp. 256–273.</mixed-citation></ref>
<ref id="pcbi.1006221.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lübke</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Frotscher</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Roth</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>. <article-title>Physiology and anatomy of synaptic connections between thick tufted pyramidal neurones in the developing rat neocortex</article-title>. <source>J Physiol</source>. <year>1997</year>;<volume>500</volume>: <fpage>409</fpage>–<lpage>440</lpage>. <object-id pub-id-type="pmid">9147328</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hof</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Morrison</surname> <given-names>JH</given-names></name>. <article-title>The aging brain: morphomolecular senescence of cortical circuits</article-title>. <source>Trends Neurosci</source>. <year>2004</year>;<volume>27</volume>: <fpage>607</fpage>–<lpage>613</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tins.2004.07.013" xlink:type="simple">10.1016/j.tins.2004.07.013</ext-link></comment> <object-id pub-id-type="pmid">15374672</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dimitriu</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hao</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hara</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kaufmann</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Janssen</surname> <given-names>WGM</given-names></name>, <name name-style="western"><surname>Lou</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Selective changes in thin spine density and morphology in monkey prefrontal cortex correlate with aging-related cognitive impairment</article-title>. <source>J Neurosci</source>. <year>2010</year>;<volume>30</volume>: <fpage>7507</fpage>–<lpage>7515</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.6410-09.2010" xlink:type="simple">10.1523/JNEUROSCI.6410-09.2010</ext-link></comment> <object-id pub-id-type="pmid">20519525</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bosch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Martínez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Masachs</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Teixeira</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Fernaud</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Ulloa</surname> <given-names>F</given-names></name>, <etal>et al</etal>. <article-title>FIB/SEM technology and high-throughput 3D reconstruction of dendritic spines and synapses in GFP-labeled adult-generated neurons</article-title>. <source>Front Neuroanat</source>. <year>2015</year>;<volume>9</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fnana.2015.00060" xlink:type="simple">10.3389/fnana.2015.00060</ext-link></comment> <object-id pub-id-type="pmid">26052271</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Häusser</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mel</surname> <given-names>B</given-names></name>. <article-title>Dendrites: bug or feature?</article-title> <source>Curr Opin Neurobiol</source>. <year>2003</year>;<volume>13</volume>: <fpage>372</fpage>–<lpage>383</lpage>. <object-id pub-id-type="pmid">12850223</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gordon</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Polsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schiller</surname> <given-names>J</given-names></name>. <article-title>Plasticity compartments in basal dendrites of neocortical pyramidal neurons</article-title>. <source>J Neurosci</source>. <year>2006</year>;<volume>26</volume>: <fpage>12717</fpage>–<lpage>12726</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3502-06.2006" xlink:type="simple">10.1523/JNEUROSCI.3502-06.2006</ext-link></comment> <object-id pub-id-type="pmid">17151275</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gelfo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>De Bartolo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Giovine</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Petrosini</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Leggio</surname> <given-names>MG</given-names></name>. <article-title>Layer and regional effects of environmental enrichment on the pyramidal neuron morphology of the rat</article-title>. <source>Neurobiol Learn Mem</source>. <year>2009</year>;<volume>91</volume>: <fpage>353</fpage>–<lpage>365</lpage>. <object-id pub-id-type="pmid">19340947</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Petreanu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Mao</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sternson</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Svoboda</surname> <given-names>K</given-names></name>. <article-title>The subcellular organization of neocortical excitatory connections</article-title>. <source>Nature</source>. <year>2009</year>;<volume>457</volume>: <fpage>1142</fpage>–<lpage>1145</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature07709" xlink:type="simple">10.1038/nature07709</ext-link></comment> <object-id pub-id-type="pmid">19151697</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berry</surname> <given-names>Kalen P</given-names></name>; <name name-style="western"><surname>Nedivi</surname> <given-names>E</given-names></name>. <article-title>Spine Dynamics: Are They All the Same?</article-title> <source>Neuron</source>. <year>2017</year>;<volume>96</volume>: <fpage>43</fpage>–<lpage>55</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2017.08.008" xlink:type="simple">10.1016/j.neuron.2017.08.008</ext-link></comment> <object-id pub-id-type="pmid">28957675</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Van Harreveld</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fifkova</surname> <given-names>E</given-names></name>. <article-title>Swelling of dendritic spines in the fascia dentata after stimulation of the perforant fibers as a mechanism of post-tetanic potentiation</article-title>. <source>Exp Neurol</source>. <year>1975</year>;<volume>49</volume>: <fpage>736</fpage>–<lpage>749</lpage>. <object-id pub-id-type="pmid">173566</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holtmaat</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Svoboda</surname> <given-names>K</given-names></name>. <article-title>Experience-dependent structural synaptic plasticity in the mammalian brain</article-title>. <source>Nat Rev Neurosci</source>. <year>2009</year>;<volume>10</volume>: <fpage>647</fpage>–<lpage>658</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn2699" xlink:type="simple">10.1038/nrn2699</ext-link></comment> <object-id pub-id-type="pmid">19693029</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Araya</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vogels</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>. <article-title>Activity-dependent dendritic spine neck changes are correlated with synaptic strength</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2014</year>;<volume>111</volume>: <fpage>2094</fpage>–<lpage>2895</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1400138111" xlink:type="simple">10.1073/pnas.1400138111</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006221.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tønnesen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Katona</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Rózsa</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Nägerl</surname> <given-names>V</given-names></name>. <article-title>Spine neck plasticity regulates compartmentalization of synapses</article-title>. <source>Nat Neurosci</source>. <year>2014</year>;<volume>17</volume>: <fpage>678</fpage>–<lpage>685</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3682" xlink:type="simple">10.1038/nn.3682</ext-link></comment> <object-id pub-id-type="pmid">24657968</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Segal</surname> <given-names>M</given-names></name>. <article-title>Dendritic spines: morphological building blocks of memory</article-title>. <source>Neurobiol Learn Mem</source>. <year>2017</year>;<volume>138</volume>: <fpage>3</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.nlm.2016.06.007" xlink:type="simple">10.1016/j.nlm.2016.06.007</ext-link></comment> <object-id pub-id-type="pmid">27311757</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eyal</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Verhoog</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Testa-Silva</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Deitcher</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lodder</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Benavides-Piccione</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Unique membrane properties and enhanced signal processing in human neocortical neurons</article-title>. <source>Elife</source>. <year>2016</year>;<volume>5</volume>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benavides-Piccione</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ballesteros-Yáñez</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>DeFelipe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>. <article-title>Cortical area and species differences in dendritic spine morphology</article-title>. <source>J Neurocytol</source>. <year>2002</year>;<volume>31</volume>: <fpage>337</fpage>–<lpage>346</lpage>. <object-id pub-id-type="pmid">12815251</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blazquez-Llorca</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Garcia-Marín</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>DeFelipe</surname> <given-names>J</given-names></name>. <article-title>Pericellular innervation of neurons expressing abnormally hyperphosphorylated tau in the hippocampal formation of Alzheimer’s disease patients</article-title>. <source>Front Neuroanat</source>. <year>2010</year>;<volume>4</volume>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref036"><label>36</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Brodmann</surname> <given-names>K</given-names></name>. <source>Brodmann’s Localisation in the Cerebral Cortex</source>. <publisher-loc>London</publisher-loc>: <publisher-name>Smith-Gordon</publisher-name>; <year>1994</year>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Elston</surname> <given-names>GN</given-names></name>; <name name-style="western"><surname>Rosa</surname> <given-names>M</given-names></name>. <article-title>The occipitoparietal pathway of the macaque monkey: comparison of pyramidal cell morphology in layer III of functionally related cortical visual areas</article-title>. <source>Cereb Cortex</source>. <year>1997</year>;<volume>7</volume>: <fpage>432</fpage>–<lpage>452</lpage>. <object-id pub-id-type="pmid">9261573</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Elston</surname> <given-names>GN</given-names></name>; <name name-style="western"><surname>Benavides-Piccione</surname> <given-names>R</given-names></name>; <name name-style="western"><surname>DeFelipe</surname> <given-names>J</given-names></name>. <article-title>The pyramidal cell in cognition: A comparative study in human and monkey</article-title>. <source>J Neurosci</source>. <year>2001</year>;<volume>21</volume>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benavides-Piccione</surname> <given-names>R</given-names></name>; <name name-style="western"><surname>Ballesteros-Yáñez</surname> <given-names>I</given-names></name>; <name name-style="western"><surname>DeFelipe</surname> <given-names>J</given-names></name>; <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>. <article-title>Alterations of cortical pyramidal neurons in mice lacking high-affinity nicotinic receptors</article-title>. <source>Proc Natl Acad Sci</source>. <year>2010</year>;<volume>107</volume>: <fpage>11567</fpage>–<lpage>11572</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1006269107" xlink:type="simple">10.1073/pnas.1006269107</ext-link></comment> <object-id pub-id-type="pmid">20534523</object-id></mixed-citation></ref>
<ref id="pcbi.1006221.ref040"><label>40</label><mixed-citation publication-type="other" xlink:type="simple">Patil S, Ravi B. Voxel-based representation, display and thickness analysis of intricate shapes. Proceedings of the Ninth International Conference on Computer Aided Design and Computer Graphics. 2005.</mixed-citation></ref>
<ref id="pcbi.1006221.ref041"><label>41</label><mixed-citation publication-type="other" xlink:type="simple">Lorensen WE, Cline HE. Marching cubes: A high resolution 3D surface construction algorithm. Proceedings of the 14th Annual Conference on Computer Graphics and Interactive Techniques. 1987. pp. 163–169.</mixed-citation></ref>
<ref id="pcbi.1006221.ref042"><label>42</label><mixed-citation publication-type="other" xlink:type="simple">Desbrun M, Meyer M, Schröder P, Barr AH. Implicit fairing of irregular meshes using diffusion and curvature flow. Proceedings of the 26th Annual Conference on Computer Graphics and Interactive Techniques. 1999. pp. 317–324.</mixed-citation></ref>
<ref id="pcbi.1006221.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tangelder</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Veltkamp</surname> <given-names>RC</given-names></name>. <article-title>A survey of content based 3D shape retrieval methods</article-title>. <source>Multimed Tools Appl</source>. <year>2008</year>;<volume>39</volume>: <fpage>441</fpage>–<lpage>471</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref044"><label>44</label><mixed-citation publication-type="other" xlink:type="simple">Hilaga M, Shinagawa Y, Kohmura T, Kunii TL. Topology matching for fully automatic similarity estimation of 3D shapes. Proceedings of the 28th Annual Conference on Computer Graphics and Interactive Techniques. 2001. pp. 203–212.</mixed-citation></ref>
<ref id="pcbi.1006221.ref045"><label>45</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>McLachlan</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Basford</surname> <given-names>KE</given-names></name>. <source>Mixture Models: Inference and Applications to Clustering</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Wiley</publisher-name>; <year>1988</year>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref046"><label>46</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Titterington</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>AFM</given-names></name>, <name name-style="western"><surname>Makov</surname> <given-names>UE</given-names></name>. <source>Statistical Analysis of Finite Mixture Distributions</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>John Wiley and Sons</publisher-name>; <year>1985</year>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dempster</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Laird</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>J R Stat Soc Ser B</source>. <year>1977</year>;<volume>39</volume>: <fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwarz</surname> <given-names>G</given-names></name>. <article-title>Estimating the dimension of a model</article-title>. <source>Ann Stat</source>. <year>1978</year>;<volume>6</volume>: <fpage>461</fpage>–<lpage>464</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fraley</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Raftery</surname> <given-names>AE</given-names></name>. <article-title>Model-based clustering, discriminant analysis, and density estimation</article-title>. <source>J Am Stat Assoc</source>. <year>2002</year>;<volume>97</volume>: <fpage>611</fpage>–<lpage>631</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref050"><label>50</label><mixed-citation publication-type="other" xlink:type="simple">Cohen W. Fast effective rule induction. Proceedings of the Twelfth International Conference on Machine Learning. 1995. pp. 115–123.</mixed-citation></ref>
<ref id="pcbi.1006221.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chawla N</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Bowyer</surname> <given-names>KW</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>LO</given-names></name>, <name name-style="western"><surname>Kegelmeyer</surname> <given-names>WP</given-names></name>. <article-title>SMOTE: Synthetic minority over-sampling technique</article-title>. <source>J Artif Intell Res</source>. <year>2002</year>;<volume>16</volume>: <fpage>321</fpage>–<lpage>357</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hall</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Pfahringer</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Reutemann</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Witten</surname> <given-names>IH</given-names></name>. <article-title>The WEKA data mining software: An update</article-title>. <source>SIGKDD Explor</source>. <year>2009</year>;<volume>11</volume>: <fpage>10</fpage>–<lpage>18</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref053"><label>53</label><mixed-citation publication-type="other" xlink:type="simple">Abou-Moustafa, Ferrie FP. A note on metric properties of some divergence measures: The Gaussian case. Proceedings of Machine Learning Research. 2012. pp. 1–12.</mixed-citation></ref>
<ref id="pcbi.1006221.ref054"><label>54</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Torgerson</surname> <given-names>WS</given-names></name>. <source>Theory and Methods of Scaling</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>John Wiley and Sons</publisher-name>; <year>1958</year>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maitra</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Melnykov</surname> <given-names>V</given-names></name>. <article-title>Simulating data to study performance of finite mixture modeling and clustering algorithms</article-title>. <source>J Comput Graph Stat</source>. <year>2010</year>;<volume>19</volume>: <fpage>354</fpage>–<lpage>376</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Melnykov</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>W-C</given-names></name>, <name name-style="western"><surname>Maitra</surname> <given-names>R</given-names></name>. <article-title>MixSim: An R package for simulating data to study performance of clustering algorithms</article-title>. <source>J Stat Softw</source>. <year>2012</year>;<volume>51</volume>: <fpage>1</fpage>–<lpage>25</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006221.ref057"><label>57</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Loop</surname> <given-names>C</given-names></name>. <chapter-title>Smooth subdivision surfaces based on triangles</chapter-title> [Internet]. <publisher-name>Department of Mathematics, University of Utah.</publisher-name> <year>1987</year>. Available: <ext-link ext-link-type="uri" xlink:href="https://www.microsoft.com/en-us/research/publication/smooth-subdivision-surfaces-based-on-triangles/" xlink:type="simple">https://www.microsoft.com/en-us/research/publication/smooth-subdivision-surfaces-based-on-triangles/</ext-link></mixed-citation></ref>
<ref id="pcbi.1006221.ref058"><label>58</label><mixed-citation publication-type="book" xlink:type="simple">Kohavi R. A study of cross-validation and bootstrap for accuracy estimation and model selection. Proceedings of the 14th International Joint Conference on Artificial Intelligence. 1995. pp. 1137–1143.</mixed-citation></ref>
</ref-list>
</back>
</article>