<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">07-PLCB-RA-0662R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000077</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Sequence Motif Analysis</subject><subject>Mathematics/Statistics</subject><subject>Molecular Biology/Bioinformatics</subject></subj-group></article-categories><title-group><article-title>Measuring Global Credibility with Application to Local Sequence Alignment</article-title><alt-title alt-title-type="running-head">Global Credibility in Sequence Alignment</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Webb-Robertson</surname><given-names>Bobbie-Jo M.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>McCue</surname><given-names>Lee Ann</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Lawrence</surname><given-names>Charles E.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Computational Biology and Bioinformatics, Pacific Northwest National Laboratory, Richland, Washington, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Applied Mathematics and the Center of Computational Molecular Biology, Brown University, Providence, Rhode Island, United States of America</addr-line>       </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Rzhetsky</surname><given-names>Andrey</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of Chicago, United States of America</aff><author-notes><corresp id="cor1">* E-mail: <email xlink:type="simple">bj@pnl.gov</email></corresp><fn fn-type="con"><p>Conceived and designed the experiments: B-JMW-R CL. Performed the experiments: B-JMW-R. Analyzed the data: B-JMW-R LM CL. Contributed reagents/materials/analysis tools: LM. Wrote the paper: B-JMW-R LM CL.</p></fn><fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>5</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>16</day><month>5</month><year>2008</year></pub-date><volume>4</volume><issue>5</issue><elocation-id>e1000077</elocation-id><history><date date-type="received"><day>29</day><month>10</month><year>2007</year></date><date date-type="accepted"><day>31</day><month>3</month><year>2008</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder>Webb-Robertson et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Computational biology is replete with high-dimensional (high-D) discrete prediction and inference problems, including sequence alignment, RNA structure prediction, phylogenetic inference, motif finding, prediction of pathways, and model selection problems in statistical genetics. Even though prediction and inference in these settings are uncertain, little attention has been focused on the development of global measures of uncertainty. Regardless of the procedure employed to produce a prediction, when a procedure delivers a single answer, that answer is a point estimate selected from the solution ensemble, the set of all possible solutions. For high-D discrete space, these ensembles are immense, and thus there is considerable uncertainty. We recommend the use of Bayesian credibility limits to describe this uncertainty, where a (1−<italic>α</italic>)%, 0≤<italic>α</italic>≤1, credibility limit is the minimum Hamming distance radius of a hyper-sphere containing (1−<italic>α</italic>)% of the posterior distribution. Because sequence alignment is arguably the most extensively used procedure in computational biology, we employ it here to make these general concepts more concrete. The maximum similarity estimator (i.e., the alignment that maximizes the likelihood) and the centroid estimator (i.e., the alignment that minimizes the mean Hamming distance from the posterior weighted ensemble of alignments) are used to demonstrate the application of Bayesian credibility limits to alignment estimators. Application of Bayesian credibility limits to the alignment of 20 human/rodent orthologous sequence pairs and 125 orthologous sequence pairs from six <italic>Shewanella</italic> species shows that credibility limits of the alignments of promoter sequences of these species vary widely, and that centroid alignments dependably have tighter credibility limits than traditional maximum similarity alignments.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><p>Sequence alignment is the cornerstone capability used by a multitude of computational biology applications, such as phylogeny reconstruction and identification of common regulatory mechanisms. Sequence alignment methods typically seek a high-scoring alignment between a pair of sequences, and assign a statistical significance to this single alignment. However, because a single alignment of two (or more) sequences is a point estimate, it may not be representative of the entire set (ensemble) of possible alignments of those sequences; thus, there may be considerable uncertainty associated with any one alignment among an immense ensemble of possibilities. To address the uncertainty of a proposed alignment, we used a Bayesian probabilistic approach to assess an alignment's reliability in the context of the entire ensemble of possible alignments. Our approach performs a global assessment of the degree to which the members of the ensemble depart from a selected alignment, thereby determining a credibility limit. In an evaluation of the popular maximum similarity alignment and the centroid alignment (i.e., the alignment that is in the center of the posterior distribution of alignments), we find that the centroid yields tighter credibility limits (on average) than the maximum similarity alignment. Beyond the usual interest in putting error limits on point estimates, our findings of substantial variability in credibility limits of alignments argue for wider adoption of these limits, so the degree of error is delineated prior to the subsequent use of the alignments.</p></abstract><funding-group><funding-statement>The Pacific Northwest National Laboratory (PNNL) is a multiprogram national laboratory operated by Battelle for the U.S. Department of Energy (DOE) under contract DE-AC06-76RL01830. This work was supported by the DOE through the Laboratory Directed Research and Development program at PNNL, by DOE grant DE-FG02-04ER63942, by NIH grant R01HG01257, and by the Center for Computational Molecular Biology at Brown University.</funding-statement></funding-group><counts><page-count count="12"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>The study of genomics, and much of computational molecular biology, is about the inference or prediction of discrete, high-dimensional (high-D) unobserved variables, based on observed data. For example, in RNA secondary structure prediction, the challenge is to select a specific set of base pairs from a combinatorially large collection, as a prediction of the secondary structure of an RNA polymer, given its sequence. Similarly, in pathway inference, the challenge is to select a set of graph edges to connect genes or their products (nodes) from a combinatorially large collection of possible edge sets, based on gene expression or other data. Model selection problems for studying diseases stemming from mutlifactorial inheritance are becoming increasing common in the post-genome era. In these studies, the ultimate goal is to identify the combinations of genes responsible for inheritance components of disease etiology based on genetic and/or other post-genome data. In motif finding, the challenge is to select a single member of a large ensemble of possible combinations of motif sites in a set of sequences. Procedures that select the single best scoring solution, such as maximum similarity, maximum likelihood, maximum <italic>a-posteriori</italic> (MAP), or minimum free energy, dominate nearly all of these problems.</p><p>Sequence alignment is a typical example and is arguably the most important high-D discrete prediction problem for biology. Because it is the cornerstone capability used by a multitude of computational biology applications, we employ sequence alignment to make these general concepts concrete. Sequence alignment methods commonly focus on identifying the highest scoring alignment between two sequences, and assessing the statistical significance of this alignment <xref ref-type="bibr" rid="pcbi.1000077-Booth1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1000077-Yu1">[7]</xref>. Thus, alignment algorithms, heuristic <xref ref-type="bibr" rid="pcbi.1000077-Pearson1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1000077-Altschul1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1000077-Pearson2">[10]</xref> (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/BLAST/" xlink:type="simple">http://www.ncbi.nlm.nih.gov/BLAST/</ext-link>) and optimization <xref ref-type="bibr" rid="pcbi.1000077-Smith1">[11]</xref> (<ext-link ext-link-type="uri" xlink:href="http://fasta.bioch.virginia.edu/fasta_www2/" xlink:type="simple">http://fasta.bioch.virginia.edu/fasta_www2/</ext-link>) alike, typically report the selected alignment, and a statistical score that assesses how likely an alignment with a score as good or better could have emerged by chance, under a specified null distribution (commonly an <italic>E</italic>-value). While methods that assign the significance of alignments under a null distribution have been well studied, assessments of the uncertainty of a proposed alignment, defining the confidence in this alignment and assessing its overall reliability, have received considerably less attention.</p><p>Regardless of the alignment procedure employed, when a single alignment is chosen for the comparison of two (or more) sequences, it is a point estimate (or estimating alignment) selected from a large ensemble of all possible alignments. For example, two sequences of length <italic>m</italic> and <italic>n</italic> have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e001" xlink:type="simple"/></inline-formula> possible local alignments, where <italic>k</italic> represents the number of matches in the alignment <xref ref-type="bibr" rid="pcbi.1000077-Smith1">[11]</xref>,<xref ref-type="bibr" rid="pcbi.1000077-Waterman1">[12]</xref>. This number grows rapidly with the length of the sequences being aligned; for example, two small sequences of only length 20 generate over 10<sup>29</sup> possible local alignments. The question addressed here is: How, based on the available data, should we articulate the overall uncertainty of a selected estimating alignment (how well does it represent the large ensemble of possible solutions), and thus assess the reliability of this alignment?</p><p>The traditional approach to address the reliability of a single alignment is to evaluate the optimal alignment in the context of a set of near-optimal alignments. Near-optimal or suboptimal alignment analysis involves evaluating residue alignment consistency over the set of defined near-optimal alignments <xref ref-type="bibr" rid="pcbi.1000077-Waterman1">[12]</xref>–<xref ref-type="bibr" rid="pcbi.1000077-Schlosshauer1">[17]</xref>. Specifically, the reliability of an alignment position (<italic>i</italic>,<italic>j</italic>) is assessed by comparing the score of the optimal alignment to the score of this alignment under the constraint that positions <italic>i</italic> and <italic>j</italic> do not align <xref ref-type="bibr" rid="pcbi.1000077-Vingron1">[14]</xref>,<xref ref-type="bibr" rid="pcbi.1000077-Vingron2">[15]</xref>. More advanced methods have been proposed that determine reliability measures between residues aligned to both residues and gaps <xref ref-type="bibr" rid="pcbi.1000077-Schlosshauer1">[17]</xref>. An alternative to computing near-optimal alignments, involving a single model that assigns probabilities to a specific residue pair, such as a pair Hidden Markov Model <xref ref-type="bibr" rid="pcbi.1000077-Yu1">[7]</xref>,<xref ref-type="bibr" rid="pcbi.1000077-Yu2">[18]</xref>,<xref ref-type="bibr" rid="pcbi.1000077-Durbin1">[19]</xref>, can be derived and used to assess the reliability of individual aligned pairs.</p><p>With this in mind, these near-optimal alignment and model-based methods have offered significant improvements in reliability for tasks such as structural alignment. However, these methods are focused on delineating the reliability/uncertainty of the individual components of an estimated alignment, not the reliability of an estimated alignment in the context of the entire alignment space. There are methods to assess the accuracy of an alignment in the prediction of a ground-truth standard such as an alignment based on crystal structures <xref ref-type="bibr" rid="pcbi.1000077-Yu1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1000077-Yu2">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1000077-Chao1">[20]</xref>–<xref ref-type="bibr" rid="pcbi.1000077-Tress1">[22]</xref>. But our focus here is on assessment of the reliability of an alignment based on its own characteristics, rather than the assessment of its accuracy in predicting an established reference. Toward this end, we describe a procedure for global assessment of the degree to which the members of the ensemble may depart from a selected estimate.</p><p>The introduction of probabilistic alignment methods <xref ref-type="bibr" rid="pcbi.1000077-Liu1">[23]</xref>–<xref ref-type="bibr" rid="pcbi.1000077-Miyazawa1">[26]</xref> established the notion of sequence alignment as an inference procedure. For example, optimization-based alignment routines often search for the single alignment that is most probable among all those in the entire space of alignments. It is not surprising, given the immense size of the alignment space, that the most probable alignments, and thus all individual alignments, often have very small probabilities. This finding raises three questions:</p><list list-type="order"><list-item><p>In discrete spaces, how strongly does the available data recommend a single chosen estimate?</p></list-item><list-item><p>When the data provide weak evidence for any single estimate, what criteria can be used to judge the credibility of an estimate, and what are reasonable limits in the degree of variation within the ensemble from this estimate that are consistent with the data?</p></list-item><list-item><p>How can we identify the single estimate that best represents the ensemble of alignments and that is consistent with the data?</p></list-item></list><p>We suggest the following answers to these questions:</p><list list-type="order"><list-item><p>The strength of the recommendation of the data for any specific estimate is equal to its posterior probability under the assumed probabilistic model.</p></list-item><list-item><p>A credibility limit is the radius of the smallest hyper-sphere around a proposed estimate that contains a specified proportion of the probability mass of the posterior distribution, where the radius is measured by the number of elements by which two solutions differ. The size of this limit characterizes an estimate's credibility.</p></list-item><list-item><p>The estimate with the minimum credibility limit best represents the ensemble.</p></list-item></list><p>To address these questions and test our proposed answers, we employ a Bayesian probabilistic approach. In the <xref ref-type="sec" rid="s2">Methods</xref> section, we review some concepts on probabilistic alignments and distance measures, and then consider the distribution of the distances of the alignments in an ensemble from a proposed estimating alignment, including the quantiles and expected value of this distribution. We use the quantiles to identify credibility limits. The identification of credibility limits begs the question: What procedures can be developed to identify alignments with tight credibility limits? In an effort to achieve this goal, we employ statistical decision theory to find an estimation procedure that identifies the estimates with the minimum average distance from the posterior weighted ensemble; that is, the centroid. Centroid estimators, which were recently described by Carvalho and Lawrence <xref ref-type="bibr" rid="pcbi.1000077-Carvalho1">[27]</xref>, look promising to yield tight credibility limits because they minimize an average Hamming distance. Furthermore, we show that since popular procedures that select an estimate because it scores better than any other single solution (e.g., maximum likelihood, maximum similarity, maximum <italic>a-posteriori</italic> Viterbi solutions) are optimal under a zero/one-loss function, there is no principled reason to expect them to have tight credibility limits and, thus, to have high credibility. Below we compare the credibility limits for centroid alignments to those for maximum similarity alignments.</p></sec><sec id="s2"><title>Methods</title><p>A statistical model that yields a probability distribution over an ensemble of solutions is essential for the characterization of uncertainty. Specifically, we are interested in using the data, in combination with any parameters that have been specified, to assign “posterior” probabilities to the members of the ensemble. We call these posterior probabilities because they are assigned after considering the implications of the data, the posterior weighted ensemble. Because in high-D settings it is often impossible to characterize the entire immense ensemble of solutions, it is common practice to employ representative samples from the posterior distributions to draw inferences or make predictions <xref ref-type="bibr" rid="pcbi.1000077-Liu2">[28]</xref>.</p><sec id="s2a"><title>Probabilistic Alignment</title><p>A probabilistic alignment model from which samples can be drawn can be described as follows. An alignment describes a set of aligned residues and associated insertion and deletion events. For a pair of sequences, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e002" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e003" xlink:type="simple"/></inline-formula>, let <italic>A</italic> be a matrix that characterizes an alignment whose (<italic>i</italic>,<italic>j</italic>)-entry is defined as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e004" xlink:type="simple"/></disp-formula>Without loss of generality, let <italic>I</italic>≤<italic>J</italic>. Because a residue cannot align with more than one other residue, two constraints must be satisfied, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e005" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e006" xlink:type="simple"/></inline-formula>. In addition, the alignment co-linearity constraint requires that <italic>A<sub>i,j</sub></italic>+<italic>A<sub>k,l</sub></italic>≤1, <italic>i</italic>≤<italic>k</italic>, <italic>l</italic>≤<italic>j</italic>. Let Θ be a matrix of residue pair similarities, such as one of the BLOSUM <xref ref-type="bibr" rid="pcbi.1000077-Henikoff1">[29]</xref> or PAM <xref ref-type="bibr" rid="pcbi.1000077-Dayhoff1">[30]</xref> scoring matrices, and let Λ = (<italic>λ</italic><italic><sub>o</sub></italic>, <italic>λ</italic><italic><sub>e</sub></italic>) be the probability of opening and extending a gap, respectively.</p><p>Most sequence alignment methods optimize an objective function that can be described, based on a probabilistic model, as a log-likelihood <xref ref-type="bibr" rid="pcbi.1000077-Liu3">[31]</xref>,<xref ref-type="bibr" rid="pcbi.1000077-Pearson3">[32]</xref>. In traditional (frequentist) statistics, only the observed data, here <italic>R</italic><sup>(1)</sup> and <italic>R</italic><sup>(2)</sup>, are seen as random variables, and the remaining terms are deterministic variables with perhaps unknown values. In maximum likelihood estimation, the values of these unknowns, which maximize the likelihood, are the maximum likelihood estimates. Typically, the user must set specific parameter values for the scoring matrix Θ<sup>0</sup> and gap probabilities Λ<sup>0</sup> to find the most probable alignment <italic>A</italic>* over all possible alignments:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e007" xlink:type="simple"/><label>(1)</label></disp-formula>This alignment is guaranteed to be the alignment that has the largest probability over all possible alignments, and with appropriate re-parameterization, it can also be shown to be the maximum similarity (MS) alignment <xref ref-type="bibr" rid="pcbi.1000077-Durbin1">[19]</xref>.</p><p>To capture the entire alignment space in a probabilistic manner, the problem of alignment can be formulated as a Bayesian inference problem <xref ref-type="bibr" rid="pcbi.1000077-Durbin1">[19]</xref>,<xref ref-type="bibr" rid="pcbi.1000077-Liu1">[23]</xref>,<xref ref-type="bibr" rid="pcbi.1000077-Miyazawa1">[26]</xref>. The Bayesian Algorithm for Local Sequence Alignment (BALSA) <xref ref-type="bibr" rid="pcbi.1000077-Webb1">[24]</xref> describes such a probability model, the full joint distribution of all alignments, as the product of the likelihood and priors:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e008" xlink:type="simple"/></disp-formula>Recursion can be employed to marginalize (i.e., sum out) over all possible alignments to obtain the marginal probability of the data in the two sequences, given only the defined scoring matrix, Θ<sup>0</sup>, and gap penalties, Λ<sup>0</sup>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e009" xlink:type="simple"/></disp-formula>The required sums are completed in an analogous manner to the Smith-Waterman recursion by essentially replacing the maximum function with a summation. The alignment parameters Θ and Λ can also be defined as random variables and marginalized over using Markov chain Monte Carlo (MCMC) sampling methods. In this application, to mirror common alignment practice, a specific scoring matrix (PAM 110) and gap-penalty parameters (gap opening = −14 and gap extension = −2) were selected as generic parameters used by sequence alignment algorithms. Now the probability of any single alignment can be computed as a posterior probability using the following Bayes formula:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e010" xlink:type="simple"/><label>(2)</label></disp-formula>Equation 2 is a ratio of the likelihood of the data and the alignment <italic>A</italic>* to the sum of these joint likelihoods over all alignments. It approaches a value of 1 when a single alignment dominates all others.</p><p>Given that the number of possible alignments for even small biopolymer sequences is immense, it is not feasible to calculate the probability of all alignments in a brute force manner. However, we can almost always use the recursive relationships that are fundamental to dynamic programming (DP) to draw guaranteed representative samples from the solution ensemble <xref ref-type="bibr" rid="pcbi.1000077-Durbin1">[19]</xref>. Because of the power of the recursions, such sampling procedures require no burn-in period to ensure that the samples are drawn from the equilibrium distribution, and these samples are independent of one another. Briefly, these algorithms use modified versions of the two fundamental steps of DP: the forward and back-trace recursions. In DP, the forward recursion finds the optimal value of the objective function (e.g., the best total alignment score) by using optimal solutions of subproblems to recursively build up to the best total score. In the sampling algorithm, we instead use an analogous recursion to build up to the sum over the entire ensemble of solutions. This sum finds the normalizing constant that assures that probabilities sum to one. In the back-trace step, instead of finding the solution that yields the optimal value of the objective function, we use an analogous recursion to sample solutions in proportion to their posterior probabilities. An important unappreciated fact is that for large ensembles, the accuracy of estimates based on a sample depends on the sample size only, and not on the size of the population <xref ref-type="bibr" rid="pcbi.1000077-Liu1">[23]</xref>. Thus, a representative sample (i.e., a sample drawn in proportion to the probabilities of the unknowns) of even modest size, say 1000, can yield accurate estimates of unknowns, even if this sample is drawn from an ensemble of immense size. As we illustrate below, representative samples can be used to estimate credibility limits and define an ensemble centroid (EC) solution.</p></sec><sec id="s2b"><title>Credibility Limits and Means Distance</title><p>In this section, we describe procedures for finding credibility limits and mean distances for the sequence alignment problem. We begin by examining the distribution function of the distances of the ensemble members from a proposed estimate. Basic to this perspective are two concepts: 1) given the available data, the solution space is inherently uncertain; and 2) a proposed estimate is a point estimate (i.e., a single member of the ensemble) that is intended to represent the entire ensemble <xref ref-type="bibr" rid="pcbi.1000077-Carlin1">[33]</xref>.</p><p>A simple measure of the difference between two members of a discrete ensemble (e.g., two possible alignments of a pair of sequences) is the Hamming distance. For two alignments, <italic>A</italic><sup>(<italic>k</italic>)</sup> and <italic>A</italic><sup>(<italic>m</italic>)</sup>, of a pair of sequences, <italic>R</italic><sup>(1)</sup> and <italic>R</italic><sup>(2)</sup>, of length <italic>I</italic> and <italic>J</italic>, the Hamming distance is simply the number of aligned positions that differ between <italic>A</italic><sup>(<italic>k</italic>)</sup> and <italic>A</italic><sup>(<italic>m</italic>)</sup>, <italic>D</italic>(<italic>A</italic><sup>(<italic>k</italic>)</sup>, <italic>A</italic><sup>(<italic>m</italic>)</sup>). For alignments, this distance is simply the sum of the differences in two binary matrices of size (<italic>I</italic>×<italic>J</italic>). When ensemble members are binary objects, the Hamming distances are also equal to distances on other scales <xref ref-type="bibr" rid="pcbi.1000077-Holmes1">[34]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e011" xlink:type="simple"/><label>(3)</label></disp-formula>Using the metric in Equation 3, the distance between any proposed estimating alignment and the ensemble of alignments can be computed regardless of how one selects the estimating alignment. In this report, we compare the results of using two different estimating alignments: <italic>A<sup>M</sup></italic>, the MS alignment, and <italic>A<sup>C</sup></italic>, the EC alignment.</p><p>Specifically, let <italic>D<sub>i</sub></italic> = <italic>D</italic>(<italic>A<sub>i</sub></italic>, <italic>A<sup>x</sup></italic>) be the distance of the <italic>i</italic><sup>th</sup> member, <italic>A<sub>i</sub></italic>, of the ensemble from a proposed estimating alignment, <italic>A<sup>x</sup></italic>, where X is a categorical variable indicating the estimator (<italic>X</italic>∈[<italic>M</italic>, <italic>C</italic>]). We then rank the ensemble members by their distances from <italic>A<sup>x</sup></italic>, and let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e012" xlink:type="simple"/></inline-formula> be the order statistics of these distances (i.e., the distances of the ensemble members from the estimating alignment) with the indices permuted to reflect their order in the distance ranking <xref ref-type="bibr" rid="pcbi.1000077-Kendall1">[35]</xref>. The distribution function of the distances is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e013" xlink:type="simple"/><label>(4)</label></disp-formula>where <italic>d</italic><sub>(1−α)</sub> is the (1−<italic>α</italic>)<italic><sup>th</sup></italic> quantile. Now the credibility limit at (1−<italic>α</italic>) is <italic>d</italic><sub>(1−<italic>α</italic>)</sub>. While higher-order DP recursions can be used to obtain these limits, they can also be quite reasonably estimated from a representative sample of even modest size by the following algorithm <xref ref-type="bibr" rid="pcbi.1000077-Kendall1">[35]</xref>:</p><list list-type="order"><list-item><p>Draw a representative sample of size <italic>p</italic>, say <italic>p</italic> = 1000, elements by sampling from their posterior distribution, as illustrated for sequence alignment by Webb et al. <xref ref-type="bibr" rid="pcbi.1000077-Webb1">[24]</xref>.</p></list-item><list-item><p>Rank these alignments by their distance, <italic>D<sub>i</sub></italic> = <italic>D</italic>(<italic>A<sub>i</sub></italic>, <italic>A<sup>x</sup></italic>), from the estimate <italic>A<sup>x</sup></italic>.</p></list-item><list-item><p>Now <italic>d̂</italic><sub>(1−<italic>α</italic>)</sub>, the (1−<italic>α</italic>)<italic><sup>th</sup></italic> quantile in this sample is our estimator of <italic>d</italic><sub>(1−<italic>α</italic>)</sub>.</p></list-item></list><p>The expected value of <italic>D<sub>i</sub></italic> is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e014" xlink:type="simple"/><label>(5)</label></disp-formula>where <italic>A<sub>n,i,j</sub></italic> is 1 if <italic>i</italic> aligns with <italic>j</italic> in the <italic>n</italic><sup>th</sup> member of the sample, and zero otherwise; <italic>q<sub>i,j</sub></italic> is the marginal probability that <italic>A<sub>n,i,j</sub></italic> = 0; and <italic>p<sub>i,j</sub></italic> is the marginal probability that <italic>A<sub>n,i,j</sub></italic> = 1. The required marginal probabilities can be estimated based on a sample, or when DP is available, they can be obtained using the forward- and back-trace algorithm described by Durbin et al. <xref ref-type="bibr" rid="pcbi.1000077-Durbin1">[19]</xref>.</p></sec><sec id="s2c"><title>Normalized Credibility Limit</title><p>Hamming distances will, in general, be dependent on the lengths of the ensemble members. For example, in alignment, longer sequences will tend to return larger distances simply because the alignment matrix is larger. Thus, normalization is in order. For this normalization, we employ a normalization factor that uses maximum realized alignment lengths. Specifically, when calculating a credibility limit, the length of the estimating alignment (<italic>LE</italic>) is known, and the maximum length of an alignment in the ensemble is the length of the shorter of the two sequences (<italic>I</italic>). Thus, the maximum Hamming distances between an estimating alignment and the longest member of the ensemble is (<italic>LE</italic>+<italic>I</italic>). However, in our studies, we found that using this sum as a normalizing factor was misleading for cases in which the posterior space of alignments tended to be dominated by shorter local alignments. For example, the local alignments of the randomly shuffled sequences described in the <xref ref-type="sec" rid="s3">Results</xref> section (see <xref ref-type="fig" rid="pcbi-1000077-g001">Figure 1</xref>) were dominated by short alignments. As a result, using (<italic>LE</italic>+<italic>I</italic>) as the normalizing constant in this case produced normalized distances that were not close to one, even when there were no base pairs in common between a sampled alignment and the estimating alignment. To adjust these differences, we used the length of the longest sampled alignment, <italic>LS</italic>, as the second term in our normalizing sum, and the normalizing distance between the estimating alignment <italic>A<sup>x</sup></italic> and the <italic>i<sup>th</sup></italic> alignment in the sample is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000077.e015" xlink:type="simple"/></inline-formula> where <italic>S</italic> indicates the set of sampled alignments. Using this normalization factor yields normalizing distances with values between zero and one. A perfect match would yield an <italic>ND</italic> score of zero, and in the case where the longest sampled alignment has no base pairings in common with the estimating alignment, the <italic>ND</italic> score would be one. We define the credibility of the alignment at (1−α) to be <italic>ND</italic><sub>(1−<italic>α</italic>)</sub>.</p><fig id="pcbi-1000077-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000077.g001</object-id><label>Figure 1</label><caption><title>Plot of <italic>ND</italic><sub>95</sub> values for the EC versus the MS of 20 pairwise sequence alignments.</title><p>The <italic>ND</italic><sub>95</sub> values associated with the 20 highly conserved gene sequences are represented as green circles. The sequence alignments that represent alignment of random, un-related, sequences are represented as black triangles. In blue squares are the <italic>ND</italic><sub>95</sub> values for the intergenic sequences upstream of the coding genes. The four example alignment <italic>ND</italic> distributions displayed in <xref ref-type="fig" rid="pcbi-1000077-g002">Figure 2</xref> are indicated by a letter next to the corresponding square.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.g001" xlink:type="simple"/></fig></sec><sec id="s2d"><title>Centroid Alignment Estimators</title><p>Maximum similarity alignments, and the associated Viterbi alignments, have been the dominant alignment procedures for decades. In these procedures, an alignment output is typically the single alignment that has the maximum probability over all possible alignments. However, having the largest probability does not indicate that it represents the alignment space described by the billions (or more) possible alignments, except in the unusual event that this single alignment alone has high probability. In fact, the most probable alignment, the MS alignment, often has very small probability. For example, in this study, the probabilities of the MS alignments ranged from 10<sup>−37</sup> to 10<sup>−249</sup> for the alignments of the human/rodent pairs of gene and promoter sequences. Because it is the most probable alignment for a pair of sequences, all other alignments for that pair can be no more probable than the MS alignment. Thus, from a Bayesian prospective, any individual alignment represents the data only weakly at best.</p><p>As Carvalho and Lawrence <xref ref-type="bibr" rid="pcbi.1000077-Carvalho1">[27]</xref> point out, procedures that identify the single, highest scoring alignment are optimal under a zero/one loss function. Accordingly, after the highest scoring alignments have been identified, all other alignments have a penalty of one (i.e., are all equally unimportant); thus, if no single alignment has a high probability mass then the expected loss will be large. As a result, with zero/one loss there is no reason for the optimal alignment to be positioned near any other member of the ensemble of alignments, therefore failing to garner support from any other member of the ensemble.</p><p>In contrast, centroid alignments garner information from the complete ensemble of alignments, because these alignments minimize the expected Hamming distance from the complete posterior weighted ensemble of alignments. Centroid alignments correspond directly to the reliable alignments of Miyazawa with a cut off 0.5 <xref ref-type="bibr" rid="pcbi.1000077-Miyazawa1">[26]</xref>. Reliable alignments are further described by Durbin et al. <xref ref-type="bibr" rid="pcbi.1000077-Durbin1">[19]</xref> and are elaborated on by Holmes and Durbin <xref ref-type="bibr" rid="pcbi.1000077-Holmes1">[34]</xref>. Furthermore, because these alignments minimize the average Hamming distance, we expect that they may yield tighter credibility limits than MS alignments. The alignment that is the centroid of the entire ensemble of alignments is called the EC alignment. These alignments meet the exclusive pairing and colinearity constraints of the alignment problem, but they do not necessarily meet the common requirement that a gap in one sequence cannot be followed by a gap in the other sequence. We compare the credibility limits of MS alignments and EC alignments below.</p></sec></sec><sec id="s3"><title>Results</title><p>To assess the credibility measures and estimators described above, we examine the local alignments of sequences from (1) 20 orthologous genes between human and rodent, and (2) 24 orthologous genes between six species of <italic>Shewanella</italic>. All sequence pairs were evaluated using BALSA <xref ref-type="bibr" rid="pcbi.1000077-Webb1">[24]</xref> with a PAM 110 scoring matrix, gap penalties of −14 and −2 for opening and extending a gap, respectively, and a sample size of 1000 to compute the estimated alignment distributions, credibility limits, and EC alignments.</p><sec id="s3a"><title>Credibility Limits for Human/Rodent Pairs</title><p>The 20 orthologous genes for human/rodent are specifically up-regulated in human skeletal muscle tissue, and their upstream sequences have been used in previous studies to locate <italic>cis</italic>-regulatory modules <xref ref-type="bibr" rid="pcbi.1000077-Thompson1">[36]</xref>. The coding regions of the 20 human/rodent orthologous gene pairs were evaluated, as were the 20 sequence pairs that represent up to 3 kb of sequence upstream of the orthologous gene pairs. All sequence pairs were masked using RepeatMasker (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org/" xlink:type="simple">http://www.repeatmasker.org/</ext-link>). For the local alignments of the 20 gene pairs and the 20 intergenic regions, we examined the credibility limits associated with two estimating alignments: the MS, and the EC. Specifically, we examined the 95% quantiles of the normalized distances (<italic>ND</italic>), computed based on the distances between these estimating alignments from the 1000 sampled alignments from the posterior alignment distribution. <xref ref-type="fig" rid="pcbi-1000077-g001">Figure 1</xref> shows a scatter plot of the MS 95% credibility limits (MS <italic>ND</italic><sub>95</sub>) versus the EC 95% credibility limits (EC <italic>ND</italic><sub>95</sub>) for the local alignments of the genes and the intergenic regions. For contrast, the genes were randomly shuffled, and 95% credibility limits were defined for these non-related sequence pair alignments.</p><p>First, notice that the credibility limits for the gene sequence alignments are small, and the difference between the EC and MS is negligible. These genes are so highly conserved that the majority of the posterior distribution falls along a small set of paths with high probability, thus creating high correlation between the EC and MS. Alternatively, when the gene sequences are shuffled, the hyper-sphere surrounding 95% of the posterior distribution is very large because the probability of aligning any two residues is essentially random. This results in extremely large credibility limits with high deviation in the distance of the ensemble from the EC and MS. The intergenic regions are less conserved than the genes and, thus, are intermediate between these two extremes. Notice that the credibility limits are often surprisingly large, with normalized distances over 50% for 18 of the 20 MS alignments, and for 17 of the 20 EC alignments. This indicates that we have confidence in less than half the predicted aligned base pairs. As the plot shows, there is considerable variation in the credibility limits over the 20 examples when either the EC or MS limit is used. The credibility limits for the EC range from 29% of maximal to nearly 91%, while the MS limits range from 37% to almost 100% of maximal. This result highlights the need to report credibility limits for every sequence pair. We also see that for all but one of the sequence pairs, the MS credibility limits are greater than those for the EC. Furthermore, for 11 of the 20 upstream sequence pairs, the MS credibility limits were more than 600 base pairs larger than EC credibility limits. Thus while the differences in <xref ref-type="fig" rid="pcbi-1000077-g001">Figure 1</xref> look modest, the MS credibility limits are often hundreds of base pairs larger than those of the EC estimators.</p><p>Taken together, the differences between the 20 MS normalized distances and 20 EC normalized distances in <xref ref-type="fig" rid="pcbi-1000077-g001">Figure 1</xref> are significantly different (i.e., p&lt;0.001, Wilcoxon Signed Rank test <xref ref-type="bibr" rid="pcbi.1000077-Ott1">[37]</xref>). To offer further insight, we chose four alignments from the 20 to examine in more detail (<xref ref-type="table" rid="pcbi-1000077-t001">Table 1</xref>); the results for all 20 pairs are in <xref ref-type="supplementary-material" rid="pcbi.1000077.s001">Table S1</xref>. In <xref ref-type="fig" rid="pcbi-1000077-g002">Figure 2</xref>, we show histograms of the distance of the 1000 sampled alignments from the two estimating alignments (MS, EC); in addition, the 95% quantile (<italic>ND</italic><sub>95</sub>) for the EC and MS are shown as bars, and the values are given in <xref ref-type="table" rid="pcbi-1000077-t001">Table 1</xref>. As <xref ref-type="fig" rid="pcbi-1000077-g001">Figure 1</xref> indicates, pair (A) has the tightest credibility limits of all the promoter sequences. These tighter limits are a reflection of the fact that the ensemble of alignments is relatively close to the estimators; the 95<sup>th</sup> percentile alignment differs from the EC estimator by 270 of a possible 1556 base pairs that could potentially differ (<italic>ND</italic><sub>95</sub> = 0.29), while the MS is about 20% larger with an <italic>ND</italic><sub>95</sub> = 0.37. Of the 20 promoter sequence pairs, there are 11 in which the two credibility limits are markedly different (i.e., by more than 0.05). <xref ref-type="fig" rid="pcbi-1000077-g002">Figure 2D</xref> is another illustration of the characteristics of these 11 pairs for which the MS credibility limits are substantially larger than those of the EC, although for pair (D) the distance distributions have very little overlap, as well as large credibility limits. <xref ref-type="fig" rid="pcbi-1000077-g002">Figure 2C</xref> is representative of the remaining nine pairs, in which the posterior surface is quite flat, and the two credibility limits differ by less than 0.05. For the sequence pair shown in <xref ref-type="fig" rid="pcbi-1000077-g002">Figure 2C</xref>, the credibility limits for both estimators are large. Because the EC alignment is the nearest alignment to the mean <xref ref-type="bibr" rid="pcbi.1000077-Holmes1">[34]</xref>, the large size of this limit for the EC alignment indicates that the alignments in the posterior distribution are widely dispersed over the ensemble. Also notice that in (B) and (C), the two distributions overlap substantially and have high <italic>ND</italic><sub>95</sub> values; for example, the alignment in <xref ref-type="fig" rid="pcbi-1000077-g002">Figure 2B</xref> shows a <italic>ND</italic><sub>95</sub> = 0.72 for the EC, and <italic>ND</italic><sub>95</sub> = 0.77 for the MS alignment. Because the centroid estimator is the closest feasible alignment to the mean, for this sequence pair the mean and the mode are close, as is typical of symmetric distributions <xref ref-type="bibr" rid="pcbi.1000077-Carvalho1">[27]</xref>.</p><table-wrap id="pcbi-1000077-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000077.t001</object-id><label>Table 1</label><caption><title>Gene, <italic>ND</italic><sub>95</sub>, P-Quantile information on examples highlighted in <xref ref-type="fig" rid="pcbi-1000077-g001">Figures 1</xref> and <xref ref-type="fig" rid="pcbi-1000077-g002">2</xref>.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000077-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="2" rowspan="1">RefSeq Gene Identifier</td><td align="left" colspan="2" rowspan="1"><italic>ND</italic><sub>95</sub></td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Human</td><td align="left" colspan="1" rowspan="1">Rodent</td><td align="left" colspan="1" rowspan="1">EC</td><td align="left" colspan="1" rowspan="1">MS</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">(A)</td><td align="left" colspan="1" rowspan="1">NM_001885.1</td><td align="left" colspan="1" rowspan="1">NM_012935.2</td><td align="left" colspan="1" rowspan="1">0.291</td><td align="left" colspan="1" rowspan="1">0.373</td></tr><tr><td align="left" colspan="1" rowspan="1">(B)</td><td align="left" colspan="1" rowspan="1">NM_000080.2</td><td align="left" colspan="1" rowspan="1">NM_009603.1</td><td align="left" colspan="1" rowspan="1">0.716</td><td align="left" colspan="1" rowspan="1">0.773</td></tr><tr><td align="left" colspan="1" rowspan="1">(C)</td><td align="left" colspan="1" rowspan="1">NM_001042.2</td><td align="left" colspan="1" rowspan="1">NM_012751.1</td><td align="left" colspan="1" rowspan="1">0.587</td><td align="left" colspan="1" rowspan="1">0.647</td></tr><tr><td align="left" colspan="1" rowspan="1">(D)</td><td align="left" colspan="1" rowspan="1">NM_003186.3</td><td align="left" colspan="1" rowspan="1">NM_011526.4</td><td align="left" colspan="1" rowspan="1">0.674</td><td align="left" colspan="1" rowspan="1">0.771</td></tr></tbody></table></alternatives></table-wrap><fig id="pcbi-1000077-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000077.g002</object-id><label>Figure 2</label><caption><title>Histograms of the distances of the sampled alignments from the EC and MS.</title><p>In (A) the centroid and optimal alignments are similar and represent the distribution well, but in (B) and (C), despite a similar centroid and optimal alignment, neither represent the overall alignment distribution. In (D) it is observed that the centroid and optimal deviate significantly from each other, and that the centroid is a much better representation of the alignment space.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.g002" xlink:type="simple"/></fig></sec><sec id="s3b"><title>Credibility Limits for <italic>Shewanella</italic></title><p>We also examined the credibility limits for the MS and EC estimators for local alignments of orthologous pairs of intergenic regions (up to 500 bp upstream of orthologous genes) from six species of <italic>Shewanella</italic> for which full genome sequence data are available: 1) <italic>S. denitrificans</italic> OS217 (DENI), 2) <italic>S. loihica</italic> PV-4 (SPV4), 3) <italic>S. oneidensis</italic> MR-1 (SONE), 4) <italic>S. putrefaciens</italic> CN-32 (CN32), 5) <italic>Shewanella</italic> sp. MR-4 (SMR4), and 6) <italic>Shewanella</italic> sp. MR-7 (SMR7). We chose SMR4 as our base species, aligning orthologous sequences from each of the other five to the region from SMR4. Starting with SMR4, the species in order of increasing evolutionary distance are SMR4&gt;SMR7&gt;SONE&gt;CN32&gt;SPV4∼DENI. As before, we examined the 95% quantiles of the normalized distances, computed based on the distances between the estimating alignments and the sampled ensemble of alignments drawn from the posterior alignment distribution. <xref ref-type="fig" rid="pcbi-1000077-g003">Figure 3</xref> shows a scatter plot of the MS <italic>ND</italic><sub>95</sub> versus the EC <italic>ND</italic><sub>95</sub> values for each of 24 randomly selected orthologous regions, for the pairwise comparison of SMR4 to each of the five species at varying evolutionary distances (120 total comparisons).</p><fig id="pcbi-1000077-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000077.g003</object-id><label>Figure 3</label><caption><title>Plot of <italic>ND</italic><sub>95</sub> values for the EC versus the MS of 120 pairwise sequence alignments (24 comparisons for each of the five species in the legend to SMR4).</title><p>The four example alignment <italic>ND</italic> distributions displayed in <xref ref-type="fig" rid="pcbi-1000077-g004">Figure 4</xref> are indicated by a letter next to the corresponding symbol.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.g003" xlink:type="simple"/></fig><p>The two species SMR4 and SMR7 are very closely related, having been isolated from samples taken at different depths (5 m and 60 m, respectively) from a single location (latitude and longitude) in the Black Sea <xref ref-type="bibr" rid="pcbi.1000077-Perry1">[38]</xref>. Thus, it is not surprising that even the intergenic regions are highly conserved and that the EC and MS exhibit tight credibility limits. Among the comparisons to species at increasing evolutionary distance, we observe increasing credibility limits. In fact, for many of the SMR4-DENI sequence pairs, the credibility limits are no better than expected for randomly shuffled sequence. While, on average, the credibility limits of a pair of species increase with increasing evolutionary distance, the figure also shows that the credibility limits of the alignments for a given pair of species vary greatly. For example, even though the credibility limits of most SMR4-DENI pairs are large (&gt;0.8), there are sequence pairs from these two species that have credibility limits &lt;0.3. The fact that there is wide variability in credibility limits for all of these pairs of species, except SMR4-SMR7, highlights the importance of assessing the reliability (credibility limits) of nearly all alignments. For example, there is a pair of SMR4-CN32 sequences whose alignment is very reliable (EC <italic>ND</italic><sub>95</sub> and MS <italic>ND</italic><sub>95</sub>&lt;0.05), but there are also three pairs whose alignments cannot be trusted (EC <italic>ND</italic><sub>95</sub> and MS <italic>ND</italic><sub>95</sub>&gt;0.6), and the remainder are scattered over the full range in between.</p><p>We further evaluated the findings shown in <xref ref-type="fig" rid="pcbi-1000077-g003">Figure 3</xref> in the context of a single gene's orthologous upstream sequences. Often in evaluating promoter sequences across species it is unknown <italic>a priori</italic> which sequences it would be most beneficial to align. The tight credibility limits shown in <xref ref-type="fig" rid="pcbi-1000077-g004">Figure 4A and 4B</xref> indicate that when evaluating the promoter region of SMR4_0576, we would have confidence in the alignments with the orthologous region from SONE and CN32 (also with SRM7, data not shown). This is not the case for the orthologous regions from SPV4 and DENI. The high <italic>ND</italic><sub>95</sub> values for the EC and MS alignments indicate that alignment of SPV4 or DENI sequences would not contribute to a meaningful evaluation of the SMR4_0576 promoter region. Unfortunately, not all alignments of promoter regions from SMR4 with the promoter sequences of orthologous genes in SONE and CN32 are reliable. For example, as <xref ref-type="fig" rid="pcbi-1000077-g005">Figure 5</xref> shows, the posterior distribution of the alignments of the SMR4_ 1557 promoter region with its CN32 ortholog is substantially more widespread and variable than the posterior distribution of alignments for the promoter region of SMR4_0576 with its orthologous region in CN32.</p><fig id="pcbi-1000077-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000077.g004</object-id><label>Figure 4</label><caption><title>Histograms of the distances of the sampled alignments from the EC and MS for the intergenic regions upstream of the gene SMR4_0576.</title><p>SMR4_0576 alignment distribution with its orthologous sequence from (A) SONE, (B) CN32, (C) SPV4, and (D) DENI.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.g004" xlink:type="simple"/></fig><fig id="pcbi-1000077-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000077.g005</object-id><label>Figure 5</label><caption><title>Histograms of the distances of the sampled alignments from the EC and MS for the intergenic regions upstream of orthologous genes from SMR4 and CN32.</title><p>(A) Alignment distribution for the regions upstream of the orthologous genes SMR4_0576 and CN32_3301 and (B) alignment distribution for the orthologous regions upstream of the arginine decarboxylase (speA) genes SMR4_1557 and CN32_1647.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.g005" xlink:type="simple"/></fig><p>These findings of large differences in the reliability of alignments within species pairs have had a substantial practical impact on our studies of phylogenetic motif finding using these <italic>Shewanella</italic> species. Specifically, alignment of orthologous promoters can substantially increase the power of motif finding, if the alignments can be trusted. However, the findings shown in <xref ref-type="fig" rid="pcbi-1000077-g005">Figure 5</xref> indicate that reliance on a single genome-wide measure of species distances is very frequently insufficient to assure that alignments of promoters from species pairs can be trusted. Thus, we are using credibility limits on a gene-by-gene and species-by-species basis to make decisions about which alignments can be trusted.</p></sec><sec id="s3c"><title>Centroid Alignment Heat Map</title><p>The use of heat maps or other means to visually illustrate confidence in the individual alignment of individual pairs of bases must accommodate a different feature for centroid alignments. Specifically, EC alignments have a feature not present in standard alignments, in that they allow stretches of sequence in the middle of an alignment to remain unaligned in a manner analogous to those regions at the ends of local alignments. That is, a residue in one sequence that cannot be <italic>reliably</italic> aligned with any single residue in the other sequence is excluded from the centroid alignment. Aligning any such residues to any bases in the other sequence would only increase the average distance of the centroid alignment from the posterior distribution of alignments. In addition, with probabilistic alignment, we return marginal probabilities of all residue pairs. Therefore, to display all the features of this alignment, we employ 1) a traditional dash to represent gaps, 2) a dot to represent residues that cannot be reliably aligned and are thus ignored in the alignment, and 3) a gradient color scheme (i.e., a heat map) to show the base pair alignment probabilities, where red indicates high probability for that residue pair, green indicates probabilities nearing 50%, and the ignored region is grayed out to further differentiate those residues for which the variability in alignments is too great to permit marginal pair probabilities of 0.5 or greater. <xref ref-type="fig" rid="pcbi-1000077-g006">Figure 6</xref> gives an example of the heat map alignment display for a human/rodent intergenic sequence pair (the region upstream of the MYL2 gene). The red-to-green coloring of aligned regions allows quick distinction of areas of alignment of high versus low confidence.</p><fig id="pcbi-1000077-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000077.g006</object-id><label>Figure 6</label><caption><title>Heat-map alignment representation of the EC.</title><p>Sequence indices are given on the left and the color gradient associated with aligned residue probabilities is given on the right. Sequence regions that have no aligned pairs with a probability greater than 0.5 are ignored by the alignment, grayed out, and aligned with a dot to differentiate these from insertion/deletion events that utilize a dash.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.g006" xlink:type="simple"/></fig></sec></sec><sec id="s4"><title>Discussion</title><p>Because prediction and estimation involve making inferences about unknown quantities based on the available data, they are inevitably uncertain. Thus, when a specific value is reported as a point estimate, it is common in many fields to simultaneously report a confidence limit or a credibility limit, which is the Bayesian analog. Such limits are all too often absent in computational biology. Here, to promote their broader adoption, we describe a method for estimating credibility limits and illustrate these concepts using sequence alignment. These credibility limits are derived from the empirical distribution function of the Hamming distance from the estimator to the members of the ensemble of solutions, or more accurately, a representative sample of the ensemble of solutions. The 95% credibility limit of a proposed estimate describes the posterior distribution by indicating the normalized Hamming distance containing 95% of the probability mass of the posterior distribution. The existence of these limits begs the question: What estimation procedure will yield tight credibility limits? We advocate the use of recently developed centroid estimators that minimize the expected Hamming distance to address this question.</p><p>While it is reasonable to expect centroid estimators to produce tighter credibility limits, it is not a guaranteed product of this procedure, because the centroid is the estimator that minimizes the average differences from the posterior ensemble, while the credibility limits are based on a quantile. Nevertheless, our finding of tighter credibility limits for EC alignments compared to MS alignments should come as no surprise, since the well-known zero/one loss risk associated with the latter estimators provides no principled reason to expect that such estimators will be near the center of the posterior distribution of alignments. On the other hand, centroid alignments, which are the alignment nearest to the multivariate mean of the posterior distribution, are centered in the posterior distribution <xref ref-type="bibr" rid="pcbi.1000077-Carvalho1">[27]</xref>.</p><sec id="s4a"><title>Performance</title><p>Our findings of 1) high variability in the credibility limits in the alignments of promoter sequences of 20 human/rodent sequence pairs and 2) similar high variability among 4 of the 5 pairs of <italic>Shewanella</italic> species highlight the need for assessing the overall reliability of sequence alignments. Without such limits, there is little to distinguish alignments that vary greatly from one another in their reliability. Furthermore, our findings indicate that centroid estimators have promising potential to improve sequence alignment. For example, for over half of the human/rodent non-coding sequence pairs (each of ∼3000 bases) in our sample, the EC and MS alignments differ by more than 600 base pairs, and similar relative differences are observed in <italic>Shewanella</italic> alignments. While we report here on the credibility of nucleotide sequence alignments, they are equally applicable and valuable for protein sequence alignments.</p><p>In some discrete high-D inference problems, the posterior ensemble of solutions may not only be asymmetric, but also it may be multimodal, as has been reported for RNA secondary structures <xref ref-type="bibr" rid="pcbi.1000077-Ding1">[39]</xref>. Since, in such a case no single point estimate can reasonably represent the posterior ensemble, class-specific estimates, with one for each distinct class, will be required. In these cases, samples associated with each class can be used to find credibility limits for the class estimates, and the overall credibility limits around these class-specific estimates can be identified based on distances to the nearest class estimate.</p><p>As mentioned above, the probabilistic model used is a Smith-Waterman recursive DP algorithm whose Viterbi alignment corresponded exactly to the MS alignment reported here. Thus, differences in credibility limits reported here are solely the result of the differences in the estimation procedures. In addition, the alignment that minimizes expected Hamming distance loss and also follows the requirement concerning adjacent gaps in the two sequences are available using a DP algorithm <xref ref-type="bibr" rid="pcbi.1000077-Durbin1">[19]</xref>,<xref ref-type="bibr" rid="pcbi.1000077-Holmes1">[34]</xref>. However this alignment can only increase the average Hamming distance above that of the centroid.</p><p>While we believe this evidence supports reconsideration of the maximum scoring alignment paradigm, stronger evidence for reconsideration has been in the literature for over a decade. In 1995, Miyazawa <xref ref-type="bibr" rid="pcbi.1000077-Miyazawa1">[26]</xref> was the first to report what we now call centroid alignments <xref ref-type="bibr" rid="pcbi.1000077-Carvalho1">[27]</xref>. In addition to his very insightful development of reliable alignments, he showed that these alignments are superior, using x-ray crystal structures of proteins as ground truth. <xref ref-type="fig" rid="pcbi-1000077-g007">Figure 7</xref> (reproduced from Miyazawa's work <xref ref-type="bibr" rid="pcbi.1000077-Miyazawa1">[26]</xref>, with permission of the author and Oxford Journals) shows that structural predictions based on reliable (centroid) alignments quite consistently produce lower root mean squared deviations than those based on maximum similarity alignments. Thus, from a practical biological prospective, there is already clear evidence in the literature that centroid alignments can be applied with advantage in the prediction of protein structures.</p><fig id="pcbi-1000077-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000077.g007</object-id><label>Figure 7</label><caption><title>Root mean squared (r.m.s) deviation between the EC and MS for X-ray crystal structure data <xref ref-type="bibr" rid="pcbi.1000077-Miyazawa1">[26]</xref>.</title><p>This scatter plot demonstrates that probability-based alignments (e.g., EC) typically have higher similarity with structural alignments than MS alignments.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.g007" xlink:type="simple"/></fig></sec><sec id="s4b"><title>Time Complexity</title><p>We also note that the time complexity of algorithms for obtaining centroid alignments and credibility limits is not different from those of more traditional optimization based methods. When recursions can be employed to obtain optimal solutions via DP, analogous recursions are frequently available for associated probabilistic models, and stochastic back-trace procedures can be employed to draw samples from the posterior ensemble of solutions <xref ref-type="bibr" rid="pcbi.1000077-Durbin1">[19]</xref>. In general, the time complexity for drawing these samples will be the same as that of the associated DP algorithm, and is set by the forward step of these algorithms. For example, in local sequence alignment, the most computationally intensive step is the forward-recursive step. For two sequences of length <italic>n</italic> and <italic>m</italic>, the time complexity is <italic>O</italic>(<italic>n</italic>*<italic>m</italic>) for both the optimization and Bayesian algorithms. Running times to obtain credibility limits in a recursive setting will generally be longer than times required to obtain optimal estimates because a back-trace step must be executed only once to obtain the optimal, while it must be employed multiple times to draw samples. However, this sampling will not generally greatly increase overall running times, because back-trace recursions are usually of a lower time complexity than their forward steps. For example, for local alignments the time complexity of the back-trace recursions is only <italic>O</italic>(min(<italic>n</italic>,<italic>m</italic>)). For problems not open to recursive solutions, MCMC algorithms are commonly employed, using procedures like simulated annealing. Credibility limits and centroids also can be obtained using MCMC sampling with run times that may be less than those for optimizations <xref ref-type="bibr" rid="pcbi.1000077-Carvalho1">[27]</xref>.</p></sec><sec id="s4c"><title>Caveats</title><p>Some caveats are appropriate. In settings in which uncertainty is low, such as shown for the alignments of coding regions of human/rodent sequence pairs in <xref ref-type="fig" rid="pcbi-1000077-g001">Figure 1</xref> and the promoter sequence pairs of very closely related species like <italic>Shewanella</italic> sp. MR-4 and MR-7 in <xref ref-type="fig" rid="pcbi-1000077-g003">Figure 3</xref>, credibility limits will likely be tight and not vary greatly among examples. Nevertheless, it would be reassuring to document this low variability by reporting credibility limits. While we have given principled arguments supporting our belief that centroid solutions should dependably have tighter credibility limits than optimization estimators, this advantage cannot be guaranteed. However, this trend was observed in both the human/rodent pairs and the <italic>Shewanella</italic> pairs. In our on-going work with <italic>Shewanella</italic>, we have found 1329 orthologous genes that were present in all six species and computed the 95% credibility limits for both the MS and EC, for all the promoters from SMR4 aligned with the orthologous sequences from each of the remaining 5 strains. The EC <italic>ND</italic><sub>95</sub> credibility limits were smaller than the MS <italic>ND</italic><sub>95</sub> limits in 6078 (91.55%) of these 6645 sequence pairs (i.e., p&lt;1e-100, Wilcoxon Signed Rank test <xref ref-type="bibr" rid="pcbi.1000077-Ott1">[37]</xref>).</p><p>In our comparison of centroid alignments to MS alignments, we focused on the alignment of individual pairs of sequences. However, we did not address how these two estimators would compare if we had available multiple pairs of sequences all drawn from a model with a single common “true” alignment. In the context of sequence alignment, such a situation would not be observed in nature because we know of no families of biological sequence pairs for which one can be confident that sequence pairs within this family all follow the same “true” alignment. For example, even for sequence pairs drawn from orthologous regions from clearly related species, alignments are likely to differ. This same absence of replicates, all of which are sampled from the same “true” value of the unknown, is expected for many, but not necessarily all, high-D discrete biological inference problems. Even when obtaining a large number of such biological replicates is possible in principle, such as a large number of biological replicates in a microarray study, obtaining them in practice is often prohibitively expensive. However, with advances in technology, this limitation may be overcome. When a substantial number of such replicate observations are available, the asymptotic properties of maximum likelihood estimates, such as consistency and asymptotic unbiasedness, can be brought to bare. In such cases, as sample size increases, the MS estimator will approach the true value, and the bias will tend toward zero. This reduction in bias might well counter-balance the higher variability (high credibility limits) reported here for individual sequence pairs.</p><p>The findings reported in this paper are for pairwise alignments. When multiple alignments are employed, we expect credibility limits to narrow because of the increased size of the data sets; however, we caution that the alignment space grows rapidly with increasing sequences in an alignment. Therefore, these limits may or may not shrink as quickly as expected. Furthermore, it is important to keep in mind that the credibility limits reported here are sampling estimates of true 95% quantiles, but with samples of 1000 the error bars on these estimates are 95%±1.35%. All the estimates in this work are based on a local probabilistic alignment model. While local alignment is the most common procedure, other probabilistic alignment procedures, or local alignments with other parameter settings <xref ref-type="bibr" rid="pcbi.1000077-Zhu1">[25]</xref>,<xref ref-type="bibr" rid="pcbi.1000077-Miyazawa1">[26]</xref>, may give varying results. As is common practice, all alignments here are given for a fixed set of parameters. Alignment parameters also can be estimated from the data; perhaps with such an approach, credibility limits could be smaller and more consistent, although this may not be the case because uncertainty of the parameter estimates would be introduced into the procedure.</p></sec><sec id="s4d"><title>Conclusions</title><p>Beyond the usual interest in putting error limits on point estimates, our findings of substantial variability in credibility limits of alignments argues for wider adoption of these limits, so that the degree of error is delineated prior to the subsequent use of the alignments. From a practical prospective, when credibility alignments are tight, those using these alignments in subsequent procedures can be confident in the input alignments and know the limited degree to which input alignment may vary. The absence of such limits may well lead to a false sense of confidence in subsequent findings, especially when credibility limits are wide, and/or seriously limit an investigator's ability to determine the source of difficulties or inconsistencies in subsequent procedures that depend on these unreliable alignments. In practice, knowing early in a study that alignments required for subsequent results are unreliable (i.e., have high credibility limits) might well lead an investigator to reconsider his/her plans. For example, in studies of phylogenetic tree reconstruction when it is known that input alignments are reliable, investigators' conclusions about phylogenetic relationships will be bolstered; whereas, prior knowledge that input alignments are unreliable will motivate serious investigators to revise their study design or, after the fact, permit reviewers to raise legitimate questions about the studies conclusions.</p><p>While the results presented here concern only sequence alignment, the procedures described are generally applicable to point estimates for high-D discrete spaces; this includes many major inference problems in computational biology, such as pathway prediction in systems biology, the prediction of phylogenetic trees, the reconstruction of ancestral states, the delineation of alternate splice forms, and prediction of RNA secondary structures. For any of these problems, the algorithm given in the <xref ref-type="sec" rid="s2">Methods</xref> section “Credibility limits and means distance” can be employed to obtain <italic>ND</italic><sub>95</sub> values for any proposed estimate given a procedure for drawing samples from the posterior distribution. We caution that while the Hamming distance will be appropriate in many of these areas, it may not be as appropriate in some of these settings. Regardless of the distance measure used, the proposed procedure will return credibility limits for an estimator when a representative sample can be obtained. We believe the use of confidence or credibility limits is long overdue throughout the full spectrum of discrete high-D inference problems encountered in computational biology. These limits have a number of valuable uses, including gauging the degree by which solutions might depart from their estimated value, appraising the overall credibility of a prediction, and comparing the performance of alternative estimators in cases where a “gold standard” is not available.</p></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi.1000077.s001" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000077.s001" xlink:type="simple"><label>Table S1</label><caption><p>Gene, ND95, and P-Quantile information on all 20 sequence pairs.</p><p>(0.04 MB DOC)</p></caption></supplementary-material></sec></body><back><ack><p>We acknowledge the useful feedback of Luis Carvalho of Brown University and Katrina Waters at Pacific Northwest National Laboratory. We also thank Dr. Sanzo Miyazawa of Gunma University in Kirya Japan for supplying <xref ref-type="fig" rid="pcbi-1000077-g007">Figure 7</xref> from his previous work.</p></ack><ref-list><title>References</title><ref id="pcbi.1000077-Booth1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Booth</surname><given-names>HS</given-names></name><name name-style="western"><surname>Maindonald</surname><given-names>JH</given-names></name><name name-style="western"><surname>Wilson</surname><given-names>SR</given-names></name><name name-style="western"><surname>Gready</surname><given-names>JE</given-names></name></person-group>             <year>2004</year>             <article-title>An efficient Z-score algorithm for assessing sequence alignments.</article-title>             <source>J Comput Biol</source>             <volume>11</volume>             <fpage>616</fpage>             <lpage>625</lpage>          </element-citation></ref><ref id="pcbi.1000077-Comet1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Comet</surname><given-names>JP</given-names></name><name name-style="western"><surname>Aude</surname><given-names>JC</given-names></name><name name-style="western"><surname>Glemet</surname><given-names>E</given-names></name><name name-style="western"><surname>Risler</surname><given-names>JL</given-names></name><name name-style="western"><surname>Henaut</surname><given-names>A</given-names></name><etal/></person-group>             <year>1999</year>             <article-title>Significance of Z-value statistics of Smith-Waterman scores for protein alignments.</article-title>             <source>Comput Chem</source>             <volume>23</volume>             <fpage>317</fpage>             <lpage>331</lpage>          </element-citation></ref><ref id="pcbi.1000077-Karlin1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Karlin</surname><given-names>S</given-names></name><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name></person-group>             <year>1990</year>             <article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>87</volume>             <fpage>2264</fpage>             <lpage>2268</lpage>          </element-citation></ref><ref id="pcbi.1000077-Lipman1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Wilbur</surname><given-names>WJ</given-names></name><name name-style="western"><surname>Smith</surname><given-names>TF</given-names></name><name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name></person-group>             <year>1984</year>             <article-title>On the statistical significance of nucleic acid similarities.</article-title>             <source>Nucleic Acids Res</source>             <volume>12</volume>             <fpage>215</fpage>             <lpage>226</lpage>          </element-citation></ref><ref id="pcbi.1000077-Pearson1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pearson</surname><given-names>WR</given-names></name></person-group>             <year>1990</year>             <article-title>Rapid and sensitive sequence comparison with FASTP and FASTA.</article-title>             <source>Methods Enzymol</source>             <volume>183</volume>             <fpage>63</fpage>             <lpage>98</lpage>          </element-citation></ref><ref id="pcbi.1000077-Webber1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Webber</surname><given-names>C</given-names></name><name name-style="western"><surname>Barton</surname><given-names>GJ</given-names></name></person-group>             <year>2001</year>             <article-title>Estimation of P-values for global alignments of protein sequences.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>             <fpage>1158</fpage>             <lpage>1167</lpage>          </element-citation></ref><ref id="pcbi.1000077-Yu1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>YK</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name></person-group>             <year>2001</year>             <article-title>Statistical significance of probabilistic sequence alignment and related local hidden Markov models.</article-title>             <source>J Comput Biol</source>             <volume>8</volume>             <fpage>249</fpage>             <lpage>282</lpage>          </element-citation></ref><ref id="pcbi.1000077-Altschul1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name><name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name><name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name></person-group>             <year>1990</year>             <article-title>Basic local alignment search tool.</article-title>             <source>J Mol Biol</source>             <volume>215</volume>             <fpage>403</fpage>             <lpage>410</lpage>          </element-citation></ref><ref id="pcbi.1000077-Altschul2"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Madden</surname><given-names>TL</given-names></name><name name-style="western"><surname>Schaffer</surname><given-names>AA</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name><etal/></person-group>             <year>1997</year>             <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs.</article-title>             <source>Nucleic Acids Res</source>             <volume>25</volume>             <fpage>3389</fpage>             <lpage>3402</lpage>          </element-citation></ref><ref id="pcbi.1000077-Pearson2"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pearson</surname><given-names>WR</given-names></name><name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name></person-group>             <year>1988</year>             <article-title>Improved tools for biological sequence comparison.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>85</volume>             <fpage>2444</fpage>             <lpage>2448</lpage>          </element-citation></ref><ref id="pcbi.1000077-Smith1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>TF</given-names></name><name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name></person-group>             <year>1981</year>             <article-title>Identification of common molecular subsequences.</article-title>             <source>J Mol Biol</source>             <volume>147</volume>             <fpage>195</fpage>             <lpage>197</lpage>          </element-citation></ref><ref id="pcbi.1000077-Waterman1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name><name name-style="western"><surname>Byers</surname><given-names>TH</given-names></name></person-group>             <year>1985</year>             <article-title>A dynamic programming algorithm to find all solutions in a neighborhood of the optimum.</article-title>             <source>Math Biosci</source>             <volume>77</volume>             <fpage>48</fpage>             <lpage>53</lpage>          </element-citation></ref><ref id="pcbi.1000077-Naor1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Naor</surname><given-names>D</given-names></name><name name-style="western"><surname>Brutlag</surname><given-names>DL</given-names></name></person-group>             <year>1994</year>             <article-title>On near-optimal alignments of biological sequences.</article-title>             <source>J Comput Biol</source>             <volume>1</volume>             <fpage>349</fpage>             <lpage>366</lpage>          </element-citation></ref><ref id="pcbi.1000077-Vingron1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name></person-group>             <year>1996</year>             <article-title>Near-optimal sequence alignment.</article-title>             <source>Curr Opin Struct Biol</source>             <volume>6</volume>             <fpage>346</fpage>             <lpage>352</lpage>          </element-citation></ref><ref id="pcbi.1000077-Vingron2"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name><name name-style="western"><surname>Argos</surname><given-names>P</given-names></name></person-group>             <year>1990</year>             <article-title>Determination of reliable regions in protein sequence alignments.</article-title>             <source>Protein Eng</source>             <volume>3</volume>             <fpage>565</fpage>             <lpage>569</lpage>          </element-citation></ref><ref id="pcbi.1000077-Zuker1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zuker</surname><given-names>M</given-names></name></person-group>             <year>1991</year>             <article-title>Suboptimal sequence alignment in molecular biology. Alignment with error analysis.</article-title>             <source>J Mol Biol</source>             <volume>221</volume>             <fpage>403</fpage>             <lpage>420</lpage>          </element-citation></ref><ref id="pcbi.1000077-Schlosshauer1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schlosshauer</surname><given-names>M</given-names></name><name name-style="western"><surname>Ohlsson</surname><given-names>M</given-names></name></person-group>             <year>2002</year>             <article-title>A novel approach to local reliability of sequence alignments.</article-title>             <source>Bioinformatics</source>             <volume>18</volume>             <fpage>847</fpage>             <lpage>854</lpage>          </element-citation></ref><ref id="pcbi.1000077-Yu2"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>L</given-names></name><name name-style="western"><surname>Smith</surname><given-names>TF</given-names></name></person-group>             <year>1999</year>             <article-title>Positional statistical significance in sequence alignment.</article-title>             <source>J Comput Biol</source>             <volume>6</volume>             <fpage>253</fpage>             <lpage>259</lpage>          </element-citation></ref><ref id="pcbi.1000077-Durbin1"><label>19</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><name name-style="western"><surname>Mitchison</surname><given-names>G</given-names></name></person-group>             <year>1999</year>             <source>Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</source>             <publisher-loc>Cambridge</publisher-loc>             <publisher-name>University Press</publisher-name>          </element-citation></ref><ref id="pcbi.1000077-Chao1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chao</surname><given-names>KM</given-names></name><name name-style="western"><surname>Hardison</surname><given-names>RC</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name></person-group>             <year>1993</year>             <article-title>Locating well-conserved regions within a pairwise alignment.</article-title>             <source>Comput Appl Biosci</source>             <volume>9</volume>             <fpage>387</fpage>             <lpage>396</lpage>          </element-citation></ref><ref id="pcbi.1000077-Mevissen1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mevissen</surname><given-names>HT</given-names></name><name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name></person-group>             <year>1996</year>             <article-title>Quantifying the local reliability of a sequence alignment.</article-title>             <source>Protein Eng</source>             <volume>9</volume>             <fpage>127</fpage>             <lpage>132</lpage>          </element-citation></ref><ref id="pcbi.1000077-Tress1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tress</surname><given-names>ML</given-names></name><name name-style="western"><surname>Jones</surname><given-names>D</given-names></name><name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name></person-group>             <year>2003</year>             <article-title>Predicting reliable regions in protein alignments from sequence profiles.</article-title>             <source>J Mol Biol</source>             <volume>330</volume>             <fpage>705</fpage>             <lpage>718</lpage>          </element-citation></ref><ref id="pcbi.1000077-Liu1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name><name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name></person-group>             <year>1999</year>             <article-title>Bayesian inference on biopolymer models.</article-title>             <source>Bioinformatics</source>             <volume>15</volume>             <fpage>38</fpage>             <lpage>52</lpage>          </element-citation></ref><ref id="pcbi.1000077-Webb1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Webb</surname><given-names>B-JM</given-names></name><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name><name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name></person-group>             <year>2002</year>             <article-title>BALSA: Bayesian algorithm for local sequence alignment.</article-title>             <source>Nucleic Acids Research</source>             <volume>30</volume>             <fpage>1268</fpage>             <lpage>1277</lpage>          </element-citation></ref><ref id="pcbi.1000077-Zhu1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>J</given-names></name><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name><name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name></person-group>             <year>1998</year>             <article-title>Bayesian adaptive sequence alignment algorithms.</article-title>             <source>Bioinformatics</source>             <volume>14</volume>             <fpage>25</fpage>             <lpage>39</lpage>          </element-citation></ref><ref id="pcbi.1000077-Miyazawa1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Miyazawa</surname><given-names>S</given-names></name></person-group>             <year>1995</year>             <article-title>A reliable sequence alignment method based on probabilities of residue correspondences.</article-title>             <source>Protein Eng</source>             <volume>8</volume>             <fpage>999</fpage>             <lpage>1009</lpage>          </element-citation></ref><ref id="pcbi.1000077-Carvalho1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Carvalho</surname><given-names>LE</given-names></name><name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name></person-group>             <year>2008</year>             <article-title>Centroid estimation in discrete high-dimensional spaces with applications in biology.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>105</volume>             <fpage>3209</fpage>             <lpage>3214</lpage>          </element-citation></ref><ref id="pcbi.1000077-Liu2"><label>28</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name></person-group>             <year>2001</year>             <source>Monte Carlo Strategies in Scientific Computing</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>          </element-citation></ref><ref id="pcbi.1000077-Henikoff1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Henikoff</surname><given-names>S</given-names></name><name name-style="western"><surname>Henikoff</surname><given-names>JG</given-names></name></person-group>             <year>1992</year>             <article-title>Amino acid substitution matrices from protein blocks.</article-title>             <source>Proceedings of the National Academy of Science USA</source>             <volume>89</volume>             <fpage>10915</fpage>             <lpage>10919</lpage>          </element-citation></ref><ref id="pcbi.1000077-Dayhoff1"><label>30</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dayhoff</surname><given-names>ME</given-names></name><name name-style="western"><surname>Eck</surname><given-names>RV</given-names></name><name name-style="western"><surname>Park</surname><given-names>CM</given-names></name></person-group>             <year>1972</year>             <source>Atlas of Protein Sequence and Structure. Foundation, NBR</source>             <publisher-loc>Washington DC</publisher-loc>             <publisher-name>National Biomedical Research Foundation</publisher-name>             <fpage>89</fpage>             <lpage>99</lpage>          </element-citation></ref><ref id="pcbi.1000077-Liu3"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name><name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name></person-group>             <year>1999</year>             <article-title>Bayesian inference on biopolymer models.</article-title>             <source>Bioinformatics</source>             <volume>15</volume>             <fpage>38</fpage>             <lpage>52</lpage>          </element-citation></ref><ref id="pcbi.1000077-Pearson3"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pearson</surname><given-names>WR</given-names></name></person-group>             <year>1995</year>             <article-title>Comparison of methods for searching protein sequence databases.</article-title>             <source>Protein Science</source>             <volume>4</volume>             <fpage>1145</fpage>             <lpage>1160</lpage>          </element-citation></ref><ref id="pcbi.1000077-Carlin1"><label>33</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Carlin</surname><given-names>BP</given-names></name><name name-style="western"><surname>Louis</surname><given-names>TA</given-names></name></person-group>             <year>2000</year>             <source>Bayes and Empirical Bayes Methods for Data Analysis</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Chapman and Hall</publisher-name>          </element-citation></ref><ref id="pcbi.1000077-Holmes1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name></person-group>             <year>1998</year>             <article-title>Dynamic programming alignment accuracy.</article-title>             <source>J Comput Biol</source>             <volume>5</volume>             <fpage>493</fpage>             <lpage>504</lpage>          </element-citation></ref><ref id="pcbi.1000077-Kendall1"><label>35</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kendall</surname><given-names>M</given-names></name><name name-style="western"><surname>Stuart</surname><given-names>A</given-names></name></person-group>             <year>1979</year>             <source>The Advanced Theory of Statistics</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Macmillan</publisher-name>          </element-citation></ref><ref id="pcbi.1000077-Thompson1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Thompson</surname><given-names>W</given-names></name><name name-style="western"><surname>Palumbo</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name><name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name></person-group>             <year>2004</year>             <article-title>Decoding human regulatory circuits.</article-title>             <source>Genome Res</source>             <volume>14</volume>             <fpage>1967</fpage>             <lpage>1974</lpage>          </element-citation></ref><ref id="pcbi.1000077-Ott1"><label>37</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ott</surname><given-names>RL</given-names></name><name name-style="western"><surname>Longnecker</surname><given-names>M</given-names></name></person-group>             <year>2001</year>             <source>An Introduction to Statistical Methods and Data Analysis</source>             <publisher-loc>Pacific Grove</publisher-loc>             <publisher-name>Duxbury</publisher-name>          </element-citation></ref><ref id="pcbi.1000077-Perry1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Perry</surname><given-names>KA</given-names></name><name name-style="western"><surname>Kostka</surname><given-names>JE</given-names></name><name name-style="western"><surname>Luther</surname><given-names>GW</given-names><suffix>3rd</suffix></name><name name-style="western"><surname>Nealson</surname><given-names>KH</given-names></name></person-group>             <year>1993</year>             <article-title>Mediation of Sulfur Speciation by a Black Sea Facultative Anaerobe.</article-title>             <source>Science</source>             <volume>259</volume>             <fpage>801</fpage>             <lpage>803</lpage>          </element-citation></ref><ref id="pcbi.1000077-Ding1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ding</surname><given-names>Y</given-names></name><name name-style="western"><surname>Chan</surname><given-names>CY</given-names></name><name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name></person-group>             <year>2006</year>             <article-title>Clustering of RNA secondary structures with application to messenger RNAs.</article-title>             <source>J Mol Biol</source>             <volume>359</volume>             <fpage>554</fpage>             <lpage>571</lpage>          </element-citation></ref></ref-list></back></article>