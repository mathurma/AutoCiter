<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01797</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005676</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Circadian oscillators</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Chronobiology</subject><subj-group><subject>Circadian oscillators</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Chronobiology</subject><subj-group><subject>Circadian rhythms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Drosophila melanogaster</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Drosophila melanogaster</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Animal models</subject><subj-group><subject>Drosophila melanogaster</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Animals</subject><subj-group><subject>Invertebrates</subject><subj-group><subject>Arthropoda</subject><subj-group><subject>Insects</subject><subj-group><subject>Drosophila</subject><subj-group><subject>Drosophila melanogaster</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Approximation methods</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject><subj-group><subject>Normal distribution</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Long-time analytic approximation of large stochastic oscillators: Simulation, analysis and inference</article-title>
<alt-title alt-title-type="running-head">Approximation of large stochastic oscillators</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7953-706X</contrib-id>
<name name-style="western">
<surname>Minas</surname> <given-names>Giorgos</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2217-3274</contrib-id>
<name name-style="western">
<surname>Rand</surname> <given-names>David A.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Zeeman Institute for Systems Biology &amp; Infectious Disease Epidemiology Research, University of Warwick, Coventry, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Mathematics Institute, University of Warwick, Coventry, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ermentrout</surname> <given-names>Bard</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Pittsburgh, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">d.a.rand@warwick.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>7</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>24</day>
<month>7</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>7</issue>
<elocation-id>e1005676</elocation-id>
<history>
<date date-type="received">
<day>2</day>
<month>11</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>6</day>
<month>7</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Minas, Rand</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005676"/>
<abstract>
<p>In order to analyse large complex stochastic dynamical models such as those studied in systems biology there is currently a great need for both analytical tools and also algorithms for accurate and fast simulation and estimation. We present a new stochastic approximation of biological oscillators that addresses these needs. Our method, called phase-corrected LNA (pcLNA) overcomes the main limitations of the standard Linear Noise Approximation (LNA) to remain uniformly accurate for long times, still maintaining the speed and analytically tractability of the LNA. As part of this, we develop analytical expressions for key probability distributions and associated quantities, such as the Fisher Information Matrix and Kullback-Leibler divergence and we introduce a new approach to system-global sensitivity analysis. We also present algorithms for statistical inference and for long-term simulation of oscillating systems that are shown to be as accurate but much faster than leaping algorithms and algorithms for integration of diffusion equations. Stochastic versions of published models of the circadian clock and NF-<italic>κ</italic>B system are used to illustrate our results.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Many cellular and molecular systems such as the circadian clock and the cell cycle are oscillators that are modelled using nonlinear dynamical systems. Moreover, oscillatory systems are ubiquitous elsewhere in science. There is an extensive theory for perfectly noise-free dynamical systems and very effective algorithms for simulating their temporal behaviour. On the other hand, biological systems are inherently stochastic and the presence of stochastic noise can play a crucial role. Unfortunately, there are far fewer analytical tools and much less understanding for stochastic models especially when they are nonlinear and have lots of state variables and parameters. Moreover simulation is not so effective and can be very slow if the system is large. In this article we describe how to accurately approximate such systems in a way that facilitates fast simulation, parameter estimation and new approaches to analysis, such as calculating probability distributions that describe the system’s stochastic behaviour and describing how these distributions change when the parameters of the system are varied.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000268</institution-id>
<institution>Biotechnology and Biological Sciences Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>BB/K003097/1</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2217-3274</contrib-id>
<name name-style="western">
<surname>Rand</surname> <given-names>David A.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004963</institution-id>
<institution>Seventh Framework Programme</institution>
</institution-wrap>
</funding-source>
<award-id>305564</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2217-3274</contrib-id>
<name name-style="western">
<surname>Rand</surname> <given-names>David A.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This research was funded by the BBSRC Grant BB/K003097/1 (Systems Biology Analysis of Biological Timers and Inflammation). DAR was also supported by funding from the European Union Seventh Framework Programme (FP7/2007-2013) under grant agreement n° 305564. BBSRC web site: <ext-link ext-link-type="uri" xlink:href="http://www.bbsrc.ac.uk" xlink:type="simple">www.bbsrc.ac.uk</ext-link> Seventh Framework Programme (FP7) website: <ext-link ext-link-type="uri" xlink:href="http://cordis.europa.eu/fp7/home_en.html" xlink:type="simple">cordis.europa.eu/fp7/home_en.html</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="0"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-08-14</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Dynamic cellular oscillating systems such as the cell cycle, circadian clock and other signaling and regulatory systems have complex structures, highly nonlinear dynamics and are subject to both intrinsic and extrinsic stochasticity. Moreover, current models of these systems have high-dimensional phase spaces and many parameters. Modelling and analysing them is therefore a challenge, particularly if one wants to both take account of stochasticity and develop an analytical approach enabling quantification of various aspects of the system in a more controlled way than is possible by simulation alone. The stochastic kinetics that arise due to random births, deaths and interactions of individual species give rise to Markov jump processes that, in principle, can be analyzed by means of master equations. However, these are rarely tractable and although an exact numerical simulation algorithm is available [<xref ref-type="bibr" rid="pcbi.1005676.ref001">1</xref>], for the large systems we are interested in, this is very slow.</p>
<p>It is therefore important to develop accurate approximation methods that enable a more analytical approach as well as offering faster simulation and better algorithms for data fitting and parameter estimation. A number of approximation methods aimed at accelerating simulation are currently available. This includes leaping algorithms [<xref ref-type="bibr" rid="pcbi.1005676.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005676.ref003">3</xref>] and algorithms for integration of diffusion equations (or chemical Langevin equations (CLE)) [<xref ref-type="bibr" rid="pcbi.1005676.ref004">4</xref>] that provide faster simulation. However, these methods do not provide analytical tools for studying the dynamics of the system and they can also be extremely slow for data fitting and parameter estimation. One obvious candidate for overcoming these limitations is the Linear Noise Approximation (LNA). The LNA is based on a systematic approximation of the master equation by means of van Kampen’s Ω-expansion [<xref ref-type="bibr" rid="pcbi.1005676.ref005">5</xref>] which uses the system size parameter Ω that controls the number of molecules present in the system. The large system size validity of the LNA has been shown in [<xref ref-type="bibr" rid="pcbi.1005676.ref006">6</xref>], in the sense that the distribution of the Markov jump process at a fixed finite time converges, as the system size Ω tends to ∞, to the LNA probability distribution. The latter distribution is analytically tractable allowing for fast estimation and simulation algorithms. However, the LNA has significant limitations, particularly in approximating long-term behaviour of oscillatory systems.</p>
<p>We show below that for the oscillatory systems that we study, the LNA approximation of the distribution <italic>P</italic><sub><italic>t</italic></sub> = <italic>P</italic>(<italic>Y</italic>(<italic>t</italic>)|<italic>Y</italic>(0)), of the state <italic>Y</italic>(<italic>t</italic>) of the system at some time <italic>t</italic> becomes inaccurate when the time <italic>t</italic> is greater than a few periods of the oscillation. However, if we rather consider a similar system which in the Ω → ∞ limit instead of a limit cycle has an equilibrium point that is linearly stable, then the LNA approximation of <italic>P</italic><sub><italic>t</italic></sub> remains accurate for a much longer time-scale. For example, in Fig C in <xref ref-type="supplementary-material" rid="pcbi.1005676.s003">S3 Appendix</xref> we give an example where the LNA fails in a matter of a period or two for the oscillatory system, but for the corresponding equilibrium system it is very accurate for over a hundred times as long (and probably much longer). Similar behaviour is also observed in other systems and using different measures in [<xref ref-type="bibr" rid="pcbi.1005676.ref008">8</xref>].</p>
<p>The observation that non-degenerate limit cycles have such linearised stability in the directions transversal to the limit cycle suggests the way forward for oscillatory systems. Our approach exploits the fact that, because of this transversal linearised stability, the distributions <italic>P</italic><sub><italic>t</italic></sub> for a general class of systems with a stable attracting limit cycle in the Ω → ∞ limit are, like the above fixed point systems, similarly well-behaved on long time-scales provided one conditions <italic>P</italic><sub><italic>t</italic></sub> on appropriate transversal sections to the limit cycle.</p>
<p>We introduce a modified LNA, called the phase-corrected LNA, or pcLNA, that exploits the above observations to overcome the most important shortcomings of the LNA and we develop methods for analysis, simulation and inference of oscillatory systems that are accurate for much larger times. We build on previous work of Boland et al. [<xref ref-type="bibr" rid="pcbi.1005676.ref009">9</xref>] which uses the 2-dimensional Brusselator system as an exemplar to investigate the failure of the LNA in approximating long-term behaviour of oscillatory systems and presents a method for computing power spectra and comparing exact simulations with LNA predictions of the same phase rather than time. Using various low-dimensional oscillatory systems for illustration, a related analysis has been employed to study the temporal variability of oscillatory systems in the tangental direction of the Ω → ∞ limit cycle [<xref ref-type="bibr" rid="pcbi.1005676.ref010">10</xref>] and/or the amplitude variability in the transversal direction of the limit cycle [<xref ref-type="bibr" rid="pcbi.1005676.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1005676.ref013">13</xref>]. Other papers derive related descriptions of the asymptotic phase of stochastic oscillators [<xref ref-type="bibr" rid="pcbi.1005676.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005676.ref015">15</xref>].</p>
<p>We extend these results in a number of ways including the following: (i) we develop a theory that treats the general case and provide analytical arguments that justify our approximations and enable computation of trajectory distributions, (ii) we show that the approach is practicable for larger nonlinear systems, (iii) we present a new powerful system-global sensitivity theory for such systems using measures such as the Fisher Information Matrix and the Kullback-Leibler divergence that are analytically computed, (iv) we present a simulation algorithm and show it is as accurate but faster than leaping and integration of diffusion equation algorithms, and (v) we derive the Kalman filter associated with the pcLNA in order to provide a practical way to accurately approximate the likelihood function thus facilitating estimation of system parameters <italic>θ</italic> and predictive algorithms. The approach in [<xref ref-type="bibr" rid="pcbi.1005676.ref009">9</xref>] uses transversal sections which are normal to the limit cycle. We follow this but in the supplementary information (S1 Sects. 8.2 &amp; 8.3) we show that for most considerations one can use any transversal to the limit cycle, including those defined in [<xref ref-type="bibr" rid="pcbi.1005676.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005676.ref015">15</xref>].</p>
<p>To illustrate and validate our approach we apply it to a relatively large published stochastic model of the <italic>Drosophila</italic> circadian clock due to Gonze et al. [<xref ref-type="bibr" rid="pcbi.1005676.ref016">16</xref>] (see S2 Sect. 1). This model involves 10 state variables and 30 reactions and its structure is discussed in S2. The large system limit is given by the differential equation system of 10 kinetic equations that are listed in the supplementary information (S2 Sect. 1) along with the reaction scheme of the system. The stochastic version of the Brusselator system and a stochastic version of a well-studied model of the NF-<italic>κ</italic>B signalling system [<xref ref-type="bibr" rid="pcbi.1005676.ref017">17</xref>] are also used to illustrate our methods and the results can be found in <xref ref-type="supplementary-material" rid="pcbi.1005676.s003">S3 Appendix</xref>.</p>
<p>These systems are free-running oscillators in the sense that they correspond to a limit cycle of an autonomous differential equation in the the Ω → ∞ limit. However, our results also apply to the equally important classes of entrained forced oscillators and damped oscillations. We therefore consider two such systems in S2 and S3: the light-entrained <italic>Drosophila</italic> circadian clock model of [<xref ref-type="bibr" rid="pcbi.1005676.ref018">18</xref>] which is an example of a forced oscillator and the NF-<italic>κ</italic>B system model [<xref ref-type="bibr" rid="pcbi.1005676.ref017">17</xref>]. The latter has the extra feature that the analysis is not concerned with a limit cycle but of a transient solution that converges to the limit cycle as time increases. This solution is the biologically interesting one that describes how the system responds to being stimulated by TNF<italic>α</italic>. The supplementary information S1 includes technical derivations and S2 and S3 contain further illustrative figures that we refer to in this paper.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>Stochastic models of cellular processes in signaling and regulatory systems are usually described in terms of reaction networks. A system of multiple different molecular subpopulations has state vector, <italic>Y</italic>(<italic>t</italic>) = (<italic>Y</italic><sub>1</sub>(<italic>t</italic>), …, <italic>Y</italic><sub><italic>n</italic></sub>(<italic>t</italic>))<sup><italic>T</italic></sup> where <italic>Y</italic><sub><italic>i</italic></sub>(<italic>t</italic>), <italic>i</italic> = 1, …, <italic>n</italic>, denotes the number of molecules of each species at time <italic>t</italic>. These molecules undergo a number of possible reactions (e.g. transcription, translation, degradation) where the reaction of index <italic>j</italic> changes <italic>Y</italic>(<italic>t</italic>) to <italic>Y</italic>(<italic>t</italic>) + <italic>ν</italic><sub><italic>j</italic></sub>, <italic>ν</italic><sub><italic>j</italic></sub> ∈ ℝ<sup><italic>n</italic></sup>. The vectors <italic>ν</italic><sub><italic>j</italic></sub> are called stoichiometric vectors. Each reaction occurs randomly at a rate <italic>w</italic><sub><italic>j</italic></sub>(<italic>Y</italic>(<italic>t</italic>)) (often called the intensity of the reaction), which is a function of <italic>Y</italic>(<italic>t</italic>) but also depends periodically on <italic>t</italic> when we are studying forced oscillators. Such systems can be exactly simulated using the Stochastic Simulation algorithm (SSA) [<xref ref-type="bibr" rid="pcbi.1005676.ref001">1</xref>].</p>
<p>It is common in studying stochastic systems to introduce a system size Ω which is a parameter that occurs in the intensities of the reactions <italic>w</italic><sub><italic>j</italic></sub>(<italic>Y</italic>(<italic>t</italic>)) and controls molecular numbers (see discussion in S1 Sect. 2). While having a system size parameter is not necessary to apply our methods, it allows one to study the dependence of stochastic fluctuations upon system size and to calculate the deterministic equations that describe the evolution of the concentration vector <italic>X</italic>(<italic>t</italic>) = <italic>Y</italic>(<italic>t</italic>)/Ω in the limit of Ω → ∞ (see S1 Sect. 3). Although more general conditions can be used, a condition that will be sufficient for our purposes is that the rates <italic>w</italic><sub><italic>j</italic></sub>(<italic>Y</italic>(<italic>t</italic>)) depend upon Ω as <italic>w</italic><sub><italic>j</italic></sub>(<italic>Y</italic>) = Ω<italic>u</italic><sub><italic>j</italic></sub>(<italic>Y</italic>/Ω) (cf. [<xref ref-type="bibr" rid="pcbi.1005676.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005676.ref007">7</xref>]).</p>
<p>In the limit Ω → ∞ the time dependence of <italic>X</italic>(<italic>t</italic>) is given by the solution <italic>x</italic>(<italic>t</italic>) of the differential equation
<disp-formula id="pcbi.1005676.e001"><alternatives><graphic id="pcbi.1005676.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>u</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
with the appropriate initial condition (see S1 Sect. 3). For free-running oscillators the differential equation <xref ref-type="disp-formula" rid="pcbi.1005676.e001">Eq (1)</xref> is autonomous, whereas for forced oscillators <italic>F</italic> also depends periodically on <italic>t</italic>.</p>
<p>Throughout we will be interested in the case where the solution <italic>x</italic>(<italic>t</italic>) of interest is a stable limit cycle <italic>γ</italic> of minimal period <italic>τ</italic> &gt; 0 given by <italic>x</italic> = <italic>g</italic>(<italic>t</italic>), 0 ≤ <italic>t</italic> ≤ <italic>τ</italic>. We shall also always assume the generic situation for stable limit cycles of autonomous systems in which one of the characteristic exponents of the limit cycle is equal to zero and the rest have negative real part ([<xref ref-type="bibr" rid="pcbi.1005676.ref019">19</xref>], [<xref ref-type="bibr" rid="pcbi.1005676.ref020">20</xref> Sect 1.5] and S1 Sect. 1). For an entrained forced oscillator all the characteristic exponents of the limit cycle are assumed to have negative real parts.</p>
<p><xref ref-type="fig" rid="pcbi.1005676.g001">Fig 1(A)</xref> displays a stochastic trajectory of the concentrations <italic>X</italic>(<italic>t</italic>) = <italic>Y</italic>(<italic>t</italic>)/Ω of two of the species of the circadian clock system obtained using exact SSA simulation over a period of time <italic>t</italic> ∈ [0, 8.5<italic>τ</italic>] where <italic>τ</italic> ≈ 26.98 hours is the period of the limit cycle <italic>γ</italic>. Here the system size is Ω = 300, imposing moderate to high levels of stochasticity (see also Table C in <xref ref-type="supplementary-material" rid="pcbi.1005676.s002">S2 Appendix</xref>). Results for system sizes Ω = 200, 500 and 1000 are also reported in Fig B in <xref ref-type="supplementary-material" rid="pcbi.1005676.s002">S2 Appendix</xref>. <xref ref-type="fig" rid="pcbi.1005676.g001">Fig 1(B)</xref> shows realizations of the key probability distributions
<disp-formula id="pcbi.1005676.e002"><alternatives><graphic id="pcbi.1005676.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>t</mml:mi> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
which describe the state of the system at some time <italic>t</italic> &gt; <italic>t</italic><sub>0</sub>. It is very rare that accurate analytical approximations for such probability distributions can be derived from the exact Markov-jump process when <italic>t</italic> is large. Furthermore, as we can see, the SSA samples of <italic>P</italic>(<italic>X</italic>(<italic>t</italic>)|<italic>X</italic>(<italic>t</italic><sub>0</sub>) = <italic>x</italic><sub>0</sub>) spread along the curved periodic solution, <italic>x</italic> = <italic>g</italic>(<italic>t</italic>), of the limiting (Ω → ∞) deterministic system, implying that for large <italic>t</italic> this distribution is far from being normal and has a complex structure.</p>
<fig id="pcbi.1005676.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005676.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Exact stochastic simulation of the <italic>Drosophila</italic> circadian clock system.</title>
<p>(A) A stochastic trajectory obtained by running the SSA over the time-interval <italic>t</italic> ∈ [0, 8.5<italic>τ</italic>] and (B) SSA samples (<italic>R</italic> = 3000) at times <italic>t</italic> = <italic>τ</italic>, 2<italic>τ</italic>, …, 8<italic>τ</italic>. The concentrations, <italic>X</italic>(<italic>t</italic>) = <italic>Y</italic>(<italic>t</italic>)/Ω, of two (out of 10) of the species are displayed (<italic>per</italic> mRNA <italic>M</italic><sub><italic>P</italic></sub> (x-axis) and nuclear PER-TIM complex <italic>C</italic><sub><italic>N</italic></sub> (y-axis)). For this model the system size Ω is Avogadro’s number in units of nM<sup>−1</sup> multiplied by the cell volume in litres and the concentrations are nanomolar. The value of Ω used here is 300 in units of nM which assumes a cell volume of approximately 0.5 × 10<sup>−12</sup> litres. The number of <italic>M</italic><sub><italic>P</italic></sub> molecules ranges from 0 to 1200 and the number of <italic>C</italic><sub><italic>N</italic></sub> molecules from 100 to 900. It is only through Ω that the cell volume appears in the equations. The black solid curve is the Ω → ∞, limit cycle solution. (C) Schematic diagram illustrating the mapping <italic>G</italic><sub><italic>N</italic></sub>(⋅) and the relative phase <italic>δφ</italic><sub><italic>X</italic></sub>(⋅). (D) A plot of the lifted phase function <inline-formula id="pcbi.1005676.e003"><alternatives><graphic id="pcbi.1005676.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for a trajectory of this system. Note the long-term linear increase combined with frequent reversals.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.g001" xlink:type="simple"/>
</fig>
<p>However, we will show that there are important related distributions that can be well approximated even for large times <italic>t</italic>. For example, for each point <italic>x</italic> on the Ω → ∞ limit cycle <italic>γ</italic>, consider the (<italic>n</italic> − 1)-dimensional hyperplane <inline-formula id="pcbi.1005676.e109"><alternatives><graphic id="pcbi.1005676.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e109" xlink:type="simple"/><mml:math display="inline" id="M109"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> normal to <italic>γ</italic> at <italic>x</italic> ∈ <italic>γ</italic> (i.e. orthogonal to the tangent vector <italic>F</italic>(<italic>x</italic>) at <italic>x</italic>). We will show that the distribution of the intersection points of stochastic trajectories <italic>X</italic>(<italic>t</italic>) with <inline-formula id="pcbi.1005676.e110"><alternatives><graphic id="pcbi.1005676.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can be well-approximated by a multivariate normal (MVN) distribution that can be relatively easily calculated.</p>
<p>We need to define more precisely what we mean by intersection points. Consider the mapping <italic>G</italic><sub><italic>N</italic></sub> defined by <italic>G</italic><sub><italic>N</italic></sub>(<italic>X</italic>) = <italic>x</italic> ∈ <italic>γ</italic> if <italic>X</italic> ∈ <inline-formula id="pcbi.1005676.e111"><alternatives><graphic id="pcbi.1005676.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (see <xref ref-type="fig" rid="pcbi.1005676.g001">Fig 1(C)</xref>). Suppose that the limit cycle is given by <italic>x</italic> = <italic>g</italic>(<italic>t</italic>) and extend <italic>g</italic>(<italic>t</italic>) to all <italic>t</italic> ∈ ℝ by periodicity. Now consider a stochastic trajectory <italic>X</italic>(<italic>t</italic><sub><italic>i</italic></sub>), <italic>i</italic> = 0, 1, 2, …. Suppose that <italic>G</italic><sub><italic>N</italic></sub>(<italic>X</italic>(<italic>t</italic><sub><italic>i</italic> − 1</sub>)) = <italic>g</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub>), <italic>i</italic> &gt; 0. If <italic>G</italic><sub><italic>N</italic></sub>(<italic>X</italic>(<italic>t</italic><sub><italic>i</italic></sub>)) = <italic>g</italic>(<italic>s</italic>) then it equals <italic>g</italic>(<italic>s</italic> + <italic>qτ</italic>) for all integers <italic>q</italic>. Choose <italic>q</italic> so that <italic>s</italic><sub><italic>i</italic></sub> = <italic>s</italic> + <italic>qτ</italic> satisfies <italic>s</italic><sub><italic>i</italic> − 1</sub> − <italic>τ</italic>/2 ≤ <italic>s</italic><sub><italic>i</italic></sub> &lt; <italic>s</italic><sub><italic>i</italic> − 1</sub> + <italic>τ</italic>/2. Note that the difference between <italic>s</italic><sub><italic>i</italic></sub> and <italic>s</italic><sub><italic>i</italic> − 1</sub> can be both positive and negative and the choice of <italic>s</italic><sub><italic>i</italic></sub> minimises |<italic>s</italic><sub><italic>i</italic></sub> − <italic>s</italic><sub><italic>i</italic> − 1</sub>|. We define the relative phase <italic>δφ</italic><sub><italic>X</italic></sub>(<italic>t</italic><sub><italic>i</italic></sub>) to be 2<italic>π</italic>(<italic>s</italic><sub><italic>i</italic></sub> − <italic>s</italic><sub><italic>i</italic> − 1</sub>)/<italic>τ</italic>. With this definition the lifted phase <inline-formula id="pcbi.1005676.e004"><alternatives><graphic id="pcbi.1005676.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is defined to be the function
<disp-formula id="pcbi.1005676.e005"><alternatives><graphic id="pcbi.1005676.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mspace width="1.em"/><mml:mtext>and</mml:mtext> <mml:mspace width="1.em"/><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>i</mml:mi></mml:munderover> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>φ</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi> <mml:mspace width="1.em"/><mml:mtext>if</mml:mtext> <mml:mspace width="1.em"/><mml:mi>i</mml:mi> <mml:mo>≥</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>An example of <inline-formula id="pcbi.1005676.e006"><alternatives><graphic id="pcbi.1005676.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is shown in <xref ref-type="fig" rid="pcbi.1005676.g001">Fig 1(C)</xref>. Now, as shown in that figure, if the system size is not too small, although there will be some reversals, the stochastic process <italic>G<sub>N</sub></italic>(<italic>X</italic>(<italic>t</italic>)), <italic>t</italic> &gt; 0, will move around <italic>γ</italic> in the direction of the deterministic flow given by <xref ref-type="disp-formula" rid="pcbi.1005676.e001">Eq (1)</xref> so that <inline-formula id="pcbi.1005676.e007"><alternatives><graphic id="pcbi.1005676.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> increases at a definite positive rate because phase advances exceed retreats. Our approximations (S1 Sect. 6) give that the long term rate is 2<italic>π</italic>/<italic>τ</italic> and that the variance of the fluctuations <inline-formula id="pcbi.1005676.e008"><alternatives><graphic id="pcbi.1005676.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> grows linearly with a growth rate that is O(<italic>t</italic>/Ω).</p>
<p>Now consider stochastic trajectories <italic>X</italic>(<italic>t</italic><sub><italic>i</italic></sub>) with <italic>X</italic>(<italic>t</italic><sub>0</sub>) ∈ <inline-formula id="pcbi.1005676.e009"><alternatives><graphic id="pcbi.1005676.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and consider how this trajectory passes through <inline-formula id="pcbi.1005676.e010"><alternatives><graphic id="pcbi.1005676.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. We can assume that <italic>T</italic><sub>0</sub> &lt; <italic>T</italic><sub>1</sub> ≤ <italic>T</italic><sub>0</sub> + <italic>τ</italic> by the periodicity of <italic>g</italic>. The <italic>r</italic>th pass will occur between the first time <italic>t</italic><sub><italic>i</italic></sub> when
<disp-formula id="pcbi.1005676.e011"><alternatives><graphic id="pcbi.1005676.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and <italic>t</italic><sub><italic>i</italic>+1</sub>. Therefore, we define the <italic>first intersection point of the rth pass</italic> to be
<disp-formula id="pcbi.1005676.e012"><alternatives><graphic id="pcbi.1005676.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
since <italic>X</italic> does not change between <italic>t</italic><sub><italic>i</italic></sub> and <italic>t</italic><sub><italic>i</italic>+1</sub>.</p>
<p>These points of intersection <inline-formula id="pcbi.1005676.e013"><alternatives><graphic id="pcbi.1005676.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> describe the stochasticity of the system around a particular phase <italic>x</italic> of the system. The above ideas work equally well with any transversal to <italic>γ</italic>. For example, the time at which the <italic>i</italic>-th variable is maximal in the deterministic system is given by the transversal submanifold Σ defined by <inline-formula id="pcbi.1005676.e014"><alternatives><graphic id="pcbi.1005676.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¨</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> so the intersection of the stochastic trajectory with Σ can be regarded as giving the statistics of the maxima of the stochastic trajectory (see <xref ref-type="fig" rid="pcbi.1005676.g002">Fig 2(A)</xref>). Close to the limit cycle, Σ is well-approximated by its tangent space at the point of intersection with the limit cycle. Therefore, these transversal distributions are useful for analysing various aspects of the system.</p>
<fig id="pcbi.1005676.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005676.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Intersections of the stochastic trajectories with a transversal section <inline-formula id="pcbi.1005676.e015"><alternatives><graphic id="pcbi.1005676.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.</title>
<p>(A) Schematic representation of the intersections. (B) We consider an adapted coordinate system (<italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub>10</sub>) (see S1 Sect. 1) so that (<italic>x</italic><sub>2</sub>, …, <italic>x</italic><sub>10</sub>) are orthogonal coordinates on <inline-formula id="pcbi.1005676.e016"><alternatives><graphic id="pcbi.1005676.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and then consider the distribution <italic>P</italic><sup><italic>k</italic>, <italic>r</italic></sup> of the values of <italic>x</italic><sub><italic>k</italic></sub> for <italic>k</italic> = 2, …, 10 at the intersection points <inline-formula id="pcbi.1005676.e017"><alternatives><graphic id="pcbi.1005676.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Quantile-Quantile (Q-Q) plots of these distributions for the fourth pass, <inline-formula id="pcbi.1005676.e018"><alternatives><graphic id="pcbi.1005676.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>4</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, show that the distributions are very close to being normal, (see Fig C in <xref ref-type="supplementary-material" rid="pcbi.1005676.s002">S2 Appendix</xref> for similar plots for <italic>r</italic> = 1, 2, …, 8). (C) KS distances between the above distributions for the first <italic>r</italic> = 1, 2, …, 7 rounds of the stochastic trajectory and the distribution in the 8th round (<italic>r</italic> = 8), <italic>k</italic> = 2, 3, …, 10.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.g002" xlink:type="simple"/>
</fig>
<p>Our first observation is that the empirical transversal distributions
<disp-formula id="pcbi.1005676.e019"><alternatives><graphic id="pcbi.1005676.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
obtained by exact simulation are approximately multivariate normal (<xref ref-type="fig" rid="pcbi.1005676.g002">Fig 2(B)</xref>). Moreover, as <italic>r</italic> increases <inline-formula id="pcbi.1005676.e020"><alternatives><graphic id="pcbi.1005676.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005676.e021"><alternatives><graphic id="pcbi.1005676.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are hardly distinguishable and appear to converge to a fixed, approximately normal transversal distribution as <italic>r</italic> increases (<xref ref-type="fig" rid="pcbi.1005676.g002">Fig 2(C)</xref>). Similar results hold if we use a different family of transversal sections to <italic>γ</italic> as explained in S1 Sect. 8.2 &amp; 8.3.</p>
<p>A natural question that arises is whether one obtains a different distribution when instead of taking the first intersection point of the <italic>r</italic>th pass one takes a later intersection point of the same round. This is addressed in S1 Sect. 12 where we show that in exact simulations there appears to be no difference as would be expected from the LNA approximation.</p>
<sec id="sec003">
<title>The Linear Noise Approximation (LNA)</title>
<p>The convergence of the transversal distributions to approximately normal distributions naturally raises the question of whether asymptotic approximation methods such as the LNA, which provide multivariate normally distributed approximation of the stochastic system, can be used to accurately approximate these transversal distributions.</p>
<p>The LNA as formulated by [<xref ref-type="bibr" rid="pcbi.1005676.ref006">6</xref>] is derived directly from the underlying Markov jump process and is valid for any time interval of finite fixed length. It is based on the ansatz
<disp-formula id="pcbi.1005676.e022"><alternatives><graphic id="pcbi.1005676.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>Y</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Ω</mml:mo></mml:mfrac> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>ξ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msqrt><mml:mo>Ω</mml:mo></mml:msqrt></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>x</italic>(<italic>t</italic>) is a solution of the limiting (Ω → ∞) deterministic system <xref ref-type="disp-formula" rid="pcbi.1005676.e001">Eq (1)</xref> and <inline-formula id="pcbi.1005676.e023"><alternatives><graphic id="pcbi.1005676.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msqrt><mml:mo>Ω</mml:mo></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> describes the stochastic variations. In our case we always take <italic>x</italic>(<italic>t</italic>) to be the periodic solution <italic>g</italic>(<italic>t</italic>). A key aspect of this ansatz is that <italic>ξ</italic>(<italic>t</italic>) satisfies a linear stochastic differential equation that is independent of Ω, with drift and diffusion matrices that are functions of the deterministic solution <italic>g</italic>(<italic>t</italic>). Details are given in S1 Sect. 4 &amp; 5.</p>
<p>Given an initial time <italic>t</italic><sub>0</sub> and an initial condition <italic>ξ</italic>(<italic>t</italic><sub>0</sub>) for <italic>ξ</italic>, the LNA determines the distribution, of <italic>ξ</italic>(<italic>t</italic>), <italic>t</italic> &gt; <italic>t</italic><sub>0</sub>, and hence <inline-formula id="pcbi.1005676.e024"><alternatives><graphic id="pcbi.1005676.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msqrt><mml:mo>Ω</mml:mo></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> that we respectively denote by <italic>P</italic><sub>LNA</sub>(<italic>ξ</italic>(<italic>t</italic>)|<italic>t</italic><sub>0</sub>, <italic>ξ</italic>(<italic>t</italic><sub>0</sub>)) and <italic>P</italic><sub>LNA</sub>(<italic>X</italic>(<italic>t</italic>)|<italic>t</italic><sub>0</sub>, <italic>ξ</italic>(<italic>t</italic><sub>0</sub>)). If <italic>ξ</italic>(<italic>t</italic><sub>0</sub>) is only known up to a multivariate normal (MVN) distribution <italic>P</italic><sub>0</sub> then we denote these distributions, respectively, by <italic>P</italic><sub>LNA</sub>(<italic>ξ</italic>(<italic>t</italic>)|<italic>t</italic><sub>0</sub>, <italic>ξ</italic>(<italic>t</italic><sub>0</sub>)∼<italic>P</italic><sub>0</sub>) and <italic>P</italic><sub>LNA</sub>(<italic>X</italic>(<italic>t</italic>)|<italic>t</italic><sub>0</sub>, <italic>ξ</italic>(<italic>t</italic><sub>0</sub>)∼<italic>P</italic><sub>0</sub>). Details of how to calculate these distributions are given in S1 Sect. 4. Each of the above distributions is MVN enabling analytical approaches, for example in analysing the stochastic sensitivities of the system.</p>
<p>If we fix <italic>t</italic> &gt; <italic>t</italic><sub>0</sub> then as Ω → ∞ the true distribution of <italic>ξ</italic> converges to the distribution <italic>P</italic><sub>LNA</sub>(<italic>ξ</italic>(<italic>t</italic>)|<italic>t</italic><sub>0</sub>, <italic>ξ</italic>(<italic>t</italic><sub>0</sub>)) (see e.g. [<xref ref-type="bibr" rid="pcbi.1005676.ref005">5</xref>]). However, one most certainly cannot reverse the limits i.e. for a fixed Ω one cannot expect the approximation to hold for large time <italic>t</italic> → ∞. As we now show, this is certainly the case for oscillators and we aim to overcome this limitation by developing methods that remain accurate for much larger times than the LNA.</p>
<p>We first consider the distribution <italic>P</italic>(<italic>X</italic>(<italic>t</italic>)|<italic>X</italic>(0) = <italic>x</italic><sub>0</sub>) and compare this for SSA simulated samples and the LNA at a sequence of times <italic>t</italic> = <italic>τ</italic>, 2<italic>τ</italic>, …, 8<italic>τ</italic> and for an arbitrary (fixed) initial state <italic>x</italic><sub>0</sub> ∈ <italic>γ</italic>. As we can see in <xref ref-type="fig" rid="pcbi.1005676.g003">Fig 3</xref>, the LNA fits the SSA simulations relatively well in the short run (<italic>t</italic> ≤ <italic>τ</italic>), but as time progresses the Kolmogorov-Smirnov (KS) distance between the two distributions for each state variable for the LNA and the SSA increases substantially beyond the threshold level (see <xref ref-type="fig" rid="pcbi.1005676.g003">Fig 3(B)</xref>). The LNA predictions spread along the tangental direction and therefore fail to accurately reflect the SSA samples that have instead spread along the curved limit cycle.</p>
<fig id="pcbi.1005676.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005676.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison between LNA and exact simulations.</title>
<p>(a) Samples (in nanomolar concentrations) obtained from the SSA simulation algorithm (red crosses) and 0.01, 0.05, 0.40 contours of the LNA probability density (colored ellipsoids) at fixed times, <italic>t</italic> = <italic>τ</italic>, 2<italic>τ</italic>, …, 8<italic>τ</italic> (<italic>τ</italic>: minimal period), for the circadian clock system (<italic>M</italic><sub><italic>P</italic></sub> <italic>per</italic> mRNA; <italic>C</italic><sub><italic>N</italic></sub> nuclear PER:TIM complex <italic>P</italic><sub>0</sub> &amp; <italic>T</italic><sub>0</sub> PER &amp; TIM protein; <italic>P</italic><sub>1</sub> &amp; <italic>T</italic><sub>1</sub> phosphorylated PER &amp; TIM protein; <italic>P</italic><sub>2</sub> &amp; <italic>T</italic><sub>2</sub> twice phosphorylated PER &amp; TIM protein; <italic>C</italic> cytoplasmic PER:TIM complex, units as in <xref ref-type="fig" rid="pcbi.1005676.g001">Fig 1</xref>). The limit cycle ODE solution is also displayed (black solid line). (b) KS distance between the empirical distribution of SSA samples and the LNA distribution of each species (different colors, see legend) at the fixed times. The threshold level is also displayed (black solid line). The system size is Ω = 300.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.g003" xlink:type="simple"/>
</fig>
<p>On the other hand, as we saw earlier, the transversal distributions <inline-formula id="pcbi.1005676.e025"><alternatives><graphic id="pcbi.1005676.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of the <italic>Drosophila</italic> circadian clock system are approximately normal (<xref ref-type="fig" rid="pcbi.1005676.g003">Fig 3(B)</xref>). We next derive an approximation of <inline-formula id="pcbi.1005676.e026"><alternatives><graphic id="pcbi.1005676.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> under the LNA and show that it accurately approximates <inline-formula id="pcbi.1005676.e027"><alternatives><graphic id="pcbi.1005676.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> for the <italic>Drosophila</italic> circadian clock, Brusselator and NF-<italic>κ</italic>B systems.</p>
</sec>
<sec id="sec004">
<title>Calculating transversal distributions</title>
<p>We now generalise slightly and consider the set of stochastic trajectories <italic>X</italic> where the initial conditions <italic>X</italic>(<italic>t</italic><sub>0</sub>) have a MVN distribution <italic>P</italic><sub>0</sub> that is supported on the normal transversal section <inline-formula id="pcbi.1005676.e028"><alternatives><graphic id="pcbi.1005676.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (denoted <italic>X</italic>(<italic>t</italic><sub>0</sub>)∼<italic>P</italic><sub>0</sub>). We consider how to approximate the distribution <inline-formula id="pcbi.1005676.e029"><alternatives><graphic id="pcbi.1005676.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> of the intersection points <inline-formula id="pcbi.1005676.e030"><alternatives><graphic id="pcbi.1005676.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> of these trajectories with the normal transversal section <inline-formula id="pcbi.1005676.e031"><alternatives><graphic id="pcbi.1005676.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, <italic>t</italic><sub>1</sub> &gt; <italic>t</italic><sub>0</sub>. As an approximation we take the conditional distribution
<disp-formula id="pcbi.1005676.e032"><alternatives><graphic id="pcbi.1005676.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>LNA</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>LNA</mml:mtext></mml:msub><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:msubsup><mml:mi>t</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>τ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
given by conditioning <inline-formula id="pcbi.1005676.e033"><alternatives><graphic id="pcbi.1005676.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>LNA</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>free</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>LNA</mml:mtext></mml:msub><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> on <inline-formula id="pcbi.1005676.e034"><alternatives><graphic id="pcbi.1005676.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. It gives a MVN distribution supported on <inline-formula id="pcbi.1005676.e035"><alternatives><graphic id="pcbi.1005676.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.</p>
<p>In S1 we show that, although, for free-running oscillators, <inline-formula id="pcbi.1005676.e036"><alternatives><graphic id="pcbi.1005676.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>LNA</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>free</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> diverges as <italic>r</italic> → ∞, the mean and covariance of the MVN transversal distribution <inline-formula id="pcbi.1005676.e037"><alternatives><graphic id="pcbi.1005676.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>LNA</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> converge exponentially fast to those of a MVN distribution <inline-formula id="pcbi.1005676.e038"><alternatives><graphic id="pcbi.1005676.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>LNA</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (S1 Sect. 8, cf. <xref ref-type="fig" rid="pcbi.1005676.g004">Fig 4</xref>). The distribution <inline-formula id="pcbi.1005676.e039"><alternatives><graphic id="pcbi.1005676.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>LNA</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is a fixed point in the sense that if the distribution of <italic>X</italic>(<italic>t</italic><sub>1</sub> + <italic>τ</italic>) is given by the LNA using as initial condition <inline-formula id="pcbi.1005676.e040"><alternatives><graphic id="pcbi.1005676.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>LNA</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> then conditioning on <italic>X</italic>(<italic>t</italic><sub>1</sub> + <italic>τ</italic>) ∈ <inline-formula id="pcbi.1005676.e041"><alternatives><graphic id="pcbi.1005676.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> gives
<disp-formula id="pcbi.1005676.e042"><alternatives><graphic id="pcbi.1005676.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>LNA</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Using this fact enables us to calculate <inline-formula id="pcbi.1005676.e043"><alternatives><graphic id="pcbi.1005676.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>LNA</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> directly because we show in S1 that its mean and covariance matrix satisfy a simple fixed point equation that is easily solved numerically (S1 Sect. 9.1).</p>
<fig id="pcbi.1005676.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005676.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Schematic diagram of the distributions <inline-formula id="pcbi.1005676.e044"><alternatives><graphic id="pcbi.1005676.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msub><mml:mi>P</mml:mi> <mml:mtext>LNA</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> as <inline-formula id="pcbi.1005676.e115"><alternatives><graphic id="pcbi.1005676.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:mi>r</mml:mi></mml:math></alternatives></inline-formula> increases.</title>
<p>The yellow distribution represents the limit as <italic>r</italic> → ∞. Although, for free oscillators the latter distribution diverges, the corresponding conditional distributions on the transversal converge.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.g004" xlink:type="simple"/>
</fig>
<p>The reader will note that in <xref ref-type="disp-formula" rid="pcbi.1005676.e032">Eq (4)</xref> we approximate by conditioning on <inline-formula id="pcbi.1005676.e045"><alternatives><graphic id="pcbi.1005676.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> whereas we should have conditioned on <italic>X</italic>(<italic>t</italic>) ∈ <inline-formula id="pcbi.1005676.e046"><alternatives><graphic id="pcbi.1005676.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> for arbitrary <italic>t</italic> corresponding to the <italic>r</italic>th round. In S1 Sect. 7 we argue that the error in the mean and variance of the distribution due to taking <inline-formula id="pcbi.1005676.e047"><alternatives><graphic id="pcbi.1005676.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is O(Ω<sup>−1</sup>).</p>
<p>The question remains as to how well these distributions capture the exact simulation transversal distribution <inline-formula id="pcbi.1005676.e048"><alternatives><graphic id="pcbi.1005676.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. This is addressed in <xref ref-type="fig" rid="pcbi.1005676.g005">Fig 5</xref> where it is shown that the fit is excellent even for Ω as low as 300. The fit is even better for higher system sizes (Fig E in <xref ref-type="supplementary-material" rid="pcbi.1005676.s002">S2 Appendix</xref>). In S3 we also show similar low Ω results for the Brusselator (Fig B in <xref ref-type="supplementary-material" rid="pcbi.1005676.s003">S3 Appendix</xref>) and the NF-<italic>κ</italic>B system (Fig E in <xref ref-type="supplementary-material" rid="pcbi.1005676.s003">S3 Appendix</xref>). The result is also true for the light-entrained <italic>Drosophila</italic> circadian clock system (see Fig J in <xref ref-type="supplementary-material" rid="pcbi.1005676.s002">S2 Appendix</xref>) and the transient oscillations of the NF-<italic>κ</italic>B system (see Fig H in <xref ref-type="supplementary-material" rid="pcbi.1005676.s003">S3 Appendix</xref>). Thus we note that although the LNA cannot be used directly to accurately compute <italic>P</italic>(<italic>X</italic>(<italic>t</italic>)|<italic>X</italic>(0)) for a fixed Ω and increasing <italic>t</italic>, using it to compute the transversal distributions provides accurate estimates of <inline-formula id="pcbi.1005676.e049"><alternatives><graphic id="pcbi.1005676.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> for much larger times <italic>t</italic><sub>1</sub> + <italic>rτ</italic>. Moreover, in S1 Sects. 8.2 &amp; 8.3 we also explain why the convergence of the distribution on normal hyperplanes implies convergence on other transversal sections to <italic>γ</italic>.</p>
<fig id="pcbi.1005676.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005676.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Comparison of pcLNA and exact transversal distributions for the <italic>Drosophila</italic> circadian clock (Ω = 300).</title>
<p>(A) CDF plots of the distributions <italic>P</italic><sup><italic>k</italic>, <italic>r</italic></sup> as in <xref ref-type="fig" rid="pcbi.1005676.g002">Fig 2</xref> for the pcLNA (red line) and the SSA (empirical CDF, crosses) for <italic>k</italic> = 2, 3, …, 10 and round <italic>r</italic> = 4 (see Fig D in <xref ref-type="supplementary-material" rid="pcbi.1005676.s002">S2 Appendix</xref> for <italic>r</italic> = 1, 2, …, 8). (B) KS distances between the corresponding distributions under pcLNA and SSA, <italic>r</italic> = 1, 2, …, 8, <italic>k</italic> = 2, 3, …, 10.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.g005" xlink:type="simple"/>
</fig>
<p>In S1 Sect. 8.4. we explain that in contradistinction to free-running oscillators, for entrained forced oscillators, <italic>P</italic><sub><italic>r</italic></sub> = <italic>P</italic><sub>LNA</sub>(<italic>X</italic>((<italic>r</italic> − 1)<italic>τ</italic> + <italic>t</italic><sub>1</sub>)|<italic>x</italic><sub>0</sub>, <italic>ξ</italic><sub>0</sub> ∼ <italic>P</italic><sub>0</sub>) converges as <italic>r</italic> → ∞ so that, under the LNA, the phase fluctuation have a variance that is bounded independently of <italic>r</italic>. The corresponding conditional distribution is therefore a correspondingly good approximation to the transversal distribution <inline-formula id="pcbi.1005676.e050"><alternatives><graphic id="pcbi.1005676.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (see Fig J in <xref ref-type="supplementary-material" rid="pcbi.1005676.s002">S2 Appendix</xref>). However, it does not mean that <inline-formula id="pcbi.1005676.e051"><alternatives><graphic id="pcbi.1005676.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>LNA</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>free</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is a good approximation to the corresponding distribution <inline-formula id="pcbi.1005676.e052"><alternatives><graphic id="pcbi.1005676.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for an exact simulation. In fact, we show in Fig I in <xref ref-type="supplementary-material" rid="pcbi.1005676.s002">S2 Appendix</xref> that <inline-formula id="pcbi.1005676.e053"><alternatives><graphic id="pcbi.1005676.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>LNA</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>free</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is a poor approximation of the empirical distribution <inline-formula id="pcbi.1005676.e054"><alternatives><graphic id="pcbi.1005676.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> derived from exact simulations for the light-entrained <italic>Drosophila</italic> circadian clock (Ω = 300). The bounded variance of the phase fluctuations as <italic>r</italic> → ∞ for forced oscillators is the basic mechanism behind the population-level entrainment of stochastic oscillators introduced in [<xref ref-type="bibr" rid="pcbi.1005676.ref021">21</xref>].</p>
</sec>
<sec id="sec005">
<title>Stochastic fluctuations in periods and timing</title>
<p>We now consider the fluctuations <italic>δt</italic> in the time taken for the lifted phase of a stochastic trajectory to go from a given phase <italic>φ</italic><sub>1</sub> to a greater one <italic>φ</italic><sub>2</sub>. If <italic>φ</italic><sub>2</sub> − <italic>φ</italic><sub>1</sub> = 2<italic>rπ</italic> then this corresponds to the time taken to perform <italic>r</italic> cycles.</p>
<p>In <xref ref-type="fig" rid="pcbi.1005676.g006">Fig 6</xref> we give an example using the <italic>Drosophila</italic> circadian clock model where we take <italic>φ</italic><sub>1</sub> to be 0 (with a fixed initial condition <italic>x</italic><sub>0</sub> ∈ <italic>γ</italic>) and <italic>φ</italic><sub>2</sub> = 2<italic>πr</italic> for <italic>r</italic> = 1, …, 8. The distributions of <italic>δt</italic> appear to be very close to normal and the variance appears to grow linearly with <italic>r</italic>. We also consider the case where <italic>φ</italic><sub>1</sub> = 2(<italic>r</italic> − 1)<italic>π</italic> and <italic>φ</italic><sub>2</sub> = 2<italic>rπ</italic> for <italic>r</italic> = 1, …, 8. Again the distributions are approximately normal but the variances are approximately constant (<xref ref-type="fig" rid="pcbi.1005676.g006">Fig 6(C)</xref>). Because for a given <italic>r</italic> the trajectory has done <italic>r</italic> − 1 cycles before reaching the lifted phase <italic>φ</italic><sub>1</sub> the distribution of the state at this phase is changing with <italic>r</italic>. We expect that this distribution is converging with increasing <italic>r</italic> and this result (<xref ref-type="fig" rid="pcbi.1005676.g006">Fig 6(C)</xref>) is in accordance with this.</p>
<fig id="pcbi.1005676.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005676.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Exact empirical distribution of the fluctuations <italic>δt</italic> in <italic>Drosophila</italic> circadian clock system size Ω = 300.</title>
<p>(A) The (smoothed) empirical density function of <italic>δt</italic> in the time taken for the lifted phase of a stochastic trajectory to go from <italic>φ</italic><sub>1</sub> = 0 to <italic>φ</italic><sub>2</sub> = 2<italic>rπ</italic>, <italic>r</italic> = 1, 2, …, 8. (B) The (smoothed) empirical density function of the fluctuations in the time taken for the lifted phase of a stochastic trajectory to go from <italic>φ</italic><sub>1</sub> = 2(<italic>r</italic> − 1)<italic>π</italic> to <italic>φ</italic><sub>2</sub> = 2<italic>rπ</italic>, <italic>r</italic> = 1, 2, …, 8. (C) The variance of the distributions in (A) and (B).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.g006" xlink:type="simple"/>
</fig>
<p>In S1 Sect. 6 we approximate the statistics of <italic>δt</italic> using the LNA and show that as a random variable <italic>δt</italic> is approximately normal with mean that is O(Ω<sup>−3/2</sup>) and we also calculate its variance up to terms that are O(Ω<sup>−3/2</sup>) and the extent of its divergence from normality.</p>
<p>All points with a given lifted phase <italic>φ</italic><sub>1</sub> lie in a particular transversal <inline-formula id="pcbi.1005676.e055"><alternatives><graphic id="pcbi.1005676.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> with 0 ≤ <italic>t</italic><sub>1</sub> &lt; <italic>τ</italic>. If <italic>t</italic><sub>2</sub> = <italic>t</italic><sub>1</sub> + (<italic>φ</italic><sub>2</sub> − <italic>φ</italic><sub>1</sub>)<italic>τ</italic>/2<italic>π</italic>, then, the mean and variance of <italic>δt</italic> can be calculated in terms of <italic>t</italic><sub>1</sub> and <italic>t</italic><sub>2</sub>. If the initial conditions <italic>ξ</italic>(<italic>t</italic><sub>1</sub>) are MVN distributed on <inline-formula id="pcbi.1005676.e056"><alternatives><graphic id="pcbi.1005676.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> with mean 0 and covariance <italic>V</italic><sub>1</sub>, this variance is <inline-formula id="pcbi.1005676.e057"><alternatives><graphic id="pcbi.1005676.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msup><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>Ω</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>ˇ</mml:mo></mml:mover> <mml:mn>11</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mtext>O</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mo>Ω</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>3</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where <inline-formula id="pcbi.1005676.e058"><alternatives><graphic id="pcbi.1005676.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>ˇ</mml:mo></mml:mover> <mml:mn>11</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>ˇ</mml:mo></mml:mover> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
<disp-formula id="pcbi.1005676.e059"><alternatives><graphic id="pcbi.1005676.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>ˇ</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>V</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mi>C</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
written in adapted coordinates at <italic>g</italic>(<italic>t</italic><sub>2</sub>) (see S1 Sect. 1). All terms on the right hand side of this equation are defined in S1 Sect. 4. The above exact simulations of the <italic>Drosophila</italic> circadian clock agree with these theoretical predictions. It is easy to see (cf. S1 Sect. 8) that <inline-formula id="pcbi.1005676.e060"><alternatives><graphic id="pcbi.1005676.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>ˇ</mml:mo></mml:mover> <mml:mn>11</mml:mn></mml:msub></mml:math></alternatives></inline-formula> grows roughly linearly with <italic>t</italic><sub>2</sub> − <italic>t</italic><sub>1</sub>.</p>
</sec>
<sec id="sec006">
<title>pcLNA simulation algorithm</title>
<p>Given the ability to accurately approximate the transversal distributions and the results in [<xref ref-type="bibr" rid="pcbi.1005676.ref009">9</xref>] we realised it should be possible to use this to construct a rapid simulation algorithm. The linear increase of the variance of the deviations <italic>δt</italic>, or equivalently, the linear growth in the variance of the deviation of the lifted phase <inline-formula id="pcbi.1005676.e061"><alternatives><graphic id="pcbi.1005676.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> from 2<italic>πt</italic><sub><italic>i</italic></sub>/<italic>τ</italic>, indicates the reasons for the long-time failure of the standard LNA. It is unable to cope with the increasing phase deviations. This motivates the phase correction approach used in the simulation algorithm we now define.</p>
<p>The approach is to amend the LNA Ansatz <italic>X</italic>(<italic>t</italic>) = <italic>g</italic>(<italic>t</italic>) + Ω<sup>−1/2</sup> <italic>ξ</italic>(<italic>t</italic>) to <italic>X</italic>(<italic>t</italic>) = <italic>g</italic>(<italic>s</italic>) + Ω<sup>−1/2</sup> <italic>κ</italic>(<italic>s</italic>) where <italic>g</italic>(<italic>s</italic>) = <italic>G<sub>N</sub></italic>(<italic>X</italic>(<italic>t</italic>)) and to use resetting of <italic>t</italic> to <italic>s</italic> to cope with the growth in the variance of <inline-formula id="pcbi.1005676.e062"><alternatives><graphic id="pcbi.1005676.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> keeping the LNA fluctuation <italic>κ</italic>(<italic>s</italic>) normal to <italic>γ</italic>. While for free-running oscillators the variance of <italic>ξ</italic>(<italic>t</italic>) grows without bound as <italic>t</italic> increases, <italic>κ</italic>(<italic>s</italic>) has uniformly bounded variance.</p>
<p>The pcLNA simulation algorithm iteratively uses standard LNA steps of length Δ<italic>τ</italic> to move from a state <italic>X</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub>) to a new state <italic>X</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>) = <italic>X</italic><sub><italic>i</italic></sub>, <italic>i</italic> = 1, 2, …. After each LNA step, the phase of the system is reset or “corrected” such that <italic>g</italic>(<italic>s</italic><sub><italic>i</italic></sub>) = <italic>G</italic><sub><italic>N</italic></sub>(<italic>X</italic><sub><italic>i</italic></sub>) and the (global) fluctuations <italic>ξ</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>) = Ω<sup>1/2</sup>(<italic>X</italic><sub><italic>i</italic></sub> − <italic>g</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>)) are replaced by the normally transversal fluctuation <italic>κ</italic>(<italic>s</italic><sub><italic>i</italic></sub>) = Ω<sup>1/2</sup>(<italic>X</italic><sub><italic>i</italic></sub> − <italic>g</italic>(<italic>s</italic><sub><italic>i</italic></sub>)) which are MVN distributed and, as we showed in the previous section, approximate well the transversal fluctuations under the exact Markov Jump process.</p>
<p>The steps of the pcLNA simulation algorithm are described next in more detail (see also <xref ref-type="fig" rid="pcbi.1005676.g007">Fig 7</xref>).</p>
<fig id="pcbi.1005676.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005676.g007</object-id>
<label>Fig 7</label>
<caption>
<title>The main step in the pcLNA algorithm.</title>
<p>The solid horizontal bars below the horizontal axis are all of length Δ<italic>τ</italic>, the basic time step of the algorithm. The black arrows show <inline-formula id="pcbi.1005676.e063"><alternatives><graphic id="pcbi.1005676.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mo>Ω</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the grey arrows <inline-formula id="pcbi.1005676.e064"><alternatives><graphic id="pcbi.1005676.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mo>Ω</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Having calculated <inline-formula id="pcbi.1005676.e065"><alternatives><graphic id="pcbi.1005676.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> one uses <italic>κ</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub>) as the initial state and updates it using the LNA and a time-step Δ<italic>τ</italic> to obtain <italic>ξ</italic> at <italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>. Then <italic>ξ</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>) is replaced by <italic>κ</italic>(<italic>s</italic><sub><italic>i</italic></sub>) so that <italic>g</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>) + Ω<sup>−1/2</sup> <italic>ξ</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>) = <italic>g</italic>(<italic>s</italic><sub><italic>i</italic></sub>) + Ω<sup>−1/2</sup> <italic>κ</italic>(<italic>s</italic><sub><italic>i</italic></sub>) where <italic>κ</italic>(<italic>s</italic><sub><italic>i</italic></sub>) is normal to the limit cycle. Therefore, <italic>s</italic><sub><italic>i</italic></sub> gives the phase of <italic>κ</italic>(<italic>s</italic><sub><italic>i</italic></sub>) and the corresponding time is <italic>t</italic><sub><italic>i</italic></sub> = <italic>t</italic><sub>0</sub> + <italic>iΔτ</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.g007" xlink:type="simple"/>
</fig>
<list list-type="order">
<list-item>
<p>Choose a time-step size Δ<italic>τ</italic> &gt; 0.</p>
</list-item>
<list-item>
<p>Input <bold>initial conditions</bold> <italic>κ</italic>(<italic>s</italic><sub>0</sub>) and <italic>X</italic><sub>0</sub> = <italic>g</italic>(<italic>s</italic><sub>0</sub>) + Ω<sup>−1/2</sup> <italic>κ</italic>(<italic>s</italic><sub>0</sub>).</p>
</list-item>
<list-item>
<p><bold>For iteration</bold> <italic>i</italic> = 1, 2, …</p>
<list list-type="alpha-lower">
<list-item>
<p>sample <italic>ξ</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>) from MVN(<italic>C</italic><sub><italic>i</italic></sub> <italic>κ</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub>), <italic>V</italic><sub><italic>i</italic></sub>);</p>
</list-item>
<list-item>
<p>compute <italic>X</italic><sub><italic>i</italic></sub> = <italic>g</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>) + Ω<sup>−1/2</sup> <italic>ξ</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>);</p>
</list-item>
<list-item>
<p>set <italic>s</italic><sub><italic>i</italic></sub> to be such that <italic>G<sub>N</sub></italic>(<italic>X</italic><sub><italic>i</italic></sub>) = <italic>g</italic>(<italic>s</italic><sub><italic>i</italic></sub>) and <italic>κ</italic><sub><italic>i</italic></sub> = Ω<sup>1/2</sup>(<italic>X</italic><sub><italic>i</italic></sub> − <italic>g</italic>(<italic>s</italic><sub><italic>i</italic></sub>)).</p>
</list-item>
</list>
</list-item>
</list>
<p>In the for loop <italic>C</italic><sub><italic>i</italic></sub> = <italic>C</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub>, <italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>) and <italic>V</italic><sub><italic>i</italic></sub> = <italic>V</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub>, <italic>s</italic><sub><italic>i</italic> − 1</sub> + Δ<italic>τ</italic>) are the drift and diffusion matrices in the linear SDE describing the evolution of the noise process <italic>ξ</italic>(<italic>t</italic>) under the LNA (see S1 Sect. 4).</p>
<p>The simulated sample <italic>X</italic><sub><italic>i</italic></sub> corresponds to time <italic>t</italic><sub><italic>i</italic></sub> = <italic>t</italic><sub>0</sub> + <italic>iΔτ</italic>, <italic>i</italic> = 1, 2, …, where <italic>t</italic><sub>0</sub> is the initial time. The time <italic>t</italic><sub><italic>i</italic></sub> is not necessarily equal to the phase <italic>s</italic><sub><italic>i</italic></sub>, defined by the relation <italic>g</italic>(<italic>s</italic><sub><italic>i</italic></sub>) = <italic>G</italic><sub><italic>N</italic></sub>(<italic>X</italic><sub><italic>i</italic></sub>), which is stochastic and has variance linearly increasing with the time step Δ<italic>τ</italic>.</p>
<p>If one wants to record simulated trajectories at a finer time-scale than Δ<italic>τ</italic> then one can run the algorithm with Δ<italic>τ</italic> replaced by Δ<italic>τ</italic>/<italic>M</italic> for some integer <italic>M</italic> &gt; 1 and only carry out the phase correction in step 3(c) every <italic>M</italic>th step and at all the other steps just proceeding as in the standard LNA (ignoring step 3(c)). This gives the same distribution as if the intermediate points had not been calculated because of the transitive nature of the LNA i.e. the distribution <italic>P</italic><sub>LNA</sub>(<italic>X</italic>(<italic>s</italic> + <italic>t</italic>)|<italic>X</italic>(0)) is equal to the distribution <italic>P</italic><sub>LNA</sub>(<italic>X</italic>(<italic>t</italic>)|<italic>X</italic>(<italic>s</italic>)∼<italic>P</italic><sub>LNA</sub>(<italic>X</italic>(<italic>s</italic>)|<italic>X</italic>(0))). In the simulation results described below the time-step Δ<italic>τ</italic> = 6 hours and <italic>M</italic> = 3 so that there are <italic>τ</italic>/6 ≈ 4.5 corrections in every round of the limit cycle. The effect of less frequent correction is studied in S2 Sect. 5.</p>
<sec id="sec007">
<title>Comparisons to other simulation algorithms</title>
<p>We compared the pcLNA simulation algorithm in terms of both CPU time and precision of the approximation with some of the most important alternatives, the tau-leap method and integration of the chemical Langevin equation (CLE) method. Exact simulations produced by the SSA are also used as a reference for the comparison.</p>
<p>For the tau-leap simulation we use the algorithm described in [<xref ref-type="bibr" rid="pcbi.1005676.ref003">3</xref>], which is a refinement of the original tau-leap method first proposed in [<xref ref-type="bibr" rid="pcbi.1005676.ref002">2</xref>]. In [<xref ref-type="bibr" rid="pcbi.1005676.ref003">3</xref>] the authors suggest an optimal method to compute the largest possible time step such that the leap condition is still approximately satisfied. The leap condition ensures that the state change in any time step is small enough so that no rate function will experience a macroscopically significant change in its value. The error of this approximation is controlled by a parameter <italic>ϵ</italic>. For integrating the CLE described in [<xref ref-type="bibr" rid="pcbi.1005676.ref004">4</xref>], we use the classical Euler method (see [<xref ref-type="bibr" rid="pcbi.1005676.ref032">32</xref>]) with a fixed time step Δ<italic>t</italic>. The integration of the CLE can be done using methods that include higher-order terms in the integration and this has been shown to improve the speed of implementation in low-dimensional systems, albeit with a cost in the complexity of the algorithm (see [<xref ref-type="bibr" rid="pcbi.1005676.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1005676.ref034">34</xref>]). However, we are not aware of any implementations of these methods for high-dimensional systems such as those considered here, or of comparisons of such methods to the Euler method for such problems.</p>
<p>For both the tau-leap and the CLE approximation we explored different values of their parameters <italic>ϵ</italic> and Δ<italic>t</italic> to attain a good balance of precision and CPU time. Here we present the results for the largest values of both <italic>ϵ</italic> and Δ<italic>t</italic>, hence smallest CPU time, which attain similar performance with the pcLNA algorithm in terms of precision. If little improvement could be achieved in terms of precision by lowering either <italic>ϵ</italic> or Δ<italic>t</italic>, the larger values are preferred.</p>
<p>The algorithms are implemented for a fixed time-interval (8.5 times the period of the limit cycle of the system) and the comparison is made at 8 fixed time points using the KS distances between the empirical distribution of each algorithm and the empirical distribution derived using the SSA simulations. Note that for all approximation algorithms considered here, the probability of generating negative populations is non-zero and there are a number of methods for dealing with this. Our simple approach is described in S1 Sect. 13.</p>
<p><xref ref-type="fig" rid="pcbi.1005676.g008">Fig 8</xref> displays the median CPU times for a single trajectory simulation in <italic>t</italic> ∈ [0, 8.5<italic>τ</italic>], under the competing approaches for different system sizes, Ω = 300, 1000, 3000, along with a comparison in terms of precision for Ω = 300 (see Figs G &amp; H in <xref ref-type="supplementary-material" rid="pcbi.1005676.s002">S2 Appendix</xref> for Ω = 1000 &amp; 3000). A sample of size <italic>R</italic> = 2000 is produced for each algorithm. We see that the precision of all approximation methods is fairly similar, with their empirical distributions almost indistinguishable to exact simulations. In terms of CPU times, we see that the SSA is much slower than the other algorithms particularly for large system sizes. The tau-leap offers some improvement to the CPU times but this is relatively small compared to the CLE approximation and especially the pcLNA algorithm. One reason for this relatively small improvement for the tau-leap algorithm is the stiffness of the considered system, a property that is however very common in biological systems and it is known to slow down the tau-leap method by requiring small values of the <italic>ϵ</italic> parameter to ensure that the leap condition is satisfied and hence the approximation is fairly precise. Note that for similar reasons, a small Δ<italic>t</italic> was necessary to achieve good precision with the CLE approximation.</p>
<fig id="pcbi.1005676.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005676.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Comparison between pcLNA, tau-leap and CLE simulation algorithms for the <italic>Drosophila</italic> circadian clock.</title>
<p>Panels (A), (B) and (C) contain the samples (in concentrations, units as in <xref ref-type="fig" rid="pcbi.1005676.g001">Fig 1</xref>) produced by respectively the pcLNA, tau-leap (<italic>ϵ</italic> = 0.002) and CLE (Δ<italic>t</italic> = 0.002) algorithms and the exact simulation (SSA) at time-points <italic>t</italic> = <italic>τ</italic>, 2<italic>τ</italic>, …, 8<italic>τ</italic>, for Ω = 300, along with the KS distances between the empirical distributions of each approximation and the SSA for each system variable (coloured bars; variable names as in <xref ref-type="fig" rid="pcbi.1005676.g003">Fig 3</xref>). Panel (D) provides the median CPU times for a single trajectory run in the time-interval [0, 8.5<italic>τ</italic>] under the different simulation algorithms along with the ratio of the median CPU time under SSA and each approximation algorithm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.g008" xlink:type="simple"/>
</fig>
<p>As we can see in <xref ref-type="fig" rid="pcbi.1005676.g008">Fig 8</xref>, the pcLNA algorithm is about 24 times faster than the CLE approximation, tens to hundreds of times faster than the tau-leap and hundreds to thousands of times faster than the SSA. In our simulations, it took 0.4sec to derive this long-time trajectory, which means that in about 7 minutes one can generate more than 1000 trajectories of this large system over a long-time compared to about 2.7 hours with CLE approximation and much longer times for the other methods. Therefore, the pcLNA offers a substantial improvement in CPU times compared to standard approaches in simulating oscillatory systems without compromising the precision of the simulation substantially.</p>
<p>Perhaps more importantly, this pcLNA simulation algorithm has the advantage of being based on an analytical framework that allows calculation of some key distributions. Therefore, it enables more rigorous methods for assessing accuracy and robustness.</p>
</sec>
</sec>
<sec id="sec008">
<title>Analysis and inference of oscillatory systems using pcLNA</title>
<p>The derivation of analytical expressions of the transversal distributions allows us to analyse various aspects of the stochastic behaviour of these systems that can possibly involve a large number of variables and parameters. Here we illustrate the use of pcLNA transversal distributions to perform such an analysis. We begin by describing the pcLNA joint distribution of multiple intersections to possibly different transversal sections on the limit cycle and then discuss Fisher information, sensitivity analysis and estimation by Kalman filtering.</p>
<sec id="sec009">
<title>Joint distribution on multiple transversals</title>
<p>Consider <italic>q</italic> phase states of the limit cycle <italic>x</italic><sub><italic>i</italic></sub> = <italic>g</italic>(<italic>t</italic><sub><italic>i</italic></sub>), <italic>i</italic> = 1, …, <italic>q</italic>, on <italic>γ</italic> where 0 ≤ <italic>t</italic><sub>1</sub> &lt; <italic>t</italic><sub>2</sub> &lt; … &lt; <italic>t</italic><sub><italic>q</italic></sub> &lt; <italic>τ</italic>. If <italic>X</italic>(<italic>t</italic>) is a stochastic trajectory, we consider how it meets the transversal sections at the <italic>x</italic><sub><italic>i</italic></sub> as <italic>t</italic> increases using the lifted phase function <inline-formula id="pcbi.1005676.e066"><alternatives><graphic id="pcbi.1005676.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. We can talk of the times when <italic>G<sub>N</sub></italic>(<italic>X</italic>(<italic>t</italic>)) first takes the phase <italic>x</italic><sub><italic>i</italic></sub> during the <italic>r</italic>-th revolution of <italic>G<sub>N</sub></italic>(<italic>X</italic>(<italic>t</italic>)) around <italic>γ</italic>. Using <inline-formula id="pcbi.1005676.e067"><alternatives><graphic id="pcbi.1005676.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula> to define the points <inline-formula id="pcbi.1005676.e068"><alternatives><graphic id="pcbi.1005676.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> we have that it first meets <inline-formula id="pcbi.1005676.e112"><alternatives><graphic id="pcbi.1005676.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> in <inline-formula id="pcbi.1005676.e069"><alternatives><graphic id="pcbi.1005676.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> for <italic>i</italic> = 1, …, <italic>q</italic>. If <italic>i</italic> &lt; <italic>q</italic> then we let <inline-formula id="pcbi.1005676.e070"><alternatives><graphic id="pcbi.1005676.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> denote the first point in <inline-formula id="pcbi.1005676.e113"><alternatives><graphic id="pcbi.1005676.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> that <italic>X</italic> meets after it leaves <inline-formula id="pcbi.1005676.e071"><alternatives><graphic id="pcbi.1005676.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. If <italic>i</italic> = <italic>q</italic> then the next transversal it meets is <inline-formula id="pcbi.1005676.e114"><alternatives><graphic id="pcbi.1005676.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and the intersection point is <inline-formula id="pcbi.1005676.e072"><alternatives><graphic id="pcbi.1005676.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. In this way (see <xref ref-type="fig" rid="pcbi.1005676.g009">Fig 9</xref>) we derive a sequence of intersection points <inline-formula id="pcbi.1005676.e073"><alternatives><graphic id="pcbi.1005676.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:munder><mml:mi>Q</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>q</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>q</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>q</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<fig id="pcbi.1005676.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005676.g009</object-id>
<label>Fig 9</label>
<caption>
<title>The sequence <italic>Q</italic> in two-dimensions.</title>
<p>The stochastic trajectory <italic>X</italic>(<italic>t</italic>) (blue line), initiated from <italic>x</italic><sub>0</sub>, intersects each of the transversal sections <italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub> and <italic>x</italic><sub>3</sub> (dashed lines) of the limit cycle (red solid line) three times, following a path <inline-formula id="pcbi.1005676.e074"><alternatives><graphic id="pcbi.1005676.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>→</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>→</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>→</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>→</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>→</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>→</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>3</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>→</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>3</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>→</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>3</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.g009" xlink:type="simple"/>
</fig>
<p>We shall be interested in the distribution
<disp-formula id="pcbi.1005676.e075"><alternatives><graphic id="pcbi.1005676.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e075" xlink:type="simple"/><mml:math display="block" id="M75"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:munder><mml:mi>Q</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>q</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
Remarkably, in our approximation, this distribution is MVN with a covariance matrix whose inverse has a simple tridiagonal form in terms of the drift and diffusion matrices coming from the LNA (S1 Sects. 9.2 &amp; 9.3).</p>
<p>The fact that the above transversal distributions are MVN allows us to analytically compute the Fisher Information matrix and associated quantities that can be used to perform a stochastic sensitivity analysis of oscillatory systems.</p>
</sec>
</sec>
<sec id="sec010">
<title>Fisher information</title>
<p>Fisher Information quantifies the information that an observable random variable carries about an unknown parameter <italic>θ</italic>. If <italic>P</italic>(<italic>X</italic>, <italic>θ</italic>) is a probability distribution depending on parameters <italic>θ</italic>, the Fisher Information Matrix (FIM) <italic>I</italic> = <italic>I</italic><sub><italic>P</italic></sub> has entries
<disp-formula id="pcbi.1005676.e076"><alternatives><graphic id="pcbi.1005676.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e076" xlink:type="simple"/><mml:math display="block" id="M76"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ℓ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ℓ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>ℓ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>;</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where ℓ = log <italic>P</italic>, and <italic>θ</italic><sub><italic>i</italic></sub> and <italic>θ</italic><sub><italic>j</italic></sub> are the <italic>i</italic>th and <italic>j</italic>th components of the parameter <italic>θ</italic>. If <italic>P</italic> is MVN with mean and covariance <italic>μ</italic> = <italic>μ</italic>(<italic>θ</italic>) and Σ = Σ(<italic>θ</italic>) then
<disp-formula id="pcbi.1005676.e077"><alternatives><graphic id="pcbi.1005676.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e077" xlink:type="simple"/><mml:math display="block" id="M77"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>μ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>μ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mtext>tr</mml:mtext> <mml:mo>(</mml:mo> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mo>Σ</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mo>Σ</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p>The FIM measures the sensitivity of <italic>P</italic> to a change in parameters in the sense that
<disp-formula id="pcbi.1005676.e078"><alternatives><graphic id="pcbi.1005676.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e078" xlink:type="simple"/><mml:math display="block" id="M78"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:mi>δ</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>δ</mml:mi> <mml:msup><mml:mi>θ</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:msub><mml:mi>I</mml:mi> <mml:mi>P</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mtext>O</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>‖</mml:mo> <mml:mi>δ</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>‖</mml:mo></mml:mrow> <mml:mn>3</mml:mn></mml:msup> <mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>D</italic><sub><italic>KL</italic></sub> is the Kullback-Leibler divergence. The significance of the FIM for sensitivity and experimental design follows from its role in <xref ref-type="disp-formula" rid="pcbi.1005676.e076">Eq (6)</xref> as an approximation to the Hessian of the log-likelihood function at a maximum. Assuming non-degeneracy, if <italic>θ</italic>* is a parameter value of maximum likelihood there is a <italic>s</italic> × <italic>s</italic> orthogonal matrix <italic>V</italic> such that, in the new parameters <italic>θ</italic>′ = <italic>V</italic> ⋅ (<italic>θ</italic> − <italic>θ</italic>*),
<disp-formula id="pcbi.1005676.e079"><alternatives><graphic id="pcbi.1005676.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e079" xlink:type="simple"/><mml:math display="block" id="M79"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msup><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
for <italic>θ</italic> near <italic>θ</italic>*. From these facts it follows that the <inline-formula id="pcbi.1005676.e080"><alternatives><graphic id="pcbi.1005676.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> are the eigenvalues of the FIM and that the matrix <italic>V</italic> diagonalises it. If we assume that the <italic>σ</italic><sub><italic>i</italic></sub> are ordered so that <inline-formula id="pcbi.1005676.e081"><alternatives><graphic id="pcbi.1005676.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mo>…</mml:mo> <mml:mo>≥</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> then it follows that near the maximum the likelihood is most sensitive when <inline-formula id="pcbi.1005676.e082"><alternatives><graphic id="pcbi.1005676.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:msubsup><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is varied and least sensitive when <inline-formula id="pcbi.1005676.e083"><alternatives><graphic id="pcbi.1005676.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is. Moreover, <italic>σ</italic><sub><italic>i</italic></sub> is a measure of this sensitivity.</p>
<p>The theory of optimal experimental design is based on the idea of trying to make the <italic>σ</italic><sub><italic>i</italic></sub> decrease as slowly as possible so that the likelihood is as peaked as possible around the maximum, thus maximising the information content of the experimental sampling methods. Various criteria for experimental design have been proposed including D-optimality that maximises the determinant of the FIM and A-optimality that minimises the trace of the inverse of the FIM [<xref ref-type="bibr" rid="pcbi.1005676.ref006">6</xref>]. Diagonal elements of the inverse of FIM constitute a lower-bound for variance of any unbiased estimator of elements of <italic>θ</italic> (Cramer-Rao inequality). However, for the systems we consider here the <italic>σ</italic><sub><italic>i</italic></sub> typically decrease very fast and there are many of them. Thus, in general, criteria based on a single number are more likely to be of less use than consideration of the set of <italic>σ</italic><sub><italic>i</italic></sub> as a whole.</p>
<p>Calculation of the FIM for stochastic systems using the LNA has been carried out in [<xref ref-type="bibr" rid="pcbi.1005676.ref022">22</xref>] but only for small systems and short times where the LNA is accurate. It is notable that the pcLNA enables one to do such sensitivity analysis for large systems and large times. As an example, we analyse the stochastic behaviour of the <italic>Drosophila</italic> circadian clock based on the limit distribution <inline-formula id="pcbi.1005676.e084"><alternatives><graphic id="pcbi.1005676.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:munder><mml:mi>Q</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> when
<disp-formula id="pcbi.1005676.e085"><alternatives><graphic id="pcbi.1005676.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e085" xlink:type="simple"/><mml:math display="block" id="M85"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mi>Q</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>x</italic><sub>0</sub> = <italic>g</italic>(<italic>t</italic><sub>0</sub>) and <italic>x</italic><sub>1</sub> = <italic>g</italic>(<italic>t</italic><sub>1</sub>) are chosen so that <italic>t</italic><sub>0</sub> is the time of the peak of <italic>per</italic> mRNA <italic>M</italic><sub><italic>P</italic></sub>, and <italic>t</italic><sub>1</sub> is the peak of the nuclear complex of PER and TIM proteins <italic>C</italic><sub><italic>N</italic></sub>. We compute the Fisher Information of the distribution <inline-formula id="pcbi.1005676.e086"><alternatives><graphic id="pcbi.1005676.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:munder><mml:mi>Q</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> using the closed form expression (S1 Sect. 9.3) for this distribution. As we can see in <xref ref-type="fig" rid="pcbi.1005676.g010">Fig 10(A)</xref> the eigenvalues of the Fisher Information matrix decay exponentially, with a sharp decline followed by a slower decrease. This reveals that the influential directions in the parameter space of the system are much less than its total dimension and that only a few parameters appear to be most influential. The eigenvectors associated with the two largest eigenvalues of the Fisher Information matrix (see <xref ref-type="fig" rid="pcbi.1005676.g010">Fig 10(B)</xref>) have large entries only for the parameters <italic>k</italic><sub><italic>dn</italic></sub> (PER-TIM complex nuclear degradation), <italic>k</italic><sub><italic>d</italic></sub> (<italic>per</italic> mRNA linear degradation), <italic>k</italic><sub>2</sub> (PER-TIM complex transportation to cytosol), <italic>v</italic><sub><italic>st</italic></sub> (<italic>tim</italic> mRNA transcription), <italic>k</italic><sub><italic>ip</italic></sub> (<italic>per</italic> mRNA Hill coefficient) and <italic>k</italic><sub><italic>it</italic></sub> (<italic>tim</italic> mRNA Hill coefficient).</p>
<fig id="pcbi.1005676.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005676.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Fisher information and stochastic sensitivity analysis of the transversal distribution of the <italic>Drosophila</italic> circadian clock system at the times of the peaks of <italic>per</italic> mRNA and the nuclear complex of PER and TIM proteins.</title>
<p>(A) The logarithm of the eigenvalues of the Fisher Information Matrix (FIM). (B) The entries/weights of the eigenvectors corresponding to the 2 largest eigenvalues of FIM (C) The largest principal control coefficients <italic>S</italic><sub><italic>ij</italic></sub>. Small values are reduced to 0.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.g010" xlink:type="simple"/>
</fig>
<p>The exponential decrease of the eigenvalues is typical of tightly coupled deterministic systems [<xref ref-type="bibr" rid="pcbi.1005676.ref025">25</xref>–<xref ref-type="bibr" rid="pcbi.1005676.ref031">31</xref>], but has to our knowledge not been demonstrated before for stochastic systems. It has important consequences. For example, it tells us that only a few parameters can be estimated efficiently from time-series data unless the system is perturbed in some way to get complementary data and that there will be identifiability problems that can be analysed using the FIM. It can also be used to design experiments by considering the FIM of a combination of models including one for the proposed new experiment, choosing the new experiment so as to optimally alleviate the decline of the eigenvalues.</p>
</sec>
<sec id="sec011">
<title>Sensitivity analysis for stochastic systems</title>
<p>The fact that we can calculate the Fisher Information allows a new approach to sensitivity analysis for stochastic systems. Anderson [<xref ref-type="bibr" rid="pcbi.1005676.ref023">23</xref>] and Srivastava et al. [<xref ref-type="bibr" rid="pcbi.1005676.ref024">24</xref>] also perform sensitivity analysis for small stochastic systems (up to 4 species and 8 reactions) in which they calculate the dependence of certain summary functions or statistics at one or more times to individual parameters. Our approach is different in that we use the fact that our distributions of interest are MVN and measure the change in the distribution of the system state at any given set of phases without recourse to any summary function and, moreover, this change is calculated for any combination of parameter variations. A major difference is our use of SVD below to find a basis of mean-covariance space using the principal components that enables us to decompose these changes into different orthogonal directions that pick out the important and unimportant directions. The approach can also be formulated for the wider class of exponential families i.e. distributions that admit a representation of the form
<disp-formula id="pcbi.1005676.e087"><alternatives><graphic id="pcbi.1005676.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e087" xlink:type="simple"/><mml:math display="block" id="M87"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>F</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
in terms of functions <italic>C</italic>, <italic>F</italic><sub>1</sub>, …<italic>F</italic><sub><italic>m</italic></sub> of the state variable <italic>x</italic> and a function <italic>φ</italic> of the parameters <italic>θ</italic>.</p>
<p>We consider a family of probability distributions <italic>P</italic>(<italic>X</italic>, <italic>θ</italic>) which we assume are MVN with mean <italic>μ</italic>(<italic>θ</italic>) and covariance matrix Σ(<italic>θ</italic>) depending on the parameters <italic>θ</italic>. We show that there is a natural matrix of sensitivities <italic>S</italic><sub><italic>ij</italic></sub> associated with such a system. These are system-global in that they look at how all components of the systems change with parameters. They also have an intimate relationship with Fisher information. Note that these results are not restricted to the transversal distributions derived in previous sections but apply more generally to any MVN distribution with mean <italic>μ</italic> = <italic>μ</italic>(<italic>θ</italic>) and covariance matrix Σ = Σ(<italic>θ</italic>) parameterised by a <italic>s</italic>-dimensional vector <italic>θ</italic>, <italic>s</italic> ≥ 1.</p>
<p>As is well-known in Information Geometry, the set of multivariate normal distributions MVN<sup><italic>n</italic></sup> on ℝ<sup><italic>n</italic></sup> can be given the structure of a Riemannian manifold in which the Riemannian metric is given by the line element
<disp-formula id="pcbi.1005676.e088"><alternatives><graphic id="pcbi.1005676.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e088" xlink:type="simple"/><mml:math display="block" id="M88"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>d</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:mi>d</mml:mi> <mml:msup><mml:mi>μ</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mspace width="0.166667em"/><mml:mi>d</mml:mi> <mml:mi>μ</mml:mi> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>tr</mml:mtext> <mml:mrow><mml:mo>{</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>d</mml:mi> <mml:mo>Σ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Points in MVN<sup><italic>n</italic></sup> are denoted by Θ = (<italic>μ</italic>, Σ) where <italic>μ</italic> is the mean and Σ the covariance matrix. The corresponding inner product in the tangent space at Θ<sub>0</sub> = (<italic>μ</italic>, Σ) is given by
<disp-formula id="pcbi.1005676.e089"><alternatives><graphic id="pcbi.1005676.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e089" xlink:type="simple"/><mml:math display="block" id="M89"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:mi>δ</mml:mi> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mi>δ</mml:mi> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>0</mml:mn></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>μ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>μ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mtext>tr</mml:mtext> <mml:mo>(</mml:mo> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>δ</mml:mi> <mml:msub><mml:mo>Σ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>δ</mml:mi> <mml:msub><mml:mo>Σ</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where <italic>δ</italic>Θ<sub><italic>j</italic></sub> = (<italic>δμ</italic><sub><italic>j</italic></sub>, <italic>δ</italic>Σ<sub><italic>j</italic></sub>), <italic>j</italic> = 1, 2.</p>
<p>In calculating the FIM we have to determine the partial derivatives ∂<italic>μ</italic>/∂<italic>θ</italic><sub><italic>i</italic></sub> and ∂Σ/∂<italic>θ</italic><sub><italic>i</italic></sub>. The derivative <italic>M</italic> of the mapping <italic>θ</italic> → (<italic>μ</italic>(<italic>θ</italic>), Σ(<italic>θ</italic>)) at a parameter value <italic>θ</italic><sub>0</sub> is given by
<disp-formula id="pcbi.1005676.e090"><alternatives><graphic id="pcbi.1005676.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e090" xlink:type="simple"/><mml:math display="block" id="M90"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi> <mml:mo>·</mml:mo> <mml:mi>δ</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>μ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mo>Σ</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where the derivatives are calculated at <italic>θ</italic><sub>0</sub>.</p>
<p>We can regard <italic>M</italic> as a linear mapping between the parameter space ℝ<sup><italic>s</italic></sup> and MVN<sup><italic>n</italic></sup> with the inner product given in <xref ref-type="disp-formula" rid="pcbi.1005676.e089">Eq (8)</xref>. We can then prove (S1 Sect. 11) that we can find <italic>s</italic> orthonormal vectors <italic>V</italic><sub><italic>i</italic></sub> spanning the parameter space ℝ<sup><italic>s</italic></sup>, <italic>s</italic> orthonormal vectors <italic>U</italic><sub><italic>i</italic></sub> in the space MVN<sup><italic>n</italic></sup> and numbers <italic>σ</italic><sub>1</sub> ≥ ⋯ ≥ <italic>σ</italic><sub><italic>s</italic></sub> ≥ 0 such that
<disp-formula id="pcbi.1005676.e091"><alternatives><graphic id="pcbi.1005676.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e091" xlink:type="simple"/><mml:math display="block" id="M91"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi> <mml:msub><mml:mi>V</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>U</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula></p>
<p>Note that the orthonormality of the <italic>U</italic><sub><italic>i</italic></sub> is with respect to the inner product 〈⋅, ⋅〉<sub>Θ<sub>0</sub></sub>. The eigenvalues of the FIM <italic>F</italic> are the squares of the <italic>σ</italic><sub><italic>i</italic></sub> because with respect to the standard inner product on <italic>θ</italic>-space and 〈⋅, ⋅〉<sub>Θ<sub>0</sub></sub> on MVN<sup><italic>n</italic></sup> the adjoint <italic>M</italic>* satisfies <italic>M</italic>* <italic>M</italic> = <italic>F</italic> (S1 Sect. 11).</p>
<p>If we let <inline-formula id="pcbi.1005676.e092"><alternatives><graphic id="pcbi.1005676.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>i</mml:mi> <mml:mi>μ</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>i</mml:mi> <mml:mo>Σ</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> denote the decomposition of <italic>U</italic><sub><italic>i</italic></sub> into <italic>μ</italic> and Σ components, then the following key property follows from <xref ref-type="disp-formula" rid="pcbi.1005676.e091">Eq (9)</xref>: if <italic>δθ</italic> is any change of parameters, the change in <italic>μ</italic> and Σ is given by
<disp-formula id="pcbi.1005676.e093"><alternatives><graphic id="pcbi.1005676.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e093" xlink:type="simple"/><mml:math display="block" id="M93"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>δ</mml:mi> <mml:mi>μ</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>i</mml:mi> <mml:mi>μ</mml:mi></mml:msubsup> <mml:mo>(</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mtext>O</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>‖</mml:mo> <mml:mi>δ</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>‖</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>δ</mml:mi> <mml:mo>Σ</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>i</mml:mi> <mml:mo>Σ</mml:mo></mml:msubsup> <mml:mo>(</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mtext>O</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>‖</mml:mo> <mml:mi>δ</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>‖</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <italic>S</italic><sub><italic>ij</italic></sub> = <italic>σ</italic><sub><italic>i</italic></sub> <italic>V</italic><sub><italic>ji</italic></sub>.</p>
<p>One can define other sensitivities in a similar way but using a different orthogonal basis of MVN<sup><italic>n</italic></sup>, but the above <italic>S</italic><sub><italic>ij</italic></sub> satisfy an important optimality condition explained in S1 Sect. 11 which asserts that the basis <italic>U</italic><sub><italic>i</italic></sub> and the corresponding sensitivities <italic>S</italic><sub><italic>ij</italic></sub> are optimal for capturing as much sensitivity as possible in the low order principal components <italic>U</italic><sub><italic>i</italic></sub>.</p>
<p>In view of this we call the <italic>S</italic><sub><italic>ij</italic></sub> the <italic>principal control coefficients</italic>. Note that the role of the <italic>S</italic><sub><italic>ij</italic></sub> as sensitivities is seen from the following relation which follows from <xref ref-type="disp-formula" rid="pcbi.1005676.e093">Eq (10)</xref> (where <italic>S</italic> = (<italic>S</italic><sub><italic>ij</italic></sub>)),
<disp-formula id="pcbi.1005676.e094"><alternatives><graphic id="pcbi.1005676.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e094" xlink:type="simple"/><mml:math display="block" id="M94"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∥</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>Θ</mml:mo> <mml:mo>∥</mml:mo> <mml:mo>=</mml:mo> <mml:mo>∥</mml:mo> <mml:mi>S</mml:mi> <mml:mo>·</mml:mo> <mml:mi>δ</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>∥</mml:mo> <mml:mo>+</mml:mo> <mml:mi>O</mml:mi> <mml:mo>(</mml:mo> <mml:mo>∥</mml:mo> <mml:mi>δ</mml:mi> <mml:mi>θ</mml:mi> <mml:msup><mml:mo>∥</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula></p>
<p>These sensitivities are relatively easy to calculate using the information in S1 Sect. 11. In <xref ref-type="fig" rid="pcbi.1005676.g010">Fig 10(C)</xref> we show the <italic>S</italic><sub><italic>ij</italic></sub> for the transversal distribution of the <italic>Drosophila</italic> circadian clock at the times of the peak of <italic>per</italic> mRNA and the peak of the nuclear complex of PER and TIM proteins. As we can see, because <italic>S</italic><sub><italic>ij</italic></sub> = <italic>σ</italic><sub><italic>i</italic></sub> <italic>V</italic><sub><italic>ji</italic></sub> the coefficients rapidly decrease with the singular values <italic>σ</italic><sub><italic>i</italic></sub>, while a few parameters, similar to those with large eigenvector entries, have high coefficients.</p>
</sec>
<sec id="sec012">
<title>Calculating likelihoods via a pcLNA Kalman Filter</title>
<p>The likelihood function of a set of time-series observations of a system can be used for parameter estimation, hypothesis testing and other forms of statistical inference. For example, one may wishes to use the likelihood function to estimate parameters of a biological system. Although there is no elegant formula for
<disp-formula id="pcbi.1005676.e095"><alternatives><graphic id="pcbi.1005676.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e095" xlink:type="simple"/><mml:math display="block" id="M95"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:munder><mml:mi>X</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
similar to that for <inline-formula id="pcbi.1005676.e096"><alternatives><graphic id="pcbi.1005676.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:munder><mml:mi>Q</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> above, we can efficiently calculate it. To do this we derive a Kalman Filter for the pcLNA that is a modification of the Kalman Filter associated with the LNA [<xref ref-type="bibr" rid="pcbi.1005676.ref035">35</xref>]. This can be used to compute the likelihood function <inline-formula id="pcbi.1005676.e097"><alternatives><graphic id="pcbi.1005676.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>;</mml:mo> <mml:mover accent="true"><mml:munder><mml:mi>X</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of the system parameters <italic>θ</italic> with respect to observations <inline-formula id="pcbi.1005676.e098"><alternatives><graphic id="pcbi.1005676.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mrow><mml:mover accent="true"><mml:munder><mml:mi>X</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> recorded at <italic>N</italic> times <italic>t</italic><sub>0</sub>, <italic>t</italic><sub>1</sub>, …, <italic>t</italic><sub><italic>N</italic></sub> that are noisy linear functions of the species concentrations. This is slightly more general than just calculating <inline-formula id="pcbi.1005676.e099"><alternatives><graphic id="pcbi.1005676.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:munder><mml:mi>X</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> because we allow for a measurement equation. The Kalman filter can also be used for forward prediction.</p>
<p>We assume the measurement equation,
<disp-formula id="pcbi.1005676.e100"><alternatives><graphic id="pcbi.1005676.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e100" xlink:type="simple"/><mml:math display="block" id="M100"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>B</mml:mi> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
relating the observations <inline-formula id="pcbi.1005676.e101"><alternatives><graphic id="pcbi.1005676.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to the state variables, <italic>X</italic>(<italic>t</italic>). Here <italic>B</italic> is a transformation matrix (often simply removing unobserved species or introducing unknown scalings) and <italic>ϵ</italic> = (<italic>ϵ</italic><sub>1</sub>, …, <italic>ϵ</italic><sub><italic>n</italic></sub>)∼<italic>MVN</italic>(0, Σ<sub><italic>ϵ</italic></sub>) the observational error. The pcLNA likelihood can be decomposed as the product
<disp-formula id="pcbi.1005676.e102"><alternatives><graphic id="pcbi.1005676.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e102" xlink:type="simple"/><mml:math display="block" id="M102"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>;</mml:mo> <mml:mover accent="true"><mml:munder><mml:mi>X</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>The pcLNA Kalman Filter algorithm, which we describe in more detail in S1 Sect. 15, uses a recursive algorithm for computing the terms in <inline-formula id="pcbi.1005676.e103"><alternatives><graphic id="pcbi.1005676.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>;</mml:mo> <mml:mover accent="true"><mml:munder><mml:mi>X</mml:mi> <mml:mo>_</mml:mo></mml:munder> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The algorithm proceeds by iteration <italic>i</italic> = 1, 2, … and uses Bayes rule to derive the posterior distributions of <inline-formula id="pcbi.1005676.e104"><alternatives><graphic id="pcbi.1005676.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and a phase correction to obtain <italic>g</italic>(<italic>s</italic><sub><italic>i</italic> − 1</sub>) = <italic>G<sub>N</sub></italic>(<italic>μ</italic>*(<italic>t</italic><sub><italic>i</italic> − 1</sub>)) and the corrected noise distribution of <inline-formula id="pcbi.1005676.e105"><alternatives><graphic id="pcbi.1005676.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> The LNA transition equation (S1 Eq. (4.2)) is then used to derive the distribution of <inline-formula id="pcbi.1005676.e106"><alternatives><graphic id="pcbi.1005676.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and the LNA ansantz <xref ref-type="disp-formula" rid="pcbi.1005676.e022">Eq (3)</xref> to obtain <inline-formula id="pcbi.1005676.e107"><alternatives><graphic id="pcbi.1005676.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> The measurement equation <xref ref-type="disp-formula" rid="pcbi.1005676.e100">Eq (12)</xref> is finally used to obtain the (<italic>i</italic> + 1)th term of the likelihood function <inline-formula id="pcbi.1005676.e108"><alternatives><graphic id="pcbi.1005676.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005676.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> before proceeding to the next iteration. All the distributions obtained in this way are MVN with easily computable parameter values.</p>
<p>If the observations are recorded in short time intervals, the phase correction can be omitted in some steps, in which case the algorithm proceeds as in [<xref ref-type="bibr" rid="pcbi.1005676.ref035">35</xref>]. Computational methods such as those described in [<xref ref-type="bibr" rid="pcbi.1005676.ref032">32</xref>] and [<xref ref-type="bibr" rid="pcbi.1005676.ref035">35</xref>] can then be used to perform likelihood-based statistical inference.</p>
</sec>
</sec>
<sec id="sec013" sec-type="materials|methods">
<title>Methods</title>
<p>All computations have been carried out using MATLAB Release 2016b, The MathWorks, Inc., Natick, MA, USA. In particular, the empirical CDF plots, (q-q) plots, histograms, smooth probability density functions and KS distances are derived using the ecdf, qqplot, histogram, ksdensity, kstest functions of MATLAB and Statistics Toolbox. The computations for the SSA, tau-leap, integration of diffusion and pcLNA simulation algorithms, and the computation of Fisher Information and principal control coefficients for the sensitivity analysis were performed using the PeTTSy software which is discussed in S1 Sect. 14 and is freely available at <ext-link ext-link-type="uri" xlink:href="http://www2.warwick.ac.uk/fac/sci/systemsbiology/research/software/" xlink:type="simple">http://www2.warwick.ac.uk/fac/sci/systemsbiology/research/software/</ext-link>. Further details concerning methods are given in S1 Sect. 16.</p>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>We present a comprehensive treatment of stochastic modelling for large stochastic oscillatory systems. Practical algorithms for fast long-term simulation and likelihood-based statistical inference are provided along with the essential tools for a more analytical study of such systems.</p>
<p>There is considerable scope for future work in various directions. We expect that these results can be extended to a broader class of systems including those that are chaotic in the Ω → ∞ limit. Our approach should provide the opportunity to develop new methodology for parameter estimation, likelihood-based inference and experimental design in such systems. Finally, there is currently much interest in information transfer and decision-making in signaling systems and our methods provide new tools with which to tackle problems in this area.</p>
<p>If system biologists are to reliably use complex stochastic models to provide robust understanding it is crucial that there are analytical tools to enable a rigorous assessment of the quality and selection of these models and their fit to current biological knowledge and data. Our aim in this paper is to contribute to that but the results should be of much broader interest.</p>
</sec>
<sec id="sec015">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005676.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Technical details.</title>
<p>In this note we give further details about the mathematical underpinnings of the pcLNA methods discussed in the main paper.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005676.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.s002" xlink:type="simple">
<label>S2 Appendix</label>
<caption>
<title><italic>Drosophila</italic> circadian clock system.</title>
<p>In this note we give details about the <italic>Drosophila</italic> circadian clock and use this system to illustrate further the accuracy of distributions and simulations discussed in the main paper.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005676.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005676.s003" xlink:type="simple">
<label>S3 Appendix</label>
<caption>
<title>Brusselator and NF-<italic>κ</italic>B systems.</title>
<p>In this note we give details about the deterministic and stochastic models of the Brusselator and NF-<italic>κ</italic>B systems and use them to illustrate further the results described in the main paper.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005676.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillespie</surname> <given-names>DT</given-names></name>. <article-title>Exact stochastic simulation of coupled chemical reactions</article-title>. <source>The Journal of Physical Chemistry</source>. <year>1977</year> <month>Dec</month>;<volume>81</volume>(<issue>25</issue>):<fpage>2340</fpage>–<lpage>2361</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/j100540a008" xlink:type="simple">10.1021/j100540a008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillespie</surname> <given-names>DT</given-names></name>. <article-title>Approximate accelerated stochastic simulation of chemically reacting systems</article-title>. <source>The Journal of Chemical Physics</source>. <year>2001</year> <month>Jul</month>;<volume>115</volume>(<issue>4</issue>):<fpage>1716</fpage>–<lpage>1733</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.1378322" xlink:type="simple">10.1063/1.1378322</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillespie</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Petzold</surname> <given-names>LR</given-names></name>. <article-title>Improved leap-size selection for accelerated stochastic simulation</article-title>. <source>The Journal of Chemical Physics</source>. <year>2003</year> <month>Oct</month>;<volume>119</volume>(<issue>16</issue>):<fpage>8229</fpage>–<lpage>8234</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.1613254" xlink:type="simple">10.1063/1.1613254</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillespie</surname> <given-names>DT</given-names></name>. <article-title>The chemical Langevin equation</article-title>. <source>The Journal of Chemical Physics</source>. <year>2000</year> <month>Jul</month>;<volume>113</volume>(<issue>1</issue>):<fpage>297</fpage>–<lpage>306</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.481811" xlink:type="simple">10.1063/1.481811</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref005">
<label>5</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>van Kampen</surname> <given-names>NG</given-names></name>. <source>Stochastic Processes in Physics and Chemistry</source>, <edition>Third Edition</edition>. <publisher-loc>Amsterdam</publisher-loc>: <publisher-name>Elsevier</publisher-name>. <publisher-loc>Boston and London</publisher-loc>: <publisher-name>Elsevier</publisher-name>; <year>2007</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005676.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kurtz</surname> <given-names>TG</given-names></name>. <article-title>Limit Theorems for Sequences of Jump Markov Processes Approximating Ordinary Differential Processes</article-title>. <source>Journal of Applied Probability</source>. <year>1971</year> <month>Jun</month>;<volume>8</volume>(<issue>2</issue>), <fpage>344</fpage>–<lpage>356</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1017/S002190020003535X" xlink:type="simple">10.1017/S002190020003535X</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref007">
<label>7</label>
<mixed-citation publication-type="other" xlink:type="simple">Kurtz TG. Approximation of Population Processes. Regional Conference Series in Applied Mathematics vol. 36. Society for Industrial and Applied Mathematics. 1981.</mixed-citation>
</ref>
<ref id="pcbi.1005676.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hayot</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Jayaprakash</surname> <given-names>C</given-names></name>. <article-title>The linear noise approximation for molecular fluctuations within cells</article-title>. <source>Physical Biology</source>. <year>2004</year> <month>Dec</month>;<volume>1</volume>(<issue>3–4</issue>):<fpage>205</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1478-3967/1/4/002" xlink:type="simple">10.1088/1478-3967/1/4/002</ext-link></comment> <object-id pub-id-type="pmid">16204840</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boland</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Galla</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>McKane</surname> <given-names>AJ</given-names></name>. <article-title>How limit cycles and quasi-cycles are related in systems with intrinsic noise</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source>. <year>2008</year> <month>Sep</month>;<fpage>P09001</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005676.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Koeppl</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hafner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ganguly</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mehrotra</surname> <given-names>A</given-names></name>. <article-title>Deterministic characterization of phase noise in biomolecular oscillators</article-title>. <source>Physical Biology</source>. <year>2011</year> <month>Oct</month>;<volume>8</volume>(<issue>5</issue>):<fpage>055008</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1478-3975/8/5/055008" xlink:type="simple">10.1088/1478-3975/8/5/055008</ext-link></comment> <object-id pub-id-type="pmid">21832803</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tomita</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ohta</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tomita</surname> <given-names>H</given-names></name>. <article-title>Irreversible Circulation and Orbital Revolution: Hard Mode Instability in Far-from-Equilibrium Situation</article-title>. <source>Progress of Theoretical Physics</source>. <year>1974</year> <month>Dec</month>;<volume>52</volume>(<issue>6</issue>):<fpage>1744</fpage>–<lpage>1765</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1143/PTP.52.1744" xlink:type="simple">10.1143/PTP.52.1744</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scott</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ingalls</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Kærn</surname> <given-names>M</given-names></name> (2006). <article-title>Estimations of intrinsic and extrinsic noise in models of nonlinear genetic networks</article-title>. <source>Chaos</source>. <year>2006</year> <month>Jun</month>;<volume>16</volume>(<issue>2</issue>):<fpage>026107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.2211787" xlink:type="simple">10.1063/1.2211787</ext-link></comment> <object-id pub-id-type="pmid">16822039</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ito</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Uchida</surname> <given-names>K</given-names></name>. <article-title>Formulas for intrinsic noise evaluation in oscillatory genetic networks</article-title>. <source>Journal of Theoretical Biology</source>. <year>2010</year> <month>Aug</month>;<volume>267</volume>(<issue>2</issue>):<fpage>223</fpage>–<lpage>234</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2010.08.025" xlink:type="simple">10.1016/j.jtbi.2010.08.025</ext-link></comment> <object-id pub-id-type="pmid">20800602</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schwabedal</surname> <given-names>JTC</given-names></name>, <name name-style="western"><surname>Pikovsky</surname> <given-names>A</given-names></name>. <article-title>Phase Description of Stochastic Oscillations</article-title>. <source>Physical Review Letters</source>. <year>2013</year> <month>May</month>;<volume>110</volume>(<issue>20</issue>):<fpage>204102</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.110.204102" xlink:type="simple">10.1103/PhysRevLett.110.204102</ext-link></comment> <object-id pub-id-type="pmid">25167416</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thomas PJ and Lindner</surname> <given-names>B</given-names></name>. <article-title>Asymptotic Phase for Stochastic Oscillators</article-title>. <source>Physical Review Letters</source>. <year>2014</year> <month>Dec</month>;<volume>113</volume>(<issue>25</issue>):<fpage>254101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.113.254101" xlink:type="simple">10.1103/PhysRevLett.113.254101</ext-link></comment> <object-id pub-id-type="pmid">25554883</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gonze</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Halloy</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Leloup</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Goldbeter</surname> <given-names>A</given-names></name>. <article-title>Stochastic model for circadian rhythms: effect of molecular noise on periodic and chaotic behaviour</article-title>. <source>Comptes Rendus Biologies</source>. <year>2003</year> <month>Apr</month>;<volume>326</volume>(<issue>2</issue>):<fpage>189</fpage>–<lpage>203</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1631-0691(03)00016-7" xlink:type="simple">10.1016/S1631-0691(03)00016-7</ext-link></comment> <object-id pub-id-type="pmid">12754937</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ashall</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Horton</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Paszek</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Harper</surname> <given-names>CV</given-names></name>, <name name-style="western"><surname>Sillitoe</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ryan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Spiller</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Unitt</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Broomhead</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Kell</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Rand</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Sée</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>MRH</given-names></name>. <article-title>Pulsatile stimulation determines timing and specificity of NF-kappa B-dependent transcription</article-title>. <source>Science</source>. <year>2009</year> <month>Apr</month>;<volume>324</volume> (<issue>5924</issue>);<fpage>242</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1164860" xlink:type="simple">10.1126/science.1164860</ext-link></comment> <object-id pub-id-type="pmid">19359585</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leloup</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Goldbeter</surname> <given-names>A</given-names></name>. <article-title>A model for circadian rhythms in Drosophila incorporating the formation of a complex between the PER and TIM proteins</article-title>. <source>J Biol Rhythms</source> <year>1998</year> <month>Feb</month>;<volume>13</volume>(<issue>1</issue>):<fpage>70</fpage>–<lpage>87</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1177/074873098128999934" xlink:type="simple">10.1177/074873098128999934</ext-link></comment> <object-id pub-id-type="pmid">9486845</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref019">
<label>19</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hartman</surname> <given-names>P</given-names></name>. <source>Ordinary differential equations</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>John Wiley &amp; Sons, Inc</publisher-name>. <publisher-loc>London and Sydney</publisher-loc>: <publisher-name>Wiley</publisher-name>; <year>1964</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005676.ref020">
<label>20</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Guckenheimer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>PJ</given-names></name>. <source>Nonlinear Oscillations, Dynamical Systems and Bifurcations of Vectorfields</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag, Inc</publisher-name>. <publisher-loc>Berlin, Heidelberg and Tokyo</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>; <year>1983</year></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gupta</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hepp</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Khammash</surname> <given-names>M</given-names></name>. <article-title>Noise Induces the Population-Level Entrainment of Incoherent, Uncoupled Intracellular Oscillators</article-title>. <source>Cell Systems</source>. <year>2016</year> <volume>3</volume>(<issue>6</issue>):<fpage>521</fpage>–<lpage>531.e13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cels.2016.10.006" xlink:type="simple">10.1016/j.cels.2016.10.006</ext-link></comment> <object-id pub-id-type="pmid">27818082</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Komorowski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Costa</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Rand DA Stumpf</surname> <given-names>MPH</given-names></name>. <article-title>Sensitivity, robustness and identifiability in stochastic chemical kinetics models</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2011</year> <month>May</month>;<volume>108</volume>(<issue>21</issue>):<fpage>8645</fpage>–<lpage>8650</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1015814108" xlink:type="simple">10.1073/pnas.1015814108</ext-link></comment> <object-id pub-id-type="pmid">21551095</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref023">
<label>23</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>DF</given-names></name>. <chapter-title>An Efficient Finite Difference Method for Parameter Sensitivities of Continuous Time Markov Chains</chapter-title>. <source>ArXiv e-prints</source>. <year>2011</year> <month>Sep</month>.</mixed-citation>
</ref>
<ref id="pcbi.1005676.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Srivastava</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Rawlings</surname> <given-names>JB</given-names></name>. <article-title>Comparison of finite difference based methods to obtain sensitivities of stochastic chemical kinetic models</article-title>. <source>The Journal of Chemical Physics</source>. <year>2013</year>;<volume>138</volume>(<issue>7</issue>):<fpage>074110</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.4790650" xlink:type="simple">10.1063/1.4790650</ext-link></comment> <object-id pub-id-type="pmid">23445000</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Sethna</surname> <given-names>JP</given-names></name>. <article-title>Statistical mechanical approaches to models with many poorly known parameters</article-title>. <source>Phys. Rev. E</source>. <year>2003</year> <month>Aug</month>;<volume>68</volume>(<issue>2 Pt 1</issue>):<fpage>021904</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.68.021904" xlink:type="simple">10.1103/PhysRevE.68.021904</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Hill</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Calero</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Sethna</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Cerione</surname> <given-names>RA</given-names></name>. <article-title>The statistical mechanics of complex signaling networks: nerve growth factor signaling</article-title>. <source>Physical biology</source>. <year>2003</year> <month>Dec</month>;<volume>1</volume>(<issue>3</issue>):<fpage>184</fpage>–<lpage>195</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1478-3967/1/3/006" xlink:type="simple">10.1088/1478-3967/1/3/006</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gutenkunst</surname> <given-names>RN</given-names></name>, <name name-style="western"><surname>Waterfall</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Casey</surname> <given-names>FP</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Sethna</surname> <given-names>JP</given-names></name>. <article-title>Universally sloppy parameter sensitivities in systems biology models</article-title>. <source>PLoS Computational Biology</source>. <year>2007</year> <month>Oct</month>;<volume>3</volume>(<issue>10</issue>):<fpage>1871</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030189" xlink:type="simple">10.1371/journal.pcbi.0030189</ext-link></comment> <object-id pub-id-type="pmid">17922568</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rand</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Shulgin</surname> <given-names>BV</given-names></name>, <name name-style="western"><surname>Salazar</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Millar</surname> <given-names>AJ</given-names></name>. <article-title>Design principles underlying circadian clocks</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2004</year> <month>Nov</month>;<volume>1</volume>(<issue>1</issue>):<fpage>119</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2004.0014" xlink:type="simple">10.1098/rsif.2004.0014</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rand</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Shulgin</surname> <given-names>BV</given-names></name>, <name name-style="western"><surname>Salazar</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Millar</surname> <given-names>AJ</given-names></name>. <article-title>Uncovering the design principles of circadian clocks: Mathematical analysis of flexibility and evolutionary goals</article-title>. <source>Journal of Theoretical Biology</source>. <year>2006</year> <month>Feb</month>;<volume>238</volume>(<issue>3</issue>):<fpage>616</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2005.06.026" xlink:type="simple">10.1016/j.jtbi.2005.06.026</ext-link></comment> <object-id pub-id-type="pmid">16111710</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rand</surname> <given-names>DA</given-names></name>. <article-title>Mapping the global sensitivity of cellular network dynamics: Sensitivity heat maps and a global summation law</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2008</year> <month>Aug</month>;<volume>5</volume> <issue>Suppl 1</issue>:<fpage>S59</fpage>–<lpage>69</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2008.0084.focus" xlink:type="simple">10.1098/rsif.2008.0084.focus</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Waterfall</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Casey</surname> <given-names>FP</given-names></name>, <name name-style="western"><surname>Gutenkunst</surname> <given-names>RN</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Brouwer</surname> <given-names>PW</given-names></name>, <name name-style="western"><surname>Elser</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Sethna</surname> <given-names>JP</given-names></name>. <article-title>Sloppy-Model Universality Class and the Vandermonde Matrix</article-title>. <source>Phys. Rev. Lett</source>. <year>2006</year> <month>Oct</month>;<volume>97</volume>(<issue>15</issue>):<fpage>150601</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.97.150601" xlink:type="simple">10.1103/PhysRevLett.97.150601</ext-link></comment> <object-id pub-id-type="pmid">17155311</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref032">
<label>32</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Wilkinson</surname> <given-names>DJ</given-names></name>. <source>Stochastic modelling for systems biology</source>. <publisher-loc>Boca Raton</publisher-loc>: <publisher-name>CRC Press/Taylor &amp; Francis</publisher-name>; <year>2012</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005676.ref033">
<label>33</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Kloeden</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Platen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Schurz</surname> <given-names>H</given-names></name>. <source>Numerical solution of SDE through computer experiments/ Diskette</source>. <publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>; <year>1997</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005676.ref034">
<label>34</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Iacus</surname> <given-names>SM</given-names></name>. <source>Simulation and Inference for Stochastic Differential Equations: With R Examples</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer</publisher-name> <publisher-loc>New York</publisher-loc>:<publisher-name>Springer e-books</publisher-name>; <year>2008</year></mixed-citation>
</ref>
<ref id="pcbi.1005676.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Finkenstädt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Woodcock</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Komorowski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Harper</surname> <given-names>CV</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>JRE</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>MRH</given-names></name>, <name name-style="western"><surname>Rand</surname> <given-names>DA</given-names></name>. <article-title>Quantifying intrinsic and extrinsic noise in gene transcription using the linear noise approximation: An application to single cell data</article-title>. <source>The Annals of Applied Statistics</source>. <year>2013</year> <month>Dec</month>;<volume>7</volume>(<issue>4</issue>):<fpage>1960</fpage>–<lpage>1982</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/13-AOAS669" xlink:type="simple">10.1214/13-AOAS669</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>