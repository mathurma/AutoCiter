<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">10-PLCB-RA-2397R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1001110</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Mathematics/Statistics</subject><subject>Neuroscience/Motor Systems</subject><subject>Neuroscience/Theoretical Neuroscience</subject></subj-group></article-categories><title-group><article-title>A Granger Causality Measure for Point Process Models of Ensemble Neural Spiking Activity</article-title><alt-title alt-title-type="running-head">A Granger Causality Measure for Point Process Data</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Kim</surname><given-names>Sanggyun</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Putrino</surname><given-names>David</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ghosh</surname><given-names>Soumya</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Brown</surname><given-names>Emery N.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Brain and Cognitive Sciences, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Anesthesia and Critical Care, Massachusetts General Hospital, Boston, Massachusetts, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Centre for Neuromuscular and Neurological Disorders, University of Western Australia, QEII Medical Centre, Nedlands, Australia</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Division of Health Sciences and Technology, Harvard Medical School/Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Friston</surname><given-names>Karl J.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">University College London, United Kingdom</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">sgkim@neurostat.mit.edu</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: SK. Performed the experiments: DP SG. Analyzed the data: SK DP SG ENB. Contributed reagents/materials/analysis tools: SK. Wrote the paper: SK DP ENB.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>3</month><year>2011</year></pub-date><pub-date pub-type="epub"><day>24</day><month>3</month><year>2011</year></pub-date><volume>7</volume><issue>3</issue><elocation-id>e1001110</elocation-id><history>
<date date-type="received"><day>17</day><month>6</month><year>2010</year></date>
<date date-type="accepted"><day>17</day><month>2</month><year>2011</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Kim et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>The ability to identify directional interactions that occur among multiple neurons in the brain is crucial to an understanding of how groups of neurons cooperate in order to generate specific brain functions. However, an optimal method of assessing these interactions has not been established. Granger causality has proven to be an effective method for the analysis of the directional interactions between multiple sets of continuous-valued data, but cannot be applied to neural spike train recordings due to their discrete nature. This paper proposes a point process framework that enables Granger causality to be applied to point process data such as neural spike trains. The proposed framework uses the point process likelihood function to relate a neuron's spiking probability to possible covariates, such as its own spiking history and the concurrent activity of simultaneously recorded neurons. Granger causality is assessed based on the relative reduction of the point process likelihood of one neuron obtained excluding one of its covariates compared to the likelihood obtained using all of its covariates. The method was tested on simulated data, and then applied to neural activity recorded from the primary motor cortex (MI) of a <italic>Felis catus</italic> subject. The interactions present in the simulated data were predicted with a high degree of accuracy, and when applied to the real neural data, the proposed method identified causal relationships between many of the recorded neurons. This paper proposes a novel method that successfully applies Granger causality to point process data, and has the potential to provide unique physiological insights when applied to neural spike trains.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Recent advances in multiple-electrode recording have made it possible to record the activities of multiple neurons simultaneously. This provides an opportunity to study how groups of neurons form functional ensembles as different brain areas perform their various functions. However, most of the methods that attempt to identify associations between neurons provide little insight into the directional nature of the interactions that they detect. Recently, Granger causality has proven to be an efficient method to infer causal relationships between sets of continuous-valued data, but cannot be directly applied to point process data such as neural spike trains. Here, we propose a novel and successful attempt to expand the application of Granger causality to point process data. The proposed method performed well with simulated data, and was then applied to real experimental data recorded from sets of simultaneously recorded neurons from the primary motor cortex. The results of the real data analysis suggest that the proposed method has the potential to provide unique neurophysiological insights about network properties in the cortex that have not been possible with other contemporary methods of functional interaction detection.</p>
</abstract><funding-group><funding-statement>This work was supported by NIH Grants DP1-OD003646 and R01-EB006385(<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov" xlink:type="simple">http://www.nih.gov</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="13"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Neurons in the brain are known to exert measurable, directional influences on the firing activities of surrounding neurons, and a detailed analysis of these interactions improves our understanding of how the brain performs specific functions <xref ref-type="bibr" rid="pcbi.1001110-Brown1">[1]</xref>. Attempts to identify associations between neurons, such as the cross-correlogram <xref ref-type="bibr" rid="pcbi.1001110-Brody1">[2]</xref>, joint peri-stimulus time histogram <xref ref-type="bibr" rid="pcbi.1001110-Gerstein1">[3]</xref>, smoothed ratio of spiking activity <xref ref-type="bibr" rid="pcbi.1001110-Ventura1">[4]</xref>, and gravitational clustering <xref ref-type="bibr" rid="pcbi.1001110-Gerstein2">[5]</xref>, have been useful in the past. However, these methods provide little insight into the directional nature of the interactions that they detect, are less reliable in their detection of inhibitory interactions, and usually do not consider the point process nature of neural spike train data. Occasionally they may also give a misleading picture of the relationships between neurons if the detected associations are caused by common inputs or mediated by other neurons <xref ref-type="bibr" rid="pcbi.1001110-Stevenson1">[6]</xref>.</p>
<p>Granger causality has proven to be an effective method for the investigation of directional relationships between continuous-valued signals in many applications <xref ref-type="bibr" rid="pcbi.1001110-Granger1">[7]</xref>–<xref ref-type="bibr" rid="pcbi.1001110-Chen1">[11]</xref>. The basic idea of causality between signals was introduced by Wiener <xref ref-type="bibr" rid="pcbi.1001110-Wiener1">[12]</xref> but was too general to be implemented. Granger formalized this idea in order to enable practical implementation based on the multivariate autoregressive (MVAR) models <xref ref-type="bibr" rid="pcbi.1001110-Granger1">[7]</xref>: if past values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e001" xlink:type="simple"/></inline-formula> contain information that helps predict <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e002" xlink:type="simple"/></inline-formula> above and beyond the information contained in past values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e003" xlink:type="simple"/></inline-formula> alone, then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e004" xlink:type="simple"/></inline-formula> is said to Granger-cause (or g-cause) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e005" xlink:type="simple"/></inline-formula>. Its mathematical formulation is based on the MVAR modeling of processes. However, it is difficult to apply this method directly to spike train data, since they can not be described by the MVAR model, and standard distance measures such as the mean squared error (MSE) are not designed for spike train data. Recently, several methods have been developed to apply Granger causality to spike train data <xref ref-type="bibr" rid="pcbi.1001110-Sameshima1">[13]</xref>–<xref ref-type="bibr" rid="pcbi.1001110-Nedungadi1">[19]</xref>. Attempts at transforming neural spike trains into continuous-valued data by convolving spike trains with either a smooth kernel <xref ref-type="bibr" rid="pcbi.1001110-Sameshima1">[13]</xref> or a lowpass filter <xref ref-type="bibr" rid="pcbi.1001110-Kaminski1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Zhu1">[15]</xref> have been proposed, but they introduced unwanted distortion of the point process characteristics of spike train data. Granger causality analysis based on an MVAR-nonlinear-Poisson model has been proposed <xref ref-type="bibr" rid="pcbi.1001110-Krumin1">[16]</xref>; however, this approach lacks an explanation of the physical meaning of the model that is being applied. A method called transfer entropy using mutual information has also been proposed <xref ref-type="bibr" rid="pcbi.1001110-Schreiber1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Pereda1">[18]</xref>, and it is sensitive to nonlinear signal properties, but unfortunately its application is restricted to bivariate cases. A nonparametric method based on spectral matrix factorization has been proposed <xref ref-type="bibr" rid="pcbi.1001110-Nedungadi1">[19]</xref>; however, it required the second-order stationarity of spike train data.</p>
<p>To address these issues, this paper proposes a point process framework for assessing Granger causality between multiple neurons. The spiking activity of each neuron is simultaneously affected by multiple covariates such as its own spiking history and the concurrent ensemble activity of other neurons. The effect of these factors on a neuron's spiking activity is characterized by a statistical framework based on the point process likelihood function, which relates the neuron's spiking probability to the covariates <xref ref-type="bibr" rid="pcbi.1001110-Truccolo1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Okatan1">[21]</xref>. Using the point process likelihood function, Granger causality between neurons is assessed based on the likelihood ratio statistic. That is, Granger causality from neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e006" xlink:type="simple"/></inline-formula> to neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e007" xlink:type="simple"/></inline-formula> is measured based on the relative reduction of the point process likelihood of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e008" xlink:type="simple"/></inline-formula> obtained by excluding the covariates corresponding to the effect of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e009" xlink:type="simple"/></inline-formula> compared to the likelihood obtained using all the covariates. If the likelihood ratio is less than one, we say that there is a causal influence from neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e010" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e011" xlink:type="simple"/></inline-formula>, and if the ratio is one, we say that there is no causal influence. In continuous-valued cases, the Granger causality measure based on the MVAR prediction error was shown to be the likelihood ratio test statistic if the prediction error is assumed to be Gaussian <xref ref-type="bibr" rid="pcbi.1001110-Geweke1">[22]</xref>. In addition, the point process likelihood ratio statistic enables us to perform statistical hypothesis testing to investigate the significant causal interactions between neurons, since it asymptotically follows a chi-squared distribution when the conditional intensity function (CIF) of the point process is modeled by the generalized linear model (GLM) <xref ref-type="bibr" rid="pcbi.1001110-Dobson1">[23]</xref>. When performing a set of statistical inferences simultaneously to detect statistically significant causal interactions among all possible interactions, multiple hypothesis testing problems where the null hypothesis is more likely to be incorrectly rejected should be considered. The present study uses the false discovery rate (FDR) correction to control the expected proportion of incorrectly rejected null hypotheses <xref ref-type="bibr" rid="pcbi.1001110-Benjamini1">[24]</xref>.</p>
<p>The proposed framework was used in an attempt to identify the causal relationships between simulated spike train data, and accurately estimated the underlying causal networks presented in the simulations. It was also applied to real neural data recorded from the cat primary motor cortex (MI) in order to assess the causal relationships that occur between multiple simultaneously recorded neurons during performance of a movement task.</p>
</sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<sec id="s2a">
<title>Ethics Statement</title>
<p>The experiments that were performed for the collection of real neural spiking data were approved by the Animal Ethics Committee of the University of Western Australia, and the National Health and Medical Research Council of Australia (NH&amp;MRC) guidelines for the use of animals in experiments were followed throughout.</p>
</sec><sec id="s2b">
<title>Summary of the Proposed Method</title>
<p>Statistical analysis of the potential causal relationships between neurons was performed based on a point process likelihood function. The likelihood function related a neuron's spiking probability to possible covariates, such as its own spiking history and the concurrent activity of all simultaneously recorded neurons. The causal relationships between associated neurons were assessed based on the point process likelihood ratio, which represents the extent to which the likelihood of one neuron is reduced by the exclusion of one of its covariates, compared with the likelihood if all of the available covariates are used. The Granger causality measure based on the point process likelihood ratio also enabled us to detect significant causal relationship through a hypothesis testing based on the likelihood ratio statistic.</p>
</sec><sec id="s2c">
<title>A Granger Causality Measure for Point Process Models</title>
<p>A point process is a time series of discrete events that occur in continuous time <xref ref-type="bibr" rid="pcbi.1001110-Daley1">[25]</xref>. The discrete, all-or-nothing nature of a sequence of action potentials together with their stochastic structure suggests that neural spike trains may be regarded as point processes <xref ref-type="bibr" rid="pcbi.1001110-Truccolo1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Brown2">[26]</xref>–<xref ref-type="bibr" rid="pcbi.1001110-Kass1">[28]</xref>. Given an observation interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e012" xlink:type="simple"/></inline-formula>, let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e013" xlink:type="simple"/></inline-formula> be a set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e014" xlink:type="simple"/></inline-formula> spike times point process observations for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e015" xlink:type="simple"/></inline-formula> recorded neurons. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e016" xlink:type="simple"/></inline-formula> denote the sample path that counts the number of spikes of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e017" xlink:type="simple"/></inline-formula> in the time interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e018" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e019" xlink:type="simple"/></inline-formula>. A point process model of a spike train for neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e020" xlink:type="simple"/></inline-formula> can be completely characterized by its CIF, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e021" xlink:type="simple"/></inline-formula>, defined as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e022" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e023" xlink:type="simple"/></inline-formula> denotes the spiking history of all the neurons in the ensemble up to time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e024" xlink:type="simple"/></inline-formula> for neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e025" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1001110-Daley1">[25]</xref>. In this work, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e026" xlink:type="simple"/></inline-formula> is defined in the interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e027" xlink:type="simple"/></inline-formula>, which is divided into <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e028" xlink:type="simple"/></inline-formula> non-overlapping rectangular windows of duration <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e029" xlink:type="simple"/></inline-formula>; We denote the spike count of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e030" xlink:type="simple"/></inline-formula> in a time window of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e031" xlink:type="simple"/></inline-formula> covering the time interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e032" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e033" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e034" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e035" xlink:type="simple"/></inline-formula>. The CIF, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e036" xlink:type="simple"/></inline-formula>, of (1) represents the firing rate of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e037" xlink:type="simple"/></inline-formula> at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e038" xlink:type="simple"/></inline-formula>, so it quantifies the probability that neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e039" xlink:type="simple"/></inline-formula> fires a spike at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e040" xlink:type="simple"/></inline-formula> given its covariates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e041" xlink:type="simple"/></inline-formula>. Each neuron has a different <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e042" xlink:type="simple"/></inline-formula>, since each has a history dependency of different length, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e043" xlink:type="simple"/></inline-formula>. The probability that neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e044" xlink:type="simple"/></inline-formula> fires a single spike in a small interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e045" xlink:type="simple"/></inline-formula> can be approximated as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e046" xlink:type="simple"/></inline-formula>.</p>
<p>To model the effect of its own and ensemble's spiking histories on the current spiking activity of a neuron, a GLM framework is often used to model the CIF. In the GLM framework, the logarithm of the CIF is modeled as a linear combination of the functions of the covariates that describe the neural activity dependencies <xref ref-type="bibr" rid="pcbi.1001110-Truccolo1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Okatan1">[21]</xref>. Thus, the logarithm of the CIF is expressed as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e047" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e048" xlink:type="simple"/></inline-formula> relates to a background level of activity of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e049" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e050" xlink:type="simple"/></inline-formula> represents the effect of ensemble spiking history <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e051" xlink:type="simple"/></inline-formula> on the firing probability of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e052" xlink:type="simple"/></inline-formula>. The parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e053" xlink:type="simple"/></inline-formula> is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e054" xlink:type="simple"/><label>(3)</label></disp-formula>which represents the dependency of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e055" xlink:type="simple"/></inline-formula> on the spiking history of all neurons in the ensemble. Especially, the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e056" xlink:type="simple"/></inline-formula> represent the dependency of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e057" xlink:type="simple"/></inline-formula> on the spiking history of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e058" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e059" xlink:type="simple"/></inline-formula>. The model for the CIF of (2) is not a fixed form, but can change depending on its covariates and its relationship to them.</p>
<p>A point process likelihood function was used to fit the parametric CIF and analyze Granger causality between neurons since it is a primary tool used in constructing statistical models and has several optimality properties <xref ref-type="bibr" rid="pcbi.1001110-Pawitan1">[29]</xref>. Here, we used a discrete time representation of the point process likelihood function in order to simplify ensuing calculations. To obtain this representation, we partitioned the observation interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e060" xlink:type="simple"/></inline-formula> into <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e061" xlink:type="simple"/></inline-formula> subintervals <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e062" xlink:type="simple"/></inline-formula> each of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e063" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e064" xlink:type="simple"/></inline-formula> is a large integer. Usually, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e065" xlink:type="simple"/></inline-formula> is chosen to make <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e066" xlink:type="simple"/></inline-formula> as 1 ms. We denote the continuous time variables defined above as the discrete time versions such as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e067" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e068" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e069" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e070" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e071" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e072" xlink:type="simple"/></inline-formula> and so forth. Since we chose a large value for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e073" xlink:type="simple"/></inline-formula>, there is at most one spike per subinterval, that is, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e074" xlink:type="simple"/></inline-formula> takes on the value 0 if there is no spike in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e075" xlink:type="simple"/></inline-formula> or 1 if there is a spike. The parametric form of the CIF of (2) for neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e076" xlink:type="simple"/></inline-formula> is represented as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e077" xlink:type="simple"/></inline-formula>.</p>
<p>Given the ensemble spiking activity in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e078" xlink:type="simple"/></inline-formula>, the likelihood function of the spike train of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e079" xlink:type="simple"/></inline-formula> is given as in <xref ref-type="bibr" rid="pcbi.1001110-Truccolo1">[20]</xref> using its CIF by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e080" xlink:type="simple"/><label>(4)</label></disp-formula>where the term <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e081" xlink:type="simple"/></inline-formula> relates the probability that neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e082" xlink:type="simple"/></inline-formula> includes two or more spikes in any subinterval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e083" xlink:type="simple"/></inline-formula>. Based on the likelihood function of (4), a point process framework for assessing the causal relationships between neurons is proposed. A potential causal relationship from neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e084" xlink:type="simple"/></inline-formula> to neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e085" xlink:type="simple"/></inline-formula> is assessed by calculating the relative reduction in the likelihood of producing a particular set of spike trains of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e086" xlink:type="simple"/></inline-formula> if the spiking history of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e087" xlink:type="simple"/></inline-formula> is excluded, compared with the likelihood if all of the available covariates are used. The log-likelihood ratio, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e088" xlink:type="simple"/></inline-formula>, is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e089" xlink:type="simple"/><label>(5)</label></disp-formula>where the likelihood <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e090" xlink:type="simple"/></inline-formula> is obtained using a new CIF, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e091" xlink:type="simple"/></inline-formula>, which excludes the effect of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e092" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e093" xlink:type="simple"/></inline-formula>, given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e094" xlink:type="simple"/><label>(6)</label></disp-formula>The parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e095" xlink:type="simple"/></inline-formula> is obtained by re-optimizing the parametric likelihood model after excluding <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e096" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e097" xlink:type="simple"/></inline-formula> in order to remove the effect of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e098" xlink:type="simple"/></inline-formula> on neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e099" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e100" xlink:type="simple"/></inline-formula> is obtained by leaving out <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e101" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e102" xlink:type="simple"/></inline-formula>. Since the likelihood <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e103" xlink:type="simple"/></inline-formula> is always greater than or equal to the likelihood <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e104" xlink:type="simple"/></inline-formula>, the log-likelihood ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e105" xlink:type="simple"/></inline-formula> is always less than or equal to 0. If the spiking activity of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e106" xlink:type="simple"/></inline-formula> has a causal influence on that of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e107" xlink:type="simple"/></inline-formula> in the Granger sense, the likelihood <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e108" xlink:type="simple"/></inline-formula> that is calculated using all the covariates of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e109" xlink:type="simple"/></inline-formula> is greater than the likelihood <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e110" xlink:type="simple"/></inline-formula> that is calculated using the same covariates, save for the history of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e111" xlink:type="simple"/></inline-formula>, which is excluded. Excitatory and inhibitory influences of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e112" xlink:type="simple"/></inline-formula> on neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e113" xlink:type="simple"/></inline-formula> can be distinguished by the sign of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e114" xlink:type="simple"/></inline-formula> that represents an averaged influence of the spiking history of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e115" xlink:type="simple"/></inline-formula> on neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e116" xlink:type="simple"/></inline-formula>. The equality holds when neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e117" xlink:type="simple"/></inline-formula> has no influence on neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e118" xlink:type="simple"/></inline-formula>. Thus, the Granger causality measure from neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e119" xlink:type="simple"/></inline-formula> to neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e120" xlink:type="simple"/></inline-formula> is proposed as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e121" xlink:type="simple"/><label>(7)</label></disp-formula>which provides an indication of the extent to which the spiking history of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e122" xlink:type="simple"/></inline-formula> affects the spike train data of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e123" xlink:type="simple"/></inline-formula>. A positive result is indicative of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e124" xlink:type="simple"/></inline-formula> having an excitatory effect upon neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e125" xlink:type="simple"/></inline-formula>, a negative result indicates an inhibitory effect, and zero indicates that no interactions are detected. Finally, a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e126" xlink:type="simple"/></inline-formula> Granger causality matrix can be produced, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e127" xlink:type="simple"/></inline-formula>, whose <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e128" xlink:type="simple"/></inline-formula>th element is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e129" xlink:type="simple"/></inline-formula>, and represents the extent to which neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e130" xlink:type="simple"/></inline-formula> has either an excitatory or inhibitory influence on neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e131" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e132" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2d">
<title>Significance Test</title>
<p>The Granger causality matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e133" xlink:type="simple"/></inline-formula> represents the relative strength of estimated causal interactions between neurons, but does not provide any insight into which of these interactions are statistically significant. To address this issue, a hypothesis testing based on the likelihood ratio test statistic is performed to evaluate the statistical significance of the estimated causal interactions of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e134" xlink:type="simple"/></inline-formula>. For this, the goodness-of-fit (GOF) statistics are applied as follows <xref ref-type="bibr" rid="pcbi.1001110-Dobson1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Pawitan1">[29]</xref>. Let us denote the deviance obtained using the model parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e135" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e136" xlink:type="simple"/></inline-formula> and the deviance obtained using the model parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e137" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e138" xlink:type="simple"/></inline-formula>; The deviance is obtained by comparing the estimated model with a more general model that has a parameter for every observation so that the data fits exactly, which is called a full model <xref ref-type="bibr" rid="pcbi.1001110-Daley1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-McCullagh1">[30]</xref>. Its expression is −2 times the log-likelihood ratio of the estimated model to the full model, which is mathematically expressed by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e139" xlink:type="simple"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e140" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e141" xlink:type="simple"/></inline-formula> are the parameters for the estimated and the full models, respectively. In the GLM framework the deviance is used to compare two models, which are nested like the above case, since a model of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e142" xlink:type="simple"/></inline-formula> is a special case of the more general model of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e143" xlink:type="simple"/></inline-formula>. Consider the null hypothesis<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e144" xlink:type="simple"/><label>(9)</label></disp-formula>which corresponds to the model of (6). An alternative hypothesis is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e145" xlink:type="simple"/><label>(10)</label></disp-formula>which corresponds to the model of (2).</p>
<p>We can test <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e146" xlink:type="simple"/></inline-formula> against <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e147" xlink:type="simple"/></inline-formula> using the difference of the deviance statistic as the test statistic, which is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e148" xlink:type="simple"/><label>(11)</label></disp-formula>Thus, the deviance difference between two models is equivalent to −2 times log-likelihood ratio given by (5). If both models describe the data well, then the deviance difference may be asymptotically described as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e149" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e150" xlink:type="simple"/></inline-formula> is equal to the difference in dimensionality of the two models <xref ref-type="bibr" rid="pcbi.1001110-Dobson1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Pawitan1">[29]</xref>. If the value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e151" xlink:type="simple"/></inline-formula> is consistent with the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e152" xlink:type="simple"/></inline-formula> distribution, the hypothesis <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e153" xlink:type="simple"/></inline-formula> is accepted since it is simpler. This result indicates that the past values of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e154" xlink:type="simple"/></inline-formula> contain no significant information that would assist in predicting the activity of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e155" xlink:type="simple"/></inline-formula>. Thus, neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e156" xlink:type="simple"/></inline-formula> has no causal influence on neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e157" xlink:type="simple"/></inline-formula>. On the contrary, if the value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e158" xlink:type="simple"/></inline-formula> is in the critical region, i.e., greater than the upper tail <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e159" xlink:type="simple"/></inline-formula> of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e160" xlink:type="simple"/></inline-formula> distribution where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e161" xlink:type="simple"/></inline-formula> determines false positive rates, then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e162" xlink:type="simple"/></inline-formula> may be rejected in favor of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e163" xlink:type="simple"/></inline-formula> since the model of (2) describes the data with significantly more accuracy. This indicates that past spike times of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e164" xlink:type="simple"/></inline-formula> contain information that improves the ability to predict the activity of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e165" xlink:type="simple"/></inline-formula>. Thus the activity of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e166" xlink:type="simple"/></inline-formula> g-causes the activity of neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e167" xlink:type="simple"/></inline-formula>.</p>
<p>In any attempt to identify the causal relationships between multiple neurons simultaneously, the total number of the possible causal interactions to be investigated is usually large. Thus, the use of common statistical thresholds cited above to assess the causal interactions would lead to an unacceptably large number of false causal interactions (false positives) where the null hypothesis is incorrectly rejected <xref ref-type="bibr" rid="pcbi.1001110-Miller1">[31]</xref>. The multiple comparison problem could potentially be addressed by the use of stricter statistical thresholds, which would result in a reduction in the proportion of the falsely rejected null hypotheses. However, stricter thresholds would also reduce the probability that true causal interactions between neurons were identified. The present study uses a multiple-hypothesis testing error measure called the FDR to address the multiple comparisons problem. The FDR controls the expected proportion of false positive findings among all the rejected null hypotheses <xref ref-type="bibr" rid="pcbi.1001110-Benjamini1">[24]</xref>. In situations where the number of hypothesis tests is large, other approaches that attempt to control the familywise error rate (FWER), which is the probability of making one or more false discoveries among all the hypotheses, can be too strict and decrease the power. Thus, the FDR is a less conservative, but more powerful, quantity to control for multiple comparisons than the FWER at a cost of increasing the likelihood of obtaining false positive findings <xref ref-type="bibr" rid="pcbi.1001110-Storey1">[32]</xref>.</p>
<p>Combining the multiple hypothesis testing results with the sign of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e168" xlink:type="simple"/></inline-formula>, we detect the inhibitory, excitatory, and non-causal interactions, which are denoted as the blue, red, and green colors, respectively. Thus, a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e169" xlink:type="simple"/></inline-formula> causal connectivity matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e170" xlink:type="simple"/></inline-formula> whose <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e171" xlink:type="simple"/></inline-formula>th element corresponds to one of three interactions is constructed. In this paper, the connectivity matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e172" xlink:type="simple"/></inline-formula> was obtained by controlling the FDR as 0.05.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Simulation</title>
<p>In order to evaluate the proposed framework's ability to identify Granger causality for ensemble spiking activity, we analyzed synthetically generated spike train data. Simulated spike train data were synthetically generated based on the nine-neuron network of <xref ref-type="fig" rid="pcbi-1001110-g001">Figure 1</xref>. The firing probability of each neuron was dependent on its own spiking history and the concurrent ensemble activity through the inhibitory and the excitatory interactions of <xref ref-type="fig" rid="pcbi-1001110-g001">Figure 1</xref>. The inhibitory and the excitatory interactions were represented as black and white circles, respectively. Each neuron was influenced by other neurons through two inhibitory interactions including its own self-inhibition and through one or two excitatory interactions. The overall network of <xref ref-type="fig" rid="pcbi-1001110-g001">Figure 1A</xref> consisted of three sub-networks each with three neurons. The interactions between neurons within sub-networks were set to have relatively small duration, and the parameter vectors for the inhibitory and the excitatory interactions among neurons were set to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e173" xlink:type="simple"/></inline-formula> = [−0.8 −0.6 −0.3] and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e174" xlink:type="simple"/></inline-formula> = [1 2 2], respectively. For interactions between different sub-networks, the parameter vectors for the inhibitory and excitatory interactions were set to have relatively long duration such as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e175" xlink:type="simple"/></inline-formula> = [0 0 0 −0.8 −0.9 −0.5] and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e176" xlink:type="simple"/></inline-formula> = [0 0 0 1 2 1], respectively. The parameter vector for the self-inhibition was set to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e177" xlink:type="simple"/></inline-formula> = [−0.6 −0.5 −0.4]. All neurons had the same spontaneous firing rate (18 Hz). Spike trains for neuron <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e178" xlink:type="simple"/></inline-formula> were generated using a commonly used procedure as follows <xref ref-type="bibr" rid="pcbi.1001110-Koch1">[33]</xref>: A random number <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e179" xlink:type="simple"/></inline-formula>, uniformly distributed between 0 and 1, is generated at every interval; if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e180" xlink:type="simple"/></inline-formula>, a spike is presumed to have occurred in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e181" xlink:type="simple"/></inline-formula>; otherwise, no spike is generated. The time resolution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e182" xlink:type="simple"/></inline-formula> was set to 1 ms. An absolute refractory period of 1 ms was enforced to prevent neurons from firing a spike in adjacent time steps. Based on the experimental settings cited above, we generated 100,000 samples for each neuron, and the total number of spikes for each neuron ranged from 2176 through 2911. Examples of generated neural spike trains during the first 5 sec (5,000 samples) are illustrated in <xref ref-type="fig" rid="pcbi-1001110-g002">Figure 2</xref>. It can be seen that neurons generally fire less (or more) spikes after other neurons with inhibitory (or excitatory) influence on them fire spikes. However, it is hard to estimate the underlying causal network between neurons from this plot.</p>
<fig id="pcbi-1001110-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g001</object-id><label>Figure 1</label><caption>
<title>Nine-neuron network to generate synthetic neural spike trains.</title>
<p>(A) Each neuron had a spontaneous firing rate 18 Hz and was self-inhibitory. Neurons interact through inhibitory (black) and excitatory (white) connections. The firing probability of each neuron is modulated by a self-inhibitory interaction in addition to the inhibitory and excitatory interactions. (B) The true causal connectivity map is obtained from (A). Black and white circles indicate the respective inhibitory and excitatory influence from trigger neuron to target.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g001" xlink:type="simple"/></fig><fig id="pcbi-1001110-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g002</object-id><label>Figure 2</label><caption>
<title>Spike train examples generated based on the nine-neuron network of <xref ref-type="fig" rid="pcbi-1001110-g001"><bold>Figure 1</bold></xref>.</title>
<p>It can be seen that neurons generally fire less (or more) spikes after other neurons with inhibitory (or excitatory) influence on them fire spikes. However, it is hard to estimate the underlying causal network between neurons directly from this plot.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g002" xlink:type="simple"/></fig>
<p>In order to select a model for each neuron we fit several models with different history durations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e183" xlink:type="simple"/></inline-formula> to each spike train data and then identified the best approximating model from among a set of candidates using Akaike's information criterion (AIC) <xref ref-type="bibr" rid="pcbi.1001110-Akaike1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Burnham1">[35]</xref>. Using this criterion, an optimum model order for each neuron was selected. The spike counting window length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e184" xlink:type="simple"/></inline-formula> was set to 2 ms. For neurons 1, 3, 4, 5, 8, and 9, which were influenced by other neurons through relatively long interactions, the selected GLM spike order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e185" xlink:type="simple"/></inline-formula> was 3, which indicates a 6 ms history duration, and for neurons 2, 6, and 7 influenced by other neurons within same sub-network only through short interactions, the selected GLM order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e186" xlink:type="simple"/></inline-formula> was 2, which corresponds to a 4 ms history duration.</p>
<p>Based on the estimated model, two kinds of causality maps were obtained using the proposed method. Firstly, the Granger causality map <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e187" xlink:type="simple"/></inline-formula>, which is illustrated in <xref ref-type="fig" rid="pcbi-1001110-g003">Figure 3A</xref>, represents the relative strength of the causal interaction between neurons. It represents the extent to which a trigger neuron has a causal impact on a target compared to other interconnections, but provides little insight into which causal impact is statistically significant. In order to make up for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e188" xlink:type="simple"/></inline-formula>, the causal connectivity map <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e189" xlink:type="simple"/></inline-formula> was obtained through the hypothesis testing when we controlled the FDR as 0.05. This is shown in <xref ref-type="fig" rid="pcbi-1001110-g003">Figure 3B</xref>. The red, blue, and green colors denote the presence of excitatory, inhibitory, or no interactions from trigger neuron to target, respectively. The estimated pattern of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e190" xlink:type="simple"/></inline-formula> matches the actual network of <xref ref-type="fig" rid="pcbi-1001110-g001">Figure 1</xref> exactly. This causality map does not show a connection between neurons that do not have direct interactions, even though they have indirect interactions.</p>
<fig id="pcbi-1001110-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g003</object-id><label>Figure 3</label><caption>
<title>Two causality maps, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e191" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e192" xlink:type="simple"/></inline-formula>, estimated using the simulated data.</title>
<p>(A) The Granger causality matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e193" xlink:type="simple"/></inline-formula> shows how much each neuron interacts one another. (B) The causality connectivity map <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e194" xlink:type="simple"/></inline-formula> was obtained through the hypothesis testing. As shown, the red and blue colors denote the presence of the inhibitory and the excitatory interactions from trigger neuron to target, respectively. The green color represents that there is no causal interaction between the tested neurons. The estimated pattern matches the actual network of <xref ref-type="fig" rid="pcbi-1001110-g001">Figure 1</xref>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g003" xlink:type="simple"/></fig>
<p>The FDR procedure was used as a solution for the multiple comparisons problem when considering a set of statistical inferences simultaneously. When controlling the FDR at a specific significance level <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e195" xlink:type="simple"/></inline-formula>, we expect that on average there will be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e196" xlink:type="simple"/></inline-formula> false positives amongst <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e197" xlink:type="simple"/></inline-formula> detected significant interactions. In order to verify that the FDR is actually being controlled at the significance levels that we are claiming in the present study, the Monte-Carlo (MC) simulations were conducted by varying both the number of causal interactions between the virtual neurons, and the signal-to-noise ratio (SNR) of the simulated spikes. These MC simulations show how effectively the FDR is being controlled under different experimental conditions. Firstly, we conducted a series of the MC simulations by changing the number of causal interactions from 8 to 64. Data was synthetically generated to resemble four different kinds of networks (seen in <xref ref-type="fig" rid="pcbi-1001110-g004">Figure 4</xref>), each having a different incidence of interaction between neurons. Fifty data sets were generated for each network condition, while all other experimental parameters remained the same. The dashed circle in <xref ref-type="fig" rid="pcbi-1001110-g004">Figure 4A and B</xref> represents a neuron whose firing activity does not depend on the spiking history, and thus follows a homogeneous Poisson process, i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e198" xlink:type="simple"/></inline-formula> = 0. Networks of <xref ref-type="fig" rid="pcbi-1001110-g004">Figure 4A to D</xref> consist of 8, 16, 32, and 64 interactions (including self-interactions), respectively. The observed FDR is calculated by averaging the ratio of the number of false positives to the number of detected significant interactions over 50 simulations, and it is illustrated in <xref ref-type="fig" rid="pcbi-1001110-g005">Figure 5A</xref> for significance levels of 0.01, 0.05 and 0.1. The FDR was generally controlled at the significance level that we were attempting to control except for the 8-interaction case with less false positives than the number expected at that significance level. We then performed another MC simulation by changing the SNR. Noisy neural spike trains were generated using the CIF of (2) in the following: We added a Gaussian noise to the logarithmic CIF, i.e., the right-hand side of (2), and then generated spike trains using the perturbed CIF. The noise changed the background level of firing rate over time. The SNR is defined as the ratio between the unperturbed logarithmic CIF and the perturbation itself. Fifty data sets of noisy spike trains were synthetically generated based on the nine-neuron network of <xref ref-type="fig" rid="pcbi-1001110-g001">Figure 1</xref> with different levels of noise, which led to about 0, 10, 20, 30, and 40 dB SNRs, respectively. All other experimental conditions are same to the previous case. <xref ref-type="fig" rid="pcbi-1001110-g005">Figure 5B</xref> illustrates the simulation results obtained for significance levels of 0.01, 0.05, and 0.1. When the SNR is approximately 0 dB, more false positive events were detected than what was expected at the specified significance level, but in most cases the observed FDR was no different from the theoretical FDR. In summary, unless the perturbation level is similar to or higher than the level of the logarithmic CIF of (2) that is modulated by the intrinsic dynamics of the neurons, the FDR is effectively controlled at the significance level that we are attempting to control.</p>
<fig id="pcbi-1001110-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g004</object-id><label>Figure 4</label><caption>
<title>Four different networks used to generate synthetic neural spike trains.</title>
<p>(A) A nine-neuron network with 8 causal interactions is illustrated. All experimental conditions remained the same as those that were used for the production of <xref ref-type="fig" rid="pcbi-1001110-g001">Figure 1</xref>. The dashed circle represent a neuron that has no self-interaction effect on itself. (B) A nine-neuron network with 16 interactions is illustrated. (C) A nine-neuron network with 32 interactions is illustrated. (D) A nine-neuron network with 64 interactions is illustrated.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g004" xlink:type="simple"/></fig><fig id="pcbi-1001110-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g005</object-id><label>Figure 5</label><caption>
<title>Monte-Carlo simulations performed in order to verify the control of the FDR.</title>
<p>(A) The observed FDR is illustrated for 8, 16, 32, and 64 causal interactions at the significance levels of 0.01, 0.05, and 0.1. (B) The observed FDR is illustrated by varying the SNR from about 0 to 40 dB at the significance levels of 0.01, 0.05, and 0.1.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g005" xlink:type="simple"/></fig></sec><sec id="s3b">
<title>Real Data Analysis</title>
<p>To illustrate the application of the proposed method to real spike train data, 15 neurons were simultaneously recorded from the cat MI shown in <xref ref-type="fig" rid="pcbi-1001110-g006">Figure 6</xref> and analyzed. The experimental methodology that was implemented to collect the neural activity used for the following analysis was described in detail in Ghosh et al. <xref ref-type="bibr" rid="pcbi.1001110-Ghosh1">[36]</xref>. Briefly, an adult cat was trained to perform a skilled reaching movement, using its preferred forelimb to retrieve food pellets placed between 2 upright Perspex barriers spaced 4 cm apart. After behavioral training was complete, PTFE coated Platinum-Iridium microwires were implanted into the cortex to a depth of about 1.5 mm into forelimb and hindlimb representations of MI (identified using intracortical microsimulation). Neural recordings were made as the animal performed the reaching task, and only neurons that significantly modulated their firing rate during task performance were isolated for analysis in this study. Interspike interval, spike duration and spiking rate analyses were performed on neurons isolated from adjacent recording sites. This was done in order to rule out the possibility of the same neuron being counted more than once due to cross-talk between neighboring electrodes. Autocorrelogram, interspike interval and ‘burst surprise’ (using a surprise value of 3) analysis were performed on all neurons in order to identify any potentially bursting neurons in the data set (there were none) <xref ref-type="bibr" rid="pcbi.1001110-Bartho1">[37]</xref>–<xref ref-type="bibr" rid="pcbi.1001110-Legendy1">[39]</xref>. The data set includes 150,000 samples (3,000 samples/trial<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e199" xlink:type="simple"/></inline-formula>50 trials) for each channel, and the total number of spikes for each neuron across all trials ranged from 613 to 5716. The sampling rate was 1 KHz.</p>
<fig id="pcbi-1001110-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g006</object-id><label>Figure 6</label><caption>
<title>Location of recording electrodes in motor cortex.</title>
<p>(A) A peri-operative photograph of a craniotomy, and the locations on the cortical surface where the microwires were implanted (black dots). Rostral is up. (B) A pictorial reconstruction of the unfolded cortical surface, cytoarchitectonic boundaries and electrode locations was created from serial coronal sections. Medial is up. The recording sites where the neurons were simultaneously recorded are labeled in color code. Blue, red and black circles represent sites where one, two or no neurons were able to be recorded, respectively. Abbreviations: 3a, 4 and 6a are cytoarchitectonic areas. Sulci: SA: Ansate sulcus, SCor: Coronal sulcus, SCr: Cruciate sulcus, SPs: Presylvian sulcus.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g006" xlink:type="simple"/></fig>
<p>Using the AIC, an optimum model for each neuron is selected to minimize the criterion. The non-overlapping spike counting window <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e200" xlink:type="simple"/></inline-formula> was intuitively set to 3 ms to obtain a relatively small number of parameters while maintaining the temporal resolution. <xref ref-type="fig" rid="pcbi-1001110-g007">Figure 7</xref> shows the selected GLM spike order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e201" xlink:type="simple"/></inline-formula> of each neuron for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e202" xlink:type="simple"/></inline-formula>, and for each neuron 1 parameter (3 ms) through to 18 parameters (54 ms) were used to model its interconnection.</p>
<fig id="pcbi-1001110-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g007</object-id><label>Figure 7</label><caption>
<title>Selected GLM spike history order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e203" xlink:type="simple"/></inline-formula> by AIC.</title>
<p>Each neuron used 1 parameter (3 ms) through to 18 parameters (54 ms) to model its interconnection.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g007" xlink:type="simple"/></fig>
<p>The GOF of the estimated model is assessed by using the Kolmogorov-Smirnov (KS) plots <xref ref-type="bibr" rid="pcbi.1001110-Brown4">[40]</xref>. Prior to making inferences from an estimated statistical model, it is crucial to measure the agreement between a statistical model and the spike train data. For continuous-valued data, the GOF of the model can be quantitatively measured as standard distance such as MSE. However, this distance measure can not be applied to neural spike train data. To address this problem, we utilized the previously proposed time-rescaling theorem to transform point process measures such as neural spike train data to a continuous measure appropriate for a GOF assessment <xref ref-type="bibr" rid="pcbi.1001110-Brown4">[40]</xref>. Once a CIF is estimated, rescaled times can be computed using the estimated CIF. These rescaled times will be uniformly distributed random variables on the interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e204" xlink:type="simple"/></inline-formula> if the estimated CIF is a good approximation to the true conditional intensity of the point process. To evaluate whether the rescaled times follow the uniform distribution, we order these rescaled times from the smallest to the largest, and then plot the quantiles of the cumulative distribution function of the uniform distribution on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e205" xlink:type="simple"/></inline-formula> against the ordered rescaled times. This form of graphical representation is termed a KS plot. If the model is consistent with the data, then the points should lie on a 45-degree line. Approximate 95<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e206" xlink:type="simple"/></inline-formula> confidence bounds for the degree of agreement between the model and the data may be constructed using the distribution of the KS statistic <xref ref-type="bibr" rid="pcbi.1001110-Johnson1">[41]</xref>. <xref ref-type="fig" rid="pcbi-1001110-g008">Figure 8</xref> shows the best and the worst KS plots obtained using estimated GLMs across all the given spike train data. Most KS plots were almost within the confidence intervals, which indicates that most estimated GLMs fit the data well.</p>
<fig id="pcbi-1001110-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g008</object-id><label>Figure 8</label><caption>
<title>Best and worst KS plots across all 15 neurons.</title>
<p>The 45-degree solid line represents exact agreement between the model and spike train data. The two 45-degree dashed lines are the 95<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e207" xlink:type="simple"/></inline-formula> confidence bounds based on the distribution of the KS statistic. (A) Neuron 3 had the best KS plot. (B) Neuron 8 had the worst KS plot.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g008" xlink:type="simple"/></fig>
<p>The causal connectivity between the recorded neural spike train data was assessed using the proposed framework, and the results are illustrated in <xref ref-type="fig" rid="pcbi-1001110-g009">Figure 9</xref>. <xref ref-type="fig" rid="pcbi-1001110-g009">Figure 9A and B</xref> show the causal connectivity maps, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e208" xlink:type="simple"/></inline-formula>, estimated using the proposed framework without and with the FDR correction, respectively. As illustrated in <xref ref-type="fig" rid="pcbi-1001110-g009">Figure 9A</xref> when the multiple comparison problem was not considered, more causal connectivity was estimated; however, there was a high probability that the false rejection of the null hypotheses of the multiple comparison caused the extra causal relationships. In the present study, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e209" xlink:type="simple"/></inline-formula> for the hypothesis testing was set to 0.05. After the FDR correction for the multiple comparison problem, the incidence of interactions between the recorded neurons was sparser, and is shown in <xref ref-type="fig" rid="pcbi-1001110-g009">Figure 9B</xref>. In <xref ref-type="fig" rid="pcbi-1001110-g009">Figure 9B</xref>, neurons 2, 3, 4, 5, 6, 9, and 10 exchanged causal interactions with a handful of other neurons including themselves, neurons 7, 12, 14, and 15 showed purely self-inhibitory interactions, and finally neurons 1, 8, 11, and 13 did not receive any influence from other neurons, nor did they show signs of self-interaction. Interestingly, neurons 5, 6, 9, and 10 appeared to display evidence of self-excitatory interactions, which is highly unusual behavior for a neuron. Interspike interval and autocorrelogram analysis were performed on these neurons in order to exclude the possibility that these interactions were occurring due to bursting behavior <xref ref-type="bibr" rid="pcbi.1001110-Bartho1">[37]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Nowak1">[38]</xref>. Further analysis of these neurons revealed that they also had the four highest history orders among neurons as shown in <xref ref-type="fig" rid="pcbi-1001110-g007">Figure 7</xref>. <xref ref-type="fig" rid="pcbi-1001110-g009">Figure 9C</xref> shows the connectivity map obtained using the neural spike train data recorded during a period of postural maintenance from the same recording sites in MI following completion of a satisfactory number of task trials shown in <xref ref-type="fig" rid="pcbi-1001110-g006">Figure 6</xref>. The data set includes 54,000 samples (3000 sampless/trial<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e210" xlink:type="simple"/></inline-formula>18 trials), and the total number of spikes for each neuron across all trials ranged from 55 to 1030. As shown in the figure, during the state of postural maintenance, most neurons did not show any evidence of significant interactions. It could be argued that the decrease in the number of detected significant interactions that were seen during the state of postural maintenance was actually related to the decreased number of spikes that were observed during this behavioral period. In order to prove that this decrease is actually related to a physiological phenomenon rather than a decreased spike count, causality analysis was performed using the first 11 trials (of a total of 50) of the ‘reaching’ data set, which decreased the averaged number of spikes in that set of data (522 spikes) to a similar level as the ‘postural maintenance’ set (520 spikes). <xref ref-type="fig" rid="pcbi-1001110-g009">Figure 9D</xref> illustrates the obtained causal connectivity map, and more significant interactions were still seen between neurons during reaching movement than during postural maintenance. Note that the obtained causal connectivity maps do not necessarily represent interactions as a result of direct anatomical connection, but suggests that a functional causal connectivity exists between the recorded neurons.</p>
<fig id="pcbi-1001110-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g009</object-id><label>Figure 9</label><caption>
<title>Causal connectivity maps between recorded neurons.</title>
<p>(A) The causal connectivity map, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e211" xlink:type="simple"/></inline-formula>, estimated without the application of the multiple comparisons correction is illustrated. (B) The causal connectivity map with the FDR correction is illustrated. (C) The causal connectivity map estimated from another data set recorded during a period of postural maintenance is illustrated. (D) The causal connectivity map was estimated using a smaller number of trials of the reaching task so that the number of spikes is similar to that of data set recorded during postural maintenance.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g009" xlink:type="simple"/></fig>
<p>The estimated GLM parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e212" xlink:type="simple"/></inline-formula> that correspond to the self-interactions of all neurons <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e213" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e214" xlink:type="simple"/></inline-formula> are illustrated in <xref ref-type="fig" rid="pcbi-1001110-g010">Figure 10</xref>. The red, blue, and green colors represent the excitatory, inhibitory, or no self-interactions, respectively. In all cases, the first parameter is always negative due to the absolute refractory period, and the remaining parameters generally have positive values for the self-excitatory interactions and negative values for the self-inhibitory interactions, respectively. In cases where no-interactions was occurring, only one negative parameter (indicated with green asterisk) existed. Neurons showing evidence of excitatory self-interactions have the four highest history orders, and those indicating inhibitory self-interactions have higher orders than those with no self-interactions, which have only one parameter.</p>
<fig id="pcbi-1001110-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g010</object-id><label>Figure 10</label><caption>
<title>Estimated GLM parameters for self-interactions.</title>
<p>The estimated GLM parameters for self-interactions are plotted for all neurons. The red, blue, and green colors denote the excitatory, inhibitory, or no self-interactions, respectively.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g010" xlink:type="simple"/></fig></sec></sec><sec id="s4">
<title>Discussion</title>
<p>We proposed a point process framework for identifying causal relationships between simultaneously recorded multiple neural spike train data. Granger causality has proven to be an effective method to test causality between signals when using the MVAR model, but to date it has been used for continuous-valued data <xref ref-type="bibr" rid="pcbi.1001110-Granger1">[7]</xref>–<xref ref-type="bibr" rid="pcbi.1001110-Chen1">[11]</xref>. The method described in this study represents a novel attempt to apply Granger causality to point process data. The high level of accuracy that our method displayed when predicting the nature of the interactions occurring in the simulated data set was an encouraging indication that the proposed method is sound. Furthermore, the marked disparity in incidence of interactions during movement and non-movement periods in the experimental data is in keeping with the findings of previous studies investigating interactions in MI <xref ref-type="bibr" rid="pcbi.1001110-Ghosh1">[36]</xref>. Thus, the outcome of both our simulated and experimental data analysis provides compelling evidence that Granger causality can be successfully applied to point process data. This is an important finding, as there are currently very few techniques that assess interactions between multiple neurons as well as providing insight regarding the causal relationships that exist between them. The ability to infer causal relationships between interacting neurons provides us with important information about networks of neurons being studied with this method. A detailed understanding of the interactions occurring in ensemble activity recorded from MI may lead to improved accuracy in algorithms used to control devices such as brain-computer interfaces and neural prosthetics <xref ref-type="bibr" rid="pcbi.1001110-Truccolo1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Pillow1">[42]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Hatsopoulos1">[43]</xref>.</p>
<p>Other model-based methods for assessing the directional relationships between neurons have been recently developed <xref ref-type="bibr" rid="pcbi.1001110-Okatan1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Pillow1">[42]</xref>. These methods infer underlying interactions between neurons based on estimated model parameters, which contain the information on the dependencies between all of the recorded neurons. Thus, functional connectivity between neurons is inferred when the estimated model parameters achieve non-zero magnitude, that is, when their confidence intervals do not cross the zero-magnitude line. However, no quantitative criteria currently exists to guide users of these methods to accept or reject detected interactions when the suspected interaction is of low magnitude, or high magnitude but with wide confidence intervals for the estimated parameters. Thus, in more difficult cases where a model-based method produces uncertain results, the acceptance of a spurious interaction, or the rejection of a legitimate one, may compromise the reliability of experimental data analysis. The proposed point process framework addresses this issue by performing statistical significance tests that investigate the causal interactions based on the likelihood ratio statistic, eliminating this uncertainty. Thus, the proposed method may be of use to researchers who are having trouble quantifying some of the connections that they are detecting when using other model-based methods.</p>
<p>Some of the neurons included in this analysis showed no evidence of either self-interaction, or interactions with other neurons. Although these neurons also had non-zero GLM parameters for self-interaction, as indicated with green asterisks in <xref ref-type="fig" rid="pcbi-1001110-g010">Figure 10</xref>, their effects were tested to be statistically insignificant compared to those caused by other neurons or background firing activity. In these cases, we must consider that the hypothesis testing to evaluate the significant causal interactions depends on the FDR value that is chosen. Decreasing the FDR value means that a statistical threshold for the significance test is more strict, and would lead to a sparser causal connectivity map. Therefore, it should be noted that the inferred causal connectivity maps <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e215" xlink:type="simple"/></inline-formula> generated by this method are not absolute, and may change depending on the user's selection of the FDR value.</p>
<p>The identification of excitatory self-interactions for some of the analyzed neurons was an unexpected and interesting finding. Analysis of the spiking features of these neurons verified that they were not engaged in any manner of bursting behavior that may explain the self-excitation result. Based on the high history orders that were also seen in those neurons as shown in <xref ref-type="fig" rid="pcbi-1001110-g010">Figure 10</xref>, we infer that the self-excitation result may be caused by ‘hidden’ positive feedback networks, that is, networks involving neurons that were not recorded by our microwires. To support our inference, we have performed another simulation to investigate the effect of hidden feedback networks. We identified the causal interactions among ensemble spiking activity, which was synthetically generated based on the five-neuron network of <xref ref-type="fig" rid="pcbi-1001110-g011">Figure 11</xref>. Compared to the nine-neuron network of <xref ref-type="fig" rid="pcbi-1001110-g001">Figure 1A</xref>, the five-neuron network of <xref ref-type="fig" rid="pcbi-1001110-g011">Figure 11A</xref> had hidden neurons 4 and 5, which composed hidden positive feedback networks together with neuron 1. So the firing activity of neuron 1 was not only dependent on the spiking activity of observed neurons 2 and 3, but also on the spiking activity of hidden neurons 4 and 5; however, only neurons 1, 2, and 3 were observable. The parameter vector for the excitatory interaction of the hidden network was set to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e216" xlink:type="simple"/></inline-formula> = [0 0 1 2 2 1]. The other experimental settings were all same to the previous case. We generated 100,000 samples for each neuron, and the total number of spikes for the observed neurons 1, 2, and 3 were 4247, 2606, and 2314, respectively. Due to the hidden positive feedback, neuron 1 fired more spikes than other neurons. The model orders were selected using the AIC, and the selected orders for neurons 1, 2, and 3 were 5 (10 ms history duration), 2 (4 ms), and 2 (4 ms), respectively. Neuron 1 had a relatively longer history duration than other neurons due to the hidden feedback networks. Using the proposed method, we obtained both the Granger causality map <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e217" xlink:type="simple"/></inline-formula> and the causal connectivity map <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e218" xlink:type="simple"/></inline-formula>, which is illustrated in <xref ref-type="fig" rid="pcbi-1001110-g012">Figure 12</xref>. The estimated causality map <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e219" xlink:type="simple"/></inline-formula> matches well the original network of <xref ref-type="fig" rid="pcbi-1001110-g011">Figure 11</xref> except that neuron 1 was estimated to have a self-excitatory interaction, which was caused by the hidden positive causal interactions with neurons 4 and 5. This hidden interaction also led to the relatively long history duration of neuron 1 compared to the other neurons. This simulation supported the idea that hidden positive feedback network leads to the relatively long history duration and can change inhibitory self-interaction to excitatory one, which we could also observe in this real data analysis case. Similarly, self-inhibitory interactions, which had a relatively long history duration as shown in <xref ref-type="fig" rid="pcbi-1001110-g010">Figure 10</xref>, were also identified in this study, and may be the result of hidden negative feedback networks. Self-inhibitory interactions (as they are defined using this method) may be difficult to quantify in some cases, as a neuron with a very low firing rate may produce a self-inhibitory result that is similar in appearance to that which would occur due to hidden negative networks. However, the majority of the neurons in the present study that showed the evidence of self-inhibition had quite high firing rates. Thus, the inference of hidden negative feedback networks is a plausible explanation in these cases. The proposed framework creates an unprecedented opportunity to investigate interactions from hidden neural networks that have either excitatory or inhibitory causal influences on recorded neurons. Recently a method called partial Granger causality to identify the underlying causal interactions in the presence of exogenous inputs and latent variables for the continuous-valued case has been proposed <xref ref-type="bibr" rid="pcbi.1001110-Guo1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1001110-Guo2">[45]</xref>. It would be useful to extend this work to neural spike train data in order to deal with the effects of exogenous inputs or hidden neurons beyond the investigation of the hidden feedback network.</p>
<fig id="pcbi-1001110-g011" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g011</object-id><label>Figure 11</label><caption>
<title>Five-neuron ensemble with a hidden positive feedback network.</title>
<p>(A) Five neurons interacting with one other were simulated, but only neurons 1, 2, and 3 were treated as spike trains that were simultaneously recorded together. The activities of neurons 4 and 5 were used to create a hidden positive feedback network with neuron 1, but were treated as neurons outside the receptive field of an electrode: that is, their activities were not used as covariates to create the connectivity maps. (B) The true causal connectivity map between neurons 1, 2 and 3 is obtained from (A).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g011" xlink:type="simple"/></fig><fig id="pcbi-1001110-g012" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001110.g012</object-id><label>Figure 12</label><caption>
<title>Two causality maps obtained using the simulated data with hidden positive feedback network.</title>
<p>(A) The Granger causality matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e220" xlink:type="simple"/></inline-formula> shows the relative strength of causal interactions. (B) The causality connectivity map <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001110.e221" xlink:type="simple"/></inline-formula> shows the statistically significant causal interactions. The estimated pattern matches the actual network of <xref ref-type="fig" rid="pcbi-1001110-g011">Figure 11</xref> except that neuron 1 was estimated to have an excitatory self-interaction due to the hidden positive feedback network.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001110.g012" xlink:type="simple"/></fig>
<p>The Matlab software and the data sets used to implement the methods presented here are available at the website (<ext-link ext-link-type="uri" xlink:href="http://www.neurostat.mit.edu/gcpp" xlink:type="simple">http://www.neurostat.mit.edu/gcpp</ext-link>).</p>
</sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1001110-Brown1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name>
<name name-style="western"><surname>Kass</surname><given-names>RE</given-names></name>
<name name-style="western"><surname>Mitra</surname><given-names>PP</given-names></name>
</person-group>             <year>2005</year>             <article-title>Multiple neural spike train data analysis: state-of-the-art and future challenges.</article-title>             <source>Nat Neurosci</source>             <volume>7</volume>             <fpage>456</fpage>             <lpage>461</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Brody1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brody</surname><given-names>CD</given-names></name>
</person-group>             <year>1999</year>             <article-title>Correlations without synchrony.</article-title>             <source>Neural Comput</source>             <volume>11</volume>             <fpage>1537</fpage>             <lpage>1551</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Gerstein1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gerstein</surname><given-names>GL</given-names></name>
<name name-style="western"><surname>Perkel</surname><given-names>DH</given-names></name>
</person-group>             <year>1969</year>             <article-title>Simultaneously recorded trains of action potentials: analysis and functional interpretation.</article-title>             <source>Science</source>             <volume>164</volume>             <fpage>828</fpage>             <lpage>830</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Ventura1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ventura</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Cai</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Kass</surname><given-names>RE</given-names></name>
</person-group>             <year>2005</year>             <article-title>Statistical assessment of time-varying dependency between two neurons.</article-title>             <source>J Neurophysiol</source>             <volume>94</volume>             <fpage>2940</fpage>             <lpage>2947</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Gerstein2"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gerstein</surname><given-names>GL</given-names></name>
<name name-style="western"><surname>Perkel</surname><given-names>DH</given-names></name>
<name name-style="western"><surname>Dayhoff</surname><given-names>JE</given-names></name>
</person-group>             <year>1985</year>             <article-title>Cooperative firing activity in simultaneously recorded populations of neurons: detection and measurement.</article-title>             <source>J Neurosci</source>             <volume>5</volume>             <fpage>881</fpage>             <lpage>889</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Stevenson1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stevenson</surname><given-names>IH</given-names></name>
<name name-style="western"><surname>Rebesco</surname><given-names>JM</given-names></name>
<name name-style="western"><surname>Hatsopoulos</surname><given-names>NG</given-names></name>
<name name-style="western"><surname>Haga</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Miller</surname><given-names>LE</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Bayesian inference of functional connectivity and network structure from spikes.</article-title>             <source>IEEE Trans Neural Syst Rehabil Eng</source>             <volume>17</volume>             <fpage>203</fpage>             <lpage>213</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Granger1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Granger</surname><given-names>CWJ</given-names></name>
</person-group>             <year>1969</year>             <article-title>Investigating causal relations by econometric models and cross-spectral methods.</article-title>             <source>Econometrica</source>             <volume>37</volume>             <fpage>424</fpage>             <lpage>438</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Brovelli1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brovelli</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Ding</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Ledberg</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Chen</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Nakamura</surname><given-names>R</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Beta oscillations in a large-scale sensorimotor cortical network: directional influences revealed by Granger causality.</article-title>             <source>Proc Natl Acad Sci U S</source>             <volume>A101</volume>             <fpage>9849</fpage>             <lpage>9854</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Ding1"><label>9</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ding</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Chen</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Bressler</surname><given-names>SL</given-names></name>
</person-group>             <year>2006</year>             <article-title>Grange causality: basic theory and application to neuroscience.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Schelter</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Winterhalder</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Timmer</surname><given-names>J</given-names></name>
</person-group>             <source>Handbook of time series anal</source>             <publisher-loc>Wienheim</publisher-loc>             <publisher-name>Wiley</publisher-name>             <fpage>437</fpage>             <lpage>460</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Seth1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Seth</surname><given-names>AK</given-names></name>
</person-group>             <year>2005</year>             <article-title>Causal connectivity of evolved neural networks during behavior.</article-title>             <source>Netw Comput Neural Syst</source>             <volume>16</volume>             <fpage>35</fpage>             <lpage>54</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Chen1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chen</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Bressler</surname><given-names>SL</given-names></name>
<name name-style="western"><surname>Ding</surname><given-names>M</given-names></name>
</person-group>             <year>2006</year>             <article-title>Frequency decomposition of conditional Granger causality and application to multivariate neural field potential data.</article-title>             <source>J Neurosci Methods</source>             <volume>150</volume>             <fpage>228</fpage>             <lpage>237</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Wiener1"><label>12</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wiener</surname><given-names>N</given-names></name>
</person-group>             <year>1956</year>             <article-title>The theory of prediction.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Beckenbach</surname><given-names>EF</given-names></name>
</person-group>             <source>Modern mathematics for engineers</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>McGraw-Hill</publisher-name>             <fpage>165</fpage>             <lpage>190</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Sameshima1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sameshima</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Baccala</surname><given-names>LA</given-names></name>
</person-group>             <year>1999</year>             <article-title>Using partial directed coherence to describe neuronal ensemble interactions.</article-title>             <source>J Neurosci Methods</source>             <volume>94</volume>             <fpage>93</fpage>             <lpage>103</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Kaminski1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kaminski</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Ding</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Truccolo</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Bressler</surname><given-names>SL</given-names></name>
</person-group>             <year>2001</year>             <article-title>Evaluating causal relations in neural systems: Granger causality, directed transfer function and statistical assessment of sifnificance.</article-title>             <source>Biol Cybern</source>             <volume>85</volume>             <fpage>145</fpage>             <lpage>157</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Zhu1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zhu</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Lai</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Hoppensteadt</surname><given-names>FC</given-names></name>
<name name-style="western"><surname>He</surname><given-names>J</given-names></name>
</person-group>             <year>2003</year>             <article-title>Probing changes in neural interaction during adaptation.</article-title>             <source>Neural Comput</source>             <volume>15</volume>             <fpage>2359</fpage>             <lpage>2377</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Krumin1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Krumin</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Shoham</surname><given-names>S</given-names></name>
</person-group>             <year>2010</year>             <article-title>Multivariate autoregressive modeling and Granger causality analysis of multiple spike trains.</article-title>             <source>Comput Intell Neurosci</source>             <volume>2010</volume>             <fpage>1</fpage>             <lpage>9</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Schreiber1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schreiber</surname><given-names>T</given-names></name>
</person-group>             <year>2000</year>             <article-title>Measuring information transfer.</article-title>             <source>Phys Rev Lett</source>             <volume>85</volume>             <fpage>461</fpage>             <lpage>464</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Pereda1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pereda</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Quiroga</surname><given-names>RQ</given-names></name>
<name name-style="western"><surname>Bhattacharya</surname><given-names>J</given-names></name>
</person-group>             <year>2005</year>             <article-title>Nonlinear multivariate analysis of neurophysiological signals.</article-title>             <source>Prog Neurobiol</source>             <volume>77</volume>             <fpage>1</fpage>             <lpage>37</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Nedungadi1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nedungadi</surname><given-names>AG</given-names></name>
<name name-style="western"><surname>Rangarajan</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Jain</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Ding</surname><given-names>M</given-names></name>
</person-group>             <year>2009</year>             <article-title>Analyzing multiple spike trains with nonparametric Granger causality.</article-title>             <source>J Comput Neurosci</source>             <volume>27</volume>             <fpage>55</fpage>             <lpage>64</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Truccolo1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Truccolo</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Eden</surname><given-names>UT</given-names></name>
<name name-style="western"><surname>Fellows</surname><given-names>MR</given-names></name>
<name name-style="western"><surname>Donoghue</surname><given-names>JP</given-names></name>
<name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name>
</person-group>             <year>2005</year>             <article-title>A point process framework for relating neural spiking activity for spiking history, neural ensemble and extrinsic covariate effects.</article-title>             <source>J Neurophysiol</source>             <volume>93</volume>             <fpage>1074</fpage>             <lpage>1089</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Okatan1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Okatan</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Wilson</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name>
</person-group>             <year>2005</year>             <article-title>Analyzing functioanal connectivity using a network likelihood model of ensemble neural spiking activity.</article-title>             <source>Neural Comput</source>             <volume>17</volume>             <fpage>1927</fpage>             <lpage>1961</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Geweke1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Geweke</surname><given-names>J</given-names></name>
</person-group>             <year>1982</year>             <article-title>Measurement of linear dependence and feedback between multiple time series.</article-title>             <source>J Am Stat Assoc</source>             <volume>77</volume>             <fpage>304</fpage>             <lpage>313</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Dobson1"><label>23</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dobson</surname><given-names>AJ</given-names></name>
</person-group>             <year>2002</year>             <source>An Introduction to generalized linear models</source>             <publisher-loc>London</publisher-loc>             <publisher-name>CRC Press</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">320</size>           </element-citation></ref>
<ref id="pcbi.1001110-Benjamini1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Benjamini</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Hochberg</surname><given-names>Y</given-names></name>
</person-group>             <year>1995</year>             <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing.</article-title>             <source>J R Stat Soc Series B Stat Methodol</source>             <volume>57</volume>             <fpage>289</fpage>             <lpage>300</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Daley1"><label>25</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Daley</surname><given-names>DJ</given-names></name>
<name name-style="western"><surname>Vere-Jones</surname><given-names>D</given-names></name>
</person-group>             <year>2003</year>             <source>An Introduction to the Theory of Point Process</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">573</size>           </element-citation></ref>
<ref id="pcbi.1001110-Brown2"><label>26</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name>
</person-group>             <year>2005</year>             <article-title>Theory of point processes for neural systems.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Chow</surname><given-names>C</given-names></name>
<etal/></person-group>             <source>Methods and models in neurophysics</source>             <publisher-loc>Paris</publisher-loc>             <publisher-name>Elsevier</publisher-name>             <fpage>691</fpage>             <lpage>726</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Brown3"><label>27</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name>
<name name-style="western"><surname>Barbieri</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Eden</surname><given-names>UT</given-names></name>
<name name-style="western"><surname>Frank</surname><given-names>L</given-names></name>
</person-group>             <year>2003</year>             <article-title>Likelihood methods for neural spike train data analysis.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Feng</surname><given-names>L</given-names></name>
</person-group>             <source>Computational neuroscience: A comprehensive approach</source>             <publisher-loc>London</publisher-loc>             <publisher-name>CRC Press</publisher-name>             <fpage>253</fpage>             <lpage>286</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Kass1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kass</surname><given-names>RE</given-names></name>
<name name-style="western"><surname>Ventura</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name>
</person-group>             <year>2006</year>             <article-title>Statistical issues in the analysis of neuronal data.</article-title>             <source>J Neurophysiol</source>             <volume>94</volume>             <fpage>8</fpage>             <lpage>25</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Pawitan1"><label>29</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pawitan</surname><given-names>Y</given-names></name>
</person-group>             <year>2001</year>             <source>In all likelihood: statistical modeling and inference using likelihood</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Oxford University Press</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">544</size>           </element-citation></ref>
<ref id="pcbi.1001110-McCullagh1"><label>30</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>McCullagh</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Nelder</surname><given-names>JA</given-names></name>
</person-group>             <year>1989</year>             <source>Generalized linear models</source>             <publisher-loc>London</publisher-loc>             <publisher-name>Chapman &amp; Hall/CRC</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">532</size>           </element-citation></ref>
<ref id="pcbi.1001110-Miller1"><label>31</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Miller</surname><given-names>RG</given-names></name>
</person-group>             <year>1981</year>             <source>Simultaneous statistical inference</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer Verlag</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">299</size>           </element-citation></ref>
<ref id="pcbi.1001110-Storey1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Storey</surname><given-names>JD</given-names></name>
</person-group>             <year>2002</year>             <article-title>A direct approach to false discovery rates.</article-title>             <source>J R Stat Soc Series B Stat Methodol</source>             <volume>64</volume>             <fpage>479</fpage>             <lpage>498</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Koch1"><label>33</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Koch</surname><given-names>C</given-names></name>
</person-group>             <year>1999</year>             <source>Biophysics of computation</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Oxford University Press</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">588</size>           </element-citation></ref>
<ref id="pcbi.1001110-Akaike1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Akaike</surname><given-names>H</given-names></name>
</person-group>             <year>1974</year>             <article-title>A new look at the statistical model identification.</article-title>             <source>IEEE Trans Automat Contr</source>             <volume>19</volume>             <fpage>716</fpage>             <lpage>723</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Burnham1"><label>35</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Burnham</surname><given-names>KP</given-names></name>
<name name-style="western"><surname>Anderson</surname><given-names>DR</given-names></name>
</person-group>             <year>1998</year>             <source>Model selection and inference. A practical information-theoretic approach</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">516</size>           </element-citation></ref>
<ref id="pcbi.1001110-Ghosh1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ghosh</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Putrino</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Burro</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Ring</surname><given-names>A</given-names></name>
</person-group>             <year>2009</year>             <article-title>Patterns of spatio-temporal correlations in the neural activity of the cat motor cortex during trained forelimb movements.</article-title>             <source>Somatosens Mot Res</source>             <volume>26</volume>             <fpage>31</fpage>             <lpage>49</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Bartho1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bartho</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Hirase</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Monconduit</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Zugaro</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Harris</surname><given-names>KD</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Characterization of neocortical principal cells and interneurons by network interactions and extracellular features.</article-title>             <source>J Neurophysiol</source>             <volume>92</volume>             <fpage>600</fpage>             <lpage>608</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Nowak1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nowak</surname><given-names>LG</given-names></name>
<name name-style="western"><surname>Azouz</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Sanchez-Vives</surname><given-names>MV</given-names></name>
<name name-style="western"><surname>Gray</surname><given-names>CM</given-names></name>
<name name-style="western"><surname>McCormick</surname><given-names>DA</given-names></name>
</person-group>             <year>2003</year>             <article-title>Electrophysiological classes of cat primary visual cortical neurons in vivo as revealed by quantitative analyses.</article-title>             <source>J Neurophysiol</source>             <volume>89</volume>             <fpage>1541</fpage>             <lpage>1566</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Legendy1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Legendy</surname><given-names>CR</given-names></name>
<name name-style="western"><surname>Salcman</surname><given-names>M</given-names></name>
</person-group>             <year>1985</year>             <article-title>Bursts and Recurrences of bursts in the spike trains of spontaneously active striate cortex neurons.</article-title>             <source>J Neurophysiol</source>             <volume>53</volume>             <fpage>926</fpage>             <lpage>939</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Brown4"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name>
<name name-style="western"><surname>Barvieri</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Ventura</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Kass</surname><given-names>RE</given-names></name>
<name name-style="western"><surname>Frank</surname><given-names>LM</given-names></name>
</person-group>             <year>2002</year>             <article-title>The time-rescaling theorem and its application to neural spike train data analysis.</article-title>             <source>Neural Comput</source>             <volume>14</volume>             <fpage>325</fpage>             <lpage>346</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Johnson1"><label>41</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Johnson</surname><given-names>NL</given-names></name>
<name name-style="western"><surname>Kotz</surname><given-names>S</given-names></name>
</person-group>             <year>1970</year>             <source>Distributions in statistics: continuous univariate distributions 2</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Wiley</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">306</size>           </element-citation></ref>
<ref id="pcbi.1001110-Pillow1"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pillow</surname><given-names>JW</given-names></name>
<name name-style="western"><surname>Shlens</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Sher</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Litke</surname><given-names>AM</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population.</article-title>             <source>Nature</source>             <volume>454</volume>             <fpage>995</fpage>             <lpage>999</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Hatsopoulos1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hatsopoulos</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Harrison</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Donoghue</surname><given-names>JP</given-names></name>
</person-group>             <year>2001</year>             <article-title>Representations based on neuronal interactions in motor cortex.</article-title>             <source>Prog Brain Res</source>             <volume>130</volume>             <fpage>233</fpage>             <lpage>244</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Guo1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Guo</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Seth</surname><given-names>AK</given-names></name>
<name name-style="western"><surname>Kendrick</surname><given-names>KM</given-names></name>
<name name-style="western"><surname>Zhou</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Feng</surname><given-names>J</given-names></name>
</person-group>             <year>2008</year>             <article-title>Partial Granger causality-Eliminating exogenous inputs and latent variables.</article-title>             <source>J Neurosci Methods</source>             <volume>172</volume>             <fpage>79</fpage>             <lpage>93</lpage>          </element-citation></ref>
<ref id="pcbi.1001110-Guo2"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Guo</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Wu</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Ding</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Feng</surname><given-names>J</given-names></name>
</person-group>             <year>2008</year>             <article-title>Uncovering interactions in the frequency domain.</article-title>             <source>PLoS Comp Biol</source>             <volume>4</volume>             <fpage>1</fpage>             <lpage>10</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>