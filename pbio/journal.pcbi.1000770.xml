<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-0535R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000770</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Transcriptional Regulation</subject><subject>Genetics and Genomics/Gene Expression</subject><subject>Mathematics/Statistics</subject></subj-group></article-categories><title-group><article-title>A Bayesian Framework to Account for Complex Non-Genetic Factors in Gene Expression Levels Greatly Increases Power in eQTL Studies</article-title><alt-title alt-title-type="running-head">Bayesian Framework for Phenotypic Variability</alt-title></title-group><contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Stegle</surname><given-names>Oliver</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Parts</surname><given-names>Leopold</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Durbin</surname><given-names>Richard</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Winn</surname><given-names>John</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Max Planck Institutes Tübingen, Tübingen, Germany</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>University of Cambridge, Cambridge, United Kingdom</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Wellcome Trust Sanger Institute, Hinxton, Cambridge, United Kingdom</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Microsoft Research, Cambridge, United Kingdom</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Regev</surname><given-names>Aviv</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Broad Institute of MIT and Harvard, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">oliver.stegle@tuebingen.mpg.de</email> (OS); <email xlink:type="simple">jwinn@microsoft.com</email> (JW)</corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: OS LP RD JW. Performed the experiments: OS LP. Analyzed the data: OS LP. Wrote the paper: OS LP RD JW. Developed methodology: OS LP RD JW.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>5</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>6</day><month>5</month><year>2010</year></pub-date><volume>6</volume><issue>5</issue><elocation-id>e1000770</elocation-id><history>
<date date-type="received"><day>13</day><month>5</month><year>2009</year></date>
<date date-type="accepted"><day>30</day><month>3</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Stegle et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Gene expression measurements are influenced by a wide range of factors, such as the state of the cell, experimental conditions and variants in the sequence of regulatory regions. To understand the effect of a variable of interest, such as the genotype of a locus, it is important to account for variation that is due to confounding causes. Here, we present VBQTL, a probabilistic approach for mapping expression quantitative trait loci (eQTLs) that jointly models contributions from genotype as well as known and hidden confounding factors. VBQTL is implemented within an efficient and flexible inference framework, making it fast and tractable on large-scale problems. We compare the performance of VBQTL with alternative methods for dealing with confounding variability on eQTL mapping datasets from simulations, yeast, mouse, and human. Employing Bayesian complexity control and joint modelling is shown to result in more precise estimates of the contribution of different confounding factors resulting in additional associations to measured transcript levels compared to alternative approaches. We present a threefold larger collection of <italic>cis</italic> eQTLs than previously found in a whole-genome eQTL scan of an outbred human population. Altogether, 27% of the tested probes show a significant genetic association in <italic>cis</italic>, and we validate that the additional eQTLs are likely to be real by replicating them in different sets of individuals. Our method is the next step in the analysis of high-dimensional phenotype data, and its application has revealed insights into genetic regulation of gene expression by demonstrating more abundant <italic>cis</italic>-acting eQTLs in human than previously shown. Our software is freely available online at <ext-link ext-link-type="uri" xlink:href="http://www.sanger.ac.uk/resources/software/peer/" xlink:type="simple">http://www.sanger.ac.uk/resources/software/peer/</ext-link>.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Gene expression is a complex phenotype. The measured expression level in an experiment can be affected by a wide range of factors—state of the cell, experimental conditions, variants in the sequence of regulatory regions, and others. To understand genotype-to-phenotype relationships, we need to be able to distinguish the variation that is due to the genetic state from all the confounding causes. We present VBQTL, a probabilistic method for dissecting gene expression variation by jointly modelling the underlying global causes of variability and the genetic effect. Our method is implemented in a flexible framework that allows for quick model adaptation and comparison with alternative models. The probabilistic approach yields more accurate estimates of the contributions from different sources of variation. Applying VBQTL, we find that common genetic variation controlling gene expression levels in human is more abundant than previously shown, which has implications for a wide range of studies relating genotype to phenotype.</p>
</abstract><funding-group><funding-statement>This work was supported by the Wellcome Trust [grant number WT077192/Z/05/Z] and the Technical Computing Initiative (Microsoft Research). OS received funding from EPSRC and the Cambridge Gates Trust. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="11"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>DNA microarray technologies allow for quantification of expression levels of thousands of loci in the genome. These measurements enable exploring how a variable, such as clinical phenotype, tissue type, or genetic background, affects the transcriptional state of the sample. Recently, gene expression levels have been studied as quantitative genetic traits, investigating the effect of genotype as the primary variable. Studies have found and characterised large numbers of expression quantitative trait loci (eQTLs) <xref ref-type="bibr" rid="pcbi.1000770-Brem1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1000770-Schadt1">[3]</xref>, exploring their complexity <xref ref-type="bibr" rid="pcbi.1000770-Brem2">[2]</xref>, population genetics <xref ref-type="bibr" rid="pcbi.1000770-Stranger1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1000770-Spielman1">[5]</xref> and associations with disease <xref ref-type="bibr" rid="pcbi.1000770-Chen1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1000770-Emilsson1">[7]</xref>.</p>
<p>An important issue in such studies is additional variation in expression data that is not due to the genetic state, as illustrated in <xref ref-type="fig" rid="pcbi-1000770-g001">Figure 1</xref>. Intracellular fluctuations, environmental conditions, and experimental procedures are factors that all can have a strong effect on the measured transcript levels <xref ref-type="bibr" rid="pcbi.1000770-Brem2">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1000770-Gibson1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1000770-Plagnol1">[10]</xref> and thereby obscure the association signal. When measured, correct estimation of the additional variation due to these <italic>known factors</italic> allows for a more sensitive analysis of the genetic effect. For example, it has been reported that additional human eQTLs can be found when including the known factors of age, and blood cell counts in the model <xref ref-type="bibr" rid="pcbi.1000770-Emilsson1">[7]</xref>. It is also standard procedure to correct for batch effects, such as image artefacts or sample preparation differences <xref ref-type="bibr" rid="pcbi.1000770-Balding1">[11]</xref>.</p>
<fig id="pcbi-1000770-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000770.g001</object-id><label>Figure 1</label><caption>
<title>General additive model for sources of gene expression variability.</title>
<p>The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e001" xlink:type="simple"/></inline-formula> matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e002" xlink:type="simple"/></inline-formula> of measured gene expression levels of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e003" xlink:type="simple"/></inline-formula> genes from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e004" xlink:type="simple"/></inline-formula> individuals is modelled by additive contributions from components <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e005" xlink:type="simple"/></inline-formula> and observation noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e006" xlink:type="simple"/></inline-formula>. Here, the components capture the signal due to primary effect of the genetic state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e007" xlink:type="simple"/></inline-formula>, known factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e008" xlink:type="simple"/></inline-formula> and hidden factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e009" xlink:type="simple"/></inline-formula>. Some examples of possible underlying sources of variation are given above the model boxes. The groupings represent some standard genetic association models commonly used.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.g001" xlink:type="simple"/></fig>
<p>In practise it is not possible to measure or even be aware of all potential sources of variation, but nevertheless it is important to account for them. Unobserved, <italic>hidden factors</italic>, such as cell culture conditions <xref ref-type="bibr" rid="pcbi.1000770-Pastinen1">[12]</xref> often have an influence on large numbers of genes. We and others have proposed methods to detect and correct for such effects <xref ref-type="bibr" rid="pcbi.1000770-Leek1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1000770-Stegle1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1000770-Kang1">[14]</xref>. These studies demonstrated the importance of accounting for hidden factors, yielding a stronger statistical discrimination signal.</p>
<p>The challenge in modelling several confounding sources of variation (<xref ref-type="fig" rid="pcbi-1000770-g001">Figure 1</xref>) is to correctly estimate the contribution that is due to each one of them. There are open questions how to ensure that only spurious signal is eliminated by methods that account for hidden factors (see for instance discussion in <xref ref-type="bibr" rid="pcbi.1000770-Kang1">[14]</xref>), and how to deal with situations when both known and hidden factors are present. The problem of identifying the correct causes of the signal is even harder in the presence of additional sources of variability. For example, when searching for epistatic or genotype-environment interactions, the primary effects of other known factors and hidden factors also need to be accounted for.</p>
<p>The key for correctly attributing expression variability is controlling the complexity of the statistical models for each source of variation. For example, the number of genotypes considered in an association scan can be enormous, and not all of them affect the expression level of every probe. Threshold values, obtained from likelihood ratio statistics or empirical p-value distributions, can be used to determine the significance of individual associations, thereby avoiding overfitting by controlling the model complexity <xref ref-type="bibr" rid="pcbi.1000770-Stranger1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1000770-Lander1">[15]</xref>. Similar measures are necessary for models of other sources of variability such as hidden factors.</p>
<p>In this work we present VBQTL (Variational Bayesian QTL mapper), a joint Bayesian framework for gene expression variability that accounts for the signal from genotype, known factors, and hidden factors. VBQTL is implemented within a general framework that provides commonly used models for sources of phenotypic variation, which can be combined as needed. While previous attempts have been specific to a narrow set of underlying sources, our approach is flexible and can be adapted to a particular study design. The probabilistic treatment allows uncertainty to be propagated between models, and yields a posterior distribution over model parameters. Complexity control is tackled at the level of individual models, where parameters are regularised in a Bayesian manner.</p>
<p>We compare the performance of VBQTL with existing approaches for detecting expression QTLs. A simulation experiment contrasts VBQTL with common approaches that use non-Bayesian techniques for distinguishing global hidden factor effects from genetic effects. This study highlights differences in the methodology to control model complexity with implications to eQTL detection power. The necessity and difficulty to account for variability that confounds the genetic signal is demonstrated. Results on datasets from a human outbred population and crosses of inbred yeast and mouse strains show that VBQTL identifies more significant associations than alternative methods. Finally, we apply VBQTL to perform a whole-genome eQTL scan on the HapMap phase 2 expression and genotype data, demonstrating the scalability of our framework to large numbers of samples and probes. We find three times more <italic>cis</italic> eQTLs than a standard association mapping method, suggesting more extensive genetic control of gene expression by common variants than previously shown.</p>
</sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<p>Here, we present VBQTL, a configuration of a general framework for modelling diverse sources of gene expression variability. The model underlying this framework assumes that gene expression levels are influenced by additive effects from independent sources, e.g. in the case of VBQTL these are contributions from genotype, known factors, and hidden factors (<xref ref-type="fig" rid="pcbi-1000770-g001">Figures 1</xref>, <xref ref-type="fig" rid="pcbi-1000770-g002">2a</xref>). We cast the full model in a probabilistic setting, treating its parameters as random variables.</p>
<fig id="pcbi-1000770-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000770.g002</object-id><label>Figure 2</label><caption>
<title>Bayesian network and outline of the inference schedule for VBQTL.</title>
<p>(<bold>a</bold>) The Bayesian network for the model of gene expression variation used in VBQTL (see <xref ref-type="sec" rid="s2">Methods</xref>). The full model combines genetic (green), known factor (blue) and hidden factor (red) models to explain the observed gene expression levels <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e010" xlink:type="simple"/></inline-formula>. The solid rectangles indicate that contained variables are duplicated for each gene probe (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e011" xlink:type="simple"/></inline-formula>), SNP (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e012" xlink:type="simple"/></inline-formula>) or factor (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e013" xlink:type="simple"/></inline-formula>) respectively. A similar rectangle for individuals (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e014" xlink:type="simple"/></inline-formula>) is omitted in this representation. The dashed rectangle indicates that the variable <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e015" xlink:type="simple"/></inline-formula> switches the contained part of the graph on or off representing the existence or lack of an association. Nodes with thick outlines (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e016" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e017" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e018" xlink:type="simple"/></inline-formula>) are observed. (<bold>b</bold>)–(<bold>e</bold>) Update cycle of the known factors model introduced in Section Inference. The red outline highlights the parts of the model that change in a step, and the thick blue arrows illustrate the flow of information. Details of these updates are discussed in the text.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.g002" xlink:type="simple"/></fig>
<p>We perform Bayesian inference in the joint model, which is appealing for several reasons. First, it allows possible dependencies between the different sources of variation to be captured. The effects of the genotype, known and hidden factors are learned jointly, taking other parts of the model into account. Propagation of uncertainty leads to more accurate parameter estimates <xref ref-type="bibr" rid="pcbi.1000770-Rattray1">[16]</xref>, and avoids possible pathologies, for instance of maximum likelihood methods <xref ref-type="bibr" rid="pcbi.1000770-MacKay1">[17]</xref>. Second, Bayesian inference allows different models to be flexibly combined according to the needs of a particular study. Many existing approaches can be cast as special cases of this general framework, with some examples given in <xref ref-type="fig" rid="pcbi-1000770-g001">Figure 1</xref>. Finally, the Bayesian approach leads itself to efficient approximate inference schemes such as variational methods <xref ref-type="bibr" rid="pcbi.1000770-Jordan1">[18]</xref>, rendering the resulting algorithms applicable to large-scale and high-dimensional datasets. Also, variational learning allows an inference schedule to be specified by the user, leading to distinct algorithms with different computational complexity and properties (see Inference).</p>
<p>In the following, we present the mathematical model of VBQTL, and an outline of the inference procedure. We then describe alternative non-Bayesian models for expression QTL studies used in the experiments. An in-depth treatment of the framework including full details about the parameter estimation is provided in <xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>.</p>
<sec id="s2a">
<title>VBQTL - a joint Bayesian model for gene expression variability</title>
<p>The observed gene expression matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e019" xlink:type="simple"/></inline-formula> for genes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e020" xlink:type="simple"/></inline-formula> and individuals <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e021" xlink:type="simple"/></inline-formula> is modelled by the sum of contributions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e022" xlink:type="simple"/></inline-formula> from the genotype, known and hidden factor models and Gaussian noise with precisions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e023" xlink:type="simple"/></inline-formula> for each gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e024" xlink:type="simple"/></inline-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e025" xlink:type="simple"/><label>(1)</label></disp-formula>with a gamma prior on the noise precisions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e026" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1000770-g002">Figure 2a</xref>). The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e027" xlink:type="simple"/></inline-formula> comprise the contribution of individual sources to the variability in the observed expression levels, and are themselves treated as random variables with different underlying models.</p>
<p><bold>1) Genotype effect model</bold> represents the probabilistic variant of the standard genetic association model, where some of the SNP genotypes have a linear effect on gene expression levels. The genetic component of the expression level <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e028" xlink:type="simple"/></inline-formula> of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e029" xlink:type="simple"/></inline-formula>th gene probe in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e030" xlink:type="simple"/></inline-formula>th individual is explained by linear effects of the genotypes of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e031" xlink:type="simple"/></inline-formula> SNPs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e032" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1000770-g002">Figure 2a</xref>, green plate):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e033" xlink:type="simple"/><label>(2)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e034" xlink:type="simple"/><label>(3)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e035" xlink:type="simple"/><label>(4)</label></disp-formula>The weights <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e036" xlink:type="simple"/></inline-formula> control the magnitude of the effect of the SNP on the expression levels of genes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e037" xlink:type="simple"/></inline-formula>. The binary variables <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e038" xlink:type="simple"/></inline-formula> determine whether the SNP effect is significant (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e039" xlink:type="simple"/></inline-formula>) or not (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e040" xlink:type="simple"/></inline-formula>). The prior probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e041" xlink:type="simple"/></inline-formula> of an individual association controls the complexity of the model by influencing the a priori expected number of significant associations; this parameter corresponds to a significance threshold in a classical setting (<xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>).</p>
<p>To reduce the computational cost, inference in the association model is approximated, only considering a single most relevant SNP-regulator per gene, with the other <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e042" xlink:type="simple"/></inline-formula> forced to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e043" xlink:type="simple"/></inline-formula>. This bottleneck approximation ensures tractability of the joint association model for large-scale studies (<xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>), avoiding the need to track the covariance between effects from multiple SNPs.</p>
<p><bold>2) Known factor model</bold> accounts for the effect of known covariates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e044" xlink:type="simple"/></inline-formula> of individual samples, such as environmental conditions, gender, or a population indicator. The linear effects of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e045" xlink:type="simple"/></inline-formula> measured covariates in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e046" xlink:type="simple"/></inline-formula>th individual, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e047" xlink:type="simple"/></inline-formula>, is taken into account using a variant of Bayesian regression (<xref ref-type="fig" rid="pcbi-1000770-g002">Figure 2a</xref>, blue plate):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e048" xlink:type="simple"/><label>(5)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e049" xlink:type="simple"/><label>(6)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e050" xlink:type="simple"/><label>(7)</label></disp-formula>Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e051" xlink:type="simple"/></inline-formula> is the corresponding weight vector for each gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e052" xlink:type="simple"/></inline-formula>. The gamma prior on the inverse variance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e053" xlink:type="simple"/></inline-formula> for weights of each factor introduces automatic relevance detection (ARD) <xref ref-type="bibr" rid="pcbi.1000770-Mackay1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1000770-Neal1">[20]</xref>, driving the weights of unused factors to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e054" xlink:type="simple"/></inline-formula> and thereby switching them off. This provides complexity control of the model by regularising the effective number of covariates.</p>
<p><bold>3) Hidden factor model</bold> accounts for the effect of hidden factors (such as unmeasured covariates and global effects) on the gene expression levels. We use a probabilistic variant of the classical factor analysis model for this task. We have previously shown that this model captures hidden factors better than alternative linear models, such as probabilistic principal component analysis or independent component analysis <xref ref-type="bibr" rid="pcbi.1000770-Stegle1">[13]</xref>. Similarly to known factors, the expression level of gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e055" xlink:type="simple"/></inline-formula> in individual <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e056" xlink:type="simple"/></inline-formula> is modelled by linear effects from a chosen number of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e057" xlink:type="simple"/></inline-formula> hidden factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e058" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1000770-g002">Figure 2a</xref>, red plate).<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e059" xlink:type="simple"/><label>(8)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e060" xlink:type="simple"/><label>(9)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e061" xlink:type="simple"/><label>(10)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e062" xlink:type="simple"/><label>(11)</label></disp-formula>Note that in contrast to the known factor model, the factor activations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e063" xlink:type="simple"/></inline-formula> are unobserved random variables that need to be inferred from the expression profiles. Again, the ARD prior switches unused factors off, thereby providing probabilistic complexity control (<xref ref-type="bibr" rid="pcbi.1000770-Stegle1">[13]</xref>, <xref ref-type="sec" rid="s3">Results</xref>).</p>
</sec><sec id="s2b">
<title>Inference</title>
<p>Parameter inference in VBQTL is implemented using variational Bayesian learning <xref ref-type="bibr" rid="pcbi.1000770-Jordan1">[18]</xref>, a generalisation of the expectation maximisation algorithm. An approximate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e064" xlink:type="simple"/></inline-formula>-distribution over model parameters is iteratively refined until convergence. In each iteration, approximate distributions of individual parameters are updated according to a specified schedule, taking the current state of all other parameter distributions into account (<xref ref-type="fig" rid="pcbi-1000770-g002">Figure 2b–e</xref>). Choosing an approximation that factorises over individual models, the variational update equations have an intuitive interpretation:</p>
<list list-type="order"><list-item>
<p>The current belief of the residual dataset for a particular active model is calculated, taking the prediction form all other models and the estimated noise precision into account (<xref ref-type="fig" rid="pcbi-1000770-g002">Figure 2b</xref>).</p>
</list-item><list-item>
<p>The parameters of the active <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e065" xlink:type="simple"/></inline-formula>th model are updated based on their previous states and the new residual dataset (<xref ref-type="fig" rid="pcbi-1000770-g002">Figure 2c</xref>).</p>
</list-item><list-item>
<p>The distribution of the model contribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e066" xlink:type="simple"/></inline-formula> is recalculated using the updated parameter values. The global noise precisions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e067" xlink:type="simple"/></inline-formula> are updated (<xref ref-type="fig" rid="pcbi-1000770-g002">Figure 2d</xref>) based on the first and second moments of all the contributions.</p>
</list-item><list-item>
<p>The same procedure is in turn applied to the remaining models in the schedule (<xref ref-type="fig" rid="pcbi-1000770-g002">Figure 2e</xref>) until convergence.</p>
</list-item></list>
<p>This iterative procedure, performing updates of local parameter distributions in turn, can be interpreted as a message passing algorithm, where sufficient statistics of parameter and data distributions are propagated across the graphical model <xref ref-type="bibr" rid="pcbi.1000770-Winn1">[21]</xref>.</p>
<p>The initial values of parameters are determined from maximum likelihood solutions. A random initialisation via sampling from the prior is possible as well; we have not explored the implications of this alternative here. Details on inference and the individual parameter update equations are given in <xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>.</p>
<p>In experiments, we compare two alternative inference schedules of VBQTL. In iterative VBQTL (iVBQTL), the model parameters are learned using several iterations through all model components, first updating the genetic model, then known and hidden factors (<xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>). An important property of iVBQTL is that hidden factors are estimated jointly with the genetic state and known factors. This choice of schedule and the iterative learning help to ensure that variability that is due to genetic associations is not explained away by other parts of the model (<xref ref-type="sec" rid="s3">Results</xref>).</p>
<p>In cases where neither known nor hidden factors are correlated with the genetic state, their effect can be learned independently without running the risk of explaining away meaningful association signal. This motivates fast VBQTL (fVBQTL), which performs a single update iteration of the full model, first inferring the contribution from the known and hidden factors, and then from the genetic state. This simpler schedule can save significant computation time, since the factor effects can be precalculated, and only a single iteration of the computationally more expensive genetic association model is needed. In cases where the genetic state is approximately orthogonal to the known and hidden factors, this cheaper approximation performs equally with iVBQTL for finding genetic associations (<xref ref-type="sec" rid="s3">Results</xref>).</p>
</sec><sec id="s2c">
<title>Alternative methods to account for confounding variation in expression QTL studies</title>
<p>We compared VBQTL with previous methods that account for confounding variance in the context of expression QTL mapping. Similarly to VBQTL, they model known and hidden factors in the expression levels. The differences between the alternative methods are in the hidden factor model used, which in turn vary in the complexity control approach employed as highlighted below. Thus these alternative models are named after the hidden factor estimation method.</p>
<list list-type="bullet"><list-item>
<p><bold>Standard model</bold> explains the expression variability solely by the effects of known factors and SNP genotypes, without accounting for the hidden factors.</p>
</list-item><list-item>
<p><bold>PCA</bold> uses principal component analysis to detect hidden factors. In general, PCA can explain all the variability in the data. Complexity is controlled by specifying the number of components to use as a parameter.</p>
</list-item><list-item>
<p><bold>PCAsig</bold> is an extension of PCA to account for hidden factors. In this model, complexity control is achieved via significance testing of eigenvalues, retaining only components that explain more variance than expected by chance at a specified significance cutoff (<xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>).</p>
</list-item><list-item>
<p><bold>SVA</bold> model controls complexity similarly to PCAsig, and also accommodates a per-gene noise model and explicitly allows for sparse non-orthogonal components <xref ref-type="bibr" rid="pcbi.1000770-Leek1">[9]</xref>.</p>
</list-item></list>
<p>For a quantitative evaluation of the performance of each method, we considered the resulting residuals of the estimated effects from known and hidden factors. To detect eQTLs we applied standard statistical tests employing a linear model on the SNP genotype on these residual datasets (<xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>). For iVBQTL and fVBQTL, we inferred the posterior parameter distributions, and subtracted off the estimated effect of known and hidden factors. For other methods, we first subtracted off the standard linear regression fit of the known factors, and then learned and subtracted off the hidden factor effects on the residuals. All these alternative methods are also implemented in the general framework; for details see <xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>.</p>
<p>While VBQTL shares basic assumptions with these alternatives, there are a number of differences. First, it is a probabilistic model that operates with uncertainties in the parameter estimates as explained above. Second, the hidden factor model allows for non-orthogonal components, and provides probabilistic complexity control based on ARD. Third, the iVBQTL schedule takes the genetic signal into account when estimating the hidden factor effect. Finally, the VBQTL model estimates a global gene-specific noise level, while the non-Bayesian models either estimate noise levels implicitly (SVA) or assume noise-free observations (PCA, PCAsig).</p>
</sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Simulation study highlights performance differences due to complexity control approaches</title>
<p>We employed a simulated dataset to highlight the differences between alternative approaches to account for global factors in eQTL finding. Our synthetic expression data combines linear effects from genetic associations (eQTLs), known, hidden, and genetic global factors, and gene-specific noise (<xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>). We used three known and seven unknown global factors whose influence varies significantly to simulate effects with a range of magnitudes. These factors are meant to represent sources of confounding variation that are encountered in the study of the real datasets. We also introduced three global genetic factors giving rise to <italic>trans</italic> eQTL hotspots, mimicking the action of a genetic variant in a transcriptional regulator (e.g. transcription factor or pathway component). Such loci have been observed in several eQTL mapping studies <xref ref-type="bibr" rid="pcbi.1000770-Brem1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000770-Schadt1">[3]</xref>. We designated three genes with a simulated eQTL as such regulators, and simulated correlated expression levels for 15% of the genes for each. While the specific simulation scenario may be biased in the comparative performance of different methods, its underlying linear model is shared by all the considered approaches, and it gives intuition for the results on real datasets discussed later.</p>
<sec id="s3a1">
<title>Complexity control determines the accuracy of the hidden factor model</title>
<p>We assessed the ability of the considered methods to recover the simulated confounding variability. For those approaches that do infer hidden factor effects, we varied the corresponding complexity control parameters to investigate the influence on performance. For methods that take the number of components in the hidden factor model as a parameter (PCA, VBQTL), performance for one to 50 hidden factors was compared. For significance-testing based methods, we considered different significance cutoffs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e068" xlink:type="simple"/></inline-formula> in the range <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e069" xlink:type="simple"/></inline-formula>.</p>
<p>iVBQTL correctly captured the non-genetic global factor effects (<xref ref-type="fig" rid="pcbi-1000770-g003">Figure 3a</xref>), as it is the only method that models the genetic signal when learning hidden factors. All other methods treat the simulated transcription factor contributions as confounding variation and explain them away. This can be a desired effect when the genetic signal is not of primary interest, or a serious shortcoming when downstream eQTLs are sought.</p>
<fig id="pcbi-1000770-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000770.g003</object-id><label>Figure 3</label><caption>
<title>Sensitivity of recovering simulated hidden factor effects and eQTLs for Bayesian and non-Bayesian methods.</title>
<p>(<bold>a</bold>) Mean-squared error in estimating only the hidden factor contribution. Methods that do not explicitly retain the genetic factors explain them away as hidden global factors, resulting in high error comparable to not accounting for hidden factors at all (Standard). (<bold>b</bold>) Mean-squared error in estimating the contribution from hidden and genetic factors. (<bold>c</bold>) Sensitivity of recovering immediate SNP associations. (<bold>d</bold>) Sensitivity of recovering downstream associations. Seven hidden factors and three transcription factor effects were simulated. For eQTL sensitivity, standard eQTL finding on simulated data (Standard) and same data without the hidden effects (Ideal) are included as comparisons. PCAsig and SVA identified a constant number of hidden components (marked with a diamond shape), thus only a single result (dashed line) is given.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.g003" xlink:type="simple"/></fig>
<p>Complexity control settings determined the performance of capturing the simulated global effects on expression levels. PCA was most accurate when the number of hidden factors was set to 10, since seven hidden factors and three transcription factors were simulated. For larger number of components PCA overfitted, and started explaining away genetic signal, resulting in the increase in error. For a small number of components, transcription factor effects were explained away first, which increased the error in estimating the hidden factors alone. However, the estimates of the total global effects improved. PCAsig and SVA found 6 and 7 significant hidden factors for the wide range of significance cutoffs, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e070" xlink:type="simple"/></inline-formula>, respectively. They failed to detect some of the weaker hidden effects that continued to mask the genetic signal, and underfitted the data. Their performance was similar to PCA with the matching number of components. While the significance-testing based complexity control prevents these approaches from overfitting, only a single outcome is observed for a wide range of parameter settings, with the models settling to a rigid suboptimal solution. fVBQTL achieved the most accurate estimation of global variation. Notably, unlike PCA, its performance did not degrade for large numbers of hidden factors in the model, exhibiting good complexity control in this scenario.</p>
</sec><sec id="s3a2">
<title>Hidden factor effect estimation accuracy is mirrored in eQTL finding sensitivity</title>
<p>We determined the sensitivity and specificity of the considered methods for detecting the immediate and downstream simulated genetic associations. The significance of an eQTL was tested using a two-sided t test on the correlation coefficient with a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e071" xlink:type="simple"/></inline-formula> Bonferroni corrected per-gene false positive rate in the genetic association model. The results when calling eQTLs using regression on ranks, or permutations to establish the empirical null distribution of LOD scores were almost identical (<xref ref-type="supplementary-material" rid="pcbi.1000770.s003">Figure S1</xref>. As a benchmark, the comparison includes eQTL finding using the standard method on both raw expression data (Standard), and an ideal case, where the simulated hidden factor effects are removed, but the simulated genetic factors maintained (Ideal).</p>
<p>The accuracy of the hidden factor effect estimation mirrored the immediate eQTL finding sensitivity (<xref ref-type="fig" rid="pcbi-1000770-g003">Figure 3c</xref>). The specificity was consistent with the chosen false positive rate for all methods (data not shown). fVBQTL and iVBQTL recovered more true <italic>cis</italic> eQTLs compared to other methods, approaching the performance of the ideal case, mirroring the accuracy of estimating hidden factor effects. PCA overfitted when the number of components used was greater than the true number of ten simulated global factors, explaining away genetic signal. While the PCA error for detecting global effects increased only marginally, the decrease in sensitivity for identifying eQTLs was severe. The overfitting in case of PCA, and underfitting in case of PCAsig and SVA both resulted in a loss of sensitivity to find the simulated <italic>cis</italic> associations. fVBQTL and iVBQTL did not suffer from either deficiency, capturing nearly all the associations possible in the ideal case.</p>
<p>All methods except iVBQTL and standard method explained away simulated <italic>trans</italic> eQTL hotspots (<xref ref-type="fig" rid="pcbi-1000770-g003">Figure 3d</xref>). This is due to the global factor effect estimation accuracy, where iVBQTL alone refrained from explaining the hotspots away as a global factor. The standard method found nearly all the original <italic>trans</italic> associations, actually outperforming methods that explain away confounding variability. Thus, in cases where there is true genetic signal with widespread downstream effects, its contribution needs to be taken into account to retain its relation to genotype, and avoid attributing it to a confounding global cause. This is straightforward in our framework, and is demonstrated by the good performance of iVBQTL in this scenario. iVBQTL retained the original associations, while explaining away non-genetic causes of expression variability, thus adding power to detect the weaker, masked eQTLs. This effect is also observed in the study of crosses of inbred strains below.</p>
<p>Taken together these results suggest that it is important to account for the confounding sources of variation in expression levels, while keeping the signal of the genetic state. Correct complexity control is required to avoid over- and underfitting in order to achieve optimal sensitivity for detecting true genetic associations.</p>
</sec></sec><sec id="s3b">
<title>VBQTL finds additional expression QTLs in real datasets</title>
<p>Next, we compared the same methods for expression QTL finding on yeast <xref ref-type="bibr" rid="pcbi.1000770-Brem2">[2]</xref>, mouse <xref ref-type="bibr" rid="pcbi.1000770-Schadt1">[3]</xref> and human <xref ref-type="bibr" rid="pcbi.1000770-Stranger1">[4]</xref> datasets. These represent common study designs of an outbred population (human), and a population of crosses between inbred strains (yeast, mouse). We considered 5, 15, 30, and 60 hidden factors for PCA and VBQTL, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e072" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e073" xlink:type="simple"/></inline-formula> as significance cutoffs for SVA and PCAsig. Expression QTLs were detected using a two-sided t test analogously to the simulation scenario. Again, results for alternative genetic association tests were similar (<xref ref-type="supplementary-material" rid="pcbi.1000770.s004">Figures S2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000770.s005">S3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000770.s006">S4</xref>).</p>
<sec id="s3b1">
<title>Accounting for hidden factors helps to detect additional <italic>cis</italic> eQTLs in an outbred population</title>
<p>We applied the considered methods on the genotype and expression data from 90 individuals of the CEU (CEPH from Utah) HapMap phase 2 samples <xref ref-type="bibr" rid="pcbi.1000770-Stranger1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1000770-The1">[22]</xref>. The data consisted of genotypes of 55,000 SNPs and expression levels of 618 probes from chromosome 19 (results for three more chromosomes were similar, data not shown). The expression levels were measured in EBV-transformed lymphoblastoid cell lines of healthy individuals. The gender covariate was included as a known factor for all methods. We did not consider probes with overlapping SNPs. Following <xref ref-type="bibr" rid="pcbi.1000770-Stranger1">[4]</xref>, an association was called to be in <italic>cis</italic> when the SNP was within 1Mb from the probe midpoint and in <italic>trans</italic> otherwise.</p>
<p>The standard method found the least gene probes with a <italic>cis</italic> association (20, <xref ref-type="fig" rid="pcbi-1000770-g004">Figure 4c</xref>), suggesting that strong confounding sources of variation are present in this dataset. The number of identified probes with a <italic>trans</italic> association was not significantly higher than expected by chance at the chosen FPR, which is in line with previous results <xref ref-type="bibr" rid="pcbi.1000770-Stranger1">[4]</xref>, and suggests little intrachromosomal <italic>trans</italic> regulation.</p>
<fig id="pcbi-1000770-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000770.g004</object-id><label>Figure 4</label><caption>
<title>Number of probes with an eQTL found as a function of maximum number of hidden factors for three previously published datasets.</title>
<p>Significance-testing based methods (PCAsig, SVA) identified the same number of factors for a wide range of cutoff values (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e074" xlink:type="simple"/></inline-formula>), thus only a single count is given (dashed lines), together with the number of factors found (diamond shape). Other methods were applied with a maximum number of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e075" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e076" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e077" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e078" xlink:type="simple"/></inline-formula> hidden factors.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.g004" xlink:type="simple"/></fig>
<p>PCA, the simplest method for accounting for hidden factors, found additional associations when up to 30 principal components were used, but substantially fewer for 60 components. This is expected, since there are no more than 90 degrees of freedom in this dataset, and 60 principal components accounted for over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e079" xlink:type="simple"/></inline-formula> of the variance (<xref ref-type="supplementary-material" rid="pcbi.1000770.s011">Table S5</xref>), and hence PCA is likely to explain away part of the genetic association signal for large numbers of components.</p>
<p>The significance-testing based methods, SVA and PCAsig both found additional associations compared to the standard method. It is remarkable that both found a constant number of significant hidden factors for the wide range <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e080" xlink:type="simple"/></inline-formula> of significance cutoffs considered, again exhibiting rigid complexity control. The performance of SVA with the 12 hidden factors found is close to performance of PCA with 15 components (both find 38 probes with an association). Similarly, PCAsig with the 7 significant components performs comparably to PCA with 5 components (37 vs. 35 probes with an association). This shows the intrinsic similarity of these methods to PCA, as was also observed in the simulation scenario.</p>
<p>fVBQTL and iVBQTL found more probes with an association (55 and 54) than all other methods, representing an almost threefold increase in the number of genes with a <italic>cis</italic> eQTL. Complexity control assured that the performance saturated for large enough number of factors and did not degrade as for PCA. None of the estimated hidden factors was significantly correlated to a SNP genotype, suggesting that individual genetic variants do not have global effects on many gene expression levels in this dataset.</p>
<p>It is important to note that the model performance depends on two aspects. First, the model complexity control, regulating the amount of variance explained, is important to ensure that genetic signal is not attributed to hidden factors. Overfitting in case of PCA for a large number of components is an example of such an effect. Second, while alternative hidden factor models explained similar amounts of variance, their performance differed due to the underlying model. For example, PCA and fVBQTL both explained about 70% of variance in the observed expression levels (<xref ref-type="supplementary-material" rid="pcbi.1000770.s011">Table S5</xref>), yet fVBQTL identified additional associations. These findings are consistent with the simulation study results, and suggest that the additional associations found with Bayesian models are due to differences in the underlying model and complexity control.</p>
</sec><sec id="s3b2">
<title>Accounting for hidden factors adds power to detect <italic>cis</italic> associations in crosses between inbred mouse and yeast strains</title>
<p>Next, we applied the methods to two datasets of inbred strain crosses. The yeast expression dataset <xref ref-type="bibr" rid="pcbi.1000770-Brem2">[2]</xref> (GEO <xref ref-type="bibr" rid="pcbi.1000770-Barrett1">[23]</xref> accession GSE1990 with genotypes provided by authors) contained <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e081" xlink:type="simple"/></inline-formula> expression measurements and 2925 genotyped loci in 112 crosses of segregating yeast strains. The mouse expression data <xref ref-type="bibr" rid="pcbi.1000770-Schadt1">[3]</xref> consisted of 23,698 expression measurements for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e082" xlink:type="simple"/></inline-formula> F<sub>2</sub> mouse lines, and genotypes at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e083" xlink:type="simple"/></inline-formula> genetic markers. An association was called to be in <italic>cis</italic> if the probe and the genotyped locus were from the same chromosome, and in <italic>trans</italic> otherwise.</p>
<p>The relative performance of different methods was similar to their ability to detect <italic>cis</italic> eQTLs in the outbred population dataset (<xref ref-type="fig" rid="pcbi-1000770-g004">Figures 4a, 4b</xref>). The absolute performance gain was significantly lower for all methods, however. This finding suggests that the genetic signal is stronger compared to confounding sources of variation, which is not unexpected from the study design. All factor methods identified additional associations compared to the standard method. PCA overfitted for larger numbers of principal components used, explaining away genetic association signal. SVA and PCAsig found the same number of significant hidden factors for a range of significance cutoffs considered, exhibiting little flexibility. Again, their performance was similar to extrapolation of PCA results with matching numbers of effective components. fVBQTL and iVBQTL found additional genetic associations in <italic>cis</italic> compared to the standard model and other methods for accounting for confounding variance, as observed in simulations and human dataset. Summary statistics for the method performance can be found in <xref ref-type="supplementary-material" rid="pcbi.1000770.s012">Table S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000770.s013">S7</xref> respectively.</p>
</sec><sec id="s3b3">
<title>Iterative learning with iVBQTL overcomes difficulties in detecting <italic>trans</italic> associations for crosses of inbred strains</title>
<p>All methods found additional <italic>trans</italic> associations in mouse, but fewer than the standard method in yeast (<xref ref-type="fig" rid="pcbi-1000770-g004">Figure 4d, 4e</xref>). In yeast, the more variance was explained by the hidden factors, the fewer <italic>trans</italic> eQTLs were found, suggesting that the global determinants of gene expression variation were correlated with the genetic state. Indeed, the inferred hidden factor levels were correlated with genotypes of “pivotal loci” that are associated with expression levels of hundreds of genes.</p>
<p>The effect of pivotal loci has been observed before, and interpreted in different ways <xref ref-type="bibr" rid="pcbi.1000770-Leek1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1000770-Kang1">[14]</xref>. It could be that the additional variation is artefactual, and correlated to the genetic state by chance. In this case, all the original <italic>trans</italic> associations are spurious. The alternative explanation is that the genotype of these loci have real downstream effects on the expression profiles of the genes. In this case the variance is not confounding the genetic signal, but in fact is a part of it, and hence should not be explained away.</p>
<p>Previous methods do not provide consistent ways of dealing with this issue. The SVA authors also suggest to remove the effect of the primary variable first. However, the authors do not consider accounting for the genetic effect in their application to the same yeast dataset <xref ref-type="bibr" rid="pcbi.1000770-Leek1">[9]</xref>. In a second study <xref ref-type="bibr" rid="pcbi.1000770-Kang1">[14]</xref>, the application of a correction procedure also explains away <italic>trans</italic> associations. We provide a principled approach for dealing with this situation and show its merit. The iVBQTL scheduling takes the genetic state into account while learning the hidden factors, and as a consequence is more sensitive to genetic associations.</p>
</sec></sec><sec id="s3c">
<title>Application of VBQTL recovers three times more probes with a <italic>cis</italic> eQTL in a whole-genome scan of HapMap phase II data</title>
<p>Motivated by the results of the initial study of a single human chromosome, we applied fVBQTL, learning 30 hidden factors, to the 10,000 most variable expression probes of the HapMap 2 dataset. We searched for <italic>cis</italic> eQTLs in the original expression data (standard eQTLs) as well as the residuals of fVBQTL (VBeQTLs), using a 2-tailed t test with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e084" xlink:type="simple"/></inline-formula> Bonferroni-corrected per-gene FPR to assess the significance of association.</p>
<p>On the CEU population, we found 1051 genes with a VBeQTL at false discovery rate (FDR) of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e085" xlink:type="simple"/></inline-formula>, and 382 genes with a standard eQTL at FDR of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e086" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1000770-g005">Figure 5</xref>). This result corresponds to nearly a threefold increase in the number of genes with an association, and is consistent across chromosomes. A similar increase in the number of associations was found for other populations (<xref ref-type="supplementary-material" rid="pcbi.1000770.s007">Table S1</xref>).</p>
<fig id="pcbi-1000770-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000770.g005</object-id><label>Figure 5</label><caption>
<title>Fraction of tested genes with a <italic>cis</italic> association in individual chromosomes and overall false discovery rate for the HapMap CEU population (FPR = <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e087" xlink:type="simple"/></inline-formula>).</title>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.g005" xlink:type="simple"/></fig>
<p>We repeated this genome-wide experiment on pooled populations. Due to the increased sample size, it was possible to detect additional associations. We found 2696 genes with a VBeQTL compared to 1045 genes with a standard eQTL at the 0.1% FPR (<xref ref-type="fig" rid="pcbi-1000770-g006">Figure 6a</xref>). The VBeQTLs in the pooled sample cover <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e088" xlink:type="simple"/></inline-formula> of all the considered probes, suggesting that the number of human genes whose expression levels are affected by common <italic>cis</italic>-acting genetic variation may be significantly higher than previously shown <xref ref-type="bibr" rid="pcbi.1000770-Stranger2">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1000770-Williams1">[25]</xref>. This additional abundance of associations suggests that detection of <italic>cis</italic> eQTLs has not been saturated and larger sample sizes may lead to evidence of even more extensive <italic>cis</italic> regulation by common polymorphisms.</p>
<fig id="pcbi-1000770-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000770.g006</object-id><label>Figure 6</label><caption>
<title>Validation of VBeQTLs by comparison to standard eQTLs.</title>
<p>(<bold>a,b,d,e</bold>) Venn diagrams depicting overlap of probes with a standard eQTL or VBeQTL in the CEU population and probes with an eQTL in other populations. (<bold>c,f</bold>) Standard and VBeQTL location and strength relative to the transcription start site.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.g006" xlink:type="simple"/></fig>
<p>Exploratory results indicate additional power to find <italic>trans</italic> eQTLs without explaining away eQTL hotspots (<xref ref-type="supplementary-material" rid="pcbi.1000770.s002">Text S2</xref>). These should be interpreted with caution due to very stringent multiple testing corrections, however.</p>
</sec><sec id="s3d">
<title>Additional associations are due to increased sensitivity</title>
<p>It is important to demonstrate that the additional associations found after removing the learned non-genetic factors are biologically meaningful. We provide evidence that the additional associations found in HapMap phase 2 data are real in three ways.</p>
<p>First, we investigated how many of the genes with a VBeQTL in each of the three populations individually were replicated using the standard method on a pooled data set containing all populations. Note that this will only validate weak associations that occur in multiple populations – we would not expect weak population-specific associations to be replicated in the pooled data set. However, we expect many of the associations to be replicated in multiple populations <xref ref-type="bibr" rid="pcbi.1000770-Stranger2">[24]</xref>. A total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e089" xlink:type="simple"/></inline-formula> of all and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e090" xlink:type="simple"/></inline-formula> of the additional associations found in the CEU population were recovered using the standard method in the pooled population (<xref ref-type="fig" rid="pcbi-1000770-g006">Figure 6b</xref>). The remaining additional associations may be explained by even weaker signals that were recovered by applying fVBQTL, or as population-specific effects that do not stand out in the pooled sample. Analogous overlaps were found when excluding the CEU population from the pooled analysis (<xref ref-type="supplementary-material" rid="pcbi.1000770.s009">Table S3</xref>).</p>
<p>Second, we evaluated to what extent the additional genes with a VBeQTL in a single population were replicated in other populations. For instance, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e091" xlink:type="simple"/></inline-formula> of genes with a CEU VBeQTL were replicated on the YRI population (<xref ref-type="fig" rid="pcbi-1000770-g006">Figure 6d</xref>), and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e092" xlink:type="simple"/></inline-formula> on the CHB+JPT population (<xref ref-type="fig" rid="pcbi-1000770-g006">Figure 6e</xref>). These overlaps are consistent with overlaps of standard eQTLs, and are similar for other populations (<xref ref-type="supplementary-material" rid="pcbi.1000770.s008">Table S2</xref>), and alternative methods accounting for hidden factors.</p>
<p>Finally, we validated that the locations of the novel associations are distributed similarly to the original ones. We analysed the distribution of the position of additional <italic>cis</italic> associations around the gene start along with the association LOD scores. The additional VBeQTLs have very similar characteristics to the standard eQTLs, being concentrated around the gene start (<xref ref-type="fig" rid="pcbi-1000770-g006">Figure 6c, 6f</xref>), in line with previous results <xref ref-type="bibr" rid="pcbi.1000770-Stranger2">[24]</xref>.</p>
</sec><sec id="s3e">
<title>Interpretation of learned hidden factors</title>
<p>The hidden factor models hypothesise a set of unobserved non-genetic factors that influence the measured gene expression levels. To gain insights into their interpretation we considered correlations to known effects such as gender, population or environment, and the sets of genes most influenced.</p>
<p>We applied fVBQTL to expression data from individuals of all three HapMap populations, and tested for correlation between the inferred hidden factors and the population and gender indicator variables. The resulting correlation coefficients (<xref ref-type="supplementary-material" rid="pcbi.1000770.s010">Table S4</xref>) indicate that many of the learned latent causes are correlated with population and that one is strongly correlated with gender. This implies that the hidden factor model can recapture variance in the gene expression levels due to true underlying properties of individuals. However, none of the global factors learned in one population was correlated with a single SNP genotype.</p>
<p>A recent study in yeast looked for changes in eQTLs when segregating strains were grown in different media <xref ref-type="bibr" rid="pcbi.1000770-Smith1">[26]</xref>. We applied fVBQTL to the expression data of this study (GEO accession GSE9376), without including any information about the growth condition. The first hidden factor learned was highly correlated with the indicator variable for the growth condition (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e093" xlink:type="simple"/></inline-formula>), demonstrating that the VBQTL model can successfully recover an environmental effect if it is present.</p>
<p>The global factors identified can be further analysed for biological signals, looking for GO term over-representation in the genes that they affect. We used the ordered GO profiling method <xref ref-type="bibr" rid="pcbi.1000770-Reimand1">[27]</xref> to find significantly enriched GO categories for 30 genes most affected by each factor. Recent results <xref ref-type="bibr" rid="pcbi.1000770-Biswas1">[28]</xref> show that related linear Gaussian models find biologically relevant factors in the yeast expression dataset. We replicated these findings with our model, yielding factors enriched in biological functions, including sugar, alcohol and amino acid metabolic processes. Similar analysis in human and mouse did not show significant over-representation of GO categories, providing no evidence that the main axes of variation in the expression levels for these experiments are due to common biological function. This could be due to poor annotation of the genes, gene features not related to biological function, or more technical sources of global variation, such as cell culture conditions <xref ref-type="bibr" rid="pcbi.1000770-Pastinen1">[12]</xref>.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>We have presented VBQTL, a probabilistic model to dissect gene expression variation in the context of genetic association studies. The model is implemented in a Bayesian inference framework that allows uncertainty to be propagated between different parts of the model, and yields posterior distributions over parameter estimates for more sensitive analysis. In comparative eQTL mapping experiments, VBQTL outperformed alternative methods for eQTL finding on simulated and real data. In the most striking example, VBQTL found up to three times more eQTLs than a standard method, and 45% more compared to the best alternative in the HapMap 2 expression dataset.</p>
<p>Our approach advances the methodology for understanding phenotypic variation. The implementation of a flexible framework allows models for explaining the observed variability to be straightforwardly combined. Notably, non-Bayesian models can also be included, as we demonstrated with PCA, SVA, and linear regression models. VBQTL controls the model complexity at the level of all individual components of expression variability, thereby preventing from over- and underfitting. Our experimental results on simulation and real data showed how explaining away too much variability removes some signal of interest from the data, and failing to account for all sources of confounding variation decreases power to detect the relevant signal. When the variable of interest is correlated with many gene expression levels, its effect can be falsely explained away by the hidden factor model. We showed that in such settings the choice of an iterative schedule helps to ensure that variability is explained by the appropriate part of the model. There can be no silver bullet solution that provides perfect results in any scenario with no supervision. Instead, modelling assumptions must be made explicit, and incorporated in the analysis, as is elegantly done in the Bayesian setting.</p>
<p>VBQTL and other methods that account for hidden factors all found additional expression QTLs in the datasets studied compared to the standard method. It is remarkable that, with only 270 samples, and looking in one tissue type, we can find significant genetic associations to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000770.e094" xlink:type="simple"/></inline-formula> of the expressed genes. While similar results have been reported before, we have shown a threefold increase in the number of associations for the HapMap dataset, and analysed their repeatability and location distribution. The replication of the additional associations in different populations suggests that they are genuine. The increase in power is due to the hidden factor model, which explains away unwanted non-genetic variability, thereby allowing the genetic effects to stand out to a greater extent. The high number of additional associations suggests that association finding studies in human have not saturated, and we expect the fraction of genes with an eQTL will increase further as the number of samples grows. It may be that the expression of majority of human genes varies as a result of segregating genetic variation. While previous studies have reported only 12% of heritable variation to be due to <italic>cis</italic> variants <xref ref-type="bibr" rid="pcbi.1000770-Price1">[29]</xref>, this does not contradict the presence of weak <italic>cis</italic> eQTLs for a large fraction of the genes.</p>
<p>In conclusion, we believe that VBQTL provides a principled and accurate way to study gene expression and other high-dimensional data. Increasingly complex models combining genetic and other effects can explain significantly more of the variance in observed phenotypes, as suggested by this study and others. Our general framework provides the flexibility to facilitate these richer models, for example, we have already started exploring interaction effects as an additional model of the framework. It will be interesting to see how these approaches can contribute to our understanding of human disease genetics, potentially involving intermediate phenotypes such as gene expression and other factors.</p>
<p>The software used in this study is freely available online at <ext-link ext-link-type="uri" xlink:href="http://www.sanger.ac.uk/resources/software/peer/" xlink:type="simple">http://www.sanger.ac.uk/resources/software/peer/</ext-link>.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000770.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s001" xlink:type="simple"><label>Text S1</label><caption>
<p>Supplementary methods.</p>
<p>(0.23 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s002" xlink:type="simple"><label>Text S2</label><caption>
<p>Supplementary results.</p>
<p>(0.86 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s003" xlink:type="simple"><label>Figure S1</label><caption>
<p>Sensitivity of recovering simulated eQTLs for alternative eQTL models. (a–b) Using a standard model for expression values, performing 2-tailed t tests on the statistic based on correlation coefficient between expression level and genotype. (c–d) Similar test for ranks of expression values. (e–f) Permutation test with 1000 permutations and 0.1% FPR. Bonferroni correction to 0.1% false positive rate was used for (a–d) to correct for multiple testing as detailed in <xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>.</p>
<p>(0.30 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s004" xlink:type="simple"><label>Figure S2</label><caption>
<p>Sensitivity of recovering human eQTLs for alternative eQTL models. (a–b) Using a standard nested model for expression values, performing chi-squared tests with one degree of freedom on the log likelihood ratio for adding the genetic association term to the model. (c–d) Using a standard nested model for ranks of expression values, performing t tests with N-2 degrees of freedom as described in Supplementary Methods. Bonferroni correction to 1% false positive rate was used for both methods to correct for multiple testing as detailed in <xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>.</p>
<p>(0.23 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s005" xlink:type="simple"><label>Figure S3</label><caption>
<p>Sensitivity of recovering yeast eQTLs for alternative eQTL models. (a–b) Using a standard model for expression values, performing 2-tailed t tests on the statistic based on correlation coefficient between expression level and genotype. (c–d) Similar test for ranks of expression values. Bonferroni correction to 0.1% false positive rate was used for both methods to correct for multiple testing as detailed in <xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>.</p>
<p>(0.26 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s006" xlink:type="simple"><label>Figure S4</label><caption>
<p>Sensitivity of recovering mouse eQTLs for alternative eQTL models. (a–b) Using a standard model for expression values, performing 2-tailed t tests on the statistic based on correlation coefficient between expression level and genotype. (c–d) Similar test for ranks of expression values. Bonferroni correction to 0.1% false positive rate was used for both methods to correct for multiple testing as detailed in <xref ref-type="supplementary-material" rid="pcbi.1000770.s001">Text S1</xref>.</p>
<p>(0.25 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s007" xlink:type="simple"><label>Table S1</label><caption>
<p>Number of probes with a <italic>cis</italic> association for individual chromosomes and per-probe false discovery rate for the considered populations (per-probe FPR = 0.100%, Bonferroni corrected for testing multiple SNPs per probe, 2-tailed t test) on raw expression data (Standard) and after accounting for hidden factors (fVBQTL).</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s008" xlink:type="simple"><label>Table S2</label><caption>
<p>Magnitude and fraction of overlap between probes with a Standard of fVBQTL <italic>cis</italic> eQTL respectively, for different populations and methods. Total numbers for each population and method are given in parenthesis after the population. 955 probes had a standard eQTL in some population, and 148 in every population. 2236 probes had a fVBQTL eQTL in some population, and 477 in every population.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s009" xlink:type="simple"><label>Table S3</label><caption>
<p>Overlap of VBQTLs in one population (2.) with standard eQTLs found when pooling the other two populations (3.). Overlaps are given both for all QTLs (2. &amp; 3.) and only for additional ones (2. - 1. &amp; 3. - 1.) compared to standard eQTLs in the population. Per-probe eQTL FPR = 0.1%, Bonferroni corrected for testing multiple SNPs per probe, 2-tailed t test.</p>
<p>(0.01 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s010" xlink:type="simple"><label>Table S4</label><caption>
<p>Pearson correlation coefficient between top 6 factors learned on the pooled HapMap data, and 4 indicator variables relating to the background of the individual. Correlations with absolute value above 0.6 are highlighted.</p>
<p>(0.01 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s011" xlink:type="simple"><label>Table S5</label><caption>
<p>Summary statistics for method performances on the human chromosome 19 dataset presented in the main text. The parameters for different methods are varied by the number of allowed factors K (PCA, VBQTL) or by the significance cutoff α (PCAsig, SVA). Hidden factor summary is given by the number of factors found and the variance explained by the hidden factor effects. The number of probes with a <italic>cis</italic> and <italic>trans</italic> eQTL, as well as the sensitivity and specificity of recovering probes with a standard eQTL are given. Per-probe eQTL FPR = 0.001, Bonferroni corrected for testing multiple SNPs per probe, 2-tailed t test.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s012" xlink:type="simple"><label>Table S6</label><caption>
<p>Summary statistics for method performances on the yeast dataset presented in the main text. The parameters for different methods are varied by the number of allowed factors K (PCA, VBQTL) or by the significance cutoff α (PCAsig, SVA). Hidden factor summary is given by the number of factors found and the variance explained by the hidden factor effects. The number of probes with a <italic>cis</italic> and <italic>trans</italic> eQTL, as well as the sensitivity and specificity of recovering probes with a standard eQTL are given. Per-probe eQTL FPR = 0.001, Bonferroni corrected for testing multiple SNPs per probe, 2-tailed t test.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000770.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000770.s013" xlink:type="simple"><label>Table S7</label><caption>
<p>Summary statistics for method performances on the mouse dataset presented in the main text. The parameters for different methods are varied by the number of allowed factors K (PCA, VBQTL) or by the significance cutoff α (PCAsig, SVA). Hidden factor summary is given by the number of factors found and the variance explained by the hidden factor effects. The number of probes with a <italic>cis</italic> and <italic>trans</italic> eQTL, as well as the sensitivity and specificity of recovering probes with a standard eQTL are given. Per-probe eQTL FPR = 0.001, Bonferroni corrected for testing multiple SNPs per probe, 2-tailed t test.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>The authors would like to thank Manolis Dermitzakis for helpful discussions and feedback, Rachel Brem, Eric Schadt and Barbara Stranger for access to gene expression and genotype data, Claude Beasley for assistance, Richard Bourgon for advice, and Alexandra Nica and members of the Durbin group for comments on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000770-Brem1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brem</surname><given-names>RB</given-names></name>
<name name-style="western"><surname>Yvert</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Clinton</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Kruglyak</surname><given-names>L</given-names></name>
</person-group>             <year>2002</year>             <article-title>Genetic dissection of transcriptional regulation in budding yeast.</article-title>             <source>Science</source>             <volume>296</volume>             <fpage>752</fpage>             <lpage>755</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Brem2"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brem</surname><given-names>RB</given-names></name>
<name name-style="western"><surname>Kruglyak</surname><given-names>L</given-names></name>
</person-group>             <year>2005</year>             <article-title>The landscape of genetic complexity across 5,700 gene expression traits in yeast.</article-title>             <source>Proc Natl Acad Sci</source>             <volume>102</volume>             <fpage>1572</fpage>             <lpage>7</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Schadt1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schadt</surname><given-names>EE</given-names></name>
<name name-style="western"><surname>Lamb</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Yang</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Zhu</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Edwards</surname><given-names>S</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>An integrative genomics approach to infer causal associations between gene expression and disease.</article-title>             <source>Nature genetics</source>             <volume>37</volume>             <fpage>710</fpage>             <lpage>7</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Stranger1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stranger</surname><given-names>BEE</given-names></name>
<name name-style="western"><surname>Nica</surname><given-names>ACC</given-names></name>
<name name-style="western"><surname>Forrest</surname><given-names>MSS</given-names></name>
<name name-style="western"><surname>Dimas</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Bird</surname><given-names>CPP</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Population genomics of human gene expression.</article-title>             <source>Nature genetics</source>             <volume>39</volume>             <fpage>1217</fpage>          </element-citation></ref>
<ref id="pcbi.1000770-Spielman1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Spielman</surname><given-names>RSS</given-names></name>
<name name-style="western"><surname>Bastone</surname><given-names>LAA</given-names></name>
<name name-style="western"><surname>Burdick</surname><given-names>JTT</given-names></name>
<name name-style="western"><surname>Morley</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Ewens</surname><given-names>WJJ</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Common genetic variants account for differences in gene expression among ethnic groups.</article-title>             <source>Nature genetics</source>             <volume>200</volume>             <fpage>7</fpage>          </element-citation></ref>
<ref id="pcbi.1000770-Chen1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chen</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Zhu</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Lum</surname><given-names>PY</given-names></name>
<name name-style="western"><surname>Yang</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Pinto</surname><given-names>S</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Variations in DNA elucidate molecular networks that cause disease.</article-title>             <source>Nature</source>             <volume>452</volume>             <fpage>429</fpage>          </element-citation></ref>
<ref id="pcbi.1000770-Emilsson1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Emilsson</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Thorleifsson</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Zhang</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Leonardson</surname><given-names>AS</given-names></name>
<name name-style="western"><surname>Zink</surname><given-names>F</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Genetics of gene expression and its effect on disease.</article-title>             <source>Nature</source>             <volume>452</volume>             <fpage>423</fpage>             <lpage>428</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Gibson1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gibson</surname><given-names>G</given-names></name>
</person-group>             <year>2008</year>             <article-title>The environmental contribution to gene expression profiles.</article-title>             <source>Nature Reviews Genetics</source>             <volume>9</volume>             <fpage>575</fpage>             <lpage>581</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Leek1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Leek</surname><given-names>JT</given-names></name>
<name name-style="western"><surname>Storey</surname><given-names>JD</given-names></name>
</person-group>             <year>2007</year>             <article-title>Capturing heterogeneity in gene expression studies by surrogate variable analysis.</article-title>             <source>PLoS Genetics</source>             <volume>3</volume>             <fpage>e161</fpage>          </element-citation></ref>
<ref id="pcbi.1000770-Plagnol1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Plagnol</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Uz</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Wallace</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Stevens</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Clayton</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Extreme clonality in lymphoblastoid cell lines with implications for allele specific expression analyses.</article-title>             <source>PLoS ONE</source>             <volume>3</volume>          </element-citation></ref>
<ref id="pcbi.1000770-Balding1"><label>11</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Balding</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Bishop</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Cannings</surname></name>
</person-group>             <year>2003</year>             <source>Handbook of Statistical Genetics</source>             <publisher-loc>N.Y.</publisher-loc>             <publisher-name>Wiley J. and Sons Ltd., second edition</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000770-Pastinen1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pastinen</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Ge</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Hudson</surname><given-names>TJ</given-names></name>
</person-group>             <year>2006</year>             <article-title>Influence of human genome polymorphism on gene expression.</article-title>             <source>Hum Mol Genet</source>             <volume>15</volume>             <fpage>R9</fpage>          </element-citation></ref>
<ref id="pcbi.1000770-Stegle1"><label>13</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stegle</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Kannan</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Winn</surname><given-names>J</given-names></name>
</person-group>             <year>2008</year>             <article-title>Accounting for non-genetic factors improves the power of eQTL studies.</article-title>             <source>Research in Computational Molecular Biology</source>             <publisher-name>Springer</publisher-name>             <fpage>411</fpage>             <lpage>422</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Kang1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kang</surname><given-names>HM</given-names></name>
<name name-style="western"><surname>Ye</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Eskin</surname><given-names>E</given-names></name>
</person-group>             <year>2008</year>             <article-title>Accurate discovery of expression quantitative trait loci under confounding from spurious and genuine regulatory hotspots.</article-title>             <source>Genetics</source>             <volume>180</volume>             <fpage>1909</fpage>             <lpage>1925</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Lander1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lander</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Botstein</surname><given-names>D</given-names></name>
</person-group>             <year>1989</year>             <article-title>Mapping mendelian factors underlying quantitative traits using RFLP linkage maps.</article-title>             <source>Genetics</source>             <volume>121</volume>             <fpage>185</fpage>             <lpage>199</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Rattray1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rattray</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Sanguinetti</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Milo</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Lawrence</surname><given-names>ND</given-names></name>
</person-group>             <year>2006</year>             <article-title>Propagating uncertainty in microarray data analysis.</article-title>             <source>Briefings in Bioinformatics</source>             <volume>7</volume>             <fpage>37</fpage>             <lpage>47</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-MacKay1"><label>17</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>MacKay</surname><given-names>DJC</given-names></name>
</person-group>             <year>2003</year>             <source>Information theory, inference and learning algorithms</source>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000770-Jordan1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Jordan</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Ghahramani</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Jaakkola</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Saul</surname><given-names>L</given-names></name>
</person-group>             <year>1999</year>             <article-title>An introduction to variational methods for graphical models.</article-title>             <source>Machine Learning</source>             <volume>37</volume>             <fpage>183</fpage>             <lpage>233</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Mackay1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mackay</surname><given-names>DJC</given-names></name>
</person-group>             <year>1995</year>             <article-title>Probable networks and plausible predictions - a review of practical Bayesian methods for supervised neural networks.</article-title>             <source>Network: Computation in Neural Systems</source>             <volume>6</volume>             <fpage>469</fpage>             <lpage>505</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Neal1"><label>20</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Neal</surname><given-names>RM</given-names></name>
</person-group>             <year>1996</year>             <source>Bayesian Learning for Neural Networks</source>             <publisher-name>Springer</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000770-Winn1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Winn</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Bishop</surname><given-names>C</given-names></name>
</person-group>             <year>2006</year>             <article-title>Variational Message Passing.</article-title>             <source>Journal of Machine Learning Research</source>             <volume>6</volume>             <fpage>661</fpage>          </element-citation></ref>
<ref id="pcbi.1000770-The1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <collab xlink:type="simple">The International HapMap Consortium</collab>             <year>2005</year>             <article-title>A haplotype map of the human genome.</article-title>             <source>Nature</source>             <volume>437</volume>             <fpage>1299</fpage>             <lpage>1320</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Barrett1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Barrett</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Troup</surname><given-names>DB</given-names></name>
<name name-style="western"><surname>Wilhite</surname><given-names>SE</given-names></name>
<name name-style="western"><surname>Ledoux</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Rudnev</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>NCBI GEO: mining tens of millions of expression profiles–database and tools update.</article-title>             <source>Nucleic acids research</source>             <volume>35</volume>             <fpage>D760</fpage>          </element-citation></ref>
<ref id="pcbi.1000770-Stranger2"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stranger</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Forrest</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Dunning</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Ingle</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Beazley</surname><given-names>C</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Relative impact of nucleotide and copy number variation on gene expression phenotypes.</article-title>             <source>Science</source>             <volume>315</volume>             <fpage>848</fpage>             <lpage>853</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Williams1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Williams</surname><given-names>RB</given-names></name>
<name name-style="western"><surname>Chan</surname><given-names>EK</given-names></name>
<name name-style="western"><surname>Cowley</surname><given-names>MJ</given-names></name>
<name name-style="western"><surname>Little</surname><given-names>PF</given-names></name>
</person-group>             <year>2007</year>             <article-title>The influence of genetic variation on gene expression.</article-title>             <source>Genome Res</source>             <volume>17</volume>             <fpage>1707</fpage>             <lpage>1716</lpage>          </element-citation></ref>
<ref id="pcbi.1000770-Smith1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smith</surname><given-names>EN</given-names></name>
<name name-style="western"><surname>Kruglyak</surname><given-names>L</given-names></name>
</person-group>             <year>2008</year>             <article-title>Gene-environment interaction in yeast gene expression.</article-title>             <source>PLoS Biology</source>             <volume>6</volume>             <fpage>e83+</fpage>          </element-citation></ref>
<ref id="pcbi.1000770-Reimand1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Reimand</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Kull</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Peterson</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Hansen</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Vilo</surname><given-names>J</given-names></name>
</person-group>             <year>2007</year>             <article-title>g:Profiler–a web-based toolset for functional profiling of gene lists from large-scale experiments.</article-title>             <source>Nucleic acids research</source>             <volume>35</volume>          </element-citation></ref>
<ref id="pcbi.1000770-Biswas1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Biswas</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Storey</surname><given-names>JD</given-names></name>
<name name-style="western"><surname>Akey</surname><given-names>JM</given-names></name>
</person-group>             <year>2008</year>             <article-title>Mapping gene expression quantitative trait loci by singular value decomposition and independent component analysis.</article-title>             <source>BMC Bioinformatics</source>             <volume>9</volume>             <fpage>244</fpage>          </element-citation></ref>
<ref id="pcbi.1000770-Price1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Price</surname><given-names>AL</given-names></name>
<name name-style="western"><surname>Patterson</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Hancks</surname><given-names>DC</given-names></name>
<name name-style="western"><surname>Myers</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Reich</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Effects of cis and trans genetic ancestry on gene expression in african americans.</article-title>             <source>PLoS Genetics</source>             <volume>4</volume>             <fpage>e1000294+</fpage>          </element-citation></ref>
</ref-list>

</back>
</article>