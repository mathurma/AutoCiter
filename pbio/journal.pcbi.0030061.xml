<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0030061</article-id><article-id pub-id-type="publisher-id">06-PLCB-RA-0200R3</article-id><article-id pub-id-type="sici">plcb-03-03-20</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Eukaryotes</subject></subj-group></article-categories><title-group><article-title>DNA Familial Binding Profiles Made Easy: Comparison of Various Motif Alignment and Clustering Strategies</article-title><alt-title alt-title-type="running-head">STAMP: Comparing<italic>cis</italic>-Regulatory Motifs</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Mahony</surname><given-names>Shaun</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref><xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref><xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Auron</surname><given-names>Philip E</given-names></name><xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref><xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Benos</surname><given-names>Panayiotis V</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref><xref ref-type="aff" rid="aff5">
            <sup>5</sup>
          </xref><xref ref-type="aff" rid="aff6">
            <sup>6</sup>
          </xref><xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref></contrib></contrib-group><aff id="aff1">
				<label>1</label><addr-line> Department of Computational Biology, School of Medicine, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Department of Computer Science, Faculty of Arts and Sciences, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America
			</addr-line></aff><aff id="aff3">
				<label>3</label><addr-line> Department of Biological Sciences, Duquesne University, Pittsburgh, Pennsylvania, United States of America
			</addr-line></aff><aff id="aff4">
				<label>4</label><addr-line> Department of Molecular Genetics and Biochemistry, School of Medicine, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America
			</addr-line></aff><aff id="aff5">
				<label>5</label><addr-line> Department of Human Genetics, Graduate School of Public Health, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America
			</addr-line></aff><aff id="aff6">
				<label>6</label><addr-line> University of Pittsburgh Cancer Institute, School of Medicine, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America
			</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Stormo</surname><given-names>Gary</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Washington University, United States of America</aff><author-notes><fn fn-type="con" id="ack1"><p>SM and PVB conceived and designed the experiments. SM performed the experiments and contributed reagents/materials/analysis tools. SM, PEA, and PVB analyzed the data and wrote the paper.</p></fn><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">shaun.mahony@ccbb.pitt.edu</email> (SM); <email xlink:type="simple">benos@pitt.edu</email> (PVB)</corresp><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>3</month><year>2007</year></pub-date><pub-date pub-type="epub"><day>30</day><month>3</month><year>2007</year></pub-date><pub-date pub-type="epreprint"><day>15</day><month>2</month><year>2007</year></pub-date><volume>3</volume><issue>3</issue><elocation-id>e61</elocation-id><history><date date-type="received"><day>23</day><month>5</month><year>2006</year></date><date date-type="accepted"><day>15</day><month>2</month><year>2007</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2007</copyright-year><copyright-holder>Mahony et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Transcription factor (TF) proteins recognize a small number of DNA sequences with high specificity and control the expression of neighbouring genes. The evolution of TF binding preference has been the subject of a number of recent studies, in which generalized binding profiles have been introduced and used to improve the prediction of new target sites. Generalized profiles are generated by aligning and merging the individual profiles of related TFs. However, the distance metrics and alignment algorithms used to compare the binding profiles have not yet been fully explored or optimized. As a result, binding profiles depend on TF structural information and sometimes may ignore important distinctions between subfamilies. Prediction of the identity or the structural class of a protein that binds to a given DNA pattern will enhance the analysis of microarray and ChIP–chip data where frequently multiple putative targets of usually unknown TFs are predicted. Various comparison metrics and alignment algorithms are evaluated (a total of 105 combinations). We find that local alignments are generally better than global alignments at detecting eukaryotic DNA motif similarities, especially when combined with the <italic>sum of squared distances</italic> or <italic>Pearson's correlation coefficient</italic> comparison metrics. In addition, multiple-alignment strategies for binding profiles and tree-building methods are tested for their efficiency in constructing generalized binding models. A new method for automatic determination of the optimal number of clusters is developed and applied in the construction of a new set of familial binding profiles which improves upon TF classification accuracy. A software tool, STAMP, is developed to host all tested methods and make them publicly available. This work provides a high quality reference set of familial binding profiles and the first comprehensive platform for analysis of DNA profiles. Detecting similarities between DNA motifs is a key step in the comparative study of transcriptional regulation, and the work presented here will form the basis for tool and method development for future transcriptional modeling studies.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><sec id="st1"><title/><p>Transcription factors are primary regulators of gene expression. They usually recognize short DNA sequences in gene promoters and subsequently alter their transcription rate. It is known that structurally related transcription factors often recognize similar DNA-binding patterns (or <italic>motifs</italic>). Comparison of these motifs not only provides insights into the evolutionary process they undergo, but it also has many important practical applications. For example, motifs that are found to be “similar” can be combined to form generalized profiles, which can be used to improve our ability to predict novel DNA signals in the promoters of co-expressed genes, and thus facilitate a more accurate mapping of gene-regulatory networks. However, to date there is no comprehensive platform that will allow for an efficient analysis of DNA motifs. Furthermore, the efficiency of the methods used to assign similarity between DNA motifs has not been thoroughly tested. This paper takes an important first step towards this goal by evaluating available comparison strategies as applied to DNA motifs and by generating an improved familial profile dataset.</p></sec></abstract><funding-group><funding-statement>This work was supported by US National Science Foundation grant MCB0316255, by US National Institutes of Health-NIAID contract N01-AI50018, and by Pittsburgh Foundation grant M2005–0046.</funding-statement></funding-group><counts><page-count count="14"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Mahony S, Auron PE, Benos PV (2007) DNA familial binding profiles made easy: Comparison of various motif alignment and clustering strategies. PLoS Comput Biol 3(3): e61. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030061" xlink:type="simple">10.1371/journal.pcbi.0030061</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p><named-content content-type="genus-species" xlink:type="simple">Transcription factor</named-content> (TF) proteins usually recognize a small number of DNA targets via the formation of sequence-specific and nonspecific molecular interactions. Understanding the evolution of TF DNA-binding preferences will not only provide useful insights on the mechanism of DNA recognition, it will also allow more accurate prediction of genomic regulatory elements, which still constitutes a major hurdle in understanding cellular gene regulatory networks. Furthermore, high-throughput studies, such as microarray and ChIP–chip, generate a number of DNA motifs that are putative targets of usually unknown TFs. In this study, we present an alignment and comparison platform that is optimized for DNA motifs, thereby allowing for their efficient analysis and enabling and formalizing their evolutionary study. This platform is called <italic>STAMP</italic>, for similarity, tree-building, and alignment of DNA motifs and profiles.</p><p>TF DNA-binding preferences are usually modeled via frequency matrices, derived from alignments of known sites (see <xref ref-type="sec" rid="s4">Methods</xref>). Typically, these <italic>position-specific scoring matrices</italic> (PSSMs) assume independency between the base positions [<xref ref-type="bibr" rid="pcbi-0030061-b001">1</xref>]. It has been recognized that structurally related TFs often share similarities in their DNA-binding motifs, although the extent to which this happens depends on the TF family [<xref ref-type="bibr" rid="pcbi-0030061-b002">2</xref>–<xref ref-type="bibr" rid="pcbi-0030061-b005">5</xref>]. Generalized binding models or <italic>familial binding profiles</italic> (FBPs), a term coined by Sandelin and Wasserman [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>], constitute an “average” binding specificity of a family of TFs (see <xref ref-type="fig" rid="pcbi-0030061-g001">Figure 1</xref> for an illustration of the FBP concept). FBPs can be incorporated in pattern-finding algorithms as prior knowledge in order to bias them towards motifs from a particular TF family [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>–<xref ref-type="bibr" rid="pcbi-0030061-b008">8</xref>]. This is useful if the investigator expects to find motifs from a particular class of TFs. The use of FBPs as prior information focuses the motif search on biologically relevant patterns, offering a way to improve upon the currently limited performance of DNA motif-finders [<xref ref-type="bibr" rid="pcbi-0030061-b009">9</xref>]. FBPs have been used to infer the identity of the TF family bound to predicted novel motifs [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0030061-b008">8</xref>,<xref ref-type="bibr" rid="pcbi-0030061-b010">10</xref>], and to remove degeneracy between related motifs in the motif repositories [<xref ref-type="bibr" rid="pcbi-0030061-b011">11</xref>–<xref ref-type="bibr" rid="pcbi-0030061-b013">13</xref>]. More recently, FBPs have been used to help estimate the binding specificity of regulatory proteins from ChIP–chip data [<xref ref-type="bibr" rid="pcbi-0030061-b014">14</xref>].</p><fig id="pcbi-0030061-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.g001</object-id><label>Figure 1</label><caption><title>Illustration of Familial Binding Profile Construction</title><p>In this example, the binding motifs for four bZIP–CREB transcription factors are aligned in a multiple-motif alignment. The generalized familial binding profiles correspond to the weighted average of the individual profiles.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.g001" xlink:type="simple"/></fig><p>The early studies introducing FBPs demonstrated their potential in regulatory DNA analysis. However, the methods employed to compare and align DNA-binding motifs, a key aspect in constructing FBPs, have not been thoroughly studied. Currently, the construction of FBPs is based on (semi)-empirical clustering methods and ad hoc distance metrics. Ungapped local motif alignments [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0030061-b007">7</xref>] or enumeration of subsequence frequencies across related motifs' members [<xref ref-type="bibr" rid="pcbi-0030061-b010">10</xref>,<xref ref-type="bibr" rid="pcbi-0030061-b011">11</xref>] are typically used to compare PSSMs, although it is not yet known if these strategies are optimal. Even the definition of binding motif families and subgroups is currently problematic. Structural information and protein sequence comparisons have been previously used to guide manual clustering of TF binding profiles [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0030061-b008">8</xref>], although automatic methods have been recently introduced [<xref ref-type="bibr" rid="pcbi-0030061-b007">7</xref>].</p><p>For more reliable FBP construction methods, and in order to expand the area of applications for generalized binding models, a detailed evaluation of a variety of motif alignment strategies is required. Motif evolution and the motif dependence on the proteins' structural properties need to be investigated. Sandelin and Wasserman [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>] did an important first step when they created a set of 11 FBPs for the nonzinc finger families. During the FBP construction, they noticed that the bZIP family exhibited two different DNA-binding patterns, so they partitioned it into CCAAT/enhancer binding protein (C/EBP)- and cAMP response element-binding (CREB)-related proteins. However, their FBP clustering was done manually and other (sub)family characteristics may have been missed. On the other side of the spectrum, two families may have similar binding preferences, and although they may not belong to the same structural group, it may be reasonable to cluster their binding profiles together, so that the overall number of false positive predictions is reduced. Finally, a detailed analysis of the structural properties of the protein–DNA complexes, together with automatic clustering and classification results, is hoped to shed more light on the evolution of the DNA preferences and their utility in prediction and classification studies.</p><p>Schones et al. have compared the effectiveness of three profile distance metrics [<xref ref-type="bibr" rid="pcbi-0030061-b013">13</xref>]. We expand their study by evaluating combinations of six distance metrics, three pairwise alignment methods, two multiple-alignment strategies, and two tree-building algorithms. In addition, we develop a new statistic for automatically deciding the optimal number of clusters in a given motif tree. We use this statistic on the tree obtained from the optimal distance metrics and alignment strategies combination to generate a new set of FBPs without prior knowledge of TF structural classification. The new collection of FBPs exhibits better TF classification accuracy than previous manually derived clusters [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>] and identifies similarities and differences in the binding preferences of TF (sub)families.</p><p>Although species-specific binding preference may emerge for some TFs [<xref ref-type="bibr" rid="pcbi-0030061-b015">15</xref>], in general structurally related TFs often share similarities in their DNA-binding preferences. Exploring this trend, Narlikar and Hartemink built a Bayesian TF structural family classifier based on the DNA motifs [<xref ref-type="bibr" rid="pcbi-0030061-b010">10</xref>]. We found that the same accuracy of this sophisticated method can be achieved with simple motif similarity searches when the appropriate alignment algorithms are used. Correctly predicting the TF structural class for novel motifs will be a crucial step in the interpretation of experiments that aim to systematically estimate regulatory motifs in entire mammalian genomes (e.g., [<xref ref-type="bibr" rid="pcbi-0030061-b016">16</xref>]).</p></sec><sec id="s2"><title>Results</title><sec id="s2a"><title>Distributions of Similarity Scores in PSSM Columns from Known TFs</title><p>All columns from the known PSSM models in the TRANSFAC database [<xref ref-type="bibr" rid="pcbi-0030061-b017">17</xref>] were compared with each other using the six metrics presented in <xref ref-type="table" rid="pcbi-0030061-t001">Table 1</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>). <xref ref-type="fig" rid="pcbi-0030061-g002">Figure 2</xref> shows the great variability in the range and distribution of the scores. Both <italic>Pearson's correlation coefficient</italic> (PCC) and <italic>average log likelihood ratio</italic> (ALLR) have negative expected values, which makes them especially suitable for use in alignment algorithms (although, negative mean values can be obtained from any metric by subtracting an appropriate number). Three of the methods, namely PCC, <italic>sum of squared distances</italic> (SSD), and <italic>p-value of chi-square</italic> (pCS), have peaks of very small variance, with PCC having two distinct peaks. Comparison of JASPAR [<xref ref-type="bibr" rid="pcbi-0030061-b018">18</xref>] columns gave similar results (unpublished data).</p><table-wrap content-type="1col" id="pcbi-0030061-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.t001</object-id><label>Table 1</label><caption><p>The Six Similarity Metrics Used in This Study for PSSM Column Similarity and Motif Alignments</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Similarity Metric</td><td><hr/>Formula</td></tr></thead><tbody><tr><td valign="center">Pearson correlation coefficient (PCC) </td><td valign="center"><mml:math display='inline'><mml:mrow><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle='true'><mml:msubsup><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mover accent='true'><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow><mml:mo>&macr;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mover accent='true'><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>Y</mml:mi></mml:msub></mml:mrow><mml:mo stretchy='true'>&macr;</mml:mo></mml:mover><mml:mo stretchy='false'>)</mml:mo></mml:mstyle></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mstyle displaystyle='true'><mml:msubsup><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mover accent='true'><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow><mml:mo stretchy='true'>&macr;</mml:mo></mml:mover></mml:mrow></mml:mstyle><mml:msup><mml:mo stretchy='false'>)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>&sdot;</mml:mo><mml:mstyle displaystyle='true'><mml:msubsup><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mover accent='true'><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>Y</mml:mi></mml:msub></mml:mrow><mml:mo stretchy='true'>&macr;</mml:mo></mml:mover><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mo>2</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></td></tr><tr><td valign="center">Chi-square (pCS) (1&minus;<italic>p-value of</italic>) </td><td valign="center"><mml:math display='inline'><mml:mrow><mml:msubsup><mml:mo>&chi;</mml:mo><mml:mo>3</mml:mo><mml:mo>2</mml:mo></mml:msubsup><mml:mo stretchy='false'>(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>&equals;</mml:mo><mml:mo>&lcub;</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>&rcub;</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>K</mml:mi><mml:mi>e</mml:mi></mml:msubsup><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mo>2</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>K</mml:mi><mml:mi>e</mml:mi></mml:msubsup><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:math></td></tr><tr><td>Average Kullback&ndash;Leibler (AKL) </td><td valign="center"><mml:math display='inline'><mml:mrow><mml:mi>A</mml:mi><mml:mi>K</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mo>10</mml:mo><mml:mo>&minus;</mml:mo><mml:mstyle displaystyle='true'><mml:mfrac><mml:mrow><mml:mstyle displaystyle='true'><mml:msubsup><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo></mml:mrow></mml:mstyle><mml:mo>log</mml:mo><mml:mo></mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&plus;</mml:mo><mml:mstyle displaystyle='true'><mml:msubsup><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo></mml:mrow></mml:mstyle><mml:mo>log</mml:mo><mml:mo></mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>2</mml:mo></mml:mfrac></mml:mstyle></mml:mrow></mml:math></td></tr><tr><td>Sum of squared distances (SSD) </td><td valign="center"><mml:math display='inline'><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mo>2</mml:mo><mml:mo>&minus;</mml:mo><mml:mstyle displaystyle='true'><mml:msubsup><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mo>2</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:math></td></tr><tr><td>Average log-likelihood ratio (ALLR) </td><td valign="center"><mml:math display='inline'><mml:mrow><mml:mi>A</mml:mi><mml:mi>L</mml:mi><mml:mi>L</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle='true'><mml:msubsup><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo><mml:mo>log</mml:mo><mml:mo></mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle><mml:mo>&plus;</mml:mo><mml:mstyle displaystyle='true'><mml:msubsup><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo><mml:mo>log</mml:mo><mml:mo></mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle='true'><mml:msubsup><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow></mml:math></td></tr><tr><td>ALLR with lower limit (ALLR_LL)</td><td valign="center">Same as above, but a lower limit of &minus;2 is imposed on the score (see text)</td></tr></tbody></table> --><!-- --></table-wrap><fig id="pcbi-0030061-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.g002</object-id><label>Figure 2</label><caption><title>Distribution of the Observed Scores of Column-to-Column Comparisons for the Five Main Similarity Metrics</title><p>Columns are obtained from the TRANSFAC database [<xref ref-type="bibr" rid="pcbi-0030061-b017">17</xref>]. The ALLR_LL distribution is identical to ALLR for every point ≥2 (unpublished data). Comparison of the JASPAR motif columns yielded similar results.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.g002" xlink:type="simple"/></fig></sec><sec id="s2b"><title>Evaluation of the Similarity Metrics in PSSM Column Comparisons</title><p>Each of the six metrics was tested for its ability to discriminate between columns randomly sampled from two distinct distributions: an information content–specific distribution and a background (reference) distribution. For information content, <italic>I,</italic> <xref ref-type="fig" rid="pcbi-0030061-g003">Figure 3</xref> plots the percent of the <inline-formula id="pcbi-0030061-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030061.ex001" xlink:type="simple"/></inline-formula>
					-sampled columns that were included in the area around <inline-formula id="pcbi-0030061-ex002"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030061.ex002" xlink:type="simple"/></inline-formula>
					 when a <italic>false discovery rate</italic> (FDR) of 1% was reached. For lower information content, ALLR and SSD perform best at discriminating columns sampled around <inline-formula id="pcbi-0030061-ex003"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030061.ex003" xlink:type="simple"/></inline-formula>
					 and <inline-formula id="pcbi-0030061-ex004"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030061.ex004" xlink:type="simple"/></inline-formula>
					. The finding that ALLR is a better discriminator than pCS metric may seem to contradict the findings of Schones et al. [<xref ref-type="bibr" rid="pcbi-0030061-b013">13</xref>]. However, apart from our sampling size being larger, their evaluation focused on the whole motif level. As we will see later, the advantageous performance of ALLR in column-to-column comparisons does not seem to extend to motif-to-motif comparisons.
				</p><fig id="pcbi-0030061-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.g003</object-id><label>Figure 3</label><caption><title>Performance of the Five Main Similarity Metrics in Discriminating between Columns Sampled from Dirichlet Distributions around Information Content <italic>I</italic> and a Background Distribution</title><p>The plot shows the positive predictive rate for an FDR of 1% as a function of the information content.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.g003" xlink:type="simple"/></fig></sec><sec id="s2c"><title>Comparing Motif Alignment Strategies: The “Best-Hit” Evaluation</title><p>It is difficult to construct an unbiased artificial dataset for the evaluation of motif alignment strategies. However, an indication of performance may be gained from similarity searches of a motif against all motifs in a database. Generally, in databases with good representation, the best match to a given motif is expected to be a motif associated with a member of the same structural class [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>]. The “best-hit” approach can be used to assess the relative effectiveness of column-scoring metrics and alignment-method combinations by finding the proportion of motifs that match another member of the same structural class using each strategy.</p><p>One hundred and five combinations of similarity metrics, alignment methods, and gap penalty values were tested over two datasets: the JASPAR- and TRANSFAC-derived models (see <xref ref-type="sec" rid="s4">Methods</xref>). The top 15 and bottom 15 performing strategies/combinations are presented in <xref ref-type="table" rid="pcbi-0030061-t002">Table 2</xref>, and a full table of results is available in <xref ref-type="supplementary-material" rid="pcbi-0030061-st001">Table S1</xref>. Smith–Waterman local alignments populate the list of best performing results, indicating that they are generally better than Needleman–Wunsch global alignments in motif alignment applications. The results also suggest that the PCC and SSD metrics are on average more effective than the AKL, pCS, and ALLR metrics (including ALLR_LL) for whole-motif comparison. The best-performing combination is Smith–Waterman local alignment using the SSD metric and gap open = 1 (average accuracy 0.811), whereas Smith–Waterman local alignment using the PCC metric also scores highly (seventh-best score; average accuracy 0.805). The first strategy that uses the AKL metric appears at position 28 of the list, and the first strategy using ALLR_LL appears at position 37. Strategies using the standard ALLR metric first appear at position 48, and strategies using the pCS metric first appear at position 60.</p><table-wrap content-type="1col" id="pcbi-0030061-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.t002</object-id><label>Table 2</label><caption><p>The Top 15 and Bottom 15 Performing Alignment Strategies</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.t002" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb2col1" align="left" charoff="0" char=""/><col id="tb2col2" align="left" charoff="0" char=""/><col id="tb2col3" align="left" charoff="0" char=""/><col id="tb2col4" align="char" charoff="0" char="."/><col id="tb2col5" align="left" charoff="0" char=""/><col id="tb2col6" align="left" charoff="0" char=""/><col id="tb2col7" align="left" charoff="0" char=""/><col id="tb2col8" align="left" charoff="0" char=""/><col id="tb2col9" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Performance</td><td><hr/>Alignment Algorithm</td><td><hr/>Similarity Metric</td><td><hr/>Gap Open</td><td><hr/>JASPAR Non-ZNF</td><td><hr/>JASPAR ZNF</td><td><hr/>TRANSFAC Non-ZNF</td><td><hr/>TRANSFAC ZNF</td><td><hr/>Average</td></tr></thead><tbody><tr><td>Top 15</td><td>SW</td><td>SSD</td><td>1.00</td><td>0.845</td><td>0.480</td><td>0.833</td><td>0.788</td><td><bold>0.811</bold></td></tr><tr><td></td><td valign="bottom">SW (overlapping)</td><td valign="bottom">SSD</td><td valign="bottom">1.00</td><td valign="bottom">0.845</td><td valign="bottom">0.480</td><td valign="bottom">0.833</td><td valign="bottom">0.788</td><td valign="bottom"><bold>0.811</bold></td></tr><tr><td></td><td valign="bottom">SW</td><td valign="bottom">SSD</td><td valign="bottom">0.75</td><td valign="bottom">0.845</td><td valign="bottom">0.440</td><td valign="bottom">0.831</td><td valign="bottom">0.794</td><td valign="bottom"><bold>0.809</bold></td></tr><tr><td></td><td valign="bottom">SW (overlapping)</td><td valign="bottom">SSD</td><td valign="bottom">0.75</td><td valign="bottom">0.845</td><td valign="bottom">0.440</td><td valign="bottom">0.831</td><td valign="bottom">0.794</td><td valign="bottom"><bold>0.809</bold></td></tr><tr><td></td><td valign="bottom">SW</td><td valign="bottom">SSD</td><td valign="bottom">0.50</td><td valign="bottom">0.845</td><td valign="bottom">0.520</td><td valign="bottom">0.824</td><td valign="bottom">0.794</td><td valign="bottom"><bold>0.808</bold></td></tr><tr><td></td><td valign="bottom">SW (overlapping)</td><td valign="bottom">SSD</td><td valign="bottom">0.50</td><td valign="bottom">0.845</td><td valign="bottom">0.520</td><td valign="bottom">0.824</td><td valign="bottom">0.794</td><td valign="bottom"><bold>0.808</bold></td></tr><tr><td></td><td valign="bottom">SW</td><td valign="bottom">PCC</td><td valign="bottom">1.50</td><td valign="bottom">0.845</td><td valign="bottom">0.520</td><td valign="bottom">0.817</td><td valign="bottom">0.800</td><td valign="bottom"><bold>0.805</bold></td></tr><tr><td></td><td valign="bottom">SW</td><td valign="bottom">SSD</td><td valign="bottom">0.25</td><td valign="bottom">0.859</td><td valign="bottom">0.560</td><td valign="bottom">0.808</td><td valign="bottom">0.806</td><td valign="bottom"><bold>0.804</bold></td></tr><tr><td></td><td valign="bottom">SW (overlapping)</td><td valign="bottom">SSD</td><td valign="bottom">0.25</td><td valign="bottom">0.859</td><td valign="bottom">0.560</td><td valign="bottom">0.808</td><td valign="bottom">0.806</td><td valign="bottom"><bold>0.804</bold></td></tr><tr><td></td><td valign="bottom">SW</td><td valign="bottom">PCC</td><td valign="bottom">1.00</td><td valign="bottom">0.831</td><td valign="bottom">0.600</td><td valign="bottom">0.815</td><td valign="bottom">0.788</td><td valign="bottom"><bold>0.802</bold></td></tr><tr><td></td><td valign="bottom">SW (overlapping)</td><td valign="bottom">PCC</td><td valign="bottom">1.00</td><td valign="bottom">0.831</td><td valign="bottom">0.600</td><td valign="bottom">0.812</td><td valign="bottom">0.788</td><td valign="bottom"><bold>0.801</bold></td></tr><tr><td></td><td valign="bottom">SW (ungapped)</td><td valign="bottom">PCC</td><td valign="bottom" align="left">N/A</td><td valign="bottom">0.887</td><td valign="bottom">0.600</td><td valign="bottom">0.812</td><td valign="bottom">0.763</td><td valign="bottom"><bold>0.801</bold></td></tr><tr><td></td><td valign="bottom">SW</td><td valign="bottom">PCC</td><td valign="bottom">1.50</td><td valign="bottom">0.845</td><td valign="bottom">0.520</td><td valign="bottom">0.810</td><td valign="bottom">0.800</td><td valign="bottom"><bold>0.801</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">SSD</td><td valign="bottom">1000</td><td valign="bottom">0.859</td><td valign="bottom">0.480</td><td valign="bottom">0.817</td><td valign="bottom">0.781</td><td valign="bottom"><bold>0.801</bold></td></tr><tr><td></td><td valign="bottom">SW</td><td valign="bottom">SSD</td><td valign="bottom">1000</td><td valign="bottom">0.859</td><td valign="bottom">0.480</td><td valign="bottom">0.817</td><td valign="bottom">0.781</td><td valign="bottom"><bold>0.801</bold></td></tr><tr><td>Bottom 15</td><td valign="bottom">NW</td><td valign="bottom">pCS</td><td valign="bottom">0.75</td><td valign="bottom">0.662</td><td valign="bottom">0.600</td><td valign="bottom">0.657</td><td valign="bottom">0.675</td><td valign="bottom"><bold>0.660</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">pCS</td><td valign="bottom">1.00</td><td valign="bottom">0.662</td><td valign="bottom">0.440</td><td valign="bottom">0.653</td><td valign="bottom">0.688</td><td valign="bottom"><bold>0.654</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">pCS</td><td valign="bottom">0.50</td><td valign="bottom">0.690</td><td valign="bottom">0.560</td><td valign="bottom">0.653</td><td valign="bottom">0.650</td><td valign="bottom"><bold>0.652</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">pCS</td><td valign="bottom">0.25</td><td valign="bottom">0.634</td><td valign="bottom">0.640</td><td valign="bottom">0.650</td><td valign="bottom">0.656</td><td valign="bottom"><bold>0.650</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">ALLR</td><td valign="bottom">5.00</td><td valign="bottom">0.634</td><td valign="bottom">0.480</td><td valign="bottom">0.648</td><td valign="bottom">0.619</td><td valign="bottom"><bold>0.633</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">AKL</td><td valign="bottom">4.00</td><td valign="bottom">0.704</td><td valign="bottom">0.400</td><td valign="bottom">0.594</td><td valign="bottom">0.600</td><td valign="bottom"><bold>0.600</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">pCS</td><td valign="bottom">2.00</td><td valign="bottom">0.563</td><td valign="bottom">0.400</td><td valign="bottom">0.596</td><td valign="bottom">0.656</td><td valign="bottom"><bold>0.600</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">SSD</td><td valign="bottom">1.00</td><td valign="bottom">0.634</td><td valign="bottom">0.480</td><td valign="bottom">0.585</td><td valign="bottom">0.581</td><td valign="bottom"><bold>0.585</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">PCC</td><td valign="bottom">1.50</td><td valign="bottom">0.606</td><td valign="bottom">0.520</td><td valign="bottom">0.580</td><td valign="bottom">0.581</td><td valign="bottom"><bold>0.581</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">PCC</td><td valign="bottom">2.00</td><td valign="bottom">0.521</td><td valign="bottom">0.480</td><td valign="bottom">0.423</td><td valign="bottom">0.500</td><td valign="bottom"><bold>0.453</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">ALLR</td><td valign="bottom">10.00</td><td valign="bottom">0.394</td><td valign="bottom">0.440</td><td valign="bottom">0.343</td><td valign="bottom">0.400</td><td valign="bottom"><bold>0.365</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">SSD</td><td valign="bottom">2.00</td><td valign="bottom">0.437</td><td valign="bottom">0.400</td><td valign="bottom">0.324</td><td valign="bottom">0.375</td><td valign="bottom"><bold>0.350</bold></td></tr><tr><td></td><td valign="bottom">NW</td><td valign="bottom">ALLR</td><td valign="bottom">15.00</td><td valign="bottom">0.268</td><td valign="bottom">0.400</td><td valign="bottom">0.261</td><td valign="bottom">0.381</td><td valign="bottom"><bold>0.295</bold></td></tr><tr><td></td><td>NW</td><td>PCC</td><td>4.00</td><td>0.282</td><td>0.480</td><td>0.282</td><td>0.269</td><td><bold>0.286</bold></td></tr><tr><td></td><td>NW</td><td>ALLR</td><td>20.00</td><td>0.268</td><td>0.440</td><td>0.232</td><td>0.306</td><td><bold>0.261</bold></td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt201"><p>Performance is measured as the percent of motifs whose structural class are correctly recovered via the best hit in database searches. The two datasets used in this comparison are taken from JASPAR and TRANSFAC. While accuracy was measured over the complete dataset (column <italic>Average</italic>, bold), the performance results are also partitioned separately for the nonzinc-finger families (non-ZNF; ten families in JASPAR, 20 in TRANSFAC) and the zinc-finger families (ZNF; three in JASPAR, five in TRANSFAC). <italic>Average</italic> is the weighted average. Overlapping and ungapped alignments are specified. Gap extension is equal to half the gap opening.</p></fn></table-wrap-foot> --></table-wrap></sec><sec id="s2d"><title>Predicting the TF Structural Class from its Binding Preferences</title><p>In the study of Narlikar and Hartemink [<xref ref-type="bibr" rid="pcbi-0030061-b010">10</xref>], a sparse Bayesian learning algorithm was used to predict the structural class of the TF that binds to a given DNA motif. The test dataset in that study consisted of the six largest motif families in TRANSFAC, and Narlikar and Hartemink's algorithm was able to correctly predict the TF structural family for 86% of these DNA-binding motifs. By analyzing the same dataset, we found that the best-hit approach (with ungapped Smith–Waterman alignment and the PCC metric) yields practically the same performance (87%). The best-hit searches perform better in predicting the bZIP, C4 zinc finger, and Forkhead families, whereas the Bayesian learning is better in the more diverse (in terms of DNA binding motifs) C2H2 zinc finger, homeodomain, and bHLH families (<xref ref-type="table" rid="pcbi-0030061-t003">Table 3</xref>). We will later show that the appropriate clustering of DNA motifs can help improve the classification accuracy.</p><table-wrap content-type="1col" id="pcbi-0030061-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.t003</object-id><label>Table 3</label><caption><p>Performance of TF Structural Family Classification Based on DNA-Binding Preferences in the Six Largest Motif Families in TRANSFAC</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.t003" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb3col1" align="left" charoff="0" char=""/><col id="tb3col2" align="left" charoff="0" char=""/><col id="tb3col3" align="left" charoff="0" char=""/><col id="tb3col4" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left" rowspan="2"><hr/>Name</td><td rowspan="2"><hr/>Number of TFs</td><td colspan="2"><hr/>Accuracy</td></tr><tr><td><hr/>Best-Hit (STAMP)</td><td><hr/>Bayesian Learning</td></tr></thead><tbody><tr><td>bZIP</td><td>93</td><td>0.94</td><td>0.92</td></tr><tr><td>C2H2</td><td>74</td><td>0.76</td><td>0.77</td></tr><tr><td>C4</td><td>52</td><td>0.98</td><td>0.91</td></tr><tr><td>Homeo</td><td>50</td><td>0.82</td><td>0.85</td></tr><tr><td>Forkhead</td><td>49</td><td>0.90</td><td>0.83</td></tr><tr><td>bHLH</td><td>37</td><td>0.81</td><td>0.88</td></tr><tr><td><italic>Average</italic></td><td></td><td><italic>0.87</italic></td><td><italic>0.86</italic></td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt301"><p>Results with the database &ldquo;best-hit&rdquo; approach (using STAMP) are compared with an earlier work using Bayesian learning classification &lsqb;<xref ref-type="bibr" rid="pcbi-0030061-b010">10</xref>&rsqb;.</p></fn></table-wrap-foot> --></table-wrap></sec><sec id="s2e"><title>Performance of Motif Tree-Building Methods</title><p>Sandelin and Wasserman manually constructed FBPs for those ten nonzinc-finger structural families for which four or more motifs exist in the JASPAR database (71 motifs) [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>]. One of the ten families, bZIP, produced two distinct FBPs: one related to C/EBP and one related to the CREB proteins. The set of 71 profiles provides an appropriate dataset for testing tree-building strategies and automatic clustering methods. In this study, an agglomerative (UPGMA) and a divisive (SOTA) strategy were compared (see <xref ref-type="sec" rid="s4">Methods</xref>). The most effective alignment strategy for the nonzinc-finger JASPAR dataset, the ungapped Smith–Waterman alignment, was used with each of the six similarity metrics in conjunction with UPGMA or SOTA. Performance was measured as the <italic>average homogeneity</italic> of the families at each leaf node on the tree and with respect to the tree growth. For a given node, a performance average homogeneity score of 1 denotes that only one family is represented in the motifs clustered at that node (perfect homogeneity); a score of 0.5 denotes that two equally represented families are clustered in that node; etc. The point at which the average homogeneity of the leaf nodes reaches 1 is the point where motifs have been successfully separated on the basis of structural class (although a class might be split into multiple nodes). As can be seen in <xref ref-type="fig" rid="pcbi-0030061-g004">Figure 4</xref>, UPGMA generally performs better than the neural tree method (SOTA), regardless of the similarity metric. Ungapped Smith–Waterman alignment using the PCC metric is by far the most successful metric on this dataset, managing to separate all ten structural families (100% average homogeneity) with only 25 leaf nodes. In addition, ungapped Smith–Waterman alignment using the SSD metric achieves 95% average homogeneity with 26 leaf nodes. The actual tree resulting from the combination of ungapped Smith–Waterman alignment, the PCC metric, and the UPGMA tree construction method displays a high degree of separation of the TF structural classes (<xref ref-type="fig" rid="pcbi-0030061-g005">Figure 5</xref>).</p><fig id="pcbi-0030061-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.g004</object-id><label>Figure 4</label><caption><title>Average Homogeneity of Families Represented at Each Tree Node as a Factor of the Growth of the Tree</title><p>Six scoring metrics and two different tree-building methods are tested with ungapped Smith–Waterman alignments.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.g004" xlink:type="simple"/></fig><fig id="pcbi-0030061-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.g005</object-id><label>Figure 5</label><caption><title>The Tree Resulting from a UPGMA Tree Construction of Ten JASPAR Families (71 Motifs Total) Using the PCC Scoring Metric and Smith–Waterman (Ungapped) Alignment Method</title><p>The red line represents the level at which the <italic>CH</italic><sub>log</sub> metric estimates the optimal number of data clusters on the tree.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.g005" xlink:type="simple"/></fig></sec><sec id="s2f"><title>Automatic Construction of Familial Binding Profiles</title><p>Estimating the optimal number of data clusters on a tree of binding motifs is of significant interest in classification and familial binding property analysis applications. It is well-known, however, that this is an inherently arbitrary procedure; different criteria on where to “split” the tree will give different estimates of cluster number. A number of statistics have been described that aim to estimate the optimal number of clusters (e.g., [<xref ref-type="bibr" rid="pcbi-0030061-b019">19</xref>–<xref ref-type="bibr" rid="pcbi-0030061-b021">21</xref>]), usually by seeking an optimal balance between intercluster and intracluster variability.</p><p>We used a subset of the JASPAR motifs to understand how different metrics perform in determining the optimal number of clusters in a tree. For this purpose, only closely related members of the ETS, REL, Forkhead, high mobility group (HMG), and MADS families were used. The statistics we compared were: the Gap statistic of Hastie, Tibshirani, and Walter (<italic>HTW</italic>) [<xref ref-type="bibr" rid="pcbi-0030061-b022">22</xref>], the standard Calinski and Harabasz (<italic>CH</italic>) [<xref ref-type="bibr" rid="pcbi-0030061-b019">19</xref>], and a derivative (<italic>CH</italic><bold><sub>log</sub></bold>) we developed (<xref ref-type="table" rid="pcbi-0030061-t004">Table 4</xref>). When tested on the tree of the five well-defined families, the standard <italic>CH</italic> statistic didn't yield any local maximum number of clusters. We believe this is because this statistic performs well when the number of clusters is small compared with the number of points. Otherwise, the within-cluster difference goes quickly to zero, driving the <italic>CH</italic> to infinity. The <italic>CH</italic><sub>log</sub>, by design, avoids this problem. <italic>HTW</italic> and <italic>CH</italic><sub>log</sub> both gave the correct optimal number of clusters in the five-family dataset. When tested on the full nonzinc-finger JASPAR dataset (71 motifs) (<xref ref-type="fig" rid="pcbi-0030061-g005">Figure 5</xref>), however, <italic>HTW</italic> and <italic>CH</italic> yielded no optimum number of clusters, whereas <italic>CH</italic><sub>log</sub> gave 17 (<xref ref-type="fig" rid="pcbi-0030061-g006">Figure 6</xref>), which is a reasonable number (compared with 11 of Sandelin and Wasserman). For the most part, the identified clusters of motifs seemed reasonable both in terms of binding motif conservation (manual examination) and in terms of TF subfamily classification. More information is provided in the Discussion section. The suitability of <italic>CH</italic><sub>log</sub> was also tested in trees with two, three, four, and six well-defined clusters (from the above set of JASPAR PSSMs) and always yielded the correct answer.</p><table-wrap content-type="1col" id="pcbi-0030061-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.t004</object-id><label>Table 4</label><caption><p>The Four Statistics Tested on Automatic Clustering of the 71 JASPAR Motifs</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.t004" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb4col1" align="left" charoff="0" char=""/><col id="tb4col2" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Statistic</td><td><hr/>Formula</td></tr></thead><tbody><tr><td>Hastie, Tibshirani, Walter (<italic>HTW</italic>)</td><td><mml:math display='inline'><mml:mrow><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy='false'>(</mml:mo><mml:mi>log</mml:mi><mml:mo></mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mi>log</mml:mi><mml:mo></mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:math></td></tr><tr><td>Calinski and Harabasz (<italic>CH</italic>) </td><td> <mml:math display='inline'><mml:mrow><mml:mi>C</mml:mi><mml:mi>H</mml:mi><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:mstyle mathvariant='bold' mathsize='normal'><mml:mi>B</mml:mi></mml:mstyle><mml:mo>/</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mi>g</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mstyle mathvariant='bold' mathsize='normal'><mml:mi>W</mml:mi></mml:mstyle><mml:mo>/</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mi>n</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></td></tr><tr><td>Log-modified Calinski and Harabasz (<italic>CH</italic><sub>log</sub>)</td><td> <mml:math display='inline'><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>log</mml:mi><mml:mo></mml:mo></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:mi>log</mml:mi><mml:mo></mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mstyle mathvariant='bold' mathsize='normal'><mml:mi>B</mml:mi></mml:mstyle><mml:mo stretchy='false'>)</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mi>g</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo></mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mstyle mathvariant='bold' mathsize='normal'><mml:mi>W</mml:mi></mml:mstyle><mml:mo stretchy='false'>)</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mi>n</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt401"><p><italic>B</italic> and <italic>W</italic> are the between- and within-cluster variability, respectively, <italic>n</italic> is the number of data points (matrices), and <italic>g</italic> is the number of clusters under consideration.</p></fn></table-wrap-foot> --></table-wrap><fig id="pcbi-0030061-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.g006</object-id><label>Figure 6</label><caption><title>The Behaviour of the Calinski and Harabasz–Based Log-Metric (<italic>CH</italic><sub>log</sub>) for the Tree in <xref ref-type="fig" rid="pcbi-0030061-g005">Figure 5</xref> as the Number of Clusters (<italic>g</italic>) Is Varied</title><p>The value of <italic>g</italic> = 17 produces a global minimum in the value of <italic>CH</italic><sub>log</sub>.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.g006" xlink:type="simple"/></fig><p>We test the hypothesis that the 17 automatically generated FBPs are a more accurate representation of motif diversity in the JASPAR set than the 11 manually constructed motifs using <italic>leave-one-out cross-validation</italic> (LOOCV). In this test, we treat the set of FBP clusters as static multiple alignments and remove the contribution of each motif from its appropriate FBP in turn. The removed motif is then compared against all regenerated FBPs, and treated as correctly classified if it most closely matches the FBP from which it was withdrawn. LOOCV using Sandelin and Wasserman's 11 manually defined FBPs results in nine misclassifications, or a classification performance of 62/71 = 87% (this performance rate was also reported in [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>]). By comparison, in our dataset of 17 automatically defined FBPs, LOOCV resulted in two misclassifications, which, combined with the two unclassifiable singleton clusters, suggests a classification performance of 94% (67/71).</p><p>JASPAR also contains three zinc-finger motifs that were not used in the Sandelin and Wasserman FBP construction. One of them, C2H2, includes TF proteins with highly divergent patterns of contacts (see <xref ref-type="sec" rid="s3">Discussion</xref>). The other two, DOF (a C4 zinc-finger family) and GATA, have quite conserved DNA-binding patterns. We repeated the above analysis by including the DOF and GATA motifs in JASPAR (four motifs in each family). Our method determined 18 clusters (including two singletons), and a LOOCV test resulted in 72/79 correct classifications (91%). Sandelin's and Wasserman's method on the 13 clusters (the previous 11 and the two zinc fingers) resulted in 60/79 correct classifications in the LOOCV test (76%). Compared with the 71-motif tree (<xref ref-type="fig" rid="pcbi-0030061-g005">Figure 5</xref>), the new tree is identical in 15 of the clusters (<xref ref-type="fig" rid="pcbi-0030061-g007">Figure 7</xref>). The main difference is that the two-member cluster of the heterodimeric bHLH proteins, TAL1-TCF3 and HAND1-TCF3, is now split. The TAL1-TCF3 motif is part of a new cluster with the (previously singleton) FOXL1 and the GATA-1 zinc-finger protein motif. The remaining three GATA proteins formed a new cluster. All four DOF proteins are co-clustered with the IRF proteins.</p><fig id="pcbi-0030061-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.g007</object-id><label>Figure 7</label><caption><title>The Tree Resulting from a UPGMA Tree Construction of 12 JASPAR Families (79 Motifs Total) Using the PCC Scoring Metric and Smith–Waterman (Ungapped) Alignment Method</title><p>This tree includes the two zinc-finger families (GATA and DOF).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.g007" xlink:type="simple"/></fig></sec><sec id="s2g"><title>The STAMP Platform</title><p>All described methods have been compiled in a software platform (STAMP) (Mahony S, Benos PV, STAMP: A web tool for exploring DNA-binding motif similarities, unpublished). STAMP is modularly designed to allow any combination of column–column scoring metric, alignment method, tree-building algorithm, and multiple-alignment strategy to be used. Its potential uses range from simple motif database searches to identify the TF that may bind to a particular motif to a full-scale analysis of multiple-aligned genomic regions. In the section below, examples of both these uses are provided. STAMP is publicly accessible from <ext-link ext-link-type="uri" xlink:href="http://www.benoslab.pitt.edu/stamp/" xlink:type="simple">http://www.benoslab.pitt.edu/stamp/</ext-link>.</p></sec></sec><sec id="s3"><title>Discussion</title><sec id="s3a"><title>Comparison of PSSM Column Distance Metrics and Alignment Strategies</title><p>Six PSSM column similarity metrics were evaluated together with three pairwise alignment methods (two gapped and one ungapped), two multiple-alignment strategies, and two tree-building strategies on motif datasets. The results showed that the Smith–Waterman local alignment algorithm used with the PCC or SSD metrics generally performs better in aligning the currently available PSSM models with models for which the associated TF belongs to the same structural family. We also discovered that the high efficiency of some metrics in column-to-column comparison does not extend to the alignment of whole motifs, which is a surprising and previously overlooked outcome. In the case of the ALLR metric, we believe that this inconsistency is due to the metric's very negatively skewed scoring distribution (<xref ref-type="fig" rid="pcbi-0030061-g002">Figure 2</xref>). Although such a distribution might be advantageous in distinguishing between PSSM columns with low information content, it also makes motif alignment more difficult, especially when the motifs contain low-scoring regions that can rigorously negate the overall score. The difficulties in using ALLR became more apparent with the Needleman–Wunsch global alignment, as low scores that are frequently observed in the beginning and/or at the end of the alignment could not be adequately subsidized by the positive scores in the alignable areas. The use of the alternative ALLR_LL metric (i.e., ALLR with a lower limit of −2) improved the results slightly. However, ALLR is the only metric that takes into consideration the background distribution when it compares two columns, which, in combination with the fact that it distinguishes better between columns of low information content (<xref ref-type="fig" rid="pcbi-0030061-g003">Figure 3</xref>), can be advantageous in identifying the correct PSSM model among closely related models (e.g., those belonging to the same family).</p><p>Smith–Waterman local alignments were found to be more effective than Needleman–Wunsch global alignments for DNA motifs. This is expected given the current status of the motif databases. Motifs in existing databases usually result from some automated method that runs on a set of unaligned sequences recorded in these databases. These motifs frequently consist of a “core” area of columns with high information content, surrounded by columns of low(er) information content. On such motifs, local motif alignment methods will tend to perform better than global alignment methods. Structurally, this also makes sense, since binding sites are often recognized by a single structural sequence recognition element (e.g., α-helix) either surrounded by or adjacent to a less-specific element that provides additional binding energy. Interestingly, ungapped algorithms or gapped algorithms with high gap-opening penalties generally performed better with the same metric (<xref ref-type="table" rid="pcbi-0030061-t002">Table 2</xref>). This is probably due to the fact that the motifs for TF families in JASPAR and TRANSFAC share ungapped regions of similarity. However, the difference between ungapped/high penalty and gapped with lower-gap penalty algorithms is marginal in the JASPAR and TRANSFAC databases. Gapped alignment methods are expected to be more effective when aligning families of motifs that share common half-sites with variable length spacer regions, like many prokaryotic sites.</p></sec><sec id="s3b"><title>Differences in Classification Efficiency between TF Structural Families</title><p>An unexpected finding was that the current multiclass motif classifiers perform no better than simple best-hit similarity queries against a motif database <italic>when appropriate motif alignment methods are used</italic>. Interestingly, the two zinc-finger families (C2H2 and C4) are predicted with the worst and the best efficiency, respectively, which reflects their binding geometries. The C4 factors form extensive networks of contacts along the length of an α-helix embedded in a B-DNA major groove. As a result, their target sequences are very conserved and thus their predictions easier. The C2H2 zinc fingers on the other hand contact the DNA helix at an angle using only few amino acid side-chains extending from the end of a less intimately associated helix. This results in less binding dependence upon individual amino acid sequences. Changes in certain “key” amino acid positions can drastically alter the DNA-binding specificity, thus yielding highly variable targets.</p><p>bZIP factors bind to DNA as dimers in palindromic targets and they select individual half-sites in the process. The monomers readily dissociate from the dimeric form, binding DNA initially as half-site monomers [<xref ref-type="bibr" rid="pcbi-0030061-b023">23</xref>]. This kinetic selection process, along with the intimate association of the recognition helix with the major groove (similar to C4 Zn fingers) likely provides exquisite selectivity. The same selectivity may not be realized for the bHLH proteins. Although these factors also select out half-sites, their monomers, in contrast to bZIPs, have very low dissociation rates and act more like covalently linked DNA-binding domains (similar to C2H2 factors). Also, the angle of interaction between the recognition helix and the major groove is more obtuse for bHLH than for bZIP (23 versus 20 degrees), resulting in less interaction with half-sites (3 bp instead of 4 bp). These differences may explain why a bHLH behaves more like a C2H2 in target heterogeneity.</p><p>The relatively poor prediction specificity exhibited for the Homeo HTH domain proteins stems from the binding of these factors to highly divergent targets (usually recognizing mostly an “AT” motif), probably due to their dependence upon partner domains that are either dissociable (like Hox-Pbx, Ubx-Exd, and Mat a1-alpha2) or covalently linked (like Oct, Pax, and Pit). Member families of the monomeric wHTH subtype have strong consensus correlations (like the ETS and Forkhead families with consensus GGAA and TAAACA, respectively). This results in higher prediction efficiency for Forkhead than for the more variable Homeo class. It is this idea of variability, perhaps dependent upon multimerization-related constraints, that may be a useful basis for the distinctions we observe.</p><p>Another problem that may impose a limit in the classification efficiency of any method (regardless of the TF family) is the quality of the TFBS alignment and the resulting PSSM models. It is hoped that with the accumulation of new data, this will become less of a problem in the future.</p></sec><sec id="s3c"><title>Clustering of DNA Profiles: Automatic FBP Construction</title><p>Sandelin and Wasserman [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>] had previously built 11 FBPs from 71 nonzinc-finger PSSM models (ten TF families) available in the JASPAR database. Their manual clustering of the PSSM models was based on prior knowledge of the structural class of the corresponding TF. An exception to this general rule was the bZIP family, for which they constructed two FBPs (CREB- and C/EBP-related) after observing very different DNA patterns. The FBP corresponding to each structural class was calculated from a multiple-motif alignment where the contributions from outlying motifs were negatively weighted. The 11 familial binding profiles and the 71 motifs in the training set are available to view from the JASPAR database website (<ext-link ext-link-type="uri" xlink:href="http://mordor.cgb.ki.se/cgi-bin/jaspar2005/jaspar_db.pl" xlink:type="simple">http://mordor.cgb.ki.se/cgi-bin/jaspar2005/jaspar_db.pl</ext-link>). Sandelin and Wasserman's manual approach is suitable for relatively small sets of binding motifs where the structural class corresponding to each motif is known, and where the representatives from each component structural class bind a set of closely related target motifs. However, in the more general case, where families that bind diverse target motifs are included or where the structural class of certain motifs is unknown, it may be useful to attempt automatic generation of the appropriate familial binding motifs.</p><p>We developed a fully automated method for PSSM clustering, based on the combinations of metric, alignment strategies, and tree building examined in this study. The advantages of the automatic clustering are obvious. By remaining ignorant to the prior knowledge of the structural class of each motif, we can find cases where motifs from diverse structural classes are more suitably grouped together, if they have similar binding preferences. Similarly, the automatic approach avoids the temptation of forcing together subfamilies of the same structural class with different binding preferences. Also, “outlier” PSSMs can be easily detected through an automatic clustering and subsequently be excluded from the FBP.</p><p>The method we used to determine the optimal number of clusters is similar to the Calinski and Harabasz statistic [<xref ref-type="bibr" rid="pcbi-0030061-b019">19</xref>], but the intercluster and intracluster variability is calculated on the log-scale. We found this method to compare favourably with other methods on datasets with a known, well-defined small number of clusters and in the whole dataset. When applied on the 71 JASPAR PSSM models of our dataset, this method yielded 17 clusters, two of which are singletons and another two of which contain a pair of heterologous TFs each (<xref ref-type="fig" rid="pcbi-0030061-g008">Figure 8</xref>). Overall, the automatic clustering method divides the dataset into homogeneous clusters with respect to the structural group of the corresponding TF (note that the clusters are based solely on the <italic>binding preferences</italic> of the TFs). This agrees with the general notion that structurally similar TFs tend to have similar binding specificities. The MADS domain proteins and the wHTH ETS proteins are two examples of TF families with very conserved DNA-binding preferences. Also, <italic>homeobox</italic> and <italic>nuclear receptor</italic> family clusters are homogeneous, although some members of these families can be found in other clusters. Interestingly, our algorithm split the patterns of the members of the (so-called) TRP family into Myb-related proteins and IRF proteins. This may not be surprising, since these two HTH-like proteins exhibit distinct DNA-binding geometries. Myb proteins contain three HTH domains, only one of which is involved in the target recognition (with reported consensus YAAC[G/T]G). The IRF family consists of wHTH proteins that bind as homodimers via nonpalindromic direct repeats [<xref ref-type="bibr" rid="pcbi-0030061-b024">24</xref>] or as monomers cooperatively with other proteins, like ETS [<xref ref-type="bibr" rid="pcbi-0030061-b025">25</xref>]. The IRF motif (<xref ref-type="fig" rid="pcbi-0030061-g008">Figure 8</xref>) contains a repeat of the commonly reported [A/G]NGAAA consensus, which we attribute to the homodimerization binding of these proteins.</p><fig id="pcbi-0030061-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.g008</object-id><label>Figure 8</label><caption><title>Optimal Number of Clusters of the 71 JASPAR Motifs, According to Our Method</title><p>PCC with Smith–Waterman ungapped alignment was used as a scoring function. Examples of protein–DNA complexes are provided for comparison.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.g008" xlink:type="simple"/></fig><p>Our algorithm also correctly recognized three subfamilies in the major bHLH family. The six members of the bHLH-zip subclass (e.g., USF1, MAX, etc.) are clustered together, whereas the remaining four “standard” bHLH proteins (Myf, NHLH1) and bHLH complexes (HAND1-TCF3, TAL1-TCF3) form two separate clusters. Examination of the FBPs of these clusters (<xref ref-type="fig" rid="pcbi-0030061-g008">Figure 8</xref>) shows clearly that binding preferences are substantially different, reflecting their corresponding mode of DNA recognition. The bZIP binding motifs were also automatically split into two clusters, identical to the (manually) classified JASPAR FBPs: one with the CREB-like and one with the C/EBP-like proteins. We note the striking similarity between the bZIP/CREB and the nuclear receptor binding patterns. Still, since the only base position they differ in is one of high information content, our clustering method was able to distinguish between the two patterns.</p><p>The HMG proteins are represented by three protein families that bind chromosomal DNA. The two families represented in the JASPAR database are HMGA/HMGI/Y and HMGB/SOX/SRY, whereas the HMGN family is not represented. The HMGA proteins are members of the <italic>AT-hook</italic> family of TFs [<xref ref-type="bibr" rid="pcbi-0030061-b026">26</xref>]. The HMGB proteins are structurally distinct <italic>HMG-box</italic> proteins [<xref ref-type="bibr" rid="pcbi-0030061-b027">27</xref>]. Both families prefer to bind to AT-rich sequences in the minor groove with low selectivity. This is probably the reason that our algorithm clustered them together with the Forkhead family, which also binds to AT-rich sequences, but in the major groove. There is no structural similarity among these classes of proteins, and the mode of their interaction with the DNA suggests that the target similarity is coincidental. In fact, the two motifs are <italic>not</italic> identical, but they show significant overlap in four highly informative nucleotide positions (consensus: AACA) (<xref ref-type="fig" rid="pcbi-0030061-g009">Figure 9</xref>). Nevertheless, for those that use the FBPs for predicting the TF that binds to a given DNA motif, this provides an example where generating individual FBPs might lead to misclassification due to coincidental target similarity. Thus, for prediction purposes, we propose to keep these two families in the same cluster (FBP), since distinguishing between the two may be difficult (<xref ref-type="fig" rid="pcbi-0030061-g009">Figure 9</xref>). Notably, our algorithm identified another cluster composed of members of both families, suggesting there is a relationship between their motifs. Both these clusters contain members of the HMGB subgroup. The only member of the distinct HMGA subgroup, HMG-I/Y, clusters together with a homeodomain protein, Pax4. Pax proteins have two covalently linked HTH domains separated by a long linker and they also bind AT-rich sequences. The HTHs bind to 5-bp and 6-bp recognition sequences with an interpositioned 6-bp spacer that interacts with the linker [<xref ref-type="bibr" rid="pcbi-0030061-b028">28</xref>]. This explains the long recognition sequence revealed in the FBP in this cluster.</p><fig id="pcbi-0030061-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030061.g009</object-id><label>Figure 9</label><caption><title>Similarity between the HMG and Forkhead Motifs</title><p>These families are grouped together on the HMG/Forkhead Group I cluster (<xref ref-type="fig" rid="pcbi-0030061-g008">Figure 8</xref>).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.g009" xlink:type="simple"/></fig><p>When the two zinc-finger families were included in the analysis, the overall structure of the tree and the clusters remained the same, pointing to the stability of our multiple alignment and clustering algorithm. Most of the GATA proteins formed a new cluster, whereas all DOF proteins joined the cluster of the two IRF proteins. This is because the DOF consensus target sequence (AAAG) is part of the IRF motif (<xref ref-type="fig" rid="pcbi-0030061-g008">Figure 8</xref>). The cross-validation results in the extended family tree/clustering remained very high (91% compared with 94% in the smaller tree).</p></sec><sec id="s3d"><title>The STAMP Platform</title><p>The STAMP platform, introduced in this study, contains all tested algorithms and can be efficiently used in BLAST-like searches against a database of PSSM models. Various datasets (including TRANSFAC and JASPAR motifs) are currently supported. In the future, it would be useful to incorporate other similarity metrics, alignment methods, and tree-building algorithms into the platform in order to allow for further exploration of optimal methods. Note, however, that it may not be possible to implement all of the known tree-building algorithms for motif alignment. Other distance-based methods (such as neighbour-joining [<xref ref-type="bibr" rid="pcbi-0030061-b029">29</xref>]) rely heavily on additivity of the distance metric, which was not possible to define using our comparison metrics. Parsimony-based methods [<xref ref-type="bibr" rid="pcbi-0030061-b030">30</xref>] rely on the estimation of substitution rates between sites, which is also not easily definable for frequency matrices. However, a substitution matrix has recently been defined for DNA-binding consensus sequences [<xref ref-type="bibr" rid="pcbi-0030061-b031">31</xref>], so application of alternative tree-building methods may yet be possible in the DNA-binding motif domain (albeit not for PSSMs per se).</p><p>In summary, we expect that the methods and the results described in this study will facilitate the exploration of DNA-binding preference evolution amongst related transcription factors and will have a significant impact in many areas of gene research.</p></sec></sec><sec id="s4"><title>Materials and Methods</title><sec id="s4a"><title/><sec id="s4a1"><title>PSSM column-scoring metrics.</title><p>A PSSM model of length <italic>L</italic> is composed of a set of 4 × <italic>L</italic> weights (columns). Each column, <italic>X,</italic> follows a probability distribution, {<italic>p<sub>x</sub></italic>(<italic>b</italic>)}<italic><sub>b</sub></italic><sub>∈{<italic>A,C,G,T</italic>}</sub>, with the base-probability values reflecting the preference of the TF for the corresponding base in this position. The probability values can be estimated from the observed base counts {<italic>n<sub>x</sub></italic>(<italic>b</italic>)}<italic><sub>b</sub></italic><sub>∈{<italic>A,C,G,T</italic>}</sub>. We denote the estimated values <italic>f</italic>(X) = {<italic>f<sub>x</sub></italic>(<italic>b</italic>)}<italic><sub>b</sub></italic><sub>∈{<italic>A,C,G,T</italic>}</sub>. In practice, <italic>p<sub>X</sub></italic> are estimated from <italic>n<sub>X</sub></italic> plus some pseudocounts to reduce small-sample biases and to avoid zero probabilities. The assumption of independence between positions is not entirely accurate, but acts as a useful approximation [<xref ref-type="bibr" rid="pcbi-0030061-b032">32</xref>–<xref ref-type="bibr" rid="pcbi-0030061-b034">34</xref>]. In this study, only position-independent PSSM models are considered.</p><p>Six metrics (<xref ref-type="table" rid="pcbi-0030061-t001">Table 1</xref>) are compared with respect to their efficiency in capturing similarities between PSSM columns and in aligning PSSM motifs. Let us suppose one wants to compare two columns <bold><italic>X</italic></bold> and <bold><italic>Y</italic></bold><italic>,</italic> with total number of aligned sequences <italic>N<sub>X</sub></italic> and <italic>N<sub>Y</sub></italic> and (estimated) frequency distributions of 
						<italic>f̂</italic>(<italic>X</italic>) = (<italic>X<sub>A</sub></italic>, <italic>X<sub>C</sub></italic>, <italic>X<sub>G</sub></italic>, <italic>X<sub>T</sub></italic>) and 
						<italic>f̂</italic> (<italic>Y</italic>) = (<italic>Y<sub>A</sub></italic>, <italic>Y<sub>C</sub></italic>, <italic>Y<sub>G</sub></italic>, <italic>Y<sub>T</sub></italic>), respectively. We denote 
						<italic>X̄</italic> and 
						<italic>Ȳ</italic> the average frequencies in the two columns.
					</p><p><italic>Pearson Correlation Coefficient (PCC).</italic> PCC is a popular similarity metric that has been used by us and others in comparing DNA models [<xref ref-type="bibr" rid="pcbi-0030061-b007">7</xref>,<xref ref-type="bibr" rid="pcbi-0030061-b032">32</xref>,<xref ref-type="bibr" rid="pcbi-0030061-b035">35</xref>]. PCC gives a measure of agreement between two (unweighted) sets of observations by means of their covariance. Pietrokovski [<xref ref-type="bibr" rid="pcbi-0030061-b036">36</xref>] found PCC to be the most effective among four metrics for protein profiles.</p><p><italic>p-Value of chi-square test (pCS).</italic> Schones et al. [<xref ref-type="bibr" rid="pcbi-0030061-b013">13</xref>] used the chi-square statistic as an approximation of the Fisher–Irwin exact test to investigate whether two columns are samples from the same multinomial distribution. In <xref ref-type="table" rid="pcbi-0030061-t001">Table 1</xref>, <italic>n<sub>K</sub></italic>(<italic>b</italic>) in the pCS formula represents the observed count of base <italic>b</italic> in column <italic>K</italic> (<italic>K</italic> ∈ {<bold><italic>X</italic></bold>, <bold><italic>Y</italic></bold>}) plus one pseudocount. The expected occurrence of base <italic>b</italic> in column <italic>K</italic> is given by <inline-formula id="pcbi-0030061-ex005"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030061.ex005" xlink:type="simple"/></inline-formula>
						 = (<italic>N<sub>K</sub></italic>·<italic>N<sub>b</sub></italic>)/<italic>N</italic>, where <italic>N<sub>K</sub></italic> is the total number of counts in column <italic>K, N<sub>b</sub></italic> is the total number of counts for base <italic>b</italic> in the two columns, and <italic>N</italic> is the sum of counts in both columns. The <italic>p</italic>-value is calculated from the <inline-formula id="pcbi-0030061-ex006"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030061.ex006" xlink:type="simple"/></inline-formula>
						 statistic and subtracted from 1 to yield a similarity score. We note that the pCS metric does not hold as an approximation of the Fisher–Irwin exact test when one or more bases has fewer than five observed counts in a column [<xref ref-type="bibr" rid="pcbi-0030061-b013">13</xref>]. This condition occurs often in PSSM models.
					</p><p><italic>Average Kullback–Leibler (AKL).</italic> The Kullback–Leibler distance (or <italic>relative entropy</italic>) is the weighted log-likelihood ratio distance between two distributions. The standard Kullback–Leibler is noncommutative and hence is not a true metric. However, it is frequently used in comparing TF–DNA preference probability distributions since it has an important quality: more weight is placed in the high-probability bases, where TF–DNA modeling algorithms need to be more accurate. Kullback–Leibler distance has been employed in the T-Reg Comparator motif similarity software tool and elsewhere [<xref ref-type="bibr" rid="pcbi-0030061-b032">32</xref>,<xref ref-type="bibr" rid="pcbi-0030061-b037">37</xref>,<xref ref-type="bibr" rid="pcbi-0030061-b038">38</xref>]. In our study, we subtract the <italic>average</italic> Kullback–Leibler score from an arbitrarily defined maximum (10.0) to convert it to a similarity score. A theoretical maximum score cannot be defined for the AKL column distances, but more than 99% of the column-to-column scores in the TRANSFAC database [<xref ref-type="bibr" rid="pcbi-0030061-b017">17</xref>] were found to have an AKL of less than 10.0.</p><p><italic>Sum of squared distances (SSD).</italic> SSD is a simple scoring metric that was employed by Sandelin and Wasserman in their construction of FBPs [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>]. Note that in this metric, the basic distance measure is subtracted from the maximum possible score (2.0) to convert it to similarity measure.</p><p><italic>Average Log Likelihood Ratio (ALLR and ALLR_LL).</italic> The ALLR statistic was introduced by Wang and Stormo [<xref ref-type="bibr" rid="pcbi-0030061-b031">31</xref>,<xref ref-type="bibr" rid="pcbi-0030061-b039">39</xref>] as a way to measure similarity between two <italic>informative</italic> (i.e., different from the background) column distributions. <xref ref-type="table" rid="pcbi-0030061-t001">Table 1</xref> presents the formula for ALLR, where <italic>n<sub>K</sub></italic>(<italic>b</italic>) is the observed count of base <italic>b</italic> in column <italic>K</italic> (<italic>K</italic> ∈ {<bold><italic>X</italic></bold>, <bold><italic>Y</italic></bold>}) and <italic>p<sub>ref</sub></italic>(<italic>b</italic>) is the background probability of base <italic>b</italic>. In this study, <italic>p<sub>ref</sub></italic>(<italic>b</italic>) is assumed to be 0.25 for all bases. The ALLR metric has a skewed scoring distribution; the minimum score (≤−10) is much smaller than the maximum score (2). Therefore, we also tested a modified ALLR measure, termed <italic>ALLR_LL,</italic> in which the lower score was bounded by −2.</p></sec><sec id="s4a2"><title>Comparing columns.</title><p>Information content–specific PSSM columns were constructed with <italic>f<sub>I</sub>(C) = f<sub>I</sub>(G) = f<sub>I</sub></italic>(T) and <italic>f<sub>I</sub></italic>(A) set such that the column information content had a specified value <italic>I</italic>. This column is denoted the “true” column centre, or <inline-formula id="pcbi-0030061-ex007"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030061.ex007" xlink:type="simple"/></inline-formula>
						. One million columns were sampled independently from a Dirichlet distribution centered on <inline-formula id="pcbi-0030061-ex008"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030061.ex008" xlink:type="simple"/></inline-formula>
						 (Dirichlet <italic>α</italic> parameter = 20). The sum of nucleotide counts in each of the random columns was set to 30 to reflect the mean number of binding site instances used to construct TRANSFAC PSSMs. Another one million columns were sampled from a Dirichlet distribution centered on the zero information content column<inline-formula id="pcbi-0030061-ex009"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030061.ex009" xlink:type="simple"/></inline-formula>
						, where <italic>f<sub>ref</sub>(A)</italic> = <italic>f<sub>ref</sub>(C)</italic> = <italic>f<sub>ref</sub>(G)</italic> = <italic>f<sub>ref</sub>(T)</italic> = 0.25.
					</p></sec><sec id="s4a3"><title>Comparing motifs of different lengths: <italic>p</italic>-Values.</title><p>To avoid length biases when comparing motifs of different lengths, we used the method of Sandelin and Wasserman for the calculation of empirical <italic>p</italic>-values based on simulated PSSMs [<xref ref-type="bibr" rid="pcbi-0030061-b006">6</xref>]. Construction of a dataset of 10,000 simulated PSSMs was performed according to the instructions of Sandelin and Wasserman (<ext-link ext-link-type="uri" xlink:href="http://forkhead2.cgb.ki.se/jaspar/additional" xlink:type="simple">http://forkhead2.cgb.ki.se/jaspar/additional</ext-link>) that reflected the properties of PSSMs in the JASPAR database.</p></sec><sec id="s4a4"><title>Pairwise and multiple-motif alignment and tree-building methods.</title><p><italic>Pairwise motif alignment.</italic> Needleman–Wunsch global alignment [<xref ref-type="bibr" rid="pcbi-0030061-b040">40</xref>,<xref ref-type="bibr" rid="pcbi-0030061-b041">41</xref>] and Smith–Waterman local alignment [<xref ref-type="bibr" rid="pcbi-0030061-b042">42</xref>] were tested. Both methods allow for affine gap penalties. For this study, the gap-extension penalty is set to be half the value of the gap-opening penalty. Smith–Waterman alignments also allow the user to specify a minimum overlap length for the local alignment. In cases where we tested the performance of Smith–Waterman alignments with required overlap, the minimum overlap length was set to three columns. We also implemented an ungapped, extended Smith–Waterman alignment method, in which the “motif cores” of the PSSM models under comparison are aligned before extending the local alignment. A “core” is defined as the longest of (a) the four most informative adjacent columns; and (b) the “trimmed” motif (starting and ending at a position with information content of at least 0.3). The ungapped extended Smith–Waterman alignment was found to have advantages in aligning groups of short motifs. Optimal alignment is sought in both forward and reverse motif directions.</p><p><italic>Multiple-motif alignment.</italic> Two multiple-alignment strategies are tested. One is a progressive profile alignment strategy, which relies on the preconstruction of an approximate guide tree using UPGMA. The multiple alignment is built up by progressively aligning the nodes on the guide tree in order of decreasing similarity. In this way, each internal node contains a “familial” profile. The alignment at the root node will represent the final multiple alignment. The second implemented strategy is <italic>iterative refinement alignment,</italic> which aims to combat the problem of local minima, common in the progressive alignment methods due to “frozen” subalignments [<xref ref-type="bibr" rid="pcbi-0030061-b043">43</xref>]. Iterative refinement builds a rough multiple alignment by progressively adding to the current alignment the most similar input PSSM (and taking the most similar pair as the start point of the multiple alignment). Once the initial alignment is built, each PSSM is removed from the alignment in turn and realigned to a profile of the other aligned sequences. Iteration of the realignment continues a fixed number of times. For gapped multiple alignments, gaps are encouraged to open in the same positions as previous gaps by negatively weighting the gap-open and gap-extend penalties in positions of the alignment that already contain gaps.</p><p><italic>Tree-building algorithms.</italic> We implemented two similarity-based tree-building algorithms: an agglomerative method (UPGMA [<xref ref-type="bibr" rid="pcbi-0030061-b044">44</xref>]) and a divisive method that is based on a self-organizing tree algorithm (SOTA [<xref ref-type="bibr" rid="pcbi-0030061-b045">45</xref>]). UPGMA begins by assigning each input PSSM its own leaf node. At each timestep, the two nodes with the maximum average pairwise similarity are joined. The tree is built up through successive combinations of nodes until only one node (the root) remains. SOTA follows the opposite strategy. The tree is initialized with only one node (the root), which contains a rough alignment of all input PSSMs, and the node model is generated from this alignment. The root node then produces two identical offspring leaf nodes. During each timestep, the algorithm assigns the PSSMs to their most similar leaf nodes and then allows the node model to be updated in accordance with their current contents. As is characteristic of self-organizing neural algorithms, SOTA also allows for small contributions from neighboring nodes during the update step. These contributions are designed to keep neighboring nodes similar. After a number of timesteps, the node with the highest degree of dissimilarity amongst its members is allowed to produce two identical offspring nodes. This competitive learning scheme continues until each leaf node contains a single PSSM. While we denote this algorithm SOTA to reflect its similarity to the concepts presented by Dopazo and Carazo [<xref ref-type="bibr" rid="pcbi-0030061-b045">45</xref>], the neural tree algorithm implemented here may also be thought of as a weighted hierarchical binary <italic>k</italic>-means algorithm.</p><p><italic>Estimating the number of data clusters in a PSSM tree.</italic> In this study, we tested two known statistics: Hastie, Tibshirani, Walter (<italic>HTW</italic>) [<xref ref-type="bibr" rid="pcbi-0030061-b022">22</xref>] and Calinski and Harabasz (<italic>CH</italic>) [<xref ref-type="bibr" rid="pcbi-0030061-b019">19</xref>], and one derivative of the latter (<xref ref-type="table" rid="pcbi-0030061-t004">Table 4</xref>). For the given dataset, we found that <italic>CH</italic><sub>log</sub> performed the best. The <italic>CH</italic><sub>log</sub> formula is given in <xref ref-type="table" rid="pcbi-0030061-t004">Table 4</xref>, with <italic>B</italic> and <italic>W</italic> representing the between and within cluster sum of squared errors, <italic>n</italic> is the number of matrices (i.e., 71 for the JASPAR dataset), and <italic>g</italic> is the current number of clusters in the hierarchy. Error here refers to the negative logarithm of the motif comparison <italic>p</italic>-value (described above). In contrast to the original Calinski and Harabasz statistic, the <italic>B</italic> and <italic>W</italic> are log-transformed to avoid the tendency of the denominator towards zero, which results from the relatively small size of the datasets in which we operate. This logarithm transformation means that the estimate for the optimal number of clusters on the tree (<italic>K</italic>) is the value of <italic>g</italic> that minimizes <italic>CH</italic><sub>log</sub> (in the original Calinski and Harabasz formula, the maximum value of <italic>CH</italic><sub>log</sub> was sought). The suitability of the above metric to the current application domain was confirmed by evaluating its performance in a dataset with a small number of tightly clustered motif groups (see <xref ref-type="sec" rid="s2">Results</xref>).</p></sec><sec id="s4a5"><title>Motif datasets and structures.</title><p>For the purposes of testing the accuracy of various motif-alignment and tree-building strategies, we compiled two datasets that contain the motifs of the families with four or more profiles in JASPAR [<xref ref-type="bibr" rid="pcbi-0030061-b018">18</xref>] and TRANSFAC (release 9.3 [<xref ref-type="bibr" rid="pcbi-0030061-b017">17</xref>]) databases. JASPAR contained 96 such motifs in 13 such families (of which 25 motifs belong to three zinc finger families). TRANSFAC contained 586 motifs in 25 families (of which 160 motifs belong to five zinc-finger families). The edges of the motifs were “trimmed” down to the first position with information content 0.4 or more.</p></sec></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi-0030061-st001" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030061.st001" xlink:type="simple"><label>Table S1</label><caption><title>Relative Performance of All Tested Motif Alignment Strategies</title><p>Performance is measured as the percent of motifs whose structural class are correctly recovered via the best hit in database searches. The two datasets used in this comparison are taken from JASPAR and TRANSFAC. While accuracy was measured over the complete dataset, the results below report separately the performance for the nonzinc-finger families (non-ZNF; ten families in JASPAR, 20 in TRANSFAC) and the zinc-finger families (ZNF; three in JASPAR, five in TRANSFAC). <italic>Average</italic> is the weighted average. Overlapping (<italic>overlap</italic>) and ungapped (<italic>ungapped</italic>) alignments are specified. Gap extension is equal to half the gap opening.</p><p>(243 KB DOC)</p></caption></supplementary-material><sec id="s5a"><title>Accession Numbers</title><p>The structures we used in <xref ref-type="fig" rid="pcbi-0030061-g008">Figure 8</xref> have the following Protein Data Bank (<ext-link ext-link-type="uri" xlink:href="http://www.pdb.org" xlink:type="simple">http://www.pdb.org</ext-link>) accession numbers: 9ANT, 2EZD, 1HRY, 1IF1, 1DH3, 1BC8, 2NLL, 1H88, 1PDN, 1SVC, 1SRS, 1MDY, 1AN2. The HNF3_Mod structure was provided by Kirk L. Clark and Stephen K. Burley (personal communication).</p></sec></sec></body><back><ack><p>We are grateful to the anonymous reviewers whose comments led us to substantially improve this manuscript. PVB was supported by US National Institutes of Health grants 1R01LM007994–01 and RR014214 and by TATRC/DoD USAMRAA Prime Award W81XWH-05-2-0066. PEA was supported by NIH grant CA06668544.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>AKL</term><def><p>average Kullback–Leibler (metric)</p></def></def-item><def-item><term>ALLR</term><def><p>average log-likelihood ratio (metric)</p></def></def-item><def-item><term>C/EBP</term><def><p>CCAAT/enhancer binding protein</p></def></def-item><def-item><term>CREB</term><def><p>cAMP response element-binding</p></def></def-item><def-item><term>FBP</term><def><p>familial binding profile</p></def></def-item><def-item><term>HMG</term><def><p>high mobility group</p></def></def-item><def-item><term>LOOCV</term><def><p>leave-one-out cross-validation</p></def></def-item><def-item><term>PCC</term><def><p>Pearson's correlation coefficient (metric)</p></def></def-item><def-item><term>pCS</term><def><p><italic>p</italic>-value of chi-square (metric)</p></def></def-item><def-item><term>PSSM</term><def><p>position-specific scoring matrix</p></def></def-item><def-item><term>SOTA</term><def><p>self-organizing tree algorithm</p></def></def-item><def-item><term>SSD</term><def><p>sum of squared distances (metric)</p></def></def-item><def-item><term>STAMP</term><def><p>similarity, tree-building, and alignment of DNA motifs and profiles</p></def></def-item><def-item><term>TF</term><def><p>transcription factor</p></def></def-item><def-item><term>UPGMA</term><def><p>unweighted pair group method with arithmetic mean</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0030061-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>
					<year>2000</year>
					<article-title>DNA binding sites: Representation and discovery.</article-title>
					<source>Bioinformatics</source>
					<volume>16</volume>
					<fpage>16</fpage>
					<lpage>23</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Suzuki</surname><given-names>M</given-names></name><name name-style="western"><surname>Yagi</surname><given-names>N</given-names></name></person-group>
					<year>1994</year>
					<article-title>DNA recognition code of transcription factors in the helix-turn-helix, probe helix, hormone receptor, and zinc finger families.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>91</volume>
					<fpage>12357</fpage>
					<lpage>12361</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rudolph</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Gergen</surname><given-names>JP</given-names></name></person-group>
					<year>2001</year>
					<article-title>DNA-binding by Ig-fold proteins.</article-title>
					<source>Nat Struct Biol</source>
					<volume>8</volume>
					<fpage>384</fpage>
					<lpage>386</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pabo</surname><given-names>CO</given-names></name><name name-style="western"><surname>Peisach</surname><given-names>E</given-names></name><name name-style="western"><surname>Grant</surname><given-names>RA</given-names></name></person-group>
					<year>2001</year>
					<article-title>Design and selection of novel Cys2His2 zinc finger proteins.</article-title>
					<source>Annu Rev Biochem</source>
					<volume>70</volume>
					<fpage>313</fpage>
					<lpage>340</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b005"><label>5</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Auron</surname><given-names>PE</given-names></name></person-group>
					<year>2004</year>
					<article-title>DNA sequence-specific transcription factors.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Lotze</surname><given-names>MT</given-names></name><name name-style="western"><surname>Thomson</surname><given-names>AW</given-names></name></person-group>
					<source>Measuring immunity: Basic science and clinical practice. 1st edition</source>
					<publisher-loc>London</publisher-loc>
					<publisher-name>Elsevier</publisher-name>
					<fpage>91</fpage>
					<lpage>109</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sandelin</surname><given-names>A</given-names></name><name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name></person-group>
					<year>2004</year>
					<article-title>Constrained binding site diversity within families of transcription factors enhances pattern discovery bioinformatics.</article-title>
					<source>J Mol Biol</source>
					<volume>338</volume>
					<fpage>207</fpage>
					<lpage>215</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mahony</surname><given-names>S</given-names></name><name name-style="western"><surname>Golden</surname><given-names>A</given-names></name><name name-style="western"><surname>Smith</surname><given-names>TJ</given-names></name><name name-style="western"><surname>Benos</surname><given-names>PV</given-names></name></person-group>
					<year>2005</year>
					<article-title>Improved detection of DNA motifs using a self-organized clustering of familial binding profiles.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<issue>Supplement 1</issue>
					<fpage>i283</fpage>
					<lpage>291</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b008"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Xing</surname><given-names>EP</given-names></name><name name-style="western"><surname>Karp</surname><given-names>RM</given-names></name></person-group>
					<year>2004</year>
					<article-title>MotifPrototyper: A Bayesian profile model for motif families.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>101</volume>
					<fpage>10523</fpage>
					<lpage>10528</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tompa</surname><given-names>M</given-names></name><name name-style="western"><surname>Li</surname><given-names>N</given-names></name><name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name><name name-style="western"><surname>Church</surname><given-names>GM</given-names></name><name name-style="western"><surname>De Moor</surname><given-names>B</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Assessing computational tools for the discovery of transcription factor binding sites.</article-title>
					<source>Nat Biotechnol</source>
					<volume>23</volume>
					<fpage>137</fpage>
					<lpage>144</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Narlikar</surname><given-names>L</given-names></name><name name-style="western"><surname>Hartemink</surname><given-names>AJ</given-names></name></person-group>
					<year>2006</year>
					<article-title>Sequence features of DNA binding sites reveal structural class of associated transcription factor.</article-title>
					<source>Bioinformatics</source>
					<volume>22</volume>
					<fpage>157</fpage>
					<lpage>163</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b011"><label>11</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Cartharius</surname><given-names>K</given-names></name><name name-style="western"><surname>Frech</surname><given-names>K</given-names></name><name name-style="western"><surname>Grote</surname><given-names>K</given-names></name><name name-style="western"><surname>Klocke</surname><given-names>B</given-names></name><name name-style="western"><surname>Haltmeier</surname><given-names>M</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>MatInspector and beyond: Promoter analysis based on transcription factor binding sites.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>2933</fpage>
					<lpage>2942</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kielbasa</surname><given-names>SM</given-names></name><name name-style="western"><surname>Gonze</surname><given-names>D</given-names></name><name name-style="western"><surname>Herzel</surname><given-names>H</given-names></name></person-group>
					<year>2005</year>
					<article-title>Measuring similarities between transcription factor binding sites.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>6</volume>
					<fpage>237</fpage>
				</element-citation></ref><ref id="pcbi-0030061-b013"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Schones</surname><given-names>DE</given-names></name><name name-style="western"><surname>Sumazin</surname><given-names>P</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>MQ</given-names></name></person-group>
					<year>2005</year>
					<article-title>Similarity of position frequency matrices for transcription factor binding sites.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>307</fpage>
					<lpage>313</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Macisaac</surname><given-names>KD</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>DB</given-names></name><name name-style="western"><surname>Nekludova</surname><given-names>L</given-names></name><name name-style="western"><surname>Odom</surname><given-names>DT</given-names></name><name name-style="western"><surname>Schreiber</surname><given-names>J</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>A hypothesis-based approach for identifying the binding specificity of regulatory proteins from chromatin immunoprecipitation data.</article-title>
					<source>Bioinformatics</source>
					<volume>22</volume>
					<fpage>423</fpage>
					<lpage>429</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Corcoran</surname><given-names>DL</given-names></name><name name-style="western"><surname>Feingold</surname><given-names>E</given-names></name><name name-style="western"><surname>Dominick</surname><given-names>J</given-names></name><name name-style="western"><surname>Wright</surname><given-names>M</given-names></name><name name-style="western"><surname>Harnaha</surname><given-names>J</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Footer: A quantitative comparative genomics method for efficient recognition of <italic>cis-</italic>regulatory elements.</article-title>
					<source>Genome Res</source>
					<volume>15</volume>
					<fpage>840</fpage>
					<lpage>847</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Xie</surname><given-names>X</given-names></name><name name-style="western"><surname>Lu</surname><given-names>J</given-names></name><name name-style="western"><surname>Kulbokas</surname><given-names>EJ</given-names></name><name name-style="western"><surname>Golub</surname><given-names>TR</given-names></name><name name-style="western"><surname>Mootha</surname><given-names>V</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Systematic discovery of regulatory motifs in human promoters and 3′ UTRs by comparison of several mammals.</article-title>
					<source>Nature</source>
					<volume>434</volume>
					<fpage>338</fpage>
					<lpage>345</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Matys</surname><given-names>V</given-names></name><name name-style="western"><surname>Fricke</surname><given-names>E</given-names></name><name name-style="western"><surname>Geffers</surname><given-names>R</given-names></name><name name-style="western"><surname>Gossling</surname><given-names>E</given-names></name><name name-style="western"><surname>Haubrock</surname><given-names>M</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>TRANSFAC: Transcriptional regulation, from patterns to profiles.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>374</fpage>
					<lpage>378</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sandelin</surname><given-names>A</given-names></name><name name-style="western"><surname>Alkema</surname><given-names>W</given-names></name><name name-style="western"><surname>Engstrom</surname><given-names>P</given-names></name><name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name><name name-style="western"><surname>Lenhard</surname><given-names>B</given-names></name></person-group>
					<year>2004</year>
					<article-title>JASPAR: An open-access database for eukaryotic transcription factor binding profiles.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>D91</fpage>
					<lpage>D94</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Calinski</surname><given-names>T</given-names></name><name name-style="western"><surname>Harabasz</surname><given-names>J</given-names></name></person-group>
					<year>1974</year>
					<article-title>A dendrite method for cluster analysis.</article-title>
					<source>Communications Statistics</source>
					<volume>3</volume>
					<fpage>1</fpage>
					<lpage>27</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Davies</surname><given-names>DL</given-names></name><name name-style="western"><surname>Bouldin</surname><given-names>DW</given-names></name></person-group>
					<year>1979</year>
					<article-title>A cluster separation measure.</article-title>
					<source>IEEE Trans Patt Anal Mach Intell</source>
					<volume>1</volume>
					<fpage>224</fpage>
					<lpage>227</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name><name name-style="western"><surname>Walther</surname><given-names>G</given-names></name><name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name></person-group>
					<year>2001</year>
					<article-title>Estimating the number of data clusters via the Gap statistic.</article-title>
					<source>J Roy Stat Soc B</source>
					<volume>63</volume>
					<fpage>411</fpage>
					<lpage>423</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name><name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name><name name-style="western"><surname>Walter</surname><given-names>G</given-names></name></person-group>
					<year>2001</year>
					<article-title>Estimating the number of data clusters via the Gap statistic.</article-title>
					<source>J Roy Stat Soc B</source>
					<volume>63</volume>
					<fpage>411</fpage>
					<lpage>423</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kohler</surname><given-names>JJ</given-names></name><name name-style="western"><surname>Metallo</surname><given-names>SJ</given-names></name><name name-style="western"><surname>Schneider</surname><given-names>TL</given-names></name><name name-style="western"><surname>Schepartz</surname><given-names>A</given-names></name></person-group>
					<year>1999</year>
					<article-title>DNA specificity enhanced by sequential binding of protein monomers.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>96</volume>
					<fpage>11735</fpage>
					<lpage>11739</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Moustakas</surname><given-names>A</given-names></name><name name-style="western"><surname>Heldin</surname><given-names>CH</given-names></name></person-group>
					<year>2003</year>
					<article-title>The nuts and bolts of IRF structure.</article-title>
					<source>Nat Struct Biol</source>
					<volume>10</volume>
					<fpage>874</fpage>
					<lpage>876</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Escalante</surname><given-names>CR</given-names></name><name name-style="western"><surname>Brass</surname><given-names>AL</given-names></name><name name-style="western"><surname>Pongubala</surname><given-names>JM</given-names></name><name name-style="western"><surname>Shatova</surname><given-names>E</given-names></name><name name-style="western"><surname>Shen</surname><given-names>L</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>Crystal structure of PU.1/IRF-4/DNA ternary complex.</article-title>
					<source>Mol Cell</source>
					<volume>10</volume>
					<fpage>1097</fpage>
					<lpage>1105</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b026"><label>26</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Reeves</surname><given-names>R</given-names></name><name name-style="western"><surname>Beckerbauer</surname><given-names>L</given-names></name></person-group>
					<year>2001</year>
					<article-title>HMGI/Y proteins: Flexible regulators of transcription and chromatin structure.</article-title>
					<source>Biochim Biophys Acta</source>
					<volume>1519</volume>
					<fpage>13</fpage>
					<lpage>29</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Stott</surname><given-names>K</given-names></name><name name-style="western"><surname>Tang</surname><given-names>GS</given-names></name><name name-style="western"><surname>Lee</surname><given-names>KB</given-names></name><name name-style="western"><surname>Thomas</surname><given-names>JO</given-names></name></person-group>
					<year>2006</year>
					<article-title>Structure of a complex of tandem HMG boxes and DNA.</article-title>
					<source>J Mol Biol</source>
					<volume>360</volume>
					<fpage>90</fpage>
					<lpage>104</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b028"><label>28</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Xu</surname><given-names>HE</given-names></name><name name-style="western"><surname>Rould</surname><given-names>MA</given-names></name><name name-style="western"><surname>Xu</surname><given-names>W</given-names></name><name name-style="western"><surname>Epstein</surname><given-names>JA</given-names></name><name name-style="western"><surname>Maas</surname><given-names>RL</given-names></name><etal/></person-group>
					<year>1999</year>
					<article-title>Crystal structure of the human Pax6 paired domain–DNA complex reveals specific roles for the linker region and carboxy-terminal subdomain in DNA binding.</article-title>
					<source>Genes Dev</source>
					<volume>13</volume>
					<fpage>1263</fpage>
					<lpage>1275</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Saitou</surname><given-names>N</given-names></name><name name-style="western"><surname>Nei</surname><given-names>M</given-names></name></person-group>
					<year>1987</year>
					<article-title>The neighbor-joining method: A new method for reconstructing phylogenetic trees.</article-title>
					<source>Mol Biol Evol</source>
					<volume>4</volume>
					<fpage>406</fpage>
					<lpage>425</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b030"><label>30</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Fitch</surname><given-names>WM</given-names></name></person-group>
					<year>1971</year>
					<article-title>Toward defining the course of evolution: Minimum change for a specified tree topology.</article-title>
					<source>Syst Zool</source>
					<volume>20</volume>
					<fpage>406</fpage>
					<lpage>416</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>T</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>
					<year>2005</year>
					<article-title>Identifying the conserved network of <italic>cis-</italic>regulatory sites of a eukaryotic genome.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>102</volume>
					<fpage>17400</fpage>
					<lpage>17405</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b032"><label>32</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Benos</surname><given-names>PV</given-names></name><name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>
					<year>2002</year>
					<article-title>Additivity in protein–DNA interactions: How good an approximation is it?</article-title>
					<source>Nucleic Acids Res</source>
					<volume>30</volume>
					<fpage>4442</fpage>
					<lpage>4451</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b033"><label>33</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Benos</surname><given-names>PV</given-names></name><name name-style="western"><surname>Lapedes</surname><given-names>AS</given-names></name><name name-style="western"><surname>Fields</surname><given-names>DS</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>
					<year>2001</year>
					<article-title>SAMIE: Statistical algorithm for modeling interaction energies.</article-title>
					<source>Pac Symp Biocomput</source>
					<fpage>115</fpage>
					<lpage>126</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Benos</surname><given-names>PV</given-names></name><name name-style="western"><surname>Lapedes</surname><given-names>AS</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>
					<year>2002</year>
					<article-title>Probabilistic code for DNA recognition by proteins of the EGR family.</article-title>
					<source>J Mol Biol</source>
					<volume>323</volume>
					<fpage>701</fpage>
					<lpage>727</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b035"><label>35</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hughes</surname><given-names>JD</given-names></name><name name-style="western"><surname>Estep</surname><given-names>PW</given-names></name><name name-style="western"><surname>Tavazoie</surname><given-names>S</given-names></name><name name-style="western"><surname>Church</surname><given-names>GM</given-names></name></person-group>
					<year>2000</year>
					<article-title>Computational identification of <italic>cis-</italic>regulatory elements associated with groups of functionally related genes in <named-content content-type="genus-species" xlink:type="simple">Saccharomyces cerevisiae</named-content>.</article-title>
					<source>J Mol Biol</source>
					<volume>296</volume>
					<fpage>1205</fpage>
					<lpage>1214</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b036"><label>36</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pietrokovski</surname><given-names>S</given-names></name></person-group>
					<year>1996</year>
					<article-title>Searching databases of conserved sequence regions by aligning protein multiple-alignments.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>24</volume>
					<fpage>3836</fpage>
					<lpage>3845</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b037"><label>37</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Aerts</surname><given-names>S</given-names></name><name name-style="western"><surname>Van Loo</surname><given-names>P</given-names></name><name name-style="western"><surname>Thijs</surname><given-names>G</given-names></name><name name-style="western"><surname>Moreau</surname><given-names>Y</given-names></name><name name-style="western"><surname>De Moor</surname><given-names>B</given-names></name></person-group>
					<year>2003</year>
					<article-title>Computational detection of <italic>cis-</italic>regulatory modules.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<issue>Supplement 2</issue>
					<fpage>II5</fpage>
					<lpage>II14</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b038"><label>38</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Roepcke</surname><given-names>S</given-names></name><name name-style="western"><surname>Grossmann</surname><given-names>S</given-names></name><name name-style="western"><surname>Rahmann</surname><given-names>S</given-names></name><name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name></person-group>
					<year>2005</year>
					<article-title>T-Reg Comparator: An analysis tool for the comparison of position weight matrices.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>W438</fpage>
					<lpage>W441</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b039"><label>39</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>T</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>
					<year>2003</year>
					<article-title>Combining phylogenetic data with co-regulated genes to identify regulatory motifs.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<fpage>2369</fpage>
					<lpage>2380</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b040"><label>40</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gotoh</surname><given-names>O</given-names></name></person-group>
					<year>1982</year>
					<article-title>An improved algorithm for matching biological sequences.</article-title>
					<source>J Mol Biol</source>
					<volume>162</volume>
					<fpage>705</fpage>
					<lpage>708</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b041"><label>41</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Needleman</surname><given-names>SB</given-names></name><name name-style="western"><surname>Wunsch</surname><given-names>CD</given-names></name></person-group>
					<year>1970</year>
					<article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins.</article-title>
					<source>J Mol Biol</source>
					<volume>48</volume>
					<fpage>443</fpage>
					<lpage>453</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b042"><label>42</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>TF</given-names></name><name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name></person-group>
					<year>1981</year>
					<article-title>Identification of common molecular subsequences.</article-title>
					<source>J Mol Biol</source>
					<volume>147</volume>
					<fpage>195</fpage>
					<lpage>197</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b043"><label>43</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Barton</surname><given-names>GJ</given-names></name><name name-style="western"><surname>Sternberg</surname><given-names>MJ</given-names></name></person-group>
					<year>1987</year>
					<article-title>A strategy for the rapid multiple alignment of protein sequences. Confidence levels from tertiary structure comparisons.</article-title>
					<source>J Mol Biol</source>
					<volume>198</volume>
					<fpage>327</fpage>
					<lpage>337</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b044"><label>44</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sokal</surname><given-names>RR</given-names></name><name name-style="western"><surname>Michener</surname><given-names>CD</given-names></name></person-group>
					<year>1958</year>
					<article-title>A statistical method for evaluating systematic relationships.</article-title>
					<source>U Kansas Scientific Bull</source>
					<volume>28</volume>
					<fpage>1409</fpage>
					<lpage>1438</lpage>
				</element-citation></ref><ref id="pcbi-0030061-b045"><label>45</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Dopazo</surname><given-names>J</given-names></name><name name-style="western"><surname>Carazo</surname><given-names>JM</given-names></name></person-group>
					<year>1997</year>
					<article-title>Phylogenetic reconstruction using an unsupervised growing neural network that adopts the topology of a phylogenetic tree.</article-title>
					<source>J Mol Evol</source>
					<volume>44</volume>
					<fpage>226</fpage>
					<lpage>233</lpage>
				</element-citation></ref></ref-list></back></article>