<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005096</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00658</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>DNA sequencing</subject><subj-group><subject>Next-generation sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>DNA sequencing</subject><subj-group><subject>Next-generation sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Transcriptome analysis</subject><subj-group><subject>Next-generation sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Transcriptome analysis</subject><subj-group><subject>Next-generation sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene types</subject><subj-group><subject>Pseudogenes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome complexity</subject><subj-group><subject>Pseudogenes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome complexity</subject><subj-group><subject>Pseudogenes</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>RNA structure</subject><subj-group><subject>RNA alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>RNA</subject><subj-group><subject>RNA structure</subject><subj-group><subject>RNA alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genomic libraries</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genomic libraries</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome complexity</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome complexity</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>AlignerBoost: A Generalized Software Toolkit for Boosting Next-Gen Sequencing Mapping Accuracy Using a Bayesian-Based Mapping Quality Framework</article-title>
<alt-title alt-title-type="running-head">AlignerBoost Software Toolkit</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Zheng</surname>
<given-names>Qi</given-names>
</name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Grice</surname>
<given-names>Elizabeth A.</given-names>
</name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Department of Dermatology, Perelman School of Medicine, University of Pennsylvania, Philadelphia, Pennsylvania, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Poisot</surname>
<given-names>Timoth√©e</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Universite de Montreal, CANADA</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"><list-item><p><bold>Conceived and designed the experiments:</bold> QZ.</p></list-item> <list-item><p><bold>Performed the experiments:</bold> QZ.</p></list-item> <list-item><p><bold>Analyzed the data:</bold> QZ.</p></list-item> <list-item><p><bold>Contributed reagents/materials/analysis tools:</bold> EAG.</p></list-item> <list-item><p><bold>Wrote the paper:</bold> QZ EAG.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">zhengqi@mail.med.upenn.edu</email> (QZ); <email xlink:type="simple">egrice@mail.med.upenn.edu</email> (EAG)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>5</day>
<month>10</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>10</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>10</issue>
<elocation-id>e1005096</elocation-id>
<history>
<date date-type="received">
<day>21</day>
<month>4</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>2</day>
<month>8</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Zheng, Grice</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005096"/>
<abstract>
<p>Accurate mapping of next-generation sequencing (NGS) reads to reference genomes is crucial for almost all NGS applications and downstream analyses. Various repetitive elements in human and other higher eukaryotic genomes contribute in large part to ambiguously (non-uniquely) mapped reads. Most available NGS aligners attempt to address this by either removing all non-uniquely mapping reads, or reporting one random or "best" hit based on simple heuristics. Accurate estimation of the mapping quality of NGS reads is therefore critical albeit completely lacking at present. Here we developed a generalized software toolkit "AlignerBoost", which utilizes a Bayesian-based framework to accurately estimate mapping quality of ambiguously mapped NGS reads. We tested AlignerBoost with both simulated and real DNA-seq and RNA-seq datasets at various thresholds. In most cases, but especially for reads falling within repetitive regions, AlignerBoost dramatically increases the mapping precision of modern NGS aligners without significantly compromising the sensitivity even without mapping quality filters. When using higher mapping quality cutoffs, AlignerBoost achieves a much lower false mapping rate while exhibiting comparable or higher sensitivity compared to the aligner default modes, therefore significantly boosting the detection power of NGS aligners even using extreme thresholds. AlignerBoost is also SNP-aware, and higher quality alignments can be achieved if provided with known SNPs. AlignerBoost‚Äôs algorithm is computationally efficient, and can process one million alignments within 30 seconds on a typical desktop computer. AlignerBoost is implemented as a uniform Java application and is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Grice-Lab/AlignerBoost" xlink:type="simple">https://github.com/Grice-Lab/AlignerBoost</ext-link>.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000069</institution-id>
<institution>National Institute of Arthritis and Musculoskeletal and Skin Diseases</institution>
</institution-wrap>
</funding-source>
<award-id>R01-AR066663</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Grice</surname>
<given-names>Elizabeth A.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000056</institution-id>
<institution>National Institute of Nursing Research</institution>
</institution-wrap>
</funding-source>
<award-id>R01-NR015639</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Grice</surname>
<given-names>Elizabeth A.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100006920</institution-id>
<institution>University of Pennsylvania</institution>
</institution-wrap>
</funding-source>
</award-group>
<funding-statement>This work was supported by grants from the National Institutes of Health, National Institutes of Arthritis and Musculoskeletal and Skin Disease (Grant R01 AR066663 to EAG) and the National Institute of Nursing Research (Grant R01 NR015639 to EAG) and the Department of Dermatology at University of Pennsylvania. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="20"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>‚ÄúThis is a <italic>PLOS Computational Biology</italic> Software paper.‚Äù</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Numerous genome-scale experimental applications are now possible due to the advent of high throughput, low cost next-generation sequencing (NGS) platforms, including genome sequencing/re-sequencing, gene expression profiling, mRNA splicing prediction/characterization, SNP identification and genotyping, and disease-associated variant identification. Accurate mapping of NGS reads to reference genomes is critical to all of these applications. Many public or commercial NGS read mapping programs (‚Äúaligners‚Äù) are available, most of which utilize a "seed-search" first strategy to allow ultra-fast processing. The most commonly used algorithms for seed-search are Hash-index (e.g. MAQ, GSNAP, SRMapper, mrsFAST-Ultra, SeqAlto [<xref ref-type="bibr" rid="pcbi.1005096.ref001">1</xref>‚Äì<xref ref-type="bibr" rid="pcbi.1005096.ref005">5</xref>]), "Burrows-Wheeler Transform" (e.g. Bowtie/Bowtie2, BWA, SOAP2 [<xref ref-type="bibr" rid="pcbi.1005096.ref006">6</xref>‚Äì<xref ref-type="bibr" rid="pcbi.1005096.ref010">10</xref>]), un-compressed tries (e.g. STAR [<xref ref-type="bibr" rid="pcbi.1005096.ref011">11</xref>]), or a mixture of the above (e.g. YOABS [<xref ref-type="bibr" rid="pcbi.1005096.ref012">12</xref>]). These seed-search algorithms usually use relatively small segments of the reads ("seeds") to initiate mapping, due to large RAM requirements to build the index. They then attempt to extend the mapping either by naive comparison or local Smith-Waterman alignment algorithm [<xref ref-type="bibr" rid="pcbi.1005096.ref001">1</xref>‚Äì<xref ref-type="bibr" rid="pcbi.1005096.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005096.ref006">6</xref>‚Äì<xref ref-type="bibr" rid="pcbi.1005096.ref012">12</xref>]. Theoretically, the use of relatively small "seeds" should provide enough uniqueness (or mapping precision) even for very large genomes. In reality however, most genomes, especially those of higher eukaryotes, are enriched with various large and highly similar repetitive elements, such as pseudogenes, paralog gene families, transposable elements, tandem repeats and sequences encoding repeat RNAs. This often leads to multiple hits in the "seed-search" stage and subsequent ambiguously mapped reads for most real NGS datasets, even those designed to target exome regions. In fact, certain NGS aligners treat seeds in highly repetitive regions as ‚Äúhigh complexity‚Äù and ignore them by default. However, some repetitive elements in the human genome can have an overwhelming high copy number. For example, some human pseudogene classes may have more than 500 copies of over 3,000 bp; a few human SINE retrotransposon families may have over 100,000 copies of about 300 bp. In these repetitive regions, a ‚Äúlow complexity‚Äù seed might not even exist, leading to biased mapping in favor of these regions and subsequent false mapping.</p>
<p>Incorrect mapping of NGS reads may cause many problems in downstream data analyses, including biased genome/transcriptome profiling, false prediction of novel genes/transcripts, false SNP prediction, or even identification of false disease variations [<xref ref-type="bibr" rid="pcbi.1005096.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005096.ref014">14</xref>]. Most current NGS aligners attempt to address this problem by either removing or suppressing all multiple-mapped reads [<xref ref-type="bibr" rid="pcbi.1005096.ref006">6</xref>], reporting a random hit [<xref ref-type="bibr" rid="pcbi.1005096.ref007">7</xref>], or reporting a "best" hit [<xref ref-type="bibr" rid="pcbi.1005096.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005096.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005096.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005096.ref012">12</xref>]. However, all currently available ‚Äúbest hit‚Äù methods are based on heuristic instead of strict statistical inference, such as number of seed mismatches or Smith-Waterman alignment scores, whose effect haven't been proven for finding the correct mapping loci.</p>
<p>Here we present AlignerBoost, a generalized software toolkit suitable for most NGS studies requiring alignment to a reference genome. AlignerBoost significantly increases mapping precision of NGS aligners, without significantly decreasing the mapping sensitivity when only considering the best hits, especially for reads generated from repeat regions. AlignerBoost achieves this by first tuning NGS aligners to report all potential alignments, then utilizes a Bayesian-based framework to accurately estimate the mapping quality of ambiguously mapped reads.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>We tested AlignerBoost with both simulated and real datasets under various combinations of experimental strategies. Since it is very difficult to determine whether a read from a real dataset is mapped correctly, we first generated synthetic NGS datasets under complex sequencing error models (see below). It is noteworthy that we didn‚Äôt choose published software for this purpose, such as SlnC [<xref ref-type="bibr" rid="pcbi.1005096.ref015">15</xref>], XS [<xref ref-type="bibr" rid="pcbi.1005096.ref016">16</xref>], GemSIM [<xref ref-type="bibr" rid="pcbi.1005096.ref017">17</xref>], or ART [<xref ref-type="bibr" rid="pcbi.1005096.ref018">18</xref>], because to our knowledge, they do not support generating simulated reads in designated regions of the genome as our procedures do. For all datasets, we tested the overall mapping precision (positive prediction value, or PPV = TP/(TP + FP) and sensitivity (true positive rate, or TPR = TP/(TP + FN)) for AlignerBoost with various NGS aligners, and compared the AlignerBoost filtered results to the default "best" outputs (<xref ref-type="supplementary-material" rid="pcbi.1005096.s001">S1 Table</xref>). To calculate the mapping precision and sensitivity, a ‚Äúcorrect-mapping‚Äù is defined as aligned boundaries that are within +/- 20% of the true locus relative to the alignment length. The exact definition of a true locus is explained for simulated and real datasets separately below.</p>
<sec id="sec003">
<title>Simulated DNA-seq datasets</title>
<p>We generated simulated DNA-seq datasets with a complex sequencing error model by the following procedures: (1) Random genomic regions with particular genetic features are drawn from uniform distributed locations and truncated Gaussian size-distributions; (2) Genomic single-end (SE) or paired-end (PE) reads with given size are extracted from these regions; (3) Simulated base qualities (sequencing errors) are randomly drawn from Gaussian distributions with fixed mean qualities at seed regions and progressively decreasing means at subsequent bases both with fixed standard-deviations, for forward and reverse reads independently; (4) Original reads are then subjected to a mutation process for substitutions, insertions, and deletions according to designated base qualities. The resulting simulated NGS datasets have many common features of datasets produced by modern NGS sequencing platforms, such as variable base qualities both for different reads and different positions (<xref ref-type="supplementary-material" rid="pcbi.1005096.s009">S1 Fig</xref>). To mimic different experimental designs, we generated four simulated DNA-seq datasets of four different genetic features, namely total genome (Genome), RefSeq gene exons (RefExome), VegaPseudogenes (Pseudogene), and Repeat-Masker annotated Transposable Elements (RMSK). Detailed parameters for generating these simulated NGS datasets can be found in <xref ref-type="supplementary-material" rid="pcbi.1005096.s002">S2 Table</xref>.</p>
<p>We mapped all simulated datasets with or without using AlignerBoost coupled with 4 NGS aligners, namely SeqAlto [<xref ref-type="bibr" rid="pcbi.1005096.ref005">5</xref>], Bowtie [<xref ref-type="bibr" rid="pcbi.1005096.ref006">6</xref>], Bowtie2 [<xref ref-type="bibr" rid="pcbi.1005096.ref007">7</xref>] and BWA-MEM (abbreviated to ‚ÄúBWA‚Äù hereafter) [<xref ref-type="bibr" rid="pcbi.1005096.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005096.ref009">9</xref>], then compared the ‚Äúbest‚Äù alignments (with highest mapQ values) between AlignerBoost filtered or the program‚Äôs default outputs. In general, the filtered results achieved much higher mapping precision (most times &gt;97%) without significantly losing sensitivity (sometimes even with increased sensitivity) compared to the "default" results (<xref ref-type="fig" rid="pcbi.1005096.g001">Fig 1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005096.s003">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005096.s004">S4</xref> Tables), regardless of which type of aligner was used. This is especially true for the repeat-rich datasets, i.e. pseudogenes and RMSK, where the precision gain can be very profound (up to ~15%). As expected, for PE-reads the default method already yielded reasonably good mapping precision especially for genome and RefExome datasets, yet AlignerBoost achieved even higher precision (mostly &gt;98%) and with no sensitivity losses (<xref ref-type="fig" rid="pcbi.1005096.g001">Fig 1E‚Äì1H</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005096.s004">S4 Table</xref>). Therefore, AlignerBoost is suitable for most, if not all, NGS experimental designs, especially for those with many repeat-oriented sequences and relatively short read length. It is of note that some aligners, such as SeqAlto and BWA, don‚Äôt support multiple mapping under PE mode, and were therefore not tested under these scenarios.</p>
<fig id="pcbi.1005096.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005096.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Mapping sensitivity and precision of simulated DNA-seq datasets by picking ‚Äúbest‚Äù hits using AlignerBoost filtering procedures (AlignerBoost) or the aligner‚Äôs default best mode (Default).</title>
<p>A-D: Single-end (SE) mapping; E-H: Paired-end (PE) mapping; A/E, B/F, C/G, D/H: SE/PE results for Genome, RefExome, Pseudogene and RMSK simulated datasets, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.g001" xlink:type="simple"/>
</fig>
<p>It is not uncommon that extremely high precision alignment is required, such as when calling disease-related genetic variations. Since most modern NGS aligners report variable empirical mapQ values, we sought to test the read mapping performance of AlignerBoost (regarding the sensitivity and FDR (1- precision)) by applying a minimum mapQ cutoff at different thresholds (<xref ref-type="fig" rid="pcbi.1005096.g002">Fig 2</xref>). Strikingly, AlignerBoost achieves up-to one order of magnitude lower FDR rate toward the very strict end of the mapQ cutoff threshold, while maintaining an equivalent or even higher sensitivity, for all 4 simulated datasets (<xref ref-type="fig" rid="pcbi.1005096.g002">Fig 2A‚Äì2D</xref>). Similar mapping performance improvements were observed for the PE datasets, where we only tested those aligners supporting multiple mapped reads under PE mode (<xref ref-type="fig" rid="pcbi.1005096.g002">Fig 2E‚Äì2H</xref>). The simultaneous gain of precision and sensitivity is very profound for aligners known to be able to carry out near-exhaustive searches (e.g. Bowtie2 and BWA), suggesting it is a good combination to use AlignerBoost with highly sensitive NGS aligners.</p>
<fig id="pcbi.1005096.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005096.g002</object-id>
<label>Fig 2</label>
<caption>
<title>The mapping sensitivity vs. False Discovery Rate (FDR) curves under different mapping quality (mapQ) cutoffs for the simulated DNA-seq datasets.</title>
<p>The mapQ varies from 0, 3, 6, 10, 13, 20, then in increments of 10 up to the maximum allowed values of the indicated aligner. ‚ÄúDefault‚Äù indicates aligners‚Äô default best hits; ‚ÄúAlignerBoost‚Äù indicates best hits via AlignerBoost mapping and filtering procedures. A-D: Single-end (SE) mapping; E-H: Paired-end (PE) mapping; A/E: Genome, B/F: RefExome, C/G: Pseudogene, D/H: RMSK.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>Simulated RNA-seq datasets</title>
<p>Another widely used NGS application is RNA-seq, which has added complexity regarding read mapping, including exon/intron junction handling and post-transcription modifications, such as polyadenylation and editing. These complexities can lead to improper partial alignments between the non-genomic parts of the reads to the genome, especially for those aligners that do not implement the Smith-Waterman local alignment algorithm. To test this, we generated simulated RNA-seq datasets (both SE and PE) from RefSeq mRNAs (refGenes) using a similar procedure as for the DNA-seq datasets, with the exception that random regions were drawn directly from spliced RefSeq mRNAs instead of the genome (<xref ref-type="supplementary-material" rid="pcbi.1005096.s002">S2 Table</xref>). We then did similar comparisons as above but with additional NGS aligners, including two dedicated RNA-seq aligners, Tophat2 and STAR, which can handle splicing-junction alignments [<xref ref-type="bibr" rid="pcbi.1005096.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005096.ref019">19</xref>]. We also enabled the "1DP" feature (see <xref ref-type="sec" rid="sec008">Methods</xref>) for aligners without local-alignment algorithm support for the reasons explained above.</p>
<p>Similar to the DNA-seq dataset results, AlignerBoost achieves significantly higher precision compared to the default results for all aligners tested and for both SE and PE reads (<xref ref-type="fig" rid="pcbi.1005096.g003">Fig 3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005096.s005">S5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005096.s006">S6</xref> Tables). Surprisingly, it often increases the mapping sensitivity as well, especially for DNA-seq aligners (<xref ref-type="fig" rid="pcbi.1005096.g003">Fig 3</xref>), suggesting that the default mode of these aligners for RNA-seq reads are not optimal when compared to the AlignerBoost fine-tuned options.</p>
<fig id="pcbi.1005096.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005096.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Mapping sensitivity and precision of simulated RNA-seq datasets by picking ‚Äúbest‚Äù hits using AlignerBoost filtering procedures (AlignerBoost) or the aligner‚Äôs default best mode (Default).</title>
<p>A: Single-end (SE) mapping; B: Paired-end (PE) mapping.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.g003" xlink:type="simple"/>
</fig>
<p>We also tested AlignerBoost performance under different mapQ cut-offs for the RNA-seq dataset (<xref ref-type="fig" rid="pcbi.1005096.g004">Fig 4</xref>). As expected, AlignerBoost achieves 1‚Äì2 orders of magnitude smaller FDR without significantly losing (sometimes even strongly gaining) mapping sensitivity, which is even true for the PE-reads (<xref ref-type="fig" rid="pcbi.1005096.g004">Fig 4B</xref>). Notably by using AlignerBoost, the overall mapping quality (regarding sensitivity and FDR) of the DNA-seq aligners is comparable to the dedicated RNA-seq aligners, suggesting that it is technically practical to use DNA-seq aligners along with AlignerBoost for RNA-seq mapping purposes, especially in cases that reliable annotation of splicing isoforms is not available, and the RNA-seq experiments serve mainly as a Next-Gen approach to determine differential gene expression.</p>
<fig id="pcbi.1005096.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005096.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The mapping sensitivity vs. False Discovery Rate (FDR) curves under different mapping quality (mapQ) cutoffs for the simulated RNA-seq datasets.</title>
<p>The mapQ varies from 0, 3, 6, 10, 13, 20, then in increments of 10 up to the maximum allowed values of the indicated aligner. ‚ÄúDefault‚Äù indicates aligners‚Äô default best hits; ‚ÄúAlignerBoost‚Äù indicates best hits via AlignerBoost mapping and filtering procedures. A: Single-end (SE) mapping; B: Paired-end (PE) mapping.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Real datasets</title>
<p>Real experimental NGS datasets are much more complicated than simulated datasets; besides sequencing error, incorrect mapping could be caused by SNP, CNV, chromosome rearrangement, RNA modification/editing, etc. It is very difficult to judge the effects of these elements on mapping due to a lack of "gold-standard" datasets. As a first effort, we selected public exome-sequencing (exome-seq) datasets from NCBI SRA, which utilized 4 widely-used commercial target-enrichment kits, namely Agilent SureSelect v4.0, Agilent Haloplex V3, NimbleGen SeqCap EZ v3.0, and Illumina TruSeq Exome (abbreviated hereafter to SureSelect, Haloplex, SeqCap EZ, TruSeq, respectively), all of which are paired-end datasets. These kits are designed to selectively purify pre-defined coding genomic regions (exome) that cover ~51.2 Mb, ~105.8 Mb, ~64.2 Mb and ~62.1 Mb of the human genome, respectively. They therefore provide a decent proxy for determining "correct mapping" of NGS reads. To be specific, a "correctly mapped" read is defined when its mapped locus overlaps to any of the designed capture regions.</p>
<p>We randomly down-sampled all 4 exome-seq datasets to 10 million reads and generated pseudo SE-datasets by dropping all reverse reads. These real datasets exhibit a very similar quality pattern as our simulated dataset (<xref ref-type="supplementary-material" rid="pcbi.1005096.s010">S2 Fig</xref>). We tested them similarly as described for the simulated datasets; note that all mappings were performed using the Bowtie2 aligner due to its superior performance in conjunction with AlignerBoost as shown in the simulated results. Since the exact true loci of these reads are unknown, we evaluated the total coverage depth of designed capture regions instead of mapping sensitivity, and the mapping precision should be treated as estimation. In general the result is very similar to the simulated datasets: if just considering the best hits without any mapQ restriction, AlignerBoost strongly increases the precision without significant loss or even gain of mapping sensitivity, while toward the extreme mapQ cutoffs, AlignerBoost achieves a noticeably lower FDR rate with increased sensitivity (<xref ref-type="fig" rid="pcbi.1005096.g005">Fig 5</xref>). A very similar overall mapping performance improvement is observed for both SE and PE reads (<xref ref-type="fig" rid="pcbi.1005096.g005">Fig 5A and 5B</xref>). This fact holds true when we switched to the BWA (BWA-MEM) aligner (<xref ref-type="supplementary-material" rid="pcbi.1005096.s011">S3 Fig</xref>), indicating the observed performance improvement is not specific to a particular aligner. Notably, even with AlignerBoost filtering, the highest achieved precision was usually &lt;90% (FDR &gt; 0.1) except for the Agilent Haloplex platform; this is potentially caused by non-specific binding between synthesized probes and target DNAs (i.e. binding to pseudogenes/repeats), and exaggerated by the possibility that flanking sequences of target regions were pulled down during capture but after random fragmentation did not overlap capture regions. In fact, the estimated mapping precisions are in agreement with previous studies [<xref ref-type="bibr" rid="pcbi.1005096.ref020">20</xref>], though our results have consistently higher precision.</p>
<fig id="pcbi.1005096.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005096.g005</object-id>
<label>Fig 5</label>
<caption>
<title>The estimated mapping sensitivity vs. False Discovery Rate (FDR) curves under different mapping quality (mapQ) cutoffs for the real exome-seq datasets.</title>
<p>All mappings were performed using Bowtie2. Mapping sensitivity is approximated by the read depth in capture regions. The mapQ varies from 0, 3, 6, 10, 13, 20, then in increments of 10 up to the maximum allowed values of the indicated aligner. ‚ÄúDefault‚Äù indicates aligners‚Äô default best hits; ‚ÄúAlignerBoost‚Äù indicates best hits via AlignerBoost mapping and filtering procedures. A: Single-end (SE) mapping; B: Paired-end (PE) mapping.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.g005" xlink:type="simple"/>
</fig>
<p>As discussed above, genetic variation could affect the mapping quality of NGS reads. To test this, we provided the Hap-Map phase 3 (HapMap3) or 1000genomes (1000G) SNPs to AlignerBoost to re-analyze the exome-seq datasets. Not surprisingly, there were only subtle gains of mapping precision when providing AlignerBoost with known SNPs (<xref ref-type="supplementary-material" rid="pcbi.1005096.s007">S7 Table</xref>), since only a very small proportion (2~3%) of reads contained any known SNPs. Interestingly, the overall coverage depth of target regions was also slightly increased when known SNPs were incorporated, giving AlignerBoost an additional advantage in detecting and confirming genetic variants near highly variable regions in the genomes.</p>
<p>A recent option for RNA-seq studies is to apply target enrichment similar to that of exome-seq [<xref ref-type="bibr" rid="pcbi.1005096.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1005096.ref022">22</xref>] experiments. This new approach, termed Capture-seq, gives us an opportunity to closely examine the effect of AlignerBoost in RNA-seq studies. We compared the AlignerBoost filtered vs. default alignments for 10 public Capture-seq libraries from human tissues and cells, and found a profound reduction of the FDR, although the overall read depth of designed capture regions moderately suffered (<xref ref-type="fig" rid="pcbi.1005096.g006">Fig 6A and 6B</xref>).</p>
<fig id="pcbi.1005096.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005096.g006</object-id>
<label>Fig 6</label>
<caption>
<title>The estimated mapping sensitivity vs. False Discovery Rate (FDR) curves under different mapping quality (mapQ) cutoffs for the real capture-seq datasets.</title>
<p>All mappings were performed using STAR. Mapping sensitivity is approximated by the read depth in capture regions. The mapQ varies from 0, 3, 6, 10, 13, 20, then in increments of 10 up to the maximum allowed values of the indicated aligner. ‚ÄúDefault‚Äù indicates aligners‚Äô default best hits; ‚ÄúAlignerBoost‚Äù indicates best hits via AlignerBoost mapping and filtering procedures. A: Single-end (SE) mapping; B: Paired-end (PE) mapping. Replicate samples have same point types but different line types.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.g006" xlink:type="simple"/>
</fig>
<p>As discussed above, it is usually more difficult to estimate the mapping accuracy for RNA-seq data, mainly due to the potential spatial separation between capturing probes and sequencing reads by the presence of large introns. We therefore further evaluated the general effect of AlignerBoost on gene expression profiling using the Capture-seq libraries by comparing the normalized transcript expression (in Read per Kb per Million or RPKM) on a gold standard coding mRNA dataset (coding gene) as well as a pseudogene dataset (pseudogene) with or without using AlignerBoost. Not surprisingly, compared to the default results, AlignerBoost consistently increased gene expression of the coding genes, where the pseudogene expression is decreased globally (<xref ref-type="fig" rid="pcbi.1005096.g007">Fig 7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005096.s012">S4 Fig</xref>), especially for SE mapping (all p-values &lt; 0.01 for both replicates, paired t-tests). These results strongly indicate improved mapping accuracy of real datasets, given that gold standard coding genes are more likely to be expressed than the pseudogenes in the tissues and cells we tested.</p>
<fig id="pcbi.1005096.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005096.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Gene expression differences between AlignerBoost filtered or ‚Äúdefault ‚Äúbest alignments for two replicate Capture-seq datasets from human brain tissues.</title>
<p>Gene expression is represented by RPKM values. Coding gene (red) and pseudogene (blue) annotations are from GENCODE project (v19). Values in parentheses show the mean gene expression changes of the two replicates. A: Single-end (SE) mapping; B: Paired-end (PE) mapping.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.g007" xlink:type="simple"/>
</fig>
<p>Taken together, AlignerBoost has practical implications in improving mapping accuracy in most reference genome-based NGS projects, thereby enabling more accurate downstream analyses and better interpretation of results.</p>
</sec>
<sec id="sec006">
<title>Comparison to similar tools</title>
<p>AlignerBoost is designed uniquely as <italic>ad hoc</italic> alignment optimization software to improve NGS read mapping precision and overall performance. Although AlignerBoost is not an NGS aligner, several published NGS aligners estimate mapping quality based on similar probabilistic frameworks as AlignerBoost, such as Stampy [<xref ref-type="bibr" rid="pcbi.1005096.ref023">23</xref>] and BatAlign [<xref ref-type="bibr" rid="pcbi.1005096.ref024">24</xref>]. Stampy is a hybrid NGS aligner that first uses BWA to map reads with close representatives in the reference dataset, then maps the remaining reads using a hash based algorithm, in which large indels are treated particularly carefully. BatAlign is an incremental method for accurate read alignment, which integrates two novel strategies called ‚ÄúReverse-Alignment‚Äù and ‚ÄúDeep-scan‚Äù. We compared the AlignerBoost filtered results (with Bowtie2 aligner) of all the simulated DNA-seq datasets to the default mapping results (running options in <xref ref-type="supplementary-material" rid="pcbi.1005096.s001">S1 Table</xref>) of Stampy and BatAlign in a similar way of choosing different mapQ cut-offs (<xref ref-type="fig" rid="pcbi.1005096.g008">Fig 8</xref>). As expected, all three tools performed similarly overall for genome and refExome datasets (<xref ref-type="fig" rid="pcbi.1005096.g008">Fig 8A, 8B, 8E and 8F</xref>). For RMSK datasets, AlignerBoost clearly exhibits the overall best performance (<xref ref-type="fig" rid="pcbi.1005096.g008">Fig 8D and 8H</xref>); for pseudogene datasets, Stampy performed best overall, while AlignerBoost reached the same level of low FDR but with relatively lower sensitivity (<xref ref-type="fig" rid="pcbi.1005096.g008">Fig 8C and 8G</xref>). This result suggests that for pseudogene datasets the true mapping loci are often missed by the BWT (Burrows‚ÄìWheeler transform) algorithm-based aligners tested in this study, while hash-based algorithms (such as Stampy) are more sensitive. However, a disadvantage of hash-index based NGS aligners, including Stampy, is that processing speeds are usually much slower [<xref ref-type="bibr" rid="pcbi.1005096.ref023">23</xref>].</p>
<fig id="pcbi.1005096.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005096.g008</object-id>
<label>Fig 8</label>
<caption>
<title>The mapping sensitivity vs. False Discovery Rate (FDR) curves under different mapping quality (mapQ) cutoffs for the simulated DNA-seq datasets using AlignerBoost and similar tools.</title>
<p>The mapQ varies from 0, 3, 6, 10, 13, 20, then in increments of 10 up to the maximum allowed values of the indicated aligner. Different tools are labelled with different line points. AlignerBoost is used with Bowtie2 aligner. A-D: Single-end (SE) mapping; E-H: Paired-end (PE) mapping; A/E: Genome, B/F: RefExome, C/G: Pseudogene, D/H: RMSK.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.g008" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>Discussion</title>
<p>Increasing throughput and decreasing costs of employing NGS platforms for various genome-wide experimental applications have made fast and accurate mapping of NGS reads to reference genomes an imperative need. Though ultra-fast speed has been achieved in many state-of-art NGS aligners, rarely have there been attempts to improve the mapping quality in terms of precision and sensitivity. Here, we developed a generalized software toolkit, AlignerBoost, which we show dramatically boosts the mapping precision for most modern NGS aligners while maintaining a similar level of sensitivity. AlignerBoost works for almost any experimental design requiring alignment to reference genomes, but has the greatest advantage for NGS libraries with a considerable proportion of repetitive reads, such as pseudogenes, transposons and paralog gene families that are usually contributing more than half of higher eukaryotic genomes. AlignerBoost supports numerous customizable mapping parameters and users can expect up to 100% mapping precision in most cases if parameters are correctly chosen. The fact that pure pseudogene or RMSK datasets can achieve up to 98% mapping precision makes it practical to interrogate these ‚Äúdark matter‚Äù genomic regions with good confidence when using AlignerBoost with relatively short NGS reads. AlignerBoost is also able to greatly increase the mapping precision and sensitivity simultaneously for RNA-seq datasets regardless of whether a dedicated RNA-seq aligner is used or not, making it especially useful when mapping RNA reads to a poorly annotated genome. Furthermore, the ability to estimate the true "inserts" by "1DP" function of AlignerBoost makes it particularly promising for mapping NGS reads with non-genome fragments, which could result from untrimmed adapters/barcodes, RNA modification, exon/intron boundaries or chimeric reads. At last, we speculate that AlignerBoost will become a powerful tool for identification of disease-associated mutations and variations in the near future, when personalized SNP and variation data will be available that can be utilized by AlignerBoost to generate extremely high quality alignments.</p>
</sec>
<sec id="sec008" sec-type="materials|methods">
<title>Methods</title>
<p>AlignerBoost first generates executable scripts that call external NGS aligners in multiple-mapping enabled mode. To achieve optimal sensitivity, AlignerBoost also performs optional pre-processing procedures such as quality-control (QC), adapter trimming, non-redundant tag reduction and provides sequence statistic summaries. All of these pre-processing and mapping steps are governed by tunable options, which are specified by a single user-provided configuration file, and support many major NGS aligners (<xref ref-type="supplementary-material" rid="pcbi.1005096.s008">S8 Table</xref>). The executable scripts generate standard SAM/BAM alignment files that contain all potential alignments (multiple-mapping enabled) for every read.</p>
<sec id="sec009">
<title>Mapping quality of single-end reads</title>
<p>The core function of AlignerBoost is to estimate the mapping quality (<italic>mapQ</italic>) of an alignment between an NGS read and a reference genome, given all potential alignments (multiple mapping) of that read. In this application, the <italic>mapQ</italic> is the phred-scaled posterior probability of a mapping given all potential alignments, defined as:
<disp-formula id="pcbi.1005096.e001">
<alternatives>
<graphic id="pcbi.1005096.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>‚àí</mml:mo><mml:mn>10</mml:mn><mml:mo>√ó</mml:mo><mml:mtext>lg</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>‚àí</mml:mo><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Œë</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
where <italic>map</italic><sub><italic>i</italic></sub> and <italic>A</italic> is the i<sup>th</sup> mapping/alignment and all potential alignments for this read, respectively. AlignerBoost uses a simple Bayesian method to calculate the posterior probability by determining the likelihood of all potential alignments, as:
<disp-formula id="pcbi.1005096.e002">
<alternatives>
<graphic id="pcbi.1005096.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Œë</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle displaystyle="true" mathsize="140%"><mml:munder><mml:mo>‚àë</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>‚àà</mml:mo><mml:mo>Œë</mml:mo></mml:mrow></mml:munder></mml:mstyle><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>Àú</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
where <italic>L</italic><sub><italic>i</italic></sub> is the alignment length, Pr(<italic>align</italic><sub><italic>i</italic></sub> | <italic>loc</italic><sub><italic>i</italic></sub>) is the alignment likelihood for this locus, and <inline-formula id="pcbi.1005096.e003"><alternatives><graphic id="pcbi.1005096.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>Àú</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the normalization constant. Note that we use the widely-accepted prior probability of a mapping from any given locus which is proportional to its alignment length as Pr(<italic>loc</italic><sub><italic>i</italic></sub>) = <italic>L</italic><sub><italic>i</italic></sub> / <italic>L</italic><sub><italic>G</italic></sub> where <italic>L</italic><sub><italic>G</italic></sub> is the effective genome size. The alignment likelihood above is calculated in log10-scale, as:
<disp-formula id="pcbi.1005096.e004">
<alternatives>
<graphic id="pcbi.1005096.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>lgPr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>‚àë</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mtext>lgPr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>‚àë</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:mtext>lg</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>‚àí</mml:mo><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>match</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>mismatch</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>gap-open</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>gap-ext</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>soft-clip</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>hard-clip</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>N¬†or¬†P</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where <italic>A</italic><sub><italic>ij</italic></sub> and <italic>Q</italic><sub><italic>ij</italic></sub> is the <italic>j</italic><sup><italic>th</italic></sup> aligned position and base quality score (in phred scale) of the alignment, <inline-formula id="pcbi.1005096.e005"><alternatives><graphic id="pcbi.1005096.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the estimated base quality of the (unobserved) hard-clipped bases, <italic>Œ≥</italic><sub><italic>o</italic></sub>, <italic>Œ≥</italic><sub><italic>e</italic></sub>, <italic>Œ≥</italic><sub><italic>s</italic></sub>, <italic>Œ≥</italic><sub><italic>h</italic></sub> are the penalty scores for each alignment status, and <italic>s</italic> is the phredscore scaling factor (always -10 here). The <italic>Q2P</italic>(.) is a simple function for converting a phred-scale quality score back to the error probability as:
<disp-formula id="pcbi.1005096.e006">
<alternatives>
<graphic id="pcbi.1005096.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mrow><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>‚àí</mml:mo><mml:mi>q</mml:mi><mml:mo>/</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
Practically the <inline-formula id="pcbi.1005096.e007"><alternatives><graphic id="pcbi.1005096.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> was estimated using the average base quality of a small region immediately adjacent to the hard-clipped bases. Note that alignment positions with <italic>N</italic> (intron) or <italic>P</italic> (padding) status are ignored. The penalty scores used above can be considered the relative occurring chance of each status compared to a mismatch in the unit of log10 scale, and can be controlled in the configuration files.</p>
</sec>
<sec id="sec010">
<title>Mapping quality of paired-end reads</title>
<p>For paired-end read alignments, the likelihood of each mate of a paired alignment is calculated independently as <xref ref-type="disp-formula" rid="pcbi.1005096.e004">Eq (3)</xref>; however the posterior probability of a mapping pair is calculated jointly, as
<disp-formula id="pcbi.1005096.e008">
<alternatives>
<graphic id="pcbi.1005096.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Œ°</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle displaystyle="true" mathsize="140%"><mml:munder><mml:mo>‚àë</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>‚àà</mml:mo><mml:mo>Œ°</mml:mo></mml:mrow></mml:munder></mml:mstyle><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>Àú</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>L</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>L</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mtext>Pr</mml:mtext></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
where <italic>fwd</italic> and <italic>rev</italic> stand for forward and reverse mate of the pair, respectively, and <inline-formula id="pcbi.1005096.e009"><alternatives><graphic id="pcbi.1005096.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mrow><mml:mtext>Pr</mml:mtext></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the pairing probability between read mates. In practice, the pairing probability is calculated either as the Gaussian probability density of given mate distance <inline-formula id="pcbi.1005096.e010"><alternatives><graphic id="pcbi.1005096.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msub><mml:mrow><mml:mtext>Pr</mml:mtext></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>œÜ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>Œº</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>œÉ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>Œº</italic> and <italic>œÉ</italic><sup><italic>2</italic></sup> are the estimated mean and standard deviation of the fragment size between the forward and reverse mates, if they can be reliably estimated, or as a constant if not (i.e. for RNA-seq reads with introns between read mates). It is of note that if one mate of a pair is missing (due to discordant distance, sequencing error, or other reasons), <xref ref-type="disp-formula" rid="pcbi.1005096.e008">function (5)</xref> is still used but the entire missing mate is treated as if every base is "soft-masked". This treatment tends to prevent biased mapping qualities when paired-end and unpaired alignments co-exist for certain reads, so the unpaired alignments will not always be preferred over paired alignments.</p>
</sec>
<sec id="sec011">
<title>Incorporation of known variations</title>
<p>To accommodate known variants including single nucleotide polymorphism (SNP), indels and multiple nucleotide polymorphism (MNP), AlignerBoost can read in pre-defined variation information from standard VCF/gVCF files, and uses a slightly modified method to calculate the mapping qualities for enhanced accuracy. To be specific, the likelihood of an alignment is calculated either by <xref ref-type="disp-formula" rid="pcbi.1005096.e004">function (3)</xref> or its enhanced version below:
<disp-formula id="pcbi.1005096.e011">
<alternatives>
<graphic id="pcbi.1005096.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e011" xlink:type="simple"/>
<mml:math display="block" id="M11">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>lgPr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>‚àë</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mtext>lgPr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>‚àë</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:mtext>lg</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>‚àí</mml:mo><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>match</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>mismatch</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>gap-open</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>gap-ext</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>soft-clip</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¬Ø</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>hard-clip</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>N¬†or¬†P</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>known¬†SNP</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>known¬†indel</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>known¬†MNP</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
where the biological explanation of the penalty-scores <italic>Œ≥</italic><sub><italic>v</italic></sub>, <italic>Œ≥</italic><sub><italic>g</italic></sub>, and <italic>Œ≥</italic><sub><italic>b</italic></sub> are similar as in <xref ref-type="disp-formula" rid="pcbi.1005096.e004">Eq (3)</xref> for each indicated known variation types (see <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/books/NBK44447/" xlink:type="simple">http://www.ncbi.nlm.nih.gov/books/NBK44447/</ext-link> for their detailed definitions), and their default values can be controlled in the user-specified configuration files. For variations with allelic frequency (<italic>AF</italic>) available, AlignerBoost estimates these penalty-scores as
<disp-formula id="pcbi.1005096.e012">
<alternatives>
<graphic id="pcbi.1005096.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:mrow><mml:mi>Œ≥</mml:mi><mml:mo>=</mml:mo><mml:mo>‚àí</mml:mo><mml:mtext>lg</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
where <italic>AF</italic><sub><italic>alt</italic></sub> is the allele frequency of the observed alternate allele from the alignment. Then the largest value of the likelihood calculated by Eqs (<xref ref-type="disp-formula" rid="pcbi.1005096.e004">3</xref>) or (<xref ref-type="disp-formula" rid="pcbi.1005096.e011">6</xref>) calculated for each known SNP is used for subsequent <italic>mapQ</italic> calculation; this assumes the SNPs are independent if multiple ones are found in a same alignment, which is believed to be almost always true due to the low frequency of common SNPs and relative small NGS read size.</p>
</sec>
<sec id="sec012">
<title>Determining the actual insert range</title>
<p>To re-estimate the actual DNA fragment (insert) range given an alignment, a one-dimensional dynamic programming (1DP) algorithm is implemented to find the insert range that maximizes an insert score <italic>S</italic>; the recurrence relation of <italic>S</italic> is:
<disp-formula id="pcbi.1005096.e013">
<alternatives>
<graphic id="pcbi.1005096.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e013" xlink:type="simple"/>
<mml:math display="block" id="M13">
<mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>‚Ä¶</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
Similar to <xref ref-type="disp-formula" rid="pcbi.1005096.e004">Eq (3)</xref>, <italic>A</italic><sub><italic>i</italic></sub> is defined as the alignment score at position <italic>i</italic> as:
<disp-formula id="pcbi.1005096.e014">
<alternatives>
<graphic id="pcbi.1005096.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005096.e014" xlink:type="simple"/>
<mml:math display="block" id="M14">
<mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>match</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>¬†mismatch</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>gap-open</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mtext>¬†</mml:mtext><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>¬†gap-ext</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>¬†soft-clip</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mo>‚àí</mml:mo><mml:msub><mml:mi>Œ≥</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>¬†hard-clip</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>N¬†or¬†P</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
where <italic>a</italic><sub><italic>m</italic></sub> and <italic>a</italic><sub><italic>x</italic></sub> have similar biological explanations as the other penalty scores described above. The mismatch and indel information is extracted from the "Cigar" elements and "MD:Z" mismatch tags from the SAM/BAM alignment records, if available.</p>
</sec>
<sec id="sec013">
<title>Other utility functions</title>
<p>Besides the core function of generating and filtering high quality alignments, AlignerBoost also includes many other utilities designed to fit various needs for end users, such as read QC, quick classification for SAM/BAM, BED, VCF files, and conversion from SAM/BAM files to Wig and various coverage files. The complete list of these functions can be found on the website.</p>
</sec>
<sec id="sec014">
<title>Implementations</title>
<p>AlignerBoost is implemented in pure Java as a unified program, similar to the latest Picard tools or GATK tools [<xref ref-type="bibr" rid="pcbi.1005096.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005096.ref026">26</xref>]. For SAM/BAM file manipulations and VCF file processing, Htslib JDK from Picard tools is used and packed along with the AlignerBoost executable file. It is of note that during the 1DP process, the "Cigar" elements and "MD:Z" mismatch tags are modified to maintain the correctness of the SAM records; therefore AlignerBoost filtered alignments are ready-to-use for further analysis such as variation calls. Besides, AlignerBoost retains many mapping quality metrics such as mismatch and indel numbers and alignment likelihood as customized tags in the output BAM files. Please refer to the AlignerBoost website for a complete list of these customized tags.</p>
</sec>
<sec id="sec015">
<title>Performance</title>
<p>The core function of AlignerBoost is to calculate the posterior mapping probability (mapQ) of an alignment using formulas (<xref ref-type="disp-formula" rid="pcbi.1005096.e002">2</xref>), (<xref ref-type="disp-formula" rid="pcbi.1005096.e004">3</xref>), (<xref ref-type="disp-formula" rid="pcbi.1005096.e008">5</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005096.e011">6</xref>), which is in linear time complexity regarding the alignment length. The additional time and space complexity for 1DP estimation of insert range is also linear. Therefore, the overall performance of AlignerBoost is fast. In our benchmark tests, AlignerBoost can process 1 million alignments (from the total genome dataset) in 27.9 and 25.8 seconds for 100 bp SE or PE reads, respectively, on a Linux workstation using a single Intel Xeon 3.70 GHz core. These numbers are 28.2 and 29.0 seconds if we enable the 1DP function. Finally, we found that the major limitation of AlignerBoost performance is disk IO, so we didn't implement multi-threading, which often offers limited gain of processing speed at the expense of much larger memory footprint.</p>
</sec>
<sec id="sec016">
<title>Accession numbers</title>
<p>The NCBI SRA accession numbers for the Exome-seq datasets are SRR1609896, SRR1573550, SRR1611182 and ERR364421 for the SureSelect, Haloplex, SeqCap EZ and TruSeq enrichment kits, respectively. The SRA accession numbers for the Capture-seq datasets are SRR1576165, SRR1576167, SRR1576146, SRR1576147, SRR1576148, SRR1576149, SRR1576155, SRR1576180, SRR1576152, SRR1576177 for K562 cells, liver, lung, ovary, brain respectively, each with 2 replicates. The expression abundance (in RPKM) for all capture-seq datasets were calculated by the featureCounts program [<xref ref-type="bibr" rid="pcbi.1005096.ref027">27</xref>]. Coding gene and pseudogene annotations are downloaded from GENCODE project (v19, <ext-link ext-link-type="uri" xlink:href="http://www.gencodegenes.org/" xlink:type="simple">http://www.gencodegenes.org/</ext-link>), and only those overlapping with the designed capturing regions are used.</p>
</sec>
</sec>
<sec id="sec017">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005096.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Running options used for testing the default output of datasets.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005096.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s002" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Parameters for generating simulated NGS datasets.</title>
<p>SD: standard deviation.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005096.s003" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s003" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Mapping sensitivity and precision of simulated DNA-seq single-end (SE) datasets by picking ‚Äúbest‚Äù hits with or without applying AlignerBoost procedures.</title>
<p>AlignerBoost: AlignerBoost filtered best hits; Default: ‚Äúdefault‚Äù best hits.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005096.s004" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s004" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Mapping sensitivity and precision of simulated DNA-seq paired-end (PE) datasets by picking ‚Äúbest‚Äù hits with or without applying AlignerBoost procedures.</title>
<p>AlignerBoost: AlignerBoost filtered best hits; Default: ‚Äúdefault‚Äù best hits. (1) NA values are for NGS aligners that don‚Äôt support reporting all alignments under PE mode, thus AlignerBoost filtering was ineffective.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005096.s005" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s005" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>Mapping sensitivity and precision of simulated RNA-seq single-end (SE) datasets by picking ‚Äúbest‚Äù hits with or without applying AlignerBoost procedures.</title>
<p>(1) DNA-seq aligner without local alignment ability, so 1DP function of AlingerBoost was enabled; (2) DNA-seq aligners; (3) RNA-seq aligners.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005096.s006" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s006" xlink:type="simple">
<label>S6 Table</label>
<caption>
<title>Mapping sensitivity and precision of simulated RNA-seq paired-end (PE) datasets by picking ‚Äúbest‚Äù hits with or without applying AlignerBoost procedures.</title>
<p>(1) DNA-seq aligner without local alignment ability, so 1DP function of AlingerBoost was enabled; (2) DNA-seq aligners; (3) RNA-seq aligners; (4) NA values are for NGS aligners that don‚Äôt support reporting all alignments under PE mode, thus AlignerBoost filtering was ineffective.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005096.s007" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s007" xlink:type="simple">
<label>S7 Table</label>
<caption>
<title>Comparison of mapping precision and sensitivity of real exome-seq datasets by incorporating known SNP information for AlignerBoost.</title>
<p>Both HapMap phase3 (HapMap3) and 1000genomes (1000G) datasets were downloaded from GATK FTP bundles. All statistics are based on best hits without mapQ cutoff.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005096.s008" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s008" xlink:type="simple">
<label>S8 Table</label>
<caption>
<title>NGS aligners currently supported by AlignerBoost.</title>
<p>Note that AlignerBoost supports filtering customized SAM/BAM alignment files produced by ANY NGS aligners. However, for the aligners listed below, AlignerBoost supports automatic generation of executable scripts with fine tuned options aiming to boost both the precision and sensitivity of the alignments. BWT: Burrows‚ÄìWheeler transform algorithm.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005096.s009" mimetype="application/jpeg" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s009" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Distributions of simulated read qualities of the DNA-seq reads using the "Genome" dataset as an example.</title>
<p>Y-axes indicate the read quality scores in Phred-scale; X-axes indicate the base-pair positions with positive and negative values representing forward and reverse read positions, respectively; Center solid lines: mean values of the quality scores at corresponding positions; shaded areas between dashed lines: mean ¬± SD (standard deviation) of the quality scores at corresponding positions; all quality scores were drawn from truncated Gaussian distributions. A: Quality score distributions for the simulated SE-dataset; B: Quality score distributions for the simulated PE-dataset.</p>
<p>(JPG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005096.s010" mimetype="application/jpeg" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s010" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Distributions of simulated read qualities using the "SureSelect" dataset as an example (SRA accession SRR1609896).</title>
<p>Y-axes indicate the read quality scores in Phred-scale; X-axes indicate the base-pair positions with positive and negative values representing forward and reverse read positions, respectively; Center solid lines: mean values of the quality scores at corresponding positions; shaded areas between dashed lines: mean ¬± SD (standard deviation) of the quality scores at corresponding positions.</p>
<p>(JPG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005096.s011" mimetype="application/jpeg" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s011" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>The mapping sensitivity vs. False Discovery Rate (FDR) curves under different mapping quality (mapQ) cutoffs for the real exome-seq single-end (SE) dataset.</title>
<p>All mappings were performed using BWA-MEM (BWA). The mapQ varies from 0, 3, 6, 10, 13, 20, then in increments of 10 up to the maximum allowed values of the indicated aligner. ‚ÄúDefault‚Äù indicates aligners‚Äô default best hits; ‚ÄúAlignerBoost‚Äù indicates best hits via AlignerBoost mapping and filtering procedures.</p>
<p>(JPG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005096.s012" mimetype="application/jpeg" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005096.s012" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Gene expression differences between AlignerBoost filtered or ‚Äúdefault ‚Äúbest alignments for replicated capture-seq datasets from human cells and tissues.</title>
<p>Gene expression represented by RPKM values. Coding gene and pseudogene annotations are from GENCODE project (v19). Values in parentheses show the average gene expression changes of the two replicates. A-B, C-D, E-F, G-H show the results for the SE or PE mapping for human K562 cells, liver, lung and ovary tissue, respectively.</p>
<p>(JPG)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank members of the Grice laboratory for their valuable input and discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005096.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ruan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>. <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>. <source>Genome research</source>. <year>2008</year>;<volume>18</volume>(<issue>11</issue>):<fpage>1851</fpage>‚Äì<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.078212.108" xlink:type="simple">10.1101/gr.078212.108</ext-link></comment> <object-id pub-id-type="pmid">18714091</object-id>; PubMed Central PMCID: PMC2577856.</mixed-citation></ref>
<ref id="pcbi.1005096.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hach</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Sarrafi</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Hormozdiari</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Alkan</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Eichler</surname> <given-names>EE</given-names></name>, <name name-style="western"><surname>Sahinalp</surname> <given-names>SC</given-names></name>. <article-title>mrsFAST-Ultra: a compact, SNP-aware mapper for high performance sequencing applications</article-title>. <source>Nucleic acids research</source>. <year>2014</year>;<volume>42</volume>(<issue>Web Server issue</issue>):<fpage>W494</fpage>‚Äì<lpage>500</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gku370" xlink:type="simple">10.1093/nar/gku370</ext-link></comment> <object-id pub-id-type="pmid">24810850</object-id>; PubMed Central PMCID: PMC4086126.</mixed-citation></ref>
<ref id="pcbi.1005096.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gontarz</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wong</surname> <given-names>CF</given-names></name>. <article-title>SRmapper: a fast and sensitive genome-hashing alignment tool</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>3</issue>):<fpage>316</fpage>‚Äì<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts712" xlink:type="simple">10.1093/bioinformatics/bts712</ext-link></comment> <object-id pub-id-type="pmid">23267171</object-id>.</mixed-citation></ref>
<ref id="pcbi.1005096.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Nacu</surname> <given-names>S</given-names></name>. <article-title>Fast and SNP-tolerant detection of complex variants and splicing in short reads</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>7</issue>):<fpage>873</fpage>‚Äì<lpage>81</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq057" xlink:type="simple">10.1093/bioinformatics/btq057</ext-link></comment> <object-id pub-id-type="pmid">20147302</object-id>; PubMed Central PMCID: PMC2844994.</mixed-citation></ref>
<ref id="pcbi.1005096.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mu</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kiani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mohiyuddin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bani Asadi</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wong</surname> <given-names>WH</given-names></name>. <article-title>Fast and accurate read alignment for resequencing</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>18</issue>):<fpage>2366</fpage>‚Äì<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts450" xlink:type="simple">10.1093/bioinformatics/bts450</ext-link></comment> <object-id pub-id-type="pmid">22811546</object-id>; PubMed Central PMCID: PMCPMC3436849.</mixed-citation></ref>
<ref id="pcbi.1005096.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Langmead</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pop</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name>. <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome biology</source>. <year>2009</year>;<volume>10</volume>(<issue>3</issue>):<fpage>R25</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2009-10-3-r25" xlink:type="simple">10.1186/gb-2009-10-3-r25</ext-link></comment> <object-id pub-id-type="pmid">19261174</object-id>; PubMed Central PMCID: PMC2690996.</mixed-citation></ref>
<ref id="pcbi.1005096.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Langmead</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name>. <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nature methods</source>. <year>2012</year>;<volume>9</volume>(<issue>4</issue>):<fpage>357</fpage>‚Äì<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1923" xlink:type="simple">10.1038/nmeth.1923</ext-link></comment> <object-id pub-id-type="pmid">22388286</object-id>; PubMed Central PMCID: PMC3322381.</mixed-citation></ref>
<ref id="pcbi.1005096.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>. <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>14</issue>):<fpage>1754</fpage>‚Äì<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp324" xlink:type="simple">10.1093/bioinformatics/btp324</ext-link></comment> <object-id pub-id-type="pmid">19451168</object-id>; PubMed Central PMCID: PMC2705234.</mixed-citation></ref>
<ref id="pcbi.1005096.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>. <article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>5</issue>):<fpage>589</fpage>‚Äì<lpage>95</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp698" xlink:type="simple">10.1093/bioinformatics/btp698</ext-link></comment> <object-id pub-id-type="pmid">20080505</object-id>; PubMed Central PMCID: PMC2828108.</mixed-citation></ref>
<ref id="pcbi.1005096.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lam</surname> <given-names>TW</given-names></name>, <name name-style="western"><surname>Yiu</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Kristiansen</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>SOAP2: an improved ultrafast tool for short read alignment</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>15</issue>):<fpage>1966</fpage>‚Äì<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp336" xlink:type="simple">10.1093/bioinformatics/btp336</ext-link></comment> <object-id pub-id-type="pmid">19497933</object-id>.</mixed-citation></ref>
<ref id="pcbi.1005096.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dobin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Schlesinger</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Drenkow</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zaleski</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Jha</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>1</issue>):<fpage>15</fpage>‚Äì<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts635" xlink:type="simple">10.1093/bioinformatics/bts635</ext-link></comment> <object-id pub-id-type="pmid">23104886</object-id>; PubMed Central PMCID: PMC3530905.</mixed-citation></ref>
<ref id="pcbi.1005096.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Galinsky</surname> <given-names>VL</given-names></name>. <article-title>YOABS: yet other aligner of biological sequences‚Äîan efficient linearly scaling nucleotide aligner</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>8</issue>):<fpage>1070</fpage>‚Äì<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts102" xlink:type="simple">10.1093/bioinformatics/bts102</ext-link></comment> <object-id pub-id-type="pmid">22402614</object-id>.</mixed-citation></ref>
<ref id="pcbi.1005096.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ruffalo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>LaFramboise</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Koyuturk</surname> <given-names>M</given-names></name>. <article-title>Comparative analysis of algorithms for next-generation sequencing read alignment</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>20</issue>):<fpage>2790</fpage>‚Äì<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr477" xlink:type="simple">10.1093/bioinformatics/btr477</ext-link></comment> <object-id pub-id-type="pmid">21856737</object-id>.</mixed-citation></ref>
<ref id="pcbi.1005096.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yoon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Xuan</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Makarov</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Ye</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sebat</surname> <given-names>J</given-names></name>. <article-title>Sensitive and accurate detection of copy number variants using read depth of coverage</article-title>. <source>Genome research</source>. <year>2009</year>;<volume>19</volume>(<issue>9</issue>):<fpage>1586</fpage>‚Äì<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.092981.109" xlink:type="simple">10.1101/gr.092981.109</ext-link></comment> <object-id pub-id-type="pmid">19657104</object-id>; PubMed Central PMCID: PMC2752127.</mixed-citation></ref>
<ref id="pcbi.1005096.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pattnaik</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rao</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Panda</surname> <given-names>B</given-names></name>. <article-title>SInC: an accurate and fast error-model based simulator for SNPs, Indels and CNVs coupled with a read generator for short-read sequence data</article-title>. <source>BMC Bioinformatics</source>. <year>2014</year>;<volume>15</volume>:<fpage>40</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-15-40" xlink:type="simple">10.1186/1471-2105-15-40</ext-link></comment> <object-id pub-id-type="pmid">24495296</object-id>; PubMed Central PMCID: PMCPMC3926339.</mixed-citation></ref>
<ref id="pcbi.1005096.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pratas</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pinho</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Rodrigues</surname> <given-names>JM</given-names></name>. <article-title>XS: a FASTQ read simulator</article-title>. <source>BMC Res Notes</source>. <year>2014</year>;<volume>7</volume>:<fpage>40</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1756-0500-7-40" xlink:type="simple">10.1186/1756-0500-7-40</ext-link></comment> <object-id pub-id-type="pmid">24433564</object-id>; PubMed Central PMCID: PMCPMC3927261.</mixed-citation></ref>
<ref id="pcbi.1005096.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McElroy</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Luciani</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>T</given-names></name>. <article-title>GemSIM: general, error-model based simulator of next-generation sequencing data</article-title>. <source>BMC genomics</source>. <year>2012</year>;<volume>13</volume>:<fpage>74</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-13-74" xlink:type="simple">10.1186/1471-2164-13-74</ext-link></comment> <object-id pub-id-type="pmid">22336055</object-id>; PubMed Central PMCID: PMCPMC3305602.</mixed-citation></ref>
<ref id="pcbi.1005096.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Marth</surname> <given-names>GT</given-names></name>. <article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>4</issue>):<fpage>593</fpage>‚Äì<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr708" xlink:type="simple">10.1093/bioinformatics/btr708</ext-link></comment> <object-id pub-id-type="pmid">22199392</object-id>; PubMed Central PMCID: PMCPMC3278762.</mixed-citation></ref>
<ref id="pcbi.1005096.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pertea</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pimentel</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kelley</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name>. <article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title>. <source>Genome biology</source>. <year>2013</year>;<volume>14</volume>(<issue>4</issue>):<fpage>R36</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2013-14-4-r36" xlink:type="simple">10.1186/gb-2013-14-4-r36</ext-link></comment> <object-id pub-id-type="pmid">23618408</object-id>; PubMed Central PMCID: PMC4053844.</mixed-citation></ref>
<ref id="pcbi.1005096.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chilamakuri</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Lorenz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Madoui</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Vodak</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hovig</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Performance comparison of four exome capture systems for deep sequencing</article-title>. <source>BMC genomics</source>. <year>2014</year>;<volume>15</volume>:<fpage>449</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-15-449" xlink:type="simple">10.1186/1471-2164-15-449</ext-link></comment> <object-id pub-id-type="pmid">24912484</object-id>; PubMed Central PMCID: PMC4092227.</mixed-citation></ref>
<ref id="pcbi.1005096.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Clark</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Mercer</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Bussotti</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Leonardi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Haynes</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Crawford</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Quantitative gene profiling of long noncoding RNAs with targeted RNA sequencing</article-title>. <source>Nature methods</source>. <year>2015</year>;<volume>12</volume>(<issue>4</issue>):<fpage>339</fpage>‚Äì<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3321" xlink:type="simple">10.1038/nmeth.3321</ext-link></comment> <object-id pub-id-type="pmid">25751143</object-id>.</mixed-citation></ref>
<ref id="pcbi.1005096.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mercer</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Andersen</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Brunck</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Haerty</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Crawford</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide discovery of human splicing branchpoints</article-title>. <source>Genome research</source>. <year>2015</year>;<volume>25</volume>(<issue>2</issue>):<fpage>290</fpage>‚Äì<lpage>303</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.182899.114" xlink:type="simple">10.1101/gr.182899.114</ext-link></comment> <object-id pub-id-type="pmid">25561518</object-id>; PubMed Central PMCID: PMCPMC4315302.</mixed-citation></ref>
<ref id="pcbi.1005096.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lunter</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Goodson</surname> <given-names>M</given-names></name>. <article-title>Stampy: a statistical algorithm for sensitive and fast mapping of Illumina sequence reads</article-title>. <source>Genome research</source>. <year>2011</year>;<volume>21</volume>(<issue>6</issue>):<fpage>936</fpage>‚Äì<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.111120.110" xlink:type="simple">10.1101/gr.111120.110</ext-link></comment> <object-id pub-id-type="pmid">20980556</object-id>; PubMed Central PMCID: PMCPMC3106326.</mixed-citation></ref>
<ref id="pcbi.1005096.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lim</surname> <given-names>JQ</given-names></name>, <name name-style="western"><surname>Tennakoon</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Guan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sung</surname> <given-names>WK</given-names></name>. <article-title>BatAlign: an incremental method for accurate alignment of sequencing reads</article-title>. <source>Nucleic acids research</source>. <year>2015</year>;<volume>43</volume>(<issue>16</issue>):<fpage>e107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkv533" xlink:type="simple">10.1093/nar/gkv533</ext-link></comment> <object-id pub-id-type="pmid">26170239</object-id>; PubMed Central PMCID: PMCPMC4652746.</mixed-citation></ref>
<ref id="pcbi.1005096.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McKenna</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hanna</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Banks</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sivachenko</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cibulskis</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kernytsky</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome research</source>. <year>2010</year>;<volume>20</volume>(<issue>9</issue>):<fpage>1297</fpage>‚Äì<lpage>303</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.107524.110" xlink:type="simple">10.1101/gr.107524.110</ext-link></comment> <object-id pub-id-type="pmid">20644199</object-id>; PubMed Central PMCID: PMC2928508.</mixed-citation></ref>
<ref id="pcbi.1005096.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>DePristo</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Banks</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Poplin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Garimella</surname> <given-names>KV</given-names></name>, <name name-style="western"><surname>Maguire</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Hartl</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nature genetics</source>. <year>2011</year>;<volume>43</volume>(<issue>5</issue>):<fpage>491</fpage>‚Äì<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng.806" xlink:type="simple">10.1038/ng.806</ext-link></comment> <object-id pub-id-type="pmid">21478889</object-id>; PubMed Central PMCID: PMC3083463.</mixed-citation></ref>
<ref id="pcbi.1005096.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Smyth</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>W</given-names></name>. <article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>7</issue>):<fpage>923</fpage>‚Äì<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt656" xlink:type="simple">10.1093/bioinformatics/btt656</ext-link></comment> <object-id pub-id-type="pmid">24227677</object-id>.</mixed-citation></ref>
</ref-list>
</back>
</article>