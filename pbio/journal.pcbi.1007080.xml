<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01972</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1007080</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuronal tuning</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Algebra</subject><subj-group><subject>Linear algebra</subject><subj-group><subject>Eigenvalues</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Visual cortex</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Visual cortex</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Propagation of orientation selectivity in a spiking network model of layered primary visual cortex</article-title>
<alt-title alt-title-type="running-head">Propagation of orientation selectivity</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Merkt</surname> <given-names>Benjamin</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Schüßler</surname> <given-names>Friedrich</given-names></name>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3534-6530</contrib-id>
<name name-style="western">
<surname>Rotter</surname> <given-names>Stefan</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Bernstein Center Freiburg, University of Freiburg, Freiburg, Germany</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Faculty of Biology, University of Freiburg, Freiburg, Germany</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Doiron</surname> <given-names>Brent</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Pittsburgh, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">stefan.rotter@bio.uni-freiburg.de</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>7</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>19</day>
<month>7</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>7</issue>
<elocation-id>e1007080</elocation-id>
<history>
<date date-type="received">
<day>21</day>
<month>11</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>2</day>
<month>5</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Merkt et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1007080"/>
<abstract>
<p>Neurons in different layers of sensory cortex generally have different functional properties. But what determines firing rates and tuning properties of neurons in different layers? Orientation selectivity in primary visual cortex (V1) is an interesting case to study these questions. Thalamic projections essentially determine the preferred orientation of neurons that receive direct input. But how is this tuning propagated though layers, and how can selective responses emerge in layers that do not have direct access to the thalamus? Here we combine numerical simulations with mathematical analyses to address this problem. We find that a large-scale network, which just accounts for experimentally measured layer and cell-type specific connection probabilities, yields firing rates and orientation selectivities matching electrophysiological recordings in rodent V1 surprisingly well. Further analysis, however, is complicated by the fact that neuronal responses emerge in a dynamic fashion and cannot be directly inferred from static neuroanatomy, as some connections tend to have unintuitive effects due to recurrent interactions and strong feedback loops. These emergent phenomena can be understood by linearizing and coarse-graining. In fact, we were able to derive a low-dimensional linear dynamical system effectively describing stimulus-driven activity layer by layer. This low-dimensional system explains layer-specific firing rates and orientation tuning by accounting for the different gain factors of the aggregate system. Our theory can also be used to design novel optogenetic stimulation experiments, thus facilitating further exploration of the interplay between connectivity and function.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Understanding the precise roles of neuronal sub-populations in shaping the activity of networks is a fundamental objective of neuroscience research. In complex neuronal network structures like the neocortex, the relation between the connectome and the algorithm implemented in it is often not self-explaining. To this end, our work makes three important contributions. First, we show that the connectivity extracted by anatomical and physiological experiments in visual cortex suffices to explain important properties of the various sub-populations, including their selectivity to visual stimulation. Second, we introduce a novel system-level approach for the analysis of input-output relations of recurrent networks, which leads to the observed activity patterns. Third, we present a method for the design of future optogenetic experiments that can be used to devise specific stimuli resulting in a predictable change of neuronal activity. In summary, we introduce a novel framework to determine the relevant features of neuronal microcircuit function that can be applied to a wide range of neuronal systems.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Seventh Framework Programme (FP7/2007-2013)</institution>
</funding-source>
<award-id>600925</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Merkt</surname> <given-names>Benjamin</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002347</institution-id>
<institution>Bundesministerium für Bildung und Forschung</institution>
</institution-wrap>
</funding-source>
<award-id>BFNT 01GQ0830</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3534-6530</contrib-id>
<name name-style="western">
<surname>Rotter</surname> <given-names>Stefan</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>EXC 1086</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3534-6530</contrib-id>
<name name-style="western">
<surname>Rotter</surname> <given-names>Stefan</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>INST 39/963-1 FUGG</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Merkt</surname> <given-names>Benjamin</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was partially supported by the European Union’s Seventh Framework Programme (FP7/2007-2013) under Grant Agreement 600925 (NeuroSeeker), by the BMBF (grant BFNT 01GQ0830) and DFG (grant EXC 1086). The HPC facilities are funded by the state of Baden-Württemberg through bwHPC and DFG grant INST 39/963-1 FUGG. In addition, our work was promoted by the German Academic Exchange Service (DAAD) and the Carl Zeiss Stiftung. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="3"/>
<page-count count="34"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All data analysis and simulation software files are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/obachtos/layeredOSI" xlink:type="simple">https://github.com/obachtos/layeredOSI</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Understanding the complex computations performed by neural networks in the nervous system is a central challenge in neuroscience. In recent years, research in rodent sensory systems has provided access to many new facts, but has also raised new theoretical questions. In particular, the role of cortical layers [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>] and other distinct subpopulations [<xref ref-type="bibr" rid="pcbi.1007080.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref004">4</xref>] has received increasing attention. While the anatomical path of sensory input from the thalamus through cortical layers has been particularly well characterized for the visual system, it provides little explanation yet how the information is processed and transformed in transit. Here, we apply computational neuroscience techniques to gain new insight into the various computational steps within a highly recurrent neural network.</p>
<p>From a theoretical perspective, the cortical network constitutes a dynamical system, which operates on different types of sensory input. To study basic properties of such networks, its input has been assumed to be identical for all neurons [<xref ref-type="bibr" rid="pcbi.1007080.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref006">6</xref>]. In a sensory system, however, the input varies across neurons, as sensors extract different aspects of the stimulus. The primary visual cortex (V1) represents an interesting example to study such systems [<xref ref-type="bibr" rid="pcbi.1007080.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>]. In this case, non-homogeneous input for example carries information about the orientation of moving gratings or light bars presented to the eye of an animal [<xref ref-type="bibr" rid="pcbi.1007080.ref009">9</xref>].</p>
<p>A major difference of rodent visual cortex compared to carnivores and primates is the absence of orientation columns and maps [<xref ref-type="bibr" rid="pcbi.1007080.ref010">10</xref>]. Although the “salt-and-pepper” organization of orientation preferences implies that lateral interactions are quite unspecific [<xref ref-type="bibr" rid="pcbi.1007080.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref012">12</xref>], neurons nevertheless exhibit responses that are strongly tuned with respect to oriented light bars or gratings [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref013">13</xref>]. Interestingly, this output tuning is already present at eye opening in juvenile mice, where recurrent connectivity appears to be functionally random [<xref ref-type="bibr" rid="pcbi.1007080.ref014">14</xref>]. In recent theoretical studies, this phenomenon could be explained by a strong attenuation of the untuned component of the distributed input, due to the dominance of inhibition in the recurrent network [<xref ref-type="bibr" rid="pcbi.1007080.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1007080.ref017">17</xref>]. While these previous works identified the mechanism underlying strong output tuning in the primary visual cortex of rodents, they provide no explanation for the different degrees of orientation selectivity in different sub-populations, like cortical layers.</p>
<p>In the present work, we apply computational network modeling techniques to study the emergence of orientation selectivity in a layered cortical network model, with a focus on the differences between layers and neuronal subpopulations. As a starting point, we adopt the anatomically and physiologically founded network model developed by Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>] and extend it by orientation selective input similar to Sadeh et al. [<xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>]. We model an experiment in which an animal is shown a sinusoidal grating as a visual stimulus. By this approach, we can focus on the influence of synaptic connectivity on neuronal tuning as all other parameters are chosen to be the same over all populations.</p>
<p>Without any adaptation or fine-tuning of parameters, the resulting model matches the distributions of orientation selectivity found in electrophysiological recordings, including the weak tuning of inhibitory neurons as well as L5 pyramidal neurons. We then show that these specific properties cannot be attributed to any specific projection in the circuit. Rather, it is an emergent network feature of the entire recurrent microcircuit. Furthermore, we suggest a concept for the design of novel optogenetic stimulation experiments. Applying this concept to the V1 cortical microcircuit, we can make specific predictions for the outcome of experiments to manipulate the orientation selectivity of L5 principal cells. The analysis of such experiments can eventually confirm or refute our analysis of the circuit.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>A multiplayer model of primary visual cortex</title>
<p>The network model considered throughout our study is, in essence, the same as the recurrent network model developed by Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>], extended by thalamic input with a weak orientation bias as described in Sadeh et al. [<xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>]. Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>] created a full-scale neural network model, matching as close as possible the nervous tissue underneath 1 mm<sup>2</sup> of neocortex. They incorporated a large set of experimental studies, most prominently the ones by Thomson et al. [<xref ref-type="bibr" rid="pcbi.1007080.ref018">18</xref>] and Binzegger et al. [<xref ref-type="bibr" rid="pcbi.1007080.ref019">19</xref>]. They derived a generic connectivity map between eight populations of neurons situated in four layers (L2/3, L4, L5, L6), one excitatory (e) and one inhibitory (i) population in each layer (see <xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1A</xref> for an illustration of the model). The model network consists of close to 80 000 leaky integrate-and-fire neurons, where the respective size of individual subpopulations varies strongly across layers. While the two largest populations (L4e and L2/3e) contain more than 20 000 neurons, L5e comprizes only about 5 000 neurons (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1D</xref>). Throughout all layers, inhibitory populations are considerably smaller than the respective excitatory populations, by a factor of four on average. In our work, the leaky integrate-and-fire neurons are all equipped with delta synapses, i.e. with each incoming spike, the membrane potential is instantaneously deflected by a fixed voltage <italic>J</italic>, decaying with the membrane time constant <italic>τ</italic>. The synaptic efficacy <italic>J</italic> varies depending on the source and target population, respectively.</p>
<fig id="pcbi.1007080.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Model parameters.</title>
<p><bold>A</bold> Schematic of the model with eight populations in four layers, thalamic and other background input. Triangles and circles denote excitatory and inhibitory populations, respectively. <bold>B</bold> Total number of synapses each neuron receives (in-degree) from any other neuronal population in the model, including input. <bold>C</bold> Input rate variation over stimulus angles for single neurons in L4 and L6. The angle corresponding to the peak of the curve is the preferred orientation of the thalamic input to that neuron. <bold>D</bold> Total number of neurons in each of the eight subpopulations. <bold>E-F</bold> Input in-degree for each neuron in each of the eight populations. Numbers are identical to the two right-most columns of the matrix shown in B.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.g001" xlink:type="simple"/>
</fig>
<p>Our model has a fixed number of synapses for each projection, i.e. each neuron of the postsynaptic population <italic>P</italic> receives the same number of synaptic inputs <italic>K</italic><sub><italic>PT</italic></sub> from the presynaptic population <italic>T</italic>. For any postsynaptic neuron in the target population, the presynaptic neurons are drawn randomly from the source population. The numbers <italic>K</italic><sub><italic>PT</italic></sub>, which are the essential parameters of our model, were derived by Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>] and are graphically represented in <xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1B</xref>.</p>
<p>In addition to recurrent synaptic connections, neurons of the model network receive external input from two different sources (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1A</xref>). The first type of input, termed “background input” throughout this paper, is targeting all populations. It represents axons from other cortical and subcortical regions, including gray matter and white matter projections (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1B/1E</xref>), but excludes those originating from the thalamus. These background inputs are independent of the stimulus. In all simulations, they are modeled as Poisson processes with rate <italic>ν</italic><sub><italic>bg</italic></sub>.</p>
<p>The second type of input is represented by thalamocortical projections that originate from the lateral geniculate nucleus (LGN) (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1B/1F</xref>). In primary visual cortex, these projections are the main source of information about a stimulus. This is the component where we made an important addition to the original model of Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>]. We replaced the unspecific thalamic input with an input that depends in a specific way on the stimulus. Throughout this paper, the stimuli considered were oriented moving gratings, which are commonly used in visual neuroscience. Similar to Sadeh et al. [<xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>], each neuron in one of the two populations that receive input (i.e. L4 and L6) is randomly assigned a preferred orientation <inline-formula id="pcbi.1007080.e001"><alternatives><graphic id="pcbi.1007080.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> to represent the tuning of the effective compound input from all pre-synaptic thalamic neurons. Specifically, the input to each neuron depends on the orientation <italic>θ</italic> of the stimulus and varies according to
<disp-formula id="pcbi.1007080.e002"><alternatives><graphic id="pcbi.1007080.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mi>P</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>ν</mml:mi><mml:mn>0</mml:mn><mml:mtext>th</mml:mtext></mml:msubsup><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mspace width="0.166667em"/><mml:mo form="prefix">cos</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
Here, <inline-formula id="pcbi.1007080.e003"><alternatives><graphic id="pcbi.1007080.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msubsup><mml:mi>K</mml:mi><mml:mi>P</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> is the in-degree of this projection, and <inline-formula id="pcbi.1007080.e004"><alternatives><graphic id="pcbi.1007080.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mi>ν</mml:mi><mml:mn>0</mml:mn><mml:mtext>th</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> is the mean rate of individual thalamic neurons. We only require the compound input to be tuned and do not make any assumptions about the origin of this tuning. An illustration of the input variation is provided in <xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1C</xref>. Note that orientations vary between 0° and 180° as we do not consider direction selectivity in this study. Similar to the background input, the thalamic input was conceived as a homogeneous Poisson process.</p>
<p>It is instructive to analyze and compare two different modes of operation. The <italic>stimulation</italic> condition is the situation described above, emphasizing the presentation of a structured visual stimulus (here, a moving oriented grating) to the animal. In contrast, the <italic>spontaneous</italic> condition emulates the presentation of a homogeneous gray screen to the animal. In this case, the intensity of thalamic inputs is the same as the rate of the background inputs. Moreover, the angular modulation <italic>m</italic> is set to zero, removing any information about stimulus orientation from the input.</p>
</sec>
<sec id="sec004">
<title>Implementations of the model</title>
<p>The results of this study are based on three different approximations of the network model. Each of them makes additional assumptions about the network dynamics to achieve different levels of abstraction and simplification. At the same time, all renderings are based on the same connectivity parameters and the same single neuron model. In the following, the three models will be briefly described.</p>
<sec id="sec005">
<title>Model A: Spiking neuronal network model</title>
<p>The starting point for our analysis is a <italic>spiking neuronal network</italic>, very similar to the implementation by Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>]. Here, for each of the close to 80 000 neurons, the temporal evolution of the membrane potential <italic>V</italic><sub><italic>i</italic></sub>(<italic>t</italic>) is simulated for each neuron <italic>i</italic> using standard numerical methods. The interaction among neurons in the network is mediated by discrete spike events. Each spike emitted by a pre-synaptic neuron depolarizes or hyperpolarizes the membrane potential of the post-synaptic neuron. The output of the recurrent network is defined in terms of the spike trains of all neurons. Like Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>], we use the spiking network simulation tool NEST [<xref ref-type="bibr" rid="pcbi.1007080.ref020">20</xref>] to perform all the necessary numerical simulations.</p>
</sec>
<sec id="sec006">
<title>Model B: Nonlinear firing rate model</title>
<p>Based on the spiking neural network model, we also developed a neuron-by-neuron <italic>firing rate model</italic>, applying the theory developed by Brunel [<xref ref-type="bibr" rid="pcbi.1007080.ref006">6</xref>] to single neurons [<xref ref-type="bibr" rid="pcbi.1007080.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref021">21</xref>]. This approximation assumes that neuronal spike trains have Poissonian statistics and that correlations among neurons are insignificant.</p>
<p>The network is characterized by the input-output transfer function <italic>F</italic><sub><italic>i</italic></sub> of each neuron, leading to the network-level self-consistency equation
<disp-formula id="pcbi.1007080.e005"><alternatives><graphic id="pcbi.1007080.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ν</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>ν</mml:mi><mml:mtext>bg</mml:mtext></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>ν</mml:mi><mml:mtext>th</mml:mtext></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic>i</italic> = 1, …, <italic>N</italic> is the neuron index and <italic>ν</italic>, <italic>ν</italic><sup>bg</sup> and <italic>ν</italic><sup>th</sup> are the vectors of recurrent neuronal firing rates and input rates, respectively. Throughout this work, variables denoted by th and bg refer to quantities originating from the thalamus or other external inputs, respectively. Consequently, the model results in a high-dimensional system of nonlinear algebraic equations to be solved numerically, yielding the firing rate <italic>ν</italic><sub><italic>i</italic></sub> of each individual neuron.</p>
</sec>
<sec id="sec007">
<title>Model C: Linearized network model</title>
<p>Finally, based on Model B, we also derive a <italic>linearized network model</italic> of the microcircuit. Fixing a point of linearization, for any input perturbation Δ<italic>ν</italic><sup>th</sup>, it predicts the perturbation of the single neuron firing rates Δ<italic>ν</italic>. In the linear model, these can be explicitly calculated by
<disp-formula id="pcbi.1007080.e006"><alternatives><graphic id="pcbi.1007080.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mi>B</mml:mi><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msup><mml:mi>ν</mml:mi><mml:mtext>th</mml:mtext></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
The matrices <italic>W</italic> and <italic>B</italic> are given by appropriate partial derivatives of the transfer function (<xref ref-type="disp-formula" rid="pcbi.1007080.e005">Eq 2</xref>). As the linearization point, we choose the activity into which the network settles when thalamic neurons are completely silenced. This choice provides the greatest flexibility in the further analysis. Consequently, with this linearization point, we have Δ<italic>ν</italic><sup>th</sup> = <italic>ν</italic><sup>th</sup> (<xref ref-type="disp-formula" rid="pcbi.1007080.e002">Eq 1</xref>).</p>
<p>The perturbation Δ<italic>ν</italic><sup>th</sup> has different values for the two simulated conditions. In the spontaneous condition, it is given by a homogeneous vector with the compound thalamic baseline rate in all entries. In the stimulated condition, it contains the homogeneous (constant) as well as the non-homogeneous (proportional to <italic>m</italic>) terms in <xref ref-type="disp-formula" rid="pcbi.1007080.e002">Eq 1</xref>. The latter, therefore, also represents the specific, orientation dependent perturbation for each neuron.</p>
<p>While the spiking network model (Model A) is the most realistic version from a biological perspective, accounting for irregular spike trains and activity fluctuations, it is at the same time computationally expensive and analytically intractable. The firing rate model (Model B) makes additional assumptions about the network activity, like negligible correlations, but it has the advantage of being numerically tractable. Finally, while the linear network model (Model C) ignores non-linear effects by construction, it has the great benefit of allowing the application of a powerful linear algebra toolbox and enabling an explicit solution of the system [<xref ref-type="bibr" rid="pcbi.1007080.ref017">17</xref>].</p>
<p>Importantly, considering different implementations of the same model is only justified if their predictions are consistent. Therefore, whenever possible throughout this work, we cross-check the results of the different models.</p>
</sec>
<sec id="sec008">
<title>Parameter variation</title>
<p>In addition to the standard parameter set adopted from Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>], we also performed simulations with crucial model parameters varied. Hereby, we were able to evaluate the robustness of our results, and of the conclusions drawn from them. In total, we used six different parameter sets:
<list list-type="bullet">
<list-item><p><italic>Standard</italic>: Default parameter set described below.</p></list-item>
<list-item><p><italic>High background</italic>: Background firing rate <italic>ν</italic><sup>bg</sup> increased by a factor of 2.</p></list-item>
<list-item><p><italic>Low background</italic>: Background firing rate <italic>ν</italic><sup>bg</sup> reduced by a factor of 2.</p></list-item>
<list-item><p><italic>Strong inhibition</italic>: Relative strength of inhibitory synapses increased by a factor of 2.</p></list-item>
<list-item><p><italic>Strong synapses</italic>: Strength of all recurrent synapses increased by a factor of 2.</p></list-item>
<list-item><p><italic>Low connectivity</italic>: Recurrent indegrees reduced by a factor of 2.</p></list-item>
</list></p>
</sec>
</sec>
<sec id="sec009">
<title>Data analysis</title>
<sec id="sec010">
<title>Measuring orientation selectivity</title>
<p>In order to quantify orientation selectivity, we adopt a measure from circular statistics [<xref ref-type="bibr" rid="pcbi.1007080.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref023">23</xref>]. If <italic>ν</italic><sub><italic>k</italic></sub>(<italic>θ</italic>) is the firing rate of neuron <italic>k</italic> for stimulation angle <italic>θ</italic>, the orientation selectivity vector (OSV) is calculated by
<disp-formula id="pcbi.1007080.e007"><alternatives><graphic id="pcbi.1007080.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>θ</mml:mi></mml:msub><mml:msub><mml:mi>ν</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>θ</mml:mi></mml:msub><mml:msub><mml:mi>ν</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
which yields a complex number, equivalent to a vector with two real components. Here, the two sums are running over all stimulation angles <italic>θ</italic>, or a uniform sample of angles in a simulation. The orientation selectivity index (OSI) is then defined as the length of the OSV
<disp-formula id="pcbi.1007080.e008"><alternatives><graphic id="pcbi.1007080.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
The preferred orientation (PO) of a single neuron can be calculated from the angle of the OSV
<disp-formula id="pcbi.1007080.e009"><alternatives><graphic id="pcbi.1007080.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo form="prefix">arg</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Note that this definition of OSI is identical to
<disp-formula id="pcbi.1007080.e010"><alternatives><graphic id="pcbi.1007080.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>F</italic>0 and <italic>F</italic>1 are the zeroth and first Fourier components of the tuning curve, giving rise to a more intuitive interpretation of the OSI. Here, <italic>F</italic>0 accounts for the average firing rate over all stimulation angles, and <italic>F</italic>1 is to the amplitude of a cosine function accounting for the lowest-order modulation over all angles. A perfect cosine tuning curve as assumed for the input provided by thalamic neurons yields <inline-formula id="pcbi.1007080.e011"><alternatives><graphic id="pcbi.1007080.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>m</italic> is the modulation amplitude of the tuning curve (<xref ref-type="disp-formula" rid="pcbi.1007080.e002">Eq 1</xref>). The OSI as defined here provides a robust measure of tuning strength, in particular for neurons with low firing rates and noisy responses.</p>
<p>An alternative measure for orientation selectivity also used in the literature is based on the neuronal firing rates at the preferred and orthogonal orientation
<disp-formula id="pcbi.1007080.e012"><alternatives><graphic id="pcbi.1007080.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>I</mml:mi><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mn>90</mml:mn><mml:mo>°</mml:mo></mml:msup><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mn>90</mml:mn><mml:mo>°</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
For noisy measurements, in particular for low firing rates, an estimation according to this recipe is problematic. Therefore, we fit a cosine function with offset to the tuning curve of each individual neuron and extract the maximum and minimum firing rates from this fit.</p>
</sec>
<sec id="sec011">
<title>Input currents</title>
<p>Our model uses a simple integrate-and-fire neuron model with delta-synapses. In this model, the mean current received by neuron <italic>i</italic> through synaptic input from neuron <italic>j</italic> is given by
<disp-formula id="pcbi.1007080.e013"><alternatives><graphic id="pcbi.1007080.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
where <inline-formula id="pcbi.1007080.e014"><alternatives><graphic id="pcbi.1007080.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the mean rate of neuron <italic>j</italic>. In order to quantify the information about the stimulus contained in the input current received from any neuron in the network, we also define a tuning vector (TV) of each synaptic connection. For a given pre-synaptic neuron <italic>j</italic> and post-synaptic neuron <italic>i</italic>, it is defined by
<disp-formula id="pcbi.1007080.e015"><alternatives><graphic id="pcbi.1007080.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>TV</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where <inline-formula id="pcbi.1007080.e016"><alternatives><graphic id="pcbi.1007080.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the firing rate of neuron <italic>j</italic> averaged over all angles. Note that this is identical to the first Fourier component (F1) of the tuning curve of the input current. The single neuron tuning vectors TV<sub><italic>ij</italic></sub> can then be used to quantify the combined tuning information each neuron in the network receives from a given source population <italic>P</italic> by calculating
<disp-formula id="pcbi.1007080.e017"><alternatives><graphic id="pcbi.1007080.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mtext>TV</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>K</italic><sub><italic>ij</italic></sub> = 1 if neuron <italic>j</italic> makes a synapse onto neuron <italic>i</italic>, and <italic>K</italic><sub><italic>ij</italic></sub> = 0 otherwise.</p>
</sec>
</sec>
<sec id="sec012">
<title>Detailed model descriptions</title>
<p>In the following, the mathematical model implementations are described in detail. While this documentation allows to fully reproduce the model, it is not essential for the comprehension of the results of the study. In the main text of the manuscript we do not refer to these details, and the reader may choose to directly jump to <bold>Results</bold>.</p>
<sec id="sec013">
<title>Model A: Spiking neural network model</title>
<p>We start by describing the spiking neural network model in detail. To a large extent, it is identical to the original model introduced by Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>]. It consists of <italic>N</italic> = 77 169 neurons distributed over eight populations, one excitatory and one inhibitory population in each out of four layers, respectively (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1A</xref>). The individual population sizes are summarized in <xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1C</xref> and <xref ref-type="table" rid="pcbi.1007080.t001">Table 1</xref>. We use the linear leaky integrate-and-fire neuron model throughout this study. In this point neuron approximation, the membrane potential <italic>V</italic><sub><italic>i</italic></sub>(<italic>t</italic>) of each individual neuron follows the differential equation
<disp-formula id="pcbi.1007080.e018"><alternatives><graphic id="pcbi.1007080.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
Here, <italic>τ</italic><sub>m</sub> is the membrane time constant and <italic>V</italic><sub>r</sub> is the resting potential. The total input current has three separate components <inline-formula id="pcbi.1007080.e019"><alternatives><graphic id="pcbi.1007080.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mtext>rec</mml:mtext></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The recurrent input is given by
<disp-formula id="pcbi.1007080.e020"><alternatives><graphic id="pcbi.1007080.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mtext>rec</mml:mtext></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>t</italic><sub><italic>jk</italic></sub> is the time of the <italic>k</italic>-th spike of neuron j, <italic>d</italic><sub><italic>ij</italic></sub> is the transmission delay of the connection, and <italic>J</italic><sub><italic>ij</italic></sub> is the amplitude of the post-synaptic potential (synaptic “efficacy”) from neuron <italic>j</italic> to neuron <italic>i</italic>. Each time the pre-synaptic neuron <italic>j</italic> fires a spike at time <italic>t</italic><sub><italic>jk</italic></sub>, the membrane potential of neuron <italic>i</italic> is deflected by <italic>J</italic><sub><italic>ij</italic></sub> at time <italic>t</italic><sub><italic>ik</italic></sub> + <italic>d</italic><sub><italic>ij</italic></sub>. If the membrane potential reaches the threshold voltage <italic>V</italic><sub>thr</sub>, the neuron emits a spike that is transmitted to all its post-synaptic neurons. Following each spike, the membrane potential is clamped at the reset potential <italic>V</italic><sub><italic>i</italic></sub> = <italic>V</italic><sub><italic>r</italic></sub> for a refractory period <italic>τ</italic><sub>ref</sub>. In our work, the synapse model slightly differs from the original model of Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>]. While they used exponential post-synaptic currents, in our model all of the charge is delivered instantaneously, as expressed by the <italic>δ</italic>-function in <xref ref-type="disp-formula" rid="pcbi.1007080.e018">Eq 5</xref>. Numerical values for the single neuron parameters are summarized in <xref ref-type="table" rid="pcbi.1007080.t002">Table 2</xref>.</p>
<table-wrap id="pcbi.1007080.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.t001</object-id>
<label>Table 1</label>
<caption>
<title>Populations sizes.</title>
</caption>
<alternatives>
<graphic id="pcbi.1007080.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">population</th>
<th align="center">L2/3e</th>
<th align="center">L2/3i</th>
<th align="center">L4e</th>
<th align="center">L4i</th>
<th align="center">L5e</th>
<th align="center">L5i</th>
<th align="center">L6e</th>
<th align="center">L6i</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">size</td>
<td align="center">20 683</td>
<td align="center">5 834</td>
<td align="center">21 915</td>
<td align="center">5 479</td>
<td align="center">4 850</td>
<td align="center">1 065</td>
<td align="center">14 395</td>
<td align="center">2 948</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pcbi.1007080.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.t002</object-id>
<label>Table 2</label>
<caption>
<title>Single neuron parameter values.</title>
</caption>
<alternatives>
<graphic id="pcbi.1007080.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">parameter</th>
<th align="right">value</th>
<th align="left">unit</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><italic>τ</italic><sub>m</sub></td>
<td align="right">10</td>
<td align="left">ms</td>
</tr>
<tr>
<td align="center"><italic>τ</italic><sub>ref</sub></td>
<td align="right">2</td>
<td align="left">ms</td>
</tr>
<tr>
<td align="center"><italic>R</italic></td>
<td align="right">40</td>
<td align="left">MΩ</td>
</tr>
<tr>
<td align="center"><italic>C</italic><sub>m</sub></td>
<td align="right">250</td>
<td align="left">pF</td>
</tr>
<tr>
<td align="center"><italic>V</italic><sub>thr</sub></td>
<td align="right">-50</td>
<td align="left">mV</td>
</tr>
<tr>
<td align="center"><italic>V</italic><sub>r</sub></td>
<td align="right">-65</td>
<td align="left">mV</td>
</tr>
<tr>
<td align="center"><italic>J</italic><sub>e</sub></td>
<td align="right">0.15 ± 0.015</td>
<td align="left">mV</td>
</tr>
<tr>
<td align="center"><italic>g</italic></td>
<td align="right">4</td>
<td align="left"/>
</tr>
<tr>
<td align="center"><italic>d</italic><sub>exc</sub></td>
<td align="right">1.5 ± 0.75</td>
<td align="left">ms</td>
</tr>
<tr>
<td align="center"><italic>d</italic><sub>inh</sub></td>
<td align="right">0.7 ± 0.35</td>
<td align="left">ms</td>
</tr>
<tr>
<td align="center"><italic>ν</italic><sub>bg</sub></td>
<td align="right">8</td>
<td align="left">Hz</td>
</tr>
<tr>
<td align="center">
<inline-formula id="pcbi.1007080.e021">
<alternatives>
<graphic id="pcbi.1007080.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e021" xlink:type="simple"/>
<mml:math display="inline" id="M21">
<mml:msubsup>
<mml:mi>ν</mml:mi>
<mml:mn>0</mml:mn>
<mml:mtext>th</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="right">30</td>
<td align="left">Hz</td>
</tr>
<tr>
<td align="center"><italic>m</italic></td>
<td align="right">0.3</td>
<td align="left"/>
</tr>
<tr>
<td align="center"><italic>θ</italic></td>
<td align="right">0, 15, …, 165</td>
<td align="left">°</td>
</tr>
<tr>
<td align="center">
<inline-formula id="pcbi.1007080.e022">
<alternatives>
<graphic id="pcbi.1007080.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e022" xlink:type="simple"/>
<mml:math display="inline" id="M22">
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mi>i</mml:mi>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="right">[0, 180)</td>
<td align="left">°</td>
</tr>
<tr>
<td align="center"><italic>T</italic></td>
<td align="right">100</td>
<td align="left">s</td>
</tr>
<tr>
<td align="center">Δ<italic>t</italic></td>
<td align="right">0.1</td>
<td align="left">ms</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>Shown are variable names, numerical parameter values and, if applicable, the standard deviation of the Gaussian distribution, as well as physical units.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>The connectivity of the model was compiled in Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>] based on a large number of anatomical and electrophysiological measurements, most prominently by Thomson et al. [<xref ref-type="bibr" rid="pcbi.1007080.ref018">18</xref>] and Binzegger et al. [<xref ref-type="bibr" rid="pcbi.1007080.ref019">19</xref>]. The connectivity map shown in <xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1B</xref> and <xref ref-type="table" rid="pcbi.1007080.t003">Table 3</xref> summarizes the result of an extended review of the literature. In our implementation, these numbers describe the exact number of synapses each post-synaptic neuron receives from randomly chosen pre-synaptic neurons in each of the eight populations. All connections are unitary, and self-connections are excluded. This fixed in-degree connectivity deviates from the original model, where a fixed number of synapses was distributed by randomly drawing both target and source neurons, resulting in approximately binomially distributed in- and out-degrees. Our modification results in a somewhat lower variability of rates and orientation selectivities in the populations.</p>
<table-wrap id="pcbi.1007080.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.t003</object-id>
<label>Table 3</label>
<caption>
<title>In-degrees for individual projections between pre- and postsynaptic populations.</title>
</caption>
<alternatives>
<graphic id="pcbi.1007080.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<tbody>
<tr>
<td align="left" colspan="2" rowspan="2"/>
<td align="center" colspan="10">pre</td>
</tr>
<tr>
<td align="right">L2/3e</td>
<td align="right">L2/3i</td>
<td align="right">L4e</td>
<td align="right">L4i</td>
<td align="right">L5e</td>
<td align="right">L5i</td>
<td align="right">L6e</td>
<td align="right">L6i</td>
<td align="right">bg</td>
<td align="right">th</td>
</tr>
<tr>
<td align="left" rowspan="8">post</td>
<td align="left">L2/3e</td>
<td align="right">2 199</td>
<td align="right">1 079</td>
<td align="right">979</td>
<td align="right">467</td>
<td align="right">159</td>
<td align="right">0</td>
<td align="right">109</td>
<td align="right">0</td>
<td align="right">1 600</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">L2/3i</td>
<td align="right">2 990</td>
<td align="right">860</td>
<td align="right">703</td>
<td align="right">289</td>
<td align="right">380</td>
<td align="right">0</td>
<td align="right">60</td>
<td align="right">0</td>
<td align="right">1 500</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">L4e</td>
<td align="right">159</td>
<td align="right">34</td>
<td align="right">1 117</td>
<td align="right">794</td>
<td align="right">32</td>
<td align="right">0</td>
<td align="right">667</td>
<td align="right">0</td>
<td align="right">2100</td>
<td align="right">93</td>
</tr>
<tr>
<td align="left">L4i</td>
<td align="right">1 480</td>
<td align="right">16</td>
<td align="right">1 813</td>
<td align="right">953</td>
<td align="right">16</td>
<td align="right">0</td>
<td align="right">1 608</td>
<td align="right">0</td>
<td align="right">1 900</td>
<td align="right">57</td>
</tr>
<tr>
<td align="left">L5e</td>
<td align="right">2 188</td>
<td align="right">374</td>
<td align="right">1 135</td>
<td align="right">31</td>
<td align="right">420</td>
<td align="right">496</td>
<td align="right">296</td>
<td align="right">0</td>
<td align="right">2 000</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">L5i</td>
<td align="right">1 165</td>
<td align="right">159</td>
<td align="right">570</td>
<td align="right">12</td>
<td align="right">300</td>
<td align="right">404</td>
<td align="right">124</td>
<td align="right">0</td>
<td align="right">1 900</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">L6e</td>
<td align="right">325</td>
<td align="right">38</td>
<td align="right">467</td>
<td align="right">91</td>
<td align="right">285</td>
<td align="right">21</td>
<td align="right">581</td>
<td align="right">752</td>
<td align="right">2 900</td>
<td align="right">47</td>
</tr>
<tr>
<td align="left">L6i</td>
<td align="right">766</td>
<td align="right">5</td>
<td align="right">74</td>
<td align="right">2</td>
<td align="right">136</td>
<td align="right">8</td>
<td align="right">979</td>
<td align="right">459</td>
<td align="right">2 100</td>
<td align="right">17</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Synaptic efficacies <italic>J</italic><sub><italic>ij</italic></sub> are drawn from a normal distribution with a mean that depends on the type of connection, and a standard deviation corresponding to 10% of the mean. The mean is <italic>J</italic><sub>e</sub> for excitatory and <italic>J</italic><sub><italic>i</italic></sub> = −<italic>g J</italic><sub>e</sub> for inhibitory connections. As in the model by Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>], the projection from L4e to L2/3e neurons is an exception, where a mean efficacy of 2 <italic>J</italic><sub>e</sub> is imposed. This modification is due to inconclusive data for this particular projection, see [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref024">24</xref>] for details. For all unconnected pairs, we set <italic>J</italic><sub><italic>ij</italic></sub> = 0. In order to obey Dale’s principle, the normal distributions are clipped at zero. Similarly, delays <italic>d</italic><sub><italic>ij</italic></sub> are also drawn from two normal distributions with fixed means and variances, <italic>d</italic><sub>exc</sub> for excitatory and <italic>d</italic><sub>inh</sub> for inhibitory connections, respectively. The delay distributions are clipped at the simulation time step Δ<italic>t</italic>. Numerical values for the distributions of connection strengths and delays can be found in <xref ref-type="table" rid="pcbi.1007080.t002">Table 2</xref>.</p>
<p>In addition to recurrent connections, neurons receive two types of external input. The constant background input represents connections from other brain regions as well as from neurons within V1, which are not part of the model network. It is realized as a homogeneous Poisson input for each neuron. The resulting input current to each single neuron is
<disp-formula id="pcbi.1007080.e023"><alternatives><graphic id="pcbi.1007080.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mtext>bg</mml:mtext></mml:msub><mml:mspace width="0.166667em"/><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
In this case <italic>J</italic><sub>bg</sub> = <italic>J</italic><sub>e</sub> is the connection strength of background synapses, and <italic>t</italic><sub><italic>ik</italic></sub> is the time of <italic>k</italic>-th spike of the Poisson process of neuron <italic>i</italic>. The rate of each Poisson process depends on the population <italic>P</italic> the neuron belongs to and is given by <inline-formula id="pcbi.1007080.e024"><alternatives><graphic id="pcbi.1007080.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>P</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mi>P</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup><mml:msub><mml:mi>ν</mml:mi><mml:mtext>bg</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Here, <inline-formula id="pcbi.1007080.e025"><alternatives><graphic id="pcbi.1007080.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msubsup><mml:mi>K</mml:mi><mml:mi>P</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> is the number of background synapses connecting to individual neurons in the respective target population (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1B/1D</xref> and <xref ref-type="table" rid="pcbi.1007080.t003">Table 3</xref>) and <italic>ν</italic><sub>bg</sub> is the rate of individual background neurons.</p>
<p>Similar to background input, the thalamocortical input is also conceived as a homogeneous Poisson process. The current from the connections is given by
<disp-formula id="pcbi.1007080.e026"><alternatives><graphic id="pcbi.1007080.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mtext>th</mml:mtext></mml:msub><mml:mspace width="0.166667em"/><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
with <italic>J</italic><sub>th</sub> = <italic>J</italic><sub>e</sub>. In contrast to the homogeneous background input to each individual neuron, the rate of the thalamic input depends on the orientation <italic>θ</italic> of a grating that represents the visual stimulus (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1C</xref>). The resulting orientation-tuned input is given by
<disp-formula id="pcbi.1007080.e027"><alternatives><graphic id="pcbi.1007080.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mi>P</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>ν</mml:mi><mml:mn>0</mml:mn><mml:mtext>th</mml:mtext></mml:msubsup><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mspace width="0.166667em"/><mml:mo form="prefix">cos</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
where <inline-formula id="pcbi.1007080.e028"><alternatives><graphic id="pcbi.1007080.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msubsup><mml:mi>K</mml:mi><mml:mi>P</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> denotes the number of thalamocortical synapses per neuron in population <italic>P</italic> (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1B/1E</xref>), <inline-formula id="pcbi.1007080.e029"><alternatives><graphic id="pcbi.1007080.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msubsup><mml:mi>ν</mml:mi><mml:mn>0</mml:mn><mml:mtext>th</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> is the fixed mean rate of thalamic neurons, <italic>m</italic> is the modulation strength and <inline-formula id="pcbi.1007080.e030"><alternatives><graphic id="pcbi.1007080.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> the preferred orientation of the input to this neuron. The latter is drawn from a uniform distribution on [0°, 180°). The network is simulated for twelve stimulation angles <italic>θ</italic> from 0° to 165° in steps of 15°. Again, numerical values for all parameters can be found in Tables <xref ref-type="table" rid="pcbi.1007080.t002">2</xref> and <xref ref-type="table" rid="pcbi.1007080.t003">3</xref>.</p>
<p>The non-homogeneous thalamic input is our most significant modification of the model by Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>] to account for visual stimulation of the network. The original model used a population of 902 thalamic neurons. However, in order to include orientation tuning into the projection, it would be necessary to make assumptions on how the input tuning is generated by the thalamocortical afferents. Because our work concentrates on the cortical processing of tuning information, we replaced the thalamic neurons by Poisson type tuned input.</p>
<p>Stimulation by a grating with each of the twelve angles <italic>θ</italic> is simulated for a total of <italic>T</italic> = 100 s, with a simulation time step of Δ<italic>t</italic> = 0.1 ms. In addition, before the stimulation starts, the network is simulated for a warm-up time of 200 ms to exclude onset transients from the analysis. Spike times and the exact synaptic connectivity for all pairs of neurons are extracted and stored for further analysis.</p>
</sec>
<sec id="sec014">
<title>Model B: Nonlinear firing rate model</title>
<p>To derive a firing rate model for the system under study, we apply the mean field approach put forward by Brunel [<xref ref-type="bibr" rid="pcbi.1007080.ref006">6</xref>] to each single neuron in all eight populations. We assume that the total input to each neuron <italic>i</italic> amounts to a mean current <italic>μ</italic><sub><italic>i</italic></sub> and additive current fluctuations (Gaussian white noise) <italic>η</italic>(<italic>t</italic>) with variance <inline-formula id="pcbi.1007080.e031"><alternatives><graphic id="pcbi.1007080.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>
<disp-formula id="pcbi.1007080.e032"><alternatives><graphic id="pcbi.1007080.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msqrt><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:msqrt><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
This way, we can characterize the stationary state, in which <italic>μ</italic><sub><italic>i</italic></sub> and <italic>σ</italic><sub><italic>i</italic></sub> are fixed parameters that depend on the thalamic input. Similar to the total input current, the mean and variance can be separated into three sources
<disp-formula id="pcbi.1007080.e033"><alternatives><graphic id="pcbi.1007080.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mtext>rec</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mtext>rec</mml:mtext><mml:mphantom><mml:mpadded width="0pt"><mml:mn>12</mml:mn><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:mpadded></mml:mphantom></mml:mrow></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
For each source, the respective mean and variance are approximately given by
<disp-formula id="pcbi.1007080.e034"><alternatives><graphic id="pcbi.1007080.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mtext>rec</mml:mtext></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mtext>rec</mml:mtext><mml:mphantom><mml:mpadded width="0pt"><mml:mn>12</mml:mn><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:mpadded></mml:mphantom></mml:mrow></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mspace width="0.166667em"/><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mi>J</mml:mi><mml:mtext>bg</mml:mtext></mml:msub><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>J</mml:mi><mml:mtext>bg</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mi>J</mml:mi><mml:mtext>th</mml:mtext></mml:msub><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>J</mml:mi><mml:mtext>th</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where independence of all input components has been assumed. As for the spiking model, the in-degrees of the external input has been accounted for in <inline-formula id="pcbi.1007080.e035"><alternatives><graphic id="pcbi.1007080.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>bg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007080.e036"><alternatives><graphic id="pcbi.1007080.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>. Furthermore, <inline-formula id="pcbi.1007080.e037"><alternatives><graphic id="pcbi.1007080.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> accounts for the non-homogeneous input each individual neuron receives due to the oriented stimulus according to <xref ref-type="disp-formula" rid="pcbi.1007080.e027">Eq 6</xref>. The self-consistent solutions of the associated first-passage time problem [<xref ref-type="bibr" rid="pcbi.1007080.ref025">25</xref>] yield the steady-state firing rates of all neurons
<disp-formula id="pcbi.1007080.e038"><alternatives><graphic id="pcbi.1007080.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ν</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
with the transfer function <italic>F</italic><sub><italic>i</italic></sub> being defined by
<disp-formula id="pcbi.1007080.e039"><alternatives><graphic id="pcbi.1007080.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ν</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ν</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where
<disp-formula id="pcbi.1007080.e040"><alternatives><graphic id="pcbi.1007080.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ν</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mtext>ref</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt><mml:msubsup><mml:mo>∫</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>thr</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>erf</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where erf is the standard error function. Solving this non-linear algebraic set of equations yields the desired estimates for the firing rate of each single neuron.</p>
<p>The challenge is now to actually solve this 77 169-dimensional system of highly non-linear self-consistency equations. This can be achieved by reformulating the problem as a Wilson-Cowan type model [<xref ref-type="bibr" rid="pcbi.1007080.ref026">26</xref>]. Since we are only interested in the fixed point describing the steady-state of the system, and not in its exact temporal evolution, we choose a unit time constant and introduce a pseudo-time <italic>s</italic>. This allows to write the problem as a system of ordinary differential equations
<disp-formula id="pcbi.1007080.e041"><alternatives><graphic id="pcbi.1007080.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>ν</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>ν</mml:mi><mml:mtext>th</mml:mtext></mml:msup><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Assuming stability, these differential equations converge to a steady-state rate vector <italic>ν</italic>* which solves the system in <xref ref-type="disp-formula" rid="pcbi.1007080.e038">Eq 7</xref> characterized by <inline-formula id="pcbi.1007080.e042"><alternatives><graphic id="pcbi.1007080.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>ν</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. For the numerical solution, we applied an explicit Runge-Kutta method of order (4)5 including adaptive step size control [<xref ref-type="bibr" rid="pcbi.1007080.ref027">27</xref>].</p>
</sec>
<sec id="sec015">
<title>Model C: Linearized network model</title>
<p>The linear model is derived from the rate coding model described above using a standard linearization procedure. We start by calculating the total derivative of the transfer function <xref ref-type="disp-formula" rid="pcbi.1007080.e038">Eq 7</xref>
<disp-formula id="pcbi.1007080.e043"><alternatives><graphic id="pcbi.1007080.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>Δ</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mtext>OP</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
The partial derivatives of the transfer function are given by
<disp-formula id="pcbi.1007080.e044"><alternatives><graphic id="pcbi.1007080.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where the partial derivatives of Φ<sub><italic>i</italic></sub> are
<disp-formula id="pcbi.1007080.e045"><alternatives><graphic id="pcbi.1007080.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mtext>erfcx</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>thr</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>)</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mtext>erfcx</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>)</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mtext>erfcx</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>thr</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>)</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>thr</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mtext>erfcx</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>)</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Here, the Leibniz integral rule was used, and <inline-formula id="pcbi.1007080.e046"><alternatives><graphic id="pcbi.1007080.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:mtext>erfcx</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>erf</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the scaled complementary error function. Finally, the partial derivatives of the mean and standard deviation of the input are given by
<disp-formula id="pcbi.1007080.e047"><alternatives><graphic id="pcbi.1007080.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Note that in all partial derivatives above an explicit mention of the evaluation point <italic>ν</italic> = <italic>ν</italic><sub>OP</sub> was omitted for the sake of a compact notation.</p>
<p>The operating point <italic>ν</italic><sub>OP</sub> at which the derivatives are evaluated can be chosen freely. However, the precision of the linear approximation depends on the nature of the non-linearity of the activity of the network, and how far the linearization point is away from the regime of interest. Here, it is chosen as the activity with zero thalamic input, <italic>ν</italic><sup>th</sup> = 0. This choice provides the greatest flexibility in the predictions to be derived from the model. In this case, for both conditions considered here, the thalamic input perturbation is identical to the thalamic input rates, <inline-formula id="pcbi.1007080.e048"><alternatives><graphic id="pcbi.1007080.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:mo>Δ</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Note that, while thalamic neurons do not fire at the linearization point, the network does still receive background input from other sources, leading to non-zero network activity at this point.</p>
<p>The derivatives of the transfer function are organized in a matrix <italic>W</italic> <disp-formula id="pcbi.1007080.e049"><alternatives><graphic id="pcbi.1007080.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo/><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mtext>OP</mml:mtext></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and the diagonal matrix
<disp-formula id="pcbi.1007080.e050"><alternatives><graphic id="pcbi.1007080.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e050" xlink:type="simple"/><mml:math display="block" id="M50"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo/><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>j</mml:mi><mml:mtext>th</mml:mtext></mml:msubsup></mml:mrow></mml:mfrac><mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mtext>OP</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<xref ref-type="disp-formula" rid="pcbi.1007080.e043">Eq 8</xref> can then be compactly written as
<disp-formula id="pcbi.1007080.e051"><alternatives><graphic id="pcbi.1007080.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>W</mml:mi><mml:mo>−</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:mi>ν</mml:mi><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msup><mml:mi>ν</mml:mi><mml:mtext>th</mml:mtext></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where we also summarized the input and output rate perturbations into the vectors Δ<italic>ν</italic> and Δ<italic>ν</italic><sup>th</sup>. Assuming that <inline-formula id="pcbi.1007080.e052"><alternatives><graphic id="pcbi.1007080.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mo>(</mml:mo><mml:mi>W</mml:mi><mml:mo>−</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is invertible, which is almost always the case for the large random matrices considered here, and defining the scaled effective input Δ<italic>β</italic> = <italic>B</italic> Δ<italic>ν</italic><sup>th</sup>, we obtain the explicit expression for the output perturbation
<disp-formula id="pcbi.1007080.e053"><alternatives><graphic id="pcbi.1007080.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:mi>β</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula></p>
<p>In a next step, the effective input perturbation can be decomposed into
<disp-formula id="pcbi.1007080.e054"><alternatives><graphic id="pcbi.1007080.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e054" xlink:type="simple"/><mml:math display="block" id="M54"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where Δ<italic>β</italic><sub><italic>B</italic></sub> is the baseline and Δ<italic>β</italic><sub><italic>M</italic></sub> is the modulation component, respectively [<xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>]. The former is defined by <inline-formula id="pcbi.1007080.e055"><alternatives><graphic id="pcbi.1007080.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mrow><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, the vector of expected effective input rates. Note that the expectation values are identical across all neurons of each population. With this, we define Δ<italic>β</italic><sub><italic>M</italic></sub> = Δ<italic>β</italic> − Δ<italic>β</italic><sub><italic>B</italic></sub> as the vector containing the deviations from the population means.</p>
<p>Along the same lines, the matrix <italic>W</italic> can also be decomposed into two matrices such that
<disp-formula id="pcbi.1007080.e056"><alternatives><graphic id="pcbi.1007080.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mi>Q</mml:mi><mml:mo>+</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>Q</italic> is a block-wise constant matrix containing expectation values <inline-formula id="pcbi.1007080.e057"><alternatives><graphic id="pcbi.1007080.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and <italic>S</italic> is composed of the zero-mean deviances <italic>S</italic> = <italic>W</italic> − <italic>Q</italic>. Combining the decomposition of the input perturbation and the matrix, we can define two linear systems
<disp-formula id="pcbi.1007080.e058"><alternatives><graphic id="pcbi.1007080.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
In analogy to what was suggested by Sadeh et al. [<xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>], these two systems can be interpreted as two separate processing pathways of the network. In the baseline system, the matrix <italic>Q</italic> defines the processing of the untuned baseline input, while in the modulation system, the matrix <italic>S</italic> is responsible for the input modulation. However, this characterizes the system only if there is no interference between the two pathways: The output Δ<italic>ν</italic><sub><italic>B</italic></sub> should not contain a modulation component, and the output Δ<italic>ν</italic><sub><italic>M</italic></sub> should not contain a baseline component. Furthermore, it is not obvious that the combination Δ<italic>ν</italic> = Δ<italic>ν</italic><sub><italic>B</italic></sub> + Δ<italic>ν</italic><sub><italic>M</italic></sub> solves the original <italic>W</italic>-system described in <xref ref-type="disp-formula" rid="pcbi.1007080.e053">Eq 9</xref>.</p>
<p>We start verifying these requirements by showing that Δ<italic>ν</italic><sub><italic>B</italic></sub> is constant across populations and thus does not contain a modulation component. To this end, a symmetry argument can be applied: Let Δ<italic>ν</italic><sub><italic>B</italic></sub><sub><italic>i</italic></sub> = <italic>x</italic> and Δ<italic>ν</italic><sub><italic>B</italic></sub><sub><italic>j</italic></sub> = <italic>y</italic> for two neurons <italic>i</italic> and <italic>j</italic> of the same population, then Δ<italic>ν</italic><sub><italic>B</italic></sub><sub><italic>i</italic></sub> = <italic>y</italic>, Δ<italic>ν</italic><sub><italic>B</italic></sub><sub><italic>j</italic></sub> = <italic>x</italic> must also be a solution of the system, as <italic>Q</italic> is block-wise constant. As the operator <inline-formula id="pcbi.1007080.e059"><alternatives><graphic id="pcbi.1007080.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is invertible and the system has only one solution, it follows that <italic>x</italic> = <italic>y</italic> and Δ<italic>ν</italic><sub><italic>B</italic></sub> must be constant for all neurons from the same population.</p>
<p>In order to show that Δ<italic>ν</italic><sub><italic>M</italic></sub> does not have a baseline component, we look at the modulation system (<xref ref-type="disp-formula" rid="pcbi.1007080.e058">Eq 10</xref>) in its element-wise, implicit form
<disp-formula id="pcbi.1007080.e060"><alternatives><graphic id="pcbi.1007080.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e060" xlink:type="simple"/><mml:math display="block" id="M60"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>δ</italic><sub><italic>ij</italic></sub> is the Kronecker delta function. Changing to the expected value of the expression and assuming independence of <italic>S</italic><sub><italic>ij</italic></sub> and Δ<italic>ν</italic><sub><italic>M</italic></sub><sub><italic>j</italic></sub> leads to
<disp-formula id="pcbi.1007080.e061"><alternatives><graphic id="pcbi.1007080.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e061" xlink:type="simple"/><mml:math display="block" id="M61"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Noting that <inline-formula id="pcbi.1007080.e062"><alternatives><graphic id="pcbi.1007080.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007080.e063"><alternatives><graphic id="pcbi.1007080.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> by construction, this shows that
<disp-formula id="pcbi.1007080.e064"><alternatives><graphic id="pcbi.1007080.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e064" xlink:type="simple"/><mml:math display="block" id="M64"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula>
and thus that Δ<italic>ν</italic><sub><italic>M</italic></sub> has no baseline component.</p>
<p>Finally, we show that Δ<italic>ν</italic> = Δ<italic>ν</italic><sub><italic>B</italic></sub> + Δ<italic>ν</italic><sub><italic>M</italic></sub> yields an approximate solution of the <italic>W</italic>-system. For this, we substitute this ansatz and the decomposition <italic>W</italic> = <italic>Q</italic> + <italic>S</italic> into <xref ref-type="disp-formula" rid="pcbi.1007080.e053">Eq 9</xref>
<disp-formula id="pcbi.1007080.e065"><alternatives><graphic id="pcbi.1007080.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e065" xlink:type="simple"/><mml:math display="block" id="M65"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>Q</mml:mi><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mrow><mml:mo>(</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>Q</mml:mi><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mi>Q</mml:mi><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo>︸</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mo>−</mml:mo><mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mi>S</mml:mi><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>︸</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula>
We will now analyze the two interference terms (a) and (b) in more detail:
<list list-type="order">
<list-item><p>The matrix Q is block-wise constant with value <italic>Q</italic><sub><italic>ij</italic></sub> = <italic>q</italic><sub><italic>PT</italic></sub> for neurons <italic>i</italic> and <italic>j</italic> in populations <italic>P</italic> and <italic>T</italic>, respectively. For each element in the vector <italic>Q</italic>Δ<italic>ν</italic><sub><italic>M</italic></sub>, we then have
<disp-formula id="pcbi.1007080.e066"><alternatives><graphic id="pcbi.1007080.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e066" xlink:type="simple"/><mml:math display="block" id="M66"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Q</mml:mi><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>T</mml:mi></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>T</mml:mi></mml:munder><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Using <xref ref-type="disp-formula" rid="pcbi.1007080.e064">Eq 11</xref>, we know that ∑<sub><italic>j</italic>∈<italic>T</italic></sub> Δ<italic>ν</italic><sub><italic>M</italic></sub> ≈ 0 and therefore also <italic>Q</italic>Δ<italic>ν</italic><sub><italic>M</italic></sub> ≈ 0.</p></list-item>
<list-item><p>Similarly, for each element of the second interference term, we can write
<disp-formula id="pcbi.1007080.e067"><alternatives><graphic id="pcbi.1007080.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e067" xlink:type="simple"/><mml:math display="block" id="M67"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>T</mml:mi></mml:munder><mml:msub><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where now Δ<italic>ν</italic><sub><italic>B</italic></sub><sub><italic>j</italic></sub> = Δ<italic>ν</italic><sub><italic>B</italic></sub><sub><italic>T</italic></sub> are the values of the population-wise constant vector Δ<italic>ν</italic><sub><italic>B</italic></sub>. The matrix <italic>S</italic> is defined as the zero-mean deviations between <italic>W</italic> and <italic>Q</italic>. Therefore, for sufficiently large population sizes and small variances in the connectivity, we have ∑<sub><italic>j</italic>∈<italic>T</italic></sub> <italic>S</italic><sub><italic>ij</italic></sub> ≈ 0 which leads to <italic>S</italic>Δ<italic>ν</italic><sub><italic>B</italic></sub> ≈ 0.</p></list-item>
</list></p>
<p>Combining these findings with <xref ref-type="disp-formula" rid="pcbi.1007080.e065">Eq 12</xref>, the expression can be reduced to
<disp-formula id="pcbi.1007080.e068"><alternatives><graphic id="pcbi.1007080.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e068" xlink:type="simple"/><mml:math display="block" id="M68"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:mi>ν</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
by definition of Δ<italic>ν</italic><sub><italic>B</italic></sub> and Δ<italic>ν</italic><sub><italic>M</italic></sub> (<xref ref-type="disp-formula" rid="pcbi.1007080.e058">Eq 10</xref>), meaning that Δ<italic>ν</italic> = Δ<italic>ν</italic><sub><italic>B</italic></sub> + Δ<italic>ν</italic><sub><italic>M</italic></sub> indeed provides an approximate solution to the system.</p>
<p>To summarize, we showed that instead of solving the linear model via the <italic>W</italic>-system directly, it can also be studied in terms of the two pathways defined by <xref ref-type="disp-formula" rid="pcbi.1007080.e058">Eq 10</xref>. Provided the two interference terms in <xref ref-type="disp-formula" rid="pcbi.1007080.e065">Eq 12</xref> can indeed be neglected for the network at hand, this is approximately equivalent and potentially more informative than the direct solution.</p>
</sec>
<sec id="sec016">
<title>External stimulation</title>
<p>In addition to the synaptic input provided by the background and the thalamus, neurons can also receive additional external stimulation <italic>I</italic><sup>stim</sup> in an experiment. Such an input could, for example, model optogenetic microstimulation. In the single neuron rate model (Model B), this can be accounted for by an additional term in the total mean input <italic>μ</italic><sub><italic>i</italic></sub> given by <inline-formula id="pcbi.1007080.e069"><alternatives><graphic id="pcbi.1007080.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mtext>stim</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mtext>stim</mml:mtext></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. As we consider here only constant stimulation, the variance <inline-formula id="pcbi.1007080.e070"><alternatives><graphic id="pcbi.1007080.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:msup><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mtext>stim</mml:mtext></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula> of this input is zero.</p>
<p>In the linear model (Model C), applying a current results in an additional input perturbation and an extra term in the total derivative (<xref ref-type="disp-formula" rid="pcbi.1007080.e043">Eq 8</xref>). In the explicit expression <xref ref-type="disp-formula" rid="pcbi.1007080.e053">Eq 9</xref>, this can be accounted for by
<disp-formula id="pcbi.1007080.e071"><alternatives><graphic id="pcbi.1007080.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e071" xlink:type="simple"/><mml:math display="block" id="M71"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mrow><mml:mo>(</mml:mo><mml:mo>Δ</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
The components of Δ<italic>γ</italic> are defined in analogy to the thalamic perturbation by
<disp-formula id="pcbi.1007080.e072"><alternatives><graphic id="pcbi.1007080.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e072" xlink:type="simple"/><mml:math display="block" id="M72"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo/><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mtext>OP</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</sec>
</sec>
</sec>
<sec id="sec017" sec-type="results">
<title>Results</title>
<sec id="sec018">
<title>Spiking neural network simulations</title>
<p>The results of the spiking neural network simulations performed in NEST and of the detailed data analysis performed on the simulated data are summarized in <xref ref-type="fig" rid="pcbi.1007080.g002">Fig 2</xref>, both for the spontaneous (weak, untuned thalamic input) and stimulated (tuned thalamic input) condition. Note that we do not subtract the spontaneous rates in the stimulated condition for our analysis.</p>
<fig id="pcbi.1007080.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Spiking neuronal network.</title>
<p><bold>A</bold> 250ms raster plot for both spontaneous and stimulated conditions, depicting 500 neurons of each of the eight subpopulations. <bold>B-C</bold> Box plots of the firing rate distribution within each population, for spontaneous (B) and stimulated (C) conditions, respectively. Shown are the median (central line), lower and upper quartiles (box) as well as 5% and 95% percentiles (whisker bars). <bold>D-E</bold> Comparison of median spontaneous (D) and evoked (E) rates between model results and experimental values reported by [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>]. Evoked rates are given by the maximal response over all angles. The experimental results were obtained by summing the spontaneous and evoked rates from [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>] for direct comparison. For the model results, the inhibitory rates are averaged over all layers for better comparison with the data from experiments.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.g002" xlink:type="simple"/>
</fig>
<p>As expected, the single neuron firing rates (<xref ref-type="fig" rid="pcbi.1007080.g002">Fig 2B/2C</xref>) match the values reported by Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>]. <xref ref-type="fig" rid="pcbi.1007080.g002">Fig 2D/2E</xref> compares the firing rates of the model with experimental values obtained by Niell and Stryker [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>] from adult mouse visual cortex. In the spontaneous condition (<xref ref-type="fig" rid="pcbi.1007080.g002">Fig 2D</xref>), the model firing rates are somewhat lower compared to experimental values, but are otherwise in good qualitative agreement with them. We find very low activity in L2/3 and higher rates in the granular and infragranular layers, with the exception of population L6e, where rates are also low.</p>
<p>For the stimulus condition, <xref ref-type="fig" rid="pcbi.1007080.g002">Fig 2E</xref> compares the evoked rates of the model with the results of Niell and Stryker [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>]. The evoked rates are defined as the maximal rate of the individual neurons over all angles. Therefore, they differ from the median values shown in <xref ref-type="fig" rid="pcbi.1007080.g002">Fig 2C</xref>. In this condition, the model rates vary more strongly across layers as compared to the experimental values.</p>
<p>The mean and standard deviation (SD) of the pairwise spike-count correlations over all populations are (0.2 ± 10.3) ⋅ 10<sup>−3</sup> and (0.3 ± 10.4) ⋅ 10<sup>−3</sup> for spontaneous and stimulated conditions, respectively (10 ms bin size). The mean and SD of the coefficient of variation (CV) of the inter-spike intervals are 0.9 ± 0.1 for both conditions. Both measures show only small variations over different populations (see <xref ref-type="supplementary-material" rid="pcbi.1007080.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007080.s002">S2</xref> Figs for population-wise quantification). The low correlation and Poisson-like irregularity indicate that the network indeed operates in the asynchronous irregular regime [<xref ref-type="bibr" rid="pcbi.1007080.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref028">28</xref>], as illustrated by the raster plot in <xref ref-type="fig" rid="pcbi.1007080.g002">Fig 2A</xref>.</p>
<p>The activity of the network is robust to changes in important parameters which are not well constrained by experiments. Although average firing rates vary across parameter sets, their distribution remained qualitatively similar (<xref ref-type="supplementary-material" rid="pcbi.1007080.s004">S4A/S4B</xref>–<xref ref-type="supplementary-material" rid="pcbi.1007080.s009">S9A/S9B</xref> Figs). Only for very low background input, the network operates in a more synchronous regime with increased correlations (<xref ref-type="supplementary-material" rid="pcbi.1007080.s003">S3B/S3C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007080.s006">S6D</xref> Figs). In this case, the network activity also changes qualitatively. Surprisingly, this is only the case for reduced background input. For a two-fold increase, the activity remains stable (<xref ref-type="supplementary-material" rid="pcbi.1007080.s003">S3B</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007080.s005">S5D</xref> Figs).</p>
<p>Our model extends the work of Potjans and Diesmann by giving the thalamic input a weak orientation bias, as described previously [<xref ref-type="bibr" rid="pcbi.1007080.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>]. The macroscopic connectivity pattern of the network (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1A</xref>) already gives a rough idea of the signal flow through the network. Thalamic afferents project mainly to L4 and to a smaller extent also to L6. From L4, the signal is transmitted to L2/3, which is thought to be the central processing unit of the microcircuit. Signals are then forwarded to higher brain areas as well as to L5, which is the major output unit for projections to sub-cortical brain areas.</p>
<p>In order to dissect the computations performed by the network, we extract tuning curves of all neurons in the model network. As expected from previous studies [<xref ref-type="bibr" rid="pcbi.1007080.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref017">17</xref>], during stimulation, the weak orientation bias of the thalamic input is amplified to strongly orientation selective responses in the input population (<xref ref-type="fig" rid="pcbi.1007080.g003">Fig 3</xref>). Interestingly, L2/3e also shows strong tuning although these neurons only receive input via random connections from L4 neurons. This phenomenon was previously described by Hansel and van Vreeswijk [<xref ref-type="bibr" rid="pcbi.1007080.ref007">7</xref>], where projections from L4e to L2/3 were studied independently of other parts of the network. The strong tuning in L2/3e can be explained by a recurrent tuning amplification in inhibition dominated networks [<xref ref-type="bibr" rid="pcbi.1007080.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>]. This effect is enough to create strong output tuning from a small bias in the input, which in turn is due to random sampling of preferred orientations in L4. In this context it may seem even more surprising that orientation selectivity of L5 neurons appears to be weaker compared to the other layers. This finding, which is a direct consequence of the underlying experimentally determined connectivity, is consistent with several measurements of orientation selectivity performed in different rodent species [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1007080.ref031">31</xref>] (<xref ref-type="fig" rid="pcbi.1007080.g004">Fig 4D</xref>). However, it cannot be easily explained by visual inspection of the connectivity matrix. Even though synaptic connectivity is stronger for the projection to L2/3e, L5e neurons also receive a large fraction of their input from L4e (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1B</xref>, <xref ref-type="table" rid="pcbi.1007080.t003">Table 3</xref>). Therefore, as the output tuning of L2/3e neurons is essentially inherited from these neurons, one might expect a stronger tuning also in L5e.</p>
<fig id="pcbi.1007080.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Single neuron tuning curves.</title>
<p><bold>A</bold> Single neuron tuning curves are centered at their respective preferred orientation and then binned over angles (bin size 10°). 5%, 25%, 50% (median), 75% and 95% percentiles are then calculated for each bin independently and plotted using different line styles. Gray lines indicate median firing rates in the spontaneous condition. <bold>B</bold> Sample tuning curves from each population in polar representation. Gray lines indicate rates of the same neuron in the spontaneous condition.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.g003" xlink:type="simple"/>
</fig>
<fig id="pcbi.1007080.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Orientation selectivity in the spiking neural network.</title>
<p><bold>A</bold> Every single neuron integrates its thalamic input with a large number of differently tuned inputs from various cortical populations (right) and generates tuned output from it (left). The orientation selectivity index (OSI) of the neuron is measured by the relative strength of the first (F1) as compared to the zeroth (F0) Fourier component of the output tuning curve (circular variance). <bold>B-C</bold> OSI quantified for neurons in all layers, measured both under spontaneous and stimulated conditions. Percentiles are the same as in <xref ref-type="fig" rid="pcbi.1007080.g002">Fig 2</xref>. <bold>D</bold> Comparison of mean orientation selectivities in the model with experimental values from [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.g004" xlink:type="simple"/>
</fig>
<p>In order to understand in more detail the differences in orientation selectivity between layers, we extracted the orientation selectivity index (OSI) of all neurons in the model network (<xref ref-type="fig" rid="pcbi.1007080.g004">Fig 4B/4C</xref>). We employ a measure based on the circular variance to quantify orientation selectivity (see <xref ref-type="sec" rid="sec002">Methods</xref> for details). For each neuron, the OSI is calculated as the ratio of first (F1) and zeroth (F0) Fourier component of the tuning curve (<xref ref-type="fig" rid="pcbi.1007080.g004">Fig 4A</xref>). A stronger modulation of the firing rate over angles (higher F1), leads to a higher OSI, while a higher mean rate (higher F0) reduces the OSI. Experimental studies often use a different measure for orientation selectivity based on the activity at the preferred and orthogonal orientation. To allow direct comparison with these works, we also calculated this alternative quantity (<xref ref-type="supplementary-material" rid="pcbi.1007080.s010">S10 Fig</xref>). While the absolute numbers are generally higher for this measure, the qualitative results are identical. Note that also the distribution of orientation tuning is quite robust against variations in parameters (<xref ref-type="supplementary-material" rid="pcbi.1007080.s004">S4C</xref>–<xref ref-type="supplementary-material" rid="pcbi.1007080.s009">S9C</xref> Figs).</p>
<p>Consistent with experimental findings and throughout all layers, inhibitory neurons have a lower OSI than the corresponding excitatory neurons [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref032">32</xref>] (<xref ref-type="fig" rid="pcbi.1007080.g004">Fig 4D</xref>). While this might be expected for L4 and L6 due to the lower number of thalamic afferents, it is not at all obvious for L2/3. In this population, it is a consequence of the recurrent network connectivity, as our analysis will show.</p>
<p>Note that during spontaneous activity, neurons also exhibit weak apparent orientation selectivity (<xref ref-type="fig" rid="pcbi.1007080.g004">Fig 4B</xref>). This is essentially due to fluctuations in the spiking process. Neurons may randomly fire a few action potentials more for one orientation as compared to another, which results in weak but nonzero orientation selectivity. The magnitudes found here are consistent with a Poisson process with the same rate and recording time.</p>
<p>The orientation selectivity is measured as the ratio of first and zeroth Fourier component of the tuning curves (<xref ref-type="fig" rid="pcbi.1007080.g004">Fig 4A</xref>). Analyzing the tuning curves in <xref ref-type="fig" rid="pcbi.1007080.g003">Fig 3A</xref> in more detail, we see that although the F1 component in L5e is stronger than in L2/3e, this is overcompensated by the high F0 component of this population, leading to weaker tuning in L5e.</p>
<p>This raises two questions: First, which projections onto L2/3e and L5e lead to the observed difference in activity? Second, why is the tuned (F1) component of L5e not as strongly amplified as the mean rate (F0), similar to the situation in L2/3? In the following, we will address these questions, employing suitable mathematical and computational methods. While the first question can be answered by analyzing the input currents received by the different populations, the second question requires an approach which takes the strongly recurrent nature of the circuit across layers into consideration.</p>
</sec>
<sec id="sec019">
<title>Operating point of the network</title>
<p>Each neuron in the eight populations of the network receives inputs from several pre-synaptic populations, possibly all with different tuning curves, and forms its own output tuning from those (<xref ref-type="fig" rid="pcbi.1007080.g004">Fig 4A</xref>). It has been shown in experiments that this scenario also reflects the situation in rodents [<xref ref-type="bibr" rid="pcbi.1007080.ref011">11</xref>]. Which projections are most potent for driving the the target neuron is not immediately obvious from the anatomical connectivity between neurons (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1B</xref>). The activity of pre-synaptic neurons is of course also relevant for the total input current to a given neuron. In <xref ref-type="fig" rid="pcbi.1007080.g005">Fig 5A</xref>, the mean input current (<xref ref-type="disp-formula" rid="pcbi.1007080.e013">Eq 3</xref>) for each projection between populations is shown. While the difference between inputs to L2/3e and L5e seems insignificant when looking at the underlying connectivity (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1B</xref>), the picture changes completely if the activity of pre-synaptic neurons is taken into consideration (<xref ref-type="fig" rid="pcbi.1007080.g005">Fig 5A</xref>). The input to L2/3e neurons is mostly determined by L2/3i, both L4 populations and the constant background. Input to L5e, on the other hand, is dominated by L5i and background input, but only to a lesser extent by inputs from L2/3i, L4e and L5e. As a result, due to the different excitation-inhibition (EI) balance, the net currents imply a higher mean input to L5e compared to L2/3e (<xref ref-type="fig" rid="pcbi.1007080.g005">Fig 5C</xref>).</p>
<fig id="pcbi.1007080.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Neuronal input analysis.</title>
<p><bold>A</bold> Mean input currents for all projections between all the involved neuronal populations. <bold>B</bold> Mean projection tuning vector length for all recurrent projections (see text for explanation). <bold>C-E</bold> Output firing rates (F0 of tuning curves), output modulations (F1 of tuning curves) and resulting OSI, averaged over each population. <bold>F</bold> Illustration of single neuron input tuning vector addition. Each small arrow represents the tuning vector of a single pre-synaptic neuron. Linearly adding the vectors of all pre-synaptic neurons of one population results in the tuning vector that characterizes the projection to one post-synaptic neuron.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.g005" xlink:type="simple"/>
</fig>
<p>The marked difference between anatomically defined connectivity (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1B</xref>) and the total input current in the stationary balanced state (<xref ref-type="fig" rid="pcbi.1007080.g005">Fig 5A</xref>) highlights the contribution of activity dynamics in recurrent networks [<xref ref-type="bibr" rid="pcbi.1007080.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref034">34</xref>]. While the situation for L5e and L2/3e is very similar when counting the number of excitatory and inhibitory synapses that terminate in each population, the actual current drive they receive is quite different. Since the activity of the whole network autonomously settles in an operating point where the EI balance is dynamically maintained, this can have very different consequences for the various populations, irrespective of the anatomical connectivity.</p>
<p>Having demonstrated how the dynamic equilibrium and the resulting operating point of the layered network explains the high firing rate of L5 neurons, we can now ask the same question with regard to orientation tuning in each neuronal population. In combination, these two aspects fully determine the orientation selectivity index (OSI) of all neurons. To achieve this, we calculate for each neuron a tuning vector summarizing the information about the stimulus conveyed by the input currents to that neuron. Its magnitude measures the tuning strength of the combined input to the post-synaptic neuron, whereas its direction indicates its preferred orientation (<xref ref-type="fig" rid="pcbi.1007080.g005">Fig 5F</xref> inset, <xref ref-type="disp-formula" rid="pcbi.1007080.e015">Eq 4</xref>). The total tuning input from one specific source population to a single neuron can then be calculated as the sum of all tuning vectors of neurons in the pre-synaptic population which connect to the post-synaptic neuron. If all tuning curves are cosine-like, this concept exactly corresponds to linear summation of inputs. The magnitudes of the tuning vectors are identical to the first Fourier component (F1) of the tuning curves for the current input.</p>
<p>
<xref ref-type="fig" rid="pcbi.1007080.g005">Fig 5B</xref> summarizes the mean lengths of all projection tuning vectors, summarizing the information flow in the system. The tuning information enters the cortical network in L4 and L6 and then spreads to the other populations. Although both L4 and L6 neurons show significant tuning to stimulus orientation, due to the low firing rates of L6e neurons it is mostly L4 which provides tuning information to the other populations. In contrast to what would be expected from the connectivity alone (<xref ref-type="fig" rid="pcbi.1007080.g001">Fig 1B</xref>), also L5e neurons receive most of the tuned current from L4. Comparing the input to L2/3e and L5e neurons in more detail reveals that L2/3e neurons mostly integrate tuned input from both populations in L4, while L5e neurons receive less tuned input almost exclusively from L4e.</p>
<p>Considering only the output modulation of the different populations (<xref ref-type="fig" rid="pcbi.1007080.g005">Fig 5D</xref>), which is defined as the first Fourier component of the tuning curves (<xref ref-type="fig" rid="pcbi.1007080.g004">Fig 4A</xref>), it surprises that despite the less tuned input to L5e, these neurons still show a stronger output modulation than L2/3e. This highlights that, besides the input strength, the input sensitivity of neurons is relevant as well. However, the large modulation component of the output of L5e neurons cannot compensate their high firing rates, leading to a lower OSI (<xref ref-type="fig" rid="pcbi.1007080.g005">Fig 5C–5E</xref>). Comparing the distribution of firing rates and output modulations over the eight populations (<xref ref-type="fig" rid="pcbi.1007080.g005">Fig 5C/5D</xref>), it is evident that these two components are subject to different gain factors. In the following, these dependencies will be studied in more detail.</p>
</sec>
<sec id="sec020">
<title>Two processing pathways: Baseline and modulation</title>
<p>Our analyses so far disentangled the input to neurons in different populations, which explains the observed features of neuronal output. However, the multi-population model is highly recurrent. Therefore, it is not yet clear why the input to all neurons settles in the observed operating point. We face a chicken-and-egg problem here, as in the recurrent network, the output of all populations is simultaneously the input to the same populations, eventually settling in the dynamical operating point. In order to tackle this problem, we now change our perspective from analyzing the input-output relation of single neurons to input-output behavior of the entire network. The idea is to manage the problem by considering the network as a distributed system, which can perform its function only as a whole.</p>
<p>This approach is best realized by linearizing the network dynamics about its operating point. We obtain our close to 80000-dimensional linearized network model (Model C) by first formulating a single neuron firing rate model based on the single neuron transfer function <italic>F</italic><sub><italic>i</italic></sub>(<italic>ν</italic>, <italic>ν</italic><sup>th</sup>) (Model B). The firing rate model is then linearized about its dynamical operating point, leading to the explicit input-output relation
<disp-formula id="pcbi.1007080.e073"><alternatives><graphic id="pcbi.1007080.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e073" xlink:type="simple"/><mml:math display="block" id="M73"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>Δ</mml:mo><mml:mi>β</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(13)</label></disp-formula>
Here, Δ<italic>ν</italic> is a vector summarizing all single neuron rate changes due to a change in the effective input Δ<italic>β</italic>, which in turn is the change in thalamic input rate scaled by the input sensitivities of the different populations. These sensitivities can also be understood as the feed-forward gains of the system [<xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>], see <xref ref-type="sec" rid="sec002">Methods</xref> for details. Furthermore, the behavior of the recurrent model is governed by the matrix <italic>W</italic>, which is the matrix of effective recurrent connections, which are a product of the anatomically and physiologically defined synaptic weights and the input-output sensitivities (gains) of individual post-synaptic neurons at their operating point. In combination with the activity at the operating point <italic>ν</italic><sub>0</sub>, the rate change Δ<italic>ν</italic> results in the output activity <italic>ν</italic> = <italic>ν</italic><sub>0</sub> + Δ<italic>ν</italic> of the linear network model.</p>
<p>The explicit form of <xref ref-type="disp-formula" rid="pcbi.1007080.e073">Eq 13</xref> also supports the idea of considering the network as an integrated system with one single vector-valued input-output relation. Importantly, this relation is governed by the inverse of the effective connectivity <inline-formula id="pcbi.1007080.e074"><alternatives><graphic id="pcbi.1007080.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Because the entries in <italic>W</italic><sub><italic>ij</italic></sub> are a function of <italic>K</italic><sub><italic>ij</italic></sub>, this inversion potentially distributes the influence of each single connectivity parameter <italic>K</italic><sub><italic>ij</italic></sub> over the entire network. This observation also explains why the effects of individual connectivity parameters can be counterintuitive [<xref ref-type="bibr" rid="pcbi.1007080.ref035">35</xref>].</p>
<p>The firing rate model (Model B) as well as the linear network model (Model C) can be considered as simplifications of the spiking neural network (Model A), as they make additional assumptions about its dynamics. Therefore, before analyzing these models in more detail, it is important to establish the consistency of their respective behavior. <xref ref-type="supplementary-material" rid="pcbi.1007080.s011">S11 Fig</xref> compares the results from a simulation of all three models, for matched network parameters. We found that the single neuron firing rates of the three models are in good agreement. While the similarity between the non-linear rate model (Model B) and the linear model (Model C) is quite high, both exhibit mild discrepancies from the spiking network model (Model A). In particular, for the larger firing rates of L5e, the non-linear rate model and the linear model tend to slightly underestimate them. Generally, also the preferred orientations and orientation selectivities are in good agreement between the different models. While the match is again excellent for the non-linear firing rate model and linear network model, both slighly deviate from the spiking network model. This can be explained by the role played by activity fluctuations in this model. In particular, the observed orientation selectivities are somewhat higher here, reflecting the same positive bias as the one observed during spontaneous activity.</p>
<p>The match between the three models is also very robust with respect to changes in parameters (<xref ref-type="supplementary-material" rid="pcbi.1007080.s004">S4A/S4B/S4C</xref>–<xref ref-type="supplementary-material" rid="pcbi.1007080.s009">S9A/S9B/S9C</xref> Figs). In fact, even for reduced background input, when there is substantial synchrony in the spiking activity, the non-linear rate and linear models still provide reasonable approximations (<xref ref-type="supplementary-material" rid="pcbi.1007080.s006">S6A/S6B/S6C Fig</xref>).</p>
<p>Now that the general consistency in the behavior of the different models is established, we can analyze the linearized network and be confident that our conclusions are also valid for the spiking network. In previous work, a separation into two separate, non-interfering pathways were postulated, exploiting that the network can have different gains for different components of its input [<xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>] (<xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6A</xref>). Specifically, the effective input perturbation is split into a baseline and a modulation component such that Δ<italic>β</italic> = Δ<italic>β</italic><sub><italic>B</italic></sub> + Δ<italic>β</italic><sub><italic>M</italic></sub>. Here, we generalize this decomposition to our present multi-population model. Furthermore, we present a novel analytical approach for their analysis.</p>
<fig id="pcbi.1007080.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Separate amplification/attenuation of non-informative baseline and tuned modulation.</title>
<p><bold>A</bold> The input perturbation Δ<italic>β</italic> can be decomposed into baseline and modulation, which are then amplified or attenuated by the network with different gains. <bold>B</bold> Input perturbation for one particular orientation of the oriented stimulus. The effective change in input rate is shown for each neuron in the eight populations of the layered network (blue). The baseline (population mean) is depicted in red. The modulation, which is the entry-wise difference between the two, is plotted in the inset (green). <bold>C</bold> Solutions for the baseline and modulation system. Shown are the baseline (green) and baseline plus modulation (red) output rates. For comparison, also the solution of the full <italic>W</italic> system is shown (blue). The inset shows a magnification for a small sample of neurons in population L4e.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.g006" xlink:type="simple"/>
</fig>
<p>For each population, the baseline Δ<italic>β</italic><sub><italic>B</italic></sub> is conceived as the mean input these neurons receive during stimulation. Since the mean input is different for each population, this leads to a population-wise constant input vector (<xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6B</xref>, red curve). The modulation Δ<italic>β</italic><sub><italic>M</italic></sub>, in contrast, accounts for all neuron-by-neuron deviations from the population baseline, Δ<italic>β</italic><sub><italic>M</italic></sub> ≔ Δ<italic>β</italic> − Δ<italic>β</italic><sub><italic>B</italic></sub>, yielding a vector with zero mean in each of the eight populations (<xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6B</xref>, inset). Most importantly, the modulation component includes the tuning information that each neurons receives, based on the neuron-specific orientation bias of the stimulus. In other words, the deviation of Δ<italic>β</italic><sub><italic>M</italic></sub> from the baseline is determined by the orientation of the stimulus, as described by <xref ref-type="disp-formula" rid="pcbi.1007080.e027">Eq 6</xref>.</p>
<p>Note that the baseline and modulation components are both only indirectly related to mean rate (F0) and tuning strength (F1) discussed in the previous section. While the latter are calculated for the tuning curve of each single neuron independently, the baseline and modulation of the input are calculated over all neurons in one population, for a single stimulation angle.</p>
<p>Separation of baseline and modulation pathway means that the two input components Δ<italic>β</italic><sub><italic>B</italic></sub> and Δ<italic>β</italic><sub><italic>M</italic></sub> are processed by two independent mechanisms with possibly distinct gains <italic>γ</italic><sub><italic>B</italic></sub> and <italic>γ</italic><sub><italic>M</italic></sub>. As shown in <bold>Methods</bold>, the two pathways are governed by
<disp-formula id="pcbi.1007080.e075"><alternatives><graphic id="pcbi.1007080.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e075" xlink:type="simple"/><mml:math display="block" id="M75"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where the decomposition <italic>W</italic> = <italic>Q</italic> + <italic>S</italic> was used. Thereby, <italic>Q</italic> contains population-wise expectation values, resulting in an 8 × 8 block structure, and <italic>S</italic> are the individual modulations <italic>S</italic> = <italic>W</italic> − <italic>Q</italic> of single connections in the network. Importantly, there is no cross-talk between the two pathways. A change in the input baseline Δ<italic>β</italic><sub><italic>B</italic></sub> does not lead to change in the output modulation Δ<italic>ν</italic><sub><italic>M</italic></sub>, and vice versa.</p>
<p>Solving these two systems independently yields two output rate changes Δ<italic>ν</italic><sub><italic>B</italic></sub> and Δ<italic>ν</italic><sub><italic>M</italic></sub>. If the cross-terms in the calculations are indeed negligible, the solution Δ<italic>ν</italic> = Δ<italic>ν</italic><sub><italic>B</italic></sub> + Δ<italic>ν</italic><sub><italic>M</italic></sub> provides a good approximation to the network behavior (see <xref ref-type="disp-formula" rid="pcbi.1007080.e065">Eq 12</xref>ff). For the network under study here, the mean magnitudes <italic>μ</italic> of the cross-terms are <italic>μ</italic>[|<italic>Q</italic>Δ<italic>ν</italic><sub><italic>M</italic></sub>|] = 0.02 and <italic>μ</italic>[|<italic>S</italic>Δ<italic>ν</italic><sub><italic>B</italic></sub>|] = 0.09 as compared to <italic>μ</italic>[|Δ<italic>β</italic>|] = 3.63, implying that the system can indeed be studied by treating the baseline and the modulation pathway separately. Similar numbers are also obtained for the other parameter sets (<xref ref-type="supplementary-material" rid="pcbi.1007080.s003">S3E Fig</xref>).</p>
<p>The solutions of the baseline and modulation systems, Δ<italic>ν</italic><sub><italic>B</italic></sub> and Δ<italic>ν</italic><sub><italic>M</italic></sub>, are shown in <xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6C</xref> in comparison to the solution of the <italic>W</italic>-system. Throughout all populations, the separation solution is in excellent agreement with the direct solution. The modulation part, which conveys the tuning information of the neurons, matches almost perfectly (<xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6C</xref> inset). The good agreement is further confirmed by the high coefficient of determination (“variance explained”) of <italic>R</italic><sup>2</sup> = 99.1%. For the different parameter sets, the lowest <italic>R</italic><sup>2</sup> is obtained for increased background input with <italic>R</italic><sup>2</sup> = 98.0% (<xref ref-type="supplementary-material" rid="pcbi.1007080.s003">S3D</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007080.s004">S4E</xref>–<xref ref-type="supplementary-material" rid="pcbi.1007080.s009">S9E</xref> Figs). This demonstrates the robustness of the baseline and modulation decomposition also with respect to changes in parameters.</p>
<p>In previous sections, we identified the high baseline rate of L5e as the main cause for the low orientation selectivity of its neurons. This becomes manifest in a high baseline output rate Δ<italic>ν</italic><sub><italic>B</italic></sub> for this particular population (<xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6C</xref>). While this observation still does not fully reveal the underlying reason for the high rates, it hints at the effective mean connectivity represented by <italic>Q</italic>. In the following, we will therefore study the baseline pathway in more detail.</p>
</sec>
<sec id="sec021">
<title>Mode decomposition</title>
<p>We start by summarizing the results of Sadeh et al. [<xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref036">36</xref>], where a similar scenario for a two population EI network was studied. In analogy to the present model, the two population system can also be described by a linear system of the form
<disp-formula id="pcbi.1007080.e076"><alternatives><graphic id="pcbi.1007080.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e076" xlink:type="simple"/><mml:math display="block" id="M76"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>Δ</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where the dimensionality of the system equals the total number of neurons. In order to study the network behavior, it is instrumental to inspect the eigenvalue spectrum of the matrix <italic>W</italic>. In the two population case, when both populations receive the same input, the eigenvalue spectrum consists of a bulk of known radius localized at the origin and a single exceptional eigenvalue λ [<xref ref-type="bibr" rid="pcbi.1007080.ref037">37</xref>]. For inhibition dominated networks, this exceptional eigenvalue is real and negative (<xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7A</xref>). Furthermore, the eigenvector Ψ corresponding to that exceptional eigenvalue is the uniform vector, with all entries identical. In this two-population network model, the baseline component of the input perturbation is also proportional to the uniform vector
<disp-formula id="pcbi.1007080.e077"><alternatives><graphic id="pcbi.1007080.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e077" xlink:type="simple"/><mml:math display="block" id="M77"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>∝</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>∝</mml:mo><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Therefore, exploiting the eigenvector property of a baseline perturbation, the exceptional eigenvalue can be transformed into the gain factor of the baseline
<disp-formula id="pcbi.1007080.e078"><alternatives><graphic id="pcbi.1007080.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e078" xlink:type="simple"/><mml:math display="block" id="M78"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>λ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
For inhibition dominated networks, this gain factor <inline-formula id="pcbi.1007080.e079"><alternatives><graphic id="pcbi.1007080.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> has a small magnitude and thus results in a strong attenuation of the baseline component. This, in turn, amplifies the orientation selectivity of the network.</p>
<fig id="pcbi.1007080.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Eigenmode analysis of input-output relations.</title>
<p><bold>A</bold> Eigenvalue spectrum of the linearized model of Brunel [<xref ref-type="bibr" rid="pcbi.1007080.ref006">6</xref>]. The exceptional eigenvalue is shown in red, the bulk spectrum in green. <bold>B</bold> Eigenvalues of the close to 80000-dimensional linear system. Blue and green dots indicate the exceptional and bulk eigenvalues of <italic>W</italic>, respectively. Crosses mark eigenvalues of <italic>Q</italic>. <bold>C</bold> Eigenvalues of the matrix <inline-formula id="pcbi.1007080.e080"><alternatives><graphic id="pcbi.1007080.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. <bold>D</bold> The eight output modes of the <italic>Q</italic> system. Shown are the change in output rate for each single neuron, due to each mode. Inset: Input perturbation decomposed into the eight modes, which are also the right eigenvectors of <italic>Q</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.g007" xlink:type="simple"/>
</fig>
<p>Generalizing the two-population scenario to the eight-population network considered here, two major differences in terms of the eigenvalue spectrum of <italic>W</italic> become apparent. First, instead of a single exceptional eigenvalue, the spectrum of the effective connectivity is more complex (<xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7B</xref>). In addition to the bulk of eigenvalues (diameter indicated in green in <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7B</xref>), there are seven eigenvalues with a significantly larger magnitude (blue dots in <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7B</xref>). In a random matrix theory context, it was previously shown that the exceptional and bulk eigenvalues are due to the expectation values and variances of the distribution of the elements of <italic>W</italic>. Therefore, the exceptional eigenvalues are asymptotically identical to the eigenvalues of <italic>Q</italic> [<xref ref-type="bibr" rid="pcbi.1007080.ref038">38</xref>]. Indeed, the first seven eigenvalues are in good agreement with the numerical calculations on <italic>W</italic> (crosses in <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7B</xref>). Furthermore, an eighth exceptional eigenvalue is identified, which lies in the middle of the bulk and could therefore not be distinguished from bulk eigenvalues in numerical calculations on <italic>W</italic>.</p>
<p>The second difference compared to the two-population scenario is the fact that the constant vector is not any more an eigenvector of an exceptional eigenvalue. Instead, the eigenvectors of the baseline system <italic>Q</italic> are only population-wise constant (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7D</xref> inset). However, also the input perturbation is not proportional to the constant vector in this case. For each population, it depends on the sensitivity to thalamic input, also resulting in a population-wise constant function. In order to study the input-output behavior, the input can therefore be decomposed into the eight eigenvectors (cf. <xref ref-type="fig" rid="pcbi.1007080.g008">Fig 8</xref> left)
<disp-formula id="pcbi.1007080.e081"><alternatives><graphic id="pcbi.1007080.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e081" xlink:type="simple"/><mml:math display="block" id="M81"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:munderover><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Here, Ψ<sub><italic>i</italic></sub> are the eigenvectors of <italic>Q</italic> and <italic>ξ</italic><sub><italic>i</italic></sub> are the coefficients of the modes. The weighted components <italic>ξ</italic><sub><italic>i</italic></sub>Ψ<sub><italic>i</italic></sub> can be considered as the <italic>input modes</italic> of the input perturbation Δ<italic>β</italic><sub><italic>B</italic></sub>. The eight modes which represent the perturbation of the stimulation are shown in the inset of <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7D</xref>. Note that the sum over these modes is identical to Δ<italic>β</italic><sub><italic>B</italic></sub> in <xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6B</xref>. Applying the decomposition to the linear baseline system of <xref ref-type="disp-formula" rid="pcbi.1007080.e082">Eq 14</xref> results in a decomposition of the output rates of the network, where the eight exceptional eigenvalues define the gain factors of the individual modes by (<xref ref-type="fig" rid="pcbi.1007080.g008">Fig 8</xref> right)
<disp-formula id="pcbi.1007080.e082"><alternatives><graphic id="pcbi.1007080.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e082" xlink:type="simple"/><mml:math display="block" id="M82"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:munderover><mml:msub><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(14)</label></disp-formula>
The transformed gain factors <inline-formula id="pcbi.1007080.e083"><alternatives><graphic id="pcbi.1007080.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msub><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are shown in <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7C</xref>. The individual parts of this decomposition can be considered as <italic>output modes</italic> of the system, with a direct one-to-one relation to the input modes. The effect of the exceptional eigenvalues λ is quite similar to the two-population scenario described previously, where the single exceptional eigenvalue defined the gain of the homogeneous common mode. In the multi-population case, each input mode is amplified with the respective gain <inline-formula id="pcbi.1007080.e084"><alternatives><graphic id="pcbi.1007080.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:msub><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> to form the output perturbation of the network. The eight output modes are shown in <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7D</xref>. Note that, similar to the input perturbation Δ<italic>β</italic><sub><italic>B</italic></sub>, the sum of the modes is identical to the baseline component Δ<italic>ν</italic><sub><italic>B</italic></sub> shown in <xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6C</xref>.</p>
<fig id="pcbi.1007080.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Eigenmode decomposition of input and output.</title>
<p>Left: The baseline component of the input perturbation Δ<italic>β</italic><sub><italic>B</italic></sub> is decomposed into the eight input modes <italic>ξ</italic><sub><italic>i</italic></sub>Ψ<sub><italic>i</italic></sub>. Center: By the network action, each mode is amplified or attenuated by its individual gain factor <inline-formula id="pcbi.1007080.e085"><alternatives><graphic id="pcbi.1007080.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:msub><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. Right: The sum of all scaled output modes <inline-formula id="pcbi.1007080.e086"><alternatives><graphic id="pcbi.1007080.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> results in the baseline component of the output perturbation Δ<italic>ν</italic><sub><italic>B</italic></sub>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.g008" xlink:type="simple"/>
</fig>
<p>Studying the output modes in more detail, it is apparent that the high rates of L5e neurons, and thus also their low orientation selectivity, are mostly due to one specific mode (orange line in <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7D</xref>). On the other hand, the same mode has a similar strength as the other components in the input space (orange line, <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7D</xref> inset). As the corresponding eigenvalue of <italic>W</italic> has a very small magnitude, however, the gain factor <inline-formula id="pcbi.1007080.e087"><alternatives><graphic id="pcbi.1007080.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> of that mode is much larger compared to the other modes (<xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7C</xref>, orange dot). Due to this gain, the mode is dominant in the output rate change, resulting in high firing rates in L5e. The fact that only a single mode is responsible for this strong amplification underlines our conclusion that this effect is a feature of the whole network, which cannot be pinned down to one specific connection in a meaningful way. Importantly, although the eigenvalue spectrum and mode structure can change to some degree, the observation that a single mode with a strong gain is responsible for the high rates of L5e is consistent for all parameter sets considered (<xref ref-type="supplementary-material" rid="pcbi.1007080.s004">S4F/S4G/S4H</xref>–<xref ref-type="supplementary-material" rid="pcbi.1007080.s009">S9F/S9G/S9H</xref> Figs).</p>
</sec>
<sec id="sec022">
<title>Predictions for new stimulation experiments</title>
<p>Having identified the large gain of a specific mode in the input as the source of the high firing rates in L5e, we now apply our theory to predict the network behavior for a scenario, where that particular mode is absent in the input. For two reasons the mode cannot be directly removed from the input firing rates. First, that mode has non-zero coefficients for all populations, which leads to non-zero thalamic input also to L2/3 and L5. While it is technically possible to implement this in a computational model, it is infeasible as a biological experiment. The second problem is more fundamental: Subtracting the mode from the input perturbation would lead to negative firing rates, which cannot be realized. Therefore, instead of using altered Poisson input to neurons, we designed an external current stimulation, which has an equivalent effect on the neuronal output rates. It is conceivable to realize such an input, for example by specific optogenetic stimulation. In the linear model (Model C), an external current results in an additional input perturbation Δ<italic>γ</italic> such that
<disp-formula id="pcbi.1007080.e088"><alternatives><graphic id="pcbi.1007080.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e088" xlink:type="simple"/><mml:math display="block" id="M88"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mrow><mml:mo>(</mml:mo><mml:mo>Δ</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
In order to delete a specific mode Ψ<sub><italic>k</italic></sub> from the input, we can set Δ<italic>γ</italic> = −<italic>ξ</italic><sub><italic>k</italic></sub>Ψ<sub><italic>k</italic></sub>. As a consequence, when the two inputs Δ<italic>β</italic> and Δ<italic>γ</italic> are combined, the mode cancels out, resulting in altered output perturbation.</p>
<p>The required input current for single neurons in each population are shown in <xref ref-type="fig" rid="pcbi.1007080.g009">Fig 9A</xref>. They are not directly proportional to the deleted mode, due to the scaling by the individual feed-forward gain of each population, as well as due to the highly recurrent processing of the network. As expected, since the rate of L5e neurons should be suppressed, these neurons receive a strongly negative current. More surprisingly, L2/3e requires a positive input current of similar magnitude, although the desired change in rate of that population is much smaller.</p>
<fig id="pcbi.1007080.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007080.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Predictions for future current stimulation experiments.</title>
<p><bold>A-C</bold> Current stimulus 1: Effective deletion of a distinct mode from the input. <bold>D-F</bold> Current stimulus 2: Selective suppression of L5e activity. <bold>A,D</bold> Single neuron current stimulation required to achieve the effect. <bold>B,E</bold> Change of the mean rate of excitatory populations upon current stimulation. Inhibitory populations are omitted for simplicity. x-axis shows current intensity relative to values in A,D, respectively. In all panels, lines represent the linear model (Model C), and dashed lines the spiking neural network simulations (Model A). <bold>C,F</bold> Change of orientation selectivity in L2/3e and L5e due to the two different current stimulations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.g009" xlink:type="simple"/>
</fig>
<p>When the current is applied with an intensity that exactly removes the mode from the input, the change in output exactly matches the sum of the remaining modes (<xref ref-type="fig" rid="pcbi.1007080.g009">Fig 9B</xref>, relative intensity 1). For stronger stimulation intensities, the input mode is overcompensated. The mean population rates of the linearized network and spiking network model are in good agreement. Also in the spiking neural network model, the mean rates change almost linearly, even if the input mode is overcompensated by a factor of two.</p>
<p>As expected, the reduction of L5e firing rates leads to an increase in orientation selectivity of 250% from 0.02 to 0.07 in the linearized network model (75% in the spiking network model, <xref ref-type="fig" rid="pcbi.1007080.g009">Fig 9C</xref>). Simultaneously, due to the increase in firing rate in L2/3e, the orientation selectivity of this population decreases by 66% from 0.12 to 0.04 in the linearized network model (25% in the spiking network model). The discrepancy between the OSI of the spiking and linearized network model can be partially explained by the bias of random tuning due to the fluctuations of the spiking process, which were also the reason for non-zero OSIs observed in the spontaneous, unstimulated condition in <xref ref-type="fig" rid="pcbi.1007080.g004">Fig 4B</xref>. Other contributions could come from a weak crosstalk between the baseline and modulation pathways, or from deviations from the assumptions of Poisson firing statistics and negligible correlations.</p>
<p>Effectively deleting the mode from the input is not the only option to reduce the activity of L5e neurons. From our analytic calculations, all feed-forward and recurrent baseline gains are known. Exploiting this knowledge, we can design yet another current stimulus that exclusively affects L5e neurons, leaving the mean firing rates of all other populations unchanged (<xref ref-type="sec" rid="sec002">Methods</xref>). The desired change of rates for this stimulus can be conveniently summarized in a vector Δ<italic>ν</italic><sup>L5e</sup>. This vector is zero for all populations except L5e. For this population, it contains the negative of the mean rates in the stimulation condition such that the resulting rates vanish. The required effective external perturbation can then be calculated by
<disp-formula id="pcbi.1007080.e089"><alternatives><graphic id="pcbi.1007080.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007080.e089" xlink:type="simple"/><mml:math display="block" id="M89"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>Δ</mml:mo><mml:msup><mml:mi>ν</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msup><mml:mn>5</mml:mn><mml:mi mathvariant="normal">e</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
which are the external currents scaled with the known neuron sensitivities.</p>
<p>The required stimulation currents are shown in <xref ref-type="fig" rid="pcbi.1007080.g009">Fig 9D</xref>. Surprisingly, in this case, the input currents to L5e neurons all need to be positive, although the desired effect on the output rates is negative, and the rates of these neurons are reduced. It is also interesting that input currents to all neurons except L4 are of similar strength. It is clear that the other populations also require substantial stimulation to maintain their original rate, since the altered rate of L5e neurons needs to be compensated. However, the magnitude of these currents surprises as L5 does not serve as a major input to any other population within the network (Figs <xref ref-type="fig" rid="pcbi.1007080.g001">1B</xref> and <xref ref-type="fig" rid="pcbi.1007080.g005">5A</xref>). This highlights again the strongly recurrent and often unintuitive nature of such networks.</p>
<p>
<xref ref-type="fig" rid="pcbi.1007080.g009">Fig 9E</xref> shows that the new current stimulus successfully reduces the rate of L5e neurons, while keeping all other firing rates unchanged. Similar to the first current stimulus discussed above, the two models match quite well. Only for strong stimulation intensities, when the rates of L5e neurons approach zero, the two models show discrepancies. In this regime, the rates of L5e begin to be rectified. Since this is a non-linear effect, it can of course not be captured by the linearized version of the model.</p>
<p>Analogously to our first prediction for current stimulation, L5e neurons show a strong increase in orientation selectivity (<xref ref-type="fig" rid="pcbi.1007080.g009">Fig 9F</xref>). In the linear model, the OSI rises very sharply for large current intensities. This is an artifact of the neglected rectification of neuron rates, as already observed above. In the more realistic spiking network model (Model A), the OSI also increases strongly by about 150% (from 0.04 to 0.1). However, in contrast to the first current stimulus discussed above, in this case orientation selectivity of L2/3e neurons is not compromised by the additional input currents. The OSIs of the other excitatory and inhibitory populations also remain unchanged.</p>
</sec>
</sec>
<sec id="sec023" sec-type="conclusions">
<title>Discussion</title>
<sec id="sec024">
<title>Model</title>
<p>The goal of this work was to study signal propagation across layers in primary visual cortex of rodents, with a particular focus on the emergence of orientation tuning in layers that have no direct access to thalamic input. We decided to employ a model that was developed previously by Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>]. The synaptic connectivity defining this model was rigorously derived from the results of anatomical and electrophysiological measurements. The parameters describing neuronal connectivity depend on the pre-synaptic and post-synaptic population, but they do not depend on the functional properties (tuning) of individual neurons. Furthermore, in order to focus our analysis on the impact of neuronal connectivity on dynamics, single-neuron parameters were chosen the same for all neurons, independently of the population they belong to.</p>
<p>Since not all required connectivity data are available, Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>] combined data from different species (cat and rat) into one single generic model circuit. In addition, the measurements were performed in several different brain regions, so it is debatable whether this model can account for information processing in mouse visual cortex at all. In view of this, it may be surprising that the predictions of our study with regard to neuronal activity are in very good agreement with direct electrophysiological measurements performed in mouse visual cortex. This finding is in fact compatible with the idea of a universal cortical circuit which is found in different species and in different cortical regions devoted to the processing of sensory information. It will be interesting to see to which degree a neural network model based on the full mouse/rat visual cortex connectome (when it becomes available) deviates from the present model.</p>
<p>In our work, the model proposed by Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>] was extended by adding neuron-specific thalamic input, which is tuned to the orientation of a visual stimulus, i.e., a moving grating. This input was provided to both the excitatory and inhibitory populations in L4 and L6. From experiments, it is known that neurons modulate their firing rate with the temporal frequency of the grating [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref003">3</xref>]. However, in order to keep the already complex model and analysis as simple as possible, we did not include this aspect of visual processing into our considerations. In fact, our analysis showed that the cortical network operates in a quasi-linear regime. Therefore, we expect that the additional temporal modulation of firing rates would not have a significant impact on the mean values studied and reported here.</p>
<p>Via random connections, the very weak orientation bias in the input was enough to induce strong orientation tuning in L2/3; see Hansel and van Vreeswijk [<xref ref-type="bibr" rid="pcbi.1007080.ref007">7</xref>] and Sadeh et al. [<xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref017">17</xref>] for an analysis of this generic effect. Note, however, that we did not make any assumptions about the origin of the orientation bias in the input. It could be a consequence of the alignment of the receptive fields of afferent neurons [<xref ref-type="bibr" rid="pcbi.1007080.ref039">39</xref>], or it could be inherited from already tuned thalamic neurons [<xref ref-type="bibr" rid="pcbi.1007080.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref041">41</xref>]. While the input was assumed to convey information about a visual stimulus throughout the present study, our analysis of the layered network does not rely on this interpretation. Our approach could therefore also be applied to study feature selectivity in other sensory modalities, like in somatosensory or auditory cortex.</p>
<p>The distributions of orientation selectivity that emerge in our model across the different layers and neuronal populations are qualitatively very similar to experimental recordings [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1007080.ref031">31</xref>] (see also [<xref ref-type="bibr" rid="pcbi.1007080.ref042">42</xref>] for some inconclusive results). This represents a remarkable result, as the model is based on measured connectivity in different cortical regions in different species, and it was not at all designed and tuned as a specific model of rodent visual cortex. Furthermore, the recordings cited above were performed in adult mice, which are known to have some degree of feature-specific connectivity. Our model, in contrast, entirely lacks specific connectivity, resembling the situation at eye opening [<xref ref-type="bibr" rid="pcbi.1007080.ref014">14</xref>]. Our analysis demonstrates that well-tuned neuronal responses can emerge in all cortical layers without feature-specific connections between neurons. On the other hand, it is known that specific connectivity can work as a concurrent mechanism to improve orientation selectivity and yield the higher values observed experimentally (see also [<xref ref-type="bibr" rid="pcbi.1007080.ref036">36</xref>]).</p>
<p>While the distribution of firing rates in spontaneous and evoked conditions are qualitatively similar to experimental findings [<xref ref-type="bibr" rid="pcbi.1007080.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref003">3</xref>], there are also discrepancies in several respects (<xref ref-type="fig" rid="pcbi.1007080.g002">Fig 2D/2E</xref>). It is difficult to asses the impact of these differences for the findings of our work. However, our results are generally robust to changes in central network parameters, despite considerable rate changes. Therefore, we expect that the neuronal mechanisms described in our work still apply when more precise and detailed models of the microcircuit are developed.</p>
<p>In the present model, the mouse which is subject to visual stimulation is assumed to be non-moving. As shown in a recent study [<xref ref-type="bibr" rid="pcbi.1007080.ref003">3</xref>], neuronal responses in primary visual cortex of rodents are very similar in awake and anesthetized animals. In contrast, the responses dramatically change during locomotion behavior [<xref ref-type="bibr" rid="pcbi.1007080.ref043">43</xref>]. Different inhibitory neuronal subtypes play a central role in this [<xref ref-type="bibr" rid="pcbi.1007080.ref004">4</xref>]. A future enhanced version of our model might account for such effects as well.</p>
</sec>
<sec id="sec025">
<title>Microcircuit perspective</title>
<p>While analyzing network activity in terms of firing rates and orientation tuning, it becomes apparent that a direct interpretation of connectivity cannot fully explain all features of the dynamics observed in network simulations. For example, although afferent connectivity originating from L4e is very similar, firing rates and orientation selectivity in L2/3e and L5e are quite different. As the input is comprised of both excitatory and inhibitory projections that partially cancel each other, a small difference in the input may have strong effects on the operating point the two populations eventually settle in [<xref ref-type="bibr" rid="pcbi.1007080.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref034">34</xref>]. Such effects are not straight-forward to predict, since in a highly recurrent network neuronal output simultaneously also provides input to the same network. Sometimes this leads to non-intuitive effects like effective inhibitory influence of excitatory neuron populations [<xref ref-type="bibr" rid="pcbi.1007080.ref035">35</xref>]. To master such difficulties in the analysis, a system-level view of complex microcircuits is inevitable [<xref ref-type="bibr" rid="pcbi.1007080.ref044">44</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref045">45</xref>].</p>
</sec>
<sec id="sec026">
<title>Baseline and modulation pathways</title>
<p>Previously, inhibition dominated recurrent networks were shown to exhibit two distinct processing pathways [<xref ref-type="bibr" rid="pcbi.1007080.ref008">8</xref>]. While the untuned and uninformative component (baseline) of the input is strongly attenuated by the recurrent network, the modulated component, which conveys all the information about the stimulus, has a much higher gain. This results in a net amplification of feature selectivity through the input-output transformation exerted by the network.</p>
<p>By separating the (linearized) layered model into two systems, we were able to analytically calculate the feed-forward and recurrent gains of the baseline pathway also for a multi-population system. In combination, these two gains describe how the input to one population affects the output of any other population. In contrast to our model, neurons in the model of Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1007080.ref002">2</xref>] have binomially distributed in-degrees, leading to a certain degree of cross-talk between the two pathways by non-vanishing interference terms in <xref ref-type="disp-formula" rid="pcbi.1007080.e065">Eq 12</xref>. While this introduces some discrepancies between the direct and separate solutions of the linear model, it does not impair the described mechanism.</p>
<p>It should be emphasized that the separation between baseline and modulation pathways, its different gains, and thus also tuning amplification are purely linear effects. This is possible, as a linear transformation may impose different scaling factors to different input components.</p>
</sec>
<sec id="sec027">
<title>Mode decomposition</title>
<p>Instead of analyzing the operation of a network from the viewpoint of neuronal populations, we chose a basis that is more natural for the network in question. We decomposed the input into eigenmodes of the system, where the eigenvalues of the effective connectivity correspond to the gains of the individual input modes. Interestingly, the high gain of L5e can be attributed to a single mode, which has a much higher gain than all the other modes. Due to this mode, L5e neurons exhibit a high firing rate and a weak selectivity for stimulus orientation.</p>
<p>What is the functional significance of having a mode with this exceptionally high gain? For a preliminary answer, it is important to take into consideration that the different populations in the layered cortical network play different roles for information processing. For instance, L2/3e neurons project to higher brain areas and need to transmit information in a reliable way [<xref ref-type="bibr" rid="pcbi.1007080.ref046">46</xref>]. Therefore, it is desirable that this population has a strong attenuation of the baseline and, thus, strong tuning amplification. L5e neurons, on the other hand, mainly project to sub-cortical brain regions, including thalamus [<xref ref-type="bibr" rid="pcbi.1007080.ref047">47</xref>]. It is likely that this population is involved in feedback control mechanisms, where tuning information may be less relevant.</p>
</sec>
<sec id="sec028">
<title>Predictions for optogenetic intervention</title>
<p>Using the theory developed in this work, we are in the position to devise external (e.g. optogenetically applied) stimuli which effectively manipulate the orientation tuning of L5e neurons. We designed two different such stimuli which reduce the mean firing rates of these neurons, thus increasing their tuning. Interestingly, although the effect on the rate of L5e is identical, one stimulus requires a positive current, while the other utilizes a negative current. This can be explained by the indirect effect of the stimulus on other populations, propagated via the recurrent network.</p>
<p>Our calculations constitute strong predictions of our model, which can be tested with some effort in experiments. Different subpopulations can be stimulated by a combination of channelrhodopsin and halorhodopsin with different wavelength sensitivities, as described by Klapoetke et al. [<xref ref-type="bibr" rid="pcbi.1007080.ref048">48</xref>], possibly in combination with locally confined optical stimulation.</p>
<p>Throughout our study, and in particular for the derived predictions, the consistency of results between the spiking network and the linear model are remarkable. Only for very strong stimulation, when non-linear rectification sets in, some deviations become evident. This confirms previous findings that a network of highly nonlinear neurons can be effectively linearized about its dynamical operating point, which corresponds to the balanced state of the excitatory-inhibitory network [<xref ref-type="bibr" rid="pcbi.1007080.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1007080.ref034">34</xref>].</p>
<p>In our work, the newly developed mathematical tools were applied to design current stimuli which effectively and selectively suppress L5e activity. In our model, all rate gains are known from the decomposition into baseline and modulation pathways. Therefore, other types of experiments can be performed as well, even for complex multi-population networks different from the primary visual cortex. This makes the suggested method an ideal tool for the design of external current stimuli in a large variety of experiments.</p>
<p>In summary, we presented a novel method for analyzing the dynamics of multi-population networks in terms of their input-output relations. We applied the approach to the analysis of a layered model of rodent visual cortex, revealing interesting and to some degree also unexpected and non-intuitive consequences of the underlying connectivity. In addition, we derived predictions for future optogenetic experiments, which could be performed to test the power of our computational analysis.</p>
</sec>
</sec>
<sec id="sec029">
<title>Supporting information</title>
<supplementary-material id="pcbi.1007080.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Correlation and spike regularity in the spontaneous condition.</title>
<p><bold>A-B</bold> Mean and standard deviation of spike count correlations between neurons from different populations. A bin size of 10 ms was used. <bold>C</bold> Distributions of the coefficient of variation of inter-spike-intervals for neurons in different populations. Same quantiles as described in <xref ref-type="fig" rid="pcbi.1007080.g002">Fig 2</xref> are shown.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007080.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Correlation and spike regularity in the stimulated condition.</title>
<p><bold>A-B</bold> Mean and standard deviation of spike count correlations between neurons from different populations. A bin size of 10 ms was used. <bold>C</bold> Distributions of the coefficient of variation of inter-spike-intervals for neurons in different populations. Same quantiles as described in <xref ref-type="fig" rid="pcbi.1007080.g002">Fig 2</xref> are shown.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007080.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Characteristic quantities compared over parameter sets.</title>
<p><bold>A</bold> Abbreviations used in other panels. <bold>B</bold> Mean and SD of correlation coefficient over all populations. <bold>C</bold> Mean and SD of CV of inter-spike-intervals over all populations. <bold>D</bold> Coefficient of determination (<italic>R</italic><sup>2</sup>) quantifying the fit between a direct linear solution and a baseline and modulation decomposition. <bold>E</bold> Magnitudes of interference terms in <xref ref-type="disp-formula" rid="pcbi.1007080.e065">Eq 12</xref> on logarithmic scale (blue: Δ<italic>β</italic>, red: <italic>Q</italic>Δ<italic>ν</italic><sub><italic>M</italic></sub>, green: <italic>S</italic>Δ<italic>ν</italic><sub><italic>B</italic></sub>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007080.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Central results summarized for standard parameter set.</title>
<p><bold>A/B</bold> Mean firing rates for spontaneous and stimulated condition. For each population, the results of the spiking model (Model A, top), nonlinear rate model (Model B, middle) and linear model (Model C, bottom) are shown. <bold>C</bold> Mean orientation selectivities for stimulated condition for all three models. <bold>D</bold> Raster plot for the stimulated condition for 250 ms of 500 neurons in each population. <bold>E</bold> Comparison of baseline and modulation solution with direct solution of the linear model (cf. <xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6C</xref>). <bold>F</bold> Eigenvalue spectrum of the effective connectivity <italic>W</italic> (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7B</xref>). <bold>G</bold> Input perturbation Δ<italic>β</italic><sub><italic>B</italic></sub> (inset) and output perturbation Δ<italic>ν</italic><sub><italic>B</italic></sub> decomposed into input and output modes, respectively (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7D</xref>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007080.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Central results summarized for high background parameter set.</title>
<p><bold>A/B</bold> Mean firing rates for spontaneous and stimulated condition. For each population, the results of the spiking model (Model A, top), nonlinear rate model (Model B, middle) and linear model (Model C, bottom) are shown. <bold>C</bold> Mean orientation selectivities for stimulated condition for all three models. <bold>D</bold> Raster plot for the stimulated condition for 250 ms of 500 neurons in each population. <bold>E</bold> Comparison of baseline and modulation solution with direct solution of the linear model (cf. <xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6C</xref>). <bold>F</bold> Eigenvalue spectrum of the effective connectivity <italic>W</italic> (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7B</xref>). <bold>G</bold> Input perturbation Δ<italic>β</italic><sub><italic>B</italic></sub> (inset) and output perturbation Δ<italic>ν</italic><sub><italic>B</italic></sub> decomposed into input and output modes, respectively (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7D</xref>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007080.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Central results summarized for low background parameter set.</title>
<p><bold>A/B</bold> Mean firing rates for spontaneous and stimulated condition. For each population, the results of the spiking model (Model A, top), nonlinear rate model (Model B, middle) and linear model (Model C, bottom) are shown. <bold>C</bold> Mean orientation selectivities for stimulated condition for all three models. <bold>D</bold> Raster plot for the stimulated condition for 250 ms of 500 neurons in each population. <bold>E</bold> Comparison of baseline and modulation solution with direct solution of the linear model (cf. <xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6C</xref>). <bold>F</bold> Eigenvalue spectrum of the effective connectivity <italic>W</italic> (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7B</xref>). <bold>G</bold> Input perturbation Δ<italic>β</italic><sub><italic>B</italic></sub> (inset) and output perturbation Δ<italic>ν</italic><sub><italic>B</italic></sub> decomposed into input and output modes, respectively (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7D</xref>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007080.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Central results summarized for strong inhibition parameter set.</title>
<p><bold>A/B</bold> Mean firing rates for spontaneous and stimulated condition. For each population, the results of the spiking model (Model A, top), nonlinear rate model (Model B, middle) and linear model (Model C, bottom) are shown. <bold>C</bold> Mean orientation selectivities for stimulated condition for all three models. <bold>D</bold> Raster plot for the stimulated condition for 250 ms of 500 neurons in each population. <bold>E</bold> Comparison of baseline and modulation solution with direct solution of the linear model (cf. <xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6C</xref>). <bold>F</bold> Eigenvalue spectrum of the effective connectivity <italic>W</italic> (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7B</xref>). <bold>G</bold> Input perturbation Δ<italic>β</italic><sub><italic>B</italic></sub> (inset) and output perturbation Δ<italic>ν</italic><sub><italic>B</italic></sub> decomposed into input and output modes, respectively (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7D</xref>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007080.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Central results summarized for strong synapses parameter set.</title>
<p><bold>A/B</bold> Mean firing rates for spontaneous and stimulated condition. For each population, the results of the spiking model (Model A, top), nonlinear rate model (Model B, middle) and linear model (Model C, bottom) are shown. <bold>C</bold> Mean orientation selectivities for stimulated condition for all three models. <bold>D</bold> Raster plot for the stimulated condition for 250 ms of 500 neurons in each population. <bold>E</bold> Comparison of baseline and modulation solution with direct solution of the linear model (cf. <xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6C</xref>). <bold>F</bold> Eigenvalue spectrum of the effective connectivity <italic>W</italic> (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7B</xref>). <bold>G</bold> Input perturbation Δ<italic>β</italic><sub><italic>B</italic></sub> (inset) and output perturbation Δ<italic>ν</italic><sub><italic>B</italic></sub> decomposed into input and output modes, respectively (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7D</xref>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007080.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Central results summarized for low connectivity parameter set.</title>
<p><bold>A/B</bold> Mean firing rates for spontaneous and stimulated condition. For each population, the results of the spiking model (Model A, top), nonlinear rate model (Model B, middle) and linear model (Model C, bottom) are shown. <bold>C</bold> Mean orientation selectivities for stimulated condition for all three models. <bold>D</bold> Raster plot for the stimulated condition for 250 ms of 500 neurons in each population. <bold>E</bold> Comparison of baseline and modulation solution with direct solution of the linear model (cf. <xref ref-type="fig" rid="pcbi.1007080.g006">Fig 6C</xref>). <bold>F</bold> Eigenvalue spectrum of the effective connectivity <italic>W</italic> (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7B</xref>). <bold>G</bold> Input perturbation Δ<italic>β</italic><sub><italic>B</italic></sub> (inset) and output perturbation Δ<italic>ν</italic><sub><italic>B</italic></sub> decomposed into input and output modes, respectively (cf. <xref ref-type="fig" rid="pcbi.1007080.g007">Fig 7D</xref>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007080.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Comparison of orientation selectivity measures.</title>
<p>Left column: Distribution of orientation selectivity measure based on circular statistics (OSI). Middle column: Orientation selectivity measure based on cosine fit (OSI*). Right column: Comparison of the two orientation selectivity measures. Each dot represents a single neuron in the respective population.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007080.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007080.s011" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Model comparison.</title>
<p>Comparison of the three central observables of the different network models. Top row: single neuron firing rates, middle row: preferred orientation (PO), bottom row: orientation selectivity index (OSI). The first column compares the spiking network model (Model A) with the firing rate model (Model B), the second column compares the firing rate model with linearized network model (Model C) and the third column compares the spiking network model with the linearized network model. Same color code is used as in previous figures to indicate the eight different populations.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Uwe Grauer from the Bernstein Center Freiburg as well as Bernd Wiebelt and Michael Janczyk from the Freiburg University Computing Center for their assistance with HPC applications and the developers of the neural simulation tool NEST. Furthermore, we thank Michael Kordovan for helpful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1007080.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Niell</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Stryker</surname> <given-names>MP</given-names></name>. <article-title>Highly selective receptive fields in mouse visual cortex</article-title>. <source>Journal of Neuroscience</source>. <year>2008</year>;<volume>28</volume>(<issue>30</issue>):<fpage>7520</fpage>–<lpage>7536</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.0623-08.2008" xlink:type="simple">10.1523/JNEUROSCI.0623-08.2008</ext-link></comment> <object-id pub-id-type="pmid">18650330</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Potjans</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>. <article-title>The Cell-Type Specific Cortical Microcircuit: Relating Structure and Activity in a Full-Scale Spiking Network Model</article-title>. <source>Cerebral Cortex</source>. <year>2014</year>;<volume>24</volume>:<fpage>785</fpage>–<lpage>806</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/bhs358" xlink:type="simple">10.1093/cercor/bhs358</ext-link></comment> <object-id pub-id-type="pmid">23203991</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Durand</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Iyer</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Mizuseki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>de Vries</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mihalas</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>. <article-title>A comparison of visual response properties in the lateral geniculate nucleus and primary visual cortex of awake and anesthetized mice</article-title>. <source>Journal of Neuroscience</source>. <year>2016</year>;<volume>36</volume>(<issue>48</issue>):<fpage>12144</fpage>–<lpage>12156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1741-16.2016" xlink:type="simple">10.1523/JNEUROSCI.1741-16.2016</ext-link></comment> <object-id pub-id-type="pmid">27903724</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pakan</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Lowe</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Dylda</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Keemink</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Currie</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Coutts</surname> <given-names>CA</given-names></name>, <etal>et al</etal>. <article-title>Behavioral-state modulation of inhibition is context-dependent and cell type specific in mouse visual cortex</article-title>. <source>Elife</source>. <year>2016</year>;<volume>5</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.14985" xlink:type="simple">10.7554/eLife.14985</ext-link></comment> <object-id pub-id-type="pmid">27552056</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Amit</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>Model of global spontaneous activity and local structured activity during delay periods in the cerebral cortex</article-title>. <source>Cerebral Cortex</source>. <year>1997</year>;<volume>7</volume>(<issue>3</issue>):<fpage>237</fpage>–<lpage>252</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/7.3.237" xlink:type="simple">10.1093/cercor/7.3.237</ext-link></comment> <object-id pub-id-type="pmid">9143444</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>Dynamics of sparsely connected networks of excitatory and inhibitory spiking neurons</article-title>. <source>Journal of Computational Neuroscience</source>. <year>2000</year>;<volume>8</volume>(<issue>3</issue>):<fpage>183</fpage>–<lpage>208</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1023/A:1008925309027" xlink:type="simple">10.1023/A:1008925309027</ext-link></comment> <object-id pub-id-type="pmid">10809012</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hansel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>van Vreeswijk</surname> <given-names>C</given-names></name>. <article-title>The mechanism of orientation selectivity in primary visual cortex without a functional map</article-title>. <source>Journal of Neuroscience</source>. <year>2012</year>;<volume>32</volume>(<issue>12</issue>):<fpage>4049</fpage>–<lpage>4064</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.6284-11.2012" xlink:type="simple">10.1523/JNEUROSCI.6284-11.2012</ext-link></comment> <object-id pub-id-type="pmid">22442071</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sadeh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cardanobile</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Mean-field analysis of orientation selectivity in inhibition-dominated networks of spiking neurons</article-title>. <source>SpringerPlus</source>. <year>2014</year>;<volume>3</volume>(<issue>1</issue>):<fpage>148</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/2193-1801-3-148" xlink:type="simple">10.1186/2193-1801-3-148</ext-link></comment> <object-id pub-id-type="pmid">24790806</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hubel</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Wiesel</surname> <given-names>TN</given-names></name>. <article-title>Receptive fields of single neurones in the cat’s striate cortex</article-title>. <source>The Journal of Physiology</source>. <year>1959</year>;<volume>148</volume>(<issue>3</issue>):<fpage>574</fpage>–<lpage>591</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1113/jphysiol.1959.sp006308" xlink:type="simple">10.1113/jphysiol.1959.sp006308</ext-link></comment> <object-id pub-id-type="pmid">14403679</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ohki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chung</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ch’ng</surname> <given-names>YH</given-names></name>, <name name-style="western"><surname>Kara</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>. <article-title>Functional imaging with cellular resolution reveals precise micro-architecture in visual cortex</article-title>. <source>Nature</source>. <year>2005</year>;<volume>433</volume>(<issue>7026</issue>):<fpage>597</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature03274" xlink:type="simple">10.1038/nature03274</ext-link></comment> <object-id pub-id-type="pmid">15660108</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jia</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Rochefort</surname> <given-names>NL</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Konnerth</surname> <given-names>A</given-names></name>. <article-title>Dendritic organization of sensory input to cortical neurons in vivo</article-title>. <source>Nature</source>. <year>2010</year>;<volume>464</volume>(<issue>7293</issue>):<fpage>1307</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature08947" xlink:type="simple">10.1038/nature08947</ext-link></comment> <object-id pub-id-type="pmid">20428163</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Pichler</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Buchanan</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Sjöström</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name>. <article-title>Functional specificity of local synaptic connections in neocortical networks</article-title>. <source>Nature</source>. <year>2011</year>;<volume>473</volume>(<issue>7345</issue>):<fpage>87</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature09880" xlink:type="simple">10.1038/nature09880</ext-link></comment> <object-id pub-id-type="pmid">21478872</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Pichler</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Vogelstein</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ros</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Differential connectivity and response dynamics of excitatory and inhibitory neurons in visual cortex</article-title>. <source>Nature Neuroscience</source>. <year>2011</year>;<volume>14</volume>(<issue>8</issue>):<fpage>1045</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2876" xlink:type="simple">10.1038/nn.2876</ext-link></comment> <object-id pub-id-type="pmid">21765421</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Cossell</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Baragli</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Antolik</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Clopath</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>, <etal>et al</etal>. <article-title>The emergence of functional microcircuits in visual cortex</article-title>. <source>Nature</source>. <year>2013</year>;<volume>496</volume>(<issue>7443</issue>):<fpage>96</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature12015" xlink:type="simple">10.1038/nature12015</ext-link></comment> <object-id pub-id-type="pmid">23552948</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pehlevan</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Selectivity and sparseness in randomly connected balanced networks</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>2</issue>):<fpage>e89992</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0089992" xlink:type="simple">10.1371/journal.pone.0089992</ext-link></comment> <object-id pub-id-type="pmid">24587172</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sadeh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Distribution of orientation selectivity in recurrent networks of spiking neurons with different random topologies</article-title>. <source>PloS one</source>. <year>2014</year>;<volume>9</volume>(<issue>12</issue>):<fpage>e114237</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0114237" xlink:type="simple">10.1371/journal.pone.0114237</ext-link></comment> <object-id pub-id-type="pmid">25469704</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sadeh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Orientation selectivity in inhibition-dominated networks of spiking neurons: effect of single neuron properties and network dynamics</article-title>. <source>PLoS Computational Biology</source>. <year>2015</year>;<volume>11</volume>(<issue>1</issue>):<fpage>e1004045</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004045" xlink:type="simple">10.1371/journal.pcbi.1004045</ext-link></comment> <object-id pub-id-type="pmid">25569445</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thomson</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>West</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bannister</surname> <given-names>AP</given-names></name>. <article-title>Synaptic connections and small circuits involving excitatory and inhibitory neurons in layers 2–5 of adult rat and cat neocortex: triple intracellular recordings and biocytin labelling in vitro</article-title>. <source>Cerebral Cortex</source>. <year>2002</year>;<volume>12</volume>(<issue>9</issue>):<fpage>936</fpage>–<lpage>953</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/12.9.936" xlink:type="simple">10.1093/cercor/12.9.936</ext-link></comment> <object-id pub-id-type="pmid">12183393</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Binzegger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Douglas</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>KA</given-names></name>. <article-title>A quantitative map of the circuit of cat primary visual cortex</article-title>. <source>Journal of Neuroscience</source>. <year>2004</year>;<volume>24</volume>(<issue>39</issue>):<fpage>8441</fpage>–<lpage>8453</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1400-04.2004" xlink:type="simple">10.1523/JNEUROSCI.1400-04.2004</ext-link></comment> <object-id pub-id-type="pmid">15456817</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gewaltig</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>. <article-title>NEST (NEural Simulation Tool)</article-title>. <source>Scholarpedia</source>. <year>2007</year>;<volume>2</volume>(<issue>4</issue>):<fpage>1430</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4249/scholarpedia.1430" xlink:type="simple">10.4249/scholarpedia.1430</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ostojic</surname> <given-names>S</given-names></name>. <article-title>Two types of asynchronous activity in networks of excitatory and inhibitory spiking neurons</article-title>. <source>Nature Neuroscience</source>. <year>2014</year>;<volume>17</volume>(<issue>4</issue>):<fpage>594</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3658" xlink:type="simple">10.1038/nn.3658</ext-link></comment> <object-id pub-id-type="pmid">24561997</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref022">
<label>22</label>
<mixed-citation publication-type="other" xlink:type="simple">Batschelet E. Circular statistics in biology. ACADEMIC PRESS, 111 FIFTH AVE, NEW YORK, NY 10003, 1981, 388. 1981.</mixed-citation>
</ref>
<ref id="pcbi.1007080.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Piscopo</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>El-Danaf</surname> <given-names>RN</given-names></name>, <name name-style="western"><surname>Huberman</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Niell</surname> <given-names>CM</given-names></name>. <article-title>Diverse visual features encoded in mouse lateral geniculate nucleus</article-title>. <source>Journal of Neuroscience</source>. <year>2013</year>;<volume>33</volume>(<issue>11</issue>):<fpage>4642</fpage>–<lpage>4656</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.5187-12.2013" xlink:type="simple">10.1523/JNEUROSCI.5187-12.2013</ext-link></comment> <object-id pub-id-type="pmid">23486939</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Feldmeyer</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lübke</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>. <article-title>Efficacy and connectivity of intracolumnar pairs of layer 2/3 pyramidal cells in the barrel cortex of juvenile rats</article-title>. <source>The Journal of physiology</source>. <year>2006</year>;<volume>575</volume>(<issue>2</issue>):<fpage>583</fpage>–<lpage>602</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1113/jphysiol.2006.105106" xlink:type="simple">10.1113/jphysiol.2006.105106</ext-link></comment> <object-id pub-id-type="pmid">16793907</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Siegert</surname> <given-names>AJ</given-names></name>. <article-title>On the first passage time probability problem</article-title>. <source>Physical Review</source>. <year>1951</year>;<volume>81</volume>(<issue>4</issue>):<fpage>617</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRev.81.617" xlink:type="simple">10.1103/PhysRev.81.617</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Cowan</surname> <given-names>JD</given-names></name>. <article-title>Excitatory and inhibitory interactions in localized populations of model neurons</article-title>. <source>Biophysical Journal</source>. <year>1972</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0006-3495(72)86068-5" xlink:type="simple">10.1016/S0006-3495(72)86068-5</ext-link></comment> <object-id pub-id-type="pmid">4332108</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref027">
<label>27</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hairer</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Nørsett</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Wanner</surname> <given-names>G</given-names></name>. <chapter-title>Solving Ordinary Differential Equations. I</chapter-title>, <source>Springer Series in Computational Mathematics</source>; <year>1993</year>.</mixed-citation>
</ref>
<ref id="pcbi.1007080.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Renart</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>De La Rocha</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bartho</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hollender</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Parga</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>The asynchronous state in cortical circuits</article-title>. <source>Science</source>. <year>2010</year>;<volume>327</volume>(<issue>5965</issue>):<fpage>587</fpage>–<lpage>590</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1179850" xlink:type="simple">10.1126/science.1179850</ext-link></comment> <object-id pub-id-type="pmid">20110507</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Heimel</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Van Hooser</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>SB</given-names></name>. <article-title>Laminar organization of response properties in primary visual cortex of the gray squirrel (Sciurus carolinensis)</article-title>. <source>Journal of neurophysiology</source>. <year>2005</year>;<volume>94</volume>(<issue>5</issue>):<fpage>3538</fpage>–<lpage>3554</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00106.2005" xlink:type="simple">10.1152/jn.00106.2005</ext-link></comment> <object-id pub-id-type="pmid">16000528</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Girman</surname> <given-names>SV</given-names></name>, <name name-style="western"><surname>Sauvé</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lund</surname> <given-names>RD</given-names></name>. <article-title>Receptive field properties of single neurons in rat primary visual cortex</article-title>. <source>Journal of neurophysiology</source>. <year>1999</year>;<volume>82</volume>(<issue>1</issue>):<fpage>301</fpage>–<lpage>311</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.1999.82.1.301" xlink:type="simple">10.1152/jn.1999.82.1.301</ext-link></comment> <object-id pub-id-type="pmid">10400959</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sun</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Tan</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Mensh</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Ji</surname> <given-names>N</given-names></name>. <article-title>Thalamus provides layer 4 of primary visual cortex with orientation-and direction-tuned inputs</article-title>. <source>Nature Neuroscience</source>. <year>2016</year>;<volume>19</volume>(<issue>2</issue>):<fpage>308</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4196" xlink:type="simple">10.1038/nn.4196</ext-link></comment> <object-id pub-id-type="pmid">26691829</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scholl</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Pattadkal</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Dilly</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Priebe</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Zemelman</surname> <given-names>BV</given-names></name>. <article-title>Local integration accounts for weak selectivity of mouse neocortical parvalbumin interneurons</article-title>. <source>Neuron</source>. <year>2015</year>;<volume>87</volume>(<issue>2</issue>):<fpage>424</fpage>–<lpage>436</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2015.06.030" xlink:type="simple">10.1016/j.neuron.2015.06.030</ext-link></comment> <object-id pub-id-type="pmid">26182423</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Van Vreeswijk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Chaos in neuronal networks with balanced excitatory and inhibitory activity</article-title>. <source>Science</source>. <year>1996</year>;<volume>274</volume>(<issue>5293</issue>):<fpage>1724</fpage>–<lpage>1726</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.274.5293.1724" xlink:type="simple">10.1126/science.274.5293.1724</ext-link></comment> <object-id pub-id-type="pmid">8939866</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Van Vreeswijk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Chaotic balanced state in a model of cortical circuits</article-title>. <source>Neural Computation</source>. <year>1998</year>;<volume>10</volume>(<issue>6</issue>):<fpage>1321</fpage>–<lpage>1371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089976698300017214" xlink:type="simple">10.1162/089976698300017214</ext-link></comment> <object-id pub-id-type="pmid">9698348</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tsodyks</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Skaggs</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>. <article-title>Paradoxical effects of external modulation of inhibitory interneurons</article-title>. <source>Journal of Neuroscience</source>. <year>1997</year>;<volume>17</volume>(<issue>11</issue>):<fpage>4382</fpage>–<lpage>4388</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.17-11-04382.1997" xlink:type="simple">10.1523/JNEUROSCI.17-11-04382.1997</ext-link></comment> <object-id pub-id-type="pmid">9151754</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sadeh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Clopath</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Processing of feature selectivity in cortical networks with specific connectivity</article-title>. <source>PloS one</source>. <year>2015</year>;<volume>10</volume>(<issue>6</issue>):<fpage>e0127547</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0127547" xlink:type="simple">10.1371/journal.pone.0127547</ext-link></comment> <object-id pub-id-type="pmid">26083363</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rajan</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Abbott</surname> <given-names>L</given-names></name>. <article-title>Eigenvalue spectra of random matrices for neural networks</article-title>. <source>Physical Review Letters</source>. <year>2006</year>;<volume>97</volume>(<issue>18</issue>):<fpage>188104</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.97.188104" xlink:type="simple">10.1103/PhysRevLett.97.188104</ext-link></comment> <object-id pub-id-type="pmid">17155583</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aljadeff</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Renfrew</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Vegué</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sharpee</surname> <given-names>TO</given-names></name>. <article-title>Low-dimensional dynamics of structured random networks</article-title>. <source>Physical Review E</source>. <year>2016</year>;<volume>93</volume>(<issue>2</issue>):<fpage>022302</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.93.022302" xlink:type="simple">10.1103/PhysRevE.93.022302</ext-link></comment> <object-id pub-id-type="pmid">26986347</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hubel</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Wiesel</surname> <given-names>TN</given-names></name>. <article-title>Receptive fields, binocular interaction and functional architecture in the cat’s visual cortex</article-title>. <source>The Journal of Physiology</source>. <year>1962</year>;<volume>160</volume>(<issue>1</issue>):<fpage>106</fpage>–<lpage>154</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1113/jphysiol.1962.sp006837" xlink:type="simple">10.1113/jphysiol.1962.sp006837</ext-link></comment> <object-id pub-id-type="pmid">14449617</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marshel</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Kaye</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Nauhaus</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Callaway</surname> <given-names>EM</given-names></name>. <article-title>Anterior-posterior direction opponency in the superficial mouse lateral geniculate nucleus</article-title>. <source>Neuron</source>. <year>2012</year>;<volume>76</volume>(<issue>4</issue>):<fpage>713</fpage>–<lpage>720</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2012.09.021" xlink:type="simple">10.1016/j.neuron.2012.09.021</ext-link></comment> <object-id pub-id-type="pmid">23177957</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scholl</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tan</surname> <given-names>AY</given-names></name>, <name name-style="western"><surname>Corey</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Priebe</surname> <given-names>NJ</given-names></name>. <article-title>Emergence of orientation selectivity in the mammalian visual pathway</article-title>. <source>Journal of Neuroscience</source>. <year>2013</year>;<volume>33</volume>(<issue>26</issue>):<fpage>10616</fpage>–<lpage>10624</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.0404-13.2013" xlink:type="simple">10.1523/JNEUROSCI.0404-13.2013</ext-link></comment> <object-id pub-id-type="pmid">23804085</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Van den Bergh</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Arckens</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Chino</surname> <given-names>YM</given-names></name>. <article-title>Receptive-field properties of V1 and V2 neurons in mice and macaque monkeys</article-title>. <source>Journal of Comparative Neurology</source>. <year>2010</year>;<volume>518</volume>(<issue>11</issue>):<fpage>2051</fpage>–<lpage>2070</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/cne.22321" xlink:type="simple">10.1002/cne.22321</ext-link></comment> <object-id pub-id-type="pmid">20394058</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Niell</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Stryker</surname> <given-names>MP</given-names></name>. <article-title>Modulation of visual responses by behavioral state in mouse visual cortex</article-title>. <source>Neuron</source>. <year>2010</year>;<volume>65</volume>(<issue>4</issue>):<fpage>472</fpage>–<lpage>479</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2010.01.033" xlink:type="simple">10.1016/j.neuron.2010.01.033</ext-link></comment> <object-id pub-id-type="pmid">20188652</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>. <article-title>From the neuron doctrine to neural networks</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2015</year>;<volume>16</volume>(<issue>8</issue>):<fpage>487</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn3962" xlink:type="simple">10.1038/nrn3962</ext-link></comment> <object-id pub-id-type="pmid">26152865</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bassett</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Sporns</surname> <given-names>O</given-names></name>. <article-title>Network neuroscience</article-title>. <source>Nature Neuroscience</source>. <year>2017</year>;<volume>20</volume>(<issue>3</issue>):<fpage>353</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4502" xlink:type="simple">10.1038/nn.4502</ext-link></comment> <object-id pub-id-type="pmid">28230844</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Felleman</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Van</surname> <given-names>DE</given-names></name>. <article-title>Distributed hierarchical processing in the primate cerebral cortex</article-title>. <source>Cerebral Cortex</source>. <year>1991</year>;<volume>1</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>47</lpage>. <object-id pub-id-type="pmid">1822724</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sherman</surname> <given-names>SM</given-names></name>. <article-title>Thalamus plays a central role in ongoing cortical functioning</article-title>. <source>Nature Neuroscience</source>. <year>2016</year>;<volume>19</volume>(<issue>4</issue>):<fpage>533</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4269" xlink:type="simple">10.1038/nn.4269</ext-link></comment> <object-id pub-id-type="pmid">27021938</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007080.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Klapoetke</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Murata</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Pulver</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Birdsey-Benson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cho</surname> <given-names>YK</given-names></name>, <etal>et al</etal>. <article-title>Independent optical excitation of distinct neural populations</article-title>. <source>Nature Methods</source>. <year>2014</year>;<volume>11</volume>(<issue>3</issue>):<fpage>338</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.2836" xlink:type="simple">10.1038/nmeth.2836</ext-link></comment> <object-id pub-id-type="pmid">24509633</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>