<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005642</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00604</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Education</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject><subj-group><subject>Infectious disease epidemiology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject><subj-group><subject>Infectious disease epidemiology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Systems science</subject><subj-group><subject>Dynamical systems</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Systems science</subject><subj-group><subject>Dynamical systems</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immunity</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immunity</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject><subj-group><subject>Infectious disease modeling</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Population modeling</subject><subj-group><subject>Infectious disease modeling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population modeling</subject><subj-group><subject>Infectious disease modeling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Computer modeling</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Learning infectious disease epidemiology in a modern framework</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4622-1146</contrib-id>
<name name-style="western">
<surname>Handel</surname>
<given-names>Andreas</given-names>
</name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Department of Epidemiology and Biostatistics and Health Informatics Institute and Center for the Ecology of Infectious Diseases, The University of Georgia, Athens, Georgia, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ouellette</surname>
<given-names>Francis</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Genome Quebec, CANADA</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The author has declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">ahandel@uga.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>19</day>
<month>10</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<month>10</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>10</issue>
<elocation-id>e1005642</elocation-id>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Andreas Handel</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005642"/>
<funding-group>
<funding-statement>This study was partially supported by NIH/NIAID grant U19 AI117891. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="11"/>
</counts>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Education paper.</p>
</disp-quote>
<sec id="sec001">
<title>Summary</title>
<p>Modern infectious disease epidemiology makes heavy use of computational model–based approaches and a dynamical systems perspective. The importance of analyzing infectious diseases in such a way keeps increasing. However, infectious disease epidemiology is still often taught mainly from a medical and classical epidemiological study design (e.g., cohort, case-control) perspective.</p>
<p>While textbooks and other resources that teach a model-based approach to infectious diseases exist, almost any such teaching material requires students to work with mathematical models and write computer code. This is a significant barrier for students who do not have a strong mathematical background or prior coding experience, which applies to many students in public health and related biomedical disciplines. It limits the number of students who can or want to engage with infectious disease epidemiology by using modern, systems modeling–based approaches. New tools and approaches are needed to reach a wider audience and allow students to learn concepts such as the reproductive number, herd immunity, critical community size, and the population-level impact of interventions from a dynamical systems and model perspective, without the obstacles of coding or having to formulate and analyze differential equations.</p>
<p>Here, I describe a new software package for the widely used <monospace>R</monospace> language that allows individuals to explore and study concepts of infectious disease epidemiology by using a modern, dynamical systems model framework, without the need to read or write computer code. The package includes documentation and material to serve as a stand-alone tool—supplemented as needed with provided references—for students to get an introduction to important modern infectious disease concepts. The package is built in a modular way that allows a student to seamlessly continue on their journey of learning infectious disease modeling if they choose to do so. The different ways to use the package are described in detail, and examples are provided.</p>
</sec>
<sec id="sec002">
<title>Background and motivation</title>
<p>Epidemiology has its roots in the study of infectious diseases. While modern epidemiology deals with a host of different health-related topics, infectious diseases are still an important component. The classical study approach of epidemiology, based on randomized controlled trials, cohort studies, case-control studies, and related study designs, can be successfully applied to infectious diseases.</p>
<p>However, this framework of study generally does not account for a crucial aspect of infectious diseases, namely, the nonindependence between individuals. Accounting for interactions between hosts is required to understand important infectious disease concepts such as population-level immunity thresholds, critical community size, or indirect effects of interventions.</p>
<p>On the research side, the importance of such interactions has long been appreciated and is at the core of the infectious disease modeling paradigm, in which one builds and analyzes a system of interacting components (e.g., susceptible and infected hosts). Such systems approaches based on models have a long history in infectious disease epidemiology [<xref ref-type="bibr" rid="pcbi.1005642.ref001">1</xref>,<xref ref-type="bibr" rid="pcbi.1005642.ref002">2</xref>]. The importance of computational methods for the study of infectious diseases continues to increase. However, teaching such computational approaches to students in public health, medicine, and related areas remains a challenge [<xref ref-type="bibr" rid="pcbi.1005642.ref003">3</xref>].</p>
<p>While resources (e.g., textbooks [<xref ref-type="bibr" rid="pcbi.1005642.ref001">1</xref>,<xref ref-type="bibr" rid="pcbi.1005642.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1005642.ref005">5</xref>]) that teach this modern approach to infectious diseases exist, one of the main obstacles is the requirement to write computer code, which tends to be a barrier for students who do not have any prior coding experience. In my own experience teaching a course entitled “Modeling Infectious Diseases,” students often struggled with the mathematical and especially the coding aspects, which interferes with their ability to understand the scientific concepts. If a student intends to become an infectious disease modeler, they undoubtedly need mastery of the mathematical and coding components. However, many students in public health and related disciplines do not intend to become modelers. They will, however, in their future career, likely become consumers of results from modeling studies. Thus, they could still greatly benefit from learning infectious disease epidemiology from the perspective of a dynamically interacting system, without the obstacles of coding and differential equations.</p>
<p>Good examples of ways to teach modern infectious disease epidemiology concepts without requiring students to have computational or mathematical skills are some recent online courses, most notably the course “Epidemics—the Dynamics of Infectious Diseases” [<xref ref-type="bibr" rid="pcbi.1005642.ref006">6</xref>], developed by faculty from Penn State University, and the course “Epidemics,” developed by faculty from Hong Kong University [<xref ref-type="bibr" rid="pcbi.1005642.ref007">7</xref>]. While these courses are excellent resources, they consist of passive learning, with students mainly watching lectures. Active learning, i.e., directly interacting with the material, often leads to better learning outcomes [<xref ref-type="bibr" rid="pcbi.1005642.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1005642.ref009">9</xref>]. Computer simulations are an ideal method for facilitating such active learning. Furthermore, exposure to computer simulations can provide a familiarity with such tools that will greatly enhance the students' ability to assess and integrate results from models into their future decision-making, even if the student will never build their own model. Lastly, a gentle introduction to computational approaches can help to lower entry barriers for students on their path to becoming active modelers. To facilitate these goals, I developed the <monospace>R</monospace> package <italic>Dynamical Systems Approaches to Infectious Disease Epidemiology</italic> (DSAIDE), which allows students to learn infectious disease concepts by using a modern computational and modeling approach while not requiring—though allowing and encouraging, as described below—students to read or write computer code.</p>
</sec>
<sec id="sec003">
<title>Intended audience and goal of the package</title>
<p>The audience for the DSAIDE package are individuals interested in understanding infectious disease spread and control on the population level from a dynamical systems and modeling perspective. The package was originally built to complement a course on infectious disease epidemiology from a dynamical systems perspective. However, the documentation contained within DSAIDE strives to be detailed and self-contained enough to allow a motivated student to use DSAIDE and learn the topics covered by the package on their own. Any knowledge gaps can be filled by reading the provided references. For more advanced students who are comfortable with some level of coding, the package can be used as described in “Level 2” and “Level 3” below, either on its own or as a complement to a course on infectious disease modeling.</p>
</sec>
<sec id="sec004">
<title>Package description</title>
<p>The package currently consists of 12 simulations (hereafter referred to as “apps”) that allow for the exploration of different topics in infectious disease epidemiology. <xref ref-type="table" rid="pcbi.1005642.t001">Table 1</xref> lists all available apps (as of the time of this publication) and provides brief explanations for each. Each app is meant to be fully self-explanatory and contains a description of the model, a list of tasks the user could try, and information on further details and readings. All currently available apps are implemented as compartmental dynamical models, either deterministic using ordinary differential equations (deSolve package [<xref ref-type="bibr" rid="pcbi.1005642.ref010">10</xref>]) or stochastic using a Gillespie-type approach (adaptivetau package [<xref ref-type="bibr" rid="pcbi.1005642.ref011">11</xref>]). Using the functionality of the <monospace>R</monospace> shiny package [<xref ref-type="bibr" rid="pcbi.1005642.ref012">12</xref>], a graphical user interface is wrapped around each underlying simulation. This allows students to explore the models and infectious disease epidemiology concepts without the need to write any code. At the same time, the package is structured in a modular way that allows interested students to directly interact with and modify the underlying simulations in a step-wise manner, as described below.</p>
<table-wrap id="pcbi.1005642.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005642.t001</object-id>
<label>Table 1</label> <caption><title>Apps currently available in DSAIDE.</title></caption>
<alternatives>
<graphic id="pcbi.1005642.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005642.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">App_Name</th>
<th align="left">Model</th>
<th align="left">Topic_Covered</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ID Dynamics Intro</td>
<td align="left">3-compartment (SIR) ODE model.</td>
<td align="left">A first introduction to a simple compartmental SIR model. Allows simulation of a single outbreak for different parameter and initial condition settings.</td>
</tr>
<tr>
<td align="left">Characteristics of ID</td>
<td align="left">6-compartment ODE model.</td>
<td align="left">The potential role of different disease states (e.g., presymptomatic, asymptomatic, symptomatic) on ID dynamics.</td>
</tr>
<tr>
<td align="left">ID Patterns</td>
<td align="left">6-compartment ODE model. Includes natural births and deaths, waning immunity, and seasonality in transmission.</td>
<td align="left">Different ID patterns (single outbreak, oscillations, steady states).</td>
</tr>
<tr>
<td align="left">Direct Transmission</td>
<td align="left">3-compartment ODE model. Births, deaths, and waning immunity are included.</td>
<td align="left">The differences between density-dependent and frequency-dependent transmission and their impact on ID dynamics.</td>
</tr>
<tr>
<td align="left">Environmental Transmission</td>
<td align="left">4-compartment ODE model. Includes explicit environmental stage. Natural births and deaths are included.</td>
<td align="left">The impact of environmental shedding, decay, and transmission.</td>
</tr>
<tr>
<td align="left">Vector Transmission</td>
<td align="left">5-compartment ODE model. Includes susceptible and infected vectors and their dynamics. Births and deaths for vectors and waning immunity for hosts are included.</td>
<td align="left">Exploration of a simple vector-borne transmission model.</td>
</tr>
<tr>
<td align="left">Reproductive Number</td>
<td align="left">3-compartment ODE model. Includes vaccination of population at the beginning of the simulation. Births, deaths, and waning immunity are included.</td>
<td align="left">The reproductive number concept and how to estimate it from (simulated) data.</td>
</tr>
<tr>
<td align="left">ID Control</td>
<td align="left">9-compartment ODE model. An environmental and 2 vector stages as well as 6 host stages.</td>
<td align="left">The impact of different control measures for different types of ID.</td>
</tr>
<tr>
<td align="left">Host Heterogeneity</td>
<td align="left">6-compartment ODE model. 2x SIR for 2 different hosts.</td>
<td align="left">The impact of host heterogeneity and core groups on ID dynamics and control.</td>
</tr>
<tr>
<td align="left">Stochastic Dynamics</td>
<td align="left">4-compartment (SEIR) stochastic model. Births, deaths, and waning immunity are included.</td>
<td align="left">Stochasticity of ID dynamics, the phenomenon of ID extinction.</td>
</tr>
<tr>
<td align="left">Evolutionary Dynamics</td>
<td align="left">5-compartment stochastic model. Untreated and treated hosts infected with wild-type, and hosts infected with a resistant strain.</td>
<td align="left">Interaction between drug treatment and evolution/emergence of drug resistance.</td>
</tr>
<tr>
<td align="left">Multi-Pathogen Dynamics</td>
<td align="left">9-compartment ODE model with basic SIR dynamics for 2 pathogens and coinfection.</td>
<td align="left">Infection dynamics for 2 pathogens.</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>Abbreviations: DSAIDE, Dynamical Systems Approaches to Infectious Disease Epidemiology; ID, infectious disease; ODE, Ordinary Differential Equation; SEIR, Susceptible-Exposed-Infected-Removed; SIR, Susceptible-Infected-Recovered.</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec005">
<title>Installing and running the package</title>
<p>The package is installed like any other <monospace>R</monospace> package. Following are quick-start instructions:</p>
<list list-type="bullet">
<list-item><p>Install R from <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/" xlink:type="simple">https://cran.r-project.org/</ext-link>.</p></list-item>
<list-item><p>Optional, recommended: install RStudio from <ext-link ext-link-type="uri" xlink:href="https://www.rstudio.com/" xlink:type="simple">https://www.rstudio.com/</ext-link>.</p></list-item>
<list-item><p>Open R/Rstudio, install the package by typing <monospace>install.packages('DSAIDE')</monospace> into the R console.</p></list-item>
<list-item><p>Load the package with <monospace>library('DSAIDE')</monospace>.</p></list-item>
<list-item><p>Call the main menu by typing <monospace>dsaidemenu()</monospace> into the R console.</p></list-item>
<list-item><p>You are ready to explore!</p></list-item>
</list>
<p>Note: The package is developed and hosted publicly on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/ahgroup/DSAIDE" xlink:type="simple">https://github.com/ahgroup/DSAIDE</ext-link>. The Github repository can be used as an alternative to CRAN to install and test the most up-to-date version of the package (which could possibly be buggy). See the package Github site for more information and to submit bug reports, feature requests, etc.</p>
</sec>
<sec id="sec006">
<title>Using the package</title>
<p>The following sections describe the main ways for students to interact with the DSAIDE package. The idea is that everyone starts at level 1, and then, depending on needs and interests, they can decide whether to move on to the next level.</p>
<sec id="sec007">
<title>Level 1: Interactive use through the graphical user interface</title>
<p>The interactive exploration of the models and infectious disease concepts through the graphical user interface is the main intended use of this package. Once the package is loaded, the main menu is started by executing the command <monospace>dsaidemenu()</monospace> in the <monospace>R</monospace> console. This will bring up a graphical menu (<xref ref-type="fig" rid="pcbi.1005642.g001">Fig 1</xref>), from which the user can choose apps to explore specific infectious disease topics.</p>
<fig id="pcbi.1005642.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005642.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Main menu of the DSAIDE package.</title>
<p>DSAIDE, Dynamical Systems Approaches to Infectious Disease Epidemiology.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005642.g001" xlink:type="simple"/>
</fig>
<p>The user interacts with each app through a graphical interface consisting of input boxes to set model parameters and other settings and output in the form of graphs and text. <xref ref-type="fig" rid="pcbi.1005642.g002">Fig 2</xref> shows a screenshot of one of the apps.</p>
<fig id="pcbi.1005642.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005642.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Graphical interface for the reproductive number app.</title>
<p>Inputs are on the left; outputs in the form of graphs and useful numbers (e.g., maximum of each compartment during the simulation) are provided on the right. Below this is the documentation for the app; an example is shown in the next figure. S, Susceptible; I, Infected; R, Recovered.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005642.g002" xlink:type="simple"/>
</fig>
<p>Below the input and output areas are several tabs that contain detailed information for each app. The main tabs are the “Model” and the “What to do” tabs. The former describes the model, including showing the flow diagram and equations for the model. The latter contains a list of suggested tasks to learn about the topic covered by the app. <xref ref-type="fig" rid="pcbi.1005642.g003">Fig 3</xref> shows a screenshot of some of the documentation contained in one of the apps.</p>
<fig id="pcbi.1005642.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005642.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Documentation tabs for the environmental transmission app.</title>
<p>ODE, Ordinary Differential Equation; SIR, Susceptible-Infected-Recovered.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005642.g003" xlink:type="simple"/>
</fig>
<p>After exploring an app, the user returns to the main menu and eventually exits the main menu and closes the R session. No code needs to be written. The user can fully focus on learning the infectious disease topics and concepts covered by the different apps.</p>
</sec>
<sec id="sec008">
<title>Level 2: Directly interacting with the simulation functions</title>
<p>The interaction with DSAIDE described in the previous section is the main intended use of the package. However, it is easy for a student to gently proceed from having no interaction with the code to writing a few lines of additional code. To facilitate direct interaction with the code, the simulation model underlying each app is a stand-alone function. This simulator function can be called directly, without going through the graphical interface. The “Further Information” tab of each app provides the name of the corresponding simulator function and a brief description of how to interact with it.</p>
<p>For instance, for the first app, “ID Dynamics Intro,” the underlying simulator function is called <monospace>simulate_introduction.R</monospace>. The user can learn about the inputs and outputs of the function by looking at its documentation (typing <monospace>help("simulate_introduction")</monospace> at the R console). For this function, one can specify the initial number of susceptibles and infected, the duration for which the simulation should be run, and the infection and recovery parameters. Unless explicitly specified, the models do not have inherent time units. Instead, those are set by the user based on unit choices for the model parameters. It is important to ensure that all parameters are expressed in the same time units, e.g., days or months (or the inverse of those units for the rate parameters). Each parameter has some default. The user can modify those default settings. For instance, one can call the simulator with the following settings, overwriting the defaults:</p>
<p specific-use="line"><monospace>result &lt;- <bold>simulate_introduction</bold>(S0 = 500, I0 = 5, tmax = 100, g = 0.1, b = 1/2500)</monospace></p>
<p>Calling the simulation function runs the underlying dynamical model, here a simple 3-compartment Susceptible-Infected-Recovered (SIR) model implemented via ordinary differential equations and described in the “Model” section of the app. The simulation function produces and returns time series for the dynamics of each of the variables that are tracked. Users can produce their own plots, e.g., plotting susceptible, infected, and recovered individuals as a function of time with the code provided below. <xref ref-type="fig" rid="pcbi.1005642.g004">Fig 4</xref> shows the resulting plot.</p>
<fig id="pcbi.1005642.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005642.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Dynamics of susceptible, infected, and recovered during a single outbreak, obtained by a direct call to the simulate_introduction() function.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005642.g004" xlink:type="simple"/>
</fig>
<p specific-use="line"><monospace>ytext = "Number of individuals";</monospace></p>
<p specific-use="line"><monospace><bold>plot</bold>(result[,"time"],result[,"S"],xlab = 'Time',ylab = ytext,type = 'l',col = 'blue',ylim = <bold>c</bold>(0,500))</monospace></p>
<p specific-use="line"><monospace><bold>lines</bold>(result[,"time"],result[,"I"],xlab = 'Time',type = 'l',col = 'red',lty = 2)</monospace></p>
<p specific-use="line"><monospace><bold>lines</bold>(result[,"time"],result[,"R"],xlab = 'Time',type = 'l',col = 'black',lty = 3)</monospace></p>
<p specific-use="line"><monospace>legendtext = <bold>c</bold>('Susceptible','Infected','Recovered')</monospace></p>
<p specific-use="line"><monospace><bold>legend</bold>("top",legendtext,lty = <bold>c</bold>(1,2,3),lwd = 2,bty = "n",col = <bold>c</bold>('blue','red','black'))</monospace></p>
<p>Calling the simulation functions directly allows additional exploration of the models. For instance, if one wanted to systematically explore the behavior of a model for different values of some model parameter, one would need to do this manually if run through the graphical interface. By calling the function directly, this can be automated. As an example, the following lines of <monospace>R</monospace> code show a loop over different values of the recovery rate. At each value, the peak of the outbreak is recorded.</p>
<p specific-use="line"><monospace>gvec = <bold>seq</bold>(0.01,0.3,by = 0.01) <italic>#values of recovery rate</italic>, <italic>g</italic>, <italic>for which to run the simulation</italic></monospace></p>
<p specific-use="line"><monospace>peak = <bold>rep</bold>(0,<bold>length</bold>(gvec)) <italic>#this will record the peak values for each g</italic></monospace></p>
<p specific-use="line"><monospace>for (n in 1:<bold>length</bold>(gvec))</monospace></p>
<p specific-use="line"><monospace>{</monospace></p>
<p specific-use="line">  <monospace><italic>#call the</italic> <italic>simulator function with different values of g each time</italic></monospace></p>
<p specific-use="line">  <monospace>result &lt;- <bold>simulate_introduction</bold>(S0 = 500, I0 = 5, tmax = 200, g = gvec[n], b = 1/2500)</monospace></p>
<p specific-use="line">  <monospace>peak[n] &lt;- <bold>max</bold>(result[,"I"]) <italic>#record max number of infected for each value of g</italic></monospace></p>
<p specific-use="line"><monospace>}</monospace></p>
<p><xref ref-type="fig" rid="pcbi.1005642.g005">Fig 5</xref> shows the resulting plot. (The <monospace>R</monospace> code to plot this figure is omitted to save space).</p>
<fig id="pcbi.1005642.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005642.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Peak of the outbreak as a function of recovery rate.</title>
<p>This plot is obtained by wrapping the <monospace>simulate_introduction()</monospace> function into a loop for different values of the recovery time parameter.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005642.g005" xlink:type="simple"/>
</fig>
<p>By using this “Level 2” approach, the user can wrap their own code around the existing simulator functions and easily explore questions and scenarios that would be impossible or tedious to explore through the graphical interface. This provides a lot more flexibility. It requires writing some, but rather minimal, <monospace>R</monospace> code to interface with the supplied simulator functions. Once students have mastered this level and gained some coding proficiency, they can continue to the next level if interested.</p>
</sec>
<sec id="sec009">
<title>Level 3: Modifying the simulation functions</title>
<p>In addition to interacting with the simulation functions, the user can directly access and modify them. To make this easy, copies of all simulator functions are in a sub-directory called “simulatorfunctions” inside the DSAIDE package folder. The exact location of this folder depends on the settings for the <monospace>R</monospace> libraries but should be easy to locate. Each function starts with <monospace>simulate_</monospace>. Because these functions are copies of the ones used to run the code in the DSAIDE package, the user could edit them without breaking the package. Even so, to ensure any modifications made by the user are not overwritten if, for instance, the package is being reinstalled, I recommend copying these functions to a different folder.</p>
<p>Each simulator function is well documented. Some basic to intermediate level of R coding experience is required to successfully modify the functions. A simple example follows. Assume that one wants to modify the SIR model encoded in <monospace>simulate_introduction.R</monospace> and include waning immunity, with recovered returning to the susceptible class at rate <italic>w</italic>. After finding the file and making a copy (let's call the modified function <monospace>mysimulator.R</monospace>), modify the following lines of code of the <monospace>mysimulator.R</monospace> file as follows:</p>
<p>old:</p>
<p specific-use="line"><monospace>simulate_introduction &lt;- function(S0 = 1000, I0 = 1, tmax = 300, g = 0.5, b = 1/1000)</monospace></p>
<p>new:</p>
<p specific-use="line"><monospace>mysimulator &lt;- function(S0 = 1000, I0 = 1, tmax = 300, g = 0.5, b = 1/1000, w = 0)</monospace></p>
<p>old:</p>
<p specific-use="line"><monospace>pars = <bold>c</bold>(b = b, g = g);</monospace></p>
<p>new:</p>
<p specific-use="line"><monospace>pars = <bold>c</bold>(b = b, g = g, w = w);</monospace></p>
<p>old:</p>
<p specific-use="line"><monospace>dS = —b * S * I; <italic>#susceptibles</italic></monospace></p>
<p specific-use="line"><monospace>dI = b * S * I—g * I; <italic>#infected/infectious</italic></monospace></p>
<p specific-use="line"><monospace>dR = g * I; <italic>#recovered</italic></monospace></p>
<p>new:</p>
<p specific-use="line"><monospace>dS = —b * S * I + w * R; <italic>#susceptibles</italic></monospace></p>
<p specific-use="line"><monospace>dI = b * S * I—g * I; <italic>#infected/infectious</italic></monospace></p>
<p specific-use="line"><monospace>dR = g * I—w * R; <italic>#recovered</italic></monospace></p>
<p>No other parts of the simulator function code need to be modified. It is now possible to explore how different rates of waning immunity impact the outbreak peak by slightly modifying the code shown above in “Level 2,” namely, by writing a loop that goes through different values for the waning immunity parameter, <italic>w</italic>. The following code accomplishes this:</p>
<p specific-use="line"><monospace><bold>source</bold>('mysimulator.R') <italic>#to initialize the new function—needs to be in same directory</italic></monospace></p>
<p specific-use="line"><monospace>wvec = <bold>seq</bold>(0,1,by = 0.02) <italic>#values of immunity loss rate</italic>, <italic>w</italic>, <italic>for which to run the simulation</italic></monospace></p>
<p specific-use="line"><monospace>peak = <bold>rep</bold>(0,<bold>length</bold>(wvec)) <italic>#this will record the peak values for each g</italic></monospace></p>
<p specific-use="line"><monospace>for (n in 1:<bold>length</bold>(wvec))</monospace></p>
<p specific-use="line"><monospace>{</monospace></p>
<p specific-use="line">  <monospace>result &lt;- <bold>mysimulator</bold>(S0 = 1000, I0 = 1, tmax = 300, g = 0.5, b = 1/1000, w = wvec[n])</monospace></p>
<p specific-use="line">  <monospace>peak[n] &lt;- <bold>max</bold>(result[,"I"])</monospace></p>
<p specific-use="line"><monospace>}</monospace></p>
<p>The result of this simulation is shown in <xref ref-type="fig" rid="pcbi.1005642.g006">Fig 6</xref>.</p>
<fig id="pcbi.1005642.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005642.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Peak of the outbreak as a function of waning immunity.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005642.g006" xlink:type="simple"/>
</fig>
<p>This approach of using the DSAIDE package allows the user to completely customize the existing code based on their own needs and interests. Once a student makes it to this level, they are on their way to becoming a modeler who builds and analyzes their own models.</p>
</sec>
<sec id="sec010">
<title>Level 4: Contributing to the package and developing new apps</title>
<p>It is quite likely that there are still bugs and typos in the package and its documentation; if you find some, let me know. DSAIDE is hosted on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/ahgroup/DSAIDE" xlink:type="simple">https://github.com/ahgroup/DSAIDE</ext-link>. To submit bug reports, feature requests, and otherwise interact with the package and the package authors, please use Github if possible. DSAIDE is built in a way that (hopefully) makes it easy for others to contribute new simulations/apps. The package contains a subfolder called <italic>/docsfordevelopers</italic> (in the locally installed version of the package, this folder is in the main package folder; on Github, it is inside the <italic>/inst</italic> folder). The information in this folder explains the overall structure of the package and gives detailed instructions on how to create new apps. The information provided is meant to be detailed and complete enough to allow fairly easy development and contribution of new apps (or other enhancements) to the package. For any further questions, feel free to contact me via email or Github.</p>
</sec>
</sec>
<sec id="sec011">
<title>Further resources</title>
<p>For individuals interested in tools and resources related to infectious disease epidemiology, a number of additional R packages exist. The following are packages I am currently aware of.</p>
<p>For learning and teaching, the EpiModel package [<xref ref-type="bibr" rid="pcbi.1005642.ref013">13</xref>] is a very good resource. This package includes network-based models, which are currently not part of DSAIDE. However, only a few simple models are accessible through a graphical user interface. While the package allows the user to simulate more detailed network models with a fairly minimal amount of coding, for a user to fully take advantage of the features provided by EpiModel, some level of coding is required. As such, the EpiModel package targets individuals who are willing to learn some coding and would like to be able to explore more advanced network-based models.</p>
<p>The EpiDynamics [<xref ref-type="bibr" rid="pcbi.1005642.ref014">14</xref>] R package provides somewhat similar functionality as the DSAIDE package but does not allow graphical interaction with the models and thus requires some amount of coding from the beginning.</p>
<p>For research purposes, the R Epidemics Consortium (RECON) [<xref ref-type="bibr" rid="pcbi.1005642.ref015">15</xref>] develops a number of R packages that are focused on providing tools to analyze infectious disease outbreaks.</p>
<p>A very powerful set of functions for fitting compartmental models to data is provided by the POMP R package [<xref ref-type="bibr" rid="pcbi.1005642.ref016">16</xref>]. This package requires some advanced knowledge of <monospace>R</monospace> and fitting. Good tutorials are provided on the package's Github site.</p>
</sec>
<sec id="sec012" sec-type="conclusions">
<title>Conclusion</title>
<p>I described the <monospace>R</monospace> package <monospace>DSAIDE</monospace>, which allows interested individuals to learn modern infectious disease epidemiology with the help of computer models but without the need to write code. The package is designed to allow easy advancement of the student toward increased flexibility in addressing questions of interest, with a concomitant (gentle) increase of required coding. Furthermore, the package allows for—hopefully rather easy—contributions of new apps. My hope is that this package will continue to grow and become a widely used and useful resource for teaching and learning modern infectious disease epidemiology.</p>
</sec>
</body>
<back>
<ack>
<p>The following individuals contributed bits of code or bug-fixes to this package: Spencer Hall, Brian McKay, John Rossow, Sina Solaimanpour. I thank the reviewers for feedback that helped to improve this manuscript and the DSAIDE package.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005642.ref001"><label>1</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Anderson</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>May</surname> <given-names>R</given-names></name>. <chapter-title>Infectious disease of humans</chapter-title>. <source>Dynamics and control</source>. <publisher-name>Oxford University Press</publisher-name>. <year>1991</year></mixed-citation></ref>
<ref id="pcbi.1005642.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blower</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bernoulli</surname> <given-names>D</given-names></name>. <article-title>An attempt at a new analysis of the mortality caused by smallpox and of the advantages of inoculation to prevent it. 1766</article-title>. <source>Reviews in medical virology</source>. <year>2004</year>;<volume>14</volume>: <fpage>275</fpage>–<lpage>288</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/rmv.443" xlink:type="simple">10.1002/rmv.443</ext-link></comment> <object-id pub-id-type="pmid">15334536</object-id></mixed-citation></ref>
<ref id="pcbi.1005642.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bellan</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Pulliam</surname> <given-names>JRC</given-names></name>, <name name-style="western"><surname>Scott</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Dushoff</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Committee</surname> <given-names>MO</given-names></name>. <article-title>How to make epidemiological training infectious</article-title>. <source>PLoS Biol</source>. <year>2012</year>;<volume>10</volume>: <fpage>e1001295</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pbio.1001295" xlink:type="simple">10.1371/journal.pbio.1001295</ext-link></comment> <object-id pub-id-type="pmid">22509129</object-id></mixed-citation></ref>
<ref id="pcbi.1005642.ref004"><label>4</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Keeling</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Rohani</surname> <given-names>P</given-names></name>. <source>Modeling infectious diseases in humans and animals</source>. <publisher-name>Princeton University Press</publisher-name>; <year>2008</year>.</mixed-citation></ref>
<ref id="pcbi.1005642.ref005"><label>5</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Vynnycky</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>R</given-names></name>. <source>An introduction to infectious disease modelling</source>. <publisher-name>Oxford University Press</publisher-name>; <year>2010</year>.</mixed-citation></ref>
<ref id="pcbi.1005642.ref006"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Epidemics—the dynamics of infectious diseases. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.coursera.org/learn/epidemics" xlink:type="simple">https://www.coursera.org/learn/epidemics</ext-link>. [cited 9/30/2017].</mixed-citation></ref>
<ref id="pcbi.1005642.ref007"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Epidemics. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.coursera.org/learn/hkuepidemics" xlink:type="simple">https://www.coursera.org/learn/hkuepidemics</ext-link>. [cited 9/30/2017].</mixed-citation></ref>
<ref id="pcbi.1005642.ref008"><label>8</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Fink</surname> <given-names>LD</given-names></name>. <source>Creating significant learning experiences: An integrated approach to designing college courses</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1005642.ref009"><label>9</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Miller</surname> <given-names>MD</given-names></name>. <chapter-title>Minds online: Teaching effectively with technology</chapter-title>. <publisher-name>Harvard University Press</publisher-name>; <year>2014</year>.</mixed-citation></ref>
<ref id="pcbi.1005642.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Soetaert</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Petzoldt</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Setzer</surname> <given-names>RW</given-names></name>. <article-title>Solving differential equations in r: Package deSolve</article-title>. <source>Journal of Statistical Software</source>. <year>2010</year>;<volume>33</volume>: <fpage>1</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v033.i09" xlink:type="simple">10.18637/jss.v033.i09</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005642.ref011"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Johnson P. Adaptivetau: Tau-leaping stochastic simulation [Internet]. 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=adaptivetau" xlink:type="simple">https://CRAN.R-project.org/package=adaptivetau</ext-link>. [cited 9/30/2017].</mixed-citation></ref>
<ref id="pcbi.1005642.ref012"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Chang W, Cheng J, Allaire J, Xie Y, McPherson J. Shiny: Web application framework for r [Internet]. 2017. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=shiny" xlink:type="simple">https://CRAN.R-project.org/package=shiny</ext-link>. [cited 9/30/2017].</mixed-citation></ref>
<ref id="pcbi.1005642.ref013"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Jenness S, Goodreau SM, Morris M. EpiModel: Mathematical modeling of infectious disease [Internet]. 2017. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=EpiModel" xlink:type="simple">https://CRAN.R-project.org/package=EpiModel</ext-link>. [cited 9/30/2017].</mixed-citation></ref>
<ref id="pcbi.1005642.ref014"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Santos Baquero O, Silveira Marques F. EpiDynamics: Dynamic models in epidemiology [Internet]. 2015. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=EpiDynamics" xlink:type="simple">https://CRAN.R-project.org/package=EpiDynamics</ext-link>. [cited 9/30/2017].</mixed-citation></ref>
<ref id="pcbi.1005642.ref015"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">RECON. R epidemics consortium [Internet]. 2017. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.repidemicsconsortium.org/" xlink:type="simple">http://www.repidemicsconsortium.org/</ext-link>. [cited 9/30/2017].</mixed-citation></ref>
<ref id="pcbi.1005642.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>King</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ionides</surname> <given-names>EL</given-names></name>. <article-title>Statistical inference for partially observed markov processes via the R package pomp</article-title>. <source>Journal of Statistical Software</source>. <year>2016</year>;<volume>69</volume>: <fpage>1</fpage>–<lpage>43</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v069.i12" xlink:type="simple">10.18637/jss.v069.i12</ext-link></comment></mixed-citation></ref>
</ref-list>
</back>
</article>