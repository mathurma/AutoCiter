<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-01504</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003145</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Genetics</subject></subj-group><subj-group><subject>Neuroscience</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject></subj-group><subj-group><subject>Statistics</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physics</subject><subj-group><subject>Biophysics</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Statistical Analysis of Molecular Signal Recording</article-title>
<alt-title alt-title-type="running-head">Statistical Analysis of Molecular Signal Recording</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Glaser</surname><given-names>Joshua I.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Zamft</surname><given-names>Bradley M.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Marblestone</surname><given-names>Adam H.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Moffitt</surname><given-names>Jeffrey R.</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Tyo</surname><given-names>Keith</given-names></name><xref ref-type="aff" rid="aff6"><sup>6</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Boyden</surname><given-names>Edward S.</given-names></name><xref ref-type="aff" rid="aff7"><sup>7</sup></xref><xref ref-type="aff" rid="aff8"><sup>8</sup></xref><xref ref-type="aff" rid="aff9"><sup>9</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Church</surname><given-names>George</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Kording</surname><given-names>Konrad P.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff10"><sup>10</sup></xref><xref ref-type="aff" rid="aff11"><sup>11</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Physical Medicine and Rehabilitation, Northwestern University and Rehabilitation Institute of Chicago, Chicago, Illinois, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Genetics, Harvard Medical School, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Biophysics Program, Harvard University, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Wyss Institute, Harvard University, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff5"><label>5</label><addr-line>Department of Chemistry and Chemical Biology, Harvard University, Cambridge, Massachusetts, United States of America</addr-line></aff>
<aff id="aff6"><label>6</label><addr-line>Department of Chemical and Biological Engineering, Northwestern University, Evanston, Illinois, United States of America</addr-line></aff>
<aff id="aff7"><label>7</label><addr-line>Media Lab, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line></aff>
<aff id="aff8"><label>8</label><addr-line>Department of Biological Engineering, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line></aff>
<aff id="aff9"><label>9</label><addr-line>McGovern Institute, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line></aff>
<aff id="aff10"><label>10</label><addr-line>Department of Physiology, Northwestern University, Chicago, Illinois, United States of America</addr-line></aff>
<aff id="aff11"><label>11</label><addr-line>Department of Applied Mathematics, Northwestern University, Chicago, Illinois, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Markel</surname><given-names>Scott</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Accelrys, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">j-glaser@u.northwestern.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: JIG BMZ AHM JRM KT ESB GC KPK. Performed the experiments: JIG. Analyzed the data: JIG BMZ AHM JRM KPK. Wrote the paper: JIG BMZ AHM JRM KT ESB GC KPK.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>7</month><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>18</day><month>7</month><year>2013</year></pub-date>
<volume>9</volume>
<issue>7</issue>
<elocation-id>e1003145</elocation-id>
<history>
<date date-type="received"><day>21</day><month>9</month><year>2012</year></date>
<date date-type="accepted"><day>2</day><month>6</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Glaser et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>A molecular device that records time-varying signals would enable new approaches in neuroscience. We have recently proposed such a device, termed a “molecular ticker tape”, in which an engineered DNA polymerase (DNAP) writes time-varying signals into DNA in the form of nucleotide misincorporation patterns. Here, we define a theoretical framework quantifying the expected capabilities of molecular ticker tapes as a function of experimental parameters. We present a decoding algorithm for estimating time-dependent input signals, and DNAP kinetic parameters, directly from misincorporation rates as determined by sequencing. We explore the requirements for accurate signal decoding, particularly the constraints on (1) the polymerase biochemical parameters, and (2) the amplitude, temporal resolution, and duration of the time-varying input signals. Our results suggest that molecular recording devices with kinetic properties similar to natural polymerases could be used to perform experiments in which neural activity is compared across several experimental conditions, and that devices engineered by combining favorable biochemical properties from multiple known polymerases could potentially measure faster phenomena such as slow synchronization of neuronal oscillations. Sophisticated engineering of DNAPs is likely required to achieve molecular recording of neuronal activity with single-spike temporal resolution over experimentally relevant timescales.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Recording of physiological signals from inaccessible microenvironments is often hampered by the macroscopic sizes of current recording devices. A signal-recording device constructed on a molecular scale could advance biology by enabling the simultaneous recording from millions or billions of cells. We recently proposed a molecular device for recording time-varying ion concentration signals: DNA polymerases (DNAPs) copy known template DNA strands with an error rate dependent on the local ion concentration. The resulting DNA polymers could then be sequenced, and with the help of statistical techniques, used to estimate the time-varying ion concentration signal experienced by the polymerase. We develop a statistical framework to treat this inverse problem and describe a technique to decode the ion concentration signals from DNA sequencing data. We also provide a novel method for estimating properties of DNAP dynamics, such as polymerization rate and pause frequency, directly from sequencing data. We use this framework to explore potential application scenarios for molecular recording devices, achievable via molecular engineering within the biochemical parameter ranges of known polymerases. We find that accurate recording of neural firing rate responses across several experimental conditions would likely be feasible using molecular recording devices with kinetic properties similar to those of known polymerases.</p>
</abstract>
<funding-group><funding-statement>Adam Marblestone is supported by a Lowell Wood Fellowship from the Fannie and John Hertz Foundation. Jeffrey Moffitt is funded by a Helen Hay Whitney Postdoctoral Fellowship. Ed Boyden acknowledges funding by DARPA Living Foundries Program; Google; New York Stem Cell Foundation-Robertson Investigator Award; NIH EUREKA Award 1R01NS075421, NIH Transformative R01 1R01GM104948, NIH Single Cell Grant 1 R01 EY023173, and NIH Grants 1R01DA029639, and 1R01NS067199; NSF CAREER Award CBET 1053233 and NSF Grants, EFRI0835878 and DMS1042134; Paul Allen Distinguished Investigator in Neuroscience Award; SkTech. Bradley Zamft and George Church acknowledge support from the Office of Naval Research and the NIH Centers of Excellence in Genomic Science, Grant 1P50HG005550. Konrad Kording and Keith Tyo are funded in part by the Chicago Biomedical Consortium with support from the Searle Funds at The Chicago Community Trust. Konrad Kording is also supported by NIH grants 5R01NS063399, P01NS044393, and 1R01NS074044. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="14"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>When the monomers added to a growing polymer chain depend on signals in the environment, such as the ion fluxes during an action potential, the polymer sequence stores a record of the environmental signal's variation over time, much like a ticker tape <xref ref-type="bibr" rid="pcbi.1003145-Church1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Kording1">[2]</xref>. DNA polymerases (DNAPs), enzymes that catalyze replication of DNA, possess nucleotide misincorporation probabilities that can be modulated by local ion concentrations <xref ref-type="bibr" rid="pcbi.1003145-ElDeiry1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Zamft1">[4]</xref>, making them candidates for ion-sensitive molecular ticker tapes that encode signals into DNA strands in the form of base misincorporation patterns. For example, neural firing could be recorded by linking intracellular calcium concentration to polymerase misincorporation rates. In DNAP misincorporation-based recording, information is stored in the form of a string of copied nucleotides, which can be sequenced and compared to the known template sequence to identify the sites of misincorporations. Consequently, one can estimate the state of the environment – e.g. ion concentration – as a function of time, based on the observed misincorporation pattern.</p>
<p>A key problem for such biochemical ticker tape machines is that they may not have a high-fidelity clock. DNAPs do not add nucleotides at a constant rate <xref ref-type="bibr" rid="pcbi.1003145-Viguera1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Schwartz1">[6]</xref>: binding, catalysis, pausing, and dissociation from the template strand are thermally-activated, stochastic processes <xref ref-type="bibr" rid="pcbi.1003145-Moffitt1">[7]</xref>. It is therefore necessary to address imperfect measurements of time in molecular ticker tapes.</p>
<p>To assess the feasibility of extracting information from molecular ticker tapes, we analyze a system in which multiple ion-sensitive DNAPs simultaneously replicate identical DNA template strands in the presence of a time-varying ion concentration signal (<xref ref-type="fig" rid="pcbi-1003145-g001">Fig. 1A</xref>). In this scenario, DNAPs add each successive copied nucleotide with an ion concentration-dependent misincorporation probability. Due to thermal fluctuations, the time at which the addition of a particular nucleotide occurs must be treated as a random variable (<xref ref-type="fig" rid="pcbi-1003145-g001">Fig. 1B</xref>). In the limit of a large ensemble of simultaneously replicated templates, a misincorporation probability distribution can be measured as a function of the index of the nucleotide (<xref ref-type="fig" rid="pcbi-1003145-g001">Fig. 1C</xref>). Here we study the problem of estimating the ion concentration signal as a function of time, based on observed misincorporation frequencies as a function of the nucleotide index.</p>
<fig id="pcbi-1003145-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003145.g001</object-id><label>Figure 1</label><caption>
<title>Encoding and decoding of signals with a molecular ticker tape.</title>
<p><bold>A</bold>) Example time-varying ion concentration signal. In a neuron, peaks in calcium concentration occur during neural firing. <bold>B</bold>) Example products from the simultaneous replication of multiple template strands, showing correct (C) and incorrect (I) nucleotide additions, with the time of incorporation shown on the horizontal axis. Misincorporations are more likely in the presence of higher ion concentration. <bold>C</bold>) The misincorporation counts from each template copy are summed to calculate the misincorporation probability at every nucleotide position in the template. In this example, approximately 100 nucleotides are replicated per second on average.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003145.g001" position="float" xlink:type="simple"/></fig>
<p>Our method for solving this inverse problem relies only on counting the total number of misincorporations as a function of position within the template. Therefore, it is directly compatible with current-generation short-read deep sequencing technologies, in conjunction with <italic>in silico</italic> sequence alignment algorithms (e.g. Smith-Waterman <xref ref-type="bibr" rid="pcbi.1003145-Smith1">[8]</xref>), which would be used to localize the short reads inside a long, high-complexity DNA template sequence. Note that assembly of the short reads into contiguous strands, representing the output of a single polymerase molecule, is not required. This is fortunate because distinct error-prone copies of templates with identical sequences will share a high degree of homology and therefore may be difficult to assemble.</p>
<p>What are the biochemical properties that a DNAP must possess in order to function as a molecular ticker tape recorder? To allow for faithful decoding of realistic input signals, a DNAP may require a favorable combination of parameters such as speed, pause probability, distribution of pause durations, and ion-dependent misincorporation rate. Likewise, it is unclear how many simultaneously replicated template strands are required for accurate decoding.</p>
<p>Here we address these statistical constraints on molecular ticker tapes by presenting (1) an intuitive theoretical framework, based on Fisher information theory, which quantifies the theoretical optimal precision for estimating the time-varying input signal from sequencing data as a function of relevant biochemical and experimental parameters, and (2) decoding algorithms to perform estimation of the time-varying input signal from sequencing data. The decoding algorithms rely on knowledge of the DNAP's kinetic parameters. When these parameters are unknown, we provide an algorithm to calibrate them from sequence data generated in the presence of known input signals. Simulations of the decoding algorithm are used to determine the effects of relevant experimental parameters on the actual decoding performance of the algorithms (as opposed to their effects on the theoretical optima). With a view towards potential neuroscience applications, we identify polymerase parameter sets and input signal characteristics for which molecular recording may be feasible, thereby providing guidelines for the experimental design and validation of molecular recording technologies.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Overview</title>
<p>The statistical feasibility of molecular recording depends on several experimental and biochemical parameters. We focus on (1) the kinetic parameters of polymerization by DNAP: the average single-base elongation time (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e001" xlink:type="simple"/></inline-formula>), average pause time (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e002" xlink:type="simple"/></inline-formula>), and pause probability (<italic>P</italic>); (2) the number of simultaneously replicated DNA template strands; and (3) the concentration to misincorporation link function (CMLF), which relates the per-base misincorporation probability to the local ion concentration. All these parameters can be determined experimentally prior to their use in molecular ticker tapes, either by traditional biochemical or single-molecule methods, or by those discussed below.</p>
<p>Using these parameters, we created a multi-parameter forward model (<xref ref-type="disp-formula" rid="pcbi.1003145.e079"><italic>Eqs. 2</italic></xref><italic>–</italic><xref ref-type="disp-formula" rid="pcbi.1003145.e121"><italic>5</italic></xref>; see <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>) for the probability of nucleotide misincorporation at any template base position, given a time-varying ion concentration signal. Based on this forward model, we derived an expression that analytically relates the optimal precision of ion concentration estimation to the model parameters in the setting of a single ion concentration pulse (<xref ref-type="disp-formula" rid="pcbi.1003145.e008"><italic>Eqs. 1</italic></xref><italic>&amp;</italic><xref ref-type="disp-formula" rid="pcbi.1003145.e143"><italic>7</italic></xref>; see <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>).</p>
<p>For the case of realistic time-dependent ion concentrations, rather than single pulses, we have developed two algorithms (see <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>) to decode the time-varying ion concentration signal from the observed DNA sequences. The first algorithm estimates a continuous concentration trace by minimizing a cost function, while the second estimates a binary concentration trace using maximum likelihood estimation. A third algorithm determines unknown DNAP kinetic parameters from sequencing data, given known time-dependent ion concentration signals as inputs.</p>
<p>We first apply Fisher information theory to quantify optimal estimation precision for a single-pulse input, which results in a concise formula that provides intuition for the dependence of decoding fidelity on relevant experimental parameters. We next apply our decoding algorithms to simulated data. This allows us to quantify the achievable temporal resolution and recording duration of molecular ticker tapes in the context of realistic neural recording experiments. For several experimental paradigms, we determine the necessary DNAP kinetic parameters, CMLFs, and number of DNA templates. We also study the effects of DNAP dissociation from the template and of variation in polymerase start-times.</p>
</sec><sec id="s2b">
<title>Analytically relating estimation precision to experimental parameters</title>
<p>To provide some insight into the feasibility of ticker tape decoding under different experimental parameters, and to provide an analytical tool for testing the performance of our algorithms, we start by deriving the Fisher information associated with estimating the characteristics of a single concentration pulse from the observed misincorporation rate (see <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>). Here, the Fisher information <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e003" xlink:type="simple"/></inline-formula> measures the degree to which the observed nucleotides are informative about the peak ion concentration <italic>C</italic> of an input pulse. A greater value for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e004" xlink:type="simple"/></inline-formula> implies that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e005" xlink:type="simple"/></inline-formula> can be estimated more precisely: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e006" xlink:type="simple"/></inline-formula> is the theoretical minimum variance of an unbiased estimator of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e007" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003145-Cramr1">[9]</xref>.</p>
<p>In the limit of small misincorporation rates, the Fisher information can be approximated as:<disp-formula id="pcbi.1003145.e008"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e008" xlink:type="simple"/><label>(1)</label></disp-formula>(see <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>), where <italic>N</italic> is the number of DNA templates; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e009" xlink:type="simple"/></inline-formula> is the probability that nucleotide <italic>i</italic> was added during a concentration spike with start-time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e010" xlink:type="simple"/></inline-formula> and duration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e011" xlink:type="simple"/></inline-formula>, and DNAP parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e012" xlink:type="simple"/></inline-formula>; <italic>C</italic> is the ion concentration; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e013" xlink:type="simple"/></inline-formula> is the baseline error rate per base; and <italic>m</italic> is the slope of the CMLF, where we approximate the CMLF as linear <xref ref-type="bibr" rid="pcbi.1003145-Zamft1">[4]</xref>, i.e., as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e014" xlink:type="simple"/></inline-formula>.</p>
<p><xref ref-type="disp-formula" rid="pcbi.1003145.e008"><italic>Eq. 1</italic></xref> confirms several natural intuitions about molecular recording: the theoretical optimal precision of ion concentration estimation can be increased by increasing <italic>N</italic> (the number of DNA templates; <xref ref-type="supplementary-material" rid="pcbi.1003145.s001">Fig. S1A</xref>), decreasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e015" xlink:type="simple"/></inline-formula> (the baseline misincorporation rate; <xref ref-type="supplementary-material" rid="pcbi.1003145.s001">Fig. S1B</xref>), increasing <italic>m</italic> (sensitivity of misincorporation rate to ion concentration changes; <xref ref-type="supplementary-material" rid="pcbi.1003145.s001">Fig. S1C</xref>), and increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e016" xlink:type="simple"/></inline-formula> (probability that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e017" xlink:type="simple"/></inline-formula> nucleotide was incorporated during the concentration spike). <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e018" xlink:type="simple"/></inline-formula> can be increased in multiple ways. Decreasing the pause duration or frequency increases <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e019" xlink:type="simple"/></inline-formula> because polymerases will be less widely dispersed during the pulse when their nucleotide addition kinetics are less stochastic (<xref ref-type="supplementary-material" rid="pcbi.1003145.s001">Fig. S1D</xref>). Decreasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e020" xlink:type="simple"/></inline-formula> increases <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e021" xlink:type="simple"/></inline-formula> because the ensemble of polymerases de-phases over time (explained in more detail in <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>). Lastly, increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e022" xlink:type="simple"/></inline-formula>, the duration of the concentration pulse, increases <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e023" xlink:type="simple"/></inline-formula>. Note that, while <xref ref-type="disp-formula" rid="pcbi.1003145.e008"><italic>Eq. 1</italic></xref> applies in the limit of small error rates, the full expression for the Fisher information (<xref ref-type="disp-formula" rid="pcbi.1003145.e143"><italic>Eq. 7</italic></xref>) indicates that these general trends are still valid when considering moderate or large error rates; we use the full expression for the Fisher information in our simulations.</p>
<p>For further simplifications of <xref ref-type="disp-formula" rid="pcbi.1003145.e008"><italic>Eq. 1</italic></xref> in the limits of low and high baseline misincorporation rates and concentrations, see <italic><xref ref-type="supplementary-material" rid="pcbi.1003145.s007">Text S1</xref>: Further Simplifications</italic>. We also studied how Fisher information governs the estimation of other properties of the concentration pulse in addition to its peak concentration: see <italic><xref ref-type="supplementary-material" rid="pcbi.1003145.s007">Text S1</xref>: Additional Pulse Properties</italic>.</p>
<p>In the case of multiple concentration pulses, a Fisher information matrix can be constructed; however, this does not give rise to a simple analytic expression. Thus, to determine the performance of decoding multi-pulse input concentration traces, we implemented our decoding algorithms on simulated data in what follows.</p>
</sec><sec id="s2c">
<title>Testing the performance of decoding algorithms</title>
<p>Our continuous decoding algorithm, which minimizes prediction error by using a cost function, obtains ion concentration estimation variances similar to the Fisher information optimum when decoding a single concentration pulse (<xref ref-type="supplementary-material" rid="pcbi.1003145.s001">Fig. S1</xref>). When decoding more complex multi-pulse concentrations traces, the performance of this algorithm should be viewed as a lower bound on what could be achievable. Our binary decoding algorithm, which exhaustively computes the maximum likelihood concentration given the sequencing data, also obtains decoding accuracies similar to the Fisher information optimum when decoding a single concentration pulse, although its performance degrades relative to the theoretical optimum in the limits of small numbers of templates or high baseline misincorporation rates (<xref ref-type="supplementary-material" rid="pcbi.1003145.s002">Fig. S2</xref>). Theoretically, Fisher information naturally arises from maximum likelihood estimation <xref ref-type="bibr" rid="pcbi.1003145-Miura1">[10]</xref>. Therefore, when determination of the maximum-likelihood concentration trace is possible, this simple decoding approach should be near optimal, even when decoding complex multi-pulse concentration pulses. Below we will use both ion concentration estimation algorithms to test the parameter requirements of molecular recording devices for neuroscience applications.</p>
</sec><sec id="s2d">
<title>Continuous concentration decoding</title>
<p>Many neuroscience experiments focus on measuring the firing rates of neurons. Understanding the factors that influence firing rates can inform researchers about what a neuron encodes. In order to test the ability of molecular ticker tapes to accurately record neural firing rates, we performed simulations using our continuous decoder, as increased firing rates will increase calcium ion concentration levels in a continuous manner <xref ref-type="bibr" rid="pcbi.1003145-Koch1">[11]</xref> (further details about the conversion from calcium concentrations to firing rates can be found in the <xref ref-type="sec" rid="s3"><italic>Discussion</italic></xref>). We aimed to determine which biochemical parameters of a molecular ticker tape system are required to allow molecular recording of firing rates at the temporal resolutions characteristic of typical neuroscience experiments.</p>
<sec id="s2d1">
<title>Recording firing rates across several conditions</title>
<p>Perhaps the simplest neuroscience experiments compare neural firing rates across several externally imposed conditions; for instance, to determine how neural firing rates differ in the presence vs. absence of a drug. There is a large class of such “multi-condition experiments”: examples include determining neural activity in response to varying behaviors, varying sensory stimuli (tuning curves), or systematic pharmacological, electrical, or optogenetic perturbations.</p>
<p>To test the feasibility of accurate molecular recording of a generalized multi-condition experiment, we considered a scenario in which multiple externally imposed conditions are presented in series over a period of time, while a molecular ticker tape records the time-varying ion concentrations resulting from the firing rates generated in response to each condition. We set the number of externally imposed conditions to eight, and the total experimental duration to 20 minutes, so that each condition lasts 150 seconds. Thus, in this scenario, a generalized multi-condition experiment corresponds to recording continuous ion concentration levels with a temporal resolution of 150 seconds for a duration of 20 minutes.</p>
<p>We used approximate DNAP kinetic parameters from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e024" xlink:type="simple"/></inline-formula> DNAP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e025" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e026" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e027" xlink:type="simple"/></inline-formula>) <xref ref-type="bibr" rid="pcbi.1003145-Ibarra1">[12]</xref>. Note that these biochemical parameters change across experimental preparations, and the <italic>in vivo</italic> parameters in neurons are unknown, so this parameter choice may not always be accurate for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e028" xlink:type="simple"/></inline-formula> DNAP. We used a CMLF of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e029" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e030" xlink:type="simple"/></inline-formula>, similar to that measured for Dpo4 in buffers of varying manganese concentrations <xref ref-type="bibr" rid="pcbi.1003145-Zamft1">[4]</xref>, one of the few CMLFs experimentally measured at present. Note that while <italic>m</italic> generally has units of inverse concentration (e.g. M<sup>−1</sup> or mM<sup>−1</sup>), here the concentrations in all simulations are scaled to range from 0 to 1 (arbitrary units), so that <italic>m</italic> also contains arbitrary units, and the misincorporation rate at high concentration is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e031" xlink:type="simple"/></inline-formula> (here <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e032" xlink:type="simple"/></inline-formula>). In our simulations, <italic>m</italic> can be viewed as the differential misincorporation rate, i.e., the difference between the misincorporation rates at high and low concentrations.</p>
<p>We first tested the effect of varying the number of DNA templates on the accuracy of continuous concentration decoding at 150 second temporal resolution. An example is shown in <xref ref-type="fig" rid="pcbi-1003145-g002">Fig. 2</xref>, for a sequence of ion concentrations representing the word “RECORDER” (where the concentration of A = 0/25,…, Z = 25/25). In this example, with 1000 templates, concentration estimation is nearly perfect (1.8% median estimation error; <xref ref-type="fig" rid="pcbi-1003145-g002">Fig. 2</xref>).</p>
<fig id="pcbi-1003145-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003145.g002</object-id><label>Figure 2</label><caption>
<title>Decoding continuous concentration signals.</title>
<p>Continuous decoding to estimate sequences of eight concentrations over 20 minutes of recording using varying numbers of templates. The 95% confidence interval of the estimated concentrations (light red) that result from the decoding algorithm presented here on an ion concentration input sequence representing the word “RECORDER” (dark red). Concentrations are mapped to letters via A = 0/25, B = 1/25,,…,Z = 25/25, so that the concentration sequence representing the word RECORDER is 17/25, 4/25…). The numbers of templates used were, from top to bottom, 1000, 100, 10, and 1. For all panels, kinetic parameters are those of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e033" xlink:type="simple"/></inline-formula> DNAP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e034" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e035" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e036" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e037" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e038" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e039" xlink:type="simple"/></inline-formula>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003145.g002" position="float" xlink:type="simple"/></fig>
<p>Using randomly generated concentration sequences, we varied the number of templates (<xref ref-type="fig" rid="pcbi-1003145-g003">Fig. 3A</xref>), the CMLF (<xref ref-type="fig" rid="pcbi-1003145-g003">Fig. 3B</xref>), and the DNAP parameters (<xref ref-type="fig" rid="pcbi-1003145-g003">Figs. 3C&amp;D</xref>). We found that multi-condition experiments could be performed using feasible numbers of templates and CMLFs, and DNAP parameters within the range of documented DNAPs. We also studied the effects of dissociation (<xref ref-type="supplementary-material" rid="pcbi.1003145.s003">Fig. S3</xref>), DNAP start-time variation, and concentration fluctuations (<xref ref-type="supplementary-material" rid="pcbi.1003145.s004">Fig. S4</xref>), and found these effects to be minimal in this context. Lastly, we studied the effect of varying the number of externally imposed conditions within the 20 minutes of recording (i.e., varying the temporal resolution), and found that approximately 10 conditions could be accurately recorded using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e040" xlink:type="simple"/></inline-formula> DNAP kinetic parameters, and more conditions with less stochastic parameters (<xref ref-type="supplementary-material" rid="pcbi.1003145.s005">Fig. S5</xref>). For a more in-depth explanation of our parameter sweep results, see <italic><xref ref-type="supplementary-material" rid="pcbi.1003145.s008">Text S2</xref></italic>. In general, we find that high accuracy molecular recording of multi-condition experiments is feasible using DNAPs with kinetic parameters similar to those of known polymerases.</p>
<fig id="pcbi-1003145-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003145.g003</object-id><label>Figure 3</label><caption>
<title>Varying numbers of templates, CMLFs, and DNAP parameters.</title>
<p>Performance of continuous decoding to estimate randomly determined sequences of eight concentrations over 20 minutes of recording, as a function of experimental parameters. Solid lines are median estimation errors, and dashed lines are 95% confidence intervals. <bold>A</bold>) Varying numbers of templates, with the CMLF fixed at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e041" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e042" xlink:type="simple"/></inline-formula>, and using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e043" xlink:type="simple"/></inline-formula> DNAP kinetic parameters. <bold>B</bold>) Varying CMLFs, with the number of templates fixed at 1000, and using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e044" xlink:type="simple"/></inline-formula> DNAP kinetic parameters. <bold>C, D</bold>) Varying DNAP pausing parameters, with a fixed elongation time of 20 ms, a fixed CMLF of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e045" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e046" xlink:type="simple"/></inline-formula>, and 1000 and 100 templates, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003145.g003" position="float" xlink:type="simple"/></fig></sec><sec id="s2d2">
<title>Recording firing rates at 1000 ms and 100 ms temporal resolutions</title>
<p>Going beyond such generalized multi-condition experiments, which occur on a timescale of minutes, it is often of interest to study the dynamics of the firing rate at higher temporal resolutions, since many neuronal computations occur on timescales of 1000 ms (e.g. <xref ref-type="bibr" rid="pcbi.1003145-Ahrens1">[13]</xref>) or less. What temporal resolutions are possible for continuous decoding using feasible biochemical parameters? Even with many templates (<italic>N</italic> = 10000), and the maximal differential misincorporation rate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e047" xlink:type="simple"/></inline-formula> vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e048" xlink:type="simple"/></inline-formula>, recording with 1 second temporal resolution yields over 50% median estimation error after only 5 seconds of recording when using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e049" xlink:type="simple"/></inline-formula> DNAP kinetic parameters. However, using optimal polymerase parameters consisting of a 1 ms elongation time (c.f., <italic>E. coli</italic> pol III <xref ref-type="bibr" rid="pcbi.1003145-Kelman1">[14]</xref>) and no significant pausing (e.g., T7 RNA polymerase <xref ref-type="bibr" rid="pcbi.1003145-Thomen1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Skinner1">[16]</xref>), 1 second temporal resolution is possible for 10 minutes (6000 seconds) with ∼5% median estimation error (<italic>N</italic> = 1000, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e050" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e051" xlink:type="simple"/></inline-formula>; <xref ref-type="fig" rid="pcbi-1003145-g004">Fig. 4A</xref>). We further tested whether variation in polymerase start-times affected these conclusions. When polymerase start-times were allowed to vary from 0–2 seconds, median estimation error remained at &lt;6% at 10 minutes of recording, but when start-times varied from 0–10 seconds, estimation rose to nearly 60% (<xref ref-type="fig" rid="pcbi-1003145-g004">Fig. 4B</xref>). As start-time variation can be large (e.g. shown to vary between 0.3 and 10 seconds <italic>in vivo</italic> in <italic>Xenopus laevis</italic> <xref ref-type="bibr" rid="pcbi.1003145-Gauthier1">[17]</xref>), techniques such as optogenetics, which control molecular activities with &lt;1 second temporal precision, will likely be required to decrease start-time variation. Thus, a DNAP constructed using a combination of the best parameters from within the range of documented DNAPs could likely be used to record continuous concentration traces at 1 second resolution, as long as polymerases are initially roughly synchronized.</p>
<fig id="pcbi-1003145-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003145.g004</object-id><label>Figure 4</label><caption>
<title>Continuous concentration decoding at high resolutions.</title>
<p><bold>A</bold>) Estimation error of continuous concentration decoding at 1 second resolution as a function of the time of recording. Parameters are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e052" xlink:type="simple"/></inline-formula> ms, <italic>P</italic> = 0, <italic>N</italic> = 1000, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e053" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e054" xlink:type="simple"/></inline-formula>. <bold>B</bold>) Estimation error at 6000 seconds (10 minutes) of recording for polymerases that do not start recording simultaneously. Polymerase start-time distributions are drawn from gamma distributions that have almost all values between 0 and twice the average delay time. <bold>C</bold>) Estimation error of continuous concentration decoding at 100 ms resolution as a function of the time of recording. Parameters are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e055" xlink:type="simple"/></inline-formula> ms, <italic>P</italic> = 0, <italic>N</italic> = 10000, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e056" xlink:type="simple"/></inline-formula>, and varying <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e057" xlink:type="simple"/></inline-formula>. In all panels, solid lines are median estimation errors, and dashed lines are 95% confidence intervals.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003145.g004" position="float" xlink:type="simple"/></fig>
<p>Could such a DNAP record continuous concentrations at 100 ms resolution? Using a DNAP with a 1 ms elongation time and no pausing, 10000 templates, and a high differential misincorporation rate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e058" xlink:type="simple"/></inline-formula> vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e059" xlink:type="simple"/></inline-formula>, continuous concentrations can be accurately recorded (&lt;5% median error) at 100 ms resolution for only about 8 seconds (<xref ref-type="fig" rid="pcbi-1003145-g004">Fig. 4C</xref>). Using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e060" xlink:type="simple"/></inline-formula> (polymerase Iota's misincorporation rate on template T <xref ref-type="bibr" rid="pcbi.1003145-Frank1">[18]</xref>), accurate 100 ms resolution recording is still only possible for about 11 seconds. Non-synchronized start-times also have an even more deleterious effect at this higher temporal resolution: for example, when polymerase start-times vary from 0–1 seconds, the median estimation error is never below 30% (using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e061" xlink:type="simple"/></inline-formula>). Start-time variation must be very small to have limited effect on recording accuracy: for instance, start-times that vary from 0–200 ms will allow &lt;5% error until 7 seconds as opposed to 8 seconds. To record continuous concentration traces at 100 ms resolution for experimentally significant durations, sophisticated DNA engineering, to both lengthen the feasible recording duration and ensure extremely coordinated polymerase start-times, will likely be necessary.</p>
</sec></sec><sec id="s2e">
<title>Binary concentration decoding</title>
<p>Some experiments seek only to determine whether or not a neuron has fired within a given time window, rather than to determine an analog firing rate. This binary, rather than continuous, decoding scenario could lead to different constraints on the biochemical parameters of molecular recording devices. We studied binary decoding in the context of two experimental paradigms: detecting synchronized firing and recording spike trains at single-spike temporal resolution.</p>
<sec id="s2e1">
<title>Slow neuronal synchronization</title>
<p>Oscillations during slow-wave sleep are associated with frequencies of 0.1 to 0.5 Hz <xref ref-type="bibr" rid="pcbi.1003145-SanchezVives1">[19]</xref>, while delta brain waves are associated with frequencies of 0.5 to 4 Hz <xref ref-type="bibr" rid="pcbi.1003145-Ward1">[20]</xref>. A binary decoder with 100 ms temporal resolution could map such synchronization by determining whether any pair of neurons consistently fired together during 100 ms intervals.</p>
<p>We investigated the CMLFs required for this application, using optimal DNAP kinetic parameters from within naturally known ranges (1000 nt/sec elongation rate, no pausing, no dissociation) and 10000 DNA templates. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e062" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e063" xlink:type="simple"/></inline-formula>, binary decoding at 100 ms temporal resolution could be achieved for a recoding duration of 325 seconds at 95% accuracy (<xref ref-type="table" rid="pcbi-1003145-t001">Table 1</xref>). A 10% misincorporation rate at high ion concentration could provide the same level of resolution and accuracy for over 700 seconds of recording (<xref ref-type="table" rid="pcbi-1003145-t001">Table 1</xref>). We again find that for a constant ratio of misincorporation rates at high and low ion concentrations (diagonal of <xref ref-type="table" rid="pcbi-1003145-t001">Table 1</xref>), increasing misincorporation rates increases the feasible duration of recording. Additionally, decreasing the speed of the polymerase has a strong effect: an elongation time of 10 ms (as opposed to 1 ms), decreases the feasible recording time from 300 seconds to 10 seconds (at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e064" xlink:type="simple"/></inline-formula>).</p>
<table-wrap id="pcbi-1003145-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003145.t001</object-id><label>Table 1</label><caption>
<title>Binary decoding at 100 ms resolution.</title>
</caption><alternatives><graphic id="pcbi-1003145-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003145.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td colspan="4" align="left" rowspan="1">Baseline Misincorporation Probability (<italic>E</italic><sub>0</sub>)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Misincorporation Probability at High Concentration (<italic>E</italic><sub>h</sub>  = <italic>E</italic><sub>0</sub>+<italic>m</italic>)</td>
<td align="left" rowspan="1" colspan="1">0.5%</td>
<td align="left" rowspan="1" colspan="1">1.5%</td>
<td align="left" rowspan="1" colspan="1">5%</td>
<td align="left" rowspan="1" colspan="1">15%</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">1%</td>
<td align="left" rowspan="1" colspan="1">75 sec</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3%</td>
<td align="left" rowspan="1" colspan="1">325 sec</td>
<td align="left" rowspan="1" colspan="1">125 sec</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">10%</td>
<td align="left" rowspan="1" colspan="1">700 sec</td>
<td align="left" rowspan="1" colspan="1">475 sec</td>
<td align="left" rowspan="1" colspan="1">250 sec</td>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">30%</td>
<td align="left" rowspan="1" colspan="1">1275 sec</td>
<td align="left" rowspan="1" colspan="1">1000 sec</td>
<td align="left" rowspan="1" colspan="1">750 sec</td>
<td align="left" rowspan="1" colspan="1">425 sec</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>The maximum recording duration at which decoding at 100 ms temporal resolution is possible with 95% decoding accuracy. An optimal DNAP with an elongation time of 1 ms and no pausing is used, along with 10000 DNA templates. The search for maximal achievable recording durations was performed at 25 second intervals.</p></fn></table-wrap-foot></table-wrap>
<p>We next tested the effect of varying start-times on 100 ms resolution binary decoding. As was the case for continuous decoding, we found that start-time variation has a large impact on the feasible recording duration at this resolution. Start-times varying between 0 and 1 seconds still allow 95% decoding accuracy until 300 seconds of recording (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e065" xlink:type="simple"/></inline-formula>). However, for start-times varying between 0 and 3 seconds, 95% decoding accuracy is never achievable. Techniques that decrease start-time variation would thus be necessary in order to use molecular ticker tapes to record slow synchronization of neuronal oscillations.</p>
<p>Although these experiments would be limited to hundreds of seconds, the large number of individual neurons that could potentially be recorded could provide fundamentally new insights into mechanisms of neural synchronization. We thus find that coarse measurement of neuronal oscillations could be feasible at the limits of documented polymerase parameters, assuming an ample number of simultaneously replicated templates per cell and a mechanism to control the polymerase start-times.</p>
</sec><sec id="s2e2">
<title>Single-spike resolution</title>
<p>A desirable application for molecular ticker tapes would be the recording of neuronal spike trains at single-spike resolution (approximately 10 ms), e.g. for the study of spike timing dependent neural coding and plasticity <xref ref-type="bibr" rid="pcbi.1003145-Engel1">[21]</xref>. A binary decoder would be sufficient to determine whether or not a neuron has spiked within a 10 ms time bin.</p>
<p>Would a DNAP constructed from optimal kinetic parameters found within natural polymerases (1000 nt/s speed, no pausing) be able to record at 10 ms resolution? We find that only one second of recording with 95% accuracy is possible when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e066" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e067" xlink:type="simple"/></inline-formula>, and there are 10000 templates. If the misincorporation rate at high ion concentration is increased to 10%, then ∼2.5 seconds of recording at 10 ms temporal resolution could be achieved. In order to achieve 1 minute of accurate recording, a polymerase with a speed of 8000 nt/s (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e068" xlink:type="simple"/></inline-formula> ms) would be required given a 10% high misincorporation rate. Even in the limiting case of a 100% high misincorporation rate and a 0% low misincorporation rate, with no pausing and 10000 templates, a speed of 3500 nt/s would still be needed to achieve 1 minute of recording at 10 ms temporal resolution. These speeds are outside the range of polymerase speeds known from nature.</p>
<p>Therefore, even in the absence of pausing, and with arbitrarily high signal-to-noise ratio in the ion-dependent misincorporation rate, temporal stochasticity constrains the achievable temporal resolution for molecular recording. This results from the fact that there is no deterministic one-to-one mapping between time and nucleotide position; the time between base additions in the elongating state is not a constant but is rather governed by a probability distribution over dwell times. Our results suggest that recording spike trains at 10 ms resolution with a DNAP misincorporation-based molecular ticker tape and short-read sequencing, for more than a few seconds, would require sophisticated protein engineering to go beyond naturally occurring polymerase parameters.</p>
</sec></sec><sec id="s2f">
<title>Calibrating unknown DNAP parameters via sequencing</title>
<p>Decoding unknown input signals requires a detailed model of the polymerase dynamics (see <italic><xref ref-type="supplementary-material" rid="pcbi.1003145.s009">Text S3</xref></italic>, <xref ref-type="supplementary-material" rid="pcbi.1003145.s006">Fig. S6</xref>); however, such information may not always be available <italic>a priori</italic>. To determine if it is possible to calibrate the polymerase parameters from sequencing data generated with a known input signal, we tested the accuracy of estimating the three kinetic parameters of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e069" xlink:type="simple"/></inline-formula> DNAP with varying numbers of template copies for a fixed input concentration sequence of 10010001, with each segment lasting 150 seconds (the timeframe we use when analyzing multi-condition experiments). The percent error of the estimated parameters relative to the true parameters decreased as the number of template copies increased, with an especially sharp drop from 10 to 100 templates (<xref ref-type="fig" rid="pcbi-1003145-g005">Fig. 5A</xref>). Thus, it should be possible to calibrate polymerases with high accuracy, <italic>in vivo</italic>, where their dynamic properties may not be known.</p>
<fig id="pcbi-1003145-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003145.g005</object-id><label>Figure 5</label><caption>
<title>Estimating DNAP parameter values from sequencing data.</title>
<p><bold>A</bold>) The percent error of the estimated parameters compared to the true parameters (those of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e070" xlink:type="simple"/></inline-formula> DNAP) as a function of the number of template copies. <bold>B</bold>) The ion concentration estimation error based on polymerase parameters estimated from data using varying numbers of templates. Ion concentration estimation used <italic>N</italic> = 1000, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e071" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e072" xlink:type="simple"/></inline-formula>. In both panels, solid lines are median estimation errors, and dashed lines are 95% confidence intervals.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003145.g005" position="float" xlink:type="simple"/></fig>
<p>To confirm that polymerase parameters calibrated as above could be used to decode novel signals, we tested concentration decoding by using the estimated parameters on new (i.e. unknown) input signals. Specifically, we performed continuous ion concentration estimation in the multi-condition experiment framework as before, using 1000 DNA templates, and a CMLF of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e073" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e074" xlink:type="simple"/></inline-formula>, but this time using estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e075" xlink:type="simple"/></inline-formula> DNAP parameters as opposed to those used while producing the forward model. When we used at least 1000 templates to calibrate the DNAP parameters, we were able to estimate the initial time-varying ion concentration with ∼1.5% median error (<xref ref-type="fig" rid="pcbi-1003145-g005">Fig. 5B</xref>), a minimal change compared to the error obtained using known parameters. Our results indicate that data driven calibration is an effective method that will allow decoding of concentration traces generated using previously un-characterized polymerases (i.e., those that have not been subjected to single-molecule biophysics experiments to determine their detailed properties in physiologically relevant contexts).</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>This work presents analytical and algorithmic approaches to the statistical problems associated with signal reconstruction in molecular ticker tapes. We develop a procedure to estimate the time-dependent state of the environment from the observed strings of symbols in the replicated polymers and analyze its dependence on several experimentally relevant parameters. In addition, we present an analytical approach that illustrates intuitively how the precision of ion concentration estimation depends on these parameters. We show that high-accuracy estimation is possible under certain conditions even for DNAPs that dissociate from the DNA template and those with asynchronous start-times.</p>
<sec id="s3a">
<title>Comparisons with existing neural recording technologies</title>
<p>A proposed application for molecular ticker tapes is to record simultaneously from large numbers of neurons. In the scheme treated here, polymerase misincorporation rates would be made to depend on ions, such as calcium, for which the intracellular concentration varies in response to neuronal activity. More generally, physical variables such as membrane voltage could be used in a molecularly engineered system to modulate nucleotide incorporation probabilities either through direct physical action on the polymerase, or indirectly by controlling the availability of small molecules such as nucleotides or ions. It should thus be possible to use DNAPs to measure many microscopic variables of interest in neuroscience.</p>
<p>It is important to compare the spatial resolution of molecular ticker tapes to existing techniques. One highly scalable technique with high spatial resolution is 2-deoxy-D-glucose (2-DG) imaging <xref ref-type="bibr" rid="pcbi.1003145-Sokoloff1">[22]</xref>, which utilizes the fact that active neurons consume more glucose, and allows estimation of neural activity during one or two <xref ref-type="bibr" rid="pcbi.1003145-Friedman1">[23]</xref> conditions. Molecular ticker tapes promise to achieve similar spatial scale and resolution to 2-DG, while also allowing multiplexing across many conditions during the same experiment. In particular, our results suggest that molecular ticker tapes could be used to determine the firing rate responses of neurons under a sequence of ∼10 conditions, using a DNAP with kinetic parameters similar to those of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e076" xlink:type="simple"/></inline-formula> DNAP. A popular technique with lower spatial resolution (∼1 mm) is fMRI, which is often used to compare voxel-scale hemodynamic responses across a number of conditions. Molecular ticker tapes, in contrast, promise much greater spatial resolution while also allowing multiple conditions per experiment.</p>
<p>It is also important to compare the temporal resolution of molecular ticker tapes to existing techniques. We found that, while determining binary neural responses could be feasible at resolutions of &gt;10 Hz through combining favorable biochemical parameters from multiple existing DNAPs into a single engineered system, temporal resolutions approaching 100 Hz may be hard to reach, for recording durations of longer than a few seconds, without sophisticated protein engineering to go beyond individual parameters known from nature. However, molecular ticker tapes do have the potential to rival the temporal resolution of fMRI and surpass that of 2-DG imaging. Many other techniques, including EEG, local field potentials, calcium imaging, and single cell recordings, allow very high temporal resolution but are currently limited to small numbers of simultaneously recorded cells; greatly improved engineered DNAPs would be necessary for molecular ticker tapes to reach comparable temporal resolutions. Molecular ticker tapes thus present an opportunity to combine effectively unlimited spatial resolution with temporal resolution sufficient for complex functional studies, but this approach will face challenges in capturing the single-spike timescale (see <xref ref-type="table" rid="pcbi-1003145-t002">Table 2</xref>).</p>
<table-wrap id="pcbi-1003145-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003145.t002</object-id><label>Table 2</label><caption>
<title>Technology comparison.</title>
</caption><alternatives><graphic id="pcbi-1003145-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003145.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">Spatial Resolution</td>
<td align="left" rowspan="1" colspan="1">Temporal Resolution</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>fMRI</bold> (current setups)</td>
<td align="left" rowspan="1" colspan="1">∼1 mm</td>
<td align="left" rowspan="1" colspan="1">∼1 sec</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>2-DG</bold></td>
<td align="left" rowspan="1" colspan="1">∼100 µm</td>
<td align="left" rowspan="1" colspan="1">&gt;30 min</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>Ticker Tape</bold> (DNAP kinetics at limits of known polymerases, 10k DNA templates)</td>
<td align="left" rowspan="1" colspan="1">1 neuron (∼10 µm)</td>
<td align="left" rowspan="1" colspan="1">∼100 ms binary decoding ∼1 sec continuous decoding</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p>Approximate spatial and temporal resolutions for a subset of technologies theoretically capable of recording from entire mammalian brains.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3b">
<title>Estimating DNAP kinetic parameters using molecular recording</title>
<p>There is considerable uncertainty about the parameters characterizing the dynamics of most DNAPs. Databases available online <xref ref-type="bibr" rid="pcbi.1003145-Langhorst1">[24]</xref> do not fully specify the dynamics. More importantly, there may be significant variation in polymerase dynamics between different <italic>in vivo</italic> settings. Our study suggests that DNAP kinetic parameters can be characterized using data solely derived from deep sequencing. We could fit average speed, processivity, misincorporation rates (insertion or deletion), pause density and duration, and any other such parameters. These parameters could even be determined in a high throughput manner from sequencing data as a function of many variables such as divalent cation concentration <xref ref-type="bibr" rid="pcbi.1003145-Zamft1">[4]</xref>, substrate composition/concentration, or the effects of inhibitors/mutagens. The amenability of this sequencing-based characterization method to high-throughput experimental procedures stands in contrast to more traditional single-molecule methods. Additionally, this approach could allow determination of <italic>in vivo</italic> DNAP dynamics, which is usually not accessible to single-molecule methods. The method we present, based on fitting a generative model using sequence data, may therefore augment methods based on direct single-molecule biophysical observations of the dynamics of polymer-generating molecular machines <xref ref-type="bibr" rid="pcbi.1003145-Ibarra1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Davenport1">[25]</xref>–<xref ref-type="bibr" rid="pcbi.1003145-Zamft2">[28]</xref>.</p>
<p>Here we have focused on a DNAP-based molecular ticker tape. However, our methodology could be applicable to any molecular recording device based on modulating a polymerization process. Any system in which an enzyme catalyzes the formation of polymers with sequence features dependent on an environmental signal will fit into our basic theoretical framework and could be used to record time-varying signals. Thus, our methodology could also be used to characterize kinetic parameters of enzymes besides DNAP.</p>
</sec><sec id="s3c">
<title>Algorithmic limitations and future directions</title>
<p>While neural spike times and firing rates are the variables critical to neuroscience, our continuous decoding algorithm estimates time-dependent concentrations. Sometimes, calcium concentration increases linearly with firing rates. For example, sustained firing in the proximal apical dendrite of cortical layer 5 pyramidal neurons results in a calcium concentration that scales approximately linearly with firing rate (its equilibrium time constant is 200 ms) <xref ref-type="bibr" rid="pcbi.1003145-Koch1">[11]</xref>. However, the conversion from intracellular free Ca<sup>2+</sup> concentrations to spike rates is generally nonlinear and dependent on cell type (e.g. on the number and distribution of voltage gated calcium channels). Nonetheless, the problem of inferring spike rates from Ca<sup>2+</sup> signals has been studied extensively and effective algorithms have been developed <xref ref-type="bibr" rid="pcbi.1003145-Vogelstein1">[29]</xref>–<xref ref-type="bibr" rid="pcbi.1003145-Mishchenko1">[31]</xref>. Intracellular free Ca<sup>2+</sup> has been successfully used as an indicator of neural activity in many high-resolution techniques <xref ref-type="bibr" rid="pcbi.1003145-Yuste1">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Chun1">[33]</xref>. If ion-dependent DNAP misincorporation is used as a sensing mechanism in molecular ticker tapes, then future work will need to combine our methodology with these techniques to infer neural firing rates from ion concentration traces. However, it may also be possible to directly couple DNAP misincorporation to trans-membrane voltage through the use of protein engineering.</p>
<p>The conclusions from our binary decoder regarding what is feasible are based on the assumption that the maximum likelihood solution can be found. While we performed an exhaustive search of the binary parameter space to find the maximum likelihood solution, to use this algorithm for long bit strings, more efficient binary optimization routines will be necessary.</p>
<p>The algorithms used here make important assumptions about DNA replication. They assume that misincorporation probabilities at neighboring template bases are statistically independent, an assumption that significantly simplifies all calculations and that is consistent with previous measurements in the presence of fixed concentrations of manganese <xref ref-type="bibr" rid="pcbi.1003145-Zamft1">[4]</xref>. This assumption could be violated if the misincorporation rate at a base depends on the presence or absence of a mismatch across the double helix at the previous base. Such effects would need to be incorporated into the forward model of polymerase misincorporations as well as the decoding algorithms.</p>
<p>Another conflating effect could also occur under time-varying (but not static) ion concentrations, if the elongation time at a base depends on the presence or absence of a misincorporation (and hence a mismatch across the double helix) in the previous position(s). Further studies are needed to address the effect of nearby mismatches on the nucleotide addition time and the interaction of this effect with time-varying ion concentrations.</p>
<p>Furthermore, the algorithms used here assume that the DNAP dynamics (e.g., elongation rate, pause rate and pause duration) are unaffected by the surrounding ion concentrations (except via the misincorporation probability itself that is deliberately a function of ion concentration), which is in general not true <xref ref-type="bibr" rid="pcbi.1003145-Thomen1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Frank1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Hays1">[34]</xref>. In a plausible alternative scenario, the elongation time may depend directly on the instantaneous local ion concentration. While this would not directly couple misincorporations at adjacent nucleotides via the forward model (i.e., the DNAP's misincorporation probability at a given time still depends only on the instantaneous ion concentration, and not on its history of previous misincorporations), it would lead to changes in polymerase dynamics over time, causing increased variation in the incorporation times for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e077" xlink:type="simple"/></inline-formula> nucleotide. It would also lead to a more difficult inverse problem, as the misincorporation rate at a given nucleotide position would depend on the entire history of the unknown input ion concentration trace that is to be estimated. In future work, this feature could be added, motivating an EM-type algorithm <xref ref-type="bibr" rid="pcbi.1003145-Dempster1">[35]</xref> which iteratively adjusts both the forward model parameters (as a function of ion concentration) and the inferred ion concentration trace itself.</p>
<p>Our methods also assume a given temperature and fixed concentrations of DNA template, DNAP and nucleotide substrates, and do not account for local template structure or for the identity of the nucleotide to be copied, all of which are important <xref ref-type="bibr" rid="pcbi.1003145-Zamft1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Mejia1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-CornishBowden1">[36]</xref>. However, these features could be readily accounted for by adding more parameters to the model. Despite these assumptions, the decoding algorithms are simple and applicable to the problems defined by current experimental techniques, e.g., in the context of preliminary experimental testing of molecular recording paradigms.</p>
<p>Real polymerase kinetics are more complex than our simple forward model, in which the sum of two exponentials governs the time distribution between nucleotide additions. In principle, any model of DNAP dynamics <xref ref-type="bibr" rid="pcbi.1003145-Ibarra1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Sharma1">[37]</xref> could be fit to the same data. It may also be possible to generalize this work based on general statistical descriptions of enzymatic dynamics <xref ref-type="bibr" rid="pcbi.1003145-Shaevitz1">[38]</xref>–<xref ref-type="bibr" rid="pcbi.1003145-Kolomeisky1">[40]</xref>. This approximation approach would decrease our algorithm's run-time and the amount of data required. In the future, the methods presented here can thus be extended to treat more realistic enzyme kinetics.</p>
<p>Lastly, the inverse problem that we are solving here has deep connections with deconvolution, and one could argue that misincorporation rates result from a time-dependent convolution of a time-dependent source signal. There is a rich literature on such deconvolution techniques (e.g. <xref ref-type="bibr" rid="pcbi.1003145-Vogelstein1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Vogelstein2">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Bell1">[41]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Kirkeby1">[42]</xref>) and more generally on latent variable models, which have been prominently used in neuroscience (e.g. <xref ref-type="bibr" rid="pcbi.1003145-Yu1">[43]</xref>–<xref ref-type="bibr" rid="pcbi.1003145-Sahani1">[45]</xref>). Combining our approaches with existing computational methodologies promises to enable improved algorithms.</p>
</sec><sec id="s3d">
<title>Towards single-spike resolution</title>
<p>Could molecular signal recording at high temporal resolutions be possible? Increasing the polymerase speed and decreasing the stochastic pausing of an engineered DNAP might be the most feasible pathways. At a more fundamental level, one could engineer a DNAP to exhibit less stochasticity in its elongation rate (i.e., compared to the assumption of a single-exponential distribution of dwell times in the elongating state which was studied here) even after pausing has been eliminated. In general, multi-step kinetic processes can be remarkably regular in time, as long as the rates of each of the kinetic sub-steps (e.g., nucleotide entry, binding, pyrophosphate cleavage, pyrophosphate release, and physical motion of the enzyme forward) are comparable <xref ref-type="bibr" rid="pcbi.1003145-Moffitt1">[7]</xref>. For example, the packaging motor of the bacteriophage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e078" xlink:type="simple"/></inline-formula> moves along DNA with little stochasticity under certain adenosine triphosphate concentrations because as many as six separate kinetic events are equally rate limiting in its catalytic cycle <xref ref-type="bibr" rid="pcbi.1003145-Moffitt2">[46]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Moffitt3">[47]</xref>. Similarly, one could imagine engineering clock-like polymerases by first removing pause states and then by balancing the rates of the multiple catalytic sub-steps within each nucleotide addition. Thus, there are polymerase engineering directions that could significantly improve temporal resolution.</p>
<p>While we assumed here a single-exponential dwell time distribution in the elongating state, to our knowledge this distribution has not been experimentally measured. Thus, it is possible that real polymerases are less stochastic at the level of pause-free nucleotide additions than we have assumed. If true, this could make the problem of engineering a molecular recorder with single-spike resolution more tractable.</p>
<p>Combining the methodology discussed here with additional experimental and computational machinery may also significantly enhance the achievable temporal resolution. For instance, an external signal could be used as a clock pulse. Neurons could be optogenetically activated at known times, altering the misincorporation rates of nucleotides incorporated at those times, effectively embedding synchronization signals into the DNA sequences. Computational techniques could be developed to estimate the nucleotides' incorporation times given this additional timing information. As our methodology is currently limited by the stochasticity of nucleotide incorporation times, such an approach would have the potential to increase the feasible duration of recording at high temporal resolutions.</p>
</sec><sec id="s3e">
<title>Conclusion</title>
<p>The ability to record cellular signals is a cornerstone of neuroscience. Current macroscopic recording devices can simultaneously sample only a tiny number (currently hundreds to thousands) of neurons in mammals <xref ref-type="bibr" rid="pcbi.1003145-Wang1">[48]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Buzsaki1">[49]</xref> (but see <xref ref-type="bibr" rid="pcbi.1003145-Ahrens1">[13]</xref>). Due to the scalability of molecular technology, the molecular signal-recording devices discussed here could potentially enable the simultaneous recording from millions or billions of neurons. This approach is particularly attractive because the price-performance of DNA sequencing has been improving faster than Moore's law <xref ref-type="bibr" rid="pcbi.1003145-Carr1">[50]</xref>. Statistical techniques to allow precise readout, despite the imperfect clocks of molecular ticker tapes, will be important for the development of molecular recording technologies. In demonstrating these computational techniques, we have illustrated an analytical framework as well as practical decoding methods that provide insight into the capabilities and limitations of molecular ticker tapes as a function of relevant experimental parameters.</p>
</sec></sec><sec id="s4" sec-type="methods">
<title>Methods</title>
<sec id="s4a">
<title>Derivation of the forward model: Modeling DNAP dynamics and dwell time distributions</title>
<p>We use a simplified model of DNAP dynamics based on recent single-molecule measurements <xref ref-type="bibr" rid="pcbi.1003145-Sharma1">[37]</xref>. We model the time distribution between successive nucleotide additions, or “dwell time,” as the sum of two exponentials (<xref ref-type="fig" rid="pcbi-1003145-g006">Fig. 6A&amp;B</xref>), which correspond to the processes of (i) continuing directly from one nucleotide to the next, and (ii) pausing in an off-pathway state between nucleotide additions. A decaying exponential has been recently shown to fit pause lifetime data <xref ref-type="bibr" rid="pcbi.1003145-Schwartz1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003145-Morin1">[51]</xref>. The normalized probability distribution over times between successive nucleotide additions is then:<disp-formula id="pcbi.1003145.e079"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e079" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e080" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e081" xlink:type="simple"/></inline-formula> are the average times for the continuous (elongation) and pausing paths respectively, <italic>P</italic> is the DNAP pause probability per nucleotide (i.e. the pause density), and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e082" xlink:type="simple"/></inline-formula> is the parameter set for a particular DNAP.</p>
<fig id="pcbi-1003145-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003145.g006</object-id><label>Figure 6</label><caption>
<title>Minimal forward model of misincorporation by a DNAP.</title>
<p><bold>A</bold>) DNAP can copy one nucleotide directly after another (top path) or pause between additions (bottom path). <bold>B</bold>) Dwell-time distributions between nucleotide additions. Distributions for the continuous route and for the pausing route are mixed based on their relative frequencies to create the full dwell time distribution, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e083" xlink:type="simple"/></inline-formula>. For this panel, the parameters are set as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e084" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e085" xlink:type="simple"/></inline-formula> ms, and <italic>P</italic> = 0.3, to best illustrate the concept of distribution mixing. <bold>C</bold>) Time distributions, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e086" xlink:type="simple"/></inline-formula>, resulting from repeated convolutions of the dwell time distribution, are shown for nucleotides 50, 200, 400, and 600. Iterated convolutions cause the distribution to widen for later times. For this panel and below, parameters are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e087" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e088" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e089" xlink:type="simple"/></inline-formula>. <bold>D</bold>) An example time-varying concentration. <bold>E</bold>) The probability of misincorporation for a polymerase subjected to the input concentration trace from panel B. The misincorporation probability is related to the concentration through a CMLF: here, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e090" xlink:type="simple"/></inline-formula> <bold>F</bold>) The misincorporation probability of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e091" xlink:type="simple"/></inline-formula> nucleotide, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e092" xlink:type="simple"/></inline-formula>. The more the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e093" xlink:type="simple"/></inline-formula> nucleotide's incorporation-time distribution overlaps with the concentration peaks in the time-varying input signal, the larger the misincorporation probability at the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e094" xlink:type="simple"/></inline-formula> nucleotide.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003145.g006" position="float" xlink:type="simple"/></fig>
<p>For a full discussion of polymerase model simplifications, see <italic><xref ref-type="supplementary-material" rid="pcbi.1003145.s010">Text S4</xref></italic>. Importantly, while we have here chosen to approximate dwell time as the sum of two exponentials, any normalized dwell time distribution is compatible with our methodology, as any two probability distributions can be convolved (see below).</p>
</sec><sec id="s4b">
<title>Derivation of the forward model: Time distributions of nucleotide incorporations</title>
<p>The probability distribution over dwell times that we discuss above induces a probability distribution for the time of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e095" xlink:type="simple"/></inline-formula> nucleotide addition, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e096" xlink:type="simple"/></inline-formula>. Basically, the time nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e097" xlink:type="simple"/></inline-formula> is written is the sum of the time nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e098" xlink:type="simple"/></inline-formula> was written plus the dwell time drawn from the distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e099" xlink:type="simple"/></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1003145.e079"><italic>Eq. 2</italic></xref>). We calculate the probability distribution of the sum of two independent random variables (we assume in this model that the dwell time distributions for subsequent steps are independent) via the convolution of their distributions <xref ref-type="bibr" rid="pcbi.1003145-Hogg1">[52]</xref>:<disp-formula id="pcbi.1003145.e100"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e100" xlink:type="simple"/><label>(3)</label></disp-formula>(<xref ref-type="fig" rid="pcbi-1003145-g006">Fig. 6C</xref>). Note that unless otherwise stated, polymerases are assumed to start at the first nucleotide at time 0, so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e101" xlink:type="simple"/></inline-formula>.</p>
<p>For large <italic>i</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e102" xlink:type="simple"/></inline-formula> can be approximated as a Gaussian (as is done in the enzymatic dynamics literature <xref ref-type="bibr" rid="pcbi.1003145-Shaevitz1">[38]</xref>–<xref ref-type="bibr" rid="pcbi.1003145-Kolomeisky1">[40]</xref>): <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e103" xlink:type="simple"/></inline-formula>. This can be expressed for every nucleotide <italic>i</italic>, in terms of the DNAP kinetic parameters:<disp-formula id="pcbi.1003145.e104"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e104" xlink:type="simple"/><label>(4a)</label></disp-formula><disp-formula id="pcbi.1003145.e105"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e105" xlink:type="simple"/><label>(4b)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e106" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e107" xlink:type="simple"/></inline-formula> are respectively the mean and standard deviation of a Gaussian distribution governing the time at which nucleotide <italic>i</italic> is incorporated. For all simulations we will work with a discrete-time form of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e108" xlink:type="simple"/></inline-formula>, and use this Gaussian approximation for large <italic>i</italic> (see <italic><xref ref-type="supplementary-material" rid="pcbi.1003145.s011">Text S5</xref></italic> for details). The time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e109" xlink:type="simple"/></inline-formula> when each nucleotide is written is a latent variable here, which we integrate out (see <xref ref-type="disp-formula" rid="pcbi.1003145.e121"><italic>Eq. 5</italic></xref>).</p>
</sec><sec id="s4c">
<title>Derivation of the forward model: Quantifying misincorporation probabilities</title>
<p>A concentration to misincorporation link function (CMLF), <italic>f</italic>, quantifies the misincorporation rate when a nucleotide is replicated in the presence of a constant concentration. We assume this function to be known based on previous experiments. In molecular recording, a nucleotide will be copied as concentrations are fluctuating. Thus, in this simplest of models, a nucleotide's probability of misincorporation is dependent on the ion concentration at the time at which it is incorporated, and on the CMLF. To calculate the probability of misincorporation on the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e110" xlink:type="simple"/></inline-formula> nucleotide, we weight the probability of misincorporation resulting from the ion concentration at a given time <italic>t</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e111" xlink:type="simple"/></inline-formula>, by the probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e112" xlink:type="simple"/></inline-formula> that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e113" xlink:type="simple"/></inline-formula> nucleotide is copied at time <italic>t</italic>, and sum this product over all values of the time variable (marginalization):<disp-formula id="pcbi.1003145.e114"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e114" xlink:type="simple"/><label>(5a)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e115" xlink:type="simple"/></inline-formula> is a misincorporation on nucleotide <italic>i</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e116" xlink:type="simple"/></inline-formula> is the ion concentration at time <italic>t</italic>, and <bold><italic>C</italic></bold> (bolded) is the vector with elements <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e117" xlink:type="simple"/></inline-formula> over all times <italic>t</italic>.</p>
<p>We assume <italic>f</italic> is linear (<xref ref-type="fig" rid="pcbi-1003145-g006">Fig. 6D&amp;E</xref>) <xref ref-type="bibr" rid="pcbi.1003145-Zamft1">[4]</xref>, i.e.<disp-formula id="pcbi.1003145.e118"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e118" xlink:type="simple"/><label>(5b)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e119" xlink:type="simple"/></inline-formula> is the baseline error rate, <italic>m</italic> is the slope of the CMLF, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e120" xlink:type="simple"/></inline-formula>. In this case,<disp-formula id="pcbi.1003145.e121"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e121" xlink:type="simple"/><label>(5c)</label></disp-formula>(<xref ref-type="fig" rid="pcbi-1003145-g006">Fig. 6F</xref>). Note that the linear form of the CMLF generally is approximately accurate for small concentration perturbations, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e122" xlink:type="simple"/></inline-formula> is the first-order Taylor expansion of a general, smooth CMLF.</p>
</sec><sec id="s4d">
<title>Analytical relation between estimation precision and experimental parameters</title>
<p>Fisher information measures the degree to which samples from a probability distribution are informative about the parameters characterizing that distribution. In the simplified case that there is a single ion concentration square pulse during a time interval starting at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e123" xlink:type="simple"/></inline-formula> with duration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e124" xlink:type="simple"/></inline-formula> (the ion concentration assumed zero elsewhere), we analytically quantify the Fisher information, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e125" xlink:type="simple"/></inline-formula>, that <italic>N</italic> copied DNA templates contain about the concentration, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e126" xlink:type="simple"/></inline-formula>, during time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e127" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e128" xlink:type="simple"/></inline-formula>.</p>
<p>Applying the previously derived forward model (<xref ref-type="disp-formula" rid="pcbi.1003145.e121"><italic>Eq. 5c</italic></xref>), we set the probability of misincorporation at the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e129" xlink:type="simple"/></inline-formula> nucleotide as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e130" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e131" xlink:type="simple"/></inline-formula> is the probability that nucleotide <italic>i</italic> is replicated during the time interval at which the concentration burst is present:<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e132" xlink:type="simple"/></inline-formula>. From now on, we will refer to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e133" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e134" xlink:type="simple"/></inline-formula> for brevity. We let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e135" xlink:type="simple"/></inline-formula> signify a correct incorporation at nucleotide <italic>i</italic> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e136" xlink:type="simple"/></inline-formula> signify a misincorporation at nucleotide <italic>i</italic>, so that the probability of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e137" xlink:type="simple"/></inline-formula> is<disp-formula id="pcbi.1003145.e138"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e138" xlink:type="simple"/><label>(6)</label></disp-formula>From now on, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e139" xlink:type="simple"/></inline-formula> will be written only as a function of parameters that are explicitly changing (in this case <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e140" xlink:type="simple"/></inline-formula>).</p>
<p>The Fisher information in this distribution is:<disp-formula id="pcbi.1003145.e141"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e141" xlink:type="simple"/><label>(7a)</label></disp-formula>At constant ion concentrations, misincorporation probabilities at successive template bases are approximately independent <xref ref-type="bibr" rid="pcbi.1003145-Zamft1">[4]</xref>. Because Fisher information is additive across independent events,<disp-formula id="pcbi.1003145.e142"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e142" xlink:type="simple"/><label>(7b)</label></disp-formula>Additionally, we assume that individual templates are copied independently, so that:<disp-formula id="pcbi.1003145.e143"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e143" xlink:type="simple"/><label>(7c)</label></disp-formula>We use <xref ref-type="disp-formula" rid="pcbi.1003145.e143"><italic>Eq. 7c</italic></xref> as a basis for our analysis.</p>
<p>In the limit that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e144" xlink:type="simple"/></inline-formula>, the Fisher information can be approximated as:<disp-formula id="pcbi.1003145.e145"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e145" xlink:type="simple"/></disp-formula>as is given in <xref ref-type="disp-formula" rid="pcbi.1003145.e008"><italic>Eq. 1</italic></xref>.</p>
<p>For a method to determine optimal decoding accuracy of a single concentration pulse using Fisher information, expressions of how Fisher information relates to pulse properties besides concentration, and full derivations, see <italic><xref ref-type="supplementary-material" rid="pcbi.1003145.s007">Text S1</xref></italic>.</p>
</sec><sec id="s4e">
<title>Estimation of continuous time-varying concentrations</title>
<p>In order to move beyond the assumption that there is a single concentration pulse, we estimate the concentration trace by minimizing a convex, differentiable, cost function with constraints:<disp-formula id="pcbi.1003145.e146"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e146" xlink:type="simple"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e147" xlink:type="simple"/></inline-formula> is the total number of misincorporations at nucleotide position <italic>i</italic> summed across all templates, <italic>L</italic> is the length of the template in bases, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e148" xlink:type="simple"/></inline-formula> is the final time of recording. Our cost function penalizes the difference between the actual number of misincorporations on a nucleotide and the expected number of misincorporations (at the concentration being queried). When the concentration trace is expected to be sparse and/or smooth, additional terms, for example <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e149" xlink:type="simple"/></inline-formula> and/or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e150" xlink:type="simple"/></inline-formula> respectively, can be included in the cost function. We optimize this cost function using a constrained gradient-based solver based on line-search methods, <italic>“minConf,”</italic> <xref ref-type="bibr" rid="pcbi.1003145-Schmidt1">[53]</xref>.</p>
</sec><sec id="s4f">
<title>Estimation of binary time-varying concentrations</title>
<p>To estimate an original binary time-varying ion concentration, we run the forward model with many different binary time-varying ion concentrations and determine which is the most likely to produce the observed sequences. Assuming independent binary (Bernoulli) events, the likelihood that a concentration will result in the observed sequences is given by the binomial distribution <xref ref-type="bibr" rid="pcbi.1003145-Hogg1">[52]</xref>:<disp-formula id="pcbi.1003145.e151"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003145.e151" xlink:type="simple"/><label>(9)</label></disp-formula></p>
<p>Limiting the acceptable input concentrations to “high” and “low” values (1 and 0) turns the concentration vector into a bit sequence. Thus, to estimate the sequence of <italic>k</italic> concentration pulses, or bits, we have to search in a binary space of dimensionality <italic>k</italic>. In our simulations, we limit the number of bits to 10, as accuracy does not significantly degrade beyond this number of bits for many relevant parameter values, and this allows a full exploration of the binary space.</p>
</sec><sec id="s4g">
<title>DNAP parameter estimation</title>
<p>To estimate the DNAP parameters from sequencing data, we look for the parameters that are most likely to result in the observed sequences, using <xref ref-type="disp-formula" rid="pcbi.1003145.e151"><italic>Eq. 9</italic></xref>. We search for the DNAP parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e152" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e153" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e154" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e155" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e156" xlink:type="simple"/></inline-formula> are assumed to be known from previous experiments) that give the highest likelihood using the Nelder-Mead SIMPLEX algorithm <xref ref-type="bibr" rid="pcbi.1003145-Nelder1">[54]</xref>. The fixed, time-varying ion concentration signal that we use to estimate the DNAP parameter values affects the estimation accuracy, and we therefore initially test parameter estimation at several time-varying concentrations. The concentration trace that allows the most accurate parameter estimation (during testing with known parameters) is then used for all parameter estimations in this study.</p>
</sec><sec id="s4h">
<title>Testing estimation accuracy</title>
<p>We used simulated molecular recording experiments to test the accuracy of ion concentration estimation using recording time resolutions and durations relevant to neural recording experiments. We determined the DNAP kinetic parameters, CMLF, and number of DNA templates required for various neural applications, and how they are affected by DNAP dissociation from the template, start-time variation, and initially unknown DNAP kinetic parameters. DNAP dissociation was considered by adding in an additional exponential to the dwell time distribution (<xref ref-type="disp-formula" rid="pcbi.1003145.e079"><italic>Eq. 2</italic></xref>), and start-time variation was considered by convolving a Gamma distribution representing varying start-times with the time distribution of nucleotide incorporations (like in <xref ref-type="disp-formula" rid="pcbi.1003145.e100"><italic>Eq. 3</italic></xref>). Details of our simulation methods can be found in <italic><xref ref-type="supplementary-material" rid="pcbi.1003145.s011">Text S5</xref></italic>.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003145.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003145.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Optimality of continuous ion concentration estimation.</bold> For a single ion concentration pulse, the variance of ion concentration estimation using our Fisher information framework (red) is compared to estimation accuracy computed using our unconstrained (green) and constrained (blue) continuous decoding algorithms on simulated data. As the variance derived from the Fisher information framework (Cramer-Rao bound: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e157" xlink:type="simple"/></inline-formula>) assumes unbiased estimation, the red and green curves are comparable. Estimation constraints provide additional information that can be used to further reduce the variance (of the blue curve). These plots use a concentration of 0.5, and similar plots exist for other concentrations. Experimental parameters are set as: 20 minutes of recording, 150 second concentration pulse, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e158" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e159" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e160" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e161" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e162" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e163" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e164" xlink:type="simple"/></inline-formula>). Error bars are standard errors of the mean accuracy, produced by bootstrapping. In each panel, one parameter is allowed to vary: <bold>A</bold>) the number of DNA templates, <italic>N</italic>, <bold>B</bold>) the baseline misincorporation rate, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e165" xlink:type="simple"/></inline-formula> , <bold>C</bold>) the slope of the CMLF, <italic>m</italic>, <bold>D</bold>) the pause frequency, <italic>P</italic>, <bold>E</bold>) the duration of concentration pulses, and <bold>F</bold>) the end time of the pulse.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003145.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003145.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>Optimality of binary ion concentration estimation.</bold> For a single ion concentration pulse, the approximate decoding accuracy derived from our information-theoretic framework (red) is compared to decoding accuracy computed using simulations of our binary decoding algorithm (blue). Experimental parameters are set as: 20 minutes of recording, 15 second concentration pulse, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e166" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e167" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e168" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e169" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e170" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e171" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e172" xlink:type="simple"/></inline-formula>). Error bars are standard errors of the mean accuracy produced by bootstrapping. In all panels (<bold>A–F</bold>), one parameter is allowed to vary as is described in the legend of <xref ref-type="supplementary-material" rid="pcbi.1003145.s001">Fig. S1</xref>.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003145.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003145.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p><bold>DNAP dissociation from the template.</bold> The error of ion concentration estimation is shown for varying re-association times for DNAPs with processivities of 1000 (blue) and 100 (red) in a multi-condition experiment. Solid lines are median estimation errors, and dashed lines are 95% confidence intervals. Used parameters are: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e173" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e174" xlink:type="simple"/></inline-formula> ms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e175" xlink:type="simple"/></inline-formula> ms, <italic>P</italic> = 0.05, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e176" xlink:type="simple"/></inline-formula> , and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e177" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e178" xlink:type="simple"/></inline-formula>).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003145.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003145.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p><bold>Concentration fluctuations.</bold> Estimation error for concentrations that are fixed (blue) and allowed to fluctuate (red) during each condition in a multi-condition experiment, as a function of number of templates. When estimating fixed concentrations, the concentrations at each condition are confined to be 0.2 to 0.8 (estimated values can still be between 0 and 1). When estimating fluctuating concentrations, the “baseline” concentration at each condition is also confined between 0.2 and 0.8, but the concentration value at every ms is chosen randomly from the interval [baseline-0.2 baseline+0.2]. For the fluctuation condition, we are attempting to estimate the mean concentration for each condition. Solid lines are median estimation errors, and dashed lines are 95% confidence intervals.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003145.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003145.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p><bold>Varying numbers of presented conditions.</bold> <bold>A</bold>) Ion concentration estimation accuracy as a function of the number of different conditions tested within a 20 minute experiment. Solid lines are median estimation errors, and dashed lines are 95% confidence intervals. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e179" xlink:type="simple"/></inline-formula> DNAP kinetic parameters, <italic>N</italic> = 1000, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e180" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e181" xlink:type="simple"/></inline-formula> are used. <bold>B</bold>) For an experiment with 32 conditions, the median ion concentration estimation error with varying DNAP pausing parameters, a set elongation time of 5 ms, and the same additional parameters as panel A. Note that the scale differs from that of <xref ref-type="fig" rid="pcbi-1003145-g003">Fig. 3</xref>.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003145.s006" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003145.s006" position="float" xlink:type="simple"><label>Figure S6</label><caption>
<p><bold>Effects of polymerase parameters on misincorporation probabilities.</bold> <bold>A</bold>) Different combinations of the three DNAP kinetic parameters. <bold>B</bold>) The time distribution for the addition of the 50th nucleotide, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e182" xlink:type="simple"/></inline-formula> for each set of parameter values. <bold>C</bold>) An example time-varying concentration, used to calculate the misincorporation probabilities shown in panel D. The CMLF is set as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003145.e183" xlink:type="simple"/></inline-formula>. <bold>D</bold>) The misincorporation probability for the 50<sup>th</sup> nucleotide, for the three simulations with different parameter combinations.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003145.s007" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003145.s007" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Fisher information.</bold> Further simplifications of the Fisher information equations in several limits, discussion of optimal concentration estimation given the derived Cramer Rao Bound, Fisher information with respect to additional pulse properties, and full derivations.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003145.s008" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003145.s008" position="float" xlink:type="simple"><label>Text S2</label><caption>
<p><bold>Multi-condition experiments.</bold> Further details about the results of multi-condition experiments when varying the number of templates, CMLFs, DNAP kinetic parameters, and number of conditions, and considering the effects of dissociation and asynchronous start-times.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003145.s009" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003145.s009" position="float" xlink:type="simple"><label>Text S3</label><caption>
<p><bold>Importance of DNAP parameters.</bold> <xref ref-type="sec" rid="s3">Discussion</xref> regarding how DNAP parameters affect the distribution of times at which nucleotides are written, and how this alters the resulting misincorporation probabilities.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003145.s010" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003145.s010" position="float" xlink:type="simple"><label>Text S4</label><caption>
<p><bold>DNAP model.</bold> A general discussion about DNAP dwell time distributions and the assumptions made to produce our simplified model.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003145.s011" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003145.s011" position="float" xlink:type="simple"><label>Text S5</label><caption>
<p><xref ref-type="sec" rid="s4"><bold>Methods</bold></xref><bold> for testing simulations.</bold> Details are given regarding how all simulations are run.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank Hugo Fernandes and Ted Cybulski for helpful comments.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003145-Church1"><label>1</label>
<mixed-citation publication-type="other" xlink:type="simple">Church GM, Shendure J (2003) Nucleic Acid Memory Device. US Patent 20030228611.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Kording1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kording</surname><given-names>KP</given-names></name> (<year>2011</year>) <article-title>Of toasters and molecular ticker tapes</article-title>. <source>PLoS Comput Biol</source> <volume>7</volume>: <fpage>e1002291</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-ElDeiry1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>El-Deiry</surname><given-names>WS</given-names></name>, <name name-style="western"><surname>Downey</surname><given-names>KM</given-names></name>, <name name-style="western"><surname>So</surname><given-names>AG</given-names></name> (<year>1984</year>) <article-title>Molecular mechanisms of manganese mutagenesis</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>81</volume>: <fpage>7378</fpage>–<lpage>7382</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Zamft1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zamft</surname><given-names>BM</given-names></name>, <name name-style="western"><surname>Marblestone</surname><given-names>AH</given-names></name>, <name name-style="western"><surname>Kording</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Schmidt</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Martin-Alarcon</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Measuring Cation Dependent DNA Polymerase Fidelity Landscapes by Deep Sequencing</article-title>. <source>PLoS One</source> <volume>7</volume>: <fpage>e43876</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Viguera1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Viguera</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Canceill</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Ehrlich</surname><given-names>SD</given-names></name> (<year>2001</year>) <article-title>Replication slippage involves DNA polymerase pausing and dissociation</article-title>. <source>EMBO J</source> <volume>20</volume>: <fpage>2587</fpage>–<lpage>2595</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Schwartz1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwartz</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Quake</surname><given-names>SR</given-names></name> (<year>2009</year>) <article-title>Single molecule measurement of the “speed limit” of DNA polymerase</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>106</volume>: <fpage>20294</fpage>–<lpage>20299</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Moffitt1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moffitt</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Chemla</surname><given-names>YR</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name> (<year>2010</year>) <article-title>Methods in statistical kinetics</article-title>. <source>Methods Enzymol</source> <volume>475</volume>: <fpage>221</fpage>–<lpage>257</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Smith1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>TF</given-names></name>, <name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name> (<year>1981</year>) <article-title>Identification of common molecular subsequences</article-title>. <source>J Mol Biol</source> <volume>147</volume>: <fpage>195</fpage>–<lpage>197</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Cramr1"><label>9</label>
<mixed-citation publication-type="other" xlink:type="simple">Cramér H (1946) Methods of mathematical statistics. Princeton: Princeton University Press. 575 p.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Miura1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Miura</surname><given-names>K</given-names></name> (<year>2011</year>) <article-title>An Introduction to Maximum Likelihood Estimation and Information Geometry</article-title>. <source>Interdisciplinary Information Sciences</source> <volume>17</volume>: <fpage>155</fpage>–<lpage>174</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Koch1"><label>11</label>
<mixed-citation publication-type="other" xlink:type="simple">Koch C (1999) Biophysics of computation: information processing in single neurons. New York: Oxford University Press. 562 p.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Ibarra1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ibarra</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Chemla</surname><given-names>YR</given-names></name>, <name name-style="western"><surname>Plyasunov</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>SB</given-names></name>, <name name-style="western"><surname>Lazaro</surname><given-names>JM</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Proofreading dynamics of a processive DNA polymerase</article-title>. <source>EMBO J</source> <volume>28</volume>: <fpage>2794</fpage>–<lpage>2802</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Ahrens1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ahrens</surname><given-names>MB</given-names></name>, <name name-style="western"><surname>Orger</surname><given-names>MB</given-names></name>, <name name-style="western"><surname>Robson</surname><given-names>DN</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Keller</surname><given-names>PJ</given-names></name> (<year>2013</year>) <article-title>Whole-brain functional imaging at cellular resolution using light-sheet microscopy</article-title>. <source>Nat Meth</source> <volume>10</volume>: <fpage>413</fpage>–<lpage>420</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Kelman1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kelman</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>O'Donnell</surname><given-names>M</given-names></name> (<year>1995</year>) <article-title>DNA polymerase III holoenzyme: structure and function of a chromosomal replicating machine</article-title>. <source>Annu Rev Biochem</source> <volume>64</volume>: <fpage>171</fpage>–<lpage>200</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Thomen1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thomen</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Lopez</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Bockelmann</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Guillerez</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Dreyfus</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>T7 RNA polymerase studied by force measurements varying cofactor concentration</article-title>. <source>Biophys J</source> <volume>95</volume>: <fpage>2423</fpage>–<lpage>2433</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Skinner1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Skinner</surname><given-names>GM</given-names></name>, <name name-style="western"><surname>Baumann</surname><given-names>CG</given-names></name>, <name name-style="western"><surname>Quinn</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Molloy</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Hoggett</surname><given-names>JG</given-names></name> (<year>2004</year>) <article-title>Promoter binding, initiation, and elongation by bacteriophage T7 RNA polymerase. A single-molecule view of the transcription cycle</article-title>. <source>J Biol Chem</source> <volume>279</volume>: <fpage>3239</fpage>–<lpage>3244</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Gauthier1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gauthier</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Bechhoefer</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>Control of DNA replication by anomalous reaction-diffusion kinetics</article-title>. <source>Physical review letters</source> <volume>102</volume>: <fpage>158104</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Frank1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frank</surname><given-names>EG</given-names></name>, <name name-style="western"><surname>Woodgate</surname><given-names>R</given-names></name> (<year>2007</year>) <article-title>Increased catalytic activity and altered fidelity of human DNA polymerase iota in the presence of manganese</article-title>. <source>J Biol Chem</source> <volume>282</volume>: <fpage>24689</fpage>–<lpage>24696</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-SanchezVives1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sanchez-Vives</surname><given-names>MV</given-names></name>, <name name-style="western"><surname>McCormick</surname><given-names>DA</given-names></name> (<year>2000</year>) <article-title>Cellular and network mechanisms of rhythmic recurrent activity in neocortex</article-title>. <source>Nat Neurosci</source> <volume>3</volume>: <fpage>1027</fpage>–<lpage>1034</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Ward1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ward</surname><given-names>LM</given-names></name> (<year>2003</year>) <article-title>Synchronous neural oscillations and cognitive processes</article-title>. <source>Trends Cogn Sci</source> <volume>7</volume>: <fpage>553</fpage>–<lpage>559</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Engel1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Engel</surname><given-names>AK</given-names></name>, <name name-style="western"><surname>Konig</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Kreiter</surname><given-names>AK</given-names></name>, <name name-style="western"><surname>Schillen</surname><given-names>TB</given-names></name>, <name name-style="western"><surname>Singer</surname><given-names>W</given-names></name> (<year>1992</year>) <article-title>Temporal coding in the visual cortex: new vistas on integration in the nervous system</article-title>. <source>Trends Neurosci</source> <volume>15</volume>: <fpage>218</fpage>–<lpage>226</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Sokoloff1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sokoloff</surname><given-names>L</given-names></name> (<year>1981</year>) <article-title>Localization of functional activity in the central nervous system by measurement of glucose utilization with radioactive deoxyglucose</article-title>. <source>J Cereb Blood Flow Metab</source> <volume>1</volume>: <fpage>7</fpage>–<lpage>36</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Friedman1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname><given-names>HR</given-names></name>, <name name-style="western"><surname>Bruce</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>Goldmanrakic</surname><given-names>PS</given-names></name> (<year>1989</year>) <article-title>Resolution of Metabolic Columns by a Double-Label 2-Dg Technique - Interdigitation and Coincidence in Visual Cortical Areas of the Same Monkey</article-title>. <source>Journal of Neuroscience</source> <volume>9</volume>: <fpage>4111</fpage>–<lpage>4121</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Langhorst1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Langhorst</surname><given-names>BW</given-names></name>, <name name-style="western"><surname>Jack</surname><given-names>WE</given-names></name>, <name name-style="western"><surname>Reha-Krantz</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Nichols</surname><given-names>NM</given-names></name> (<year>2012</year>) <article-title>Polbase: a repository of biochemical, genetic and structural information about DNA polymerases</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>D381</fpage>–<lpage>D387</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Davenport1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Davenport</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Wuite</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Landick</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name> (<year>2000</year>) <article-title>Single-molecule study of transcriptional pausing and arrest by E. coli RNA polymerase</article-title>. <source>Science</source> <volume>287</volume>: <fpage>2497</fpage>–<lpage>2500</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Mejia1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mejia</surname><given-names>YX</given-names></name>, <name name-style="western"><surname>Mao</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Forde</surname><given-names>NR</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name> (<year>2008</year>) <article-title>Thermal probing of E. coli RNA polymerase off-pathway mechanisms</article-title>. <source>J Mol Biol</source> <volume>382</volume>: <fpage>628</fpage>–<lpage>637</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Hodges1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hodges</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Bintu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Lubkowska</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Kashlev</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name> (<year>2009</year>) <article-title>Nucleosomal fluctuations govern the transcription dynamics of RNA polymerase II</article-title>. <source>Science</source> <volume>325</volume>: <fpage>626</fpage>–<lpage>628</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Zamft2"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zamft</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Bintu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ishibashi</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>Nascent RNA structure modulates the transcriptional dynamics of RNA polymerases</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>109</volume>: <fpage>8948</fpage>–<lpage>8953</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Vogelstein1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vogelstein</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Packer</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Machado</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Sippy</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Babadi</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Fast nonnegative deconvolution for spike train inference from population calcium imaging</article-title>. <source>J Neurophysiol</source> <volume>104</volume>: <fpage>3691</fpage>–<lpage>3704</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Vogelstein2"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vogelstein</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Watson</surname><given-names>BO</given-names></name>, <name name-style="western"><surname>Packer</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Yuste</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Jedynak</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Spike Inference from Calcium Imaging Using Sequential Monte Carlo Methods</article-title>. <source>Biophys J</source> <volume>97</volume>: <fpage>636</fpage>–<lpage>655</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Mishchenko1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mishchenko</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Vogelstein</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name> (<year>2011</year>) <article-title>A Bayesian Approach for Inferring Neuronal Connectivity from Calcium Fluorescent Imaging Data</article-title>. <source>Annals of Applied Statistics</source> <volume>5</volume>: <fpage>1229</fpage>–<lpage>1261</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Yuste1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yuste</surname><given-names>R</given-names></name>, <name name-style="western"><surname>MacLean</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Vogelstein</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name> (<year>2011</year>) <article-title>Imaging action potentials with calcium indicators</article-title>. <source>Cold Spring Harb Protoc</source> <volume>2011</volume>: <fpage>985</fpage>–<lpage>989</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Chun1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chun</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Church</surname><given-names>GM</given-names></name>, <name name-style="western"><surname>Greenspan</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Roukes</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Yuste</surname><given-names>R</given-names></name> (<year>2012</year>) <article-title>The Brain Activity Map Project and the Challenge of Functional Connectomics</article-title>. <source>Neuron</source> <volume>74</volume>: <fpage>970</fpage>–<lpage>974</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Hays1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hays</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Berdis</surname><given-names>AJ</given-names></name> (<year>2002</year>) <article-title>Manganese substantially alters the dynamics of translesion DNA synthesis</article-title>. <source>Biochemistry</source> <volume>41</volume>: <fpage>4771</fpage>–<lpage>4778</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Dempster1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dempster</surname><given-names>AP</given-names></name>, <name name-style="western"><surname>Laird</surname><given-names>NM</given-names></name>, <name name-style="western"><surname>Rubin</surname><given-names>DB</given-names></name> (<year>1977</year>) <article-title>Maximum Likelihood from Incomplete Data via the EM Algorithm</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source> <volume>39</volume>: <fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-CornishBowden1"><label>36</label>
<mixed-citation publication-type="other" xlink:type="simple">Cornish-Bowden A (1979) Fundamentals of enzyme kinetics. London; Boston: Butterworths. xiii, 230 p. p.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Sharma1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sharma</surname><given-names>AK</given-names></name>, <name name-style="western"><surname>Chowdhury</surname><given-names>D</given-names></name> (<year>2012</year>) <article-title>Error correction during DNA replication</article-title>. <source>Physical Review E</source> <volume>86</volume>: <fpage>011913</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Shaevitz1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shaevitz</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Block</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Schnitzer</surname><given-names>MJ</given-names></name> (<year>2005</year>) <article-title>Statistical kinetics of macromolecular dynamics</article-title>. <source>Biophys J</source> <volume>89</volume>: <fpage>2277</fpage>–<lpage>2285</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Chemla1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chemla</surname><given-names>YR</given-names></name>, <name name-style="western"><surname>Moffitt</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name> (<year>2008</year>) <article-title>Exact solutions for kinetic models of macromolecular dynamics</article-title>. <source>J Phys Chem B</source> <volume>112</volume>: <fpage>6025</fpage>–<lpage>6044</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Kolomeisky1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kolomeisky</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>Fisher</surname><given-names>ME</given-names></name> (<year>2007</year>) <article-title>Molecular Motors: A Theorist's Perspective</article-title>. <source>Annual Review of Physical Chemistry</source> <volume>58</volume>: <fpage>675</fpage>–<lpage>695</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Bell1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bell</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Sejnowski</surname><given-names>TJ</given-names></name> (<year>1995</year>) <article-title>An information-maximization approach to blind separation and blind deconvolution</article-title>. <source>Neural Comput</source> <volume>7</volume>: <fpage>1129</fpage>–<lpage>1159</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Kirkeby1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kirkeby</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>PA</given-names></name>, <name name-style="western"><surname>Hamada</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Orduna-Bustamante</surname><given-names>F</given-names></name> (<year>1998</year>) <article-title>Fast deconvolution of multichannel systems using regularization (Reprinted from IEICE Transactions on Fundamentals of Electronics, Communications, and Computer Sciences, vol E80-A, pg 809–820, 1997)</article-title>. <source>Ieee Transactions on Speech and Audio Processing</source> <volume>6</volume>: <fpage>189</fpage>–<lpage>194</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Yu1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Afshar</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Santhanam</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Ryu</surname><given-names>SI</given-names></name>, <name name-style="western"><surname>Shenoy</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Extracting dynamical structure embedded in neural activity</article-title>. <source>Advances in Neural Information Processing Systems</source> <volume>18</volume>: <fpage>1545</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Macke1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Macke</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Buesing</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Cunningham</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>BM</given-names></name>, <name name-style="western"><surname>Shenoy</surname><given-names>KV</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Empirical models of spiking in neural populations</article-title>. <source>Advances in Neural Information Processing Systems</source> <volume>24</volume>: <fpage>13501358</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Sahani1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sahani</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Linden</surname><given-names>JF</given-names></name> (<year>2003</year>) <article-title>Evidence Optimization Techniques for Estimating Stimulus-Response Functions</article-title>. <source>Advances in Neural Information Processing Systems</source> <fpage>301</fpage>–<lpage>308</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Moffitt2"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moffitt</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Chemla</surname><given-names>YR</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name> (<year>2010</year>) <article-title>Mechanistic constraints from the substrate concentration dependence of enzymatic fluctuations</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>107</volume>: <fpage>15739</fpage>–<lpage>15744</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Moffitt3"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moffitt</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Chemla</surname><given-names>YR</given-names></name>, <name name-style="western"><surname>Aathavan</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Grimes</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Jardine</surname><given-names>PJ</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Intersubunit coordination in a homomeric ring ATPase</article-title>. <source>Nature</source> <volume>457</volume>: <fpage>446</fpage>–<lpage>450</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Wang1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Wagner</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Borton</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ozden</surname><given-names>I</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Integrated device for combined optical neuromodulation and electrical recording for chronic in vivo applications</article-title>. <source>J Neural Eng</source> <volume>9</volume>: <fpage>016001</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Buzsaki1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buzsaki</surname><given-names>G</given-names></name> (<year>2004</year>) <article-title>Large-scale recording of neuronal ensembles</article-title>. <source>Nat Neurosci</source> <volume>7</volume>: <fpage>446</fpage>–<lpage>451</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Carr1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carr</surname><given-names>PA</given-names></name>, <name name-style="western"><surname>Church</surname><given-names>GM</given-names></name> (<year>2009</year>) <article-title>Genome engineering</article-title>. <source>Nat Biotechnol</source> <volume>27</volume>: <fpage>1151</fpage>–<lpage>1162</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Morin1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morin</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Cao</surname><given-names>FJ</given-names></name>, <name name-style="western"><surname>Lazaro</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Arias-GonzaIez</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Valpuesta</surname><given-names>JM</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Active DNA unwinding dynamics during processive DNA replication</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>109</volume>: <fpage>8115</fpage>–<lpage>8120</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Hogg1"><label>52</label>
<mixed-citation publication-type="other" xlink:type="simple">Hogg RV, McKean JW, Craig AT (2005) Introduction to mathematical statistics. Upper Saddle River, N.J.: Pearson Education. xiii, 704 p. p.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Schmidt1"><label>53</label>
<mixed-citation publication-type="other" xlink:type="simple">Schmidt M (2008) minConf. Available: <ext-link ext-link-type="uri" xlink:href="http://www.di.ens.fr/~mschmidt/Software/minFunc.html" xlink:type="simple">http://www.di.ens.fr/~mschmidt/Software/minFunc.html</ext-link>. Accessed August 2012.</mixed-citation>
</ref>
<ref id="pcbi.1003145-Nelder1"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nelder</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Mead</surname><given-names>R</given-names></name> (<year>1965</year>) <article-title>A Simplex-Method for Function Minimization</article-title>. <source>Computer Journal</source> <volume>7</volume>: <fpage>308</fpage>–<lpage>313</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>