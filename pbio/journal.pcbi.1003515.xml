<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01868</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003515</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis tools</subject><subj-group><subject>Sequence assembly tools</subject></subj-group></subj-group><subj-group><subject>Genome sequencing</subject><subject>Structural genomics</subject></subj-group></subj-group><subj-group><subject>Population genetics</subject><subj-group><subject>Haplotypes</subject></subj-group></subj-group></subj-group><subj-group><subject>Microbiology</subject><subj-group><subject>Virology</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Viral Quasispecies Assembly via Maximal Clique Enumeration</article-title>
<alt-title alt-title-type="running-head">Viral Quasispecies Assembly</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Töpfer</surname><given-names>Armin</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Marschall</surname><given-names>Tobias</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Bull</surname><given-names>Rowena A.</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Luciani</surname><given-names>Fabio</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Schönhuth</surname><given-names>Alexander</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Beerenwinkel</surname><given-names>Niko</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Biosystems Science and Engineering, ETH Zurich, Basel, Switzerland</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>SIB Swiss Institute of Bioinformatics, Basel, Switzerland</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Centrum Wiskunde &amp; Informatica, Amsterdam, The Netherlands</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Inflammation and Infection Research Centre, School of Medical Sciences, UNSW, Sydney, Australia</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Carolyn  McHardy</surname><given-names>Alice</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Heinrich Heine University, Germany</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">niko.beerenwinkel@bsse.ethz.ch</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: RAB FL AS NB. Performed the experiments: RAB FL. Analyzed the data: AT TM. Contributed reagents/materials/analysis tools: RAB FL. Wrote the paper: AT TM RAB FL AS NB. Developed the model: AT TM AS NB. Implemented the software: AT TM. Performed simulation studies: AT.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>3</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>27</day><month>3</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>3</issue>
<elocation-id>e1003515</elocation-id>
<history>
<date date-type="received"><day>28</day><month>10</month><year>2013</year></date>
<date date-type="accepted"><day>31</day><month>1</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Töpfer et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="RA1" related-article-type="companion" ext-link-type="uri" page="e1003502" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1003502"> <article-title>HapTree: A Novel Bayesian Framework for Single Individual Polyplotyping Using NGS Data</article-title></related-article><related-article id="RA2" related-article-type="companion" ext-link-type="uri" page="e1003500" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1003500"> <article-title>MRFalign: Protein Homology Detection through Alignment of Markov Random Fields</article-title></related-article><related-article id="RA3" related-article-type="companion" ext-link-type="uri" page="e1003501" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1003501"> <article-title>An Integrated Model of Multiple-Condition ChIP-seq Data Reveals Predeterminants of Cdx2 Binding</article-title></related-article><related-article id="RA4" related-article-type="companion" ext-link-type="uri" page="e1003503" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1003503"> <article-title>Modeling Mutual Exclusivity of Cancer Mutations</article-title></related-article>
<abstract>
<p>Virus populations can display high genetic diversity within individual hosts. The intra-host collection of viral haplotypes, called viral quasispecies, is an important determinant of virulence, pathogenesis, and treatment outcome. We present HaploClique, a computational approach to reconstruct the structure of a viral quasispecies from next-generation sequencing data as obtained from bulk sequencing of mixed virus samples. We develop a statistical model for paired-end reads accounting for mutations, insertions, and deletions. Using an iterative maximal clique enumeration approach, read pairs are assembled into haplotypes of increasing length, eventually enabling global haplotype assembly. The performance of our quasispecies assembly method is assessed on simulated data for varying population characteristics and sequencing technology parameters. Owing to its paired-end handling, HaploClique compares favorably to state-of-the-art haplotype inference methods. It can reconstruct error-free full-length haplotypes from low coverage samples and detect large insertions and deletions at low frequencies. We applied HaploClique to sequencing data derived from a clinical hepatitis C virus population of an infected patient and discovered a novel deletion of length 357±167 bp that was validated by two independent long-read sequencing experiments. HaploClique is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/armintoepfer/haploclique" xlink:type="simple">https://github.com/armintoepfer/haploclique</ext-link>. A summary of this paper appears in the proceedings of the RECOMB 2014 conference, April 2-5.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Humans infected with a virus, such as the human immunodeficiency virus (HIV-1) or hepatitis C virus (HCV), host a population of billions of virus particles. Among these, there is an unknown number of genetically different strains, some of which can harbor drug resistance and immune escape mutations. It is of clinical importance to know the DNA sequences and abundances of these variants, as they can affect treatment outcome. Here, we present HaploClique, a computational approach to reconstruct these sequences and to predict large insertions and deletions from paired-end next-generation sequencing data. Using simulations, we demonstrate that HaploClique can reconstruct full-length HIV-1 variants from low-coverage samples. Using real-world clinical data, we predict a novel deletion of 357±167 bp in a HCV patient sample that has been validated by two independent long-read sequencing experiments.</p>
</abstract>
<funding-group><funding-statement>AS was funded by Vidi grant No. 639.072.039 of the Netherlands Organization for Scientific Research (NWO). This work has been supported by the Swiss National Science Foundation under grants No. CR32I2_127017 and 146331. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="10"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This article is associated with RECOMB 2014.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>Genetic diversity is an important characteristic of evolving populations and it affects the chances of survival in changing environments. Assessing the genetic diversity of a population experimentally is generally labor-intensive and difficult. Populations of individual cells or viruses, however, can be analyzed efficiently using next-generation sequencing (NGS). Although single-cell approaches are still immature, direct NGS of mixed samples at deep coverage allows for probing populations in great detail. The challenges with this bulk sequencing approach are (i) to separate sequencing errors from genetic variation, (ii) to assemble the short NGS reads into an unknown number of different, unknown, longer haplotype sequences, and (iii) to estimate their frequency distribution.</p>
<p>Viruses such as human immunodeficiency virus (HIV-1) and hepatitis C virus (HCV) populate their hosts as swarms of related but genetically different mutant strains, each defined by its haplotype sequence. The structure of such a mutant cloud, which is often referred to as a viral quasispecies <xref ref-type="bibr" rid="pcbi.1003515-Domingo1">[1]</xref>, is of clinical importance, because it has been shown to affect virulence <xref ref-type="bibr" rid="pcbi.1003515-Tpfer1">[2]</xref> and pathogenesis <xref ref-type="bibr" rid="pcbi.1003515-Vignuzzi1">[3]</xref>. In addition, low-frequency genetic variants may harbor resistance mutations that are capable of evolutionary escape from the selective pressure of host immune responses <xref ref-type="bibr" rid="pcbi.1003515-Henn1">[4]</xref> and of medical interventions, such as anti-viral drug treatment <xref ref-type="bibr" rid="pcbi.1003515-Beerenwinkel1">[5]</xref>. NGS is currently introduced into clinical diagnostics, but the <italic>de facto</italic> standard procedure for assessing the quasispecies structure is simply based on single-nucleotide variant (SNV) calling. This approach allows only for estimating the per-site allele frequency spectrum of the virus population and it ignores patterns of co-occurrence among mutations. This limitation is critical, because epistatic interactions are abundant in RNA viruses <xref ref-type="bibr" rid="pcbi.1003515-Hinkley1">[6]</xref>. Hence, one cannot predict viral phenotypes without knowing the underlying mix of haplotypes. Here, we address this challenge and present a computational approach for the viral quasispecies assembly problem.</p>
<p>The viral haplotype reconstruction problem is related to the human haplotype reconstruction problem, but it differs in several key aspects and faces different challenges. First, the number of unique haplotypes in a viral quasispecies is unknown unlike in the case of human diploid genomes. Second, viral populations typically exhibit more than two variants at each polymorphic locus and often all four different nucleotides. Hence, viral haplotypes cannot be described by binary sequences. Third, in a viral quasispecies, low-frequency variants are abundant and of clinical importance, yet they are difficult to distinguish from technical sequencing errors. Finally, RNA virus genomes are orders of magnitude shorter than the human genome, but exhibit more diversity within one host than the ∼0.1% diversity between the two parental human haplotypes <xref ref-type="bibr" rid="pcbi.1003515-Jorde1">[7]</xref>.</p>
<p>Several methods for viral haplotype reconstruction have been developed in recent years, specialized for different NGS technologies, experimental designs, and quasispecies structures. In general, reconstruction can be performed either locally, in a genomic region that can be covered by the average read length, or globally, over longer regions such that overlapping reads are necessary for assembly. Local reconstruction means estimating the number of locally unique haplotype sequences and, at the same time, correcting sequencing errors. Probabilistic clustering <xref ref-type="bibr" rid="pcbi.1003515-Eriksson1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1003515-Zagordi1">[11]</xref> and k-mer statistics <xref ref-type="bibr" rid="pcbi.1003515-Skums1">[12]</xref> have been proposed for this task. Global reconstruction is more challenging, as it requires computational solutions for assembling NGS reads, which has proven itself to be demanding even in settings without poly-ploidy <xref ref-type="bibr" rid="pcbi.1003515-Salzberg1">[13]</xref>.</p>
<p>For quasispecies assembly, approaches from different domains have been developed: (i) probabilistic mixture models <xref ref-type="bibr" rid="pcbi.1003515-Prabhakaran1">[14]</xref>, (ii) hidden Markov models <xref ref-type="bibr" rid="pcbi.1003515-Tpfer2">[15]</xref>, (iii) sampling schemes <xref ref-type="bibr" rid="pcbi.1003515-Prosperi1">[16]</xref>, (iv) combinatorial approaches based on analyzing the read overlap graph <xref ref-type="bibr" rid="pcbi.1003515-Eriksson1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003515-Astrovskaya1">[17]</xref>–<xref ref-type="bibr" rid="pcbi.1003515-ONeil1">[19]</xref>, (v) coloring of overlap and conflict graphs by constraint programming <xref ref-type="bibr" rid="pcbi.1003515-Huang1">[20]</xref>, and (vi) exploiting the “identical by descent” information <xref ref-type="bibr" rid="pcbi.1003515-Aguiar1">[21]</xref> in the HapCompass framework <xref ref-type="bibr" rid="pcbi.1003515-Aguiar2">[22]</xref>, originally designed for diploid single nucleotide polymorphism data.</p>
<p>The performance of global haplotype reconstruction depends on several factors, including the true underlying diversity of the population, the distribution of amplification and sequencing errors, the read length, and the distribution of the read coverage along the genome <xref ref-type="bibr" rid="pcbi.1003515-Schirmer1">[23]</xref>–<xref ref-type="bibr" rid="pcbi.1003515-Prosperi2">[25]</xref>. A major shortcoming of all existing methods is that they are unable to handle large insertions or deletions (indels). For example, large deletions can result from erroneous replication or, as observed recently in HIV-1, they may occur as alternative splice variants <xref ref-type="bibr" rid="pcbi.1003515-Ocwieja1">[26]</xref>. In the context of analyzing structural variation in the human genome, such as indels of varying sizes, the use of paired-end reads has been instrumental. For viral haplotype reconstruction, however, approaches that systematically exploit paired-end information are lacking.</p>
<p>In this paper, we present a new quasipecies assembly method for paired-end reads, called HaploClique, based on enumeration of maximal cliques (max-cliques) as a general approach to clustering NGS paired-end reads. Although, in general, the runtime of enumerating all max-cliques in a graph is exponential, it has recently been shown that the graphs induced by overlapping NGS reads can be handled efficiently <xref ref-type="bibr" rid="pcbi.1003515-Marschall1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1003515-Marschall2">[28]</xref>. Here, we exploit this fact for the quasispecies assembly problem and develop a probabilistic model of sequence and structural similarity between reads.</p>
<p>Using max-clique enumeration for reference-based read assembly is orthogonal to combinatorial approaches for <italic>de novo</italic> assembly that rely on path finding in de Bruijn or similar graphs <xref ref-type="bibr" rid="pcbi.1003515-Gnerre1">[29]</xref>–<xref ref-type="bibr" rid="pcbi.1003515-Zerbino1">[31]</xref>. Instead of computing paths, we iteratively transform max-cliques into super-reads and then seek max-cliques of super-reads, thereby obtaining haplotype segments of increasing length. The haplotype segments can eventually be extended to global haplotypes if the degree of heterogeneity of the viral quasispecies is high enough. HaploClique is related to max-cut-driven approaches in human haplotype reconstruction <xref ref-type="bibr" rid="pcbi.1003515-Bansal1">[32]</xref>, but the computational complexity of those approaches is prohibitive for virus populations of high and unknown ploidy. While HaploCliques enumerates all max-cliques, a max-cut approach seeks an optimal cut of the overlap graph.</p>
<p>HaploClique explicitly incorporates paired-end information for assembling viral haplotypes. We define the insert as the unsequenced fragment between the two ends of a paired-end read. We use linkage information among variant alleles in the distant pairs to identify reads that stem from the same haplotypes and generate error-corrected paired-end super-reads. Paired-end reads allow to bridge homogeneous, and hence ambiguous, genomic regions if the insert size is sufficiently large. They also increase the statistical power to distinguish local haplotypes from sequencing errors in homogeneous regions if the paired read is located in a more heterogeneous region. Employing our iterative clique enumeration procedure, we show that error-free full-length HIV-1 viral haplotypes can be reconstructed in a heterogeneous mix of five viral strains <italic>in silico</italic> from a data set with mean coverage of 600×. Furthermore, we demonstrate that, unlike existing methods, HaploClique can detect large indels in mixed virus populations <italic>in silico</italic> and <italic>in vivo</italic>. Finally, we apply HaploClique to a HCV Illumina paired-end NGS data set and predict a novel deletion of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e001" xlink:type="simple"/></inline-formula> bp that has been confirmed independently by two long-read NGS platforms.</p>
</sec><sec id="s3">
<title>Results</title>
<p>We developed and implemented HaploClique, a computational viral quasispecies assembly method for paired-end NGS data. HaploClique defines a read alignment graph, in which each node corresponds to a single-end or paired-end alignment (<xref ref-type="fig" rid="pcbi-1003515-g001">Figure 1A</xref>). We draw edges between two nodes if the two corresponding alignments have sufficient overlap and are likely to stem from the same haplotype (<xref ref-type="fig" rid="pcbi-1003515-g001">Figure 1B</xref>). Each max-clique in this graph consists of a large number of reads from the presumed same haplotype segment. Thus, the consensus sequence of all reads in a max-clique is a prediction of a local haplotype sequence. We refer to such a consensus sequence as a super-read. This consensus sequence also serves to correct errors in the reads that participate in the super-read by replacing the sequence of the original reads with the consensus. This form of error correction benefits from phasing sequential variants through super-read construction. Paired-end reads are particularly helpful, as they allow to also phase distantly co-occurring variant alleles.</p>
<fig id="pcbi-1003515-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003515.g001</object-id><label>Figure 1</label><caption>
<title>Max-clique enumeration and edge definitions.</title>
<p>(A) Example of a read alignment graph based on the insert size criterion. Alignments of read pairs are shown in gray and the corresponding nodes in the graph representation are depicted in blue. The four bottom-most alignment pairs stem from a haplotype harboring a deletion (shown in orange in the reference genome) and therefore display a larger insert size than the remaining alignment pairs. Note that the four deletion-indicating alignment pairs form a max-clique (circled in orange). (B) Illustration of the compatible gaps condition of the sequence similarity criterion. Two reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e002" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e003" xlink:type="simple"/></inline-formula> are aligned against the reference (left). This induces a direct read-to-read alignment of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e004" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e005" xlink:type="simple"/></inline-formula> (right). Case (1): No gaps in the reference alignments lead to a gapless read-to-read alignment, which renders the pair of reads an edge candidate. Case (2): Gaps in the reference alignment lead to gaps in the read-to-read alignment, excluding the possibility of an edge. See also <xref ref-type="supplementary-material" rid="pcbi.1003515.s006">Figure S6</xref> in the appendix for more complicated cases involving gaps.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003515.g001" position="float" xlink:type="simple"/></fig>
<p>HaploClique proceeds by iterating (i) (super-)read alignment graph construction, (ii) max-clique enumeration, and (iii) super-read construction, until convergence. The lengths of the super-reads increase while iterating and convergence is established when super-reads have reached their maximum length. If the mixed sample is sufficiently heterogeneous, super-reads will eventually represent haplotypes of full length. Because we process paired-end reads and incorporate insert-size compatibility into our edge definition, we can also identify max-cliques that indicate larger insertions and deletions. These structural variations are recognized by too small or too large insert sizes among the alignments of the reads that participate in a max-clique. We analyzed HaploClique's performance on simulated data and demonstrate its use on <italic>in vivo</italic> HCV quasispecies sequencing data.</p>
<sec id="s3a">
<title>Simulation studies</title>
<p>HaploClique integrates paired-end and base quality information for improved sequencing error correction and haplotype frequency estimation, which we assess first. Second, we evaluate HaploClique's behaviour when confronted with low heterogeneity among the different haplotype strains. Third, we demonstrate HaploClique's ability to detect large insertions and deletions in the quasispecies by making use of paired-end information. Fourth, we evaluate the quality of the local and global haplotypes that HaploClique predicts. Lastly, we compare HaploClique to state-of-the-art tools ShoRAH <xref ref-type="bibr" rid="pcbi.1003515-Zagordi3">[33]</xref>, PredictHaplo <xref ref-type="bibr" rid="pcbi.1003515-Prabhakaran1">[14]</xref>, and QuRe <xref ref-type="bibr" rid="pcbi.1003515-Prosperi1">[16]</xref> in quasispecies reconstruction of a simulated five virus mix of well-known HIV-1 lab-strains.</p>
<p>In all of the following experiments, we simulated Illumina 2×250 bp paired-end reads using SimSeq <xref ref-type="bibr" rid="pcbi.1003515-Earl1">[34]</xref> with fragment size 600 bp. To make the simulated data as realistic as possible, we estimated the required error profiles from an in-house MiSeq data set of a mixture of known HIV-1 strains. The average error-rate was 0.33% per base.</p>
<sec id="s3a1">
<title>Error correction and frequency estimation</title>
<p>We assessed HaploClique's performance in error correction and frequency estimation, and their dependency on coverage and relative haplotype abundance. We generated ten HIV-1 strains by substituting ten percent of the nucleotides of strain <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e006" xlink:type="simple"/></inline-formula>. Positions to be substituted were sampled uniformly, separately for each of the ten strains. We sampled reads from these ten strains at coverage rates that resulted in abundance levels of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e007" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e008" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e009" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e010" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e011" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e012" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e013" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e014" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e015" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e016" xlink:type="simple"/></inline-formula>.</p>
<p>We measured the accuracy of estimating relative haplotype frequencies for different true abundances and coverages (<xref ref-type="fig" rid="pcbi-1003515-g002">Figure 2A</xref>). For each coverage, we repeated the simulation ten times and depict the mean deviances. For example, a mean deviance of +1% for a strain of frequency 4.8% translates to an estimate of 5.8%. The estimated frequencies approach the true ones for increasing coverage, as indicated by approaching the dashed line of 0% deviance. HaploClique tended to underestimate frequencies above and slightly overestimated frequencies below a true frequency of ten percent. For 1600× coverage, the absolute deviation was always below one percent. We additionally measures the frequency estimation robustness by computing the standard deviation for each true frequency and coverage (<xref ref-type="supplementary-material" rid="pcbi.1003515.s001">Figure S1</xref>). We observed increased robustness with increasing coverage, except for the cases where the super-reads do not fully cover the genome.</p>
<fig id="pcbi-1003515-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003515.g002</object-id><label>Figure 2</label><caption>
<title>Performance in (A) frequency estimation and (B) distinguishing reconstructed local haplotypes.</title>
<p>(A) Ten haplotypes were sampled with different frequencies (x-axis, logarithmic scale), and the mean deviations of the estimated to the true frequencies are reported for ten repetitions of the simulation (y-axis). The different symbols represent data sets with coverages 400×, 800×, and 1600×. Color indicates whether the genome was fully covered by predicted haplotypes (blue) or not (orange). (B) Performance in distinguishing reconstructed local haplotypes, depending on pairwise distance and coverage. The displayed percentages are the fractions of super-reads that do not match any true haplotype without error. Color-coded is the fraction of super-reads that match exactly one true haplotype (100%, orange; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e017" xlink:type="simple"/></inline-formula>, blue; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e018" xlink:type="simple"/></inline-formula>, violet).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003515.g002" position="float" xlink:type="simple"/></fig>
<p>We assessed HaploClique's paired-end error correction capabilities using the same simulated data set. All super-reads, regardless of frequency, perfectly agreed with the respective true haplotype sequences. For frequency-coverage combinations of (3.6%, 400×), (2.4%, 800×), (1.2%, 1600×) and higher, the genomes were fully covered by super-reads (<xref ref-type="fig" rid="pcbi-1003515-g002">Figure 2A</xref>). For lower frequencies, reconstructed local haplotypes do not fully cover the genome in all ten data sets.</p>
</sec><sec id="s3a2">
<title>Minimal variant heterogeneity</title>
<p>To investigate the minimal heterogeneity necessary to distinguish between different haplotypes, we simulated datasets of two different haplotypes, varying coverage rates between 25 and 800× and pairwise distance from 0.05% to 10%.</p>
<p>We measured the false positive rates, percentages of reconstructed haplotypes with at least one false nucleotide, and percentages of perfectly reconstructed haplotypes that map uniquely to exactly one true variant (<xref ref-type="fig" rid="pcbi-1003515-g002">Figure 2B</xref>). For distances of 1% and above, reconstruction was perfect at all coverage rates. For distances of 0.75% and below, the vast majority of the reconstructed haplotypes still perfectly match a true haplotype. In general, the false positive rate decreases with higher coverage. However, with decreased distance between true haplotypes, many regions are conserved and cannot be assigned uniquely to a single true haplotype.</p>
</sec><sec id="s3a3">
<title>Large deletion prediction</title>
<p>The edge definition of HaploClique's read alignment graph allows for identifying large indels in the haplotypes (<xref ref-type="sec" rid="s5">Methods</xref>). Thanks to the insert size criterion, one can predict indels from paired-end read information despite the lack of alignments of read ends that directly cover the deletion breakpoint. Such alignments may be lacking in practice, because even the most advanced read mappers have difficulties aligning reads across long indels.</p>
<p>In this simulation, we benchmarked the false negative rate of the predicted deletions and the deviations of the estimated to the true deletion lengths (<xref ref-type="fig" rid="pcbi-1003515-g003">Figure 3</xref>). Aiming at a simple, yet instructive benchmark data set, we created a new haplotype by randomly placing three deletions of sizes 100, 500, and 1000 bp into the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e019" xlink:type="simple"/></inline-formula> genome. We simulated reads from the reference haplotype with a mean coverage of 100× and from the deletion-harboring haplotype with coverages of 5, 12, 24, 48, 96, and 144×. We sampled 100 data sets for each coverage to account for variability in the sampling process. Comparing coverages of 5 and 144×, we observed a more reliable size estimate with increasing coverage, as the standard deviation decreased by a factor of up to two. Independent of the true deletion size, the estimated median size approached the true size up to 6 bp. For the true deletion sizes of 100, 500, and 1000 bp the number of false negatives decreased to zero for a coverage of 24, 12, and 12×, respectively. The median size deviation to the true deletion size was always below the standard deviation of the insert fragment size if there was sufficient coverage, i.e., no false negatives.</p>
<fig id="pcbi-1003515-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003515.g003</object-id><label>Figure 3</label><caption>
<title>Large deletion estimates.</title>
<p>Estimated deletion size deviation and false negative rate for different true deletion sizes of (A) 100, (B) 500, and (C) 1000 bp. For each deletion length and each coverage of 5, 12, 24, 48, 96, and 144×, a boxplot summarizes the deviations of the estimated to the true deletion size in 100 simulated samples. The blue line represents the number of false negative predicted deletions in each of the 100 samples.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003515.g003" position="float" xlink:type="simple"/></fig></sec><sec id="s3a4">
<title>Global haplotype assembly</title>
<p>We benchmarked HaploClique's performance in terms of genome coverage, as well as numbers and lengths of constructed super-reads. We simulated a heterogeneous population, henceforth referred to as <italic>lab-mix</italic>, of five lab strains, namely <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e020" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e021" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e022" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e023" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e024" xlink:type="simple"/></inline-formula>. Among these strains, pairwise distances vary per gene and along the entire genome between 1 and 16% and between 2 and 6%, respectively. We sampled reads uniformly with a mean coverage of 600×, i.e., 120× per strain. This low coverage corresponds to very low-frequency variants in datasets of higher coverage (commonly 10,000 to 100,000×), which are of interest in diagnostic applications.</p>
<p>HaploClique was able to reconstruct haplotype <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e025" xlink:type="simple"/></inline-formula> at its full length, without a single error (<xref ref-type="table" rid="pcbi-1003515-t001">Table 1</xref>). The haplotypes of the other four variants grew up to a maximal size of 5-6 kb for the longest super-reads, where full length of the five true strains varied between 9 and 10 kb. For all strains, the reconstructed haplotypes covered the genome at its full length. The false positive rate (the rate of not perfectly matching super-reads) was 0.3%. The maximal read length increased monotonically for each iteration from 250 bp up to full-length of ∼10 kb (<xref ref-type="fig" rid="pcbi-1003515-g004">Figure 4</xref>). During the first two iterations, the number of super-reads increased, but from the third iteration decreased, converging to a number of 56 super-reads (<xref ref-type="fig" rid="pcbi-1003515-g004">Figure 4</xref>).</p>
<fig id="pcbi-1003515-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003515.g004</object-id><label>Figure 4</label><caption>
<title>Global haplotype assembly results.</title>
<p>Minimum, maximum, and mean read lengths (A) and the total number of reads (B) for the global haplotype assembly of the lab-mix, for the first 13 and the last iteration (30).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003515.g004" position="float" xlink:type="simple"/></fig><table-wrap id="pcbi-1003515-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003515.t001</object-id><label>Table 1</label><caption>
<title>Global haplotype assembly comparison.</title>
</caption><alternatives><graphic id="pcbi-1003515-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003515.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td colspan="5" align="left" rowspan="1">Estimated HIV-1 strain frequency (max. rel. haplotype length)</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Method</td>
<td align="left" rowspan="1" colspan="1">HXB2</td>
<td align="left" rowspan="1" colspan="1">NL4-3</td>
<td align="left" rowspan="1" colspan="1">YU2</td>
<td align="left" rowspan="1" colspan="1">89.6</td>
<td align="left" rowspan="1" colspan="1">JR-CSF</td>
<td align="left" rowspan="1" colspan="1">Error rate</td>
<td align="left" rowspan="1" colspan="1"># haplotypes</td>
<td align="left" rowspan="1" colspan="1">Precision</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">HaploClique</td>
<td align="left" rowspan="1" colspan="1">22% (100%)</td>
<td align="left" rowspan="1" colspan="1">21% (61%)</td>
<td align="left" rowspan="1" colspan="1">19% (59%)</td>
<td align="left" rowspan="1" colspan="1">18% (61%)</td>
<td align="left" rowspan="1" colspan="1">20% (57%)</td>
<td align="left" rowspan="1" colspan="1">0.012%</td>
<td align="left" rowspan="1" colspan="1">56</td>
<td align="left" rowspan="1" colspan="1">99.7%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">ShoRAH</td>
<td align="left" rowspan="1" colspan="1">29% (97%)</td>
<td align="left" rowspan="1" colspan="1">20% (97%)</td>
<td align="left" rowspan="1" colspan="1">20% (97%)</td>
<td align="left" rowspan="1" colspan="1">9% (97%)</td>
<td align="left" rowspan="1" colspan="1">20% (99%)</td>
<td align="left" rowspan="1" colspan="1">1.99%</td>
<td align="left" rowspan="1" colspan="1">196</td>
<td align="left" rowspan="1" colspan="1">0%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">PredictHaplo</td>
<td align="left" rowspan="1" colspan="1">91% (99%)</td>
<td align="left" rowspan="1" colspan="1">0% (0%)</td>
<td align="left" rowspan="1" colspan="1">1% (3%)</td>
<td align="left" rowspan="1" colspan="1">6% (12%)</td>
<td align="left" rowspan="1" colspan="1">2% (18%)</td>
<td align="left" rowspan="1" colspan="1">1.65%</td>
<td align="left" rowspan="1" colspan="1">95</td>
<td align="left" rowspan="1" colspan="1">0%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">QuRe</td>
<td align="left" rowspan="1" colspan="1">46% (91%)</td>
<td align="left" rowspan="1" colspan="1">7% (91%)</td>
<td align="left" rowspan="1" colspan="1">0% (0%)</td>
<td align="left" rowspan="1" colspan="1">27% (91%)</td>
<td align="left" rowspan="1" colspan="1">20% (93%)</td>
<td align="left" rowspan="1" colspan="1">2.95%</td>
<td align="left" rowspan="1" colspan="1">15</td>
<td align="left" rowspan="1" colspan="1">0%</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>Global haplotype assembly comparison of HaploClique with the software packages ShoRAH <xref ref-type="bibr" rid="pcbi.1003515-Zagordi3">[33]</xref>, PredictHaplo <xref ref-type="bibr" rid="pcbi.1003515-Prabhakaran1">[14]</xref>, and QuRe <xref ref-type="bibr" rid="pcbi.1003515-Prosperi1">[16]</xref>. We report the estimated variant frequencies and, in parenthesis, the maximal length of the reconstructed haplotypes relative to the genome length, for each of the five variants. In the remaining columns, the average error rate (computed as the number of mistaken nucleotides, divided by the length of the haplotype computed), the total number of reconstructed haplotypes, and the precision (percentage of perfectly reconstructed haplotypes weighted by the respective estimated frequency) are reported. See <xref ref-type="sec" rid="s5">Methods</xref> for more details on frequency estimation.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3a5">
<title>Comparisons</title>
<p>We performed haplotype reconstruction for the lab-mix using the tools ShoRAH <xref ref-type="bibr" rid="pcbi.1003515-Zagordi3">[33]</xref>, PredictHaplo <xref ref-type="bibr" rid="pcbi.1003515-Prabhakaran1">[14]</xref>, and QuRe <xref ref-type="bibr" rid="pcbi.1003515-Prosperi1">[16]</xref>, and compared the results to those of HaploClique (<xref ref-type="table" rid="pcbi-1003515-t001">Table 1</xref>). Hapler v1.60 <xref ref-type="bibr" rid="pcbi.1003515-ONeil1">[19]</xref> did not accept NGS alignments with insertions, and hence was not applicable to this heterogeneous virus populations. PredictHaplo v0.4 with paired-end option reconstructed local or global haplotypes with an average error-rate of 1.65%. ShoRAH does not take paired-end information into account and reconstructed 196 full-length genomes, 16 over 1% estimated frequency, with an average error rate of 1.99%. QuRe v0.99971 performed its own single-end alignment and reconstructed global haplotypes with an average error rate of 2.95%, the highest among all methods. The wall-clock time and maximal memory consumption, respectively, was 10 min and 12 mb for PredictHaplo, 30 min and 150 mb for HaploClique, 1.5 hr and 680 mb for ShoRAH, and 2 hr and 33 gb for QuRe on a 80-core server with 1 tb memory. PredictHaplo and HaploClique used a single thread, QuRe and ShoRAH are partially multithreaded. The results of QuRe were not reproducible, because new instances of QuRe on the same data set did not finish within one day. HaploClique performed best in maximal reconstructed haplotype length that was error-free, and it had the closest estimated haplotype distribution and overall the highest precision.</p>
</sec></sec><sec id="s3b">
<title>Patient sample</title>
<p>For the application of HaploClique to a clinical sample, HCV RNA was extracted from the plasma collected from a subject isolated 135 days post infection and the NS5 region RT-PCR amplified as previously described <xref ref-type="bibr" rid="pcbi.1003515-Bull1">[35]</xref>. In this subject there was experimental evidence of antigen-specific CD8+ T cell responses targeting two epitopes in the NS5 region (K2629SKRTPMGF and W2820LGNIIMFA). The NS5B region encodes for the RNA-dependent RNA polymerase and is essential for the replication of the virus.</p>
<p>This amplicon was sequenced to a coverage of 80,000× on a MiSeq instrument using a 2×250 bp read kit. The resulting reads were aligned using BWA-MEM <xref ref-type="bibr" rid="pcbi.1003515-Li2">[36]</xref>. We found the insert size distribution to have a mean of 155 bp and a standard deviation of 167 as estimated by HaploClique. Despite this large standard deviation, HaploClique was able to discover a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e026" xlink:type="simple"/></inline-formula> bp deletion. No other indels were reported by HaploClique.</p>
<p>In two independent sequencing runs of the same amplicon, once on a 454/Roche GS FLX+ system and once on a PacBio instrument, the presence of the deletion was confirmed. Both technologies yield longer reads than MiSeq that could successfully be aligned across the deletion breakpoint, allowing to determine breakpoint coordinates at base-pair resolution.</p>
<p>For the alignment of the longer reads, extreme affine gap costs have been used to find the deletion. In general, this leads to alignment artifacts in other regions, causing false positive haplotype calls. With a read length of 250 bp, we did not succeed to align reads across the large deletion.</p>
<p>Comparing coordinates, we found that the start positions predicted by HaploClique was 15 bp off the true position and the true length amounted to 444 bp. That is, the length difference between true and predicted deletion amounted to 87 bp, or 0.52 standard deviations.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>We have presented HaploClique, a method for local haplotype reconstruction, structural variant detection of large insertions and deletions, and global haplotype assembly, which represents a principled approach to viral quasispecies assembly from NGS paired-end reads. HaploClique builds on a read alignment graph as underlying combinatorial model, where nodes correspond to single-end or paired-end alignments of reads. Edges are modeled in a probabilistic fashion.</p>
<p>They are based on sequence similarity of the read overlap by incorporating phred-style quality scores in combination with a position-wise prior for the non-overlapping parts of the reads, and on a criterion that measures insert size compatibility of the two alignments. While the sequence similarity criterion accounts for correct assembly of reads, the insert size criterion allows for detecting insertions and deletions in viral haplotypes that cannot be detected from single-end read alignments alone. We suggest a model that unifies sequencing error correction, clustering reads into haplotype groups, as well as assembling reads into longer fragments, all of which naturally emerge from the model.</p>
<p>In the read alignment graph, max-cliques represent maximal read sets that overlap and represent (locally) identical haplotype sequence. The advantage of the max-clique computation is twofold. First, it clusters reads, thereby separating reads stemming from different haplotypes.</p>
<p>Second, it enables sequencing error correction in a way that can make full use of co-occurrence, that is, statistical correlation of variant alleles within reach of the reads participating in a max-clique. In particular, the error correction exploits paired-end information if provided. The improved error correction is important, as it gives rise to improved frequency estimates and allows for distinguishing between haplotypes whose pairwise distance is below 1%.</p>
<p>HaploClique allows for reconstructing full-length global haplotypes using a read assembly procedure that is orthogonal to all existing assembly methods. In our iterative approach, we alternate between transforming max-cliques into super-reads, which form the nodes of a new alignment graph, and finding max-cliques in the new graph. We repeat this process until convergence, which is established when super-reads do not grow any longer.</p>
<p>HaploClique depends on three parameters to be adjusted manually: minimal read overlap, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e027" xlink:type="simple"/></inline-formula>, a threshold for the probability that two overlapping reads stem from locally identical haplotypes, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e028" xlink:type="simple"/></inline-formula>, and the minimal coverage to call the super-read sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e029" xlink:type="simple"/></inline-formula>. In general, if one of the parameters is decreased, the number and size of cliques will increase. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e030" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e031" xlink:type="simple"/></inline-formula> are too small, the purity of cliques will decrease, meaning reads from different but very similar haplotypes cluster. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e032" xlink:type="simple"/></inline-formula> is too large, cliques will grow slower and less frequent haplotypes may be missed. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e033" xlink:type="simple"/></inline-formula> is too large, reads are more likely to cluster not only if they stem from the same haplotype but also if they have technical errors in common; this leads to lower error correction efficiency. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e034" xlink:type="simple"/></inline-formula> is too small, there might not be enough statistical power to correct for sequencing errors. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e035" xlink:type="simple"/></inline-formula> is too large, the false negative rate will rise, as low-frequency haplotypes do not provide enough reads to form cliques. We used two different parameter sets for HaploClique. In the first iteration, local haplotype reconstruction with error correction is performed and we chose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e036" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e037" xlink:type="simple"/></inline-formula>. In practice, the results are insensitive to the parameter choice (<xref ref-type="supplementary-material" rid="pcbi.1003515.s002">Figure S2</xref>). For the following iterations, the quasispecies assembly, we assume that haplotypes are error-corrected and must match perfectly. We set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e038" xlink:type="simple"/></inline-formula> to account only for the stochasticity of the Phred scores.</p>
<p>We evaluated HaploClique by extensive simulation studies. The simulated haplotypes were well-known and much analyzed HIV-1 virus strains. We kept coverage in the simulation study rather low, so as to evaluate our tool in the presence of only weak signals. We did this also in comparison with extant state-of-the-art tools. We demonstrated that our approach has superior error correction capabilities. This, in turn, yields accurate haplotype frequency estimates, even at the rather low coverage of 120× per haplotype. The tools we compared to were not able to provide similarly accurate frequency estimates. HaploClique proved to be insensitive to a coverage reduction of one order of magnitude with respect to prevalent sequencing experiments, which commonly operate at 5000× or higher.</p>
<p>Beyond improved frequency estimates, we also improve haplotype sequence reconstruction. In all experiments, more than 99% of the haplotype segments we predict perfectly matched true haplotype sequences. None of the other tools generated even only one such perfectly matching segment, possibly because they require much higher coverage. This improvement in terms of accuracy may be due to the probabilistic model that treats error correction and assembly within one unifying framework. Our simulations also indicated that the degree of heterogeneity required in order to reconstruct large enough haplotype segments can be lower than 1%.</p>
<p>We also ran HaploClique on a real, Illumina MiSeq dataset of coverage 80,000×, which was found to consist of two HCV strains one of which had a frequency of only approximately 3% and contained a deletion of size 444 bp, as conformed by independent 454/Roche and PacBio sequencing experiments. In the MiSeq dataset, the deletion in question could not be detected by state-of-the-art read alignment tools. HaploClique successfully predicts this deletion, despite the large standard deviation of the fragment size distribution (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e039" xlink:type="simple"/></inline-formula> 167 bp). These experiments document that our method can detect large deletions also in Illumina paired-end datasets that otherwise would be difficult to identify.</p>
<p>Despite these improvements over previous methods, there are limitations of this approach. For example, the runtime of HaploClique is exponential in the read coverage. This feature is critical in the first two iterations of the procedure, before the number of reads is decreased. We observed that, approximately, the runtime doubles for each additional 250 reads of coverage. The baseline runtime was ∼4 minutes for a data set with coverage 1000×, on a single 3 GHz core. To overcome this computational bottleneck, one may perform the first iterations of haplotype reconstruction on subsets of the data and then assemble the merged results. Another extension that may decrease the runtime is to employ improved clustering techniques <xref ref-type="bibr" rid="pcbi.1003515-Bellitto1">[37]</xref>.</p>
<p>In the future, we also plan to explore on human whole-genome data, including polyploid cancer genomes, to perform error correction of the paired-end reads by local haplotype reconstruction and to assemble diploid haplotypes. This problem is more challenging due to the larger genome size and smaller levels of diversity, but several ideas presented here and implemented in HaploClique may prove useful for this task.</p>
</sec><sec id="s5" sec-type="methods">
<title>Methods</title>
<p>HaploClique performs paired-end error correction, local and global haplotype reconstruction, and structural variant calling based on enumerating cliques in the read alignment graph. We first explain the graph construction and then how super-reads are built, how global haplotypes are iteratively constructed, and how haplotype abundancies are estimated.</p>
<sec id="s5a">
<title>Read alignment graph</title>
<p>Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e040" xlink:type="simple"/></inline-formula> be the set of all reads from a viral quasispecies sequencing experiment and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e041" xlink:type="simple"/></inline-formula> the set of their alignments to a reference genome as computed by a read aligner. In this paper, we assume that each read can be uniquely mapped, which is a reasonable assumption for short, non-repetitive viral genomes. In our experiments, we use the Illumina MiSeq technology for sequencing and BWA-MEM <xref ref-type="bibr" rid="pcbi.1003515-Li2">[36]</xref> as a read aligner. However, HaploClique depends on the sequencing technology and read mapper only insofar that it expects reads to be equipped with quality scores and that the reads can be properly aligned.</p>
<p>We construct a graph <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e042" xlink:type="simple"/></inline-formula> where the read alignments <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e043" xlink:type="simple"/></inline-formula> are the vertices. An edge <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e044" xlink:type="simple"/></inline-formula> indicates that the two alignments <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e045" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e046" xlink:type="simple"/></inline-formula> overlap sufficiently and that the corresponding reads are likely to originate from (locally) identical haplotypes. More precisely, we draw an edge between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e047" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e048" xlink:type="simple"/></inline-formula> if they satisfy two criteria based on sequence similarity and insert sizes, respectively. While the sequence-based criterion ensures that the reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e049" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e050" xlink:type="simple"/></inline-formula> do not exhibit mutually contradictory sequences, the insert size-based criterion guarantees that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e051" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e052" xlink:type="simple"/></inline-formula> do not contradict each other in terms of their fragment sizes. We allow alignments <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e053" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e054" xlink:type="simple"/></inline-formula> to be any combination of single- and paired-end reads, but the size-based criterion applies only if both alignment are based on paired-end reads.</p>
<sec id="s5a1">
<title>Sequence similarity criterion</title>
<p>We define pairwise sequence distance as Hamming distance. We assume if reads stem from the same haplotype, their sequences are identical up to sequencing errors in the intervals of overlapping alignments.</p>
<p>The reference alignments <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e055" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e056" xlink:type="simple"/></inline-formula> induce a direct read-to-read alignment of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e057" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e058" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e059" xlink:type="simple"/></inline-formula> index the positions of the resulting read-to-read alignment (<xref ref-type="fig" rid="pcbi-1003515-g001">Figure 1</xref>). We consider the subset of positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e060" xlink:type="simple"/></inline-formula> that are covered by both reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e061" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e062" xlink:type="simple"/></inline-formula>. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e063" xlink:type="simple"/></inline-formula>, let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e064" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e065" xlink:type="simple"/></inline-formula> be the corresponding nucleotides or gap symbols (“<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e066" xlink:type="simple"/></inline-formula>”). We construct the induced read-to-read alignment, so that no column contains gap symbols in both rows. If there is a gap <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e067" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e068" xlink:type="simple"/></inline-formula> for some <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e069" xlink:type="simple"/></inline-formula>, then we consider <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e070" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e071" xlink:type="simple"/></inline-formula> <italic>incompatible</italic> and do not connect them by an edge.</p>
<p>In the following, we assume a gapless read-to-read alignment, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e072" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e073" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e074" xlink:type="simple"/></inline-formula>. Each nucleotide in each read comes with a base calling quality score (phred score) determined by the sequencer. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e075" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e076" xlink:type="simple"/></inline-formula> be the corresponding probabilities that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e077" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e078" xlink:type="simple"/></inline-formula>, respectively, was sequenced erroneously. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e079" xlink:type="simple"/></inline-formula>, we define<disp-formula id="pcbi.1003515.e080"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003515.e080" xlink:type="simple"/><label>(1)</label></disp-formula>and compute<disp-formula id="pcbi.1003515.e081"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003515.e081" xlink:type="simple"/><label>(2)</label></disp-formula></p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e082" xlink:type="simple"/></inline-formula> is the probability that the underlying DNA sequences of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e083" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e084" xlink:type="simple"/></inline-formula> are identical on the overlap <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e085" xlink:type="simple"/></inline-formula>. The actual reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e086" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e087" xlink:type="simple"/></inline-formula> might differ on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e088" xlink:type="simple"/></inline-formula> due to sequencing errors.</p>
<p>Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e089" xlink:type="simple"/></inline-formula> denote all reference positions covered by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e090" xlink:type="simple"/></inline-formula> but not by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e091" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e092" xlink:type="simple"/></inline-formula> be the probability that the nucleotides of two randomly drawn reads coincide when being aligned with reference position t. This quantity can be estimated based on the empirical allele frequency distribution at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e093" xlink:type="simple"/></inline-formula>, denoted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e094" xlink:type="simple"/></inline-formula>. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e095" xlink:type="simple"/></inline-formula> denotes the probability of observing nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e096" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e097" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e098" xlink:type="simple"/></inline-formula>. The probability that two randomly drawn alignments that, in contrast to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e099" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e100" xlink:type="simple"/></inline-formula>, both cover <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e101" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e102" xlink:type="simple"/></inline-formula>, exhibit identical nucleotides at all these positions is<disp-formula id="pcbi.1003515.e103"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003515.e103" xlink:type="simple"/><label>(3)</label></disp-formula></p>
<p>To finally decide whether two reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e104" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e105" xlink:type="simple"/></inline-formula> are likely to originate from (locally) identical haplotypes, we consider<disp-formula id="pcbi.1003515.e106"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003515.e106" xlink:type="simple"/><label>(4)</label></disp-formula>and say that two alignments <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e107" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e108" xlink:type="simple"/></inline-formula> satisfy the <italic>sequence similarity criterion</italic> if</p>
<list list-type="order"><list-item>
<p>they do not contain incompatible gaps: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e109" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e110" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e111" xlink:type="simple"/></inline-formula>,</p>
</list-item><list-item>
<p>there is sufficient overlap: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e112" xlink:type="simple"/></inline-formula>, and</p>
</list-item><list-item>
<p>the probability that the two reads were sampled from the same haplotype is sufficiently large: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e113" xlink:type="simple"/></inline-formula>, where the exponent ensures proper length normalization.</p>
</list-item></list>
</sec><sec id="s5a2">
<title>Insert size criterion</title>
<p>If a deletion or insertion is present, the distance between the reference alignments of the two ends increases (for deletions) or decreases (for insertions) compared to the situation without indels. Such insert size discrepancies can thus indicate the presence of indels as well as the (in)compatibility of two read pairs. Following <xref ref-type="bibr" rid="pcbi.1003515-Marschall1">[27]</xref>, we define an insert size criterion based on this observation. This criterion only applies to aligments <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e114" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e115" xlink:type="simple"/></inline-formula> of two paired-end reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e116" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e117" xlink:type="simple"/></inline-formula>.</p>
<p>Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e118" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e119" xlink:type="simple"/></inline-formula> be the rightmost position of the left end and the leftmost position of the right end, respectively, of alignment <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e120" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e121" xlink:type="simple"/></inline-formula> be the alignment interval length. For two overlapping alignments <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e122" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e123" xlink:type="simple"/></inline-formula>, let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e124" xlink:type="simple"/></inline-formula> be the length of the overlap of the alignment intervals and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e125" xlink:type="simple"/></inline-formula> the mean interval length (<xref ref-type="supplementary-material" rid="pcbi.1003515.s003">Figure S3</xref>). Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e126" xlink:type="simple"/></inline-formula> be Norm<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e127" xlink:type="simple"/></inline-formula>-distributed and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e128" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e129" xlink:type="simple"/></inline-formula> be mean and variance, respectively, of the empirical insert size distribution. The <italic>insert</italic> criterion is satisfied if<disp-formula id="pcbi.1003515.e130"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003515.e130" xlink:type="simple"/></disp-formula>that is, if the alignments have similar interval lengths and sufficient overlap <xref ref-type="bibr" rid="pcbi.1003515-Marschall1">[27]</xref> (<xref ref-type="supplementary-material" rid="pcbi.1003515.s004">Figure S4</xref>).</p>
</sec><sec id="s5a3">
<title>Edge definition</title>
<p>HaploClique has two modes. When the input consists solely of paired-end reads with a known insert size distribution, then both the sequence similarity criterion and the insert size criterion can be used, and an edge is drawn if both criteria are satisfied. If this is not the case, only the sequence similarity criterion applies. In the former mode, the statistical power to distingiush different haplotypes is larger due to employing two independent criteria. This mode also allows for calling indels based on the average insert size of alignments in a clique. Applying only the sequence similarity criterion, on the other hand, comes with the flexibility of mixing paired-end reads, single-end reads, and super-reads.</p>
</sec></sec><sec id="s5b">
<title>Max-clique enumeration</title>
<p>Cliques <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e131" xlink:type="simple"/></inline-formula> are fully connected subgraphs of the read alignment graph <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e132" xlink:type="simple"/></inline-formula>. They indicate groups of reads that are all likely to stem from locally identical haplotypes. Hence max-cliques form maximal groups of reads that originate from locally identical haplotypes.</p>
<p>The algorithm proceeds by first sorting all nodes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e133" xlink:type="simple"/></inline-formula> from left to right, in ascending order of the alignment coordinates such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e134" xlink:type="simple"/></inline-formula> starts left of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e135" xlink:type="simple"/></inline-formula>. The algorithm then computes maximal cliques by processing all nodes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e136" xlink:type="simple"/></inline-formula> in this order. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e137" xlink:type="simple"/></inline-formula> be the induced subgraph of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e138" xlink:type="simple"/></inline-formula> with vertices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e139" xlink:type="simple"/></inline-formula> and let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e140" xlink:type="simple"/></inline-formula> be all max-cliques in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e141" xlink:type="simple"/></inline-formula>. For a node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e142" xlink:type="simple"/></inline-formula>, let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e143" xlink:type="simple"/></inline-formula> be all nodes that are connected to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e144" xlink:type="simple"/></inline-formula> by an edge <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e145" xlink:type="simple"/></inline-formula>. If the rightmost coordinates of all alignments in a clique <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e146" xlink:type="simple"/></inline-formula> are smaller than the leftmost coordinate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e147" xlink:type="simple"/></inline-formula>, this clique cannot be further affected by any node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e148" xlink:type="simple"/></inline-formula> — such cliques are maximal in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e149" xlink:type="simple"/></inline-formula> and can be output if only nodes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e150" xlink:type="simple"/></inline-formula> are left to be considered. After having processed all nodes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e151" xlink:type="simple"/></inline-formula>, we declare all cliques <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e152" xlink:type="simple"/></inline-formula> that can still be affected by nodes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e153" xlink:type="simple"/></inline-formula> to be <italic>active</italic>.</p>
<p>When processing node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e154" xlink:type="simple"/></inline-formula>, we compute its neighborhood <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e155" xlink:type="simple"/></inline-formula> and add a new clique <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e156" xlink:type="simple"/></inline-formula> if intersecting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e157" xlink:type="simple"/></inline-formula> with each active clique yields the empty set. Otherwise, for each active clique <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e158" xlink:type="simple"/></inline-formula>, we set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e159" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e160" xlink:type="simple"/></inline-formula>, and we add a new clique <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e161" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e162" xlink:type="simple"/></inline-formula>. Among all new cliques to be added, we eliminate duplicates.</p>
<p>Max-clique enumeration is related to the problem of finding a minimum clique cover <xref ref-type="bibr" rid="pcbi.1003515-Karp1">[38]</xref>, where a minimal set of non-overlapping max-cliques is sought, whose vertices cover the graph.</p>
<sec id="s5b1">
<title>Runtime analysis</title>
<p>Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e163" xlink:type="simple"/></inline-formula> be an upper bound on the number of active cliques and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e164" xlink:type="simple"/></inline-formula> be an upper bound on the number of active nodes, where we call a node active if it is part of at least one active clique. Since no two distinct active cliques can be extended to the same max-clique, we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e165" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e166" xlink:type="simple"/></inline-formula> is the number of max-cliques in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e167" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e168" xlink:type="simple"/></inline-formula> be the number of alignments <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e169" xlink:type="simple"/></inline-formula>. First, sorting all nodes requires <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e170" xlink:type="simple"/></inline-formula> time. Processing each node requires <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e171" xlink:type="simple"/></inline-formula> time (when doing the duplicate removal by radix sorting bit vectors representing the new cliques). Therefore, the total runtime is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e172" xlink:type="simple"/></inline-formula>. Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e173" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e174" xlink:type="simple"/></inline-formula>, the algorithm has <italic>output polynomial</italic> runtime, that is, it is polynomial in the size of the input plus the size of the output.</p>
<p>In general graphs and in the worst case, the number of max-cliques is exponential in the number of nodes <xref ref-type="bibr" rid="pcbi.1003515-Moon1">[39]</xref>. Thus, our algorithm is not necessarily polynomial in the input alone. In interval graphs, however, the number of cliques grows at most linearly and simple sweep algorithms can enumerate all max-cliques in linear time. In these graphs, each vertex is an interval on the real line and an edge is drawn between two vertices whenever the corresponding intervals overlap. The read alignment graph as defined above can be regarded as an interval graph with removed edges. Indeed, that two alignments overlap is necessary but not sufficient for drawing an edge. Although, formally, any graph can be constructed by removing edges from an interval graph, being close to an interval graph with bounded coverage is a property that one can exploit. Due to the “banded” shape of the graph (<xref ref-type="fig" rid="pcbi-1003515-g001">Figure 1</xref>), the number of maximal cliques grows linearly in the genome length (and thus in the number of nodes) in practice (<xref ref-type="supplementary-material" rid="pcbi.1003515.s005">Figure S5B</xref>). Under this assumption, the runtime of the clique finder we use <xref ref-type="bibr" rid="pcbi.1003515-Marschall1">[27]</xref> is also linear in the number of nodes once they have been sorted. This linear behavior was indeed observed in computational experiments using viral genome lengths differing by several orders of magnitude (<xref ref-type="supplementary-material" rid="pcbi.1003515.s005">Figure S5</xref>). We optimized the implementation of the algorithm by exploiting bit-parallelism whenever possible. Being linear in the genome length, in practice, is crucial for analyzing the haplotype structure of longer viral or bacterial, or eventually also cancer genomes. It is for this reason, that we have selected this algorithm and prefer it over fast general purpose algorithms for max-clique enumeration in sparse graphs <xref ref-type="bibr" rid="pcbi.1003515-Eppstein1">[40]</xref>, <xref ref-type="bibr" rid="pcbi.1003515-Eppstein2">[41]</xref>, which generally scale quadratically with genome length.</p>
</sec></sec><sec id="s5c">
<title>Super-read assembly</title>
<p>Each max-clique is a set of reads with mutually compatible alignments. Therefore, we can construct consensus sequences for max-cliques, which we refer to as super-reads. The purpose of super-read construction is two-fold. First, super-reads represent haplotype segments. Second, super-reads can be used as input to further iterations of max-clique enumeration, with the goal of global haplotype reconstruction, which is discussed in the next section.</p>
<p>To construct super-reads, let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e175" xlink:type="simple"/></inline-formula> be the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e176" xlink:type="simple"/></inline-formula> alignments participating in a max-clique and let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e177" xlink:type="simple"/></inline-formula> be the set of positions where at least <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e178" xlink:type="simple"/></inline-formula> of these alignments contain non-gap characters. We recall that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e179" xlink:type="simple"/></inline-formula> denotes the probability that nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e180" xlink:type="simple"/></inline-formula> gave rise to position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e181" xlink:type="simple"/></inline-formula> in read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e182" xlink:type="simple"/></inline-formula>, although <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e183" xlink:type="simple"/></inline-formula> might differ from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e184" xlink:type="simple"/></inline-formula> due to sequencing errors.</p>
<p>We determine the nucleotide sequence of the super-read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e185" xlink:type="simple"/></inline-formula> by means of a weighted position-wise majority vote. We set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e186" xlink:type="simple"/></inline-formula>, for each position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e187" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e188" xlink:type="simple"/></inline-formula> is defined to be zero when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e189" xlink:type="simple"/></inline-formula> does not cover position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e190" xlink:type="simple"/></inline-formula>. The parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e191" xlink:type="simple"/></inline-formula> ensures that the super-reads have sufficient coverage of high quality. For later frequency estimation, we keep track of which original reads gave rise to which super-read.</p>
</sec><sec id="s5d">
<title>Global assembly strategy</title>
<p>For global haplotype reconstruction, or quasispecies assembly, we iterate the clique enumeration procedure. We align reads against the reference sequence, construct the read alignment graph, find max-cliques, and merge them into larger super-reads with updated phred scores that reflect corrected error profiles. In the next iteration, we use these super-reads as reads and restart the procedure until number and length of super-reads have converged. For the assembly step, we assume that reads have already been error-corrected in the first iteration and set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e192" xlink:type="simple"/></inline-formula>. Reads have to match perfectly and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e193" xlink:type="simple"/></inline-formula> only allows for stochasticity of the Phred scores. We start the iterations with a relative overlap of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e194" xlink:type="simple"/></inline-formula>. Once the length and number of super-reads converged, we decrease <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e195" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e196" xlink:type="simple"/></inline-formula> down to a minimum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e197" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s5e">
<title>Haplotype abundance estimation</title>
<p>We estimate haplotype abundance by counting the number of (original) reads that participate in the super-reads giving rise to the haplotypes. Original reads may participate in several super-reads and thereby contribute to abundance counts for several haplotypes. We resolve this issue by keeping track of the original read in each iteration, such that each read can be assigned to the final haplotypes after convergence. Reads contributing to several haplotypes abundances are then taken into account by weighting them accordingly.</p>
</sec><sec id="s5f">
<title>Data</title>
<p>The MiSeq raw read data set is available through the Sequence Read Archive under the BioProject accession number SRP034655. The MiSeq 2×250 bp error profiles for SimSeq <xref ref-type="bibr" rid="pcbi.1003515-Earl1">[34]</xref> used in the simulations are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/armintoepfer/haploclique" xlink:type="simple">https://github.com/armintoepfer/haploclique</ext-link> under data.</p>
<p>A summary of this paper appears in the proceedings of the RECOMB 2014 conference, April 2-5 [42].</p>
</sec></sec><sec id="s6">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003515.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003515.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Standard deviation of ten haplotype frequency estimates for different coverages.</bold> Ten haplotypes were sampled with different frequencies (x-axis, logarithmic scale), and the standard deviations of the frequency estimates are reported for ten repetitions of the simulation (y-axis, logarithmic scale). The different symbols represent data sets with coverages of 400×, 800×, and 1600×. Color indicates whether the genome was fully covered by predicted haplotypes (blue) or not (orange).</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003515.s002" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003515.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>Empirical studies for parameters </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e198" xlink:type="simple"/></inline-formula><bold> and </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e199" xlink:type="simple"/></inline-formula><bold>.</bold> Using the lab-mix, as described in the Results section, we benchmarked the reconstruction performance, with respect to error rate (left) and mean read length (right), for varying levels of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e200" xlink:type="simple"/></inline-formula>, the number of reads required for initial super-read construction. Only sequence fragments that are supported by at least <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e201" xlink:type="simple"/></inline-formula> original reads within one max-clique are turned into super-reads of the first generation (iteration). Performance depends on the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e202" xlink:type="simple"/></inline-formula>, the threshold for the probability that both reads stem from the same haplotype and the minimal coverage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e203" xlink:type="simple"/></inline-formula> to create a consensus sequence of the super-read. We varied <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e204" xlink:type="simple"/></inline-formula> between 0.91 and 0.99, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e205" xlink:type="simple"/></inline-formula> between 1 and 9.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003515.s003" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003515.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p><bold>Overlapping inserts.</bold> Two alignment pairs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e206" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e207" xlink:type="simple"/></inline-formula> along with their insert sizes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e208" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e209" xlink:type="simple"/></inline-formula> and their overlap <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e210" xlink:type="simple"/></inline-formula> are shown.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003515.s004" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003515.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p><bold>Insert edge definitions.</bold> The different scenarios (A)–(D) of the insert size criterion are shown.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003515.s005" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003515.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p><bold>Runtime analysis.</bold> (A) Run time and (B) number of max-cliques for varying genome lengths between 10 kb and 1 Mb and for coverages of 250× and 500×. Dots represent observed runtime in seconds (A) and number of max-cliques in the corresponding alignment graph (B). Lines represent linear regressions after log-log transformation. The slopes of approximately one indicate linear relationships. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e211" xlink:type="simple"/></inline-formula> is the fraction of variance explained by the log-log linear model. For each of the five viruses HIV-1, PhiCh1, enterobacteria phage P1, Bacillus phage G, and Acanthamoeba polyphage moumouvirus, we simulated three haplotypes with a distance of five percent to the reference genome. For each virus, we generated data sets with mean coverage 250× and 500×.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003515.s006" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003515.s006" position="float" xlink:type="simple"><label>Figure S6</label><caption>
<p><bold>Edge definitions.</bold> Illustration of the compatible gaps condition of the sequence similarity criterion. Two reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e212" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e213" xlink:type="simple"/></inline-formula> are aligned against the reference (left). This induces a direct read-to-read alignment of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e214" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003515.e215" xlink:type="simple"/></inline-formula> (right). Case (1): No gaps in the reference alignments lead to a gapless read-to-read alignment, which renders the pair of reads an edge candidate. Case (2): Gaps in the reference alignment become eliminated in the direct read-to-read alignment implying an edge candidate. Case (3): The reference alignment leads to aligning –‘C’ against ‘C-’, which we interpret as aligning C against C, that is, virtually case (2) is in effect. Case (4): Gaps in the reference alignment that lead to gaps in the read-to-read alignment exclude the possibility of edges. Case (5): Similar to (3), but we interpret ‘-A’ against ‘C-’ as gap implying that no edge is possible.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1003515-Domingo1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Domingo</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Sheldon</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Perales</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>Viral quasispecies evolution</article-title>. <source>Microbiol Mol Biol Rev</source> <volume>76</volume>: <fpage>159</fpage>–<lpage>216</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Tpfer1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Töpfer</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Höper</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Blome</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Beer</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Sequencing approach to analyze the role of quasispecies for classical swine fever</article-title>. <source>Virology</source> <volume>438</volume>: <fpage>14</fpage>–<lpage>19</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Vignuzzi1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vignuzzi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Stone</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Arnold</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Cameron</surname><given-names>CE</given-names></name>, <name name-style="western"><surname>Andino</surname><given-names>R</given-names></name> (<year>2006</year>) <article-title>Quasispecies diversity determines pathogenesis through cooperative interactions in a viral population</article-title>. <source>Nature</source> <volume>439</volume>: <fpage>344</fpage>–<lpage>348</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Henn1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henn</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>Boutwell</surname><given-names>CL</given-names></name>, <name name-style="western"><surname>Charlebois</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Lennon</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Power</surname><given-names>KA</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Whole genome deep sequencing of HIV-1 reveals the impact of early minor variants upon immune recognition during acute infection</article-title>. <source>PLoS pathogens</source> <volume>8</volume>: <fpage>e1002529</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Beerenwinkel1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Günthard</surname><given-names>HF</given-names></name>, <name name-style="western"><surname>Roth</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Metzner</surname><given-names>KJ</given-names></name> (<year>2012</year>) <article-title>Challenges and opportunities in estimating viral genetic diversity from next-generation sequencing data</article-title>. <source>Front Microbio</source> <volume>3</volume>: <fpage>239</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Hinkley1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hinkley</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Martins</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Chappey</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Haddad</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Stawiski</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>A systems analysis of mutational effects in HIV-1 protease and reverse transcriptase</article-title>. <source>Nat Genet</source> <volume>43</volume>: <fpage>487</fpage>–<lpage>489</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Jorde1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jorde</surname><given-names>LB</given-names></name>, <name name-style="western"><surname>Wooding</surname><given-names>SP</given-names></name> (<year>2004</year>) <article-title>Genetic variation, classification and ‘race’</article-title>. <source>Nature genetics</source> <volume>36</volume>: <fpage>S28</fpage>–<lpage>S33</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Eriksson1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eriksson</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Mitsuya</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Rhee</surname><given-names>SY</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Viral population estimation using pyrosequencing</article-title>. <source>PLoS Comput Biol</source> <volume>4</volume>: <fpage>e1000074</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Macalalad1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Macalalad</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Zody</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Charlebois</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Lennon</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Newman</surname><given-names>RM</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Highly sensitive and specific detection of rare variants in mixed viral populations from massively parallel sequence data</article-title>. <source>PLoS Comput Biol</source> <volume>8</volume>: <fpage>e1002417</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Quince1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quince</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lanzen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Davenport</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name> (<year>2011</year>) <article-title>Removing noise from pyrosequenced amplicons</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>38</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Zagordi1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zagordi</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Geyrhofer</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Roth</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name> (<year>2010</year>) <article-title>Deep sequencing of a genetically heterogeneous sample: local haplotype reconstruction and read error correction</article-title>. <source>J Comput Biol</source> <volume>17</volume>: <fpage>417</fpage>–<lpage>428</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Skums1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Skums</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Dimitrova</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Campo</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Vaughan</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Rossi</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Efficient error correction for next-generation sequencing of viral amplicons</article-title>. <source>BMC Bioinformatics</source> <volume>13</volume> <supplement>Suppl 10</supplement><fpage>S6</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Salzberg1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salzberg</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Phillippy</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Zimin</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Pulu</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Magoc</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Gage: A critical evaluation of genome assemblies and assembly algorithms</article-title>. <source>Genome Research</source> <volume>22</volume>: <fpage>557</fpage>–<lpage>567</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Prabhakaran1"><label>14</label>
<mixed-citation publication-type="other" xlink:type="simple">Prabhakaran S, Rey M, Zagordi O, Beerenwinkel N, Roth V (2010) HIV haplotype inference using a constraint-based dirichlet process mixture model. In: NIPS Workshop on Machine Learning in Computational Biology.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Tpfer2"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Töpfer</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Zagordi</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Prabhakaran</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Roth</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Halperin</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Probabilistic inference of viral quasispecies subject to recombination</article-title>. <source>Journal of Computational Biology</source> <volume>20</volume>: <fpage>113</fpage>–<lpage>123</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Prosperi1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Prosperi</surname><given-names>MCF</given-names></name>, <name name-style="western"><surname>Salemi</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>Qure: software for viral quasispecies reconstruction from nextgeneration sequencing data</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>132</fpage>–<lpage>133</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Astrovskaya1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Astrovskaya</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Tork</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Mangul</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Westbrooks</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Mandoiu</surname><given-names>I</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Inferring viral quasispecies spectra from 454 pyrosequencing reads</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume> <supplement>Suppl 6</supplement><fpage>S1</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Mancuso1"><label>18</label>
<mixed-citation publication-type="other" xlink:type="simple">Mancuso N, Tork B, Mandoiu I, Skums P, Zelikovsky A (2011) Viral quasispecies reconstruction from amplicon 454 pyrosequencing reads. In: Proc. 1st Workshop on Computational Advances in Molecular Epidemiology. pp. 94–101. URL<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/BIBMW.2011.6112360" xlink:type="simple">http://dx.doi.org/10.1109/BIBMW.2011.6112360</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-ONeil1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>O'Neil</surname><given-names>ST</given-names></name>, <name name-style="western"><surname>Emrich</surname><given-names>SJ</given-names></name> (<year>2012</year>) <article-title>Haplotype and minimum-chimerism consesus determination using short sequence data</article-title>. <source>BMC Genomics</source> <volume>13</volume>: <fpage>S4</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Huang1"><label>20</label>
<mixed-citation publication-type="other" xlink:type="simple">Huang A, Kantor R, DeLong A, Schreier L, Istrail S (2011) Qcolors: An algorithm for conservative viral quasispecies reconstruction from short and non-contiguous next generation sequencing reads. In: IEEE International Conference on Bioinformatics and Biomedicine Workshops. pp. 130–136. doi:10.1109/BIBMW.2011.6112365.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Aguiar1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aguiar</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Istrail</surname><given-names>S</given-names></name> (<year>2013</year>) <article-title>Haplotype assembly in polyploid genomes and identical by descent shared tracts</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>i352</fpage>–<lpage>i360</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Aguiar2"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aguiar</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Istrail</surname><given-names>S</given-names></name> (<year>2012</year>) <article-title>Hapcompass: a fast cycle basis algorithm for accurate haplotype assembly of sequence data</article-title>. <source>Journal of Computational Biology</source> <volume>19</volume>: <fpage>577</fpage>–<lpage>590</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Schirmer1"><label>23</label>
<mixed-citation publication-type="other" xlink:type="simple">Schirmer M, Sloan WT, Quince C (2012) Benchmarking of viral haplotype reconstruction programmes: an overview of the capacities and limitations of currently available programmes. Brief Bioinform. In press.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Zagordi2"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zagordi</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Däumer</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Beisel</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name> (<year>2012</year>) <article-title>Read length versus depth of coverage for viral quasispecies reconstruction</article-title>. <source>PLOS ONE</source> <volume>7</volume>: <fpage>e47046</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Prosperi2"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Prosperi</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Yin</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Nolan</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Lowe</surname><given-names>AD</given-names></name>, <name name-style="western"><surname>Goodenow</surname><given-names>MM</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Empirical validation of viral quasispecies assembly algorithms: state-of-the-art and challenges</article-title>. <source>Scientific reports</source> <volume>3</volume>: <fpage>2837</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Ocwieja1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ocwieja</surname><given-names>KE</given-names></name>, <name name-style="western"><surname>Sherrill-Mix</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Mukherjee</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Custers-Allen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>David</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Dynamic regulation of HIV-1 mrna populations analyzed by single-molecule enrichment and long-read sequencing</article-title>. <source>Nucleic acids research</source> <volume>40</volume>: <fpage>10345</fpage>–<lpage>10355</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Marschall1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marschall</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Costa</surname><given-names>IG</given-names></name>, <name name-style="western"><surname>Canzar</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Bauer</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Klau</surname><given-names>GW</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Clever: clique-enumerating variant finder</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>2875</fpage>–<lpage>2882</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Marschall2"><label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Marschall T, Hajirasouliha I, Schönhuth A (2013) Mate-clever: Mendelian-inheritance-aware discovery and genotyping of midsize and long indels. Bioinformatics.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Gnerre1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gnerre</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>High-quality draft assemblies of mammalian genomes from massively parallel sequence data</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>108</volume>: <fpage>1513</fpage>–<lpage>1518</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Li1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Ruotti</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Stewart</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Thomson</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Dewey</surname><given-names>CN</given-names></name> (<year>2010</year>) <article-title>Rna-seq gene expression estimation with read mapping uncertainty</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>493</fpage>–<lpage>500</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Zerbino1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zerbino</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Birney</surname><given-names>E</given-names></name> (<year>2008</year>) <article-title>Velvet: algorithms for de novo short read assembly using de bruijn graphs</article-title>. <source>Genome Res</source> <volume>18</volume>: <fpage>821</fpage>–<lpage>829</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Bansal1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bansal</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Bafna</surname><given-names>V</given-names></name> (<year>2008</year>) <article-title>Hapcut: an efficient and accurate algorithm for the haplotype assembly problem</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>i153</fpage>–<lpage>i159</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Zagordi3"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zagordi</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Bhattacharya</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Eriksson</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name> (<year>2011</year>) <article-title>Shorah: estimating the genetic diversity of a mixed sample from next-generation sequencing data</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>119</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Earl1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Earl</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Bradnam</surname><given-names>K</given-names></name>, <name name-style="western"><surname>St John</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Darling</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Assemblathon 1: A competitive assessment of de novo short read assembly methods</article-title>. <source>Genome Research</source> <volume>21</volume>: <fpage>2224</fpage>–<lpage>41</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Bull1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bull</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Luciani</surname><given-names>F</given-names></name>, <name name-style="western"><surname>McElroy</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Gaudieri</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Pham</surname><given-names>ST</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Sequential bottlenecks drive viral evolution in early acute hepatitis c virus infection</article-title>. <source>PLoS Pathog</source> <volume>7</volume>: <fpage>e1002243</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Li2"><label>36</label>
<mixed-citation publication-type="other" xlink:type="simple">Li H (2013) Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. arXiv.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Bellitto1"><label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Bellitto T, Marschall T, Klau G, Schönhuth A (2013) Next-generation cluster editing. Technical Report 1310.3353, ArXiV.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Karp1"><label>38</label>
<mixed-citation publication-type="other" xlink:type="simple">Karp R (1972) Reducibility among combinatorial problems. In: Miller R, Thatcher J, editors. Proceedings of a Symposium on the Complexity of Computer Computations. Plenum Press. pp. 85–103.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Moon1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moon</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Moser</surname><given-names>L</given-names></name> (<year>1965</year>) <article-title>On cliques in graphs</article-title>. <source>Israel Journal of Mathematics</source> <volume>3</volume>: <fpage>23</fpage>–<lpage>28</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Eppstein1"><label>40</label>
<mixed-citation publication-type="other" xlink:type="simple">Eppstein D, Löffler M, Strash D (2010) Listing all maximal cliques in sparse graphs in near-optimal time. In: Cheong O, Chwa KY, Park K, editors. Algorithms and Computation. Volume 6506 of Lecture Notes in Computer Science. Springer Berlin Heidelberg. pp. 403–414.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Eppstein2"><label>41</label>
<mixed-citation publication-type="other" xlink:type="simple">Eppstein D, Strash D (2011) Listing all maximal cliques in large sparse real-world graphs. CoRR abs/1103.0318.</mixed-citation>
</ref>
<ref id="pcbi.1003515-Tpfe1"><label>42</label>
<mixed-citation publication-type="other" xlink:type="simple">Töpfer A, Marschall T, Bull RA, Luciani F, Schönhuth A, <etal>et al</etal>.. (2014)  Viral Quasispecies Assembly via Maximal Clique Enumeration.  In: Research in Computational Molecular Biology, Springer. <volume>pp</volume>: : 309–310.</mixed-citation>
</ref>
</ref-list></back>
</article>