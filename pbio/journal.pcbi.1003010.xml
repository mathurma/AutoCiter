<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
      <journal-id journal-id-type="pmc">ploscomp</journal-id>
      <journal-title-group>
        <journal-title>PLoS Computational Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1553-734X</issn>
      <issn pub-type="epub">1553-7358</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-01714</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pcbi.1003010</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Genomics</subject>
              <subj-group>
                <subject>Genome sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Discrete mathematics</subject>
            <subj-group>
              <subject>Combinatorics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
          <subject>Computer Science</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Combinatorial Pooling Enables Selective Sequencing of the Barley Gene Space</article-title>
        <alt-title alt-title-type="running-head">Selective Sequencing of the Barley Gene Space</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Lonardi</surname>
            <given-names>Stefano</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Duma</surname>
            <given-names>Denisa</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Alpert</surname>
            <given-names>Matthew</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Cordero</surname>
            <given-names>Francesca</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Beccuti</surname>
            <given-names>Marco</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Bhat</surname>
            <given-names>Prasanna R.</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Wu</surname>
            <given-names>Yonghui</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff5">
            <sup>5</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Ciardo</surname>
            <given-names>Gianfranco</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Alsaihati</surname>
            <given-names>Burair</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff6">
            <sup>6</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Ma</surname>
            <given-names>Yaqin</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Wanamaker</surname>
            <given-names>Steve</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Resnik</surname>
            <given-names>Josh</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Bozdag</surname>
            <given-names>Serdar</given-names>
          </name>
          <xref ref-type="aff" rid="aff7">
            <sup>7</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Luo</surname>
            <given-names>Ming-Cheng</given-names>
          </name>
          <xref ref-type="aff" rid="aff8">
            <sup>8</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Close</surname>
            <given-names>Timothy J.</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff1">
        <label>1</label>
        <addr-line>Department of Computer Science and Engineering, University of California, Riverside, California, United States of America</addr-line>
      </aff>
      <aff id="aff2">
        <label>2</label>
        <addr-line>Department of Computer Science, Università di Torino, Torino, Italy</addr-line>
      </aff>
      <aff id="aff3">
        <label>3</label>
        <addr-line>Department of Botany and Plant Sciences, University of California, Riverside, California, United States of America</addr-line>
      </aff>
      <aff id="aff4">
        <label>4</label>
        <addr-line>Monsanto Research Centre, Bangalore, India</addr-line>
      </aff>
      <aff id="aff5">
        <label>5</label>
        <addr-line>Google, Inc., Mountain View, California, United States of America</addr-line>
      </aff>
      <aff id="aff6">
        <label>6</label>
        <addr-line>Joint Center for Genomic Research, King Abdulaziz City for Science and Technology, Riyadh, Saudi Arabia</addr-line>
      </aff>
      <aff id="aff7">
        <label>7</label>
        <addr-line>Department of Mathematics, Statistics and Computer Science, Marquette University, Milwaukee, Wisconsin, United States of America</addr-line>
      </aff>
      <aff id="aff8">
        <label>8</label>
        <addr-line>Department of Plant Sciences, University of California, Davis, California, United States of America</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Miyano</surname>
            <given-names>Satoru</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>University of Tokyo, Japan</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">stelo@cs.ucr.edu</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: SL TJC. Performed the experiments: PRB YM SW JR MCL TJC. Analyzed the data: SL DD MA FC MB YW GC BA SW SB TJC. Contributed reagents/materials/analysis tools: FC MB PRB YW GC BA YM SW JR SB MCL TJC. Wrote the paper: SL TJC.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="collection">
        <month>4</month>
        <year>2013</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>4</day>
        <month>4</month>
        <year>2013</year>
      </pub-date>
      <volume>9</volume>
      <issue>4</issue>
      <elocation-id>e1003010</elocation-id>
      <history>
        <date date-type="received">
          <day>29</day>
          <month>10</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>5</day>
          <month>2</month>
          <year>2013</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2013</copyright-year>
        <copyright-holder>Lonardi et al</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>For the vast majority of species – including many economically or ecologically important organisms, progress in biological research is hampered due to the lack of a reference genome sequence. Despite recent advances in sequencing technologies, several factors still limit the availability of such a critical resource. At the same time, many research groups and international consortia have already produced BAC libraries and physical maps and now are in a position to proceed with the development of whole-genome sequences organized around a physical map anchored to a genetic map. We propose a BAC-by-BAC sequencing protocol that combines combinatorial pooling design and second-generation sequencing technology to efficiently approach <italic>denovo</italic> selective genome sequencing. We show that combinatorial pooling is a cost-effective and practical alternative to exhaustive DNA barcoding when preparing sequencing libraries for hundreds or thousands of DNA samples, such as in this case gene-bearing minimum-tiling-path BAC clones. The novelty of the protocol hinges on the computational ability to efficiently compare hundred millions of short reads and assign them to the correct BAC clones (<italic>deconvolution</italic>) so that the assembly can be carried out clone-by-clone. Experimental results on simulated data for the rice genome show that the deconvolution is very accurate, and the resulting BAC assemblies have high quality. Results on real data for a gene-rich subset of the barley genome confirm that the deconvolution is accurate and the BAC assemblies have good quality. While our method cannot provide the level of completeness that one would achieve with a comprehensive whole-genome sequencing project, we show that it is quite successful in reconstructing the gene sequences within BACs. In the case of plants such as barley, this level of sequence knowledge is sufficient to support critical end-point objectives such as map-based cloning and marker-assisted breeding.</p>
      </abstract>
      <abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>The problem of obtaining the full genomic sequence of an organism has been solved either via a global brute-force approach (called whole-genome shotgun) or by a divide-and-conquer strategy (called clone-by-clone). Both approaches have advantages and disadvantages in terms of cost, manual labor, and the ability to deal with sequencing errors and highly repetitive regions of the genome. With the advent of second-generation sequencing instruments, the whole-genome shotgun approach has been the preferred choice. The clone-by-clone strategy is, however, still very relevant for large complex genomes. In fact, several research groups and international consortia have produced clone libraries and physical maps for many economically or ecologically important organisms and now are in a position to proceed with sequencing. In this manuscript, we demonstrate the feasibility of this approach on the gene-space of a large, very repetitive plant genome. The novelty of our approach is that, in order to take advantage of the throughput of the current generation of sequencing instruments, we pool hundreds of clones using a special type of “smart” pooling design that allows one to establish with high accuracy the source clone from the sequenced reads in a pool. Extensive simulations and experimental results support our claims.</p>
      </abstract>
      <funding-group>
        <funding-statement>This work was supported by the U.S. National Science Foundation [DBI-1062301 and DBI-0321756] and by the USDA National Institute of Food and Agriculture [2009-65300-05645 and 2006-55606-16722]. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <page-count count="12"/>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>The second generation of DNA sequencing instruments is revolutionizing the way molecular biologists design and carry out investigations in genomics and genetics. These new sequencing technologies (e.g., Illumina, ABI SOLiD) can produce a significantly greater number of reads at a fraction of the cost of Sanger-based technologies, but with the exception of Roche/454 and Ion Torrent (ABI) read lengths are only 50–150 bases. While the number (and to a lesser extent the length) of reads keeps increasing at each update of these instruments, the number of samples that can be run has remained small (e.g., two sets of eight independent <italic>lanes</italic> on the Illumina HiSeq). Since the number of reads produced by the instrument is essentially fixed, when DNA samples to be sequenced are relatively “short” (e.g., BAC clones) and the correspondence between reads and their source has to be maintained, several samples must be “multiplexed” within a single lane to optimize the trade-off between cost and sequencing depth. Multiplexing is traditionally achieved by adding a DNA barcode to each sample in the form of an additional (oligo) adapter, but this does not scale readily to thousands of samples. Although it is possible to exhaustively barcode such a number of objects <xref ref-type="bibr" rid="pcbi.1003010-Kircher1">[1]</xref>, the procedure of preparing (and balancing in multiplexes) thousands to ten of thousands of barcoded libraries for sequencing is very labor-intensive and can be quite expensive. Additionally, the resulting distribution of reads for each barcoded sample can be severely skewed (see, e.g., <xref ref-type="bibr" rid="pcbi.1003010-Alon1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Craig1">[3]</xref>), necessitating rounds of selective follow-up.</p>
      <p>Here, we demonstrate that multiplexing can be achieved without exhaustive barcoding by taking advantage of recent advances in combinatorial pooling design (also known as <italic>group testing</italic>). The essence of this work is to significantly reduce the burden of library production, without severely compromising on the sequencing coverage of each BAC. Combinatorial pooling has been used previously in the context of genome analysis, but here we attempt to use it for <italic>de novo</italic> genome sequencing. Earlier works use a simple grid design that can be very vulnerable to noise and behaves poorly when several objects are positive; a simple grid design is also far from optimal in terms of the number of pools it produces <xref ref-type="bibr" rid="pcbi.1003010-Cai1">[4]</xref>–<xref ref-type="bibr" rid="pcbi.1003010-Milosavljevic1">[7]</xref>. Recent works use more sophisticated pooling designs in combination with second-generation sequencing technology <xref ref-type="bibr" rid="pcbi.1003010-Prabhu1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1003010-Erlich2">[12]</xref>. The application domain of “DNA Sudoku” is the detection of microRNA targets in <italic>Arabidopsis</italic> and human genes <xref ref-type="bibr" rid="pcbi.1003010-Erlich1">[9]</xref>, whereas <xref ref-type="bibr" rid="pcbi.1003010-Prabhu1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Hajirasouliha1">[10]</xref> are focused on targeted resequencing (i.e., when a reference genome is available). Pooling designs have also been used to recover novel or known rare alleles in groups of individuals <xref ref-type="bibr" rid="pcbi.1003010-Shental1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Erlich2">[12]</xref>.</p>
      <p>In our approach to <italic>de novo</italic> sequencing, subsets of non-redundant but overlapping genome-tiling BACs are chosen to form intersecting pools. Each pool is then sequenced individually on a fraction of a flowcell via standard multiplexing. Due to the short length of a BAC (typically <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e001" xlink:type="simple"/></inline-formula>130 kb), cost-effective sequencing requires each sequenced sample to contain thousands of BACs. Assembling short reads originating from a mix of hundreds to thousands of BACs is likely to produce low-quality assemblies, as the assembler is unable to partition the reads according to individual BACs. Moreover, resulting contigs would not be assigned to a specific BAC. If instead reads could be assigned (or <italic>deconvoluted</italic>) to individual BACs, then the assembly could proceed clone-by-clone. We demonstrate that this objective can be achieved by choosing a pooling strategy in which each BAC is present in a carefully designed set of pools such that the identity of each BAC is encoded within the pooling pattern (rather than by its association with a particular barcode). We report experimental results on simulated data on the genome of <italic>Oryza sativa</italic> (rice) and real sequencing data on the genome of <italic>Hordeum vulgare L</italic>. (barley).</p>
    </sec>
    <sec id="s2" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <p>The steps in our <italic>combinatorial clone-by-clone sequencing</italic> method are illustrated in <xref ref-type="fig" rid="pcbi-1003010-g001">Figure 1</xref> and described next in detail.</p>
      <fig id="pcbi-1003010-g001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1003010.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Proposed sequencing protocol.</title>
          <p>(A) obtain a BAC library for the target organism; (B) select gene-enriched BACs from the library (optional); (C) fingerprint BACs and build a physical map; (D) select a minimum tiling path (MTP) from the physical map; (E) pool the MTP BACs according to the shifted transversal design; (F) sequence the DNA in each pool, trim/clean sequenced reads; (G) assign reads to BACs (<italic>deconvolution</italic>); (H) assemble reads BAC-by-BAC using a short-read assembler.</p>
        </caption>
        <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003010.g001" position="float" xlink:type="simple"/>
      </fig>
      <p><bold>A.</bold> Obtain a BAC library for the target organism</p>
      <p><bold>B.</bold> Select gene-enriched BACs from the library (optional)</p>
      <p><bold>C.</bold> Fingerprint BACs and build a physical map</p>
      <p><bold>D.</bold> Select a minimum tiling path (MTP) from the physical map <xref ref-type="bibr" rid="pcbi.1003010-Engler1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Bozdag1">[14]</xref></p>
      <p><bold>E.</bold> Pool the MTP BACs according to the shifted transversal design <xref ref-type="bibr" rid="pcbi.1003010-ThierryMieg1">[15]</xref></p>
      <p><bold>F.</bold> Sequence the DNA in each pool, trim/clean sequenced reads</p>
      <p><bold>G.</bold> Assign reads to BACs (<italic>deconvolution</italic>)</p>
      <p><bold>H.</bold> Assemble reads BAC-by-BAC using a short-read assembler</p>
      <sec id="s2a">
        <title>Pooling minimum-tiling-path BACs (steps A–E)</title>
        <p>While our method can in general be applied to any set of clones that cover a genome or a portion thereof, the protocol we describe here for selective genome sequencing uses a physical map of (gene-bearing) bacterial artificial chromosomes (BACs) to identify a set of minimally redundant clones. A <italic>physical map</italic> is a partial ordering of a set of genomic clones (usually BACs) encompassing one or more chromosomes. A physical map can be represented by a set of unordered contigs, where each contig is a set of overlapping clones. A physical map is usually obtained by digesting BAC clones via restriction enzymes into DNA fragments and then measuring the length of the resulting fragments (restriction fingerprints) on an agarose gel. The smallest set of clones that spans the region represented by the physical map is called <italic>minimum tiling path</italic> (MTP). The construction of a physical library and the selection of a MTP from a physical map are well-known procedures, and many organisms now have these resources available. More details can be found in, e.g. <xref ref-type="bibr" rid="pcbi.1003010-Bozdag1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Ding1">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1003010-Bozdag2">[19]</xref>, and references therein.</p>
        <p>Once the set of clones to be sequenced has been identified, they must be pooled according to a scheme that allows the deconvolution of the sequenced reads back to their corresponding BACs. In Combinatorics, the design of a pooling method reduces to the problem of constructing a <italic>disjunctive</italic> matrix <xref ref-type="bibr" rid="pcbi.1003010-Du1">[20]</xref>. Each row of the disjunctive matrix corresponds to a BAC to be pooled and each column corresponds to a pool. Consider a subset <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e002" xlink:type="simple"/></inline-formula> of the rows (BAC clones) in the disjunctive matrix, and let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e003" xlink:type="simple"/></inline-formula> be the set of pools that contain at least one BAC in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e004" xlink:type="simple"/></inline-formula>. A design (or a matrix) is said to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e005" xlink:type="simple"/></inline-formula>-<italic>decodable</italic> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e006" xlink:type="simple"/></inline-formula> when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e007" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e008" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e009" xlink:type="simple"/></inline-formula>. The construction of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e010" xlink:type="simple"/></inline-formula>-decodable pooling designs has been extensively studied <xref ref-type="bibr" rid="pcbi.1003010-Du1">[20]</xref>. The popular 2D grid design is simple to implement but cannot be used for the purposes of this work because it is only one-decodable.</p>
        <p>Recently, a new family of “smart” pooling methods has generated considerable attention <xref ref-type="bibr" rid="pcbi.1003010-Prabhu1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1003010-Hajirasouliha1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-ThierryMieg1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Du2">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Vermeirssen1">[22]</xref>. Among these, we selected the <italic>shifted transversal</italic> design <xref ref-type="bibr" rid="pcbi.1003010-ThierryMieg1">[15]</xref> due to its ability to handle multiple positives and its robustness to noise. The parameters of a shifted transversal design pooling are defined by three integers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e011" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e012" xlink:type="simple"/></inline-formula> is a prime number, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e013" xlink:type="simple"/></inline-formula> defines the number of layers, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e014" xlink:type="simple"/></inline-formula> is a small integer. A <italic>layer</italic> is one of the classes in the partition of BACs and consists of exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e015" xlink:type="simple"/></inline-formula> pools: the larger the number of layers, the higher is the decodability. By construction the total number of pools is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e016" xlink:type="simple"/></inline-formula>. If we set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e017" xlink:type="simple"/></inline-formula> to be the smallest integer such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e018" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e019" xlink:type="simple"/></inline-formula> is the number of BACs that need to be pooled, then the decodability of the design is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e020" xlink:type="simple"/></inline-formula>. In <xref ref-type="bibr" rid="pcbi.1003010-ThierryMieg1">[15]</xref>, the shifted transversal design is defined by parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e021" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e022" xlink:type="simple"/></inline-formula> is the number of samples to be pooled, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e023" xlink:type="simple"/></inline-formula> is the prime corresponding to the number of pools in each layer, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e024" xlink:type="simple"/></inline-formula> is the number of layers. In this paper, we use <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e025" xlink:type="simple"/></inline-formula> instead of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e026" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e027" xlink:type="simple"/></inline-formula> instead of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e028" xlink:type="simple"/></inline-formula>.</p>
        <p>An important property of this pooling design is that any two BACs share at most only <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e029" xlink:type="simple"/></inline-formula> pools. By choosing a small value for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e030" xlink:type="simple"/></inline-formula> one can make pooling extremely robust to deconvolution errors. In our experiments, we use <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e031" xlink:type="simple"/></inline-formula>, so that at least ten errors are needed to mistakenly assign a read to the wrong BAC. In contrast, two errors are sufficient to draw an erroneous conclusion with the 2D grid-design.</p>
        <p>Barley BAC pools were obtained as follows. <italic>Escherichia coli</italic> strain DH10B BAC cultures were grown individually in 96-well plates covered by a porous membrane for 36 hr in 2YT medium with 0.05% glucose and 30 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e032" xlink:type="simple"/></inline-formula>g/ml chloramphenicol at 37°C in a shaking incubator. Following combinatorial pooling of 50 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e033" xlink:type="simple"/></inline-formula>l aliquots from each of 2197 BAC cultures, each of 91 collected pools (169 BACs, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e034" xlink:type="simple"/></inline-formula>8.3 ml each) was centrifuged to create cell pellets. The pellets were frozen and then used for extraction of BAC DNA using Qiagen plasmid DNA isolation reagents. Each BAC pool DNA sample was then dissolved in 225 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e035" xlink:type="simple"/></inline-formula>l of TE buffer at an estimated final concentration of 20 ng/<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e036" xlink:type="simple"/></inline-formula>l. For gene-BAC assignment using the Golden Gate assays, a total of 10 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e037" xlink:type="simple"/></inline-formula>l (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e038" xlink:type="simple"/></inline-formula>200 ng) of this DNA was then digested for 1 hour at 37°C by using 2 units of <italic>Not</italic>I enzyme with 100 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e039" xlink:type="simple"/></inline-formula>g/ml BSA in a volume of 100 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e040" xlink:type="simple"/></inline-formula>l. The <italic>Not</italic>I enzyme was then heat inactivated at 65°C for 20 min.</p>
        <p>DNA for three sets of BACs (HV4,HV5, HV6) were prepared using a procedure that yields on average about 60% BAC DNA and 40% <italic>E. coli</italic> DNA. DNA for set HV3 was prepared using a procedure that was expected to yield about 90% BAC DNA and 10% <italic>E. coli</italic> DNA. Although these DNA samples performed well for SNP locus detection in the GoldenGate assay, we were unaware of the extent of <italic>E. coli</italic> in the samples until we began BAC pool sequencing, after all BAC pool DNAs had been prepared. The HV3 set reported here replaced an earlier set containing more <italic>E. coli</italic> DNA. Attempts were made to remove <italic>E. coli</italic> DNA from the BAC DNA samples through selective digestion by using exonucleases, and to reduce highly repetitive DNA using a denaturation/renaturation and double strand nuclease method. These procedures provided little or no reduction of the proportion of <italic>E. coli</italic> DNA in the samples. A cost-benefit analysis determined that the cost of replacing all of the BAC pools by applying an alternative BAC DNA purification procedure yielding an average of 90–92% BAC DNA and 8–10% <italic>E. coli</italic> DNA would be no more advantageous than simply repeating the sequencing of samples for which more DNA sequence information was needed to support the sequence-to-BAC deconvolution.</p>
        <p>A video showing 76 seconds of the pooling process is available as <xref ref-type="supplementary-material" rid="pcbi.1003010.s015">Video S1</xref>.</p>
      </sec>
      <sec id="s2b">
        <title>Sequencing and processing of paired-end reads (step F)</title>
        <p>Sequencing of the barley BAC pools was carried out on an Illumina HiSeq 2000 at UC Riverside. Paired-end reads from each pool were quality-trimmed using a sliding window and a minimum Phred quality of 23. Next, Illumina PCR adapters were removed with Far (Flexible Adapter Remover, <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net" xlink:type="simple">http://sourceforge.net</ext-link>), and the remaining sequence discarded either if shorter than 36 bases or if containing any ‘N’. Finally, reads were cleaned of <italic>E. coli</italic> (DH10B) and vector contamination (pBeloBAC11) using BWA <xref ref-type="bibr" rid="pcbi.1003010-Li1">[23]</xref> and custom scripts.</p>
        <p>According to our simulations, the sequencing depth of each BAC after deconvolution is required to be at least 50x to obtain good BAC assemblies. The parameters of the pooling design should be chosen so that the coverage pre-deconvolution is at least 150x–200x to compensate for non-uniformity in the molar concentrations of individual BACs within each pool, and for losses due to sequencing errors.</p>
      </sec>
      <sec id="s2c">
        <title>Deconvoluting reads to BACs (step G)</title>
        <p>To understand how deconvolution is achieved, let us make the simplifying assumption that clones in the MTP do not overlap. i.e., that the MTP BACs form a non-redundant tiling for the genome under study, or a fraction thereof. Let us pool the MTP BACs according to a shifted transversal design with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e041" xlink:type="simple"/></inline-formula> layers and obtain a set of reads from them. Now, consider a read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e042" xlink:type="simple"/></inline-formula> occurring only once in the portion of the genome covered by the BACs. If there are no sequencing errors and sequencing depth is sufficient, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e043" xlink:type="simple"/></inline-formula> will appear in the sequenced output of exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e044" xlink:type="simple"/></inline-formula> pools (see <xref ref-type="fig" rid="pcbi-1003010-g002">Figure 2</xref>, case 1). To determine the BAC to which read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e045" xlink:type="simple"/></inline-formula> should be assigned, a search is made for the BAC signature that matches the list of positive pools for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e046" xlink:type="simple"/></inline-formula>.</p>
        <fig id="pcbi-1003010-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1003010.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>An illustration of the three cases we are dealing with during the deconvolution process (clones belong to a MTP).</title>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003010.g002" position="float" xlink:type="simple"/>
        </fig>
        <p>For the most realistic scenario where at most <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e047" xlink:type="simple"/></inline-formula> MTP clones overlap, the pooling must be at least <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e048" xlink:type="simple"/></inline-formula>-decodable for the deconvolution to work. We expect each non-repetitive read to belong to at most two BACs if the MTP has been computed perfectly, or rarely three BACs when considering imperfections, so we set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e049" xlink:type="simple"/></inline-formula>. When a read belongs to the overlap between two clones (again assuming no sequencing errors), it will appear in the sequenced output for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e050" xlink:type="simple"/></inline-formula> pools (see <xref ref-type="fig" rid="pcbi-1003010-g002">Figure 2</xref>, case 2). The case for three overlapping clones (see <xref ref-type="fig" rid="pcbi-1003010-g002">Figure 2</xref>, case 3) is analogous.</p>
        <p>Recall that in step <bold>E</bold> each BAC is assigned to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e051" xlink:type="simple"/></inline-formula> pools, thus the <italic>signature</italic> of a BAC is a set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e052" xlink:type="simple"/></inline-formula> numbers in the range <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e053" xlink:type="simple"/></inline-formula>, where the first number belongs to the range <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e054" xlink:type="simple"/></inline-formula>, the second belongs to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e055" xlink:type="simple"/></inline-formula>,…, and the last one belongs to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e056" xlink:type="simple"/></inline-formula>. In our pooling design two BAC signatures cannot share more than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e057" xlink:type="simple"/></inline-formula> numbers (see Theorem I in <xref ref-type="bibr" rid="pcbi.1003010-ThierryMieg1">[15]</xref>). One can think of BAC signatures as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e058" xlink:type="simple"/></inline-formula>-dimensional vectors which are rather “far” from each other.</p>
        <p>Our deconvolution method proceeds as follows. First, recall the notion of <italic>k-mer</italic> of a string (read) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e059" xlink:type="simple"/></inline-formula> as a contiguous substring of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e060" xlink:type="simple"/></inline-formula> of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e061" xlink:type="simple"/></inline-formula>. If we denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e062" xlink:type="simple"/></inline-formula> the length of string <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e063" xlink:type="simple"/></inline-formula>, observe that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e064" xlink:type="simple"/></inline-formula> has <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e065" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e066" xlink:type="simple"/></inline-formula>-mers, not necessarily distinct. Let us call <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e067" xlink:type="simple"/></inline-formula> the set of reads obtained by sequencing pool <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e068" xlink:type="simple"/></inline-formula>, for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e069" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e070" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e071" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e072" xlink:type="simple"/></inline-formula> in our pooling design). For each set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e073" xlink:type="simple"/></inline-formula>, we first compute the number of occurrences <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e074" xlink:type="simple"/></inline-formula> of each of its distinct <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e075" xlink:type="simple"/></inline-formula>-mers. Specifically, for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e076" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e077" xlink:type="simple"/></inline-formula> (i.e., for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e078" xlink:type="simple"/></inline-formula> appearing in a read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e079" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e080" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e081" xlink:type="simple"/></inline-formula> or its reverse complement occurs exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e082" xlink:type="simple"/></inline-formula> times in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e083" xlink:type="simple"/></inline-formula>. These counts are stored in a hash table such that, given a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e084" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e085" xlink:type="simple"/></inline-formula>, we can efficiently retrieve a count vector of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e086" xlink:type="simple"/></inline-formula> numbers, namely <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e087" xlink:type="simple"/></inline-formula>. Once the table is built, we process each read as follows. Given a read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e088" xlink:type="simple"/></inline-formula> in pool <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e089" xlink:type="simple"/></inline-formula>, we fetch the count vectors for each of its <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e090" xlink:type="simple"/></inline-formula>-mers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e091" xlink:type="simple"/></inline-formula>. Given a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e092" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e093" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e094" xlink:type="simple"/></inline-formula>, let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e095" xlink:type="simple"/></inline-formula> be the number of positive (non-zero) entries in its count vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e096" xlink:type="simple"/></inline-formula>, i.e., the number of pools where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e097" xlink:type="simple"/></inline-formula> occurs at least once. Several scenarios are possible:</p>
        <list list-type="order">
          <list-item>
            <p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e098" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e099" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e100" xlink:type="simple"/></inline-formula> is discarded (it is likely to contain a sequencing error).</p>
          </list-item>
          <list-item>
            <p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e101" xlink:type="simple"/></inline-formula> and if the set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e102" xlink:type="simple"/></inline-formula> positive entries is a subset of one BAC signature, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e103" xlink:type="simple"/></inline-formula> is assigned to the corresponding BAC.</p>
          </list-item>
          <list-item>
            <p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e104" xlink:type="simple"/></inline-formula> and if a perfect match between the set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e105" xlink:type="simple"/></inline-formula> positive entries and a BAC signatures is found, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e106" xlink:type="simple"/></inline-formula> is assigned to the corresponding BAC.</p>
          </list-item>
          <list-item>
            <p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e107" xlink:type="simple"/></inline-formula>, then the smallest <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e108" xlink:type="simple"/></inline-formula> counts (other than the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e109" xlink:type="simple"/></inline-formula>-th one) are dropped from the count vector, and the new count vector with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e110" xlink:type="simple"/></inline-formula> non-zero counts is handled by step 3.</p>
          </list-item>
          <list-item>
            <p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e111" xlink:type="simple"/></inline-formula> and if a perfect match between the set of positive entries and the union of two BAC signatures is found, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e112" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e113" xlink:type="simple"/></inline-formula> is assigned to the corresponding two BACs.</p>
          </list-item>
          <list-item>
            <p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e114" xlink:type="simple"/></inline-formula>, then the smallest <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e115" xlink:type="simple"/></inline-formula> counts (other than the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e116" xlink:type="simple"/></inline-formula>-th one) are dropped from the count vector, and the new count vector with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e117" xlink:type="simple"/></inline-formula> non-zero counts is handled by step 5.</p>
          </list-item>
          <list-item>
            <p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e118" xlink:type="simple"/></inline-formula>, and if a perfect match between the set of positive entries and the union of three BAC signatures is found, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e119" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e120" xlink:type="simple"/></inline-formula> is assigned to the corresponding three BACs.</p>
          </list-item>
          <list-item>
            <p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e121" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e122" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e123" xlink:type="simple"/></inline-formula> is discarded (it is highly repetitive).</p>
          </list-item>
        </list>
        <p>At the end of this process, we consider the subset of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e124" xlink:type="simple"/></inline-formula>-mers that have been assigned to one, two or three BACs and compute the union of their signatures, which becomes the <italic>signature</italic> of read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e125" xlink:type="simple"/></inline-formula>. If a perfect match between the read signature and BAC signatures (either one, or the union of two or three) is found, then the read is assigned to the corresponding BAC(s). Reads for which no such match is found are declared <italic>non-deconvolutable</italic> and saved in a separate file.</p>
        <p>This algorithm is implemented in the tool HashFilter, which has been extensively tested under Linux and MacOS. Source code and manual can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.cs.ucr.edu/stelo/hashfilter/" xlink:type="simple">http://www.cs.ucr.edu/stelo/hashfilter/</ext-link>, under the GNU General Public License.</p>
      </sec>
      <sec id="s2d">
        <title>Clone-by-clone assembly (step H)</title>
        <p>Once the reads have been assigned to individual BACs, sets of single and paired-end reads are assembled clone-by-clone using V<sc>elvet</sc> <xref ref-type="bibr" rid="pcbi.1003010-Zerbino1">[24]</xref>. Velvet requires an expected coverage, which can be computed using the amount of sequenced bases assigned to each BAC and the estimated BAC size. For barley, BAC sizes were estimated from the number of bands in the restriction fingerprinting data. First, we computed the average number of bands in the 72,055 BACs fingerprinted using high-information-content fingerprinting <xref ref-type="bibr" rid="pcbi.1003010-Ding1">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Luo1">[17]</xref> (see also <ext-link ext-link-type="uri" xlink:href="http://phymap.ucdavis.edu/barley/" xlink:type="simple">http://phymap.ucdavis.edu/barley/</ext-link>). Assuming that the average BAC length in this set was 106 kb, we computed the multiplier to apply to the number of bands to obtain the estimated BAC length, which turned out to be 1175 bases. We used that constant to obtain estimated sizes for all BACs in HV3, HV4, HV5 and HV6 (see <xref ref-type="supplementary-material" rid="pcbi.1003010.s004">Dataset S4</xref>). Note that the average size is over 125 kb, much larger than the library average size of 106 kb; this indicates that the MTP selection favors larger BACs.</p>
        <p>We also tested SOAP<sc>denovo</sc> <xref ref-type="bibr" rid="pcbi.1003010-Li2">[25]</xref> and A<sc>byss</sc> <xref ref-type="bibr" rid="pcbi.1003010-Simpson1">[26]</xref> on simulated data, but there were no obvious performance benefits compared to Velvet in terms of assembly quality (data not shown). We evaluated the assembly for several choices of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e126" xlink:type="simple"/></inline-formula>-mer (hash) size, but have reported only the assembly that maximized the N50 (N50 indicates the minimum length of all contig/scaffolds that together account for at least 50% of the genome). We recorded the number of contigs, their N50/median/max/sum statistics, and the number of reads used in the assembly.</p>
        <p>For rice assemblies, we Blast-ed the BAC contigs to the rice genome. We computed the fraction of the original (source) BAC covered by at least one contig, and the number of gaps and overlaps in the assembly. The parameters used for Blast are reported in the legend of <xref ref-type="supplementary-material" rid="pcbi.1003010.s004">Dataset S4</xref>.</p>
        <p>For barley BAC assemblies, we carried out a validation based on the known BAC-unigene associations from the Illumina GoldenGate assay described in the next section. The validation involved Blast-ing EST-derived unigenes (Harvest:Barley assembly #35 unigenes, <ext-link ext-link-type="uri" xlink:href="http://harvest.ucr.edu" xlink:type="simple">http://harvest.ucr.edu</ext-link>) against the BAC assemblies. To reduce spurious hits, we applied three filters. First, we masked highly repetitive regions by computing the frequency of all distinct 26-mers in the cleaned/trimmed HV5 data, then masking any <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e127" xlink:type="simple"/></inline-formula>-mers that occurred at least 11,000 times in the reads used for the assembly (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e128" xlink:type="simple"/></inline-formula>80 copies in the genome) from the assembled contigs, by replacing the occurrences of those repetitive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e129" xlink:type="simple"/></inline-formula>-mers with Xs. Second, we ignored any BAC contig that covered a unigene for less than 50% of its length. Third, we excluded from the hit count any unigene that hit more than ten individual BACs overall. We recorded the number of unigenes hitting a BAC, and compared them with the expected unigenes according to the Illumina assay.</p>
      </sec>
      <sec id="s2e">
        <title>Barley GoldenGate oligonucleotide pool assay</title>
        <p>Samples for the GoldenGate assay were prepared by combining 5 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e130" xlink:type="simple"/></inline-formula>l of <italic>Not</italic>I-digested BAC pool DNA (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e131" xlink:type="simple"/></inline-formula>10 ng) with 4 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e132" xlink:type="simple"/></inline-formula>l of sonicated <italic>E. coli</italic> DNA pre-dialyzed into TE buffer at a concentration of 500 ng/<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e133" xlink:type="simple"/></inline-formula>l (2000 ng) and 16 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e134" xlink:type="simple"/></inline-formula>l of TE buffer. The final volume of each sample was thus 25 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e135" xlink:type="simple"/></inline-formula>l, composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e136" xlink:type="simple"/></inline-formula>0.4 ng/<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e137" xlink:type="simple"/></inline-formula>l of digested BAC pool DNA and 80 ng/<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e138" xlink:type="simple"/></inline-formula>l of additional <italic>E. coli</italic> DNA. These DNA samples were provided to Joe DeYoung at the University of California, Los Angeles, California, or to Shiaoman Chao at the US Department of Agriculture genotyping facility in Fargo, North Dakota. The DNA concentrations were then readjusted to 50 ng/<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e139" xlink:type="simple"/></inline-formula>l and a total of 5 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e140" xlink:type="simple"/></inline-formula>l of each DNA sample was used for each GoldenGate assay.</p>
        <p>Each Illumina GoldenGate oligonucleotide pool assay (OPA) allows interrogation of a DNA sample for the presence of 1536 SNP loci. In <xref ref-type="bibr" rid="pcbi.1003010-Close1">[27]</xref>, five OPAs were designed from approximately 22,000 SNPs from EST and PCR amplicon sequence alignments. Details of the development of three test phase (POPA1, POPA2, and POPA3) and two production scale (BOPA1 and BOPA2) can be found in <xref ref-type="bibr" rid="pcbi.1003010-Close1">[27]</xref>. We genotyped the barley BAC pools described in Section “The gene space of barley” on BOPA1 and BOPA2. The output from the Illumina GoldenGate assay was first converted to binary data by visual inspection of the theta/R space in BeadStudio. A positive reading meant that the SNP locus (and its corresponding unigene) is present in at least one BAC within the pool (refer to <xref ref-type="supplementary-material" rid="pcbi.1003010.s007">Figure S1</xref> for an example).</p>
        <p>Given the genotyping data for all unigene-pool pairs, we designed an algorithm that computes the optimal assignment of unigenes to BACs so that the number of errors is minimized. For a particular unigene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e141" xlink:type="simple"/></inline-formula> under consideration, let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e142" xlink:type="simple"/></inline-formula> be the signature set of corresponding positive pools. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e143" xlink:type="simple"/></inline-formula> be an arbitrary set of BACs, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e144" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e145" xlink:type="simple"/></inline-formula> be the union of the pools that contain at least a BAC clone in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e146" xlink:type="simple"/></inline-formula>. The number of errors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e147" xlink:type="simple"/></inline-formula> associated with this particular choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e148" xlink:type="simple"/></inline-formula> is defined to be the number of extra observations (equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e149" xlink:type="simple"/></inline-formula>) plus the number of missing observation (equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e150" xlink:type="simple"/></inline-formula>). Among all possible choices of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e151" xlink:type="simple"/></inline-formula>, we chose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e152" xlink:type="simple"/></inline-formula> such that the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e153" xlink:type="simple"/></inline-formula> is minimized. When the number of errors associated with the final solution was too large (more than three), we declared that unigene to be <italic>non-decodable</italic>.</p>
        <p>This procedure resulted in 1849 unigenes mapped to one, two, or three BACs. As a verification step, when a unigene was mapped to more than one BAC, we checked whether all those BACs belonged to the same contig in the barley physical map <xref ref-type="bibr" rid="pcbi.1003010-Soderlund1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Bozdag2">[19]</xref>. Using the genetic map developed in <xref ref-type="bibr" rid="pcbi.1003010-Close1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-MuozAmatrian1">[28]</xref> we were also able to assign these unigene-anchored BACs to genetic map positions (<xref ref-type="supplementary-material" rid="pcbi.1003010.s006">Dataset S6</xref>) and to check whether a BAC was associated with more than one genetic map position. The unigene-BAC error rate from these cross-checking methods appeared to be about 5%.</p>
      </sec>
      <sec id="s2f">
        <title>Barley whole genome shotgun sequencing</title>
        <p>The whole genome shotgun sequencing of barley was carried out at several locations: Ambry Genetics (Aliso Viejo, California) sequenced five (2<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e154" xlink:type="simple"/></inline-formula>77 bases) paired-end lanes and four long-insert paired-end (LIPE) lanes (insert size of 2, 3 and 5 kb); University of Minnesota (courtesy of G. Muehlbauer) sequenced two (2<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e155" xlink:type="simple"/></inline-formula>100 bases) paired-end lanes; UC Riverside sequenced seven (2<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e156" xlink:type="simple"/></inline-formula>100 bases) paired-end lanes. The number of usable paired-end bases after quality-based trimming was 159.31 Gb and 4.92 Gb of LIPE, for an overall 31x sequencing depth of the 5.3 Gb barley genome. An <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e157" xlink:type="simple"/></inline-formula>-mer (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e158" xlink:type="simple"/></inline-formula>) analysis showed that the effective depth of coverage of the data was about 24x <xref ref-type="bibr" rid="pcbi.1003010-Alpert1">[29]</xref>.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <sec id="s3a">
        <title>Simulation results on the rice genome</title>
        <p>The physical map for <italic>Oryza sativa</italic> was assembled from 22,474 BACs fingerprinted at AGCoL, and contained 1,937 contigs and 1,290 singletons. From this map, we selected only BACs whose sequence could be uniquely mapped to the rice genome. We computed an MTP of this smaller map using our tool FMTP <xref ref-type="bibr" rid="pcbi.1003010-Bozdag1">[14]</xref>. The resulting MTP contained 3,827 BACs with an average length of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e159" xlink:type="simple"/></inline-formula> kb, and spanned 91% of the rice genome (which is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e160" xlink:type="simple"/></inline-formula> Mb). The overlap between rice BACs is significant: 1555 BACs overlap another BAC by at least 50 Kb, and 421 BACs overlap another BAC by at least 100 Kb (see <xref ref-type="supplementary-material" rid="pcbi.1003010.s008">Figure S2</xref>). In general, our method makes no assumption on the shared sequence content for pooled BACs.</p>
        <p>We pooled <italic>in silico</italic> a subset of 2,197 BACs from the set above according to the shifted transversal design <xref ref-type="bibr" rid="pcbi.1003010-ThierryMieg1">[15]</xref>. This pooling design is defined by three parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e161" xlink:type="simple"/></inline-formula> (see <xref ref-type="sec" rid="s2">Materials and Methods</xref> for a detailed description of the properties of the pooling design). First observe that if the MTP was truly a set of minimally overlapping clones, a two-decodable pooling design would be sufficient. We decided that a three-decodable pooling scheme would give additional protection against errors and imperfections in the MTP. Taking into consideration the format of the standard 96-well plate and the need for a 3-decodable design, we chose parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e162" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e163" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e164" xlink:type="simple"/></inline-formula>, so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e165" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e166" xlink:type="simple"/></inline-formula>. Each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e167" xlink:type="simple"/></inline-formula> layers consisted of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e168" xlink:type="simple"/></inline-formula> pools, for a total of 91 BAC pools, which left some space for a few control DNA samples on a 96-well plate. In this pooling design, each BAC is contained in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e169" xlink:type="simple"/></inline-formula> pools and each pool contains <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e170" xlink:type="simple"/></inline-formula> BACs. We call the set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e171" xlink:type="simple"/></inline-formula> pools to which a BAC is assigned, the <italic>BAC signature</italic>. Any two BAC signatures can share at most <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e172" xlink:type="simple"/></inline-formula> pools, and any triplet of BAC signatures can share at most <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e173" xlink:type="simple"/></inline-formula> pools. Specifically, 57.9% of any BAC signature pairs have no pool in common, 30.6% share one pool, and 11.5% share two pools. For triplets of BAC signatures, 18.5% have no pool in common, 32% share one pool, 29.6% share two pools, 14.8% share three pools, 4.5% share four pools, 0.6% share five pools, and 0.01% share six.</p>
        <p>The 91 resulting rice BAC pools were “sequenced” <italic>in silico</italic> by generating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e174" xlink:type="simple"/></inline-formula> paired-end reads of 104 bases with an insert size of 327 bases, and 1% sequencing error distributed uniformly along the read. A total of 208 M usable bases gave an expected <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e175" xlink:type="simple"/></inline-formula>x sequencing depth for a BAC in a pool. As each BAC is present in seven pools, this is an expected <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e176" xlink:type="simple"/></inline-formula>x combined coverage.</p>
        <p>The 91 read pools were processed for deconvolution using the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e177" xlink:type="simple"/></inline-formula>-mer based algorithm presented in the <xref ref-type="sec" rid="s2">Materials and Methods</xref> section. We set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e178" xlink:type="simple"/></inline-formula> because we wanted to detect an overlap between two reads of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e179" xlink:type="simple"/></inline-formula> bases with a length of at least 75% (78 bases) and at most two mismatches (observe that if the two errors are equally spaced along the 78 overlapping bases, a perfect match of length 26 must occur). The computation was relatively quick, but required a significant amount of memory. The construction of the hash table required about 120 GB of RAM and 164 minutes running on one core of a Dell PowerEdge T710 server (dual Intel Xeon X5660 2.8 Ghz, 12 cores, 169 GB RAM). The deconvolution phase took 33 minutes on 10 cores; sorting the reads into 2,197 files took 22 minutes on one core.</p>
        <p><xref ref-type="fig" rid="pcbi-1003010-g003">Figure 3-(a)</xref> illustrates the distribution of signature sizes for all the distinct <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e180" xlink:type="simple"/></inline-formula>-mers in the rice dataset. Observe that the distribution has clear peaks around <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e181" xlink:type="simple"/></inline-formula>, around the interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e182" xlink:type="simple"/></inline-formula> and the interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e183" xlink:type="simple"/></inline-formula>. These peaks correspond to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e184" xlink:type="simple"/></inline-formula>-mers originating from one, two, and three overlapping BACs, respectively (see <xref ref-type="fig" rid="pcbi-1003010-g002">Figure 2</xref>). We also have a rather large number of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e185" xlink:type="simple"/></inline-formula>-mers appearing in 1–6 pools. Observe that if the sequencing depth was sufficient, and in the absence of technical errors with BACs for a long <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e186" xlink:type="simple"/></inline-formula>-mer to have fewer than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e187" xlink:type="simple"/></inline-formula> occurrences, sequencing errors must have occurred. <xref ref-type="fig" rid="pcbi-1003010-g003">Figure 3-(b)</xref> shows the distribution of signature sizes for all the reads in the rice dataset at the outset of our deconvolution algorithm (presented in the <xref ref-type="sec" rid="s2">Materials and Methods</xref> section). Observe that the vast majority of reads now have a signature size in the expected ranges, with the exception of reads that appear in more than 80 pools. This latter set of reads cannot be deconvoluted and is discarded.</p>
        <fig id="pcbi-1003010-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1003010.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Count distribution for the signatures of all distinct 26-mers [(a) rice synthetic data, (c) barley HV5] and all the reads [(b) rice synthetic data, (d) barley HV5] in the 91 pools of sequencing data.</title>
            <p>The x-axis represents the size of the signature and the y-axis is the absolute count.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003010.g003" position="float" xlink:type="simple"/>
        </fig>
        <p>The set of reads with a signature of size 7, 12–14 or 15–21 that could be deconvoluted was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e188" xlink:type="simple"/></inline-formula>% of the total (see <xref ref-type="supplementary-material" rid="pcbi.1003010.s010">Table S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003010.s001">Dataset S1</xref>). Since we knew the BAC from which each read was generated, we determined that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e189" xlink:type="simple"/></inline-formula>% of the deconvoluted reads were assigned to either the correct BAC or to a BAC overlapping the correct BAC (see <xref ref-type="supplementary-material" rid="pcbi.1003010.s010">Table S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003010.s004">Dataset S4</xref>). After deconvolution, the average sequencing depth for each BAC was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e190" xlink:type="simple"/></inline-formula>x, about 50% higher than the expected <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e191" xlink:type="simple"/></inline-formula>x. Even if we are losing about <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e192" xlink:type="simple"/></inline-formula>% of the reads due to invalid signatures, deconvoluted reads are frequently assigned to multiple BACs, thereby amplifying the sequencing depth. Part of this inflation can be attributed to the overlap between BACs in the rice MTP (see <xref ref-type="supplementary-material" rid="pcbi.1003010.s008">Figure S2</xref>).</p>
        <p>In the final step of the protocol, we independently assembled the set of reads assigned to each BAC. We carried out this step with V<sc>elvet</sc> <xref ref-type="bibr" rid="pcbi.1003010-Zerbino1">[24]</xref> for each of the 2,197 BACs, for a variety of choices of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e193" xlink:type="simple"/></inline-formula>-mer size (hash length) and reported only the assembly that maximized the N50. This is an arbitrary choice that does not guarantee the “best” overall assembly. Sheet 1 in <xref ref-type="supplementary-material" rid="pcbi.1003010.s004">Dataset S4</xref> summarizes the results. If we average assembly statistics over all the 2,197 BACs, the percentage of reads used in the assembly was 82.3%, the average number of contigs was 41, the average N50 was 47,551 bp (31.4% of the average BAC length), the average largest contig was 57,258 bp (37.8% of the average BAC length), the average sum of all contig sizes was 137,050 bp (90.7% of the average BAC length). The N50 is quite high, and so is the percentage of reads used by the assembler. While these numbers already indicate high quality assemblies, we determined whether BACs were correctly assembled by Blast-ing BAC contigs against the rice genome. Sheet 1 in <xref ref-type="supplementary-material" rid="pcbi.1003010.s004">Dataset S4</xref> reports the results of this analysis. Considering these statistics over all the 2,197 BACs, the average BAC coverage was 76.8%, the average gap size was 263 bp, the average number of gaps was 138, the average overlap size was 107 bp, and the average number of overlaps was 75.</p>
        <p>To establish a comparison “baseline” for these assembly statistics, we considered the most optimistic scenario of a “perfect deconvolution”, which entails using the provenance annotation of each read to assign it back to the correct BAC with 100% accuracy. Sheet 2 in <xref ref-type="supplementary-material" rid="pcbi.1003010.s004">Dataset S4</xref> reports the same statistics for all 2,197 BAC assemblies in this best-case scenario. If we compute the average over all the 2,197 BACs, the average fraction of the reads used by Velvet was 82.7% and the average N50 was 132,865 bp (88% of the average BAC length). The Blast statistics showed an average BAC coverage of 96.3%, an average gap size of 52 bp, an average number of gaps of 97, an average overlap size of 29 bp, and an average number of overlaps of 54. While this latter BAC coverage is about 20% higher, the results following deconvolution compare quite favorably with what would be possible sequencing each BAC separately.</p>
      </sec>
      <sec id="s3b">
        <title>The gene-space of barley</title>
        <p>Barley's diploid genome size is estimated at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e194" xlink:type="simple"/></inline-formula>5,300 Mb and is composed of at least 80% highly repetitive DNA, predominantly LTR retrotransposons <xref ref-type="bibr" rid="pcbi.1003010-Wicker1">[30]</xref>. We started with a 6.3x genome equivalent barley BAC library which contains 313,344 BACs with an average insert size of 106 kb <xref ref-type="bibr" rid="pcbi.1003010-Yu1">[31]</xref>. Nearly 84,000 gene-enriched BACs were identified, mainly by the overgo probing method <xref ref-type="bibr" rid="pcbi.1003010-Madishetty1">[32]</xref>. Gene-enriched BACs were fingerprinted using high-information-content fingerprinting <xref ref-type="bibr" rid="pcbi.1003010-Ding1">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Luo1">[17]</xref>. From the fingerprinting data a physical map was produced <xref ref-type="bibr" rid="pcbi.1003010-Soderlund1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Bozdag2">[19]</xref> and a MTP of about 15,000 clones was derived <xref ref-type="bibr" rid="pcbi.1003010-Bozdag1">[14]</xref>. Seven sets of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e195" xlink:type="simple"/></inline-formula>2,197 clones were chosen to be pooled according to the shifted transversal design <xref ref-type="bibr" rid="pcbi.1003010-ThierryMieg1">[15]</xref>, which we internally call HV3, HV4,…, HV9 (HV1 and HV2 were pilot experiments). We used the same pooling parameters discussed in the previous section (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e196" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e197" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e198" xlink:type="simple"/></inline-formula>).</p>
        <p>Here we are reporting on four out of seven sets, namely HV3, HV4, HV5, and HV6. Each is comprised of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e199" xlink:type="simple"/></inline-formula> pools with a total of 2,197 MTP gene-rich barley BAC clones. Given the estimated 129.5 kb size of a BAC in the barley MTP (see <xref ref-type="sec" rid="s2">Materials and Methods</xref>), the total complexity of each pool of 169 BACs is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e200" xlink:type="simple"/></inline-formula> Mb and of the 2,197 BACs is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e201" xlink:type="simple"/></inline-formula> Mb. To take advantage of the high density of sequencing of the Illumina HiSeq2000, 13–16 pools were multiplexed on each lane, using custom multiplexing adapters.</p>
        <p>After each sample was sequenced and the reads demultiplexed, we obtained an average of 22.9 M, 11.3 M, 11.5 M, and 10.1 M reads per pool in HV3, HV4, HV5, and HV6, respectively, with a read length of 92 bases. Reads were quality-trimmed and cleaned of spurious sequencing adaptors, and then reads derived from <italic>E. coli</italic> contamination or the BAC vector were discarded (see <xref ref-type="supplementary-material" rid="pcbi.1003010.s002">Dataset S2</xref>). The percentage of <italic>E. coli</italic> contamination was rather high, averaging around 41%, 40%, 51%, 65% in HV3, HV4, HV5, and HV6, respectively. An alternative DNA purification method we used for HV3 showed the potential to lower amount to 8–15% if properly executed (see some of HV3 pools in <xref ref-type="supplementary-material" rid="pcbi.1003010.s002">Dataset S2</xref>, column I). The average number of usable reads after trimming and cleaning was about 13.5 M, 6.8 M, 5.5 M, and 3.6 M per pool in HV3, HV4, HV5, and HV6, respectively, with an average high quality read length of 87–89 bases. The number of reads in the set of 91 pools ranged between about 4.2 M–27.7 M in HV3, 2.9 M–17 M in HV4, 2.5 M–11.3 M in HV5, and 1.6 M–15 M in HV6. The total number of reads was about 1229 M, 620 M, 503 M, and 327 M in HV3, HV4, HV5, and HV6, respectively, for a total of about 109.1T, 54.9T, 44.8T, and 28.5T usable bases, respectively.</p>
        <p>The 91 read pools in the barley datasets were processed using the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e202" xlink:type="simple"/></inline-formula>-mer based algorithm (HashFilter with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e203" xlink:type="simple"/></inline-formula> = 26) described in the <xref ref-type="sec" rid="s2">Materials and Methods</xref> section. The computation took slightly longer than on the analogous rice dataset (i.e., about 363 minutes on one core of a Dell PowerEdge T710 server to build the hash table for HV5), but used less memory (i.e., about 43 Gb of RAM for HV5). For HV5, the deconvolution phase took 169 minutes on 10 cores, and the sorting of reads into 2,197 BAC files took 37 minutes on one core. Due to the higher repeat content of the barley genome compared to rice, we were able to deconvolute a smaller fraction of the barley reads, about 68.14% for HV3, 59.9% for HV4, 71.3% for HV5, and 58% for HV6 (see <xref ref-type="supplementary-material" rid="pcbi.1003010.s011">Tables S3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003010.s012">S4</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003010.s013">S5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003010.s014">S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003010.s003">Dataset S3</xref>). <xref ref-type="fig" rid="pcbi-1003010-g003">Figure 3-(c) and (d)</xref> illustrate the distribution of signature sizes for all the distinct <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e204" xlink:type="simple"/></inline-formula>-mers and for all reads in HV5. As expected, the number of reads occurring in over 80 pools is much higher for barley than for rice. After deconvolution, the total number of usable bases was about 97.9T for HV3 (about 90% of the bases before deconvolution), 34.6T for HV4 (about 63%), 38.9T for HV5 (about 87%), and 19.3T for HV6 (about 68%), which translated to an average sequencing depth of coverage for each BAC of about 431x in HV3, 134x in HV4, 137x in HV5, and 72x in HV6 (see <xref ref-type="supplementary-material" rid="pcbi.1003010.s004">Dataset S4</xref>).</p>
        <p>On the set HV5, we tested HashFilter for different choices of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e205" xlink:type="simple"/></inline-formula>-mer. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e206" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e207" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e208" xlink:type="simple"/></inline-formula>, the memory used by HashFilter was about 35 GB, 40 GB, and 48 GB, respectively (compared to 43 Gb of RAM for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e209" xlink:type="simple"/></inline-formula>). On one CPU core, the time to build the hash table was about 323 minutes for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e210" xlink:type="simple"/></inline-formula>, 338 minutes for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e211" xlink:type="simple"/></inline-formula>, and 915 minutes for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e212" xlink:type="simple"/></inline-formula>, compared to 363 minutes for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e213" xlink:type="simple"/></inline-formula>. On ten CPU cores, the overlap phase took 108 minutes for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e214" xlink:type="simple"/></inline-formula>, 165 minutes for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e215" xlink:type="simple"/></inline-formula>, and 244 minutes for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e216" xlink:type="simple"/></inline-formula>, compared to 169 minutes for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e217" xlink:type="simple"/></inline-formula>. In terms of the number of reads deconvoluted, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e218" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e219" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e220" xlink:type="simple"/></inline-formula>, we deconvoluted 62.2%, 68.2%, and 73.6% of the reads in HV5, respectively (compared to 71.3% when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e221" xlink:type="simple"/></inline-formula> – see <xref ref-type="supplementary-material" rid="pcbi.1003010.s003">Dataset S3</xref> for more details).</p>
        <p>We have collected strong evidence that the deconvolution accuracy was quite high in barley. For instance, six BACs that were assigned less than 20 reads in HV5 were noted as not growing during the pooling (for a video of the pooling see <xref ref-type="supplementary-material" rid="pcbi.1003010.s015">Video S1</xref>). For two HV sets, we realized that we erroneously swapped two adjacent pools after noticing that the percentage of deconvoluted reads for those pools was significant lower than the average. Later we confirmed the swap by mapping the reads in those pools to the unigenes that were known to be present in the pooled BACs. During the same investigation, we also assessed how the overall percentage of deconvolution would be affected if one pool was missing. We removed all the reads in a pool of HV3, and re-executed the deconvolution algorithm: the number of deconvoluted reads decreased by less than 0.5%, a very small loss considering that an entire pool was removed. We also carried out an analysis of deconvoluted paired-end reads for HV5 to determine to what extent the left and the right mate agreed on their BAC(s) assignment. The deconvolution treated paired-end reads as two separate single-end reads, which were processed independently. For each paired-end read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e222" xlink:type="simple"/></inline-formula>, we collected in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e223" xlink:type="simple"/></inline-formula> the set of BACs assigned to the left mate, and in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e224" xlink:type="simple"/></inline-formula> the set of BACs assigned to the right mate. Unless <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e225" xlink:type="simple"/></inline-formula>, we declared the paired-end read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e226" xlink:type="simple"/></inline-formula> to be <italic>concordant</italic> when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e227" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e228" xlink:type="simple"/></inline-formula>. For barley HV5, 68.7% of the deconvoluted paired-end reads were concordant, which indicates that the deconvolution was quite accurate (see the second sheet in <xref ref-type="supplementary-material" rid="pcbi.1003010.s003">Dataset S3</xref>).</p>
        <p>We assembled each set of reads assigned to a BAC using V<sc>elvet</sc> <xref ref-type="bibr" rid="pcbi.1003010-Zerbino1">[24]</xref> for a variety of choices of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e229" xlink:type="simple"/></inline-formula>-mer size. From the assemblies obtained for different choices of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e230" xlink:type="simple"/></inline-formula>, we decided to report in <xref ref-type="supplementary-material" rid="pcbi.1003010.s004">Dataset S4</xref> the assembly that maximized the N50. If we average the assembly statistics over the 2,197 BACs, the number of deconvoluted reads used in the assemblies was 84% in HV3, 86% in HV4, 87.6% in HV5, and 83.2% in HV6 indicating that V<sc>elvet</sc> took advantage of most of the data; the average N50 was 8,190 bp in HV3 (7.0% of the average BAC length in that set), 5,883 bp in HV4 (4.65% of the average BAC length), 7,210 bp in HV5 (5.6% of the average BAC length), and 6,032 in HV6 (4.67% of the average BAC length); the average longest contig was 18,958 bp in HV3, 15,674 bp in HV4, 19,222 bp in HV5, and 16,018 in HV6; the average sum of all the contigs in each assembly was 104,578 bp in HV3 (89.8% of the average BAC length in that set), 102,502 bp in HV4 (81.5% of the average BAC length), 113,678 bp in HV5 (87.8% of the average BAC length), and 98,087 bp in HV6 (75.9% of the average BAC length).</p>
        <p>Barley BAC assemblies were compared against BAC-unigene lists obtained using the Illumina GoldenGate oligonucleotide pool assay (OPA) <xref ref-type="bibr" rid="pcbi.1003010-Fan1">[33]</xref> developed for barley <xref ref-type="bibr" rid="pcbi.1003010-Close1">[27]</xref>. We used the Illumina OPAs on the same four, and three additional, sets of barley pools described above (637 pools in total) and determined which BAC clones were positive for two sets of 1,536 marker loci/unigenes (see <xref ref-type="sec" rid="s2">Materials and Methods</xref> for details). The Illumina OPAs allowed us to map a total of 1,849 unique unigenes to BACs (estimated error rate of 5%, see <xref ref-type="sec" rid="s2">Materials and Methods</xref> for details). <xref ref-type="supplementary-material" rid="pcbi.1003010.s009">Table S1</xref> summarizes the results of unigene-BAC and BAC-unigene assignment broken down by chromosome and chromosome arms, whereas <xref ref-type="supplementary-material" rid="pcbi.1003010.s006">Dataset S6</xref> contains all the solved BAC-unigene relationships along with their chromosomal location.</p>
        <p>Analysis of the assembly of the 2,197 barley BACs in each of the HV3–HV6 sets was carried out by assuming the results of the OPA as the “ground truth”, although the Illumina OPA assay has an estimated error rate of 5%. For instance in HV5 we extracted a total of 221 marker loci/unigenes that were mapped to a total of 202 distinct BACs. We obtained the sequence of these 221 unigenes from Harvest (<ext-link ext-link-type="uri" xlink:href="http://harvest.ucr.edu" xlink:type="simple">http://harvest.ucr.edu</ext-link>) and Blast-ed them against the HV5 BAC contigs. Out of 202 BACs that were expected to contain those genes, only 20 BAC assemblies (10%) missed the expected marker loci/unigenes (see <xref ref-type="supplementary-material" rid="pcbi.1003010.s004">Dataset S4</xref>). For the other 90% of the assemblies which contained the expected unigenes, the average coverage of those unigenes was about 90% of their length. Similar results were obtained from the HV3, HV4, and HV6 sets (see <xref ref-type="supplementary-material" rid="pcbi.1003010.s004">Dataset S4</xref>). This analysis suggests that these BAC assemblies contain the majority of the barley genes, which is the main objective of this work.</p>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>The challenges of <italic>de novo</italic> sequence assembly originate from a variety of issues, but two are the most prominent. First, sequencing instruments are not 100% accurate, and sequencing errors in the form of substitutions, insertion, or deletions complicate the detection of overlaps between reads. Sequencing errors can be detected and potentially corrected when the sequencing depth is sufficient (see, e.g., <xref ref-type="bibr" rid="pcbi.1003010-Yang1">[34]</xref>). Second, a very large fraction of eukaryotic genomes is composed of repetitive elements. During the assembly process, reads that belong to those repetitive regions get <italic>over-compressed</italic> which in turns lead to mis-assemblies <xref ref-type="bibr" rid="pcbi.1003010-Treangen1">[35]</xref>. To cope with the problems caused by repeats, two strategies have been proposed: <italic>paired-end</italic> and <italic>clone-by-clone</italic> sequencing. In paired-end sequencing, pairs of reads are obtained from both ends of inserts of various sizes <xref ref-type="bibr" rid="pcbi.1003010-Roach1">[36]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Weber1">[37]</xref>. Paired-end reads resolve repeats during assembly simply by jumping across them (abandoning the effort to fully resolve them) and disambiguating the ordering of flanking unique regions. In clone-by-clone sequencing, chunks of the genome (100–150 kb) are cloned, typically in BACs, and then reads are obtained independently from each clone <xref ref-type="bibr" rid="pcbi.1003010-Green1">[38]</xref>. Sequences that are repetitive in the context of the whole genome are more likely to have only a single copy in a given BAC, which increases the fraction of the BAC that can be assembled. Sequencing technologies based on flow cells have significantly reduced the cost of of generating raw sequence data, but, with the exception of Roche/454 and Ion Torrent (each of which suffers from a homopolymer issue), the reads are much shorter than Sanger reads. Shorter read length makes the problem of <italic>de novo</italic> genome assembly significantly harder: the shorter a read is, the more likely it is repetitive in its entirety <xref ref-type="bibr" rid="pcbi.1003010-Treangen1">[35]</xref>.</p>
      <p>The major technical hurdle for a clone-by-clone approach is the limitation of these instruments in handling hundreds or thousand of BACs in a way that would allow reads to be assigned back to their source. DNA barcoding can be used (see e.g., <xref ref-type="bibr" rid="pcbi.1003010-Kircher1">[1]</xref>), but the process of preparing thousands of barcoded libraries for sequencing is very labor-intensive and expensive. Here, we have demonstrated an efficient alternative to barcoding: by encoding the “signature” of a BAC in the unique set of pools to which it is assigned, reads originating to that BAC will also share the same signature; this enables their deconvolution to the original BAC. We note that our deconvolution method does not require paired-end data, although such type of reads is desirable for the assembly.</p>
      <p>Experimental results on simulated data for rice and actual sequencing data for barley show that our pooling-based clone-by-clone approach can be carried out effectively on short-read sequencing instruments. Our method deconvolutes reads to single BACs with very high accuracy (97.86% on rice), and as a consequence the assemblies of the resulting BAC clones are of high quality. For the synthetic data (containing 1% sequencing errors) on the rice genome, we were able to reconstruct on average 77% of the BAC content. On the barley data, we successfully assembled 90% of the expected unigenes, with an average coverage of the unigenes of nearly 90%. This amount of sequence is sufficient for a wide range of practical purposes such as map-based cloning and nearby marker development for marker-assisted breeding.</p>
      <p>We are aware of the limitations of our approach, namely (1) the need for a physical map, (2) the significance of <italic>E. coli</italic> contamination, (3) the inability of the deconvolution algorithm to deal with repetitive reads (i.e., reads that appear in more than three BACs or twenty-one pools in our pooling design), and (4) the deleterious effect of sequencing errors on the deconvolution. Issue (1) can be quite limiting, although for many economically or ecologically important organisms several research groups and international consortia have produced clone libraries and physical maps. One can address (2) by alternative, more expensive BAC DNA purification procedures that are expected to reduce <italic>E. coli</italic> contamination to less than 10%, which we tested on the HV3 set with promising results. One should keep in mind, however, that this approach might not be more cost-effective than simply generating more sequencing data. Somewhat related to this problem is the variability in sequencing quality among pools: one of the anonymous reviewers suggested that one could use <italic>E. coli</italic> reads to establish a quality metric for the sequencing step of each individual pool of BACs. Regarding (3), we speculate that the removal of “ubiquitous” reads from the BAC assembly might not significantly affect the quality of the assembly, because even if these highly-repetitive reads were assigned to the correct BAC the assembler would not be able to assemble them. We do not have, however, data to support this claim. In the future we will consider assembling all reads in a pool that do not deconvolute, then adding the resulting contigs to the BAC contigs during the merging step. Finally, to address (4), observe that the presence of one sequencing error in a read affects at most <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e231" xlink:type="simple"/></inline-formula> consecutive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e232" xlink:type="simple"/></inline-formula>-mers overlapping the error. These erroneous <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e233" xlink:type="simple"/></inline-formula>-mers are likely to occur in a small number of pools (fewer than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e234" xlink:type="simple"/></inline-formula>): observe for instance in <xref ref-type="fig" rid="pcbi-1003010-g003">Figure 3-(a)</xref> and <xref ref-type="fig" rid="pcbi-1003010-g003">Figure 3-(c)</xref> a rather large number of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e235" xlink:type="simple"/></inline-formula>-mers appearing in 1–6 pools. One could then design an error-correcting method that attempts to correct sets of consecutive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e236" xlink:type="simple"/></inline-formula>-mers that appear in fewer than seven pools. Error-correction and deconvolution are mutually dependent: correcting the reads will help the deconvolution, which in turns will lead to further error-correction. Due to this mutual dependency, the accuracy of the deconvolution algorithm could be also improved by a multi-stage approach where one initially assign high-quality reads to BACs, then use these assignments to conservatively correct a portion of the reads, which in turns will allow to deconvolute more reads, and so forth, until a fixed point is reached. Additionally, the process of correcting the reads will simplify the assembly process, which is expected to produce more accurate assemblies.</p>
      <p>To summarize the trade-offs between the target size (e.g., BACs, set of BACs, whole genome), sequencing depth, and the number/size of assembled contigs, we collected a set of critical assembly statistics in <xref ref-type="table" rid="pcbi-1003010-t001">Table 1</xref>. The first two rows contain average BAC assemblies statistics for rice data, assuming perfect deconvolution or deconvolution via our tool H<sc>ash</sc>F<sc>ilter</sc>, then assembled with V<sc>elvet</sc>. Average assembly statistics for a single BAC of barley HV3–HV6 are reported on rows 5–8. The third and ninth row represent the average statistics obtained by assembling all the reads in each pool of 169 BACs of rice and barley HV5, respectively, using V<sc>elvet</sc> with the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e237" xlink:type="simple"/></inline-formula>-mer size that maximized the N50 (see <xref ref-type="supplementary-material" rid="pcbi.1003010.s005">Dataset S5</xref>). We wanted to use V<sc>elvet</sc> for all the assemblies because it can track reads and gives accurate statistics about the number of reads used in the assembly, but it cannot efficiently handle very large datasets of reads. For the other rows in the table we had to use SOAP<sc>denovo</sc> <xref ref-type="bibr" rid="pcbi.1003010-Li2">[25]</xref>, however V<sc>elvet</sc> and SOAP<sc>denovo</sc> can be considered comparable in terms of assembly performance <xref ref-type="bibr" rid="pcbi.1003010-Salzberg1">[39]</xref>, <xref ref-type="bibr" rid="pcbi.1003010-Earl1">[40]</xref>. The fourth and tenth row report the assembly of all the reads in the 91 pools for rice and barley HV5, respectively, using SOAP<sc>denovo</sc> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e238" xlink:type="simple"/></inline-formula>. Finally, the last row reports the statistics of a 31x whole-shotgun assembly of the barley genome using SOAP<sc>denovo</sc> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e239" xlink:type="simple"/></inline-formula> (see <xref ref-type="sec" rid="s2">Materials and Methods</xref> for details about the data).</p>
      <table-wrap id="pcbi-1003010-t001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1003010.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Summary of the statistics of the various assemblies obtained using V<sc>elvet</sc> (rows 1–3, 5–9) and SOAP<sc>denovo</sc> (rows 4, 10, 11).</title>
        </caption>
        <alternatives>
          <graphic id="pcbi-1003010-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003010.t001" xlink:type="simple"/>
          <table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>Target</italic>
                </td>
                <td align="left" rowspan="1" colspan="1"><italic>Size</italic> (Mb)</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>Seq. depth</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>% reads used</italic>
                  <xref ref-type="table-fn" rid="nt104">c</xref>
                </td>
                <td align="left" rowspan="1" colspan="1"><italic>N50</italic> (bp)</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>% Sum</italic>
                </td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Rice – 1 BAC (perfect deconvolution)<xref ref-type="table-fn" rid="nt102">a</xref></td>
                <td align="left" rowspan="1" colspan="1">0.151</td>
                <td align="left" rowspan="1" colspan="1">56x</td>
                <td align="left" rowspan="1" colspan="1">82.7%</td>
                <td align="left" rowspan="1" colspan="1">132,865</td>
                <td align="left" rowspan="1" colspan="1">98.7%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Rice – 1 BAC (H<sc>ash</sc>F<sc>ilter</sc> deconvolution)<xref ref-type="table-fn" rid="nt102">a</xref></td>
                <td align="left" rowspan="1" colspan="1">0.151</td>
                <td align="left" rowspan="1" colspan="1">87x</td>
                <td align="left" rowspan="1" colspan="1">82.3%</td>
                <td align="left" rowspan="1" colspan="1">47,551</td>
                <td align="left" rowspan="1" colspan="1">90.7%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Rice – 169 BACs (no deconvolution)<xref ref-type="table-fn" rid="nt103">b</xref></td>
                <td align="left" rowspan="1" colspan="1">26</td>
                <td align="left" rowspan="1" colspan="1">56x</td>
                <td align="left" rowspan="1" colspan="1">83.2%</td>
                <td align="left" rowspan="1" colspan="1">4,236</td>
                <td align="left" rowspan="1" colspan="1">73.1%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Rice – 2,197 BACs (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e240" xlink:type="simple"/></inline-formula>, no deconvolution)</td>
                <td align="left" rowspan="1" colspan="1">332</td>
                <td align="left" rowspan="1" colspan="1">56x</td>
                <td align="left" rowspan="1" colspan="1">5.9%</td>
                <td align="left" rowspan="1" colspan="1">1,148</td>
                <td align="left" rowspan="1" colspan="1">30.6%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Barley HV3 – 1 BAC (H<sc>ash</sc>F<sc>ilter</sc> deconvolution)<xref ref-type="table-fn" rid="nt102">a</xref></td>
                <td align="left" rowspan="1" colspan="1">0.116</td>
                <td align="left" rowspan="1" colspan="1">431x</td>
                <td align="left" rowspan="1" colspan="1">83.6%</td>
                <td align="left" rowspan="1" colspan="1">8,190</td>
                <td align="left" rowspan="1" colspan="1">89.8%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Barley HV4 – 1 BAC (H<sc>ash</sc>F<sc>ilter</sc> deconvolution)<xref ref-type="table-fn" rid="nt102">a</xref></td>
                <td align="left" rowspan="1" colspan="1">0.125</td>
                <td align="left" rowspan="1" colspan="1">134x</td>
                <td align="left" rowspan="1" colspan="1">86.0%</td>
                <td align="left" rowspan="1" colspan="1">5,883</td>
                <td align="left" rowspan="1" colspan="1">81.5%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Barley HV5 – 1 BAC (H<sc>ash</sc>F<sc>ilter</sc> deconvolution)<xref ref-type="table-fn" rid="nt102">a</xref></td>
                <td align="left" rowspan="1" colspan="1">0.129</td>
                <td align="left" rowspan="1" colspan="1">137x</td>
                <td align="left" rowspan="1" colspan="1">87.6%</td>
                <td align="left" rowspan="1" colspan="1">7,210</td>
                <td align="left" rowspan="1" colspan="1">87.8%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Barley HV6 – 1 BAC (H<sc>ash</sc>F<sc>ilter</sc> deconvolution)<xref ref-type="table-fn" rid="nt102">a</xref></td>
                <td align="left" rowspan="1" colspan="1">0.129</td>
                <td align="left" rowspan="1" colspan="1">72x</td>
                <td align="left" rowspan="1" colspan="1">83.2%</td>
                <td align="left" rowspan="1" colspan="1">6,032</td>
                <td align="left" rowspan="1" colspan="1">75.9%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Barley HV5 — 169 BACs (no deconvolution)<xref ref-type="table-fn" rid="nt103">b</xref></td>
                <td align="left" rowspan="1" colspan="1">22</td>
                <td align="left" rowspan="1" colspan="1">26x</td>
                <td align="left" rowspan="1" colspan="1">67.1%</td>
                <td align="left" rowspan="1" colspan="1">4,270</td>
                <td align="left" rowspan="1" colspan="1">69.5%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Barley HV5 – 2,197 BACs (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e241" xlink:type="simple"/></inline-formula>, no deconvolution)</td>
                <td align="left" rowspan="1" colspan="1">286</td>
                <td align="left" rowspan="1" colspan="1">180x</td>
                <td align="left" rowspan="1" colspan="1">25.3%</td>
                <td align="left" rowspan="1" colspan="1">3,845</td>
                <td align="left" rowspan="1" colspan="1">56.6%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Barley – whole genome (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e242" xlink:type="simple"/></inline-formula>)</td>
                <td align="left" rowspan="1" colspan="1">5,300</td>
                <td align="left" rowspan="1" colspan="1">31x</td>
                <td align="left" rowspan="1" colspan="1">13.3%</td>
                <td align="left" rowspan="1" colspan="1">2,857</td>
                <td align="left" rowspan="1" colspan="1">30.5%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>“% Sum” is the the sum of all contig sizes as percentage of the target size;</p>
          </fn>
          <fn id="nt102">
            <label>a</label>
            <p>average over 2,197 assemblies;</p>
          </fn>
          <fn id="nt103">
            <label>b</label>
            <p>average over 91 assemblies;</p>
          </fn>
          <fn id="nt104">
            <label>c</label>
            <p>V<sc>elvet</sc> reports the number of reads used in the assembly but SOAP<sc>denovo</sc> does not: for these assemblies we used B<sc>owtie</sc> (allowing one mismatch) to align reads to the contigs.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>An analysis of the statistics reported in <xref ref-type="table" rid="pcbi-1003010-t001">Table 1</xref> clearly show that as the complexity of the target sequence increases from one BAC to the whole genome, both the N50 and the percentage of reads used by the assembler decrease, as does the sum of all contig sizes as a fraction of the target size. This indicates that the effectiveness of the assembler decreases as the complexity of the assembly problem increases. Similar conclusions were reported in <xref ref-type="bibr" rid="pcbi.1003010-Haiminen1">[41]</xref>, where the assembly of pools of BACs were of significantly better quality than shotgun assemblies of <italic>Arabidopsis</italic>. While we are not advocating to abandon the whole genome shotgun approach in favor of clone-based sequencing, there is clearly an opportunity to combine the advantages of BAC-by-BAC and whole genome shotgun assemblies. This synergistic step could represent a significant advance in solving the problem of obtaining a high quality assemblies for large, highly repetitive genomes.</p>
      <sec id="s4a">
        <title>Description of additional data files and software</title>
        <p>Barley raw sequencing data for the barley BAC set can be obtained from NCBI Sequence Read Archive accession numbers SRA051771 and SRA051780 (HV3), SRA051535 (HV4), SRA047913 (HV5) and SRA050074 (HV6). When all the BAC assemblies will be complete, we will make them available in H<sc>arvest</sc>:B<sc>arley</sc> (<ext-link ext-link-type="uri" xlink:href="http://harvest.ucr.edu" xlink:type="simple">http://harvest.ucr.edu</ext-link>) and G<sc>en</sc>B<sc>ank</sc> (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/genbank/" xlink:type="simple">http://www.ncbi.nlm.nih.gov/genbank/</ext-link>). The current set of HV3, HV4, HV5, and HV6 BAC assembly as well as the 31x shotgun genome assembly of barley can be accessed via our B<sc>last</sc> server hosted at the address <ext-link ext-link-type="uri" xlink:href="http://www.harvest-blast.org/" xlink:type="simple">http://www.harvest-blast.org/</ext-link>, by selecting “Morex Barley BACs” or “Barley Genome” from the database menu. These assemblies can also be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.harvest-web.org/utilmenu.wc" xlink:type="simple">http://www.harvest-web.org/utilmenu.wc</ext-link>. The source code of H<sc>ash</sc>F<sc>ilter</sc> is available from <ext-link ext-link-type="uri" xlink:href="http://www.cs.ucr.edu/stelo/hashfilter/under" xlink:type="simple">http://www.cs.ucr.edu/stelo/hashfilter/under</ext-link> the GNU General Public License. H<sc>ash</sc>F<sc>ilter</sc> runs under Linux or MacOS.</p>
        <p>Additional data are available with the online version of this paper.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1003010.s001" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s001" position="float" xlink:type="simple">
        <label>Dataset S1</label>
        <caption>
          <p>Excel file Dataset_S1 contains the pool-by-pool statistics of the number of rice reads deconvoluted to one BAC (column C), two BACs (column D), and three BACs (column E), as well as the percentage of reads deconvoluted as a fraction of the total number of reads in each pool (column F). Columns G-K report the paired-end read analysis: for each paired-end read (total is column G), we looked at the set of BACs assigned to the left read (set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e243" xlink:type="simple"/></inline-formula>) and the right read (set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e244" xlink:type="simple"/></inline-formula>) via deconvolution. The number of paired-end reads for which at least one of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e245" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e246" xlink:type="simple"/></inline-formula> were non-empty is reported in column I. Of these, we compared <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e247" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e248" xlink:type="simple"/></inline-formula>: if the number of shared BACs in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e249" xlink:type="simple"/></inline-formula> was equal to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e250" xlink:type="simple"/></inline-formula> we declared that paired-end read <italic>concordant</italic>. Column J reports the number of concordant deconvoluted paired-end reads.</p>
          <p>(XLSX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s002" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s002" position="float" xlink:type="simple">
        <label>Dataset S2</label>
        <caption>
          <p>Excel file Dataset_S2 contains the statistics of number of reads and bases at each step of the cleaning process for sets HV3, HV4, HV5 and HV6.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s003" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s003" position="float" xlink:type="simple">
        <label>Dataset S3</label>
        <caption>
          <p>Excel file Dataset_S3 contains the pool-by-pool statistics of the number of barley HV3, HV4, HV5 and HV6 reads deconvoluted to one BAC (column C), two BACs (column D), and three BACs (column E), as well as the percentage of reads deconvoluted as a fraction of the total number of reads in each pool (column F). For the HV5 tab, columns G-L reports on the paired-end read analysis: for each paired-end read (total is column H – obtained by subtracting the single reads from each pool), we looked at the set of BACs assigned to the left read (set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e251" xlink:type="simple"/></inline-formula>) and the right read (set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e252" xlink:type="simple"/></inline-formula>) via deconvolution. The number of paired-end reads for which at least one of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e253" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e254" xlink:type="simple"/></inline-formula> were non-empty is reported in column J. Of these, we compared <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e255" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e256" xlink:type="simple"/></inline-formula>: if the number of shared BACs in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e257" xlink:type="simple"/></inline-formula> was equal to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e258" xlink:type="simple"/></inline-formula> we declared that paired-end read <italic>concordant</italic>. Column K reports the number of concordant deconvoluted paired-end reads.</p>
          <p>(XLSX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s004" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s004" position="float" xlink:type="simple">
        <label>Dataset S4</label>
        <caption>
          <p>Excel file Dataset_S4 contains eight tables/sheets (two for rice, two tabs for barley HV3, two tabs for barley HV4, two for barley HV5, and two for barley HV6). The first sheet contains rice BAC data before and after deconvolution (columns A–H), assembly statistics (columns I–S), and Blast results (columns T–Y). Columns A–B are self-explanatory. Column C shows the list of pools where that BAC was assigned (called <italic>BAC signature</italic>). Column D shows the number of reads generated <italic>in silico</italic> for each rice BAC, column E is the actual size of the BAC, column F reports the number of reads deconvoluted to that BAC, column G the number of reads correctly deconvoluted, and column H the percentage of the reads correctly deconvoluted. A read is “correctly deconvoluted” if the list of BACs to which it has been assigned contains the BAC from where it was generated. Columns I–S report the results of running Velvet on the deconvoluted reads, BAC-by-BAC. For each BAC, ten choices of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e259" xlink:type="simple"/></inline-formula>-mer were tested, in the range [25,79] with a step of 6. The spreadsheet reports only the assembly that maximized the N50. This is an arbitrary choice that does not guarantee the “best” overall assembly. Column titled “K” shows the value of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e260" xlink:type="simple"/></inline-formula>-mer in the range which maximized the N50. Column “Cnt” shows the number of contigs produced by Velvet. Column “Used” reports the fraction of the reads used by Velvet. “Med”, “Mean”, “n50”, “max” show the median, mean, n50 and max contig size, respectively. Column “Sum” is the sum of the size of all contigs/scaffolds. “n50/Sz” and “Sum/Sz” report the size of the n50 and the sum over the expected BAC size. “Ns” report the total size of gaps in the scaffolds. Finally, columns T–Y report the results of Blast-ing the assembly (contigs) to the actual BAC sequences. Column “HSPs” is the number of high scoring segment pairs, column “Covg” shows the percentage of BAC covered by the contigs of the assembly, column “Gaps” reports the number of gaps (i.e., regions of the BAC not covered by any contig), column “AvgGap” is the average length of gaps, column “Overlaps” shows the number of regions where several HSPs overlap (i.e., portions of the BAC covered more than once), and column “AvgOvr” is the average length of the overlaps. The parameters used for Blast are: Expect threshold = 0.001, Align limit = 10, Best hit overhang = 0.1, and Best hit score edge = 0.1; for parsing the Blast results we used Align limit = 1, HSP limit = 10, and Min length = 100. The second sheet contains the assembly statistics for rice BAC data, assuming that reads are mapped to their original BAC with 100% yield and accuracy. Please refer to the previous description for an explanation of the column contents. The next six tables/sheets are two pairs each for HV3, HV4, HV5, and HV6, respectively. The sheet called “Assembly Stats” shows BAC and assembly statistics for each of the 2,197 BACS in the HV3–6 sets. The first set of columns (A–G) refer to the barley BAC stats. Columns A-C are self-explanatory (column B shows the list of pools where that BAC was assigned, called <italic>BAC signature</italic>). Column “Size Estim” is the expected BAC size, estimated from the number of bands in the fingerprinting data. “Reads” contain the number of reads mapped to that BAC, “Bases” is the total number of bases, and “Covg” is the expected coverage. The next set of columns (H–M) refer to V<sc>elvet</sc>'s assembly statistics. For each BAC, ten choices of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e261" xlink:type="simple"/></inline-formula>-mer were tested in the range [25,79] with a step of 6. The spreadsheet reports only the assembly that maximized the N50. Column titled “K” shows the value of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e262" xlink:type="simple"/></inline-formula>-mer in the range which maximized the N50. Column “Cnt” shows the number of contigs produced by V<sc>elvet</sc>. Column “Used” reports the fraction of the reads used by V<sc>elvet</sc>. “Med”, “Mean”, “n50”, “max” show the median, mean, n50 and max contig size, respectively. Column “Sum” is the sum of the size of all contigs/scaffolds. “n50/Sz” and “Sum/Sz” report the size of the n50 and the sum over the expected BAC size. “Ns” report the total size of gaps in the scaffolds. The next set of columns (S–V) report the results of B<sc>last</sc>-ing U35 unigenes (Harvest:Barley assembly #35 unigenes, <ext-link ext-link-type="uri" xlink:href="http://harvest.ucr.edu" xlink:type="simple">http://harvest.ucr.edu</ext-link>) against the BAC assemblies. We used B<sc>last</sc>N with e-value threshold 1e-20. To reduce spurious hits, we applied three filters (see <xref ref-type="sec" rid="s2">Materials and Methods</xref> for details). Column “Hits” shows the number of unigenes hitting that BAC – note that some BACs can be hit by a set of unigenes from a multi-gene family so the count can be high. For a small set of BACs, we knew in advance which unigenes they contained (via Illumina OPA): those are listed in the “expected” column. Column “observed” reports the number of expected unigenes that were actually observed. For the set of expected unigenes, we computed the fraction of those unigenes covered by the contigs (reported in column “AvgExpectedCovg”). The second table/tab (called “U35 unigenes hits by BACS”) shows the same results of BLAST-ing U35 unigenes to BAC assemblies from the viewpoint of unigenes. Here, each row is a U35 unigene: we report the total number of BACs hits by that unigene, the expected number of hits (based on the OPA) and the observed number of hits.</p>
          <p>(XLSX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s005" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s005" position="float" xlink:type="simple">
        <label>Dataset S5</label>
        <caption>
          <p>Excel file Dataset_S5 contains the Velvet assembly statistics for each individual pool of 169 BACs for the set HV5 in barley. For each pool, ten choices of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e263" xlink:type="simple"/></inline-formula>-mer were tested in the range [25,79] with a step of 6. The spreadsheet reports only the assembly that maximized the N50. Column titled “K” shows the value of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003010.e264" xlink:type="simple"/></inline-formula>-mer in the range which maximized the N50. Column “Cnt” shows the number of contigs produced by Velvet. Column “Used” reports the fraction of the reads used by Velvet. “Med”, “Mean”, “n50”, “max” show the median, mean, n50 and max contig size, respectively. Column “Sum” is the sum of the size of all contigs/scaffolds. “n50/Sz” and “Sum/Sz” report the size of the n50 and the sum over the expected BAC size. “Ns” report the total size of gaps in the scaffolds.</p>
          <p>(XLSX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s006" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s006" position="float" xlink:type="simple">
        <label>Dataset S6</label>
        <caption>
          <p>Excel file Dataset_S6 contains the list of all 3104 solved BAC-unigene relationships. Column A: BAC address in <xref ref-type="bibr" rid="pcbi.1003010-Yu1">[31]</xref> library. First four digits are plate number (0001–0816). Letter is row (A–P). Last two digits are column (01–24). Column B: POPA is SNP namein PilotOPA (1–3) format, as per <xref ref-type="bibr" rid="pcbi.1003010-Close1">[27]</xref>. Column C: BOPA_C is SNP name in concatenated barley production OPA format, as per <xref ref-type="bibr" rid="pcbi.1003010-Close1">[27]</xref>. Column D: POPA12_SNP is the original SNP name from the SNP information provider, as per <xref ref-type="bibr" rid="pcbi.1003010-Close1">[27]</xref>. Column E: POPA3_SNP is the original SNP name from the SNP information provider, as per <xref ref-type="bibr" rid="pcbi.1003010-Close1">[27]</xref>. Column F: U35 is HarvEST:Barley assembly 35 unigene number corresponding the SNP locus. Column G: MTP is the set of minimal tiling path clones (1–9). Column H: LG_2009 is the linkage group (chromosome) assignment reported on <xref ref-type="bibr" rid="pcbi.1003010-Close1">[27]</xref>. Column I: cM_2009 is the centiMorgan position reported in <xref ref-type="bibr" rid="pcbi.1003010-Close1">[27]</xref>. Column J: cM_2011 is the centiMorgan position reported in <xref ref-type="bibr" rid="pcbi.1003010-Close1">[27]</xref>. Column K: LG_Arm is the linkage group and arm reported in <xref ref-type="bibr" rid="pcbi.1003010-MuozAmatrian1">[28]</xref>. Column L: Sort indicates the chromosome and arm determined using flow sorted materials as per <xref ref-type="bibr" rid="pcbi.1003010-MuozAmatrian1">[28]</xref>. Column M: Luo indicates FPC contig of MingCheng Luo on <ext-link ext-link-type="uri" xlink:href="http://phymap.ucdavis.edu/barley/" xlink:type="simple">http://phymap.ucdavis.edu/barley/</ext-link>. Column N: Bozdag indicates the compartmentalized FPC contig of Serdar Bozdag on <ext-link ext-link-type="uri" xlink:href="http://phymap.ucdavis.edu/barley/" xlink:type="simple">http://phymap.ucdavis.edu/barley/</ext-link>.</p>
          <p>(XLSX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s007" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s007" position="float" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p>A screenshot of a successful gene detection. In this example, the gene is found in only one BAC. Consequently, seven pools that contains this BAC are positive (blue dots). Morex barley whole genome DNA served as positive control (triplicate, green dots). <italic>E. coli</italic> DNA served as negative control (duplicate, gold dots).</p>
          <p>(EPS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s008" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s008" position="float" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p>Overlap distribution between rice BACs: the x-axis represents the size of the overlap (in bp), the y-axis the number of BACs with that overlap.</p>
          <p>(EPS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s009" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s009" position="float" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <p>Chromosomal distribution of unigenes (assembly #35) contained in BACs (black numbers), and BACs containing unigenes (red numbers), according to GoldenGate assays.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s010" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s010" position="float" xlink:type="simple">
        <label>Table S2</label>
        <caption>
          <p>Number of rice reads per pool deconvoluted to one, two, or three BACs; the percentage column reports the fraction of the total number of reads that were deconvoluted to at least one BAC, and the total number of correct reads.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s011" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s011" position="float" xlink:type="simple">
        <label>Table S3</label>
        <caption>
          <p>Number of barley HV3 reads per pool deconvoluted to one, two, or three BACs; the percentage column reports the fraction of the total number of reads that were deconvoluted to at least one BAC.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s012" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s012" position="float" xlink:type="simple">
        <label>Table S4</label>
        <caption>
          <p>Number of barley HV4 reads per pool deconvoluted to one, two, or three BACs; the percentage column reports the fraction of the total number of reads that were deconvoluted to at least one BAC.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s013" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s013" position="float" xlink:type="simple">
        <label>Table S5</label>
        <caption>
          <p>Number of barley HV5 reads per pool deconvoluted to one, two, or three BACs; the percentage column reports the fraction of the total number of reads that were deconvoluted to at least one BAC.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s014" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s014" position="float" xlink:type="simple">
        <label>Table S6</label>
        <caption>
          <p>Number of barley HV6 reads per pool deconvoluted to one, two, or three BACs; the percentage column reports the fraction of the total number of reads that were deconvoluted to at least one BAC.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1003010.s015" mimetype="Video/mp4" xlink:href="info:doi/10.1371/journal.pcbi.1003010.s015" position="float" xlink:type="simple">
        <label>Video S1</label>
        <caption>
          <p>File Video_S1 shows a 75 second video of the manual pooling process. An LCD projector was mounted over a workbench to help with the manual pipetting process. The video is in MPEG-4 format (use Quicktime or VLC to play).</p>
          <p>(MP4)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank Raymond D. Fenton (UC Riverside) for assistance with BAC pooling and determining gene-BAC relationships using the Illumina GoldenGate assay, Yaniv Erlich (Whitehead Institute for Biomedical Research) and Nicolas Thierry-Mieg (TIMC-IMAG Lab) for useful comments on the manuscript, Jared Simpson (Wellcome Trust Sanger Institute) for providing help with his SGA assembler, Shiaoman Chao (USDA) and Joseph DeYoung (UC Los Angeles, Southern California Genotyping Consortium) for providing Illumina GoldenGate services, and Glenn Hicks and John Weger (UC Riverside, Institute of Integrative Genome Biology) for Illumina sequencing services. We also want to sincerely thank the anonymous reviewers for their constructive comments and suggestions that helped us improve this manuscript.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1003010-Kircher1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kircher</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Sawyer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Meyer</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>Double indexing overcomes inaccuracies in multiplex sequencing on the Illumina platform</article-title>. <source>Nucleic Acids Research</source> <volume>40</volume>: <fpage>e3</fpage>–<lpage>e3</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Alon1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alon</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Vigneault</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Eminaga</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Christodoulou</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Seidman</surname><given-names>JG</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Barcoding bias in high-throughput multiplex sequencing of miRNA</article-title>. <source>Genome Research</source> <volume>21</volume>: <fpage>1506</fpage>–<lpage>1511</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Craig1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Craig</surname><given-names>DW</given-names></name>, <name name-style="western"><surname>Pearson</surname><given-names>JV</given-names></name>, <name name-style="western"><surname>Szelinger</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sekar</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Redman</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Identification of genetic variants using bar-coded multiplexed sequencing</article-title>. <source>Nature Methods</source> <volume>5</volume>: <fpage>887</fpage>–<lpage>93</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Cai1">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cai</surname><given-names>WW</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Gibbs</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Bradley</surname><given-names>A</given-names></name> (<year>2001</year>) <article-title>A clone-array pooled strategy for sequencing large genomes</article-title>. <source>Genome Research</source> <volume>11</volume>: <fpage>1619</fpage>–<lpage>1623</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Csuros1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Csuros</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Milosavljevic</surname><given-names>A</given-names></name> (<year>2002</year>) <article-title>Pooled genomic indexing (PGI): mathematical analysis and experiment design. In: Proceedings of Workshop on Algorithms in Bioinformatics</article-title>. <source>LNCS</source> <volume>2452</volume>: <fpage>10</fpage>–<lpage>28</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Csuros2">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Csuros</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Milosavljevic</surname><given-names>A</given-names></name> (<year>2003</year>) <article-title>Clone-array pooled shotgun mapping and sequencing: design and analysis of experiments</article-title>. <source>Genome Inform</source> <volume>14</volume>: <fpage>186</fpage>–<lpage>195</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Milosavljevic1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Milosavljevic</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Harris</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Sodergren</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Jackson</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kalafus</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Pooled genomic indexing of Rhesus macaque</article-title>. <source>Genome Research</source> <volume>15</volume>: <fpage>292</fpage>–<lpage>301</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Prabhu1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Prabhu</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Pe'er</surname><given-names>I</given-names></name> (<year>2009</year>) <article-title>Overlapping pools for high-throughput targeted resequencing</article-title>. <source>Genome Research</source> <volume>19</volume>: <fpage>1254</fpage>–<lpage>1261</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Erlich1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Erlich</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Chang</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Gordon</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ronen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Navon</surname><given-names>O</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>DNA sudoku – harnessing highthroughput sequencing for multiplexed specimen analysis</article-title>. <source>Genome Research</source> <volume>19</volume>: <fpage>1243</fpage>–<lpage>1253</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Hajirasouliha1">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hajirasouliha</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Hormozdiari</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Sahinalp</surname><given-names>SC</given-names></name>, <name name-style="western"><surname>Birol</surname><given-names>I</given-names></name> (<year>2008</year>) <article-title>Optimal pooling for genome resequencing with ultra-high-throughput short-read technologies</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>i32</fpage>–<lpage>i40</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Shental1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shental</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Amir</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Zuk</surname><given-names>O</given-names></name> (<year>2010</year>) <article-title>Identification of rare alleles and their carriers using compressed se(que)nsing</article-title>. <source>Nucleic Acids Research</source> <volume>38</volume>: <fpage>e179</fpage>–<lpage>e179</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Erlich2">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Erlich</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Gordon</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Brand</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hannon</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Mitra</surname><given-names>PP</given-names></name> (<year>2010</year>) <article-title>Compressed genotyping</article-title>. <source>IEEE Transactions on Information Theory</source> <volume>56</volume>: <fpage>706</fpage>–<lpage>723</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Engler1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Engler</surname><given-names>FW</given-names></name>, <name name-style="western"><surname>Hatfield</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Soderlund</surname><given-names>CA</given-names></name> (<year>2003</year>) <article-title>Locating sequence on FPC maps and selecting a minimal tiling path</article-title>. <source>Genome Research</source> <volume>13</volume>: <fpage>2152</fpage>–<lpage>2163</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Bozdag1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bozdag</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Close</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Lonardi</surname><given-names>S</given-names></name> (<year>2008</year>) <article-title>Computing the minimal tiling path from a physical map by integer linear programming. In: Proceedings of the Workshop on Algorithms in Bioinformatics</article-title>. <source>WABI</source> <volume>2008</volume>: <fpage>148</fpage>–<lpage>161</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-ThierryMieg1">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thierry-Mieg</surname><given-names>N</given-names></name> (<year>2006</year>) <article-title>A new pooling strategy for high-throughput screening: the shifted transversal design</article-title>. <source>BMC Bioinformatics</source> <volume>7</volume>: <fpage>28</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Ding1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ding</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>WQ</given-names></name>, <name name-style="western"><surname>Wong</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>YJ</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Five-color-based highinformation- content fingerprinting of bacterial artificial chromosome clones using type IIS restriction endonucleases</article-title>. <source>Genomics</source> <volume>74</volume>: <fpage>142</fpage>–<lpage>154</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Luo1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Luo</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Thomas</surname><given-names>C</given-names></name>, <name name-style="western"><surname>You</surname><given-names>FM</given-names></name>, <name name-style="western"><surname>Hsiao</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ouyang</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>High-throughput fingerprinting of bacterial artificial chromosomes using the snapshot labeling kit and sizing of restriction fragments by capillary electrophoresis</article-title>. <source>Genomics</source> <volume>82</volume>: <fpage>378</fpage>–<lpage>389</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Soderlund1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Soderlund</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Humphray</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Dunham</surname><given-names>A</given-names></name>, <name name-style="western"><surname>French</surname><given-names>L</given-names></name> (<year>2000</year>) <article-title>Contigs built with fingerprints, markers, and FPC v4.7</article-title>. <source>Genome Research</source> <volume>10</volume>: <fpage>1772</fpage>–<lpage>1787</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Bozdag2">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bozdag</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Close</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Lonardi</surname><given-names>S</given-names></name> (<year>2007</year>) <article-title>A compartmentalized approach to the assembly of physical maps. In: Proceedings of IEEE International Symposium on Bioinformatics &amp; Bioengineering</article-title>. <source>BIBE</source> <volume>2007</volume>: <fpage>218</fpage>–<lpage>225</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Du1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Du</surname><given-names>DZ</given-names></name>, <name name-style="western"><surname>Hwang</surname><given-names>FK</given-names></name> (<year>1993</year>) <article-title>Combinatorial Group Testing and Applications. (Series on Applied Mathematics)</article-title>. <source>World Scientific Publishing Company</source></mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Du2">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Du</surname><given-names>DZ</given-names></name>, <name name-style="western"><surname>Hwang</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Znati</surname><given-names>T</given-names></name> (<year>2006</year>) <article-title>New construction for transversal design</article-title>. <source>Journal of Computational Biology</source> <volume>13</volume>: <fpage>990</fpage>–<lpage>995</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Vermeirssen1">
        <label>22</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vermeirssen</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Deplancke</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Barrasa</surname><given-names>MI</given-names></name>, <name name-style="western"><surname>Reece-Hoyes</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Arda</surname><given-names>HE</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Matrix and Steiner-triple-system smart pooling assays for high-performance transcription regulatory network mapping</article-title>. <source>Nat Meth</source> <volume>4</volume>: <fpage>659</fpage>–<lpage>664</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Li1">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Zerbino1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zerbino</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Birney</surname><given-names>E</given-names></name> (<year>2008</year>) <article-title>Velvet: Algorithms for de novo short read assembly using de Bruijn graphs</article-title>. <source>Genome Research</source> <volume>8</volume>: <fpage>821</fpage>–<lpage>9</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Li2">
        <label>25</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Ruan</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Qian</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Fang</surname><given-names>X</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>De novo assembly of human genomes with massively parallel short read sequencing</article-title>. <source>Genome Research</source> <volume>20</volume>: <fpage>265</fpage>–<lpage>272</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Simpson1">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simpson</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Wong</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Jackman</surname><given-names>SD</given-names></name>, <name name-style="western"><surname>Schein</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>SJ</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>ABySS: A parallel assembler for short read sequence data</article-title>. <source>Genome Research</source> <volume>19</volume>: <fpage>1117</fpage>–<lpage>1123</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Close1">
        <label>27</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Close</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Bhat</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Lonardi</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Rostoks</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Development and implementation of high-throughput SNP genotyping in barley</article-title>. <source>BMC Genomics</source> <volume>10</volume>: <fpage>582</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-MuozAmatrian1">
        <label>28</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Muñoz-Amatriaín</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Moscou</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Bhat</surname><given-names>PR</given-names></name>, <name name-style="western"><surname>Svensson</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Bartoš</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>An improved consensus linkage map of barley based on flow-sorted chromosomes and single nucleotide polymorphism markers</article-title>. <source>The Plant Genome</source> <volume>4</volume>: <fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Alpert1">
        <label>29</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alpert</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Wanamaker</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Duma</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Fenton</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Ma</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>A genome sequence resource for barley</article-title>. <source>Barley Genetics Newsletter</source> <volume>41</volume>: <fpage>10</fpage>–<lpage>11</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Wicker1">
        <label>30</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wicker</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Zimmermann</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Perovic</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Paterson</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ganal</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>A detailed look at 7 million years of genome evolution in a 439 kb continuous sequence at the barley Hv-eIF4E locus: recombination, rearrangements and repeats</article-title>. <source>The Plant J</source> <volume>41</volume>: <fpage>184</fpage>–<lpage>194</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Yu1">
        <label>31</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Tomkins</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Waugh</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Frisch</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Kudrna</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2000</year>) <article-title>A bacterial artificial chromosome library for barley (Hordeum vulgare L.) and the identification of clones containing putative resistance genes</article-title>. <source>Theoretical and Applied Genetics</source> <volume>101</volume>: <fpage>1093</fpage>–<lpage>1099</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Madishetty1">
        <label>32</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Madishetty</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Condamine</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Svensson</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Rodriguez</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Close</surname><given-names>TJ</given-names></name> (<year>2007</year>) <article-title>An improved method to identify BAC clones using pooled overgos</article-title>. <source>Nucleic Acids Research</source> <volume>35</volume>: <fpage>e5</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Fan1">
        <label>33</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fan</surname><given-names>JB</given-names></name>, <name name-style="western"><surname>Chee</surname><given-names>MS</given-names></name>, <name name-style="western"><surname>Gunderson</surname><given-names>KL</given-names></name> (<year>2006</year>) <article-title>Highly parallel genomic assays</article-title>. <source>Nat Rev Genet</source> <volume>7</volume>: <fpage>632</fpage>–<lpage>644</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Yang1">
        <label>34</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Dorman</surname><given-names>KS</given-names></name>, <name name-style="western"><surname>Aluru</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Reptile: representative tiling for short read error correction</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>2526</fpage>–<lpage>2533</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Treangen1">
        <label>35</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Treangen</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2011</year>) <article-title>Repetitive DNA and next-generation sequencing: computational challenges and solutions</article-title>. <source>Nature Reviews Genetics</source> <volume>13</volume>: <fpage>36</fpage>–<lpage>46</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Roach1">
        <label>36</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roach</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Boysen</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Hood</surname><given-names>L</given-names></name> (<year>1995</year>) <article-title>Pairwise end sequencing: a unified approach to genomic mapping and sequencing</article-title>. <source>Genomics</source> <volume>26</volume>: <fpage>345</fpage>–<lpage>353</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Weber1">
        <label>37</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weber</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Myers</surname><given-names>E</given-names></name> (<year>1997</year>) <article-title>Human whole-genome shotgun sequencing</article-title>. <source>Genome Research</source> <volume>7</volume>: <fpage>401</fpage>–<lpage>409</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Green1">
        <label>38</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Green</surname><given-names>E</given-names></name> (<year>2001</year>) <article-title>Strategies for the systematic sequencing of complex genomes</article-title>. <source>Nature Reviews Genetics</source> <volume>2</volume>: <fpage>573</fpage>–<lpage>583</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Salzberg1">
        <label>39</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Phillippy</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Zimin</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Puiu</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Magoc</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>GAGE: A critical evaluation of genome assemblies and assembly algorithms</article-title>. <source>Genome Research</source> <volume>22</volume>: <fpage>557</fpage>–<lpage>567</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Earl1">
        <label>40</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Earl</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Bradnam</surname><given-names>K</given-names></name>, <name name-style="western"><surname>St John</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Darling</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Assemblathon 1: A competitive assessment of de novo short read assembly methods</article-title>. <source>Genome Research</source> <volume>21</volume>: <fpage>2224</fpage>–<lpage>2241</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1003010-Haiminen1">
        <label>41</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haiminen</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Feltus</surname><given-names>FA</given-names></name>, <name name-style="western"><surname>Parida</surname><given-names>L</given-names></name> (<year>2011</year>) <article-title>Assessing pooled BAC and whole genome shotgun strategies for assembly of complex genomes</article-title>. <source>BMC Genomics</source> <volume>12</volume>: <fpage>194</fpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>